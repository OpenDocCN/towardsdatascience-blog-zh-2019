# 关于 Auto-Deeplab 你需要知道的一切:谷歌关于细分的最新消息

> 原文：<https://towardsdatascience.com/everything-you-need-to-know-about-auto-deeplab-googles-latest-on-segmentation-181425d17cd5?source=collection_archive---------15----------------------->

## 搜索图像分割模型

DeepLab 的所有早期版本(v1、v2、v3 和 v3plus)在发布时都拓展了语义分割问题的最新技术。与此同时，神经结构搜索已被用于击败由人类设计的网络设置的图像识别问题的最先进技术。因此，接下来的步骤是尝试解决密集图像预测问题，如使用神经架构搜索的语义分割。这个故事是对在 **CVPR 2019** 上发表的论文“ **Auto-DeepLab:语义图像分割的分层神经架构搜索**”的回顾。

# 内容:

1.  介绍
2.  建筑搜索空间
3.  获取模型
4.  实验结果
5.  进一步阅读

# 介绍

语义分割问题是由一些最早的 CNN 如 AlexNet，VGG，Inception，ResNet 等解决的。然后出现了这些模型的改进版本，如 Wide ResNet、Xception、ResNeXt 等。然而，所有这些模型都是用于手头问题的通用特征提取器。这些模型之后是一系列专门用于分割的模型，例如提出 atrous convolutions 或 PSPNet 概念的 DeepLab 模型系列，这些模型分别在几个数据集的分割挑战中胜出。但是，现在使用的模型大多使用 ImageNet 预训练。然而，这里提出的模型在没有这种帮助的情况下也能产生有竞争力的结果。

为了**减少搜索网络所需的计算能力**，他们**使用差分 NAS** 而不是使用进化算法或强化学习的旧技术。这样，我们能够从潜在空间而不是完全随机的搜索中得到结构。

此外，NAS 在过去已经被用于搜索有规律地重复以形成整个网络的 CNN 块。换句话说，它只用于细胞内部水平，而不是确定网络结构。然而，在这里**他们建议使用 NAS 来搜索网络以及搜索小区的正常任务。**

# 建筑搜索空间

**单元级搜索空间**

要搜索一个单元格，首先，我们定义一个单元格。这里，信元是由 *B* 块组成的完全卷积模块。每个块是两个分支的结构，并且可以由 5 元组 *(I₁，I₂，O₁，O₂，C)* 定义，其中 *I₁，I₂* ∈ Iˡᵢ是层 l 中块 I 的输入的所有可能选择的集合和 *O₁，o\\*是块 c 的层类型的选择，是用于组合两个分支的单独输出以获得该块 h 的输出的方法。**细胞的输出张量 Hˡ仅仅是来自块**的输出的串联。**一个区块的可能张量集合包含前两个单元的输出，即 Hˡ⁻和 Hˡ⁻。此外，来自单元中的块 j 的输出可以被输入到每个块 I，其中 i > j.**

此外，每个模块中要考虑的分支类型如下:

![](img/378d101604b22f879c04a91589232bf6.png)

深度方向可分离 conv 首先在 MobileNetV2 中引入，在 DeepLab 中引入 atrous conv。

**网络级搜索空间**

网络级搜索空间是特别需要的，因为这是一个密集图像预测问题，并且通常用于这种问题的网络倾向于从高分辨率图像开始，并且在网络期间在某处获得空间维度，然后再次回到原始维度。这里，**作者将总下采样因子限制为 32。**同样，**空间维度上的移动可以仅通过因子 2** 来完成。此外，层的总数，即线程单元的总数被设置为 12。

下图是**潜伏空间**的示意图。左边是整个网络的潜在空间。它是空间维度因子对层数的网格。当搜索架构时，根据每个可能的最终空间维度因子(s = 4，8，16，32)将用于分割的 ASPP 模块放置在每个可能的位置。

右图是细胞的潜在空间。它包含五个具有所有可能连接的块。这些连接将在下一节中解释。

![](img/c619654bb83cda8badd2c7cc2c5fc320.png)

# **获取模型**

这是我们通过搜索得到模型的地方。这是一个分为三步的过程，如下所示:

**细胞结构**

首先，我们浏览解释如何搜索架构的系统，该系统也遵循上面定义的搜索空间。简而言之，**我们使用下述公式对所有层**(待选择的输入、待选择的分支和待选择的空间维度)的每个可能连接赋予权重:

块 Hᵢˡ的隐藏输出:

![](img/1f8f807abf1b78880479703decc700d1.png)

此外，我们使用以下公式估算每个连接要使用的 Oⱼ₋ᵢ分支:

![](img/4a9bc87ff9f16d1bb72fa37322768556.png)

基本上，连同正常的 CNN 权重，**我们在整个潜在搜索空间中添加这些权重(αᵏⱼ₋ᵢ)(从现在起我将称它们为元权重)**，该潜在搜索空间包含可能的输入和单元内可能的分支之间的所有连接。我们给出一个加权加法，并了解这些元权重的什么组合给我们提供了单元的最佳结构。这种结构最好的部分是**，因为上面的等式是可微的**，所以**元权重可以与正常权重同时训练。**既然根据已经决定的潜在空间，我们可以把已经输出的前两个单元格转换成当前单元格。因此，在层 l 给出输出的单元的总体数学公式可以写为:

![](img/291cc59b39af30bbb73e83cf03838e1b.png)

接下来是网络作为一个整体的结构，当在前面部分描述的潜在空间中时，该结构将被搜索。如果当前层的空间维度因子是 s，则该层的输入只能来自三个空间维度，即 s/2、s 和 s，按照潜在空间。因此，就像我们对单元结构所做的一样，**我们定义元权重来获得正确的连接:**

![](img/198f6ce7a737e8c3d8cd7b3587bf9433.png)

这里β是元权重的集合。βs 之间的关系如下:

![](img/65dc8178614e03f8bc6aea9e37352d7a.png)

**优化**

就像正常权重一样，我们使用交叉熵损失来训练这些“元权重”,以便获得优化的情况，其中α的各种值描述了我们在单元内的网络，而β的各种值描述了整体结构。经过训练，他们想出了以下模型。

![](img/183f13da781fb763ccda272d62b6db2a.png)

他们通过第三步实现了这种架构:

**解码**

对于细胞结构，我们从所有可能的输入中选取两个最强的连接，使用该分支的最大α值，并对所有块重复这一练习。对于网络架构来说，**不能贪婪地计算β的值。我们的目标是得到最终给我们带来最大价值的价值序列。这是动态编程的一个经典案例，使用** [**维特比算法**](https://en.wikipedia.org/wiki/Viterbi_algorithm) **可以轻松解决。**

解码后我们得到了如上图所示的最终结构。相比之下，Deeplab 的结构如下所示:

![](img/aeee159c65740dac6e3532a8f4ca7f34.png)

# 实验结果

这个模型最大的一个成果就是不需要任何 Imagenet 的预训练。结果可以总结在下表中。在 CityScapes 数据集上，AutoDeepLab-L 的性能优于 GridNet，而**的性能与 DeepLabV3+相当，为 82.1%，而所需的计算能力几乎是后者的一半。**

![](img/aaeebaeb8166e8f11234c896ad07fab1.png)

类似地，在 COCO 数据集上，**结果与使用 Imagenet 预训练**的模型相当。这显示了 NAS 的强大功能以及我们从这一理念中获得的体系结构。

![](img/328b958a3b7bcddf1977819ad57fb19d.png)

# 进一步阅读

查看 Auto-DeepLab [的论文](https://arxiv.org/pdf/1901.02985.pdf)以了解更多关于这个想法的信息。

要了解更多关于计算机视觉和深度学习的信息，请关注我的 [Medium](https://medium.com/@vandit_15) 和 [Github](https://github.com/vandit15) 。

也可以在 [LinkedIn](https://www.linkedin.com/in/vandit-jain15/) 关注我。