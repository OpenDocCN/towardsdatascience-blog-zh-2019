<html>
<head>
<title>Human in the Loop Auto Machine Learning with Dabl</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用 Dabl 的人在回路自动机器学习</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/human-in-the-loop-auto-machine-learning-with-dabl-2fe9c9d1736f?source=collection_archive---------32-----------------------#2019-11-25">https://towardsdatascience.com/human-in-the-loop-auto-machine-learning-with-dabl-2fe9c9d1736f?source=collection_archive---------32-----------------------#2019-11-25</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><figure class="it iu gq gs iv iw gi gj paragraph-image"><div role="button" tabindex="0" class="ix iy di iz bf ja"><div class="gi gj is"><img src="../Images/d5d2bdd0c6f35136d897ddfd88612b17.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lsLOYEAWGTFCSFgYIm-Fdg.png"/></div></div></figure><div class=""/><div class=""><h2 id="d5f9" class="pw-subtitle-paragraph kc je jf bd b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt dk translated">使用这个 python 库自动执行重复的机器学习任务</h2></div><p id="9a7b" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp in bi lq translated"><span class="l lr ls lt bm lu lv lw lx ly di"> T </span>任何机器学习项目最耗时的部分都是数据清理、预处理和分析的初始阶段。在训练一个模型之前，你首先需要经历一个漫长的过程。执行任务，例如处理缺失值、将分类变量转换为数字变量并分析数据，以便为特征工程和选择提供信息。</p><p id="7395" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp in bi translated">有许多工具试图自动化这个过程，包括众所周知的<a class="ae lz" href="https://automl.github.io/auto-sklearn/master/" rel="noopener ugc nofollow" target="_blank"> auto-sklearn </a>库。然而，其中许多都是一个黑箱，很难准确理解工具是如何改变数据的，如果数据有一些独特性，也很难定制过程。</p><p id="3407" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp in bi translated">Andreas Mueller 创建的相对较新的 python 库 d <a class="ae lz" href="https://amueller.github.io/dabl/dev/quick_start.html" rel="noopener ugc nofollow" target="_blank"> abl </a>试图解决这个问题。Dabl 提供了一个工具来自动化初始模型开发阶段中涉及的许多重复性任务。虽然功能目前有点有限，但确实存在的功能是非常有前途的。看看 Github 回购开发正在进行中，最近的项目承诺发生在 2019 年 11 月 15 日。在本文的剩余部分，我将对该工具进行简单的评估。</p></div><div class="ab cl ma mb hy mc" role="separator"><span class="md bw bk me mf mg"/><span class="md bw bk me mf mg"/><span class="md bw bk me mf"/></div><div class="in io ip iq ir"><h2 id="d59b" class="mh mi jf bd mj mk ml dn mm mn mo dp mp ld mq mr ms lh mt mu mv ll mw mx my mz bi translated">自动化预处理</h2><p id="98d9" class="pw-post-body-paragraph ku kv jf kw b kx na kg kz la nb kj lc ld nc lf lg lh nd lj lk ll ne ln lo lp in bi translated">Dabl 可以 pip 安装，如下所示。该库还依赖于是否安装了最新版本的 scikit-learn，因此如果您没有安装，则需要升级或安装最新版本<code class="fe nf ng nh ni b">scikit-learn==0.21.3</code>。</p><pre class="nj nk nl nm gu nn ni no np aw nq bi"><span id="23dc" class="mh mi jf ni b gz nr ns l nt nu">pip install dabl</span><span id="4373" class="mh mi jf ni b gz nv ns l nt nu">import pandas as pd<br/>import dabl</span></pre><p id="fd67" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp in bi translated">为了说明其中的一些特性，我将使用“给我一些信任”竞赛中的 Kaggle 数据集。数据集可以从<a class="ae lz" href="https://www.kaggle.com/c/GiveMeSomeCredit/data" rel="noopener ugc nofollow" target="_blank">这里</a>下载。我使用的是<code class="fe nf ng nh ni b">cs-training.csv</code>文件，该文件包含关于一个人的信用历史和环境的特征，以及目标变量(SeriousDiqin2yrs `)。这表明他们在过去两年中是否经历过严重的财务压力。</p><pre class="nj nk nl nm gu nn ni no np aw nq bi"><span id="c1c6" class="mh mi jf ni b gz nr ns l nt nu">loan_data = pd.read_csv('cs-training.csv')</span></pre><p id="9b99" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp in bi translated">通常，机器学习项目的第一部分是理解数据，并在训练模型之前执行必要的预处理。Dabl 寻求自动化这一过程。如果运行以下命令，dabl 将尝试识别缺失值、要素类型和错误数据。我们数据集的输出显示在代码下面。</p><pre class="nj nk nl nm gu nn ni no np aw nq bi"><span id="2cf3" class="mh mi jf ni b gz nr ns l nt nu">loan_clean = dabl.clean(loan_data, verbose=1)<br/>describe_data(loan_clean)</span></pre><figure class="nj nk nl nm gu iw gi gj paragraph-image"><div class="gi gj nw"><img src="../Images/d7257cb050819727eecaa3456ab4c03a.png" data-original-src="https://miro.medium.com/v2/resize:fit:694/format:webp/1*oH27EioI0tVlLzx7vVxxHQ.png"/></div></figure><figure class="nj nk nl nm gu iw gi gj paragraph-image"><div class="gi gj nx"><img src="../Images/05a5d52989de4d8e436a5160d93befa8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1284/format:webp/1*4RyCm5ScDyyNr0KRHN6fcA.png"/></div></figure><p id="4248" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp in bi translated">有关它已识别的要素类型的更多信息，您可以键入。</p><pre class="nj nk nl nm gu nn ni no np aw nq bi"><span id="66c4" class="mh mi jf ni b gz nr ns l nt nu">types = dabl.detect_types(loan_clean)<br/>types</span></pre><figure class="nj nk nl nm gu iw gi gj paragraph-image"><div role="button" tabindex="0" class="ix iy di iz bf ja"><div class="gi gj ny"><img src="../Images/4e2f4ac0b2e12173fbfd1e067e3502f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8DEdPa-Z_7IdT8eCgpUBhg.png"/></div></div></figure><p id="85ea" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp in bi translated">当模型适合数据时，Dabl 将使用上述方法对特征进行适当的预处理。特别有用的是，1)您可以直观地看到 dabl 正在推断什么，2)如果您认为推断的数据类型不正确，您可以对预处理进行调整。例如，在上文中，dabl 已将特征<code class="fe nf ng nh ni b">NumberOfDependents</code>识别为连续变量。然而，如果被视为分类，这实际上可能在模型中执行得更好，所以我们可以选择将其指定为<code class="fe nf ng nh ni b">categorical</code>,如下面的代码所示。</p><pre class="nj nk nl nm gu nn ni no np aw nq bi"><span id="9a8d" class="mh mi jf ni b gz nr ns l nt nu">loan_clean = dabl.clean(loan_data, type_hints={"NumberOfDependents": "categorical"})</span></pre><h2 id="046b" class="mh mi jf bd mj mk ml dn mm mn mo dp mp ld mq mr ms lh mt mu mv ll mw mx my mz bi translated">数据分析</h2><p id="9882" class="pw-post-body-paragraph ku kv jf kw b kx na kg kz la nb kj lc ld nc lf lg lh nd lj lk ll ne ln lo lp in bi translated">模型开发中第二耗时的部分是数据分析。在训练模型之前，了解数据的基本分布、目标类的平衡程度以及哪些特征与目标变量密切相关非常重要。Dabl 也试图简化这一过程。简单地运行这一行代码就可以返回大量有用的可视化结果。由于 dabl 检测特征类型并自动清理数据，这使得数据分析速度极快。</p><pre class="nj nk nl nm gu nn ni no np aw nq bi"><span id="e469" class="mh mi jf ni b gz nr ns l nt nu">dabl.plot(loan_clean, 'SeriousDlqin2yrs')</span></pre><figure class="nj nk nl nm gu iw gi gj paragraph-image"><div role="button" tabindex="0" class="ix iy di iz bf ja"><div class="gi gj nz"><img src="../Images/5d4e0612187e13f4167f3c9ace82628e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qHFwThT36laa3zUTEXN-JA.png"/></div></div></figure><figure class="nj nk nl nm gu iw gi gj paragraph-image"><div role="button" tabindex="0" class="ix iy di iz bf ja"><div class="gi gj oa"><img src="../Images/ef1187aa8420c852f1e7bbd12342e3a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cpcIX6Q-nI5d5_90asvAWw.png"/></div></div></figure><h2 id="82dd" class="mh mi jf bd mj mk ml dn mm mn mo dp mp ld mq mr ms lh mt mu mv ll mw mx my mz bi translated">模型开发</h2><p id="e8be" class="pw-post-body-paragraph ku kv jf kw b kx na kg kz la nb kj lc ld nc lf lg lh nd lj lk ll ne ln lo lp in bi translated">Dabl 还寻求加速模型选择过程。通过运行非常少量的代码，dabl 训练一组 scikit-learn 模型并返回相应的分数。</p><pre class="nj nk nl nm gu nn ni no np aw nq bi"><span id="84aa" class="mh mi jf ni b gz nr ns l nt nu">fc = dabl.SimpleClassifier(random_state=0)<br/>X = loan_clean.drop('SeriousDlqin2yrs', axis=1)<br/>y = loan_clean.SeriousDlqin2yrs<br/>fc.fit(X, y)</span></pre><figure class="nj nk nl nm gu iw gi gj paragraph-image"><div role="button" tabindex="0" class="ix iy di iz bf ja"><div class="gi gj ob"><img src="../Images/9c8d428243f5c3db1c2b5f3cea9adeb6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JUil3G3AbxDzcsCJjDjRGw.png"/></div></div><figcaption class="oc od gk gi gj oe of bd b be z dk">A selection of models and scores returned from dabl</figcaption></figure></div><div class="ab cl ma mb hy mc" role="separator"><span class="md bw bk me mf mg"/><span class="md bw bk me mf mg"/><span class="md bw bk me mf"/></div><div class="in io ip iq ir"><p id="77df" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp in bi translated">这个图书馆很新，还在开发中。看一下文档，还会有一些有用的特性，包括模型解释器和增强模型构建的工具。目前，这个库提供了一种在模型开发之初自动完成大量工作的方法，特别是对于机器学习模型的快速原型开发非常有用。</p><p id="832e" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp in bi translated">感谢阅读！</p></div></div>    
</body>
</html>