<html>
<head>
<title>Using machine learning to understand customers behavior</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用机器学习来理解客户行为</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/using-machine-learning-to-understand-customers-behavior-f41b567d3a50?source=collection_archive---------2-----------------------#2019-05-29">https://towardsdatascience.com/using-machine-learning-to-understand-customers-behavior-f41b567d3a50?source=collection_archive---------2-----------------------#2019-05-29</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/54173b143f022766842fbd2c541b4c57.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ROmgayIXEU8QKwtqmSTaFg.jpeg"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk">Photo by <a class="ae jg" href="https://unsplash.com/photos/eT8vx7LLorY?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Amy Shamblen</a> on <a class="ae jg" href="https://unsplash.com/?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><div class=""/><div class=""><h2 id="eb6d" class="pw-subtitle-paragraph kg ji jj bd b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dk translated">并非所有的客户都一样</h2></div><p id="60b5" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">请把我的毛衣给我。我快冻僵了”——我的一个朋友 Lara 说。</p><p id="cabc" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><em class="lu">“哇，那看起来像一件昂贵的毛衣”</em> —玛利亚惊叫道</p><p id="df79" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><em class="lu">“是的，它花了我一大笔钱”</em>——劳拉回答</p><p id="c6be" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">“<em class="lu">我永远不会买这么贵的东西”</em> — Maria 坚定地说— <em class="lu">“我是说……我买得起，但是……真的不值得”</em></p><p id="71eb" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在我们的朋友群中，劳拉因为在衣服上过度消费而出名，仅仅因为这些衣服是由某个特定的品牌出售的。</p><p id="3211" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">另一个极端是玛丽亚。她赚了很多钱，但她不愿意在每件物品上花很多钱。</p><p id="026b" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们其余的人正好落在中间。</p><p id="f702" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我喜欢买手表，我想一周的每一天都有一只。我愿意为它们付钱，但不是一个疯狂的数目。</p><p id="1b80" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我的一些朋友过去常常买许多便宜的东西。其他人只是喜欢把薪水花在外出就餐或美食活动上。</p><p id="224f" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我有一个喜欢在网上订购东西的朋友。她讨厌去购物中心。所以每个月她都会少一百块钱，因为她点的东西太多了。</p><p id="9511" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><em class="lu">“不适合我”</em> —我的另一个朋友过去常常自豪地说— <em class="lu">“我需要试穿这双鞋，或者感受一下它的质量，才能买下它。我喜欢以旧的时尚方式购买。”</em></p><p id="459b" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">每个人都是不同的，他们作为顾客的行为也是不同的。</p><p id="b2ca" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">假设你是一家商店的老板。不管你是开电商还是开超市。不管是一家小商店还是亚马逊或网飞这样的大公司，<a class="ae jg" rel="noopener" target="_blank" href="/how-machine-learning-can-help-with-customer-retention-6b5bf654e822?source=friends_link&amp;sk=ae71c8351d3028db1aedeb9c11feee12">了解你的客户更好</a>。</p><p id="6094" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">机器学习对于这项任务来说很方便。特别地，聚类，最重要的无监督学习问题，能够创建将相似个体分组的类别。</p><p id="8099" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这些类别被称为<em class="lu">集群</em>。聚类是数据集中的点的集合。这些点在它们之间比它们与属于其他聚类的点更相似。</p><p id="c41c" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><em class="lu">基于距离的聚类</em>将点分组为一些簇，使得簇内的距离应该小，而簇之间的距离应该大。</p><figure class="lw lx ly lz gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi lv"><img src="../Images/2a3853b375a55a67023233e3eb285247.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ru5Un6XMuRoMq9LBcX_uNQ.png"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk">Clustering example: A cluster is a collection of points which are more similar to each other that they are to points in another cluster.</figcaption></figure><p id="25f3" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">有几种方法可以计算这些距离。你可以阅读<a class="ae jg" href="https://medium.com/@meinzaugarat/how-to-measure-distances-in-machine-learning-13a396aa34ce?source=friends_link&amp;sk=adb1f38fb6c7cb31b6f2f992ad7bddbf" rel="noopener">我的帖子</a>了解更多详情。</p><p id="dc27" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">假设现在您能够收集持有会员卡的客户的基本数据。</p><p id="fffb" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">您设法获得了客户 ID、年龄、性别、年收入和支出分数。最后一个是基于客户行为和购买数据的分数。</p><p id="91ae" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">市场上有一些你有兴趣销售的新产品。但是您希望针对每种产品的特定类型的客户。所以，你需要在你的顾客中找到模式。</p><p id="18c5" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">嗯……我们可以开始了吗？我们将使用 Python 的几个库来完成整个过程。</p><p id="2184" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在所有的聚类算法中，我们将选择 K-means。</p><p id="dcf1" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在将收集的数据读入<code class="fe ma mb mc md b">pandas</code>数据帧后，任何涉及数据科学的项目的下一步都是探索数据。</p><figure class="lw lx ly lz gt iv"><div class="bz fp l di"><div class="me mf l"/></div></figure><figure class="lw lx ly lz gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi lv"><img src="../Images/a4535d9b2f7bf880cb9528018a2aaacf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wTN7jrC-huuEND-4zzhhCQ.png"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk">A quick overview of the first rows of the dataset.</figcaption></figure><p id="da2c" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这意味着探索数据的质量和变量的分布。有必要确定您是否有丢失的值。</p><p id="ae58" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">K-means 算法不能够处理<strong class="la jk"> <em class="lu">缺失值</em> </strong>。处理缺失值总是很困难。如果只有少数观察值缺失，则可以将其从聚类中排除。</p><p id="e795" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果有大量的缺失值，有几个选项可用。</p><p id="2705" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">其中之一就是输入这些值。由于使用 K-means 进行聚类是基于距离计算的，因此应该仔细考虑输入它们的技术。</p><figure class="lw lx ly lz gt iv"><div class="bz fp l di"><div class="me mf l"/></div></figure><figure class="lw lx ly lz gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi mg"><img src="../Images/269fe3f15bd9d2c54d60f1cdf78000cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*m44vK7qBjefZ4vhhba0MRA.png"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk">Missing values present in our dataset.</figcaption></figure><p id="68df" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">幸运的是，数据集不包含缺失值。</p><p id="d5ab" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">另一方面，我们还应该探索数据集中存在的变量类型。<strong class="la jk"> <em class="lu">分类变量</em> </strong>不能直接处理。</p><p id="9cc1" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">同样，K 均值是基于距离的。转换这些变量的方法取决于分类变量的类型。</p><figure class="lw lx ly lz gt iv"><div class="bz fp l di"><div class="me mf l"/></div></figure><figure class="lw lx ly lz gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi mh"><img src="../Images/bd34c7dae79a44a90dd8e3d48e68410b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0eByH_UahetuuVm8LEcLdA.png"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk">Type of variables in the dataset.</figcaption></figure><p id="adcd" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们确认(正如我们在数据集概述中已经看到的)变量<code class="fe ma mb mc md b">Gender</code>是分类的。</p><p id="0579" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">因为它是一个基数变量(它没有任何固有的顺序)我们可以把它转换成两个二元变量:<code class="fe ma mb mc md b">Male</code>，取值 0 或 1。<code class="fe ma mb mc md b">Female</code>，取值 0 或 1。</p><p id="6709" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">此外，您应该获得描述性统计数据，并绘制每个感兴趣变量的分布图。</p><p id="eda9" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们将定义两个函数。第一个返回一些统计数据:平均值、标准差、中值、方差。我们的另一个函数绘制了每个变量的分布(<em class="lu">你可以查看我放在文章最后的 GitHub repo 中的代码</em>)。</p><figure class="lw lx ly lz gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi mi"><img src="../Images/9135e5f29248754a437681256d5ba312.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bToJAgCBJMmkQ9SzFBg70Q.png"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk">Descriptive statistics for numerical variables.</figcaption></figure><figure class="lw lx ly lz gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi mj"><img src="../Images/512383861d89a2ee4c89acd546a6f054.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Qa0fBujWMSMtZCK6XczL_g.png"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk">Distribution of numerical variables.</figcaption></figure><p id="1455" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">此外，我们将分析数字参数之间的相关性。为此，我们将使用<code class="fe ma mb mc md b">pairplot</code> seaborn 函数。</p><p id="ea4e" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们想知道性别之间是否存在差异。因此，我们将设置<code class="fe ma mb mc md b">hue</code>参数来为属于女性或客户的点获取不同的颜色。</p><figure class="lw lx ly lz gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi mk"><img src="../Images/a163135b3d657f679ac7f131e6e74ec6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cIOsOAIz2zkTzWe92LDcWA.png"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk">Pairplot showing the correlation between numerical variables. Also, it can be observed male customers in green and female customers in blue.</figcaption></figure><p id="7ff3" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la jk">为什么在使用 K-means 时研究这些参数很重要？</strong></p><p id="fa93" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">因为我们需要满足算法假设。k 均值假设:</p><ul class=""><li id="1e4a" class="ml mm jj la b lb lc le lf lh mn ll mo lp mp lt mq mr ms mt bi translated"><strong class="la jk">簇的形状</strong>:分布的方差是球形的，意味着簇具有球形形状。为了做到这一点，所有变量都应该是正态分布的，并且具有相同的方差。</li><li id="28bc" class="ml mm jj la b lb mu le mv lh mw ll mx lp my lt mq mr ms mt bi translated"><strong class="la jk">聚类的大小:</strong>所有的聚类都有相同数量的观察值。</li><li id="50cd" class="ml mm jj la b lb mu le mv lh mw ll mx lp my lt mq mr ms mt bi translated"><strong class="la jk">变量之间的关系:</strong>变量之间很少或没有相关性。</li></ul><p id="a832" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">此外，查看分布和描述性统计数据允许我们确定是否需要执行特征缩放。</p><p id="afc1" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">k-Means 中的距离计算给每个维度分配相等的权重。如果一个变量的范围与其他变量完全不同，那么绝对变化可能会更大。这可能导致模型更加重视该变量。</p><p id="2629" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在我们的数据集中，变量是正态分布的。方差彼此非常接近。除了年龄比其他变量的方差小。</p><p id="fe9d" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们可以找到一个合适的转换来解决这个问题。我们可以应用对数或 Box-Cox 变换。</p><p id="94ac" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><a class="ae jg" href="https://en.wikipedia.org/wiki/Power_transform#Box%E2%80%93Cox_transformation" rel="noopener ugc nofollow" target="_blank"> <em class="lu"> Box-Cox </em> </a>是一个变换家族，允许我们修正非正态分布变量或非等方差。它通过为所提供的特定数据选择最佳转换来实现这一点。调节这一点的主要参数由λ表示。</p><p id="a85a" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在，我们将使用<a class="ae jg" href="https://jakevdp.github.io/PythonDataScienceHandbook/05.09-principal-component-analysis.html#Introducing-Principal-Component-Analysis" rel="noopener ugc nofollow" target="_blank"> <strong class="la jk">主成分分析</strong> (PCA) </a>来提取关于数据集的隐藏结构的信息。</p><p id="a5c3" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">PCA 是一种无监督学习算法。它基本上是一种降维算法。</p><p id="ea17" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">它用于发现哪些维度最大化了数据集中存在的要素的方差。但它也可以用作可视化和特征提取等工具。</p><p id="64e9" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">“降维”到底是什么意思？</p><p id="0e0e" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我记得我在大学教数学的时候。最困难的部分是解释 n 维空间。更别说去想象 5 维、6 维或 90 维了。</p><p id="133e" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">为什么会这样？因为看二维或至多三维空间总是更容易将事物形象化。</p><p id="b50a" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">假设我们想找出几个变量之间的关系。如果我们能够在二维空间中绘制这些变量，我们就能够马上描绘出它们之间的联系。</p><p id="877b" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这是 PCA 进入的地方。在 PCA 中，这种关系通过找到数据中的主轴列表来量化。后来，它们被用来描述我们的数据集。</p><p id="864f" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们来看看实际情况。我们有 5 个变量(<code class="fe ma mb mc md b">Age</code>、<code class="fe ma mb mc md b">Annual Income</code>、<code class="fe ma mb mc md b">Spending</code>、<code class="fe ma mb mc md b">Male</code>、<code class="fe ma mb mc md b">Female</code>)。所以如果我们想把它们都画出来，我们需要 5 个维度。</p><p id="68aa" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">相反，我们将应用来自<code class="fe ma mb mc md b">sklearn</code>模块的<code class="fe ma mb mc md b">PCA</code>函数。然后，我们将模型与最终数据集相匹配。并转换数据。</p><figure class="lw lx ly lz gt iv"><div class="bz fp l di"><div class="me mf l"/></div></figure><p id="8be1" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在拟合过程中，模型从数据中学习一些量:<code class="fe ma mb mc md b">components </code>和<code class="fe ma mb mc md b">explained variance</code>。</p><figure class="lw lx ly lz gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi mz"><img src="../Images/e3081967c817fd0eebb47704746b5d40.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uWHj7x_AKDn7UNfHzFaeAA.png"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk">Components and explained variance learn during the fitting process.</figcaption></figure><p id="ec46" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这些看似抽象的数字定义了矢量。分量定义了向量的方向，而解释的方差定义了向量的平方长度。</p><p id="01ab" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">向量代表数据的主轴。向量的长度表示该轴在描述数据分布时的重要性。每个数据点在主轴上的投影就是数据的<strong class="la jk"> <em class="lu">主成分</em> </strong>。</p><p id="3ccf" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们可以用一种叫做<em class="lu">双标图</em>的散点图来表示。每一个点都用它在主成分上的得分来表示。</p><p id="2c4c" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">理解数据的降维是有帮助的。它还帮助我们发现主成分和原始变量之间的关系。</p><figure class="lw lx ly lz gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi mg"><img src="../Images/fec50c6792ad5e82ff08ad7e24811288.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4AAmfsJJmCjEUm5UDjXs7A.png"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk">Biplot showing data scores regarding principal components.</figcaption></figure><p id="9010" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们可以观察到年收入和支出这两个最重要的组成部分。</p><p id="e2e9" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><em class="lu">聚类时间到！</em></p><p id="99db" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">为了对数据进行聚类，我们需要确定如何判断两个数据点是否相似。邻近性度量表征了对象之间存在的相似性或不相似性。</p><p id="c691" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们可以选择确定两个点是否相似。所以如果值大，点就很相似。</p><p id="5ba4" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">或者选择确定它们是否不同。值小的话，点也差不多。这就是我们所说的“距离”。</p><p id="9b18" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">聚类算法可以使用各种距离:曼哈顿距离、闵可夫斯基距离、欧几里德距离等等。</p><p id="9d1d" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">还记得你在学校或者大学学的计算两点间的直线距离吗？你用的是欧几里德距离。</p><p id="fc54" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">它是两个向量的相应元素之间的平方差之和的平方根。欧几里德距离的公式如下:</p><figure class="lw lx ly lz gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi na"><img src="../Images/908896a304ee8360f3f7466e624a36fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*E-SPCam4fEsEIBAvb5f8Qw.png"/></div></div></figure><p id="b722" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">其中 x 和 y 是两个向量。或者用 Python 编码:</p><figure class="lw lx ly lz gt iv"><div class="bz fp l di"><div class="me mf l"/></div></figure><p id="b283" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">K-means 通常使用欧几里德距离来确定两个点的相似(或不相似)程度。</p><p id="4e43" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">K-means 的过程简单明了。在开始模型之前，我们需要确定我们想要的集群数量。</p><p id="335a" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">不同数量的聚类会导致完全不同的结果。</p><p id="e35c" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">有几种直接的方法可以实现这一点。其中，我们找到了<em class="lu">肘</em>和<em class="lu">剪影</em>的方法。</p><p id="9b07" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们将使用肘法。</p><p id="c23f" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">请记住，聚类的目的是定义这样的聚类，其中的点彼此之间的相似性大于与其他聚类中的点的相似性。</p><p id="7862" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">为此，我们将考虑总的类内变异(或总的类内平方和(WSS))。我们会尽量减少。</p><p id="8f96" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">肘方法关注的是总 WSS 如何随着星团数量的变化而变化。</p><p id="f780" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">为此，我们将计算一系列不同 k 值的 k 均值。然后，我们计算总 WSS。我们绘制了 WSS 对集群数量的曲线。</p><p id="64f7" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">最后，我们定位图的拐点。这个点被认为是适当的集群数量。</p><p id="fcdc" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">为什么？因为如果我们继续增加聚类，WSS 不会提高，但我们将点聚集在一起的能力会下降。</p><figure class="lw lx ly lz gt iv"><div class="bz fp l di"><div class="me mf l"/></div></figure><figure class="lw lx ly lz gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nb"><img src="../Images/cf3ad4654e366f776fbeda73df7213da.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZmaNgePj3GP3dNk8CtZxFg.png"/></div></div></figure><p id="738e" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">查看该图，我们将选择 5 个集群。</p><p id="8e3c" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们忘记说了！K-means 中的<em class="lu"> K </em>是指聚类数。在我们的例子中，是 5。</p><p id="e433" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><a class="ae jg" href="http://www.vlfeat.org/api/kmeans-fundamentals.html" rel="noopener ugc nofollow" target="_blank"> k-means 聚类</a>是如何工作的？主要思想是选择 k 个中心，每个聚类一个。有几种方法可以初始化这些中心。我们可以随机进行，通过我们认为是中心的某些点，或者以一种巧妙的方式放置它们(例如，彼此尽可能远离)。</p><p id="2230" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">第一次放质心的位置很重要吗？是的，非常重要。不同的初始化质心会导致不同的结果。</p><p id="82d7" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">然后，我们计算每个点和聚类中心之间的欧氏距离。我们将这些点分配到距离最小的聚类中心。</p><p id="3468" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">之后，我们重新计算新的聚类中心。我们选择位于每个聚类中间的点作为新的中心。</p><p id="4cf6" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们重新开始，计算距离，分配到集群，计算新的中心。我们什么时候停止？当中心不再移动时。</p><p id="e7df" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们看看 Python 的实现:</p><figure class="lw lx ly lz gt iv"><div class="bz fp l di"><div class="me mf l"/></div></figure><p id="54a0" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在，让我们看看我们的集群是什么样子的:</p><figure class="lw lx ly lz gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nc"><img src="../Images/9f257247d0a548277106fc5e9f2d2bc5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SHycucKcL3tVWojCE9aN4w.png"/></div></div></figure><p id="096a" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">回到我们最初的情况。我们想了解我们的顾客。分割它们。所以我们可以为他们提供合适的产品。</p><p id="a797" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">每个聚类的中心点与该细分市场的平均客户<em class="lu">相匹配。</em></p><figure class="lw lx ly lz gt iv"><div class="bz fp l di"><div class="me mf l"/></div></figure><figure class="lw lx ly lz gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nd"><img src="../Images/c3a36eccecf07d914701f4d1b97c797f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uGZH7VWOO_NhssnZtMn3UA.png"/></div></div></figure><p id="cfa3" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">男性或女性似乎没有任何影响(他们在 0.5 左右。记住这是一个二进制变量)。</p><p id="c4ad" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">最重要的特征似乎是<code class="fe ma mb mc md b">Annual Income</code>和<code class="fe ma mb mc md b">Spending score</code>。</p><p id="c760" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们有收入较低但支出在同一范围内的人——第 0 部分。收入高且花钱多的人——第一部分。收入中等但消费水平相同的客户——细分市场 2。</p><p id="839f" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">然后，我们有收入很高的客户，但他们的支出最多，这就是细分市场 4。最后，收入少但消费高的人——第五部分。</p><p id="c2d6" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">最后一个音符。想象一下，明天我们有了一个新成员。我们想知道那个人属于哪一部分。</p><p id="d045" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">没问题！我们可以预测这一点:</p><figure class="lw lx ly lz gt iv"><div class="bz fp l di"><div class="me mf l"/></div></figure><figure class="lw lx ly lz gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ne"><img src="../Images/2b0255f2e5b348c37636c5fb0c698112.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Mt5Faq2mQmfplCcn8oXtQQ.png"/></div></div></figure><p id="f15a" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在，您已经准备好开展营销活动了！</p><p id="f28f" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><em class="lu"> →查看我的</em> <a class="ae jg" href="https://github.com/ugis22/clustering_analysis" rel="noopener ugc nofollow" target="_blank"> <em class="lu"> GitHub 库</em> </a> <em class="lu">观看完整代码。← </em></p></div></div>    
</body>
</html>