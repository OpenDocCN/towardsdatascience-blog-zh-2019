<html>
<head>
<title>5 smart Python NumPy functions</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">5 个智能 Python NumPy 函数</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/5-smart-python-numpy-functions-dfd1072d2cb4?source=collection_archive---------10-----------------------#2019-10-21">https://towardsdatascience.com/5-smart-python-numpy-functions-dfd1072d2cb4?source=collection_archive---------10-----------------------#2019-10-21</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/2113c07d2f2468315d143f721c852461.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*H58dY25CrlMUnf_EBH7REA.png"/></div></div></figure><div class=""/><div class=""><h2 id="20c2" class="pw-subtitle-paragraph kb jd je bd b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks dk translated">简洁编程的优雅 NumPy 函数</h2></div><p id="3d58" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">在机器学习和数据科学项目的日常数据处理中，我们会遇到独特的情况，这些情况需要样板代码来解决问题。随着时间的推移，其中一些被转换成由核心语言或软件包本身根据社区的需要和使用提供的基本特性。在这里，我分享 5 个优雅的 python Numpy 函数，它们可以用于高效简洁的数据操作。</p><h1 id="4a12" class="lp lq je bd lr ls lt lu lv lw lx ly lz kk ma kl mb kn mc ko md kq me kr mf mg bi translated">1)在整形中使用-1</h1><p id="802f" class="pw-post-body-paragraph kt ku je kv b kw mh kf ky kz mi ki lb lc mj le lf lg mk li lj lk ml lm ln lo im bi translated">Numpy 允许我们重塑一个矩阵，只要新的形状与原来的形状兼容。这个新形状的一个有趣的方面是，我们可以给出一个形状参数作为<strong class="kv jf"> -1 </strong>。这仅仅意味着它是一个未知的维度，我们希望 Numpy 能够解决它。Numpy 将通过查看<strong class="kv jf"><em class="mm">‘数组的长度和剩余维度’</em></strong>并确保它满足上述标准来确定这一点。现在让我们看一个例子。</p><figure class="mo mp mq mr gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi mn"><img src="../Images/bd4007de6c0ceddd8d613f049380af6f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6KZ6m0JaRTnBjmnjwJaO-w.png"/></div></div><figcaption class="ms mt gj gh gi mu mv bd b be z dk">Pictorial representation of different reshape with one dimension as -1</figcaption></figure><pre class="mo mp mq mr gt mw mx my mz aw na bi"><span id="c932" class="nb lq je mx b gy nc nd l ne nf">a = np.array([[1, 2, 3, 4],<br/>              [5, 6, 7, 8]])<br/>a.shape<br/>(2, 4)</span></pre><p id="dae0" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">假设我们给行 1，给列-1，那么 Numpy 将能够找到列 8。</p><pre class="mo mp mq mr gt mw mx my mz aw na bi"><span id="aa8f" class="nb lq je mx b gy nc nd l ne nf">a.reshape(1,-1)<br/>array([[1, 2, 3, 4, 5, 6, 7, 8]])</span></pre><p id="e8a9" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">假设我们给行-1，给列 1，那么 Numpy 将能够找到行 8。</p><pre class="mo mp mq mr gt mw mx my mz aw na bi"><span id="d61c" class="nb lq je mx b gy nc nd l ne nf">a.reshape(-1,1)<br/>array([[1],<br/>       [2],<br/>       [3],<br/>       [4],<br/>       [5],<br/>       [6],<br/>       [7],<br/>       [8]])</span></pre><p id="d586" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">类似地，下面是可能的。</p><pre class="mo mp mq mr gt mw mx my mz aw na bi"><span id="9324" class="nb lq je mx b gy nc nd l ne nf">a.reshape(-1,4)<br/>array([[1, 2, 3, 4],<br/>       [5, 6, 7, 8]])</span><span id="cda5" class="nb lq je mx b gy ng nd l ne nf">a.reshape(-1,2)<br/>array([[1, 2],<br/>       [3, 4],<br/>       [5, 6],<br/>       [7, 8]])</span><span id="2500" class="nb lq je mx b gy ng nd l ne nf">a.reshape(2,-1)<br/>array([[1, 2, 3, 4],<br/>       [5, 6, 7, 8]])</span><span id="3d5f" class="nb lq je mx b gy ng nd l ne nf">a.reshape(4,-1)<br/>array([[1, 2],<br/>       [3, 4],<br/>       [5, 6],<br/>       [7, 8]])</span></pre><p id="05e9" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">这也适用于任何更高级张量整形，但是只能给出一个维度-1。</p><pre class="mo mp mq mr gt mw mx my mz aw na bi"><span id="1450" class="nb lq je mx b gy nc nd l ne nf">a.reshape(2,2,-1)<br/>array([[[1, 2],<br/>        [3, 4]],</span><span id="627f" class="nb lq je mx b gy ng nd l ne nf">[[5, 6],<br/>        [7, 8]]])</span><span id="5d8b" class="nb lq je mx b gy ng nd l ne nf">a.reshape(2,-1,1)<br/>array([[[1],<br/>        [2],<br/>        [3],<br/>        [4]],</span><span id="affb" class="nb lq je mx b gy ng nd l ne nf">[[5],<br/>        [6],<br/>        [7],<br/>        [8]]])</span></pre><p id="ecb1" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">如果我们试图重塑一个不兼容的形状或一个以上的未知形状，将会出现一个错误信息。</p><pre class="mo mp mq mr gt mw mx my mz aw na bi"><span id="9aeb" class="nb lq je mx b gy nc nd l ne nf">a.reshape(-1,-1)<br/><strong class="mx jf">ValueError</strong>: can only specify one unknown dimension</span><span id="d089" class="nb lq je mx b gy ng nd l ne nf">a.reshape(3,-1)<br/><strong class="mx jf">ValueError</strong>: cannot reshape array of size 8 into shape (3,newaxis)</span></pre><p id="e934" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">总而言之，当重塑数组时，新形状必须包含与旧形状相同数量的元素，这意味着两个形状的尺寸的<strong class="kv jf">乘积必须等于</strong>。当使用-1 时，对应于-1 的维数将是原始数组的维数的乘积除以赋予<code class="fe nh ni nj mx b">reshape</code>的维数的乘积，以保持相同的元素数量。</p><h1 id="8fe9" class="lp lq je bd lr ls lt lu lv lw lx ly lz kk ma kl mb kn mc ko md kq me kr mf mg bi translated">2) AArgpartition:在数组中找到 N 个最大值</h1><figure class="mo mp mq mr gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nk"><img src="../Images/140aa278f06dff74de8369509118d619.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*E3YGkVZ8nwHBJeNEl_26Sw.png"/></div></div></figure><p id="39fa" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">Numpy 有一个名为<strong class="kv jf"> argpartition </strong>的函数，它可以高效地找到最大的 N 值索引并依次找到 N 个值。它给出索引，然后你可以排序，如果你需要排序的值。</p><pre class="mo mp mq mr gt mw mx my mz aw na bi"><span id="987b" class="nb lq je mx b gy nc nd l ne nf">a = np.array([10, 7, 4, 3, 2, 2, 5, 9, 0, 4, 6, 0])</span><span id="1a48" class="nb lq je mx b gy ng nd l ne nf">index = <strong class="mx jf">np.argpartition</strong>(a, -5)[-5:]<br/>index<br/>array([ 6,  1, 10,  7,  0], dtype=int64)</span><span id="a06c" class="nb lq je mx b gy ng nd l ne nf">np.sort(a[index])<br/>array([ 5,  6,  7,  9, 10])</span></pre><h1 id="b493" class="lp lq je bd lr ls lt lu lv lw lx ly lz kk ma kl mb kn mc ko md kq me kr mf mg bi translated">3) Clip:如何将数组中的值保持在一个区间内</h1><p id="5ce5" class="pw-post-body-paragraph kt ku je kv b kw mh kf ky kz mi ki lb lc mj le lf lg mk li lj lk ml lm ln lo im bi translated">在许多数据问题或算法中(如强化学习中的 PPO ),我们需要将所有值保持在一个上限和下限内。Numpy 有一个名为 Clip 的内置函数可以用于此目的。Numpy <strong class="kv jf"> clip </strong> () <strong class="kv jf">函数</strong>用于<strong class="kv jf"> Clip </strong>(限制)数组中的值。给定一个区间，区间外的值被剪切到区间边缘。例如，如果指定了[-1，1]的间隔，则小于-1 的值变为-1，大于 1 的值变为 1。</p><figure class="mo mp mq mr gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nl"><img src="../Images/2a06e1c83fc89b4b60150b71fdae2b22.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FSSUJk_mypFQKt8pM-Wqfg.png"/></div></div><figcaption class="ms mt gj gh gi mu mv bd b be z dk">Clip example with min value 2 and maximum value 6</figcaption></figure><pre class="mo mp mq mr gt mw mx my mz aw na bi"><span id="5105" class="nb lq je mx b gy nc nd l ne nf"><strong class="mx jf">#Example-1</strong><br/>a = np.array([10, 7, 4, 3, 2, 2, 5, 9, 0, 4, 6, 0])<br/>print (<strong class="mx jf">np.clip</strong>(a,2,6))</span><span id="c573" class="nb lq je mx b gy ng nd l ne nf">[6 6 4 3 2 2 5 6 2 4 6 2]</span><span id="258f" class="nb lq je mx b gy ng nd l ne nf"><strong class="mx jf">#Example-2</strong><br/>a = np.array([10, -1, 4, -3, 2, 2, 5, 9, 0, 4, 6, 0])<br/>print (<strong class="mx jf">np.clip</strong>(a,2,5))</span><span id="dde6" class="nb lq je mx b gy ng nd l ne nf">[5 2 4 2 2 2 5 5 2 4 5 2]</span></pre><h1 id="4c03" class="lp lq je bd lr ls lt lu lv lw lx ly lz kk ma kl mb kn mc ko md kq me kr mf mg bi translated">4)提取:根据条件从数组中提取特定元素</h1><p id="1d51" class="pw-post-body-paragraph kt ku je kv b kw mh kf ky kz mi ki lb lc mj le lf lg mk li lj lk ml lm ln lo im bi translated">我们可以使用 Numpy <strong class="kv jf"> extract() </strong>函数从符合条件的数组中提取特定的元素。</p><figure class="mo mp mq mr gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nm"><img src="../Images/21f98ffb90390a9f6d8730a4c31d7c07.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GPJUX8YnFILrKD2GPDWfCA.png"/></div></div></figure><pre class="mo mp mq mr gt mw mx my mz aw na bi"><span id="11d5" class="nb lq je mx b gy nc nd l ne nf">arr <strong class="mx jf">=</strong> np.arange(10)<br/>arr</span><span id="75c8" class="nb lq je mx b gy ng nd l ne nf">array([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])</span><span id="8bbd" class="nb lq je mx b gy ng nd l ne nf"># Define the codition, here we take MOD 3 if zero<br/>condition <strong class="mx jf">=</strong> np.mod(arr, 3)<strong class="mx jf">==</strong>0<br/>condition</span><span id="5d3e" class="nb lq je mx b gy ng nd l ne nf">array([ True, False, False,  True, False, False,  True, False, False,True])</span><span id="9eb1" class="nb lq je mx b gy ng nd l ne nf"><strong class="mx jf">np.extract</strong>(condition, arr)<br/>array([0, 3, 6, 9])</span></pre><p id="bbfe" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">类似地，如果需要，我们可以使用 AND 和 OR 组合的直接条件</p><pre class="mo mp mq mr gt mw mx my mz aw na bi"><span id="fa1d" class="nb lq je mx b gy nc nd l ne nf"><strong class="mx jf">np.extract</strong>((<strong class="mx jf">(arr &gt; 2) &amp; (arr &lt; 8)</strong>), arr)</span><span id="b831" class="nb lq je mx b gy ng nd l ne nf">array([3, 4, 5, 6, 7])</span></pre><h1 id="879a" class="lp lq je bd lr ls lt lu lv lw lx ly lz kk ma kl mb kn mc ko md kq me kr mf mg bi translated">5) setdiff1d:如何在一个数组中找到与另一个数组相比较的唯一值</h1><p id="109d" class="pw-post-body-paragraph kt ku je kv b kw mh kf ky kz mi ki lb lc mj le lf lg mk li lj lk ml lm ln lo im bi translated">返回一个数组中不存在于另一个数组中的唯一值。这相当于两个数组的差异。</p><figure class="mo mp mq mr gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nm"><img src="../Images/80d06bee6ca5176ba5bb4ea2390d2784.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rj3UuZJd1-SX4b1AtOJ5Rg.png"/></div></div></figure><pre class="mo mp mq mr gt mw mx my mz aw na bi"><span id="df6d" class="nb lq je mx b gy nc nd l ne nf">a = np.array([1, 2, 3, 4, 5, 6, 7, 8, 9])<br/>b = np.array([3,4,7,6,7,8,11,12,14])<br/>c = <strong class="mx jf">np.setdiff1d</strong>(a,b)<br/>c</span><span id="48d7" class="nb lq je mx b gy ng nd l ne nf">array([1, 2, 5, 9])</span></pre><h1 id="98d9" class="lp lq je bd lr ls lt lu lv lw lx ly lz kk ma kl mb kn mc ko md kq me kr mf mg bi translated">最后注意:</h1><p id="68b9" class="pw-post-body-paragraph kt ku je kv b kw mh kf ky kz mi ki lb lc mj le lf lg mk li lj lk ml lm ln lo im bi translated">这是 5 个 Numpy 函数，社区并不经常使用，但是它们非常简洁优雅。在我看来，只要有类似的情况，我们就应该使用它们，因为它们不仅提供了更少的代码，而且是实现复杂问题解决方案的一种聪明方式。</p><h2 id="48f8" class="nb lq je bd lr nn no dn lv np nq dp lz lc nr ns mb lg nt nu md lk nv nw mf nx bi translated">感谢阅读。可以联系我@ <a class="ae ny" href="http://www.linkedin.com/in/baijayantaroy" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>。</h2></div><div class="ab cl nz oa hx ob" role="separator"><span class="oc bw bk od oe of"/><span class="oc bw bk od oe of"/><span class="oc bw bk od oe"/></div><div class="im in io ip iq"><p id="4668" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated"><em class="mm">每月只需 5 美元，就可以无限制地获取最鼓舞人心的内容……点击下面的链接，成为媒体会员，支持我的写作。谢谢大家！<br/></em><a class="ae ny" href="https://baijayanta.medium.com/membership" rel="noopener"><strong class="kv jf"><em class="mm"/></strong></a></p></div></div>    
</body>
</html>