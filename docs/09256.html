<html>
<head>
<title>Model Averaging: A Robust Way to Deal with Model Uncertainty</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">模型平均:一种处理模型不确定性的稳健方法</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/model-averaging-a-robust-way-to-deal-with-model-uncertainty-a604c4ab2050?source=collection_archive---------10-----------------------#2019-12-07">https://towardsdatascience.com/model-averaging-a-robust-way-to-deal-with-model-uncertainty-a604c4ab2050?source=collection_archive---------10-----------------------#2019-12-07</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="5cc3" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">模型平均的介绍，使机器学习预测对模型条件较差的数据不太敏感。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/bd5acd8ffe956f7364130424753b6b65.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Gd2Qhj5imhKMxvf_MJhARg.jpeg"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Everyone is working individually, then through consensus amongst them, they are coming up with better work. Photo by <a class="ae ky" href="https://unsplash.com/@youxventures?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">You X Ventures</a> on <a class="ae ky" href="https://unsplash.com/s/photos/working-together?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="94d5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在我们的机器学习模型中，我们试图根据描述符值来映射预测器，以模拟生成该值的底层函数。然而，如果我们的数据不能很好地代表数据的真实分布，那么我们的模型将不会像我们希望的那样有效，这是由于对不良数据的限制。例如，一个简单的线性回归模型的参数(如斜率和截距)取决于我们用来拟合模型的数据。因此，我们的模型的通用性很差。</p><p id="6dc3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当模型的不确定性很高并且会干扰预测的质量时，如何建立稳健的预测模型？解决这个问题的一个方法是在许多模型之间达成共识。这个想法是，当我们试图建立预测模型时，一些模型将正好适合预测点，而一些将高估或低估。通过对所有模型进行平均，我们可以消除高估和低估。特别是在大量模型的限制下，我们可以应用中心趋势定律，该定律指出，随着数值越来越多，概率分布接近中心平均值。因此，如果我们可以建立许多模型，并对它们取平均值，我们可以预期最终的预测比单个的预测更稳健。在本练习中，我们将看到这种近似有多好。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><blockquote class="mc md me"><p id="1120" class="kz la mf lb b lc ld ju le lf lg jx lh mg lj lk ll mh ln lo lp mi lr ls lt lu im bi translated">整体大于各部分之和。</p></blockquote></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><p id="b668" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">像往常一样，我们首先加载数据。在这个练习中，我们将使用<em class="mf"> sklearn.datasets. </em>中的<strong class="lb iu">波士顿住房数据</strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mj"><img src="../Images/39ea062c9978f05dccb86dacf6822f34.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gHb0jfsVWoPo84O7fYWYvw.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Loading the Boston data and splitting it into training and testing dataframe</figcaption></figure><p id="9f5c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，为了实现模型平均，我们将使用 RMSE(均方根误差)作为模型拟合度。然后我们将使用以下公式对它们进行平均，</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mk"><img src="../Images/efc288786d17097ce3699cebe6dbe2ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FG1jKV5I-5XqIGlV8ktHHQ.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Model averaging formula</figcaption></figure><p id="c04a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这里，我们将用模型<em class="mf"> i </em>的平方 RMSE 的倒数来加权模型<em class="mf"> i </em>的预测 y。现在，让我们写一个类来简化我们的工作，</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ml"><img src="../Images/30c9c6d7b94e03bf8c7f162568bee0cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0MB_odNS5dOQMMvj4mExLg.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Model averager class</figcaption></figure><p id="4914" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在上面的代码中，我们可以使用任何估计器，比如<em class="mf"> KernelRidge </em>等等，但是我使用了简单的<em class="mf"> LinearRegressor </em>，因为它在计算上更便宜。此外，我使用样本方差来计算 RMSE，但如果我们想要近似总体方差，我们可以使用留一估计，这也是计算密集型的。现在，我们有一个代码来完成模型平均。让我们在数据上实现它，</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mj"><img src="../Images/d55c031d5e49f59db25bc3274275a208.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZBWlXe57jk9_ZDTOAqw09w.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Compiling model data and then making a prediction on test data</figcaption></figure><p id="616b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这里，我们首先建立所有的模型，然后根据我们的测试数据进行预测。现在，让我们看看我们的模型平均性能有多好:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mm"><img src="../Images/51a3030f80ba661f0274dc848c8ebb5d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JJJ1hHvRICT8RzfJFZLZig.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Script to plot the histogram of the RMSE value of different models</figcaption></figure><p id="b24f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">运行这个脚本将产生下面的图，</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mn"><img src="../Images/44420f4ed7c354737ef46226e0ec56d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*69f_lexL6lXY7ePjmPCCvw.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Histogram of all the model RMSE and model averager RMSE</figcaption></figure><p id="be25" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以看到，我们的模型平均性能，正如预期的那样，位于所有其他模型的中间。有不同的方法来提高模型平均器的性能，例如我使用的方案可以改进，我们可以对几个最好的模型进行平均，而不是对所有的模型进行平均(我打算在以后的文章中讨论这些)。虽然性能似乎不如我们所希望的那样令人兴奋，但是这种方案对于模型的不确定性将是非常鲁棒的(以可以忽略的精度为代价)。</p></div></div>    
</body>
</html>