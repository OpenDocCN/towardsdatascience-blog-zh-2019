<html>
<head>
<title>How can Transfer Learning be a blessing in deep learning models?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">迁移学习如何成为深度学习模型中的幸事？</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-transfer-learning-can-be-a-blessing-in-deep-learning-models-fbc576dc42?source=collection_archive---------20-----------------------#2019-07-19">https://towardsdatascience.com/how-transfer-learning-can-be-a-blessing-in-deep-learning-models-fbc576dc42?source=collection_archive---------20-----------------------#2019-07-19</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="ca55" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">转移学习要点</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/3f3b3b7bb4844a425d3eb30c55961fec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*lUyfhgm9mzEmtXWfxbp17w.gif"/></div></div></figure><p id="bc62" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">迁移学习是深度学习领域的一大进步，它不仅允许我们将高性能模型用于各种任务，还减少了对越来越多数据的依赖。在这篇文章中，我将讨论什么是迁移学习，以及我们如何利用它来解决手头的问题。笔记本链接如下:</p><div class="lq lr gp gr ls lt"><a href="https://colab.research.google.com/drive/18GACFV395iu9hS47-wkKW7LSdkmOyE0P" rel="noopener  ugc nofollow" target="_blank"><div class="lu ab fo"><div class="lv ab lw cl cj lx"><h2 class="bd iu gy z fp ly fr fs lz fu fw is bi translated">谷歌联合实验室</h2><div class="ma l"><h3 class="bd b gy z fp ly fr fs lz fu fw dk translated">编辑描述</h3></div><div class="mb l"><p class="bd b dl z fp ly fr fs lz fu fw dk translated">colab.research.google.com</p></div></div><div class="mc l"><div class="md l me mf mg mc mh ks lt"/></div></div></a></div><h1 id="8298" class="mi mj it bd mk ml mm mn mo mp mq mr ms jz mt ka mu kc mv kd mw kf mx kg my mz bi translated">什么是迁移学习？</h1><p id="c8c2" class="pw-post-body-paragraph ku kv it kw b kx na ju kz la nb jx lc ld nc lf lg lh nd lj lk ll ne ln lo lp im bi translated">迁移学习是一种技术，在这种技术中，针对某项任务训练的模型可用于根据其学习(权重)对另一项任务进行预测。</p><blockquote class="nf ng nh"><p id="3e00" class="ku kv ni kw b kx ky ju kz la lb jx lc nj le lf lg nk li lj lk nl lm ln lo lp im bi translated">让我们以理解三角形的卷积神经网络为例，尝试更好地理解它。让我们考虑模型有两层。在第一层，模型将检测边缘。在第二层，模型将结合这些边来理解三角形。</p><p id="e95f" class="ku kv ni kw b kx ky ju kz la lb jx lc nj le lf lg nk li lj lk nl lm ln lo lp im bi translated">让我们考虑另一个 CNN 模型，它必须被训练来检测矩形。如果我们可以使用以前的 CNN 模型的知识来理解边缘，并只改变最后一层，这样在训练期间，它现在可以检测矩形而不是三角形。这就是迁移学习。使用已经训练好的模型对另一项任务进行预测。</p></blockquote><h1 id="dd63" class="mi mj it bd mk ml mm mn mo mp mq mr ms jz mt ka mu kc mv kd mw kf mx kg my mz bi translated">为什么要转学？</h1><p id="54b6" class="pw-post-body-paragraph ku kv it kw b kx na ju kz la nb jx lc ld nc lf lg lh nd lj lk ll ne ln lo lp im bi translated">迁移学习是一个非常重要的概念，在处理许多深度学习模型时非常有用。它带来的好处包括:</p><ol class=""><li id="8628" class="nm nn it kw b kx ky la lb ld no lh np ll nq lp nr ns nt nu bi translated"><strong class="kw iu">使用专家模型:</strong>利用迁移学习，我们只要冻结参数，改变输出层，就可以直接使用专家精心高效创建的模型。</li><li id="75b3" class="nm nn it kw b kx nv la nw ld nx lh ny ll nz lp nr ns nt nu bi translated"><strong class="kw iu">没有模型结构开发:</strong>由于我们使用的是已经存在的模型，我们不再需要考虑要包含的层，应该分配什么参数等等。</li><li id="8b51" class="nm nn it kw b kx nv la nw ld nx lh ny ll nz lp nr ns nt nu bi translated"><strong class="kw iu">更高更好的表现:</strong>由于迁移学习中使用的模型是精心设计的，它们在其他类似的任务中也表现得更好。</li></ol><p id="c658" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">让我们试着用迁移学习来解决猫和狗的问题。</p><h1 id="fd0d" class="mi mj it bd mk ml mm mn mo mp mq mr ms jz mt ka mu kc mv kd mw kf mx kg my mz bi translated">猫和狗的问题解决方案</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oa"><img src="../Images/0d28dc9262d2e50288c2dd198711ff31.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*3fMN6HlfsbdITlMt"/></div></div><figcaption class="ob oc gj gh gi od oe bd b be z dk">Photo by <a class="ae of" href="https://unsplash.com/@anshaaleena?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Anusha Barwa</a> on <a class="ae of" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h2 id="d550" class="og mj it bd mk oh oi dn mo oj ok dp ms ld ol om mu lh on oo mw ll op oq my or bi translated">问题描述</h2><p id="f654" class="pw-post-body-paragraph ku kv it kw b kx na ju kz la nb jx lc ld nc lf lg lh nd lj lk ll ne ln lo lp im bi translated">我们有一组猫和狗的图像。我们希望使用深度学习模型来区分这两个类别。</p><h2 id="3703" class="og mj it bd mk oh oi dn mo oj ok dp ms ld ol om mu lh on oo mw ll op oq my or bi translated">方法</h2><p id="5953" class="pw-post-body-paragraph ku kv it kw b kx na ju kz la nb jx lc ld nc lf lg lh nd lj lk ll ne ln lo lp im bi translated">我将首先自己创建一个 CNN 模型，并测量它的性能。然后，我将在一个流行的模型 MobileNet 上使用迁移学习来训练分类。我将把每个模型的图像大小设置为统一的 224x224，并对提供给每个模型的数据进行数据扩充。</p><h2 id="89ee" class="og mj it bd mk oh oi dn mo oj ok dp ms ld ol om mu lh on oo mw ll op oq my or bi translated">培养</h2><p id="079d" class="pw-post-body-paragraph ku kv it kw b kx na ju kz la nb jx lc ld nc lf lg lh nd lj lk ll ne ln lo lp im bi translated">由于这个问题是一个 2 类分类问题，我将用<code class="fe os ot ou ov b">adam</code>优化器、<code class="fe os ot ou ov b">sparse_categorical_crossentropy</code>损失函数和度量标准<code class="fe os ot ou ov b">accuracy</code>来编译每个模型。</p><p id="4844" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><strong class="kw iu">训练定制模型<br/> </strong>我创建了一个 CNN 模型，有 4 个<code class="fe os ot ou ov b">Conv2D</code>层，分别有 32、64、128、256 个节点和<code class="fe os ot ou ov b">relu</code>激活函数。这些卷积层中的每一层都跟随着一个<code class="fe os ot ou ov b">MaxPooling2D</code>层。接下来，我添加一个<code class="fe os ot ou ov b">Dropout</code>层，防止过度渲染。我添加了一个<code class="fe os ot ou ov b">Flatten</code>层，这样我可以把它传递给 256 节点<code class="fe os ot ou ov b">Dense</code>层。最后一层是一个 2 节点<code class="fe os ot ou ov b">Dense</code>层，带有<code class="fe os ot ou ov b">softmax</code>激活函数，给出每一类的概率。当我从头开始训练模型时，我将运行它 100 个时期。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ow"><img src="../Images/9e9c8c12483eb2ee2ea02fb2d20e0caa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1302/format:webp/1*yx-QzlMvYPkY5oYYQryItQ.png"/></div></div><figcaption class="ob oc gj gh gi od oe bd b be z dk">Custom CNN Model</figcaption></figure><p id="2dcc" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><strong class="kw iu">用迁移学习训练 MobileNet 模型<br/> </strong>我会从 Tensorflow Hub 下载 MobileNet 模型。然后我会冻结它，这样模型内部的重量就不会改变。我将添加一个有 2 个节点的密集层(两个类——猫和狗)和<code class="fe os ot ou ov b">softmax</code>激活函数。由于这是一个预训练的模型，我将只运行 5 个时期。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ox"><img src="../Images/220cffbbd646618c222cda4faacb9bed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1300/format:webp/1*OcUDsbC7OkedMBzRCZnNeA.png"/></div><figcaption class="ob oc gj gh gi od oe bd b be z dk">Transfer Learning model</figcaption></figure><h2 id="45fa" class="og mj it bd mk oh oi dn mo oj ok dp ms ld ol om mu lh on oo mw ll op oq my or bi translated">结果比较</h2><p id="dba5" class="pw-post-body-paragraph ku kv it kw b kx na ju kz la nb jx lc ld nc lf lg lh nd lj lk ll ne ln lo lp im bi translated">让我们来看看这两种模型的精度和损耗曲线。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oy"><img src="../Images/7c98c3313e1a6d69277e9df6b2d6b311.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Z3W8Y2W7hVWzfxBIs6_nQg.png"/></div></div><figcaption class="ob oc gj gh gi od oe bd b be z dk">Custom CNN model training curves</figcaption></figure><p id="4e9b" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">对于定制的 CNN 模型，在 50 个时期之后，该模型实现了 76%的验证准确度。然而，即使准确性仍在提高，训练和验证准确性之间的差异正在扩大，这表明它开始过度拟合。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oz"><img src="../Images/37556fa42cf6070ead12a9a7237c2625.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IJaWivdyNwAHOGpVxp7ijg.png"/></div></div><figcaption class="ob oc gj gh gi od oe bd b be z dk">Transfer Learning model training curves</figcaption></figure><p id="029c" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">就在 5 个时期之后，MobileNet 迁移学习模型实现了 96%的验证准确性。</p><blockquote class="pa"><p id="421d" class="pb pc it bd pd pe pf pg ph pi pj lp dk translated">迁移学习模型的准确性比定制模型高出 20%。这也减少了训练时间。</p></blockquote><p id="c510" class="pw-post-body-paragraph ku kv it kw b kx pk ju kz la pl jx lc ld pm lf lg lh pn lj lk ll po ln lo lp im bi translated">从使用现有模型的过程，到在数据集上训练它，都是如此简单和容易。这对任何人来说都是一个巨大的机会，只要拿起一个经过训练的模型，用它来解决他们的问题。</p><h1 id="f04e" class="mi mj it bd mk ml mm mn mo mp mq mr ms jz mt ka mu kc mv kd mw kf mx kg my mz bi translated">结论</h1><p id="39b2" class="pw-post-body-paragraph ku kv it kw b kx na ju kz la nb jx lc ld nc lf lg lh nd lj lk ll ne ln lo lp im bi translated">正如我们所看到的，迁移学习模型与定制 CNN 模型相比表现得非常好，并且也具有非常少的时期。很明显，迁移学习是一种非常特殊和强大的技术，可以创建深度学习模型，并帮助解决现有模型的多个问题。</p></div><div class="ab cl pp pq hx pr" role="separator"><span class="ps bw bk pt pu pv"/><span class="ps bw bk pt pu pv"/><span class="ps bw bk pt pu"/></div><div class="im in io ip iq"><p id="7a7f" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">查看其他文章:</p><div class="lq lr gp gr ls lt"><a rel="noopener follow" target="_blank" href="/google-colab-your-python-workspace-on-cloud-c3aed424de0d"><div class="lu ab fo"><div class="lv ab lw cl cj lx"><h2 class="bd iu gy z fp ly fr fs lz fu fw is bi translated">Google Colab——您在云上的 Python 工作空间</h2><div class="ma l"><h3 class="bd b gy z fp ly fr fs lz fu fw dk translated">了解 Google Colab</h3></div><div class="mb l"><p class="bd b dl z fp ly fr fs lz fu fw dk translated">towardsdatascience.com</p></div></div><div class="mc l"><div class="pw l me mf mg mc mh ks lt"/></div></div></a></div><div class="lq lr gp gr ls lt"><a rel="noopener follow" target="_blank" href="/create-a-complete-machine-learning-web-application-using-react-and-flask-859340bddb33"><div class="lu ab fo"><div class="lv ab lw cl cj lx"><h2 class="bd iu gy z fp ly fr fs lz fu fw is bi translated">使用 React 和 Flask 创建一个完整的机器学习 web 应用程序</h2><div class="ma l"><h3 class="bd b gy z fp ly fr fs lz fu fw dk translated">用 UI 和后端构建完整的 ML 应用程序</h3></div><div class="mb l"><p class="bd b dl z fp ly fr fs lz fu fw dk translated">towardsdatascience.com</p></div></div><div class="mc l"><div class="px l me mf mg mc mh ks lt"/></div></div></a></div><div class="lq lr gp gr ls lt"><a rel="noopener follow" target="_blank" href="/using-deep-learning-to-save-lives-by-ensuring-drivers-attention-e9ab39c03d07"><div class="lu ab fo"><div class="lv ab lw cl cj lx"><h2 class="bd iu gy z fp ly fr fs lz fu fw is bi translated">使用深度学习通过确保驾驶员的注意力来拯救生命</h2><div class="ma l"><h3 class="bd b gy z fp ly fr fs lz fu fw dk translated">现实生活中的卷积神经网络</h3></div><div class="mb l"><p class="bd b dl z fp ly fr fs lz fu fw dk translated">towardsdatascience.com</p></div></div><div class="mc l"><div class="py l me mf mg mc mh ks lt"/></div></div></a></div><div class="lq lr gp gr ls lt"><a rel="noopener follow" target="_blank" href="/learning-artificial-neural-networks-by-predicting-visitor-purchase-intention-724ba2be7c29"><div class="lu ab fo"><div class="lv ab lw cl cj lx"><h2 class="bd iu gy z fp ly fr fs lz fu fw is bi translated">通过预测游客购买意向学习人工神经网络</h2><div class="ma l"><h3 class="bd b gy z fp ly fr fs lz fu fw dk translated">使用 Keras 和 Tensorflow 构建人工神经网络</h3></div><div class="mb l"><p class="bd b dl z fp ly fr fs lz fu fw dk translated">towardsdatascience.com</p></div></div><div class="mc l"><div class="pz l me mf mg mc mh ks lt"/></div></div></a></div><div class="lq lr gp gr ls lt"><a href="https://neptune.ai/blog/transfer-learning-guide-examples-for-images-and-text-in-keras" rel="noopener  ugc nofollow" target="_blank"><div class="lu ab fo"><div class="lv ab lw cl cj lx"><h2 class="bd iu gy z fp ly fr fs lz fu fw is bi translated">迁移学习指南:一个实用的教程与图像和文本的例子在 Keras …</h2><div class="ma l"><h3 class="bd b gy z fp ly fr fs lz fu fw dk translated">在大型数据集上训练一个神经网络可能需要数周时间。幸运的是，由于有了模型，这个时间可以缩短…</h3></div><div class="mb l"><p class="bd b dl z fp ly fr fs lz fu fw dk translated">海王星. ai</p></div></div><div class="mc l"><div class="qa l me mf mg mc mh ks lt"/></div></div></a></div></div><div class="ab cl pp pq hx pr" role="separator"><span class="ps bw bk pt pu pv"/><span class="ps bw bk pt pu pv"/><span class="ps bw bk pt pu"/></div><div class="im in io ip iq"><p id="9b28" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">感谢阅读！请分享你的想法、观点和建议。我很乐意收到你的来信。</p></div></div>    
</body>
</html>