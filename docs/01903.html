<html>
<head>
<title>March Madness — Analyze video to detect players, teams, and who attempted the basket</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">三月疯狂-分析视频以检测球员、球队和尝试投篮的人</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/march-madness-analyze-video-to-detect-players-teams-and-who-attempted-the-basket-8cad67745b88?source=collection_archive---------5-----------------------#2019-03-29">https://towardsdatascience.com/march-madness-analyze-video-to-detect-players-teams-and-who-attempted-the-basket-8cad67745b88?source=collection_archive---------5-----------------------#2019-03-29</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="75f1" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">用数据做很酷的事情！</h2></div><h1 id="3fd5" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">介绍</h1><p id="54cf" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">这是三月疯狂月！这是一个多么激动人心的赛季。作为数据科学家，让我们利用这个机会对篮球片段做一些分析。通过使用深度学习和 opencv，我们可以从视频剪辑中提取有趣的见解。见下面的例子 gif 的游戏 b/w UCF 和杜克大学，我们可以确定所有的球员+裁判，标签球员到球队的球衣颜色为基础。在博客的后面，我将展示我们如何识别哪个球员试图投篮。所有这些都可以实时完成。</p><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div class="gh gi lw"><img src="../Images/fe6b8611d567d1ffbfc3b2835896cd40.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*QVyHGpFxmDbwMISXOYNNAQ.gif"/></div><figcaption class="me mf gj gh gi mg mh bd b be z dk">Detecting players and teams</figcaption></figure><p id="7117" class="pw-post-body-paragraph la lb it lc b ld mi ju lf lg mj jx li lj mk ll lm ln ml lp lq lr mm lt lu lv im bi translated">你可以在我的<a class="ae mn" href="https://github.com/priya-dwivedi/Deep-Learning/blob/master/march_madness_team_shot/object_detection/March_Madness_Object_Detection.ipynb" rel="noopener ugc nofollow" target="_blank"> Github repo </a>上找到代码</p><p id="62bd" class="pw-post-body-paragraph la lb it lc b ld mi ju lf lg mj jx li lj mk ll lm ln ml lp lq lr mm lt lu lv im bi translated">那我们开始吧。</p><h1 id="8f50" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">检测玩家</h1><p id="069a" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">我已经使用了一个预训练的检测模型，如<a class="ae mn" href="https://arxiv.org/abs/1506.01497" rel="noopener ugc nofollow" target="_blank">更快的 RCNN </a>来检测球员。很容易从<a class="ae mn" href="https://github.com/tensorflow/models/tree/master/research/object_detection" rel="noopener ugc nofollow" target="_blank"> Tensorflow 对象检测 API </a>下载一个在 COCO 数据集上训练的更快的 RCNN 并测试它。API 将图像的每一帧作为输入，并在 80 个不同的类别中进行检测。如果你是 Tensorflow 对象检测的新手，想了解更多，请查看这个<a class="ae mn" rel="noopener" target="_blank" href="/is-google-tensorflow-object-detection-api-the-easiest-way-to-implement-image-recognition-a8bd1f500ea0">博客</a>。该模型在检测人方面做得相当好，但是由于人群中有大量的人，所以在该视频中有许多检测。参见下面的样品检测。我抑制了太大的检测，以更干净地分割出球员。您还可以在 API 中使用分数阈值来过滤掉低可信度检测。查看<a class="ae mn" href="https://github.com/priya-dwivedi/Deep-Learning/tree/master/march_madness_team_shot" rel="noopener ugc nofollow" target="_blank"> Github </a>上的代码，了解如何抑制分数低和多次错误检测的盒子的提示。</p><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="gh gi mo"><img src="../Images/b4a6db9a93cd755d077da8a0f5bfed5f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KkAZPEPkBNQYTXSFcXwEzA.png"/></div></div><figcaption class="me mf gj gh gi mg mh bd b be z dk">Detection output from Pretrained Tensorflow model</figcaption></figure><h1 id="666c" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">探测队</h1><p id="5ef5" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">现在有趣的部分来了。我们如何检测哪些球员是 UCF 对杜克大学？我们可以使用 OpenCV 来做到这一点。</p><p id="da88" class="pw-post-body-paragraph la lb it lc b ld mi ju lf lg mj jx li lj mk ll lm ln ml lp lq lr mm lt lu lv im bi translated">如果您不熟悉 OpenCV，请参阅下面的教程:</p><p id="7964" class="pw-post-body-paragraph la lb it lc b ld mi ju lf lg mj jx li lj mk ll lm ln ml lp lq lr mm lt lu lv im bi translated"><a class="ae mn" href="http://opencv-python-tutroals.readthedocs.io/en/latest/py_tutorials/py_tutorials.html" rel="noopener ugc nofollow" target="_blank"> OpenCV 教程</a></p><p id="2e09" class="pw-post-body-paragraph la lb it lc b ld mi ju lf lg mj jx li lj mk ll lm ln ml lp lq lr mm lt lu lv im bi translated">OpenCV 允许我们识别特定颜色的面具，我们可以用它来识别白人和黑人球员。主要步骤是:</p><ul class=""><li id="e8fe" class="mt mu it lc b ld mi lg mj lj mv ln mw lr mx lv my mz na nb bi translated">将图像从 BGR 转换到 HSV 色彩空间。</li><li id="bf6f" class="mt mu it lc b ld nc lg nd lj ne ln nf lr ng lv my mz na nb bi translated">在 HSV 空间中，指定白色和黑色的颜色范围。这需要一点实验，你可以在<a class="ae mn" href="https://github.com/priya-dwivedi/Deep-Learning/tree/master/march_madness_team_shot" rel="noopener ugc nofollow" target="_blank">笔记本</a>中想象不同阈值的影响。</li><li id="0e35" class="mt mu it lc b ld nc lg nd lj ne ln nf lr ng lv my mz na nb bi translated">使用 OpenCV 遮蔽(着色)阈值范围内的像素。</li><li id="5bc8" class="mt mu it lc b ld nc lg nd lj ne ln nf lr ng lv my mz na nb bi translated">OpenCV Bitwise_and 将不在蒙版中的任何像素涂成黑色</li></ul><p id="ee5a" class="pw-post-body-paragraph la lb it lc b ld mi ju lf lg mj jx li lj mk ll lm ln ml lp lq lr mm lt lu lv im bi translated">白色请参见下面的输出。它们被伪装成“粉红色”,背景中的其他东西都是黑色的</p><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="gh gi nh"><img src="../Images/ea443321fdb4d631cc72262e998d0fca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Z7gHGSguBy_nftQCyrOBXg.png"/></div></div><figcaption class="me mf gj gh gi mg mh bd b be z dk">Detecting white colour pixels</figcaption></figure><p id="95b4" class="pw-post-body-paragraph la lb it lc b ld mi ju lf lg mj jx li lj mk ll lm ln ml lp lq lr mm lt lu lv im bi translated">为了识别每个玩家的团队，我们从 tensorflow 对象检测中提取边界框，并计算边界框中非黑色像素的百分比，以确定该玩家的团队。</p><p id="4e7f" class="pw-post-body-paragraph la lb it lc b ld mi ju lf lg mj jx li lj mk ll lm ln ml lp lq lr mm lt lu lv im bi translated">整体代码工作得很好。然而，这是一个识别黑白球衣球员的硬编码逻辑。通过使用聚类来查找相似的玩家，可以使其更通用</p><h1 id="a31b" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">检测姿势和拍摄者</h1><p id="9386" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated"><a class="ae mn" href="https://github.com/CMU-Perceptual-Computing-Lab/openpose" rel="noopener ugc nofollow" target="_blank"> OpenPose </a>是一个实时多人姿势检测库。它可以检测图像中的人，并输出每个人的主要关节的关键点——每个人最多可以有 25 个关键点。代码是开源的。你必须按照自述文件中的建议安装<a class="ae mn" href="https://github.com/CMU-Perceptual-Computing-Lab/openpose/blob/master/doc/modules/python_module.md" rel="noopener ugc nofollow" target="_blank">这里</a>。安装后，你可以通过它运行图像，并获得场景中所有球员的关键点，如下所示。</p><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="gh gi ni"><img src="../Images/f69ebd503951f04a2527557d6e9a2278.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UGVfHo8m3uyMYonx383eXQ.jpeg"/></div></div><figcaption class="me mf gj gh gi mg mh bd b be z dk">Open pose output</figcaption></figure><p id="8e3a" class="pw-post-body-paragraph la lb it lc b ld mi ju lf lg mj jx li lj mk ll lm ln ml lp lq lr mm lt lu lv im bi translated">那么我们如何识别试图投篮的球员呢？</p><p id="99bf" class="pw-post-body-paragraph la lb it lc b ld mi ju lf lg mj jx li lj mk ll lm ln ml lp lq lr mm lt lu lv im bi translated">我们可以寻找手腕关键点在头顶的玩家。意味着举起双手。这可能表明像上面的场景一样准备射击，或者可能是防御性的。此外，球的坐标以及手腕关键点的坐标可用于识别哪个玩家举手将球靠近他们。</p><h1 id="682a" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">结论</h1><p id="ee75" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">深度学习通过链接不同的想法，使得进行真正酷的分析成为可能。有许多开源代码和预训练的模型，您可以使用这些数据开始学习。以上只是起点。其他可以做的很酷的事情包括:</p><ol class=""><li id="63e5" class="mt mu it lc b ld mi lg mj lj mv ln mw lr mx lv nj mz na nb bi translated">使用 OCR 读取比赛分数，让您的系统了解哪个队赢了</li><li id="4290" class="mt mu it lc b ld nc lg nd lj ne ln nf lr ng lv nj mz na nb bi translated">跟踪球以预测何时射门得分</li><li id="a9bb" class="mt mu it lc b ld nc lg nd lj ne ln nf lr ng lv nj mz na nb bi translated">跟踪玩家以获得每个玩家的统计数据</li><li id="f206" class="mt mu it lc b ld nc lg nd lj ne ln nf lr ng lv nj mz na nb bi translated">检测事件，如灌篮，三分篮球等。</li></ol><p id="fbdf" class="pw-post-body-paragraph la lb it lc b ld mi ju lf lg mj jx li lj mk ll lm ln ml lp lq lr mm lt lu lv im bi translated">希望你拉代码自己试试。</p><p id="5012" class="pw-post-body-paragraph la lb it lc b ld mi ju lf lg mj jx li lj mk ll lm ln ml lp lq lr mm lt lu lv im bi translated">我有自己的深度学习咨询公司，喜欢研究有趣的问题。我已经帮助许多初创公司部署了基于人工智能的创新解决方案。请到 http://deeplearninganalytics.org/的<a class="ae mn" href="http://deeplearninganalytics.org/" rel="noopener ugc nofollow" target="_blank">来看看我们吧。</a></p><p id="1a49" class="pw-post-body-paragraph la lb it lc b ld mi ju lf lg mj jx li lj mk ll lm ln ml lp lq lr mm lt lu lv im bi translated">你也可以在<a class="ae mn" href="https://medium.com/@priya.dwivedi" rel="noopener">https://medium.com/@priya.dwivedi</a>看到我的其他作品</p><p id="78a9" class="pw-post-body-paragraph la lb it lc b ld mi ju lf lg mj jx li lj mk ll lm ln ml lp lq lr mm lt lu lv im bi translated">如果你有一个我们可以合作的项目，请通过我的网站或 info@deeplearninganalytics.org 联系我</p><p id="6ab0" class="pw-post-body-paragraph la lb it lc b ld mi ju lf lg mj jx li lj mk ll lm ln ml lp lq lr mm lt lu lv im bi translated"><strong class="lc iu">参考文献</strong></p><ul class=""><li id="be0a" class="mt mu it lc b ld mi lg mj lj mv ln mw lr mx lv my mz na nb bi translated"><a class="ae mn" href="https://github.com/tensorflow/models/tree/master/research/object_detection" rel="noopener ugc nofollow" target="_blank"> Tensorflow 对象检测 API </a></li><li id="7f5a" class="mt mu it lc b ld nc lg nd lj ne ln nf lr ng lv my mz na nb bi translated">关于使用 OpenCV 检测颜色的好教程</li></ul></div></div>    
</body>
</html>