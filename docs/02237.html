<html>
<head>
<title>How to manage files in Google Drive with Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用 Python 管理 Google Drive 中的文件</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-manage-files-in-google-drive-with-python-d26471d91ecd?source=collection_archive---------3-----------------------#2019-04-14">https://towardsdatascience.com/how-to-manage-files-in-google-drive-with-python-d26471d91ecd?source=collection_archive---------3-----------------------#2019-04-14</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/e5293d191f877b975b4d3bcca9f9dfc5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*btao7Ymyeduw8SEhuW4b0Q.jpeg"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk">Photo on <a class="ae kf" href="https://unsplash.com/photos/RIb4BDwiakQ" rel="noopener ugc nofollow" target="_blank">unsplash</a></figcaption></figure><p id="5e60" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">作为一名数据分析师，大多数时候我需要与我的产品经理/利益相关者分享我提取的数据，Google Drive 始终是我的首选。这里的一个主要问题是我必须每周甚至每天都做，这很无聊。我们所有人都讨厌重复的任务，包括我。</p><p id="ab8c" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">幸运的是，谷歌为其大部分服务提供了 API。我们将使用<a class="ae kf" href="https://developers.google.com/drive/" rel="noopener ugc nofollow" target="_blank"> <strong class="ki iu"> Google Drive API </strong> </a>和<a class="ae kf" href="https://pythonhosted.org/PyDrive/" rel="noopener ugc nofollow" target="_blank"> <strong class="ki iu"> PyDrive </strong> </a>来管理我们在 Google Drive 中的文件。</p><h1 id="8c03" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">使用 Google Drive API</h1><p id="87a2" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">在开始编码之前，您应该准备好 Google Drive API 访问。我写了一篇关于如何通过客户端 ID 获得你的<a class="ae kf" href="https://medium.com/@chingjunetao/simple-way-to-access-to-google-service-api-a22f4251bb52" rel="noopener"> Google 服务访问的文章。你应该可以得到包含密钥的 JSON 文件来访问你的 Google Drive。</a></p><h1 id="52a4" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">PyDrive 入门</h1><h2 id="6f34" class="mh lf it bd lg mi mj dn lk mk ml dp lo kr mm mn ls kv mo mp lw kz mq mr ma ms bi translated">安装 PyDrive</h2><p id="113e" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">我们将使用 python 包管理器来安装 PyDrive</p><pre class="mt mu mv mw gt mx my mz na aw nb bi"><span id="7924" class="mh lf it my b gy nc nd l ne nf">pip install pydrive</span></pre><h2 id="e421" class="mh lf it bd lg mi mj dn lk mk ml dp lo kr mm mn ls kv mo mp lw kz mq mr ma ms bi translated">正在连接到 Google Drive</h2><p id="bb74" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">PyDrive 只用 2 行代码就使认证变得非常容易。</p><figure class="mt mu mv mw gt ju"><div class="bz fp l di"><div class="ng nh l"/></div></figure><blockquote class="ni nj nk"><p id="6779" class="kg kh nl ki b kj kk kl km kn ko kp kq nm ks kt ku nn kw kx ky no la lb lc ld im bi translated">你必须<strong class="ki iu">将</strong>JSON 文件重命名为“<strong class="ki iu">client _ secrets . JSON”</strong>，并将它与你的脚本放在同一个目录下。</p></blockquote><p id="ba68" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">将启动浏览器并要求您进行身份验证。选择您想要访问的 google 帐户并授权应用程序。</p><p id="dcee" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><code class="fe np nq nr my b">drive = GoogleDrive(gauth)</code>创建一个 Google Drive 对象来处理文件。您将使用该对象来列出和创建文件。</p><h2 id="3322" class="mh lf it bd lg mi mj dn lk mk ml dp lo kr mm mn ls kv mo mp lw kz mq mr ma ms bi translated">在 Google Drive 中列出和上传文件</h2><figure class="mt mu mv mw gt ju"><div class="bz fp l di"><div class="ng nh l"/></div></figure><p id="8ae1" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">第 1 行到第 4 行将显示 Google Drive 中的文件/文件夹列表。它还会给你这些文件/文件夹的详细信息。我们获取您想要上传文件的文件夹的<strong class="ki iu">文件 ID </strong>。在这种情况下，<code class="fe np nq nr my b">To Share</code>是我上传文件的文件夹。</p><blockquote class="ni nj nk"><p id="9889" class="kg kh nl ki b kj kk kl km kn ko kp kq nm ks kt ku nn kw kx ky no la lb lc ld im bi translated"><strong class="ki iu">文件 ID </strong>很重要，因为 Google Drive 使用文件 ID 来指定位置，而不是使用文件路径。</p></blockquote><p id="6623" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><code class="fe np nq nr my b">drive.CreateFile()</code>接受<strong class="ki iu">元数据</strong> ( <em class="nl"> dict </em>)。)作为输入来初始化一个 GoogleDriveFile。我用<code class="fe np nq nr my b">"mimeType" : "text/csv"</code>和<code class="fe np nq nr my b">"id" : fileID</code>初始化了一个文件。这个<code class="fe np nq nr my b">id</code>将指定文件上传到哪里。在这种情况下，文件将被上传到文件夹<code class="fe np nq nr my b">To Share</code>。</p><p id="11ad" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><code class="fe np nq nr my b">file1.SetContentFile("small_file.csv")</code>将打开指定的文件名并将文件的内容设置为 GoogleDriveFile 对象。此时，文件仍未上传。您将需要<code class="fe np nq nr my b">file1.Upload()</code>来完成上传过程。</p><h2 id="4bff" class="mh lf it bd lg mi mj dn lk mk ml dp lo kr mm mn ls kv mo mp lw kz mq mr ma ms bi translated">访问文件夹中的文件</h2><figure class="mt mu mv mw gt ju"><div class="bz fp l di"><div class="ng nh l"/></div></figure><p id="f938" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果你想上传文件到一个文件夹里的文件夹里呢？是的，你还需要文件 ID ！你可以使用<code class="fe np nq nr my b">ListFile</code>来获取文件，但是这次把<code class="fe np nq nr my b">root</code>改为<code class="fe np nq nr my b">file ID</code>。</p><pre class="mt mu mv mw gt mx my mz na aw nb bi"><span id="6ae6" class="mh lf it my b gy nc nd l ne nf">file_list = drive.ListFile({'q': "'&lt;folder ID&gt;' in parents and trashed=false"}).GetList()</span></pre><p id="07cd" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在我们可以进入文件夹<code class="fe np nq nr my b">To Share</code>中的文件夹<code class="fe np nq nr my b">picture</code>。</p><p id="6025" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">除了上传文件到 Google Drive，我们还可以删除它们。首先，用指定的文件 ID 创建一个 GoogleDriveFile。使用<code class="fe np nq nr my b">Trash()</code>将文件移至垃圾箱。您也可以使用<code class="fe np nq nr my b">Delete()</code>永久删除文件。</p><p id="7d82" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在你已经学会了如何用 Python 管理你的 Google Drive 文件。希望这篇文章对你有用。如果我犯了任何错误或打字错误，请给我留言。</p><p id="cfd7" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">可以在我的<a class="ae kf" href="https://github.com/chingjunetao/google-service-with-python/tree/master/google-drive-with-python" rel="noopener ugc nofollow" target="_blank"> <strong class="ki iu"> Github </strong> </a>中查看完整的脚本。干杯！</p></div><div class="ab cl ns nt hx nu" role="separator"><span class="nv bw bk nw nx ny"/><span class="nv bw bk nw nx ny"/><span class="nv bw bk nw nx"/></div><div class="im in io ip iq"><p id="b881" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu">如果你喜欢读这篇文章，你可能也会喜欢这些:</strong></p><div class="nz oa gp gr ob oc"><a rel="noopener follow" target="_blank" href="/how-to-rewrite-your-sql-queries-in-python-with-pandas-8d5b01ab8e31"><div class="od ab fo"><div class="oe ab of cl cj og"><h2 class="bd iu gy z fp oh fr fs oi fu fw is bi translated">如何用熊猫用 Python 重写 SQL 查询</h2><div class="oj l"><h3 class="bd b gy z fp oh fr fs oi fu fw dk translated">在 Python 中再现相同的 SQL 查询结果</h3></div><div class="ok l"><p class="bd b dl z fp oh fr fs oi fu fw dk translated">towardsdatascience.com</p></div></div><div class="ol l"><div class="om l on oo op ol oq jz oc"/></div></div></a></div><div class="nz oa gp gr ob oc"><a rel="noopener follow" target="_blank" href="/how-to-master-python-command-line-arguments-5d5ad4bcf985"><div class="od ab fo"><div class="oe ab of cl cj og"><h2 class="bd iu gy z fp oh fr fs oi fu fw is bi translated">如何掌握 Python 命令行参数</h2><div class="oj l"><h3 class="bd b gy z fp oh fr fs oi fu fw dk translated">使用命令行参数创建自己的 Python 脚本的简单指南</h3></div><div class="ok l"><p class="bd b dl z fp oh fr fs oi fu fw dk translated">towardsdatascience.com</p></div></div><div class="ol l"><div class="or l on oo op ol oq jz oc"/></div></div></a></div><p id="34e7" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu">你可以在 Medium 上找到我其他作品的链接，关注我</strong> <a class="ae kf" href="https://medium.com/@chingjunetao" rel="noopener"> <strong class="ki iu">这里</strong> </a> <strong class="ki iu">。感谢阅读！</strong></p></div></div>    
</body>
</html>