<html>
<head>
<title>Visualizing Emotions</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">可视化情感</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/visualizing-emotions-cec2215e9178?source=collection_archive---------27-----------------------#2019-11-20">https://towardsdatascience.com/visualizing-emotions-cec2215e9178?source=collection_archive---------27-----------------------#2019-11-20</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="cdd1" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">当我们通读一篇文章时，我想展示它的情感。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ki"><img src="../Images/ddfa4f4e807f0ca60dab1c41ecc4d4e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/1*fhYE-yRpkC9vUCD850Ko2A.gif"/></div></figure><p id="b595" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">我从探索词汇数据库 WordNet 开始。我最初的想法是使用 WordNet 创建一个所有单词(不包括停用词)与其同义词相连的图表，并在单词出现在文本中时对其进行跟踪。我希望他们能创造出一串相关的单词。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="gh gi lm"><img src="../Images/96a30b235619b29269a8c9dfc7a8554c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ewcf-dVsNZLt_3zSIAU2Hw.png"/></div></div><figcaption class="lr ls gj gh gi lt lu bd b be z dk">Visualized with Gephi (find the shortest path)</figcaption></figure><p id="b674" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">但是哎呀！他们是偶然的；我错过了一些重要的东西。比方说，A 和 B 共享同素集，B 和 C 也共享同素集。然而，A 和 C 可能在意义上没有关系。例如，一个公共节点连接<em class="lv">‘take’</em>和<em class="lv">‘occupy’</em>。另一个节点连接<em class="lv">【关注】</em>和<em class="lv">【占领】</em>。这将<em class="lv">【take】</em>和<em class="lv">【concern】</em>联系起来，尽管它们的含义并不相似。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="gh gi lw"><img src="../Images/613cec64a1e66d916568122d9d4fed07.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yJLF_EAk76eBN_DRtVLpzw.jpeg"/></div></div></figure><p id="fff6" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">下一次，我再次使用 WordNet，试图形成一个通过上位词连接的树。我尝试使用派生相关的形式、相似的 to 和动词组，将尽可能多的叶节点扩展到根‘实体’。我用迈克·博斯托克的径向树状图来展示数据。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="gh gi lx"><img src="../Images/18d3308debeeb2c14060ef83ab2d2382.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cOJroUUUW2nL6FSELqTU3w.png"/></div></div><figcaption class="lr ls gj gh gi lt lu bd b be z dk">Visualized with Mike Bostock’s Radial Dendrogram</figcaption></figure><p id="4c10" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">这一次，虽然它形成了聚类，但单词不是基于含义聚类的。</p><p id="b4b0" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">例如，感觉群集被放置在远离物理实体群集的地方。然而，在情感群中,“高兴”和“愤怒”的节点就在附近。虽然这两个节点通过上位词密切相关，但它们在意义上是相反的。</p><h2 id="dec9" class="ly lz it bd ma mb mc dn md me mf dp mg kz mh mi mj ld mk ml mm lh mn mo mp mq bi translated">终于！</h2><p id="052a" class="pw-post-body-paragraph kq kr it ks b kt mr ju kv kw ms jx ky kz mt lb lc ld mu lf lg lh mv lj lk ll im bi translated">最后，我选择了国家研究委员会的情感强度词典，也就是 Saif M. Mohammad 的情感强度词典。它包含四种情绪的 0 到 1 分的单词:愤怒、恐惧、快乐和悲伤。我考虑了三种情绪，用它们的分数和色轮来找到它们的位置。</p><pre class="kj kk kl km gt mw mx my mz aw na bi"><span id="e013" class="ly lz it mx b gy nb nc l nd ne">var xyArray=[];<br/>function data2rgb(filename)<br/>{<br/>    let D=2*R;<br/>    let rgbArray=[];<br/>    let scaleColor= d3.scaleLinear().domain([0,1]).range([0,255]);<br/>    d3.csv(filename).then(function(data) <br/>    {<br/>        for(let i=0;i&lt;data.length;i++)<br/>        {<br/>            let [red,green,blue]=<br/>               [scaleColor(data[i]["anger"]),<br/>                scaleColor(data[i]["joy"]),<br/>                scaleColor(data[i]["fear"])];<br/>       <br/>            let xyval=rgb2xy(red,green,blue,data[i]["negate"]);<br/>            xyArray.push({i:i, word:data[i].word, x:xyval.x,<br/>                      y:xyval.y, h:xyval.h, s:xyval.s, v:xyval.v});<br/>        }   <br/>        intervalLoop(xyArray);<br/>    });<br/>}</span></pre><p id="c048" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">首先，我借助了 Cory Forsyth 的文章<a class="ae nf" href="https://medium.com/@bantic/hand-coding-a-color-wheel-with-canvas-78256c9d7d43" rel="noopener">用画布手工编写色轮</a>。我开始收集一篇<a class="ae nf" href="http://shortstoriesshort.com/story/hansel-and-gretel/" rel="noopener ugc nofollow" target="_blank">文章</a>中可以在词典中找到的单词，以及它们的分数。然后，我将每个分数在 0 到 255 的范围内，并给它分配了一种颜色(绿色代表快乐，红色代表愤怒，蓝色代表恐惧)。将 RGB 值转换成 HSV 后，我可以从 H 和 S 得到它在圆中的位置，从 v 得到它的值。</p><pre class="kj kk kl km gt mw mx my mz aw na bi"><span id="537b" class="ly lz it mx b gy nb nc l nd ne">function repeating()<br/>{<br/>    timeouts=setTimeout(function()<br/>    {  if(i==xyArray.length-1) <br/>       return 0;<br/>       drawNode(xyArray[i],xyArray[i+1]);<br/>       i++;<br/>       repeating();<br/>       },tt);</span><span id="9db2" class="ly lz it mx b gy ng nc l nd ne">    function drawNode(a,b)<br/>    {...}<br/>}<br/>repeating();</span></pre><p id="6625" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">然后，使用 setTimeout()方法，我评估了该函数，以便在一个间隔之后定期绘制 SVG 元素。在这段时间里，通过 d3 转换，我可以在节点之间进行线性转换，并转换节点的颜色。但是我想创造一个更平滑的路径；不是线性的。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nh"><img src="../Images/38a0d5043ee42860d29cfae26317988f.png" data-original-src="https://miro.medium.com/v2/resize:fit:516/1*BJTSRGR1_FotWRXez09Cag.gif"/></div></figure><p id="3404" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">因此，我创建了一个 Catmull-Rom 样条线使用 d3 的无中风或填充，并打破了它成段。然后，我将沿着断开线段的点的数据添加到每个单词的数据中，以便在 setTimeout()函数中使用。</p><pre class="kj kk kl km gt mw mx my mz aw na bi"><span id="6027" class="ly lz it mx b gy nb nc l nd ne">if (b.seg.length!=0)<br/>{ <br/>      circles.attr("cx",R+p)<br/>         .attr("cy",R+p);</span><span id="5d05" class="ly lz it mx b gy ng nc l nd ne">      let pathSeg=svg.append("path").attr("id","pathSeg")<br/>         .data([b.seg])<br/>         .attr("d", d3.line()<br/>         .curve(d3.curveCatmullRom))<br/>         .attr("fill","none")<br/>         .attr("stroke-width","0")<br/>         .attr("transform", "translate("+ R+p +"," + R+p + ")");</span><span id="a39f" class="ly lz it mx b gy ng nc l nd ne">      circles.transition()<br/>         .duration(t)<br/>         .attrTween("transform", translateAlong(pathSeg.node()))<br/>         .attr("fill",d3.hsv(b.h,b.s,b.v))<br/>         .attr("r",scaleRadius(b.v));<br/>}<br/>else<br/>{<br/>      circles.attr("cx",R+b.x+p)<br/>         .attr("cy",R+b.y+p)<br/>         .transition().duration(t)<br/>         .attr("fill",d3.hsv(b.h,b.s,b.v))<br/>         .attr("r",scaleRadius(b.v));<br/>}</span></pre><p id="a1ef" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">最后，为了表示 HSV 颜色的 V 值，我改变了节点的半径，使其与 V 成比例，看起来像是在垂直于屏幕的方向上平移。此外，为了匹配背景，我重叠了一个黑色圆圈，不透明度等于 1-V。</p><pre class="kj kk kl km gt mw mx my mz aw na bi"><span id="538c" class="ly lz it mx b gy nb nc l nd ne">svg.append("circle").attr("id","cvalue")<br/>     .attr("cx",R+p).attr("cy",R+p).attr("r",R)<br/>     .attr("fill","black").attr("fill-opacity",1-a.v)<br/>     .transition().duration(t).ease(d3.easeLinear)<br/>     .attr("fill-opacity",1-b.v);</span></pre><p id="aa28" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">还有刷新！</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ki"><img src="../Images/ddfa4f4e807f0ca60dab1c41ecc4d4e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/1*fhYE-yRpkC9vUCD850Ko2A.gif"/></div><figcaption class="lr ls gj gh gi lt lu bd b be z dk">And refresh!</figcaption></figure><h2 id="28e9" class="ly lz it bd ma mb mc dn md me mf dp mg kz mh mi mj ld mk ml mm lh mn mo mp mq bi translated"><em class="ni">参考文献:</em></h2><p id="5f3b" class="pw-post-body-paragraph kq kr it ks b kt mr ju kv kw ms jx ky kz mt lb lc ld mu lf lg lh mv lj lk ll im bi translated">[1]赛义夫·穆罕默德，<a class="ae nf" href="https://saifmohammad.com/WebPages/AffectIntensity.htm" rel="noopener ugc nofollow" target="_blank"> NRC 影响强度词典</a></p><p id="6dd2" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">[2] C. Forsyth，<a class="ae nf" href="https://medium.com/@bantic/hand-coding-a-color-wheel-with-canvas-78256c9d7d43" rel="noopener">用画布手工编码色轮</a> (2017)</p><h2 id="f8cc" class="ly lz it bd ma mb mc dn md me mf dp mg kz mh mi mj ld mk ml mm lh mn mo mp mq bi translated"><strong class="ak">倒影:</strong></h2><ol class=""><li id="d41a" class="nj nk it ks b kt mr kw ms kz nl ld nm lh nn ll no np nq nr bi translated">还有很多事情要做。(例如，在 VADER，根据标点符号或强调符号来修改分数)。</li><li id="c679" class="nj nk it ks b kt ns kw nt kz nu ld nv lh nw ll no np nq nr bi translated">我们如何知道一个词在文本和词典中的意义？比如某本书里提到的<em class="lv">‘邪灵’</em>，词典上可能会认为是<em class="lv">‘精神好’</em>。</li><li id="ac29" class="nj nk it ks b kt ns kw nt kz nu ld nv lh nw ll no np nq nr bi translated">假设快乐、愤怒和恐惧这三种情绪相距 120 度是正确的吗？将悲伤视为快乐的对立面，并将其置于愤怒和恐惧之间(冷静和勇气也是如此)，这样做对吗？</li></ol></div><div class="ab cl nx ny hx nz" role="separator"><span class="oa bw bk ob oc od"/><span class="oa bw bk ob oc od"/><span class="oa bw bk ob oc"/></div><div class="im in io ip iq"><p id="f746" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">这个项目是我第一次尝试数据可视化和自然语言处理。如果你有任何反馈或建议，给我发邮件到 nive.mathan21@gmail.com，或者在回复中告诉我。我很乐意连接！</p></div></div>    
</body>
</html>