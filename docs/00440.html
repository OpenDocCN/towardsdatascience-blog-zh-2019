<html>
<head>
<title>Beginner: Cost Function and Gradient Descent</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">初学者:成本函数和梯度下降</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/machine-leaning-cost-function-and-gradient-descend-75821535b2ef?source=collection_archive---------6-----------------------#2019-01-20">https://towardsdatascience.com/machine-leaning-cost-function-and-gradient-descend-75821535b2ef?source=collection_archive---------6-----------------------#2019-01-20</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/7ac062fade2dadd6f0c6c670c4462a9d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fEfpkQkb2YS8ASpgbReaUw.jpeg"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Credited to “Machine Learning and Human Bias”. <em class="kc">Google. </em><a class="ae kd" href="https://www.youtube.com/watch?v=59bMh59JQDo" rel="noopener ugc nofollow" target="_blank">https://www.youtube.com/watch?v=59bMh59JQDo</a></figcaption></figure><p id="cf0a" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">讲故事有两种方式，一种是艰难的方式，你被期望达到演讲者或作者的标准，另一种是作者或演讲者期望观众必须理解故事在讲什么，不管你听起来有多天真。因此，在这里，我试图停留在后一类，同时试图给读者一个直观的成本函数的理解，以及 2 种不同的方法来减少成本函数。</p><p id="723a" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">注意:我假设读者是拥有二维和三维平面的家庭。</p><h2 id="7d27" class="lc ld iq bd le lf lg dn lh li lj dp lk kp ll lm ln kt lo lp lq kx lr ls lt lu bi translated">介绍</h2><p id="a7f5" class="pw-post-body-paragraph ke kf iq kg b kh lv kj kk kl lw kn ko kp lx kr ks kt ly kv kw kx lz kz la lb ij bi translated">假设给你三个数字(1，1)，(2，2)，(3，3)，它们可以在二维平面上表示，这意味着它们可以在 x-y 平面上表示，如下图所示。</p><figure class="mb mc md me gt jr gh gi paragraph-image"><div class="gh gi ma"><img src="../Images/5df4cb7f2eff3ed780e69c39e3028297.png" data-original-src="https://miro.medium.com/v2/resize:fit:754/format:webp/1*mWHeSwIOaDsP9jH9j80d8Q.jpeg"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">(a)</figcaption></figure><p id="64ab" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">现在，有人要求你拟合一条线，尽可能接近你已经得到的所有的点。拟合线是指尽可能接近二维平面中所有点的线。这些线将遵循的等式如下所示:</p><figure class="mb mc md me gt jr gh gi paragraph-image"><div class="gh gi mf"><img src="../Images/b19874b514e63eedd1079a144e8595d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1106/format:webp/1*p-4RGbmxFPoxZM82xugjgg.jpeg"/></div></figure><p id="f242" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">这里θ0 是直线的截距，θ1 是直线的斜率。截距是直线与 y 轴相交的值，斜率表示 x 轴上一个单位的变化会改变 y 轴上的值。</p><figure class="mb mc md me gt jr gh gi paragraph-image"><div class="gh gi mg"><img src="../Images/25aac3c720c9ed267aa467f30e0326ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:864/format:webp/1*0jiVGC5a3i28YsdnQoecEw.jpeg"/></div></figure><p id="e10e" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">根据这个等式，假设我们得出了三种不同的直线，它们有三种不同的斜率和截距值，如下所示。该表的上线、中线和下线为θ0，上线、中线和下线为θ1。</p><div class="mb mc md me gt ab cb"><figure class="mh jr mi mj mk ml mm paragraph-image"><img src="../Images/d612b44c7418b272fc0bd6811bf646f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:726/format:webp/1*K3VZY5B94Cm4-qG6Ifl1WA.jpeg"/></figure><figure class="mh jr mn mj mk ml mm paragraph-image"><img src="../Images/57df2ba66067c3a99f6af3ff0f8f7746.png" data-original-src="https://miro.medium.com/v2/resize:fit:362/format:webp/1*eHVo_h2JATk0AwKGulSxZA.png"/><figcaption class="jy jz gj gh gi ka kb bd b be z dk mo di mp mq">(b)</figcaption></figure></div><p id="30ba" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">这些图形显示的线的值也以表格形式显示。</p><figure class="mb mc md me gt jr gh gi paragraph-image"><div class="gh gi mg"><img src="../Images/25aac3c720c9ed267aa467f30e0326ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:864/format:webp/1*0jiVGC5a3i28YsdnQoecEw.jpeg"/></div></figure><p id="700b" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">很明显，中间的线与图(a)中显示的所有三个点相匹配，但是上面的线和下面的线与这三个点并不完全匹配。那是什么意思？让我看看…</p><h1 id="2810" class="mr ld iq bd le ms mt mu lh mv mw mx lk my mz na ln nb nc nd lq ne nf ng lt nh bi translated">价值函数</h1><p id="c78b" class="pw-post-body-paragraph ke kf iq kg b kh lv kj kk kl lw kn ko kp lx kr ks kt ly kv kw kx lz kz la lb ij bi translated">成本函数基本上意味着你的预测线离我们已经知道的实际点有多远。换句话说，你已经得到了一些点，然后你预测了θ0 和θ1 的值，利用这些，你在图上画了一条线；这样做之后，你意识到新的线并不完全触及你已经拥有的所有三个数据点，所以现在你计算原始点和你预测的线有多远。你可以用成本函数来计算。计算公式如下:</p><figure class="mb mc md me gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ni"><img src="../Images/1aa35e107f2be7c8062f4a8aa46292c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iAO4EFoJUD8WDgxp8dcFDg.jpeg"/></div></div></figure><p id="3c3f" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">让我们分解一下，看看这是什么意思。</p><p id="b42c" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">第一项 1/2m 是一个常数项，其中 m 表示我们已经拥有的数据点的数量，在我们的例子中是 3。然后我们有一个求和符号，这个符号意味着对于下标' I '中的每一个变化的值，我们不断地把结果相加。h(x^i 项表示我们的假设对于 I 的特定值的输出，换句话说，您使用等式 h(x)=θ0+xθ1 预测的线，而 y^i 项表示我们已经拥有的数据点的值。值“I”表示我们已经计算出的数据点的数量。为了更清楚地了解情况，我们来看一些例子:</p><h2 id="4c7c" class="lc ld iq bd le lf lg dn lh li lj dp lk kp ll lm ln kt lo lp lq kx lr ls lt lu bi translated">中线</h2><p id="4d21" class="pw-post-body-paragraph ke kf iq kg b kh lv kj kk kl lw kn ko kp lx kr ks kt ly kv kw kx lz kz la lb ij bi translated">原始点有值(1，1)，(2，2)，(3，3)。</p><p id="c32c" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">θ0 和θ1 分别预测为 0 和 1。利用假设方程我们画了一条线，现在要计算成本。我们画的这条线经过的点和我们已经知道的点完全一样。所以我们的假设值<em class="nj"> h(x)是 1，2，3 </em>并且<em class="nj"> y^i 的值也是 1，2，3 </em>。</p><figure class="mb mc md me gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nk"><img src="../Images/5ed83cbb369e5211e8169c8a525326df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0zTqvwsV2D_lReu7mo5X9w.jpeg"/></div></div></figure><p id="19db" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">我们可以看到，成本函数给我们的中间线为零。下面的红线是我们的假设线，黑点是我们的点。</p><figure class="mb mc md me gt jr gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/ef13d7250d8866d91cf320d3a4807473.png" data-original-src="https://miro.medium.com/v2/resize:fit:736/format:webp/1*4yHrGS_RsP8GbNBeaEz9dA.jpeg"/></div></figure><h2 id="d207" class="lc ld iq bd le lf lg dn lh li lj dp lk kp ll lm ln kt lo lp lq kx lr ls lt lu bi translated">上线</h2><p id="76c0" class="pw-post-body-paragraph ke kf iq kg b kh lv kj kk kl lw kn ko kp lx kr ks kt ly kv kw kx lz kz la lb ij bi translated">θ0 和θ1 分别预测为 1.5 和 1.25。这意味着 y 轴上的截距是 1.5，对于 x 轴上的每个单位机会，假设 h(x)在 y 轴上变化 1.25。</p><p id="91e2" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">这样，我们计算出我们的<em class="nj"> h(x)值如下— (1.5，2.75 和 4) </em>。而 y^i(原始数据点)保持不变— <em class="nj"> (1，2，3) </em>。使用成本函数，我们得到以下值:</p><figure class="mb mc md me gt jr gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/6cd208cf028bd521314700fb1f85bd1e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*gWdP32XPKB4AccYj3WuABw.jpeg"/></div></figure><figure class="mb mc md me gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nn"><img src="../Images/d4209bc26e1655a603efdb8960109d0a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IfAfmTgmWHHZopnItkVKZQ.jpeg"/></div></div></figure><h2 id="61e8" class="lc ld iq bd le lf lg dn lh li lj dp lk kp ll lm ln kt lo lp lq kx lr ls lt lu bi translated">下部线</h2><p id="12d0" class="pw-post-body-paragraph ke kf iq kg b kh lv kj kk kl lw kn ko kp lx kr ks kt ly kv kw kx lz kz la lb ij bi translated">下线条的θ0 和θ1 值分别为 1.25 和 0.75。这意味着它在 1.25 处截取 y 轴，并且对于 x 值的每个单位变化，假设 h(x)将以 0.75 的速率变化。</p><p id="45ba" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">我们已经知道，原始点<em class="nj"> y 的值是(1，2 和 3) </em>，我们预测的点<em class="nj"> h(x)的值是-1.25，1.5，2。现在，使用成本函数我们可以计算成本，如下图所示。</em></p><figure class="mb mc md me gt jr gh gi paragraph-image"><div class="gh gi no"><img src="../Images/6efe86126f83edd4378e90e415ff771e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1072/format:webp/1*6G4mxVK2QpFkbU1eiYxy6Q.jpeg"/></div></figure><figure class="mb mc md me gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nn"><img src="../Images/8b2ec52ca2516175ef3a2fb3b06a2235.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3RzMFFFIZGCMzYi_cDMVSQ.jpeg"/></div></div></figure><h1 id="7eae" class="mr ld iq bd le ms mt mu lh mv mw mx lk my mz na ln nb nc nd lq ne nf ng lt nh bi translated">降低成本函数</h1><p id="3064" class="pw-post-body-paragraph ke kf iq kg b kh lv kj kk kl lw kn ko kp lx kr ks kt ly kv kw kx lz kz la lb ij bi translated">你还记得上面预测的θ-0 和θ-1 的值，因为它们只是预测，只有中间那个是完美的。但是在现实生活中，找到θ-0 和θ-1 的完美值几乎是不可能的。然而，你有能力操纵θ-0 和θ-1 的值，对于任何给定的一组值<em class="nj"> (x1，x2，x3…xn) </em>您正在寻找具有最低成本函数值的线。</p><p id="b3eb" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">让我们得出θ-0 和θ-1 的不同值。θ-0 和θ-1 分别为 0 和 1.42。它创建的线看起来像下面这样。</p><figure class="mb mc md me gt jr gh gi paragraph-image"><div class="gh gi np"><img src="../Images/3f551a6e0e76452ddd2d31597c11612f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1016/format:webp/1*lpu8AGBwPp45zbDeEv41gg.jpeg"/></div></figure><p id="b435" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">但是，因为你需要降低成本，你需要创建一条符合这三点的线。大概是这样的:</p><figure class="mb mc md me gt jr gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/7c04d9aa619c617a21b1ad615bd36d21.png" data-original-src="https://miro.medium.com/v2/resize:fit:1012/format:webp/1*d0s6VSyKqgsqoSEv4OC5Gg.jpeg"/></div></figure><p id="0323" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">所以你使用一种叫做梯度下降的降低成本的方法。永远记住，你只是减少θ-0 和θ-1 的值，通过这样做，你从那边的红线到下面的黑线。见下文，以便更好地理解。</p><figure class="mb mc md me gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nr"><img src="../Images/9c9ccdafef2acbcdf864e530d66aa166.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*D6vrHQLvp_gNnXR7jE0TLg.gif"/></div></div></figure><p id="af58" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">因为我们知道改变θ-0 和θ-1 的值，所以线的方向可以改变，并且为了达到尽可能接近这三个点的线，我们一点一点地减少所有θ的值(在我们的情况下只有 2θ),以这样的方式，我们达到成本函数的最小值。</p><figure class="mb mc md me gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nk"><img src="../Images/ca0f8fdc215ca318f2054f4011a51486.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JvZjVXvQPuGBGKiv4aKkKA.jpeg"/></div></div></figure><p id="af85" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">术语“阿尔法”的意思是——你的价值减少了多少。这里的θ-j 代表解中的每个θ，所以对所有θ都用这个方程，在我们的例子中，θ是 2，但也可以是 3，4 或 10，这取决于手头的问题。所以，上图中最上面的线有一定的θ-0 和θ-1 的值，然后，使用这里的公式，你将方程中所有θ的值减少一些α值，并随着你的预测线移动一点。然后你再次运行那个公式，减少θs 的值，看看那条线看起来像什么，计算成本，为下一次迭代做准备。然后你再降低θ的值，再看这条线，计算成本。你一直这样做，直到你的线到达成本最小的点，在我们的例子中，可以看到上面的图片值为 1，2，3。相对于原始数据点 1、2、3，成本为零的完美线条。公式的分解更有意义，见下图。</p><figure class="mb mc md me gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ns"><img src="../Images/c5e848769c1fff84f8ce1bf933accc78.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AzHK6GOSoJ1PkjUMzD1ajQ.jpeg"/></div></div></figure><h1 id="0e66" class="mr ld iq bd le ms mt mu lh mv mw mx lk my mz na ln nb nc nd lq ne nf ng lt nh bi translated">总结:</h1><p id="3871" class="pw-post-body-paragraph ke kf iq kg b kh lv kj kk kl lw kn ko kp lx kr ks kt ly kv kw kx lz kz la lb ij bi translated">1-你有一些数据点。</p><p id="b185" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">2-使用它们，你可以计算θ的值，并使用假设方程绘制图形。</p><p id="210e" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">3-您使用成本函数计算成本，成本函数是您绘制的数据点和原始数据点之间的距离。</p><p id="0da8" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">你看到成本函数给了你一些你想减少的值。</p><p id="1e6c" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">5-使用梯度下降，将θ的值减少α的量级。</p><p id="4511" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">6-使用一组新的θ值，再次计算成本。</p><p id="0d8f" class="pw-post-body-paragraph ke kf iq kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">7-你一个接一个地重复步骤 5 和步骤 6，直到你达到成本函数的最小值。</p></div></div>    
</body>
</html>