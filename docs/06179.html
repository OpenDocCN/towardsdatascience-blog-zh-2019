<html>
<head>
<title>Structuring data to predict the future, aka Project Flux Capacitor</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">结构化数据预测未来，又名项目通量电容器</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/structuring-data-to-predict-the-future-aka-project-flux-capacitor-7133715d7e57?source=collection_archive---------26-----------------------#2019-09-06">https://towardsdatascience.com/structuring-data-to-predict-the-future-aka-project-flux-capacitor-7133715d7e57?source=collection_archive---------26-----------------------#2019-09-06</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="34da" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">数据准备是一个好的机器学习(ML)模型的核心，但获得正确的数据需要时间。很多时间！不要害怕。</h2></div><p id="79fc" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了帮助传递一些知识并使您的过程更容易，我和我的团队发布了代码来支持、加速甚至改进您构建 ML 模型的方式，如倾向模型、客户生命周期价值模型、推荐系统等。</p><p id="a89f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">大卫、<a class="ae lb" href="https://www.linkedin.com/in/kathrina-rose-ondap-7842b64b" rel="noopener ugc nofollow" target="_blank">凯西</a>和<a class="ae lb" href="https://www.linkedin.com/in/rukshan-batuwita-3881a526/?originalSubdomain=au" rel="noopener ugc nofollow" target="_blank">鲁克山</a>为开发这一解决方案并使之成为可能而付出的努力让他们感到无比自豪。</p></div><div class="ab cl lc ld hu le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="ij ik il im in"><p id="0186" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">我们走吧！</strong></p><p id="e411" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在幕后，代码利用<a class="ae lb" href="https://cloud.google.com/dataflow/" rel="noopener ugc nofollow" target="_blank">谷歌云数据流</a>来运行 Apache Beam 管道，并利用<a class="ae lb" href="https://cloud.google.com/bigquery/" rel="noopener ugc nofollow" target="_blank">谷歌云 BigQuery </a>来读取和保存。将大量数据转换成 ML ready 格式的强大而快速的方法。</p><p id="255b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们已经优化了代码，可以插入到一个<a class="ae lb" href="https://support.google.com/analytics/answer/3437618?hl=en" rel="noopener ugc nofollow" target="_blank"> Google Analytics BigQuery 表</a>中，但是如果有用的话，也可以插入到其他 BigQuery 数据源中。输入您的 BigQuery 表，运行管道，然后——瞧——输出带有结构化特征和标签的新 BigQuery 表。准备好使用你最喜欢的 ML 工具来训练一个 ML 模型，比如 AutoML-Tables，BigQuery ML，Tensorflow，Python sklearn…等等。</p><p id="9581" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">渴望一头扎进去？去吧…</p><ul class=""><li id="ba88" class="lj lk iq kh b ki kj kl km ko ll ks lm kw ln la lo lp lq lr bi translated">在<a class="ae lb" href="https://github.com/GoogleCloudPlatform/cloud-for-marketing/tree/master/marketing-analytics/predicting/ml-data-windowing-pipeline" rel="noopener ugc nofollow" target="_blank">Google cloud platform/cloud-for-marketing/…GitHub Repo</a>中检查 ML 数据窗口管道代码。</li><li id="0ff7" class="lj lk iq kh b ki ls kl lt ko lu ks lv kw lw la lo lp lq lr bi translated">说明如何使用的<a class="ae lb" href="https://github.com/GoogleCloudPlatform/cloud-for-marketing/blob/master/marketing-analytics/predicting/ml-data-windowing-pipeline/README.md" rel="noopener ugc nofollow" target="_blank">自述文件</a>的直接链接。</li><li id="a1c8" class="lj lk iq kh b ki ls kl lt ko lu ks lv kw lw la lo lp lq lr bi translated">我们还发布了一个关于<a class="ae lb" href="https://cloud.google.com/solutions/preparing-ml-ready-data-for-personalization" rel="noopener ugc nofollow" target="_blank">为个性化准备 ML 就绪数据的 Google Cloud 教程</a>。</li></ul><p id="869d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">或者，<strong class="kh ir">如果你能坚持听我说几分钟</strong>，了解通量电容管道如何构建数据对于理解其价值非常重要。我试图向我的非技术伙伴(yikes)解释这种技术，所以决定在这里发表我的想法，作为一个更非官方的——希望更有趣的——解释。</p></div><div class="ab cl lc ld hu le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="ij ik il im in"><p id="e969" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">为什么要通量电容器？</strong></p><p id="07bc" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们的正式项目名称是 ML 数据窗口管道。尽管如此，一切都需要一个有趣的名字，当我们根据过去发生的事情构建数据来预测未来时，Flux Capacitor 似乎很合适。正是这些数据让“时间旅行”成为可能，🧀。好了，先把这些劣质的东西放在一边，让我来解释一下它是做什么的。</p></div><div class="ab cl lc ld hu le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="ij ik il im in"><p id="e71b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">“医生”布朗想买辆车</strong></p><p id="5bd5" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我们考虑一个随机的人，称他为医生。在这个例子中，Doc 从我们的网站上购买了一辆新车。</p><figure class="ly lz ma mb gt mc gh gi paragraph-image"><div class="gh gi lx"><img src="../Images/7d22e544ca1c28d59c77b7fc609cd130.png" data-original-src="https://miro.medium.com/v2/resize:fit:1184/format:webp/1*q7WMIhSawjnBywZWs3lziQ.png"/></div><figcaption class="mf mg gj gh gi mh mi bd b be z dk">Image Christopher Lloyd as Dr. Emmett Brown — Back to the Future</figcaption></figure><p id="391c" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们的汽车网站上有谷歌分析设置，让我们记录和查看文件的浏览活动。让我们记住，实际上我们只查看匿名指标(我们只是为了好玩才使用文档参考)。</p><figure class="ly lz ma mb gt mc gh gi paragraph-image"><div role="button" tabindex="0" class="mk ml di mm bf mn"><div class="gh gi mj"><img src="../Images/2936df72274dde32054c3ac5e9029d45.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lS8S1H0otS68ff0l-dVxTA.png"/></div></div><figcaption class="mf mg gj gh gi mh mi bd b be z dk">Image made by author — User timeline of events</figcaption></figure><p id="75de" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这是代表活动的时间线，蓝色方框表示导致购买事件的交互。每次互动都有一些我们可以从谷歌分析中获得的指标，例如浏览器、一天中的时间、访问的页面、点击量等。</p><p id="1760" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我们从一个时间快照来看这个时间线中的细节，并将该快照称为日期 d 。</p><figure class="ly lz ma mb gt mc gh gi paragraph-image"><div role="button" tabindex="0" class="mk ml di mm bf mn"><div class="gh gi mp"><img src="../Images/2ce9f82e0765569f4a0c8c1de2ffa024.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zslvrjjQYL4ALBiTjXdC-g.png"/></div></div><figcaption class="mf mg gj gh gi mh mi bd b be z dk">Image made by author — User timeline of events from Date d</figcaption></figure><p id="2885" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，关于<em class="mo">日期 d </em>，我们可以开始回顾过去一段时间，并将文档的会话信息汇总在一起。这个定义的时间段被称为<em class="mo">回顾窗口</em>。</p><figure class="ly lz ma mb gt mc gh gi paragraph-image"><div role="button" tabindex="0" class="mk ml di mm bf mn"><div class="gh gi mq"><img src="../Images/d0d6390810d3928748be1bb953a34b85.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zuHWpjX6hzkl3a5d1W1Oiw.png"/></div></div><figcaption class="mf mg gj gh gi mh mi bd b be z dk">Image made by author — User timeline of events with Features</figcaption></figure><p id="8f7c" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在这个例子中，Google Analytics 交互被聚合以创建新的指标，例如最频繁的页面、浏览器、活跃天数、总点击数等。它们代表了我们将用来训练 ML 模型的特征。</p><p id="a913" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">接下来，从我们的<em class="mo">日期 d </em>开始，我们通过指定的时间量来预测未来，并将此称为<em class="mo">预测窗口</em>。</p><figure class="ly lz ma mb gt mc gh gi paragraph-image"><div role="button" tabindex="0" class="mk ml di mm bf mn"><div class="gh gi mq"><img src="../Images/3555424f034c5945ee5c9b4bc06a2f33.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YB93XngumVev9o9iHIPA1g.png"/></div></div><figcaption class="mf mg gj gh gi mh mi bd b be z dk">Image made by author — User timeline of events with Features and Label</figcaption></figure><p id="8b89" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因此，就数据而言，如果购买发生在相对于日期 d <em class="mo">和日期 d </em>的<em class="mo">预测窗口</em>内，那么它发生在日期 d <em class="mo">和日期 d </em>。换句话说，该标签基于在<em class="mo">预测窗口</em>期间是否发生了购买事件。</p><p id="4ffb" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这是这里的关键，所以我们的模型是根据未来会发生什么以及如何预测来训练的。</p><figure class="ly lz ma mb gt mc gh gi paragraph-image"><div role="button" tabindex="0" class="mk ml di mm bf mn"><div class="gh gi mr"><img src="../Images/998f7bddb11ca726649bff5012c61c7a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iPQp_rnIMBXMlYpN0htmfQ.png"/></div></div><figcaption class="mf mg gj gh gi mh mi bd b be z dk">Image made by author — User timeline of events with Features and Label</figcaption></figure><p id="be81" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这代表了我们将用来训练 ML 模型的标签。</p><p id="94c9" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">一旦我们为文档——我们的匿名用户——提取了与 d <em class="mo"> ate d </em>相关的特征和标签，我们就会在表中看到一行，如下所示:</p><figure class="ly lz ma mb gt mc gh gi paragraph-image"><div class="gh gi ms"><img src="../Images/80466abcb8894c28ad17b259bcb5fdd4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1326/format:webp/1*OKb6K8G-6djC-fw10p0IeQ.png"/></div><figcaption class="mf mg gj gh gi mh mi bd b be z dk">Image made by author — User Features and Label for Date d</figcaption></figure><p id="b64a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后，我们为网站上的所有用户在日期<em class="mo">和</em>拍摄这些快照。</p><figure class="ly lz ma mb gt mc gh gi paragraph-image"><div role="button" tabindex="0" class="mk ml di mm bf mn"><div class="gh gi mt"><img src="../Images/f3350cf81c1c98a524d2bdf34be0d155.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lA5qsxT4T9EMt8J8LELEjg.png"/></div></div><figcaption class="mf mg gj gh gi mh mi bd b be z dk">Image made by author — Users timeline of events with Features and Label</figcaption></figure><p id="d1b7" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">生成的表格看起来像这样:</p><figure class="ly lz ma mb gt mc gh gi paragraph-image"><div class="gh gi mu"><img src="../Images/2ccb45e82c96c560cca572724f51bd51.png" data-original-src="https://miro.medium.com/v2/resize:fit:1392/format:webp/1*Es3Zi1ZPyBsx_GYd9ZlZow.png"/></div><figcaption class="mf mg gj gh gi mh mi bd b be z dk">Image made by author — Users Features and Label for Date d</figcaption></figure><p id="522f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后，我们以<em class="mo">间隔 w </em>(例如，一天、一周…等)将<em class="mo">日期 d </em>移动一个设定的滑动窗口，以针对 d + w、d + 2w…等为所有用户及时创建更多快照。</p><figure class="ly lz ma mb gt mc gh gi paragraph-image"><div role="button" tabindex="0" class="mk ml di mm bf mn"><div class="gh gi mv"><img src="../Images/e1060c09d52b815c1e2f170151623bcc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BIsDkYOK5XkpQFmln1orvQ.png"/></div></div><figcaption class="mf mg gj gh gi mh mi bd b be z dk">Image made by author — Users snapshots over time</figcaption></figure><p id="9e69" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">随着时间的推移，通过多个快照，我们的数据集可以了解数据如何变化以适应季节性(最近和频率信息)。</p></div><div class="ab cl lc ld hu le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="ij ik il im in"><p id="8673" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">“伟大的斯科特！”</strong></p><p id="287a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">结果。一个强大(大)的数据集，准备好训练你的 ML 模型。</p><p id="8897" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">最后要记住的是成本。简单运行 ML 数据窗口管道代码，比如使用 Google Analytics 样本数据集，应该是最少的。然而，生产成本将取决于您的数据大小。管道被设计为尽可能高效，但请注意<a class="ae lb" href="https://cloud.google.com/dataflow/pricing" rel="noopener ugc nofollow" target="_blank">谷歌云数据流定价指南</a>和<a class="ae lb" href="https://cloud.google.com/products/calculator/" rel="noopener ugc nofollow" target="_blank">谷歌云平台定价计算器</a>，以确保没有意外。</p></div><div class="ab cl lc ld hu le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="ij ik il im in"><p id="fe3b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我希望这是有用的，我们很乐意在评论区看到你是如何应用它的。</p></div><div class="ab cl lc ld hu le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="ij ik il im in"><p id="a093" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">PS。如果你从未看过电影《回到未来》，我向你道歉！因为许多这些类比/图片可能看起来有点随机。</p><figure class="ly lz ma mb gt mc gh gi paragraph-image"><div class="gh gi mw"><img src="../Images/2ce79834d192cf8ddc9ac61296a35613.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/format:webp/1*hNG-y_hu426MJ19Oep6XFw.png"/></div><figcaption class="mf mg gj gh gi mh mi bd b be z dk">Image Meme — Made at imgflip</figcaption></figure></div></div>    
</body>
</html>