<html>
<head>
<title>House price prediction using Linear Regression with TensorFlow.js</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">利用 TensorFlow.js 进行线性回归的房价预测</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/linear-regression-with-tensorflow-js-e7b39713572?source=collection_archive---------6-----------------------#2019-07-10">https://towardsdatascience.com/linear-regression-with-tensorflow-js-e7b39713572?source=collection_archive---------6-----------------------#2019-07-10</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="c87c" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用 TensorFlow.js 构建线性回归模型，并用于预测房价</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/f59b94282b739f59b641a36dec2db220.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*e5HnPjVLvvqPb7vCguLA0w.jpeg"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Photo by Geran de Klerk</figcaption></figure><blockquote class="ky"><p id="7d8a" class="kz la it bd lb lc ld le lf lg lh li dk translated"><em class="lj">TL；DR 在 TensorFlow.js 建立线性回归模型，预测房价。了解如何处理分类数据和进行要素缩放。</em></p></blockquote><p id="2707" class="pw-post-body-paragraph lk ll it lm b ln lo ju lp lq lr jx ls lt lu lv lw lx ly lz ma mb mc md me li im bi translated">又下雨了。自从你最后一次见到太阳已经三个星期了。你已经厌倦了这种寒冷、不愉快的孤独和忧郁的感觉。</p><p id="61a8" class="pw-post-body-paragraph lk ll it lm b ln mf ju lp lq mg jx ls lt mh lv lw lx mi lz ma mb mj md me li im bi translated">你脑子里的声音越来越大。</p><p id="8ebe" class="pw-post-body-paragraph lk ll it lm b ln mf ju lp lq mg jx ls lt mh lv lw lx mi lz ma mb mj md me li im bi translated">——“动”。</p><p id="3670" class="pw-post-body-paragraph lk ll it lm b ln mf ju lp lq mg jx ls lt mh lv lw lx mi lz ma mb mj md me li im bi translated">好了，你准备好了。去哪里？你记得你几乎破产了。</p><p id="a43d" class="pw-post-body-paragraph lk ll it lm b ln mf ju lp lq mg jx ls lt mh lv lw lx mi lz ma mb mj md me li im bi translated">你的一个朋友告诉了你爱荷华州的埃姆斯这个地方，它深深地印在了你的脑海里。快速搜索后，你发现一年中天气宜人，也有一些雨水，但不多。兴奋！</p><p id="298c" class="pw-post-body-paragraph lk ll it lm b ln mf ju lp lq mg jx ls lt mh lv lw lx mi lz ma mb mj md me li im bi translated">幸运的是，你知道 Kaggle 上的这个数据集，它可能会帮助你找出你梦想中的房子可能要花多少钱。我们开始吧！</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mk ml l"/></div></figure><p id="2704" class="pw-post-body-paragraph lk ll it lm b ln mf ju lp lq mg jx ls lt mh lv lw lx mi lz ma mb mj md me li im bi translated"><strong class="lm iu">在浏览器中运行本教程的完整源代码:</strong></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mk ml l"/></div></figure><h1 id="49f2" class="mm mn it bd mo mp mq mr ms mt mu mv mw jz mx ka my kc mz kd na kf nb kg nc nd bi translated">房价数据</h1><p id="31c5" class="pw-post-body-paragraph lk ll it lm b ln ne ju lp lq nf jx ls lt ng lv lw lx nh lz ma mb ni md me li im bi translated">我们的数据来自 Kaggle 的<a class="ae nj" href="https://www.kaggle.com/c/house-prices-advanced-regression-techniques/data" rel="noopener ugc nofollow" target="_blank">房价:高级回归技术</a>挑战。</p><blockquote class="nk nl nm"><p id="8d66" class="lk ll nn lm b ln mf ju lp lq mg jx ls no mh lv lw np mi lz ma nq mj md me li im bi translated">有 79 个解释变量描述了(几乎)爱荷华州埃姆斯住宅的每个方面，这个比赛挑战你预测每个家庭的最终价格。</p></blockquote><p id="d4d7" class="pw-post-body-paragraph lk ll it lm b ln mf ju lp lq mg jx ls lt mh lv lw lx mi lz ma mb mj md me li im bi translated">以下是我们将在模型中使用的数据子集:</p><ul class=""><li id="199e" class="nr ns it lm b ln mf lq mg lt nt lx nu mb nv li nw nx ny nz bi translated"><code class="fe oa ob oc od b">OverallQual</code> -对房屋的整体材料和装饰进行评级(0 - 10)</li><li id="79fc" class="nr ns it lm b ln oe lq of lt og lx oh mb oi li nw nx ny nz bi translated"><code class="fe oa ob oc od b">GrLivArea</code> -地上(地面)以上居住面积平方英尺</li><li id="e3a6" class="nr ns it lm b ln oe lq of lt og lx oh mb oi li nw nx ny nz bi translated"><code class="fe oa ob oc od b">GarageCars</code> -车库容量大小</li><li id="804f" class="nr ns it lm b ln oe lq of lt og lx oh mb oi li nw nx ny nz bi translated"><code class="fe oa ob oc od b">TotalBsmtSF</code> -地下室总面积平方英尺</li><li id="fe98" class="nr ns it lm b ln oe lq of lt og lx oh mb oi li nw nx ny nz bi translated"><code class="fe oa ob oc od b">FullBath</code> -地面以上的全浴室</li><li id="94d5" class="nr ns it lm b ln oe lq of lt og lx oh mb oi li nw nx ny nz bi translated"><code class="fe oa ob oc od b">YearBuilt</code> -原始施工日期</li><li id="6fa2" class="nr ns it lm b ln oe lq of lt og lx oh mb oi li nw nx ny nz bi translated"><code class="fe oa ob oc od b">SalePrice</code> -以美元为单位的房产销售价格(我们正在尝试预测)</li></ul><p id="0ccd" class="pw-post-body-paragraph lk ll it lm b ln mf ju lp lq mg jx ls lt mh lv lw lx mi lz ma mb mj md me li im bi translated">让我们使用<a class="ae nj" href="https://www.papaparse.com/" rel="noopener ugc nofollow" target="_blank"> Papa Parse </a>来加载训练数据:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oj ml l"/></div></figure><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oj ml l"/></div></figure><h1 id="8e62" class="mm mn it bd mo mp mq mr ms mt mu mv mw jz mx ka my kc mz kd na kf nb kg nc nd bi translated">探测</h1><p id="ddd0" class="pw-post-body-paragraph lk ll it lm b ln ne ju lp lq nf jx ls lt ng lv lw lx nh lz ma mb ni md me li im bi translated">让我们更好地理解我们的数据。首先—每栋房屋的质量得分:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ok"><img src="../Images/80bc658d4056384f56c9448d4dae3ad0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gdmWQ0QKDPTliB6AL-Jc1Q.png"/></div></div></figure><p id="96c1" class="pw-post-body-paragraph lk ll it lm b ln mf ju lp lq mg jx ls lt mh lv lw lx mi lz ma mb mj md me li im bi translated">大多数房子质量一般，但“好”的比“坏”的多。</p><p id="36c4" class="pw-post-body-paragraph lk ll it lm b ln mf ju lp lq mg jx ls lt mh lv lw lx mi lz ma mb mj md me li im bi translated">让我们看看它们有多大(她是这么说的):</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ok"><img src="../Images/8522d4c652a6ed8f4ed31017249257f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qF4R_gf4Laqh4ZYhZoORtQ.png"/></div></div></figure><p id="d2cb" class="pw-post-body-paragraph lk ll it lm b ln mf ju lp lq mg jx ls lt mh lv lw lx mi lz ma mb mj md me li im bi translated">大多数房子的价格在 1，000-2，000 英镑之间，我们也有一些更大的。</p><p id="87c7" class="pw-post-body-paragraph lk ll it lm b ln mf ju lp lq mg jx ls lt mh lv lw lx mi lz ma mb mj md me li im bi translated">让我们看看它们是哪一年建造的:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ok"><img src="../Images/70c8613b27b488e0a53975c07fdcac4f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bKyXXD7fqrVfkiT_WpmS6A.png"/></div></div></figure><p id="11c5" class="pw-post-body-paragraph lk ll it lm b ln mf ju lp lq mg jx ls lt mh lv lw lx mi lz ma mb mj md me li im bi translated">尽管有很多房子是最近建造的，但我们的分布范围要广得多。</p><p id="8b34" class="pw-post-body-paragraph lk ll it lm b ln mf ju lp lq mg jx ls lt mh lv lw lx mi lz ma mb mj md me li im bi translated">年份和价格有多大关系？</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ok"><img src="../Images/339f10652b015396cc358e9e55c8a7d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TkKDQ4FrsymTiRXGQMx6zg.png"/></div></div></figure><p id="4282" class="pw-post-body-paragraph lk ll it lm b ln mf ju lp lq mg jx ls lt mh lv lw lx mi lz ma mb mj md me li im bi translated">似乎新房子更贵，没有人喜欢旧的和造得好的房子？</p><p id="c1c2" class="pw-post-body-paragraph lk ll it lm b ln mf ju lp lq mg jx ls lt mh lv lw lx mi lz ma mb mj md me li im bi translated">哦，好吧，但是高质量应该等于高价格，对吗？</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ok"><img src="../Images/d7413f6b6a0e080a40734d39599e3d22.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*osNa5DItNKocTHuXKJW4Ag.png"/></div></div></figure><p id="198e" class="pw-post-body-paragraph lk ll it lm b ln mf ju lp lq mg jx ls lt mh lv lw lx mi lz ma mb mj md me li im bi translated">一般可以，但是看质量 10。其中一些相对便宜。知道为什么会这样吗？</p><p id="c5d6" class="pw-post-body-paragraph lk ll it lm b ln mf ju lp lq mg jx ls lt mh lv lw lx mi lz ma mb mj md me li im bi translated">房子越大就等于价格越高吗？</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ok"><img src="../Images/b59fc6f924a5f632146592b69d519599.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rr-pchm3pQJZRaEBFMeFsQ.png"/></div></div></figure><p id="3f1a" class="pw-post-body-paragraph lk ll it lm b ln mf ju lp lq mg jx ls lt mh lv lw lx mi lz ma mb mj md me li im bi translated">似乎是这样，我们可以从居住区开始我们的价格预测模型！</p><h1 id="dc84" class="mm mn it bd mo mp mq mr ms mt mu mv mw jz mx ka my kc mz kd na kf nb kg nc nd bi translated">线性回归</h1><p id="f25e" class="pw-post-body-paragraph lk ll it lm b ln ne ju lp lq nf jx ls lt ng lv lw lx nh lz ma mb ni md me li im bi translated">线性回归模型假设因变量<code class="fe oa ob oc od b">Y</code>和一个或多个解释变量<code class="fe oa ob oc od b">X</code>之间存在线性关系(可以用直线建模)。</p><p id="866c" class="pw-post-body-paragraph lk ll it lm b ln mf ju lp lq mg jx ls lt mh lv lw lx mi lz ma mb mj md me li im bi translated">在我们的例子中，我们将使用像<code class="fe oa ob oc od b">living area</code> (X)这样的特征来预测房子的<code class="fe oa ob oc od b">sale price</code> (Y)。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ok"><img src="../Images/c8d5c23271b5ee16a822ba8954706b8c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FfP7Pte4NXcj0r1v663OyA.png"/></div></div></figure><h2 id="eb99" class="ol mn it bd mo om on dn ms oo op dp mw lt oq or my lx os ot na mb ou ov nc ow bi translated">简单线性回归</h2><p id="d0c5" class="pw-post-body-paragraph lk ll it lm b ln ne ju lp lq nf jx ls lt ng lv lw lx nh lz ma mb ni md me li im bi translated">简单线性回归是一种只有一个独立变量<code class="fe oa ob oc od b">X</code>的模型。它由下式给出:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ox"><img src="../Images/14add7616484510023ab597668cdd6f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:430/format:webp/1*NnWcMrpCcC9CC7-LEB_0zw.png"/></div></figure><p id="b9f6" class="pw-post-body-paragraph lk ll it lm b ln mf ju lp lq mg jx ls lt mh lv lw lx mi lz ma mb mj md me li im bi translated">其中 a 和 b 是在我们的模型训练期间学习的参数。<em class="nn"> X </em>是我们将要用来训练我们的模型的数据，<em class="nn"> b </em>控制斜率，<em class="nn"> a </em>与<em class="nn"> y </em>轴的交点。</p><h2 id="6c6a" class="ol mn it bd mo om on dn ms oo op dp mw lt oq or my lx os ot na mb ou ov nc ow bi translated">多元线性回归</h2><p id="40d8" class="pw-post-body-paragraph lk ll it lm b ln ne ju lp lq nf jx ls lt ng lv lw lx nh lz ma mb ni md me li im bi translated">多元线性回归模型是简单线性回归模型的自然延伸。它由下式给出:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oy"><img src="../Images/ab806bfd2ea8df998342f24deb18c186.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-dWOADKMOWjpgozPskLaJg.png"/></div></div></figure><p id="8ffb" class="pw-post-body-paragraph lk ll it lm b ln mf ju lp lq mg jx ls lt mh lv lw lx mi lz ma mb mj md me li im bi translated">其中，x1，x2，…，xn 是数据集的特征，w1，w2，…，wn 是学习参数。</p><h2 id="a0bf" class="ol mn it bd mo om on dn ms oo op dp mw lt oq or my lx os ot na mb ou ov nc ow bi translated">损失函数</h2><p id="f3f1" class="pw-post-body-paragraph lk ll it lm b ln ne ju lp lq nf jx ls lt ng lv lw lx nh lz ma mb ni md me li im bi translated">我们将使用<a class="ae nj" href="https://en.wikipedia.org/wiki/Root-mean-square_deviation" rel="noopener ugc nofollow" target="_blank">均方根误差</a>来衡量我们的预测与实际房价的差距。它由下式给出:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oz"><img src="../Images/b91dc0ab53d00c7a5a82fb821ecb26f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bJebKf90motucl_xAjy6uA.png"/></div></div></figure><p id="77d6" class="pw-post-body-paragraph lk ll it lm b ln mf ju lp lq mg jx ls lt mh lv lw lx mi lz ma mb mj md me li im bi translated">其中假设/预测<em class="nn"> hw </em>由下式给出:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pa"><img src="../Images/73bd3a4926584282de3636231b3124bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:580/format:webp/1*CxDqzRBCE9Oc40bxaeQekQ.png"/></div></figure><h1 id="a77d" class="mm mn it bd mo mp mq mr ms mt mu mv mw jz mx ka my kc mz kd na kf nb kg nc nd bi translated">数据预处理</h1><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="pb ml l"/></div></figure><p id="3235" class="pw-post-body-paragraph lk ll it lm b ln mf ju lp lq mg jx ls lt mh lv lw lx mi lz ma mb mj md me li im bi translated">目前，我们的数据存放在一个 JS 对象数组中。我们需要把它变成张量，并用它来训练我们的模型。下面是代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oj ml l"/></div></figure><p id="ac95" class="pw-post-body-paragraph lk ll it lm b ln mf ju lp lq mg jx ls lt mh lv lw lx mi lz ma mb mj md me li im bi translated">我们将特征存储在<code class="fe oa ob oc od b">X</code>中，将标签存储在<code class="fe oa ob oc od b">y</code>中。然后，我们将数据转换为张量，并将其分成训练和测试数据集。</p><h2 id="0faf" class="ol mn it bd mo om on dn ms oo op dp mw lt oq or my lx os ot na mb ou ov nc ow bi translated">分类特征</h2><p id="1c74" class="pw-post-body-paragraph lk ll it lm b ln ne ju lp lq nf jx ls lt ng lv lw lx nh lz ma mb ni md me li im bi translated">我们数据集中的一些要素是分类的/可枚举的。例如，<code class="fe oa ob oc od b">GarageCars</code>可以在 0-5 的范围内。</p><p id="2833" class="pw-post-body-paragraph lk ll it lm b ln mf ju lp lq mg jx ls lt mh lv lw lx mi lz ma mb mj md me li im bi translated">在我们的数据集中用整数表示类别可能会引入隐含的排序依赖。不存在分类变量的事物。</p><p id="9b95" class="pw-post-body-paragraph lk ll it lm b ln mf ju lp lq mg jx ls lt mh lv lw lx mi lz ma mb mj md me li im bi translated">我们将使用 TensorFlow 的<a class="ae nj" href="https://en.wikipedia.org/wiki/One-hot" rel="noopener ugc nofollow" target="_blank">一键编码</a>为每个值创建一个整数向量，以打破排序。首先，让我们指定每个类别有多少不同的值:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oj ml l"/></div></figure><p id="8f04" class="pw-post-body-paragraph lk ll it lm b ln mf ju lp lq mg jx ls lt mh lv lw lx mi lz ma mb mj md me li im bi translated">我们将使用<a class="ae nj" href="https://js.tensorflow.org/api/latest/#oneHot" rel="noopener ugc nofollow" target="_blank"> tf.oneHot() </a>将单个值转换成一个 Hot 表示:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oj ml l"/></div></figure><p id="10b4" class="pw-post-body-paragraph lk ll it lm b ln mf ju lp lq mg jx ls lt mh lv lw lx mi lz ma mb mj md me li im bi translated">注意，<code class="fe oa ob oc od b">createDataSets()</code>函数接受一个名为<code class="fe oa ob oc od b">categoricalFeatures</code>的参数，它应该是一个集合。我们将使用它来检查我们是否应该将该特征作为分类来处理。</p><h2 id="f76e" class="ol mn it bd mo om on dn ms oo op dp mw lt oq or my lx os ot na mb ou ov nc ow bi translated">特征缩放</h2><p id="7dca" class="pw-post-body-paragraph lk ll it lm b ln ne ju lp lq nf jx ls lt ng lv lw lx nh lz ma mb ni md me li im bi translated"><a class="ae nj" href="https://en.wikipedia.org/wiki/Feature_scaling" rel="noopener ugc nofollow" target="_blank">特征缩放</a>用于将特征值转换到一个(相似的)范围内。<a class="ae nj" href="https://arxiv.org/abs/1502.03167" rel="noopener ugc nofollow" target="_blank">特征缩放将帮助我们的模型学习得更快</a>，因为我们使用<a class="ae nj" href="https://en.wikipedia.org/wiki/Gradient_descent" rel="noopener ugc nofollow" target="_blank">梯度下降</a>来训练它。</p><p id="bc36" class="pw-post-body-paragraph lk ll it lm b ln mf ju lp lq mg jx ls lt mh lv lw lx mi lz ma mb mj md me li im bi translated">让我们使用一种最简单的特征缩放方法—最小-最大归一化:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oj ml l"/></div></figure><p id="dc4e" class="pw-post-body-paragraph lk ll it lm b ln mf ju lp lq mg jx ls lt mh lv lw lx mi lz ma mb mj md me li im bi translated">此方法在[0，1]的范围内重新调整值的范围。</p><h1 id="cd9f" class="mm mn it bd mo mp mq mr ms mt mu mv mw jz mx ka my kc mz kd na kf nb kg nc nd bi translated">预测房价</h1><p id="55ae" class="pw-post-body-paragraph lk ll it lm b ln ne ju lp lq nf jx ls lt ng lv lw lx nh lz ma mb ni md me li im bi translated">既然我们知道了线性回归模型，我们就可以根据现有的数据来预测房价。让我们从简单的开始:</p><h2 id="996c" class="ol mn it bd mo om on dn ms oo op dp mw lt oq or my lx os ot na mb ou ov nc ow bi translated">构建简单的线性回归模型</h2><p id="2ec3" class="pw-post-body-paragraph lk ll it lm b ln ne ju lp lq nf jx ls lt ng lv lw lx nh lz ma mb ni md me li im bi translated">我们将把培训过程封装在一个函数中，以便在未来的模型中重用:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oj ml l"/></div></figure><p id="c364" class="pw-post-body-paragraph lk ll it lm b ln mf ju lp lq mg jx ls lt mh lv lw lx mi lz ma mb mj md me li im bi translated"><code class="fe oa ob oc od b">trainLinearModel</code>接受我们模型的特性和标签。让我们使用 TensorFlow 定义一个线性回归模型:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oj ml l"/></div></figure><p id="2c7f" class="pw-post-body-paragraph lk ll it lm b ln mf ju lp lq mg jx ls lt mh lv lw lx mi lz ma mb mj md me li im bi translated">由于 TensorFlow.js 不提供 RMSE 损失函数，我们将使用 MSE，并在稍后计算它的平方根。我们还将跟踪预测价格和实际价格之间的平均绝对误差(MAE ):</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oj ml l"/></div></figure><p id="74e9" class="pw-post-body-paragraph lk ll it lm b ln mf ju lp lq mg jx ls lt mh lv lw lx mi lz ma mb mj md me li im bi translated">以下是培训过程:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oj ml l"/></div></figure><p id="2f8f" class="pw-post-body-paragraph lk ll it lm b ln mf ju lp lq mg jx ls lt mh lv lw lx mi lz ma mb mj md me li im bi translated">我们针对<em class="nn"> 100 </em>个时期进行训练，预先对数据进行洗牌，并使用其中的<em class="nn"> 10% </em>进行验证。RMSE 和梅在每一个时代之后都是可视化的。</p><h2 id="53db" class="ol mn it bd mo om on dn ms oo op dp mw lt oq or my lx os ot na mb ou ov nc ow bi translated">培养</h2><p id="f8fb" class="pw-post-body-paragraph lk ll it lm b ln ne ju lp lq nf jx ls lt ng lv lw lx nh lz ma mb ni md me li im bi translated">我们的简单线性回归模型使用了<em class="nn"> GrLivArea </em>特性:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oj ml l"/></div></figure><p id="5e16" class="pw-post-body-paragraph lk ll it lm b ln mf ju lp lq mg jx ls lt mh lv lw lx mi lz ma mb mj md me li im bi translated">我们没有明确的特征，所以我们让这个集合为空。让我们来看看表演:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pc"><img src="../Images/28fdc5fdfa094fd83ece240f58449e42.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SPNd4vkKCvSTlXqM0eT37Q.png"/></div></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pc"><img src="../Images/bc931dff49ecb4ddb9d060b9862ab261.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*35r_lPMBz-6DS6Y9NvdZSQ.png"/></div></div></figure><h2 id="1f7c" class="ol mn it bd mo om on dn ms oo op dp mw lt oq or my lx os ot na mb ou ov nc ow bi translated">建立多元线性回归模型</h2><p id="9f82" class="pw-post-body-paragraph lk ll it lm b ln ne ju lp lq nf jx ls lt ng lv lw lx nh lz ma mb ni md me li im bi translated">我们还有很多没用过的数据。让我们看看这是否有助于改善预测:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oj ml l"/></div></figure><p id="191c" class="pw-post-body-paragraph lk ll it lm b ln mf ju lp lq mg jx ls lt mh lv lw lx mi lz ma mb mj md me li im bi translated">我们使用数据集中的所有要素，并传递一组分类要素。我们做得更好吗？</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pc"><img src="../Images/ef147c20a60cb5c46f3d794f30cceb99.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*S_9noM5kkKDEagU82Pec7g.png"/></div></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pc"><img src="../Images/ef8d2b176c5e613e8b9744e3e06de6a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*I4XYac95Q0Lo0WxaW3_rZA.png"/></div></div></figure><p id="5f31" class="pw-post-body-paragraph lk ll it lm b ln mf ju lp lq mg jx ls lt mh lv lw lx mi lz ma mb mj md me li im bi translated">总的来说，这两种型号的性能大致相同。这一次，增加模型的复杂性并没有给我们带来更好的准确性。</p><h1 id="aa21" class="mm mn it bd mo mp mq mr ms mt mu mv mw jz mx ka my kc mz kd na kf nb kg nc nd bi translated">估价</h1><p id="146d" class="pw-post-body-paragraph lk ll it lm b ln ne ju lp lq nf jx ls lt ng lv lw lx nh lz ma mb ni md me li im bi translated">评估我们模型的另一种方法是对照测试数据检查它们的预测。让我们从简单的线性回归开始:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ok"><img src="../Images/1e676ccd6bfc6711017aa8fff9c901da.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-i-rPSBL3sBXqfnyNUAzuw.png"/></div></div></figure><p id="1a4e" class="pw-post-body-paragraph lk ll it lm b ln mf ju lp lq mg jx ls lt mh lv lw lx mi lz ma mb mj md me li im bi translated">添加更多的数据是如何改善预测的？</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ok"><img src="../Images/3e58c34c35fe6d7592d0f7ff23aff5dc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*L1xSDQa5OoARVy7oPCJ6pg.png"/></div></div></figure><p id="1c33" class="pw-post-body-paragraph lk ll it lm b ln mf ju lp lq mg jx ls lt mh lv lw lx mi lz ma mb mj md me li im bi translated">但事实并非如此。同样，用更多数据训练更复杂的模型并不能提供更好的性能。</p><h1 id="ad49" class="mm mn it bd mo mp mq mr ms mt mu mv mw jz mx ka my kc mz kd na kf nb kg nc nd bi translated">结论</h1><p id="fda8" class="pw-post-body-paragraph lk ll it lm b ln ne ju lp lq nf jx ls lt ng lv lw lx nh lz ma mb ni md me li im bi translated">你做到了！您构建了两个线性回归模型，根据一组特征预测房价。你也做到了:</p><p id="456a" class="pw-post-body-paragraph lk ll it lm b ln mf ju lp lq mg jx ls lt mh lv lw lx mi lz ma mb mj md me li im bi translated">-特征缩放以加快模型训练</p><p id="da7c" class="pw-post-body-paragraph lk ll it lm b ln mf ju lp lq mg jx ls lt mh lv lw lx mi lz ma mb mj md me li im bi translated">-将分类变量转换为一键表示</p><p id="71f8" class="pw-post-body-paragraph lk ll it lm b ln mf ju lp lq mg jx ls lt mh lv lw lx mi lz ma mb mj md me li im bi translated">-实施 RMSE(基于 MSE)进行精度评估</p><p id="ccea" class="pw-post-body-paragraph lk ll it lm b ln mf ju lp lq mg jx ls lt mh lv lw lx mi lz ma mb mj md me li im bi translated"><strong class="lm iu">在浏览器中运行本教程的完整源代码:</strong></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mk ml l"/></div></figure><p id="1c1a" class="pw-post-body-paragraph lk ll it lm b ln mf ju lp lq mg jx ls lt mh lv lw lx mi lz ma mb mj md me li im bi translated">是时候学习神经网络了吗？</p><h1 id="bb4e" class="mm mn it bd mo mp mq mr ms mt mu mv mw jz mx ka my kc mz kd na kf nb kg nc nd bi translated">参考</h1><p id="fe80" class="pw-post-body-paragraph lk ll it lm b ln ne ju lp lq nf jx ls lt ng lv lw lx nh lz ma mb ni md me li im bi translated"><a class="ae nj" href="https://www.pluralsight.com/guides/handling-categorical-data-in-machine-learning-models" rel="noopener ugc nofollow" target="_blank">处理机器学习模型中的分类数据</a></p><p id="8392" class="pw-post-body-paragraph lk ll it lm b ln mf ju lp lq mg jx ls lt mh lv lw lx mi lz ma mb mj md me li im bi translated"><a class="ae nj" href="https://sebastianraschka.com/Articles/2014_about_feature_scaling.html" rel="noopener ugc nofollow" target="_blank">关于特征缩放和归一化</a></p><p id="e90c" class="pw-post-body-paragraph lk ll it lm b ln mf ju lp lq mg jx ls lt mh lv lw lx mi lz ma mb mj md me li im bi translated"><a class="ae nj" href="https://www.statisticshowto.datasciencecentral.com/rmse/" rel="noopener ugc nofollow" target="_blank"> RMSE:均方根误差</a></p></div><div class="ab cl pd pe hx pf" role="separator"><span class="pg bw bk ph pi pj"/><span class="pg bw bk ph pi pj"/><span class="pg bw bk ph pi"/></div><div class="im in io ip iq"><p id="cd64" class="pw-post-body-paragraph lk ll it lm b ln mf ju lp lq mg jx ls lt mh lv lw lx mi lz ma mb mj md me li im bi translated"><em class="nn">最初发表于</em><a class="ae nj" href="https://www.curiousily.com/posts/predicting-house-prices-using-linear-regression-with-tensorflow-js/" rel="noopener ugc nofollow" target="_blank"><em class="nn">https://www.curiousily.com</em></a><em class="nn">。</em></p></div><div class="ab cl pd pe hx pf" role="separator"><span class="pg bw bk ph pi pj"/><span class="pg bw bk ph pi pj"/><span class="pg bw bk ph pi"/></div><div class="im in io ip iq"><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mk ml l"/></div></figure></div><div class="ab cl pd pe hx pf" role="separator"><span class="pg bw bk ph pi pj"/><span class="pg bw bk ph pi pj"/><span class="pg bw bk ph pi"/></div><div class="im in io ip iq"><p id="57fd" class="pw-post-body-paragraph lk ll it lm b ln mf ju lp lq mg jx ls lt mh lv lw lx mi lz ma mb mj md me li im bi translated">建立机器学习模型(特别是深度神经网络)，可以轻松地与现有或新的 web 应用程序集成。想想您的 ReactJs、Vue 或 Angular 应用程序通过机器学习模型的强大功能得到了增强:</p><div class="pk pl gp gr pm pn"><a href="https://leanpub.com/deep-learning-for-javascript-hackers" rel="noopener  ugc nofollow" target="_blank"><div class="po ab fo"><div class="pp ab pq cl cj pr"><h2 class="bd iu gy z fp ps fr fs pt fu fw is bi translated">JavaScript 黑客的深度学习</h2><div class="pu l"><h3 class="bd b gy z fp ps fr fs pt fu fw dk translated">建立机器学习模型(特别是深度神经网络)，您可以轻松地与现有或新的网络集成…</h3></div><div class="pv l"><p class="bd b dl z fp ps fr fs pt fu fw dk translated">leanpub.com</p></div></div><div class="pw l"><div class="px l py pz qa pw qb ks pn"/></div></div></a></div></div></div>    
</body>
</html>