<html>
<head>
<title>Machine Learning: Simple Linear Regression with Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">机器学习:用 Python 实现简单线性回归</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/machine-learning-simple-linear-regression-with-python-f04ecfdadc13?source=collection_archive---------6-----------------------#2019-03-18">https://towardsdatascience.com/machine-learning-simple-linear-regression-with-python-f04ecfdadc13?source=collection_archive---------6-----------------------#2019-03-18</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="4cdb" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">在这篇文章中，我们将指导你使用简单的线性回归来进行机器学习的第一步。</h2></div><h1 id="a520" class="kg kh iq bd ki kj kk kl km kn ko kp kq jw kr jx ks jz kt ka ku kc kv kd kw kx bi translated">什么是线性？</h1><p id="4d4d" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">首先，假设你正在沃尔玛购物。不管你买不买东西，你都要付 2 美元的停车票。每个苹果的价格是 1.5 美元，你必须购买一个(<em class="lu"> x) </em>的苹果。然后，我们可以填充如下价格列表:</p><figure class="lw lx ly lz gt ma gh gi paragraph-image"><div class="gh gi lv"><img src="../Images/b19e404b1ecccbffcfb4d0e7f916a6dc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1224/format:webp/1*Omu6iJl1GuykwHP5x8IkTg.png"/></div><figcaption class="md me gj gh gi mf mg bd b be z dk">Crosstab (Quantity &amp; Price) for apple at Walmart</figcaption></figure><p id="169b" class="pw-post-body-paragraph ky kz iq la b lb mh jr ld le mi ju lg lh mj lj lk ll mk ln lo lp ml lr ls lt ij bi translated">对于本例，使用公式<strong class="la ir"> <em class="lu"> y=2+1.5x </em> </strong>很容易预测(或计算)基于价值的价格，反之亦然，或者:</p><figure class="lw lx ly lz gt ma gh gi paragraph-image"><div class="gh gi mm"><img src="../Images/11e7017bd056ed449e2aeee776c2eadd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1202/format:webp/1*iE4xdqJgjh_5sAxsViHMEA.png"/></div><figcaption class="md me gj gh gi mf mg bd b be z dk">Linear Functions</figcaption></figure><p id="3a52" class="pw-post-body-paragraph ky kz iq la b lb mh jr ld le mi ju lg lh mj lj lk ll mk ln lo lp ml lr ls lt ij bi translated">使用:</p><ul class=""><li id="1e62" class="mn mo iq la b lb mh le mi lh mp ll mq lp mr lt ms mt mu mv bi translated">a = 2</li><li id="7eca" class="mn mo iq la b lb mw le mx lh my ll mz lp na lt ms mt mu mv bi translated">b = 1.5</li></ul><p id="a71c" class="pw-post-body-paragraph ky kz iq la b lb mh jr ld le mi ju lg lh mj lj lk ll mk ln lo lp ml lr ls lt ij bi translated">一个<strong class="la ir">线性函数</strong>有一个自变量和一个因变量。自变量为<strong class="la ir"> <em class="lu"> x </em> </strong>因变量为<strong class="la ir"> <em class="lu"> y </em> </strong>。</p><ul class=""><li id="6dbb" class="mn mo iq la b lb mh le mi lh mp ll mq lp mr lt ms mt mu mv bi translated"><strong class="la ir"><em class="lu"/></strong>是常数项或 y 截距。是<strong class="la ir"> <em class="lu"> x </em> </strong> = 0 时因变量的值。</li><li id="ca38" class="mn mo iq la b lb mw le mx lh my ll mz lp na lt ms mt mu mv bi translated"><strong class="la ir"> <em class="lu"> b </em> </strong>是自变量的系数。它也被称为斜率，给出了因变量的变化率。</li></ul><p id="731d" class="pw-post-body-paragraph ky kz iq la b lb mh jr ld le mi ju lg lh mj lj lk ll mk ln lo lp ml lr ls lt ij bi translated">为什么我们称之为线性？好了，让我们把上面得到的数据集可视化吧！</p><figure class="lw lx ly lz gt ma gh gi paragraph-image"><div role="button" tabindex="0" class="nc nd di ne bf nf"><div class="gh gi nb"><img src="../Images/8965ca2c57b039150575482eb252cc5b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lJAUpLSlcReLEkAwSXbG1A.png"/></div></div><figcaption class="md me gj gh gi mf mg bd b be z dk">Shopping cost (y = 1.5x + 2)</figcaption></figure><p id="e1d0" class="pw-post-body-paragraph ky kz iq la b lb mh jr ld le mi ju lg lh mj lj lk ll mk ln lo lp ml lr ls lt ij bi translated">在标绘购物成本的所有值(蓝线)后，你可以看到，它们都在<strong class="la ir">一条线</strong>上，这就是为什么我们称之为<strong class="la ir"><em class="lu"/></strong>。用线性方程(y=a+bx)，a 是自变量。即使 a=0(停车票不用你出)，购物成本线也会下移，他们还是在一条线上(橙色线)。</p><figure class="lw lx ly lz gt ma gh gi paragraph-image"><div role="button" tabindex="0" class="nc nd di ne bf nf"><div class="gh gi ng"><img src="../Images/fefd079b1332bb63bbb823dc5878c91a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uYDswmQMj-YbxAVLJ2RtGA.png"/></div></div><figcaption class="md me gj gh gi mf mg bd b be z dk">Shopping cost (y = 1.5x)</figcaption></figure><h1 id="4ab8" class="kg kh iq bd ki kj kk kl km kn ko kp kq jw kr jx ks jz kt ka ku kc kv kd kw kx bi translated">但是在现实生活中，事情并没有那么简单！</h1><p id="aa29" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">我们再举一个例子，在 AB 公司，有一个基于工作年限的工资分配表，如下所示:</p><figure class="lw lx ly lz gt ma gh gi paragraph-image"><div class="gh gi nh"><img src="../Images/52376219bd04220d4678fbdd869844b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:526/format:webp/1*g5JCA1qiprxNhAyA9IhO7A.png"/></div><figcaption class="md me gj gh gi mf mg bd b be z dk">Salary based on Years of Experience (<a class="ae ni" href="https://s3.us-west-2.amazonaws.com/public.gamelab.fun/dataset/salary_data.csv" rel="noopener ugc nofollow" target="_blank">salary_data.csv</a>)</figcaption></figure><p id="7b5c" class="pw-post-body-paragraph ky kz iq la b lb mh jr ld le mi ju lg lh mj lj lk ll mk ln lo lp ml lr ls lt ij bi translated">假设你是一名人力资源主管，你得到了一名有 5 年工作经验的候选人。那你应该给他开出的最好工资是多少？” </p><p id="98ab" class="pw-post-body-paragraph ky kz iq la b lb mh jr ld le mi ju lg lh mj lj lk ll mk ln lo lp ml lr ls lt ij bi translated">在深入探讨这个问题之前，让我们先将数据集绘制到图中:</p><figure class="lw lx ly lz gt ma gh gi paragraph-image"><div role="button" tabindex="0" class="nc nd di ne bf nf"><div class="gh gi nj"><img src="../Images/6a7c02626110c0a8aaf7fbf5f3917a72.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BU2zrxl3E1o3_xiVNU-fdw.png"/></div></div><figcaption class="md me gj gh gi mf mg bd b be z dk">Salary Data on Scatter Plot</figcaption></figure><p id="f0e1" class="pw-post-body-paragraph ky kz iq la b lb mh jr ld le mi ju lg lh mj lj lk ll mk ln lo lp ml lr ls lt ij bi translated">请仔细看这张图表。现在我们有一个坏消息:所有的观察结果都不在一条线上。这意味着我们找不到计算(y)值的方程。</p><p id="02fe" class="pw-post-body-paragraph ky kz iq la b lb mh jr ld le mi ju lg lh mj lj lk ll mk ln lo lp ml lr ls lt ij bi translated">那现在怎么办？别担心，我们有好消息要告诉你！</p><p id="9af0" class="pw-post-body-paragraph ky kz iq la b lb mh jr ld le mi ju lg lh mj lj lk ll mk ln lo lp ml lr ls lt ij bi translated">向下滚动之前，再次查看散点图。你看到了吗？</p><p id="cdf5" class="pw-post-body-paragraph ky kz iq la b lb mh jr ld le mi ju lg lh mj lj lk ll mk ln lo lp ml lr ls lt ij bi translated">所有的点不在一条直线上，但是它们在一条直线上！<strong class="la ir">是线性的！</strong></p><figure class="lw lx ly lz gt ma gh gi paragraph-image"><div role="button" tabindex="0" class="nc nd di ne bf nf"><div class="gh gi nk"><img src="../Images/ab699b0421a39b47beb759c9e6686ed9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5ZOxDGtFsewBEve9FG5DQQ.png"/></div></div><figcaption class="md me gj gh gi mf mg bd b be z dk">Salary Data on Scatter Plot with linear shape</figcaption></figure><p id="411b" class="pw-post-body-paragraph ky kz iq la b lb mh jr ld le mi ju lg lh mj lj lk ll mk ln lo lp ml lr ls lt ij bi translated">根据我们的观察，我们可以猜测 5 年经验的薪资范围应该在红色范围内。当然，我们可以向候选人提供红色范围内的任何数字。但是如何挑选最适合他的号码呢？是时候使用机器学习来预测我们候选人的最佳薪酬了。</p><p id="37a3" class="pw-post-body-paragraph ky kz iq la b lb mh jr ld le mi ju lg lh mj lj lk ll mk ln lo lp ml lr ls lt ij bi translated">在本节中，我们将在 Spyder IDE 上使用 Python 来为我们的候选人找到最佳工资。好吧，我们开始吧！</p><h1 id="7eab" class="kg kh iq bd ki kj kk kl km kn ko kp kq jw kr jx ks jz kt ka ku kc kv kd kw kx bi translated">用 Python 实现线性回归</h1><p id="2903" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">在继续之前，我们总结了机器学习的两个基本步骤如下:</p><ol class=""><li id="ef30" class="mn mo iq la b lb mh le mi lh mp ll mq lp mr lt nl mt mu mv bi translated">培养</li><li id="23d9" class="mn mo iq la b lb mw le mx lh my ll mz lp na lt nl mt mu mv bi translated">预测</li></ol><p id="fcc4" class="pw-post-body-paragraph ky kz iq la b lb mh jr ld le mi ju lg lh mj lj lk ll mk ln lo lp ml lr ls lt ij bi translated">好的，我们将使用 4 个库，如<code class="fe nm nn no np b">numpy</code>和<code class="fe nm nn no np b">pandas</code>来处理数据集，<code class="fe nm nn no np b">sklearn</code>来实现机器学习功能，<code class="fe nm nn no np b">matplotlib</code>来可视化我们的绘图以供查看:</p><figure class="lw lx ly lz gt ma"><div class="bz fp l di"><div class="nq nr l"/></div></figure><p id="489e" class="pw-post-body-paragraph ky kz iq la b lb mh jr ld le mi ju lg lh mj lj lk ll mk ln lo lp ml lr ls lt ij bi translated">代码解释:</p><ul class=""><li id="b0c4" class="mn mo iq la b lb mh le mi lh mp ll mq lp mr lt ms mt mu mv bi translated"><code class="fe nm nn no np b">dataset</code>:该表包含了我们 csv 文件中的所有值</li><li id="76d1" class="mn mo iq la b lb mw le mx lh my ll mz lp na lt ms mt mu mv bi translated"><code class="fe nm nn no np b">X</code>:包含年经验数组的第一列</li><li id="4fe5" class="mn mo iq la b lb mw le mx lh my ll mz lp na lt ms mt mu mv bi translated"><code class="fe nm nn no np b">y</code>:包含薪资数组的最后一列</li></ul><p id="a98e" class="pw-post-body-paragraph ky kz iq la b lb mh jr ld le mi ju lg lh mj lj lk ll mk ln lo lp ml lr ls lt ij bi translated">接下来，我们必须将数据集(总共 30 个观察值)分成 2 组:用于训练的训练集和用于测试的测试集:</p><figure class="lw lx ly lz gt ma"><div class="bz fp l di"><div class="nq nr l"/></div></figure><p id="8587" class="pw-post-body-paragraph ky kz iq la b lb mh jr ld le mi ju lg lh mj lj lk ll mk ln lo lp ml lr ls lt ij bi translated">代码解释:</p><ul class=""><li id="a618" class="mn mo iq la b lb mh le mi lh mp ll mq lp mr lt ms mt mu mv bi translated"><code class="fe nm nn no np b">test_size=1/3</code>:我们将我们的数据集(30 个观察值)分成两部分(训练集、测试集)，并且<strong class="la ir">测试集</strong>与数据集的比率是 1/3 (10 个观察值将被放入<strong class="la ir">测试集</strong>)。你可以放 1/2 得到 50%或者 0.5，它们是一样的。我们不应该让测试集太大；如果它太大，我们将缺乏数据来训练。通常情况下，我们应该选择 5%到 30%左右。</li><li id="0bb8" class="mn mo iq la b lb mw le mx lh my ll mz lp na lt ms mt mu mv bi translated"><code class="fe nm nn no np b">train_size</code>:如果我们已经使用了 test_size，其余的数据将自动分配给 train_size。</li><li id="91cb" class="mn mo iq la b lb mw le mx lh my ll mz lp na lt ms mt mu mv bi translated"><code class="fe nm nn no np b">random_state</code>:这是随机数生成器的种子。我们也可以放一个<code class="fe nm nn no np b">RandomState</code>类的实例。如果我们将其留空或为 0，将使用由<code class="fe nm nn no np b">np.random</code>使用的<code class="fe nm nn no np b">RandomState</code>实例。</li></ul><p id="0b95" class="pw-post-body-paragraph ky kz iq la b lb mh jr ld le mi ju lg lh mj lj lk ll mk ln lo lp ml lr ls lt ij bi translated">我们已经有了训练集和测试集，现在我们必须构建回归模型:</p><figure class="lw lx ly lz gt ma"><div class="bz fp l di"><div class="nq nr l"/></div></figure><p id="e541" class="pw-post-body-paragraph ky kz iq la b lb mh jr ld le mi ju lg lh mj lj lk ll mk ln lo lp ml lr ls lt ij bi translated">代码解释:</p><ul class=""><li id="cf16" class="mn mo iq la b lb mh le mi lh mp ll mq lp mr lt ms mt mu mv bi translated"><code class="fe nm nn no np b">regressor = LinearRegression()</code>:我们的训练模型，将实现线性回归。</li><li id="91fe" class="mn mo iq la b lb mw le mx lh my ll mz lp na lt ms mt mu mv bi translated"><code class="fe nm nn no np b">regressor.fit</code>:在这一行中，我们通过包含<strong class="la ir">年经历</strong>值的<code class="fe nm nn no np b">X_train</code>和包含<strong class="la ir">具体薪资</strong>值的<code class="fe nm nn no np b">y_train</code>来组成模型。这是训练过程。</li></ul><p id="8d9e" class="pw-post-body-paragraph ky kz iq la b lb mh jr ld le mi ju lg lh mj lj lk ll mk ln lo lp ml lr ls lt ij bi translated">让我们设想一下我们的培训模型和测试模型:</p><figure class="lw lx ly lz gt ma"><div class="bz fp l di"><div class="nq nr l"/></div></figure><p id="bbc3" class="pw-post-body-paragraph ky kz iq la b lb mh jr ld le mi ju lg lh mj lj lk ll mk ln lo lp ml lr ls lt ij bi translated">运行上述代码后，您将在控制台窗口中看到两个图:</p><figure class="lw lx ly lz gt ma gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/ecb5f8be3a9ba2b5ee84d5ba3075ef29.png" data-original-src="https://miro.medium.com/v2/resize:fit:822/format:webp/1*6BiMLXzGY20lpNaMsx_Mjg.png"/></div><figcaption class="md me gj gh gi mf mg bd b be z dk">Training Set</figcaption></figure><figure class="lw lx ly lz gt ma gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/95028f9ec35bf1af136b4c5acb545d79.png" data-original-src="https://miro.medium.com/v2/resize:fit:822/format:webp/1*cQmFfKyGjJoMFO1NT3FSLw.png"/></div><figcaption class="md me gj gh gi mf mg bd b be z dk">Test Set</figcaption></figure><p id="e745" class="pw-post-body-paragraph ky kz iq la b lb mh jr ld le mi ju lg lh mj lj lk ll mk ln lo lp ml lr ls lt ij bi translated">比较两幅图，我们可以看到两条蓝线是同一个方向。我们的模型现在很好用。</p><p id="a29a" class="pw-post-body-paragraph ky kz iq la b lb mh jr ld le mi ju lg lh mj lj lk ll mk ln lo lp ml lr ls lt ij bi translated">好吧！我们已经有了模型，现在我们可以用它来计算(预测)<em class="lu">X 的任何值取决于 y </em>或<em class="lu">y 的任何值取决于 X </em>。我们是这样做的:</p><figure class="lw lx ly lz gt ma"><div class="bz fp l di"><div class="nq nr l"/></div></figure><figure class="lw lx ly lz gt ma gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/706c13dc335c2eeb5a7759a6ed4fdd7e.png" data-original-src="https://miro.medium.com/v2/resize:fit:854/format:webp/1*O0l-DFJijAFhcGGtx1P3KA.png"/></div><figcaption class="md me gj gh gi mf mg bd b be z dk"><code class="fe nm nn no np b">Predict y_pred</code> using single value of X=5</figcaption></figure><p id="1c9c" class="pw-post-body-paragraph ky kz iq la b lb mh jr ld le mi ju lg lh mj lj lk ll mk ln lo lp ml lr ls lt ij bi translated">答对了。<strong class="la ir"> X = 5 </strong> (5 年经验)的<code class="fe nm nn no np b">y_pred</code>值为 73545.90</p><p id="3a10" class="pw-post-body-paragraph ky kz iq la b lb mh jr ld le mi ju lg lh mj lj lk ll mk ln lo lp ml lr ls lt ij bi translated">你可以向你的候选人提供 73，545.90 美元的薪水，这对他来说是最好的薪水了！</p><p id="e21d" class="pw-post-body-paragraph ky kz iq la b lb mh jr ld le mi ju lg lh mj lj lk ll mk ln lo lp ml lr ls lt ij bi translated">我们也可以传递一个 X 的<strong class="la ir">数组，而不是 X </strong>的<strong class="la ir">单值:</strong></p><figure class="lw lx ly lz gt ma"><div class="bz fp l di"><div class="nq nr l"/></div></figure><figure class="lw lx ly lz gt ma gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/ea25abf6f369c661ab7006d1905df584.png" data-original-src="https://miro.medium.com/v2/resize:fit:804/format:webp/1*4QjhqpPXy2H3vAPyuoHJAg.png"/></div><figcaption class="md me gj gh gi mf mg bd b be z dk"><code class="fe nm nn no np b">Predict y_pred</code> using array of X_test</figcaption></figure><p id="9661" class="pw-post-body-paragraph ky kz iq la b lb mh jr ld le mi ju lg lh mj lj lk ll mk ln lo lp ml lr ls lt ij bi translated">我们也可以用 y 来预测 X。你自己试试吧！</p><p id="a20a" class="pw-post-body-paragraph ky kz iq la b lb mh jr ld le mi ju lg lh mj lj lk ll mk ln lo lp ml lr ls lt ij bi translated"><strong class="la ir">总之，对于简单的线性回归，我们必须按照以下 5 个步骤进行:</strong></p><ol class=""><li id="cfae" class="mn mo iq la b lb mh le mi lh mp ll mq lp mr lt nl mt mu mv bi translated">导入数据集。</li><li id="5c18" class="mn mo iq la b lb mw le mx lh my ll mz lp na lt nl mt mu mv bi translated">将数据集分成训练集和测试集(每个集有 X 和 y 两个维度)。通常，测试集应该是数据集的 5%到 30%。</li><li id="3ac7" class="mn mo iq la b lb mw le mx lh my ll mz lp na lt nl mt mu mv bi translated">将训练集和测试集可视化以进行双重检查(如果需要，可以绕过这一步)。</li><li id="e297" class="mn mo iq la b lb mw le mx lh my ll mz lp na lt nl mt mu mv bi translated">初始化回归模型并使用训练集(X 和 y)对其进行拟合。</li><li id="7b02" class="mn mo iq la b lb mw le mx lh my ll mz lp na lt nl mt mu mv bi translated">我们来预测一下！！</li></ol><p id="1a9c" class="pw-post-body-paragraph ky kz iq la b lb mh jr ld le mi ju lg lh mj lj lk ll mk ln lo lp ml lr ls lt ij bi translated"><strong class="la ir">资源:</strong></p><ul class=""><li id="a06a" class="mn mo iq la b lb mh le mi lh mp ll mq lp mr lt ms mt mu mv bi translated"><a class="ae ni" href="https://s3.us-west-2.amazonaws.com/public.gamelab.fun/dataset/salary_data.csv" rel="noopener ugc nofollow" target="_blank"> salary_data.csv </a></li><li id="e8e2" class="mn mo iq la b lb mw le mx lh my ll mz lp na lt ms mt mu mv bi translated"><a class="ae ni" href="https://gist.github.com/panicpotatoe/14d9c7a5a25566a58143e7069813629f" rel="noopener ugc nofollow" target="_blank">简单 _ 线性 _ 回归. py </a></li></ul><p id="cacb" class="pw-post-body-paragraph ky kz iq la b lb mh jr ld le mi ju lg lh mj lj lk ll mk ln lo lp ml lr ls lt ij bi translated">天天快乐学习！</p></div></div>    
</body>
</html>