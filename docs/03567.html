<html>
<head>
<title>Amazon and Gold</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">亚马逊和黄金</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/amazon-and-gold-efficient-frontier-analysis-ba9c8ad4c35b?source=collection_archive---------14-----------------------#2019-06-06">https://towardsdatascience.com/amazon-and-gold-efficient-frontier-analysis-ba9c8ad4c35b?source=collection_archive---------14-----------------------#2019-06-06</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="dda7" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">有效前沿分析</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/1a466d8610523d9ca209346cc66a3767.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*f0637Rl44ZJghhCBKQaQ5w.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk"><a class="ae ky" href="https://unsplash.com/photos/rymh7EZPqRs" rel="noopener ugc nofollow" target="_blank">https://unsplash.com/photos/rymh7EZPqRs</a></figcaption></figure><h1 id="c936" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated"><strong class="ak">什么是马科维茨投资组合优化？</strong></h1><p id="a05d" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">根据该理论，有可能构建一个最优投资组合的“有效边界”,在给定的风险水平下提供最大可能的预期回报。这一理论是由哈里·马科维茨在他的论文《投资组合选择》中首创的，该论文于 1952 年发表在《金融杂志》上。他后来因为开发了 MPT 而获得了诺贝尔奖。</p><h1 id="7cb6" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated"><strong class="ak">为什么有趣？</strong></h1><p id="f87d" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">在我人生的大部分时间里，我都认为投资“风险越高，回报越高”。当只通过个股的范式来看投资时，这是典型的情况。如果你考虑股票之间的相关系数，通过分散投资，实际上有可能获得更高的回报和同等(或更低)的风险。在这个大纲中，我将尽力引导读者明白这是一个多么令人激动的概念。</p><h1 id="729a" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated"><strong class="ak">预测:</strong></h1><p id="7a8f" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">我们将从 2004 年 11 月-2019 年 5 月分析 GLD (SPDR 黄金股票-黄金 ETF)和 AMZN(亚马逊-西雅图电子商务巨头)。</p><ul class=""><li id="0285" class="mn mo it lt b lu mp lx mq ma mr me ms mi mt mm mu mv mw mx bi translated">哪种资产回报更高？哪个风险更高？</li><li id="3884" class="mn mo it lt b lu my lx mz ma na me nb mi nc mm mu mv mw mx bi translated">如果我们要单独用这两种资产做一个投资组合，如果我们的目标是最小化风险(100% GLD，0% AMZN)，(50% GLD，50% AMZN)等，那么黄金与亚马逊的比例是最保守的？</li><li id="cbe4" class="mn mo it lt b lu my lx mz ma na me nb mi nc mm mu mv mw mx bi translated">哪个比率是最大化回报，同时最小化每单位回报的风险？</li></ul><p id="45f5" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nd mc md me ne mg mh mi nf mk ml mm im bi">— — — — — — — — — — — — — — — — — — — — — — — — — — — — — — —</p><h1 id="aa74" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">导入模块:</h1><pre class="kj kk kl km gt ng nh ni nj aw nk bi"><span id="ed28" class="nl la it nh b gy nm nn l no np">import numpy as np<br/>import pandas as pd<br/>from pandas_datareader import data as wb<br/>import matplotlib.pyplot as plt<br/>%matplotlib inline</span></pre><p id="131d" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nd mc md me ne mg mh mi nf mk ml mm im bi translated">接下来，让我们引入数据。我直接连接到 Yahoo Finance API，这对于查看大量股票要实用得多。api 的代码:</p><pre class="kj kk kl km gt ng nh ni nj aw nk bi"><span id="8120" class="nl la it nh b gy nm nn l no np">assets = ['AMZN', 'GLD']<br/>pf_data = pd.DataFrame()</span><span id="4e66" class="nl la it nh b gy nq nn l no np">for a in assets:<br/>    pf_data[a] = wb.DataReader(a, data_source = 'yahoo', start = '2004-11-18')['Adj Close']</span></pre><p id="1004" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nd mc md me ne mg mh mi nf mk ml mm im bi translated">既然我们已经获取了数据并将其分配给一个变量，那么让我们继续绘制标准化价格趋势。从这个角度来看，亚马逊在过去 15 年里一直是最大的资产。记住，高回报意味着高风险，对吗？</p><pre class="kj kk kl km gt ng nh ni nj aw nk bi"><span id="531e" class="nl la it nh b gy nm nn l no np">(pf_data / pf_data.iloc[0] * 100).plot(figsize=(10, 5))</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nr"><img src="../Images/45f2886decb87ac13ea8de05a58ea436.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fjKWOqYv-3tc3LORxSxEaw.png"/></div></div></figure><p id="e5ce" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nd mc md me ne mg mh mi nf mk ml mm im bi translated">让我们研究一下真实的数字。我们将计算这些股票的年度对数收益、标准差、协方差和相关性。</p><h1 id="09c6" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">年度日志回报:</h1><pre class="kj kk kl km gt ng nh ni nj aw nk bi"><span id="ac76" class="nl la it nh b gy nm nn l no np">log_returns = np.log(pf_data / pf_data.shift(1))<br/>log_returns.mean()*250</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ns"><img src="../Images/26dffae0d793c2dde87a10a5e3c1d3f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dbkokfq-7UIq6CZZAEmWvQ.png"/></div></div></figure><h1 id="0e64" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">风险:</h1><pre class="kj kk kl km gt ng nh ni nj aw nk bi"><span id="ac43" class="nl la it nh b gy nm nn l no np">log_returns.std()*250**0.5</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nt"><img src="../Images/522a880a350abbfa7aba8463802a53a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Jb1J4Zd7HVoipMDxdt1ZaA.png"/></div></div></figure><h1 id="71d4" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">共方差:</h1><pre class="kj kk kl km gt ng nh ni nj aw nk bi"><span id="a547" class="nl la it nh b gy nm nn l no np">log_returns.cov()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nu"><img src="../Images/56cdcc65e751af9a45e962c57ac30580.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-9HQibF5ZmmFOAuslJaZNQ.png"/></div></div></figure><h1 id="8c1c" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">相关性:</h1><p id="9f88" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">存在非常低的负相关；然而，任何相关性仍然会产生影响。</p><pre class="kj kk kl km gt ng nh ni nj aw nk bi"><span id="b2f4" class="nl la it nh b gy nm nn l no np">log_returns.corr()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nv"><img src="../Images/979b4f45ea4b440115eb2504cf34e571.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KR_3DEALFwmpjIekg3FiOQ.png"/></div></div></figure><p id="87e2" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nd mc md me ne mg mh mi nf mk ml mm im bi translated">我们稍后将使用这段代码。但是简单解释一下，我用两个随机数组成一个数组，加起来是 1。</p><pre class="kj kk kl km gt ng nh ni nj aw nk bi"><span id="3fda" class="nl la it nh b gy nm nn l no np">weights = np.random.random(2)<br/>weights = weights/np.sum(weights)<br/>weights</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nw"><img src="../Images/59de0ae412aba444bff92871cd9f38e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kYYSqNFiMDDyR7PmtuL_CQ.png"/></div></div></figure><p id="1e99" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nd mc md me ne mg mh mi nf mk ml mm im bi translated">现在是我们进行模拟的时候了。我们这样做是为了查看黄金和亚马逊权重的所有可能组合。对于每一组随机权重，我们的模拟将为投资组合计算新的年回报率和标准差。</p><p id="bb61" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nd mc md me ne mg mh mi nf mk ml mm im bi translated">我们首先创建两个空列表，分别叫做‘pfolio _ returns’和‘pfolio _ volatilities’。这些将捕获其下函数的<strong class="lt iu">的所有模拟计算。</strong></p><p id="823b" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nd mc md me ne mg mh mi nf mk ml mm im bi translated">我们添加了之前的随机权重生成器代码，并将随机权重的 1000 次迭代插入到我们的投资组合回报和投资组合波动率公式中。append 方法是在每次交互时为列表创建一个新条目的方法。</p><pre class="kj kk kl km gt ng nh ni nj aw nk bi"><span id="b363" class="nl la it nh b gy nm nn l no np">pfolio_returns = []<br/>pfolio_volatilities = []</span><span id="b3cc" class="nl la it nh b gy nq nn l no np">for x <strong class="nh iu">in</strong> range (1000):<br/>    weights = np.random.random(2)<br/>    weights /= np.sum(weights)<br/>    pfolio_returns.append(np.sum(weights * log_returns.mean()) * 250)<br/>    pfolio_volatilities.append(np.sqrt(np.dot(weights.T,np.dot(log_returns.cov() * 250, weights))))<br/>    <br/>pfolio_returns = np.array(pfolio_returns)<br/>pfolio_volatilities = np.array(pfolio_volatilities)</span><span id="5b90" class="nl la it nh b gy nq nn l no np">pfolio_returns, pfolio_volatilities</span></pre><p id="e0a8" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nd mc md me ne mg mh mi nf mk ml mm im bi translated">这将输出 2 个长数组。它们包含有价值的信息，但我们无法绘制出来。为了绘图，我们需要将数组转换成 dataframe 对象。我们可以通过将列键分配给列来使用字典。</p><pre class="kj kk kl km gt ng nh ni nj aw nk bi"><span id="9ebe" class="nl la it nh b gy nm nn l no np">portfolios = pd.DataFrame({'Return': pfolio_returns, 'Volatility': pfolio_volatilities})<br/>portfolios.head()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nx"><img src="../Images/fd58d6005ca0ff20b5f5052df1b0a356.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*s_qDLR03cDIUu6V9JmK6Mw.png"/></div></div></figure><p id="5a92" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nd mc md me ne mg mh mi nf mk ml mm im bi translated">现在让我们绘制我们创建的 dataframe 对象！</p><p id="0aa9" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nd mc md me ne mg mh mi nf mk ml mm im bi translated">如你所见，它有一个回旋镖形状。这正是大多数投资组合优化图应该呈现的样子。图的底端是 GLD 的风险/回报(6.8%的回报/18.3%的标准差)，右上角是 AMZN 的风险/回报(26.1%的回报/38.6%的标准差)。</p><blockquote class="ny nz oa"><p id="e1a6" class="lr ls ob lt b lu mp ju lw lx mq jx lz oc nd mc md od ne mg mh oe nf mk ml mm im bi translated">在中间，是当你在一个投资组合中混合两者时，风险/回报动态的样子。越往上越是 AMZN 分配，越往下越是 GLD</p></blockquote><pre class="kj kk kl km gt ng nh ni nj aw nk bi"><span id="8ebb" class="nl la it nh b gy nm nn l no np">portfolios.plot(x='Volatility', y='Return',kind = 'scatter',figsize=(10,6));<br/>plt.xlabel('Expected Volatility')<br/>plt.ylabel('Expected Return')</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi of"><img src="../Images/8a5e793106ec38455701fcaf295a1a82.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*C-GK8ezt0OEV2IUkuwzjUQ.png"/></div></div></figure><h1 id="4b58" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated"><strong class="ak">保守视角:</strong></h1><p id="3829" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">在曲线风险最小的地方(大约 16%的标准差)，看起来大约是 80%的 GLD 和 20%的 AMZN。令人惊讶的是，与我们 100%投资于 GLD 相比，这个点有更高的回报<strong class="lt iu">和更低的风险</strong>。这推翻了高回报意味着高风险的观点。我们正从个股范式转向投资组合范式。</p><h1 id="1226" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated"><strong class="ak">夏普视角:</strong></h1><p id="ac15" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">理想情况下，我们希望回报最大化，同时风险最小化。这意味着大多数人希望尽可能靠近图表的左上角。这就是夏普比率(Sharpe ratio)的由来:每单位波动率超过无风险利率的平均回报率。本质上，夏普找到了一种方法来计算这条曲线上最靠近左上角的点。</p><p id="aba8" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nd mc md me ne mg mh mi nf mk ml mm im bi translated">如果我们全押在亚马逊上，我们仍然有最高的回报，但我们也有更高的风险。如果我们处于中间位置，理论上我们会通过最小化风险和最大化回报来优化我们的投资组合。</p><blockquote class="ny nz oa"><p id="2d33" class="lr ls ob lt b lu mp ju lw lx mq jx lz oc nd mc md od ne mg mh oe nf mk ml mm im bi translated"><strong class="lt iu">那么，GLD 和 AMZN 的最佳投资组合平衡是什么？</strong></p></blockquote><p id="0991" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nd mc md me ne mg mh mi nf mk ml mm im bi translated">我在 Github 上发现了一个程序，它实际上为我们自动化了这个过程。下图从最小波动率角度和最大夏普比率角度显示了 AMZN 和 GLD 的确切投资组合规格。我稍微调整了一下原始代码，将我们的数据插入到 Ricky Kim 的代码中，得到了这张图片:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi og"><img src="../Images/354ee27ab8550744e5242220f1869339.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ugH3K_1QYjFm2jIpgyix0A.png"/></div></div></figure><p id="31c6" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nd mc md me ne mg mh mi nf mk ml mm im bi translated">但是，即使严格基于我提供的原始代码，您也可以感觉到曲线上的哪个点最小化了风险(最接近左边)，哪个点最大化了夏普(最接近左上角)，以及每个点使用了每只股票的什么权重(通过测量这些点沿着直线有多远)。</p></div><div class="ab cl oh oi hx oj" role="separator"><span class="ok bw bk ol om on"/><span class="ok bw bk ol om on"/><span class="ok bw bk ol om"/></div><div class="im in io ip iq"><p id="80b5" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nd mc md me ne mg mh mi nf mk ml mm im bi translated">GitHub 中的代码:<a class="ae ky" href="https://github.com/ahershy/Efficient-Frontier-Program/blob/master/markowitz-portfolio-optimization-gold-and-amazon.ipynb" rel="noopener ugc nofollow" target="_blank">https://GitHub . com/ahershy/Efficient-Frontier-Program/blob/master/markowitz-portfolio-optimization-gold-and-Amazon . ipynb</a></p><p id="a12a" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nd mc md me ne mg mh mi nf mk ml mm im bi translated">非常感谢里奇·金的灵感和伟大的文章:<a class="ae ky" rel="noopener" target="_blank" href="/efficient-frontier-portfolio-optimisation-in-python-e7844051e7f">https://towards data science . com/efficient-frontier-portfolio-optimization-in-python-e 7844051 e7f</a></p><h2 id="be1a" class="nl la it bd lb oo op dn lf oq or dp lj ma os ot ll me ou ov ln mi ow ox lp oy bi translated">点击此处了解有关线性回归/多项式回归的更多信息:</h2><p id="0382" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated"><a class="ae ky" rel="noopener" target="_blank" href="/linear-vs-polynomial-regression-walk-through-83ca4f2363a3">https://towards data science . com/linear-vs-polynomial-regression-walk-through-83c a4 f 2363 a3</a></p><p id="362c" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nd mc md me ne mg mh mi nf mk ml mm im bi translated">如果您觉得这有帮助，请订阅、鼓掌或评论。</p><p id="4787" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nd mc md me ne mg mh mi nf mk ml mm im bi translated">安德鲁</p></div></div>    
</body>
</html>