# 机器学习如何降低寻找更好远足的搜索成本

> 原文：<https://towardsdatascience.com/how-machine-learning-can-lower-the-search-cost-for-finding-better-hikes-3d2e499cfcdd?source=collection_archive---------22----------------------->

![](img/4eeb72e3b859ecd747411cbf3f7ec7f0.png)

我最近去了一个周末露营旅行，地点是迷人的 T1，离我在华盛顿州西雅图的住处只有两个多小时的车程。为了计划旅行，我们依靠[华盛顿步道协会](https://www.wta.org) (WTA)和一些其他资源来确保我们每天都有最佳的步道路线和露营地点。这些户外探险资源中的许多可以帮助人们计划多天的野营旅行，确定去哪里和父母一起远足，或者确保正确穿越阿斯加德山口，这是一个不到一英里的海拔 2300 英尺的粗略增益。**但仍有所欠缺。**

我真的希望所有这些徒步旅行资源都有一件事是**基于我过去喜欢的徒步旅行的个性化徒步旅行建议**(即如果我喜欢 hike X，我会喜欢 hike Y，因为它有类似的徒步旅行路线功能)或基于我过去对徒步旅行的评价(即 [Goodreads](https://www.goodreads.com/) 基于你的评论的个性化书籍建议)。

这些户外探险应用中的许多都让用户能够通过自定义过滤特定的徒步旅行路径属性(距离、海拔高度、难度等)来搜索徒步旅行。)但是他们缺乏任何智能推荐算法来降低搜索成本，以找到用户真正喜欢的远足。

我开始提出以下问题:

1.*什么类型的智能推荐对狂热的徒步旅行者有用？*

2.*我能否构建一个利用徒步旅行评论的个性化推荐引擎？*

3.*我能否创建一个能力评分公式，将点评总数和给定提价的平均评分结合起来？*

为了回答这些问题，我介绍了如何构建一个全栈机器学习 web 应用程序，该应用程序将根据徒步路线属性和用户评论为人们提供智能徒步建议。这将帮助狂热的徒步旅行者找到更好的路径。

## 为什么不直接构建这个机器学习应用程序呢？

我实际上已经构建并部署了这个机器学习应用程序，但抓取和使用他们的数据违反了许多公司的服务条款，所以我将它与相应的博客和 GitHub 存储库一起离线。我的确很天真，当时我并没有完全理解刮擦的惯例。

我对此感到非常抱歉，因为我不熟悉如何查看抓取数据。我只是对解决这个问题产生了浓厚的兴趣，并希望在我真正喜欢的应用程序上添加一个智能功能，以便我和我的朋友可以找到更好的徒步旅行。我希望这会给底层应用带来更多的流量。

不幸的是，事情并没有那么顺利——公司礼貌地要求我把我开发的应用程序撤下来。因此，在这篇文章的其余部分，我将分享我如何构建一个假设的线索推荐应用程序的高级视图。我将避免详细讨论如何抓取或提取数据，而是将重点放在管道上。

# **数据收集和机器学习管道**

![](img/386c984a2f75f4087f7fd5cee8901110.png)

Hypothetical full data pipeline

**数据**

在理想的情况下，我会直接从内部数据库下载数据。在一个假设的世界中，我会编写一个 Python web 抓取脚本来获取徒步旅行路线属性和用户徒步旅行评论数据。对于华盛顿州，这将留给我大约 3，500 次徒步旅行和大约 200，000 次用户评论的数据，我希望将这些数据存储在我在本地连接的 MongoDB 数据库中。

**徒步旅行路线特色**

这些是远足径的功能，我想用它来建立一个类似的远足算法，以及一个基于用户评级的个性化算法。

![](img/dc0f2c4da229d6645e690b1d52e2f48a.png)

Synthetically Generated Hiking Trail Features

数字特征包括总距离(以英里为单位)、高程增量(以英尺为单位)和高程严重性。其余的特征将被分类标记为值 0 表示“否”或 1 表示“是”，这取决于该特征是否描述了给定的远足。这些特性中的大部分可以通过清理存储在 MongoDB 中的原始数据直接创建。我还想设计一些额外的功能。我会包括:

海拔严重程度:每英里步行距离的海拔高度，以英尺为单位

**人流量**:我会解析一个线索摘要段落和用户评论，寻找描述给定线索的典型人流量的语言。这些将被分类为重度、中度、轻度和未知

# **推荐系统**

为了建立机器学习模型，我会利用苹果的开源机器学习库 [Turi Create](https://github.com/apple/turicreate) ，因为开发定制推荐模型非常灵活。

## **项目内容相似度**

这个[推荐器](https://apple.github.io/turicreate/docs/api/generated/turicreate.recommender.item_content_recommender.ItemContentRecommender.html)只考虑了徒步路径属性。它查看每一对不同的徒步旅行，并根据徒步旅行路线的特征计算它们的相似程度。通过首先计算每个特征之间的相似性来计算该相似性分数，然后对这些特征进行加权平均来获得最终的相似性。这是很有用的，因为用户可以指定他们喜欢的远足，这个推荐器将提供最相似的远足。

**例如:** *“如果你喜欢崂山古道，这里有一些与崂山古道最相似的徒步旅行项目。”*

**模型功效启发式**

在构建模型之前，我会有一些具体的试验示例，在这些示例中，我可以测试算法的建议质量。这是我根据自己的经验熟悉的几个例子:

派克市场→ *也许应该得到推荐。其他类似城市的短距离、低海拔步行*

宁静湖步道→ *可能应该推荐科尔查克湖，因为它们都是高步行交通，挑战与高山湖相似距离的徒步旅行*

![](img/549d5bc56e437acf8b19a649867053c5.png)![](img/e724cb7ee12c1a58da35941ce1dd046e.png)

Mock Design for how to Test the efficacy of the similar hike algorithm against established expectation

在上面的例子中，这两个测试案例都符合要求，Pike Place Market 返回其他短途城市步行，Lake Serene Trail 返回 Colchuck 湖作为第二个最相似的徒步旅行。

## **排名因子分解**

如果我们有用户给出的实际提价评级，那么选择最佳模型取决于我们是否希望预测用户对任何特定提价的评级，或者我们是否希望模型推荐它认为用户会给予很高评级的提价。我们可能更关心*排名表现*，因为在**中，我们想要推荐用户可能评价很高的提价。**

[ranking factorization recommender](https://apple.github.io/turicreate/docs/api/generated/turicreate.recommender.ranking_factorization_recommender.RankingFactorizationRecommender.html)推荐与用户已查看的徒步旅行数据集中的徒步旅行相似的徒步旅行，以及那些将被用户高度评价的徒步旅行。这种推荐背后的直觉是，应该有一些潜在的特征来决定用户如何评价上涨。

![](img/7b011b5043e10423691b0397865c9c3f.png)

Building a Hiking Recommender System with Matrix Factorization

**例如:** *“对于已经对一些涨价进行了评级的用户佩里来说，以下是佩里可能会给予很高评级的涨价。”*

**建立这个模型**

在大多数户外应用程序中，用户会明确地根据星级数增加评分(0 =非常不喜欢，5 =非常喜欢)。如果我们在过去有大约 200，000 个这样的评级(记录表明用户*有*的评级提升 *X* 有 *Y* 颗星)，那么我们可以构建排名因子分解推荐器。我会使用一种称为分割验证的技术:我们只取这些评级(称为训练集)的子集(80%)来训练模型，然后我们要求模型预测我们隐藏的 20%的评级(测试集)。

例如，可能会发生这样的情况，一个测试用户给某次远足打了 4 颗星，但是你的模型预测是 3.5 颗星，因此在这个评分上有 0.5 的误差。然后，我们使用均方根误差(RMSE)公式计算整个测试集的平均误差，以获得最终结果。这就是如何量化这个推荐系统的预测性能。在应用程序中实现该模型之前，我会遍历该模型的几个不同的超参数值，以最小化训练集数据上的 RMSE。

## **人气**

基于流行度的推荐器并不智能，但是如果用户以前没有在特定区域徒步旅行过(或者以前从未徒步旅行过!),它们是有用的数据产品和冷启动问题的潜在解决方案。).这些通常很有趣，也是寻找徒步旅行的有用基线。

**评论数量**

这将根据评论的数量推荐最受欢迎的远足。

**平均星级(指定符合条件的最低点评数)**

这将根据评分推荐最受欢迎的涨价。我将从分析评论数量的分布开始，来感受一下评论在哪里。在这个合成生成的数据集中，很明显，5 星级(满分)的远足是由少数评论主导的。因此，我认为一次远足至少需要有 100 条评论才能算作推荐。例如，我想确保一次有大约 6 个评论的 5 星评分的远足不包括在内。

![](img/bd2aec072a24421b9e5408f2d080fdd7.png)

Synthetically Generated: 5 Star Ratings dominated by Low Number of Reviewed Hikes

**额定功率**

我将创建一个从 0 到 100 的自定义评分，将评论数和平均评分混合到同一个分数中。**评价为 4.9 星但只有 10 条评论的远足可能不会被评价为 4.6 星但有 1000 条评论的远足。**

![](img/c84189af970ac964b4c3396d592d1cc7.png)

Synthetically Generated: Distribution of Hike Ratings before blending in the Number of Reviews

**第一步:公式**

强力评分=(评论数/(评论数+90%分位数的评论数)*评分)+(90%分位数的评论数/(90%分位数的评论数+评论数)*所有涨价的平均评分)

![](img/0a26d8c744ddf018b26cadb41e53beef.png)

Synthetically Generated: Distribution of Hike Ratings after applying the formula to blend number of reviews and ratings score

**第二步:最小最大缩放器**

[最小最大缩放器](https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.MinMaxScaler.html)根据使用指定数据的最小和最大值的公式缩放和转换数据，使其在 0 和 1 之间的范围内。然后，我将每个值乘以 100，以将功率评级分数调整到 0 到 100 之间的范围。

![](img/0e9f04b7aeeb7c23de7189230f59de76.png)

Synthetically Generated: Power Ratings Distribution once scaled to values between 0 and 100

## **申请**

一旦我们有了可行的徒步旅行建议的机器学习模型，我会使用 Python 编写的 Flask web 框架来构建应用程序。在花了大约两周的时间编写代码来构建支持 HTML、CSS 和 JavaScript 文件的核心 web 应用程序功能后，我将能够在 Heroku 的云平台上将其作为多页面 web 应用程序发布。

![](img/095e6221d4cad911f5eefd820f0a3332.png)

**寻找一次和你喜欢的远足相似的远足**

为了获得与你喜欢的徒步旅行相似的徒步旅行，用户只需指定他们喜欢的一次徒步旅行，然后将提供一个最相似的徒步旅行列表，其中包含路径信息以及返回各自简档的嵌入式链接。

**根据您的评分寻找个性化的徒步旅行**

理想情况下，我们应该集成一家户外探险公司的用户登录和个人资料数据，但如果这不可能，我可以创建一个唯一的用户 ID，映射到用户的全名。

为了获得个性化的评论，用户需要输入与其账户相关的全名，在我的例子中就是:Perry Johnson。然后，根据我的评论，我真正喜欢的最有可能徒步旅行的列表将与步道信息和返回各自徒步旅行档案的嵌入式链接一起提供。

## **结论**

通过利用徒步旅行路线属性和用户评论构建这一新颖的数据产品，我们将为狂热的徒步旅行者提供更明智的徒步旅行建议。这将是第一套机器学习算法，可以个性化用户体验，降低搜索成本，以找到更好的徒步旅行路线。

***评论或提问？请发电子邮件至:perryrjohnson7@gmail.com 或联系***[***LinkedIn***](https://www.linkedin.com/in/perryrjohnson/)

***你可以看看我其他的一些作品:***

[机器学习如何帮助你给电动滑板车充电](/a-birds-eye-view-leveraging-machine-learning-to-generate-nests-30dd2136a839)

[逆向工程行走评分算法](/engineer-walkscore-4dc1730b976c)