<html>
<head>
<title>Tricks in R to Boost Your Productivity (Part 1)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">提高生产率的 R 技巧(第 1 部分)</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/tricks-in-r-to-boost-your-productivity-8c977242c69c?source=collection_archive---------7-----------------------#2019-08-11">https://towardsdatascience.com/tricks-in-r-to-boost-your-productivity-8c977242c69c?source=collection_archive---------7-----------------------#2019-08-11</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/e6084964d4ae81d9c1521c66f133b76e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*qAOuV8_NOvPYtpSA"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk">Photo by <a class="ae kf" href="https://unsplash.com/@anete_lusina?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Anete Lūsiņa</a> on <a class="ae kf" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="dd40" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我想和你们分享我在 R 和 RStudio 中用来提高工作效率的一些技巧。它们是公共资源(比如 StackOverflow)和我个人的最佳实践的结合。生命短暂，不要再用这些伎俩浪费时间了。我希望你能从中受益，并与我分享你的技巧。当我得到更多的时候，我会继续在帖子中添加新的技巧！</p><h2 id="b0ef" class="le lf it bd lg lh li dn lj lk ll dp lm kr ln lo lp kv lq lr ls kz lt lu lv lw bi translated">1.计算向量权重</h2><p id="b191" class="pw-post-body-paragraph kg kh it ki b kj lx kl km kn ly kp kq kr lz kt ku kv ma kx ky kz mb lb lc ld im bi translated">在许多情况下，我们需要根据参考向量的权重将一个数分配给一个向量，其中每个条目的权重计算为其占所有条目之和的比例。例如，您的总销售预测为 1，000，跨 3 个渠道(比如 A、B、C)的历史销售分布为(300，100，100)。然后，对于 A、B、C，渠道级别的销售预测可以分别计算为(3/5 * 1000、1/5 * 1000、1/5 * 1000)。一种极端情况是，可能没有任何历史渠道销售观察。在这种情况下，甚至跨所有渠道分发可能是一种常见的选择。如果总和等于 0，那么所有条目的所有权重都应该相等，因为它们都应该等于 0。如果你经常需要调用这样的函数，你可以创建一个助手函数来实现，如下所示</p><figure class="mc md me mf gt ju"><div class="bz fp l di"><div class="mg mh l"/></div></figure><p id="34ba" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">一个示例调用是</p><pre class="mc md me mf gt mi mj mk ml aw mm bi"><span id="7019" class="le lf it mj b gy mn mo l mp mq">&gt; lw(c(1,2,3))</span><span id="280e" class="le lf it mj b gy mr mo l mp mq">[1] 0.1666667 0.3333333 0.5000000</span></pre><h2 id="32ec" class="le lf it bd lg lh li dn lj lk ll dp lm kr ln lo lp kv lq lr ls kz lt lu lv lw bi translated">2.对于大向量，将字符转换为日期</h2><p id="66b2" class="pw-post-body-paragraph kg kh it ki b kj lx kl km kn ly kp kq kr lz kt ku kv ma kx ky kz mb lb lc ld im bi translated">当我们通过 DBI 从 CSV 文件或数据库中读取数据时，日期列可能仍然是字符类型。人们通常使用一个命令，如<em class="mv"> base R </em>中的<code class="fe ms mt mu mj b">as.Date()</code>或<em class="mv"> lubridate </em>包中的<code class="fe ms mt mu mj b">ymd()</code>将目标列转换为日期类型。它非常适合小数据。但是，如果列中有超过 1000 万个条目，这种转换方法可能需要相当长的时间。有一种更快的方法来实现它，如下所示</p><figure class="mc md me mf gt ju"><div class="bz fp l di"><div class="mg mh l"/></div></figure><p id="cb6b" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">查看代码，关键的技巧是首先对字符向量进行重复数据删除，将经过重复数据删除的字符向量转换为日期向量，然后将每个条目映射回原始向量中的位置。速度的提高是基于这样的假设，即大向量中的大多数日期都是重复的，这是很常见的。</p><h2 id="20b0" class="le lf it bd lg lh li dn lj lk ll dp lm kr ln lo lp kv lq lr ls kz lt lu lv lw bi translated">3.检查数据框中的缺失值</h2><p id="df72" class="pw-post-body-paragraph kg kh it ki b kj lx kl km kn ly kp kq kr lz kt ku kv ma kx ky kz mb lb lc ld im bi translated">每个 R 用户都应该非常熟悉<code class="fe ms mt mu mj b">summary()</code>函数，以便对数据框中的所有列进行快速统计。然而，在很多情况下，我们只关心一些特定的统计数据。就我个人而言，我经常检查每一列中缺失值的数量。因此，创建了两个辅助函数:</p><figure class="mc md me mf gt ju"><div class="bz fp l di"><div class="mg mh l"/></div></figure><ul class=""><li id="5603" class="mw mx it ki b kj kk kn ko kr my kv mz kz na ld nb nc nd ne bi translated"><code class="fe ms mt mu mj b">cc()</code>代表为我“检查清洁”。它会告诉您每一列中有多少个丢失的值。</li><li id="9739" class="mw mx it ki b kj nf kn ng kr nh kv ni kz nj ld nb nc nd ne bi translated"><code class="fe ms mt mu mj b">cd()</code>代表我的“清洁密度”。它只是告诉您每一列中缺失值的百分比。</li></ul><p id="c9f1" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我喜欢这些功能是因为在键盘上输入“c”和“d”比输入“summary”要快得多。</p><h2 id="7f96" class="le lf it bd lg lh li dn lj lk ll dp lm kr ln lo lp kv lq lr ls kz lt lu lv lw bi translated">4.到处使用管道运算符</h2><p id="a112" class="pw-post-body-paragraph kg kh it ki b kj lx kl km kn ly kp kq kr lz kt ku kv ma kx ky kz mb lb lc ld im bi translated">在我看来，R 中的管道运算符<code class="fe ms mt mu mj b">%&gt;%</code>是迄今为止最伟大的发明。它简化了我们编码时的思维流程，极大地简化了代码结构。我建议你尽可能多地使用它。显示其灵活性的几个例子如下:</p><ul class=""><li id="7a31" class="mw mx it ki b kj kk kn ko kr my kv mz kz na ld nb nc nd ne bi translated"><code class="fe ms mt mu mj b">a %&gt;% f(b)</code>相当于<code class="fe ms mt mu mj b">f(a, b)</code></li><li id="cac0" class="mw mx it ki b kj nf kn ng kr nh kv ni kz nj ld nb nc nd ne bi translated"><code class="fe ms mt mu mj b">a %&gt;% f(b) %&gt;% f(c)</code>相当于<code class="fe ms mt mu mj b">f(f(a, b), c)</code></li><li id="b5a2" class="mw mx it ki b kj nf kn ng kr nh kv ni kz nj ld nb nc nd ne bi translated"><code class="fe ms mt mu mj b">a %&gt;% {f(., b)}</code>相当于<code class="fe ms mt mu mj b">f(a, b)</code></li></ul><p id="3ded" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">另外，记住在 macOS 中插入管道符号的快捷方式是<code class="fe ms mt mu mj b">CMD + SHIFT + M</code>。</p><h2 id="ea0c" class="le lf it bd lg lh li dn lj lk ll dp lm kr ln lo lp kv lq lr ls kz lt lu lv lw bi translated">5.与 H2O 合作</h2><p id="adda" class="pw-post-body-paragraph kg kh it ki b kj lx kl km kn ly kp kq kr lz kt ku kv ma kx ky kz mb lb lc ld im bi translated">H2O 是我最喜欢的 R 包之一，并且正在成为 R 中的高性能机器学习框架</p><ul class=""><li id="dabc" class="mw mx it ki b kj kk kn ko kr my kv mz kz na ld nb nc nd ne bi translated">首先，我建议你总是使用命名空间约定调用 H2O 函数<code class="fe ms mt mu mj b">h2o::</code>和<strong class="ki iu">而不是</strong>使用<code class="fe ms mt mu mj b">library(h2o)</code>加载整个 H2O 库，因为加载整个库很可能会导致与其他常用包的函数冲突。与 H2O 的函数冲突有时会导致意想不到的后果，因为 H2O 软件包修改了其他流行软件包中许多函数的实现。</li><li id="5a06" class="mw mx it ki b kj nf kn ng kr nh kv ni kz nj ld nb nc nd ne bi translated">其次，启动 H2O 实例的命令涉及到相当多的参数设置，需要输入一些内容。我喜欢用我的个人设置而不是默认设置来启动 H2o 实例。因此，我编写了下面的助手函数，根据我的喜好来包装最初的 H2O 初始化和关闭。</li></ul><figure class="mc md me mf gt ju"><div class="bz fp l di"><div class="mg mh l"/></div></figure><h2 id="4663" class="le lf it bd lg lh li dn lj lk ll dp lm kr ln lo lp kv lq lr ls kz lt lu lv lw bi translated">6.在 RStudio 中优化窗格布局</h2><p id="48f2" class="pw-post-body-paragraph kg kh it ki b kj lx kl km kn ly kp kq kr lz kt ku kv ma kx ky kz mb lb lc ld im bi translated">大多数人使用 RStudio 中的默认窗格布局。经过几年的实践，我优化的窗格布局如下:</p><figure class="mc md me mf gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nk"><img src="../Images/b877f4c78318fb6871cf28ebd6331b14.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*M1MZw37Tb787iSkbxPqkNQ.png"/></div></div></figure><ul class=""><li id="6c3a" class="mw mx it ki b kj kk kn ko kr my kv mz kz na ld nb nc nd ne bi translated">如今，由于大多数电脑屏幕都很宽，因此垂直空间非常宝贵。水平拆分源码和控制台，充分利用了屏幕空间。</li><li id="2538" class="mw mx it ki b kj nf kn ng kr nh kv ni kz nj ld nb nc nd ne bi translated">我总是隐藏左下方的窗格以最大化源代码窗格，所以只有命令历史是左下方的窗格，这是不常使用的。</li><li id="ef3a" class="mw mx it ki b kj nf kn ng kr nh kv ni kz nj ld nb nc nd ne bi translated">因为没有办法消除左下方的窗格，所以我将所有其他功能都移到了右下方的窗格中。</li></ul><h2 id="7a0d" class="le lf it bd lg lh li dn lj lk ll dp lm kr ln lo lp kv lq lr ls kz lt lu lv lw bi translated">7.自动格式化您的代码</h2><p id="fd76" class="pw-post-body-paragraph kg kh it ki b kj lx kl km kn ly kp kq kr lz kt ku kv ma kx ky kz mb lb lc ld im bi translated">在 python 中，由于缩进的重要作用，很好地格式化代码总是令人痛苦的。在 r 中肯定不是这样，所以在 RStudio 中，你可以选择你所有的代码，在 macOS 中按下<code class="fe ms mt mu mj b">CMD + I</code>的快捷键，进行自动缩进。不管你的代码有多丑，经过这个操作后，你会惊奇地发现它变得多么美丽。</p><p id="b2da" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">更新:你现在可以在这里找到本主题<a class="ae kf" href="https://medium.com/@weilin0929/tricks-in-r-to-boost-your-productivity-part-2-7222461c6671" rel="noopener">的第 2 部分。</a></p></div></div>    
</body>
</html>