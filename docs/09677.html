<html>
<head>
<title>Generating MRI Images of Multi-Contrast</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">生成多对比度的 MRI 图像</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/generating-mri-images-of-multiple-contrast-levels-89c3b6c00e68?source=collection_archive---------11-----------------------#2019-12-19">https://towardsdatascience.com/generating-mri-images-of-multiple-contrast-levels-89c3b6c00e68?source=collection_archive---------11-----------------------#2019-12-19</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="e316" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">利用 CycleGans 将 T1 加权 MRI 图像转换为 T2 加权 MRI 图像。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/7974e7e1a1fd8ba9b1cb53ece384c907.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KNoTCpFWnwwi3EDfJoFReg.jpeg"/></div></div></figure><p id="a29c" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><strong class="kw iu">放射科医师每年误诊全球 4000 万人</strong>🤯<strong class="kw iu">！</strong></p><p id="20e0" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">虽然技术等其他事物在不断创新，但我们也必须大幅改进疾病诊断方法。通过简单地减少假阴性和假阳性误诊病例，我们可以真正解决一半的医疗保健问题。</p><p id="1025" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">如果存在更好的成像工具和设备，能够更准确地发现患病部位，这可能会挽救数百万人的生命！特别是像癌症这样的疾病，当在早期诊断时，与晚期相比，其 5 年存活率明显更高，但是很少在早期检测到疾病的任何“迹象”，这是一个问题。</p><h1 id="8d49" class="lq lr it bd ls lt lu lv lw lx ly lz ma jz mb ka mc kc md kd me kf mf kg mg mh bi translated">核磁共振扫描</h1><p id="07e9" class="pw-post-body-paragraph ku kv it kw b kx mi ju kz la mj jx lc ld mk lf lg lh ml lj lk ll mm ln lo lp im bi translated">让我们来玩一个小游戏，<em class="mn">，在这里你可以假装是放射科医生</em>。你的工作是<em class="mn">在下面的 MRI 图像中找到异常区域</em>:</p><p id="dc1e" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><strong class="kw iu">提示:</strong> <em class="mn">有</em> <strong class="kw iu"> <em class="mn">两个</em> </strong> <em class="mn">异常区域。</em></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mo"><img src="../Images/237230400cbf156f429a2d13c36196a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Jif2Uuh0WUSW0Q0Ont80dw.png"/></div></div><figcaption class="mp mq gj gh gi mr ms bd b be z dk"><a class="ae mt" href="https://www.radiologymasterclass.co.uk/tutorials/mri/t1_and_t2_images#top_3rd_img" rel="noopener ugc nofollow" target="_blank">Source</a>: MRI T1-weighted scan</figcaption></figure><p id="3184" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">如果我也给你这个核磁共振扫描，这一切会变得容易得多，你也会对你的答案更有信心:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mo"><img src="../Images/f0b5edbde99474ec6a27d4fcc6ed9cc5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*G-ZcbxE_L6NBrSI9L-K_ng.png"/></div></div><figcaption class="mp mq gj gh gi mr ms bd b be z dk"><a class="ae mt" href="https://www.radiologymasterclass.co.uk/tutorials/mri/t1_and_t2_images#top_3rd_img" rel="noopener ugc nofollow" target="_blank">Source</a>: MRI T2-weighted scan</figcaption></figure><p id="e619" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">请注意，在上面的 MRI 扫描中，两个异常区域要亮得多，也更容易发现。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mu"><img src="../Images/1fe054ed59144d2d53d281797b952583.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KucQUuY9cZxKjmjAf8JB5w.png"/></div></div><figcaption class="mp mq gj gh gi mr ms bd b be z dk"><a class="ae mt" href="https://www.radiologymasterclass.co.uk/tutorials/mri/t1_and_t2_images#top_3rd_img" rel="noopener ugc nofollow" target="_blank">Source</a></figcaption></figure><p id="cc7b" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">上面显示的两幅不同的 MRI 图像具有不同的对比度。在这种情况下，异常区域恰好表明肿瘤的迹象，特别是这名患者患有<em class="mn">多发性骨髓瘤。</em></p><p id="31f5" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">磁共振成像主要有两种类型，<strong class="kw iu"> T1 加权磁共振成像和 T2 加权磁共振成像。</strong>这两种类型的核磁共振成像对比体内不同的区域。</p><p id="6005" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">上面呈现的第一个 MRI 图像是 T1 加权的 MRI 图像👆，而第二个提出的是 T2 加权磁共振成像图像。</p><p id="4876" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">T1 加权图像特别突出了脂肪组织，而 T2 加权图像突出了体内的脂肪和水。</p><ul class=""><li id="efc5" class="mv mw it kw b kx ky la lb ld mx lh my ll mz lp na nb nc nd bi translated"><strong class="kw iu"> T1 加权→ </strong>脂肪组织看起来很亮</li><li id="9343" class="mv mw it kw b kx ne la nf ld ng lh nh ll ni lp na nb nc nd bi translated"><strong class="kw iu"> T2 加权→</strong><em class="mn"/>脂肪和水区域看起来都很亮</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/40125ac8cb100d653005a9511f1c9bd4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1360/format:webp/0*hkIDyRfNbZrr6W99.png"/></div><figcaption class="mp mq gj gh gi mr ms bd b be z dk">Summarizes the regions T1 and T2 images highlight</figcaption></figure><p id="b8b4" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">拥有这两种类型的 MRI 扫描可以通过为医生提供更全面的理解来大大提高诊断的准确性。</p><p id="1a5d" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">然而，在实践中，病理学家<em class="mn">很少</em>能够访问这两种类型的 MRI 图像<em class="mn"> </em>用于检查和诊断目的。这是因为多种原因，例如某些扫描时间限制以及其他因素，例如在 MRI 图像中由于噪声或伪影而发现的失真对比度。</p><p id="4474" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">克服这些低效率的方法之一是使用一种称为<strong class="kw iu">风格转移的人工智能技术，从现有的 MRI 扫描中合成不同对比度水平的 MRI 图像。</strong></p><p id="647d" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">具体来说，我利用了一种可以执行风格转移的算法，称为<strong class="kw iu">循环生成对抗网络(CycleGAN)，从 T2 加权的 MRI 图像合成 T1 加权的 MRI 图像，反之亦然。</strong></p><h1 id="c973" class="lq lr it bd ls lt lu lv lw lx ly lz ma jz mb ka mc kc md kd me kf mf kg mg mh bi translated">什么是风格转移？</h1><p id="a8a5" class="pw-post-body-paragraph ku kv it kw b kx mi ju kz la mj jx lc ld mk lf lg lh ml lj lk ll mm ln lo lp im bi translated">风格转移正是它听起来的样子！让我们用一个埃隆·马斯克的类比来进一步分解它😍。</p><p id="31dd" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这是 21 世纪的埃隆·马斯克:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/f99b28362b9ede97bcb7c2a772f32148.png" data-original-src="https://miro.medium.com/v2/resize:fit:692/format:webp/1*f6HPxAa9JYdq_njubrAqTw.jpeg"/></div></figure><p id="82f4" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">埃隆·马斯克(Elon Musk)很酷，但我一直想知道 16 世纪的优秀的老埃隆·马斯克会是什么样子。风格转移让我满足了我的好奇心，这就是它对埃隆·马斯克的影响:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/8102bd49a5679acf8687ca0780ef556f.png" data-original-src="https://miro.medium.com/v2/resize:fit:704/format:webp/1*tA5C7UI6THHdRWlxeHUGMA.jpeg"/></div><figcaption class="mp mq gj gh gi mr ms bd b be z dk">Painting of Elon Musk in the 16th century</figcaption></figure><p id="2e88" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">那是埃隆·马斯克在 16 世纪的一幅画👆！</p><p id="3daf" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这是一个风格转换的演示，将一张“现代”的照片几乎完美地变成了一幅古典绘画。特别是，这被称为<strong class="kw iu"> <em class="mn">图像到图像的翻译</em>，将图像从一个域转移到另一个域的任务。</strong></p><p id="2159" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这里有更多的例子！</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/c8749dd43193061451e90d17ea9feca1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1322/format:webp/0*-S4cPG6YVCKOVvyY.png"/></div></figure><p id="d2ef" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">🐴我以前从未见过斑马在美丽的大自然中奔跑，但现在我看到了…</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/f3d8135c0c19f51c9794ab46b1716599.png" data-original-src="https://miro.medium.com/v2/resize:fit:1152/format:webp/1*dps6gTMnWN_agvRH-5YtWA.png"/></div></figure><p id="fd73" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">☀️，我真的希望季节转换的魔力真的存在于现实生活中，而不仅仅是图像。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/8165de9afadd9daa5411cd62adbe544f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*oY3Dl--Tkmp1S9Ld.jpg"/></div></div></figure><p id="1db9" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">🎨《蒙娜丽莎》五季怎么样？(我知道，我知道，你想说只有四个季节，对吧，我想传统是要打破的。)</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi np"><img src="../Images/1ef9e32dd2e70192a432d4b064a9e95e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*RbPOibTK7AKq1Iuf.png"/></div></div></figure><p id="8a0e" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">🐰史上最可爱的仓鼠！(ps:实际上我不知道那是不是仓鼠，但它可能是)</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nq"><img src="../Images/271d76fa2999411e193521676784432d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*DpHx4bHQHHnum4zl"/></div></div></figure><p id="f70a" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这里还有一些👆。享受吧。</p><p id="b8e0" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><strong class="kw iu">好的，我得到了样式转移部分，但是是什么使 CycleGan 适合于将样式转移应用于 MRI 图像的特定任务呢？</strong></p><p id="661a" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">风格转移并不是一个真正的新概念，已经做了大量的工作。但使<strong class="kw iu"> CycleGAN 成为一个有吸引力的模型的是，它不需要<em class="mn">成对的训练数据</em> </strong>，但仍然能够合成“惊人”质量的风格转移图像。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/3c570b6c67e50b3a40807248e9b98b57.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*sch-N6BcUPYq86JA.png"/></div><figcaption class="mp mq gj gh gi mr ms bd b be z dk">Paired data vs unpaired data</figcaption></figure><p id="94eb" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><strong class="kw iu">成对数据</strong>是 x1 对应 y1、x2 对应 y2 等的数据。就 T1 加权和 T1 加权 MRI 图像而言，如果数据是成对的，这意味着每个 T1 加权 MRI 图像及其对应的 T2 加权 MRI 图像来自同一患者。</p><p id="33cd" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><strong class="kw iu">不成对数据</strong>则是两组数据，其中 x1 不需要对应 y1，x2 到 y2 等等。</p><p id="dcbf" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">先前用于风格转移的机器学习方法工作良好，并且仅在用配对数据训练的情况下产生“体面”的结果。<em class="mn">然而，成对数据的大型数据集非常罕见。</em></p><p id="e424" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">CycleGAN 很有用，因为它可以像其他风格传输方法一样出色地执行，但使用的是<em class="mn">不成对数据</em>。寻找数据集是一件痛苦的事情，如果你在机器学习方面做过一些工作，你就会知道这有多痛苦！如果你想要成对数据的大型数据集，那就更痛苦了，而且大多数时候，对于像 MRI 图像这样的数据集，<em class="mn">公共成对数据集甚至不存在</em>(或者，我没有挖掘足够多😅).</p><p id="3769" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><strong class="kw iu">这就是 CycleGAN 如此有用的原因，与成对数据相比，它可以用不成对数据进行同样好的训练。</strong></p><p id="5afd" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在我们深入到 CycleGAN 之前，让我们先来看看正则生成敌对网络(GANs)。</p><h2 id="744d" class="ns lr it bd ls nt nu dn lw nv nw dp ma ld nx ny mc lh nz oa me ll ob oc mg od bi translated">生成对抗网络</h2><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oe"><img src="../Images/269783900c04fc04986cf8844e851e41.png" data-original-src="https://miro.medium.com/v2/resize:fit:1276/format:webp/1*0Ukm_cwBltCALzmwgH6hCA.jpeg"/></div></figure><p id="4b6f" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><strong class="kw iu">GANs 的魔力包括两个关键部分:</strong></p><ul class=""><li id="ebd6" class="mv mw it kw b kx ky la lb ld mx lh my ll mz lp na nb nc nd bi translated"><strong class="kw iu">生成器</strong>——负责生成“逼真”的合成数据(在这种情况下，它们是图像)</li><li id="abbf" class="mv mw it kw b kx ne la nf ld ng lh nh ll ni lp na nb nc nd bi translated"><strong class="kw iu">鉴别器</strong> —尽力将生成器生成的“虚假”[0]数据与训练数据集中提供的“真实”[1]数据区分开来</li></ul><p id="663d" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">让我们用一个类比来帮助我们更直观地理解这一点。</p><p id="2884" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">杰西卡是一名专业的艺术品侦探，她的职责是侦查伪造的艺术品。</p><p id="f0f6" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">艺术界有成千上万的“伪造者”在生产“伪造”艺术品。</p><ul class=""><li id="4aab" class="mv mw it kw b kx ky la lb ld mx lh my ll mz lp na nb nc nd bi translated"><strong class="kw iu">伪造者的工作</strong>(“生成者”)是制作看起来非常“逼真”的赝品，并试图愚弄侦探杰西卡(“鉴别者”)。</li><li id="9b06" class="mv mw it kw b kx ne la nf ld ng lh nh ll ni lp na nb nc nd bi translated"><strong class="kw iu">杰西卡</strong>(“鉴别者”)负责区分“真”艺术品与伪造者(“生成者”)的“假”艺术品。</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="ab gu cl of"><img src="../Images/66be47cfb2c02531b762ed14b2996283.png" data-original-src="https://miro.medium.com/v2/format:webp/1*-gFsbymY9oJUQJ-A3GTfeg.png"/></div></figure><p id="5c5d" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">杰西卡和伪造者本质上是在这场猫和老鼠的竞赛中竞争。为了训练甘斯产生逼真的图像，最终目标是训练生成者(“伪造者”)变得真正擅长愚弄鉴别者(“杰西卡”)。</p><p id="8d7d" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">杰西卡和伪造者都很有竞争力，他们互相依赖，以求更好。随着鉴别器更好地检测由发生器从真实图像合成的假图像，这迫使发生器也变得更好地生成“逼真”的图像。</p><h1 id="4840" class="lq lr it bd ls lt lu lv lw lx ly lz ma jz mb ka mc kc md kd me kf mf kg mg mh bi translated">CycleGAN 式传输，但数据不成对</h1><p id="a917" class="pw-post-body-paragraph ku kv it kw b kx mi ju kz la mj jx lc ld mk lf lg lh ml lj lk ll mm ln lo lp im bi translated">CycleGAN 比常规 GAN 更复杂，但它包含类似的组件，如发生器和鉴别器。别担心，只是稍微复杂一点，嗯，也许…</p><p id="cba0" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">让我们首先来看看数据集，它包括两个独立的数据集。我用来训练我的 CycleGAN 模型的两个数据集包括以下内容:</p><ul class=""><li id="1035" class="mv mw it kw b kx ky la lb ld mx lh my ll mz lp na nb nc nd bi translated"><strong class="kw iu">数据集#1: </strong>真实 T1 加权脑 MRI 图像</li><li id="b8b5" class="mv mw it kw b kx ne la nf ld ng lh nh ll ni lp na nb nc nd bi translated"><strong class="kw iu">数据集#2: </strong>真实的 T2 加权脑 MRI 图像</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi og"><img src="../Images/bed019dc7a0b967a5786763db08ceaaf.png" data-original-src="https://miro.medium.com/v2/resize:fit:982/format:webp/1*55uyX8L1MMc8oh_oRz0tGg.png"/></div><figcaption class="mp mq gj gh gi mr ms bd b be z dk">Daily dose of MRI! Left: T1-weighted MRI image, Right: T2-weighted MRI Image. <strong class="bd oh">Ps: Another example of how having both types of MRI images allows for a more comprehensive diagnosis.</strong></figcaption></figure><p id="7a1a" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">CycleGAN 的架构有点像 2 个 GAN 的组合，总共由 4 个模型组成(2 组 1 个发生器网络+ 1 个鉴别器网络)。下面是每个 GAN 在一个 CycleGAN 中所负责的内容:</p><h2 id="b95d" class="ns lr it bd ls nt nu dn lw nv nw dp ma ld nx ny mc lh nz oa me ll ob oc mg od bi translated">甘#1:</h2><blockquote class="oi oj ok"><p id="e35e" class="ku kv mn kw b kx ky ju kz la lb jx lc ol le lf lg om li lj lk on lm ln lo lp im bi translated">GAN #1 负责对 T1 加权的 MRI 图像(第一数据集)应用风格转移，以合成生成其对应的 T2 加权的 MRI 图像(第二数据集)。</p></blockquote><p id="90ba" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><strong class="kw iu">甘#1 发电机:</strong></p><ul class=""><li id="5d3d" class="mv mw it kw b kx ky la lb ld mx lh my ll mz lp na nb nc nd bi translated">输入:T1 加权脑 MRI 图像(第一数据集)</li><li id="1cb0" class="mv mw it kw b kx ne la nf ld ng lh nh ll ni lp na nb nc nd bi translated">输出:合成相应的 T2 加权</li></ul><p id="53a9" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><strong class="kw iu">GAN # 1 的鉴别器:</strong></p><ul class=""><li id="7a34" class="mv mw it kw b kx ky la lb ld mx lh my ll mz lp na nb nc nd bi translated">输入:T2 加权脑 MRI 图像的数据集(数据集#2) +来自 GAN #1 的发生器的合成生成的 T2 加权脑 MRI 图像</li><li id="f724" class="mv mw it kw b kx ne la nf ld ng lh nh ll ni lp na nb nc nd bi translated">输出:真实[1]或虚假[0]-表示生成的图像与来自数据集#2 的真实图像相比有多真实</li></ul><h2 id="4037" class="ns lr it bd ls nt nu dn lw nv nw dp ma ld nx ny mc lh nz oa me ll ob oc mg od bi translated">甘二号:</h2><blockquote class="oi oj ok"><p id="cb68" class="ku kv mn kw b kx ky ju kz la lb jx lc ol le lf lg om li lj lk on lm ln lo lp im bi translated">GAN #2 负责将风格转移应用于 T2 加权 MRI 图像(第二数据集)以合成生成其对应的 T1 加权 MRI 图像(第一数据集)。</p></blockquote><p id="3465" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><strong class="kw iu">甘#2 发电机:</strong></p><ul class=""><li id="4aa3" class="mv mw it kw b kx ky la lb ld mx lh my ll mz lp na nb nc nd bi translated">输入:T2 加权脑 MRI 图像(第二数据集)</li><li id="1df5" class="mv mw it kw b kx ne la nf ld ng lh nh ll ni lp na nb nc nd bi translated">输出:合成相应的 T2 加权</li></ul><p id="0143" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><strong class="kw iu">GAN # 2 的鉴别器:</strong></p><ul class=""><li id="9cbf" class="mv mw it kw b kx ky la lb ld mx lh my ll mz lp na nb nc nd bi translated">输入:T1 加权脑 MRI 图像的数据集(数据集#1) +来自 GAN #2 发生器的合成生成的 T1 加权脑 MRI 图像</li><li id="08fe" class="mv mw it kw b kx ne la nf ld ng lh nh ll ni lp na nb nc nd bi translated">输出:真实[1]或虚假[0]-表示生成的图像与数据集#1 中的真实图像相比有多真实</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oo"><img src="../Images/1d84e3a247294d891d61cf36ec5c08f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5rBJSzWRCAlASPrVxdRVqw.jpeg"/></div></div><figcaption class="mp mq gj gh gi mr ms bd b be z dk">CycleGAN representation</figcaption></figure><p id="17fb" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><strong class="kw iu">好的，但是发生器和鉴别器的组成部分到底是什么？</strong></p><p id="cf86" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">发生器的结构由一个编码器-解码器网络组成。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi op"><img src="../Images/5bea8ceac46a9425ea1a26863037295b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*htre0kgGDqltmgzQ6dO1cg.png"/></div></div></figure><p id="df07" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><strong class="kw iu">发电机包含三种主要类型的部件:</strong></p><p id="3731" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><strong class="kw iu"> 1。编码器</strong> —由卷积层组成，将图像解压缩为代表其压缩特征的矢量。</p><ul class=""><li id="bede" class="mv mw it kw b kx ky la lb ld mx lh my ll mz lp na nb nc nd bi translated">接受“真实的”MRI 图像，即来自中提供的数据集的 256 x 256 图像作为输入。</li><li id="408b" class="mv mw it kw b kx ne la nf ld ng lh nh ll ni lp na nb nc nd bi translated">将图像的压缩表示作为特征向量输出。</li></ul><p id="ce05" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><strong class="kw iu"> 2。转换器</strong> —由负责解释编码的残差神经网络(ResNet)组成。</p><ul class=""><li id="73fd" class="mv mw it kw b kx ky la lb ld mx lh my ll mz lp na nb nc nd bi translated">ResNet 层将来自编码器的特征向量作为输入。</li><li id="5b90" class="mv mw it kw b kx ne la nf ld ng lh nh ll ni lp na nb nc nd bi translated">它负责将变换应用于特征向量，以使特征向量与期望的输出相匹配。例如，对于负责将 T1 加权 MRI 图像变换为 T2 加权 MRI 图像的 GAN #1，变换器的工作是变换 T1 加权 MRI 图像的压缩特征向量，使得它类似于 T2 加权 MRI 图像的特征向量。</li><li id="3b33" class="mv mw it kw b kx ne la nf ld ng lh nh ll ni lp na nb nc nd bi translated">每个 ResNet 层由两个使用跳过连接的卷积层组成。跳过连接确保早期层中的变换在整个模型中得以保留，因为它解决了渐变消失的问题。这允许输出在重建(由解码器执行)期间保留原始输入图像的大部分特征。</li></ul><p id="7221" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><strong class="kw iu"> 3。解码器</strong> —由解卷积层(与卷积层相反)组成，它将图像的紧凑表示解构成原始大小。</p><ul class=""><li id="8a88" class="mv mw it kw b kx ky la lb ld mx lh my ll mz lp na nb nc nd bi translated">在这种情况下，原始大小是 256 x256 的图像。</li><li id="ed33" class="mv mw it kw b kx ne la nf ld ng lh nh ll ni lp na nb nc nd bi translated">解码器将来自 ResNet 层的<em class="mn">变换后的</em>特征向量作为输入，并对其进行上采样以生成新的 256×256 图像。</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oq"><img src="../Images/c5739608c597a6b5ba36c6baf82cf1a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*gECW_aNyE0jvPmG4.jpeg"/></div></div><figcaption class="mp mq gj gh gi mr ms bd b be z dk">Convolutional neural network</figcaption></figure><p id="653b" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><strong class="kw iu">解码器网络的架构要简单得多，由一个执行图像分类的卷积神经网络</strong>组成。如上所述，卷积层决定了输入模型的图像是真的[1]还是假的[0]。</p><p id="9e4e" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在只训练了我的模型 2 个时期后，它就能够合成看起来“干净”的 MRI 图像了！然而，我建议为大约 50 个纪元训练这样的模型，这可能需要几天时间📆。</p><h2 id="c4fc" class="ns lr it bd ls nt nu dn lw nv nw dp ma ld nx ny mc lh nz oa me ll ob oc mg od bi translated">结果如下:</h2><p id="49f0" class="pw-post-body-paragraph ku kv it kw b kx mi ju kz la mj jx lc ld mk lf lg lh ml lj lk ll mm ln lo lp im bi translated">这是从 T1 加权 MRI 图像生成 T2 加权 MRI 图像的例子之一。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi or"><img src="../Images/829b40a31560a76316e55636f9e899ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ASIGNtO5VeJOvrkTLu1NTQ.png"/></div></div><figcaption class="mp mq gj gh gi mr ms bd b be z dk">Real: T1–weighted MRI image, Generated: T2-Generated MRI image</figcaption></figure><p id="61c5" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这是产生相应 T2 加权 MRI 图像的 T1 加权 MRI 图像的模型的另一个例子。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi os"><img src="../Images/124026c496c6525310363456a29383da.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QdCc9gB9jjRSssK4s6d9cQ.png"/></div></div><figcaption class="mp mq gj gh gi mr ms bd b be z dk">Real: T2-weighted MRI image, Generated: T1-weighted MRI image</figcaption></figure></div><div class="ab cl ot ou hx ov" role="separator"><span class="ow bw bk ox oy oz"/><span class="ow bw bk ox oy oz"/><span class="ow bw bk ox oy"/></div><div class="im in io ip iq"><p id="89be" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这项技术的含义是疯狂的！CycleGAN 可以用来合成任何对比度级别的 MRI 图像！此外，它甚至有可能被部署精确地导出 CT 扫描、PET 扫描、X 射线等。核磁共振扫描，反之亦然！</p><h2 id="b665" class="ns lr it bd ls nt nu dn lw nv nw dp ma ld nx ny mc lh nz oa me ll ob oc mg od bi translated">关键要点:</h2><ul class=""><li id="91eb" class="mv mw it kw b kx mi la mj ld pa lh pb ll pc lp na nb nc nd bi translated">CycleGAN 使用不成对的数据，这使得它非常有吸引力，因为成对的数据很少，很难找到</li><li id="571b" class="mv mw it kw b kx ne la nf ld ng lh nh ll ni lp na nb nc nd bi translated">GANs 包括两个网络:生成器(“伪造者”)和鉴别器(“侦探”)</li><li id="3cea" class="mv mw it kw b kx ne la nf ld ng lh nh ll ni lp na nb nc nd bi translated">一个循环中涉及两个 GAN</li><li id="4a81" class="mv mw it kw b kx ne la nf ld ng lh nh ll ni lp na nb nc nd bi translated">我训练了一个 CycleGAN 来合成 T1 加权的 MRI 图像，给定 T2 加权的 MRI 图像，反之亦然</li></ul><p id="4938" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><em class="mn">在您离开之前，如果您有任何疑问，请随时联系我，并通过</em> <a class="ae mt" href="https://www.google.com/url?sa=t&amp;rct=j&amp;q=&amp;esrc=s&amp;source=web&amp;cd=1&amp;cad=rja&amp;uact=8&amp;ved=2ahUKEwjsqKS-y8DmAhVJXK0KHYHrCK0QFjAAegQIBxAB&amp;url=https%3A%2F%2Fca.linkedin.com%2Fin%2Fjoey-mach-6293b1175&amp;usg=AOvVaw2zgAwIF5r8P-8rHkWc5B_A" rel="noopener ugc nofollow" target="_blank"> <em class="mn"> LinkedIn </em> </a> <em class="mn">与我联系！PS:我每月都会发简讯，如果你有兴趣了解这位 16 年的创新者/人工智能爱好者的最新动态，</em> <strong class="kw iu"> <em class="mn">请随意订阅</em> </strong> <a class="ae mt" href="https://landing.mailerlite.com/webforms/landing/j8c7g3" rel="noopener ugc nofollow" target="_blank"> <strong class="kw iu"> <em class="mn">这里</em> </strong> </a> <strong class="kw iu"> <em class="mn">！</em> </strong></p></div></div>    
</body>
</html>