<html>
<head>
<title>Use AI to Write Captions for Images with Cloudsight + Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用 AI 用 Cloudsight + Python 为图片写标题</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/use-ai-to-write-captions-for-images-with-cloudsight-python-a82115f16ab8?source=collection_archive---------27-----------------------#2019-11-21">https://towardsdatascience.com/use-ai-to-write-captions-for-images-with-cloudsight-python-a82115f16ab8?source=collection_archive---------27-----------------------#2019-11-21</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="f36f" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">Pythonic API 允许您自动为图像编写人类可读的标题</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/4acbdcc41d3b65b4c101e055d49f4ac2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AFteTn0s-7B86fCOmDKb8w.jpeg"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">How would you caption this? Credit: Gado Images.</figcaption></figure><p id="b6f6" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如今市场上有很多使用人工智能和机器学习来标记图像的解决方案。IBM Watson、Imagga、Cloudsight、Google Vision 和微软 Azure 的解决方案都表现良好，通过 Algorithmia 等服务，你可以轻松地启动和训练自己的图像标记网络。</p><p id="837a" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">然而，为图像编写人类可读的句子长度的标题是一项更困难的任务。您生成的句子不仅需要准确描述场景中的对象，还需要捕捉它们彼此之间的关系、上下文等。它需要知道什么才是真正重要的——没有人想要一个对桌子上的每一个物体或背景中的每一株植物都进行详细描述的图像。当人工智能知道得太多时，它可能比知道得太少更糟糕。</p><p id="c3a4" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">总部位于洛杉矶的初创公司 Cloudsight 正致力于解决使用人工智能和机器学习来自动为图像编写句子长度、人类可读的字幕的挑战。</p><p id="4f51" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">他们为特定应用提供完全定制的人在回路系统，但他们也有一个通用模型，你可以很快开始测试，并返回一些令人印象深刻的结果。这是他们唯一的人工智能系统，但同样，你也可以将其插入人类团队，并获得更好的输出(以更高的价格和更多的训练时间)。</p><h2 id="ffd0" class="lv lw it bd lx ly lz dn ma mb mc dp md lh me mf mg ll mh mi mj lp mk ml mm mn bi translated">入门指南</h2><p id="e995" class="pw-post-body-paragraph ky kz it la b lb mo ju ld le mp jx lg lh mq lj lk ll mr ln lo lp ms lr ls lt im bi translated">要开始使用 Cloudsight API 进行测试，您不能像在 IBM 或 Google Vision 中那样注册一个帐户。Cloudsight 是一家新兴公司，他们喜欢与潜在的新客户进行合作，尤其是在早期测试阶段。</p><p id="5bdc" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">好消息是他们反应很快。通过他们网站上的联系方式<a class="ae lu" href="https://cloudsight.ai/contact" rel="noopener ugc nofollow" target="_blank">联系他们，他们通常会在几个小时后回来。你甚至可能会听到他们的首席执行官或团队的高级成员的消息。Cloudsight 通常可以提供 API 访问和一定数量的免费 API 调用来进行测试。我得到了 1000 个免费的 API 调用来开始。</a></p><p id="1e2f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">一旦你联系并设置好了，他们会给你一个 API 密匙。</p><h2 id="8be4" class="lv lw it bd lx ly lz dn ma mb mc dp md lh me mf mg ll mh mi mj lp mk ml mm mn bi translated">准备 Python</h2><p id="b106" class="pw-post-body-paragraph ky kz it la b lb mo ju ld le mp jx lg lh mq lj lk ll mr ln lo lp ms lr ls lt im bi translated">方便的是，Cloudsight 有一个随时可用的 Python 库。</p><p id="3750" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">用 pip 安装。</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="4054" class="lv lw it mu b gy my mz l na nb">pip install cloudsight</span></pre><p id="c65c" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果你还没有，我也喜欢通过 Pillow 安装 PIL，这是一个图像处理库。</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="4f75" class="lv lw it mu b gy my mz l na nb">pip install pillow</span></pre><h2 id="9a9d" class="lv lw it bd lx ly lz dn ma mb mc dp md lh me mf mg ll mh mi mj lp mk ml mm mn bi translated">预处理</h2><p id="2afb" class="pw-post-body-paragraph ky kz it la b lb mo ju ld le mp jx lg lh mq lj lk ll mr ln lo lp ms lr ls lt im bi translated">首先，选择要处理的图像。我将使用本文顶部的那张照片，它是由我公司的一位新西兰摄影师拍摄的。</p><p id="09d9" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">设置基本导入。</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="6a57" class="lv lw it mu b gy my mz l na nb">from PIL import Image</span><span id="7220" class="lv lw it mu b gy nc mz l na nb">import cloudsight</span></pre><p id="5466" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我喜欢先通过 PIL 的缩略图功能将图像缩小到标准尺寸。这使得它更小，更容易上传。如果你不这样做，Cloudsight 会帮你做，但是发送更少的字节更容易，所以你也可以在你这边精简一下。</p><p id="60f8" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这是标准的东西——你接收图像，使用缩略图功能使其大小一致，然后再次保存。</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="2e46" class="lv lw it mu b gy my mz l na nb">im = Image.open('YOURIMAGE.jpg')</span><span id="684d" class="lv lw it mu b gy nc mz l na nb">im.thumbnail((600,600))</span><span id="f3fc" class="lv lw it mu b gy nc mz l na nb">im.save('cloudsight.jpg')</span></pre><h2 id="c1aa" class="lv lw it bd lx ly lz dn ma mb mc dp md lh me mf mg ll mh mi mj lp mk ml mm mn bi translated">打电话</h2><p id="ebc3" class="pw-post-body-paragraph ky kz it la b lb mo ju ld le mp jx lg lh mq lj lk ll mr ln lo lp ms lr ls lt im bi translated">现在您已经有了一个经过适当处理的图像，您可以进行实际的 API 调用了。首先，使用 API 密钥进行身份验证。</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="5a9b" class="lv lw it mu b gy my mz l na nb">auth = cloudsight.SimpleAuth('YOUR KEY')</span></pre><p id="91c3" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">接下来，打开您的图像文件，并发出请求:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="496b" class="lv lw it mu b gy my mz l na nb">with open('cloudsight.jpg', 'rb') as f:<br/>    response = api.image_request(f, 'cloudsight.jpg',  {'image_request[locale]': 'en-US',})</span></pre><p id="e730" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">接下来的一点有点出乎意料。因为 Cloudsight 有时会有人参与，所以您需要给他们几秒钟或更长的时间来完成他们的请求。这与 API 对 Watson 等标签服务的请求略有不同，后者往往会立即完成。</p><p id="9bc8" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">使用 Cloudsight，您可以调用 wait 函数，并定义最大等待时间。30 秒通常足够了。</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="7c49" class="lv lw it mu b gy my mz l na nb">status = api.wait(response['token'], timeout=30)</span></pre><p id="1138" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">最后，打印出响应！</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="a600" class="lv lw it mu b gy my mz l na nb">print status</span></pre><h2 id="625e" class="lv lw it bd lx ly lz dn ma mb mc dp md lh me mf mg ll mh mi mj lp mk ml mm mn bi translated">回应</h2><p id="616e" class="pw-post-body-paragraph ky kz it la b lb mo ju ld le mp jx lg lh mq lj lk ll mr ln lo lp ms lr ls lt im bi translated">Cloudsight 将返回一个包含响应数据的对象。这是我得到的上面的图像。</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="b3d0" class="lv lw it mu b gy my mz l na nb">{u'status': u'completed', u'name': u'man in gray crew neck t-shirt sitting on brown wooden chair', u'url': u'https://assets.cloudsight.ai/uploads/image_request/image/734/734487/734487841/cloudsight.jpg', u'similar_objects': [u'chair', u't-shirt', u'crew neck'], u'token': u'fgo4F5ufJsQUCLrtwGJkxQ', u'nsfw': False, u'ttl': 54.0, u'structured_output': {u'color': [u'gray', u'brown'], u'gender': [u'man'], u'material': [u'wooden']}, u'categories': [u'fashion-and-jewelry', u'furniture']}</span></pre><p id="34f1" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这是非常酷的东西！正如你所看到的，系统给图片加了标题<strong class="la iu">“一个穿着灰色圆领 t 恤的男人坐在棕色的木椅上。”</strong>说得好极了！</p><p id="77b7" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">除了非结构化的句子，API 还给我关于图像的结构化数据，比如图像中的颜色(灰色、棕色)、人的性别(男人)、类别和呈现的材料。</p><p id="6109" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在一次调用中结合结构化和非结构化数据非常有帮助——您可以进行标记或语义映射，同时还可以获得人类可读的句子来描述图像。</p><p id="462a" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这是完整的节目单。</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="bac7" class="lv lw it mu b gy my mz l na nb">from PIL import Image</span><span id="659e" class="lv lw it mu b gy nc mz l na nb">import cloudsight<br/></span><span id="afda" class="lv lw it mu b gy nc mz l na nb">im = Image.open('YOUR IMAGE')</span><span id="eded" class="lv lw it mu b gy nc mz l na nb">im.thumbnail((600,600))</span><span id="65fe" class="lv lw it mu b gy nc mz l na nb">im.save('cloudsight.jpg')</span><span id="8e55" class="lv lw it mu b gy nc mz l na nb">auth = cloudsight.SimpleAuth('YOUR API KEY')</span><span id="8b0c" class="lv lw it mu b gy nc mz l na nb">api = cloudsight.API(auth)</span><span id="7df6" class="lv lw it mu b gy nc mz l na nb">with open('cloudsight.jpg', 'rb') as f:</span><span id="d649" class="lv lw it mu b gy nc mz l na nb">response = api.image_request(f, 'cloudsight.jpg', {'image_request[locale]': 'en-US',})</span><span id="a3ee" class="lv lw it mu b gy nc mz l na nb">status = api.wait(response['token'], timeout=30)</span><span id="6a06" class="lv lw it mu b gy nc mz l na nb">print status</span></pre><p id="a02e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这是一个句子长度的图像字幕，通过人工智能，大约 10 行代码！</p><h2 id="92c8" class="lv lw it bd lx ly lz dn ma mb mc dp md lh me mf mg ll mh mi mj lp mk ml mm mn bi translated">从这里去哪里</h2><p id="32a9" class="pw-post-body-paragraph ky kz it la b lb mo ju ld le mp jx lg lh mq lj lk ll mr ln lo lp ms lr ls lt im bi translated">如果您想在测试后扩大您对 Cloudsight 的使用，该团队可以帮助您为生产做好准备。他们不报一般价格，这完全取决于您的预计数量、使用情形和所需的任何额外培训。</p><p id="44e8" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果通用模型的输出还不错，但并不完美，您还可以与团队合作，根据您的特定用例对其进行定制。例如，我正与他们合作，将人类部分引入到处理历史图像的循环中。定价可能会高于纯人工智能解决方案，但它也将更具体地针对我的用例。这是与新兴公司合作的最大好处，因为他们能更好地满足你的特殊需求。</p><p id="54e7" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果你对自动图像字幕感兴趣，可以看看 Cloudsight！同样，使用 Python，您可以在几分钟内开始为您的图像添加字幕——或者只是使用这一新功能——而且只需很少的代码！</p></div></div>    
</body>
</html>