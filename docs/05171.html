<html>
<head>
<title>No True Effects in High Dimensions</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">高维空间中没有真正的效果</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/no-true-effects-in-high-dimensions-1f56360182cd?source=collection_archive---------10-----------------------#2019-08-02">https://towardsdatascience.com/no-true-effects-in-high-dimensions-1f56360182cd?source=collection_archive---------10-----------------------#2019-08-02</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="f9f0" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsdatascience.com/tagged/stats-ml-life-sciences" rel="noopener" target="_blank">生命科学的数理统计和机器学习</a></h2><div class=""/><div class=""><h2 id="542f" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">我们能相信从高维数据中得到的结果吗？</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/2f5af9a9028ffeb6b22b4b8c7a37791b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5pNk13PqNpG32EI1wJnHpQ.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk"><a class="ae lh" href="https://gateway.newton.ac.uk/event/tgmw46" rel="noopener ugc nofollow" target="_blank">Image source</a></figcaption></figure><p id="4e0e" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">这是<a class="ae lh" href="https://towardsdatascience.com/tagged/stats-ml-life-sciences?source=post_page---------------------------" rel="noopener" target="_blank"> <strong class="lk jd">生命科学的数理统计与机器学习</strong> </a>栏目的第五篇文章。<strong class="lk jd"> </strong>在本专栏中，我将介绍我们在<a class="ae lh" href="https://en.wikipedia.org/wiki/List_of_life_sciences" rel="noopener ugc nofollow" target="_blank">生命科学</a>中面临的数据和分析挑战，如<strong class="lk jd">生物医学、生物信息学、细胞生物学、遗传学、进化生物学</strong>等。也许主要的分析挑战是处理<strong class="lk jd">高维数据</strong>，对这一事实的不当解释可能会导致错误的结论，这对医疗保健中的患者安全尤其有害。</p><p id="2a38" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在这篇文章中，我将展示当增加数据的维度时，分析模型如何不能重建变量之间的真实关系。</p><h1 id="582c" class="me mf it bd mg mh mi mj mk ml mm mn mo ki mp kj mq kl mr km ms ko mt kp mu mv bi translated">高维多变量分析</h1><p id="02bf" class="pw-post-body-paragraph li lj it lk b ll mw kd ln lo mx kg lq lr my lt lu lv mz lx ly lz na mb mc md im bi translated">考虑一个简单的线性模型<strong class="lk jd"> Y ~ X </strong>，其中 Y 是<strong class="lk jd">响应</strong>，X 是解释变量(<strong class="lk jd">预测值</strong>)。<strong class="lk jd"> </strong> Y 可以是<strong class="lk jd">表型向量</strong>，例如 n 个个体/样本中每一个的疾病状态(患病/健康)，而 X 是具有<strong class="lk jd"> n 个样本</strong>和<strong class="lk jd"> p 个特征/维度的矩阵。</strong>为简单起见，X 和 Y 均取自正态分布。假设低维情况 n &gt; &gt; p:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="nb nc l"/></div></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nd"><img src="../Images/d177eda683d32205b780eae186e7f641.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*H7SeLuENMXxZtAonNgmH7w.png"/></div></div></figure><p id="8022" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">结果看起来不错，Y 和 X 变量不像预期的那样相关，因为它们来自正态分布。只要 n &gt; p，数学工作没有问题。现在让我们增加特征/维度 p 的数量，看看会发生什么。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="nb nc l"/></div></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ne"><img src="../Images/58e172dae353a868f850f3e4f6e4a488.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NqahQGpvezevBFQuQwcQCg.png"/></div></div></figure><p id="627c" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">发生了什么事？我们可以看到，X 中的一些特征，即 X2、X6、X9、X10，开始与 Y 显著相关<strong class="lk jd">。看看调整后的 R 平方，它是 X 解释的 Y 方差的分数，<strong class="lk jd">我们现在解释 Y 方差的 28% </strong>，尽管<strong class="lk jd"> Y 和 X 不应该相关</strong>，因为它们是从正态分布中独立采样的。好了，如果特征数 p 等于样本数 n，会发生什么？</strong></p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="nb nc l"/></div></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nf"><img src="../Images/1db720016113027f5b9fe8393841ef46.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*v8s0Bjt0fG88wAbfZ6z4dA.png"/></div></div></figure><p id="7137" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">有意思！当<strong class="lk jd"> p = n </strong>时，r 拒绝计算多元线性模型，尽管我们只有 20 维。我们在这里观察到的效果被称为<strong class="lk jd">过拟合</strong>，这可以被认为是<a class="ae lh" href="https://en.wikipedia.org/wiki/Curse_of_dimensionality" rel="noopener ugc nofollow" target="_blank"> <strong class="lk jd">维度诅咒</strong> </a>的一种表现形式。过度拟合意味着我们不能使用我们想要的那么多的拟合参数，而是应该基于一些附加的标准来选择它们的<strong class="lk jd">最佳数量</strong>，例如<a class="ae lh" href="https://en.wikipedia.org/wiki/Akaike_information_criterion" rel="noopener ugc nofollow" target="_blank"><strong class="lk jd">【AIC】</strong></a>【阿卡科信息标准】，或者执行<strong class="lk jd">交叉验证</strong>，因为预测器的数量实质上是多元线性模型的<strong class="lk jd">超参数</strong>。</p><p id="4a18" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">所以我们对 R 抛出了一个“奇点”误差，对于仅仅 20 个维度来说，事实上我们通常有<strong class="lk jd">数万个</strong><strong class="lk jd">(</strong><a class="ae lh" href="https://en.wikipedia.org/wiki/RNA-Seq" rel="noopener ugc nofollow" target="_blank"><strong class="lk jd">RNA seq</strong></a><strong class="lk jd">)</strong><strong class="lk jd">甚至数百万个</strong> <strong class="lk jd"> ( </strong> <a class="ae lh" href="https://en.wikipedia.org/wiki/DNA_sequencing" rel="noopener ugc nofollow" target="_blank"> <strong class="lk jd">基因组学</strong> </a> <strong class="lk jd">，</strong><strong class="lk jd">甲基化</strong>  <strong class="lk jd"> ) </strong>个维度在这是生命科学中多变量分析的主要障碍，也是为什么<strong class="lk jd">单变量特征选择</strong> <strong class="lk jd"> ( </strong> <a class="ae lh" href="https://en.wikipedia.org/wiki/Genome-wide_association_study" rel="noopener ugc nofollow" target="_blank"> <strong class="lk jd">关联研究</strong> </a> <strong class="lk jd">、差异基因表达、差异甲基化)</strong>通常优于多变量特征选择的一个原因，尽管后者的预测能力更高。典型生物设置<strong class="lk jd">n&lt;T57】p</strong>的另一个结果是，必须用套索/脊/弹性网预选信息特征，并进行降维。</p><h1 id="54d9" class="me mf it bd mg mh mi mj mk ml mm mn mo ki mp kj mq kl mr km ms ko mt kp mu mv bi translated">对协变量进行调整隐藏了真实的影响</h1><p id="be1a" class="pw-post-body-paragraph li lj it lk b ll mw kd ln lo mx kg lq lr my lt lu lv mz lx ly lz na mb mc md im bi translated">现在想象 X 不是一个矩阵而是一个向量，例如一个<a class="ae lh" href="https://en.wikipedia.org/wiki/Genotype" rel="noopener ugc nofollow" target="_blank">基因型</a>的向量，所以我们正在进行一项关联研究，表型 Y 与基因型 X。我经常观察到试图解释可能<strong class="lk jd">混淆</strong>这种关联的其他因素(<strong class="lk jd">协变量</strong>)。事实上，如果个体来自不同的人类群体，如非洲人、欧洲人、亚洲人，这种异质性可以解释表型 Y 中的显著百分比变异，而我们感兴趣的是由基因型解释的表型变异<strong class="lk jd">，换句话说，群体异质性是一个<strong class="lk jd">混杂因素</strong>，应在模型 Y~X 中进行调整。通常，对所有可用的遗传变异体进行<strong class="lk jd">主成分分析(PCA) </strong>，并选择少量 PC 作为关联的协变量:Y~X + PC1 +在这种情况下，协变量的数量是根据常识任意选择的，而在这里，我想证明这个数量对于恢复表现型与基因型关联的真实效果可能是至关重要的。</strong></p><p id="85ad" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">让我们模拟 X 和 Y 之间的一个线性关系:<strong class="lk jd"> Y=2*X +噪声</strong>。假设我们有一个线性模型 Y~X，让我们针对逐渐增加的与 Y 稍微相关的 PCs 数量来调整这个模型，即 PC1=0.9*Y，PC2=0.8*Y 等等。：</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="nb nc l"/></div></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ng"><img src="../Images/183b2203f115730a1ba8e8cfc68e180b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*O0p8oD1sM-OCAavBdz7LGg.png"/></div></div></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ng"><img src="../Images/73727886b160c3d419935fa76bcd411f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wsb7OAA9QqZ8oaj2YngTLA.png"/></div></div></figure><p id="adaf" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我们在此观察到，当添加与 Y 相关的 PCs 时，Y 和 X 之间关联的真实效应 2 变得越来越难以恢复。尽管我们仍有 n&gt;p，但当添加 10 个 PCs 时，恢复的效应约为 0.5，这与真实效应 2 相差甚远。此外，我们观察到调整后的 R 平方(<strong class="lk jd">方差解释</strong>)几乎达到 1，这意味着我们通过仅包括 10 个协变量来解释 Y <strong class="lk jd">中的所有方差。</strong></p><p id="0986" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在上面的代码中，请注意(1-i/10)前面的系数 1。我们称之为 Y 和 PCs 之间的<strong class="lk jd">协变系数</strong>。我们刚刚看到，对于协变=1 的情况，真实效应 2 可能被错误地计算为 0.5。如果我们增加 Y 和 PCs 之间的协变，即协变=2 和 3，现在会发生什么？</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="nb nc l"/></div></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ng"><img src="../Images/df5731a1e75b77c72ee56082e1378487.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fchJgwXEnvX4Pg2g3bo8iw.png"/></div></div></figure><p id="9562" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我们观察到，Y 与协变量 PCs 越相关，就越难重建真实的效果。当协变=3 时，重构的效应基本上是<strong class="lk jd">零</strong>，这意味着 Y 和 X 之间没有关联，尽管<strong class="lk jd">我们已经将该效应模拟为 2 </strong>。因此，尽管<strong class="lk jd">可以从生物学角度</strong>调整 covarites 的线性模型，但这应该<strong class="lk jd">谨慎执行</strong>，因为由于维数灾难，数学可能无法忍受。</p><h1 id="4346" class="me mf it bd mg mh mi mj mk ml mm mn mo ki mp kj mq kl mr km ms ko mt kp mu mv bi translated">摘要</h1><p id="4252" class="pw-post-body-paragraph li lj it lk b ll mw kd ln lo mx kg lq lr my lt lu lv mz lx ly lz na mb mc md im bi translated">在本文中，我们已经了解到，由于维数灾难，当特征/维度的数量接近样本的数量时,<strong class="lk jd">多元分析会爆炸。此外，进行关联研究时，您应该特别注意线性模型调整的协变量的数量。<strong class="lk jd">过多的协变量可能会</strong> <strong class="lk jd">模糊真实效果</strong>并使其无法重建。</strong></p><p id="b0b3" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在下面的评论中让我知道生命科学中的哪些分析对你来说似乎特别神秘，我会在这个专栏中尝试回答它们。在媒体<a class="nh ni ep" href="https://medium.com/u/8570b484f56c?source=post_page-----1f56360182cd--------------------------------" rel="noopener" target="_blank">尼古拉·奥斯科尔科夫</a>关注我，在 Twitter @尼古拉·奥斯科尔科夫关注我，在<a class="ae lh" href="http://linkedin.com/in/nikolay-oskolkov-abb321186?source=post_page---------------------------" rel="noopener ugc nofollow" target="_blank"> Linkedin </a>关注我。下次我们将比较<strong class="lk jd">单变量与多变量特征选择</strong>，敬请关注。</p></div></div>    
</body>
</html>