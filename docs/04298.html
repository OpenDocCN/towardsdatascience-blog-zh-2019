<html>
<head>
<title>Time Series Analysis and Forecasting of Web Service Metrics</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Web 服务度量的时间序列分析和预测</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/time-series-analysis-and-forecasting-of-web-service-metrics-1e15d7fb72c2?source=collection_archive---------7-----------------------#2019-07-04">https://towardsdatascience.com/time-series-analysis-and-forecasting-of-web-service-metrics-1e15d7fb72c2?source=collection_archive---------7-----------------------#2019-07-04</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="f097" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">讨论用于分析和预测 Web 服务度量及其应用的各种机器学习技术。</h2></div><h1 id="2e06" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">概观</h1><p id="0a86" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">在本文中，我们将<strong class="lc iu"> <em class="lw">讨论用于分析和预测 web 服务指标的各种机器学习技术及其应用</em> </strong>。<em class="lw"> Auto-scaling </em>就是一个很好的应用，预测技术可以用来估计 web 服务的请求率。类似地，预测技术可以应用于服务指标，以<em class="lw">预测警报和异常</em>。</p><p id="edb6" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">在本文中，我将首先讨论<strong class="lc iu">时间序列</strong>数据及其在预测技术中的作用。稍后，我将举例说明一个用于预测 web 服务请求率的预测模型。本文提供了对时间序列预测技术的基本理解，这些技术可以应用于服务度量或任何时间序列数据。</p><figure class="md me mf mg gt mh gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi mc"><img src="../Images/b01a9bb771c86364932e4a50522e3e0a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Bd8bcyb-hSZYt4MF-8oP0g.png"/></div></div></figure></div><div class="ab cl mo mp hx mq" role="separator"><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt"/></div><div class="im in io ip iq"><h1 id="fccf" class="ki kj it bd kk kl mv kn ko kp mw kr ks jz mx ka ku kc my kd kw kf mz kg ky kz bi translated">开始使用…</h1><h2 id="ad84" class="na kj it bd kk nb nc dn ko nd ne dp ks lj nf ng ku ln nh ni kw lr nj nk ky nl bi translated">什么是时间序列？</h2><p id="2f53" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated"><strong class="lc iu">时间序列</strong>是以恒定的时间间隔收集的数据点的集合。<strong class="lc iu">时间序列数据的示例</strong>可以从应用程序指标(如 RPM 中的请求率)到系统指标(如以固定时间间隔获取的空闲 CPU 百分比)不等。</p><p id="e976" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">为了用机器学习技术解决预测问题，需要将数据转换成时间序列格式。时间序列数据具有自然的时间顺序。时间序列分析可以应用于实值、连续数据、离散数字数据或离散符号数据。</p><p id="2ed9" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">为了说明，我使用了<em class="lw"> Python </em>。<strong class="lc iu"> <em class="lw"> Numpy，Pandas，Matpoltlib </em> </strong>模块用于<em class="lw">转换&amp;分析</em>，S <strong class="lc iu"> <em class="lw"> tatsmodel </em> </strong>用于<em class="lw">预测模型</em>。</p><figure class="md me mf mg gt mh"><div class="bz fp l di"><div class="nm nn l"/></div></figure><figure class="md me mf mg gt mh"><div class="bz fp l di"><div class="nm nn l"/></div></figure><figure class="md me mf mg gt mh gh gi paragraph-image"><div class="gh gi no"><img src="../Images/663b4446a6a8e376378fcb56c3d26890.png" data-original-src="https://miro.medium.com/v2/resize:fit:740/format:webp/1*rEqJdvyhR4KmUKuVcDWv9Q.png"/></div><figcaption class="np nq gj gh gi nr ns bd b be z dk">Statistics of Request Rate data</figcaption></figure><figure class="md me mf mg gt mh"><div class="bz fp l di"><div class="nm nn l"/></div></figure><figure class="md me mf mg gt mh gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/5e6afb39ba1fd09d6077310740c21d43.png" data-original-src="https://miro.medium.com/v2/resize:fit:538/format:webp/1*VcOnez2F3BJc2AMvbldd3w.jpeg"/></div><figcaption class="np nq gj gh gi nr ns bd b be z dk">Few data points of time series</figcaption></figure><figure class="md me mf mg gt mh"><div class="bz fp l di"><div class="nm nn l"/></div></figure><figure class="md me mf mg gt mh gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi nu"><img src="../Images/4df69d8a0265f00fc6de2b51538d6e41.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IMkVKlYrSBJbvaH-oVQzUA.jpeg"/></div></div><figcaption class="np nq gj gh gi nr ns bd b be z dk">Time series graph representing request rates (in RPM) for a web service taken at every minute of interval.</figcaption></figure><blockquote class="nv nw nx"><p id="3210" class="la lb lw lc b ld lx ju lf lg ly jx li ny lz ll lm nz ma lp lq oa mb lt lu lv im bi translated"><strong class="lc iu"> <em class="it">预处理数据</em> </strong></p><p id="646c" class="la lb lw lc b ld lx ju lf lg ly jx li ny lz ll lm nz ma lp lq oa mb lt lu lv im bi translated">查看上面以 RPM 为单位的请求率图表，您是否发现数据存在任何挑战？</p><p id="713e" class="la lb lw lc b ld lx ju lf lg ly jx li ny lz ll lm nz ma lp lq oa mb lt lu lv im bi translated">在上图中，您可以观察到<strong class="lc iu">有太多的数据点和峰值</strong>需要处理。</p><p id="b43b" class="la lb lw lc b ld lx ju lf lg ly jx li ny lz ll lm nz ma lp lq oa mb lt lu lv im bi translated">如何处理这个问题？</p><p id="9a2e" class="la lb lw lc b ld lx ju lf lg ly jx li ny lz ll lm nz ma lp lq oa mb lt lu lv im bi translated"><strong class="lc iu"> *重采样</strong>:所有的数据点都是以一分钟为间隔采集的。每小时、每天或每周重新采样数据有助于减少要处理的数据点数量。在本例中，我们将使用<strong class="lc iu">日平均重采样</strong>值。</p><p id="9843" class="la lb lw lc b ld lx ju lf lg ly jx li ny lz ll lm nz ma lp lq oa mb lt lu lv im bi translated"><strong class="lc iu"> *变换</strong>:可以应用对数、平方根或立方根等变换来处理图形中的尖峰。在本例中，我们将对时间序列执行<strong class="lc iu">对数转换</strong>。</p></blockquote><figure class="md me mf mg gt mh"><div class="bz fp l di"><div class="nm nn l"/></div></figure><figure class="md me mf mg gt mh gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi ob"><img src="../Images/c7bbf06c3993f155409d68e01c10ee59.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-_u8TvcSSd4eBBTHbG8T4w.png"/></div></div><figcaption class="np nq gj gh gi nr ns bd b be z dk">Observe that large number of data points have reduced and the graph looks smoother as a result of daily resampling.</figcaption></figure><figure class="md me mf mg gt mh"><div class="bz fp l di"><div class="nm nn l"/></div></figure><figure class="md me mf mg gt mh gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi oc"><img src="../Images/85ab58547a027731414d467a2b378c64.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vz6kbkiZbzDY833wu5-7Ng.png"/></div></div><figcaption class="np nq gj gh gi nr ns bd b be z dk">Observe the values on the y-axis as a result of log transformation</figcaption></figure><h2 id="8c4a" class="na kj it bd kk nb nc dn ko nd ne dp ks lj nf ng ku ln nh ni kw lr nj nk ky nl bi translated">时间序列基本</h2><p id="50d5" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated"><strong class="lc iu">单变量与多变量时间序列<br/></strong><em class="lw"/>单变量时间序列数据只包含一个变量。单变量分析是最简单的数据分析形式，其中被分析的数据只包含一个变量。因为它是一个单一的变量，它不处理原因或关系。这种单变量时间序列的一个例子可以是请求速率度量。<br/>当时间序列由两个变量组成时，称为<em class="lw">二元时间序列</em>。对这类数据的分析涉及原因和关系，分析的目的是找出两个变量之间的关系。例如，web 服务的 CPU 使用率百分比取决于请求率。为了更好地理解数据，这些变量通常绘制在图表的 X 轴和 Y 轴上，其中一个变量是独立的，而另一个是相关的。<br/> <em class="lw">多元时间序列</em>由三个或更多的变量组成。多变量时间序列的例子可以是依赖于多个变量的股票价格。</p><p id="4d9a" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated"><strong class="lc iu">时间序列的组成部分<br/> </strong>为了想出一个适合预测时间序列的模型，了解时间序列数据的组成部分是很重要的。时间序列数据主要由以下部分组成:</p><ul class=""><li id="6a7b" class="od oe it lc b ld lx lg ly lj of ln og lr oh lv oi oj ok ol bi translated"><strong class="lc iu"> <em class="lw">趋势<br/> </em> </strong>趋势显示数据在一段较长时间内增加或减少的总体趋势。趋势是一个平滑的、一般的、长期的、平均的趋势。在给定的时间内，增加或减少并不总是必须在同一方向。对 web 服务的请求率可能会在一段较长的时间内显示出某种类型的移动趋势。</li><li id="ad92" class="od oe it lc b ld om lg on lj oo ln op lr oq lv oi oj ok ol bi translated"><strong class="lc iu"> <em class="lw">季节性<br/> </em> </strong>这些是由于季节性因素而在数据中出现的短期变动。短期通常被认为是时间序列发生变化的时期。电子商务网络服务在某些月份可能会收到更多的流量。</li><li id="5cfb" class="od oe it lc b ld om lg on lj oo ln op lr oq lv oi oj ok ol bi translated"><strong class="lc iu"> <em class="lw">周期<br/> </em> </strong>这些是时间序列中发生的长期振荡。</li><li id="f7c5" class="od oe it lc b ld om lg on lj oo ln op lr oq lv oi oj ok ol bi translated"><strong class="lc iu"> <em class="lw">错误<br/> </em> </strong>这些是时间序列中的随机或不规则运动。这些是在时间序列中发生的突然变化，不太可能重复。</li></ul><blockquote class="nv nw nx"><p id="3b0a" class="la lb lw lc b ld lx ju lf lg ly jx li ny lz ll lm nz ma lp lq oa mb lt lu lv im bi translated"><strong class="lc iu"> <em class="it">加法与乘法模型</em> </strong></p><p id="8ee9" class="la lb lw lc b ld lx ju lf lg ly jx li ny lz ll lm nz ma lp lq oa mb lt lu lv im bi translated"><em class="it">简单分解模型可以是:<br/> </em>加法模型:Y[t] = T[t] + S[t] + e[t] <br/>乘法模型:Y[t] = T[t] * S[t] * e[t]</p><p id="768b" class="la lb lw lc b ld lx ju lf lg ly jx li ny lz ll lm nz ma lp lq oa mb lt lu lv im bi translated"><em class="it">其中，Y[t]为‘T’时刻的预测值，T[t]，S[t]和 e[t]分别为‘T’时刻的趋势分量、季节分量和误差。</em></p></blockquote><figure class="md me mf mg gt mh"><div class="bz fp l di"><div class="nm nn l"/></div></figure><figure class="md me mf mg gt mh gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi or"><img src="../Images/60beb8b3244c0b1cb7a81fa504fa656b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*B7wrfi4NYeZKPdulVwizxg.png"/></div></div><figcaption class="np nq gj gh gi nr ns bd b be z dk">Additive Decomposition Model for time series</figcaption></figure><figure class="md me mf mg gt mh"><div class="bz fp l di"><div class="nm nn l"/></div></figure><figure class="md me mf mg gt mh gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi os"><img src="../Images/32690be0d964f57f75113ba43f148dc6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wUtRvyH1ILWOR0tD9fjtyA.png"/></div></div><figcaption class="np nq gj gh gi nr ns bd b be z dk">Multiplicative Decomposition Model for time series</figcaption></figure><h2 id="c817" class="na kj it bd kk nb nc dn ko nd ne dp ks lj nf ng ku ln nh ni kw lr nj nk ky nl bi translated">平稳序列</h2><p id="add1" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">如果时间序列在一段时间内具有恒定的统计特性，即。以下内容:</p><ul class=""><li id="f992" class="od oe it lc b ld lx lg ly lj of ln og lr oh lv oi oj ok ol bi translated">常数平均值</li><li id="ca86" class="od oe it lc b ld om lg on lj oo ln op lr oq lv oi oj ok ol bi translated">恒定方差</li><li id="f760" class="od oe it lc b ld om lg on lj oo ln op lr oq lv oi oj ok ol bi translated">不依赖于时间的自协方差。</li></ul><p id="16c2" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">大多数时间序列模型要求时间序列是平稳的。</p><h2 id="48e2" class="na kj it bd kk nb nc dn ko nd ne dp ks lj nf ng ku ln nh ni kw lr nj nk ky nl bi translated">如何检查时间序列的平稳性？</h2><p id="30e4" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">以下是检查时间序列平稳性的一些方法:</p><ul class=""><li id="bf15" class="od oe it lc b ld lx lg ly lj of ln og lr oh lv oi oj ok ol bi translated"><strong class="lc iu">滚动统计<br/> </strong>我们可以<strong class="lc iu"> <em class="lw">绘制移动平均值或移动方差</em> </strong>来检查随时间的变化。例如，7 天内每分钟请求的滚动平均值图表。这是一种视觉技术。</li><li id="d190" class="od oe it lc b ld om lg on lj oo ln op lr oq lv oi oj ok ol bi translated"><strong class="lc iu"> Dickey-Fuller 检验<br/> </strong>这是用于检查平稳性的<strong class="lc iu"> <em class="lw">统计检验</em> </strong>之一。它是<strong class="lc iu"> <em class="lw">单元根测试</em> </strong>的一种类型。测试结果由测试统计数据和不同置信水平的一些临界值组成。如果“检验统计量”小于“临界值”，我们可以拒绝零假设，说序列是平稳的。这里的零假设是时间序列是非平稳的。</li></ul><figure class="md me mf mg gt mh"><div class="bz fp l di"><div class="nm nn l"/></div></figure><figure class="md me mf mg gt mh gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi ot"><img src="../Images/e20e5488e804326776e429e6c0baddb4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3ul4hKjbMdvYGF1Nm-Mg6w.png"/></div></div><figcaption class="np nq gj gh gi nr ns bd b be z dk">Rolling Stats Plot and AD Fuller Test results for original time series</figcaption></figure><h2 id="20a8" class="na kj it bd kk nb nc dn ko nd ne dp ks lj nf ng ku ln nh ni kw lr nj nk ky nl bi translated">如何让一个时间序列平稳？</h2><p id="2d11" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">有多种方法可以使时间序列平稳。其中有<strong class="lc iu"> <em class="lw">求差、去趋势、变换</em> </strong>等。</p><figure class="md me mf mg gt mh"><div class="bz fp l di"><div class="nm nn l"/></div></figure><figure class="md me mf mg gt mh gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi ou"><img src="../Images/d6461579ef24b4574365fabf11f981a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Q0C7ok7Pi-D_0hi3GzmGPQ.png"/></div></div><figcaption class="np nq gj gh gi nr ns bd b be z dk">Rolling Stats Plot and AD Fuller Test results for log transformed and differenced time series.</figcaption></figure></div><div class="ab cl mo mp hx mq" role="separator"><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt"/></div><div class="im in io ip iq"><h1 id="a334" class="ki kj it bd kk kl mv kn ko kp mw kr ks jz mx ka ku kc my kd kw kf mz kg ky kz bi translated">模型拟合和评估</h1><p id="5148" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">我大致讲两种预测模型，<strong class="lc iu"> <em class="lw">数学模型和人工神经网络</em> </strong>。</p><figure class="md me mf mg gt mh gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi ov"><img src="../Images/ee31d87e80343454e3a94377eb6c3662.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fj01Ps8OkeRm9ODDK8HBhw.png"/></div></div><figcaption class="np nq gj gh gi nr ns bd b be z dk">Predictive Models</figcaption></figure><h2 id="5102" class="na kj it bd kk nb nc dn ko nd ne dp ks lj nf ng ku ln nh ni kw lr nj nk ky nl bi translated">数学模型</h2><p id="3b99" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">下面提到一些经典的时间序列预测模型。我将为我们的场景举例说明<strong class="lc iu"> SARIMA </strong>模型。</p><p id="b50a" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">AR、MA、ARMA、ARIMA 等模型都是萨里玛模型的特例。VAR、VARMA、VARMAX 类似于前面提到的模型，它们在向量数据而不是单变量时间序列的情况下很有用。</p><p id="9c1d" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">在某些情况下，Holt-Winter 模型可用于预测带有季节性成分的时间序列。</p><p id="7b20" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated"><strong class="lc iu">萨里玛型号</strong></p><p id="1ae0" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">当时间序列中存在趋势和季节性时，非常流行的方法是使用 S <strong class="lc iu">季节自回归综合移动平均(SARIMA) </strong>模型，它是 ARMA 模型的推广。</p><p id="4633" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">萨里玛模型由<strong class="lc iu">萨里玛(P，D，q) (P，D，Q) [S] </strong>表示，其中</p><ul class=""><li id="09b7" class="od oe it lc b ld lx lg ly lj of ln og lr oh lv oi oj ok ol bi translated"><strong class="lc iu"> p，q </strong>指 ARMA 模型的自回归和移动平均项</li><li id="cf54" class="od oe it lc b ld om lg on lj oo ln op lr oq lv oi oj ok ol bi translated"><strong class="lc iu"> d </strong>是差异度(数据减去过去值的次数)</li><li id="05ab" class="od oe it lc b ld om lg on lj oo ln op lr oq lv oi oj ok ol bi translated"><strong class="lc iu"> P、D 和 Q </strong>指的是 ARIMA 模型季节部分的自回归、差分和移动平均项。</li><li id="d5c2" class="od oe it lc b ld om lg on lj oo ln op lr oq lv oi oj ok ol bi translated"><strong class="lc iu"> S </strong>指每个季节的周期数</li></ul><blockquote class="nv nw nx"><p id="1897" class="la lb lw lc b ld lx ju lf lg ly jx li ny lz ll lm nz ma lp lq oa mb lt lu lv im bi translated"><strong class="lc iu">模型参数估计</strong></p><p id="691b" class="la lb lw lc b ld lx ju lf lg ly jx li ny lz ll lm nz ma lp lq oa mb lt lu lv im bi translated">*对于萨里玛<strong class="lc iu"> (p，D，q) (P，D，Q)【S】</strong>模型，我们需要<strong class="lc iu">估计 7 个参数</strong>。</p><p id="7867" class="la lb lw lc b ld lx ju lf lg ly jx li ny lz ll lm nz ma lp lq oa mb lt lu lv im bi translated">*从季节分解中我们看到，时间序列数据具有季节性。因此，<strong class="lc iu"> S = 365 </strong>，表示季节变化有 365 天的滞后。</p><p id="a492" class="la lb lw lc b ld lx ju lf lg ly jx li ny lz ll lm nz ma lp lq oa mb lt lu lv im bi translated">*对于<strong class="lc iu"> p，Q，P &amp; Q </strong>参数，我们可以<strong class="lc iu">绘制 ACF(自相关函数)&amp; PACF(部分自相关函数)</strong>并且对于参数<strong class="lc iu"> d &amp; D </strong>我们可以尝试在时间序列中具有<strong class="lc iu">差异的相同绘图。</strong></p></blockquote><figure class="md me mf mg gt mh gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi ow"><img src="../Images/7cae6d31436ad038452fe70a15d3f545.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hBPg85IoF_uvnUsWO4AkGg.png"/></div></div><figcaption class="np nq gj gh gi nr ns bd b be z dk">ACF Plot suggests a possibility of P = 0 and D = 0</figcaption></figure><figure class="md me mf mg gt mh gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi ox"><img src="../Images/e3b7dd7b9a77ecc22787a684e3c8ad9b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*o49130NDhHBSywieu17rNw.png"/></div></div><figcaption class="np nq gj gh gi nr ns bd b be z dk">ACF Plot suggests a possibility of p ~ 43 and d = 0</figcaption></figure><figure class="md me mf mg gt mh gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi oy"><img src="../Images/011be70b536c8cfb402bc8ce4622325a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JLbaBh9LPv_e4CSfnsDbgQ.png"/></div></div><figcaption class="np nq gj gh gi nr ns bd b be z dk">PACF Plot suggests a possibility of Q = 0 and D = 0</figcaption></figure><figure class="md me mf mg gt mh gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi oz"><img src="../Images/f57ab0e65ccfaabff2058ac8265b4676.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jK0ZVUe0AVYFK8CWlkCQPQ.png"/></div></div><figcaption class="np nq gj gh gi nr ns bd b be z dk">PACF Plot suggests a possibility of q ~ 7 and d = 0</figcaption></figure><blockquote class="nv nw nx"><p id="0de5" class="la lb lw lc b ld lx ju lf lg ly jx li ny lz ll lm nz ma lp lq oa mb lt lu lv im bi translated">*估计参数的另一种方法是通过尝试多组值来找到一个模型，对于该模型，<strong class="lc iu"> AIC </strong> ( <strong class="lc iu"> Akaike 信息准则</strong>)值相对较小。</p><p id="dfa4" class="la lb lw lc b ld lx ju lf lg ly jx li ny lz ll lm nz ma lp lq oa mb lt lu lv im bi translated">*模型的估计参数是:<strong class="lc iu"> SARIMA (2，1，4) (0，1，0)【365】</strong></p><p id="40de" class="la lb lw lc b ld lx ju lf lg ly jx li ny lz ll lm nz ma lp lq oa mb lt lu lv im bi translated"><strong class="lc iu">训练和测试数据集拆分</strong></p><p id="f6c7" class="la lb lw lc b ld lx ju lf lg ly jx li ny lz ll lm nz ma lp lq oa mb lt lu lv im bi translated">就像其他机器学习模型一样，为了评估模型的准确性，我们<strong class="lc iu">将数据集分为训练和测试数据集</strong>。这个比例可以从 60%到 90%不等。在我们的例子中，由于数据点的数量较少，我保持<strong class="lc iu"> 95% </strong>的比率。保持该比率为 95%的另一个原因是，为了使 SARIMA 模型准确预测，训练数据集应该具有足够的 2 个季节的数据点。</p></blockquote><figure class="md me mf mg gt mh"><div class="bz fp l di"><div class="nm nn l"/></div><figcaption class="np nq gj gh gi nr ns bd b be z dk">Model will be trained with 2 years data and tested with 39 days data.</figcaption></figure><blockquote class="nv nw nx"><p id="2f22" class="la lb lw lc b ld lx ju lf lg ly jx li ny lz ll lm nz ma lp lq oa mb lt lu lv im bi translated"><strong class="lc iu">模型拟合</strong></p><p id="2be5" class="la lb lw lc b ld lx ju lf lg ly jx li ny lz ll lm nz ma lp lq oa mb lt lu lv im bi translated"><em class="it">被拟合的数据是</em> <strong class="lc iu"> <em class="it">日均重采样和对数变换的时间序列</em> </strong> <em class="it">。模型调用估计参数</em> <strong class="lc iu"> <em class="it"> (2，1，4) (0，1，0)【365】</em></strong><em class="it">。注意到该型号的</em> <strong class="lc iu"> <em class="it"> AIC 值为-296.90 </em> </strong> <em class="it">。</em></p></blockquote><figure class="md me mf mg gt mh"><div class="bz fp l di"><div class="nm nn l"/></div></figure><blockquote class="nv nw nx"><p id="bda2" class="la lb lw lc b ld lx ju lf lg ly jx li ny lz ll lm nz ma lp lq oa mb lt lu lv im bi translated"><strong class="lc iu">预测</strong></p><p id="ce30" class="la lb lw lc b ld lx ju lf lg ly jx li ny lz ll lm nz ma lp lq oa mb lt lu lv im bi translated">现在模型已经训练好了，我们可以进行预测了。为此，我们可以提供要预测的步数作为参数。</p></blockquote><figure class="md me mf mg gt mh"><div class="bz fp l di"><div class="nm nn l"/></div></figure><figure class="md me mf mg gt mh gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi pa"><img src="../Images/cf5debfe570fd332e17e7fd1ddc338d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NtqRoTeJM_KpgSKwIcwxrA.png"/></div></div><figcaption class="np nq gj gh gi nr ns bd b be z dk">Graph showing Training, Test and Predicted values for Average Daily and Log Transformed RPM values for the service.</figcaption></figure><p id="d46f" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated"><strong class="lc iu">注意</strong>:观察文章开头的原图 和上面提到的预测图中<strong class="lc iu"> <em class="lw"> y 轴上的数值。web 服务的 RPM 值大约为 300，而预测值大约为 5，这是因为预测值被转换了。我们需要应用<strong class="lc iu">逆变换</strong>来获得原始刻度上的值。根据我们应用的转换，您能猜出哪个逆转换是合适的吗？</em></strong></p><p id="c39b" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">基于应用的<em class="lw">对数变换</em>，我们需要对逆应用<em class="lw">指数变换。这在评估预测之前是必需的，因为我们需要知道<em class="lw">原始标度</em>上预测值的准确性。</em></p><blockquote class="nv nw nx"><p id="d746" class="la lb lw lc b ld lx ju lf lg ly jx li ny lz ll lm nz ma lp lq oa mb lt lu lv im bi translated"><strong class="lc iu">验证预测</strong></p><p id="7040" class="la lb lw lc b ld lx ju lf lg ly jx li ny lz ll lm nz ma lp lq oa mb lt lu lv im bi translated">既然我们已经将预测值逆变换回原始比例，我们就可以评估预测模型的准确性了。</p><p id="f8e0" class="la lb lw lc b ld lx ju lf lg ly jx li ny lz ll lm nz ma lp lq oa mb lt lu lv im bi translated">为此我们需要找出<strong class="lc iu">原始</strong> &amp; <strong class="lc iu">预测</strong>测试值之间的误差来计算:<br/> *均方误差(MSE) <br/> *均方根误差(RMSE) <br/> *变异系数<br/> *四分位数离散系数等</p></blockquote><p id="b993" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">由于我们的数据集只有 39 个数据点，我们将能够评估 39 天的预测。让我们评估一下<strong class="lc iu"> 39 天</strong>和<strong class="lc iu"> 20 天</strong>的模型，以比较结果。</p><p id="b0d6" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated"><strong class="lc iu"> 39 天预测</strong></p><figure class="md me mf mg gt mh gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi pb"><img src="../Images/6698a819d58bb12cecdd7fe7510a2d64.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*x45L8U5ndi0rFthbIOwZgQ.png"/></div></div><figcaption class="np nq gj gh gi nr ns bd b be z dk">Actual and Predicted RPM for 39 days</figcaption></figure><figure class="md me mf mg gt mh"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="e435" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated"><strong class="lc iu">注意</strong>:变异系数为 11.645，这意味着该模型能够以 88%的<strong class="lc iu">准确度预测未来 39 天</strong>的服务的日平均转速。</p><p id="4a6e" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated"><strong class="lc iu"> 20 天预测</strong></p><figure class="md me mf mg gt mh gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi pc"><img src="../Images/0ad124d874780080a9cee42fb20cf051.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ohBGd8pwyfmniNEG4-tElA.png"/></div></div><figcaption class="np nq gj gh gi nr ns bd b be z dk">Actual and Predicted RPM for 20 days</figcaption></figure><figure class="md me mf mg gt mh"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="2bb0" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated"><strong class="lc iu">注意</strong>:变异系数为 5.55，这意味着该模型能够以 94%的准确率<strong class="lc iu">预测未来 20 天的服务日平均转速</strong>。</p></div><div class="ab cl mo mp hx mq" role="separator"><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt"/></div><div class="im in io ip iq"><h2 id="0bf9" class="na kj it bd kk nb nc dn ko nd ne dp ks lj nf ng ku ln nh ni kw lr nj nk ky nl bi translated">神经网络</h2><p id="839b" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">基于预测的问题的神经网络模型与数学模型的工作方式不同。一个<strong class="lc iu">递归神经网络</strong> ( <strong class="lc iu"> RNN </strong>)是一类<em class="lw">人工神经网络</em>，表现出时间动态行为。</p><p id="2bc3" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated"><strong class="lc iu"> LSTM【长短期记忆】</strong>是最合适的<strong class="lc iu"> <em class="lw"> RNN </em> </strong>。为了发展 LSTM 模型，时间序列预测问题必须重新构造为监督学习问题。</p></div><div class="ab cl mo mp hx mq" role="separator"><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt"/></div><div class="im in io ip iq"><h1 id="f609" class="ki kj it bd kk kl mv kn ko kp mw kr ks jz mx ka ku kc my kd kw kf mz kg ky kz bi translated">结论</h1><ul class=""><li id="6827" class="od oe it lc b ld le lg lh lj pd ln pe lr pf lv oi oj ok ol bi translated">为了预测 web 服务的某些度量，如<strong class="lc iu"><em class="lw"/></strong>，需要非常高效的模型来预测<strong class="lc iu"> <em class="lw">实时时间序列数据</em> </strong>。</li><li id="0bb4" class="od oe it lc b ld om lg on lj oo ln op lr oq lv oi oj ok ol bi translated">每个指标都有一个合适的<strong class="lc iu"> <em class="lw">粒度的时间步长</em> </strong>与之相关联。为了预测响应时间，时间步长的合适粒度应该是秒或分钟。而对于自动缩放，预测每天的 RPM 就足够了。</li><li id="301b" class="od oe it lc b ld om lg on lj oo ln op lr oq lv oi oj ok ol bi translated">在预测涉及<strong class="lc iu"> <em class="lw">多变量时间序列</em> </strong>的复杂指标时，如<strong class="lc iu"> <em class="lw"> CPU 使用率%或磁盘交换</em> </strong>，应选择适当的模型，因为它可能不是单变量时间序列，并且多个变量肯定会影响其值。</li><li id="6375" class="od oe it lc b ld om lg on lj oo ln op lr oq lv oi oj ok ol bi translated">为预测一个指标而开发的预测模型可能不适合另一个指标。</li><li id="06d2" class="od oe it lc b ld om lg on lj oo ln op lr oq lv oi oj ok ol bi translated"><strong class="lc iu"> <em class="lw">模型</em> </strong>的精度可以通过用更大的数据集训练它和微调模型的参数来提高。</li></ul></div><div class="ab cl mo mp hx mq" role="separator"><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt"/></div><div class="im in io ip iq"><h1 id="75c7" class="ki kj it bd kk kl mv kn ko kp mw kr ks jz mx ka ku kc my kd kw kf mz kg ky kz bi translated">进一步阅读</h1><ul class=""><li id="28c5" class="od oe it lc b ld le lg lh lj pd ln pe lr pf lv oi oj ok ol bi translated">要了解更多关于本文中提到的其他时间序列预测模型，你可以阅读<a class="ae pg" href="https://en.wikipedia.org/wiki/Exponential_smoothing" rel="noopener ugc nofollow" target="_blank">温特-霍尔特</a>和<a class="ae pg" href="https://en.wikipedia.org/wiki/Long_short-term_memory" rel="noopener ugc nofollow" target="_blank"> LSTM </a>。</li><li id="1132" class="od oe it lc b ld om lg on lj oo ln op lr oq lv oi oj ok ol bi translated">要理解多变量时间序列的时间序列分析，请阅读<a class="ae pg" href="https://en.wikipedia.org/wiki/Granger_causality" rel="noopener ugc nofollow" target="_blank">格兰杰因果关系</a>测试。</li><li id="8b00" class="od oe it lc b ld om lg on lj oo ln op lr oq lv oi oj ok ol bi translated">对于 ACF 和 PACF 图，请参考<a class="ae pg" href="https://en.wikipedia.org/wiki/Autocorrelation" rel="noopener ugc nofollow" target="_blank">自相关</a>和<a class="ae pg" href="https://en.wikipedia.org/wiki/Partial_autocorrelation_function" rel="noopener ugc nofollow" target="_blank">部分自相关</a>。</li></ul></div></div>    
</body>
</html>