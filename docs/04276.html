<html>
<head>
<title>Manipulating the data with Pandas using Python.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用 Python 操作熊猫的数据。</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/manipulating-the-data-with-pandas-using-python-be6c5dfabd47?source=collection_archive---------15-----------------------#2019-07-03">https://towardsdatascience.com/manipulating-the-data-with-pandas-using-python-be6c5dfabd47?source=collection_archive---------15-----------------------#2019-07-03</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="fb99" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">让我们用 Python 来计算我的熊猫数据框架的兼职收入。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/d94d1344735f0a23aef1a3f8e9be786e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Dss7A8Z-M4x8LD9ccgw7pQ.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Credits: <a class="ae kv" href="https://geospatialtraining.com/tutorial-using-pandas-dataframes-with-the-arcgis-api-for-python/" rel="noopener ugc nofollow" target="_blank">GeoSpatial Training Services</a></figcaption></figure><p id="c8af" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在开始之前，让我给你介绍一下<a class="ae kv" href="https://pandas.pydata.org/" rel="noopener ugc nofollow" target="_blank"> Pandas </a>，Pandas 是一个 python 库，它为 Python 编程语言的数据分析工具提供了高性能、易于使用的数据结构，如系列、数据框和面板。为了使用 pandas 库和它的数据结构，你必须安装并导入它。请参见<a class="ae kv" href="https://pandas.pydata.org/" rel="noopener ugc nofollow" target="_blank">熊猫</a>库的文档以获得更多更好的理解和安装指南。</p><h1 id="a9a1" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated"><strong class="ak">计算兼职收入的步骤。</strong></h1><ol class=""><li id="55cb" class="mk ml iq ky b kz mm lc mn lf mo lj mp ln mq lr mr ms mt mu bi translated">导入所需的(熊猫)库。</li><li id="e857" class="mk ml iq ky b kz mv lc mw lf mx lj my ln mz lr mr ms mt mu bi translated">将日期、工作时间和收入等值存储在数据帧中。</li><li id="e1b2" class="mk ml iq ky b kz mv lc mw lf mx lj my ln mz lr mr ms mt mu bi translated">向现有数据帧添加更多行(更新数据帧的行)。</li><li id="390e" class="mk ml iq ky b kz mv lc mw lf mx lj my ln mz lr mr ms mt mu bi translated">计算挣的钱和工作的总时间。</li><li id="1eb4" class="mk ml iq ky b kz mv lc mw lf mx lj my ln mz lr mr ms mt mu bi translated">用日期和挣得的钱绘制条形图。</li><li id="6142" class="mk ml iq ky b kz mv lc mw lf mx lj my ln mz lr mr ms mt mu bi translated">包括搜索选项，以便搜索相应的工作日期。</li><li id="3186" class="mk ml iq ky b kz mv lc mw lf mx lj my ln mz lr mr ms mt mu bi translated">最后添加工资选项。</li></ol><p id="fd71" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">让我们开始吧！！！</strong></p><p id="907e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> 1。导入所需的(熊猫)库。</strong></p><p id="29fa" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在本教程中，我们将只使用 pandas 库来执行以下计算，pandas 库本身将为我们提供计算总和并绘制条形图的选项，您无需导入 matplotlib 来绘制图形，pandas 库将为您提供绘制条形图的选项。这将是非常重要的，以了解如何使用熊猫数据框架绘制条形图。如果你用的是 Google Colab 笔记本，你不需要安装任何熊猫图书馆，只需要导入就可以了。否则，您必须在命令提示符下说 pip install pandas 来手动安装它。别名(pd)的原因是，当我想通过别名使用任何方法时，我不必每次都写给熊猫，我可以改为写 pd.method name。</p><pre class="kg kh ki kj gt na nb nc nd aw ne bi"><span id="5553" class="nf lt iq nb b gy ng nh l ni nj"># Importing pandas library.<br/>import pandas as pd<br/></span></pre></div><div class="ab cl nk nl hu nm" role="separator"><span class="nn bw bk no np nq"/><span class="nn bw bk no np nq"/><span class="nn bw bk no np"/></div><div class="ij ik il im in"><p id="c59a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> 2。将日期、工作时间和收入等值存储在数据帧中。</strong></p><pre class="kg kh ki kj gt na nb nc nd aw ne bi"><span id="f972" class="nf lt iq nb b gy ng nh l ni nj"># Creating a data frame df.<br/>df = pd.DataFrame({'Date':['11/05/19', '12/05/19', '19/05/19', '25/05/19', '26/05/19', '1/06/19'],'Time Worked': [3, 3, 4, 3, 3, 4],'Money Earned': [33.94, 33.94, 46, 33.94, 33.94, 46]})</span><span id="9358" class="nf lt iq nb b gy nr nh l ni nj"># Head displays only the top 5 rows from the data frame.<br/>df.head()</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ns"><img src="../Images/a7421be664b00086cec36d3ba6394901.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*c9QZduVEcwyANhjVeeLikQ.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Storing the values in a data frame.</figcaption></figure><p id="19e6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这一步中，我将所有数据分类为数据、工作时间和收入三列。日期栏以日/月/年格式显示工作的日期，它将以字符串形式存储，工作时间以整数形式显示一天内完成的工作总量(小时),收入以整数形式显示一天内收入的总额(加元)。在这里工作一小时，最低工资是 11.51 加元。所有这些只是原始数据，这些数据后来被存储在 pandas DataFrame 中，并被分配给一个变量 df。为此，只需使用“pd。DataFrame”并传入所有数据，通过这样做，熊猫会自动将原始数据转换成 DataFrame。我使用 head()是因为数据框包含 10 行数据，所以如果我打印它们，它们可能会看起来很大并覆盖大部分页面，因此 head()显示数据框中的前 5 行数据。</p></div><div class="ab cl nk nl hu nm" role="separator"><span class="nn bw bk no np nq"/><span class="nn bw bk no np nq"/><span class="nn bw bk no np"/></div><div class="ij ik il im in"><p id="ceed" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> 3。向现有数据帧添加更多行(更新数据帧的行)</strong></p><p id="6583" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这一步中，我们将学习如何向现有数据框追加或添加更多行，这是一个重要的步骤，因为很多时候您必须通过添加更多行来更新您的数据框，在本例中，我首先创建了一个名为 df2 的新数据框，然后通过将 df2 作为参数传递来调用 append()。您必须像 df.append(df2) (existing)那样将新数据帧附加到现有数据帧。append(新数据帧))，现在在 append 函数中，我们有一些其他参数，如 ignore_index = True，这可以防止数据帧追加新的索引，因此在此示例中，所有索引都是连续的(递增)，下一个参数是 sort = False。这是因为我们不想根据索引对数据进行排序，否则我们的数据将完全是一个混合体，您可以通过分别将这些参数的值更改为 False 和 True 来处理这些参数，并注意它们之间的差异。最后，将新的附加数据帧存储到新的变量 df 中。</p><pre class="kg kh ki kj gt na nb nc nd aw ne bi"><span id="b1ce" class="nf lt iq nb b gy ng nh l ni nj"># Adding more rows<br/>df2 = pd.DataFrame({‘Date’: [‘10/06/19’, ‘12/06/19’, ‘14/06/19’],<br/>                    ‘Time Worked’: [3, 4, 3],<br/>                    ‘Money Earned’: [33.94, 46, 33.94]})<br/>df2</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nt"><img src="../Images/c8fa83fa45ae2d32b6682fa740b18e9c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FPCwlAR9IZ7ujNzSUZR7ZQ.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Storing the values in a new data frame df2</figcaption></figure><pre class="kg kh ki kj gt na nb nc nd aw ne bi"><span id="d967" class="nf lt iq nb b gy ng nh l ni nj"># Appending the rows of the old data frame to the new data frame.</span><span id="41ce" class="nf lt iq nb b gy nr nh l ni nj">df = df.append(df2, ignore_index=True, sort = False)<br/>df.head()</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nu"><img src="../Images/33de0d7012b9cc8aa746191bd0a68e30.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PHC63WgIOYsKs4geRyMg3A.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Appending the rows of the old data frame to the new data frame.</figcaption></figure></div><div class="ab cl nk nl hu nm" role="separator"><span class="nn bw bk no np nq"/><span class="nn bw bk no np nq"/><span class="nn bw bk no np"/></div><div class="ij ik il im in"><p id="7659" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> 4。计算挣得的钱和总工作时间的总和</strong></p><p id="b7b1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这一步非常简单，因为我们只需获得“挣得的钱”和“工作的时间”两列的总和。要做到这一点，您只需使用 sum()即可，它将返回这两列中所有数据的总和。我只是对 Total_earnings 使用 round()来获得精确的值。确保在 df 中传递正确的列名，因为如果列名不匹配，就会给你带来麻烦。最后，我以可读性更好的方式打印结果。</p><pre class="kg kh ki kj gt na nb nc nd aw ne bi"><span id="801e" class="nf lt iq nb b gy ng nh l ni nj">Total_earnings = df[‘Money Earned’].sum()<br/>Total_time = df[‘Time Worked’].sum()</span><span id="6bdf" class="nf lt iq nb b gy nr nh l ni nj">print(“You have earned total of ====&gt;” ,round(Total_earnings),“CAD”)<br/>print(“ — — — — — — — — — — — — — — — — — — — — — — — — — — — ”)<br/>print(“You have worked for a total of ====&gt;”, Total_time, “hours”)</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nv"><img src="../Images/99be315bd258a95781ad2a68ff239612.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FW-j6AfowaIq5nUb7ig_yQ.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Printing the result of total earnings and total time worked.</figcaption></figure></div><div class="ab cl nk nl hu nm" role="separator"><span class="nn bw bk no np nq"/><span class="nn bw bk no np nq"/><span class="nn bw bk no np"/></div><div class="ij ik il im in"><p id="0402" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> 5。绘制总持续时间与收入的条形图</strong></p><p id="9da8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">正如我前面提到的，要绘制一个图形，您不必导入 matplot 库，pandas 有一个 plot()，它将在一定程度上帮助您绘制一个图形。我已经使用了 plot()并将“日期”和“赚的钱”作为 x 和 y 值传递(因为你需要 x 和 y 值来绘制一个图形；)我想要一个条形图，所以我用了条形图，你也可以使用线，分散到关键字种类。然后我们得到一个漂亮的条形图，其中所有的值都是根据我们的期望绘制的。</p><pre class="kg kh ki kj gt na nb nc nd aw ne bi"><span id="53f9" class="nf lt iq nb b gy ng nh l ni nj"># Plotting a bar graph using pandas library.<br/>df.plot(x =’Date’, y=’Money Earned’, kind = ‘bar’)</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nw"><img src="../Images/f8277879a8a1c697f7ec784418e23e78.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YPRNtxEQZaXGrZAyW_3E7A.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Plotting the graph of Date vs Money Earned.</figcaption></figure><p id="82ef" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">上面显示的不是绘制图表的最佳方式，但是我已经向你们展示了熊猫库可以帮助你们绘制图表，有时使用这种方法很方便，因为数据和计算较少，你所要做的就是用 x 和 y 值绘制图表。</p></div><div class="ab cl nk nl hu nm" role="separator"><span class="nn bw bk no np nq"/><span class="nn bw bk no np nq"/><span class="nn bw bk no np"/></div><div class="ij ik il im in"><p id="9e13" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> 6。包括搜索选项，以便搜索相应的工作日期。</strong></p><p id="235c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这是一个额外的步骤，只是为了给它一种感觉，就像我加入了一些功能的数据库，比如搜索选项。在实时项目中，这是一个方便的功能，你经常需要搜索数据，但你不能手动搜索，所以在下面代码片段的帮助下，你就可以完成任务了。在这个例子中，我使用 str.contains()进行搜索操作，并将数据作为参数传递，现在数据是一个变量，包含用户输入的要搜索的数据。输入日期时，str.contains()会搜索输入的日期，然后显示日期和数据框中的相应值。这将有助于当你想搜索一个特定的数据，并获得时间和金钱，你可以只输入日期，并得到结果快，而不是手动寻找所需的日期。</p><pre class="kg kh ki kj gt na nb nc nd aw ne bi"><span id="f8b4" class="nf lt iq nb b gy ng nh l ni nj"># Including a search option.<br/>date = input(“Enter the date you want to search ===&gt; “)<br/>df[df[‘Date’].str.contains(date)]</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nx"><img src="../Images/46f1b0f7c456790c3299b424a0211989.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JLdCUUB0AKrXqW1EGuyumA.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">The result of the search option.</figcaption></figure></div><div class="ab cl nk nl hu nm" role="separator"><span class="nn bw bk no np nq"/><span class="nn bw bk no np nq"/><span class="nn bw bk no np"/></div><div class="ij ik il im in"><p id="c11f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> 7。最后添加工资选项</strong></p><p id="faf6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这更像是一个可选(奖金)步骤，因为这将为输入的数据生成工资，这不是一个行业级工资生成器，而是一个简单的工资生成器，具有不同的功能和打印报表。逻辑非常简单，我所做的就是将姓名、小时数和费率作为用户输入，然后将费率和小时数相乘，并将它们存储在 total_money 中，并将其封装在一个函数中。</p><pre class="kg kh ki kj gt na nb nc nd aw ne bi"><span id="b1e1" class="nf lt iq nb b gy ng nh l ni nj"># Function payroll contains calculation of total money.<br/>def payroll():<br/> name = input(“Enter the name of the employee: ==&gt; “)<br/> hours = int(input(“Enter the hours worked by the employee ==&gt;“))<br/> rate = float(input(“Enter the pay rate for one hour ==&gt; “))</span><span id="6832" class="nf lt iq nb b gy nr nh l ni nj"> total_money = hours * rate </span><span id="87c0" class="nf lt iq nb b gy nr nh l ni nj"> print(“The total money earned by “, name, “for working “, hours,  “hours”, “is ===&gt; “, round(total_money), “CAD”)</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ny"><img src="../Images/1e2881b8308eeee83de1db72568a8cd0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tPOGn4pbwqkYzYFnq_NbWw.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">The result of the payroll function.</figcaption></figure><p id="7b9f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">因此，这就是如何使用 pandas 数据框和 python 计算兼职收入的方法。我知道这很容易理解，因为我已经尽可能多地解释了代码，剩下的你可以自己练习。如果你对熊猫图书馆知之甚少，这是一个好的开始，这些是你应该唾手可得的一些基本方法。我就讲到这里，让你们练习代码。如果你有任何疑问，请在评论区告诉我，或者给 tanunprabhu95@gmail.com<a class="ae kv" href="mailto:tanunprabhu95@gmail.com" rel="noopener ugc nofollow" target="_blank">发邮件</a>让我知道你的问题，我一定会解决你的问题。祝你过得愉快！！！！</p></div></div>    
</body>
</html>