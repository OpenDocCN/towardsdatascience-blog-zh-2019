<html>
<head>
<title>Using R to analyze movies shot in San Francisco</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用 R 分析在旧金山拍摄的电影</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/https-medium-com-tanmayee92-was-your-favorite-movie-shot-in-san-francisco-f872e482a5d9?source=collection_archive---------35-----------------------#2019-03-25">https://towardsdatascience.com/https-medium-com-tanmayee92-was-your-favorite-movie-shot-in-san-francisco-f872e482a5d9?source=collection_archive---------35-----------------------#2019-03-25</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="ip iq gp gr ir is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/db83b25c82d58f64c52d6caabfecff69.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vo_xfbfHVK90hj3r1-ipQA.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">The Golden Gate Bridge stands tall with the city of San Francisco on the horizon</figcaption></figure><div class=""/><p id="59b3" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">旧金山是一个纯粹的魔法城市，几个月前我在这座黄金城市度过了一段美好的时光。因此，当我偶然发现一组非常有趣的电影和连续剧的数据，这些电影和连续剧是在旧金山的几个地方拍摄的，我无法阻止自己去挖掘它们。瞧，我发现了 4 个有趣的见解！</p><ol class=""><li id="c967" class="la lb jf ke b kf kg kj kk kn lc kr ld kv le kz lf lg lh li bi translated">2015 年仅一年就有 23 部在旧金山拍摄的电影上映！</li><li id="5559" class="la lb jf ke b kf lj kj lk kn ll kr lm kv ln kz lf lg lh li bi translated">金门大桥是这座城市中最热门的电影拍摄地(毫无疑问！)</li><li id="f6e9" class="la lb jf ke b kf lj kj lk kn ll kr lm kv ln kz lf lg lh li bi translated">导演安德鲁·海格在《海湾城市》中拍摄了多达 11 部电影！</li><li id="2760" class="la lb jf ke b kf lj kj lk kn ll kr lm kv ln kz lf lg lh li bi translated">华纳兄弟影业(娱乐巨头之一)和 Hulu(流媒体服务公司之一)在旧金山拍摄的电影/连续剧数量最多。</li></ol><p id="7508" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">在这篇文章中，我将展示我是如何通过 6 个步骤分析这些数据的。所以，打开你的 R 工作室，跟着做吧！</p><p id="eb08" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">步骤 1:导入库</p><pre class="lo lp lq lr gt ls lt lu lv aw lw bi"><span id="08be" class="lx ly jf lt b gy lz ma l mb mc">library(dplyr)<br/>library(readxl)<br/>library(writexl) <br/>library(tidyquant)<br/>library(tidyverse)<br/>library(forcats)<br/>library(magrittr)</span></pre><p id="28bf" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">步骤 2:加载数据</p><p id="83f7" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">这项练习的数据可以在这个<a class="ae md" href="https://data.sfgov.org/Culture-and-Recreation/Film-Locations-in-San-Francisco/yitu-d5am" rel="noopener ugc nofollow" target="_blank"> url </a>上找到。确保以 csv 格式将数据下载到您的本地驱动器中。</p><pre class="lo lp lq lr gt ls lt lu lv aw lw bi"><span id="5eb2" class="lx ly jf lt b gy lz ma l mb mc">film &lt;- read.csv('Film_Locations_in_San_Francisco.csv')</span></pre><p id="c2b4" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">现在，让我们仔细观察这些数据，了解其维度。</p><pre class="lo lp lq lr gt ls lt lu lv aw lw bi"><span id="41cb" class="lx ly jf lt b gy lz ma l mb mc">dim(film)</span></pre><figure class="lo lp lq lr gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi me"><img src="../Images/0f7cc8d33737dcd644b2ea78ec00663b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*stNvnrJ1cGKE_h84Ad6v_w.png"/></div></div></figure><p id="5d12" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">我们有 1622 行和 11 列。由于列的数量很大，这是一个很宽的数据集，因此，我们将使用 glimpse()函数一次性查看所有的列。</p><pre class="lo lp lq lr gt ls lt lu lv aw lw bi"><span id="ef21" class="lx ly jf lt b gy lz ma l mb mc">glimpse(film)</span></pre><figure class="lo lp lq lr gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mf"><img src="../Images/0fadc261d52b2a37a3472154887b9000.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mjxEumWCoz_Z67R-yW4FPQ.png"/></div></div></figure><p id="2670" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">我们在数据中看到了 NAs，但我们将保持原样。</p><p id="8df8" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">第三步:争论数据</p><p id="6852" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">我想通过替换“.”来使列名更加标准在带有“_”的名称中。此外，我决定重新排列几列，将“标题”、“发行年份”、“地点”、“导演”和“编剧”放在列表的顶部。</p><pre class="lo lp lq lr gt ls lt lu lv aw lw bi"><span id="e30c" class="lx ly jf lt b gy lz ma l mb mc">#Replacing "." in the column names with "_"</span><span id="f02e" class="lx ly jf lt b gy mg ma l mb mc">film_wrangled &lt;- film %&gt;%<br/>  set_names(names(.)%&gt;% str_replace_all("\\.", "_")) %&gt;%</span><span id="03e5" class="lx ly jf lt b gy mg ma l mb mc">#Re-ordering the columns</span><span id="b735" class="lx ly jf lt b gy mg ma l mb mc">  select(Title, Release_Year, Locations, Director, Writer,   everything()) %&gt;%<br/>  glimpse()</span></pre><figure class="lo lp lq lr gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mh"><img src="../Images/86d98a52c2069644ff7ac52c4bd01368.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*J2xFshl8qrz4sCc42ElJsg.png"/></div></div></figure><p id="4c68" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">我们看到所期望的改变已经实现。</p><p id="1622" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">步骤 4:数据操作</p><p id="4809" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">为了深入分析，我决定只关注几列，即“发行年份”、“标题”、“地点”、“导演”和“经销商”。</p><pre class="lo lp lq lr gt ls lt lu lv aw lw bi"><span id="0e49" class="lx ly jf lt b gy lz ma l mb mc">film_tbl &lt;- film_wrangled %&gt;%<br/>   #Choosing the columns to focus on<br/>   select(Release_Year, Title, Locations, Director, Distributor) %&gt;%<br/>   glimpse()</span></pre><p id="3308" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">因此，TiB ble“film _ TBL”是我们在这一点之后进行任何分析的首选数据集。</p><h1 id="7d61" class="mi ly jf bd mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne bi translated"><strong class="ak">问题 1:哪一年在三藩市拍摄的电影数量最多</strong></h1><pre class="lo lp lq lr gt ls lt lu lv aw lw bi"><span id="5c16" class="lx ly jf lt b gy lz ma l mb mc">popular_by_year &lt;- film_tbl %&gt;%<br/>                    group_by(Release_Year) %&gt;%<br/>                    summarize(Number_of_movies = n_distinct(Title)) %&gt;%<br/>                    filter(Number_of_movies &gt; 5) %&gt;%<br/>                    arrange(desc(Number_of_movies))</span></pre><p id="738b" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">这个如果形象化就很好理解了。</p><pre class="lo lp lq lr gt ls lt lu lv aw lw bi"><span id="cd25" class="lx ly jf lt b gy lz ma l mb mc">popular_by_year %&gt;%<br/>    ggplot(aes(x = Release_Year, y = Number_of_movies)) +<br/>    <br/>    #Adding geometries<br/>    geom_col(fill = "#18BC9C") +<br/>    <br/>    #Formatting<br/>    geom_text(aes(label= Number_of_movies), vjust = 0 ) +<br/>    theme_tq() +<br/>    labs(<br/>         title = "Number of movies shot in San Francisco by release year",<br/>         subtitle = "The City was the clear favourite of movie-makers in 2015 ",<br/>         x = "Release Year",<br/>         y = "Number of Movies"<br/>    )</span></pre><figure class="lo lp lq lr gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nf"><img src="../Images/a89e929a9ea4e2d1f4d61525c5ef441b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HZOXg6o3n5xxERa2kdMKuQ.png"/></div></div></figure><p id="7e51" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">似乎 2015 年是科幻电影最多的一年，接下来是 2016 年。在这两年之前，大多数科幻电影的拍摄发生在 1996 年。</p><h1 id="93e5" class="mi ly jf bd mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne bi translated">问题 2:旧金山有哪些最著名的拍摄电影的地点？</h1><pre class="lo lp lq lr gt ls lt lu lv aw lw bi"><span id="ec42" class="lx ly jf lt b gy lz ma l mb mc">popular_locations &lt;- film_tbl %&gt;%<br/>                       group_by(Locations) %&gt;%<br/>                       summarize(Number_of_movies = n_distinct(Title)) %&gt;%<br/>                       filter(Number_of_movies &gt; 5) %&gt;%<br/>                       filter(Number_of_movies &lt; 54) %&gt;%  <br/>                       arrange(desc(Number_of_movies))</span></pre><p id="806a" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">视觉化这个…</p><pre class="lo lp lq lr gt ls lt lu lv aw lw bi"><span id="db3c" class="lx ly jf lt b gy lz ma l mb mc">popular_locations %&gt;%<br/>      ggplot(aes(x = reorder(Locations, -Number_of_movies), y = Number_of_movies )) + <br/>      <br/>      #Adding Geometries  <br/>      geom_col(fill = "#C40003" ) +<br/>      <br/>      #Formatting  <br/>      theme_tq() +<br/>      geom_text(aes(label= Number_of_movies), hjust = 0 ) +<br/>      labs (<br/>        title = "San Francisco is a top choice of the Directors",<br/>        subtitle = "Andrew Haigh directed the most number of movies shot in the City",<br/>        y = "Number of Movies"<br/>      ) +<br/>      coord_flip()</span></pre><figure class="lo lp lq lr gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ng"><img src="../Images/2ccb76528ee9a5c82179556bdb99b74a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ieQH1T4vwNCnNNdrCOKo-g.png"/></div></div></figure><p id="7ea9" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">数据告诉我们，拍摄一部电影最著名的地点是金门大桥(这里没有惊喜！).它与其他热门地点竞争激烈，如市政厅、梅森街 950 号的费尔蒙特酒店、金银岛和 Coit Tower。</p><h1 id="8eb3" class="mi ly jf bd mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne bi translated">问题 3:哪些导演在旧金山拍摄的电影数量最多？</h1><pre class="lo lp lq lr gt ls lt lu lv aw lw bi"><span id="be8d" class="lx ly jf lt b gy lz ma l mb mc">directors &lt;- film_tbl %&gt;%<br/>               group_by(Director) %&gt;%<br/>               summarize(Number_of_movies = n_distinct(Title)) %&gt;%<br/>               filter(Number_of_movies &gt; 3) %&gt;%<br/>               arrange(desc(Number_of_movies))</span></pre><p id="8fe8" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">视觉化这个…</p><pre class="lo lp lq lr gt ls lt lu lv aw lw bi"><span id="9efd" class="lx ly jf lt b gy lz ma l mb mc">directors %&gt;%<br/>    ggplot(aes(x = Director, y = Number_of_movies )) +<br/>    <br/>    #Adding Geometries  <br/>    geom_col(fill = "#0055AA" ) +<br/>    <br/>    #Formatting  <br/>    theme_tq() +<br/>    geom_text(aes(label= Number_of_movies), vjust = 0 ) +<br/>    labs (<br/>         title = "San Francisco is a top choice of the Directors",<br/>         subtitle = "Andrew Haigh directed the most number of movies shot in the City",<br/>         y = "Number of Movies"<br/>    )</span></pre><figure class="lo lp lq lr gt is gh gi paragraph-image"><div class="gh gi nh"><img src="../Images/3f343ad02ea56449c3de6ea40fa330a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1270/format:webp/1*MsxZ7QOWZFexGwy1-Ljofg.png"/></div></figure><p id="3e09" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">导演安德鲁·海格在这座海湾城市拍摄了多达 11 部电影，紧随其后的是阿尔弗雷德·希区柯克、克里斯·哥伦布、盖瑞·马歇尔和菲利普·考夫曼，他们分别在这里拍摄了 4 部电影。</p><h1 id="cbce" class="mi ly jf bd mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne bi translated">问题 4:哪些发行公司的大部分电影都是在旧金山拍摄的？</h1><pre class="lo lp lq lr gt ls lt lu lv aw lw bi"><span id="7903" class="lx ly jf lt b gy lz ma l mb mc">film_tbl %&gt;%<br/>      select(Title, Distributor) %&gt;%<br/>      group_by(Distributor) %&gt;%<br/>      summarise(Number_of_movies = n_distinct(Title)) %&gt;%<br/>      arrange(desc(Number_of_movies))</span></pre><figure class="lo lp lq lr gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ni"><img src="../Images/4da072d7d8d19f2d369c845019fd613d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Nvh2CKagYhkcKMUY89uqLA.png"/></div></div></figure><p id="f4e5" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">我们看到华纳兄弟电影公司是明显的赢家。此外，值得注意的是，流行的流媒体服务 Hulu 似乎有很多系列/电影在旧金山拍摄。</p><h1 id="8e9f" class="mi ly jf bd mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne bi translated"><strong class="ak">问题 5:在金门大桥拍摄的电影叫什么名字？</strong></h1><p id="7452" class="pw-post-body-paragraph kc kd jf ke b kf nj kh ki kj nk kl km kn nl kp kq kr nm kt ku kv nn kx ky kz ij bi translated">既然我们已经知道了大多数电影通常都会有一两个在著名的金门大桥的场景，让我们看看它们的名字。</p><pre class="lo lp lq lr gt ls lt lu lv aw lw bi"><span id="b947" class="lx ly jf lt b gy lz ma l mb mc">film_tbl %&gt;%<br/>      select(Title, Locations, Release_Year) %&gt;%<br/>      filter(grepl("Golden Gate Bridge", Locations)) %&gt;%<br/>      arrange(desc(Release_Year))</span></pre><figure class="lo lp lq lr gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi no"><img src="../Images/3c3413683927524a107c546ac94a3f6f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kqK-dh5AgFa4AuLDjSta7A.png"/></div></div></figure><p id="e015" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">我们看到近年来上映的电影，如《寻找》(2014)、《牛奶》(2008)、《桥》(2006)等，都是在这个非常著名的地方拍摄的。</p><p id="c5cb" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">太棒了，不是吗？</p><p id="1d60" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">一个小提示——在这些电影中，我发现网飞只有“牛奶”!所以如果你想欣赏金门大桥的美景，你知道现在该去哪里了！:)</p><p id="68a8" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">感谢阅读这篇文章！如果你喜欢，请给我发来掌声:)</p></div><div class="ab cl np nq hu nr" role="separator"><span class="ns bw bk nt nu nv"/><span class="ns bw bk nt nu nv"/><span class="ns bw bk nt nu"/></div><div class="ij ik il im in"><p id="c30a" class="pw-post-body-paragraph kc kd jf ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><em class="nw">源代码托管在我的</em> <a class="ae md" href="https://github.com/tanmayeewaghmare/Movie-Analysis-using-R" rel="noopener ugc nofollow" target="_blank"> <em class="nw"> GitHub 页面</em> </a></p></div></div>    
</body>
</html>