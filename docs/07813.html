<html>
<head>
<title>Colaboratory + Drive + Github -&gt; the workflow made simpler</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">协作室+驱动器+ Github -&gt;工作流程更加简单</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/colaboratory-drive-github-the-workflow-made-simpler-bde89fba8a39?source=collection_archive---------17-----------------------#2019-10-29">https://towardsdatascience.com/colaboratory-drive-github-the-workflow-made-simpler-bde89fba8a39?source=collection_archive---------17-----------------------#2019-10-29</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><h1 id="ae1a" class="jq jr it bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">介绍</h1><p id="5c4c" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">这篇文章是我们之前尝试充分利用两个世界的延续，即 T2 谷歌实验室和 T4 Github T5。简而言之，我们试图在典型的数据科学工作流程中映射这些工具的使用。虽然我们成功了，但是这个过程也有缺点:</p><ul class=""><li id="b965" class="ln lo it kq b kr lp kv lq kz lr ld ls lh lt ll lu lv lw lx bi translated">它依赖于<em class="ly">动态导入</em>，这使得我们的代码变得不必要的麻烦。</li><li id="a028" class="ln lo it kq b kr lz kv ma kz mb ld mc lh md ll lu lv lw lx bi translated">我们没有让 Github 部分正常工作。工作空间必须脱机保存。</li></ul><p id="4bc5" class="pw-post-body-paragraph ko kp it kq b kr lp kt ku kv lq kx ky kz me lb lc ld mf lf lg lh mg lj lk ll im bi translated">在本帖中，我们将向您展示一种更简单的方法来组织工作空间，而不会有这些缺陷。你需要的只是一个 Gmail 和 Github 账户。我们开始工作吧。</p><h1 id="4598" class="jq jr it bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">什么去哪里？</h1><figure class="mi mj mk ml gt mm gh gi paragraph-image"><div role="button" tabindex="0" class="mn mo di mp bf mq"><div class="gh gi mh"><img src="../Images/76f88f8d369d4738626af2e46990fcc4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*RnwPGV4oGTw-5sDe.png"/></div></div><figcaption class="mt mu gj gh gi mv mw bd b be z dk">Figure 1. Three parts of our simple “ecosystem”.</figcaption></figure><p id="d299" class="pw-post-body-paragraph ko kp it kq b kr lp kt ku kv lq kx ky kz me lb lc ld mf lf lg lh mg lj lk ll im bi translated">通常，我们的工作区中有四种基本的文件类别:</p><ul class=""><li id="b52c" class="ln lo it kq b kr lp kv lq kz lr ld ls lh lt ll lu lv lw lx bi translated">笔记本<em class="ly">(。ipynb) </em> —对于交互式开发工作，</li><li id="a44a" class="ln lo it kq b kr lz kv ma kz mb ld mc lh md ll lu lv lw lx bi translated">库<em class="ly">(。py) </em> —对于我们使用和重用的代码，</li><li id="74e3" class="ln lo it kq b kr lz kv ma kz mb ld mc lh md ll lu lv lw lx bi translated">模型——我们试图建造的东西，</li><li id="7c13" class="ln lo it kq b kr lz kv ma kz mb ld mc lh md ll lu lv lw lx bi translated">数据——我们构建数据的原料。</li></ul><p id="1e65" class="pw-post-body-paragraph ko kp it kq b kr lp kt ku kv lq kx ky kz me lb lc ld mf lf lg lh mg lj lk ll im bi translated">由于 Colab 后端不是持久的，我们需要一个永久的存储解决方案。除此之外，我们还需要一个版本控制系统，这样我们就可以跟踪变化。最后，如果我们不需要考虑这个机器，我们会很感激。</p><p id="4ac0" class="pw-post-body-paragraph ko kp it kq b kr lp kt ku kv lq kx ky kz me lb lc ld mf lf lg lh mg lj lk ll im bi translated">Colab 很容易与 Google Drive 集成，这使它成为存储空间的自然选择。我们将使用它来存储我们的<em class="ly">数据</em>和<em class="ly">模型</em>。同时，Github 更适合代码，因此我们将把它用于<em class="ly">笔记本</em>和<em class="ly">库</em>。现在，问题出现了，我们如何从笔记本的位置将两者接口，这将使我们的工作流尽可能地无痛？</p><h1 id="987d" class="jq jr it bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">开源代码库</h1><p id="01c2" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">我们假设您已经有了一个 Github 帐户，并为您的项目创建了一个存储库。除非您的存储库是<em class="ly"> public </em>，否则您将需要<em class="ly">生成一个</em> <strong class="kq iu"> <em class="ly">令牌</em> </strong>来通过命令行与之交互。这里有一个简短的<a class="ae lm" href="https://help.github.com/en/enterprise/2.15/user/articles/creating-a-personal-access-token-for-the-command-line" rel="noopener ugc nofollow" target="_blank">指南</a>告诉你如何创建一个。</p><h1 id="3a16" class="jq jr it bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">Google Drive</h1><p id="c2de" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">接下来的事情是为模型和数据组织我们的非易失性存储空间。如果你有一个 Gmail 账户，你就成功了一半。你需要做的就是在驱动器中创建一个空目录，就这样。</p><h1 id="ae3a" class="jq jr it bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">合作实验室——操作笔记本</h1><p id="e1d7" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">为了让事情井井有条，我们定义了一个单独的笔记本作为我们的<em class="ly">操作</em>工具。我们将专门使用它的单元来操纵我们的空间，让其他笔记本来处理更有趣的事情，如<em class="ly">探索性数据分析</em>、<em class="ly">特征工程</em>或<em class="ly">培训</em>。所有笔记本，包括这个，都将被修改，但是命令存储在<em class="ly">操作</em>笔记本中。</p><h1 id="41f8" class="jq jr it bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">工作流程</h1><p id="3428" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">工作流程是一个简单的<strong class="kq iu">三步流程</strong>:</p><ol class=""><li id="5443" class="ln lo it kq b kr lp kv lq kz lr ld ls lh lt ll mx lv lw lx bi translated">首先，在连接到 Colab 运行时之后，我们需要<em class="ly">挂载</em> Google Drive 并且<em class="ly">使用 Github 更新</em>我们的空间。</li><li id="d3c4" class="ln lo it kq b kr lz kv ma kz mb ld mc lh md ll mx lv lw lx bi translated">我们使用笔记本和其余的文件(我们的模块、库等)。).在这种背景下，我们干脆称之为<em class="ly">剪辑</em>。</li><li id="8ea8" class="ln lo it kq b kr lz kv ma kz mb ld mc lh md ll mx lv lw lx bi translated">我们<em class="ly">保存</em>我们的工作，通过使用<em class="ly">操作</em>笔记本将我们的驱动器与 Github 同步。</li></ol><h1 id="22db" class="jq jr it bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">连接、安装和更新</h1><pre class="mi mj mk ml gt my mz na nb aw nc bi"><span id="28db" class="nd jr it mz b gy ne nf l ng nh">from google.colab import drive<br/>from os.path import join<br/><br/>ROOT = '/content/drive'     # default for the drive<br/>PROJ = 'My Drive/...'       # path to your project on Drive<br/><br/>GIT_USERNAME = "OlegZero13" # replace with yours<br/>GIT_TOKEN = "XXX"           # definitely replace with yours<br/>GIT_REPOSITORY = "yyy"      # ...nah<br/><br/><br/>drive.mount(ROOT)           # we mount the drive at /content/drive<br/><br/>PROJECT_PATH = join(ROOT, PROJ)<br/>!mkdir "{PROJECT_PATH}"I    # in case we haven't created it already   <br/><br/>GIT_PATH = "https://{GIT_TOKEN}@github.com/{GIT_USERNAME}/{GIT_REPOSITORY}.git"<br/>!mkdir ./temp<br/>!git clone "{GIT_PATH}"<br/>!mv ./temp/* "{PROJECT_PATH}"<br/>!rm -rf ./temp<br/>!rsync -aP --exclude=data/ "{PROJECT_PATH}"/*  ./</span></pre><p id="bf48" class="pw-post-body-paragraph ko kp it kq b kr lp kt ku kv lq kx ky kz me lb lc ld mf lf lg lh mg lj lk ll im bi translated">上面的代码片段在<code class="fe ni nj nk mz b">/content/drive</code>安装 Google Drive 并创建我们项目的目录。然后，它从 Github 中取出所有文件，并将它们复制到那个目录中。最后，它收集属于驱动器目录的所有内容，并将其复制到我们的本地运行时。</p><p id="14bc" class="pw-post-body-paragraph ko kp it kq b kr lp kt ku kv lq kx ky kz me lb lc ld mf lf lg lh mg lj lk ll im bi translated">这个解决方案的一个好处是，如果多次执行，它不会崩溃。无论何时执行，它只会更新新的东西。此外，使用<code class="fe ni nj nk mz b">rsync</code>，我们可以选择<em class="ly">排除</em>一些内容，这可能需要很长时间才能复制(...数据？).</p><h1 id="3952" class="jq jr it bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">编辑、编辑和编辑</h1><p id="fd61" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">开发，尤其是在数据科学中，意味着在我们最终把事情做好之前要尝试多次。在此阶段，可以通过以下方式编辑外部文件/库:</p><ol class=""><li id="1776" class="ln lo it kq b kr lp kv lq kz lr ld ls lh lt ll mx lv lw lx bi translated">替换或更改驱动器上的文件，然后使用<code class="fe ni nj nk mz b">rsync</code>将它们传输到每个笔记本的本地运行时，或者</li><li id="b991" class="ln lo it kq b kr lz kv ma kz mb ld mc lh md ll mx lv lw lx bi translated">使用所谓的 IPython <a class="ae lm" href="https://ipython.readthedocs.io/en/stable/interactive/magics.html" rel="noopener ugc nofollow" target="_blank">魔法</a>命令。</li></ol><p id="db73" class="pw-post-body-paragraph ko kp it kq b kr lp kt ku kv lq kx ky kz me lb lc ld mf lf lg lh mg lj lk ll im bi translated">假设您想要快速更改<code class="fe ni nj nk mz b">somefile.py</code>，这是您的库文件之一。您可以为该文件编写代码，并使用<code class="fe ni nj nk mz b">%%writefile</code>命令告诉 Colab 保存它。由于文件驻留在本地，您可以简单地使用<code class="fe ni nj nk mz b">import</code>语句再次加载它的新内容。唯一的事情是记住首先执行<code class="fe ni nj nk mz b">%reload_ext somefile</code>命令，以确保 Colab 知道更新。</p><p id="f9bb" class="pw-post-body-paragraph ko kp it kq b kr lp kt ku kv lq kx ky kz me lb lc ld mf lf lg lh mg lj lk ll im bi translated">这里有一个例子:</p><figure class="mi mj mk ml gt mm gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/8eeb206d83007e209ebdd44c15171f3c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1334/format:webp/0*IlOTzOp9dYEMiTp6.png"/></div><figcaption class="mt mu gj gh gi mv mw bd b be z dk">Figure 2. Importing, editing and importing again. All done through the cells.</figcaption></figure><h1 id="9bf5" class="jq jr it bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">储蓄，收工</h1><p id="1a52" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">一旦你想备份你所有的工作，你需要做的就是把所有的文件复制到存储器里，然后推送到 Github。</p><p id="be63" class="pw-post-body-paragraph ko kp it kq b kr lp kt ku kv lq kx ky kz me lb lc ld mf lf lg lh mg lj lk ll im bi translated">可以使用笔记本单元中执行的<code class="fe ni nj nk mz b">!cp -r ./* "{PROJECT_PATH}"</code>进行复制，这将更新驱动器存储。然后，推送到 Github 需要创建一个临时工作目录和<strong class="kq iu">配置本地 git repo </strong>只是暂时的。下面是要执行的命令:</p><pre class="mi mj mk ml gt my mz na nb aw nc bi"><span id="4643" class="nd jr it mz b gy ne nf l ng nh">!mkdir ./temp<br/>!git clone "https://{GIT_TOKEN}@github.com/{GIT_USERNAME}/{GIT_REPOSITORY}.git" ./temp<br/>!rsync -aP --exclude=data/ "{PROJECT_PATH}"/* ./temp<br/><br/>%cd ./temp<br/>!git add .<br/>!git commit -m '"{GIT_COMMIT_MESSAGE}"'<br/>!git config --global user.email "{GIT_EMAIL}"<br/>!git config --global user.name "{GIT_NAME}"<br/>!git push origin "{GIT_BRANCH_NAME}"<br/>%cd /content<br/>!rm -rf ./temp</span></pre><p id="7c9c" class="pw-post-body-paragraph ko kp it kq b kr lp kt ku kv lq kx ky kz me lb lc ld mf lf lg lh mg lj lk ll im bi translated">显然，您需要自己定义<code class="fe ni nj nk mz b">"{...}"</code>中的字符串。</p><figure class="mi mj mk ml gt mm gh gi paragraph-image"><div role="button" tabindex="0" class="mn mo di mp bf mq"><div class="gh gi nm"><img src="../Images/570480ba0acb9f5a7e706088bdcf2b7f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*xs_i6KdR8LAdBilM.png"/></div></div><figcaption class="mt mu gj gh gi mv mw bd b be z dk">Figure 3. Successful upload of the content to Github. Calling it a day.</figcaption></figure><h1 id="74a9" class="jq jr it bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">结论</h1><p id="3b12" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">在这篇文章中，我们展示了如何在使用 Google Colab 时有效地将 Google Drive 和 Github <strong class="kq iu">结合起来</strong>。改进后的工作流程比之前介绍的流程简单得多。</p><p id="a189" class="pw-post-body-paragraph ko kp it kq b kr lp kt ku kv lq kx ky kz me lb lc ld mf lf lg lh mg lj lk ll im bi translated">如果你想分享任何有用的技巧或提出一些改进建议，请在评论中提出。你的反馈很有帮助。</p><h1 id="48e0" class="jq jr it bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">还会有更多…</h1><p id="f1b4" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">我计划把文章带到下一个层次，并提供简短的视频教程。</p><p id="b613" class="pw-post-body-paragraph ko kp it kq b kr lp kt ku kv lq kx ky kz me lb lc ld mf lf lg lh mg lj lk ll im bi translated">如果您想获得关于视频和未来文章的更新，<strong class="kq iu">订阅我的</strong> <a class="ae lm" href="https://landing.mailerlite.com/webforms/landing/j5y2q1" rel="noopener ugc nofollow" target="_blank"> <strong class="kq iu">简讯</strong> </a> <strong class="kq iu">。你也可以通过填写<a class="ae lm" href="https://forms.gle/bNpf9aqZJGLgaU589" rel="noopener ugc nofollow" target="_blank">表格</a>让我知道你的期望。回头见！</strong></p></div><div class="ab cl nn no hx np" role="separator"><span class="nq bw bk nr ns nt"/><span class="nq bw bk nr ns nt"/><span class="nq bw bk nr ns"/></div><div class="im in io ip iq"><p id="b3df" class="pw-post-body-paragraph ko kp it kq b kr lp kt ku kv lq kx ky kz me lb lc ld mf lf lg lh mg lj lk ll im bi translated"><em class="ly">原载于</em><a class="ae lm" href="https://zerowithdot.com/colab-github-workflow/" rel="noopener ugc nofollow" target="_blank"><em class="ly"/></a><em class="ly">。</em></p></div></div>    
</body>
</html>