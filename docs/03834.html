<html>
<head>
<title>Flask and Heroku for online Machine Learning deployment</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用于在线机器学习部署的 Flask 和 Heroku</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/flask-and-heroku-for-online-machine-learning-deployment-425beb54a274?source=collection_archive---------16-----------------------#2019-06-17">https://towardsdatascience.com/flask-and-heroku-for-online-machine-learning-deployment-425beb54a274?source=collection_archive---------16-----------------------#2019-06-17</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div class="gh gi ir"><img src="../Images/22357fccbb4bc9d0298d4a7a3c225428.png" data-original-src="https://miro.medium.com/v2/resize:fit:1276/format:webp/1*lfsNq-qhWwOo-bzqwh7Igw.jpeg"/></div><figcaption class="iy iz gj gh gi ja jb bd b be z dk">(Source = <a class="ae jc" href="https://image.slidesharecdn.com/slides-170512093121/95/deploying-machine-learning-models-to-production-8-638.jpg?cb=1507239367" rel="noopener ugc nofollow" target="_blank">https://image.slidesharecdn.com/slides-170512093121/95/deploying-machine-learning-models-to-production-8-638.jpg?cb=1507239367</a>)</figcaption></figure><div class=""/><figure class="gl gn kc kd ke iv"><div class="bz fp l di"><div class="kf kg l"/></div></figure><h1 id="af35" class="kh ki jf bd kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le bi translated">介绍</h1><p id="d0b0" class="pw-post-body-paragraph lf lg jf lh b li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">感谢 Pandas、scikit-learn 和 Matplotlib 等库，使用 Python 中的简单机器学习(ML)算法开始探索数据集和进行一些初步预测相对容易。虽然，为了使这些训练好的模型在现实世界中有用，有必要分享它们，并使它们可以在网上访问，以做好预测的准备。只有这样，机器学习才能被用来造福社会。</p><p id="76f0" class="pw-post-body-paragraph lf lg jf lh b li md lk ll lm me lo lp lq mf ls lt lu mg lw lx ly mh ma mb mc im bi translated">我最近一直在使用 yei-Cheng 教授的<a class="ae jc" href="https://www.openml.org/d/1464" rel="noopener ugc nofollow" target="_blank">输血服务中心数据集</a>，我使用随机森林分类器实现了 91.1%的预测准确率。因此，我决定把这个模型放到我的<a class="ae jc" href="https://pierpaolo28.github.io/" rel="noopener ugc nofollow" target="_blank">个人网站</a>上。为此，我使用了 Heroku 和 Python 库 Flask。</p><p id="1aec" class="pw-post-body-paragraph lf lg jf lh b li md lk ll lm me lo lp lq mf ls lt lu mg lw lx ly mh ma mb mc im bi translated">作为进一步的发展，我还决定使用 Android Studio 为我的个人网站创建一个 Android 应用程序，这样我的 ML 模型也可以在 Android 设备上运行。</p><h1 id="9d82" class="kh ki jf bd kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le bi translated">瓶</h1><figure class="mj mk ml mm gt iv gh gi paragraph-image"><div class="gh gi mi"><img src="../Images/d3adad8e67b795374d55b99307a5a37b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*0OD66Df9V6iylNEa3DgpeQ.png"/></div><figcaption class="iy iz gj gh gi ja jb bd b be z dk">(Source = <a class="ae jc" href="https://kenya-tech.com/wp-content/uploads/2019/01/flask-python.png" rel="noopener ugc nofollow" target="_blank">https://kenya-tech.com/wp-content/uploads/2019/01/flask-python.png</a>)</figcaption></figure><p id="a9e2" class="pw-post-body-paragraph lf lg jf lh b li md lk ll lm me lo lp lq mf ls lt lu mg lw lx ly mh ma mb mc im bi translated">Flask 是一个用于为 Python 创建 web 应用的 Web 框架。在开发在线 ML 模型的情况下，这可以通过使用三个 python 文件来完成:</p><ol class=""><li id="9de5" class="mn mo jf lh b li md lm me lq mp lu mq ly mr mc ms mt mu mv bi translated"><strong class="lh jg"> model.py </strong> =在这个文件中，ML 模型应该被实现和训练。然后应该使用<em class="mw"> Pickle 库</em>保存训练好的模型，以便在网络上使用时用于给出实时预测。</li><li id="f909" class="mn mo jf lh b li mx lm my lq mz lu na ly nb mc ms mt mu mv bi translated"><strong class="lh jg"> app.py </strong> =在这个文件中 Flask 用于处理我们从 request.py 获得的<em class="mw"> POST </em>请求，然后返回结果。为此，使用<em class="mw"> Pickle 库</em>检索训练好的 ML 模型。</li><li id="d2a1" class="mn mo jf lh b li mx lm my lq mz lu na ly nb mc ms mt mu mv bi translated"><strong class="lh jg"> request.py </strong> =用于向服务器请求特性并检索结果。</li></ol><p id="507c" class="pw-post-body-paragraph lf lg jf lh b li md lk ll lm me lo lp lq mf ls lt lu mg lw lx ly mh ma mb mc im bi translated"><strong class="lh jg"> app.py </strong>的一个基本例子可以是:</p><pre class="mj mk ml mm gt nc nd ne nf aw ng bi"><span id="e62f" class="nh ki jf nd b gy ni nj l nk nl">import numpy as np<br/>from flask import Flask, request, jsonify, render_template<br/>import pickle</span><span id="d0d1" class="nh ki jf nd b gy nm nj l nk nl">app = Flask(__name__)</span><span id="7e82" class="nh ki jf nd b gy nm nj l nk nl"># Code to load ML model</span><span id="baf3" class="nh ki jf nd b gy nm nj l nk nl">@app.route('/')<br/>def home():    <br/>     return render_template(<em class="mw">“filename.html”</em>)</span><span id="c03d" class="nh ki jf nd b gy nm nj l nk nl">@app.route('/ml-model', methods=['POST'])<br/>def run_model():<br/>     # Code to use the trained model to make real time predictions<br/>     return render_template(<em class="mw">“filename.html”, result</em>)</span><span id="c62d" class="nh ki jf nd b gy nm nj l nk nl">if __name__ == '__main__':<br/>     app.run()</span></pre><p id="e240" class="pw-post-body-paragraph lf lg jf lh b li md lk ll lm me lo lp lq mf ls lt lu mg lw lx ly mh ma mb mc im bi translated">如果我们想要添加一些 HTML、CSS 或任何其他类型的内容来改善模型的在线图形，可以通过在我们的<strong class="lh jg"> model.py </strong>、<strong class="lh jg"> app.py </strong>和<strong class="lh jg"> request.py </strong>文件所在的同一个工作目录中创建一个<em class="mw"> templates </em>文件夹来实现。这些文件必须包含在<em class="mw">模板</em>文件夹中，因为当调用<strong class="lh jg"> app.py </strong>中的<em class="mw">render _ template(" filename . html ")</em>时，Flask 将默认只在<em class="mw">模板</em>文件夹中查找文件。</p><p id="56d1" class="pw-post-body-paragraph lf lg jf lh b li md lk ll lm me lo lp lq mf ls lt lu mg lw lx ly mh ma mb mc im bi translated">仅使用 Flask，我们就可以使用本地服务器在本地机器上运行我们的模型。如果我们想让我们的模型在网络上可用，我们可以将我们的 Flask 应用程序部署到一个在线平台上，比如 Heroku。</p><h1 id="9688" class="kh ki jf bd kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le bi translated">赫罗库</h1><figure class="mj mk ml mm gt iv gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/65dd5e8c7bbd415361de67a9bfce2f4e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1024/format:webp/1*CIv6YAXcT8oLls28xcg7mg.png"/></div><figcaption class="iy iz gj gh gi ja jb bd b be z dk">(Source = <a class="ae jc" href="https://pbs.twimg.com/profile_images/689189555765784576/3wgIDj3j.png" rel="noopener ugc nofollow" target="_blank">https://pbs.twimg.com/profile_images/689189555765784576/3wgIDj3j.png</a>)</figcaption></figure><p id="0ae0" class="pw-post-body-paragraph lf lg jf lh b li md lk ll lm me lo lp lq mf ls lt lu mg lw lx ly mh ma mb mc im bi translated">Heroku 是一个云平台，可用于部署网站和其他服务。为了使用 Heroku，有必要在你的机器上安装:<a class="ae jc" href="https://signup.heroku.com/dc" rel="noopener ugc nofollow" target="_blank"> Heroku 账号</a>、<a class="ae jc" href="https://devcenter.heroku.com/articles/heroku-cli#download-and-install" rel="noopener ugc nofollow" target="_blank"> Heroku CLI 工具</a>和 git。</p><p id="85c5" class="pw-post-body-paragraph lf lg jf lh b li md lk ll lm me lo lp lq mf ls lt lu mg lw lx ly mh ma mb mc im bi translated">依次地，有必要:</p><ol class=""><li id="7f00" class="mn mo jf lh b li md lm me lq mp lu mq ly mr mc ms mt mu mv bi translated">在我们的 Flask 应用程序所在的目录中创建一个 git 存储库。</li><li id="dd36" class="mn mo jf lh b li mx lm my lq mz lu na ly nb mc ms mt mu mv bi translated">登录我们的 Heroku 账户。</li><li id="ad02" class="mn mo jf lh b li mx lm my lq mz lu na ly nb mc ms mt mu mv bi translated">创建一个 Heroku 项目。</li><li id="4db7" class="mn mo jf lh b li mx lm my lq mz lu na ly nb mc ms mt mu mv bi translated">创建一个 requirements.txt 和 Procfile。</li><li id="e653" class="mn mo jf lh b li mx lm my lq mz lu na ly nb mc ms mt mu mv bi translated">将目录中的所有文件添加到存储库中。</li><li id="4d23" class="mn mo jf lh b li mx lm my lq mz lu na ly nb mc ms mt mu mv bi translated">将应用程序推送到 web 上！</li></ol><p id="2928" class="pw-post-body-paragraph lf lg jf lh b li md lk ll lm me lo lp lq mf ls lt lu mg lw lx ly mh ma mb mc im bi translated">前三个步骤可以通过在命令提示符下依次运行以下命令来实现。</p><pre class="mj mk ml mm gt nc nd ne nf aw ng bi"><span id="a8d3" class="nh ki jf nd b gy ni nj l nk nl">git init<br/>heroku login<br/>heroku create</span></pre><p id="b573" class="pw-post-body-paragraph lf lg jf lh b li md lk ll lm me lo lp lq mf ls lt lu mg lw lx ly mh ma mb mc im bi translated">创建 requirements.txt 文件需要告知 Heroku 运行 Flask 应用程序需要什么库。因此，在 requirements.txt 文件中，我们为每一行写一个所使用的所有库的名称。对于这个应用程序，Procfile 只需要包含一行文本(如下所示)。Procfile 需要让 Heroku 知道我们希望执行什么类型的应用程序。</p><pre class="mj mk ml mm gt nc nd ne nf aw ng bi"><span id="9e11" class="nh ki jf nd b gy ni nj l nk nl">web: gunicorn app:app</span></pre><p id="86a5" class="pw-post-body-paragraph lf lg jf lh b li md lk ll lm me lo lp lq mf ls lt lu mg lw lx ly mh ma mb mc im bi translated">然后，可以通过在命令行中顺序运行以下命令来执行第五步和第六步。</p><pre class="mj mk ml mm gt nc nd ne nf aw ng bi"><span id="4e20" class="nh ki jf nd b gy ni nj l nk nl">git add .<br/>git commit -m "Committing all the directory files to Heroku"<br/>git push heroku master<br/>heroku open</span></pre><p id="be42" class="pw-post-body-paragraph lf lg jf lh b li md lk ll lm me lo lp lq mf ls lt lu mg lw lx ly mh ma mb mc im bi translated">使用<em class="mw"> heroku open </em>命令应该可以打开已经部署了 Flask 应用程序的网页。或者，通过在线登录我们的 Heroku 帐户，可以找到部署我们模型的链接。访问 Heroku 网站可能特别有用，尤其是在我们的 Flask 应用程序午餐期间出现任何问题的情况下。</p><h1 id="8330" class="kh ki jf bd kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le bi translated">结论</h1><p id="2894" class="pw-post-body-paragraph lf lg jf lh b li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">这是一个关于如何在线部署你的机器学习模型的简单介绍。如果你想了解更多关于如何使用 Flask 编写 Web 应用程序的信息，这里有一些有用的参考资料[1，2，3]。</p><p id="b35c" class="pw-post-body-paragraph lf lg jf lh b li md lk ll lm me lo lp lq mf ls lt lu mg lw lx ly mh ma mb mc im bi translated">我的在线机器学习模型在<a class="ae jc" href="https://pierpaolo28.github.io/Projects/flask.html" rel="noopener ugc nofollow" target="_blank">这里</a>可以找到，我用来设计它的所有代码都可以在我的<a class="ae jc" href="https://github.com/pierpaolo28/Artificial-Intelligence-Projects/tree/master/ML-Deployement" rel="noopener ugc nofollow" target="_blank"> GitHub 页面</a>上找到。</p><h1 id="f8a2" class="kh ki jf bd kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le bi translated">联系人</h1><p id="5502" class="pw-post-body-paragraph lf lg jf lh b li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">如果你想了解我最新的文章和项目<a class="ae jc" href="https://medium.com/@pierpaoloippolito28?source=post_page---------------------------" rel="noopener">，请在媒体</a>上关注我，并订阅我的<a class="ae jc" href="http://eepurl.com/gwO-Dr?source=post_page---------------------------" rel="noopener ugc nofollow" target="_blank">邮件列表</a>。以下是我的一些联系人详细信息:</p><ul class=""><li id="0a4f" class="mn mo jf lh b li md lm me lq mp lu mq ly mr mc no mt mu mv bi translated"><a class="ae jc" href="https://uk.linkedin.com/in/pier-paolo-ippolito-202917146?source=post_page---------------------------" rel="noopener ugc nofollow" target="_blank">领英</a></li><li id="b8c8" class="mn mo jf lh b li mx lm my lq mz lu na ly nb mc no mt mu mv bi translated"><a class="ae jc" href="https://pierpaolo28.github.io/blog/?source=post_page---------------------------" rel="noopener ugc nofollow" target="_blank">个人博客</a></li><li id="d2f4" class="mn mo jf lh b li mx lm my lq mz lu na ly nb mc no mt mu mv bi translated"><a class="ae jc" href="https://pierpaolo28.github.io/?source=post_page---------------------------" rel="noopener ugc nofollow" target="_blank">个人网站</a></li><li id="1325" class="mn mo jf lh b li mx lm my lq mz lu na ly nb mc no mt mu mv bi translated"><a class="ae jc" href="https://towardsdatascience.com/@pierpaoloippolito28?source=post_page---------------------------" rel="noopener" target="_blank">中型型材</a></li><li id="151b" class="mn mo jf lh b li mx lm my lq mz lu na ly nb mc no mt mu mv bi translated"><a class="ae jc" href="https://github.com/pierpaolo28?source=post_page---------------------------" rel="noopener ugc nofollow" target="_blank"> GitHub </a></li><li id="55ef" class="mn mo jf lh b li mx lm my lq mz lu na ly nb mc no mt mu mv bi translated"><a class="ae jc" href="https://www.kaggle.com/pierpaolo28?source=post_page---------------------------" rel="noopener ugc nofollow" target="_blank">卡格尔</a></li></ul><h1 id="9e5c" class="kh ki jf bd kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le bi translated">文献学</h1><p id="0625" class="pw-post-body-paragraph lf lg jf lh b li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">[1]如何使用 Flask 构建 web 应用并部署到云上。萨尔瓦多·维拉隆。访问:<a class="ae jc" href="https://www.freecodecamp.org/news/how-to-build-a-web-application-using-flask-and-deploy-it-to-the-cloud-3551c985e492/" rel="noopener ugc nofollow" target="_blank">https://www . freecodecamp . org/news/how-to-build-a-web-application-using-flask-and-deploy-it-to-the-cloud-3551 c 985 e 492/</a>。</p><p id="02a0" class="pw-post-body-paragraph lf lg jf lh b li md lk ll lm me lo lp lq mf ls lt lu mg lw lx ly mh ma mb mc im bi translated">[2]教程:将机器学习模型部署到 web。剑桥火花，亚历山大罗伯逊。访问:<a class="ae jc" href="https://blog.cambridgespark.com/deploying-a-machine-learning-model-to-the-web-725688b851c7" rel="noopener ugc nofollow" target="_blank">https://blog . Cambridge spark . com/deploying-a-machine-learning-model-to-the-web-725688 b 851 c 7</a>。</p><p id="b80c" class="pw-post-body-paragraph lf lg jf lh b li md lk ll lm me lo lp lq mf ls lt lu mg lw lx ly mh ma mb mc im bi translated">[3]使用 flask 部署一个机器学习模型。<a class="ae jc" href="https://hackernoon.com/@vyashemang?source=user_popover" rel="noopener ugc nofollow" target="_blank">赫曼维亚斯</a>。访问:<a class="ae jc" href="https://hackernoon.com/deploy-a-machine-learning-model-using-flask-da580f84e60c" rel="noopener ugc nofollow" target="_blank">https://hacker noon . com/deploy-a-machine-learning-model-using-flask-da 580 f 84 e 60 c</a>。</p></div></div>    
</body>
</html>