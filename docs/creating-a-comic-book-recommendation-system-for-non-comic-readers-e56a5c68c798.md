# 为非漫画读者创建漫画推荐系统

> 原文：<https://towardsdatascience.com/creating-a-comic-book-recommendation-system-for-non-comic-readers-e56a5c68c798?source=collection_archive---------37----------------------->

我的一个爱好是漫画书。你可能已经注意到，即使你不是读者，你也一定会接触到电视和电影中使用的漫画中的人物和故事。网飞、Hulu、亚马逊、HBO 和许多其他公司都涉足漫画内容制作。夏季影院里挤满了最新的《复仇者联盟》或《蝙蝠侠传奇》。

![](img/48630bc1155f4ad18da32ad15d467102.png)

尽管我很喜欢这种媒介，但漫画书行业通常被认为有利于使用他们的故事或角色的下一部大型电影或电视节目。有很多人看到这些节目和电影，有阅读的灵感，但不知道从哪里开始。我明白，看漫画会让人害怕。我认为许多人在《辛普森一家》中的漫画店主的脑海中形成了这样的愿景，并想以另一种方式逃跑。我认为必须有一种方法来帮助人们涉足漫画，而不是从头开始。

我的主要想法是，我如何让看漫画书的电影和电视节目的人成为漫画书？跟他们在电影电视剧里的喜好怎么样！我从那些已有的偏好里给你推荐漫画怎么样。

总的来说，这个项目依赖于你喜欢的内容有一些内在的味道。下面是一个假设类型的例子。这可能并不总是一个明确的概念，但你的品味中可能有一些潜在的方面，可以通过你消费的媒体看到。

![](img/16753404e0bf736dbb054f06658b47a1.png)

考虑到这些，我们来构建一个推荐系统吧！

# 数据准备和挖掘漫画

我的目标是寻找那些对电影/电视和漫画书/漫画小说都有评价的人。为了建立我的模型，我使用了之前在加州大学圣地亚哥分校的一个研究项目中收集的大型亚马逊评论库(1996 年至 2014 年约 24GB 的书籍和电影/电视评论，[更多信息请点击这里](http://jmcauley.ucsd.edu/data/amazon/links.html))。

为了提取正确的用户和评级，我不得不花大量时间学习和探索这个数据集。所有的漫画书/漫画小说都被归入所有其他书评中，没有快捷方式将它们取出。我从抓取亚马逊畅销书页面开始，为漫画书准备了少量的亚马逊 id(ASIN)。基于数据探索，我在 ids 中发现了一种模式，可以快捷地获得漫画书的几大块 id。下面是我发现的模式的一个例子:

![](img/a001d58ccc779b0f8500e538ab38ebba.png)

有了这组 id，我找到了任何对应的评论。然后我找了那组评论者，找到了所有评论过电影/电视的人。在删除少于 5 条评论的条目，并删除任何缺少相关元数据的数据(一些数据缺少标题或链接到不再列出的条目，使它们不可用)后，我正在处理约 84，000 条评论，约 8，500 个不同用户和约 7，400 条条目(约 1，300 部漫画/漫画小说，约 6，100 部电影/电视)。

# 建模和交替最小二乘法

我的方法是建立一个替代的最小二乘(ALS)模型来拥有一个协同过滤推荐系统。你可能会问自己，这些最小二乘是什么，为什么它们会交替出现？

交替最小二乘法是一种方法，通过这种方法，我们可以将评级矩阵分解为代表用户和项目的矩阵，每个矩阵都通过潜在特征来表示。在一个非常简单的例子中，可以这样认为:

![](img/492fd53f8e12da72c3a5f0240d512f42.png)

所以我有我的用户评分矩阵和他们对漫画和电影的评论。这个矩阵将是相当稀疏的，因为用户将只对一些事情进行评分，但我们希望填充这些空白的位置，并根据我们对他们的了解猜测他们可能会得分。我们首先选择一些潜在的特征。潜在特征本质上是描述用户和项目的数学推导方式。通过非负矩阵分解(NMF)，我们可以从 R 中导出用户(U)和项目(P)的矩阵。我们保持 U 不变(用随机值填充)并求解 P。然后，我们保持 P 不变并求解 U。这个过程如此往复，直到看不到误差减少。完成后，U 和 P 相乘得到新的 R 估计值，填入用户评价矩阵中的值。

# 估价

为了评估，我基于对均方根误差(RMSE)和平均绝对误差(MAE)的优化来优化我的模型的性能。调整我的模型的参数并没有提供太多的性能，但是我确定了我的最佳模型，使用 50 个潜在特征，正则化参数为 0.1，最大迭代次数为 20。我表现最好的模型的 RMSE 是 1.17。总的来说，我希望这个数字低于 1，但我认为在我目前的范围内这是一个相当好的表现。

# 起来，起来，走！

你可以在 [IntoComics](http://comics.naujoks.co/) 亲自测试一下。该应用程序为您提供了从 1 到 5 的电影选择(目前是 60 部最常被评级的电影的精选列表，但排除了所有基于漫画或漫画小说的电影，以更清晰地推动这两种媒体的分离)。一旦你对其中一个或多个进行了评级，它会返回一个前 5 名漫画/图形小说推荐列表，并提供亚马逊上每个产品的链接。我将继续努力改进模型，但现在，希望你喜欢！