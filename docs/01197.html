<html>
<head>
<title>Cryptocurrency Analysis with Python — MACD</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">基于 Python 的加密货币分析——MACD</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/cryptocurrency-analysis-with-python-macd-452ceb251d7c?source=collection_archive---------10-----------------------#2019-02-24">https://towardsdatascience.com/cryptocurrency-analysis-with-python-macd-452ceb251d7c?source=collection_archive---------10-----------------------#2019-02-24</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/f496ae5d76fb7ca23fedda55d54815bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*SBUdw7fENXN39d-n"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk">Photo by <a class="ae kf" href="https://unsplash.com/@thoughtcatalog?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Thought Catalog</a> on <a class="ae kf" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="4a2b" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我决定周末学习加密货币分析。我破解了代码<a class="ae kf" href="https://romanorac.github.io/assets/notebooks/2017-12-17-cryptocurrency-analysis-with-python-part1.ipynb" rel="noopener ugc nofollow" target="_blank">来下载每日比特币价格，并对其应用简单的交易策略。</a></p><p id="56ce" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu">如果你错过了我关于这个话题的其他文章:</strong></p><div class="le lf gp gr lg lh"><a href="https://romanorac.medium.com/stock-market-analysis-in-python-b71bf50151d9" rel="noopener follow" target="_blank"><div class="li ab fo"><div class="lj ab lk cl cj ll"><h2 class="bd iu gy z fp lm fr fs ln fu fw is bi translated">Python 中的股票市场分析</h2><div class="lo l"><h3 class="bd b gy z fp lm fr fs ln fu fw dk translated">我用 Python 写的关于股票市场和加密货币分析的文章的精选列表。</h3></div><div class="lp l"><p class="bd b dl z fp lm fr fs ln fu fw dk translated">romanorac.medium.com</p></div></div><div class="lq l"><div class="lr l ls lt lu lq lv jz lh"/></div></div></a></div><p id="920c" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu">这里有几个你可能会感兴趣的链接:</strong></p><pre class="lw lx ly lz gt ma mb mc md aw me bi"><span id="a134" class="mf mg it mb b gy mh mi l mj mk">- <a class="ae kf" href="https://trymito.io/" rel="noopener ugc nofollow" target="_blank">Complete your Python analyses 10x faster with Mito</a> [Product]</span><span id="cf78" class="mf mg it mb b gy ml mi l mj mk">- <a class="ae kf" href="https://aigents.co/skills" rel="noopener ugc nofollow" target="_blank">Free skill tests for Data Scientists &amp; ML Engineers</a> [Test]</span><span id="1e41" class="mf mg it mb b gy ml mi l mj mk">- <a class="ae kf" href="https://imp.i115008.net/c/2402645/1116216/11298" rel="noopener ugc nofollow" target="_blank">All New Self-Driving Car Engineer Nanodegree</a><strong class="mb iu"> </strong>[Course]</span></pre><p id="3897" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">您愿意阅读更多这样的文章吗？如果是这样，你可以点击上面的任何链接来支持我。其中一些是附属链接，但你不需要购买任何东西。</p><h1 id="db0c" class="mn mg it bd mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj bi translated">传统视图</h1><p id="b125" class="pw-post-body-paragraph kg kh it ki b kj nk kl km kn nl kp kq kr nm kt ku kv nn kx ky kz no lb lc ld im bi translated">已经存在执行这种分析的工具，例如<a class="ae kf" href="https://www.tradingview.com/" rel="noopener ugc nofollow" target="_blank"> tradingview </a>，但是在 Python 中进行这种分析可以实现更深入的分析。</p><figure class="lw lx ly lz gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi np"><img src="../Images/f3be1fe8ff13be5bbe75e1e988428487.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*fybYsSvNw1ShL7u5.gif"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk">Interactive plot showing Bitcoin price</figcaption></figure><h1 id="3250" class="mn mg it bd mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj bi translated">放弃</h1><p id="e512" class="pw-post-body-paragraph kg kh it ki b kj nk kl km kn nl kp kq kr nm kt ku kv nn kx ky kz no lb lc ld im bi translated">我不是交易者，这篇博客也不是金融建议。这纯粹是入门知识。当我们分析巨大增长的时期时，这里的结论可能是误导的。</p><h1 id="2d45" class="mn mg it bd mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj bi translated">要求</h1><ul class=""><li id="4b8e" class="nq nr it ki b kj nk kn nl kr ns kv nt kz nu ld nv nw nx ny bi translated">Python 3</li><li id="53ee" class="nq nr it ki b kj nz kn oa kr ob kv oc kz od ld nv nw nx ny bi translated"><a class="ae kf" href="http://jupyter.org/" rel="noopener ugc nofollow" target="_blank"> Jupyter 笔记本</a></li><li id="2208" class="nq nr it ki b kj nz kn oa kr ob kv oc kz od ld nv nw nx ny bi translated"><a class="ae kf" href="https://pandas.pydata.org/" rel="noopener ugc nofollow" target="_blank">熊猫数据分析库</a></li><li id="9aff" class="nq nr it ki b kj nz kn oa kr ob kv oc kz od ld nv nw nx ny bi translated"><a class="ae kf" href="https://bokeh.pydata.org/en/latest/" rel="noopener ugc nofollow" target="_blank">散景互动可视化库</a></li><li id="71ce" class="nq nr it ki b kj nz kn oa kr ob kv oc kz od ld nv nw nx ny bi translated"><a class="ae kf" href="https://github.com/jealous/stockstats" rel="noopener ugc nofollow" target="_blank">股票统计/指标计算助手</a></li></ul><h1 id="c8b4" class="mn mg it bd mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj bi translated">获取加密货币数据</h1><p id="69dc" class="pw-post-body-paragraph kg kh it ki b kj nk kl km kn nl kp kq kr nm kt ku kv nn kx ky kz no lb lc ld im bi translated">我们在 Bitstamp exchange 上下载每日以美元计算的比特币数据。<a class="ae kf" href="https://www.cryptocompare.com/api/#introduction" rel="noopener ugc nofollow" target="_blank">也支持其他交换</a>。</p><pre class="lw lx ly lz gt ma mb mc md aw me bi"><span id="06a8" class="mf mg it mb b gy mh mi l mj mk">from_symbol <strong class="mb iu">=</strong> 'BTC'<br/>to_symbol <strong class="mb iu">=</strong> 'USD'<br/>exchange <strong class="mb iu">=</strong> 'Bitstamp'<br/>datetime_interval <strong class="mb iu">=</strong> 'day'</span></pre><p id="2f33" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><a class="ae kf" href="https://www.cryptocompare.com/api/#introduction" rel="noopener ugc nofollow" target="_blank"> cryptocompare API </a>返回以下列:</p><ul class=""><li id="a292" class="nq nr it ki b kj kk kn ko kr oe kv of kz og ld nv nw nx ny bi translated"><strong class="ki iu">开盘</strong>，该时段开盘的价格、</li><li id="5d02" class="nq nr it ki b kj nz kn oa kr ob kv oc kz od ld nv nw nx ny bi translated"><strong class="ki iu">高点</strong>，期间达到的最高价位，</li><li id="d426" class="nq nr it ki b kj nz kn oa kr ob kv oc kz od ld nv nw nx ny bi translated"><strong class="ki iu">低点</strong>，期间达到的最低价，</li><li id="184e" class="nq nr it ki b kj nz kn oa kr ob kv oc kz od ld nv nw nx ny bi translated"><strong class="ki iu">收盘</strong>，该时段收盘的价格、</li><li id="2021" class="nq nr it ki b kj nz kn oa kr ob kv oc kz od ld nv nw nx ny bi translated"><strong class="ki iu">成交量从</strong>开始，以交易的基础货币表示的成交量，</li><li id="4ba7" class="nq nr it ki b kj nz kn oa kr ob kv oc kz od ld nv nw nx ny bi translated"><strong class="ki iu">成交量到</strong>，交易货币的成交量。</li></ul><p id="3662" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们下载数据并存储到一个文件中。</p><pre class="lw lx ly lz gt ma mb mc md aw me bi"><span id="5e13" class="mf mg it mb b gy mh mi l mj mk">import requests<br/>from datetime import datetime<br/></span><span id="f544" class="mf mg it mb b gy ml mi l mj mk"><strong class="mb iu">def</strong> <strong class="mb iu">get_filename</strong>(from_symbol, to_symbol, exchange, datetime_interval, download_date):<br/>    <strong class="mb iu">return</strong> '%s_%s_%s_%s_%s.csv' <strong class="mb iu">%</strong> (from_symbol, to_symbol, exchange, datetime_interval, download_date)<br/></span><span id="dc31" class="mf mg it mb b gy ml mi l mj mk"><strong class="mb iu">def</strong> <strong class="mb iu">download_data</strong>(from_symbol, to_symbol, exchange, datetime_interval):<br/>    supported_intervals <strong class="mb iu">=</strong> {'minute', 'hour', 'day'}<br/>    <strong class="mb iu">assert</strong> datetime_interval <strong class="mb iu">in</strong> supported_intervals,\<br/>        'datetime_interval should be one of %s' <strong class="mb iu">%</strong> supported_intervals</span><span id="d5d5" class="mf mg it mb b gy ml mi l mj mk">    <strong class="mb iu">print</strong>('Downloading %s trading data for %s %s from %s' <strong class="mb iu">%</strong><br/>          (datetime_interval, from_symbol, to_symbol, exchange))<br/>    base_url <strong class="mb iu">=</strong> 'https://min-api.cryptocompare.com/data/histo'<br/>    url <strong class="mb iu">=</strong> '%s%s' <strong class="mb iu">%</strong> (base_url, datetime_interval)</span><span id="01fa" class="mf mg it mb b gy ml mi l mj mk">    params <strong class="mb iu">=</strong> {'fsym': from_symbol, 'tsym': to_symbol,<br/>              'limit': 2000, 'aggregate': 1,<br/>              'e': exchange}<br/>    request <strong class="mb iu">=</strong> requests<strong class="mb iu">.</strong>get(url, params<strong class="mb iu">=</strong>params)<br/>    data <strong class="mb iu">=</strong> request<strong class="mb iu">.</strong>json()<br/>    <strong class="mb iu">return</strong> data<br/></span><span id="4bf9" class="mf mg it mb b gy ml mi l mj mk"><strong class="mb iu">def</strong> <strong class="mb iu">convert_to_dataframe</strong>(data):<br/>    df <strong class="mb iu">=</strong> pd<strong class="mb iu">.</strong>io<strong class="mb iu">.</strong>json<strong class="mb iu">.</strong>json_normalize(data, ['Data'])<br/>    df['datetime'] <strong class="mb iu">=</strong> pd<strong class="mb iu">.</strong>to_datetime(df<strong class="mb iu">.</strong>time, unit<strong class="mb iu">=</strong>'s')<br/>    df <strong class="mb iu">=</strong> df[['datetime', 'low', 'high', 'open',<br/>             'close', 'volumefrom', 'volumeto']]<br/>    <strong class="mb iu">return</strong> df<br/></span><span id="fe7d" class="mf mg it mb b gy ml mi l mj mk"><strong class="mb iu">def</strong> <strong class="mb iu">filter_empty_datapoints</strong>(df):<br/>    indices <strong class="mb iu">=</strong> df[df<strong class="mb iu">.</strong>sum(axis<strong class="mb iu">=</strong>1) <strong class="mb iu">==</strong> 0]<strong class="mb iu">.</strong>index<br/>    <strong class="mb iu">print</strong>('Filtering %d empty datapoints' <strong class="mb iu">%</strong> indices<strong class="mb iu">.</strong>shape[0])<br/>    df <strong class="mb iu">=</strong> df<strong class="mb iu">.</strong>drop(indices)<br/>    <strong class="mb iu">return</strong> df<br/></span><span id="10b3" class="mf mg it mb b gy ml mi l mj mk">data <strong class="mb iu">=</strong> download_data(from_symbol, to_symbol, exchange, datetime_interval)<br/>df <strong class="mb iu">=</strong> convert_to_dataframe(data)<br/>df <strong class="mb iu">=</strong> filter_empty_datapoints(df)</span><span id="c0fe" class="mf mg it mb b gy ml mi l mj mk">current_datetime <strong class="mb iu">=</strong> datetime<strong class="mb iu">.</strong>now()<strong class="mb iu">.</strong>date()<strong class="mb iu">.</strong>isoformat()<br/>filename <strong class="mb iu">=</strong> get_filename(from_symbol, to_symbol, exchange, datetime_interval, current_datetime)<br/><strong class="mb iu">print</strong>('Saving data to %s' <strong class="mb iu">%</strong> filename)<br/>df<strong class="mb iu">.</strong>to_csv(filename, index<strong class="mb iu">=</strong>False)</span></pre><h1 id="3fb6" class="mn mg it bd mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj bi translated">读取数据</h1><p id="4bb7" class="pw-post-body-paragraph kg kh it ki b kj nk kl km kn nl kp kq kr nm kt ku kv nn kx ky kz no lb lc ld im bi translated">我们从文件中读取数据，所以我们不需要再次下载它。</p><pre class="lw lx ly lz gt ma mb mc md aw me bi"><span id="888a" class="mf mg it mb b gy mh mi l mj mk">import pandas <strong class="mb iu">as</strong> pd</span><span id="f7c8" class="mf mg it mb b gy ml mi l mj mk"><strong class="mb iu">def</strong> <strong class="mb iu">read_dataset</strong>(filename):<br/>    <strong class="mb iu">print</strong>('Reading data from %s' <strong class="mb iu">%</strong> filename)<br/>    df <strong class="mb iu">=</strong> pd<strong class="mb iu">.</strong>read_csv(filename)<br/>    <em class="mm"># change type from object to datetime<br/></em>    df<strong class="mb iu">.</strong>datetime <strong class="mb iu">=</strong> pd<strong class="mb iu">.</strong>to_datetime(df<strong class="mb iu">.</strong>datetime) <br/>    df <strong class="mb iu">=</strong> df<strong class="mb iu">.</strong>set_index('datetime') <br/>    df <strong class="mb iu">=</strong> df<strong class="mb iu">.</strong>sort_index() <em class="mm"># sort by datetime</em><br/>    <strong class="mb iu">print</strong>(df<strong class="mb iu">.</strong>shape)<br/>    <strong class="mb iu">return</strong> df</span><span id="cf01" class="mf mg it mb b gy ml mi l mj mk">df <strong class="mb iu">=</strong> read_dataset(filename)</span></pre><h1 id="9088" class="mn mg it bd mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj bi translated">交易策略</h1><p id="94cc" class="pw-post-body-paragraph kg kh it ki b kj nk kl km kn nl kp kq kr nm kt ku kv nn kx ky kz no lb lc ld im bi translated">交易策略是一套客观的规则，定义了交易进场和出场必须满足的条件。</p><p id="bd12" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们将采用移动平均线收敛发散(MACD)交易策略，这是技术分析中常用的指标。MACD 计算两条不同长度的移动平均线来确定趋势方向和持续时间。然后，取这两条移动平均线(MACD 线)和这些移动平均线的指数移动平均线(信号线)之间的差值。Tradeview 有一篇关于 MACD 的精彩博文。</p><p id="eca4" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">正如我们在下面的例子中看到的:</p><ul class=""><li id="81c5" class="nq nr it ki b kj kk kn ko kr oe kv of kz og ld nv nw nx ny bi translated">当 MACD 线穿过 MACD 信号线时退出交易，</li><li id="12eb" class="nq nr it ki b kj nz kn oa kr ob kv oc kz od ld nv nw nx ny bi translated">当 MACD 线穿过 MACD 信号线时，进场交易(买入)。</li></ul><h1 id="d253" class="mn mg it bd mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj bi translated">计算交易策略</h1><p id="8ff5" class="pw-post-body-paragraph kg kh it ki b kj nk kl km kn nl kp kq kr nm kt ku kv nn kx ky kz no lb lc ld im bi translated">我们使用<a class="ae kf" href="https://github.com/jealous/stockstats" rel="noopener ugc nofollow" target="_blank"> stockstats </a>软件包来计算 MACD。</p><pre class="lw lx ly lz gt ma mb mc md aw me bi"><span id="9762" class="mf mg it mb b gy mh mi l mj mk">from stockstats import StockDataFrame<br/>df <strong class="mb iu">=</strong> StockDataFrame<strong class="mb iu">.</strong>retype(df)<br/>df['macd'] <strong class="mb iu">=</strong> df<strong class="mb iu">.</strong>get('macd') <em class="mm"># calculate MACD</em></span></pre><p id="8001" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">stockstats 向数据集添加了 5 列:</p><ul class=""><li id="a880" class="nq nr it ki b kj kk kn ko kr oe kv of kz og ld nv nw nx ny bi translated"><strong class="ki iu"> close_12_ema </strong>是快速 12 天指数移动平均线，</li><li id="8699" class="nq nr it ki b kj nz kn oa kr ob kv oc kz od ld nv nw nx ny bi translated"><strong class="ki iu"> close_26_ema </strong>是慢 26 天指数移动平均线，</li><li id="14ec" class="nq nr it ki b kj nz kn oa kr ob kv oc kz od ld nv nw nx ny bi translated"><strong class="ki iu"> macd </strong>是 macd 线，</li><li id="3afe" class="nq nr it ki b kj nz kn oa kr ob kv oc kz od ld nv nw nx ny bi translated"><strong class="ki iu">MACD</strong>是信号线，</li><li id="8ce8" class="nq nr it ki b kj nz kn oa kr ob kv oc kz od ld nv nw nx ny bi translated"><strong class="ki iu"> macdh </strong>是 MACD 直方图。</li></ul><figure class="lw lx ly lz gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi oh"><img src="../Images/545366569e010e58463c9e9d1ef3e235.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QgQoKjqFrlYZOBPQsI-61A.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk">Few entries in the dataset.</figcaption></figure><h1 id="f499" class="mn mg it bd mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj bi translated">可视化交易策略</h1><p id="2657" class="pw-post-body-paragraph kg kh it ki b kj nk kl km kn nl kp kq kr nm kt ku kv nn kx ky kz no lb lc ld im bi translated">我们使用散景交互式图表来绘制数据。</p><p id="bef0" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">折线图用蜡烛线显示每日收盘价(放大)。蜡烛图显示特定时期的最高价、最低价、开盘价和收盘价。Tradeview 有一篇关于<a class="ae kf" href="https://www.investopedia.com/terms/c/candlestick.asp" rel="noopener ugc nofollow" target="_blank">烛台图</a>的很棒的博文。</p><p id="3da8" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在线图下方，我们用 MACD 线(蓝色)、信号线(橙色)和柱状图(紫色)绘制了 MACD 策略。</p><pre class="lw lx ly lz gt ma mb mc md aw me bi"><span id="6847" class="mf mg it mb b gy mh mi l mj mk">from math import pi</span><span id="0a47" class="mf mg it mb b gy ml mi l mj mk">from bokeh.plotting import figure, show, output_notebook, output_file<br/>output_notebook()</span><span id="d363" class="mf mg it mb b gy ml mi l mj mk">datetime_from <strong class="mb iu">=</strong> '2016-01-01 00:00'<br/>datetime_to <strong class="mb iu">=</strong> '2017-12-10 00:00'<br/></span><span id="69b1" class="mf mg it mb b gy ml mi l mj mk"><strong class="mb iu">def</strong> <strong class="mb iu">get_candlestick_width</strong>(datetime_interval):<br/>    <strong class="mb iu">if</strong> datetime_interval <strong class="mb iu">==</strong> 'minute':<br/>        <strong class="mb iu">return</strong> 30 <strong class="mb iu">*</strong> 60 <strong class="mb iu">*</strong> 1000  <em class="mm"># half minute in ms</em><br/>    <strong class="mb iu">elif</strong> datetime_interval <strong class="mb iu">==</strong> 'hour':<br/>        <strong class="mb iu">return</strong> 0.5 <strong class="mb iu">*</strong> 60 <strong class="mb iu">*</strong> 60 <strong class="mb iu">*</strong> 1000  <em class="mm"># half hour in ms</em><br/>    <strong class="mb iu">elif</strong> datetime_interval <strong class="mb iu">==</strong> 'day':<br/>        <strong class="mb iu">return</strong> 12 <strong class="mb iu">*</strong> 60 <strong class="mb iu">*</strong> 60 <strong class="mb iu">*</strong> 1000  <em class="mm"># half day in ms</em><br/></span><span id="24cd" class="mf mg it mb b gy ml mi l mj mk">df_limit <strong class="mb iu">=</strong> df[datetime_from: datetime_to]<strong class="mb iu">.</strong>copy()<br/>inc <strong class="mb iu">=</strong> df_limit<strong class="mb iu">.</strong>close <strong class="mb iu">&gt;</strong> df_limit<strong class="mb iu">.</strong>open<br/>dec <strong class="mb iu">=</strong> df_limit<strong class="mb iu">.</strong>open <strong class="mb iu">&gt;</strong> df_limit<strong class="mb iu">.</strong>close</span><span id="198c" class="mf mg it mb b gy ml mi l mj mk">title <strong class="mb iu">=</strong> '%s datapoints from %s to %s for %s and %s from %s with MACD strategy' <strong class="mb iu">%</strong> (<br/>    datetime_interval, datetime_from, datetime_to, from_symbol, to_symbol, exchange)<br/>p <strong class="mb iu">=</strong> figure(x_axis_type<strong class="mb iu">=</strong>"datetime",  plot_width<strong class="mb iu">=</strong>1000, title<strong class="mb iu">=</strong>title)</span><span id="57a8" class="mf mg it mb b gy ml mi l mj mk">p<strong class="mb iu">.</strong>line(df_limit<strong class="mb iu">.</strong>index, df_limit<strong class="mb iu">.</strong>close, color<strong class="mb iu">=</strong>'black')</span><span id="51a7" class="mf mg it mb b gy ml mi l mj mk"><em class="mm"># plot macd strategy</em><br/>p<strong class="mb iu">.</strong>line(df_limit<strong class="mb iu">.</strong>index, 0, color<strong class="mb iu">=</strong>'black')<br/>p<strong class="mb iu">.</strong>line(df_limit<strong class="mb iu">.</strong>index, df_limit<strong class="mb iu">.</strong>macd, color<strong class="mb iu">=</strong>'blue')<br/>p<strong class="mb iu">.</strong>line(df_limit<strong class="mb iu">.</strong>index, df_limit<strong class="mb iu">.</strong>macds, color<strong class="mb iu">=</strong>'orange')<br/>p<strong class="mb iu">.</strong>vbar(x<strong class="mb iu">=</strong>df_limit<strong class="mb iu">.</strong>index, bottom<strong class="mb iu">=</strong>[<br/>       0 <strong class="mb iu">for</strong> _ <strong class="mb iu">in</strong> df_limit<strong class="mb iu">.</strong>index], top<strong class="mb iu">=</strong>df_limit<strong class="mb iu">.</strong>macdh, width<strong class="mb iu">=</strong>4, color<strong class="mb iu">=</strong>"purple")</span><span id="1935" class="mf mg it mb b gy ml mi l mj mk"><em class="mm"># plot candlesticks</em><br/>candlestick_width <strong class="mb iu">=</strong> get_candlestick_width(datetime_interval)<br/>p<strong class="mb iu">.</strong>segment(df_limit<strong class="mb iu">.</strong>index, df_limit<strong class="mb iu">.</strong>high,<br/>          df_limit<strong class="mb iu">.</strong>index, df_limit<strong class="mb iu">.</strong>low, color<strong class="mb iu">=</strong>"black")<br/>p<strong class="mb iu">.</strong>vbar(df_limit<strong class="mb iu">.</strong>index[inc], candlestick_width, df_limit<strong class="mb iu">.</strong>open[inc],<br/>       df_limit<strong class="mb iu">.</strong>close[inc], fill_color<strong class="mb iu">=</strong>"#D5E1DD", line_color<strong class="mb iu">=</strong>"black")<br/>p<strong class="mb iu">.</strong>vbar(df_limit<strong class="mb iu">.</strong>index[dec], candlestick_width, df_limit<strong class="mb iu">.</strong>open[dec],<br/>       df_limit<strong class="mb iu">.</strong>close[dec], fill_color<strong class="mb iu">=</strong>"#F2583E", line_color<strong class="mb iu">=</strong>"black")</span><span id="034f" class="mf mg it mb b gy ml mi l mj mk">output_file("visualizing_trading_strategy.html", title<strong class="mb iu">=</strong>"visualizing trading strategy")<br/>show(p)</span></pre><figure class="lw lx ly lz gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi oi"><img src="../Images/e9ab2994efefd82e35827f496e8d447d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*r6AcrcEzR5Tqe-78ybcC8g.png"/></div></div></figure><h1 id="be03" class="mn mg it bd mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj bi translated">在你走之前</h1><p id="dea3" class="pw-post-body-paragraph kg kh it ki b kj nk kl km kn nl kp kq kr nm kt ku kv nn kx ky kz no lb lc ld im bi translated">在<a class="ae kf" href="https://twitter.com/romanorac" rel="noopener ugc nofollow" target="_blank"> Twitter </a>上关注我，在那里我定期<a class="ae kf" href="https://twitter.com/romanorac/status/1328952374447267843" rel="noopener ugc nofollow" target="_blank">发布关于数据科学和机器学习的</a>消息。</p><figure class="lw lx ly lz gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi oj"><img src="../Images/b5d426b68cc5a21b1a35d0a157ebc4f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*69rP1pwjJi9mLSFE"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk">Photo by <a class="ae kf" href="https://unsplash.com/@cmhedger?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Courtney Hedger</a> on <a class="ae kf" href="https://unsplash.com/?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure></div></div>    
</body>
</html>