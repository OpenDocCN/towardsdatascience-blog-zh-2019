<html>
<head>
<title>The complete beginner’s guide to data cleaning and preprocessing</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">数据清理和预处理完全初学者指南</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/the-complete-beginners-guide-to-data-cleaning-and-preprocessing-2070b7d4c6d?source=collection_archive---------4-----------------------#2019-02-17">https://towardsdatascience.com/the-complete-beginners-guide-to-data-cleaning-and-preprocessing-2070b7d4c6d?source=collection_archive---------4-----------------------#2019-02-17</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="c2d4" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">如何在几分钟内为机器学习模型成功准备数据</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/dc2668ddff29c230a5668ade99c2b7e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rqquTRzaaVH6NiFF-Jz66A.jpeg"/></div></div></figure><p id="9696" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">数据预处理是建立工作机器学习模型的第一步(也可以说是最重要的一步)。很关键！</p><p id="19fd" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">如果您的数据没有经过清理和预处理，那么您的模型就不起作用。</p><p id="9cf2" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">就这么简单。</p><p id="9b54" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">数据预处理通常被认为是枯燥的部分。但这就是有准备和完全没有准备的区别。这就是看起来像专业人士和看起来很傻的区别。</p><p id="ba5f" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">有点像准备去度假。你可能不喜欢准备部分，但是提前确定细节可以让你免于一场噩梦般的旅行。</p><p id="37de" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">你必须去做，否则你就不能开始享受乐趣。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lq lr l"/></div><figcaption class="ls lt gj gh gi lu lv bd b be z dk">GIF via <a class="ae lw" href="https://giphy.com/gifs/poker-face-mlPUJrMgkEays" rel="noopener ugc nofollow" target="_blank">GIPHY</a></figcaption></figure><p id="607a" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">但是你是怎么做到的呢？</p><blockquote class="lx"><p id="0975" class="ly lz it bd ma mb mc md me mf mg lp dk translated"><strong class="ak">本教程将带你了解为任何机器学习模型准备任何数据集的基本知识。</strong></p></blockquote><h2 id="921a" class="mh mi it bd mj mk ml dn mm mn mo dp mp ld mq mr ms lh mt mu mv ll mw mx my mz bi translated">进口第一！</h2><p id="bd68" class="pw-post-body-paragraph ku kv it kw b kx na ju kz la nb jx lc ld nc lf lg lh nd lj lk ll ne ln lo lp im bi translated">我们希望从导入预处理数据所需的库开始。库实际上只是一个你可以使用的工具。你给库输入，库做它的工作，它给你你需要的输出。有很多可用的库，但是有三个是 Python 中的基本库。你几乎每次都会用到它们。使用 Python 时，三个最流行的库是 Numpy、Matplotlib 和 Pandas。<strong class="kw iu"> Numpy </strong>是你需要的所有数学知识的图书馆。因为你的代码要在数学上运行，所以你要用这个。Matplotlib (特别是 Matplotlib.pyplot)是你想要制作图表的库。Pandas 是导入和管理数据集的最佳工具。熊猫和 Numpy 基本上是数据预处理必不可少的。</p><p id="8d96" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">(如果你对这些都不熟悉，你可能想看看 NumPy 的终极初学者指南！)</p><div class="nf ng gp gr nh ni"><a rel="noopener follow" target="_blank" href="/the-ultimate-beginners-guide-to-numpy-f5a2f99aef54"><div class="nj ab fo"><div class="nk ab nl cl cj nm"><h2 class="bd iu gy z fp nn fr fs no fu fw is bi translated">NumPy 初学者终极指南</h2><div class="np l"><h3 class="bd b gy z fp nn fr fs no fu fw dk translated">开始使用 NumPy 需要知道的一切</h3></div><div class="nq l"><p class="bd b dl z fp nn fr fs no fu fw dk translated">towardsdatascience.com</p></div></div><div class="nr l"><div class="ns l nt nu nv nr nw ks ni"/></div></div></a></div><p id="210b" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">用一个快捷别名导入这些库是最有意义的，这样以后可以节省一点时间。这很简单，你可以这样做:</p><pre class="kj kk kl km gt nx ny nz oa aw ob bi"><span id="9ac8" class="mh mi it ny b gy oc od l oe of">import numpy as np<br/>import matplotlib.pyplot as plt<br/>import pandas as pd</span></pre><p id="ff19" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">现在，您可以通过键入以下内容来读取数据集</p><pre class="kj kk kl km gt nx ny nz oa aw ob bi"><span id="b14e" class="mh mi it ny b gy oc od l oe of">dataset = pd.read_csv('my_data.csv')</span></pre><p id="7166" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这告诉 Pandas (pd)读入您的数据集。这些是我为本教程整理的数据集的前几行:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi og"><img src="../Images/1ddaf81e769ea486b47d87b7c4fe624e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1264/format:webp/1*p6VRCgPm1MI6ryU7wZPEHg.png"/></div></figure><p id="adc9" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">现在我们有了数据集，但是我们需要创建一个因变量矩阵和一个自变量向量。您可以通过键入以下内容来创建因变量矩阵:</p><pre class="kj kk kl km gt nx ny nz oa aw ob bi"><span id="49ab" class="mh mi it ny b gy oc od l oe of">X = dataset.iloc[:, :-1].values</span></pre><p id="b6a1" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">第一个冒号(<strong class="kw iu"> : </strong>)意味着我们想要获取数据集中的所有行。<strong class="kw iu"> :-1 </strong>表示我们要抓取除最后一列之外的所有数据列。的。<strong class="kw iu">值</strong>放在最后意味着我们要抓取所有的值。</p><p id="65da" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">现在我们需要一个因变量的向量，只包含最后一列的数据，所以我们可以键入</p><pre class="kj kk kl km gt nx ny nz oa aw ob bi"><span id="64f8" class="mh mi it ny b gy oc od l oe of">y = dataset.iloc[:, 3].values</span></pre><p id="327a" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">请记住，当您查看数据集时，索引从 0 开始。如果你想计算列数，从 0 开始，而不是 1。<strong class="kw iu"> [:，3] </strong>获得<strong class="kw iu">动物</strong>、<strong class="kw iu">年龄</strong>、<strong class="kw iu">价值</strong>栏。0 是动物栏，1 是年龄栏，2 是价值。如果你还没有习惯这个计数系统，你会习惯的！</p><h2 id="3c34" class="mh mi it bd mj mk oh dn mm mn oi dp mp ld oj mr ms lh ok mu mv ll ol mx my mz bi translated">如果我们有丢失的数据会怎么样？</h2><p id="05ac" class="pw-post-body-paragraph ku kv it kw b kx na ju kz la nb jx lc ld nc lf lg lh nd lj lk ll ne ln lo lp im bi translated">这实际上一直都在发生。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="om lr l"/></div><figcaption class="ls lt gj gh gi lu lv bd b be z dk">GIF via <a class="ae lw" href="https://giphy.com/gifs/what-surprised-shock-ZHkVpDiI3vIiY" rel="noopener ugc nofollow" target="_blank">GIPHY</a></figcaption></figure><p id="57b8" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们可以删除丢失数据的行，但这真的不是最聪明的主意。这很容易引起问题。我们需要找到一个更好的主意！最常见的解决方案是取列的平均值来填充缺失的数据点。</p><p id="c5e2" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">使用 scikit-learn 的预处理模型中的 imputer 类可以很容易地做到这一点。如果你还不知道，scikit-learn 包含了惊人的机器学习模型，我强烈建议你去看看！)</p><p id="b5eb" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">当应用于机器学习时，您可能不习惯使用“<strong class="kw iu">方法</strong>、“<strong class="kw iu">类</strong>”和“<strong class="kw iu">对象</strong>”这样的术语。没问题！</p><p id="31cb" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">一个<strong class="kw iu">类</strong>是我们想要构建的东西的模型。如果我们要搭建一个棚子，棚子的搭建方案就是上课。</p><p id="6df6" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">一个<strong class="kw iu">对象</strong>是该类的一个实例。本例中的对象是我们按照施工计划搭建的棚子。同一个类可以有许多对象。这就像是说，你可以根据建筑计划建造很多棚子。</p><p id="094f" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">一个<strong class="kw iu">方法</strong>是一个我们可以在对象上使用的工具，或者一个应用于对象的函数，它接受一些输入并返回一些输出。这就像一个把手，当我们的小屋开始变得有点闷时，我们可以用它来打开窗户。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi on"><img src="../Images/999065f7e4764c831d9178209bfbc6a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*9tNbMFo4CSApIumF"/></div></div><figcaption class="ls lt gj gh gi lu lv bd b be z dk">Photo by <a class="ae lw" href="https://unsplash.com/@romankraft?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Roman Kraft</a> on <a class="ae lw" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="ceea" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">为了使用估算器，我们将运行类似这样的程序</p><pre class="kj kk kl km gt nx ny nz oa aw ob bi"><span id="bfa4" class="mh mi it ny b gy oc od l oe of">from sklearn.preprocessing import Imputer<br/>imputer = Imputer(missing_values = np.nan, strategy = ‘mean’, axis = 0)</span></pre><p id="5572" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">Mean 是默认策略，所以您实际上不需要指定它，但是它在这里，所以您可以了解您想要包含什么信息。missing_values 的默认值是 nan。如果您的数据集有称为“NaN”的缺失值，您将坚持使用 np.nan。</p><p id="7b39" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">现在，为了适应这个估算，我们键入</p><pre class="kj kk kl km gt nx ny nz oa aw ob bi"><span id="decf" class="mh mi it ny b gy oc od l oe of">imputer = imputer.fit(X[:, 1:3])</span></pre><p id="c88f" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们只想将估算值拟合到缺少数据的列。第一个冒号意味着我们想要包含所有的行，而<strong class="kw iu"> 1:3 </strong>意味着我们接受列索引 1 和 2。别担心。您很快就会习惯 Python 的计算方式！</p><p id="1eb9" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">现在我们想使用的方法将实际上取代丢失的数据。您可以通过键入</p><pre class="kj kk kl km gt nx ny nz oa aw ob bi"><span id="61b9" class="mh mi it ny b gy oc od l oe of">X[:, 1:3] = imputer.transform(X[:, 1:3])</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oo"><img src="../Images/c738a9c354041bd6f48d7f8f57965438.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Xwa1N4KVuoBc_TFxkw31Bg.png"/></div></div></figure><p id="33a4" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">用其他策略试试这个吧！您可能会发现，对于您的项目来说，用列的中间值填充缺失值更有意义。还是模式！像这样的决定看起来很小，但实际上却非常重要。</p><p id="bef3" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">某样东西受欢迎并不一定就是正确的选择。数据点的平均值不一定是模型的最佳选择。</p><p id="73e7" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">毕竟，几乎每个阅读这篇文章的人都有超过平均水平的手臂…</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi op"><img src="../Images/22cf00f151a52705ce3eb8b2aa78d5df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*5lpdsnzBBNF7Y2KA"/></div></div><figcaption class="ls lt gj gh gi lu lv bd b be z dk">Photo by <a class="ae lw" href="https://unsplash.com/@matthewhenry?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Matthew Henry</a> on <a class="ae lw" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h2 id="7c26" class="mh mi it bd mj mk oh dn mm mn oi dp mp ld oj mr ms lh ok mu mv ll ol mx my mz bi translated">如果你有分类数据呢？</h2><p id="e9d4" class="pw-post-body-paragraph ku kv it kw b kx na ju kz la nb jx lc ld nc lf lg lh nd lj lk ll ne ln lo lp im bi translated">很棒的问题！你不能完全理解<strong class="kw iu">猫</strong>、<strong class="kw iu">狗</strong>和<strong class="kw iu">驼鹿</strong>的意思。我们能做什么？我们可以将分类值编码成数字！您需要从 sklearn.preprocessing 中获取标签编码器类。</p><p id="0df5" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">从您想要对数据进行编码的一列开始，并调用标签编码器。然后将它放入您的数据中</p><pre class="kj kk kl km gt nx ny nz oa aw ob bi"><span id="9a73" class="mh mi it ny b gy oc od l oe of">from sklearn.preprocessing import LabelEncoder<br/>labelencoder_X = LabelEncoder()<br/>X[:, 0] = labelencoder_X.fit_transform(X[:, 0])</span></pre><p id="aa7f" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">(还记得括号里的数字是怎么工作的吗？:表示我们想要处理所有的行，0 表示我们想要获取第一列。)</p><p id="d8cf" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这就是用数字替换第一列中的分类变量的全部步骤。例如，不是驼鹿，而是“0”，不是“狗”，而是“2”，不是“猫”，而是“3”。</p><p id="90c5" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">你看到潜在的问题了吗？</p><p id="9e26" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这种标注系统暗示了数据的等级值，这可能会影响您的模型。3 的值大于 0，但<strong class="kw iu">猫</strong>并不(一定……)大于<strong class="kw iu">驼鹿</strong>。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oq"><img src="../Images/07203863c9642c680feca62fd3457539.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*RXDLfUCOCtWG82Qs"/></div></div><figcaption class="ls lt gj gh gi lu lv bd b be z dk">Photo by <a class="ae lw" href="https://unsplash.com/@cellisboa?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Cel Lisboa</a> on <a class="ae lw" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="59f7" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们需要创建<strong class="kw iu">虚拟变量</strong>！</p><p id="a7a7" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们可以为猫创建一个列，为驼鹿创建一个列，以此类推。然后，我们将在列中填入 1 和 0(认为 1 =是，0 =否)。这意味着，如果您在原始列中有<strong class="kw iu">猫</strong>，现在您将在驼鹿列中有 0，在狗列中有 0，在猫列中有 1。</p><p id="44d5" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">听起来很复杂。输入一个热编码器！</p><p id="ce82" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">导入编码器，然后指定列的索引</p><pre class="kj kk kl km gt nx ny nz oa aw ob bi"><span id="1222" class="mh mi it ny b gy oc od l oe of">from sklearn.preprocessing import OneHotEncoder<br/>onehotencoder = OneHotEncoder(categorical_features = [0])</span></pre><p id="1879" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">现在稍微适应和改变一下</p><pre class="kj kk kl km gt nx ny nz oa aw ob bi"><span id="19ca" class="mh mi it ny b gy oc od l oe of">X = onehotencoder.fit_transform(X).toarray()</span></pre><p id="4473" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">瞧啊。您的单个列已被原始列中的每个分类变量替换为一个列，并用 1 和 0 替换分类变量。</p><p id="8072" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">很可爱，对吧？</p><p id="28c6" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">如果我们有像“yes”和“no”这样的分类变量，我们可以继续对我们的<strong class="kw iu"> y </strong>列使用标签编码器</p><pre class="kj kk kl km gt nx ny nz oa aw ob bi"><span id="c7d3" class="mh mi it ny b gy oc od l oe of">labelencoder_y = LabelEncoder()<br/>y = labelencoder_y.fit_transform(y)</span></pre><p id="4248" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这将把 y 拟合并转换成一个编码变量，1 表示是，0 表示否。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi or"><img src="../Images/946e6c6b15dfaddb032f8ca901d8682d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TPSvSF1grIpfakrhLsNR2A.png"/></div></div></figure><h2 id="631c" class="mh mi it bd mj mk oh dn mm mn oi dp mp ld oj mr ms lh ok mu mv ll ol mx my mz bi translated">列车测试分离</h2><p id="0e3b" class="pw-post-body-paragraph ku kv it kw b kx na ju kz la nb jx lc ld nc lf lg lh nd lj lk ll ne ln lo lp im bi translated">此时，您可以继续将数据分成训练集和测试集。<a class="ae lw" rel="noopener" target="_blank" href="/wtf-is-image-classification-8e78a8235acb">我知道我已经在图像分类教程</a>中说过了，但是请始终将您的数据分成训练和测试集，<strong class="kw iu">永远不要</strong>使用您的测试数据进行训练！你需要避免过度合身。(你可以把过度拟合想象成在没有理解信息的情况下，在一次考试前记忆超级具体的细节。当你记住细节的时候，你会在家里用你的抽认卡做得很好。然而，当你面对新的信息时，你会通不过任何真正的测试。)</p><p id="6e1d" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">现在，我们有一台需要学习的机器。它需要在数据上进行训练，并看看它对在单独数据上所学内容的理解程度。记忆训练集和学习不是一回事！您的模型在训练集上学习得越好，就越能预测测试集的结果。你永远不会想过度拟合你的模型。你真的想让它学会！</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi os"><img src="../Images/04148c45720a77efd0f253081ab2c145.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Ic-G-LdQHkXym7vQ"/></div></div><figcaption class="ls lt gj gh gi lu lv bd b be z dk">Photo by <a class="ae lw" href="https://unsplash.com/@thepootphotographer?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Janko Ferlič</a> on <a class="ae lw" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="b3bd" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">首先，我们进口</p><pre class="kj kk kl km gt nx ny nz oa aw ob bi"><span id="dffb" class="mh mi it ny b gy oc od l oe of">from sklearn.model_selection import train_test_split</span></pre><p id="2765" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">现在我们可以创建 X_train 和 X_test 以及 y_train 和 y_test 集合。</p><pre class="kj kk kl km gt nx ny nz oa aw ob bi"><span id="8aec" class="mh mi it ny b gy oc od l oe of">X_train, X_test, y_train, y_test = train_test_split(X, y, test_size = 0.2, random_state = 0)</span></pre><p id="ee8d" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">将数据进行 80/20 分割是非常常见的，80%的数据用于培训，20%用于测试。这就是我们将 test_size 指定为 0.2 的原因。你可以按你需要的方式分割它。你不需要设置一个随机状态，但我喜欢这样做，这样我们就可以准确地重现我们的结果。</p><h2 id="044e" class="mh mi it bd mj mk oh dn mm mn oi dp mp ld oj mr ms lh ok mu mv ll ol mx my mz bi translated">现在进行特征缩放。</h2><p id="f1a3" class="pw-post-body-paragraph ku kv it kw b kx na ju kz la nb jx lc ld nc lf lg lh nd lj lk ll ne ln lo lp im bi translated">什么是特征缩放？我们为什么需要它？</p><p id="6b7d" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">好吧，看看我们的数据。我们有一列动物年龄从 4-17 岁，动物价值从 48，000 美元到 83，000 美元不等。不仅“价值”栏由比“年龄”栏高得多的数字组成，而且变量也覆盖了更广泛的数据范围。这意味着欧几里德距离将被<strong class="kw iu">价值</strong>所支配，并将最终支配<strong class="kw iu">年龄</strong>数据。</p><p id="846d" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">如果欧几里德距离在你的特定机器学习模型中不起作用怎么办？缩放要素仍会使模型速度更快，因此在预处理数据时，您可能需要包括此步骤。</p><p id="98d4" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">有许多方法可以进行特征缩放。它们都意味着我们把我们所有的特征放在同一个尺度上，所以没有一个被另一个所支配。</p><p id="165b" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">从导入开始(您必须习惯这一点)</p><pre class="kj kk kl km gt nx ny nz oa aw ob bi"><span id="a3d1" class="mh mi it ny b gy oc od l oe of">from sklearn.preprocessing import StandardScaler</span></pre><p id="d96e" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">然后创建一个我们要缩放的对象，称之为标准缩放器</p><pre class="kj kk kl km gt nx ny nz oa aw ob bi"><span id="4239" class="mh mi it ny b gy oc od l oe of">sc_X = StandardScaler()</span></pre><p id="e94c" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">现在，我们直接拟合和转换数据集。抓取对象并应用方法。</p><pre class="kj kk kl km gt nx ny nz oa aw ob bi"><span id="8a52" class="mh mi it ny b gy oc od l oe of">X_train = sc_X.fit_transform(X_train)<br/>X_test = sc_X.transform(X_test)</span></pre><p id="f588" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们不需要让它适合我们的测试集，我们只需要一个转换。</p><pre class="kj kk kl km gt nx ny nz oa aw ob bi"><span id="2c5b" class="mh mi it ny b gy oc od l oe of">sc_y = StandardScaler()<br/>y_train = sc_y.fit_transform(y_train)</span></pre><h2 id="68ae" class="mh mi it bd mj mk oh dn mm mn oi dp mp ld oj mr ms lh ok mu mv ll ol mx my mz bi translated"><strong class="ak">哑变量呢？需要对它们进行缩放吗？</strong></h2><p id="ef0e" class="pw-post-body-paragraph ku kv it kw b kx na ju kz la nb jx lc ld nc lf lg lh nd lj lk ll ne ln lo lp im bi translated">嗯，有些人说是，有些人说不是。这是一个你有多想坚持你的解释的问题。让我们所有的数据保持相同的比例是件好事。但是，如果我们对数据进行缩放，我们就失去了轻松解释哪些观察值属于哪个变量的能力。</p><p id="91e6" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">那<strong class="kw iu"> y </strong>呢？如果你有一个像 0 和 1 这样的因变量，你真的不需要应用特征缩放。这是一个具有绝对相关值的分类问题。但是如果你有很大范围的特征值，那么是的！您确实想应用缩放器！</p><h2 id="57ae" class="mh mi it bd mj mk oh dn mm mn oi dp mp ld oj mr ms lh ok mu mv ll ol mx my mz bi translated">你做到了！</h2><p id="7afc" class="pw-post-body-paragraph ku kv it kw b kx na ju kz la nb jx lc ld nc lf lg lh nd lj lk ll ne ln lo lp im bi translated">就是这样！</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ot"><img src="../Images/68f4921b238bd62ede670027815d0654.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*UyfAS8-vfoe7EcoI"/></div></div><figcaption class="ls lt gj gh gi lu lv bd b be z dk">Photo by <a class="ae lw" href="https://unsplash.com/@rovenimages_com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Roven Images</a> on <a class="ae lw" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="e1d6" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">只需几行代码，您就已经完成了数据清理和预处理的基础工作！<a class="ae lw" href="https://github.com/bonn0062/basic_data_preprocessing" rel="noopener ugc nofollow" target="_blank">想看的话可以看这里的</a>代码。</p><p id="3eae" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在这一步，你肯定会有很多想法需要考虑。您需要考虑如何准确地填充缺失的数据。考虑是否需要缩放要素以及如何缩放。虚拟变量还是没有？你会对你的数据进行编码吗？你会编码你的虚拟变量吗？这里有大量的细节需要考虑。</p><p id="b92f" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">也就是说，你有这个！</p><p id="e6b3" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">现在出去把数据准备好！</p><p id="ba76" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">和往常一样，如果你用这些信息做了什么很酷的事情，请在下面的回复中让人们知道，或者随时在 LinkedIn <a class="ae lw" href="https://www.linkedin.com/in/annebonnerdata/" rel="noopener ugc nofollow" target="_blank"> @annebonnerdata </a>上联系！</p><p id="a47c" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">如果你喜欢这篇文章，你可能也会对我的其他文章感兴趣:</p><div class="nf ng gp gr nh ni"><a rel="noopener follow" target="_blank" href="/getting-started-with-git-and-github-6fcd0f2d4ac6"><div class="nj ab fo"><div class="nk ab nl cl cj nm"><h2 class="bd iu gy z fp nn fr fs no fu fw is bi translated">Git 和 GitHub 入门:完全初学者指南</h2><div class="np l"><h3 class="bd b gy z fp nn fr fs no fu fw dk translated">Git 和 GitHub 基础知识，供好奇和完全困惑的人使用(加上最简单的方法来为您的第一次公开…</h3></div><div class="nq l"><p class="bd b dl z fp nn fr fs no fu fw dk translated">towardsdatascience.com</p></div></div><div class="nr l"><div class="ou l nt nu nv nr nw ks ni"/></div></div></a></div><div class="nf ng gp gr nh ni"><a rel="noopener follow" target="_blank" href="/simple-linear-regression-in-four-lines-of-code-d690fe4dba84"><div class="nj ab fo"><div class="nk ab nl cl cj nm"><h2 class="bd iu gy z fp nn fr fs no fu fw is bi translated">机器学习完全入门指南:简单线性回归四行代码！</h2><div class="np l"><h3 class="bd b gy z fp nn fr fs no fu fw dk translated">一个清晰而全面的蓝图，绝对适合任何想要构建简单机器学习模型的人</h3></div><div class="nq l"><p class="bd b dl z fp nn fr fs no fu fw dk translated">towardsdatascience.com</p></div></div><div class="nr l"><div class="ov l nt nu nv nr nw ks ni"/></div></div></a></div><div class="nf ng gp gr nh ni"><a rel="noopener follow" target="_blank" href="/getting-started-with-google-colab-f2fff97f594c"><div class="nj ab fo"><div class="nk ab nl cl cj nm"><h2 class="bd iu gy z fp nn fr fs no fu fw is bi translated">Google Colab 入门</h2><div class="np l"><h3 class="bd b gy z fp nn fr fs no fu fw dk translated">沮丧和困惑的基本教程</h3></div><div class="nq l"><p class="bd b dl z fp nn fr fs no fu fw dk translated">towardsdatascience.com</p></div></div><div class="nr l"><div class="ow l nt nu nv nr nw ks ni"/></div></div></a></div><div class="nf ng gp gr nh ni"><a rel="noopener follow" target="_blank" href="/how-to-create-a-free-github-pages-website-53743d7524e1"><div class="nj ab fo"><div class="nk ab nl cl cj nm"><h2 class="bd iu gy z fp nn fr fs no fu fw is bi translated">如何用 GitHub 毫不费力地免费创建一个网站</h2><div class="np l"><h3 class="bd b gy z fp nn fr fs no fu fw dk translated">GitHub Pages 入门:创建和发布免费作品集的快速简便指南…</h3></div><div class="nq l"><p class="bd b dl z fp nn fr fs no fu fw dk translated">towardsdatascience.com</p></div></div><div class="nr l"><div class="ox l nt nu nv nr nw ks ni"/></div></div></a></div><div class="nf ng gp gr nh ni"><a rel="noopener follow" target="_blank" href="/intro-to-deep-learning-c025efd92535"><div class="nj ab fo"><div class="nk ab nl cl cj nm"><h2 class="bd iu gy z fp nn fr fs no fu fw is bi translated">深度学习简介</h2><div class="np l"><h3 class="bd b gy z fp nn fr fs no fu fw dk translated">新手、新手和新手的神经网络。</h3></div><div class="nq l"><p class="bd b dl z fp nn fr fs no fu fw dk translated">towardsdatascience.com</p></div></div><div class="nr l"><div class="oy l nt nu nv nr nw ks ni"/></div></div></a></div><div class="nf ng gp gr nh ni"><a rel="noopener follow" target="_blank" href="/wtf-is-image-classification-8e78a8235acb"><div class="nj ab fo"><div class="nk ab nl cl cj nm"><h2 class="bd iu gy z fp nn fr fs no fu fw is bi translated">WTF 是图像分类？</h2><div class="np l"><h3 class="bd b gy z fp nn fr fs no fu fw dk translated">为好奇和困惑征服卷积神经网络</h3></div><div class="nq l"><p class="bd b dl z fp nn fr fs no fu fw dk translated">towardsdatascience.com</p></div></div><div class="nr l"><div class="oz l nt nu nv nr nw ks ni"/></div></div></a></div><div class="nf ng gp gr nh ni"><a href="https://medium.freecodecamp.org/how-to-build-the-best-image-classifier-3c72010b3d55" rel="noopener  ugc nofollow" target="_blank"><div class="nj ab fo"><div class="nk ab nl cl cj nm"><h2 class="bd iu gy z fp nn fr fs no fu fw is bi translated">如何构建准确率高于 97%的图像分类器</h2><div class="np l"><h3 class="bd b gy z fp nn fr fs no fu fw dk translated">清晰完整的成功蓝图</h3></div><div class="nq l"><p class="bd b dl z fp nn fr fs no fu fw dk translated">medium.freecodecamp.org</p></div></div><div class="nr l"><div class="pa l nt nu nv nr nw ks ni"/></div></div></a></div><div class="nf ng gp gr nh ni"><a href="https://heartbeat.fritz.ai/brilliant-beginners-guide-to-model-deployment-133e158f6717" rel="noopener  ugc nofollow" target="_blank"><div class="nj ab fo"><div class="nk ab nl cl cj nm"><h2 class="bd iu gy z fp nn fr fs no fu fw is bi translated">出色的模型部署初学者指南</h2><div class="np l"><h3 class="bd b gy z fp nn fr fs no fu fw dk translated">一个清晰简单的路线图，让你的机器学习模型在互联网上，做一些很酷的事情</h3></div><div class="nq l"><p class="bd b dl z fp nn fr fs no fu fw dk translated">heartbeat.fritz.ai</p></div></div><div class="nr l"><div class="pb l nt nu nv nr nw ks ni"/></div></div></a></div><p id="81ff" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">感谢阅读！</p></div></div>    
</body>
</html>