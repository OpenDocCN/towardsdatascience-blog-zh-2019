<html>
<head>
<title>Converting From Keras To PyTorch Lightning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">从喀拉斯转化为 PyTorch 闪电</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/converting-from-keras-to-pytorch-lightning-be40326d7b7d?source=collection_archive---------6-----------------------#2019-12-01">https://towardsdatascience.com/converting-from-keras-to-pytorch-lightning-be40326d7b7d?source=collection_archive---------6-----------------------#2019-12-01</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/2e57d50198ea8c2bcf38b8ccbbdcea1a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_arxJQLyvw3Lr6dOqYgcug.jpeg"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo By: <a class="ae kc" href="https://nicolecrank.com/are-you-enjoying-the-journey/" rel="noopener ugc nofollow" target="_blank">Nicole Crank</a></figcaption></figure><p id="8c5d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本教程中，我们将把一个<a class="ae kc" href="https://www.google.com/search?q=keras&amp;oq=keras&amp;aqs=chrome..69i57j0l3j69i60j69i65.1983j0j7&amp;sourceid=chrome&amp;ie=UTF-8" rel="noopener ugc nofollow" target="_blank"> Keras </a>模型转换成一个<a class="ae kc" href="https://github.com/PyTorchLightning/pytorch-lightning" rel="noopener ugc nofollow" target="_blank"> PyTorch Lightning </a>模型，为你的深度学习忍者技能增加另一项能力。</p><p id="ba74" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Keras 为 Tensorflow 提供了一个极好的高级接口。现在，Keras 用户可以通过一个类似的名为 PyTorch Lightning 的高级界面试用 PyTorch。</p><p id="37c6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然而，Lightning 与 Keras 的不同之处在于，与其说它是一个框架，不如说它是 PyTorch 的风格指南，它为用户(研究人员、学生、制作团队)提供了尝试疯狂想法的终极灵活性，而不必学习另一个框架，同时自动化掉所有的工程细节。</p><p id="02e2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Lightning 与 Keras 的不同之处在于:</p><ol class=""><li id="c485" class="lb lc iq kf b kg kh kk kl ko ld ks le kw lf la lg lh li lj bi translated">它不是一个框架，更像是一个风格指南。</li><li id="42be" class="lb lc iq kf b kg lk kk ll ko lm ks ln kw lo la lg lh li lj bi translated">Lightning 没有隐藏网络和优化设计的细节。</li><li id="f8e0" class="lb lc iq kf b kg lk kk ll ko lm ks ln kw lo la lg lh li lj bi translated">Lightning 自动化了所有工程，如提前停止、多 GPU 训练、多节点训练等…</li><li id="5542" class="lb lc iq kf b kg lk kk ll ko lm ks ln kw lo la lg lh li lj bi translated">Lightning 为研究人员和生产团队提供了极大的灵活性，他们可能需要跨多个 GPU 进行负采样或建立自己的分布式环境。</li></ol></div><div class="ab cl lp lq hu lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="ij ik il im in"><h1 id="4b8d" class="lw lx iq bd ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt bi translated">为什么要学 PyTorch 闪电？</h1><p id="323e" class="pw-post-body-paragraph kd ke iq kf b kg mu ki kj kk mv km kn ko mw kq kr ks mx ku kv kw my ky kz la ij bi translated">根据您团队的需求，能够同时使用 Tensorflow 和 PyTorch 是非常有用的。Lightning 的用户喜欢这个框架的灵活性。他们可以让事情变得非常简单，或者将训练行为修改为如何完成后退的步骤。</p><p id="0583" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这种简单性和最大复杂性的平衡(对于那些需要它的人来说)使得 Lightning 成为一个独特的框架，使得用 PyTorch 进行生产和原型设计变得非常容易。</p><p id="e3be" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">事实上，它甚至使深度学习研究更具可重复性(查看<a class="ae kc" href="https://reproducibility-challenge.github.io/neurips2019/resources/" rel="noopener ugc nofollow" target="_blank"> NeurIPS 可重复性挑战</a>)！</p></div><div class="ab cl lp lq hu lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="ij ik il im in"><h1 id="8dfe" class="lw lx iq bd ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt bi translated">你好，在喀拉斯的 MNIST</h1><figure class="na nb nc nd gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mz"><img src="../Images/60a19b50a9295196ab0dba9c40e35bb9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*5E45j3PQ0-WV6eVE.png"/></div></div></figure><p id="154b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">要了解如何转换项目的核心，让我们看看典型的 MNIST·克雷斯的例子。</p><figure class="na nb nc nd gt jr"><div class="bz fp l di"><div class="ne nf l"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Source: <a class="ae kc" href="https://keras.io/examples/mnist_cnn/" rel="noopener ugc nofollow" target="_blank">Keras documentation</a></figcaption></figure><p id="7508" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这段代码可以分成几个部分。</p><p id="1ffb" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">第一节:进口</strong></p><p id="22be" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">第二部分:数据加载</strong></p><p id="420a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">第 3 节:模型定义</strong></p><p id="e992" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">第四节:</strong> <strong class="kf ir">培训</strong></p><p id="809e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">第 5 节:测试</strong></p><p id="f26c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">上面的每个部分都有一个 PyTorch 闪电的等价物。但是在 Lightning 中，代码是在一个特定的接口中构建的，其中每个函数负责上面的一个部分。</p></div><div class="ab cl lp lq hu lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="ij ik il im in"><h1 id="6c7d" class="lw lx iq bd ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt bi translated"><strong class="ak">照明模块</strong></h1><figure class="na nb nc nd gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ng"><img src="../Images/34370825bcf283fa7a2bed8cc154aaf9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*whwii3-a25YANs5t5Tyivg.png"/></div></div></figure><p id="ad7e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">每一个研究想法都在不同的<a class="ae kc" href="https://pytorch-lightning.readthedocs.io/en/0.6.0/lightning-module.html" rel="noopener ugc nofollow" target="_blank">照明模块</a>中实现。这是与 LightningModule 相同的 Keras 示例。</p><div class="nh ni gp gr nj nk"><a href="https://pytorch-lightning.readthedocs.io/en/0.6.0/lightning-module.html" rel="noopener  ugc nofollow" target="_blank"><div class="nl ab fo"><div class="nm ab nn cl cj no"><h2 class="bd ir gy z fp np fr fs nq fu fw ip bi translated">Lightning module-py torch-Lightning 0 . 6 . 0 文档</h2><div class="nr l"><h3 class="bd b gy z fp np fr fs nq fu fw dk translated">LightningModule 是 torch.nn.Module 的严格超类，但它提供了一个接口来标准化“成分”…</h3></div><div class="ns l"><p class="bd b dl z fp np fr fs nq fu fw dk translated">py torch-lightning . readthedocs . io</p></div></div></div></a></div><p id="89ba" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">虽然表面上看起来更冗长，但是增加的行让您可以更深入地控制正在发生的事情。请注意以下事项:</p><ol class=""><li id="49ca" class="lb lc iq kf b kg kh kk kl ko ld ks le kw lf la lg lh li lj bi translated">通过 PyTorch 的美丽，现在你可以在前进的步骤中调试模型的流程。</li></ol><figure class="na nb nc nd gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nt"><img src="../Images/674bc81fba42a012abda7764fe70896f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1_eTZO_1t5bpMh6DoRDjVg.png"/></div></div></figure><p id="88a4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">事实上，您甚至可以通过改变调试器中的输入来尝试在<strong class="kf ir">实时</strong>中进行实验。在这种情况下，我们只想看看第二层之后的维度会发生什么，所以在调试器中，我们提供了一个张量，其中包含我们想要测试的维度。</p><figure class="na nb nc nd gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nu"><img src="../Images/93e93116325fe73ef41c7769958d0788.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1nshZyr7LGLfA1OEx99cXQ.png"/></div></div></figure><p id="c5d7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">2.训练步骤、验证步骤和测试步骤中发生的事情是分离的。例如，我们可以计算验证步骤的准确性，但不能计算训练步骤的准确性。</p><p id="3c11" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果我们在做机器翻译之类的事情，我们可以在验证步骤中进行波束搜索来生成样本。</p><p id="2e19" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">3.数据加载被很好地抽象在数据加载器之后。</p><p id="0af1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">4.代码是标准的！如果一个项目使用了 Lightning，您可以通过查看任何项目的培训步骤来了解正在发生的事情的核心！这是朝着帮助实现更多可复制的深度学习代码迈出的令人难以置信的一步。</p><p id="7ad4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">5.这个代码是纯 PyTorch！上面没有抽象…这意味着你可以随心所欲地编写代码。</p><p id="a9a5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">总之，LightningModule 集合了我们构建深度学习系统所需的核心成分:</p><ol class=""><li id="c959" class="lb lc iq kf b kg kh kk kl ko ld ks le kw lf la lg lh li lj bi translated">计算(初始化，向前)。</li><li id="a9a3" class="lb lc iq kf b kg lk kk ll ko lm ks ln kw lo la lg lh li lj bi translated">训练循环(training_step)中会发生什么。</li><li id="e6c3" class="lb lc iq kf b kg lk kk ll ko lm ks ln kw lo la lg lh li lj bi translated">验证循环中发生了什么(validation_step)。</li><li id="8a35" class="lb lc iq kf b kg lk kk ll ko lm ks ln kw lo la lg lh li lj bi translated">测试循环中发生了什么(test_step)。</li><li id="4f2b" class="lb lc iq kf b kg lk kk ll ko lm ks ln kw lo la lg lh li lj bi translated">要使用的优化器(configure _ optimizers)。</li><li id="6e04" class="lb lc iq kf b kg lk kk ll ko lm ks ln kw lo la lg lh li lj bi translated">要使用的数据(训练、测试、评估数据加载器)。</li></ol></div><div class="ab cl lp lq hu lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="ij ik il im in"><h1 id="0f2f" class="lw lx iq bd ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt bi translated">运动鞋</h1><p id="410d" class="pw-post-body-paragraph kd ke iq kf b kg mu ki kj kk mv km kn ko mw kq kr ks mx ku kv kw my ky kz la ij bi translated">请注意，LightningModule 没有任何关于 GPU 或 16 位精度或早期停止或日志记录或任何类似的东西…所有这些都是由培训师自动处理的。</p><figure class="na nb nc nd gt jr"><div class="bz fp l di"><div class="ne nf l"/></div></figure><p id="6df2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这就是训练这个模型的全部！培训师为您处理所有事情，包括:</p><ol class=""><li id="ba8a" class="lb lc iq kf b kg kh kk kl ko ld ks le kw lf la lg lh li lj bi translated">提前停止</li><li id="4cbc" class="lb lc iq kf b kg lk kk ll ko lm ks ln kw lo la lg lh li lj bi translated">自动记录到 tensorboard(或 comet、mlflow 等)</li><li id="e46a" class="lb lc iq kf b kg lk kk ll ko lm ks ln kw lo la lg lh li lj bi translated">自动检查点</li></ol><figure class="na nb nc nd gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nv"><img src="../Images/b404527ceaa216cdd02b4f383a4a5585.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4qr1xtr6N8AMRbTiE1PSHA.png"/></div></div></figure><p id="4315" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果你照原样运行训练器，你会注意到一个名为<strong class="kf ir"> <em class="nw"> lightning_logs </em> </strong>的文件夹，你可以从中运行一个 tensorboard 会话:)</p><pre class="na nb nc nd gt nx ny nz oa aw ob bi"><span id="f1ea" class="oc lx iq ny b gy od oe l of og">tensorboard — logdir=./lightning_logs</span></pre><figure class="na nb nc nd gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi oh"><img src="../Images/a0ccc693594164c3da654e119aa82d33.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MXU8MCfP6wFnwTU-_S9J_g.png"/></div></div></figure><p id="f554" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">所有这些都是免费的！</p><p id="a168" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">事实上，Lightning 添加了一个漂亮的文本窗口，向您显示在这个特定的实验中使用了哪些参数。只要将 hparams 参数传递给 LightningModule，您就可以免费获得它。</p><figure class="na nb nc nd gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi oi"><img src="../Images/2fae657b7c95cc215516b1691f945cc3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*n_TAyy9FpM96SsOiqh04PA.png"/></div></div></figure><p id="3016" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，模型的每次运行都确切地知道它使用了什么超参数！</p></div><div class="ab cl lp lq hu lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="ij ik il im in"><h1 id="bb92" class="lw lx iq bd ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt bi translated">GPU 培训</h1><p id="3a4d" class="pw-post-body-paragraph kd ke iq kf b kg mu ki kj kk mv km kn ko mw kq kr ks mx ku kv kw my ky kz la ij bi translated">闪电让 GPU 和多 GPU 训练变得琐碎。例如，如果您想在多个 GPU 上训练上述示例，只需向训练器添加以下标志:</p><figure class="na nb nc nd gt jr"><div class="bz fp l di"><div class="ne nf l"/></div></figure><p id="0d56" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">使用上述标志将在 4 个 GPU 上运行该模型。</p><p id="8676" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果您想在 16 个 GPU 上运行，其中有 4 台机器，每台机器有 4 个 GPU，请将教练标志更改为:</p><figure class="na nb nc nd gt jr"><div class="bz fp l di"><div class="ne nf l"/></div></figure><p id="f71e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">并提交以下 SLURM 作业:</p><figure class="na nb nc nd gt jr"><div class="bz fp l di"><div class="ne nf l"/></div></figure></div><div class="ab cl lp lq hu lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="ij ik il im in"><h1 id="f7a7" class="lw lx iq bd ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt bi translated">高级用途</h1><p id="ce58" class="pw-post-body-paragraph kd ke iq kf b kg mu ki kj kk mv km kn ko mw kq kr ks mx ku kv kw my ky kz la ij bi translated">对于学生，以及对深度学习有所了解的人来说，Lightning 非常容易使用。然而，对于高级用户，如研究人员和生产团队，Lightning 给你更多的控制。</p><p id="55b1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，您可以这样做:</p><ol class=""><li id="1ac3" class="lb lc iq kf b kg kh kk kl ko ld ks le kw lf la lg lh li lj bi translated"><a class="ae kc" href="https://pytorch-lightning.readthedocs.io/en/latest/LightningModule/properties/#gradient_clip_val" rel="noopener ugc nofollow" target="_blank">渐变裁剪</a></li></ol><pre class="na nb nc nd gt nx ny nz oa aw ob bi"><span id="b178" class="oc lx iq ny b gy od oe l of og">Trainer(gradient_clip_val=2.0)</span></pre><p id="5d45" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">2.<a class="ae kc" href="https://pytorch-lightning.readthedocs.io/en/latest/Trainer/Training%20Loop/" rel="noopener ugc nofollow" target="_blank">累积梯度</a></p><pre class="na nb nc nd gt nx ny nz oa aw ob bi"><span id="4a67" class="oc lx iq ny b gy od oe l of og">Trainer(accumulate_grad_batches=12)</span></pre><p id="0be9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">3.16 位精度</p><pre class="na nb nc nd gt nx ny nz oa aw ob bi"><span id="c3ea" class="oc lx iq ny b gy od oe l of og">Trainer(use_amp=True)</span></pre><p id="58d7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">4.<a class="ae kc" href="https://pytorch-lightning.readthedocs.io/en/latest/Trainer/Training%20Loop/#truncated-backpropagation-through-time" rel="noopener ugc nofollow" target="_blank">截断反向传播通过时间</a></p><pre class="na nb nc nd gt nx ny nz oa aw ob bi"><span id="1fac" class="oc lx iq ny b gy od oe l of og">Trainer(truncated_bptt_steps=3)</span></pre><p id="ddf7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">还有关于<a class="ae kc" href="https://github.com/williamFalcon/pytorch-lightning#lightning-automates-all-of-the-following-each-is-also-configurable" rel="noopener ugc nofollow" target="_blank"> 42 更高级的特性</a> …</p></div><div class="ab cl lp lq hu lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="ij ik il im in"><h1 id="f368" class="lw lx iq bd ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt bi translated">高级使用++语言</h1><p id="5f0e" class="pw-post-body-paragraph kd ke iq kf b kg mu ki kj kk mv km kn ko mw kq kr ks mx ku kv kw my ky kz la ij bi translated">但是也许你需要更多的灵活性。在这种情况下，您可以这样做:</p><ol class=""><li id="6265" class="lb lc iq kf b kg kh kk kl ko ld ks le kw lf la lg lh li lj bi translated"><a class="ae kc" href="https://pytorch-lightning.readthedocs.io/en/latest/Trainer/hooks/#backward" rel="noopener ugc nofollow" target="_blank">改变后退步骤的完成方式</a>。</li><li id="3352" class="lb lc iq kf b kg lk kk ll ko lm ks ln kw lo la lg lh li lj bi translated"><a class="ae kc" href="https://pytorch-lightning.readthedocs.io/en/latest/Trainer/hooks/#configure_apex" rel="noopener ugc nofollow" target="_blank">改变 16 位的初始化方式</a>。</li><li id="197a" class="lb lc iq kf b kg lk kk ll ko lm ks ln kw lo la lg lh li lj bi translated"><a class="ae kc" href="https://pytorch-lightning.readthedocs.io/en/latest/Trainer/hooks/#configure_ddp" rel="noopener ugc nofollow" target="_blank">添加您自己的分布式培训方式。</a></li><li id="1a90" class="lb lc iq kf b kg lk kk ll ko lm ks ln kw lo la lg lh li lj bi translated"><a class="ae kc" href="https://williamfalcon.github.io/pytorch-lightning/LightningModule/RequiredTrainerInterface/#configure_optimizers" rel="noopener ugc nofollow" target="_blank">添加学习率调度器</a>。</li><li id="cf3d" class="lb lc iq kf b kg lk kk ll ko lm ks ln kw lo la lg lh li lj bi translated"><a class="ae kc" href="https://williamfalcon.github.io/pytorch-lightning/LightningModule/RequiredTrainerInterface/#configure_optimizers" rel="noopener ugc nofollow" target="_blank">使用多个优化器</a>。</li><li id="cde6" class="lb lc iq kf b kg lk kk ll ko lm ks ln kw lo la lg lh li lj bi translated">更改优化器更新的频率。</li></ol><p id="f9ed" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">还有很多很多东西。在引擎盖下，Lightning 中的所有东西都被<a class="ae kc" href="https://williamfalcon.github.io/pytorch-lightning/Trainer/hooks/" rel="noopener ugc nofollow" target="_blank">实现为可以被用户覆盖的钩子</a>。这使得<strong class="kf ir">培训的每个</strong>方面都具有高度的可配置性——这正是研究或生产团队需要的灵活性。</p></div><div class="ab cl lp lq hu lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="ij ik il im in"><h1 id="9f35" class="lw lx iq bd ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt bi translated">摘要</h1><p id="8c22" class="pw-post-body-paragraph kd ke iq kf b kg mu ki kj kk mv km kn ko mw kq kr ks mx ku kv kw my ky kz la ij bi translated">本教程解释了如何将 Keras 模型转换为 PyTorch Lightning，以供想要尝试 PyTorch 或寻求更大灵活性的用户使用。</p><p id="eed1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">闪电的关键在于:</p><ol class=""><li id="99b3" class="lb lc iq kf b kg kh kk kl ko ld ks le kw lf la lg lh li lj bi translated">对于 PyTorch 来说，它不是一个框架，而更像是一个风格指南。这是因为闪电暴露了核心 PyTorch，而不是将其抽象掉。</li><li id="442e" class="lb lc iq kf b kg lk kk ll ko lm ks ln kw lo la lg lh li lj bi translated">通过使用 Lightning 格式，您可以消除工程上的复杂性，并使您的代码具有可复制性。</li><li id="39f0" class="lb lc iq kf b kg lk kk ll ko lm ks ln kw lo la lg lh li lj bi translated">对于新用户来说，Lightning 可能非常简单，但对于即使是最高级的研究团队来说，它也非常灵活。</li><li id="bfe6" class="lb lc iq kf b kg lk kk ll ko lm ks ln kw lo la lg lh li lj bi translated">虽然我们展示了一个 MNIST 的例子，但是 Lightning 可以实现任意复杂的方法。<a class="ae kc" href="https://colab.research.google.com/drive/1F_RNcHzTfFuQf-LeKvSlud6x7jXYkG31#scrollTo=HOk9c4_35FKg" rel="noopener ugc nofollow" target="_blank">看看这个可乐罐</a>！</li></ol></div></div>    
</body>
</html>