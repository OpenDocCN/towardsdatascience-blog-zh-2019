<html>
<head>
<title>Analysis of Boston Crime Incident Open Data Using Pandas</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用 Pandas 分析波士顿犯罪事件公开数据</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/analysis-of-boston-crime-incident-open-data-using-pandas-5ff2fd6e3254?source=collection_archive---------9-----------------------#2019-07-20">https://towardsdatascience.com/analysis-of-boston-crime-incident-open-data-using-pandas-5ff2fd6e3254?source=collection_archive---------9-----------------------#2019-07-20</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/5e7b82f03e402ceca93204449845f061.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oVzQ3kMf-jgzyXUPAbO4nA.jpeg"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk"><a class="ae kf" href="https://pixabay.com/photos/panda-china-bamboo-zoo-bear-3857754/" rel="noopener ugc nofollow" target="_blank">Pixabay.com</a></figcaption></figure><p id="c3dd" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">当我在 Python 中使用<a class="ae kf" href="https://pandas.pydata.org/pandas-docs/stable/user_guide/index.html" rel="noopener ugc nofollow" target="_blank"> Pandas </a>学习数据分析时，我对分析我目前居住的城市的开放数据很感兴趣。</p><p id="ff8e" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">开放数据为人们提供了无数的机会，让他们随心所欲、不受限制地使用和分析数据。通过查看一个城市的犯罪事件公开数据，您可以了解这个城市或特定社区是否安全。因此，我使用波士顿犯罪事件报告的公开数据，通过使用 Pandas 来分析和可视化它们。希望你看完我的经历，能对获取、分析、可视化开放数据有更好的理解。</p></div><div class="ab cl le lf hx lg" role="separator"><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj"/></div><div class="im in io ip iq"><h1 id="722b" class="ll lm it bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">获取数据</h1><ul class=""><li id="d227" class="mj mk it ki b kj ml kn mm kr mn kv mo kz mp ld mq mr ms mt bi translated">首先我去<a class="ae kf" href="https://data.boston.gov/" rel="noopener ugc nofollow" target="_blank"> <em class="mu">分析波士顿</em> </a> <em class="mu"> : </em>一个波士顿开放数据网站。搜索“犯罪”并转到<a class="ae kf" href="https://data.boston.gov/dataset/crime-incident-reports-august-2015-to-date-source-new-system" rel="noopener ugc nofollow" target="_blank">犯罪事件报告</a></li></ul><figure class="mw mx my mz gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mv"><img src="../Images/ff3ae7987a4debede0d220571f0273ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ThzuBRD6ycPSiLoshHStfA.png"/></div></div></figure><ul class=""><li id="4bf2" class="mj mk it ki b kj kk kn ko kr na kv nb kz nc ld mq mr ms mt bi translated">为了获得数据，我复制了下载 csv 格式数据的链接:</li></ul><pre class="mw mx my mz gt nd ne nf ng aw nh bi"><span id="71ae" class="ni lm it ne b gy nj nk l nl nm">url = “<a class="ae kf" href="https://data.boston.gov/dataset/6220d948-eae2-4e4b-8723-2dc8e67722a3/resource/12cb3883-56f5-47de-afa5-3b1cf61b257b/download/tmppj4rb047.csv" rel="noopener ugc nofollow" target="_blank">https://data.boston.gov/dataset/6220d948-eae2-4e4b-8723-2dc8e67722a3/resource/12cb3883-56f5-47de-afa5-3b1cf61b257b/download/tmppj4rb047.csv</a>”</span></pre><ul class=""><li id="5e72" class="mj mk it ki b kj kk kn ko kr na kv nb kz nc ld mq mr ms mt bi translated">使用<code class="fe nn no np ne b">wget</code>命令下载数据。</li></ul><figure class="mw mx my mz gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nq"><img src="../Images/e60fb92acff52b1669c0dad7593b2942.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*du9p1ib0bexMFhfIdM9Rrg.png"/></div></div></figure><ul class=""><li id="18ba" class="mj mk it ki b kj kk kn ko kr na kv nb kz nc ld mq mr ms mt bi translated">进口熊猫</li></ul><p id="34b5" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><code class="fe nn no np ne b">import pandas as pd</code></p><ul class=""><li id="8911" class="mj mk it ki b kj kk kn ko kr na kv nb kz nc ld mq mr ms mt bi translated">使用熊猫中的<code class="fe nn no np ne b">read_csv</code>读取数据并保存到数据框中</li></ul><p id="53b6" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><code class="fe nn no np ne b">df = pd.read_csv('tmppj4rb047.csv')</code></p><ul class=""><li id="d0ea" class="mj mk it ki b kj kk kn ko kr na kv nb kz nc ld mq mr ms mt bi translated">检查是否成功获取数据。</li></ul><p id="8770" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><code class="fe nn no np ne b">df.head()</code></p><figure class="mw mx my mz gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nr"><img src="../Images/776fb538e783d58bdc05fb1d094fa74f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ds6_bbzLbPRivTA6Wbu38w.png"/></div></div></figure></div><div class="ab cl le lf hx lg" role="separator"><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj"/></div><div class="im in io ip iq"><h1 id="8029" class="ll lm it bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">数据分析</h1><h2 id="a9d9" class="ni lm it bd ln ns nt dn lr nu nv dp lv kr nw nx lz kv ny nz md kz oa ob mh oc bi translated">1.犯罪类型</h2><p id="a076" class="pw-post-body-paragraph kg kh it ki b kj ml kl km kn mm kp kq kr od kt ku kv oe kx ky kz of lb lc ld im bi translated">获得数据后，我想知道波士顿有多少种犯罪类型。</p><ul class=""><li id="de51" class="mj mk it ki b kj kk kn ko kr na kv nb kz nc ld mq mr ms mt bi translated">在熊猫身上用<code class="fe nn no np ne b">value_counts</code>。</li></ul><p id="2461" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><code class="fe nn no np ne b">value_counts</code>帮助统计不同类型犯罪的出现次数，并进行排序。</p><pre class="mw mx my mz gt nd ne nf ng aw nh bi"><span id="0b96" class="ni lm it ne b gy nj nk l nl nm">df.OFFENSE_CODE_GROUP.value_counts().iloc[:10]</span></pre><p id="08cb" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">为了便于展示，我只要求返回前十个结果。</p><figure class="mw mx my mz gt ju gh gi paragraph-image"><div class="gh gi og"><img src="../Images/f72cf8ed92cf060ecbf47c490fd357cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1128/format:webp/1*cMuQe-A6i5NU4Uz7T9XIbQ.png"/></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk">Top 10 Crime Incidents in Boston</figcaption></figure><p id="3d94" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在这里，我们可以看到波士顿发生最频繁的犯罪事件是“机动车事故反应”，“盗窃”也发生得非常频繁。</p><p id="836c" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后，为了更好的可视化，我绘制了结果。</p><pre class="mw mx my mz gt nd ne nf ng aw nh bi"><span id="84f0" class="ni lm it ne b gy nj nk l nl nm">df.OFFENSE_CODE_GROUP.value_counts().iloc[:10].sort_values().plot(kind= “barh”)</span></pre><figure class="mw mx my mz gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi oh"><img src="../Images/0363c3df8cffef5632804e6f4e2f18f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pT18BXm60-YbG9Ft__DGVg.png"/></div></div></figure><h2 id="36d1" class="ni lm it bd ln ns nt dn lr nu nv dp lv kr nw nx lz kv ny nz md kz oa ob mh oc bi translated">2.分析具体的犯罪</h2><p id="70d5" class="pw-post-body-paragraph kg kh it ki b kj ml kl km kn mm kp kq kr od kt ku kv oe kx ky kz of lb lc ld im bi translated">我想具体分析一下波士顿的盗窃罪。因此，我将数据帧中包含盗窃的部分放到另一个数据帧中，并将其称为“盗窃”</p><pre class="mw mx my mz gt nd ne nf ng aw nh bi"><span id="33f5" class="ni lm it ne b gy nj nk l nl nm">larceny = df[df.OFFENSE_CODE_GROUP.str.contains(“Larceny”)]<br/>larceny.head()</span></pre><figure class="mw mx my mz gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi oi"><img src="../Images/b1590cf1bb4893042f39fc65d0e56275.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lfyeiZjI1-GVaFa4jwQcmg.png"/></div></div></figure><ul class=""><li id="dfab" class="mj mk it ki b kj kk kn ko kr na kv nb kz nc ld mq mr ms mt bi translated">检查“盗窃”数据的大小</li></ul><pre class="mw mx my mz gt nd ne nf ng aw nh bi"><span id="4616" class="ni lm it ne b gy nj nk l nl nm">larceny.shape() </span></pre><figure class="mw mx my mz gt ju gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/079fb9a70962b9b191bd3ffe1e85f16f.png" data-original-src="https://miro.medium.com/v2/resize:fit:678/format:webp/1*TyzVlIyu0aFp3Cxnlz_qkA.png"/></div></figure><p id="0ac6" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">盗窃事件记录 17961 条，每条记录 17 列。</p><h2 id="e836" class="ni lm it bd ln ns nt dn lr nu nv dp lv kr nw nx lz kv ny nz md kz oa ob mh oc bi translated">3.分析地点</h2><p id="1370" class="pw-post-body-paragraph kg kh it ki b kj ml kl km kn mm kp kq kr od kt ku kv oe kx ky kz of lb lc ld im bi translated">我想知道波士顿不同地点的犯罪事件数据，更具体地说，波士顿哪些地方更危险。</p><p id="d54b" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我用熊猫里的<code class="fe nn no np ne b">groupby</code>函数对犯罪地点类型进行分组，用<code class="fe nn no np ne b">size</code>函数查看条目数量。</p><pre class="mw mx my mz gt nd ne nf ng aw nh bi"><span id="3bb6" class="ni lm it ne b gy nj nk l nl nm">larceny.groupby(“STREET”).size().sort_values(ascending = False)</span></pre><figure class="mw mx my mz gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi ok"><img src="../Images/b54d287b618ac076efb19cad4403412f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PkfzsaQgPTzwwtpLgV3UwA.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk">First few entires of the result</figcaption></figure><p id="42cb" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">查看结果，我们可以看到波士顿盗窃案发生率较高的地点是华盛顿街、博伊尔斯顿街和纽伯里街。</p><figure class="mw mx my mz gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi ol"><img src="../Images/9a8cd812570b63b6cf7a243bc8a9f0e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*C6mN-0c0_By1hHOs63cC1w.png"/></div></div></figure><h2 id="ac01" class="ni lm it bd ln ns nt dn lr nu nv dp lv kr nw nx lz kv ny nz md kz oa ob mh oc bi translated">4.分析时间</h2><p id="0a10" class="pw-post-body-paragraph kg kh it ki b kj ml kl km kn mm kp kq kr od kt ku kv oe kx ky kz of lb lc ld im bi translated">我还想知道波士顿盗窃事件的趋势。</p><pre class="mw mx my mz gt nd ne nf ng aw nh bi"><span id="b513" class="ni lm it ne b gy nj nk l nl nm">larceny.groupby(“MONTH”).size().plot(kind = “bar”)</span></pre><figure class="mw mx my mz gt ju gh gi paragraph-image"><div class="gh gi om"><img src="../Images/2c7a5aa07bc01b99e66c59d955eafa3c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1230/format:webp/1*aK_dnPKJgPbIu-8KGSRRqg.png"/></div></figure><p id="cf21" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">根据我计算的柱状图，盗窃在 5 月、6 月和 12 月发生最多，而 9 月、10 月和 8 月似乎更安全。</p><p id="b386" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们看看盗窃事件的数量在一天内是如何变化的。</p><pre class="mw mx my mz gt nd ne nf ng aw nh bi"><span id="2ee4" class="ni lm it ne b gy nj nk l nl nm">larceny.groupby(“HOUR”).size().plot(kind= “bar”) </span></pre><figure class="mw mx my mz gt ju gh gi paragraph-image"><div class="gh gi on"><img src="../Images/3a633832f4a36c1ec2be4f92080c02a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1228/format:webp/1*4TbiWr4tMaI1sObKpgo4bg.png"/></div></figure><p id="d273" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在这里，我们可以告诉你波士顿一天中最不容易发生盗窃的时间是凌晨 5 点。然而，人们需要在下午 4 点到 6 点更加小心。</p><p id="ccd6" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在，我想全面了解一下波士顿每月和 24 小时内的盗窃事件数据。由于 2019 年还没有结束，数据不完整，我们具体看一下 2018 年的数据。</p><p id="f47c" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果我们在熊猫中使用<code class="fe nn no np ne b">groupby</code>对月和小时进行分组，我们会得到以下结果。</p><pre class="mw mx my mz gt nd ne nf ng aw nh bi"><span id="129c" class="ni lm it ne b gy nj nk l nl nm">larceny[larceny.YEAR == 2019].groupby([‘MONTH’, ‘HOUR’]).size()</span></pre><figure class="mw mx my mz gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nq"><img src="../Images/d172ab16a73ddf0ea28f7bdced01485f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*28GujO0tpp08Tq8GYwv0aw.png"/></div></div></figure><p id="26a6" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">但是，这对我们轻松读取数据没有帮助。为了使它更好，我使用了<code class="fe nn no np ne b">unstack</code>，这将把结果转换成可读性更好的形式。</p><pre class="mw mx my mz gt nd ne nf ng aw nh bi"><span id="558a" class="ni lm it ne b gy nj nk l nl nm">larceny[larceny.YEAR==2018].groupby([‘MONTH’,’HOUR’]).size().unstack(0)</span></pre><figure class="mw mx my mz gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi oo"><img src="../Images/c0fb126ff8461e5687d1a11722e648fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mNZy9i6g5VcETbFgLrWs1w.png"/></div></div></figure><p id="dd97" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在，我想把结果可视化。</p><p id="fb70" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">因为我将 12 个月的数据可视化为 12 张图表，所以我想使用分面图。在熊猫的<code class="fe nn no np ne b">plot</code>中有一个参数叫做<code class="fe nn no np ne b">subplots</code>。初始化为<code class="fe nn no np ne b">True</code>。我还可以通过使用<code class="fe nn no np ne b">figsize</code>来调整图形的长度和宽度。</p><pre class="mw mx my mz gt nd ne nf ng aw nh bi"><span id="4da5" class="ni lm it ne b gy nj nk l nl nm">larceny[larceny.YEAR==2018].groupby([‘MONTH’,’HOUR’]).size().unstack(0).plot(subplots=True, kind = “bar”, figsize = (5, 30)</span></pre><figure class="mw mx my mz gt ju gh gi paragraph-image"><div class="gh gi op"><img src="../Images/a05e2ba8d973899f1b75d74bd9cf559f.png" data-original-src="https://miro.medium.com/v2/resize:fit:756/format:webp/1*lLGmFvqvHIpk-e5UJDXsiw.png"/></div></figure><figure class="mw mx my mz gt ju gh gi paragraph-image"><div class="gh gi oq"><img src="../Images/3ad4aaed40ed53e80844a07ac74d1fa5.png" data-original-src="https://miro.medium.com/v2/resize:fit:664/format:webp/1*ZqYaJJyb825fqOTShrBdhg.png"/></div></figure><figure class="mw mx my mz gt ju gh gi paragraph-image"><div class="gh gi or"><img src="../Images/ecce1b4817feee6fee29c1ecf78d81b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:680/format:webp/1*OuE55jiScE8fX8suGSVUog.png"/></div></figure><figure class="mw mx my mz gt ju gh gi paragraph-image"><div class="gh gi os"><img src="../Images/78d36b614da3b3ced43d07138ccf9aeb.png" data-original-src="https://miro.medium.com/v2/resize:fit:646/format:webp/1*4aeJ6ZpT3nIHFWkuV-c7zQ.png"/></div></figure><figure class="mw mx my mz gt ju gh gi paragraph-image"><div class="gh gi ot"><img src="../Images/ff7b9fd317efed9d1a15a5cb40a19736.png" data-original-src="https://miro.medium.com/v2/resize:fit:630/format:webp/1*DICjA9d4IIY5xo-InDGYfA.png"/></div></figure><figure class="mw mx my mz gt ju gh gi paragraph-image"><div class="gh gi ou"><img src="../Images/90061f022e85313eb2a1608bbc391812.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*8ktfiTZS1nSZl8bUKAIc-A.png"/></div></figure><p id="0aae" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在，我们对 2018 年发生在波士顿的盗窃事件有了完整的可视化。</p></div><div class="ab cl le lf hx lg" role="separator"><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj"/></div><div class="im in io ip iq"><h1 id="6582" class="ll lm it bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">摘要</h1><p id="8d4b" class="pw-post-body-paragraph kg kh it ki b kj ml kl km kn mm kp kq kr od kt ku kv oe kx ky kz of lb lc ld im bi translated">通过使用 Pandas，我分析并可视化了波士顿犯罪事件报告的公开数据。在提取、分组、排序、分析和绘制数据方面，Pandas 确实是一个非常强大的 Python 包。如果你对数据分析感兴趣，使用熊猫来分析一些真实的数据集是一个很好的开始。</p></div></div>    
</body>
</html>