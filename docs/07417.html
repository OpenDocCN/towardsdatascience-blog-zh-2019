<html>
<head>
<title>How To Save And Share your Machine Learning Models (Plus More), All With One File</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何通过一个文件保存和共享您的机器学习模型(以及更多)</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-save-and-share-your-machine-learning-models-plus-more-all-with-one-file-a2536dd38883?source=collection_archive---------14-----------------------#2019-10-17">https://towardsdatascience.com/how-to-save-and-share-your-machine-learning-models-plus-more-all-with-one-file-a2536dd38883?source=collection_archive---------14-----------------------#2019-10-17</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/f9b4b6332c03348095d1e67c86d441d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xM0cm-4QytYP16py6E1Nkw.jpeg"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk">Photo by <a class="ae jg" href="https://unsplash.com/@jonathanpielmayer?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Jonathan Pielmayer</a></figcaption></figure><div class=""/><div class=""><h2 id="db36" class="pw-subtitle-paragraph kg ji jj bd b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dk translated">忘记模块导入。只需一行代码，您就可以在一个 Python 文件中存储和分发经过训练的 ML 模型等。</h2></div></div><div class="ab cl ky kz hx la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="im in io ip iq"><p id="b753" class="pw-post-body-paragraph lf lg jj lh b li lj kk lk ll lm kn ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">在处理机器学习模型时，通常建议您将它们存储在某个地方。在私营部门，您经常在生产前培训和存储它们，而在研究和未来的模型调整中，在本地存储它们是一个好主意。我总是使用令人惊讶的 Python 模块<a class="ae jg" href="https://machinelearningmastery.com/save-load-machine-learning-models-python-scikit-learn/" rel="noopener ugc nofollow" target="_blank"> pickle </a>来做这件事。</p><p id="ec45" class="pw-post-body-paragraph lf lg jj lh b li lj kk lk ll lm kn ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">我最近发现了一个有用的窍门。您不仅可以存储模型，还可以将整个函数和变量<strong class="lh jk">都存储在同一个文件</strong>中！当你想和其他人分享你的模型，但是你知道那个人不一定安装了所有需要的模块/功能，或者只是不具备这样做的专业知识时，这就特别方便了。他们只是想在一台具有基本 Python 环境的计算机上运行该算法以查看结果。</p><p id="6423" class="pw-post-body-paragraph lf lg jj lh b li lj kk lk ll lm kn ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">我将在这里向你展示如何做这个简单的把戏。</p></div><div class="ab cl ky kz hx la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="im in io ip iq"><p id="ad1c" class="pw-post-body-paragraph lf lg jj lh b li lj kk lk ll lm kn ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">假设在您的本地计算机中，为了进行分类分析，您首先加载这些 sklearn 和 numpy 模块:</p><pre class="mb mc md me gt mf mg mh mi aw mj bi"><span id="5211" class="mk ml jj mg b gy mm mn l mo mp">from sklearn.metrics import accuracy_score, f1_score<br/>from sklearn import svm<br/>from numpy import average</span></pre><p id="c1b8" class="pw-post-body-paragraph lf lg jj lh b li lj kk lk ll lm kn ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">稍后用<a class="ae jg" rel="noopener" target="_blank" href="/cross-validation-70289113a072">交叉验证</a>测试模型的准确性。最后，在验证完模型的准确性之后，用一些数据拟合最终模型:</p><pre class="mb mc md me gt mf mg mh mi aw mj bi"><span id="cef9" class="mk ml jj mg b gy mm mn l mo mp">sv_t = svm.SVC()<br/>sv_t.fit(Features,Classes)</span></pre><p id="2162" class="pw-post-body-paragraph lf lg jj lh b li lj kk lk ll lm kn ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">现在到了有趣但相当简单的部分。您可以将经过训练的模型以及任何功能/模块存储到一个 pickle 中，以便以后在其他地方分发！</p><figure class="mb mc md me gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi mq"><img src="../Images/40225ea26e92e4198ffdf5dba5ad5d30.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*U6Lp1QcJVYLHYe4nLdPeLw.png"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk">Free to use and part of the public domain Pickle drawing taken from <a class="ae jg" href="https://www.pinterest.com/pin/470274386081459180/?nic=1" rel="noopener ugc nofollow" target="_blank">here</a>. Image generated with<a class="ae jg" href="https://inkscape.org/" rel="noopener ugc nofollow" target="_blank"> Inkscape</a></figcaption></figure><p id="41ce" class="pw-post-body-paragraph lf lg jj lh b li lj kk lk ll lm kn ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">这样你就可以将训练好的模型<code class="fe mr ms mt mg b">sv_t</code>加上例如 numpy 的<code class="fe mr ms mt mg b">average</code>函数和 sklearn 模块的<code class="fe mr ms mt mg b">f1_score</code>函数保存在一个文件中。为此，您只需:</p><pre class="mb mc md me gt mf mg mh mi aw mj bi"><span id="fc6b" class="mk ml jj mg b gy mm mn l mo mp">import pickle<br/>pickle.dump([sv_t,average,f1_score], open('complete_ml.pkl', 'wb' ))</span></pre><p id="1ed6" class="pw-post-body-paragraph lf lg jj lh b li lj kk lk ll lm kn ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">就是这样！下次您(或其他人)从任何计算机加载 pickle 文件<em class="mu"> complete_ml.pkl </em> <strong class="lh jk">时:</strong></p><pre class="mb mc md me gt mf mg mh mi aw mj bi"><span id="00bd" class="mk ml jj mg b gy mm mn l mo mp">sv_t,average,f1_score = pickle.load(open('complete_ml.pkl','rb'))</span></pre><p id="f184" class="pw-post-body-paragraph lf lg jj lh b li lj kk lk ll lm kn ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">您将可以访问存储的训练模型以及您想要打包在一起以供将来分发的任何函数和变量。为什么要这样做？嗯，正如我在乞求中所说的，很多时候你想要共享、部署和分发你的 ML 管道到其他计算机，这些计算机可能没有预装所有需要的模块。有了这个技巧，唯一需要的模块就是 Pickle，它是<a class="ae jg" href="https://docs.python.org/3/library/pickle.html" rel="noopener ugc nofollow" target="_blank"> Python 的标准库</a>的一部分。</p><p id="0020" class="pw-post-body-paragraph lf lg jj lh b li lj kk lk ll lm kn ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">希望这个简单的指南对你的 ML 之旅有所帮助，它让我的 ML 之旅与众不同。</p><p id="be2b" class="pw-post-body-paragraph lf lg jj lh b li lj kk lk ll lm kn ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">感谢您的阅读！</p></div></div>    
</body>
</html>