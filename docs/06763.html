<html>
<head>
<title>Steps Before Modeling: Cleaning to EDA</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">建模前的步骤:清理至 EDA</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/steps-before-modeling-cleaning-to-eda-9a9e02981e57?source=collection_archive---------21-----------------------#2019-09-26">https://towardsdatascience.com/steps-before-modeling-cleaning-to-eda-9a9e02981e57?source=collection_archive---------21-----------------------#2019-09-26</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="9ecb" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">Python 中的数据清理和 EDA 初学者指南</h2></div><p id="722b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在能够利用我们都知道并喜爱的机器学习算法之前，重要的是要了解如何最初以适当的顺序获得数据，以及如何有效地分析数据，以便产生最佳模型。这篇文章将提供一个基本的路线图，数据科学家在使用 Python 处理新数据集时可以遵循它来执行探索性数据分析(EDA)。</p><h2 id="a8ec" class="lb lc iq bd ld le lf dn lg lh li dp lj ko lk ll lm ks ln lo lp kw lq lr ls lt bi translated">数据集:</h2><p id="2a00" class="pw-post-body-paragraph kf kg iq kh b ki lu jr kk kl lv ju kn ko lw kq kr ks lx ku kv kw ly ky kz la ij bi translated">在这篇文章中，我们将调查 2017 年和 2018 年各州的 SAT 和 ACT 参与率。数据集包括每个考试部分的全州平均分数、两次考试的综合/总分以及参与率。</p><h2 id="8470" class="lb lc iq bd ld le lf dn lg lh li dp lj ko lk ll lm ks ln lo lp kw lq lr ls lt bi translated">Python 库:</h2><pre class="lz ma mb mc gt md me mf mg aw mh bi"><span id="9723" class="lb lc iq me b gy mi mj l mk ml">#Imports:<br/>import num               as np<br/>import pandas            as pd<br/>import matplotlib.pyplot as plt<br/>import seaborn           as sns</span><span id="d4f0" class="lb lc iq me b gy mm mj l mk ml">from scipy               import stats</span></pre><h2 id="fa5f" class="lb lc iq bd ld le lf dn lg lh li dp lj ko lk ll lm ks ln lo lp kw lq lr ls lt bi translated">初步审查:</h2><p id="8317" class="pw-post-body-paragraph kf kg iq kh b ki lu jr kk kl lv ju kn ko lw kq kr ks lx ku kv kw ly ky kz la ij bi translated">在将文件加载到 Pandas dataframe 中之后，查看前几行和数据集的大小会对您正在处理的内容有所帮助。这最好通过使用<strong class="kh ir">来完成。头()</strong>和<strong class="kh ir">。形状</strong>方法。</p><figure class="lz ma mb mc gt mo gh gi paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="gh gi mn"><img src="../Images/31478b95c01fd2c029ed1f140e80fb5a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9Ke6LlezSAVIMEpNEvvi7w.png"/></div></div><figcaption class="mv mw gj gh gi mx my bd b be z dk">First 10 rows of 2017 SAT data</figcaption></figure><p id="bef9" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">。describe() </strong>方法提供了数据集中定量特征的快速统计概览，从每个特征的标准差到最小值和最大值。这也可以用来发现潜在的异常值。在下图中，我们可以很快看到<em class="mz">科学</em>的最低分数是 2.3，与其他值相比，这看起来并不正确。这需要进一步研究。</p><figure class="lz ma mb mc gt mo gh gi paragraph-image"><div class="gh gi na"><img src="../Images/0c3b66386ebd78e8726250b8471fa0a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1376/format:webp/1*dq8V8D951Qa0dT8Sgbl53w.png"/></div><figcaption class="mv mw gj gh gi mx my bd b be z dk">Summary of 2017 ACT data</figcaption></figure><pre class="lz ma mb mc gt md me mf mg aw mh bi"><span id="c75d" class="lb lc iq me b gy mi mj l mk ml">act_2017.sort_values('Science').head()</span></pre><figure class="lz ma mb mc gt mo gh gi paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="gh gi nb"><img src="../Images/bf9ea80688d87e0f4d919e97d9ae716f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3pdYj72XkFp3kp3KBKFjNg.png"/></div></div></figure><p id="c198" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">利用<strong class="kh ir"> sort_values() </strong>方法，我们可以看到马里兰州的平均科学分数为 2.3。这很可能是一个打字错误，需要更正。</p><p id="e0d2" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">描述完数据后，务必确保没有缺失值，并且所有数据类型都适用于每个要素。这个。<strong class="kh ir"> isnull() </strong>和<strong class="kh ir">。在这种情况下，最好使用 info() </strong>方法。</p><pre class="lz ma mb mc gt md me mf mg aw mh bi"><span id="2366" class="lb lc iq me b gy mi mj l mk ml">act_2018.isnull().sum()</span><span id="3b93" class="lb lc iq me b gy mm mj l mk ml">State            2<br/>Participation    2<br/>Composite        2</span></pre><p id="ddb8" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">从上面我们可以看到，2018 ACT 数据在每一列中都包含 2 个缺失值。下面的参与列作为一个对象列出，但它应该是一个浮点型，因为值是百分比。</p><figure class="lz ma mb mc gt mo gh gi paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="gh gi nc"><img src="../Images/07d31432f7fb2fcd99399b13713e5554.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MXuoQNbe9ILyjkiR6rFoXw.png"/></div></div></figure><p id="50ad" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这些 Pandas 方法为我们提供了数据的初步视图，以及在我们开始建模之前可能需要清理或纠正的内容。</p></div><div class="ab cl nd ne hu nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="ij ik il im in"><h2 id="84d8" class="lb lc iq bd ld le lf dn lg lh li dp lj ko lk ll lm ks ln lo lp kw lq lr ls lt bi translated">数据清理:</h2><p id="1dfd" class="pw-post-body-paragraph kf kg iq kh b ki lu jr kk kl lv ju kn ko lw kq kr ks lx ku kv kw ly ky kz la ij bi translated">在我们的初步审查之后，修复我们发现的错误是很重要的。首先，我们将使用<strong class="kh ir">将马里兰的<em class="mz">科学</em>分数改写为 23.2。锁定</strong>以隔离数据框中的特定位置。</p><pre class="lz ma mb mc gt md me mf mg aw mh bi"><span id="d9c8" class="lb lc iq me b gy mi mj l mk ml">act_2017.loc[act_2017['State'] == "Maryland", 'Science'] = 23.2</span></pre><p id="a04d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">下面，我们可以看到包含空值的 2 行。</p><figure class="lz ma mb mc gt mo gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/1bb18762950ca19149a133871dc974ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1116/format:webp/1*2p8fFNcfI_NDHDX-rYJKCQ.png"/></div></figure><pre class="lz ma mb mc gt md me mf mg aw mh bi"><span id="cb5f" class="lb lc iq me b gy mi mj l mk ml">act_2018.drop(act_2018.index[[52,53]], inplace = True)</span></pre><p id="831f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">上面的代码可以用来删除两行丢失的值。<strong class="kh ir">。dropna() </strong>方法是另一个有用的工具，当有丢失的值需要删除时。</p><p id="0863" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">最后，在我们开始可视化数据之前，我们需要纠正参与列的数据类型。使用<strong class="kh ir">。astype() </strong>方法，我们可以将列中的值更新为浮点数而不是对象。</p><pre class="lz ma mb mc gt md me mf mg aw mh bi"><span id="bf38" class="lb lc iq me b gy mi mj l mk ml">sat_2018['Participation'] = sat_2018['Participation'].astype(float)</span></pre></div><div class="ab cl nd ne hu nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="ij ik il im in"><h2 id="4539" class="lb lc iq bd ld le lf dn lg lh li dp lj ko lk ll lm ks ln lo lp kw lq lr ls lt bi translated">可视化数据:</h2><p id="debf" class="pw-post-body-paragraph kf kg iq kh b ki lu jr kk kl lv ju kn ko lw kq kr ks lx ku kv kw ly ky kz la ij bi translated">创建可视化可以帮助我们更详细地理解数据，并允许我们发现潜在的关系，这些关系是我们仅通过描述数据无法看到的。可视化还可以揭示可能会扭曲我们结果的异常值。我们将使用 seaborn 和 matplotlib 库来创建我们的可视化。</p><p id="fb03" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">关联热图对于查看要素之间的线性关系非常有用。决定在模型中使用哪些要素时，避免多重共线性非常重要。在下图中，较亮的值表示高度正相关的要素，较暗的图像表示高度负相关的要素。这两种考试的分数和参与率往往是逐年相关的。</p><pre class="lz ma mb mc gt md me mf mg aw mh bi"><span id="871a" class="lb lc iq me b gy mi mj l mk ml">sns.heatmap(final.corr(),mask=mask, vmax=.3, square=True, annot=True)</span></pre><figure class="lz ma mb mc gt mo gh gi paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="gh gi nl"><img src="../Images/802bb468d2d0aed6f39a9c76daf7b01c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PgBGPMcRkzqO24lfpf0DfQ.png"/></div></div><figcaption class="mv mw gj gh gi mx my bd b be z dk">Correlation Heatmap of All Features</figcaption></figure><p id="b28f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">散点图是查看两个特征之间是否存在线性关系的另一种方法。</p><pre class="lz ma mb mc gt md me mf mg aw mh bi"><span id="d7f6" class="lb lc iq me b gy mi mj l mk ml"># Establish the size of the figure.<br/>plt.figure(figsize=(16, 9))</span><span id="6194" class="lb lc iq me b gy mm mj l mk ml"># Create scatter plot of SAT vs. ACT math scores for 2017.<br/>sns.regplot(stats.zscore(final['total_sat_2017']),<br/>            stats.zscore(final['composite_act_2017']), <br/>            ci = None, <br/>            line_kws = {'color': 'orange'})</span><span id="98b5" class="lb lc iq me b gy mm mj l mk ml">plt.title("SAT vs. ACT 2017 Overall Scores", fontsize = 25)<br/>plt.ylabel("ACT 2017 Composite ZScores", fontsize = 20)<br/>plt.xlabel("SAT 2017 Composite ZScores", fontsize = 20)<br/>plt.xticks(size = 12)<br/>plt.yticks(size = 12);</span></pre><figure class="lz ma mb mc gt mo gh gi paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="gh gi nm"><img src="../Images/993faeb50847acf068c24f448e60c920.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QQ5wzVsHu3f_74u8ciqphw.png"/></div></div></figure><p id="742c" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">从散点图可以看出，ACT 和 SAT 综合成绩是负相关的。所以，一门考试考得好，不一定代表你另一门也会考得好。</p><p id="e9b6" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">直方图在查看特征分布时非常有用。下面的代码在同一个图上创建了两个直方图，因此我们可以并排分析这些特征。</p><pre class="lz ma mb mc gt md me mf mg aw mh bi"><span id="3d42" class="lb lc iq me b gy mi mj l mk ml">plt.figure(figsize=(16, 8))</span><span id="b80e" class="lb lc iq me b gy mm mj l mk ml">plt.subplot(1, 2, 1)<br/>final['total_sat_2017'].hist()<br/>plt.title('2017 SAT Total Scores', size = 25)<br/>plt.xlabel('Scores', size = 20)<br/>plt.ylabel('Frequency', size = 20)<br/>plt.vlines(x = np.mean(final['total_sat_2017']), ymin = 0, ymax = 10, color = 'r')<br/>plt.xticks(size = 12)<br/>plt.yticks(size = 12)</span><span id="8997" class="lb lc iq me b gy mm mj l mk ml">plt.subplot(1, 2, 2)<br/>final['total_sat_2018'].hist()<br/>plt.title('2018 SAT Total Scores', size = 25)<br/>plt.xlabel('Scores', size = 20)<br/>plt.ylabel('Frequency', size = 20)<br/>plt.vlines(x = np.mean(final['total_sat_2018']), ymin = 0, ymax = 10, color = 'r')<br/>plt.xticks(size = 12)<br/>plt.yticks(size = 12)</span></pre><figure class="lz ma mb mc gt mo gh gi paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="gh gi nn"><img src="../Images/8bf8555a46165668357d64676830ceb5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TnhLeeLvue-gUJGawZzuXw.png"/></div></div></figure><p id="2eac" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">从上面的直方图我们可以看出，2017 年和 2018 年的 SAT 总分并不是正态分布，而是向右偏的。在这两年中，分数下降的频率在 1100 和 1200 之间。看了这张图之后，我们可能会决定进一步研究为什么会有这种差距。</p><p id="8eba" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">最后，箱线图在查看要素分布时也很有用，但它们也有助于发现异常值。</p><pre class="lz ma mb mc gt md me mf mg aw mh bi"><span id="37ac" class="lb lc iq me b gy mi mj l mk ml">#2017 ACT scores by section<br/>plt.figure(figsize = (16, 9))</span><span id="9ac9" class="lb lc iq me b gy mm mj l mk ml">plt.title("ACT Subsection Scores 2017", size = 25)<br/>sns.boxplot(data = final[["math_act_2017", "science_act_2017", "english_act_2017", "reading_act_2017"]])</span><span id="3e39" class="lb lc iq me b gy mm mj l mk ml">plt.ylabel("Average Score", size = 20)<br/>plt.xlabel('Section', size = 20)</span><span id="b44e" class="lb lc iq me b gy mm mj l mk ml">plt.xticks(size = 16)<br/>plt.yticks(size = 16)</span></pre><figure class="lz ma mb mc gt mo gh gi paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="gh gi nn"><img src="../Images/0d3fa38a4d9ceebe22b10d616bd5d3eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pxm9S4TbZiWYwweOnzRdIQ.png"/></div></div></figure><p id="a58f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在上图中，我们可以看到 2017 年 ACT 分段分数的数据集中没有剩余异常值。在执行数据清理时，<em class="mz">科学</em>部分中的异常值已被移除。</p></div><div class="ab cl nd ne hu nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="ij ik il im in"><h2 id="c98c" class="lb lc iq bd ld le lf dn lg lh li dp lj ko lk ll lm ks ln lo lp kw lq lr ls lt bi translated">后续步骤:</h2><p id="8f08" class="pw-post-body-paragraph kf kg iq kh b ki lu jr kk kl lv ju kn ko lw kq kr ks lx ku kv kw ly ky kz la ij bi translated">现在，我们的数据是干净的，我们已经分析了我们的特征，我们准备开始预处理和建模。</p><p id="1aa7" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">正确清理数据集和执行 EDA 是数据科学家工作流程中的关键步骤。每个数据集都是不同的，但希望你学到了一些有用的方法，下次当你面临需要分析数据集的问题时可以遵循这些方法。</p><p id="25bf" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="mz">这个帖子的代码可以在我的</em> <a class="ae no" href="https://github.com/lwinter819/Project-1---Participation-Rates" rel="noopener ugc nofollow" target="_blank"> <em class="mz"> Github </em> </a> <em class="mz">上找到。</em></p><p id="0e93" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="mz">你也可以在</em><a class="ae no" href="https://www.linkedin.com/in/lucas-winter/" rel="noopener ugc nofollow" target="_blank"><em class="mz">LinkedIn</em></a><em class="mz">上找到我。</em></p></div></div>    
</body>
</html>