<html>
<head>
<title>Visualizing House Price Distributions</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">可视化房价分布</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/visualizing-house-price-distributions-fb0e6c2c264d?source=collection_archive---------22-----------------------#2019-07-19">https://towardsdatascience.com/visualizing-house-price-distributions-fb0e6c2c264d?source=collection_archive---------22-----------------------#2019-07-19</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="ip iq gp gr ir is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/1a9d3a11207ad6b99dee74ada13d32ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_jecxf8ZshyboaJJKIf9cQ.jpeg"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Photo by <a class="ae jd" href="https://unsplash.com/@lockwood?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">John Lockwood</a> on <a class="ae jd" href="https://unsplash.com/collections/4885214/blog-photos?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><div class=""/><div class=""><h2 id="cc26" class="pw-subtitle-paragraph kd jf jg bd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku dk translated">有了 Zillow 和 python 的 than，比以往任何时候都容易。</h2></div><h1 id="aac4" class="kv kw jg bd kx ky kz la lb lc ld le lf km lg kn lh kp li kq lj ks lk kt ll lm bi translated">等等，但是为什么？</h1><p id="c043" class="pw-post-body-paragraph ln lo jg lp b lq lr kh ls lt lu kk lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">我正在关闭我在佐治亚州亚特兰大的第一个家，并一直在大量使用各种房地产网站，如 Zillow，Redfin 和 Trulia。我也一直在摆弄 Zillow 的 API，尽管在功能和文档方面有些参差不齐。尽管它有缺点，但当我阅读了由<a class="ae jd" href="https://medium.com/u/5164378fc848" rel="noopener"> Lukas Frei </a>撰写的<a class="ae jd" rel="noopener" target="_blank" href="/rat-city-visualizing-new-york-citys-rat-problem-f7aabd6900b2">帖子</a>后，我受到了充分的启发，该帖子讲述了如何使用该库无缝地创建基于地理的可视化。几天后，我结合 Zillow 和 leav 制作了一些亚特兰大和美国各地房价的酷炫视觉效果。</p><h1 id="0f8b" class="kv kw jg bd kx ky kz la lb lc ld le lf km lg kn lh kp li kq lj ks lk kt ll lm bi translated">主题</h1><ul class=""><li id="a9f6" class="mj mk jg lp b lq lr lt lu lw ml ma mm me mn mi mo mp mq mr bi translated">API 集成</li><li id="9ddd" class="mj mk jg lp b lq ms lt mt lw mu ma mv me mw mi mo mp mq mr bi translated">图形遍历</li><li id="8adf" class="mj mk jg lp b lq ms lt mt lw mu ma mv me mw mi mo mp mq mr bi translated">形象化</li></ul><h1 id="4779" class="kv kw jg bd kx ky kz la lb lc ld le lf km lg kn lh kp li kq lj ks lk kt ll lm bi translated">一个小例子</h1><p id="3f49" class="pw-post-body-paragraph ln lo jg lp b lq lr kh ls lt lu kk lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">让我们从使用一些我从 Zillow 网站下载的<a class="ae jd" href="https://github.com/aagnone3/zillium/blob/master/data/State_MedianValuePerSqft_AllHomes.csv" rel="noopener ugc nofollow" target="_blank">预汇总数据</a>开始。该数据集显示了美国每个州从 1996 年 4 月到 2019 年 5 月每个月的平方英尺价格中位数。自然，人们可以对这些价格随时间的发展建立丰富的可视化；然而，现在让我们坚持使用最新的价格，它在文件的最后一列。</p><p id="8fe7" class="pw-post-body-paragraph ln lo jg lp b lq mx kh ls lt my kk lv lw mz ly lz ma na mc md me nb mg mh mi ij bi translated">看看排名前 10 的州，并没有多少惊喜。需要说明的是，最初我对其中一些城市的订单感到措手不及，特别是华盛顿和夏威夷名列榜首。但是，回想一下指标中“每平方英尺”的标准化。因此，考虑到加州的面积，我可能更惊讶于它仍然排在第三位。</p><figure class="nc nd ne nf gt is gh gi paragraph-image"><div class="ab gu cl ng"><img src="../Images/9b252fc250a5e13c97f362f086090870.png" data-original-src="https://miro.medium.com/v2/format:webp/1*m8dv-PmWxEdxXc-3f-O-Wg.png"/></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Top 10 price/sqft in thousands of $$$ (May 2019)</figcaption></figure><p id="b411" class="pw-post-body-paragraph ln lo jg lp b lq mx kh ls lt my kk lv lw mz ly lz ma na mc md me nb mg mh mi ij bi translated">不管怎样，上节目吧！由于这是一篇可视化的文章，我将避免在你面前扔太多行代码，并在文章的结尾将所有内容链接到它。简而言之，我从<a class="ae jd" href="https://github.com/python-visualization/folium" rel="noopener ugc nofollow" target="_blank">叶 repo </a>下载了一个美国各州的 GeoJSON 文件。这是一个伟大的发现，因为它立即为我提供了无缝流程所需的数据模式；我需要添加的唯一信息是价格数据(在最终的地图中生成颜色)。在提供了这些之后，仅仅 5 行代码就给了我下面的情节:</p><figure class="nc nd ne nf gt is gh gi paragraph-image"><div class="ab gu cl ng"><img src="../Images/4a129baef38b04837388cc119e26726b.png" data-original-src="https://miro.medium.com/v2/format:webp/1*otHI92R87cptloOqONQGxA.png"/></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Heatmap of price/sqft of homes in the U.S. for May 2019</figcaption></figure><h1 id="593b" class="kv kw jg bd kx ky kz la lb lc ld le lf km lg kn lh kp li kq lj ks lk kt ll lm bi translated">更进一步</h1><p id="264b" class="pw-post-body-paragraph ln lo jg lp b lq lr kh ls lt lu kk lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">既然我已经把脚趾伸进了 Zillow 和 leav 的水里，我已经准备好沉浸其中了。我决定画一张亚特兰大房价的热图。Zillow API 的一个缺点是它的搜索功能非常有限——我找不到任何基于经纬度坐标的搜索方法，这对于创建粒度热图来说非常方便。尽管如此，我还是把它作为一个机会来温习一些爬虫风格的代码；我使用一个城市名称的初始搜索结果作为未来调用的种子，以获得这些房屋的<a class="ae jd" href="https://en.wikipedia.org/wiki/Comparables" rel="noopener ugc nofollow" target="_blank"> comps </a>(通过<a class="ae jd" href="https://www.zillow.com/howto/api/GetComps.htm" rel="noopener ugc nofollow" target="_blank"> GetComps </a>端点)。</p><p id="4326" class="pw-post-body-paragraph ln lo jg lp b lq mx kh ls lt my kk lv lw mz ly lz ma na mc md me nb mg mh mi ij bi translated">值得注意的是，Zillow 确实有很多基于 URL 的搜索过滤器，可以用来进行纬度/经度搜索(见下文)。然而，从网页上获取房屋就变成了一项搜集工作，你会受到 Zillow 网页结构突然变化的影响。也就是说，抓取项目会有很多乐趣；如果你想把这个放进我做的东西里，请告诉我！</p><pre class="nc nd ne nf gt nh ni nj nk aw nl bi"><span id="b24a" class="nm kw jg ni b gy nn no l np nq"># an example of a Zillow search URL, with plenty of specifications<br/><a class="ae jd" href="https://www.zillow.com/atlanta-ga/houses/2-_beds/2.0-_baths/?searchQueryState=%7B%22pagination%22:%7B%7D,%22mapBounds%22:%7B%22west%22:-84.88217862207034,%22east%22:-84.07880337792972,%22south%22:33.53377471775447,%22north%22:33.999556422130006%7D,%22usersSearchTerm%22:%22Atlanta,%20GA%22,%22regionSelection%22:%5B%7B%22regionId%22:37211,%22regionType%22:6%7D%5D,%22isMapVisible%22:true,%22mapZoom%22:11,%22filterState%22:%7B%22price%22:%7B%22min%22:300000,%22max%22:600000%7D,%22monthlyPayment%22:%7B%22min%22:1119,%22max%22:2237%7D,%22hoa%22:%7B%22max%22:200%7D,%22beds%22:%7B%22min%22:2%7D,%22baths%22:%7B%22min%22:2%7D,%22sqft%22:%7B%22min%22:1300%7D,%22isAuction%22:%7B%22value%22:false%7D,%22isMakeMeMove%22:%7B%22value%22:false%7D,%22isMultiFamily%22:%7B%22value%22:false%7D,%22isManufactured%22:%7B%22value%22:false%7D,%22isLotLand%22:%7B%22value%22:false%7D,%22isPreMarketForeclosure%22:%7B%22value%22:false%7D,%22isPreMarketPreForeclosure%22:%7B%22value%22:false%7D%7D,%22isListVisible%22:true%7D" rel="noopener ugc nofollow" target="_blank">https://www.zillow.com/atlanta-ga/houses/2-_beds/2.0-_baths/?searchQueryState={%22pagination%22:{},%22mapBounds%22:{%22west%22:-84.88217862207034,%22east%22:-84.07880337792972,%22south%22:33.53377471775447,%22north%22:33.999556422130006},%22usersSearchTerm%22:%22Atlanta,%20GA%22,%22regionSelection%22:[{%22regionId%22:37211,%22regionType%22:6}],%22isMapVisible%22:true,%22mapZoom%22:11,%22filterState%22:{%22price%22:{%22min%22:300000,%22max%22:600000},%22monthlyPayment%22:{%22min%22:1119,%22max%22:2237},%22hoa%22:{%22max%22:200},%22beds%22:{%22min%22:2},%22baths%22:{%22min%22:2},%22sqft%22:{%22min%22:1300},%22isAuction%22:{%22value%22:false},%22isMakeMeMove%22:{%22value%22:false},%22isMultiFamily%22:{%22value%22:false},%22isManufactured%22:{%22value%22:false},%22isLotLand%22:{%22value%22:false},%22isPreMarketForeclosure%22:{%22value%22:false},%22isPreMarketPreForeclosure%22:{%22value%22:false}},%22isListVisible%22:true}</a></span></pre><p id="3379" class="pw-post-body-paragraph ln lo jg lp b lq mx kh ls lt my kk lv lw mz ly lz ma na mc md me nb mg mh mi ij bi translated">回到选择的路径，我提到我使用最初的结果作为某个城市的家庭网络的入口点。有了这些入口点，我不断递归调用每个家庭的 comps。这里的一个重要假设是，Zillow 对房屋相似性的定义，除了其他因素之外，还包括位置邻近性。如果没有位置邻近性，基于 comp 的住宅遍历相对于位置将非常不平滑。</p><p id="dd69" class="pw-post-body-paragraph ln lo jg lp b lq mx kh ls lt my kk lv lw mz ly lz ma na mc md me nb mg mh mi ij bi translated">那么，我们有什么算法可以以不同的方式遍历节点网络呢？当然，广度优先搜索(BFS)和深度优先搜索(DFS)很快就会浮现在脑海中。出于好奇，看看下面它的基本逻辑流程。除了集合成员保护之外，只有当新的 homes 满足在<code class="fe nr ns nt ni b">meets_criteria</code>函数中断言的约束时，它们才会被添加到集合中。现在，我在预定义的根纬度/经度位置和当前家的位置之间做一个简单的 L2 距离检查。这一标准鼓励搜索停留在根的本地，目的是为了一个良好连接和粒度的热图。下面的实现通过弹出列表的末尾(第 5 行)并添加到列表的末尾(第 14 行)来使用 DFS，但是通过更改任一行(但不是两行)来使用列表的前面，可以快速实现 BFS。</p><p id="ea48" class="pw-post-body-paragraph ln lo jg lp b lq mx kh ls lt my kk lv lw mz ly lz ma na mc md me nb mg mh mi ij bi translated">让这个算法在亚特兰大的房屋上运行 10，000 次迭代，在几分钟内就会产生下面的地图！更重要的是，由 folium 生成的<a class="ae jd" href="https://anthonyagnone.com/wp-shares-aagnone/atlanta_heatmap.html" rel="noopener ugc nofollow" target="_blank">网页</a>是交互式的，允许像缩放和平移这样的常见地图导航工具。为了证明它的模块化，我还生成了一些<a class="ae jd" href="https://anthonyagnone.com/wp-shares-aagnone/boston_heatmap.html" rel="noopener ugc nofollow" target="_blank">波士顿、马萨诸塞州</a>和<a class="ae jd" href="https://anthonyagnone.com/wp-shares-aagnone/seattle_heatmap.html" rel="noopener ugc nofollow" target="_blank">西雅图、华盛顿州</a>的小比例价格地图。</p><figure class="nc nd ne nf gt is gh gi paragraph-image"><div class="ab gu cl ng"><img src="../Images/5aa4689324d06731764a3272e2db6a87.png" data-original-src="https://miro.medium.com/v2/format:webp/1*Q81SBWiXe77l8xq8oqpgyw.png"/></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Heat map of Atlanta housing prices. See the interactive version <a class="ae jd" href="https://anthonyagnone.com/wp-shares-aagnone/atlanta_heatmap.html" rel="noopener ugc nofollow" target="_blank">here</a>.</figcaption></figure><h1 id="ac9c" class="kv kw jg bd kx ky kz la lb lc ld le lf km lg kn lh kp li kq lj ks lk kt ll lm bi translated">代码</h1><p id="7b4e" class="pw-post-body-paragraph ln lo jg lp b lq lr kh ls lt lu kk lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">正如承诺的那样，<a class="ae jd" href="https://github.com/aagnone3/zillium" rel="noopener ugc nofollow" target="_blank">这是项目</a>。它有一个 Make+Docker 设置，便于使用和再现。如果您想了解这两种工具如何完美结合以实现可重现的数据科学，<a class="ae jd" href="https://anthonyagnone.com/2019/07/10/towards-efficient-and-reproducible-ml-workflows-part-1-analysis/" rel="noopener ugc nofollow" target="_blank">请继续阅读这里的</a>。无论哪种方式，README 都可以让你很快上手，无论是通过脚本还是 Jupyter 笔记本。快乐的 viz！</p><div class="ip iq gp gr ir nu"><a href="https://github.com/aagnone3/zillium" rel="noopener  ugc nofollow" target="_blank"><div class="nv ab fo"><div class="nw ab nx cl cj ny"><h2 class="bd jh gy z fp nz fr fs oa fu fw jf bi translated">agnone3/zillium</h2><div class="ob l"><h3 class="bd b gy z fp nz fr fs oa fu fw dk translated">用 Zillow+leav 实现房地产可视化。在…上创建帐户，为 aagnone3/zillium 开发做出贡献</h3></div><div class="oc l"><p class="bd b dl z fp nz fr fs oa fu fw dk translated">github.com</p></div></div><div class="od l"><div class="oe l of og oh od oi ix nu"/></div></div></a></div><h1 id="24e4" class="kv kw jg bd kx ky kz la lb lc ld le lf km lg kn lh kp li kq lj ks lk kt ll lm bi translated">现在怎么办？</h1><p id="83b2" class="pw-post-body-paragraph ln lo jg lp b lq lr kh ls lt lu kk lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">接下来，我们可以沿着许多不同的方向发展这个逻辑。我在下面详细介绍了一些激励措施，但我更喜欢朝着最能获得支持、影响和协作的方向前进。你怎么想呢?</p></div><div class="ab cl oj ok hu ol" role="separator"><span class="om bw bk on oo op"/><span class="om bw bk on oo op"/><span class="om bw bk on oo"/></div><div class="ij ik il im in"><p id="5770" class="pw-post-body-paragraph ln lo jg lp b lq mx kh ls lt my kk lv lw mz ly lz ma na mc md me nb mg mh mi ij bi translated"><em class="oq">原载于</em><a class="ae jd" href="https://anthonyagnone.com/visualizing-house-price-distributions/" rel="noopener ugc nofollow" target="_blank"><em class="oq">https://anthonyagnone.com</em></a><em class="oq">。</em></p></div></div>    
</body>
</html>