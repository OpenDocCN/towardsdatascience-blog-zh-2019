<html>
<head>
<title>Data Science Fundamentals (R): Import Data from Excel — readxl</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">数据科学基础(R):从 Excel 导入数据— readxl</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/data-science-fundamentals-r-import-data-from-excel-readxl-380ef47216d5?source=collection_archive---------15-----------------------#2019-09-22">https://towardsdatascience.com/data-science-fundamentals-r-import-data-from-excel-readxl-380ef47216d5?source=collection_archive---------15-----------------------#2019-09-22</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div class="gh gi jq"><img src="../Images/ca51dd364cb23521d172ca9b4896c4ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/0*jrRu_ZTGN1pZreKn.png"/></div></figure><p id="3000" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">导入和导出文件有多种方式。我们上次讲过<a class="ae kv" rel="noopener" target="_blank" href="/data-science-fundamentals-r-import-export-data-in-excel-xlsx-bdb12a588735"> xlsx </a>这次我们会通过 readxl，同样，也有一些参数需要设置，尤其是导入文本的时候。</p><p id="e1fb" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">其他导入和导出包在系列中讨论。</p><div class="kw kx gp gr ky kz"><a href="https://medium.com/series/data-science-fundamentals-r-import-export-data-14667fed24a8" rel="noopener follow" target="_blank"><div class="la ab fo"><div class="lb ab lc cl cj ld"><h2 class="bd iu gy z fp le fr fs lf fu fw is bi translated">数据科学基础(R) —导入和导出数据</h2><div class="lg l"><h3 class="bd b gy z fp le fr fs lf fu fw dk translated">数据科学基础(R):从 Excel 导入和导出数据— xlsx</h3></div><div class="lh l"><p class="bd b dl z fp le fr fs lf fu fw dk translated">medium.com</p></div></div><div class="li l"><div class="lj l lk ll lm li ln jv kz"/></div></div></a></div></div><div class="ab cl lo lp hx lq" role="separator"><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt"/></div><div class="im in io ip iq"><h1 id="72b7" class="lv lw it bd lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms bi translated"><strong class="ak">套餐</strong></h1><p id="591c" class="pw-post-body-paragraph jx jy it jz b ka mt kc kd ke mu kg kh ki mv kk kl km mw ko kp kq mx ks kt ku im bi translated">readxl</p><h1 id="7d95" class="lv lw it bd lx ly my ma mb mc mz me mf mg na mi mj mk nb mm mn mo nc mq mr ms bi translated"><strong class="ak">功能</strong></h1><p id="9514" class="pw-post-body-paragraph jx jy it jz b ka mt kc kd ke mu kg kh ki mv kk kl km mw ko kp kq mx ks kt ku im bi translated">读取 xls 和 xlsx 文件</p><h1 id="617c" class="lv lw it bd lx ly my ma mb mc mz me mf mg na mi mj mk nb mm mn mo nc mq mr ms bi translated"><strong class="ak">描述</strong></h1><p id="9bf6" class="pw-post-body-paragraph jx jy it jz b ka mt kc kd ke mu kg kh ki mv kk kl km mw ko kp kq mx ks kt ku im bi translated">read_excel()调用 excel_format()根据文件扩展名和文件本身来确定 path 是 xls 还是 xlsx。如果您有更好的了解并希望防止这种猜测，请直接使用 read_xls()和 read_xlsx()。</p></div><div class="ab cl lo lp hx lq" role="separator"><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt"/></div><div class="im in io ip iq"><h1 id="0fbd" class="lv lw it bd lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms bi translated"><strong class="ak">演示</strong></h1><p id="c1f2" class="pw-post-body-paragraph jx jy it jz b ka mt kc kd ke mu kg kh ki mv kk kl km mw ko kp kq mx ks kt ku im bi translated">输入数据包括英文文本、数字、繁体中文文本和简体中文文本。</p><p id="4617" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">在本演示结束时，您将知道应该指定哪些选项来导入 r 中不同格式的上下文数据。使用 xlsx 和 readxl 的一个主要区别是，xlsx 只能支持 xlsx 文件的导入，但<strong class="jz iu"> readxl 同时支持 xlsx 和 xls 文件</strong>。</p><blockquote class="nd ne nf"><p id="283e" class="jx jy ng jz b ka kb kc kd ke kf kg kh nh kj kk kl ni kn ko kp nj kr ks kt ku im bi translated"><strong class="jz iu">测试功能(默认设置):</strong></p><p id="c934" class="jx jy ng jz b ka kb kc kd ke kf kg kh nh kj kk kl ni kn ko kp nj kr ks kt ku im bi translated">read_excel(path，sheet = NULL，range = NULL，col_names = TRUE，col_types = NULL，na = "，trim_ws = TRUE，skip = 0，n_max = Inf，guess_max = min(1000，n_max))</p><p id="b621" class="jx jy ng jz b ka kb kc kd ke kf kg kh nh kj kk kl ni kn ko kp nj kr ks kt ku im bi translated">read_xls(path，sheet = NULL，range = NULL，col_names = TRUE，col_types = NULL，na = "，trim_ws = TRUE，skip = 0，n_max = Inf，guess_max = min(1000，n_max))</p><p id="d780" class="jx jy ng jz b ka kb kc kd ke kf kg kh nh kj kk kl ni kn ko kp nj kr ks kt ku im bi translated">read_xlsx(path，sheet = NULL，range = NULL，col_names = TRUE，col_types = NULL，na = "，trim_ws = TRUE，skip = 0，n_max = Inf，guess_max = min(1000，n_max))</p></blockquote></div><div class="ab cl lo lp hx lq" role="separator"><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt"/></div><div class="im in io ip iq"><h1 id="9bf3" class="lv lw it bd lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms bi translated"><strong class="ak">输入文件</strong></h1><p id="84c6" class="pw-post-body-paragraph jx jy it jz b ka mt kc kd ke mu kg kh ki mv kk kl km mw ko kp kq mx ks kt ku im bi translated">Reference_Sample.xlsx</p><figure class="nl nm nn no gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="np nq di nr bf ns"><div class="gh gi nk"><img src="../Images/98596112c427adad5eb84852b4b1a910.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/0*QJrmnquixeE4Ompq.PNG"/></div></div></figure><p id="8671" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">参考 _ 样本. xls</p><figure class="nl nm nn no gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="np nq di nr bf ns"><div class="gh gi nk"><img src="../Images/cb85e94be261460b44d866b5e7d34fd6.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/0*ak6YXcflOmM8BhHZ.PNG"/></div></div></figure><h1 id="f86f" class="lv lw it bd lx ly my ma mb mc mz me mf mg na mi mj mk nb mm mn mo nc mq mr ms bi translated"><strong class="ak">代码</strong></h1><pre class="nl nm nn no gt nt nu nv nw aw nx bi"><span id="2dd2" class="ny lw it nu b gy nz oa l ob oc">###############<br/>library(readxl) <br/>############### <br/>getwd()<!-- --> <br/># read excel xls/ xlsx - method 1 <br/>xls_df = read_excel(path = "Reference_Sample.xls", sheet = "Sample_Sheet")</span></pre><figure class="nl nm nn no gt ju gh gi paragraph-image"><div class="gh gi jq"><img src="../Images/895c611e496461903ee28626191da36a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/0*oXqhv5Q0kU28cAHV.PNG"/></div></figure><p id="1099" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">与使用 xlsx 相同，如果未定义区域设置，则以 UTF 代码显示中文字符。如果您需要阅读中文字符或其他语言的特定字符，则需要进行区域设置。</p><pre class="nl nm nn no gt nt nu nv nw aw nx bi"><span id="59db" class="ny lw it nu b gy nz oa l ob oc">Sys.setlocale(category = "LC_ALL", locale = "Chinese") <br/># read excel xls/ xlsx - method 1<br/>xls_df1 = read_excel(path = "Reference_Sample.xls", sheet = "Sample_Sheet")</span></pre><figure class="nl nm nn no gt ju gh gi paragraph-image"><div class="gh gi od"><img src="../Images/4edb9f555da108ea3e0b2c71f33cde20.png" data-original-src="https://miro.medium.com/v2/resize:fit:728/0*NXArhdRl1P4vJtsw.PNG"/></div></figure><pre class="nl nm nn no gt nt nu nv nw aw nx bi"><span id="8cdd" class="ny lw it nu b gy nz oa l ob oc">xlsx_df1 = read_excel(path = "Reference_Sample.xlsx", sheet = "Sample_Sheet")</span></pre><figure class="nl nm nn no gt ju gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/19b8d4f4558db3a30d20dd54de4c6662.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/0*MluudXnWepJt6prP.PNG"/></div></figure><p id="20c8" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">xlsx 和 xls 文件均以数据框结构导入，繁体中文和简体中文字符均可成功显示。</p><p id="a1e7" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">readxl 还提供了专门导入 xlsx 或 xls 文件的其他函数。</p><pre class="nl nm nn no gt nt nu nv nw aw nx bi"><span id="4628" class="ny lw it nu b gy nz oa l ob oc"># read excel xls - method 2<br/>xls_df2 = read_xls(path = "Reference_Sample.xls", sheet = "Sample_Sheet")</span></pre><figure class="nl nm nn no gt ju gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/8b52ef303519c1dd7b56e9bfbcc3f6db.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/0*OpybQ9mfmAtcegK4.PNG"/></div></figure><pre class="nl nm nn no gt nt nu nv nw aw nx bi"><span id="e45e" class="ny lw it nu b gy nz oa l ob oc"># read excel xlsx - method 3<br/>xlsx_df2 = read_xlsx(path = "Reference_Sample.xlsx", sheet = "Sample_Sheet")</span></pre><figure class="nl nm nn no gt ju gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/6debd4f3445a486cae8dc6ecd9a12eda.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/0*B-EyCsFqzOEPpIoQ.PNG"/></div></figure><p id="4a4a" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">read_xls 和 read_xlsx 都可以演示与 read_excel 相同的读取功能。正如函数名所指定的，read_xls 只能读取 xls 文件，而 read_xlsx 只能读取 xlsx 文件。如果反过来做，会出现以下错误。</p><pre class="nl nm nn no gt nt nu nv nw aw nx bi"><span id="bbea" class="ny lw it nu b gy nz oa l ob oc">xlsx_df3 = read_xlsx(path = "Reference_Sample.xls", sheet = "Sample_Sheet")</span></pre><p id="047d" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">sheets_fun(path)中的错误:评估错误:在“Reference_Sample.xls”中找不到“”。</p></div><div class="ab cl lo lp hx lq" role="separator"><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt"/></div><div class="im in io ip iq"><h1 id="09b0" class="lv lw it bd lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms bi translated"><strong class="ak">总结</strong></h1><p id="9071" class="pw-post-body-paragraph jx jy it jz b ka mt kc kd ke mu kg kh ki mv kk kl km mw ko kp kq mx ks kt ku im bi translated">与 xlsx 包相比，readxl 可以读取 xlsx 和 xls 文件，并且选项设置较少。使用 readxl 时，只需要文件路径和工作表名称。在 read_excel、read_xls 和 read_xlsx 这三个函数中，read_excel 既适用于 xlsx 文件，也适用于 xls 文件，因此，一般来说，建议使用 read_excel 来读取 excel 文件。</p><p id="817c" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">你可以在 R <a class="ae kv" href="https://medium.com/series/data-science-fundamentals-r-import-export-data-14667fed24a8" rel="noopener">这里</a>找到数据导入导出的其他文章。</p></div><div class="ab cl lo lp hx lq" role="separator"><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt"/></div><div class="im in io ip iq"><h1 id="64f0" class="lv lw it bd lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms bi translated">编辑的话</h1><p id="4748" class="pw-post-body-paragraph jx jy it jz b ka mt kc kd ke mu kg kh ki mv kk kl km mw ko kp kq mx ks kt ku im bi translated">如果你有兴趣了解更多的窍门和技巧，欢迎你浏览我们的网站:【https://cydalytics.blogspot.com/<a class="ae kv" href="https://cydalytics.blogspot.com/" rel="noopener ugc nofollow" target="_blank"/></p><p id="9ba6" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated"><strong class="jz iu">领英:</strong></p><p id="e937" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">凯莉·罗—<a class="ae kv" href="https://www.linkedin.com/in/carrielsc/" rel="noopener ugc nofollow" target="_blank">https://www.linkedin.com/in/carrielsc/</a></p><p id="803e" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">黄洋<a class="ae kv" href="https://www.linkedin.com/in/yeungwong/" rel="noopener ugc nofollow" target="_blank">—https://www.linkedin.com/in/yeungwong/</a></p></div><div class="ab cl lo lp hx lq" role="separator"><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt"/></div><div class="im in io ip iq"><ol class=""><li id="6971" class="oe of it jz b ka kb ke kf ki og km oh kq oi ku oj ok ol om bi translated"><a class="ae kv" href="https://medium.com/analytics-vidhya/data-science-fundamentals-r-import-data-from-text-files-textreadr-readtext-c5058c3bd0d6?source=friends_link&amp;sk=dc3c4a22b2c02e66ceac70ad31001d0f" rel="noopener">数据科学基础(R):从文本文件导入数据— textreadr &amp; readtext </a></li><li id="a635" class="oe of it jz b ka on ke oo ki op km oq kq or ku oj ok ol om bi translated"><a class="ae kv" rel="noopener" target="_blank" href="/data-science-fundamentals-r-import-export-data-in-excel-xlsx-bdb12a588735?source=friends_link&amp;sk=15d135b8d3544f5a63f688ff309c159f">数据科学基础(R):导入&amp;导出 Excel 中的数据— xlsx </a></li><li id="a3af" class="oe of it jz b ka on ke oo ki op km oq kq or ku oj ok ol om bi translated"><a class="ae kv" rel="noopener" target="_blank" href="/data-visualization-tips-power-bi-convert-categorical-variables-to-dummy-variables-a53f20cdb4e?source=friends_link&amp;sk=64aeb5d2d5c7b1f9aa34b4adcc052694">数据可视化技巧(Power BI)——将分类变量转换为虚拟变量</a></li><li id="032b" class="oe of it jz b ka on ke oo ki op km oq kq or ku oj ok ol om bi translated"><a class="ae kv" href="https://medium.com/@yeung_cyda/written-in-chinese-step-by-step-chinese-word-cloud-with-python-53f57f65be69?source=friends_link&amp;sk=5194e7fadf63033934fae9111ef76a98" rel="noopener">形状各异的中文词云(Python) </a></li><li id="8ddf" class="oe of it jz b ka on ke oo ki op km oq kq or ku oj ok ol om bi translated"><a class="ae kv" rel="noopener" target="_blank" href="/making-a-game-for-kids-to-learn-english-and-have-fun-with-python-d6b54af792ec?source=friends_link&amp;sk=d174a0470ca5400fda2b20ddf633e624">用 Python 制作一个让孩子学英语、玩得开心的游戏</a></li></ol></div></div>    
</body>
</html>