<html>
<head>
<title>Learning Artificial Neural Networks by predicting visitor purchase intention</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">通过预测游客购买意向学习人工神经网络</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/learning-artificial-neural-networks-by-predicting-visitor-purchase-intention-724ba2be7c29?source=collection_archive---------21-----------------------#2019-05-14">https://towardsdatascience.com/learning-artificial-neural-networks-by-predicting-visitor-purchase-intention-724ba2be7c29?source=collection_archive---------21-----------------------#2019-05-14</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="85f2" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用 Keras 和 Tensorflow 构建人工神经网络</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/9dec2cc9c8770d7be68e52e588e602da.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*Q1H6sBSztsPZIzCKOMQ2cQ.gif"/></div></div></figure><p id="0754" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">当我在 Udemy 上学习关于深度学习的课程时，我决定利用我的知识，尝试预测一个访问者是否会购买(产生收入)。数据集取自<a class="ae lq" href="https://archive.ics.uci.edu/ml/datasets/Online+Shoppers+Purchasing+Intention+Dataset" rel="noopener ugc nofollow" target="_blank"> UCI 机器学习库</a>。您可以在下面的回购协议中找到完整的代码:</p><div class="lr ls gp gr lt lu"><a href="https://github.com/kb22/Purchasing-Intention-Prediction" rel="noopener  ugc nofollow" target="_blank"><div class="lv ab fo"><div class="lw ab lx cl cj ly"><h2 class="bd iu gy z fp lz fr fs ma fu fw is bi translated">kb22/购买意向预测</h2><div class="mb l"><h3 class="bd b gy z fp lz fr fs ma fu fw dk translated">该项目包括预测游客是否会购物。-kb22/购买意向预测</h3></div><div class="mc l"><p class="bd b dl z fp lz fr fs ma fu fw dk translated">github.com</p></div></div><div class="md l"><div class="me l mf mg mh md mi ks lu"/></div></div></a></div><h1 id="98ed" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">导入库</h1><p id="f794" class="pw-post-body-paragraph ku kv it kw b kx nb ju kz la nc jx lc ld nd lf lg lh ne lj lk ll nf ln lo lp im bi translated">第一步是导入必要的库。除了常规的数据科学库包括<code class="fe ng nh ni nj b">numpy</code>、<code class="fe ng nh ni nj b">pandas</code>、<code class="fe ng nh ni nj b">matplotlib</code>之外，我导入了机器学习库<code class="fe ng nh ni nj b">sklearn</code>和深度学习库<code class="fe ng nh ni nj b">keras</code>。我会用<code class="fe ng nh ni nj b">keras</code>开发我的以<code class="fe ng nh ni nj b">tensorflow</code>为后端的人工神经网络。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nk nl l"/></div></figure><h1 id="61b4" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">导入数据集</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/9dec2cc9c8770d7be68e52e588e602da.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*Q1H6sBSztsPZIzCKOMQ2cQ.gif"/></div></div></figure><p id="08af" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我将导入数据集并获得数据的基本概述。有 1，908 名访客带来了收入，而 10，422 名访客没有。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nk nl l"/></div></figure><p id="3be6" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">有 18 列、17 个特性和 1 个目标变量(收入)。没有丢失的值。我也跑了<code class="fe ng nh ni nj b">dataset.describe()</code>。每一列的<code class="fe ng nh ni nj b">mean</code>各不相同，因此，缩放应该有所帮助。</p><p id="e699" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">考虑到<code class="fe ng nh ni nj b">Revenue</code>是目标列，我将把数据集分成测试集和训练集。我将数据集分成 80%的训练数据和 20%的测试数据。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nk nl l"/></div></figure><h1 id="29fa" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">数据分析和可视化</h1><h2 id="b305" class="nm mk it bd ml nn no dn mp np nq dp mt ld nr ns mv lh nt nu mx ll nv nw mz nx bi translated">目标列</h2><p id="a88a" class="pw-post-body-paragraph ku kv it kw b kx nb ju kz la nc jx lc ld nd lf lg lh ne lj lk ll nf ln lo lp im bi translated">我首先在产生收入的访问者和没有产生收入的访问者之间创建了一个条形图。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ny"><img src="../Images/10549d29a382b3e2a3cbfacde094cfdc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1cK_K9SzMKM9Xhflsugulw.png"/></div></div><figcaption class="nz oa gj gh gi ob oc bd b be z dk">Target column bar chart</figcaption></figure><p id="101a" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">从上面的柱状图中可以清楚地看出，数据集包含了大多数没有产生收入的要素值。数据集是高度不平衡的，这是我们必须创建一个有效的模型，仍然可以准确地在两个类之间进行分类。</p><h2 id="1635" class="nm mk it bd ml nn no dn mp np nq dp mt ld nr ns mv lh nt nu mx ll nv nw mz nx bi translated">相关矩阵</h2><p id="d463" class="pw-post-body-paragraph ku kv it kw b kx nb ju kz la nc jx lc ld nd lf lg lh ne lj lk ll nf ln lo lp im bi translated">我创建了相关矩阵，然后根据相关程度给它着色。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi od"><img src="../Images/5b552a23d9f81a50971726efcb72eb5e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*64NzkiIylHrgvLMaA4ASUQ.png"/></div></div><figcaption class="nz oa gj gh gi ob oc bd b be z dk">Correlation Matrix (Part 1)</figcaption></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oe"><img src="../Images/2a360f819f875e19835b1e6a47aac407.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QWAtvZfO0rte2zjO8gzTpw.png"/></div></div><figcaption class="nz oa gj gh gi ob oc bd b be z dk">Correlation Matrix (Part 2)</figcaption></figure><p id="8ef8" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">看来<code class="fe ng nh ni nj b">PageValues</code>与我们的目标值线性相关最大。另外，像<code class="fe ng nh ni nj b">OperatingSystems</code>、<code class="fe ng nh ni nj b">Region</code>和<code class="fe ng nh ni nj b">TrafficType</code>这样的特性的相关性小于<code class="fe ng nh ni nj b">0.02</code>或大于<code class="fe ng nh ni nj b">-0.02</code>，所以我将删除这些列。</p><p id="f199" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">从相关矩阵中可以看出，<code class="fe ng nh ni nj b">Administrative</code>和<code class="fe ng nh ni nj b">Administrative_Duration</code>、<code class="fe ng nh ni nj b">Informational</code>和<code class="fe ng nh ni nj b">Informational_Duration</code>以及<code class="fe ng nh ni nj b">ProductRelated</code>和<code class="fe ng nh ni nj b">ProductRelated_Duration</code>之间的关系似乎具有非常高的相关性。这是意料之中的，因为在一种类型的页面上花费的时间肯定会受到该类型页面的访问量的影响。因此，我们可以删除每种类型访问的页面数量。</p><h1 id="3db5" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">数据工程</h1><h2 id="4262" class="nm mk it bd ml nn no dn mp np nq dp mt ld nr ns mv lh nt nu mx ll nv nw mz nx bi translated">移除列</h2><p id="d106" class="pw-post-body-paragraph ku kv it kw b kx nb ju kz la nc jx lc ld nd lf lg lh ne lj lk ll nf ln lo lp im bi translated">我现在将删除所有不需要的列，包括<code class="fe ng nh ni nj b">Administrative</code>、<code class="fe ng nh ni nj b">Informational</code>、<code class="fe ng nh ni nj b">ProductRelated</code>、<code class="fe ng nh ni nj b">OperatingSystems</code>、<code class="fe ng nh ni nj b">Region</code>和<code class="fe ng nh ni nj b">TrafficType</code>。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nk nl l"/></div></figure><h2 id="540f" class="nm mk it bd ml nn no dn mp np nq dp mt ld nr ns mv lh nt nu mx ll nv nw mz nx bi translated">编码分类列</h2><p id="c03f" class="pw-post-body-paragraph ku kv it kw b kx nb ju kz la nc jx lc ld nd lf lg lh ne lj lk ll nf ln lo lp im bi translated">我将使用<code class="fe ng nh ni nj b">LabelEncoder</code>对分类列进行编码。我将使用<code class="fe ng nh ni nj b">OneHotEncoder</code>对列类进行编码，然后将它们追加到数据集中。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nk nl l"/></div></figure><h2 id="c9ac" class="nm mk it bd ml nn no dn mp np nq dp mt ld nr ns mv lh nt nu mx ll nv nw mz nx bi translated">缩放数据</h2><p id="9a19" class="pw-post-body-paragraph ku kv it kw b kx nb ju kz la nc jx lc ld nd lf lg lh ne lj lk ll nf ln lo lp im bi translated">接下来，我将重新调整数据，使每一列的平均值都在 0 左右。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nk nl l"/></div></figure><h1 id="ff18" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">模型生成</h1><p id="bdf0" class="pw-post-body-paragraph ku kv it kw b kx nb ju kz la nc jx lc ld nd lf lg lh ne lj lk ll nf ln lo lp im bi translated">我将使用 Keras 和 Tensorflow 作为后端来生成一个人工神经网络。有 32 个输入节点，接着是 4 个隐藏层和 1 个输出层。该模型体系结构被设计为增加验证集的准确性以及防止在训练集上过度拟合。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nk nl l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi of"><img src="../Images/745303ab80c29507583ff247ecae4fee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9L830VjEhMontKfvRwlf_w.png"/></div></div><figcaption class="nz oa gj gh gi ob oc bd b be z dk">Artificial Neural Network</figcaption></figure><p id="de6c" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我为人工神经网络开发了一个序列模型。这些层或者是致密层或者是脱落层。每个密集层表示中子数为<code class="fe ng nh ni nj b">units</code>，激活函数为<code class="fe ng nh ni nj b">relu</code>，第一层还包括输入的<code class="fe ng nh ni nj b">input_dim</code>。输出层的激活是<code class="fe ng nh ni nj b">sigmoid</code>。退出确保训练数据不会过度拟合。</p><h1 id="e6d2" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">训练和评估模型</h1><p id="8b7d" class="pw-post-body-paragraph ku kv it kw b kx nb ju kz la nc jx lc ld nd lf lg lh ne lj lk ll nf ln lo lp im bi translated">我训练了总共 50 个时期的模型，其中 90%是训练，10%是验证分割。我达到了 90.44%的训练准确率和 89.06%的验证准确率。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nk nl l"/></div></figure><p id="279e" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">最后，对试验数据进行了预测。然后，我使用预测值和实际值创建混淆矩阵，计算出 88.77%的测试准确率。</p><h1 id="7627" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">结果分析</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/24afeed77e3df687316204a45bc25afb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*P4ognanTG3Fd9hQ-NTQMkQ.gif"/></div></div></figure><p id="d54a" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">混淆矩阵显示，我们能够识别两种类型的访问者，将产生收入的访问者和不会产生收入的访问者。我们可以如下使用这些信息:</p><ol class=""><li id="63c5" class="og oh it kw b kx ky la lb ld oi lh oj ll ok lp ol om on oo bi translated">一旦我们能够确定某人将产生收入，我们不需要提供任何优惠券，而是我们可以给访问者特殊的奖励积分，他们可以在下次访问时使用。</li><li id="dafc" class="og oh it kw b kx op la oq ld or lh os ll ot lp ol om on oo bi translated">不太可能进行购买的访问者可以被提供折扣券，使得他们更有可能进行购买。</li></ol></div><div class="ab cl ou ov hx ow" role="separator"><span class="ox bw bk oy oz pa"/><span class="ox bw bk oy oz pa"/><span class="ox bw bk oy oz"/></div><div class="im in io ip iq"><p id="4e67" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">感谢阅读。请分享你的想法、观点和建议。你也可以通过 LinkedIn 联系我。您可能还会喜欢以下内容:</p><div class="lr ls gp gr lt lu"><a rel="noopener follow" target="_blank" href="/deep-learning-to-identify-malaria-cells-using-cnn-on-kaggle-b9a987f55ea5"><div class="lv ab fo"><div class="lw ab lx cl cj ly"><h2 class="bd iu gy z fp lz fr fs ma fu fw is bi translated">在 Kaggle 上使用 CNN 进行深度学习以识别疟疾细胞</h2><div class="mb l"><h3 class="bd b gy z fp lz fr fs ma fu fw dk translated">医学领域的深度学习</h3></div><div class="mc l"><p class="bd b dl z fp lz fr fs ma fu fw dk translated">towardsdatascience.com</p></div></div><div class="md l"><div class="pb l mf mg mh md mi ks lu"/></div></div></a></div><div class="lr ls gp gr lt lu"><a rel="noopener follow" target="_blank" href="/extracting-faces-using-opencv-face-detection-neural-network-475c5cd0c260"><div class="lv ab fo"><div class="lw ab lx cl cj ly"><h2 class="bd iu gy z fp lz fr fs ma fu fw is bi translated">利用 OpenCV 人脸检测神经网络提取人脸</h2><div class="mb l"><h3 class="bd b gy z fp lz fr fs ma fu fw dk translated">使用预先训练的人脸检测系统</h3></div><div class="mc l"><p class="bd b dl z fp lz fr fs ma fu fw dk translated">towardsdatascience.com</p></div></div><div class="md l"><div class="pc l mf mg mh md mi ks lu"/></div></div></a></div><div class="lr ls gp gr lt lu"><a rel="noopener follow" target="_blank" href="/predicting-presence-of-heart-diseases-using-machine-learning-36f00f3edb2c"><div class="lv ab fo"><div class="lw ab lx cl cj ly"><h2 class="bd iu gy z fp lz fr fs ma fu fw is bi translated">使用机器学习预测心脏病的存在</h2><div class="mb l"><h3 class="bd b gy z fp lz fr fs ma fu fw dk translated">机器学习在医疗保健中的应用</h3></div><div class="mc l"><p class="bd b dl z fp lz fr fs ma fu fw dk translated">towardsdatascience.com</p></div></div><div class="md l"><div class="pd l mf mg mh md mi ks lu"/></div></div></a></div><div class="lr ls gp gr lt lu"><a rel="noopener follow" target="_blank" href="/create-a-complete-machine-learning-web-application-using-react-and-flask-859340bddb33"><div class="lv ab fo"><div class="lw ab lx cl cj ly"><h2 class="bd iu gy z fp lz fr fs ma fu fw is bi translated">使用 React 和 Flask 创建一个完整的机器学习 web 应用程序</h2><div class="mb l"><h3 class="bd b gy z fp lz fr fs ma fu fw dk translated">用 UI 和后端构建完整的 ML 应用程序</h3></div><div class="mc l"><p class="bd b dl z fp lz fr fs ma fu fw dk translated">towardsdatascience.com</p></div></div><div class="md l"><div class="pe l mf mg mh md mi ks lu"/></div></div></a></div></div></div>    
</body>
</html>