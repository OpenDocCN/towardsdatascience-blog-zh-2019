<html>
<head>
<title>Monte Carlo Simulation in R with focus on Option Pricing</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">R 中的蒙特卡罗模拟，重点是期权定价</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/monte-carlo-simulation-in-r-with-focus-on-financial-data-ad43e2a4aedf?source=collection_archive---------0-----------------------#2019-06-25">https://towardsdatascience.com/monte-carlo-simulation-in-r-with-focus-on-financial-data-ad43e2a4aedf?source=collection_archive---------0-----------------------#2019-06-25</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/3bb1b791e9202da28e6692fd1e437217.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zeE59zfjRJmIngwvJsvMRQ.png"/></div></div></figure><blockquote class="kb kc kd"><p id="7534" class="ke kf kg kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">在这篇博客中，我将介绍蒙特卡罗模拟的基础知识，随机数分布和生成它们的算法。最后，我还将介绍蒙特卡罗模拟在期权定价领域的应用。整个博客的重点是用<strong class="kh iu"> R </strong>编写代码，这样你也可以用 R 实现自己的蒙特卡罗模拟应用。</p></blockquote><h2 id="be8c" class="ld le it bd lf lg lh dn li lj lk dp ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">蒙特卡洛方法是什么？</h2><p id="2965" class="pw-post-body-paragraph ke kf it kh b ki lz kk kl km ma ko kp lm mb ks kt lq mc kw kx lu md la lb lc im bi translated">蒙特卡罗方法基本上是指一类利用随机性进行估计的算法。让我们举一个例子来说明这一点</p><figure class="mf mg mh mi gt ju gh gi paragraph-image"><div class="gh gi me"><img src="../Images/d860426a624fcf7ed727049ba0c60382.png" data-original-src="https://miro.medium.com/v2/resize:fit:812/format:webp/1*QdrC2XByQ79uFunMi-kXew.png"/></div></figure><p id="bf6d" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp lm kr ks kt lq kv kw kx lu kz la lb lc im bi translated">为了使用蒙特卡罗方法给出函数的该积分的<strong class="kh iu">数值估计</strong>，可以将该积分建模为<strong class="kh iu"><em class="kg">E[f(U)】</em></strong>，其中<strong class="kh iu"> <em class="kg"> U </em> </strong>是<strong class="kh iu">【0，1】</strong>中的均匀随机数。生成<strong class="kh iu"><em class="kg">n</em></strong><em class="kg"/><strong class="kh iu">【0，1】</strong>之间的均匀随机变量。让那些分别是函数值<strong class="kh iu">f(u₁<strong class="kh iu">u₁,u₂,…uₙ</strong>、f(U₂),…f(Uₙ) </strong>。</p><figure class="mf mg mh mi gt ju gh gi paragraph-image"><div class="gh gi mj"><img src="../Images/dc669e7db268933d91488a2599a01569.png" data-original-src="https://miro.medium.com/v2/resize:fit:790/format:webp/1*BdEPIqpj3ojBU5r18g6tlQ.png"/></div><figcaption class="mk ml gj gh gi mm mn bd b be z dk">Numerical Estimate of Integral</figcaption></figure><p id="83c7" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp lm kr ks kt lq kv kw kx lu kz la lb lc im bi translated">这样我们就用<strong class="kh iu"> <em class="kg"> n </em> </strong> <em class="kg"> </em>在<strong class="kh iu">【0，1】</strong>之间的均匀随机样本得到了积分的估计。这个估计值将<strong class="kh iu">收敛</strong>到【实际】<strong class="kh iu">α<em class="kg">n</em></strong><em class="kg"/><strong class="kh iu">收敛</strong>到<strong class="kh iu"><em class="kg"/></strong>。现在我们已经看了如何得到一个估计值，让我们看看如何产生不同的随机数分布。</p><p id="6373" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp lm kr ks kt lq kv kw kx lu kz la lb lc im bi translated">让我们再来看一个涉及<strong class="kh iu">衍生产品定价</strong>的例子。首先，我将定义一些重要的金融术语。股票价格<strong class="kh iu"><em class="kg"/></strong>将是时间<em class="kg"> t 的函数</em>我们将考虑一个<strong class="kh iu">欧式期权</strong>并对其定价。</p><p id="fb8f" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp lm kr ks kt lq kv kw kx lu kz la lb lc im bi translated"><strong class="kh iu">欧式期权:</strong>它是一种金融工具，它赋予你权利，但并不强制你以某一价格(<strong class="kh iu">执行价格</strong> ( <strong class="kh iu"> <em class="kg"> K </em> </strong>))买入/卖出资产，该价格在之前某一时间点固定，比如说时间 0。因此，如果我们继续执行合同，并同意在时间<strong class="kh iu"><em class="kg"/></strong>以固定价格<strong class="kh iu"> <em class="kg"> K </em> </strong>购买/出售一项资产。我们的利润将是</p><p id="75ee" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp lm kr ks kt lq kv kw kx lu kz la lb lc im bi translated"><strong class="kh iu"> <em class="kg">利润</em>=<em class="kg">S(T)-K/K-S(T)</em></strong></p><p id="8d21" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp lm kr ks kt lq kv kw kx lu kz la lb lc im bi translated">从现在开始，我们只关注购买一种资产，这种资产也被称为<strong class="kh iu">欧式期权</strong></p><p id="cf50" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp lm kr ks kt lq kv kw kx lu kz la lb lc im bi translated">所以，如果<strong class="kh iu"> <em class="kg"> (S(T)-K) </em> </strong> &lt;为 0，那么推进这份合同不符合我们的利益。因此，我们不<strong class="kh iu">行使</strong>我们的期权<em class="kg">，即</em>我们不购买资产<em class="kg">。</em></p><p id="66d2" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp lm kr ks kt lq kv kw kx lu kz la lb lc im bi translated">因此，你的收益是-</p><figure class="mf mg mh mi gt ju gh gi paragraph-image"><div class="gh gi mo"><img src="../Images/2f0d31ec45eb9b4546822b6da53ff1b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1008/format:webp/1*9r-eiU9eDRLsYj9LUxf-Bg.png"/></div><figcaption class="mk ml gj gh gi mm mn bd b be z dk">The value of Payoff</figcaption></figure><p id="0ff2" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp lm kr ks kt lq kv kw kx lu kz la lb lc im bi translated">但是，问题是，合同中的另一方有什么好处，因为你可能会也可能不会购买该资产，所以目前持有该资产的另一方实际上履行了合同，因为你最初也支付了一些溢价/费用。因此现在最重要的是<strong class="kh iu">这个溢价应该是多少？</strong></p><p id="a0cb" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp lm kr ks kt lq kv kw kx lu kz la lb lc im bi translated">你在开始时支付一笔额外费用，也就是说。从这个收益我们计算利润为，<strong class="kh iu"> <em class="kg">利润=收益-C</em></strong></p><p id="d0cf" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp lm kr ks kt lq kv kw kx lu kz la lb lc im bi translated">因此，当我们谈论衍生产品定价时，我们试图估计这个<strong class="kh iu"> <em class="kg"> C </em> </strong>。我现在不会深入细节，稍后在讨论几何布朗运动时会涉及到它，但是股票价格变化是使用<strong class="kh iu">随机微分方程</strong>计算的，求解后我们得到:</p><figure class="mf mg mh mi gt ju gh gi paragraph-image"><div class="gh gi mp"><img src="../Images/37ecda6f7df65af6e1b7fb89a08a2eb0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1380/format:webp/1*_ocLvQLJBuoIxE5vrMbzzg.png"/></div><figcaption class="mk ml gj gh gi mm mn bd b be z dk">S(T) Equation as a function of T</figcaption></figure><p id="7446" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp lm kr ks kt lq kv kw kx lu kz la lb lc im bi translated">这里<strong class="kh iu"> <em class="kg"> Z </em> </strong>是另一个随机数，称为标准正态随机变量。我们将来会考虑如何生成这些随机数，但现在让我们假设它们可以由我们自己生成。</p><p id="2244" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp lm kr ks kt lq kv kw kx lu kz la lb lc im bi translated">现在我们知道了在某一时刻<strong class="kh iu"> <em class="kg"> T </em> </strong>的利润，以及在某一时刻<strong class="kh iu"> <em class="kg"> T </em> </strong>的股票价格。对于时间 t=0 我们怎么计算。再次不去赘述细节，将时刻 0 的保费<strong class="kh iu"> <em class="kg"> C </em> </strong> <em class="kg"> </em>表示为<strong class="kh iu"><em class="kg">e【e⁻ʳᵗ(max(s(t)—k)，0)】</em></strong>。</p><p id="c4df" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp lm kr ks kt lq kv kw kx lu kz la lb lc im bi translated">因此，这类似于我们之前看到的<strong class="kh iu"><em class="kg">E[f(U)】</em></strong>。因此，我们再次借助蒙特卡罗模拟来估计 t=0 时的收益。</p><figure class="mf mg mh mi gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mq"><img src="../Images/cff5397d0248c9744b7a378c7f50c14a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RNEuopxVadvhNDu0DOkyaQ.png"/></div></div><figcaption class="mk ml gj gh gi mm mn bd b be z dk">Algorithm to Estimate European Option Payoff</figcaption></figure><p id="5e54" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp lm kr ks kt lq kv kw kx lu kz la lb lc im bi translated">于是我们反复采样<em class="kg"> Z </em>来寻找股票价格值，最后计算欧式期权溢价<strong class="kh iu">C</strong>T56】。</p></div><div class="ab cl mr ms hx mt" role="separator"><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw"/></div><div class="im in io ip iq"><h2 id="fe86" class="ld le it bd lf lg lh dn li lj lk dp ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">生成随机分布</h2><p id="2307" class="pw-post-body-paragraph ke kf it kh b ki lz kk kl km ma ko kp lm mb ks kt lq mc kw kx lu md la lb lc im bi translated">在以前的案例中，唯一缺少的是如何生成均匀随机的，正态随机分布。因此，我们着眼于涵盖生成这种均匀随机分布的算法，以及将这些算法转换成其他分布(如正态分布)的方法。</p><p id="f132" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp lm kr ks kt lq kv kw kx lu kz la lb lc im bi translated">我们将在<strong class="kh iu"><em class="kg">【R】</em></strong>中为这些模拟生成的数字实际上被称为<a class="ae my" href="https://en.wikipedia.org/wiki/Pseudorandom_number_generator" rel="noopener ugc nofollow" target="_blank"> <strong class="kh iu"> <em class="kg">伪随机</em> </strong> </a>数字，它们不是真正随机的，但非常善于模仿真正的随机性。我们使用确定性算法生成它们，使得它们近似于随机数序列的性质。</p><p id="275c" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp lm kr ks kt lq kv kw kx lu kz la lb lc im bi translated"><strong class="kh iu">均匀分布</strong></p><p id="e3da" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp lm kr ks kt lq kv kw kx lu kz la lb lc im bi translated">均匀分布是一种连续分布，缩写为<strong class="kh iu"> <em class="kg"> U(a，b)。</em> </strong>其中<strong class="kh iu">概率密度函数</strong>为</p><figure class="mf mg mh mi gt ju gh gi paragraph-image"><div class="gh gi mz"><img src="../Images/6b4eab70fcb93e04233b4306473df992.png" data-original-src="https://miro.medium.com/v2/resize:fit:794/format:webp/1*mARJPacsPUKHdf6_jHzMMw.png"/></div><figcaption class="mk ml gj gh gi mm mn bd b be z dk">P.D.F of Uniform Distribution</figcaption></figure><p id="986f" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp lm kr ks kt lq kv kw kx lu kz la lb lc im bi translated">产生这种数字的最流行的方法是<strong class="kh iu">线性同余发生器</strong>。LCG 是用以下方法生成的</p><figure class="mf mg mh mi gt ju gh gi paragraph-image"><div class="gh gi na"><img src="../Images/45b4bfa098608033ffc66016c378045b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1074/format:webp/1*vPbWGrN1WGpOnK6HQJyiqA.png"/></div><figcaption class="mk ml gj gh gi mm mn bd b be z dk">Linear Congruential Generator Algorithm</figcaption></figure><p id="2b0e" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp lm kr ks kt lq kv kw kx lu kz la lb lc im bi translated">因此，如果我们选择一个 x₀也称为<strong class="kh iu">种子</strong>。我们可以在<strong class="kh iu">【0，1】</strong>之间生成<strong class="kh iu"> m-1 </strong>唯一的均匀随机数。尽管一个好的估计器必须遵循非零 c 的某些条件。</p><figure class="mf mg mh mi gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nb"><img src="../Images/e61ef72151d326f9ba0748a64cb2b59b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wLsbSHfmj-eNqQcOiPAOOA.png"/></div></div></figure><figure class="mf mg mh mi gt ju"><div class="bz fp l di"><div class="nc nd l"/></div></figure><p id="8815" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp lm kr ks kt lq kv kw kx lu kz la lb lc im bi translated">上面的代码产生均匀的随机数。</p><p id="6a94" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp lm kr ks kt lq kv kw kx lu kz la lb lc im bi translated">现在让我们看看指数分布、正态分布，以及如果我们假设已经有了一个均匀的随机数<strong class="kh iu"><em class="kg"/></strong><em class="kg">，我们如何生成它们。</em></p><p id="5316" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp lm kr ks kt lq kv kw kx lu kz la lb lc im bi translated"><strong class="kh iu">指数分布</strong></p><p id="634e" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp lm kr ks kt lq kv kw kx lu kz la lb lc im bi translated">指数分布可以用<strong class="kh iu">概率密度函数</strong>来表示</p><figure class="mf mg mh mi gt ju gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/e16c37da9f20eedc06d7192f481fba29.png" data-original-src="https://miro.medium.com/v2/resize:fit:684/format:webp/1*tMPJdjY5V3zSCtODdp004A.png"/></div><figcaption class="mk ml gj gh gi mm mn bd b be z dk">P.D.F of Exponential Distribution</figcaption></figure><p id="6b3f" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp lm kr ks kt lq kv kw kx lu kz la lb lc im bi translated">为了使用均匀分布生成它，我们来看一个<strong class="kh iu">逆变换方法</strong></p><figure class="mf mg mh mi gt ju gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/4135c55f1a4276df30ab91c58c8cb777.png" data-original-src="https://miro.medium.com/v2/resize:fit:1224/format:webp/1*54Bgglx_HyO__yp-ivJhKw.png"/></div><figcaption class="mk ml gj gh gi mm mn bd b be z dk">Inverse Transform Equation</figcaption></figure><p id="18e1" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp lm kr ks kt lq kv kw kx lu kz la lb lc im bi translated">因此，使用均匀随机数<strong class="kh iu"><em class="kg"/></strong>并取指数分布的分布函数的反函数，我们可以生成指数随机数<strong class="kh iu"> <em class="kg"> X </em> </strong>。</p><p id="bf6f" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp lm kr ks kt lq kv kw kx lu kz la lb lc im bi translated">逆变换方法的正确性证明如下</p><figure class="mf mg mh mi gt ju gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/7ab7f12c628fba3770273087fb5375f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1370/format:webp/1*qKWZV8pMDgfz6v_LgjWnhA.png"/></div><figcaption class="mk ml gj gh gi mm mn bd b be z dk">Proof of Inverse Transform Method</figcaption></figure><p id="80bb" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp lm kr ks kt lq kv kw kx lu kz la lb lc im bi translated">因此，我们使用这种方法来生成指数分布，其中<strong class="kh iu"><em class="kg">【f⁻(u)</em></strong>给出如下</p><figure class="mf mg mh mi gt ju gh gi paragraph-image"><div class="gh gi nh"><img src="../Images/8fbee5dce15b9d6a5184779da67d8d45.png" data-original-src="https://miro.medium.com/v2/resize:fit:664/format:webp/1*MEsTEipOUybM36O720ujdw.png"/></div><figcaption class="mk ml gj gh gi mm mn bd b be z dk">Exponential Distribution using Inverse Transform Method</figcaption></figure><p id="7b94" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp lm kr ks kt lq kv kw kx lu kz la lb lc im bi translated">这里θ是指数参数 1/α。</p><p id="29c5" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp lm kr ks kt lq kv kw kx lu kz la lb lc im bi translated"><strong class="kh iu">正态分布</strong></p><p id="34f7" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp lm kr ks kt lq kv kw kx lu kz la lb lc im bi translated">正态分布，也称为<strong class="kh iu">高斯分布</strong>，是一种关于均值对称的概率分布，表明接近均值的数据比远离均值的数据出现的频率更高。取决于两个参数——均值和方差的<strong class="kh iu">概率密度函数</strong>为</p><figure class="mf mg mh mi gt ju gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/265661a26f7a9dca0b52918ad4940561.png" data-original-src="https://miro.medium.com/v2/resize:fit:1190/format:webp/1*JW7NinG9mC1TXOI4LkBIKA.png"/></div><figcaption class="mk ml gj gh gi mm mn bd b be z dk">P.D.F of Normal Distribution</figcaption></figure><p id="c1ca" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp lm kr ks kt lq kv kw kx lu kz la lb lc im bi translated">我们将看到一种非常流行的生成标准正态分布的方法，称为<strong class="kh iu"> Box Muller 方法</strong>。</p><p id="c483" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp lm kr ks kt lq kv kw kx lu kz la lb lc im bi translated">该方法基于以下事实:如果我们取一个二元标准正态分布<strong class="kh iu"> <em class="kg"> Z₁，</em> </strong> ~ <strong class="kh iu"> <em class="kg"> N </em> (0，1) </strong>，那么它们遵循两个性质</p><figure class="mf mg mh mi gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nj"><img src="../Images/d3ada36afa77bd292392d996cfe1f0ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*t_dITKoqS77zDYIVUQGZiQ.png"/></div></div></figure><p id="88ca" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp lm kr ks kt lq kv kw kx lu kz la lb lc im bi translated">使用事实(ii)我们生成圆的半径为<strong class="kh iu"><em class="kg">r = sqrt(-2 log(u₁))</em></strong>并且点(<strong class="kh iu"><em class="kg">【z₁】、</em>、</strong>)位于圆中的角度为<strong class="kh iu">、<em class="kg"> V=2 π ( U₂ ) </em>、</strong>使用一对均匀随机数<strong class="kh iu">、<em class="kg"> U₁、U₂.</em> </strong></p><p id="89f0" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp lm kr ks kt lq kv kw kx lu kz la lb lc im bi translated">因此这对<strong class="kh iu"> <em class="kg"> Z₁，</em></strong>z₂将生成为</p><figure class="mf mg mh mi gt ju gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/e1b9f0b0af594c52639edcce119e47d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:886/format:webp/1*nmpfnKFHQ8OCpzTLW8GbSQ.png"/></div></figure><p id="76af" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp lm kr ks kt lq kv kw kx lu kz la lb lc im bi translated">现在让我们看看代码和情节</p><figure class="mf mg mh mi gt ju"><div class="bz fp l di"><div class="nc nd l"/></div></figure><p id="f4ee" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp lm kr ks kt lq kv kw kx lu kz la lb lc im bi translated">在上面的代码<strong class="kh iu">中，R 中的 runif(5000) </strong>用于生成范围<strong class="kh iu"><em class="kg">【0，1】中的 5000 个均匀随机数。</em> </strong>这些然后被用来产生最后 10000 个<strong class="kh iu">标准正态随机变量</strong>。</p><figure class="mf mg mh mi gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nl"><img src="../Images/57588e41ea9c18c78f6a2a3f08f3fde4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VhCDuzNag3N7-7vBjZy1-g.png"/></div></div></figure><p id="44e6" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp lm kr ks kt lq kv kw kx lu kz la lb lc im bi translated">我们可以使用<a class="ae my" href="https://en.wikipedia.org/wiki/Marsaglia_polar_method" rel="noopener ugc nofollow" target="_blank"><strong class="kh iu">marsag lia-Bray</strong></a>算法进一步改进这一点，我不会在本系列中讨论它。你可以在附件的链接上看看。我也鼓励你编写<strong class="kh iu"> Marsaglia-Bray </strong>算法，并检查它与<strong class="kh iu"> Box-Muller </strong>算法相比有多快。</p></div><div class="ab cl mr ms hx mt" role="separator"><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw"/></div><div class="im in io ip iq"><h2 id="818d" class="ld le it bd lf lg lh dn li lj lk dp ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">布朗运动</h2><p id="289f" class="pw-post-body-paragraph ke kf it kh b ki lz kk kl km ma ko kp lm mb ks kt lq mc kw kx lu md la lb lc im bi translated">既然已经介绍了蒙特卡罗模拟和各种随机分布的基础概念，让我们集中使用<strong class="kh iu">蒙特卡罗方法</strong>来模拟各种<a class="ae my" href="https://en.wikipedia.org/wiki/Stochastic_process" rel="noopener ugc nofollow" target="_blank"> <strong class="kh iu">随机过程</strong> </a>的路径。</p><p id="d14f" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp lm kr ks kt lq kv kw kx lu kz la lb lc im bi translated">【T50[0，T] 上的标准布朗运动是一个随机过程{ <strong class="kh iu"> <em class="kg"> W(t)，0</em></strong>≤<strong class="kh iu"><em class="kg">T</em></strong>≤<strong class="kh iu"><em class="kg">T }</em></strong>它满足如下一些性质</p><p id="7ee4" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp lm kr ks kt lq kv kw kx lu kz la lb lc im bi translated">i) <strong class="kh iu"> <em class="kg"> W(0)=0 </em> </strong></p><p id="9b72" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp lm kr ks kt lq kv kw kx lu kz la lb lc im bi translated">ii)对于任何<strong class="kh iu"> <em class="kg"> k </em> </strong>和任何<strong class="kh iu"> <em class="kg"> 0≤ t₁ ≤ t₂ ≤ …。≤ tₖ ≤ T </em> </strong>，任意两个连续的<strong class="kh iu"><em class="kg">【w(tᵢ)-w(tᵢ-₁】</em></strong>之间的增量是独立的。</p><p id="035f" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp lm kr ks kt lq kv kw kx lu kz la lb lc im bi translated">iii)对于任意 0≤ s &lt; t ≤ T，差值<strong class="kh iu"> <em class="kg"> W(t)- W(s) ~ N(0，t-s) </em> </strong></p><p id="5977" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp lm kr ks kt lq kv kw kx lu kz la lb lc im bi translated">作为 I)和 iii) <strong class="kh iu"> <em class="kg">的结果 W(t) ~ N(0，t)。</em>T87】</strong></p><p id="121f" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp lm kr ks kt lq kv kw kx lu kz la lb lc im bi translated">另一方面，非标准的布朗运动会像正态分布一样有两个参数，称为<strong class="kh iu">漂移</strong>和<strong class="kh iu">扩散</strong>。利用<strong class="kh iu"> <em class="kg"> W(t) </em> </strong>我们因此给出了任意布朗运动的<strong class="kh iu">随机微分方程</strong></p><figure class="mf mg mh mi gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nm"><img src="../Images/887094e4942fbb0f1feaf4282a1119b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uuPFrln6SVUzwFiU5HwvGw.png"/></div></div></figure><h2 id="3a19" class="ld le it bd lf lg lh dn li lj lk dp ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">样本路径生成</h2><p id="f7a6" class="pw-post-body-paragraph ke kf it kh b ki lz kk kl km ma ko kp lm mb ks kt lq mc kw kx lu md la lb lc im bi translated">求解上面给出的 SDE，我们可以用 X(tᵢ、μ(s)、σ(s)来写方程</p><figure class="mf mg mh mi gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nn"><img src="../Images/388cc8bd6f428b6f9724f2fcd9293f54.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*A_J4bfi-nAR3EeOm4knt7Q.png"/></div></div><figcaption class="mk ml gj gh gi mm mn bd b be z dk">Solution of Stochastic Differential Equation for Brownian Motion</figcaption></figure><p id="0a3a" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp lm kr ks kt lq kv kw kx lu kz la lb lc im bi translated">因此，让我们看看生成路径的代码，这里我假设μ和σ是常数</p><figure class="mf mg mh mi gt ju"><div class="bz fp l di"><div class="nc nd l"/></div></figure><p id="a5c6" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp lm kr ks kt lq kv kw kx lu kz la lb lc im bi translated">上述代码使用为布朗运动定义的公式为其生成 10 条路径，并使用<strong class="kh iu"> rnorm(1) </strong>一个在<strong class="kh iu"> <em class="kg"> R </em> </strong>中定义的函数来生成标准正态随机变量。</p><figure class="mf mg mh mi gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nl"><img src="../Images/20b3f1d0932d97439cbfc78bf0b7a696.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QUCsrhOHiKl-c2cvsGIpNg.png"/></div></div></figure><p id="e600" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp lm kr ks kt lq kv kw kx lu kz la lb lc im bi translated">上图代表了为标准布朗运动生成的代码的 10 条路径。</p></div><div class="ab cl mr ms hx mt" role="separator"><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw"/></div><div class="im in io ip iq"><h2 id="7181" class="ld le it bd lf lg lh dn li lj lk dp ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated"><strong class="ak">几何布朗运动</strong></h2><p id="1aba" class="pw-post-body-paragraph ke kf it kh b ki lz kk kl km ma ko kp lm mb ks kt lq mc kw kx lu md la lb lc im bi translated">一个随机过程<strong class="kh iu"> <em class="kg"> S(t) </em> </strong>如果差<br/><strong class="kh iu"><em class="kg">log(S(t))-log(S(0))</em></strong>是一个布朗运动，那么这个随机过程就是一个几何布朗运动。基本上，与布朗运动中讨论的性质 ii)相比，这意味着现在，</p><figure class="mf mg mh mi gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi no"><img src="../Images/046c17e9c7e31b76f2ddcd1fa27d243f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oq_vvyTzXcuuRKBo5uNB6w.png"/></div></div></figure><p id="f243" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp lm kr ks kt lq kv kw kx lu kz la lb lc im bi translated">是相互独立的，而不仅仅是布朗运动中的连续差。</p><p id="976f" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp lm kr ks kt lq kv kw kx lu kz la lb lc im bi translated">因此，我们现在用来表示<strong class="kh iu"> GBM </strong>的<strong class="kh iu">随机微分方程</strong>为</p><figure class="mf mg mh mi gt ju gh gi paragraph-image"><div class="gh gi np"><img src="../Images/fb48d1413fe36b5872096ceb7881fd6a.png" data-original-src="https://miro.medium.com/v2/resize:fit:920/format:webp/1*bsDZU0BElq-dXBBKWZ_1Kw.png"/></div><figcaption class="mk ml gj gh gi mm mn bd b be z dk">S.D.E for Geometric Brownian Motion</figcaption></figure><p id="a539" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp lm kr ks kt lq kv kw kx lu kz la lb lc im bi translated">该问题的解决方案与之前用于估计股票价格的等式相同，我在该等式中展示了使用<strong class="kh iu">蒙特卡洛模拟的示例。</strong></p><figure class="mf mg mh mi gt ju gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/f0b879c87004b5151173c5fcda83617a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1124/format:webp/1*JSJQlb0AIo7NqckfmT6-Cg.png"/></div><figcaption class="mk ml gj gh gi mm mn bd b be z dk">Solution of S.D.E for Geometric Brownian Motion</figcaption></figure><p id="695c" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp lm kr ks kt lq kv kw kx lu kz la lb lc im bi translated">其中 W(t)替换为</p><figure class="mf mg mh mi gt ju gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/5242054358cf20a3942b579b15ddb01a.png" data-original-src="https://miro.medium.com/v2/resize:fit:232/format:webp/1*Ry701p63aQcJYdZ2kiR1Uw.png"/></div></figure><p id="a8ee" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp lm kr ks kt lq kv kw kx lu kz la lb lc im bi translated">这就是如何通过使用蒙特卡罗模拟，我们也可以模拟一个<strong class="kh iu">股票价格</strong>或<strong class="kh iu">几何布朗运动的路径。<br/> </strong>对于这样的模拟，我们再次需要<strong class="kh iu">将时间线离散化为一些<strong class="kh iu"><em class="kg"/></strong>点，以生成所有这些点的股票价格。让我们假设初始股票价格为 100</strong></p><figure class="mf mg mh mi gt ju"><div class="bz fp l di"><div class="nc nd l"/></div></figure><p id="9ca6" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp lm kr ks kt lq kv kw kx lu kz la lb lc im bi translated">剧情看起来</p><figure class="mf mg mh mi gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi ns"><img src="../Images/2a266ffe36a746ab91c02fec03ec1834.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rkFYPgyyO5XwBYVqwu6v3Q.png"/></div></div></figure><p id="50c2" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp lm kr ks kt lq kv kw kx lu kz la lb lc im bi translated">因此我们可以使用所有这样的路径最终得到一个<strong class="kh iu"><em class="kg">【T】</em></strong>并计算欧式期权的溢价，最后给出欧式期权价格的平均估计。接下来，我们将看看另一个期权，称为<strong class="kh iu">亚式期权</strong>，它也需要中间股票价格来计算期权价格。</p></div><div class="ab cl mr ms hx mt" role="separator"><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw"/></div><div class="im in io ip iq"><h2 id="e4cb" class="ld le it bd lf lg lh dn li lj lk dp ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated"><strong class="ak">亚式期权定价</strong></h2><p id="af75" class="pw-post-body-paragraph ke kf it kh b ki lz kk kl km ma ko kp lm mb ks kt lq mc kw kx lu md la lb lc im bi translated">在亚式期权中，收益取决于标的资产在一定时期内的<strong class="kh iu">平均价格</strong>，而标准期权只取决于到期价格。</p><figure class="mf mg mh mi gt ju gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/c460832007ecc902427699a4c7c5945a.png" data-original-src="https://miro.medium.com/v2/resize:fit:582/format:webp/1*4LKYZ4h71wolztD1LEk01A.png"/></div><figcaption class="mk ml gj gh gi mm mn bd b be z dk">Average Price Calculation for Asian Option</figcaption></figure><p id="c695" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp lm kr ks kt lq kv kw kx lu kz la lb lc im bi translated">现在的收益是</p><figure class="mf mg mh mi gt ju gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/e6306505b44607ee3273d2895cf962c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:294/format:webp/1*vzKINlNBpxAbEFVURouHcQ.png"/></div><figcaption class="mk ml gj gh gi mm mn bd b be z dk">Payoff of Asian Option</figcaption></figure><p id="3b77" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp lm kr ks kt lq kv kw kx lu kz la lb lc im bi translated">我们对模拟<strong class="kh iu">股票价格</strong>路径的兴趣实际上是在为这些期权定价，特别是因为收益取决于基础资产 s 的路径。</p><p id="ca57" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp lm kr ks kt lq kv kw kx lu kz la lb lc im bi translated">让我们看看<strong class="kh iu">亚式期权定价</strong>的代码</p><figure class="mf mg mh mi gt ju"><div class="bz fp l di"><div class="nc nd l"/></div></figure></div><div class="ab cl mr ms hx mt" role="separator"><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw"/></div><div class="im in io ip iq"><h2 id="28e3" class="ld le it bd lf lg lh dn li lj lk dp ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h2><p id="f28a" class="pw-post-body-paragraph ke kf it kh b ki lz kk kl km ma ko kp lm mb ks kt lq mc kw kx lu md la lb lc im bi translated">我希望你们不仅能公平地了解蒙特卡罗方法，还能了解金融工程领域(期权定价)。现在你应该熟悉蒙特卡罗方法，衍生品定价(欧式和亚式期权)，随机数分布(均匀，指数和正态分布)，R 中编程基础，几何布朗运动及其路径生成。</p></div></div>    
</body>
</html>