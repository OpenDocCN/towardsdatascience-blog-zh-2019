<html>
<head>
<title>My Compilation of Simple Yet Practical Data Cleaning Codes</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我汇编的简单而实用的数据清理代码</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/my-compilation-of-simple-yet-practical-data-cleaning-codes-d692ec20dca8?source=collection_archive---------13-----------------------#2019-06-21">https://towardsdatascience.com/my-compilation-of-simple-yet-practical-data-cleaning-codes-d692ec20dca8?source=collection_archive---------13-----------------------#2019-06-21</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="0e63" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">为了解决混乱数据的常见情况</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/9f4f2ebef43e377639a918f2b9d2d6f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ZdY1W3dTkx6CVaSS"/></div></div></figure><p id="e767" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">长话短说，这份数据清理代码汇编是我上一篇文章的更新版本— <a class="ae lq" rel="noopener" target="_blank" href="/the-simple-yet-practical-data-cleaning-codes-ad27c4ce0a38"> <strong class="kw iu">简单而实用的数据清理代码</strong> </a> <strong class="kw iu"> </strong>出乎意料地火了起来。</p><p id="bb11" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我收到了来自数据科学家和数据专业人员的大量消息，介绍工具箱如何帮助他们完成日常的数据清理任务，我希望通过使用我最新汇编的数据清理代码来更新工具箱，使其更加完整。</p><p id="2db3" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在本文结束时，我希望您会发现一些对您的数据清理任务有帮助的数据清理代码，并且您可以在尽可能短的时间内实现它们。</p><p id="11da" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">把这个工具箱想象成你作为一个数据科学家的武器库，它有一个通用和有用代码的集合，你可以对它们稍加修改或不加修改地执行你的普通数据清理任务。</p><p id="3687" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们开始吧！</p><h1 id="fbcc" class="lr ls it bd lt lu lv lw lx ly lz ma mb jz mc ka md kc me kd mf kf mg kg mh mi bi translated"><strong class="ak">你为什么需要这个工具箱？</strong></h1><blockquote class="mj"><p id="aa33" class="mk ml it bd mm mn mo mp mq mr ms lp dk translated">世界是不完美的，数据也是。</p></blockquote><p id="b9cd" class="pw-post-body-paragraph ku kv it kw b kx mt ju kz la mu jx lc ld mv lf lg lh mw lj lk ll mx ln lo lp im bi translated">无论您是有抱负的数据科学家、有经验的数据科学家还是数据分析师，都没有关系。</p><p id="ad56" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在开始分析和理解数据之前，您可能已经有 40%-70%的时间陷入了数据清理任务。</p><p id="07f7" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">是的，现实是这个过程通常是不可避免的(除非有人帮你清理数据)。</p><p id="5722" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">就我个人而言，我已经经历过这段时间的耗时和繁琐的部分，因为数据清理实在是太重要了，不容忽视。</p><p id="0cd4" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">因此，就在几个月前，我开始为数据清理任务构建我的个人工具箱，因为我注意到许多数据清理代码实际上可以重复用于许多常见的数据清理任务。</p><p id="e17a" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">换句话说，<strong class="kw iu">这些代码可以被推广用于其他常见的数据清理场景，在这些场景中，它们具有相似的模式</strong>——因此我编译了所有以前的数据清理代码。</p><p id="2526" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这是至关重要的，因为我的工具箱节省了我思考和搜索的大量时间，因为我可以在几秒钟内从我的代码库中<strong class="kw iu"/>“复制和修改”。</p><p id="a9c8" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">通过与您分享这个工具箱，我希望能够节省您的时间，并使您的数据科学工作流程更加高效，以便您可以专注于其他重要任务。</p></div><div class="ab cl my mz hx na" role="separator"><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd"/></div><div class="im in io ip iq"><h1 id="f993" class="lr ls it bd lt lu nf lw lx ly ng ma mb jz nh ka md kc ni kd mf kf nj kg mh mi bi translated">我更新的数据清理工具箱</h1><p id="7c4c" class="pw-post-body-paragraph ku kv it kw b kx nk ju kz la nl jx lc ld nm lf lg lh nn lj lk ll no ln lo lp im bi translated">下面的代码是在以前的数据清理代码基础上添加的。请随意查看我的上一篇文章— <a class="ae lq" rel="noopener" target="_blank" href="/the-simple-yet-practical-data-cleaning-codes-ad27c4ce0a38"> <strong class="kw iu">简单而实用的数据清理代码</strong> </a> <strong class="kw iu"> </strong>了解更多的数据清理代码。</p><p id="fabb" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在下面的代码片段中，出于不言自明的目的，代码是用函数编写的。您总是可以直接使用这些代码，而无需将它们放入参数稍有变化的函数中。</p><h2 id="6bc0" class="np ls it bd lt nq nr dn lx ns nt dp mb ld nu nv md lh nw nx mf ll ny nz mh oa bi translated">1.重命名列名</h2><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ob oc l"/></div></figure><p id="3615" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">当面对有大写字母或中间有空格的列名时，我们经常需要改变列名，用小写字母和下划线替换它们——这样更简洁、更生动。此外，我们希望列名尽可能明确，这样您的朋友只需查看列名就能大致了解列包含的内容。</p><p id="c535" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">听起来微不足道，但很重要。</p><h2 id="d977" class="np ls it bd lt nq nr dn lx ns nt dp mb ld nu nv md lh nw nx mf ll ny nz mh oa bi translated">2.列表理解</h2><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ob oc l"/></div></figure><p id="0b7f" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">你可能认为列表理解是如此普遍，并想知道这怎么能被认为是数据清理的一部分。嗯……对我来说，列表理解是如此的优雅和简洁，以至于你可以在一行代码中抽象出你的逻辑，而不需要任何 for 循环，并且计算起来比 for 循环快得多。</p><p id="b0e5" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">通常，如果我想获得一个基于特定条件的值列表以附加到现有的数据帧或用于进一步分析，我会使用列表理解。</p><h2 id="fd59" class="np ls it bd lt nq nr dn lx ns nt dp mb ld nu nv md lh nw nx mf ll ny nz mh oa bi translated">3.为特定列输出不带 NaN 值的数据帧</h2><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ob oc l"/></div></figure><p id="f041" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">当您希望输出一个包含列中所有可用数据的数据帧时，这很有用。</p><p id="318b" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">例如，您有一个包含所有客户信息的数据帧，您希望输出一个包含所有可用客户 ID 的更新数据帧，并删除缺少客户 ID 的行。在这种情况下，代码应该是这样的:<code class="fe od oe of og b">df = df[df['id'].notnull()]</code>。</p><p id="8fa8" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">类似的概念可以应用于列为<code class="fe od oe of og b">timestamp</code>的时间序列数据。</p><h2 id="d29e" class="np ls it bd lt nq nr dn lx ns nt dp mb ld nu nv md lh nw nx mf ll ny nz mh oa bi translated">4.基于列中唯一的最后一个字符串输出数据帧</h2><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ob oc l"/></div></figure><p id="09cf" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">使用包含所有客户信息的数据帧，并为每个<code class="fe od oe of og b">id</code>添加一列<code class="fe od oe of og b">timestamp</code>。</p><p id="d2e6" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">现在每一个<code class="fe od oe of og b">id</code>都不是唯一的，它会在各自的时间段重复出现。对于每个<code class="fe od oe of og b">id</code>，您希望获得<code class="fe od oe of og b">id</code>的最后一行，因为您只关心每个<code class="fe od oe of og b">id</code>的最终客户信息。</p><p id="a499" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这时，您可以使用上面的代码片段删除所有重复的<code class="fe od oe of og b">id</code>，只保留最后一行。这确保了我们总是获得具有唯一性<code class="fe od oe of og b">id</code>的最终客户信息。同样，这只需要一行代码就可以完成！</p><h2 id="0779" class="np ls it bd lt nq nr dn lx ns nt dp mb ld nu nv md lh nw nx mf ll ny nz mh oa bi translated">5.从数值中获取离散区间</h2><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ob oc l"/></div></figure><p id="451e" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这是我最喜欢的工具之一，当涉及到<a class="ae lq" href="https://pandas.pydata.org/pandas-docs/version/0.23.4/generated/pandas.cut.html" rel="noopener ugc nofollow" target="_blank">根据指定的范围将一列中的数值转换成离散的区间时</a>。如果你想把一个连续变量转换成一个分类变量，我强烈推荐你使用<code class="fe od oe of og b">pd.cut</code>。</p><p id="1644" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">例如，在上面的代码片段中，我们有一个由从 1 到 10 的数值组成的<code class="fe od oe of og b">rating</code>列。<strong class="kw iu">如果我们想将这些评分值转换为给定值和指定范围内的特定组，该怎么办？</strong>给定使用<code class="fe od oe of og b">pd.cut</code>指定的范围，我们可以在离散区间中存储值，并将它们标记为<code class="fe od oe of og b">bad, moderate, good, strong</code>。</p><p id="dd85" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><code class="fe od oe of og b">pd.cut</code>的另一个常见用例是将年龄转换成年龄范围组，这样就可以将每个年龄归类到一个标签中。</p></div><div class="ab cl my mz hx na" role="separator"><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd"/></div><div class="im in io ip iq"><h1 id="401e" class="lr ls it bd lt lu nf lw lx ly ng ma mb jz nh ka md kc ni kd mf kf nj kg mh mi bi translated">最后的想法</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/ea35347b13ab54975fedec221565e680.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*_8wrIi4p9j_IURy0"/></div></div><figcaption class="oh oi gj gh gi oj ok bd b be z dk"><a class="ae lq" href="https://unsplash.com/photos/4K2lIP0zc_k" rel="noopener ugc nofollow" target="_blank">(Source)</a></figcaption></figure><p id="96b5" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">感谢您的阅读。</p><p id="6398" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在本文结束时，我希望您会发现这些小工具对您的常见数据清理任务很有用，并且会使您的工作更有效率，当然，对于那些必须不时处理杂乱数据的人来说，生活会轻松得多。</p><p id="7541" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">同样，代码本质上实现起来相对简单。我希望这个更新的数据清理工具箱——以及我在我的<a class="ae lq" rel="noopener" target="_blank" href="/the-simple-yet-practical-data-cleaning-codes-ad27c4ce0a38">上一篇文章</a>中分享的工具箱——给你更多的方便和信心来执行数据清理，以及根据我的经验更好地了解数据集通常是什么样子。</p><p id="3024" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">一如既往，如果您有任何问题或意见，请随时在下面留下您的反馈，或者您可以随时通过<a class="ae lq" href="https://www.linkedin.com/in/admond1994/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>联系我。在那之前，下一篇文章再见！😄</p></div><div class="ab cl my mz hx na" role="separator"><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd"/></div><div class="im in io ip iq"><h2 id="5fc3" class="np ls it bd lt nq nr dn lx ns nt dp mb ld nu nv md lh nw nx mf ll ny nz mh oa bi translated">关于作者</h2><p id="5193" class="pw-post-body-paragraph ku kv it kw b kx nk ju kz la nl jx lc ld nm lf lg lh nn lj lk ll no ln lo lp im bi translated"><a class="ae lq" href="https://www.linkedin.com/in/admond1994/" rel="noopener ugc nofollow" target="_blank"> <strong class="kw iu"> Admond Lee </strong> </a>目前是东南亚排名第一的商业银行 API 平台<a class="ae lq" href="https://www.trystaq.com" rel="noopener ugc nofollow" target="_blank"><strong class="kw iu">Staq</strong></a><strong class="kw iu">—</strong>的联合创始人/首席技术官。</p><p id="f20d" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">想要获得免费的每周数据科学和创业见解吗？</p><p id="f2b1" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><a class="ae lq" href="https://bit.ly/3pGF8jv" rel="noopener ugc nofollow" target="_blank"> <strong class="kw iu">加入 Admond 的电子邮件简讯——Hustle Hub</strong></a>，每周他都会在那里分享可行的数据科学职业建议、错误&amp;以及从创建他的初创公司 Staq 中学到的东西。</p><p id="c060" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">你可以在<a class="ae lq" href="https://www.linkedin.com/in/admond1994/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>、<a class="ae lq" href="https://medium.com/@admond1994" rel="noopener"> Medium </a>、<a class="ae lq" href="https://twitter.com/admond1994" rel="noopener ugc nofollow" target="_blank"> Twitter </a>、<a class="ae lq" href="https://www.facebook.com/admond1994" rel="noopener ugc nofollow" target="_blank">脸书</a>上和他联系。</p><div class="ol om gp gr on oo"><a href="https://www.admondlee.com/" rel="noopener  ugc nofollow" target="_blank"><div class="op ab fo"><div class="oq ab or cl cj os"><h2 class="bd iu gy z fp ot fr fs ou fu fw is bi translated">阿德蒙德·李</h2><div class="ov l"><h3 class="bd b gy z fp ot fr fs ou fu fw dk translated">让每个人都能接触到数据科学。Admond 正在通过先进的社交分析和机器学习，利用可操作的见解帮助公司和数字营销机构实现营销投资回报。</h3></div><div class="ow l"><p class="bd b dl z fp ot fr fs ou fu fw dk translated">www.admondlee.com</p></div></div><div class="ox l"><div class="oy l oz pa pb ox pc ks oo"/></div></div></a></div></div></div>    
</body>
</html>