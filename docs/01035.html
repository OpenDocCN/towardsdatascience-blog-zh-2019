<html>
<head>
<title>Measuring Performance: The Confusion Matrix</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">衡量绩效:困惑矩阵</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/measuring-performance-the-confusion-matrix-25c17b78e516?source=collection_archive---------19-----------------------#2019-02-17">https://towardsdatascience.com/measuring-performance-the-confusion-matrix-25c17b78e516?source=collection_archive---------19-----------------------#2019-02-17</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="73dd" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">混淆矩阵是使用模型对数据集的预测来计算的。通过查看混淆矩阵，您可以更好地了解您的模型的优点和缺点，并且可以更好地比较两个备选模型，以了解哪一个更适合您的应用程序。传统上，混淆矩阵是使用模型对保留测试集的预测来计算的。</p><p id="26ba" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这是一个混淆矩阵:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi ko"><img src="../Images/2ba650261f0bd9e9367dabd7d596d370.png" data-original-src="https://miro.medium.com/v2/resize:fit:862/0*AN_NBuYefGEHm6hP"/></div></figure><p id="046e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">列标签“实际阳性”和“实际阴性”是指数据集中的基本事实标签，即手写数字是真正的 1 还是 0，患者是否真正被诊断患有疾病(1)或不是(0)，胸部 x 光片是否实际显示肺炎(1)或不是(0)等。</p><p id="03c3" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">行标签“预测正”和“预测负”指的是您的模型的预测，即您的模型认为标签是什么。</p><p id="4522" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">注意混淆矩阵(TPs，FPs，FNs，TNs)内的条目是<em class="kw">计数:</em></p><ul class=""><li id="50ff" class="kx ky it js b jt ju jx jy kb kz kf la kj lb kn lc ld le lf bi translated">真阳性(TPs):模型正确分类为阳性的阳性样本的数量</li><li id="24a5" class="kx ky it js b jt lg jx lh kb li kf lj kj lk kn lc ld le lf bi translated">真实否定(TNs):模型正确分类为否定的否定例子的数量</li><li id="2cb2" class="kx ky it js b jt lg jx lh kb li kf lj kj lk kn lc ld le lf bi translated">假阳性(FPs):被模型错误分类为阳性的阴性样本的数量(即被错误分类为“阳性”的阴性样本)</li><li id="05a4" class="kx ky it js b jt lg jx lh kb li kf lj kj lk kn lc ld le lf bi translated">假阴性(FNs):被模型错误分类为阴性的阳性样本的数量(即被错误分类为“阴性”的阳性样本)</li></ul><p id="8b44" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">真阳性率和假阳性率</strong></p><p id="e6db" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">您可以使用混淆矩阵来计算真阳性率(TPR)和假阳性率(FPR)。稍后将需要 TPR 和 FPR 来计算接收机工作特性(AUROC)下的面积，AUROC 是一个流行的性能指标。</p><p id="29be" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">真阳性率=真阳性/所有阳性=真阳性/(真阳性+假阴性)</p><p id="71c3" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">假阳性率=假阳性/全部阴性=假阳性/(假阳性+真阴性)</p><p id="e59a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">即</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi ll"><img src="../Images/77b85df24f2ccb0f976ee6259a40683d.png" data-original-src="https://miro.medium.com/v2/resize:fit:708/0*rbhMO8b1pdpytYOR"/></div></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi lm"><img src="../Images/22e7da9ee7d48a8175dc5b5774178729.png" data-original-src="https://miro.medium.com/v2/resize:fit:596/0*UlFLVw21DwiV-l2_"/></div></figure><p id="f7e1" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">(<a class="ae ln" href="https://en.wikipedia.org/wiki/Confusion_matrix" rel="noopener ugc nofollow" target="_blank"> ref </a></p><p id="0de3" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">(在上面的公式中，FNR =假阴性率，TNR =真阴性率，这些是可以从混淆矩阵中计算出来的其他量。)</p><p id="b1a8" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">精度</strong></p><p id="ddc2" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">你也可以使用混淆矩阵来计算精度。稍后将需要精度以及真实的阳性率(也称为“召回”)，来计算精度-召回曲线下的面积(AUPRC)，这是另一个流行的性能指标。</p><p id="03c8" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">精度=真阳性/(真阳性+假阳性)</p><p id="2105" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">即</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi lo"><img src="../Images/d0d73d86104d23a85ce008b1d2d95786.png" data-original-src="https://miro.medium.com/v2/resize:fit:616/0*bKcLI6G84mcXqkYz"/></div></figure><p id="d338" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">(<a class="ae ln" href="https://en.wikipedia.org/wiki/Confusion_matrix" rel="noopener ugc nofollow" target="_blank">参考</a>)</p><p id="6128" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">决策阈值</strong></p><p id="4168" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">决策阈值允许您将预测概率转换为预测标签。如果模型输出概率，则必须使用决策阈值将这些概率转换为预测标签。一旦你有了预测的标签，你就可以计算一个混淆矩阵。您还需要预测标签来计算 AUROC 和 AUPRC，使用不同的决策阈值进行计算。</p><p id="a0fe" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">“决策阈值”就是您选择用来与某个概率进行比较的数字，以决定该概率应该指示正类还是负类。</p><p id="03f7" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">常见的决策阈值是 0.5，这意味着任何小于 0.5 的概率都被认为是否定类别的一部分，而任何大于 0.5 的概率都被认为属于肯定类别。</p><p id="5209" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">然而，实际上你可以选择任何你想要的决策阈值。您可以将决策阈值设为 0.99，这样一个例子的预测概率必须大于 0.99 才能被认为是“肯定的”。这意味着你的大多数例子会被认为是负面的。</p><p id="176e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">极限决策阈值</strong></p><p id="cb6b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果选择决策阈值为 0，则每个示例都将被认为是正面的:</p><ul class=""><li id="fed6" class="kx ky it js b jt ju jx jy kb kz kf la kj lb kn lc ld le lf bi translated">这意味着每个例子要么是真阳性，要么是假阳性</li><li id="0250" class="kx ky it js b jt lg jx lh kb li kf lj kj lk kn lc ld le lf bi translated">真正的正率将是 1 (TPR = TP / (TP + FN)但 FN = 0，所以 TPR = TP/TP = 1)</li><li id="a48a" class="kx ky it js b jt lg jx lh kb li kf lj kj lk kn lc ld le lf bi translated">假阳性率将是 1 (FPR = FP / (FP + TN)但是 TN = 0，所以 FPR = FP/FP = 1)</li><li id="9930" class="kx ky it js b jt lg jx lh kb li kf lj kj lk kn lc ld le lf bi translated">精度的值将取决于数据的偏差。如果数据集中实际阳性和实际阴性数量相等，则精度为 0.5(精度= TP / (TP + FP) = 50 / (50+50) = 0.5)。如果实际阳性多得多，精度会大于 0.5；如果实际底片多得多，精度会小于 0.5。</li></ul><p id="0fbf" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果选择决策阈值 1，则每个示例都将被认为是负面的:</p><ul class=""><li id="8280" class="kx ky it js b jt ju jx jy kb kz kf la kj lb kn lc ld le lf bi translated">这意味着每个例子要么是真阴性，要么是假阴性</li><li id="7d86" class="kx ky it js b jt lg jx lh kb li kf lj kj lk kn lc ld le lf bi translated">真正的正率将是 0 (TPR = TP / (TP + FN)但是 TP = 0，所以 TPR = 0)</li><li id="fd92" class="kx ky it js b jt lg jx lh kb li kf lj kj lk kn lc ld le lf bi translated">假阳性率将是 0 (FPR = FP / (FP + TN)但是 FP = 0，所以 FPR = 0)</li><li id="2834" class="kx ky it js b jt lg jx lh kb li kf lj kj lk kn lc ld le lf bi translated">从技术上讲，精度将是未定义的(精度= TP / (TP + FP) = 0/0)</li></ul><p id="3467" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">如何选择决策阈值</strong></p><p id="e0fe" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">决策阈值的选择取决于模型的下游应用。</p><p id="70f2" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">例如:在某些医疗应用中，假阴性可能比假阳性更糟糕，例如，在皮肤病学照片的自动分类中，您不想错过一个黑色素瘤病例。在这种情况下，您希望选择较低的决策阈值，以便将更多的示例分类为阳性，这将降低您的假阴性率，但会增加假阳性率。</p><p id="f4e5" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">例子:想象一下，在一个社会中，预测模型被用来决定罪犯是应该被说服还是被释放。在这种情况下，假阳性可能比假阴性更糟糕，例如，如果模型错误地确定一个无辜的人有罪，并把那个人送进监狱，那就太糟糕了。(谢天谢地，这一场景仍在反乌托邦科幻小说中，至少目前如此……)</p><p id="de2b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">AUROC 和 AUPRC 曲线还可以帮助您直观地了解不同决策阈值导致的权衡，并帮助您为模型的下游应用选择一个好的决策阈值。</p><p id="53a1" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">其他名称</strong></p><ul class=""><li id="ab4b" class="kx ky it js b jt ju jx jy kb kz kf la kj lb kn lc ld le lf bi translated">真正的阳性率也称为敏感度、回忆率或命中率</li><li id="9ddc" class="kx ky it js b jt lg jx lh kb li kf lj kj lk kn lc ld le lf bi translated">精确度也称为阳性预测值(PPV)</li></ul><p id="9f76" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">混乱矩阵的更多细节</strong></p><p id="88c8" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">维基百科上有<a class="ae ln" href="https://en.wikipedia.org/wiki/Confusion_matrix" rel="noopener ugc nofollow" target="_blank">一篇关于混淆矩阵的伟大文章</a>。它包括关于可以从混淆矩阵计算的其他量的更多细节，包括特异性(也称为选择性或真阴性率)和阴性预测值。</p><p id="e18e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">敬请关注未来关于 AUROC 和 AUPRC 的帖子，这两个都是机器学习模型非常有用的性能指标。</p></div><div class="ab cl lp lq hx lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="im in io ip iq"><p id="4ba2" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><em class="kw">原载于 2019 年 2 月 17 日</em><a class="ae ln" href="https://glassboxmedicine.com/2019/02/17/measuring-performance-the-confusion-matrix/" rel="noopener ugc nofollow" target="_blank"><em class="kw">http://glassboxmedicine.com</em></a><em class="kw">。</em></p></div></div>    
</body>
</html>