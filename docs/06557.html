<html>
<head>
<title>Data Science Fundamentals (R): Import &amp; Export Data from Excel — xlsx</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">数据科学基础(R):从 Excel 导入和导出数据— xlsx</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/data-science-fundamentals-r-import-export-data-in-excel-xlsx-bdb12a588735?source=collection_archive---------21-----------------------#2019-09-19">https://towardsdatascience.com/data-science-fundamentals-r-import-export-data-in-excel-xlsx-bdb12a588735?source=collection_archive---------21-----------------------#2019-09-19</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div class="gh gi jq"><img src="../Images/5c0d1debcc5d3e1bff7f862289f94577.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/0*s6aXp2VX0uRZZ8-t.png"/></div></figure><p id="f59b" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated"><strong class="jz iu">数据科学是一个非常广泛的话题，在进入这个巨大的森林之前，你应该知道正确导入和导出数据这一最基础的部分。</strong>没有数据，你就无法执行所有的机器学习技术或得出有见地的分析。你可能认为导入和导出非常容易，只需要一个简单的代码和里面的文件名。我以前也有同样的感觉，但是后来，我意识到有一些关键的参数需要更改(尤其是如果数据涉及到文本)，否则，您将不会以您想要的方式获得数据。你会看到下面的例子。</p><p id="ed0f" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated"><strong class="jz iu">这篇文章会给你一个使用 R 包的总结，</strong> <code class="fe kv kw kx ky b"><strong class="jz iu">xlsx</strong></code> <strong class="jz iu">。</strong>您将了解如何导入和导出具有不同功能的 excel 文件，以及它们之间的区别。</p><p id="5ee1" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">其他导入和导出包在系列中讨论。</p><div class="kz la gp gr lb lc"><a href="https://medium.com/series/data-science-fundamentals-r-import-export-data-14667fed24a8" rel="noopener follow" target="_blank"><div class="ld ab fo"><div class="le ab lf cl cj lg"><h2 class="bd iu gy z fp lh fr fs li fu fw is bi translated">数据科学基础(R) —导入和导出数据</h2><div class="lj l"><h3 class="bd b gy z fp lh fr fs li fu fw dk translated">数据科学基础(R):从 Excel 导入和导出数据— xlsx</h3></div><div class="lk l"><p class="bd b dl z fp lh fr fs li fu fw dk translated">medium.com</p></div></div><div class="ll l"><div class="lm l ln lo lp ll lq jv lc"/></div></div></a></div></div><div class="ab cl lr ls hx lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="im in io ip iq"><h1 id="b6cb" class="ly lz it bd ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv bi translated">包裹</h1><p id="9b63" class="pw-post-body-paragraph jx jy it jz b ka mw kc kd ke mx kg kh ki my kk kl km mz ko kp kq na ks kt ku im bi translated">xlsx</p><h1 id="94b8" class="ly lz it bd ma mb nb md me mf nc mh mi mj nd ml mm mn ne mp mq mr nf mt mu mv bi translated">功能</h1><p id="0ba7" class="pw-post-body-paragraph jx jy it jz b ka mw kc kd ke mx kg kh ki my kk kl km mz ko kp kq na ks kt ku im bi translated">读取、写入和格式化 Excel 2007 和 Excel 97/2000/XP/2003 文件</p><h1 id="6bea" class="ly lz it bd ma mb nb md me mf nc mh mi mj nd ml mm mn ne mp mq mr nf mt mu mv bi translated">描述</h1><p id="fd4d" class="pw-post-body-paragraph jx jy it jz b ka mw kc kd ke mx kg kh ki my kk kl km mz ko kp kq na ks kt ku im bi translated">xlsx 包使用 r 对 Excel 文件进行编程控制。高级 API 允许用户<strong class="jz iu">将一张 xlsx 文档读入 data.frame </strong>并将<strong class="jz iu"> data.frame 写入文件</strong>。较低级别的功能允许直接操作表、行和单元格。例如，用户<strong class="jz iu">具有</strong> <strong class="jz iu">控件来设置颜色、字体、数据格式、添加边框、隐藏/取消隐藏工作表、添加/移除行、添加/移除工作表等</strong>。</p></div><div class="ab cl lr ls hx lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="im in io ip iq"><h1 id="409e" class="ly lz it bd ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv bi translated">示范</h1><p id="5a60" class="pw-post-body-paragraph jx jy it jz b ka mw kc kd ke mx kg kh ki my kk kl km mz ko kp kq na ks kt ku im bi translated">输入数据包括英文文本、数字、繁体中文文本和简体中文文本。</p><p id="6482" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">在本演示结束时，您将知道应该指定哪些选项来导入和导出 r 中不同格式的上下文数据。</p><blockquote class="ng nh ni"><p id="dc7e" class="jx jy nj jz b ka kb kc kd ke kf kg kh nk kj kk kl nl kn ko kp nm kr ks kt ku im bi translated"><strong class="jz iu">要测试的功能(默认设置)</strong></p><p id="fe62" class="jx jy nj jz b ka kb kc kd ke kf kg kh nk kj kk kl nl kn ko kp nm kr ks kt ku im bi translated">read.xlsx (file，sheetIndex，sheetName=NULL，rowIndex=NULL，startRow=NULL，endRow=NULL，colIndex=NULL，as.data.frame=TRUE，header=TRUE，colClasses=NA，keepFormulas=FALSE，encoding="unknown "，password=NULL，…)</p><p id="9932" class="jx jy nj jz b ka kb kc kd ke kf kg kh nk kj kk kl nl kn ko kp nm kr ks kt ku im bi translated">read.xlsx2 (file，sheetIndex，sheetName=NULL，startRow=1，colIndex=NULL，endRow=NULL，as.data.frame=TRUE，header=TRUE，colClasses="character "，password=NULL，…)</p><p id="9625" class="jx jy nj jz b ka kb kc kd ke kf kg kh nk kj kk kl nl kn ko kp nm kr ks kt ku im bi translated">write.xlsx (x，file，sheetName="Sheet1 "，col.names=TRUE，row.names=TRUE，append=FALSE，showNA=TRUE，password=NULL)</p><p id="a819" class="jx jy nj jz b ka kb kc kd ke kf kg kh nk kj kk kl nl kn ko kp nm kr ks kt ku im bi translated">write.xlsx2 (x，file，sheetName="Sheet1 "，col.names=TRUE，row.names=TRUE，append=FALSE，password=NULL，…)</p></blockquote></div><div class="ab cl lr ls hx lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="im in io ip iq"><h1 id="e02a" class="ly lz it bd ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv bi translated">导入文件</h1><figure class="nn no np nq gt ju gh gi paragraph-image"><div class="gh gi jq"><img src="../Images/f988491a8f776cb82e1366c9624dc6ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/0*hGLBPHSkQIxYnoSu.PNG"/></div><figcaption class="nr ns gj gh gi nt nu bd b be z dk">Reference_Sample.xlsx</figcaption></figure><pre class="nn no np nq gt nv ky nw nx aw ny bi"><span id="bb6a" class="nz lz it ky b gy oa ob l oc od">#############<br/>library(xlsx)<br/>#############<br/># read excel xlsx - method 1</span><span id="2dd2" class="nz lz it ky b gy oe ob l oc od">xlsx_df = read.xlsx(file="Reference_Sample.xlsx", sheetName="Sample_Sheet", header=T, stringsAsFactors=F, encoding="UTF-8")</span></pre><figure class="nn no np nq gt ju gh gi paragraph-image"><div class="gh gi jq"><img src="../Images/d911f76697ecb8e7029bf5847570a149.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/0*i40S66ULdLY-g4eB.PNG"/></div></figure><pre class="nn no np nq gt nv ky nw nx aw ny bi"><span id="4487" class="nz lz it ky b gy oa ob l oc od">str(xlsx_df)</span></pre><figure class="nn no np nq gt ju gh gi paragraph-image"><div class="gh gi of"><img src="../Images/ae191b0fd67c573dcbc8a663c87e30bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/0*9Mo1N3ywiV8h7f4D.PNG"/></div></figure><p id="ace7" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">header=T 在 r 中检索 xlsx 文件的标题。</p><p id="1b49" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">使用 stringsAsFactors=F 代替 T，因为我们不希望 R 将字符输入视为因子。</p><p id="2f66" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">你可以发现，由于编码设置为“UTF-8”，所以汉字是用 UTF 码显示的。如果未设置编码，将显示乱码。</p><figure class="nn no np nq gt ju gh gi paragraph-image"><div class="gh gi of"><img src="../Images/0d9f21f6cafbfef2c651855be0818244.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/0*nhMEATSl5UdCugNx.PNG"/></div></figure><p id="3b21" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">如果要显示中文字符或其他语言的特定字符，应该预先设置区域设置。在本例中，应该指定 local = "Chinese"。</p><p id="08bd" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated"><strong class="jz iu"> <em class="nj"> local = "cht "只能显示繁体中文文本，local = "Chinese "可以显示繁体和简体中文两种文字。</em>T3】</strong></p><pre class="nn no np nq gt nv ky nw nx aw ny bi"><span id="e4cc" class="nz lz it ky b gy oa ob l oc od">Sys.setlocale(category = "LC_ALL", locale = "Chinese")<br/># read excel xlsx - method 1</span><span id="96cb" class="nz lz it ky b gy oe ob l oc od">xlsx_df = read.xlsx(file="Reference_Sample.xlsx", sheetName="Sample_Sheet", header=T, stringsAsFactors=F, encoding="UTF-8")</span></pre><figure class="nn no np nq gt ju gh gi paragraph-image"><div class="gh gi of"><img src="../Images/e83a4880973de9e82ad545e3b9b3b51f.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/0*SIhNoWU80bn1behZ.PNG"/></div></figure><pre class="nn no np nq gt nv ky nw nx aw ny bi"><span id="babf" class="nz lz it ky b gy oa ob l oc od"># read excel xlsx - method 2<br/>xlsx_df2 = read.xlsx2(file="Reference_Sample.xlsx", sheetName="Sample_Sheet", header=T, stringsAsFactors=F)</span></pre><figure class="nn no np nq gt ju gh gi paragraph-image"><div class="gh gi of"><img src="../Images/595024cfc6961e8c98edc297b9caec4f.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/0*dDo6f_9U0qvvn95C.PNG"/></div></figure><p id="7b15" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">您会发现两种方法，即 read.xlsx 和 read.xlsx2，都以相同的格式显示数据。由于默认编码是“UTF-8”，因此如果区域设置正确，即区域设置为“中文”，应该会显示相同的输出。然而，当您检查 xlsx_df2 的结构时，您可以发现一些不同之处。</p><pre class="nn no np nq gt nv ky nw nx aw ny bi"><span id="cd9a" class="nz lz it ky b gy oa ob l oc od">str(xlsx_df2)</span></pre><figure class="nn no np nq gt ju gh gi paragraph-image"><div class="gh gi of"><img src="../Images/a49ad2808fd5169ba981ad1b8365de74.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/0*sHf7Vh7Qskhm6DXq.PNG"/></div></figure><p id="3abb" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">所有变量的结构都变成字符。如果以后要做计算，可能会造成不便。</p><p id="4feb" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">使用 read.xlsx 和 read.xlsx2 时，如果列名包含空格，则所有空格都更改为“.”</p><p id="50a3" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">因此，当您使用列名对列进行选择时，您需要使用新的名称，即“Traditional”。中文”和“简体”。中国人”在这种情况下。</p></div><div class="ab cl lr ls hx lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="im in io ip iq"><h1 id="7cfb" class="ly lz it bd ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv bi translated">导出文件</h1><p id="69bd" class="pw-post-body-paragraph jx jy it jz b ka mw kc kd ke mx kg kh ki my kk kl km mz ko kp kq na ks kt ku im bi translated">以下部分是编写 excel 输出的演示。</p><pre class="nn no np nq gt nv ky nw nx aw ny bi"><span id="49e4" class="nz lz it ky b gy oa ob l oc od"># write excel xlsx - method 1</span><span id="572c" class="nz lz it ky b gy oe ob l oc od">write.xlsx(xlsx_df, file="Output1.xlsx", sheetName="Sample_Sheet", row.names=F, showNA=F)</span></pre><figure class="nn no np nq gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="og oh di oi bf oj"><div class="gh gi of"><img src="../Images/db5361aff20ffc8f44236420ba7c844f.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/0*uOB30W1e-66kpsy4.PNG"/></div></div></figure><p id="e308" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">指示 row.names = F 删除 r 中使用的行索引。</p><p id="759d" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">使用 showNA = F 是为了在输出文件中空白将保持为空白，而不是被“NA”替换。</p><p id="e8ba" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">但是，如果在导出之前没有再次定义列名，则列名仍然是 R 中显示的那些列名，所以您仍然会发现那些“.”在列名中。</p><pre class="nn no np nq gt nv ky nw nx aw ny bi"><span id="18da" class="nz lz it ky b gy oa ob l oc od"># write excel xlsx - method 2<br/>write.xlsx2(xlsx_df2, file="Output2.xlsx", sheetName="Sample_Sheet", row.names=F, showNA=F)</span></pre><figure class="nn no np nq gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="og oh di oi bf oj"><div class="gh gi of"><img src="../Images/cbd1fba3d928dbdc9743c4c0f8b347e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/0*sSb9wT6VpR78uHyc.PNG"/></div></div></figure><p id="20ae" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">使用 write.xlsx2 的输出显示类似的输出，但是 xlsx_df2 的所有列的上下文都是 char，所以输出会保留相同的结构，可以看到 B 列上的数字变成了字符。</p></div><div class="ab cl lr ls hx lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="im in io ip iq"><h1 id="1c8d" class="ly lz it bd ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv bi translated">摘要</h1><p id="0abc" class="pw-post-body-paragraph jx jy it jz b ka mw kc kd ke mx kg kh ki my kk kl km mz ko kp kq na ks kt ku im bi translated">建议使用 read.xlsx，因为原始数据结构没有改变，但是您需要定义编码方法。(编码= "UTF-8 "是常用的。)</p><p id="e5f5" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">对于编写 excel 文件，write.xlsx 和 write.xlsx2 的输出文件非常相似，因此您可以使用其中任何一个。</p><p id="1a6c" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">使用 xlsx 的一个限制是它只支持带有。xlsx 扩展名，如果要读取 xls 文件，可以使用 readxl(下一篇文章会讲到)。</p><p id="ed75" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">你可以在这里找到 R <a class="ae ok" href="https://medium.com/series/data-science-fundamentals-r-import-export-data-14667fed24a8" rel="noopener">的其他数据导入导出的文章。</a></p></div><div class="ab cl lr ls hx lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="im in io ip iq"><h1 id="64f0" class="ly lz it bd ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv bi translated">编辑的话</h1><p id="4748" class="pw-post-body-paragraph jx jy it jz b ka mw kc kd ke mx kg kh ki my kk kl km mz ko kp kq na ks kt ku im bi translated">如果你有兴趣了解更多的窍门和技巧，欢迎你浏览我们的网站:<a class="ae ok" href="https://cydalytics.blogspot.com/" rel="noopener ugc nofollow" target="_blank">https://cydalytics.blogspot.com/</a></p><p id="9ba6" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated"><strong class="jz iu">领英:</strong></p><p id="e937" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">卡丽·罗—<a class="ae ok" href="https://www.linkedin.com/in/carrielsc/" rel="noopener ugc nofollow" target="_blank">https://www.linkedin.com/in/carrielsc/</a></p><p id="803e" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">黄洋<a class="ae ok" href="https://www.linkedin.com/in/yeungwong/" rel="noopener ugc nofollow" target="_blank">—https://www.linkedin.com/in/yeungwong/</a></p></div><div class="ab cl lr ls hx lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="im in io ip iq"><h1 id="69b1" class="ly lz it bd ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv bi translated">其他文章</h1><ol class=""><li id="f165" class="ol om it jz b ka mw ke mx ki on km oo kq op ku oq or os ot bi translated"><a class="ae ok" rel="noopener" target="_blank" href="/data-science-fundamentals-r-import-data-from-excel-readxl-380ef47216d5?source=friends_link&amp;sk=c8992f7ab1cdc18d1e67353215d95097">数据科学基础(R):从 Excel 导入数据— readxl </a></li><li id="a635" class="ol om it jz b ka ou ke ov ki ow km ox kq oy ku oq or os ot bi translated"><a class="ae ok" href="https://medium.com/analytics-vidhya/data-science-fundamentals-r-import-data-from-text-files-textreadr-readtext-c5058c3bd0d6?source=friends_link&amp;sk=dc3c4a22b2c02e66ceac70ad31001d0f" rel="noopener">数据科学基础(R):从文本文件导入数据— textreadr &amp; readtext </a></li><li id="a3af" class="ol om it jz b ka ou ke ov ki ow km ox kq oy ku oq or os ot bi translated"><a class="ae ok" rel="noopener" target="_blank" href="/data-visualization-tips-power-bi-convert-categorical-variables-to-dummy-variables-a53f20cdb4e?source=friends_link&amp;sk=64aeb5d2d5c7b1f9aa34b4adcc052694">数据可视化技巧(Power BI)——将分类变量转换为虚拟变量</a></li><li id="032b" class="ol om it jz b ka ou ke ov ki ow km ox kq oy ku oq or os ot bi translated"><a class="ae ok" href="https://medium.com/@yeung_cyda/written-in-chinese-step-by-step-chinese-word-cloud-with-python-53f57f65be69?source=friends_link&amp;sk=5194e7fadf63033934fae9111ef76a98" rel="noopener">形状各异的中文词云(Python) </a></li><li id="8ddf" class="ol om it jz b ka ou ke ov ki ow km ox kq oy ku oq or os ot bi translated"><a class="ae ok" rel="noopener" target="_blank" href="/making-a-game-for-kids-to-learn-english-and-have-fun-with-python-d6b54af792ec?source=friends_link&amp;sk=d174a0470ca5400fda2b20ddf633e624">用 Python 制作一个让孩子学习英语并从中获得乐趣的游戏</a></li></ol></div></div>    
</body>
</html>