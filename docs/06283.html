<html>
<head>
<title>Machine Learning Project 10 — Predict which customers bought an iPhone</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">机器学习项目 10 —预测哪些客户购买了 iPhone</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/machine-learning-project-10-predict-which-customers-bought-an-iphone-ea7b153db676?source=collection_archive---------12-----------------------#2019-09-10">https://towardsdatascience.com/machine-learning-project-10-predict-which-customers-bought-an-iphone-ea7b153db676?source=collection_archive---------12-----------------------#2019-09-10</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div class="gh gi jq"><img src="../Images/3326528838c186fe84df7332cba74f06.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*6209RUtuEfHCZa3sIyFwSg.jpeg"/></div><figcaption class="jx jy gj gh gi jz ka bd b be z dk">iPhone Sales prediction — source pixabay.com</figcaption></figure><p id="d1d6" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">到目前为止，我们已经完成了 9 个项目，涵盖了不同类型的回归。</p><p id="1c47" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><strong class="kd iu"># 100 daysofml code # 100 projects inml</strong></p><p id="fd11" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">回归包括预测连续的输出变量或数量。</p><p id="5ba0" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">回归预测建模的示例包括:</p><ul class=""><li id="c877" class="kz la it kd b ke kf ki kj km lb kq lc ku ld ky le lf lg lh bi translated">根据员工的工作经验预测其工资。</li><li id="92a2" class="kz la it kd b ke li ki lj km lk kq ll ku lm ky le lf lg lh bi translated">根据城市和卧室数量预测房价。</li><li id="3be1" class="kz la it kd b ke li ki lj km lk kq ll ku lm ky le lf lg lh bi translated">给定营销预算，预测企业的销售额。</li></ul><p id="b0df" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">现在，有一组不同的问题需要我们将输出变量分成两个或更多的标签或类别。我们需要预测给定观察的标签或类别。</p><p id="03ae" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这些被称为分类预测建模。例子包括:</p><ul class=""><li id="aa0d" class="kz la it kd b ke kf ki kj km lb kq lc ku ld ky le lf lg lh bi translated">将电子邮件标记为垃圾邮件。</li><li id="ae38" class="kz la it kd b ke li ki lj km lk kq ll ku lm ky le lf lg lh bi translated">预测顾客是否会购买。</li><li id="ee94" class="kz la it kd b ke li ki lj km lk kq ll ku lm ky le lf lg lh bi translated">预测一个人是否会得糖尿病。</li></ul><p id="9743" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">以上是二元分类问题的例子。</p><p id="4984" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我们也可能有多标签或多类分类问题。在多类问题中，类是互斥的。输出变量可以被分类成任何一类。例如，一部电影可以被归类为 PG 13 或成人，但不能两者都是。</p><p id="39e4" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在多标签问题中，输出变量可以在多个标签下分类。回到我们的电影例子，一部电影可以分为“推理片”和“言情片”。我们将在未来的项目中更详细地讨论这些主题。</p><p id="4423" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">让我们从第一个分类问题开始，我们将使用逻辑回归。它被称为逻辑回归，因为它通过画一条直线将输出分成两类，如下所示</p><figure class="lo lp lq lr gt ju gh gi paragraph-image"><div class="gh gi ln"><img src="../Images/db49f2467e6e4283e05aa211dbe82c29.png" data-original-src="https://miro.medium.com/v2/resize:fit:796/format:webp/1*QLchrKgEvL1W8cPmkcwDOw.png"/></div></figure></div><div class="ab cl ls lt hx lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="im in io ip iq"><h1 id="2974" class="lz ma it bd mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw bi translated">项目目标</h1><p id="9f3e" class="pw-post-body-paragraph kb kc it kd b ke mx kg kh ki my kk kl km mz ko kp kq na ks kt ku nb kw kx ky im bi translated">让我们看看数据集。有趣的是，我们假设这些是购买或未购买 iPhone 的客户的记录。示例行如下所示。完整的数据集可以在<a class="ae nc" href="https://github.com/omairaasim/machine_learning/tree/master/project_10_logistic_regression" rel="noopener ugc nofollow" target="_blank">这里</a>访问。</p><figure class="lo lp lq lr gt ju"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="7948" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我们在这个项目中的目标是，在给定客户的性别、年龄和工资的情况下，预测他们是否会购买 iPhone。</p></div><div class="ab cl ls lt hx lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="im in io ip iq"><h1 id="986d" class="lz ma it bd mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw bi translated">步骤 1:加载数据集</h1><p id="d9b8" class="pw-post-body-paragraph kb kc it kd b ke mx kg kh ki my kk kl km mz ko kp kq na ks kt ku nb kw kx ky im bi translated">x 将包含所有 3 个独立变量“性别”、“年龄”和“工资”</p><p id="e2c5" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">y 将包含因变量“购买的 iPhone”</p><figure class="lo lp lq lr gt ju"><div class="bz fp l di"><div class="nd ne l"/></div></figure></div><div class="ab cl ls lt hx lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="im in io ip iq"><h1 id="f668" class="lz ma it bd mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw bi translated">步骤 2:将性别转换为数字</h1><p id="8a1e" class="pw-post-body-paragraph kb kc it kd b ke mx kg kh ki my kk kl km mz ko kp kq na ks kt ku nb kw kx ky im bi translated">对于大多数机器学习算法，我们必须将分类变量转换为数字。这里我们有一个必须转换的“性别”字段。</p><p id="6b24" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我们将使用 LabelEncoder 类将性别转换为数字</p><figure class="lo lp lq lr gt ju"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="c08a" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">让我们看看我们的 X 和 y:</p><figure class="lo lp lq lr gt ju gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/3b828ba89c69762724c742896dab9737.png" data-original-src="https://miro.medium.com/v2/resize:fit:1016/format:webp/1*sAGf45C5laKszud02XjzdA.png"/></div></figure></div><div class="ab cl ls lt hx lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="im in io ip iq"><h1 id="535c" class="lz ma it bd mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw bi translated">步骤 3:将数据分成训练集和测试集</h1><figure class="lo lp lq lr gt ju"><div class="bz fp l di"><div class="nd ne l"/></div></figure></div><div class="ab cl ls lt hx lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="im in io ip iq"><h1 id="ab8d" class="lz ma it bd mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw bi translated">步骤 4:特征缩放</h1><p id="9dd1" class="pw-post-body-paragraph kb kc it kd b ke mx kg kh ki my kk kl km mz ko kp kq na ks kt ku nb kw kx ky im bi translated">对于逻辑回归算法，我们必须进行特征缩放。为此，我们将使用标准定标器</p><figure class="lo lp lq lr gt ju"><div class="bz fp l di"><div class="nd ne l"/></div></figure></div><div class="ab cl ls lt hx lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="im in io ip iq"><h1 id="f020" class="lz ma it bd mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw bi translated">步骤 5:拟合逻辑回归</h1><p id="f239" class="pw-post-body-paragraph kb kc it kd b ke mx kg kh ki my kk kl km mz ko kp kq na ks kt ku nb kw kx ky im bi translated">我们将使用 sklearn linear_model 库中的 LogisticRegression 类。当我们创建这个类的对象时，它需要很多参数。其中之一是“求解器”，它指定在优化问题中使用哪种算法。</p><p id="4b1d" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">文件指出:</p><blockquote class="ng nh ni"><p id="d441" class="kb kc nj kd b ke kf kg kh ki kj kk kl nk kn ko kp nl kr ks kt nm kv kw kx ky im bi translated">对于小型数据集，“liblinear”是一个不错的选择，而“sag”和“saga”对于大型数据集更快。</p><p id="9e35" class="kb kc nj kd b ke kf kg kh ki kj kk kl nk kn ko kp nl kr ks kt nm kv kw kx ky im bi translated">对于多类问题，只有‘Newton-CG’，‘sag’，‘saga’和‘lbfgs’处理多项式损失；“liblinear”仅限于一对多方案。</p><p id="79ee" class="kb kc nj kd b ke kf kg kh ki kj kk kl nk kn ko kp nl kr ks kt nm kv kw kx ky im bi translated">牛顿-cg、lbfgs 和 sag 只处理 L2 惩罚，而 liblinear 和 saga 处理 L1 惩罚。</p></blockquote><p id="c2ec" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">由于这是一个小数据集，我选择了“liblinear”</p><figure class="lo lp lq lr gt ju"><div class="bz fp l di"><div class="nd ne l"/></div></figure></div><div class="ab cl ls lt hx lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="im in io ip iq"><h1 id="e64c" class="lz ma it bd mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw bi translated">第六步:做预测</h1><figure class="lo lp lq lr gt ju"><div class="bz fp l di"><div class="nd ne l"/></div></figure></div><div class="ab cl ls lt hx lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="im in io ip iq"><h1 id="c0a0" class="lz ma it bd mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw bi translated">步骤 7:检查预测的准确性</h1><p id="4978" class="pw-post-body-paragraph kb kc it kd b ke mx kg kh ki my kk kl km mz ko kp kq na ks kt ku nb kw kx ky im bi translated">在分类问题中，我们可以使用混淆矩阵来比较预测结果和实际结果。</p><p id="2837" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><strong class="kd iu">混淆矩阵:</strong>它会告诉我们正确和错误条目的数量。</p><figure class="lo lp lq lr gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="no np di nq bf nr"><div class="gh gi nn"><img src="../Images/18aba14b7810b7595c391daf7a9fb703.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*U1kJEDvVmgS729RAWqig0A.png"/></div></div></figure><p id="9ce1" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">让我们花一分钟来分析这个矩阵。这告诉我们什么？</p><ul class=""><li id="707f" class="kz la it kd b ke kf ki kj km lb kq lc ku ld ky le lf lg lh bi translated">如果一个人没有购买 iPhone，预测值也说他们没有购买——这是真负值(TN ),即实际值是 0，预测值也是 0。</li><li id="5b25" class="kz la it kd b ke li ki lj km lk kq ll ku lm ky le lf lg lh bi translated">如果一个人没有购买 iPhone，但预测值显示他们购买了——这是误报(FP ),即实际值为 0，预测值为 1。</li><li id="1219" class="kz la it kd b ke li ki lj km lk kq ll ku lm ky le lf lg lh bi translated">如果一个人已经购买了一部 iPhone，但预测值显示他们没有购买——这是假阴性(FN ),即实际值为 1，预测值为 0。</li><li id="3439" class="kz la it kd b ke li ki lj km lk kq ll ku lm ky le lf lg lh bi translated">如果一个人买了一部 iPhone，预测值也说他们买了——这是真正的(TP ),即实际值是 1，预测值也是 1。</li></ul><p id="308f" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><strong class="kd iu">准确性得分</strong>:这是用于检查模型准确性的最常见的度量。它是正确预测总数占预测总数的百分比。</p><blockquote class="ns"><p id="ec35" class="nt nu it bd nv nw nx ny nz oa ob ky dk translated">准确率得分= (TP + TN) / (TP + TN + FP + FN)</p></blockquote><p id="8ad6" class="pw-post-body-paragraph kb kc it kd b ke oc kg kh ki od kk kl km oe ko kp kq of ks kt ku og kw kx ky im bi translated"><strong class="kd iu">回忆分数</strong>:是我们正确预测的正面事件的百分比。</p><blockquote class="ns"><p id="7725" class="nt nu it bd nv nw nx ny nz oa ob ky dk translated">召回分数= TP / (TP + FN)</p></blockquote><p id="2be1" class="pw-post-body-paragraph kb kc it kd b ke oc kg kh ki od kk kl km oe ko kp kq of ks kt ku og kw kx ky im bi translated"><strong class="kd iu"> Precision Score: </strong>是预测的阳性事件实际为阳性的百分比。</p><blockquote class="ns"><p id="76b4" class="nt nu it bd nv nw nx ny nz oa ob ky dk translated">精度= TP / (TP + FP)</p></blockquote><figure class="oh oi oj ok ol ju"><div class="bz fp l di"><div class="nd ne l"/></div></figure><pre class="lo lp lq lr gt om on oo op aw oq bi"><span id="7aa5" class="or ma it on b gy os ot l ou ov">[[65 3]<br/> [ 6 26]]<br/>Accuracy score: 0.91<br/>Precision score: 0.896551724137931<br/>Recall score: 0.8125</span></pre><p id="cbe5" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我们获得了 91%的准确率，这已经很不错了。</p><p id="525c" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">让我们根据上面的公式手动计算分数。</p><p id="4ded" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">混淆矩阵</p><ul class=""><li id="388b" class="kz la it kd b ke kf ki kj km lb kq lc ku ld ky le lf lg lh bi translated">TN = 65</li><li id="7696" class="kz la it kd b ke li ki lj km lk kq ll ku lm ky le lf lg lh bi translated">FP = 3</li><li id="b3dc" class="kz la it kd b ke li ki lj km lk kq ll ku lm ky le lf lg lh bi translated">FN = 6</li><li id="536c" class="kz la it kd b ke li ki lj km lk kq ll ku lm ky le lf lg lh bi translated">TP = 26</li></ul><p id="b60f" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我们可以从上面的矩阵中看到，我们只得到 9 个错误的预测。</p><pre class="lo lp lq lr gt om on oo op aw oq bi"><span id="89ca" class="or ma it on b gy os ot l ou ov">Accuracy Score = (TP + TN) / (TP + TN + FP + FN)</span><span id="776d" class="or ma it on b gy ow ot l ou ov">Accuracy Score =(26 + 65)/ (26 + 65 + 3 + 6)</span><span id="bb87" class="or ma it on b gy ow ot l ou ov">Accuracy Score =91/100 = 0.91 = 91%</span></pre></div><div class="ab cl ls lt hx lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="im in io ip iq"><pre class="om on oo op aw oq bi"><span id="3f26" class="or ma it on b gy ox oy oz pa pb ot l ou ov">Recall Score = TP / (TP + FN)</span><span id="e20c" class="or ma it on b gy ow ot l ou ov">Recall Score =26/ (26 + 6)</span><span id="9f73" class="or ma it on b gy ow ot l ou ov">Recall Score =26/32 = 0.8125 = 81.25%</span></pre></div><div class="ab cl ls lt hx lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="im in io ip iq"><pre class="om on oo op aw oq bi"><span id="ac7f" class="or ma it on b gy ox oy oz pa pb ot l ou ov">Precision = TP / (TP + FP)</span><span id="b32a" class="or ma it on b gy ow ot l ou ov">Precision = 26/ (26 + 3)</span><span id="1dfc" class="or ma it on b gy ow ot l ou ov">Precision = 26/29 = 0.8965 = 89.65%</span></pre></div><div class="ab cl ls lt hx lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="im in io ip iq"><h1 id="9f50" class="lz ma it bd mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw bi translated">第八步:做出新的预测</h1><p id="26cc" class="pw-post-body-paragraph kb kc it kd b ke mx kg kh ki my kk kl km mz ko kp kq na ks kt ku nb kw kx ky im bi translated">你能做出以下预测吗——他们是否会购买 iPhone？</p><ul class=""><li id="8703" class="kz la it kd b ke kf ki kj km lb kq lc ku ld ky le lf lg lh bi translated">21 岁男性，年薪 4 万美元</li><li id="9219" class="kz la it kd b ke li ki lj km lk kq ll ku lm ky le lf lg lh bi translated">21 岁男性，年薪 8 万美元</li><li id="99dd" class="kz la it kd b ke li ki lj km lk kq ll ku lm ky le lf lg lh bi translated">女性，21 岁，收入 4 万美元</li><li id="05fe" class="kz la it kd b ke li ki lj km lk kq ll ku lm ky le lf lg lh bi translated">女性，21 岁，年薪 8 万美元</li><li id="96e1" class="kz la it kd b ke li ki lj km lk kq ll ku lm ky le lf lg lh bi translated">41 岁男性，年薪 4 万美元</li><li id="c613" class="kz la it kd b ke li ki lj km lk kq ll ku lm ky le lf lg lh bi translated">41 岁男性，年薪 8 万美元</li><li id="6b4e" class="kz la it kd b ke li ki lj km lk kq ll ku lm ky le lf lg lh bi translated">41 岁女性，年薪 4 万美元</li><li id="9c50" class="kz la it kd b ke li ki lj km lk kq ll ku lm ky le lf lg lh bi translated">41 岁女性，年薪 8 万美元</li></ul><p id="e5d1" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">让我知道你得到了什么预测。完整源代码是<a class="ae nc" href="https://github.com/omairaasim/machine_learning/tree/master/project_10_logistic_regression" rel="noopener ugc nofollow" target="_blank">这里</a>。</p><p id="5d5c" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">希望你喜欢这个项目——祝你好运</p></div></div>    
</body>
</html>