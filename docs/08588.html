<html>
<head>
<title>Time Series Analysis From Scratch in Python: Part 2</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python 中从头开始的时间序列分析:第 2 部分</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/time-series-analysis-from-scratch-in-python-part-2-1408e91e5e02?source=collection_archive---------39-----------------------#2019-11-19">https://towardsdatascience.com/time-series-analysis-from-scratch-in-python-part-2-1408e91e5e02?source=collection_archive---------39-----------------------#2019-11-19</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="5a13" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这是 Python 中时间序列分析的第二部分，将涵盖比前一部分更有趣的主题。如果您错过了上一篇文章，并且不熟悉 Python 中的日期和时间，<a class="ae ko" rel="noopener" target="_blank" href="/time-series-analysis-from-scratch-in-python-part-1-810dea60327a">您可以在这里找到它</a>。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi kp"><img src="../Images/fb4540eb497885153bb8b7995786fbb0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*GZnOSup47cj8Vlzk"/></div></div><figcaption class="lb lc gj gh gi ld le bd b be z dk">Photo by <a class="ae ko" href="https://unsplash.com/@sonjalangford?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Sonja Langford</a> on <a class="ae ko" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="e30e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这一次，我想把重点放在一些更有趣的事情上，你可以用 Python 来处理日期，这些事情包括:</p><ul class=""><li id="46d5" class="lf lg it js b jt ju jx jy kb lh kf li kj lj kn lk ll lm ln bi translated">重采样</li><li id="ee9c" class="lf lg it js b jt lo jx lp kb lq kf lr kj ls kn lk ll lm ln bi translated">改变</li></ul><p id="5617" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">因此，如果你还不熟悉你要享受的话题，如果你已经熟悉了，简单回顾一下也无妨。</p><p id="5af4" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">事不宜迟，我们开始吧。</p></div><div class="ab cl lt lu hx lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="im in io ip iq"><h1 id="87db" class="ma mb it bd mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx bi translated">数据采集</h1><p id="6f24" class="pw-post-body-paragraph jq jr it js b jt my jv jw jx mz jz ka kb na kd ke kf nb kh ki kj nc kl km kn im bi translated">在这篇文章中，我选择使用雅虎财经的一些股票数据。但是在我解释如何获得它之前，让我们先做导入。您将需要 Pandas 库，并且需要设置<strong class="js iu"><em class="nd">% matplotlib inline</em></strong>param 来查看笔记本中的图表。我不会单独导入<strong class="js iu"> <em class="nd"> matplotlib </em> </strong>，因为我们将使用熊猫来制作图表。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/361833390729be288fdc8cc7065b7777.png" data-original-src="https://miro.medium.com/v2/resize:fit:386/format:webp/1*CEcJrVv-adXzOon_j1oKxw.png"/></div></figure><p id="8c79" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">现在开始收集数据。我选择使用<strong class="js iu"> Google Inc. </strong>股票价格数据集，您可以通过<a class="ae ko" href="https://finance.yahoo.com/quote/GOOG/history?p=GOOG" rel="noopener ugc nofollow" target="_blank">打开此 URL </a>并点击<strong class="js iu"> <em class="nd">下载数据</em> </strong>按钮下载 CSV 格式的数据集。下载完成后，你可以通过 Pandas 导入它，并且只保留相关的列以供进一步分析。</p><p id="b53e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">看看我是如何指定<strong class="js iu"> <em class="nd">索引</em> </strong>列以及如何将<strong class="js iu"> <em class="nd"> parse_dates </em> </strong>参数设置为 True 的:</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/3ee0ee403e567bd7deebe9ee8a61929a.png" data-original-src="https://miro.medium.com/v2/resize:fit:644/format:webp/1*rkgNNFulyGLYLCMMbS28Ow.png"/></div></figure><p id="134c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">瞧。通过使用<strong class="js iu"> <em class="nd"> index_col </em> </strong>和<strong class="js iu"> <em class="nd"> parse_dates </em> </strong>参数，数据集自动处于所需的格式，并准备好进行进一步分析。</p><p id="e05d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">让我们快速检查一下索引，看看它是否确实是<strong class="js iu"> <em class="nd">日期时间</em> </strong>格式:</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/93dcfd0b1459f4e2eb17794abac8220c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1336/format:webp/1*9i1n46C5WAr_60GlthMpOQ.png"/></div></figure><p id="1a39" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">一切看起来都很好。我们继续吧。</p></div><div class="ab cl lt lu hx lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="im in io ip iq"><h1 id="0d60" class="ma mb it bd mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx bi translated">基本重采样</h1><p id="6c8c" class="pw-post-body-paragraph jq jr it js b jt my jv jw jx mz jz ka kb na kd ke kf nb kh ki kj nc kl km kn im bi translated">简而言之，重采样意味着聚合数据的一种方式。这里我用<strong class="js iu"><em class="nd">【M’</em></strong>作为重采样规则，代表月，我用 mean 作为聚合函数。这将执行以下操作:</p><ul class=""><li id="e020" class="lf lg it js b jt ju jx jy kb lh kf li kj lj kn lk ll lm ln bi translated">获取给定月份的所有价格</li><li id="59a4" class="lf lg it js b jt lo jx lp kb lq kf lr kj ls kn lk ll lm ln bi translated">通过将所有价格的总和除以该月的日期数来计算平均值</li></ul><p id="9638" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">让我们来看看它的实际应用:</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div class="gh gi nh"><img src="../Images/0b7c16dfeedfbedf9e15456bd0d75c8b.png" data-original-src="https://miro.medium.com/v2/resize:fit:498/format:webp/1*FPfSf0Ip9IXS0Z5cQ08Odg.png"/></div></figure><p id="5349" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">不过，您并不局限于每月重新采样，以下是可用的最流行的重新采样方法列表:</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/d052a7b23b7124c5177180e8d1e59d4e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1226/format:webp/1*BSJUHW4i72tRtQkl3IIGLw.png"/></div><figcaption class="lb lc gj gh gi ld le bd b be z dk">Source: <a class="ae ko" href="https://pandas.pydata.org/pandas-docs/stable/user_guide/timeseries.html" rel="noopener ugc nofollow" target="_blank">https://pandas.pydata.org/pandas-docs/stable/user_guide/timeseries.html</a></figcaption></figure><p id="7695" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我知道这是一个很长的列表，但是它能让你做任何你想做的事情，所以把它放在你身边。</p><p id="5722" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">派对并没有就此结束，因为我现在将使用 Pandas 内置的可视化方法来获得月平均股票价格的条形图:</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi nj"><img src="../Images/f9bba8ed57bbbd8abcf3adf5f17be111.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MjvL53vFrCYB5HEKiXD6Cg.png"/></div></div></figure><p id="2338" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu"> <em class="nd">看到了吗？</em> </strong>非常容易做到，而且你不必使用专用的绘图库。</p><p id="66cb" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这是对重采样的基本介绍，我将把进一步的探索留给你(<em class="nd">一旦你掌握了它的要点</em>，这就不难了)。</p></div><div class="ab cl lt lu hx lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="im in io ip iq"><h1 id="abd3" class="ma mb it bd mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx bi translated">时间位移</h1><p id="a92b" class="pw-post-body-paragraph jq jr it js b jt my jv jw jx mz jz ka kb na kd ke kf nb kh ki kj nc kl km kn im bi translated">时间转移基本上意味着从一个时间周期转移到另一个时间周期。让我们回顾一下数据集的样子:</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/6e29867badf86aeabf23652cf780a685.png" data-original-src="https://miro.medium.com/v2/resize:fit:402/format:webp/1*3RrUXWZuhRbEKn_v-anufQ.png"/></div></figure><p id="70ce" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在熊猫 DataFrame 对象上，可以使用<strong class="js iu"> <em class="nd">。</em>shift()</strong>从一个时间移到另一个时间的方法。让我们来看看实际情况，我将使用这种方法向前移动一段时间:</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/223bd2c6716cbd76389c6d1de35da633.png" data-original-src="https://miro.medium.com/v2/resize:fit:420/format:webp/1*yHghxHltJ4xqfXo4mr48Rw.png"/></div></figure><p id="c689" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">您可以看到第一个值丢失了，这很明显，因为在第一次观察之前没有关于股票价格的信息。</p><p id="8206" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">您也可以通过在整数参数前面加上减号来后退:</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/536dcd0c1167d607c9855208647333c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:428/format:webp/1*pOxqWec_2wcpVwQHxgGTDQ.png"/></div></figure><p id="d2d2" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果您想知道这种技术什么时候有用，那么，您可以声明几个列，每个列在过去多移动一天。通过这样做，你可以建立一个模型来预测第二天价格是上涨还是下跌。</p></div><div class="ab cl lt lu hx lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="im in io ip iq"><h1 id="569f" class="ma mb it bd mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx bi translated">在你走之前</h1><p id="edb4" class="pw-post-body-paragraph jq jr it js b jt my jv jw jx mz jz ka kb na kd ke kf nb kh ki kj nc kl km kn im bi translated">这又是对一些基本时间序列方法的简短介绍。我更喜欢这种方式，而不是写一篇你会在一分钟内点击离开的长文章。</p><p id="eec4" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">过几天，我会写一篇文章介绍<strong class="js iu"> <em class="nd"> StatsModels </em> </strong>库，稍后会有更多介绍。</p><p id="c881" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">感谢阅读。保重。</p></div><div class="ab cl lt lu hx lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="im in io ip iq"><p id="f094" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><em class="nd">喜欢这篇文章吗？成为</em> <a class="ae ko" href="https://medium.com/@radecicdario/membership" rel="noopener"> <em class="nd">中等会员</em> </a> <em class="nd">继续无限制学习。如果你使用下面的链接，我会收到你的一部分会员费，不需要你额外付费。</em></p><div class="nn no gp gr np nq"><a href="https://medium.com/@radecicdario/membership" rel="noopener follow" target="_blank"><div class="nr ab fo"><div class="ns ab nt cl cj nu"><h2 class="bd iu gy z fp nv fr fs nw fu fw is bi translated">通过我的推荐链接加入 Medium-Dario rade ci</h2><div class="nx l"><h3 class="bd b gy z fp nv fr fs nw fu fw dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="ny l"><p class="bd b dl z fp nv fr fs nw fu fw dk translated">medium.com</p></div></div><div class="nz l"><div class="oa l ob oc od nz oe kz nq"/></div></div></a></div></div></div>    
</body>
</html>