<html>
<head>
<title>The main issue with identifying Financial Fraud using Machine Learning (and how to address it)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用机器学习识别金融欺诈的主要问题(以及如何解决)</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/the-main-issue-with-identifying-financial-fraud-using-machine-learning-and-how-to-address-it-3b1bf8fa1e0c?source=collection_archive---------19-----------------------#2019-03-06">https://towardsdatascience.com/the-main-issue-with-identifying-financial-fraud-using-machine-learning-and-how-to-address-it-3b1bf8fa1e0c?source=collection_archive---------19-----------------------#2019-03-06</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><div class=""/><div class=""><h2 id="5f9c" class="pw-subtitle-paragraph jr it iu bd b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki dk translated">处理不平衡数据的策略</h2></div><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj kj"><img src="../Images/90ba46d03ef34400b1a7add72be3b2b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Tp5aNdBPEo6H290n"/></div></div></figure><p id="e022" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">支付处理器每天处理的金融交易数量惊人，而且还在不断增加:2012 年<a class="ae lr" href="https://www.nasdaq.com/article/credit-card-statistics-industry-facts-debt-statistics-cm21786" rel="noopener ugc nofollow" target="_blank">大约每天 7000 万笔信用卡交易</a>，2017 年<a class="ae lr" href="https://www.creditdonkey.com/credit-card-fraud-statistics.html" rel="noopener ugc nofollow" target="_blank">损失数十亿美元</a>。仅仅由于交易量，确定交易是合法的还是欺诈是计算机系统的专有工作。传统的机器学习方法是建立一个分类器，帮助循环中的人减少必须查看的交易数量。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj ls"><img src="../Images/5f49e9a5ddd8080084706dfa5254d404.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*2i4TQgLY0OML-QkneXPZ6A.gif"/></div></div><figcaption class="lt lu gk gi gj lv lw bd b be z dk">The goal of the machine learning classifier is to reduce the number of transactions that a human has to investigate.</figcaption></figure><p id="b43c" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">机器学习分类器面临的挑战是欺诈交易的百分比在 1-2%的数量级，这意味着分类器必须考虑训练数据中的严重不平衡。</p><p id="296c" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">这是一个非常棒的视频，展示了机器学习工程师在系统检测欺诈交易时必须经历的挑战:</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="lx ly l"/></div></figure><p id="f553" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">即使是金融欺诈的合成数据集也是有偏差的，例如，在预测金融支付服务欺诈的<a class="ae lr" href="https://www.kaggle.com/arjunjoshua/predicting-fraud-in-financial-payment-services" rel="noopener ugc nofollow" target="_blank"> Kaggle 数据集</a>上的不平衡:</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj lz"><img src="../Images/525e6a43b22553bbbf402f7190372809.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NTF2zr9i7jrk82Y77Mi_oQ.png"/></div></div></figure><p id="69d3" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">该数据集包含超过 600 万个交易和 11 个特征:</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj ma"><img src="../Images/a40a222fc0e649d4a834e05ae854e372.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8XXaY_puMiItAEUJknuJGA.png"/></div></div></figure><p id="2955" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">数据不平衡问题并不仅限于金融领域的机器学习应用，还包括一些应用，如检测罕见疾病患者的图像、从入境口岸的 X 射线图像中对受限对象进行图像分类、石油泄漏的图像识别等。</p><div class="kk kl km kn gu ab cb"><figure class="mb ko mc md me mf mg paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><img src="../Images/1964f830305696da65c3cee95b7770e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:698/0*L_VaYYzgfXrsAT1W"/></div></figure><figure class="mb ko mh md me mf mg paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><img src="../Images/40c0b36bdce169e19bf233db784dcc89.png" data-original-src="https://miro.medium.com/v2/resize:fit:652/0*og7oKcbL_DsCxj3l"/></div></figure><figure class="mb ko mh md me mf mg paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><img src="../Images/b11e70196054642087a8f89d6b4a95c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:652/0*WewoCxX89XCt0PX0"/></div><figcaption class="lt lu gk gi gj lv lw bd b be z dk mi di mj mk">Photos courtesy of <a class="ae lr" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure></div><p id="0eb1" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">在本文中，我将描述可以用来缓解数据不平衡的技术，目标是用平衡的数据集训练二元分类器。</p><p id="6345" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">为了便于说明，我们将创建一个二维的合成数据集，尽管典型的金融数据集通常有更多的特征，例如，之前的<a class="ae lr" href="https://www.kaggle.com/arjunjoshua/predicting-fraud-in-financial-payment-services" rel="noopener ugc nofollow" target="_blank"> Kaggle 数据集</a>有 28 个特征。</p><p id="214b" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">一般来说，不平衡数据集看起来是这样的:</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj ml"><img src="../Images/cd2360716248663b7bdf3e9e9724275e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TWzJ89MA1oT-jJVcfqQVCg.png"/></div></div><figcaption class="lt lu gk gi gj lv lw bd b be z dk">Dataset depicting a 99:1 class imbalance ratio. There are 1,000 samples on the yellow class (majority), and 10 samples on the orange class (minority).</figcaption></figure><p id="edc7" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">有两种缓解不平衡的一般策略:减少多数类(欠采样)，或从少数类生成合成数据(过采样)。我们将讨论这两者。</p><h1 id="3b36" class="mm mn iu bd mo mp mq mr ms mt mu mv mw ka mx kb my kd mz ke na kg nb kh nc nd bi translated">策略一。欠采样多数类</h1><p id="fa41" class="pw-post-body-paragraph kv kw iu kx b ky ne jv la lb nf jy ld le ng lg lh li nh lk ll lm ni lo lp lq in bi translated">在这个策略中，思想是减少多数类的样本数量。</p><h2 id="7697" class="nj mn iu bd mo nk nl dn ms nm nn dp mw le no np my li nq nr na lm ns nt nc nu bi translated">1.1 随机欠采样</h2><p id="434f" class="pw-post-body-paragraph kv kw iu kx b ky ne jv la lb nf jy ld le ng lg lh li nh lk ll lm ni lo lp lq in bi translated">第一种策略是忽略来自多数类的数据样本。以下动画忽略了来自多数类的随机样本，直到达到平衡数据集。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj ls"><img src="../Images/1ec62bc81a3026f1c2a48d9805f657ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*MmhnnmcNODhIq5CfRCViRw.gif"/></div></div><figcaption class="lt lu gk gi gj lv lw bd b be z dk">Random undersampling</figcaption></figure><h2 id="de53" class="nj mn iu bd mo nk nl dn ms nm nn dp mw le no np my li nq nr na lm ns nt nc nu bi translated">1.2 聚类欠采样</h2><p id="93b5" class="pw-post-body-paragraph kv kw iu kx b ky ne jv la lb nf jy ld le ng lg lh li nh lk ll lm ni lo lp lq in bi translated">另一个策略是将多数样本减少到<em class="nv"> k </em>个样本，这对应于多数类的<em class="nv"> k </em>个质心。这些质心由<a class="ae lr" href="https://en.wikipedia.org/wiki/K-means_clustering" rel="noopener ugc nofollow" target="_blank"> <em class="nv"> k 均值聚类</em> </a>无监督算法计算。质心的数量通常被设置为少数类中样本的数量，以便整个数据集是平衡的。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj ls"><img src="../Images/41222ac4877370f3647a2f65991c6fd9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*sRseBvf5T-DJ4NRugH86Qw.gif"/></div></div><figcaption class="lt lu gk gi gj lv lw bd b be z dk">Clustering undersampling</figcaption></figure><h2 id="4525" class="nj mn iu bd mo nk nl dn ms nm nn dp mw le no np my li nq nr na lm ns nt nc nu bi translated">1.3 Tomek 链接</h2><p id="bd29" class="pw-post-body-paragraph kv kw iu kx b ky ne jv la lb nf jy ld le ng lg lh li nh lk ll lm ni lo lp lq in bi translated">对多数类进行欠采样的另一个策略是移除所谓的“<a class="ae lr" href="https://ieeexplore.ieee.org/document/4309452" rel="noopener ugc nofollow" target="_blank"> Tomek 链接</a>”。这些点是离少数类最近的邻居(离对面类最近)。通过移除这些点，通过从多数类的点中“清除”其周围空间，给予少数类样本更多的权重。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj ls"><img src="../Images/cb16e32bc6e327febcf38dba8b6faf06.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*eV_y5zTZpNMP-JtGvvVvjw.gif"/></div></div><figcaption class="lt lu gk gi gj lv lw bd b be z dk">Tomek links undersampling</figcaption></figure><h1 id="e485" class="mm mn iu bd mo mp mq mr ms mt mu mv mw ka mx kb my kd mz ke na kg nb kh nc nd bi translated">策略二。对少数民族阶层进行过度采样</h1><p id="bed8" class="pw-post-body-paragraph kv kw iu kx b ky ne jv la lb nf jy ld le ng lg lh li nh lk ll lm ni lo lp lq in bi translated">在这个策略中，想法是增加少数类的样本数量。</p><h2 id="33e8" class="nj mn iu bd mo nk nl dn ms nm nn dp mw le no np my li nq nr na lm ns nt nc nu bi translated">2.1 通过少数类的随机复制进行过采样</h2><p id="e479" class="pw-post-body-paragraph kv kw iu kx b ky ne jv la lb nf jy ld le ng lg lh li nh lk ll lm ni lo lp lq in bi translated">在第一个策略中，也是最容易实现的，从少数类中选择随机样本并复制它们。尽管简单明了，但这可能会导致过度拟合。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj ls"><img src="../Images/e860bdaad6f0bc3a9b56eb10a1c70d16.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*NjRT7hAI-sSP2_-OhtpeJw.gif"/></div></div><figcaption class="lt lu gk gi gj lv lw bd b be z dk">Random oversampling</figcaption></figure><h2 id="5b1f" class="nj mn iu bd mo nk nl dn ms nm nn dp mw le no np my li nq nr na lm ns nt nc nu bi translated">2.2 合成少数过采样(SMOTE)</h2><p id="ca58" class="pw-post-body-paragraph kv kw iu kx b ky ne jv la lb nf jy ld le ng lg lh li nh lk ll lm ni lo lp lq in bi translated"><a class="ae lr" href="https://www.cs.cmu.edu/afs/cs/project/jair/pub/volume16/chawla02a-html/node6.html" rel="noopener ugc nofollow" target="_blank"> SMOTE </a>算法背后的思想是沿着来自少数类的两个样本之间的向量创建“合成”数据点，这些样本是由其最近的邻居(即最近的)选择的。新点沿该向量以随机长度设置。有关简化数据集的示例，请参见以下动画:</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj ls"><img src="../Images/1f35e9389ba530d39393d893e3a5003c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*WXgcbSg-tFjZ6yUSjCUonQ.gif"/></div></div><figcaption class="lt lu gk gi gj lv lw bd b be z dk">SMOTE interpolates over nearest neighbors.</figcaption></figure><p id="7582" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">以下动画应用于我们之前的示例进行说明:</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj ls"><img src="../Images/1f0af39fff9373b0a825d231d1479fd4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*nPnaWfd6szOM38GHIvyDpg.gif"/></div></div><figcaption class="lt lu gk gi gj lv lw bd b be z dk">Synthetic Minority Over-sampling (SMOTE) example.</figcaption></figure><h2 id="84eb" class="nj mn iu bd mo nk nl dn ms nm nn dp mw le no np my li nq nr na lm ns nt nc nu bi translated">2.3 自适应合成(ADASYN)</h2><p id="f557" class="pw-post-body-paragraph kv kw iu kx b ky ne jv la lb nf jy ld le ng lg lh li nh lk ll lm ni lo lp lq in bi translated">与 SMOTE 类似，<a class="ae lr" href="https://sci2s.ugr.es/keel/pdf/algorithm/congreso/2008-He-ieee.pdf" rel="noopener ugc nofollow" target="_blank"> ADASYN </a>算法也生成新的合成点，但通过对少数样本应用不同的权重来补偿偏斜分布。在 SMOTE 算法中，为每个少数数据示例生成相同数量的合成样本。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj ls"><img src="../Images/b0ba3a13db27e58321c3f97d71f566a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*eaiDrfIxlBXDUVME3fFetA.gif"/></div></div><figcaption class="lt lu gk gi gj lv lw bd b be z dk">Adaptive Synthetic (ADASYN)</figcaption></figure><h1 id="42f9" class="mm mn iu bd mo mp mq mr ms mt mu mv mw ka mx kb my kd mz ke na kg nb kh nc nd bi translated">3.过采样和欠采样(SMOTE + Tomek 链接)</h1><p id="3129" class="pw-post-body-paragraph kv kw iu kx b ky ne jv la lb nf jy ld le ng lg lh li nh lk ll lm ni lo lp lq in bi translated">最后，过采样(例如通过 SMOTE)和欠采样(例如通过 Tomek 链接)的结合也许是处理不平衡数据的理想途径。过采样算法创建新的实例来匹配平衡，而欠采样过程从多数类中移除点，否则这些点会减去少数类的珍贵样本的权重。这种策略 a 的一个例子可以在下面的动画中看到:</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj ls"><img src="../Images/27aa174ccaf977f5477ea47be81d95bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*VxuEGpPf-OECzOsUd88a2Q.gif"/></div></div><figcaption class="lt lu gk gi gj lv lw bd b be z dk">SMOTE + Tomek links</figcaption></figure><h1 id="8276" class="mm mn iu bd mo mp mq mr ms mt mu mv mw ka mx kb my kd mz ke na kg nb kh nc nd bi translated">摘要</h1><p id="8129" class="pw-post-body-paragraph kv kw iu kx b ky ne jv la lb nf jy ld le ng lg lh li nh lk ll lm ni lo lp lq in bi translated">策略的选择将取决于问题，并最终由业务决定支持的东西来指导:<a class="ae lr" rel="noopener" target="_blank" href="/precision-vs-recall-386cf9f89488">精度或召回</a>。</p><p id="b31b" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">幸运的是，通过 Python 库<a class="ae lr" href="https://imbalanced-learn.readthedocs.io/en/stable/index.html" rel="noopener ugc nofollow" target="_blank">不平衡学习</a>，可以直接测试这些技术的性能。</p><h2 id="d209" class="nj mn iu bd mo nk nl dn ms nm nn dp mw le no np my li nq nr na lm ns nt nc nu bi translated">延伸阅读:</h2><ul class=""><li id="139f" class="nw nx iu kx b ky ne lb nf le ny li nz lm oa lq ob oc od oe bi translated"><a class="ae lr" href="https://www.svds.com/learning-imbalanced-classes/" rel="noopener ugc nofollow" target="_blank">从不平衡的班级中学习</a>作者<a class="of og ep" href="https://medium.com/u/508c5779b512?source=post_page-----3b1bf8fa1e0c--------------------------------" rel="noopener" target="_blank">汤姆·福塞特</a></li><li id="26dd" class="nw nx iu kx b ky oh lb oi le oj li ok lm ol lq ob oc od oe bi translated"><a class="ae lr" href="https://www.kaggle.com/rafjaa/resampling-strategies-for-imbalanced-datasets" rel="noopener ugc nofollow" target="_blank">不平衡数据集的重采样策略</a>作者<a class="of og ep" href="https://medium.com/u/c5914bcc00bd?source=post_page-----3b1bf8fa1e0c--------------------------------" rel="noopener" target="_blank">拉斐尔·阿伦卡尔</a></li></ul><h1 id="5207" class="mm mn iu bd mo mp mq mr ms mt mu mv mw ka mx kb my kd mz ke na kg nb kh nc nd bi translated">源代码:</h1><p id="0d8f" class="pw-post-body-paragraph kv kw iu kx b ky ne jv la lb nf jy ld le ng lg lh li nh lk ll lm ni lo lp lq in bi translated">在这个存储库中<a class="ae lr" href="https://github.com/gchavez2/code_machine_learning_algorithms" rel="noopener ugc nofollow" target="_blank">https://github . com/gchave z2/code _ machine _ learning _ algorithms</a>您可以找到用于生成本文实验的 Python 代码，以 Jupyter 笔记本的形式:</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><a href="https://github.com/gchavez2/code_machine_learning_algorithms"><div class="gi gj om"><img src="../Images/8048a4d50644fda91635fb77a3e4c203.png" data-original-src="https://miro.medium.com/v2/resize:fit:1304/1*dqKwEtmw9VHPjLpeQQ0qCQ.gif"/></div></a><figcaption class="lt lu gk gi gj lv lw bd b be z dk"><a class="ae lr" href="https://github.com/gchavez2/code_machine_learning_algorithms" rel="noopener ugc nofollow" target="_blank">https://github.com/gchavez2/code_machine_learning_algorithms</a></figcaption></figure></div><div class="ab cl on oo hy op" role="separator"><span class="oq bw bk or os ot"/><span class="oq bw bk or os ot"/><span class="oq bw bk or os"/></div><div class="in io ip iq ir"><p id="0b38" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated"><em class="nv">我是劳伦斯伯克利国家实验室的博士后，在那里从事机器学习和高性能计算的交叉研究。</em></p><p id="6a33" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated"><em class="nv">如果你觉得这篇文章很有趣，请随意打个招呼，LinkedIn </em>  <em class="nv">，我总是很乐意与该领域的其他专业人士联系。</em></p><figure class="kk kl km kn gu ko gi gj paragraph-image"><a href="http://eepurl.com/giSKB9"><div class="gi gj ou"><img src="../Images/fc9812283b6ecba784677161ec8ba4ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FCyfjdltxWoVuR5fiKmlbA.png"/></div></a><figcaption class="lt lu gk gi gj lv lw bd b be z dk">No Spam, ever.</figcaption></figure></div></div>    
</body>
</html>