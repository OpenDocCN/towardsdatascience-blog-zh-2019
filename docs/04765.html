<html>
<head>
<title>Everything You Need to Know About Snowflake Parameters (Part 1)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">关于雪花参数您需要知道的一切(第 1 部分)</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/everything-you-need-to-know-about-snowflake-parameters-part-1-6224ccd7c559?source=collection_archive---------26-----------------------#2019-07-19">https://towardsdatascience.com/everything-you-need-to-know-about-snowflake-parameters-part-1-6224ccd7c559?source=collection_archive---------26-----------------------#2019-07-19</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="32d0" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph"><a class="ae ep" href="http://towardsdatascience.com/tagged/professional data skills" rel="noopener" target="_blank">专业数据技能</a></h2><div class=""/><figure class="gl gn jx jy jz ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi jw"><img src="../Images/d7d658c774eeec8204451a304a70e2f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*w6aNQYjaGcxTG3ht"/></div></div><figcaption class="kh ki gj gh gi kj kk bd b be z dk">Photo by <a class="ae kl" href="https://unsplash.com/@andreasonda?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Andrea Sonda</a> on <a class="ae kl" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="0353" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">雪花是一个非常受欢迎的云数据仓库，以其简单、强大的功能、有竞争力的价格和易于维护而闻名。来到 Snowflake 的 DBA 通常会惊喜地发现，他们只需调整很少的东西就能让它保持运行。</p><p id="db6c" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">其中之一就是雪花参数。对于传统数据库，DBA 经常花时间微调参数以获得最佳性能。有时，这对于提高单个查询的运行速度是必要的。有几十个雪花参数，但大多数安装都可以运行得很好，而不需要调整任何参数。</p><p id="a920" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">然而，知道什么在运行总是好的——不仅仅是为了知道，而是因为有时它可以帮助更快地解决问题。</p><p id="cdc8" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">在这篇由两部分组成的文章中，我将讨论雪花参数及其工作原理。你将学习如何以不同的方式改变和重置它们，这样一个地方的改变不会影响到另一个地方。最后，我们将讨论有时会派上用场的重要参数。</p><p id="c279" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">让我们开始吧。</p></div><div class="ab cl lk ll hu lm" role="separator"><span class="ln bw bk lo lp lq"/><span class="ln bw bk lo lp lq"/><span class="ln bw bk lo lp"/></div><div class="ij ik il im in"><h1 id="782c" class="lr ls iq bd lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo bi translated">雪花参数的类型和级别</h1><p id="a04f" class="pw-post-body-paragraph km kn iq ko b kp mp kr ks kt mq kv kw kx mr kz la lb ms ld le lf mt lh li lj ij bi translated">有两种方法可以识别雪花参数:参数的<em class="mu">类型</em>及其层次<em class="mu">级别</em>。</p><p id="2da5" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">参数类型基于它所控制的资源类型。有些参数适用于整个雪花帐户，有些适用于用户会话，有些适用于雪花对象。</p><p id="8de4" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">雪花参数有三种类型:</p><ul class=""><li id="bfd4" class="mv mw iq ko b kp kq kt ku kx mx lb my lf mz lj na nb nc nd bi translated"><strong class="ko ja">账户</strong></li><li id="7aa9" class="mv mw iq ko b kp ne kt nf kx ng lb nh lf ni lj na nb nc nd bi translated"><strong class="ko ja">会话</strong></li><li id="5405" class="mv mw iq ko b kp ne kt nf kx ng lb nh lf ni lj na nb nc nd bi translated"><strong class="ko ja">对象</strong></li></ul><p id="ab2c" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">一个<em class="mu">账户</em>类型<em class="mu"> </em>参数影响整个雪花账户。这些参数是在帐户级别设置的，不能在层次结构的较低级别覆盖。只有 ACCOUNTADMIN 角色成员(对于一个参数，还有 SYSADMIN 角色成员)可以更改它们的值。一旦您设置了帐户参数，它将对所有用户及其会话可见。</p><p id="c2e6" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">接下来，我们有<em class="mu">会话</em>类型参数。这些参数主要与用户及其会话相关。它们可以在帐户级别设置，但也可以针对每个用户进行更改。在用户的会话中，它可以再次更改为不同的内容。</p><p id="e4d0" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">这是在层次结构的不同<em class="mu">级别</em>改变参数的一个例子。这里，会话<em class="mu">类型</em>参数可以在账户<em class="mu">级别</em>(层级的根级别)设置默认值。在帐户下，我们还有单独的雪花用户(层次结构的第一层)，每个用户可以有多个会话(层次结构的第二层)。创建帐户时(或之后)，可以为用户帐户更改在帐户级别设置的参数值。当用户登录时，她可以为她的会话将相同的参数更改为不同的值。换句话说，该参数现在在层次结构的三个级别上具有三个不同的值。</p><p id="6a54" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">会话类型参数可用于满足不同的用户需求。例如，从美国连接的用户可能希望看到以“mm-dd-yyyy”格式显示的日期，而来自亚洲的用户可能希望看到以“dd/mm/yyyy”格式列出的日期。此参数的帐户级别值可以是默认的“yyyy-mm-dd”。在用户级别设置该值可确保不同的用户以他们希望的方式查看日期。</p><p id="4b95" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">现在，假设一个来自美国的用户登录到数据仓库，但是想要查看“MMM-dd-yyyy”格式的日期。她只能为自己的会话更改参数。</p><p id="8cfe" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">ACCOUNTADMIN 和 SYSADMIN 角色成员都可以为用户分配或更改参数。如果在用户或会话级别没有对会话类型参数进行更改，则应用帐户级别的值。</p><p id="baa3" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">最后还有<em class="mu">对象</em>类型参数。这些参数适用于雪花对象，如仓库和数据库。仓库没有任何层次结构，因此可以在帐户级别设置特定于仓库的参数，然后针对各个仓库进行更改。</p><p id="fa9f" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">类似地，可以在帐户级别设置特定于数据库的参数，然后针对每个数据库进行设置。与仓库不同，数据库有一个层次结构。在数据库中，模式可以覆盖帐户或数据库级别的参数集，而在模式中，表可以覆盖帐户、数据库或模式级别的参数集。如果在层次结构的较低级别没有进行更改，则在最近的较高级别设置的值将应用于下游。</p></div><div class="ab cl lk ll hu lm" role="separator"><span class="ln bw bk lo lp lq"/><span class="ln bw bk lo lp lq"/><span class="ln bw bk lo lp"/></div><div class="ij ik il im in"><h1 id="c391" class="lr ls iq bd lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo bi translated">使用雪花参数</h1><p id="3019" class="pw-post-body-paragraph km kn iq ko b kp mp kr ks kt mq kv kw kx mr kz la lb ms ld le lf mt lh li lj ij bi translated">那么如何看出雪花有哪些参数呢？</p><p id="b9f5" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">看你想看什么了。对于帐户或会话类型参数，您可以运行以下命令:</p><pre class="nj nk nl nm gt nn no np nq aw nr bi"><span id="436c" class="ns ls iq no b gy nt nu l nv nw">—- shows parameters defined at the account level<br/>SHOW PARAMETERS IN ACCOUNT;</span><span id="de5b" class="ns ls iq no b gy nx nu l nv nw">—- shows parameters defined at the user level<br/>SHOW PARAMETERS IN USER;</span><span id="089c" class="ns ls iq no b gy nx nu l nv nw">-- shows parameters defined at the session level<br/>SHOW PARAMETERS IN SESSION;</span><span id="8680" class="ns ls iq no b gy nx nu l nv nw">-- shows parameters defined at the session level<br/>SHOW PARAMETERS</span></pre><p id="33b0" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">让我们看看输出:</p><figure class="nj nk nl nm gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi ny"><img src="../Images/6f4e017a8709731773ca3366e63c410b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*p7L7IA76FINxrrclf0m2eA.png"/></div></div></figure><p id="3537" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">这里:</p><ul class=""><li id="f649" class="mv mw iq ko b kp kq kt ku kx mx lb my lf mz lj na nb nc nd bi translated"><strong class="ko ja"> <em class="mu">键</em> </strong>是参数名</li><li id="996b" class="mv mw iq ko b kp ne kt nf kx ng lb nh lf ni lj na nb nc nd bi translated"><strong class="ko ja"> <em class="mu">值</em> </strong>是为该参数设置的当前值</li><li id="8722" class="mv mw iq ko b kp ne kt nf kx ng lb nh lf ni lj na nb nc nd bi translated"><strong class="ko ja"> <em class="mu">默认值</em> </strong>是该参数的默认值</li><li id="71bc" class="mv mw iq ko b kp ne kt nf kx ng lb nh lf ni lj na nb nc nd bi translated"><strong class="ko ja"> <em class="mu">级别</em> </strong>是应用当前值的层级位置。如果默认值和当前值相同，则该字段为空。</li></ul><p id="fd86" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">以下是在会话级别更改参数的示例:</p><pre class="nj nk nl nm gt nn no np nq aw nr bi"><span id="75f5" class="ns ls iq no b gy nt nu l nv nw">ALTER SESSION SET TIMEZONE=’Australia/Sydney’;</span></pre><p id="4455" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">如果您现在运行此命令:</p><pre class="nj nk nl nm gt nn no np nq aw nr bi"><span id="c9d0" class="ns ls iq no b gy nt nu l nv nw">SHOW PARAMETERS LIKE ‘%TIMEZONE%’;</span></pre><p id="fe13" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">输出显示当前值是在会话级别设置的，它不同于默认值:</p><figure class="nj nk nl nm gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi nz"><img src="../Images/faaa28001ba90168bb9a1585585eef8d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Wnkq5UdTsqrOZLQf_3nhqA.png"/></div></div></figure><p id="0c8d" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">要查找在帐户级别设置的值，请运行以下命令:</p><pre class="nj nk nl nm gt nn no np nq aw nr bi"><span id="19f3" class="ns ls iq no b gy nt nu l nv nw">SHOW PARAMETERS LIKE ‘%TIMEZONE%’ IN ACCOUNT;</span></pre><p id="3f5d" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">它显示默认值在帐户级别没有改变。请注意“级别”列在这里是空的:</p><figure class="nj nk nl nm gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi oa"><img src="../Images/701acc267abd33a1d1a802fc84c19eb0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TffXnR7ranEsk_KvLi-eIA.png"/></div></div></figure><p id="9e73" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">要将参数重置回原来的值，请运行以下命令:</p><pre class="nj nk nl nm gt nn no np nq aw nr bi"><span id="eda3" class="ns ls iq no b gy nt nu l nv nw">ALTER SESSION UNSET TIMEZONE;</span></pre></div><div class="ab cl lk ll hu lm" role="separator"><span class="ln bw bk lo lp lq"/><span class="ln bw bk lo lp lq"/><span class="ln bw bk lo lp"/></div><div class="ij ik il im in"><p id="d31e" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">现在让我们来谈谈对象类型参数。与帐户或会话类型不同，查询对象类型参数需要指定对象类型(数据库、模式、表或仓库)和对象名称。</p><p id="9437" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">此代码片段显示了如何列出数据库、模式、表和仓库的对象属性:</p><pre class="nj nk nl nm gt nn no np nq aw nr bi"><span id="48ea" class="ns ls iq no b gy nt nu l nv nw">-- Shows parameters set at database level<br/>SHOW PARAMETERS IN DATABASE MYTESTDB;</span><span id="1725" class="ns ls iq no b gy nx nu l nv nw">-- Shows parameters set at schema level<br/>SHOW PARAMETERS IN SCHEMA MYTESTDB.TEST_SCHEMA;</span><span id="7ff4" class="ns ls iq no b gy nx nu l nv nw">-- Shows parameters set at table level<br/>SHOW PARAMETERS IN TABLE MYTESTDB.TEST_SCHEMA.MY_TEST_TABLE;</span><span id="1461" class="ns ls iq no b gy nx nu l nv nw">-- Shows parameters set for a warehouse<br/>SHOW PARAMETERS IN WAREHOUSE MYTESTWH;</span></pre><p id="d623" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">假设您想要将 TEST_SCHEMA 的数据保持期更改为 0 天，这实际上关闭了它的时间旅行。运行如下命令:</p><pre class="nj nk nl nm gt nn no np nq aw nr bi"><span id="919c" class="ns ls iq no b gy nt nu l nv nw">ALTER SCHEMA MYTESTDB.TEST_SCHEMA SET DATA_RETENTION_TIME_IN_DAYS=0;</span></pre><p id="0e5f" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">要将其改回默认值，请运行如下命令:</p><pre class="nj nk nl nm gt nn no np nq aw nr bi"><span id="9577" class="ns ls iq no b gy nt nu l nv nw">ALTER SCHEMA MYTESTDB.TEST_SCHEMA UNSET DATA_RETENTION_TIME_IN_DAYS;</span></pre><p id="7c73" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">这就是关于查询和设置雪花参数您需要知道的一切。</p></div><div class="ab cl lk ll hu lm" role="separator"><span class="ln bw bk lo lp lq"/><span class="ln bw bk lo lp lq"/><span class="ln bw bk lo lp"/></div><div class="ij ik il im in"><h1 id="6ef5" class="lr ls iq bd lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo bi translated">第 1 部分结束</h1><p id="0453" class="pw-post-body-paragraph km kn iq ko b kp mp kr ks kt mq kv kw kx mr kz la lb ms ld le lf mt lh li lj ij bi translated">这是不到十分钟的关于雪花参数的介绍。这里没有什么奇特或复杂的。然而，真正的力量来自于知道需要时可以调整哪些参数，以及调整到什么水平。这就是我们将在第 2 部分讨论的内容。敬请关注。</p><p id="3891" class="pw-post-body-paragraph km kn iq ko b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">如果你喜欢它，请鼓掌，在 Twitter、Medium 和 LinkedIn 上关注我。</p></div></div>    
</body>
</html>