<html>
<head>
<title>How to choose stocks to invest in with Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用 Python 选择股票投资</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/choose-stocks-to-invest-with-python-584892e3ad22?source=collection_archive---------10-----------------------#2019-12-23">https://towardsdatascience.com/choose-stocks-to-invest-with-python-584892e3ad22?source=collection_archive---------10-----------------------#2019-12-23</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="2a7c" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">混合整数线性规划作为解决股票选择问题的替代工具</h2></div><p id="b7fe" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">您计划在未来 3 年投资几只股票，每只股票的每一美元投资都有不同的预期回报和具体的投资金额，如下表所示(均以千美元计)。考虑到你每年投资购买股票的数量是有限的，你想决定每年投资哪些股票，以使总回报最大化。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi le"><img src="../Images/d48b0c64c5eb5b63a2fcc3833e2e7bdf.png" data-original-src="https://miro.medium.com/v2/resize:fit:956/format:webp/1*eh1wLVsYJBhthAbt8fsapw.png"/></div></figure><h1 id="a715" class="lm ln it bd lo lp lq lr ls lt lu lv lw jz lx ka ly kc lz kd ma kf mb kg mc md bi translated">当机器学习不是你的选择时</h1><p id="7539" class="pw-post-body-paragraph ki kj it kk b kl me ju kn ko mf jx kq kr mg kt ku kv mh kx ky kz mi lb lc ld im bi translated">每个人都想用最少的投资获得最多的回报，但不是每个人都花时间去分析股票，因为这不是一件容易的事情。你决定利用你的数据科学技能来帮助你解决这个问题，但发现用机器学习技术来解决这个问题很有挑战性。为什么会这样呢？</p><p id="4cd7" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">虽然机器学习在从数据中学习和做出预测方面很棒，但它在做出最佳决策方面有局限性。但使用 Python MIP(混合整数线性规划)工具，可以轻松确定每年选择的股票。当您的问题涉及多个约束并允许许多可能的解决方案时，只有 MIP 有能力找到最佳解决方案。你可以在这里找到更多关于 MIP <a class="ae mj" href="https://www.gurobi.com/machine-learning-and-mathematical-optimization/" rel="noopener ugc nofollow" target="_blank">的信息。这个博客将向你展示如何使用这个工具为你造福。</a></p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="ml mm di mn bf mo"><div class="gh gi mk"><img src="../Images/1f5aa4f623713a3529ea596a6b28bf34.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*PULJunXZ9pUzYPJn.jpg"/></div></div></figure></div><div class="ab cl mp mq hx mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="im in io ip iq"><h1 id="a46a" class="lm ln it bd lo lp mw lr ls lt mx lv lw jz my ka ly kc mz kd ma kf na kg mc md bi translated">步骤 1:识别和定义参数、约束、变量和目标</h1><p id="27f4" class="pw-post-body-paragraph ki kj it kk b kl me ju kn ko mf jx kq kr mg kt ku kv mh kx ky kz mi lb lc ld im bi translated"><em class="nb">输入参数:</em></p><ul class=""><li id="23a6" class="nc nd it kk b kl km ko kp kr ne kv nf kz ng ld nh ni nj nk bi translated">库存数量(一)</li><li id="1a53" class="nc nd it kk b kl nl ko nm kr nn kv no kz np ld nh ni nj nk bi translated">每年每种股票的预算要求(a[t][i])</li><li id="8e1e" class="nc nd it kk b kl nl ko nm kr nn kv no kz np ld nh ni nj nk bi translated">每年的预算需求(b[t])</li><li id="f451" class="nc nd it kk b kl nl ko nm kr nn kv no kz np ld nh ni nj nk bi translated">每只股票的年回报率(c[i])</li></ul><p id="3157" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="nb">决策变量:</em>是否每年选择一只股票 x[t][i]。这是一个二元变量，选择时 x[t][i] = 1，否则 x[t][i]=0</p><p id="fc46" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="nb">约束:</em>每年所有投资股票的预算需求之和不能超过当年的预算需求</p><p id="2270" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="nb">目标:</em>投资总回报最大化</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/1f671bd4bd253c497f12cf2352497e80.png" data-original-src="https://miro.medium.com/v2/resize:fit:732/format:webp/1*tArnljCjbo7o4kXh7FFy4g.png"/></div></figure><h1 id="787a" class="lm ln it bd lo lp lq lr ls lt lu lv lw jz lx ka ly kc lz kd ma kf mb kg mc md bi translated">步骤 2:用 MIP 编程</h1><h2 id="6983" class="nr ln it bd lo ns nt dn ls nu nv dp lw kr nw nx ly kv ny nz ma kz oa ob mc oc bi translated">在数组和矩阵中保存给定的信息</h2><pre class="lf lg lh li gt od oe of og aw oh bi"><span id="f4cf" class="nr ln it oe b gy oi oj l ok ol">c = [90, 120, 100, 80, 130]<br/>b = [45, 60, 50]<br/>a = [[10, 15, 12, 9, 13],[20, 15, 25, 15, 10],[15, 20, 20, 15, 10]]</span><span id="e283" class="nr ln it oe b gy om oj l ok ol">T, I = range(len(b)),range(len(c))</span></pre><p id="a524" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">安装 MIP</p><pre class="lf lg lh li gt od oe of og aw oh bi"><span id="13e1" class="nr ln it oe b gy oi oj l ok ol">pip install mip==1.4.2 </span><span id="4d1a" class="nr ln it oe b gy om oj l ok ol">from mip.model import *</span></pre><h2 id="4424" class="nr ln it bd lo ns nt dn ls nu nv dp lw kr nw nx ly kv ny nz ma kz oa ob mc oc bi translated">创建模型</h2><pre class="lf lg lh li gt od oe of og aw oh bi"><span id="2bc3" class="nr ln it oe b gy oi oj l ok ol">m = Model(sense = MAXIMIZE,solver_name=CBC)</span></pre><h2 id="9332" class="nr ln it bd lo ns nt dn ls nu nv dp lw kr nw nx ly kv ny nz ma kz oa ob mc oc bi translated">变量</h2><p id="a184" class="pw-post-body-paragraph ki kj it kk b kl me ju kn ko mf jx kq kr mg kt ku kv mh kx ky kz mi lb lc ld im bi translated">用<code class="fe on oo op oe b">add_var()</code>创建变量</p><p id="2d48" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">创建一个包含 n 个二进制决策变量(n = 5)的变量向量，指示是否选择股票</p><pre class="lf lg lh li gt od oe of og aw oh bi"><span id="c337" class="nr ln it oe b gy oi oj l ok ol">x = [[m.add_var(name = names[i], var_type=BINARY) for i in I] for t in T]</span></pre><p id="4f84" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">将<code class="fe on oo op oe b">*xsum()*</code>用于求和表达式</p><pre class="lf lg lh li gt od oe of og aw oh bi"><span id="d201" class="nr ln it oe b gy oi oj l ok ol">m.objective = maximize(xsum(c[i] * x[t][i] for i in I for t in T))</span></pre><h2 id="c355" class="nr ln it bd lo ns nt dn ls nu nv dp lw kr nw nx ly kv ny nz ma kz oa ob mc oc bi translated">限制</h2><p id="b4aa" class="pw-post-body-paragraph ki kj it kk b kl me ju kn ko mf jx kq kr mg kt ku kv mh kx ky kz mi lb lc ld im bi translated">增加每年可用资金的限制</p><pre class="lf lg lh li gt od oe of og aw oh bi"><span id="bc9a" class="nr ln it oe b gy oi oj l ok ol">for t in range(3):  <br/> <!-- -->m += xsum(a[t][i] * x[t][i] for i in I) &lt;= b[t]</span></pre><h2 id="f899" class="nr ln it bd lo ns nt dn ls nu nv dp lw kr nw nx ly kv ny nz ma kz oa ob mc oc bi translated">目标函数</h2><p id="7a26" class="pw-post-body-paragraph ki kj it kk b kl me ju kn ko mf jx kq kr mg kt ku kv mh kx ky kz mi lb lc ld im bi translated"><code class="fe on oo op oe b">Optimize()</code>方法执行配方的优化。Optimize 方法返回搜索的状态(OptimizationStatus)。<code class="fe on oo op oe b">OPTIMAL</code>如果搜索结束并找到最优解。</p><pre class="lf lg lh li gt od oe of og aw oh bi"><span id="93dc" class="nr ln it oe b gy oi oj l ok ol">status = m.optimize() </span><span id="e520" class="nr ln it oe b gy om oj l ok ol">if status == OptimizationStatus.OPTIMAL:  <br/> print('optimal solution cost {} found'.format(m.objective_value)) </span></pre><h2 id="7187" class="nr ln it bd lo ns nt dn ls nu nv dp lw kr nw nx ly kv ny nz ma kz oa ob mc oc bi translated">优化结果</h2><pre class="lf lg lh li gt od oe of og aw oh bi"><span id="91fe" class="nr ln it oe b gy oi oj l ok ol">results = {}<br/>for i in range(3):  <br/> results[i+1] = [m.vars[j].x for j in range(5*i,5*i+5)]</span></pre><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi oq"><img src="../Images/474bb282f4c26d0c5e3a1ef178ea068d.png" data-original-src="https://miro.medium.com/v2/resize:fit:526/format:webp/1*_X9sqSuHob3Uwvc_nPC2TA.png"/></div></figure><pre class="lf lg lh li gt od oe of og aw oh bi"><span id="32d5" class="nr ln it oe b gy oi oj l ok ol">import pandas as pd result = pd.DataFrame(data = results, index = ['A','B','C','D','E'])</span></pre><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi or"><img src="../Images/2bca297c4cfb0eda85855448f9c33946.png" data-original-src="https://miro.medium.com/v2/resize:fit:216/format:webp/1*Vt4mg9PZPhFbIxXPWQgG8A.png"/></div></figure><h2 id="42db" class="nr ln it bd lo ns nt dn ls nu nv dp lw kr nw nx ly kv ny nz ma kz oa ob mc oc bi translated">结果的解释</h2><p id="cae6" class="pw-post-body-paragraph ki kj it kk b kl me ju kn ko mf jx kq kr mg kt ku kv mh kx ky kz mi lb lc ld im bi translated">根据所获得的结果，这是您应该做的，以在每年预算的不同限制下最大化投资的总回报:</p><ul class=""><li id="3394" class="nc nd it kk b kl km ko kp kr ne kv nf kz ng ld nh ni nj nk bi translated">在第一年，投资股票 A、C、D 和 E</li><li id="9991" class="nc nd it kk b kl nl ko nm kr nn kv no kz np ld nh ni nj nk bi translated">在第二年，投资股票 A、B 和 D</li><li id="d59f" class="nc nd it kk b kl nl ko nm kr nn kv no kz np ld nh ni nj nk bi translated">第三年，投资股票 B、C 和 E</li></ul><h2 id="9f09" class="nr ln it bd lo ns nt dn ls nu nv dp lw kr nw nx ly kv ny nz ma kz oa ob mc oc bi translated">关键要点</h2><ul class=""><li id="5a8f" class="nc nd it kk b kl me ko mf kr os kv ot kz ou ld nh ni nj nk bi translated">尽管股票 E 和 B 的投资回报率最高，但由于它们在当年的预算要求较高，因此并不总是被选中。(也就是说，第一年没有选择股票 B，因为与其他股票相比，它的预算要求最高)</li><li id="51e6" class="nc nd it kk b kl nl ko nm kr nn kv no kz np ld nh ni nj nk bi translated">一些股票在一年内没有被选择，不是因为它们的预算要求，而是因为它们的投资回报低(即，股票 A 在第 3 年没有被选择，即使预算要求相对较低)</li></ul><h1 id="e437" class="lm ln it bd lo lp lq lr ls lt lu lv lw jz lx ka ly kc lz kd ma kf mb kg mc md bi translated">结论</h1><p id="d54b" class="pw-post-body-paragraph ki kj it kk b kl me ju kn ko mf jx kq kr mg kt ku kv mh kx ky kz mi lb lc ld im bi translated">恭喜你！您了解了如何使用 MIP 为每一年选择股票以获得最佳价值回报。我希望你在选择你的股票和观察几行代码后的最佳结果时感到愉快。</p><p id="e9c6" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在<a class="ae mj" href="https://github.com/khuyentran1401/Data-science/blob/master/mathematical_programming/invest_stock/stock_invest.ipynb" rel="noopener ugc nofollow" target="_blank"> this Github repo </a>中，您可以随意使用本文的代码。</p><p id="b177" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我喜欢写一些基本的数据科学概念，并尝试不同的算法和数据科学工具。你可以通过<a class="ae mj" href="https://www.linkedin.com/in/khuyen-tran-1401/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>和<a class="ae mj" href="https://twitter.com/KhuyenTran16" rel="noopener ugc nofollow" target="_blank"> Twitter </a>与我联系。</p><p id="24b0" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果你想查看我写的所有文章的代码，请点击这里。在 Medium 上关注我，了解我的最新数据科学文章，例如:</p><div class="ov ow gp gr ox oy"><a rel="noopener follow" target="_blank" href="/how-to-build-a-matrix-module-from-scratch-a4f35ec28b56"><div class="oz ab fo"><div class="pa ab pb cl cj pc"><h2 class="bd iu gy z fp pd fr fs pe fu fw is bi translated">如何从头开始构建矩阵模块</h2><div class="pf l"><h3 class="bd b gy z fp pd fr fs pe fu fw dk translated">如果您一直在为矩阵运算导入 Numpy，但不知道该模块是如何构建的，本文将展示…</h3></div><div class="pg l"><p class="bd b dl z fp pd fr fs pe fu fw dk translated">towardsdatascience.com</p></div></div><div class="ph l"><div class="pi l pj pk pl ph pm lk oy"/></div></div></a></div><div class="ov ow gp gr ox oy"><a rel="noopener follow" target="_blank" href="/step-by-step-tutorial-web-scraping-wikipedia-with-beautifulsoup-48d7f2dfa52d"><div class="oz ab fo"><div class="pa ab pb cl cj pc"><h2 class="bd iu gy z fp pd fr fs pe fu fw is bi translated">用美丽的声音抓取维基百科</h2><div class="pf l"><h3 class="bd b gy z fp pd fr fs pe fu fw dk translated">关于如何使用 Beautiful Soup 的分步教程，这是一个用于 web 抓取的简单易用的 Python 库</h3></div><div class="pg l"><p class="bd b dl z fp pd fr fs pe fu fw dk translated">towardsdatascience.com</p></div></div><div class="ph l"><div class="pn l pj pk pl ph pm lk oy"/></div></div></a></div><div class="ov ow gp gr ox oy"><a rel="noopener follow" target="_blank" href="/find-common-words-in-article-with-python-module-newspaper-and-nltk-8c7d6c75733"><div class="oz ab fo"><div class="pa ab pb cl cj pc"><h2 class="bd iu gy z fp pd fr fs pe fu fw is bi translated">用 Python 模块 Newspaper 和 NLTK 查找文章中的常用词</h2><div class="pf l"><h3 class="bd b gy z fp pd fr fs pe fu fw dk translated">使用 newspaper3k 和 NLTK 从报纸中提取信息和发现见解的分步指南</h3></div><div class="pg l"><p class="bd b dl z fp pd fr fs pe fu fw dk translated">towardsdatascience.com</p></div></div><div class="ph l"><div class="po l pj pk pl ph pm lk oy"/></div></div></a></div><div class="ov ow gp gr ox oy"><a href="https://medium.com/@khuyentran1476/comprehensive-numpy-tutorials-for-beginners-8b88696bd3a2" rel="noopener follow" target="_blank"><div class="oz ab fo"><div class="pa ab pb cl cj pc"><h2 class="bd iu gy z fp pd fr fs pe fu fw is bi translated">为您的数据科学项目提供 Numpy 技巧</h2><div class="pf l"><h3 class="bd b gy z fp pd fr fs pe fu fw dk translated">创建数组、矩阵、执行矩阵运算、解决线性代数问题和常见数据科学的技巧…</h3></div><div class="pg l"><p class="bd b dl z fp pd fr fs pe fu fw dk translated">medium.com</p></div></div><div class="ph l"><div class="pp l pj pk pl ph pm lk oy"/></div></div></a></div></div><div class="ab cl mp mq hx mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="im in io ip iq"><h1 id="f56b" class="lm ln it bd lo lp mw lr ls lt mx lv lw jz my ka ly kc mz kd ma kf na kg mc md bi translated">参考</h1><p id="ac39" class="pw-post-body-paragraph ki kj it kk b kl me ju kn ko mf jx kq kr mg kt ku kv mh kx ky kz mi lb lc ld im bi translated">[1]古罗比。检索自:<a class="ae mj" href="https://www.gurobi.com/machine-learning-and-mathematical-optimization/" rel="noopener ugc nofollow" target="_blank">https://www . guro bi . com/machine-learning-and-mathematical-optimization/</a></p></div></div>    
</body>
</html>