<html>
<head>
<title>Machine Learning 101 - Naive Bayes(2)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">机器学习 101 -朴素贝叶斯(2)</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/machine-learning-101-naive-bayes-2-ccb6e0217d82?source=collection_archive---------24-----------------------#2019-11-20">https://towardsdatascience.com/machine-learning-101-naive-bayes-2-ccb6e0217d82?source=collection_archive---------24-----------------------#2019-11-20</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="55c0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这是我的机器学习 101 系列的第二部分，在我的系列的第一篇文章中，我试图解释决策树和熵计算。下面是链接:<a class="ae kl" rel="noopener" target="_blank" href="/machine-learning-101-id3-decision-trees-and-entropy-calculation-1-a1d66ee9f728">机器学习 101- (1) </a></p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi km"><img src="../Images/ccdb11867cf08dc5df7fd650e0afed2d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XkW_Iu_mUQ7eVmY_LaWMNQ.jpeg"/></div></div></figure><h1 id="710e" class="ky kz iq bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">条件概率</h1><p id="5e47" class="pw-post-body-paragraph jn jo iq jp b jq lw js jt ju lx jw jx jy ly ka kb kc lz ke kf kg ma ki kj kk ij bi translated">在概率论中，条件概率是一个事件发生的<strong class="jp ir">概率</strong>的度量，假设又有一个事件发生。更具体地说，P(B|A)隐含着 A 发生时 B 的概率。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi mb"><img src="../Images/cf530a9f53c2dfac4e3935a1b47d0e93.png" data-original-src="https://miro.medium.com/v2/resize:fit:604/format:webp/1*AjqF_Z63Kw5fNiKfjOH8pA.png"/></div><figcaption class="mc md gj gh gi me mf bd b be z dk">The formula of conditional probability</figcaption></figure><h1 id="016f" class="ky kz iq bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">贝叶斯规则</h1><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi mg"><img src="../Images/f5cc63d89a0ba49f515dc831dd64be40.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*u39ZOo7FIBOQRZduALNiEA.png"/></div></div><figcaption class="mc md gj gh gi me mf bd b be z dk">Bayesian Rule</figcaption></figure><h1 id="7d52" class="ky kz iq bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">最大后验概率</h1><p id="5352" class="pw-post-body-paragraph jn jo iq jp b jq lw js jt ju lx jw jx jy ly ka kb kc lz ke kf kg ma ki kj kk ij bi translated">它用于估计未知的决策。对于所有给定的数据，在所有假设中选择哪个类别的可能性更大。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi mh"><img src="../Images/3706e34e586c9c227fc638de535ba3ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*F-z4uCMo6eGsenjTIGclnA.png"/></div></div><figcaption class="mc md gj gh gi me mf bd b be z dk">The formula of Maximum A Posteriori</figcaption></figure><p id="4ec0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果你不明白为什么分母在公式中被忽略，不要担心，下面的例子会让你明白。</p><h2 id="c7fe" class="mi kz iq bd la mj mk dn le ml mm dp li jy mn mo lm kc mp mq lq kg mr ms lu mt bi translated"><strong class="ak"> Ex: </strong></h2><ul class=""><li id="6200" class="mu mv iq jp b jq lw ju lx jy mw kc mx kg my kk mz na nb nc bi translated">P(class=+|cancer)=0.98(患者被诊断为癌症的概率，并且测试结果也是癌症(+)</li><li id="3986" class="mu mv iq jp b jq nd ju ne jy nf kc ng kg nh kk mz na nb nc bi translated">P(class= — |_cancer_)=0.97(患者被诊断为非癌症的概率，并且测试结果也不是癌症(—))</li><li id="b9ac" class="mu mv iq jp b jq nd ju ne jy nf kc ng kg nh kk mz na nb nc bi translated">p(癌症)= 0.008(被诊断为癌症的患者比率)</li></ul><p id="f61b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">根据给定的约束条件，一个检测结果为阳性的患者属于癌类还是不属于癌(_cancer_)类？</p><p id="ae0f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> P(？|class=+)=？</strong></p><p id="b30b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">一个类中给定概率的总和应该总是 1so；</p><p id="7ca4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">P(_ 癌 _) = 1- P(癌)</p><p id="ee03" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以；</p><p id="c18c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">p(_ cancer _)= 1–0.008 = 0.992</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi ni"><img src="../Images/f8d95ef01c41a29e501b4189a749818d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*80VOtHryVI39yyO8Wy7BeA.png"/></div></div></figure><p id="ae5a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">P(cancer | class =+)=(0.98 * 0.008)/P(class =+)=<strong class="jp ir">0.008/P(class =+)</strong></p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi nj"><img src="../Images/529d491f98d9779ef68a881b23f5a858.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sj06cWhwGUX46TFIN4B8Iw.png"/></div></div></figure><p id="0bb7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">P(_ cancer _ | class =+)= 0.03 * 0.992/P(class =+)=<strong class="jp ir">0.02976/P(class =+)</strong></p><p id="444d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">由于<strong class="jp ir"> 0.02976 </strong>大于<strong class="jp ir"> 0.008，P(？|class=+)=_cancer_ </strong></p><p id="efab" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们忽略了 P(class=+)，因为它是两种情况下的共同常数。即使我们把 P(class=+)计算在内，结果也不会改变。</p><h1 id="2078" class="ky kz iq bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">朴素贝叶斯定理</h1><p id="1532" class="pw-post-body-paragraph jn jo iq jp b jq lw js jt ju lx jw jx jy ly ka kb kc lz ke kf kg ma ki kj kk ij bi translated">朴素贝叶斯定理认为所有的特征都是相互独立的。朴素贝叶斯是文本分类的首选，其成功率相当高。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi nk"><img src="../Images/6c72b63ad31a4b491e4ab16d151852bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1fx50bqJjwoFqfk47uDpQA.png"/></div></div><figcaption class="mc md gj gh gi me mf bd b be z dk">The formula of Naive Bayes</figcaption></figure><p id="3f29" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">例如:</strong>根据下表中的数据集，对杂志促销说<strong class="jp ir">是</strong>，对手表促销说<strong class="jp ir">是</strong>，对人寿保险说<strong class="jp ir">否</strong>，对信用卡保险说<strong class="jp ir">否</strong>的人是什么性别？</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi nl"><img src="../Images/58570f7035ddc72a2c80a78ccc74e876.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*o3hVj9G9OeOeiSqt69reYg.png"/></div></div><figcaption class="mc md gj gh gi me mf bd b be z dk">[1]</figcaption></figure><p id="53eb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">问题的简化版本；如果(是，是，不是，不是)-&gt;性别=？</p><p id="23ef" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们有两个假设需要检验，结果是男(M)还是女(F)？为此，我们将分别计算两者的结果(因为它们互不影响)，并选择值较大的一个作为答案。</p><p id="89d9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> X =(是，是，否，否)</strong></p><p id="4909" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">假设 1: </strong></p><p id="ff70" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在第一个假设中，我们接受性是男性的，并根据它寻找结果。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/2d4a714cfe18e3081f4566ae9f5fefdf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*3meTeZwa5G7fDzsiTpaXsA.png"/></div></figure><p id="419c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">P(sex=M|X)=？由于右侧概率首先由独立的特征组成，我们将分别找到每个特征的概率结果，然后将它们相乘以获得最终的解。</p><p id="74be" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">P(magazine_promotion=Y|sex=M)(一个是男性的人对杂志促销说“是”的概率)= 4/6(一个是男性的人对杂志促销说“是”<strong class="jp ir"> / </strong>男性总数)P(watch _ Promotion = Y | sex = M)= 2/6<br/>P(life _ insurance = N | sex = M)= 4/6<br/>P(credit _ card _ insurance = N | sex = M)= 4/6</p><p id="c56d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">既然都是独立功能:</strong></p><p id="4189" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">P(X | sex = M)</strong>= P(magazine _ promotion = Y | sex = M)* P(watch _ promotion = Y | sex = M)* P(life _ insurance =N|sex=M)* P(信用卡 _ 保险= N | sex = M)</p><p id="c2bf" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">P(X | sex = M)</strong>=(4/6)*(2/6)*(4/6)*(4/6)= 0.0988</p><p id="3f94" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">P(sex = M)= 0.6<br/><strong class="jp ir">P(sex = M | X)= 0.0988 * 0.6 =<em class="nn">0.0593</em></strong></p><p id="205d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">假设二:</strong></p><p id="47fe" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">最后，在第二个假设中，我们接受性是男性的，并根据它寻找结果。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi no"><img src="../Images/2c37b30215160fb9f84804a1ebbfedb4.png" data-original-src="https://miro.medium.com/v2/resize:fit:928/format:webp/1*t4FpxfNVho8leETIQ2odMA.png"/></div></figure><p id="780f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">p(X | sex = F)=(3/4)*(2/4)*(1/4)*(3/4)= 0.07</p><p id="7d43" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">p(性别=F)=0.4</p><p id="b9d7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> P(sex=F|X)= 0.0281 </strong></p><p id="3e58" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">由于 0.0593 &gt; 0.0281，贝叶斯分类器得出<strong class="jp ir">男</strong>的可能性较高。</p><h2 id="ba3a" class="mi kz iq bd la mj mk dn le ml mm dp li jy mn mo lm kc mp mq lq kg mr ms lu mt bi translated"><strong class="ak">拉普拉斯平滑</strong></h2><p id="05c8" class="pw-post-body-paragraph jn jo iq jp b jq lw js jt ju lx jw jx jy ly ka kb kc lz ke kf kg ma ki kj kk ij bi translated">例如，如果我们使用朴素贝叶斯对电子邮件中的单词进行分类，并确定该邮件是垃圾邮件还是良性邮件。当我们遇到一个不包含在训练集中的单词时，该值将被赋为 0。而概率值会以 0 结束，因为乘法计算中 0 占优势。在这种情况下，可以使用<strong class="jp ir">拉普拉斯(1-up)平滑</strong>。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi np"><img src="../Images/dc3ee7316d3c50b0a1708803232151d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Brx6yiWUHp2sYEMHhtXjpg.png"/></div></div></figure><p id="4e53" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">例如:</strong></p><p id="d04d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">A 类:</strong>“猫蟹呱呱叫下楼梯”</p><p id="1884" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">B 类:</strong>《下着倾盆大雨》</p><p id="4400" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">根据上面的分类，对 X =“猫吃老鼠，狗吃兔子骨头”的下列文字进行分类</p><p id="64cb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">词汇</strong>= {猫、蟹、小曲、楼梯、雨、狗}</p><p id="d43a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">P(vⱼ) = 1/2(班级将是 a 或 b，所以一半的机会)</p><p id="ead4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">|Vocab|=6</p><p id="c6f0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">nA=4</p><p id="87d2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">nB=3</p><p id="ee9e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在 X 文本中，猫和狗的单词是在词汇中发现的唯一的单词。所以我们只使用它们:</p><p id="0ace" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">e=ij</p><p id="6ad3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">P(xᵢ|vⱼ)=(nₑ+ 1)/(nⱼ + 6)</p><p id="d9cd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">假设 1: <br/> </strong> P(A|X) = P(A)*P(猫|A)*P(狗| A)= 1/2 *(1+1)/(4+6)*(0+1)/4+6 =<strong class="jp ir">0.01</strong></p><p id="c43a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">假设二:<br/> </strong> P(B|X) = P(B)*P(猫|B)*P(狗| B)= 1/2 *(1+1)/(3+6)*(1+1)/(3+6)=<strong class="jp ir">0.024</strong></p><p id="476a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">因为 0.024&gt;0.01，所以 X 文本属于 B 类</p><h2 id="51b0" class="mi kz iq bd la mj mk dn le ml mm dp li jy mn mo lm kc mp mq lq kg mr ms lu mt bi translated">参考</h2><p id="f982" class="pw-post-body-paragraph jn jo iq jp b jq lw js jt ju lx jw jx jy ly ka kb kc lz ke kf kg ma ki kj kk ij bi translated">[1]<a class="ae kl" href="http://www.cs.ust.hk/~qyang/521/Readings/sample06.html" rel="noopener ugc nofollow" target="_blank">http://www.cs.ust.hk/~qyang/521/Readings/sample06.html</a></p></div></div>    
</body>
</html>