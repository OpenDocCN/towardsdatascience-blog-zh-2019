<html>
<head>
<title>OHLC Charts With Python Libraries</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">带有 Python 库的 OHLC 图表</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/ohlc-charts-with-python-libraries-c58c1ff080b0?source=collection_archive---------17-----------------------#2019-11-22">https://towardsdatascience.com/ohlc-charts-with-python-libraries-c58c1ff080b0?source=collection_archive---------17-----------------------#2019-11-22</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="a9d6" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">Python 程序员可以使用几个图形库。最流行的两个是<a class="ae ko" href="https://matplotlib.org/" rel="noopener ugc nofollow" target="_blank"> Matplotlib </a>和<a class="ae ko" href="https://plot.ly/" rel="noopener ugc nofollow" target="_blank"> Plotly </a>。选对库要看你的情况。我在两个库中重新创建了 OHLC ( <a class="ae ko" href="https://en.wikipedia.org/wiki/Open-high-low-close_chart" rel="noopener ugc nofollow" target="_blank">开盘-盘高-盘低-收盘</a>)图来突出这些差异，并包含了下面的代码。</p><h1 id="bf71" class="kp kq it bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">Matplotlib</h1><p id="1677" class="pw-post-body-paragraph jq jr it js b jt ln jv jw jx lo jz ka kb lp kd ke kf lq kh ki kj lr kl km kn im bi translated">Matplotlib 是我开始用 Python 编程时学会使用的第一个图形和绘图库。这是一个高度可定制的库，这既是它的优势也是它的弱点。您可以为您的特定目的制作强大的可视化，但是有大量可定制的代码需要调整。</p><p id="a605" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">Matplotlib 的<a class="ae ko" href="https://matplotlib.org/api/finance_api.html" rel="noopener ugc nofollow" target="_blank">财务模块</a>已被弃用，并被移至<code class="fe ls lt lu lv b">mpl_finance</code>模块。许多在线教程没有反映出这一变化，但是，该补丁相对容易用 PIP 包安装工具实现。我专门为这个练习创建了一个新环境，因为我不想在我的主环境中使用这个模块。该模块以 zip 文件的形式位于 Matplotlib 的 GitHub profile 上，命令如下:</p><p id="754e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><code class="fe ls lt lu lv b">!pip install <a class="ae ko" href="https://github.com/matplotlib/mpl_finance/archive/master.zip" rel="noopener ugc nofollow" target="_blank">https://github.com/matplotlib/mpl_finance/archive/master.zip</a></code></p><p id="91fd" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我决定绘制金宝汤公司(CPB)的年初至今(YTD) OHLC 图，截至 2019 年 11 月 21 日。数据是从<a class="ae ko" href="https://finance.yahoo.com/quote/CPB/history?p=CPB&amp;.tsrc=fin-srch" rel="noopener ugc nofollow" target="_blank">雅虎财经</a>下载的。</p><figure class="lw lx ly lz gt ma"><div class="bz fp l di"><div class="mb mc l"/></div><figcaption class="md me gj gh gi mf mg bd b be z dk">Plotting the YTD OHLC chart for the Campbell Soup Company with Matplotlib. The data came from Yahoo Finance and the tutorial was made by Harrison Kinsley.</figcaption></figure><p id="e352" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">主要的困难是解开熊猫数据框的行，并将日期字符串转换成 Matplotlib 的<a class="ae ko" href="https://matplotlib.org/3.1.1/api/dates_api.html" rel="noopener ugc nofollow" target="_blank">浮点数格式</a>。我的日期是字符串格式的，所以我可以使用 Matplotlib 的<code class="fe ls lt lu lv b">datestr2num()</code>方法。</p><figure class="lw lx ly lz gt ma gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi mh"><img src="../Images/99b09ffda11de00d364aa1e565211bf0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ICsljv-DMZ2vqF0soNjkFQ.png"/></div></div><figcaption class="md me gj gh gi mf mg bd b be z dk">The Campbell Soup Company YTD chart created with Matplotlib</figcaption></figure><h1 id="fdd7" class="kp kq it bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">Plotly</h1><p id="a3f3" class="pw-post-body-paragraph jq jr it js b jt ln jv jw jx lo jz ka kb lp kd ke kf lq kh ki kj lr kl km kn im bi translated">Plotly 提供了许多产品，包括一个用于 Python 语言的开源图形库。Plotly 提供了许多交互式图表，包括几个特定于金融的图表。我重新创建了坎贝尔 OHLC 年初至今图表如下。</p><figure class="lw lx ly lz gt ma"><div class="bz fp l di"><div class="mb mc l"/></div><figcaption class="md me gj gh gi mf mg bd b be z dk">The code for a Plotly OHLC chart with a rangeslider for the Campbell Soup Company</figcaption></figure><p id="3fa4" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">Plotly 在熊猫数据框中运行良好。这些柱子可以直接使用，不需要拆开它们。在 Plotly 的 OHLC 图表部分有几个可用的选项。这段代码生成了一个带有 rangeslider 和 hovertext 的交互式图表。rangeslider 允许您放大特定时间段，悬停文本提供有关该数据点的更多信息。该图表的静态图像如下:</p><figure class="lw lx ly lz gt ma gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi mo"><img src="../Images/3bc0a72fee9e00fad83e30479e87f1c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GN3n4uvO_j5QQEZMA3Lb5Q.png"/></div></div><figcaption class="md me gj gh gi mf mg bd b be z dk">An image of the interactive Campbell OHLC chart produced with Plotly. The rangeslider below allows you to zoom in on a time period.</figcaption></figure><figure class="lw lx ly lz gt ma gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi mp"><img src="../Images/c973d77fc9b41c0dcaa073150ba3a44e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*m8embBD_ttwdKuwDUtNuDA.png"/></div></div><figcaption class="md me gj gh gi mf mg bd b be z dk">A zoomed in version of the Plotly chart with a rangeslider and hovertext window open.</figcaption></figure><h1 id="dd08" class="kp kq it bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">增长率</h1><p id="354a" class="pw-post-body-paragraph jq jr it js b jt ln jv jw jx lo jz ka kb lp kd ke kf lq kh ki kj lr kl km kn im bi translated">我用熊猫和 Plotly 制作了两个增长率图表。Pandas 的<code class="fe ls lt lu lv b">pct_change()</code>方法计算行条目之间的百分比变化。我利用 Plotly 的<a class="ae ko" href="https://plot.ly/python/line-and-scatter/" rel="noopener ugc nofollow" target="_blank">线和分散</a>函数创建了这个图表，代码如下:</p><figure class="lw lx ly lz gt ma"><div class="bz fp l di"><div class="mb mc l"/></div><figcaption class="md me gj gh gi mf mg bd b be z dk">The code for a Plotly growth rate line chart</figcaption></figure><p id="bbae" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">您也可以向图中添加多条轨迹。我比较了 Campbells 的增长率和标准普尔 500 指数的增长率:</p><figure class="lw lx ly lz gt ma gh gi paragraph-image"><div class="gh gi mo"><img src="../Images/5e067bff76a823821ecccd51b054ca99.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*X8709eoc0Wmn7UI1DboSwg.png"/></div><figcaption class="md me gj gh gi mf mg bd b be z dk">The Campbell Soup Company YTD growth chart with Plotly</figcaption></figure><figure class="lw lx ly lz gt ma gh gi paragraph-image"><div class="gh gi mo"><img src="../Images/63a9bb47fe199fc391f8fd29ac48495c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZimXRkxzpeUl82X-2_eakg.png"/></div><figcaption class="md me gj gh gi mf mg bd b be z dk">The Campbell Soup Company and S&amp;P 500 growth chart with Plotly</figcaption></figure><h1 id="a7a3" class="kp kq it bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">比较和总结</h1><p id="1cb3" class="pw-post-body-paragraph jq jr it js b jt ln jv jw jx lo jz ka kb lp kd ke kf lq kh ki kj lr kl km kn im bi translated">Matplotlib 和 Plotly 在数据科学家的工具包中都有它们的位置。Matplotlib 是高度可定制的，但是需要更多的编码和数据准备，这是非常耗时的。Plotly 用相对较少的代码创建了强大的交互式可视化。我更喜欢用 Plotly 制作 OHLC 图表。您可以根据自己的目的决定需要哪个库。</p></div></div>    
</body>
</html>