<html>
<head>
<title>Twitter Sentiment Analysis using NLTK, Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用 NLTK、Python 的 Twitter 情感分析</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/twitter-sentiment-analysis-classification-using-nltk-python-fa912578614c?source=collection_archive---------2-----------------------#2019-09-25">https://towardsdatascience.com/twitter-sentiment-analysis-classification-using-nltk-python-fa912578614c?source=collection_archive---------2-----------------------#2019-09-25</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="3fdb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">自然语言处理(NLP)是机器学习的一个独特子集，它关注现实生活中的非结构化数据。尽管计算机不能识别和处理字符串输入，但是 NLTK、TextBlob 和许多其他库找到了一种用数学方法处理字符串的方法。Twitter 是一个平台，大多数人在这里表达他们对当前环境的感受。作为人类，我们可以猜测一个句子的情绪是积极的还是消极的。同样，在本文中，我将向您展示如何使用 python 和 NLP 库来训练和开发一个简单的 Twitter 情感分析监督学习模型。</p><p id="e1d1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们从导入这个项目所需的库开始。</p><figure class="kl km kn ko gt kp"><div class="bz fp l di"><div class="kq kr l"/></div></figure><p id="6126" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">由于这是一个监督学习任务，我们得到了一个由标有“1”或“0”的推文组成的训练数据集和一个没有标签的测试数据集。训练和测试数据集可以在<a class="ae ks" href="https://github.com/MohamedAfham/Twitter-Sentiment-Analysis-Supervised-Learning/tree/master/Data" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p><ul class=""><li id="4ed8" class="kt ku iq jp b jq jr ju jv jy kv kc kw kg kx kk ky kz la lb bi translated">标签“0”:积极情绪</li><li id="bf71" class="kt ku iq jp b jq lc ju ld jy le kc lf kg lg kk ky kz la lb bi translated">标签“1”:消极情绪</li></ul><p id="cf50" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在我们用熊猫来读数据。</p><pre class="kl km kn ko gt lh li lj lk aw ll bi"><span id="ca31" class="lm ln iq li b gy lo lp l lq lr">train_tweets = pd.read_csv('train_tweets.csv')<br/>test_tweets = pd.read_csv('test_tweets.csv')</span></pre><h2 id="1c59" class="lm ln iq bd ls lt lu dn lv lw lx dp ly jy lz ma mb kc mc md me kg mf mg mh mi bi translated">探索性数据分析</h2><p id="1cae" class="pw-post-body-paragraph jn jo iq jp b jq mj js jt ju mk jw jx jy ml ka kb kc mm ke kf kg mn ki kj kk ij bi translated">无论在哪个领域，对机器学习问题进行数据分析都是必要的。让我们做一些分析，以获得一些见解。</p><pre class="kl km kn ko gt lh li lj lk aw ll bi"><span id="c259" class="lm ln iq li b gy lo lp l lq lr">sns.barplot('label','length',data = train_tweets,palette='PRGn')</span></pre><figure class="kl km kn ko gt kp gh gi paragraph-image"><div class="gh gi mo"><img src="../Images/ab219e33d9b478fa365216985eb7e381.png" data-original-src="https://miro.medium.com/v2/resize:fit:864/format:webp/1*pPg7O89iJWVoBN92t5HKRg.png"/></div></figure><pre class="kl km kn ko gt lh li lj lk aw ll bi"><span id="553e" class="lm ln iq li b gy lo lp l lq lr">sns.countplot(x= 'label',data = train_tweets)</span></pre><figure class="kl km kn ko gt kp gh gi paragraph-image"><div class="gh gi mo"><img src="../Images/80a48521bf97feed21fdbfd4b7c424e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:864/format:webp/1*DGH5azxYlUKCOlzfmE7JFw.png"/></div></figure><p id="0c37" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">上面两张图告诉我们，给定的数据是不平衡的，只有很少数量的“1”标签，推文的长度在分类中没有起主要作用。处理不平衡数据是一个单独的部分，我们将尝试为现有的数据集生成一个最佳模型。</p><h2 id="6b33" class="lm ln iq bd ls lt lu dn lv lw lx dp ly jy lz ma mb kc mc md me kg mf mg mh mi bi translated">数据预处理和特征工程</h2><p id="cad9" class="pw-post-body-paragraph jn jo iq jp b jq mj js jt ju mk jw jx jy ml ka kb kc mm ke kf kg mn ki kj kk ij bi translated">给定的数据集由非常多的非结构化 tweets 组成，应该对其进行预处理以建立 NLP 模型。在这个项目中，我们尝试了以下预处理原始数据的技术。但是预处理技术不受限制。</p><ul class=""><li id="cdd5" class="kt ku iq jp b jq jr ju jv jy kv kc kw kg kx kk ky kz la lb bi translated">删除标点符号。</li><li id="774c" class="kt ku iq jp b jq lc ju ld jy le kc lf kg lg kk ky kz la lb bi translated">删除常用词(停用词)。</li><li id="a77d" class="kt ku iq jp b jq lc ju ld jy le kc lf kg lg kk ky kz la lb bi translated">文字规范化。</li></ul><p id="0a54" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">标点符号</strong>在 NLP 中总是一个干扰，特别是标签和“@”在 tweets 中扮演主要角色。TextBlob 从句子中提取单词的功能可以在最佳水平上删除标点符号。遗漏的标点符号和其他不常见的符号将在即将到来的预处理技术中删除。</p><figure class="kl km kn ko gt kp"><div class="bz fp l di"><div class="kq kr l"/></div></figure><p id="cb51" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">在 NLP 任务中，停用词</strong>(最常见的词，例如:is，are，have)在学习中没有意义，因为它们与情感没有联系。因此，去除它们既节省了计算能力，又提高了模型的准确性。</p><figure class="kl km kn ko gt kp"><div class="bz fp l di"><div class="kq kr l"/></div></figure><p id="c07c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所有不常见的符号和数值都被删除，并返回一个包含单词的纯列表，如上所示。但是我们仍然会遇到同一个词的多种表达。(例如:play，plays，played，playing)尽管单词不同，但它们给我们带来的意思和正常单词“play”一样。所以我们需要做<strong class="jp ir">词汇规范化</strong>的方法来解决这个问题。NLTK 内置的 WordNetLemmatizer 就做到了这一点。</p><figure class="kl km kn ko gt kp"><div class="bz fp l di"><div class="kq kr l"/></div></figure><p id="16cc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在我们已经完成了我们的文本预处理部分，我们将进入矢量化和模型选择。</p><h2 id="abf4" class="lm ln iq bd ls lt lu dn lv lw lx dp ly jy lz ma mb kc mc md me kg mf mg mh mi bi translated">矢量化和模型选择</h2><p id="e2fa" class="pw-post-body-paragraph jn jo iq jp b jq mj js jt ju mk jw jx jy ml ka kb kc mm ke kf kg mn ki kj kk ij bi translated">在让我们的数据训练之前，我们必须用数字表示预处理过的数据。自然语言处理中比较著名的单词矢量化技术有:CountVectorization 和 Tf-IDF 变换。让我们深入了解一下这些矢量化技术的理论背景。</p><p id="6805" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">计数矢量化</strong>生成一个代表文档中所有单词的<a class="ae ks" href="https://en.wikipedia.org/wiki/Sparse_matrix" rel="noopener ugc nofollow" target="_blank">稀疏矩阵</a>。计数矢量化的演示如下所示:</p><figure class="kl km kn ko gt kp gh gi paragraph-image"><div role="button" tabindex="0" class="ms mt di mu bf mv"><div class="gh gi mr"><img src="../Images/92fe46dd1c0ad1607be8d8cd2b422cf1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CfcTH_TIWNqVDDWI94aK5g.png"/></div></div><figcaption class="mw mx gj gh gi my mz bd b be z dk">Demonstration of Count Vectorization</figcaption></figure><ul class=""><li id="9ad3" class="kt ku iq jp b jq jr ju jv jy kv kc kw kg kx kk ky kz la lb bi translated"><strong class="jp ir"> Tf(d，t) </strong>(术语频率)定义为术语 t 在文档 d 中的出现次数。</li><li id="d924" class="kt ku iq jp b jq lc ju ld jy le kc lf kg lg kk ky kz la lb bi translated"><strong class="jp ir"> Idf(t) </strong>(频率的逆文档)定义为 log(D/t)，其中 D:文档总数，t:带项的文档数。</li></ul><p id="f3db" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> Tf-Idf </strong> transformer 做的是返回<strong class="jp ir"> Tf </strong>和<strong class="jp ir"> Idf </strong>的乘积，也就是该项的<strong class="jp ir"> Tf-Idf </strong>权重。</p><p id="6821" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">因此，我们现在已经将我们的 sting 数据矢量化为数值，以便将其输入到机器学习算法中。我们选择<strong class="jp ir">朴素贝叶斯分类器</strong>进行二进制分类，因为它是 NLP 中最常用的算法。此外，我们使用 scikit-learn 内置的机器学习流水线技术来预定义算法的工作流程。这节省了大量时间和计算能力。</p><figure class="kl km kn ko gt kp"><div class="bz fp l di"><div class="kq kr l"/></div></figure><h2 id="14f3" class="lm ln iq bd ls lt lu dn lv lw lx dp ly jy lz ma mb kc mc md me kg mf mg mh mi bi translated">模型验证</h2><p id="dd2f" class="pw-post-body-paragraph jn jo iq jp b jq mj js jt ju mk jw jx jy ml ka kb kc mm ke kf kg mn ki kj kk ij bi translated">因为我们决定选择自然语言处理技术，所以在应用于测试数据集之前，我们必须用现有的训练数据集来验证它。我们将使用传统的 train_test_split 技术来分割测试大小为 0.2 的训练数据集，并让我们的管道模型在分割的数据集上得到验证。一旦我们对验证的准确性感到满意，我们就可以将获得的模型应用于测试数据集。使用 scikit-learn、混淆矩阵和分类报告的内置功能来测量准确度。</p><figure class="kl km kn ko gt kp"><div class="bz fp l di"><div class="kq kr l"/></div></figure><figure class="kl km kn ko gt kp gh gi paragraph-image"><div class="gh gi na"><img src="../Images/8dae3d1a0fa32926065be17da8be1a2a.png" data-original-src="https://miro.medium.com/v2/resize:fit:892/format:webp/1*tsOdjdZvNv9JpuKoVp_txQ.png"/></div><figcaption class="mw mx gj gh gi my mz bd b be z dk">Output of the above code</figcaption></figure><p id="df03" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">对于我们的简单管道模型，获得了 0.93837 的精度。请注意，通过使用 GridSearchCV 和其他预处理技术调整参数，有机会提高这种准确性。</p><p id="cb35" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">希望这篇文章给你一个用 NLTK 和 Python 进行情感分析的基本概念。此处提供了该项目的完整笔记本<a class="ae ks" href="https://github.com/MohamedAfham/Twitter-Sentiment-Analysis-Supervised-Learning" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="02c4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">下面是一些有用的链接，可以帮助我们开始使用我们在这个项目中使用的自然语言处理库:</p><ul class=""><li id="a7ea" class="kt ku iq jp b jq jr ju jv jy kv kc kw kg kx kk ky kz la lb bi translated"><a class="ae ks" href="https://www.nltk.org/book/" rel="noopener ugc nofollow" target="_blank"> NLTK 书籍</a>:分析文本的完整指南</li><li id="4e5b" class="kt ku iq jp b jq lc ju ld jy le kc lf kg lg kk ky kz la lb bi translated"><a class="ae ks" href="https://textblob.readthedocs.io/en/dev/" rel="noopener ugc nofollow" target="_blank">文本斑点处理</a></li><li id="5929" class="kt ku iq jp b jq lc ju ld jy le kc lf kg lg kk ky kz la lb bi translated"><a class="ae ks" href="https://scikit-learn.org/stable/tutorial/text_analytics/working_with_text_data.html" rel="noopener ugc nofollow" target="_blank">在 scikit 中处理文本数据-学习</a></li><li id="f4cc" class="kt ku iq jp b jq lc ju ld jy le kc lf kg lg kk ky kz la lb bi translated"><a class="ae ks" href="https://monkeylearn.com/sentiment-analysis/" rel="noopener ugc nofollow" target="_blank">monkey learn 的情感分析指南</a></li></ul></div></div>    
</body>
</html>