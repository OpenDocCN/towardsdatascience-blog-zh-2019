<html>
<head>
<title>Understanding 1D and 3D Convolution Neural Network | Keras</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">了解 1D 和 3D 卷积神经网络| Keras</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/understanding-1d-and-3d-convolution-neural-network-keras-9d8f76e29610?source=collection_archive---------0-----------------------#2019-09-20">https://towardsdatascience.com/understanding-1d-and-3d-convolution-neural-network-keras-9d8f76e29610?source=collection_archive---------0-----------------------#2019-09-20</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/f2f25b8640f14540037a6ae0ffd68d12.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rtTzjxWmhnNGKkebU_grYQ.jpeg"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk">Image by <a class="ae kf" href="https://wallpapersafari.com/w/d4KBN6" rel="noopener ugc nofollow" target="_blank">WallpeperSafari</a></figcaption></figure><p id="c893" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">当我们说<strong class="ki iu">卷积神经网络</strong> (CNN)时，通常我们指的是用于图像分类的二维 CNN。但是在现实世界中使用了两种其他类型的卷积神经网络，它们是 1 维和 3 维 CNN。在本指南中，我们将介绍<strong class="ki iu"> 1D </strong>和<strong class="ki iu">3D</strong>CNN 及其在现实世界中的应用。我假设你已经熟悉卷积网络的一般概念。</p></div><div class="ab cl le lf hx lg" role="separator"><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj"/></div><div class="im in io ip iq"><h1 id="e7d9" class="ll lm it bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">二维 CNN | Conv2D</h1><p id="5fb4" class="pw-post-body-paragraph kg kh it ki b kj mj kl km kn mk kp kq kr ml kt ku kv mm kx ky kz mn lb lc ld im bi translated">这是在<strong class="ki iu"> Lenet-5 </strong>架构中首次引入的标准<strong class="ki iu">卷积神经网络</strong>。<strong class="ki iu"> Conv2D </strong>一般用于图像数据。它被称为二维 CNN，因为<strong class="ki iu">内核</strong>在数据上沿二维滑动，如下图所示。</p><figure class="mp mq mr ms gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mo"><img src="../Images/4098c1eb7dd09876c0c8cf78c28ece51.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MD3v02UY8-3iqsxPWto8vQ.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk">Kernal sliding over the Image</figcaption></figure><p id="1e06" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">使用 CNN 的整体优势在于，它可以使用其内核从数据中提取空间特征，这是其他网络无法做到的。例如，CNN 可以检测图像中的边缘、颜色分布等，这使得这些网络在图像分类和包含空间属性的其他类似数据中非常健壮。</p><p id="82e2" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">以下是在 keras 中添加一个<strong class="ki iu"> Conv2D </strong>层的代码。</p><figure class="mp mq mr ms gt ju"><div class="bz fp l di"><div class="mt mu l"/></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk">Conv2D Layer in Keras</figcaption></figure><p id="a3ae" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">参数<strong class="ki iu"> input_shape </strong> (128，128，3)表示图像的(高度，宽度，深度)。参数<strong class="ki iu"> kernel_size </strong> (3，3)表示内核的(高度，宽度)，内核深度将与图像的深度相同。</p></div><div class="ab cl le lf hx lg" role="separator"><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj"/></div><div class="im in io ip iq"><h1 id="5c95" class="ll lm it bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">一维 CNN | Conv1D</h1><p id="5309" class="pw-post-body-paragraph kg kh it ki b kj mj kl km kn mk kp kq kr ml kt ku kv mm kx ky kz mn lb lc ld im bi translated">在看完《T21》之前，让我给你一个提示。在 Conv1D 中，<strong class="ki iu">内核</strong>沿一维滑动。现在让我们在这里暂停博客，想一想哪种类型的数据只需要在一维上进行内核滑动，并且具有空间属性？</p><p id="a30f" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">答案是时间序列数据。我们来看下面的数据。</p><figure class="mp mq mr ms gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mv"><img src="../Images/efa9149838f3ceabfb33bd50dbc79aa2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gwxD9U7uZPcKOqP4w-ABXg.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk">Time series data from an accelerometer</figcaption></figure><p id="c6f7" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这个数据是从一个人戴在手臂上的加速度计收集的。数据代表所有 3 个轴上的加速度。1D CNN 可以从加速度计数据中执行活动识别任务，例如人是否站立、行走、跳跃等。这个数据有两个维度。第一维是时间步长，另一维是 3 个轴上的加速度值。</p><p id="4110" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">下面的图说明了内核将如何处理加速度计数据。每行代表某个轴的时间序列加速度。内核只能沿着时间轴在一维上移动。</p><figure class="mp mq mr ms gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mw"><img src="../Images/934318433403563699652f31727b6985.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JMt3BwFFyyIO780dDIN4Uw.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk">Kernel sliding over accelerometer data</figcaption></figure><p id="b3ab" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">下面是在 keras 中添加一个<strong class="ki iu"> Conv1D </strong>层的代码。</p><figure class="mp mq mr ms gt ju"><div class="bz fp l di"><div class="mt mu l"/></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk">Conv1D Layer in Keras</figcaption></figure><p id="e2a0" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">自变量<strong class="ki iu"> input_shape </strong> (120，3)，表示 120 个时间步长，每个时间步长中有 3 个数据点。这 3 个数据点是 x、y 和 z 轴的加速度。参数<strong class="ki iu"> kernel_size </strong>为 5，代表内核的宽度，内核高度将与每个时间步的数据点数相同。</p><p id="d607" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">类似地，1D CNN 也用于音频和文本数据，因为我们也可以将声音和文本表示为时间序列数据。请参考下面的图片。</p><figure class="mp mq mr ms gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mx"><img src="../Images/30ae63fe4400a0af53d01c8c46844e3d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4mOC0rCQHjS1oYfnNt5DGw.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk">Text data as Time Series</figcaption></figure><p id="f811" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">Conv1D 广泛应用于传感数据，加速度计数据就是其中之一。</p></div><div class="ab cl le lf hx lg" role="separator"><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj"/></div><div class="im in io ip iq"><h1 id="a2be" class="ll lm it bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">三维 CNN | Conv3D</h1><p id="4a97" class="pw-post-body-paragraph kg kh it ki b kj mj kl km kn mk kp kq kr ml kt ku kv mm kx ky kz mn lb lc ld im bi translated">在<strong class="ki iu"> Conv3D </strong>中，<strong class="ki iu">内核</strong>在三维空间滑动，如下图所示。让我们再想想哪种数据类型需要内核在三维空间中移动？</p><figure class="mp mq mr ms gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi my"><img src="../Images/bb6e590692f6e910f8b4712c72783012.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*z5wfLwBCEgAPTI_U1mSaVA.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk">Kernel sliding on 3D data</figcaption></figure><p id="993f" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">Conv3D 主要用于 3D 图像数据。如<strong class="ki iu">磁共振成像</strong> (MRI)数据。MRI 数据被广泛用于检查大脑、脊髓、内部器官等。<strong class="ki iu">计算机断层扫描</strong> (CT)也是 3D 数据的一个例子，它是通过组合从身体周围不同角度拍摄的一系列 X 射线图像而创建的。我们可以使用 Conv3D 对这些医疗数据进行分类，或者从中提取特征。</p><figure class="mp mq mr ms gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mz"><img src="../Images/17284aaf13449e8b83ec36433c5aa7c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*R_aWDEk6oDlM7s-ywIPNsQ.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk">Cross Section of 3D Image of CT Scan and MRI</figcaption></figure><p id="42f4" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">3D 数据的另一个例子是<strong class="ki iu">视频</strong>。视频只不过是一系列图像帧的组合。我们也可以在视频上应用 Conv3D，因为它具有空间特征。</p><p id="f267" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">以下是在 keras 中添加<strong class="ki iu"> Conv3D </strong>层的代码。</p><figure class="mp mq mr ms gt ju"><div class="bz fp l di"><div class="mt mu l"/></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk">Conv3D Layer in Keras</figcaption></figure><p id="a82c" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这里参数<strong class="ki iu">输入形状</strong> (128，128，128，3)有 4 个维度。3D 图像是四维数据，其中第四维表示<strong class="ki iu">颜色通道</strong>的数量。就像平面 2D 图像具有三维，其中第三维表示颜色通道。参数<strong class="ki iu"> kernel_size </strong> (3，3，3)表示内核的(高度，宽度，深度)，内核的第四维将与颜色通道相同。</p></div><div class="ab cl le lf hx lg" role="separator"><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj"/></div><div class="im in io ip iq"><h1 id="ef94" class="ll lm it bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">摘要</h1><ul class=""><li id="35c3" class="na nb it ki b kj mj kn mk kr nc kv nd kz ne ld nf ng nh ni bi translated">在<strong class="ki iu"> 1D CNN </strong>中，内核向<strong class="ki iu"> 1 </strong>方向移动。1D CNN 的输入输出数据是<strong class="ki iu"> 2 </strong>维的。主要用于<strong class="ki iu">时间序列</strong>数据。</li><li id="4a96" class="na nb it ki b kj nj kn nk kr nl kv nm kz nn ld nf ng nh ni bi translated">在<strong class="ki iu"> 2D CNN </strong>中，内核向<strong class="ki iu"> 2 </strong>方向移动。2D CNN 的输入输出数据是<strong class="ki iu"> 3 </strong>维的。主要用于<strong class="ki iu">图像</strong>数据。</li><li id="6e6f" class="na nb it ki b kj nj kn nk kr nl kv nm kz nn ld nf ng nh ni bi translated">在<strong class="ki iu"> 3D CNN </strong>中，内核在<strong class="ki iu"> 3 </strong>方向移动。3D CNN 的输入输出数据为<strong class="ki iu"> 4 </strong>维。主要用于<strong class="ki iu"> 3D </strong>图像<strong class="ki iu">数据</strong>(MRI、CT 扫描、视频)。</li></ul></div><div class="ab cl le lf hx lg" role="separator"><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj"/></div><div class="im in io ip iq"><p id="c836" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu">接下来是</strong></p><div class="no np gp gr nq nr"><a href="https://shiva-verma.medium.com/understanding-self-supervised-learning-with-examples-d6c92768fafb" rel="noopener follow" target="_blank"><div class="ns ab fo"><div class="nt ab nu cl cj nv"><h2 class="bd iu gy z fp nw fr fs nx fu fw is bi translated">理解自我监督学习，并举例说明</h2><div class="ny l"><h3 class="bd b gy z fp nw fr fs nx fu fw dk translated">迈向艾将军的一步？</h3></div><div class="nz l"><p class="bd b dl z fp nw fr fs nx fu fw dk translated">shiva-verma.medium.com</p></div></div><div class="oa l"><div class="ob l oc od oe oa of jz nr"/></div></div></a></div></div></div>    
</body>
</html>