<html>
<head>
<title>Getting Started with Plot.ly</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Plot.ly 入门</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/getting-started-with-plot-ly-3c73706a837c?source=collection_archive---------4-----------------------#2019-06-14">https://towardsdatascience.com/getting-started-with-plot-ly-3c73706a837c?source=collection_archive---------4-----------------------#2019-06-14</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/c96576c3e58cb197de24add770dc8ad5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jXMPtDxBbYsI6tVENUDHbA.jpeg"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk">Source: Bailey Zindel on Unsplash</figcaption></figure><div class=""/><div class=""><h2 id="b50e" class="pw-subtitle-paragraph kf jh ji bd b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw dk translated">Python 中强大可视化的引导式演练</h2></div><p id="56d5" class="pw-post-body-paragraph kx ky ji kz b la lb kj lc ld le km lf lg lh li lj lk ll lm ln lo lp lq lr ls im bi translated"><em class="lt">作者:爱丽丝·李和伊桑·戴伊</em></p><p id="39da" class="pw-post-body-paragraph kx ky ji kz b la lb kj lc ld le km lf lg lh li lj lk ll lm ln lo lp lq lr ls im bi translated">Matplotlib 还行，Seaborn 很棒，但是 Plot.ly？这是一个全新的水平。Plot.ly 通过提供完全交互性的选项和许多编辑工具，提供了比一般图形更多的功能。与其他产品不同的是，它可以选择在离线和在线模式下显示图形，它还配备了一个强大的 API，当设置完成后，它将无缝地在 web 浏览器中显示图形，并能够保存本地副本。你将遇到的唯一的挫折之一是处理许多选项来找出你想要用于你的情节的工具。</p><figure class="lv lw lx ly gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi lu"><img src="../Images/e475ab2f003ee575d25d92df75b31a19.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LZLjF5CqqIixVgKX5qGHbQ.png"/></div></div></figure><h2 id="1234" class="lz ma ji bd mb mc md dn me mf mg dp mh lg mi mj mk lk ml mm mn lo mo mp mq mr bi translated">概观</h2><p id="94cc" class="pw-post-body-paragraph kx ky ji kz b la ms kj lc ld mt km lf lg mu li lj lk mv lm ln lo mw lq lr ls im bi translated">我们将从在 Python 中设置 plot.ly 的基础开始。在那之后，我们将从一些基本的可视化开始，从典型的盒须图到 choropleth 图，以及沿途的代码分解。我们在本指南中使用 Zillow Economics 数据集进行了所有可视化，该数据集包含 1996 年至 2017 年按位置汇总的各种住房指标的时间序列数据。如果你对这篇文章的完整代码感兴趣，可以查看下面的 GitHub 链接；否则，用于创建可视化效果的所有代码都将包含在每个可视化效果中。</p><p id="e66f" class="pw-post-body-paragraph kx ky ji kz b la lb kj lc ld le km lf lg lh li lj lk ll lm ln lo lp lq lr ls im bi translated">我们的希望是，到最后，您将对 plotly API 如何工作有一个基本的直觉，并且对您可以应用于自己的项目的通用框架有一个感觉。你可以在这里找到一个指向 plotly cheatsheet <a class="ae mx" href="https://images.plot.ly/plotly-documentation/images/python_cheat_sheet.pdf" rel="noopener ugc nofollow" target="_blank">的链接，如果你对用于可视化的任何参数有兴趣，你可以使用<code class="fe my mz na nb b">help()</code>函数访问文档。关于所有类型的图和参数的更多细节，这里的</a><a class="ae mx" href="https://plot.ly/python/" rel="noopener ugc nofollow" target="_blank">是关于 Plotly 的 Python 开源图形库的更多信息的链接。</a></p><h1 id="8d7e" class="nc ma ji bd mb nd ne nf me ng nh ni mh ko nj kp mk kr nk ks mn ku nl kv mq nm bi translated">安装</h1><p id="a4f3" class="pw-post-body-paragraph kx ky ji kz b la ms kj lc ld mt km lf lg mu li lj lk mv lm ln lo mw lq lr ls im bi translated">Plotly 是一个运行在 JSON 上的平台，JSON 是一种以字典格式将参数传递给 plotly API 的格式。我们可以使用<code class="fe my mz na nb b">plot.ly</code>包在 python 中访问这个 API。要安装软件包，打开终端并输入<code class="fe my mz na nb b">$ pip install plotly</code>或<code class="fe my mz na nb b">$ sudo pip install plotly</code>。</p><p id="c1f1" class="pw-post-body-paragraph kx ky ji kz b la lb kj lc ld le km lf lg lh li lj lk ll lm ln lo lp lq lr ls im bi translated">Plotly 的图表是使用在线网络服务托管的，因此您首先需要在线设置一个免费帐户来存储您的图表。要检索您的个人 API 密钥，请点击此处的链接:<a class="ae mx" href="https://plot.ly/settings/api#/" rel="noopener ugc nofollow" target="_blank">https://plot.ly/settings/api#/</a>。一旦你这样做了，你就可以用<code class="fe my mz na nb b">set_credential_files()</code>函数开始设置 plotly，如下所示。</p><pre class="lv lw lx ly gt nn nb no np aw nq bi"><span id="ade0" class="lz ma ji nb b gy nr ns l nt nu">import plotly</span><span id="9c2b" class="lz ma ji nb b gy nv ns l nt nu">plotly.tools.set_credentials_file(username=’YourAccountName’, api_key=’YourAPIKey’)``</span></pre><h2 id="702b" class="lz ma ji bd mb mc md dn me mf mg dp mh lg mi mj mk lk ml mm mn lo mo mp mq mr bi translated">在线和离线绘图</h2><p id="3037" class="pw-post-body-paragraph kx ky ji kz b la ms kj lc ld mt km lf lg mu li lj lk mv lm ln lo mw lq lr ls im bi translated">在 plotly 上显示可视化效果时，绘图和数据都会保存到您的 plotly 帐户中。无需在云中购买更多空间，您最多可以在云中存储 25 个图，但这些图像可以轻松地存储在本地，并在为更多空间腾出空间时删除。</p><p id="a3bf" class="pw-post-body-paragraph kx ky ji kz b la lb kj lc ld le km lf lg lh li lj lk ll lm ln lo lp lq lr ls im bi translated">有两种主要的方法来显示 plotly 图。如果您正在使用 Jupyter Notebook 或其他交互式 python 环境(扩展名为<code class="fe my mz na nb b">.ipynb</code>的文件)，<code class="fe my mz na nb b">py.iplot()</code>函数会在单元格下方的输出中显示绘图。另一方面，<code class="fe my mz na nb b">py.plot()</code>返回一个可以保存的 url，并且也使用默认的 web 浏览器打开。</p><p id="07e9" class="pw-post-body-paragraph kx ky ji kz b la lb kj lc ld le km lf lg lh li lj lk ll lm ln lo lp lq lr ls im bi translated">Plotly 离线模式也使您能够在本地保存图形。要离线绘图，您可以使用<code class="fe my mz na nb b">plotly.offline.plot()</code>或<code class="fe my mz na nb b">plotly.offline.iplot()</code>。同样，<code class="fe my mz na nb b">iplot()</code>功能用于 Jupyter 笔记本，并将在笔记本内显示图形。<code class="fe my mz na nb b">plot()</code>创建一个保存在本地的 HTML 页面，以便在网络浏览器中打开。</p><h1 id="a784" class="nc ma ji bd mb nd ne nf me ng nh ni mh ko nj kp mk kr nk ks mn ku nl kv mq nm bi translated">基本结构</h1><p id="47af" class="pw-post-body-paragraph kx ky ji kz b la ms kj lc ld mt km lf lg mu li lj lk mv lm ln lo mw lq lr ls im bi translated">正如我们之前提到的，所有 plot.ly 可视化都是使用 Json 结构创建的，Json 结构是要使用 API 修改的参数列表，因此本质上您将看到参数和通用结构来制作每个绘图，如果您学习了其中一个，您可以制作其余的。</p><pre class="lv lw lx ly gt nn nb no np aw nq bi"><span id="4dd1" class="lz ma ji nb b gy nr ns l nt nu">import plotly.plotly as py<br/>import plotly.graph_objs as go</span></pre><p id="447c" class="pw-post-body-paragraph kx ky ji kz b la lb kj lc ld le km lf lg lh li lj lk ll lm ln lo lp lq lr ls im bi translated"><code class="fe my mz na nb b">import plotly.plotly as py</code>:具有与 plotly 服务器通信的功能</p><p id="917f" class="pw-post-body-paragraph kx ky ji kz b la lb kj lc ld le km lf lg lh li lj lk ll lm ln lo lp lq lr ls im bi translated"><code class="fe my mz na nb b">import plotly.graph_objs as go</code>:具有生成图形对象的功能。这是一个有用的模块，用于调用帮助来查看作为对象参数的所有属性。对象也有不同的有用方法，如 update 方法，可用于更新 plot 对象以向其添加更多信息。</p><h2 id="ab3d" class="lz ma ji bd mb mc md dn me mf mg dp mh lg mi mj mk lk ml mm mn lo mo mp mq mr bi translated">广义结构</h2><p id="210e" class="pw-post-body-paragraph kx ky ji kz b la ms kj lc ld mt km lf lg mu li lj lk mv lm ln lo mw lq lr ls im bi translated"><code class="fe my mz na nb b">graph_objs</code>类包含几个结构，这些结构在 plot.ly 中创建的可视化中是一致的，与类型无关。</p><p id="45c0" class="pw-post-body-paragraph kx ky ji kz b la lb kj lc ld le km lf lg lh li lj lk ll lm ln lo lp lq lr ls im bi translated">我们从<code class="fe my mz na nb b">trace</code>开始，它可以被认为是一个单独的层，包含数据和数据应该如何绘制的规范(即线条、标记、图表类型)。下面是 trace 结构的一个示例:</p><pre class="lv lw lx ly gt nn nb no np aw nq bi"><span id="9623" class="lz ma ji nb b gy nr ns l nt nu">trace1 = {<br/>  "x": ["2017-09-30", "2017-10-31", "2017-11-30", ...], <br/>  "y": [327900.0, 329100.0, 331300.0, ...], <br/>  "line": {<br/>    "color": "#385965", <br/>    "width": 1.5<br/>  }, <br/>  "mode": "lines", <br/>  "name": "Hawaii", <br/>  "type": "scatter", <br/>}</span></pre><p id="05d1" class="pw-post-body-paragraph kx ky ji kz b la lb kj lc ld le km lf lg lh li lj lk ll lm ln lo lp lq lr ls im bi translated">如您所见，<code class="fe my mz na nb b">trace</code>是要绘制的数据的参数字典，以及关于颜色和线型的信息。</p><p id="c957" class="pw-post-body-paragraph kx ky ji kz b la lb kj lc ld le km lf lg lh li lj lk ll lm ln lo lp lq lr ls im bi translated">我们可以通过将它们附加到一个列表来编译几个跟踪，我们称之为<code class="fe my mz na nb b">data</code>。列表中轨迹的顺序决定了它们在最终绘图上的放置顺序。通常，数据应该是这样的:</p><pre class="lv lw lx ly gt nn nb no np aw nq bi"><span id="e108" class="lz ma ji nb b gy nr ns l nt nu"> data = [trace1, trace2, trace3, trace4]</span></pre><p id="37c2" class="pw-post-body-paragraph kx ky ji kz b la lb kj lc ld le km lf lg lh li lj lk ll lm ln lo lp lq lr ls im bi translated"><code class="fe my mz na nb b">layout = go.Layout()</code>:该对象用于数据的布局，包括数据的外观和可变特性，如标题、轴标题、字体和间距。就像<code class="fe my mz na nb b">trace</code>一样，是字典的字典。</p><pre class="lv lw lx ly gt nn nb no np aw nq bi"><span id="fd28" class="lz ma ji nb b gy nr ns l nt nu">layout = {<br/>  "showlegend": True, <br/>  "title": {"text": "Zillow Home Value Index for Top 5 States"}, <br/>  "xaxis": {<br/>    "rangeslider": {"visible": True}, <br/>    "title": {"text": "Year from 1996 to 2017"}, <br/>    "zeroline": False<br/>  }, <br/>  "yaxis": {<br/>    "title": {"text": "ZHVI BottomTier"}, <br/>    "zeroline": False<br/>  }<br/>}</span></pre><p id="5424" class="pw-post-body-paragraph kx ky ji kz b la lb kj lc ld le km lf lg lh li lj lk ll lm ln lo lp lq lr ls im bi translated">我们最终可以使用<code class="fe my mz na nb b">go.Figure()</code>函数来编译数据和布局，它最终会被传递给我们选择的绘图函数。</p><pre class="lv lw lx ly gt nn nb no np aw nq bi"><span id="2213" class="lz ma ji nb b gy nr ns l nt nu">fig = go.Figure(data = data, layout = layout)</span></pre><h1 id="8440" class="nc ma ji bd mb nd ne nf me ng nh ni mh ko nj kp mk kr nk ks mn ku nl kv mq nm bi translated"><strong class="ak">条形图</strong></h1><figure class="lv lw lx ly gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nw"><img src="../Images/04d9807c1203a33b1346f8780de057a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kETUx9wo4mOblzn_gYOJeA.png"/></div></div></figure><figure class="lv lw lx ly gt iv"><div class="bz fp l di"><div class="nx ny l"/></div></figure><p id="145f" class="pw-post-body-paragraph kx ky ji kz b la lb kj lc ld le km lf lg lh li lj lk ll lm ln lo lp lq lr ls im bi translated"><code class="fe my mz na nb b">go.Bar()</code>创建一个条形图类型的图。在<code class="fe my mz na nb b">go.Layout()</code>函数中，我们可以指定重要的信息，比如<code class="fe my mz na nb b">barmode = “group”</code>，它将每年不同的条形图组合在一起，x 和 y 轴的标签，以及完整图表的标题。</p><h1 id="cc20" class="nc ma ji bd mb nd ne nf me ng nh ni mh ko nj kp mk kr nk ks mn ku nl kv mq nm bi translated"><strong class="ak">线条图</strong></h1><figure class="lv lw lx ly gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nz"><img src="../Images/fd39c9c2543f318d31227944b5ae92e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*r6ZDG944ixKVY3YUerVMyQ.png"/></div></div></figure><figure class="lv lw lx ly gt iv"><div class="bz fp l di"><div class="nx ny l"/></div></figure><p id="f657" class="pw-post-body-paragraph kx ky ji kz b la lb kj lc ld le km lf lg lh li lj lk ll lm ln lo lp lq lr ls im bi translated"><code class="fe my mz na nb b">go.Scatter()</code>实例化散点图类型的痕迹，与条形图或其他形式相反。</p><p id="6b73" class="pw-post-body-paragraph kx ky ji kz b la lb kj lc ld le km lf lg lh li lj lk ll lm ln lo lp lq lr ls im bi translated">我们可以使用 mode 参数更改标记的模式。即使我们使用的是散点图，我们也可以生成散点图，在散点图上创建线条和标记(点)。</p><pre class="lv lw lx ly gt nn nb no np aw nq bi"><span id="b8bb" class="lz ma ji nb b gy nr ns l nt nu">mode = “lines+markers”</span></pre><h1 id="b271" class="nc ma ji bd mb nd ne nf me ng nh ni mh ko nj kp mk kr nk ks mn ku nl kv mq nm bi translated">时间序列线图</h1><figure class="lv lw lx ly gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi oa"><img src="../Images/bb2edb02850f72c6a512a86543495775.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iojsBubgtfH83iddzhrnMg.png"/></div></div></figure><figure class="lv lw lx ly gt iv"><div class="bz fp l di"><div class="nx ny l"/></div></figure><p id="b86c" class="pw-post-body-paragraph kx ky ji kz b la lb kj lc ld le km lf lg lh li lj lk ll lm ln lo lp lq lr ls im bi translated">在这里，我们添加了一个范围滑块，使用<code class="fe my mz na nb b">rangeslider</code>参数调整可以包含在主图中的数据域。</p><p id="05ce" class="pw-post-body-paragraph kx ky ji kz b la lb kj lc ld le km lf lg lh li lj lk ll lm ln lo lp lq lr ls im bi translated">我们还传递了一个颜色字典，其中包含每个州的唯一颜色。为此，我们使用了 seaborn <code class="fe my mz na nb b">color_palette()</code>函数，指定了颜色范围，以及分布中需要的离散值的数量。因为 plot.ly 不接受 RGB 元组，我们可以使用<code class="fe my mz na nb b">as_hex()</code>函数将输出转换为十六进制代码。</p><h1 id="b369" class="nc ma ji bd mb nd ne nf me ng nh ni mh ko nj kp mk kr nk ks mn ku nl kv mq nm bi translated"><strong class="ak">多重散点图</strong></h1><figure class="lv lw lx ly gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ob"><img src="../Images/d66ad78e0e6b8d815717804718dee228.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vVYvstfAF43MXPH3ENabTg.png"/></div></div></figure><figure class="lv lw lx ly gt iv"><div class="bz fp l di"><div class="nx ny l"/></div></figure><p id="df1a" class="pw-post-body-paragraph kx ky ji kz b la lb kj lc ld le km lf lg lh li lj lk ll lm ln lo lp lq lr ls im bi translated">为了创建这个布局，我们使用<code class="fe my mz na nb b">make_subplots()</code>函数创建子情节，并使用<code class="fe my mz na nb b">append_trace()</code>函数将轨迹添加到网格上的特定位置，而不是将轨迹附加到单个字典。</p><h1 id="5252" class="nc ma ji bd mb nd ne nf me ng nh ni mh ko nj kp mk kr nk ks mn ku nl kv mq nm bi translated">等值区域图</h1><figure class="lv lw lx ly gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi oc"><img src="../Images/4470ed1e54a86101fcba7872d71b4b2e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8YHWsruBvGVOu00EmvW3LQ.png"/></div></div></figure><figure class="lv lw lx ly gt iv"><div class="bz fp l di"><div class="nx ny l"/></div></figure><p id="2a5c" class="pw-post-body-paragraph kx ky ji kz b la lb kj lc ld le km lf lg lh li lj lk ll lm ln lo lp lq lr ls im bi translated">有了 choropleth，我们可以使用 figure factory 类走捷径，它包含一组函数来轻松绘制更复杂的图形，如地理地图。</p><pre class="lv lw lx ly gt nn nb no np aw nq bi"><span id="9dcf" class="lz ma ji nb b gy nr ns l nt nu">import plotly.figure_factory as ff</span></pre><p id="4ee2" class="pw-post-body-paragraph kx ky ji kz b la lb kj lc ld le km lf lg lh li lj lk ll lm ln lo lp lq lr ls im bi translated">从<code class="fe my mz na nb b">ff.create_choropleth()</code>函数中，我们传递一组<code class="fe my mz na nb b">FIPS</code>值，或特定于每个县、市或州的地理标识码，其中<code class="fe my mz na nb b">values</code>(ZHVI _ 底层)对应于要分配给该地区的数据。</p><h1 id="cc23" class="nc ma ji bd mb nd ne nf me ng nh ni mh ko nj kp mk kr nk ks mn ku nl kv mq nm bi translated"><strong class="ak">最后的想法</strong></h1><p id="295e" class="pw-post-body-paragraph kx ky ji kz b la ms kj lc ld mt km lf lg mu li lj lk mv lm ln lo mw lq lr ls im bi translated">正如上面不同类型图表的例子所描述的，Plot.ly 是一个强大的工具，可以为广泛的受众开发视觉愉悦和易于理解的情节。它有许多好处，包括可以广泛地访问离线和在线模式，并且包含可以在笔记本和网络浏览器中显示生成的图形的功能。由于在交互性方面的额外优势，Plotly 是 Matplotlib 和 Seaborn 的一个很好的替代品，并且可以增强演示的效果。</p><p id="0637" class="pw-post-body-paragraph kx ky ji kz b la lb kj lc ld le km lf lg lh li lj lk ll lm ln lo lp lq lr ls im bi translated">如果您有任何问题，请告诉我们！</p></div></div>    
</body>
</html>