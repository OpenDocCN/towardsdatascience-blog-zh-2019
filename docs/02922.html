<html>
<head>
<title>Interesting Properties of the Covariance Matrix</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">协方差矩阵的有趣性质</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/interesting-properties-and-use-cases-of-the-covariance-matrix-80d72939c7ab?source=collection_archive---------8-----------------------#2019-05-12">https://towardsdatascience.com/interesting-properties-and-use-cases-of-the-covariance-matrix-80d72939c7ab?source=collection_archive---------8-----------------------#2019-05-12</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="79d7" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">数据科学家关于协方差矩阵的基本信息</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/a60bee05b95a17eff5cd9d71769c2001.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oCcFoQ5a7ZIMcv32JDNf6Q.png"/></div></div></figure><p id="6af3" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">协方差矩阵有许多有趣的属性，可以在混合模型、成分分析、卡尔曼滤波器等中找到。发展对协方差矩阵如何运作的直觉有助于理解其实际含义。本文将集中在一些重要的性质，相关的证明，然后一些有趣的实际应用，即非高斯混合模型。</p><p id="ae14" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我经常发现研究论文在写公式时没有详细说明矩阵的形状。我已经包括了这些和其他必要的信息来帮助数据科学家编写他们自己的算法。</p><h2 id="a1a3" class="lr ls it bd lt lu lv dn lw lx ly dp lz ld ma mb mc lh md me mf ll mg mh mi mj bi translated">子协方差矩阵</h2><p id="3e11" class="pw-post-body-paragraph ku kv it kw b kx mk ju kz la ml jx lc ld mm lf lg lh mn lj lk ll mo ln lo lp im bi translated">协方差矩阵可以分解成多个唯一的(2×2)协方差矩阵。唯一子协方差矩阵的数量等于矩阵下半部分的元素数量，不包括主对角线。A (DxD)协方差矩阵将具有 D*(D+1)/2 -D 唯一子协方差矩阵。例如，三维协方差矩阵在等式(0)中示出。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mp"><img src="../Images/ac1c64ffc1c880263e335e20d5a5176f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*etIU3AGkRL_etUqcWSRYnA.png"/></div></div></figure><p id="6690" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">可以看出，协方差矩阵中的每个元素由每个(I，j)维对之间的协方差来表示。等式(1)显示了将 a (DxD)分解成多个(2x2)协方差矩阵。对于(3x3)维的情况，将有 3 * 4/2–3 或 3 个唯一的子协方差矩阵。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mp"><img src="../Images/b9ee975887aa32b894b5b4bba137b803.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3pT51aoWjNyBZEtN1OGNhg.png"/></div></div></figure><p id="f08d" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">注意，生成随机子协方差矩阵可能不会产生有效的协方差矩阵。协方差矩阵必须是半正定的，并且子协方差矩阵的每个对角线元素的方差必须与协方差矩阵对角线上的方差相同。</p><h2 id="27cf" class="lr ls it bd lt lu lv dn lw lx ly dp lz ld ma mb mc lh md me mf ll mg mh mi mj bi translated">正半定性质</h2><p id="3058" class="pw-post-body-paragraph ku kv it kw b kx mk ju kz la ml jx lc ld mm lf lg lh mn lj lk ll mo ln lo lp im bi translated">协方差矩阵的性质之一是它必须是半正定矩阵。正定是什么意思，为什么协方差矩阵总是半正定的，值得另文讨论。简而言之，如果等式(2)中所示的运算产生大于或等于零的值，则矩阵 M 是半正定的。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mp"><img src="../Images/2c0d4f0362afa0820059c879a9d2b76b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GlsdMBuA40cEtJtRS4Nvvw.png"/></div></div></figure><p id="e397" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">m 是实值 DxD 矩阵，z 是 Dx1 向量。注意:这个操作的结果是一个 1x1 标量。</p><p id="e93f" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">协方差矩阵 M 可以通过以下操作从数据中构建，其中 M = E[(x-mu)。T*(x-mu)]。将 M 代入等式(2)得到等式(3)。可以看出，任何可以写成 M.T*M 形式的矩阵都是半正定的。<a class="ae mq" href="https://ttic.uchicago.edu/~dmcallester/ttic101-07/lectures/Gaussians/Gaussians.pdf" rel="noopener ugc nofollow" target="_blank">出处。</a> ✎编辑</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mp"><img src="../Images/e897d9110758a4b563ef8abd2d1aa211.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RTwGIBdjT4XWBQOL7oJbbA.png"/></div></div></figure><p id="c1eb" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">请注意，协方差矩阵并不总是描述数据集维度之间的协变。例如，协方差矩阵可用于描述高斯混合模型中使用的<a class="ae mq" href="https://en.wikipedia.org/wiki/Multivariate_normal_distribution" rel="noopener ugc nofollow" target="_blank">多元正态聚类</a>的形状。</p><h2 id="e6bb" class="lr ls it bd lt lu lv dn lw lx ly dp lz ld ma mb mc lh md me mf ll mg mh mi mj bi translated">几何含义</h2><p id="ef91" class="pw-post-body-paragraph ku kv it kw b kx mk ju kz la ml jx lc ld mm lf lg lh mn lj lk ll mo ln lo lp im bi translated">另一种<em class="lq">思考方式</em>协方差矩阵是几何级数的。本质上，协方差矩阵表示数据传播的方向和比例。为了理解这个观点，有必要理解特征值和特征向量。</p><p id="fb46" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">等式(4)示出了特征向量及其相关特征值的定义。下一个陈述对理解特征向量和特征值很重要。如果矩阵乘法 M*z 产生相同的向量 z，则 z 是 M 的特征向量。换句话说，我们可以把矩阵 M 看作是<em class="lq">不</em>改变 z 方向的变换矩阵，或者 z 是矩阵 M 的一个基矢。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mp"><img src="../Images/cbb3e8508004e20825f6e9b0086993b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vBQk6kTmLh0F2cjhKMm_IA.png"/></div></div></figure><p id="dc73" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">λ是特征值(1x1)标量，z 是特征向量(Dx1)矩阵，M 是(DxD)协方差矩阵。半正定(DxD)协方差矩阵将具有 D 个特征值和(DxD)个特征向量。第一特征向量总是在数据的最高扩展的方向上，所有特征向量彼此正交，并且所有特征向量被归一化，即它们具有 0 和 1 之间的值。等式(5)示出了协方差矩阵、特征向量和特征值之间的矢量化关系。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mp"><img src="../Images/a7e66076a2da38d2c9f639e1fc1ca6fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_TdI5etpKynMGtxHI1uQwQ.png"/></div></div></figure><p id="0078" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">s 是(DxD)对角缩放矩阵，其中对角值对应于特征值，并且表示每个特征向量的方差。r 是(DxD)旋转矩阵，表示每个特征值的方向。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mp"><img src="../Images/090d25b2fccb35ed07d56f1c0d44724b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Bx73zMfJk0g-eXToIo9VNQ.png"/></div></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mp"><img src="../Images/837f362a080579b3c752319da6a07dd4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aO3TLY5S-ICCXJg7Qax8hg.png"/></div></div></figure><p id="8823" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在上面的等式中，对于唯一的(I，j)子协方差(2D)矩阵，表示特征向量和特征值矩阵。等式(6)中所示的子协方差矩阵的特征向量具有一个参数<em class="lq">θ</em>，其控制每个(I，j) <em class="lq">维</em>对之间的旋转量。协方差矩阵的特征值跨越对角元素，如等式(7)所示，并且表示每个维度的方差。缩放矩阵具有控制每个特征向量的缩放的 D 个参数。</p><h2 id="5d11" class="lr ls it bd lt lu lv dn lw lx ly dp lz ld ma mb mc lh md me mf ll mg mh mi mj bi translated">协方差矩阵变换</h2><p id="337a" class="pw-post-body-paragraph ku kv it kw b kx mk ju kz la ml jx lc ld mm lf lg lh mn lj lk ll mo ln lo lp im bi translated">通过应用相关的比例和旋转矩阵,( 2x2)协方差矩阵可以变换(2x1)向量。比例矩阵必须在旋转矩阵之前应用，如等式(8)所示。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mp"><img src="../Images/32c2eee376cf65d60c0e8c8eb54f06f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XCvluuTIY0hu1dn9N5UJcA.png"/></div></div></figure><p id="f488" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">等式(9)中示出了(Nx2)矩阵 X 的矢量化协方差矩阵变换。矩阵 X 必须以(0，0)为中心，这样向量才能正确地绕原点旋转。如果矩阵 X 不居中，数据点将不会围绕原点旋转。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mp"><img src="../Images/a5064679c18d190138126e297ff2fca8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*N2gCONt3nFur69TFH-1noQ.png"/></div></div></figure><p id="6271" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">(Nx2)矩阵的协方差变换示例如图 1 所示。关于如何生成该图的更多信息可在此处找到<a class="ae mq" href="https://datascienceplus.com/understanding-the-covariance-matrix/" rel="noopener ugc nofollow" target="_blank">。</a></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mr"><img src="../Images/e9ee633edca5f7b89153fe7d5c0f4f8d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JuzOTNDCsXArVM5-rznv4w.png"/></div></div><figcaption class="ms mt gj gh gi mu mv bd b be z dk">Figure 1. Covariance Matrix Transform</figcaption></figure><h2 id="a0c2" class="lr ls it bd lt lu lv dn lw lx ly dp lz ld ma mb mc lh md me mf ll mg mh mi mj bi translated">绘制高斯混合等高线</h2><p id="20e1" class="pw-post-body-paragraph ku kv it kw b kx mk ju kz la ml jx lc ld mm lf lg lh mn lj lk ll mo ln lo lp im bi translated">通过用子协方差矩阵变换(2×2)单位圆，高斯混合的轮廓可以在多个维度上可视化。特定标准偏差下的<em class="lq">聚类轮廓</em>可以通过将标度矩阵乘以期望标准偏差的平方值来绘制。然后，聚类从原点移动到它们相关的质心值。生成下图的代码可以在<a class="ae mq" href="https://gist.github.com/freedomtowin/a196b8026b96a9264fdbd45aa77bae12" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mw"><img src="../Images/829e86d864834fcc45f1b834eccfe439.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RZOkDfBmcnZi4OjBltrPKg.png"/></div></div><figcaption class="ms mt gj gh gi mu mv bd b be z dk">Figure 2. Gaussian Mixture Contours</figcaption></figure><p id="7087" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">图二。显示了在<a class="ae mq" href="https://archive.ics.uci.edu/ml/datasets/iris" rel="noopener ugc nofollow" target="_blank">虹膜数据集</a>上训练的 3 簇高斯混合模型解决方案。在上面的图中，等高线代表混合物的概率密度，在一个特定的标准偏差，从群集的质心。在图 2 中。，从每个聚类的质心绘制 1 个标准偏差和 2 个标准偏差的等值线。</p><h2 id="090a" class="lr ls it bd lt lu lv dn lw lx ly dp lz ld ma mb mc lh md me mf ll mg mh mi mj bi translated">离群点检测</h2><p id="2440" class="pw-post-body-paragraph ku kv it kw b kx mk ju kz la ml jx lc ld mm lf lg lh mn lj lk ll mo ln lo lp im bi translated">高斯混合有推开聚类的趋势，因为具有重叠分布会降低优化度量、最大似然估计或 MLE。数据点仍有很高的概率属于多元正态聚类，同时仍是一个或多个维度上的异常值。相对较低的概率值表示属于特定聚类的数据点的不确定性。</p><p id="412c" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">通过找到位于多元超立方体之外的数据点，可以将均匀混合模型用于异常值检测。这些混合物对导致特定特征向量上的低方差的“强烈”剪切是鲁棒的。与平滑轮廓相比，查找数据点位于多边形内部还是外部在计算上也更容易。</p><p id="f11b" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">均匀分布聚类的创建方式与上一节中生成等值线的方式相同。以(0，0)为中心的单位正方形通过子协方差矩阵进行变换，然后移动到特定的平均值。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mw"><img src="../Images/304e75f4dcb666b3e37e87cff759e17c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KqV2Agd8GTETuld0s_bqFw.png"/></div></div><figcaption class="ms mt gj gh gi mu mv bd b be z dk">Figure 3. Multivariate Uniform Mixture — Outlier Detection</figcaption></figure><p id="1dbb" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">旋转后的矩形，如图 3 所示。的长度等于每个特征值的平方根的 1.58 倍。离群值被定义为<strong class="kw iu">不</strong>完全位于一个集群的超立方体内的数据点。异常值被着色以帮助可视化至少在一个维度上代表异常值的数据点。有许多不同的方法可以用来查找数据点是否位于凸多边形内。寻找一个数据点是否位于多边形内将留给读者作为练习。</p><p id="7cae" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">均匀分布混合模型的另一个潜在用例是将该算法用作核密度分类器。可以为超立方体内部的数据点找到目标的平均值，并且可以将其用作该集群具有目标的概率。该算法将允许为每个集群独立考虑成本效益分析。</p><h2 id="249d" class="lr ls it bd lt lu lv dn lw lx ly dp lz ld ma mb mc lh md me mf ll mg mh mi mj bi translated">主成分分析</h2><p id="4dd6" class="pw-post-body-paragraph ku kv it kw b kx mk ju kz la ml jx lc ld mm lf lg lh mn lj lk ll mo ln lo lp im bi translated">主成分分析(PCA)利用数据集的协方差矩阵将数据集转换为一组正交要素，以获取最大范围的数据。下面的代码片段说明了如何使用协方差矩阵的特征向量和特征值来生成主分量。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mx my l"/></div></figure><p id="c903" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">特征向量矩阵可用于将标准化数据集转换成一组主成分。数据集的维数可以通过丢弃捕获最低数据分布或具有最低相应特征值的特征向量来减少。在计算协方差矩阵之前，应标准化数据集的列，以确保每列的权重相等。</p><h2 id="00a0" class="lr ls it bd lt lu lv dn lw lx ly dp lz ld ma mb mc lh md me mf ll mg mh mi mj bi translated">最终注释</h2><p id="1e69" class="pw-post-body-paragraph ku kv it kw b kx mk ju kz la ml jx lc ld mm lf lg lh mn lj lk ll mo ln lo lp im bi translated">还有许多更有趣的使用案例和属性没有在本文中介绍:1)协方差和相关性之间的关系 2)寻找<a class="ae mq" href="https://ieeexplore.ieee.org/document/8144941" rel="noopener ugc nofollow" target="_blank">最近相关矩阵</a> 3)协方差矩阵在卡尔曼滤波器、马氏距离和主成分分析中的应用 4)如何计算协方差矩阵的特征向量和特征值 5)如何优化高斯混合模型。</p><h2 id="1877" class="lr ls it bd lt lu lv dn lw lx ly dp lz ld ma mb mc lh md me mf ll mg mh mi mj bi translated">资源</h2><p id="c7c2" class="pw-post-body-paragraph ku kv it kw b kx mk ju kz la ml jx lc ld mm lf lg lh mn lj lk ll mo ln lo lp im bi translated"><a class="ae mq" href="https://ttic.uchicago.edu/~dmcallester/ttic101-07/lectures/Gaussians/Gaussians.pdf" rel="noopener ugc nofollow" target="_blank">协方差和中心极限定理</a> ✎版</p><p id="d5d9" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><a class="ae mq" href="http://www.visiondummy.com/2014/04/geometric-interpretation-covariance-matrix/" rel="noopener ugc nofollow" target="_blank">协方差矩阵的几何解释</a></p><p id="fc13" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><a class="ae mq" href="https://datascienceplus.com/understanding-the-covariance-matrix/" rel="noopener ugc nofollow" target="_blank">了解协方差矩阵</a></p></div></div>    
</body>
</html>