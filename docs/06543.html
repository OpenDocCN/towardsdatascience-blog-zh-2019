<html>
<head>
<title>Prediction Intervals in Linear Regression</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">线性回归中的预测区间</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/prediction-intervals-in-linear-regression-2ea14d419981?source=collection_archive---------7-----------------------#2019-09-19">https://towardsdatascience.com/prediction-intervals-in-linear-regression-2ea14d419981?source=collection_archive---------7-----------------------#2019-09-19</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div class="gh gi jq"><img src="../Images/0307ad582eafaa664859de23e64ce9c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1230/format:webp/1*gm0tc5mLhpIbACUjdQIl-w.png"/></div></figure><p id="d7a9" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">这篇文章讲述了如何计算线性回归的预测区间。通常在建模时，我们从回归模型中得到一个单一的值。但是如果这个价值被用来计划或做重要的决定呢？</p><p id="5af6" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">那么，当我们想知道我们的不确定性或误差幅度时，一个单一的值可能会夸大我们的信心。当然，你可以像 RMSE 一样查看所有预测的总体误差分数，但是对于单个预测呢？预测间隔为您提供了一个预测范围，该范围考虑了对您至关重要的任何建模误差阈值。类似于置信区间，您可以选择一个阈值，如 95%，其中您希望实际值在 95%的时间内处于某个范围内。这在计划时非常好，因为您可以在评估过程中使用上限和下限。</p><p id="2e01" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">我已经创建了一个小方法(使用来自<a class="ae kv" href="https://machinelearningmastery.com/prediction-intervals-for-machine-learning/" rel="noopener ugc nofollow" target="_blank">这里</a>的一些输入)来预测对你或你的项目很重要的某个置信阈值的范围。我将用波士顿住房数据集来说明一个预测区间，预测不同地区住房的中值。如果你喜欢阅读<a class="ae kv" href="https://github.com/NathanMaton/prediction_intervals" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上的代码，这里有完整的笔记本。</p><p id="c904" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">否则，以下是数据集的描述:</p><pre class="kw kx ky kz gt la lb lc ld aw le bi"><span id="a3f9" class="lf lg it lb b gy lh li l lj lk">from sklearn import datasets<br/>print(datasets.load_boston()['DESCR'])</span><span id="65b0" class="lf lg it lb b gy ll li l lj lk">Boston house prices dataset<br/>---------------------------<br/><br/>**Data Set Characteristics:**  <br/><br/>    :Number of Instances: 506 <br/><br/>    :Number of Attributes: 13 numeric/categorical predictive. Median Value (attribute 14) is usually the target.<br/><br/>    :Attribute Information (in order):<br/>        - CRIM     per capita crime rate by town<br/>        - ZN       proportion of residential land zoned for lots over 25,000 sq.ft.<br/>        - INDUS    proportion of non-retail business acres per town<br/>        - CHAS     Charles River dummy variable (= 1 if tract bounds river; 0 otherwise)<br/>        - NOX      nitric oxides concentration (parts per 10 million)<br/>        - RM       average number of rooms per dwelling<br/>        - AGE      proportion of owner-occupied units built prior to 1940<br/>        - DIS      weighted distances to five Boston employment centres<br/>        - RAD      index of accessibility to radial highways<br/>        - TAX      full-value property-tax rate per $10,000<br/>        - PTRATIO  pupil-teacher ratio by town<br/>        - B        1000(Bk - 0.63)^2 where Bk is the proportion of blacks by town<br/>        - LSTAT    % lower status of the population<br/>        - MEDV     Median value of owner-occupied homes in $1000's</span></pre><p id="4e9d" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">我们将对数据进行预处理，使用 sklearn 的线性回归包对其建模。</p><pre class="kw kx ky kz gt la lb lc ld aw le bi"><span id="ad6a" class="lf lg it lb b gy lh li l lj lk">#preprocess data<br/>df = pd.DataFrame(datasets.load_boston()['data'])<br/>df.columns = datasets.load_boston()['feature_names']<br/>df['target'] = datasets.load_boston()['target']<br/> <br/>#split data<br/>X_train, X_test, y_train, y_test = train_test_split(<br/>    df.drop('target',axis=1), df.target, test_size=0.2, random_state=42)</span><span id="ea19" class="lf lg it lb b gy ll li l lj lk">#do modeling<br/>model = LinearRegression()<br/>fit_model = model.fit(X_train, y_train)<br/>predictions = fit_model.predict(X_test)</span></pre><p id="ff3a" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">如果想了解单个预测层面的模型误差呢？这里我构建了一个简单的方法来获得这个区间。</p><pre class="kw kx ky kz gt la lb lc ld aw le bi"><span id="761f" class="lf lg it lb b gy lh li l lj lk">def get_prediction_interval(prediction, y_test, test_predictions, pi=.95):<br/>    '''<br/>    Get a prediction interval for a linear regression.<br/>    <br/>    INPUTS: <br/>        - Single prediction, <br/>        - y_test<br/>        - All test set predictions,<br/>        - Prediction interval threshold (default = .95) <br/>    OUTPUT: <br/>        - Prediction interval for single prediction<br/>    '''<br/>    <br/>    #get standard deviation of y_test<br/>    sum_errs = np.sum((y_test - test_predictions)**2)<br/>    stdev = np.sqrt(1 / (len(y_test) - 2) * sum_errs)</span><span id="0832" class="lf lg it lb b gy ll li l lj lk">#get interval from standard deviation<br/>    one_minus_pi = 1 - pi<br/>    ppf_lookup = 1 - (one_minus_pi / 2)<br/>    z_score = stats.norm.ppf(ppf_lookup)<br/>    interval = z_score * stdev</span><span id="177e" class="lf lg it lb b gy ll li l lj lk">#generate prediction interval lower and upper bound<br/>    lower, upper = prediction - interval, prediction + interval</span><span id="6768" class="lf lg it lb b gy ll li l lj lk">    return lower, prediction, upper</span><span id="efe6" class="lf lg it lb b gy ll li l lj lk">get_prediction_interval(predictions[0], y_test, predictions)<br/>OUTPUT: (19.24072024369257, 28.996723619824934, 38.752726995957296)</span></pre><h1 id="6c72" class="lm lg it bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">结论</h1><p id="1782" class="pw-post-body-paragraph jx jy it jz b ka mj kc kd ke mk kg kh ki ml kk kl km mm ko kp kq mn ks kt ku im bi translated">那么你应该从这篇文章中学到什么呢？您可以使用一些工具来计算称为预测区间的不确定性，对于线性回归，您可以在项目中使用上面的代码。这有助于我计算非常关键的业务流程的不确定性，并且是您工具箱中的一项有用技术。</p><p id="a387" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">随着您在数据科学职业生涯中的不断进步，您将需要更多量化风险和不确定性的方法，因为这将有助于为关键决策提供信息。希望你喜欢这个简短的教程！</p></div></div>    
</body>
</html>