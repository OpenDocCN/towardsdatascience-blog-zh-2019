<html>
<head>
<title>All you want to know about preprocessing: Data preparation</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">关于预处理，您想知道的是:数据准备</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/all-you-want-to-know-about-preprocessing-data-preparation-b6c2866071d4?source=collection_archive---------8-----------------------#2019-05-29">https://towardsdatascience.com/all-you-want-to-know-about-preprocessing-data-preparation-b6c2866071d4?source=collection_archive---------8-----------------------#2019-05-29</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="ip iq gp gr ir is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/8507007b41e2656163edf2739b0abdb8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eWYm3Dm7s0t8lLWYRW4pow.jpeg"/></div></div></figure><div class=""/><div class=""><h2 id="927e" class="pw-subtitle-paragraph jy ja jb bd b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp dk translated">这是一个介绍部分，我们将讨论如何检查和准备您的数据进行进一步的预处理。</h2></div><p id="0cd3" class="pw-post-body-paragraph kq kr jb ks b kt ku kc kv kw kx kf ky kz la lb lc ld le lf lg lh li lj lk ll ij bi translated">如今，几乎所有的 ML/数据挖掘项目工作流都在标准的<code class="fe lm ln lo lp b">CRISP-DM</code>(数据挖掘的跨行业标准流程)或其 IBM enhance <code class="fe lm ln lo lp b">ASUM-DM</code>(数据挖掘/预测分析的分析解决方案统一方法)上运行。该工作流程中最长也是最重要的步骤是<strong class="ks jc">数据准备/预处理</strong>，大约占时间的 70%。这一步很重要，因为在大多数情况下，客户提供的数据质量很差，或者不能直接提供给某种 ML 模型。关于数据预处理，我最喜欢的格言是:<code class="fe lm ln lo lp b">Garbage in, garbage out (GIGO)</code>。换句话说，如果你给你的模型提供糟糕的数据，就不要指望它会有好的表现。在本帖中，我们将讨论:</p><ol class=""><li id="b787" class="lq lr jb ks b kt ku kw kx kz ls ld lt lh lu ll lv lw lx ly bi translated"><code class="fe lm ln lo lp b">Data types</code></li><li id="a474" class="lq lr jb ks b kt lz kw ma kz mb ld mc lh md ll lv lw lx ly bi translated"><code class="fe lm ln lo lp b">Data validation</code></li><li id="4b30" class="lq lr jb ks b kt lz kw ma kz mb ld mc lh md ll lv lw lx ly bi translated"><code class="fe lm ln lo lp b">Handling dates</code></li><li id="8462" class="lq lr jb ks b kt lz kw ma kz mb ld mc lh md ll lv lw lx ly bi translated"><code class="fe lm ln lo lp b">Handling nominal and ordinal categorical values</code></li></ol><p id="8271" class="pw-post-body-paragraph kq kr jb ks b kt ku kc kv kw kx kf ky kz la lb lc ld le lf lg lh li lj lk ll ij bi translated">在接下来的文章中，我们将讨论更高级的预处理技术:</p><ol class=""><li id="d8ef" class="lq lr jb ks b kt ku kw kx kz ls ld lt lh lu ll lv lw lx ly bi translated">数据清洗和标准化:<code class="fe lm ln lo lp b">Normalization and standartization</code>、<code class="fe lm ln lo lp b">Handling missing data</code>、<code class="fe lm ln lo lp b">Handling outliers</code></li><li id="86ab" class="lq lr jb ks b kt lz kw ma kz mb ld mc lh md ll lv lw lx ly bi translated">特征选择和数据集平衡:<code class="fe lm ln lo lp b">Dataset balancing</code>、<code class="fe lm ln lo lp b">Feature extraction</code>、<code class="fe lm ln lo lp b">Feature selection</code>。</li></ol><p id="b1f8" class="pw-post-body-paragraph kq kr jb ks b kt ku kc kv kw kx kf ky kz la lb lc ld le lf lg lh li lj lk ll ij bi translated">这一系列文章代表了通常的预处理流程顺序，但事实上，所有这些部分都是以独立的方式划分的，不需要了解前面部分的知识。</p><p id="2b06" class="pw-post-body-paragraph kq kr jb ks b kt ku kc kv kw kx kf ky kz la lb lc ld le lf lg lh li lj lk ll ij bi translated">这是一个介绍部分，我们将讨论如何检查和准备您的数据进行进一步的预处理。</p><h1 id="5d5a" class="me mf jb bd mg mh mi mj mk ml mm mn mo kh mp ki mq kk mr kl ms kn mt ko mu mv bi translated">数据类型</h1><p id="7c7a" class="pw-post-body-paragraph kq kr jb ks b kt mw kc kv kw mx kf ky kz my lb lc ld mz lf lg lh na lj lk ll ij bi translated">首先，让我们定义存在哪些数据类型以及它们有哪些度量标准:</p><h2 id="965f" class="nb mf jb bd mg nc nd dn mk ne nf dp mo kz ng nh mq ld ni nj ms lh nk nl mu nm bi translated"><code class="fe lm ln lo lp b">Numeric</code></h2><ol class=""><li id="3651" class="lq lr jb ks b kt mw kw mx kz nn ld no lh np ll lv lw lx ly bi translated"><code class="fe lm ln lo lp b">Discrete</code> -整数值。示例:<code class="fe lm ln lo lp b">number of products bought in the shop</code></li><li id="b026" class="lq lr jb ks b kt lz kw ma kz mb ld mc lh md ll lv lw lx ly bi translated"><code class="fe lm ln lo lp b">Continuos</code> -某个允许范围内的任何值(浮点型、双精度型)。示例:<code class="fe lm ln lo lp b">average length of words in text</code></li></ol><h2 id="76df" class="nb mf jb bd mg nc nd dn mk ne nf dp mo kz ng nh mq ld ni nj ms lh nk nl mu nm bi translated"><code class="fe lm ln lo lp b">Categorical</code></h2><p id="d801" class="pw-post-body-paragraph kq kr jb ks b kt mw kc kv kw mx kf ky kz my lb lc ld mz lf lg lh na lj lk ll ij bi translated">从预定数量的类别中选择的变量值</p><ol class=""><li id="5c31" class="lq lr jb ks b kt ku kw kx kz ls ld lt lh lu ll lv lw lx ly bi translated"><code class="fe lm ln lo lp b">Ordinal</code> -类别可以有意义地排序。示例:<code class="fe lm ln lo lp b">grade (A, B, C, D, E, F)</code></li><li id="f4eb" class="lq lr jb ks b kt lz kw ma kz mb ld mc lh md ll lv lw lx ly bi translated"><code class="fe lm ln lo lp b">Nominal</code> -类别没有任何顺序。示例:<code class="fe lm ln lo lp b">religion (Christian, Muslim, Hindu, etc.)</code></li><li id="77fb" class="lq lr jb ks b kt lz kw ma kz mb ld mc lh md ll lv lw lx ly bi translated"><code class="fe lm ln lo lp b">Dichotomous/Binary</code> -名词性的特例，只有 2 种可能的类别。示例:<code class="fe lm ln lo lp b">gender (male, female)</code></li></ol><h2 id="1944" class="nb mf jb bd mg nc nd dn mk ne nf dp mo kz ng nh mq ld ni nj ms lh nk nl mu nm bi translated"><code class="fe lm ln lo lp b">Date</code></h2><p id="439c" class="pw-post-body-paragraph kq kr jb ks b kt mw kc kv kw mx kf ky kz my lb lc ld mz lf lg lh na lj lk ll ij bi translated">字符串、python 日期时间、时间戳。示例:<code class="fe lm ln lo lp b">12.12.2012</code></p><h2 id="4913" class="nb mf jb bd mg nc nd dn mk ne nf dp mo kz ng nh mq ld ni nj ms lh nk nl mu nm bi translated"><code class="fe lm ln lo lp b">Text</code></h2><p id="ebb2" class="pw-post-body-paragraph kq kr jb ks b kt mw kc kv kw mx kf ky kz my lb lc ld mz lf lg lh na lj lk ll ij bi translated">多维数据，更多关于文本预处理的内容见我之前的<a class="ae nq" rel="noopener" target="_blank" href="/text-preprocessing-steps-and-universal-pipeline-94233cb6725a">帖子</a></p><h2 id="6817" class="nb mf jb bd mg nc nd dn mk ne nf dp mo kz ng nh mq ld ni nj ms lh nk nl mu nm bi translated"><code class="fe lm ln lo lp b">Images</code></h2><p id="168e" class="pw-post-body-paragraph kq kr jb ks b kt mw kc kv kw mx kf ky kz my lb lc ld mz lf lg lh na lj lk ll ij bi translated">多维数据，更多关于图像预处理的内容请见我的下一篇文章</p><h2 id="f9e4" class="nb mf jb bd mg nc nd dn mk ne nf dp mo kz ng nh mq ld ni nj ms lh nk nl mu nm bi translated"><code class="fe lm ln lo lp b">Time series</code></h2><p id="1370" class="pw-post-body-paragraph kq kr jb ks b kt mw kc kv kw mx kf ky kz my lb lc ld mz lf lg lh na lj lk ll ij bi translated">按时间顺序索引的数据点，关于时间序列预处理的更多信息请见我的下一篇文章。</p><h1 id="4325" class="me mf jb bd mg mh mi mj mk ml mm mn mo kh mp ki mq kk mr kl ms kn mt ko mu mv bi translated">数据有效性</h1><p id="00cd" class="pw-post-body-paragraph kq kr jb ks b kt mw kc kv kw mx kf ky kz my lb lc ld mz lf lg lh na lj lk ll ij bi translated">第一步是最简单也是最明显的:你必须调查和验证你的数据。为了能够验证数据，您必须对您的数据有深入的了解。简单规则:<code class="fe lm ln lo lp b">Don't dismiss the description of the dataset</code>。验证步骤包括:</p><h2 id="4ca8" class="nb mf jb bd mg nc nd dn mk ne nf dp mo kz ng nh mq ld ni nj ms lh nk nl mu nm bi translated"><code class="fe lm ln lo lp b">Data type and data representation consistency check</code></h2><p id="f778" class="pw-post-body-paragraph kq kr jb ks b kt mw kc kv kw mx kf ky kz my lb lc ld mz lf lg lh na lj lk ll ij bi translated">同样的东西必须以同样的方式和同样的格式来表现。示例:</p><ol class=""><li id="9450" class="lq lr jb ks b kt ku kw kx kz ls ld lt lh lu ll lv lw lx ly bi translated">日期具有相同的格式。在我的实践中，有几次我得到了一部分日期是美国格式，另一部分是欧洲格式的数据。</li><li id="eb69" class="lq lr jb ks b kt lz kw ma kz mb ld mc lh md ll lv lw lx ly bi translated">整数是真正的整数，不是字符串或浮点数</li><li id="8218" class="lq lr jb ks b kt lz kw ma kz mb ld mc lh md ll lv lw lx ly bi translated">分类数据没有重复，因为有空格、小写/大写字母</li><li id="ead9" class="lq lr jb ks b kt lz kw ma kz mb ld mc lh md ll lv lw lx ly bi translated">其他数据表示不包含错误</li></ol><h2 id="1e63" class="nb mf jb bd mg nc nd dn mk ne nf dp mo kz ng nh mq ld ni nj ms lh nk nl mu nm bi translated"><code class="fe lm ln lo lp b">Data domain check</code></h2><p id="6fcd" class="pw-post-body-paragraph kq kr jb ks b kt mw kc kv kw mx kf ky kz my lb lc ld mz lf lg lh na lj lk ll ij bi translated">数据在允许值范围内。示例:数值变量在允许的(最小，最大)范围内。</p><h2 id="cafa" class="nb mf jb bd mg nc nd dn mk ne nf dp mo kz ng nh mq ld ni nj ms lh nk nl mu nm bi translated"><code class="fe lm ln lo lp b">Data integrity check</code></h2><p id="9027" class="pw-post-body-paragraph kq kr jb ks b kt mw kc kv kw mx kf ky kz my lb lc ld mz lf lg lh na lj lk ll ij bi translated">检查允许的关系和约束的履行情况。示例:</p><ol class=""><li id="556a" class="lq lr jb ks b kt ku kw kx kz ls ld lt lh lu ll lv lw lx ly bi translated">核对姓名头衔和性别，出生年龄和年龄</li><li id="6a26" class="lq lr jb ks b kt lz kw ma kz mb ld mc lh md ll lv lw lx ly bi translated">历史资料有正确的年表。购买后交货、首次付款前银行开户等。</li><li id="a9d6" class="lq lr jb ks b kt lz kw ma kz mb ld mc lh md ll lv lw lx ly bi translated">这些动作是由被允许的实体做出的。抵押贷款只能批准给 18 岁以上的人，等等。</li></ol><h2 id="40f9" class="nb mf jb bd mg nc nd dn mk ne nf dp mo kz ng nh mq ld ni nj ms lh nk nl mu nm bi translated">好的，我们发现了一些错误，我们能做什么？</h2><ol class=""><li id="ce19" class="lq lr jb ks b kt mw kw mx kz nn ld no lh np ll lv lw lx ly bi translated"><code class="fe lm ln lo lp b">Correct</code>如果您确定问题出在哪里，请咨询专家或数据提供商。</li><li id="ca28" class="lq lr jb ks b kt lz kw ma kz mb ld mc lh md ll lv lw lx ly bi translated"><code class="fe lm ln lo lp b">Discard</code>有误差的样品，在很多情况下这是一个很好的选择，因为你无法满足 1。</li><li id="e66d" class="lq lr jb ks b kt lz kw ma kz mb ld mc lh md ll lv lw lx ly bi translated"><code class="fe lm ln lo lp b">Do nothing</code>，这当然会对以后的步骤造成不良影响。</li></ol><h1 id="2900" class="me mf jb bd mg mh mi mj mk ml mm mn mo kh mp ki mq kk mr kl ms kn mt ko mu mv bi translated">处理日期</h1><p id="1f96" class="pw-post-body-paragraph kq kr jb ks b kt mw kc kv kw mx kf ky kz my lb lc ld mz lf lg lh na lj lk ll ij bi translated">不同的系统以不同的格式存储日期:<code class="fe lm ln lo lp b">11.12.2019</code>、<code class="fe lm ln lo lp b">2016-02-12</code>、<code class="fe lm ln lo lp b">Sep 24, 2003</code>等。但是为了在日期数据上建立模型，我们需要以某种方式将其转换成数字格式。</p><p id="80f2" class="pw-post-body-paragraph kq kr jb ks b kt ku kc kv kw kx kf ky kz la lb lc ld le lf lg lh li lj lk ll ij bi translated">首先，我将向您展示一个如何将日期字符串转换成 python <code class="fe lm ln lo lp b">datetime type</code>的示例，这对于后续步骤来说要方便得多。该示例在 pandas 数据框架上演示。让我们假设<code class="fe lm ln lo lp b">date_string</code>列包含字符串形式的日期:</p><pre class="nr ns nt nu gt nv lp nw nx aw ny bi"><span id="fc99" class="nb mf jb lp b gy nz oa l ob oc"># Converts date string column to python datetime type<br/># `infer_datetime_format=True` says method to guess date format from string</span><span id="93d3" class="nb mf jb lp b gy od oa l ob oc">df['datetime'] = pd.to_datetime(df['date_string'], infer_datetime_format=True)</span><span id="e444" class="nb mf jb lp b gy od oa l ob oc"># Converts date string column to python datetime type<br/># `format` argument specifies the format of date to parse, fails on errors</span><span id="1f88" class="nb mf jb lp b gy od oa l ob oc">df['datetime'] = pd.to_datetime(df['date_string'], format='%Y.%m.%d')</span></pre><p id="03c1" class="pw-post-body-paragraph kq kr jb ks b kt ku kc kv kw kx kf ky kz la lb lc ld le lf lg lh li lj lk ll ij bi translated">通常，仅仅年份(YYYY)就足够了。但是如果我们想要存储月、日甚至更详细的数据，我们的数字格式必须满足 1 个充分的约束，它必须保存间隔，这意味着，例如，一周中的星期一-星期五必须具有与 1 相同的差值。— 5.任何一个月。所以<code class="fe lm ln lo lp b">YYYYMMDD</code>格式将不是一个选项，因为一个月的最后一天和下个月的第一天比一个月的第一天和第二天有更大的距离。实际上，将日期转换为数字格式有 4 种最常见的方法:</p><h2 id="0c42" class="nb mf jb bd mg nc nd dn mk ne nf dp mo kz ng nh mq ld ni nj ms lh nk nl mu nm bi translated"><code class="fe lm ln lo lp b">Unix timestamp</code></h2><p id="4be3" class="pw-post-body-paragraph kq kr jb ks b kt mw kc kv kw mx kf ky kz my lb lc ld mz lf lg lh na lj lk ll ij bi translated">自 1970 年以来的秒数</p><p id="ec39" class="pw-post-body-paragraph kq kr jb ks b kt ku kc kv kw kx kf ky kz la lb lc ld le lf lg lh li lj lk ll ij bi translated"><strong class="ks jc">优点:</strong></p><ol class=""><li id="1606" class="lq lr jb ks b kt ku kw kx kz ls ld lt lh lu ll lv lw lx ly bi translated">完美保留音程</li><li id="1e2d" class="lq lr jb ks b kt lz kw ma kz mb ld mc lh md ll lv lw lx ly bi translated">如果小时、分钟和秒很重要，那就好</li></ol><p id="5ee2" class="pw-post-body-paragraph kq kr jb ks b kt ku kc kv kw kx kf ky kz la lb lc ld le lf lg lh li lj lk ll ij bi translated"><strong class="ks jc">缺点:</strong></p><ol class=""><li id="27e8" class="lq lr jb ks b kt ku kw kx kz ls ld lt lh lu ll lv lw lx ly bi translated">价值不明显</li><li id="791e" class="lq lr jb ks b kt lz kw ma kz mb ld mc lh md ll lv lw lx ly bi translated">不要帮助直觉和知识发现</li><li id="e3f9" class="lq lr jb ks b kt lz kw ma kz mb ld mc lh md ll lv lw lx ly bi translated">越难验证，越容易出错</li></ol><p id="c79f" class="pw-post-body-paragraph kq kr jb ks b kt ku kc kv kw kx kf ky kz la lb lc ld le lf lg lh li lj lk ll ij bi translated">在 pandas 中将<code class="fe lm ln lo lp b">datetime</code>列转换为时间戳:</p><pre class="nr ns nt nu gt nv lp nw nx aw ny bi"><span id="91f7" class="nb mf jb lp b gy nz oa l ob oc"># Coverts column in python datetime type to timestamp<br/>df['timestamp'] = df['datetime'].values.astype(np.int64) // 10 ** 9</span></pre><h2 id="3402" class="nb mf jb bd mg nc nd dn mk ne nf dp mo kz ng nh mq ld ni nj ms lh nk nl mu nm bi translated"><code class="fe lm ln lo lp b">KSP date format</code></h2><figure class="nr ns nt nu gt is gh gi paragraph-image"><div class="gh gi oe"><img src="../Images/62b375803b4cb5c855188927baf4ff53.png" data-original-src="https://miro.medium.com/v2/resize:fit:724/0*ZfgmYdZfvbI4FbKG"/></div></figure><p id="f8e6" class="pw-post-body-paragraph kq kr jb ks b kt ku kc kv kw kx kf ky kz la lb lc ld le lf lg lh li lj lk ll ij bi translated"><strong class="ks jc">优点:</strong></p><ol class=""><li id="2da6" class="lq lr jb ks b kt ku kw kx kz ls ld lt lh lu ll lv lw lx ly bi translated">年份和季度很明显</li><li id="8538" class="lq lr jb ks b kt lz kw ma kz mb ld mc lh md ll lv lw lx ly bi translated">简单的直觉和知识发现</li><li id="70ea" class="lq lr jb ks b kt lz kw ma kz mb ld mc lh md ll lv lw lx ly bi translated">可以扩展到包括时间</li></ol><p id="4a13" class="pw-post-body-paragraph kq kr jb ks b kt ku kc kv kw kx kf ky kz la lb lc ld le lf lg lh li lj lk ll ij bi translated"><strong class="ks jc">缺点:</strong></p><ol class=""><li id="cf3b" class="lq lr jb ks b kt ku kw kx kz ls ld lt lh lu ll lv lw lx ly bi translated">保留间隔(几乎)</li></ol><p id="9045" class="pw-post-body-paragraph kq kr jb ks b kt ku kc kv kw kx kf ky kz la lb lc ld le lf lg lh li lj lk ll ij bi translated">在 pandas 中将<code class="fe lm ln lo lp b">python datetime</code>列转换为 KSP 格式:</p><pre class="nr ns nt nu gt nv lp nw nx aw ny bi"><span id="184b" class="nb mf jb lp b gy nz oa l ob oc">import datetime as dt<br/>import calendar</span><span id="f7e9" class="nb mf jb lp b gy od oa l ob oc">def to_ksp_format(datetime):<br/>    year = datetime.year<br/>    day_from_jan_1 = (datetime - dt.datetime(year, 1, 1)).days<br/>    is_leap_year = int(calendar.isleap(year))<br/>    return year + (day_from_jan_1 - 0.5) / (365 + is_leap_year)</span><span id="bab7" class="nb mf jb lp b gy od oa l ob oc">df['ksp_date'] = df['datetime'].apply(to_ksp_format)</span></pre><h2 id="3647" class="nb mf jb bd mg nc nd dn mk ne nf dp mo kz ng nh mq ld ni nj ms lh nk nl mu nm bi translated"><code class="fe lm ln lo lp b">Divide into several features</code></h2><p id="3b4e" class="pw-post-body-paragraph kq kr jb ks b kt mw kc kv kw mx kf ky kz my lb lc ld mz lf lg lh na lj lk ll ij bi translated">年、月、日等。</p><p id="d7ed" class="pw-post-body-paragraph kq kr jb ks b kt ku kc kv kw kx kf ky kz la lb lc ld le lf lg lh li lj lk ll ij bi translated"><strong class="ks jc">缺点:</strong></p><ol class=""><li id="f639" class="lq lr jb ks b kt ku kw kx kz ls ld lt lh lu ll lv lw lx ly bi translated">完美保留音程</li><li id="b9b5" class="lq lr jb ks b kt lz kw ma kz mb ld mc lh md ll lv lw lx ly bi translated">简单的直觉和知识发现</li></ol><p id="a92b" class="pw-post-body-paragraph kq kr jb ks b kt ku kc kv kw kx kf ky kz la lb lc ld le lf lg lh li lj lk ll ij bi translated"><strong class="ks jc">优点:</strong></p><ol class=""><li id="3617" class="lq lr jb ks b kt ku kw kx kz ls ld lt lh lu ll lv lw lx ly bi translated">你增加的维度越多，你的模型就越复杂，但这并不总是坏事。</li></ol><h2 id="3aca" class="nb mf jb bd mg nc nd dn mk ne nf dp mo kz ng nh mq ld ni nj ms lh nk nl mu nm bi translated"><code class="fe lm ln lo lp b">Construct new feature</code></h2><p id="2208" class="pw-post-body-paragraph kq kr jb ks b kt mw kc kv kw mx kf ky kz my lb lc ld mz lf lg lh na lj lk ll ij bi translated">基于日期要素构建新要素。例如:</p><p id="fb46" class="pw-post-body-paragraph kq kr jb ks b kt ku kc kv kw kx kf ky kz la lb lc ld le lf lg lh li lj lk ll ij bi translated"><code class="fe lm ln lo lp b">date of birth</code>-&gt;-<code class="fe lm ln lo lp b">age</code></p><p id="90a0" class="pw-post-body-paragraph kq kr jb ks b kt ku kc kv kw kx kf ky kz la lb lc ld le lf lg lh li lj lk ll ij bi translated"><code class="fe lm ln lo lp b">date order created</code>和<code class="fe lm ln lo lp b">date order delivered</code>-&gt;-T16】。</p><p id="7493" class="pw-post-body-paragraph kq kr jb ks b kt ku kc kv kw kx kf ky kz la lb lc ld le lf lg lh li lj lk ll ij bi translated"><strong class="ks jc">缺点:</strong></p><ol class=""><li id="33de" class="lq lr jb ks b kt ku kw kx kz ls ld lt lh lu ll lv lw lx ly bi translated">简单的直觉和知识发现</li></ol><p id="c649" class="pw-post-body-paragraph kq kr jb ks b kt ku kc kv kw kx kf ky kz la lb lc ld le lf lg lh li lj lk ll ij bi translated"><strong class="ks jc">优点:</strong></p><ol class=""><li id="19c4" class="lq lr jb ks b kt ku kw kx kz ls ld lt lh lu ll lv lw lx ly bi translated">手动构建特征可能会导致重要信息丢失</li></ol><h1 id="5f16" class="me mf jb bd mg mh mi mj mk ml mm mn mo kh mp ki mq kk mr kl ms kn mt ko mu mv bi translated">处理分类值</h1><p id="5b6e" class="pw-post-body-paragraph kq kr jb ks b kt mw kc kv kw mx kf ky kz my lb lc ld mz lf lg lh na lj lk ll ij bi translated">闪回:<code class="fe lm ln lo lp b">Categorical</code> -从预定义数量的类别中选择的变量值。与任何其他非数字类型一样，分类值也必须转换为数字值。怎么做才是对的？</p><h2 id="f996" class="nb mf jb bd mg nc nd dn mk ne nf dp mo kz ng nh mq ld ni nj ms lh nk nl mu nm bi translated"><code class="fe lm ln lo lp b">Ordinal</code></h2><p id="6bfb" class="pw-post-body-paragraph kq kr jb ks b kt mw kc kv kw mx kf ky kz my lb lc ld mz lf lg lh na lj lk ll ij bi translated">类别可以有意义地排序。可以转换成数值，保留其自然顺序。等级:<code class="fe lm ln lo lp b">A+</code> - <code class="fe lm ln lo lp b">4.0</code>、<code class="fe lm ln lo lp b">A-</code> - <code class="fe lm ln lo lp b">3.7</code>、<code class="fe lm ln lo lp b">B+</code> - <code class="fe lm ln lo lp b">3.3</code>、<code class="fe lm ln lo lp b">B</code> - <code class="fe lm ln lo lp b">3.0</code>等。</p><p id="8238" class="pw-post-body-paragraph kq kr jb ks b kt ku kc kv kw kx kf ky kz la lb lc ld le lf lg lh li lj lk ll ij bi translated">熊猫示范:</p><pre class="nr ns nt nu gt nv lp nw nx aw ny bi"><span id="e7e8" class="nb mf jb lp b gy nz oa l ob oc">grades = {<br/>    'A+': 4.0,<br/>    'A-': 3.7,<br/>    'B+': 3.3,<br/>    'B' : 3.0<br/>}<br/>df['grade_numeric'] = df['grade'].apply(lambda x: grades[x])</span></pre><h2 id="3cd9" class="nb mf jb bd mg nc nd dn mk ne nf dp mo kz ng nh mq ld ni nj ms lh nk nl mu nm bi translated"><code class="fe lm ln lo lp b">Dichotomous/Binary</code></h2><p id="5283" class="pw-post-body-paragraph kq kr jb ks b kt mw kc kv kw mx kf ky kz my lb lc ld mz lf lg lh na lj lk ll ij bi translated">只有两种可能。在这种情况下，您可以将值转换成指标值<code class="fe lm ln lo lp b">1/0</code>。比如:<code class="fe lm ln lo lp b">Male</code> - <code class="fe lm ln lo lp b">1</code>或者<code class="fe lm ln lo lp b">Female</code> - <code class="fe lm ln lo lp b">0</code>，也可以反过来做。</p><p id="93a8" class="pw-post-body-paragraph kq kr jb ks b kt ku kc kv kw kx kf ky kz la lb lc ld le lf lg lh li lj lk ll ij bi translated">熊猫示范:</p><pre class="nr ns nt nu gt nv lp nw nx aw ny bi"><span id="442f" class="nb mf jb lp b gy nz oa l ob oc">df['gender_indicator'] = df['gender'].apply(lambda x: int(x.lower() == 'Male'))</span></pre><h2 id="224e" class="nb mf jb bd mg nc nd dn mk ne nf dp mo kz ng nh mq ld ni nj ms lh nk nl mu nm bi translated"><code class="fe lm ln lo lp b">Nominal</code></h2><p id="98bc" class="pw-post-body-paragraph kq kr jb ks b kt mw kc kv kw mx kf ky kz my lb lc ld mz lf lg lh na lj lk ll ij bi translated">所有可能类别中的一个或多个。在这种情况下，必须使用<code class="fe lm ln lo lp b">One hot encoding</code>。该方法假设为每个类别创建一个指标值(<code class="fe lm ln lo lp b">1</code> -样本在类别中，<code class="fe lm ln lo lp b">0</code> -如果不在)。该方法也适用于<code class="fe lm ln lo lp b">Dichotomous/Binary</code>分类值。<strong class="ks jc">永远不要对名义值使用序数表示法</strong>，这会导致可怕的副作用，你的模型将无法以正确的方式处理分类特征。</p><p id="40f4" class="pw-post-body-paragraph kq kr jb ks b kt ku kc kv kw kx kf ky kz la lb lc ld le lf lg lh li lj lk ll ij bi translated">熊猫示范:</p><pre class="nr ns nt nu gt nv lp nw nx aw ny bi"><span id="674e" class="nb mf jb lp b gy nz oa l ob oc"># Pandas `.get_dummies()` method<br/>df = pd.concat([df, pd.get_dummies(df['category'], prefix='category')],axis=1)</span><span id="8786" class="nb mf jb lp b gy od oa l ob oc"># now drop the original 'category' column (you don't need it anymore)<br/>df.drop(['category'],axis=1, inplace=True)</span></pre><p id="1126" class="pw-post-body-paragraph kq kr jb ks b kt ku kc kv kw kx kf ky kz la lb lc ld le lf lg lh li lj lk ll ij bi translated">sklearn 和熊猫中的演示:</p><pre class="nr ns nt nu gt nv lp nw nx aw ny bi"><span id="5d70" class="nb mf jb lp b gy nz oa l ob oc">from sklearn.preprocessing import LabelEncoder, OneHotEncoder</span><span id="9069" class="nb mf jb lp b gy od oa l ob oc">prefix = 'category'</span><span id="f7d2" class="nb mf jb lp b gy od oa l ob oc">ohe = OneHotEncoder(sparse=False)<br/>ohe = ohe.fit(df[['category']])<br/>onehot_encoded = ohe.transform(df[['category']])</span><span id="6b0e" class="nb mf jb lp b gy od oa l ob oc">features_names_prefixed = [ f"{prefix}_{category}" for category in onehot_encoder.categories_[0]]</span><span id="4523" class="nb mf jb lp b gy od oa l ob oc">df = pd.concat([df, pd.DataFrame(onehot_encoded, columns=features_names_prefixed)], axis=1)</span><span id="7873" class="nb mf jb lp b gy od oa l ob oc"># now drop the original 'category' column (you don't need it anymore)<br/>df.drop(['category'],axis=1, inplace=True)</span></pre><p id="6e45" class="pw-post-body-paragraph kq kr jb ks b kt ku kc kv kw kx kf ky kz la lb lc ld le lf lg lh li lj lk ll ij bi translated">我希望你会喜欢我的帖子。欢迎在评论中提问。</p><p id="6051" class="pw-post-body-paragraph kq kr jb ks b kt ku kc kv kw kx kf ky kz la lb lc ld le lf lg lh li lj lk ll ij bi translated">P.S .这些都是非常非常基础简单的东西，但是在实践中非常重要。更多有趣的东西将会在接下来的帖子中出现！</p></div></div>    
</body>
</html>