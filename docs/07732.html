<html>
<head>
<title>Using Machine Learning to know if your chest pain is the sign of Heart Disease or not</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用机器学习来了解你的胸痛是否是心脏病的征兆</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/using-machine-learning-to-know-if-your-chest-pain-is-the-sign-of-heart-disease-or-not-f7bcf73be71b?source=collection_archive---------18-----------------------#2019-10-26">https://towardsdatascience.com/using-machine-learning-to-know-if-your-chest-pain-is-the-sign-of-heart-disease-or-not-f7bcf73be71b?source=collection_archive---------18-----------------------#2019-10-26</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="63c0" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph">医学机器学习</h2><div class=""/><div class=""><h2 id="71bc" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">开发机器学习模型，以通过给定的胸痛和其他属性来分类该人是否患有心脏病</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/aa471bf91ce802a2747b2e40ae9564cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*fZrGNJS4ZmIgGU4g"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk">Photo by <a class="ae lh" href="https://unsplash.com/@marceloleal80?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Marcelo Leal</a> on <a class="ae lh" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="188c" class="li lj it bd lk ll lm ln lo lp lq lr ls ki lt kj lu kl lv km lw ko lx kp ly lz bi translated">先决条件</h1><p id="35ba" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">在开始项目之前，您应该具备以下基本知识:</p><ol class=""><li id="51a5" class="mw mx it mc b md my mg mz mj na mn nb mr nc mv nd ne nf ng bi translated">计算机编程语言</li><li id="406a" class="mw mx it mc b md nh mg ni mj nj mn nk mr nl mv nd ne nf ng bi translated">熊猫(数据分析库)</li><li id="8cfd" class="mw mx it mc b md nh mg ni mj nj mn nk mr nl mv nd ne nf ng bi translated">科学计算库</li><li id="3ce6" class="mw mx it mc b md nh mg ni mj nj mn nk mr nl mv nd ne nf ng bi translated">Scikit 学习(用于数据预处理和模型选择)</li></ol><h1 id="396a" class="li lj it bd lk ll lm ln lo lp lq lr ls ki lt kj lu kl lv km lw ko lx kp ly lz bi translated">资料组</h1><p id="1d5f" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">我们将使用加州大学<strong class="mc jd"> <em class="nm">机器学习库提供的<a class="ae lh" href="https://archive.ics.uci.edu/ml/datasets/heart+Disease" rel="noopener ugc nofollow" target="_blank"> <strong class="mc jd">心脏病数据集</strong> </a>。</em> </strong></p><blockquote class="nn no np"><p id="dae8" class="ma mb nm mc b md my kd mf mg mz kg mi nq nr ml mm ns nt mp mq nu nv mt mu mv im bi translated">UCI 页面提到以下人员是负责数据收集的主要研究者:<br/> 1。匈牙利心脏病研究所。布达佩斯:医学博士安朵斯·雅诺西。瑞士苏黎世大学医院:医学博士威廉·斯坦布伦。瑞士巴塞尔大学医院:医学博士马蒂亚斯·普菲斯特勒。弗吉尼亚医疗中心，长滩和克利夫兰诊所基金会:罗伯特·德特拉诺，医学博士，哲学博士。</p></blockquote><h1 id="06e6" class="li lj it bd lk ll lm ln lo lp lq lr ls ki lt kj lu kl lv km lw ko lx kp ly lz bi translated">介绍</h1><p id="3bf9" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">在这个项目中，我们将通过使用患者的年龄、性别、胸痛类型、血压、胆固醇水平及其心脏病状况数据来对胸痛是否是心脏病的指征进行分类。</p><h1 id="037a" class="li lj it bd lk ll lm ln lo lp lq lr ls ki lt kj lu kl lv km lw ko lx kp ly lz bi translated">代码部分</h1><h2 id="4d80" class="nw lj it bd lk nx ny dn lo nz oa dp ls mj ob oc lu mn od oe lw mr of og ly iz bi translated">2.1 准备数据</h2><p id="ec50" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">首先让我们看看我们的数据字典:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi oh"><img src="../Images/049bc03587c3bbad7bc9eaeeb9e6978d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vxD9teF9wuoTuXmzalpCJA.png"/></div></div></figure><p id="8fe7" class="pw-post-body-paragraph ma mb it mc b md my kd mf mg mz kg mi mj nr ml mm mn nt mp mq mr nv mt mu mv im bi translated">这里我们总共有 14 列，13 列是我们的特性，1 列是标签。</p><pre class="ks kt ku kv gt oi oj ok ol aw om bi"><span id="07af" class="nw lj it oj b gy on oo l op oq">import <strong class="oj jd">pandas</strong> as <strong class="oj jd">pd</strong></span><span id="10f8" class="nw lj it oj b gy or oo l op oq">df = pd.read_csv('data.csv')</span></pre><p id="b87f" class="pw-post-body-paragraph ma mb it mc b md my kd mf mg mz kg mi mj nr ml mm mn nt mp mq mr nv mt mu mv im bi translated">我们正在用熊猫进行数据处理。</p><pre class="ks kt ku kv gt oi oj ok ol aw om bi"><span id="58a6" class="nw lj it oj b gy on oo l op oq">df.head()</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi os"><img src="../Images/4be530e185121a0521d7492be4901482.png" data-original-src="https://miro.medium.com/v2/resize:fit:1254/format:webp/1*L01feQgxyvcfmUaDyRtX3w.png"/></div></figure><p id="d6d0" class="pw-post-body-paragraph ma mb it mc b md my kd mf mg mz kg mi mj nr ml mm mn nt mp mq mr nv mt mu mv im bi translated">在我们的数据集中，我们没有列的名称，现在我们的任务是根据数据字典为相应的列添加名称。</p><p id="493f" class="pw-post-body-paragraph ma mb it mc b md my kd mf mg mz kg mi mj nr ml mm mn nt mp mq mr nv mt mu mv im bi translated">同样，我们将使用 pandas 读取 csv 文件，但这次我们也将向列中添加名称。</p><pre class="ks kt ku kv gt oi oj ok ol aw om bi"><span id="648c" class="nw lj it oj b gy on oo l op oq">df = pd.read_csv('data.csv', sep=",", names=["Age", "Sex", "CP", "Trestbps", "Chol", "Fbs", "Restecg", "Thalach", "Exang", "Oldpeak", "Slope", "CA", "Thal", "Label"])</span><span id="3196" class="nw lj it oj b gy or oo l op oq">df.head()</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ot"><img src="../Images/89f1a24e950452dcac0b3d6abcc23509.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ic8K1oce3bCjXhhshM_6cg.png"/></div></div></figure><p id="ca53" class="pw-post-body-paragraph ma mb it mc b md my kd mf mg mz kg mi mj nr ml mm mn nt mp mq mr nv mt mu mv im bi translated">现在看起来不错。</p><h2 id="4b55" class="nw lj it bd lk nx ny dn lo nz oa dp ls mj ob oc lu mn od oe lw mr of og ly iz bi translated">2.2 探索数据</h2><p id="351a" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">让我们检查信息，看看数据集中是否有空值。</p><pre class="ks kt ku kv gt oi oj ok ol aw om bi"><span id="e81d" class="nw lj it oj b gy on oo l op oq">df.info()</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi ou"><img src="../Images/44d87ee80936c09315d8d4cea30fdac5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1102/format:webp/1*SQJF39vnjhEgTiNMrvJnsQ.png"/></div></figure><p id="7ea7" class="pw-post-body-paragraph ma mb it mc b md my kd mf mg mz kg mi mj nr ml mm mn nt mp mq mr nv mt mu mv im bi translated">如您所见，每列有 303 个条目，没有任何空值。这对我们来说是个好兆头。</p><p id="48bd" class="pw-post-body-paragraph ma mb it mc b md my kd mf mg mz kg mi mj nr ml mm mn nt mp mq mr nv mt mu mv im bi translated">现在，让我们立即开始特征工程。</p><h2 id="eed8" class="nw lj it bd lk nx ny dn lo nz oa dp ls mj ob oc lu mn od oe lw mr of og ly iz bi translated">2.3 特征工程</h2><p id="a423" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">众所周知，特征工程是数据科学中最关键的部分。从这里，我们应该能够深入了解我们的数据，并设计出对我们的分类贡献更大的最佳特征。</p><h2 id="b910" class="nw lj it bd lk nx ny dn lo nz oa dp ls mj ob oc lu mn od oe lw mr of og ly iz bi translated"><strong class="ak"> 2.3.1 固定数据</strong></h2><p id="abd5" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">通过观察数据，我们可以看到标签栏中的值偏差很小。因为这是一个二元分类问题，应该有 0 或 1 个值，但这里我们有 5 个不同的值。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi ov"><img src="../Images/25f34d85472f188006fc5a886a6afd9f.png" data-original-src="https://miro.medium.com/v2/resize:fit:888/format:webp/1*RQZj5KdPZsheb-7dvHQnCQ.png"/></div></figure><p id="9368" class="pw-post-body-paragraph ma mb it mc b md my kd mf mg mz kg mi mj nr ml mm mn nt mp mq mr nv mt mu mv im bi translated">如果我们查看由<strong class="mc jd"> UCI </strong>提供的<a class="ae lh" href="https://archive.ics.uci.edu/ml/machine-learning-databases/heart-disease/heart-disease.names" rel="noopener ugc nofollow" target="_blank"> <strong class="mc jd">数据描述</strong> </a>我们可以看到 label(num)列值分为两类:</p><ol class=""><li id="119e" class="mw mx it mc b md my mg mz mj na mn nb mr nc mv nd ne nf ng bi translated">值 0:表示没有心脏病</li><li id="7586" class="mw mx it mc b md nh mg ni mj nj mn nk mr nl mv nd ne nf ng bi translated">价值 1:意味着有心脏病</li></ol><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ow"><img src="../Images/b103af91e933e2c868c6d4d98e545d69.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TOpsuPcsDlPhPXSvqLMDaQ.png"/></div></div></figure><p id="fcf4" class="pw-post-body-paragraph ma mb it mc b md my kd mf mg mz kg mi mj nr ml mm mn nt mp mq mr nv mt mu mv im bi translated">由此我们假设大于 1 的值也属于有心脏病一类。</p><p id="d7a0" class="pw-post-body-paragraph ma mb it mc b md my kd mf mg mz kg mi mj nr ml mm mn nt mp mq mr nv mt mu mv im bi translated">让我们编写一个函数来映射这些值:</p><pre class="ks kt ku kv gt oi oj ok ol aw om bi"><span id="8f4b" class="nw lj it oj b gy on oo l op oq">def <strong class="oj jd">mapLabels</strong>(value):<br/>    if value &gt; 0:<br/>        return 1<br/>    else:<br/>        return 0</span></pre><p id="5d7c" class="pw-post-body-paragraph ma mb it mc b md my kd mf mg mz kg mi mj nr ml mm mn nt mp mq mr nv mt mu mv im bi translated">上面的函数获取值，如果值大于 0 则返回 1，否则返回 0。</p><p id="a3ee" class="pw-post-body-paragraph ma mb it mc b md my kd mf mg mz kg mi mj nr ml mm mn nt mp mq mr nv mt mu mv im bi translated">让我们将其映射到我们的标签:</p><pre class="ks kt ku kv gt oi oj ok ol aw om bi"><span id="0b30" class="nw lj it oj b gy on oo l op oq">df['Label'] = df['Label'].map(mapLabels)<br/>df['Label'].value_counts()</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi ox"><img src="../Images/d7ea54fec8aca719000e718794c26f5b.png" data-original-src="https://miro.medium.com/v2/resize:fit:714/format:webp/1*cW7Ak24IdHLNZ-6fx2WthA.png"/></div></figure><p id="33a6" class="pw-post-body-paragraph ma mb it mc b md my kd mf mg mz kg mi mj nr ml mm mn nt mp mq mr nv mt mu mv im bi translated">我们数据中的另一个问题是:</p><p id="b4eb" class="pw-post-body-paragraph ma mb it mc b md my kd mf mg mz kg mi mj nr ml mm mn nt mp mq mr nv mt mu mv im bi translated">在我们的 CA 和 Thal 列中，我们将它作为对象数据类型，但是值是浮动的。</p><pre class="ks kt ku kv gt oi oj ok ol aw om bi"><span id="cab8" class="nw lj it oj b gy on oo l op oq">import <strong class="oj jd">numpy</strong> as <strong class="oj jd">np</strong></span><span id="09a5" class="nw lj it oj b gy or oo l op oq">df.select_dtypes([np.object]).head()</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi oy"><img src="../Images/f0c64f42f18e9464b7313f0b903634b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:396/format:webp/1*56mCHivlMpD4pveUGBnvbQ.png"/></div></figure><p id="799e" class="pw-post-body-paragraph ma mb it mc b md my kd mf mg mz kg mi mj nr ml mm mn nt mp mq mr nv mt mu mv im bi translated">这里我们使用 numpy 从数据集中选择对象数据类型。</p><p id="88a5" class="pw-post-body-paragraph ma mb it mc b md my kd mf mg mz kg mi mj nr ml mm mn nt mp mq mr nv mt mu mv im bi translated">经过一点挖掘，我发现，CA 和 Thal 列有一些空值设置为“？”。</p><p id="b704" class="pw-post-body-paragraph ma mb it mc b md my kd mf mg mz kg mi mj nr ml mm mn nt mp mq mr nv mt mu mv im bi translated">让我们也修复这些数据:</p><pre class="ks kt ku kv gt oi oj ok ol aw om bi"><span id="f06d" class="nw lj it oj b gy on oo l op oq">def <strong class="oj jd">caToFloat</strong>(value):<br/>    if not value == '?':<br/>       return float(value)<br/>    else:<br/>        return 0</span><span id="7493" class="nw lj it oj b gy or oo l op oq">df['CA'] = df['CA'].map(<strong class="oj jd">caToFloat</strong>)</span></pre><p id="4125" class="pw-post-body-paragraph ma mb it mc b md my kd mf mg mz kg mi mj nr ml mm mn nt mp mq mr nv mt mu mv im bi translated">这里，我们将<strong class="mc jd"> CA </strong>列的值映射到 float 值和任何带“？”的值到 0。因为只有几个人？数据，我们的数据最初属于[0–3]类；可以将它们映射到 0。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi oz"><img src="../Images/208ac35741ffa54d30f9f91210943ba9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_atnU6AnyO0JPaIJ4Lbixw.png"/></div></div></figure><p id="a9ef" class="pw-post-body-paragraph ma mb it mc b md my kd mf mg mz kg mi mj nr ml mm mn nt mp mq mr nv mt mu mv im bi translated">对于<strong class="mc jd"> Thal </strong>数据:</p><pre class="ks kt ku kv gt oi oj ok ol aw om bi"><span id="75af" class="nw lj it oj b gy on oo l op oq">df['Thal'].value_counts()</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi pa"><img src="../Images/339e501f9480e16ab014f20517211fdc.png" data-original-src="https://miro.medium.com/v2/resize:fit:574/format:webp/1*ZRZrou156Mff-5kw1mPt7g.png"/></div></figure><p id="9d52" class="pw-post-body-paragraph ma mb it mc b md my kd mf mg mz kg mi mj nr ml mm mn nt mp mq mr nv mt mu mv im bi translated">如我们所见，我们的大多数数据都是<strong class="mc jd"> 3.0 </strong>值，因此我们可以映射出<strong class="mc jd">'？'</strong>值到<strong class="mc jd"> 3.0 </strong>，因为它们只有 2 个数字。</p><pre class="ks kt ku kv gt oi oj ok ol aw om bi"><span id="ff8e" class="nw lj it oj b gy on oo l op oq">df['Thal'] = df['Thal'].map(lambda x : 3.0 if x == '?' else float(x))</span><span id="46d7" class="nw lj it oj b gy or oo l op oq">df['Thal'].value_counts()</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi pb"><img src="../Images/dae73a8468ed77d7a171be8cef969610.png" data-original-src="https://miro.medium.com/v2/resize:fit:628/format:webp/1*fGxCOcZ9yWjOT9nJwKv2Gw.png"/></div></figure><p id="a092" class="pw-post-body-paragraph ma mb it mc b md my kd mf mg mz kg mi mj nr ml mm mn nt mp mq mr nv mt mu mv im bi translated">现在让我们检查我们的数据信息:</p><pre class="ks kt ku kv gt oi oj ok ol aw om bi"><span id="4e24" class="nw lj it oj b gy on oo l op oq">df.info()</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi pc"><img src="../Images/fe362c19d1a28af1ae0178b9dd626e0b.png" data-original-src="https://miro.medium.com/v2/resize:fit:916/format:webp/1*M5v4-jdqwbeGzZJ1LXXBsw.png"/></div></figure><p id="3930" class="pw-post-body-paragraph ma mb it mc b md my kd mf mg mz kg mi mj nr ml mm mn nt mp mq mr nv mt mu mv im bi translated">我们所有的值都是数字。</p><p id="470d" class="pw-post-body-paragraph ma mb it mc b md my kd mf mg mz kg mi mj nr ml mm mn nt mp mq mr nv mt mu mv im bi translated">让我们将连续年龄数据转化为类数据:</p><pre class="ks kt ku kv gt oi oj ok ol aw om bi"><span id="0a62" class="nw lj it oj b gy on oo l op oq">df.loc[df['Age'] &lt;= 16, 'Age']  = 0,<br/>df.loc[(df['Age'] &gt; 16) &amp; (df['Age'] &lt;= 26), 'Age']  = 1,<br/>df.loc[(df['Age'] &gt; 26) &amp; (df['Age'] &lt;= 36), 'Age']  = 2,<br/>df.loc[(df['Age'] &gt; 36) &amp; (df['Age'] &lt;= 62), 'Age']  = 3,<br/>df.loc[df['Age'] &gt; 16, 'Age']  = 4</span></pre><p id="3914" class="pw-post-body-paragraph ma mb it mc b md my kd mf mg mz kg mi mj nr ml mm mn nt mp mq mr nv mt mu mv im bi translated">这里，我们将年龄数据分为[0，1，2，3，4]类，其中:</p><p id="5b17" class="pw-post-body-paragraph ma mb it mc b md my kd mf mg mz kg mi mj nr ml mm mn nt mp mq mr nv mt mu mv im bi translated">儿童:0 青少年:1 成人:2 中年:3 老年人:4</p><pre class="ks kt ku kv gt oi oj ok ol aw om bi"><span id="c965" class="nw lj it oj b gy on oo l op oq">df['Age'].value_counts()</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi pd"><img src="../Images/c7d769e8d24a7f409799a8286f437291.png" data-original-src="https://miro.medium.com/v2/resize:fit:584/format:webp/1*KRvvaOT58ew3VZUqskVXCg.png"/></div></figure><p id="9837" class="pw-post-body-paragraph ma mb it mc b md my kd mf mg mz kg mi mj nr ml mm mn nt mp mq mr nv mt mu mv im bi translated">如你所见，我们的数据中没有孩子或年轻人。</p><p id="d638" class="pw-post-body-paragraph ma mb it mc b md my kd mf mg mz kg mi mj nr ml mm mn nt mp mq mr nv mt mu mv im bi translated">这有助于更好的分类。你也可以寻找其他的特性并设计它们。</p><h2 id="b6be" class="nw lj it bd lk nx ny dn lo nz oa dp ls mj ob oc lu mn od oe lw mr of og ly iz bi translated">2.4 数据预处理</h2><p id="270f" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">现在是准备分类数据的时候了。</p><pre class="ks kt ku kv gt oi oj ok ol aw om bi"><span id="90c7" class="nw lj it oj b gy on oo l op oq">labels = df['Label']<br/>features = df.drop(['Label], axis=1)</span></pre><p id="1f11" class="pw-post-body-paragraph ma mb it mc b md my kd mf mg mz kg mi mj nr ml mm mn nt mp mq mr nv mt mu mv im bi translated">这里，我们将特征和标签从数据帧中分离出来。</p><p id="4fb4" class="pw-post-body-paragraph ma mb it mc b md my kd mf mg mz kg mi mj nr ml mm mn nt mp mq mr nv mt mu mv im bi translated">现在，我们将使用 scikitlearn 将我们的数据分成训练和测试数据。</p><pre class="ks kt ku kv gt oi oj ok ol aw om bi"><span id="8898" class="nw lj it oj b gy on oo l op oq">from sklearn.model_selection import train_test_split</span><span id="79d1" class="nw lj it oj b gy or oo l op oq">tran_x, test_x, train_y, test_y = train_test_split(features,labels, shuffle=True)</span></pre><h2 id="e984" class="nw lj it bd lk nx ny dn lo nz oa dp ls mj ob oc lu mn od oe lw mr of og ly iz bi translated">2.5 型号选择</h2><p id="3f8a" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">现在我们准备好训练我们的数据。</p><p id="acfb" class="pw-post-body-paragraph ma mb it mc b md my kd mf mg mz kg mi mj nr ml mm mn nt mp mq mr nv mt mu mv im bi translated">为了选择我们的最佳模型并在此基础上训练我们的数据，我们将使用 sklearn。</p><pre class="ks kt ku kv gt oi oj ok ol aw om bi"><span id="590d" class="nw lj it oj b gy on oo l op oq">from sklearn.svm import SVC<br/>from sklearn.tree import DecisionTreeClassifier<br/>from sklearn.ensemble import RandomForestClassifier<br/>from sklearn.naive_bayes import GaussianNB<br/>from sklearn.model_selection import KFold, cross_val_score<br/>from sklearn.ensemble import GradientBoostingClassifier</span><span id="be8c" class="nw lj it oj b gy or oo l op oq">k_fold = KFold(n_splits=12, shuffle=True, random_state=0)</span></pre><p id="148b" class="pw-post-body-paragraph ma mb it mc b md my kd mf mg mz kg mi mj nr ml mm mn nt mp mq mr nv mt mu mv im bi translated">在这里，我们将使用<strong class="mc jd"> KFold </strong>交叉验证我们的数据，并从这些不同的分类模型中选择我们的最佳模型。</p><p id="644e" class="pw-post-body-paragraph ma mb it mc b md my kd mf mg mz kg mi mj nr ml mm mn nt mp mq mr nv mt mu mv im bi translated"><strong class="mc jd"> KFold </strong>允许我们验证所有的训练数据，并帮助找到我们的最佳模型。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi pe"><img src="../Images/62e9d588d18c0947a78f7d2cc6194e97.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*1XS3_tiICyju6U5C.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk">KFold</figcaption></figure><p id="eafa" class="pw-post-body-paragraph ma mb it mc b md my kd mf mg mz kg mi mj nr ml mm mn nt mp mq mr nv mt mu mv im bi translated">这里我们将使用 12 个折叠拆分。</p><p id="afb8" class="pw-post-body-paragraph ma mb it mc b md my kd mf mg mz kg mi mj nr ml mm mn nt mp mq mr nv mt mu mv im bi translated">现在，让我们训练我们的第一个模型是 SVC 或 SVM(支持向量机)</p><pre class="ks kt ku kv gt oi oj ok ol aw om bi"><span id="f277" class="nw lj it oj b gy on oo l op oq">clf = SVC(gamma='auto')<br/>scoring = 'accuracy'<br/>score = cross_val_score(clf, train_x, train_y, cv=k_fold, n_jobs=1, scoring=scoring)<br/>print(score)<br/>## OUTPUT: 61.38</span></pre><p id="09e4" class="pw-post-body-paragraph ma mb it mc b md my kd mf mg mz kg mi mj nr ml mm mn nt mp mq mr nv mt mu mv im bi translated">从 SVC 我们只能得到 61.38%的准确率。</p><p id="ca97" class="pw-post-body-paragraph ma mb it mc b md my kd mf mg mz kg mi mj nr ml mm mn nt mp mq mr nv mt mu mv im bi translated">让我们看看其他模型:</p><p id="aa82" class="pw-post-body-paragraph ma mb it mc b md my kd mf mg mz kg mi mj nr ml mm mn nt mp mq mr nv mt mu mv im bi translated"><strong class="mc jd">梯度推进分类器</strong></p><pre class="ks kt ku kv gt oi oj ok ol aw om bi"><span id="3f7b" class="nw lj it oj b gy on oo l op oq">clf = GradientBoostingClassifier()<br/>scoring = 'accuracy'<br/>score = cross_val_score(clf, train_x, train_y, cv=k_fold, n_jobs=1, scoring=scoring)<br/>round(np.mean(score)*100, 2)</span><span id="8841" class="nw lj it oj b gy or oo l op oq">## OUTPUT: 77.35</span></pre><p id="2765" class="pw-post-body-paragraph ma mb it mc b md my kd mf mg mz kg mi mj nr ml mm mn nt mp mq mr nv mt mu mv im bi translated"><strong class="mc jd">决策树分类器</strong></p><pre class="ks kt ku kv gt oi oj ok ol aw om bi"><span id="28b0" class="nw lj it oj b gy on oo l op oq">clf = DecisionTreeClassifier()<br/>scoring = 'accuracy'<br/>score = cross_val_score(clf, train_x, train_y, cv=k_fold, n_jobs=1, scoring=scoring)<br/>round(np.mean(score)*100, 2)</span><span id="3aea" class="nw lj it oj b gy or oo l op oq">## OUTPUT: 75.91</span></pre><p id="4555" class="pw-post-body-paragraph ma mb it mc b md my kd mf mg mz kg mi mj nr ml mm mn nt mp mq mr nv mt mu mv im bi translated"><strong class="mc jd">随机森林</strong></p><pre class="ks kt ku kv gt oi oj ok ol aw om bi"><span id="edc0" class="nw lj it oj b gy on oo l op oq">clf = RandomForestClassifier(n_estimators=10)<br/>scoring = 'accuracy'<br/>score = cross_val_score(clf, train_x, train_y, cv=k_fold, n_jobs=1, scoring=scoring)<br/>round(np.mean(score)*100, 2)</span><span id="dc30" class="nw lj it oj b gy or oo l op oq">## OUTPUT: 83.28</span></pre><p id="2e9c" class="pw-post-body-paragraph ma mb it mc b md my kd mf mg mz kg mi mj nr ml mm mn nt mp mq mr nv mt mu mv im bi translated"><strong class="mc jd">朴素贝叶斯</strong></p><pre class="ks kt ku kv gt oi oj ok ol aw om bi"><span id="7964" class="nw lj it oj b gy on oo l op oq">clf = GaussianNB()<br/>scoring = 'accuracy'<br/>score = cross_val_score(clf, train_x, train_y, cv=k_fold, n_jobs=1, scoring=scoring)<br/>round(np.mean(score)*100, 2)</span><span id="4365" class="nw lj it oj b gy or oo l op oq">## OUTPUT : 85.95</span></pre><p id="8e05" class="pw-post-body-paragraph ma mb it mc b md my kd mf mg mz kg mi mj nr ml mm mn nt mp mq mr nv mt mu mv im bi translated">正如我们可以看到的，我们在朴素贝叶斯上得到了高分，所以我们将使用这个分类器进行分类。</p><blockquote class="nn no np"><p id="30b6" class="ma mb nm mc b md my kd mf mg mz kg mi nq nr ml mm ns nt mp mq nu nv mt mu mv im bi translated">我们的分数很低，因为我们没有正确设计我们的数据。你可以通过更多的数据清理和特征选择来获得更多的分数。</p><p id="a182" class="ma mb nm mc b md my kd mf mg mz kg mi nq nr ml mm ns nt mp mq nu nv mt mu mv im bi translated">您还可以调整 hyper 参数以获得更好的效果。</p></blockquote><h2 id="45f5" class="nw lj it bd lk nx ny dn lo nz oa dp ls mj ob oc lu mn od oe lw mr of og ly iz bi translated">2.6 培训模式</h2><p id="1e83" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">让我们使用朴素贝叶斯分类器算法来训练我们的模型:</p><pre class="ks kt ku kv gt oi oj ok ol aw om bi"><span id="122c" class="nw lj it oj b gy on oo l op oq">clf = GaussianNB()<br/>clf.fit(train_x, train_y)</span></pre><p id="ed09" class="pw-post-body-paragraph ma mb it mc b md my kd mf mg mz kg mi mj nr ml mm mn nt mp mq mr nv mt mu mv im bi translated">现在让我们看看我们的预测:</p><pre class="ks kt ku kv gt oi oj ok ol aw om bi"><span id="9ec8" class="nw lj it oj b gy on oo l op oq">predictions = clf.predict(test_x)<br/>values = list(zip(predictions, test_y.values))</span><span id="d2c9" class="nw lj it oj b gy or oo l op oq">status = []<br/>for x, y in list_of_values:<br/>    status.append(x == y)<br/>list_of_values = list(zip(predictions, test_y.values, status))</span><span id="89cf" class="nw lj it oj b gy or oo l op oq">final_df = pd.DataFrame(list_of_values, columns=['Predicted', 'Actual', "Status"])</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi pf"><img src="../Images/a94596389953d197f41edc76e3b62d64.png" data-original-src="https://miro.medium.com/v2/resize:fit:680/format:webp/1*_u0D4MC6V0gPBWNp_oMObg.png"/></div></figure><p id="a74c" class="pw-post-body-paragraph ma mb it mc b md my kd mf mg mz kg mi mj nr ml mm mn nt mp mq mr nv mt mu mv im bi translated">这里我们可以看到我们也有一些错误的分类，您可以通过改进我们的特征选择来改善这些。</p><h1 id="21e8" class="li lj it bd lk ll lm ln lo lp lq lr ls ki lt kj lu kl lv km lw ko lx kp ly lz bi translated">结论</h1><p id="db1e" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">现在，我们的模型能够通过给定的各种特征来预测心脏病的迹象😀。</p><p id="3d87" class="pw-post-body-paragraph ma mb it mc b md my kd mf mg mz kg mi mj nr ml mm mn nt mp mq mr nv mt mu mv im bi translated">分类问题有时容易，有时非常困难，这完全取决于您使用哪种数据以及您在特征选择+模型超参数选择上付出了多少努力。</p><p id="c04a" class="pw-post-body-paragraph ma mb it mc b md my kd mf mg mz kg mi mj nr ml mm mn nt mp mq mr nv mt mu mv im bi translated">对于像我们这样的初学者来说，了解 ML 如何工作，探索数据集和解决问题是最好的学习方式。</p><p id="9a32" class="pw-post-body-paragraph ma mb it mc b md my kd mf mg mz kg mi mj nr ml mm mn nt mp mq mr nv mt mu mv im bi translated">暂时就这样了。希望你喜欢这个项目，并学到了一些东西。</p></div></div>    
</body>
</html>