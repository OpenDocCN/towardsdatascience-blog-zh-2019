<html>
<head>
<title>Introduction to Recurrent Neural Networks (RNN) with Dinosaurs</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">恐龙递归神经网络(RNN)简介</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/introduction-to-recurrent-neural-networks-rnn-with-dinosaurs-790e74e3e6f6?source=collection_archive---------18-----------------------#2019-04-15">https://towardsdatascience.com/introduction-to-recurrent-neural-networks-rnn-with-dinosaurs-790e74e3e6f6?source=collection_archive---------18-----------------------#2019-04-15</a></blockquote><div><div class="fc ij ik il im in"/><div class="io ip iq ir is"><div class=""/><div class=""><h2 id="c793" class="pw-subtitle-paragraph js iu iv bd b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj dk translated">了解关于 RNNs 的一切，并构建一个恐龙名称生成器</h2></div><figure class="kl km kn ko gt kp gh gi paragraph-image"><div role="button" tabindex="0" class="kq kr di ks bf kt"><div class="gh gi kk"><img src="../Images/a4eed0473efbdc8d67978255ab29d97a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*2mree6TnHqK8a6_R"/></div></div><figcaption class="kw kx gj gh gi ky kz bd b be z dk">Photo by <a class="ae la" href="https://unsplash.com/@daiga_ellaby?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Daiga Ellaby</a> on <a class="ae la" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="323e" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">递归神经网络(RNN)是称为<strong class="ld iw">序列模型</strong>的更大算法组的一部分。序列模型在语音识别、音乐生成、DNA 序列分析、机器翻译等领域取得了巨大的进步。</p><p id="ba89" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">在这篇文章中，介绍了 RNN 的理论，我们将通过建立一个能产生新恐龙名字的模型来巩固一切。</p><p id="6df8" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">我们走吧！</p><blockquote class="lx"><p id="a6d5" class="ly lz iv bd ma mb mc md me mf mg lw dk translated">对于机器学习、深度学习和人工智能的实践视频教程，请查看我的<a class="ae la" href="https://www.youtube.com/channel/UC-0lpiwlftqwC7znCcF83qg?view_as=subscriber" rel="noopener ugc nofollow" target="_blank"> YouTube 频道</a>。</p></blockquote><figure class="mh mi mj mk ml kp"><div class="bz fp l di"><div class="mm mn l"/></div><figcaption class="kw kx gj gh gi ky kz bd b be z dk">Now, that’s a specie I don’t know about…</figcaption></figure><h1 id="c128" class="mo mp iv bd mq mr ms mt mu mv mw mx my kb mz kc na ke nb kf nc kh nd ki ne nf bi translated">为什么要使用递归神经网络？</h1><p id="f9a1" class="pw-post-body-paragraph lb lc iv ld b le ng jw lg lh nh jz lj lk ni lm ln lo nj lq lr ls nk lu lv lw io bi translated">假设你想建立一个神经网络来识别句子中的人名。</p><p id="2015" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">在这种情况下，传统的神经网络不适合这种类型的应用。首先，输入和输出不会有相同的长度，因为一个人的名字可能有很大的不同。第二，学习到的特征不会在文本的不同位置共享，导致低于标准的性能。</p><p id="ffb9" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">这就是为什么 rnn 非常受序列数据的欢迎，比如句子或音乐。</p><h1 id="e4d2" class="mo mp iv bd mq mr ms mt mu mv mw mx my kb mz kc na ke nb kf nc kh nd ki ne nf bi translated">一种递归神经网络的结构</h1><p id="75cf" class="pw-post-body-paragraph lb lc iv ld b le ng jw lg lh nh jz lj lk ni lm ln lo nj lq lr ls nk lu lv lw io bi translated">在 RNN 中，输入被馈送到网络的一个层，并且它输出预测。然后，第二输入被馈送到另一层，并且网络输出预测。然而，它也使用从前一层计算的信息。</p><p id="beac" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">重复该过程，直到获得最终输出。</p><p id="959f" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">因此，典型的 RNN 看起来是这样的:</p><figure class="kl km kn ko gt kp gh gi paragraph-image"><div role="button" tabindex="0" class="kq kr di ks bf kt"><div class="gh gi nl"><img src="../Images/155d19e6269681c3b5f876e8ff8526bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mHimR6ok4bAEYhKESwhdrg.png"/></div></div><figcaption class="kw kx gj gh gi ky kz bd b be z dk">Left: folded schema of an RNN. Right: unfolded schema of an RNN. <a class="ae la" href="http://www.easy-tensorflow.com/tf-tutorials/recurrent-neural-networks/vanilla-rnn-for-classification" rel="noopener ugc nofollow" target="_blank">Source</a></figcaption></figure><p id="c666" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">这种结构允许 rnn 将信息从早期步骤链接到当前步骤。然而，如果 RNN 很深，意味着它有许多层，它将容易出现<strong class="ld iw">消失</strong>或<strong class="ld iw">爆发</strong>渐变。</p><p id="03be" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">当渐变接近 0 时，渐变消失，因此权重不再更新。另一方面，爆炸梯度是当梯度太大时，并且永远不会达到优化函数的全局最小值。当然，有办法防止爆炸和消失的梯度，我们会看到当我们编码一个 RNN。</p><h1 id="442b" class="mo mp iv bd mq mr ms mt mu mv mw mx my kb mz kc na ke nb kf nc kh nd ki ne nf bi translated">对 RNN 进行编码以生成新的恐龙名称</h1><h2 id="34fb" class="nm mp iv bd mq nn no dn mu np nq dp my lk nr ns na lo nt nu nc ls nv nw ne nx bi translated">概观</h2><p id="5ca2" class="pw-post-body-paragraph lb lc iv ld b le ng jw lg lh nh jz lj lk ni lm ln lo nj lq lr ls nk lu lv lw io bi translated">现在，我们将使用 Python 编写一个 RNN，它将为我们生成新的恐龙名称。我们将学习如何:</p><ul class=""><li id="fc56" class="ny nz iv ld b le lf lh li lk oa lo ob ls oc lw od oe of og bi translated">存储文本数据，并使用 RNN 对其进行处理</li><li id="cf2a" class="ny nz iv ld b le oh lh oi lk oj lo ok ls ol lw od oe of og bi translated">如何合成数据</li><li id="38f5" class="ny nz iv ld b le oh lh oi lk oj lo ok ls ol lw od oe of og bi translated">如何生成文本</li><li id="eaf3" class="ny nz iv ld b le oh lh oi lk oj lo ok ls ol lw od oe of og bi translated">如何裁剪渐变以避免渐变爆炸</li></ul><p id="3542" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">我们的 RNN 将会是这样的:</p><figure class="kl km kn ko gt kp gh gi paragraph-image"><div role="button" tabindex="0" class="kq kr di ks bf kt"><div class="gh gi om"><img src="../Images/9b3338819fbd00423d248d0f51a5c9d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*obLEYSKh2nytc2Hu344psw.png"/></div></div><figcaption class="kw kx gj gh gi ky kz bd b be z dk">RNN schema. <a class="ae la" href="https://www.deeplearning.ai/" rel="noopener ugc nofollow" target="_blank">Source</a></figcaption></figure><p id="d1b7" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">当然，如果你想继续写代码的话，可以使用<a class="ae la" href="https://github.com/marcopeix/Deep_Learning_AI/blob/master/5.Sequence%20Models/1.Recurrent%20Neural%20Networks/Dinosoraus%20Land.ipynb" rel="noopener ugc nofollow" target="_blank">全笔记本</a>。您还将找到复制结果所需的所有实用工具。</p><h2 id="86fb" class="nm mp iv bd mq nn no dn mu np nq dp my lk nr ns na lo nt nu nc ls nv nw ne nx bi translated">步骤 1:导入库并浏览数据集</h2><p id="dd86" class="pw-post-body-paragraph lb lc iv ld b le ng jw lg lh nh jz lj lk ni lm ln lo nj lq lr ls nk lu lv lw io bi translated">我们首先导入必要的库和实用程序，并查看我们将使用的数据。</p><figure class="kl km kn ko gt kp gh gi paragraph-image"><div role="button" tabindex="0" class="kq kr di ks bf kt"><div class="gh gi on"><img src="../Images/3d764aa7c4ddc5fb99c3b33c59eb0b7a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*W4PfDOnOFuUsI1jfQoU1VA.png"/></div></div></figure><p id="deeb" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">你应该看到我们有相当多的恐龙名字，我们也有 27 个独特的角色。它们对应于字母表中的每个字母，我们有一个特殊的字符“\n”来定义一个新行。这将是我们的句尾字符(<strong class="ld iw"> EOS </strong>)。</p><h2 id="ecf4" class="nm mp iv bd mq nn no dn mu np nq dp my lk nr ns na lo nt nu nc ls nv nw ne nx bi translated">步骤 2:定义渐变裁剪函数</h2><p id="ec11" class="pw-post-body-paragraph lb lc iv ld b le ng jw lg lh nh jz lj lk ni lm ln lo nj lq lr ls nk lu lv lw io bi translated">如前所述，rnn 容易消失或爆炸梯度，所以我们将实现梯度裁剪，以防止梯度“爆炸”。</p><p id="797a" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">渐变裁剪非常简单:如果计算出的渐变大于某个阈值，我们将它缩放回阈值。否则，我们就让它保持原样。像这样，我们将确保我们的优化函数会收敛。</p><figure class="kl km kn ko gt kp gh gi paragraph-image"><div role="button" tabindex="0" class="kq kr di ks bf kt"><div class="gh gi oo"><img src="../Images/83685e014e12361a86f901881cc2399f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YN8DsICcwN0isP043ITfEw.png"/></div></div><figcaption class="kw kx gj gh gi ky kz bd b be z dk">Gradient descent with and without clipping. <a class="ae la" href="https://www.deeplearning.ai/" rel="noopener ugc nofollow" target="_blank">Source</a></figcaption></figure><p id="16da" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">在代码中:</p><figure class="kl km kn ko gt kp gh gi paragraph-image"><div role="button" tabindex="0" class="kq kr di ks bf kt"><div class="gh gi op"><img src="../Images/df3b29bc905fff9ad11af6fa1bdb40bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VGWq4GmHfGwCbe-04Y1YoQ.png"/></div></div></figure><h2 id="d8b9" class="nm mp iv bd mq nn no dn mu np nq dp my lk nr ns na lo nt nu nc ls nv nw ne nx bi translated">步骤 3:定义采样函数</h2><p id="ac1f" class="pw-post-body-paragraph lb lc iv ld b le ng jw lg lh nh jz lj lk ni lm ln lo nj lq lr ls nk lu lv lw io bi translated">一旦我们的模型被训练，我们将需要一个函数来选择最有可能生成一个似乎合理的恐龙名字的角色。</p><p id="16e3" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">换句话说，它需要从字符库中抽取一个字符并生成一个单词。</p><p id="c7b8" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">在代码中:</p><figure class="kl km kn ko gt kp gh gi paragraph-image"><div role="button" tabindex="0" class="kq kr di ks bf kt"><div class="gh gi oq"><img src="../Images/78f662a9f9a0ab9e035de557d17a967b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yb38nJgUGYqLVHneftPTvQ.png"/></div></div></figure><h2 id="010d" class="nm mp iv bd mq nn no dn mu np nq dp my lk nr ns na lo nt nu nc ls nv nw ne nx bi translated">步骤 4:构建模型</h2><p id="2101" class="pw-post-body-paragraph lb lc iv ld b le ng jw lg lh nh jz lj lk ni lm ln lo nj lq lr ls nk lu lv lw io bi translated">现在，我们准备好构建模型了。首先，我们实现一个函数，该函数执行带有梯度裁剪的随机梯度下降的一个步骤:</p><figure class="kl km kn ko gt kp gh gi paragraph-image"><div role="button" tabindex="0" class="kq kr di ks bf kt"><div class="gh gi or"><img src="../Images/4d8f106eab07d673177636669e2c44cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xAjM--9TQt_Lv7RpMkR3fw.png"/></div></div></figure><p id="46c7" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">完美！现在我们可以编写并训练我们的模型:</p><figure class="kl km kn ko gt kp"><div class="bz fp l di"><div class="os mn l"/></div></figure><p id="d042" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">现在，我们只需要运行下面的单元格来获得新的恐龙名称:</p><pre class="kl km kn ko gt ot ou ov ow aw ox bi"><span id="4e7f" class="nm mp iv ou b gy oy oz l pa pb">parameters = model(data, ix_to_char, char_to_ix)</span></pre><p id="2eb7" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">你应该看到算法在生成更可信的恐龙名字方面变得越来越好。我得到的几个例子是:</p><ul class=""><li id="c6a3" class="ny nz iv ld b le lf lh li lk oa lo ob ls oc lw od oe of og bi translated">Trokalenator</li><li id="3da8" class="ny nz iv ld b le oh lh oi lk oj lo ok ls ol lw od oe of og bi translated">尼沃龙</li><li id="8c9e" class="ny nz iv ld b le oh lh oi lk oj lo ok ls ol lw od oe of og bi translated">卢特龙</li></ul><p id="4f77" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">如果您有更多的时间和计算能力，请随意调整模型并训练它更长时间，因为它应该会生成更好的名称。</p></div><div class="ab cl pc pd hz pe" role="separator"><span class="pf bw bk pg ph pi"/><span class="pf bw bk pg ph pi"/><span class="pf bw bk pg ph"/></div><div class="io ip iq ir is"><p id="e02c" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">就是这样！您学习了 RNNs 的基础知识，并应用它们来生成新的恐龙名称！</p><p id="57a4" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">在未来的帖子中，我们将讨论长短期记忆(LSTM)单位，这是另一种类型的循环网络，我们将生成爵士乐。</p><p id="7a5e" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">敬请期待！</p><p id="fcc3" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">来源:<a class="ae la" href="https://www.deeplearning.ai/" rel="noopener ugc nofollow" target="_blank"> Deeplearning.ai </a></p></div></div>    
</body>
</html>