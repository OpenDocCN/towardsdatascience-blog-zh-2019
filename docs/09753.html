<html>
<head>
<title>ELT Data Pipelining in Snowflake Data Warehouse — using Streams and Tasks</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">雪花数据仓库中的 ELT 数据流水线——使用流和任务</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/elt-data-pipelining-in-snowflake-data-warehouse-using-streams-and-tasks-ae6eb7c083de?source=collection_archive---------5-----------------------#2019-12-22">https://towardsdatascience.com/elt-data-pipelining-in-snowflake-data-warehouse-using-streams-and-tasks-ae6eb7c083de?source=collection_archive---------5-----------------------#2019-12-22</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/18518535c5ae0728232d1f4bf9fe11f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WM-t0mXMXrjDrCYwLlXdGw.png"/></div></div></figure><div class=""/><p id="68be" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在我之前的帖子中:</p><blockquote class="kz la lb"><p id="f465" class="kb kc lc kd b ke kf kg kh ki kj kk kl ld kn ko kp le kr ks kt lf kv kw kx ky im bi translated">使用 Azure Portal Web UI 为雪花数据仓库在 Azure Blob 存储上构建 Snowpipe</p><p id="d3ca" class="kb kc lc kd b ke kf kg kh ki kj kk kl ld kn ko kp le kr ks kt lf kv kw kx ky im bi translated"><a class="ae lg" href="https://medium.com/@qiuyujx/building-snowpipe-on-azure-blob-storage-using-azure-portal-web-ui-for-snowflake-data-warehouse-f0cdd7997250" rel="noopener">https://medium . com/@ qiuyujx/building-snow pipe-on-azure-blob-storage-using-azure-portal-we b-ui-for-snow flake-data-warehouse-f0cdd 7997250</a></p></blockquote><p id="8392" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">Snowpipe 被引入用于自动发现云存储(例如 Azure Blob 存储)中的新数据文件，然后将数据加载到某个表中。</p><p id="e826" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">Snowpipe 是实现上述目的的一个非常方便的工具。然而，Snowpipe 本身只被认为是 ELT 的“E”(提取)，因为在 Snowpipe 创建语句中只允许使用<code class="fe lh li lj lk b">COPY INTO</code>命令。换句话说，我们可以用它轻松实现以下目标:</p><ul class=""><li id="3129" class="ll lm je kd b ke kf ki kj km ln kq lo ku lp ky lq lr ls lt bi translated">加载不同格式的数据文件，如 CSV、JSON、XML、Parquet 和 ORC</li><li id="9df5" class="ll lm je kd b ke lu ki lv km lw kq lx ku ly ky lq lr ls lt bi translated">采用和调整数据源以获得更好的兼容性，比如剥离 JSON 的外部数组和 XML 的外部元素</li><li id="9346" class="ll lm je kd b ke lu ki lv km lw kq lx ku ly ky lq lr ls lt bi translated">更改列名</li><li id="c0ec" class="ll lm je kd b ke lu ki lv km lw kq lx ku ly ky lq lr ls lt bi translated">更改列顺序</li><li id="fe67" class="ll lm je kd b ke lu ki lv km lw kq lx ku ly ky lq lr ls lt bi translated">省略列</li><li id="90ba" class="ll lm je kd b ke lu ki lv km lw kq lx ku ly ky lq lr ls lt bi translated">将数据/时间字符串解析为数据/时间对象</li></ul><p id="db31" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">因此，出于以下原因，数据流水线的其余部分需要流和任务:</p><ol class=""><li id="2b24" class="ll lm je kd b ke kf ki kj km ln kq lo ku lp ky lz lr ls lt bi translated">一些数据转换可能是必要的，比如数字计算和字符串连接。</li><li id="b932" class="ll lm je kd b ke lu ki lv km lw kq lx ku ly ky lz lr ls lt bi translated">数据源不是典型的三范数格式，需要根据一定的关系加载到多个表中。</li><li id="51a4" class="ll lm je kd b ke lu ki lv km lw kq lx ku ly ky lz lr ls lt bi translated">ELT 作业可能不限于追加表，还包括更复杂的需求，如要实现的 SCD(渐变维度)。</li></ol><p id="9157" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">因此，我们不得不在雪花中涉及其他对象来完成数据管道。</p><h1 id="a539" class="ma mb je bd mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx bi translated">雪花溪流</h1><p id="24df" class="pw-post-body-paragraph kb kc je kd b ke my kg kh ki mz kk kl km na ko kp kq nb ks kt ku nc kw kx ky im bi translated">雪花流对象用于跟踪对表的任何更改，包括插入、更新和删除，然后可以被其他 DML 语句使用。steam 对象的一个典型用法是 CDC(变更数据捕获)</p><h2 id="a2e5" class="nd mb je bd mc ne nf dn mg ng nh dp mk km ni nj mo kq nk nl ms ku nm nn mw no bi translated"><strong class="ak">标准视频点播附加流</strong></h2><p id="527f" class="pw-post-body-paragraph kb kc je kd b ke my kg kh ki mz kk kl km na ko kp kq nb ks kt ku nc kw kx ky im bi translated">我们可以在 Snowflake 中定义两种类型的流，标准流和仅附加流。标准流将捕获对表的任何类型的更改，而仅追加流只捕获插入的行。前者可用于一般目的，而后者可用于典型的 ELT 模型中，当我们只对摄取的新行感兴趣时。</p><p id="6672" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">例如，我们可以使用 Snowpipe 从云存储中的 CSV 文件自动获取数据，并复制到临时表中。然后，一个流将捕获这个批量插入动作，并记录这些新行的<strong class="kd jf">偏移量</strong>。</p><h2 id="4824" class="nd mb je bd mc ne nf dn mg ng nh dp mk km ni nj mo kq nk nl ms ku nm nn mw no bi translated"><strong class="ak">流偏移</strong></h2><p id="f508" class="pw-post-body-paragraph kb kc je kd b ke my kg kh ki mz kk kl km na ko kp kq nb ks kt ku nc kw kx ky im bi translated">雪花流在物理上不存储、包含或复制任何数据。它只是在当前时间拍摄跟踪表的快照(例如，在创建流时)，然后流会将对此表所做的每个更改记录为附加元数据。表格的前一版本和当前版本之间的差异称为<strong class="kd jf">偏移</strong>。</p><p id="6d35" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">当其他 DML 语句使用流的偏移量时，偏移量将被重置，并且流将所使用的数据视为表的“先前”版本。典型的消耗流偏移量的 DML 语句是<code class="fe lh li lj lk b">INSERT INTO ... SELECT ... FROM STREAM</code>。</p><p id="ace2" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">以下是流消费流的一个示例:</p><ol class=""><li id="4164" class="ll lm je kd b ke kf ki kj km ln kq lo ku lp ky lz lr ls lt bi translated">假设一个表中已经有一百万行。我们在这个表上创建一个流，这个流没有偏移量，因为这个表的当前版本是快照。</li><li id="43aa" class="ll lm je kd b ke lu ki lv km lw kq lx ku ly ky lz lr ls lt bi translated">假设有 1000 行从 Snowpipe <code class="fe lh li lj lk b">COPY INTO</code>语句插入到表中。</li><li id="c68b" class="ll lm je kd b ke lu ki lv km lw kq lx ku ly ky lz lr ls lt bi translated">该流将这 1000 行记录为其偏移量。</li><li id="b718" class="ll lm je kd b ke lu ki lv km lw kq lx ku ly ky lz lr ls lt bi translated">假设现在我们从流中读取这 1000 行，并将它们插入到另一个表中。</li><li id="f150" class="ll lm je kd b ke lu ki lv km lw kq lx ku ly ky lz lr ls lt bi translated">该流现在将没有偏移量，因此它将是空的，因为我们已经消耗了先前的偏移量。</li></ol><p id="88cf" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">很明显，雪花流是为英语教学过程设计的。例如，我们有一个高频率的数据被接收到数据库中，我们每 5 分钟消耗一次数据。该流将保证我们每次使用新数据时没有遗漏和重叠。这确实是一个在其他数据库管理系统中实现起来很复杂的逻辑，或者我们可能需要使用额外的编程语言来实现这一点。</p><h2 id="57a9" class="nd mb je bd mc ne nf dn mg ng nh dp mk km ni nj mo kq nk nl ms ku nm nn mw no bi translated"><strong class="ak">流列</strong></h2><p id="7b6a" class="pw-post-body-paragraph kb kc je kd b ke my kg kh ki mz kk kl km na ko kp kq nb ks kt ku nc kw kx ky im bi translated">因为 stream 实际上是原始表的快照，所以原始表中的所有列也可以在 stream 中访问。例如，如果原始表有 3 列名为<code class="fe lh li lj lk b">col1</code>、<code class="fe lh li lj lk b">col2</code>和<code class="fe lh li lj lk b">col3</code>，那么我们可以简单运行</p><pre class="np nq nr ns gt nt lk nu nv aw nw bi"><span id="1747" class="nd mb je lk b gy nx ny l nz oa">SELECT col1, col2, col3<br/>FROM the_stream;</span></pre><p id="8823" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">检索此流中的偏移量。</p><p id="e6f4" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">此外，还有 3 个额外的列是专门针对流对象的元数据:</p><ul class=""><li id="5ab2" class="ll lm je kd b ke kf ki kj km ln kq lo ku lp ky lq lr ls lt bi translated"><code class="fe lh li lj lk b">METADATA$ACTION</code>表示该行的更改类型。可以是<code class="fe lh li lj lk b">INSERT</code>也可以是<code class="fe lh li lj lk b">DELETE</code>。请注意，没有“更新”操作。一行的更新将由两行表示，一行是前一行的<code class="fe lh li lj lk b">DELETE</code>，另一行是新行的<code class="fe lh li lj lk b">INSERT</code>。您会发现这非常方便，因为通过比较这两行，您可以在流中获得关于更新了哪些特定字段的信息。</li><li id="549a" class="ll lm je kd b ke lu ki lv km lw kq lx ku ly ky lq lr ls lt bi translated"><code class="fe lh li lj lk b">METADATA$ISUPDATE</code>表示该行是否因更新而生成。这个列是一个额外的指示器，它允许您获得所有带有<code class="fe lh li lj lk b">INSERT</code>和<code class="fe lh li lj lk b">DELETE</code>的行，但实际上是因为更新而生成的。</li><li id="dd1b" class="ll lm je kd b ke lu ki lv km lw kq lx ku ly ky lq lr ls lt bi translated"><code class="fe lh li lj lk b">METADATA$ROW_ID</code>是特定行的唯一 ID。即使该行被更新，它也不会改变，并且在将来的任何进一步的偏移更新中保持不变。</li></ul><p id="9d47" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这是一张来自官方文档的图片，非常清晰地展示了数据流。</p><figure class="np nq nr ns gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ob"><img src="../Images/ee2a918d1ea1eca86389d8fa206fd19e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mgdbadQNEDZWOHGjGN-o6Q.png"/></div></div><figcaption class="oc od gj gh gi oe of bd b be z dk">Image courtesy: <a class="ae lg" href="https://docs.snowflake.net/manuals/user-guide/streams.html" rel="noopener ugc nofollow" target="_blank">https://docs.snowflake.net/manuals/user-guide/streams.html</a></figcaption></figure><h1 id="798b" class="ma mb je bd mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx bi translated">雪花任务</h1><p id="80f7" class="pw-post-body-paragraph kb kc je kd b ke my kg kh ki mz kk kl km na ko kp kq nb ks kt ku nc kw kx ky im bi translated">雪花任务就是这样一种对象，它可以安排 SQL 语句作为重复事件自动执行。</p><p id="8621" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">是的，我对每个任务都使用“an”SQL 语句。目前，这是雪花任务的一个限制。希望在未来的更新中，它将支持事务适当的<code class="fe lh li lj lk b">BEGIN</code>和<code class="fe lh li lj lk b">COMMIT</code>关键字，以便我们可以在一个事务中执行一系列 SQL 语句，并利用任务来调度该事务。</p><p id="e45b" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">尽管有这样的限制，雪花确实提供了多 SQL 语句调度的方法，这被称为<strong class="kd jf">任务树</strong>。顾名思义，我们可以在一个树形结构中定义多个任务。几个小贴士:</p><ul class=""><li id="07f7" class="ll lm je kd b ke kf ki kj km ln kq lo ku lp ky lq lr ls lt bi translated">一个任务可以有多个任务作为其子任务，所以子任务将在父任务完成时执行。</li><li id="e94b" class="ll lm je kd b ke lu ki lv km lw kq lx ku ly ky lq lr ls lt bi translated">一个任务只能有一个父任务。</li><li id="1efe" class="ll lm je kd b ke lu ki lv km lw kq lx ku ly ky lq lr ls lt bi translated">因此，任务树实际上只是一棵树，而不是 DAG。所以，你可以考虑它可以做“fork”，但是没有“join”。</li></ul><p id="07ee" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">下面是一个简单任务树的图表。</p><figure class="np nq nr ns gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi og"><img src="../Images/44528641102de80e4158674545268a02.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TPV-E6j-rFPi34rJft9oYQ.png"/></div></div><figcaption class="oc od gj gh gi oe of bd b be z dk">Image courtesy: <a class="ae lg" href="https://docs.snowflake.net/manuals/user-guide/tasks-intro.html" rel="noopener ugc nofollow" target="_blank">https://docs.snowflake.net/manuals/user-guide/tasks-intro.html</a></figcaption></figure><h2 id="f190" class="nd mb je bd mc ne nf dn mg ng nh dp mk km ni nj mo kq nk nl ms ku nm nn mw no bi translated">触发任务</h2><p id="7048" class="pw-post-body-paragraph kb kc je kd b ke my kg kh ki mz kk kl km na ko kp kq nb ks kt ku nc kw kx ky im bi translated">触发任务有两种方式，一种是通过定义计划，另一种是通过另一个任务触发。</p><p id="85ee" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">雪花支持两种类型的任务调度定义，“CRON”表达式和时间间隔。CRON 表达式可以定义任务将被触发的确切日期/日期/时间，它非常强大，可以实现任何简单到复杂的需求，例如</p><ul class=""><li id="7326" class="ll lm je kd b ke kf ki kj km ln kq lo ku lp ky lq lr ls lt bi translated">在每天的特定时间运行任务</li><li id="fc76" class="ll lm je kd b ke lu ki lv km lw kq lx ku ly ky lq lr ls lt bi translated">在一周中某一天的某个时间运行任务</li><li id="06da" class="ll lm je kd b ke lu ki lv km lw kq lx ku ly ky lq lr ls lt bi translated">支持时区</li><li id="8e34" class="ll lm je kd b ke lu ki lv km lw kq lx ku ly ky lq lr ls lt bi translated">支持夏令时</li></ul><p id="c0d9" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">关于 CRON 表达式的具体语法，请访问这个免费网站进行详细的解释和实验:</p><div class="is it gp gr iu oh"><a href="https://www.freeformatter.com/cron-expression-generator-quartz.html" rel="noopener  ugc nofollow" target="_blank"><div class="oi ab fo"><div class="oj ab ok cl cj ol"><h2 class="bd jf gy z fp om fr fs on fu fw jd bi translated">免费在线克隆表达式生成器和描述-FreeFormatter.com</h2><div class="oo l"><h3 class="bd b gy z fp om fr fs on fu fw dk translated">使用易于使用的在线界面生成 quartz cron 表达式。将 cron 表达式转换成可读文本…</h3></div><div class="op l"><p class="bd b dl z fp om fr fs on fu fw dk translated">www.freeformatter.com</p></div></div></div></a></div><p id="bcfc" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">另一种调度定义的方法要简单得多，就是简单的定义时间间隔。例如，如果我希望任务每 5 分钟触发一次，那么就这样定义它:</p><pre class="np nq nr ns gt nt lk nu nv aw nw bi"><span id="980f" class="nd mb je lk b gy nx ny l nz oa">SCHEDULE = '5 MINUTE'</span></pre><p id="e010" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">触发任务的另一种方式是定义父任务，这被认为是构建任务树。例如，如果我们想在<code class="fe lh li lj lk b">TASK1</code>结束时触发<code class="fe lh li lj lk b">TASK2</code>，只需简单定义:</p><pre class="np nq nr ns gt nt lk nu nv aw nw bi"><span id="b2cb" class="nd mb je lk b gy nx ny l nz oa">CREATE TASK TASK2<br/>...<br/>AFTER "TASK1"<br/>AS<br/>&lt;SQL&gt;</span></pre><h2 id="ce76" class="nd mb je bd mc ne nf dn mg ng nh dp mk km ni nj mo kq nk nl ms ku nm nn mw no bi translated"><strong class="ak">有条件的任务</strong></h2><p id="5570" class="pw-post-body-paragraph kb kc je kd b ke my kg kh ki mz kk kl km na ko kp kq nb ks kt ku nc kw kx ky im bi translated">可以通过“WHEN”子句用条件来定义任务，该子句用于决定是否应该执行该任务。</p><p id="4709" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这是一个非常方便的功能。例如，如果您用您的“根任务”设置一个条件，当条件不满足时，整个任务树将根本不会运行。</p><p id="7706" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">此外，如果这种“条件测试”发生在雪花的云服务层(使用元数据而不是对表的 SQL 查询)，则这种条件测试的成本为零，因此如果条件不满足，则没有成本。</p><h1 id="7f62" class="ma mb je bd mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx bi translated">通过流使用任务</h1><p id="93ed" class="pw-post-body-paragraph kb kc je kd b ke my kg kh ki mz kk kl km na ko kp kq nb ks kt ku nc kw kx ky im bi translated">雪花任务和流被一起用来构建数据管道是非常常见的。一个非常典型的使用模式是:</p><ol class=""><li id="ddb7" class="ll lm je kd b ke kf ki kj km ln kq lo ku lp ky lz lr ls lt bi translated">Snowpipe 将原始数据加载到临时表中。</li><li id="a621" class="ll lm je kd b ke lu ki lv km lw kq lx ku ly ky lz lr ls lt bi translated">雪花流是在 staging 表上创建的，因此被摄取的新行将被记录为偏移量。</li><li id="9e55" class="ll lm je kd b ke lu ki lv km lw kq lx ku ly ky lz lr ls lt bi translated">然后，雪花任务通过一些 DML 语句消耗流偏移量，以进一步将数据加载到生产表中，可能包括一些更复杂的转换。</li><li id="13c4" class="ll lm je kd b ke lu ki lv km lw kq lx ku ly ky lz lr ls lt bi translated">在实践中，会有一个任务树来执行多个 SQL 语句，以便执行复杂的转换，有时会将转换后的条目填充到多个生产表中。</li><li id="d042" class="ll lm je kd b ke lu ki lv km lw kq lx ku ly ky lz lr ls lt bi translated">一些中间表可能需要由任务树中的任务创建。</li><li id="c745" class="ll lm je kd b ke lu ki lv km lw kq lx ku ly ky lz lr ls lt bi translated">在任务树的最后可能会有一些任务来清理一些临时表。</li></ol><p id="de93" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我们已经介绍了需要集成 Snowpipe 和 Stream 的典型场景。现在，对于流和任务，还有一个非常典型的使用模式，那就是系统变量<code class="fe lh li lj lk b">SYSTEM$STREAM_HAS_DATA</code>。</p><p id="cee1" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">具体来说，变量<code class="fe lh li lj lk b">SYSTEM$STREAM_HAS_DATA</code>将返回一个布尔值，表明在可消费的流中是否存在偏移。因此，我们可以简单地将这个条件放在任务定义的“WHEN”子句中。因此，如果流中没有新内容，任务将不会被执行。例如:</p><pre class="np nq nr ns gt nt lk nu nv aw nw bi"><span id="f843" class="nd mb je lk b gy nx ny l nz oa">CREATE TASK mytask1<br/>  WAREHOUSE = mywh<br/>  SCHEDULE = '5 minute'<br/>WHEN<br/>  SYSTEM$STREAM_HAS_DATA('MYSTREAM')<br/>AS<br/>  INSERT INTO ... ;</span></pre><p id="cfdb" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在这个例子中，只有当流“MYSTREAM”中存在消耗性偏移时，才会执行任务“mytask1”。否则，将跳过该任务，并在 5 分钟后再次检查状况。</p><h2 id="ab58" class="nd mb je bd mc ne nf dn mg ng nh dp mk km ni nj mo kq nk nl ms ku nm nn mw no bi translated">还有一个提示</h2><p id="16fd" class="pw-post-body-paragraph kb kc je kd b ke my kg kh ki mz kk kl km na ko kp kq nb ks kt ku nc kw kx ky im bi translated">请记住，默认情况下，刚刚创建的任务将被暂停。有必要通过如下方式“改变”任务来手动启用此任务:</p><pre class="np nq nr ns gt nt lk nu nv aw nw bi"><span id="ec44" class="nd mb je lk b gy nx ny l nz oa">ALTER TASK mytask1 RESUME;</span></pre><h1 id="9826" class="ma mb je bd mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx bi translated">未来作品</h1><p id="8bae" class="pw-post-body-paragraph kb kc je kd b ke my kg kh ki mz kk kl km na ko kp kq nb ks kt ku nc kw kx ky im bi translated">本文从理论上介绍了雪花流和任务。画出了使用 Snowpipe -&gt; Stream -&gt; Task 构建 ELT 数据管道的概貌。在下一部分中，我将使用一个真实的示例数据源来构建 ELT 数据管道，使用这些雪花组件和必要的 SQL 脚本演示，这将更具实践性。</p><div class="is it gp gr iu oh"><a href="https://medium.com/@qiuyujx/membership" rel="noopener follow" target="_blank"><div class="oi ab fo"><div class="oj ab ok cl cj ol"><h2 class="bd jf gy z fp om fr fs on fu fw jd bi translated">通过我的推荐链接加入灵媒-陶</h2><div class="oo l"><h3 class="bd b gy z fp om fr fs on fu fw dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="op l"><p class="bd b dl z fp om fr fs on fu fw dk translated">medium.com</p></div></div><div class="oq l"><div class="or l os ot ou oq ov ja oh"/></div></div></a></div><p id="126b" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">如果你觉得我的文章有帮助，请考虑加入 Medium 会员来支持我和成千上万的其他作者！(点击上面的链接)</p><h1 id="55ec" class="ma mb je bd mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx bi translated">资源</h1><p id="3960" class="pw-post-body-paragraph kb kc je kd b ke my kg kh ki mz kk kl km na ko kp kq nb ks kt ku nc kw kx ky im bi translated">雪花溪流官方文档:【https://docs.snowflake.net/manuals/user-guide/streams.html T2】</p><p id="4411" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">雪花任务官方文档:<br/>T5】https://docs . snow flake . net/manuals/user-guide/Tasks-intro . html</p><p id="143f" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">免费在线 CRON 表达式生成器:<br/><a class="ae lg" href="https://www.freeformatter.com/cron-expression-generator-quartz.html" rel="noopener ugc nofollow" target="_blank">https://www . free formatter . com/CRON-expression-generator-quartz . html</a></p></div></div>    
</body>
</html>