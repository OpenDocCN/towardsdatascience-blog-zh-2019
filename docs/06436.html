<html>
<head>
<title>Beginner Guide to Machine Learning Pipeline Monitoring</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">机器学习流水线监控初学者指南</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/beginner-guide-to-machine-learning-pipeline-monitoring-aba2af444155?source=collection_archive---------18-----------------------#2019-09-15">https://towardsdatascience.com/beginner-guide-to-machine-learning-pipeline-monitoring-aba2af444155?source=collection_archive---------18-----------------------#2019-09-15</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="a909" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">在机器学习管道的开发中，这是一个讨论较少但很重要的话题</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/1883cf3691436cde0de3db044eedd6c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FzE_hg55htBEQuitZq8Isw.jpeg"/></div></div></figure><p id="2035" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">许多公司正在使用 power machine learning 在应用程序的前端和后端提供预测、推荐或分类。来自<a class="ae ln" href="https://www.theverge.com/2019/1/28/18197520/ai-artificial-intelligence-machine-learning-computational-science" rel="noopener ugc nofollow" target="_blank"> The Verge </a>的一份报告称，“最终，几乎所有东西都将在内部的某个地方拥有(机器学习)。”然而，将机器学习模型构建和部署到机器学习管道并不是开发周期的结束。机器学习模型需要随着时间的推移进行监控和调整，以确保模型不会遇到意想不到的问题，并且在性能上是有效的。下面的流程图很好地说明了机器学习模型的开发周期，以及性能监控如何融入其中，以及人在回路中如何将强化学习带回模型。一篇关于“什么是机器学习？”可以在这篇牛逼的<a class="ae ln" rel="noopener" target="_blank" href="/not-yet-another-article-on-machine-learning-e67f8812ba86">文章</a>上找到。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi lo"><img src="../Images/39116bf42180a70c301ecacf12572ccf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*LvJeUTHJ0850kW7Y"/></div></div><figcaption class="lp lq gj gh gi lr ls bd b be z dk"><em class="lt">Source: </em><a class="ae ln" rel="noopener" target="_blank" href="/not-yet-another-article-on-machine-learning-e67f8812ba86"><em class="lt">http://towardsdatascience.com/not-yet-another-article-on-machine-learning-e67f8812ba86</em></a></figcaption></figure><p id="7348" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">机器学习模型的开发涉及许多步骤，每个步骤都需要不同的技能和知识来执行。本文将关注机器学习开发中一个较少讨论的领域，即机器学习流水线的性能监控。</p><p id="71aa" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">机器学习管道监控可以分为两个部分:</p><ol class=""><li id="825b" class="lu lv iq kt b ku kv kx ky la lw le lx li ly lm lz ma mb mc bi translated">ETL 监控</li><li id="c987" class="lu lv iq kt b ku md kx me la mf le mg li mh lm lz ma mb mc bi translated">分数监控</li></ol><p id="d4ef" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">简而言之，ETL 监控关注的是进入模型之前的数据，而 Score 监控关注的是模型的输出。总之，数据科学家可以看到数据和他们的模型行为之间的相关性。这种理解对于确定需要改进的领域和检测管道中的故障至关重要。本文将关注 ETL 监控。</p><h1 id="172e" class="mi mj iq bd mk ml mm mn mo mp mq mr ms jw mt jx mu jz mv ka mw kc mx kd my mz bi translated">机器学习流水线的 ETL 监控</h1><p id="7b1f" class="pw-post-body-paragraph kr ks iq kt b ku na jr kw kx nb ju kz la nc lc ld le nd lg lh li ne lk ll lm ij bi translated">机器学习管道中要监控的第一个领域是特征提取过程，在此过程中，输入数据在输入到机器学习模型进行分类之前被转换为数字特征。然而，深度学习模型可能不会将特征提取作为一个独立的过程，如下图所示。为了不混淆观众，这一部分将只关注传统的机器学习模型，如随机森林，它将特征提取作为过程中的一个独立步骤。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/b9ea7983ea7e8dac04337f6971fd327a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1386/0*RV685RGDsNl-KQsI"/></div><figcaption class="lp lq gj gh gi lr ls bd b be z dk"><em class="lt">Source: </em><a class="ae ln" rel="noopener" target="_blank" href="/cnn-application-on-structured-data-automated-feature-extraction-8f2cd28d9a7e"><em class="lt">https://towardsdatascience.com/cnn-application-on-structured-data-automated-feature-extraction-8f2cd28d9a7e</em></a></figcaption></figure><p id="2f22" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">当我们在数据进入模型之前查看数据时，ETL 监控并不是真正的性能监控，而是防止坏数据进入模型的保护措施。损坏的数据或不寻常的模式会扰乱模型，导致混乱的分类。换句话说，“垃圾进，垃圾出。”</p><p id="664f" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">一些数据科学项目从他们的内部操作中获取数据，这使得输入变得清晰、结构化和可解释。然而，机器学习项目通常应用于野生数据源，因为简单的基于规则的算法无法用于处理它们。例如，日志文件、用户生成的内容、第三方供应商和开放数据。这些公司对数据如何生成、何时可用以及模式会发生什么变化的控制力度较小。</p><p id="e3a9" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">使用外部数据源的风险在于，数据的模式或模式可能会在没有通知或团队意识到的情况下随时间而改变。例如，有人可能破坏开放的数据，内容生成的方法可能改变，或者供应商可能在没有通知下游用户的情况下改变数据的模式。上述原因可能会威胁到 ML 模型的性能，如果忽视太久，会产生严重的问题。</p><p id="d849" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">为了有效地监控 ETL 过程，防止关键数据问题影响模型及其性能；数据的<strong class="kt ir">完整性</strong>、<strong class="kt ir">一致性</strong>和<strong class="kt ir">可用性</strong>是选择 ETL 监控度量时需要考虑的三个方面。</p><h1 id="1c3b" class="mi mj iq bd mk ml mm mn mo mp mq mr ms jw mt jx mu jz mv ka mw kc mx kd my mz bi translated">完整</h1><p id="3b53" class="pw-post-body-paragraph kr ks iq kt b ku na jr kw kx nb ju kz la nc lc ld le nd lg lh li ne lk ll lm ij bi translated">有许多原因会危及数据的完整性。其中一些是:</p><ul class=""><li id="5c4c" class="lu lv iq kt b ku kv kx ky la lw le lx li ly lm ng ma mb mc bi translated">数据管道中的错误</li><li id="dc74" class="lu lv iq kt b ku md kx me la mf le mg li mh lm ng ma mb mc bi translated">基础设施中的软件更新</li><li id="5589" class="lu lv iq kt b ku md kx me la mf le mg li mh lm ng ma mb mc bi translated">数据源的日常维护</li><li id="fb0d" class="lu lv iq kt b ku md kx me la mf le mg li mh lm ng ma mb mc bi translated">外部方对数据的破坏</li><li id="4eb5" class="lu lv iq kt b ku md kx me la mf le mg li mh lm ng ma mb mc bi translated">数据源中数据模式的变化</li></ul><p id="7e03" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">通过创建全面的验证规则来捕捉和报告异常，可以监控数据的完整性。验证规则通常在探索性数据分析和模型训练期间制定。例如，可以使用的一些度量是缺失或看不见的特征的数量，或者未通过每个验证规则的数据点的比率。</p><p id="9168" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">即使数据科学家会将损坏的数据排除在模型之外，也必须监控数据问题的大小和严重性，以便衡量数据源的可靠性，并开发新的规则来持续验证数据完整性。</p><h1 id="640c" class="mi mj iq bd mk ml mm mn mo mp mq mr ms jw mt jx mu jz mv ka mw kc mx kd my mz bi translated">一致性</h1><p id="31be" class="pw-post-body-paragraph kr ks iq kt b ku na jr kw kx nb ju kz la nc lc ld le nd lg lh li ne lk ll lm ij bi translated">ETL 监控指标的第二个原则是数据的一致性。一致性非常重要，因为数据点可能会通过验证规则，但要素中的值可能会与模型的训练历史有很大不同。影响数据完整性的原因也会影响数据的一致性。但在用户生成数据的情况下，由于用户在平台上互动方式的转变，一致性的变化也可能有机地发生。</p><p id="eead" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">不一致的数据会影响 ML 模型的性能，因为它会改变为其训练模型的数据模式。下面的可视化说明了为什么数据的不一致性会破坏 ML 模型的性能。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nh"><img src="../Images/bb97c587460858815447115368143fb6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/0*3lNavloXLQ4JrdXN"/></div></figure><p id="ac86" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">为了监控一致性，可以导出数据的量、变化率或单个值，以便针对将被监控的指标进行汇总。然后，聚合值成为时间序列中的数据点，其中 X 轴是时间，Y 轴是用于聚合每个批次或时间窗口中的数据的测量值(取决于数据是以批次还是以流的形式出现)。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ni"><img src="../Images/1ec705cb06b41acaff5153adbeab4d3b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uwTPBoA1h1XfwSmQn5GX2w.png"/></div></div><figcaption class="lp lq gj gh gi lr ls bd b be z dk">Time Series Data Example</figcaption></figure><p id="aae4" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">有许多测量变量可用于表示数据的分布和偏斜度，如方差和百分位数。根据我的经验，我发现均值和标准差是最有效的度量组合。该组合配合使用效果最佳，因为平均值显示的是中心点，而标准偏差显示的是分布范围。下图显示了均值和标准差如何表示不同的分布。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nh"><img src="../Images/da8037633b435d0f2572bcec7a5511eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/0*Oi9AajN-YWqI6RBV"/></div><figcaption class="lp lq gj gh gi lr ls bd b be z dk">Source: <a class="ae ln" href="https://www.varsitytutors.com/hotmath/hotmath_help/topics/normal-distribution-of-data" rel="noopener ugc nofollow" target="_blank">https://www.varsitytutors.com/hotmath/hotmath_help/topics/normal-distribution-of-data</a></figcaption></figure><p id="a7f4" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">让我们用一个真实的例子来解释一下。我们建立了一个 ML 模型，根据社会经济数据来预测人口的预期寿命。其中一个特征是收入，我们每年批量获取数据。因此，我们将找到人口收入的均值和标准差，并逐年进行比较，以分析收入分布的一致性。如果 2017 年的收入均值或标准差与 2018 年有很大不同，并且该模型是根据 2017 年的数据训练的，则表明模式已经改变，预测可能不如训练和测试时准确。用 2018 年的数据重新调整模型也是一个好主意，我将在未来的帖子中谈到这个话题。</p><h1 id="7072" class="mi mj iq bd mk ml mm mn mo mp mq mr ms jw mt jx mu jz mv ka mw kc mx kd my mz bi translated">有效性</h1><p id="f585" class="pw-post-body-paragraph kr ks iq kt b ku na jr kw kx nb ju kz la nc lc ld le nd lg lh li ne lk ll lm ij bi translated">可以说，数据的可用性是监控管道时要考虑的最重要的方面。当管道从团队无法控制的数据源(如第三方供应商或开放数据)获取数据时，这一点尤其重要。如果没有数据输入，ML 管道就像一条废弃的铁轨，建设管道的投资就会损失。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nh"><img src="../Images/8ff3ed0276175b77765d36b22d1bd142.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/0*da4SewbmknLyuxqj"/></div></figure><p id="7e2d" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">数据的可用性可能不会影响 ML 模型的精度，但它会影响 ML 管道的整体性能，因为没有数据输入(或延迟输入)就无法实现业务目标。可用于监控数据可用性的 KPI 示例如下:</p><ul class=""><li id="c9ec" class="lu lv iq kt b ku kv kx ky la lw le lx li ly lm ng ma mb mc bi translated">每批数据之间的延迟时间</li><li id="1b01" class="lu lv iq kt b ku md kx me la mf le mg li mh lm ng ma mb mc bi translated">管道中没有数据的总分钟数、小时数或天数</li><li id="dd90" class="lu lv iq kt b ku md kx me la mf le mg li mh lm ng ma mb mc bi translated">数据交付落后于计划的次数</li></ul><p id="ef70" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">了解上述指标有助于数据科学团队确定需要改进的领域，并在数据不可用时得到通知。如果有多个数据源进入管道，这些指标将帮助团队了解每个数据源的可靠性，以便将问题或顾虑传达给正确的团队。</p></div><div class="ab cl nj nk hu nl" role="separator"><span class="nm bw bk nn no np"/><span class="nm bw bk nn no np"/><span class="nm bw bk nn no"/></div><div class="ij ik il im in"><p id="02fa" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">文章到此结束！我希望您现在知道如何监控数据的完整性、一致性和可用性，以及为什么它们对机器学习管道的性能至关重要。</p><p id="3325" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我将在下一篇文章中继续发布机器学习管道监控的第二部分，也就是分数监控。您可以关注我，获取更多关于性能监控和数据可视化相关主题的文章。谢谢你读到这里，我希望你喜欢这篇文章！</p></div></div>    
</body>
</html>