<html>
<head>
<title>Understanding NLP Word Embeddings — Text Vectorization</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">理解 NLP 单词嵌入—文本矢量化</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/understanding-nlp-word-embeddings-text-vectorization-1a23744f7223?source=collection_archive---------2-----------------------#2019-11-11">https://towardsdatascience.com/understanding-nlp-word-embeddings-text-vectorization-1a23744f7223?source=collection_archive---------2-----------------------#2019-11-11</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="cd18" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">处理自然语言文本并从给定的单词中提取有用的信息，使用机器学习和深度学习技术的句子需要将字符串/文本转换为一组实数(向量)——单词嵌入。</p><p id="0570" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">单词嵌入或单词向量化是 NLP 中的一种方法，用于将单词或短语从词汇表映射到相应的实数向量，该向量用于查找单词预测、单词相似性/语义。</p><blockquote class="kl km kn"><p id="9ae1" class="jn jo ko jp b jq jr js jt ju jv jw jx kp jz ka kb kq kd ke kf kr kh ki kj kk ij bi translated">将单词转换成数字的过程称为矢量化。</p></blockquote><p id="9a00" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">单词嵌入在以下用例中有所帮助。</p><ul class=""><li id="48fa" class="ks kt iq jp b jq jr ju jv jy ku kc kv kg kw kk kx ky kz la bi translated">计算相似的单词</li><li id="6fb5" class="ks kt iq jp b jq lb ju lc jy ld kc le kg lf kk kx ky kz la bi translated">文本分类</li><li id="546b" class="ks kt iq jp b jq lb ju lc jy ld kc le kg lf kk kx ky kz la bi translated">文档聚类/分组</li><li id="6dd4" class="ks kt iq jp b jq lb ju lc jy ld kc le kg lf kk kx ky kz la bi translated">用于文本分类的特征提取</li><li id="f567" class="ks kt iq jp b jq lb ju lc jy ld kc le kg lf kk kx ky kz la bi translated">自然语言处理。</li></ul><p id="252f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在将单词转换成向量后，我们需要使用一些技术如<a class="ae lg" href="https://en.wikipedia.org/wiki/Euclidean_distance" rel="noopener ugc nofollow" target="_blank">欧氏距离</a>、<a class="ae lg" href="https://en.wikipedia.org/wiki/Cosine_similarity" rel="noopener ugc nofollow" target="_blank">余弦相似度</a>来识别相似的单词。</p><h2 id="2fcc" class="lh li iq bd lj lk ll dn lm ln lo dp lp jy lq lr ls kc lt lu lv kg lw lx ly lz bi translated"><strong class="ak">为什么余弦相似</strong></h2><p id="94c9" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">计算常用词或欧几里德距离是用于匹配相似文档的一般方法，其基于计算文档之间的常用词的数量。</p><p id="fc4f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">即使常用词的数量增加，但文档谈论不同的主题，这种方法也不起作用。为了克服这个缺陷，使用“余弦相似度”方法来寻找文档之间的相似度。</p><figure class="mg mh mi mj gt mk gh gi paragraph-image"><div class="gh gi mf"><img src="../Images/da45b0f26f8799f6b212e97e672b0eb7.png" data-original-src="https://miro.medium.com/v2/resize:fit:884/format:webp/1*UODvtQMybHE8c0eL3K5z5A.png"/></div><figcaption class="mn mo gj gh gi mp mq bd b be z dk">Figure 1: Cosine Distance. Ref: <a class="ae lg" href="https://bit.ly/2X5470I" rel="noopener ugc nofollow" target="_blank">https://bit.ly/2X5470I</a></figcaption></figure><p id="2a84" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在数学上，它测量两个向量(item1，item2)在 N 维向量空间中投影的角度的余弦值。余弦相似度的优点是，即使欧氏距离是距离，它也能预测文档的相似度。</p><blockquote class="kl km kn"><p id="8dc1" class="jn jo ko jp b jq jr js jt ju jv jw jx kp jz ka kb kq kd ke kf kr kh ki kj kk ij bi translated">“角度越小，相似度越高”——余弦相似度。</p></blockquote><p id="5564" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们看一个例子。</p><ol class=""><li id="62ca" class="ks kt iq jp b jq jr ju jv jy ku kc kv kg kw kk mr ky kz la bi translated">朱莉爱约翰胜过琳达爱约翰</li><li id="0951" class="ks kt iq jp b jq lb ju lc jy ld kc le kg lf kk mr ky kz la bi translated">简爱约翰胜过朱莉爱约翰</li></ol><pre class="mg mh mi mj gt ms mt mu mv aw mw bi"><span id="461d" class="lh li iq mt b gy mx my l mz na">John  2   2<br/>Jane  0   1<br/>Julie 1   1<br/>Linda 1   0<br/>likes 0   1<br/>loves 2   1<br/>more  1   1<br/>than  1   1</span></pre><p id="7c4f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这两个向量是，</p><p id="5c5b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe nb nc nd mt b">Item 1: [2, 0, 1, 1, 0, 2, 1, 1]<br/>Item 2: [2, 1, 1, 0, 1, 1, 1, 1]</code></p><p id="4e4e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">两个向量值之间的余弦角(角度越小)为 0.822，最接近 1。</p><p id="ec37" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在我们来看看把句子转换成向量的方法都有哪些。</p><p id="f261" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">来自预训练方法的单词嵌入，</p><ul class=""><li id="070b" class="ks kt iq jp b jq jr ju jv jy ku kc kv kg kw kk kx ky kz la bi translated">Word2Vec —来自谷歌</li><li id="db4e" class="ks kt iq jp b jq lb ju lc jy ld kc le kg lf kk kx ky kz la bi translated">快速文本—来自脸书</li><li id="2c4a" class="ks kt iq jp b jq lb ju lc jy ld kc le kg lf kk kx ky kz la bi translated">手套——来自斯坦福</li></ul><p id="21c7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这个博客中，我们将看到最流行的嵌入式架构 Word2Vec。</p><p id="eb10" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> Word2Vec </strong></p><p id="2816" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Word 2 vec——由托马斯·米科洛夫和谷歌的一个研究团队在 2013 年开发的向量空间中的单词表示。</p><p id="24e5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="ko">word 2 vec 技术产生的原因:</em></p><p id="cc19" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">大多数 NLP 系统将单词视为原子单位。现有系统的局限性在于没有单词之间相似性的概念。此外，该系统适用于较小、较简单的数据，并且在只有几十亿数据或更少的数据上表现优异。</p><p id="3a1a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">为了用具有复杂模型的更大数据集进行训练，现代技术使用神经网络架构来训练复杂的数据模型，并且对于具有数十亿单词和数百万单词词汇的巨大数据集来说表现更好。</p><p id="ee1b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这种技术有助于测量结果矢量表示的质量。这适用于相似的单词，这些单词倾向于接近具有多种相似度的单词。</p><p id="f60a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">句法规则:</strong>指符合语法的句子纠正。</p><p id="fbcc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">语义规律:</strong>指词汇符号在那个结构中排列的意义。</p><figure class="mg mh mi mj gt mk gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/510213dac20db1777914e147291f855d.png" data-original-src="https://miro.medium.com/v2/resize:fit:922/format:webp/1*pGXwySwn70zdsHIVcT79Jw.png"/></div><figcaption class="mn mo gj gh gi mp mq bd b be z dk">Figure 2: Five Syntactic and Semantic word relationship test set. Ref: <a class="ae lg" href="https://arxiv.org/pdf/1301.3781.pdf" rel="noopener ugc nofollow" target="_blank">https://arxiv.org/pdf/1301.3781.pdf</a></figcaption></figure><p id="f794" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所提出的技术被发现，单词表示的相似性超出了句法规则，并且对于单词向量的代数运算惊人地有效。举个例子，</p><blockquote class="kl km kn"><p id="8888" class="jn jo ko jp b jq jr js jt ju jv jw jx kp jz ka kb kq kd ke kf kr kh ki kj kk ij bi translated">向量(“国王”)—向量(“男人”)+向量(“女人”)=词(“女王”)</p></blockquote><p id="a60e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">其中“Queen”是单词表示的最接近的结果向量。</p><p id="2f31" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">以下单词表示的模型架构的目标是最大化准确性和最小化计算复杂度。这些模型是，</p><ul class=""><li id="a27a" class="ks kt iq jp b jq jr ju jv jy ku kc kv kg kw kk kx ky kz la bi translated">前馈神经网络语言模型(NNLM)</li><li id="5ab4" class="ks kt iq jp b jq lb ju lc jy ld kc le kg lf kk kx ky kz la bi translated">递归神经网络语言模型</li></ul><p id="e810" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">上述所有模型都使用<a class="ae lg" href="https://en.wikipedia.org/wiki/Stochastic_gradient_descent" rel="noopener ugc nofollow" target="_blank">随机梯度下降</a>和<a class="ae lg" href="https://en.wikipedia.org/wiki/Backpropagation" rel="noopener ugc nofollow" target="_blank">反向传播</a>进行训练。</p><p id="7c5e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">前馈神经网络语言模型(NNLM) </strong></p><p id="e6ec" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">NNLM 模型由输入、投影、隐藏和输出层组成。由于投影层中的值密集，这种架构对于投影和隐藏层之间的计算变得复杂。</p><p id="c296" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">递归神经网络语言模型</strong></p><p id="ffbe" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">与浅层神经网络相比，RNN 模型可以有效地表示更复杂的模式。RNN 模型没有投影图层；只有输入、隐藏和输出层。</p><p id="3e9a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">应该使用名为<a class="ae lg" href="https://papers.nips.cc/paper/4687-large-scale-distributed-deep-networks.pdf" rel="noopener ugc nofollow" target="_blank"> DistBelief </a>的大规模分布式框架为庞大的数据集训练模型，这将给出更好的结果。在 Word2Vec 中提出了两个新的模型，</p><ul class=""><li id="84bf" class="ks kt iq jp b jq jr ju jv jy ku kc kv kg kw kk kx ky kz la bi translated">连续词袋模型</li><li id="b632" class="ks kt iq jp b jq lb ju lc jy ld kc le kg lf kk kx ky kz la bi translated">连续跳格模型</li></ul><p id="f4dd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">使用分布式架构，尽量降低计算复杂性。</p><p id="22db" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">连续词袋模型</strong></p><p id="7c06" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们把这个模型称为 CBOW。CBOW 架构类似于前馈 NNLM，其中非线性隐藏层被移除，并且投影层被所有单词共享；因此所有的单词都被投射到相同的位置。</p><figure class="mg mh mi mj gt mk gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/982e239b4b66f9beef54488548da5d1b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1056/format:webp/1*uDkjXY2ONRpSss5ClqM6rg.png"/></div><figcaption class="mn mo gj gh gi mp mq bd b be z dk">Figure 3: CBOW architecture. Ref: <a class="ae lg" href="https://bit.ly/2NXbraK" rel="noopener ugc nofollow" target="_blank">https://bit.ly/2NXbraK</a></figcaption></figure><blockquote class="kl km kn"><p id="712a" class="jn jo ko jp b jq jr js jt ju jv jw jx kp jz ka kb kq kd ke kf kr kh ki kj kk ij bi translated">CBOW 架构基于上下文预测当前单词。</p></blockquote><p id="3b60" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">连续跳格模型</strong></p><p id="940d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">跳格模型类似于 CBOW。唯一的区别是，它不是根据上下文来预测当前单词，而是试图根据同一句子中的另一个单词来最大化一个单词的分类。</p><figure class="mg mh mi mj gt mk gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/82a5f92be074fd47a70092c0fdbe700d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1106/format:webp/1*FzLgo1G_VeyQw8uhQDO_nQ.png"/></div><figcaption class="mn mo gj gh gi mp mq bd b be z dk">Figure 4: Skip-gram architecture. Reference — <a class="ae lg" href="https://bit.ly/2NXbraK" rel="noopener ugc nofollow" target="_blank">https://bit.ly/2NXbraK</a></figcaption></figure><blockquote class="kl km kn"><p id="e0ac" class="jn jo ko jp b jq jr js jt ju jv jw jx kp jz ka kb kq kd ke kf kr kh ki kj kk ij bi translated">给定当前单词，跳格结构预测周围的单词。</p></blockquote><p id="4cce" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> Word2Vec 架构实现— Gensim </strong></p><p id="a6ed" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Gensim 库将使我们能够通过在自定义语料库上训练我们自己的 word2vec 模型来开发单词嵌入，或者使用跳格算法的 CBOW。</p><p id="1ac5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">实现库可以在这里找到——https://bit.ly/33ywiaW<a class="ae lg" href="https://bit.ly/33ywiaW" rel="noopener ugc nofollow" target="_blank"/>。</p><p id="9f42" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">结论</strong></p><ul class=""><li id="e899" class="ks kt iq jp b jq jr ju jv jy ku kc kv kg kw kk kx ky kz la bi translated">自然语言处理需要将文本/字符串转换成实数，称为单词嵌入或单词向量化</li><li id="9021" class="ks kt iq jp b jq lb ju lc jy ld kc le kg lf kk kx ky kz la bi translated">一旦单词被转换为向量，余弦相似性是用于实现大多数使用 NLP、文档聚类、文本分类、基于句子上下文预测单词的用例的方法</li><li id="cf56" class="ks kt iq jp b jq lb ju lc jy ld kc le kg lf kk kx ky kz la bi translated">余弦相似性—“角度越小，相似性越高</li><li id="c55e" class="ks kt iq jp b jq lb ju lc jy ld kc le kg lf kk kx ky kz la bi translated">最著名的架构，如 Word2Vec、Fasttext、Glove，有助于转换单词向量，并利用余弦相似性作为单词相似性特征</li><li id="522a" class="ks kt iq jp b jq lb ju lc jy ld kc le kg lf kk kx ky kz la bi translated">NNLM，RNNLM 优于巨大的词数据集。但是计算复杂度是一个很大的开销</li><li id="2603" class="ks kt iq jp b jq lb ju lc jy ld kc le kg lf kk kx ky kz la bi translated">为了克服计算复杂性，Word2Vec 使用 CBOW 和 Skip-gram 结构，以便最大化精度和最小化计算复杂性</li><li id="a96b" class="ks kt iq jp b jq lb ju lc jy ld kc le kg lf kk kx ky kz la bi translated">CBOW 架构基于上下文预测当前单词</li><li id="15e2" class="ks kt iq jp b jq lb ju lc jy ld kc le kg lf kk kx ky kz la bi translated">给定当前单词，跳格结构预测周围的单词</li><li id="7748" class="ks kt iq jp b jq lb ju lc jy ld kc le kg lf kk kx ky kz la bi translated">详细解释了关于 Word2Vec 架构的论文。</li></ul><p id="bb66" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">参考资料:</p><ul class=""><li id="eca0" class="ks kt iq jp b jq jr ju jv jy ku kc kv kg kw kk kx ky kz la bi translated"><a class="ae lg" href="https://arxiv.org/pdf/1301.3781.pdf" rel="noopener ugc nofollow" target="_blank">https://arxiv.org/pdf/1301.3781.pdf</a></li><li id="2fc6" class="ks kt iq jp b jq lb ju lc jy ld kc le kg lf kk kx ky kz la bi translated"><a class="ae lg" href="https://www.machinelearningplus.com/nlp/cosine-similarity/" rel="noopener ugc nofollow" target="_blank">https://www.machinelearningplus.com/nlp/cosine-similarity/</a></li><li id="32f2" class="ks kt iq jp b jq lb ju lc jy ld kc le kg lf kk kx ky kz la bi translated"><a class="ae lg" href="https://medium.com/@adriensieg/text-similarities-da019229c894" rel="noopener">https://medium . com/@ adriensieg/text-similarities-da 019229 c 894</a></li></ul></div></div>    
</body>
</html>