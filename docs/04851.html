<html>
<head>
<title>Torch vs Keras for CNN Image Classification: Thoughts on the Rock Paper Scissor dataset</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Torch vs Keras 用于 CNN 图像分类:关于石头剪刀布数据集的思考</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/torch-vs-keras-for-cnn-image-classification-thoughts-on-the-rock-paper-scissor-dataset-5042f966efae?source=collection_archive---------26-----------------------#2019-07-22">https://towardsdatascience.com/torch-vs-keras-for-cnn-image-classification-thoughts-on-the-rock-paper-scissor-dataset-5042f966efae?source=collection_archive---------26-----------------------#2019-07-22</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="1ebb" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">上周，我写了一篇关于使用 CNN 分类法对石头、纸或剪刀手势的图像进行分类的文章，该分类法是使用名为“torchvision”的软件包在 pyTorch 框架上构建的。</p><p id="e4ad" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">参见:</p><div class="ko kp gp gr kq kr"><a href="https://medium.com/swlh/rock-paper-scissor-image-classifier-using-torch-vision-and-a-cnn-f54d3ed0a65e" rel="noopener follow" target="_blank"><div class="ks ab fo"><div class="kt ab ku cl cj kv"><h2 class="bd iu gy z fp kw fr fs kx fu fw is bi translated">使用火炬视觉和 CNN 的石头剪子图像分类器</h2><div class="ky l"><h3 class="bd b gy z fp kw fr fs kx fu fw dk translated">在过去的一年里，我一直在探索 Pytorch 框架的使用，并注意到许多答案…</h3></div><div class="kz l"><p class="bd b dl z fp kw fr fs kx fu fw dk translated">medium.com</p></div></div><div class="la l"><div class="lb l lc ld le la lf lg kr"/></div></div></a></div><p id="bb29" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">的文章，并且:</p><div class="ko kp gp gr kq kr"><a href="https://github.com/xijianlim/torch_and_keras/blob/master/CNN_RPS_torch.ipynb" rel="noopener  ugc nofollow" target="_blank"><div class="ks ab fo"><div class="kt ab ku cl cj kv"><h2 class="bd iu gy z fp kw fr fs kx fu fw is bi translated">西江林/火炬 _ 和 _ 喀拉斯</h2><div class="ky l"><h3 class="bd b gy z fp kw fr fs kx fu fw dk translated">在 GitHub 上创建一个帐户，为 xijianlim/torch_and_keras 的开发做出贡献。</h3></div><div class="kz l"><p class="bd b dl z fp kw fr fs kx fu fw dk translated">github.com</p></div></div><div class="la l"><div class="lh l lc ld le la lf lg kr"/></div></div></a></div><p id="a82a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">对应的代码。</p><p id="3be8" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我想在 Keras 中复制相同的分类器，以查看相对易用性和特性。简而言之:Keras 和它的包看起来比 Torch 好用得多。这里是在数据加载、网络架构和培训上使用深度学习框架所涉及的阶段的比较。</p><ol class=""><li id="76d2" class="li lj it js b jt ju jx jy kb lk kf ll kj lm kn ln lo lp lq bi translated"><strong class="js iu">图像数据集加载:</strong></li></ol><p id="85b4" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这两个软件包都完成了繁重的工作，只需提取存储文件夹中的所有图像，然后将它们添加到数据加载器中，然后输入到您的网络中。前提是你如何存储你的图像在单独的子文件夹(“石头”，“纸”或“剪刀”)在一个数据文件夹，和加载器包读取相应的图像和标签的基础上的子文件夹名称。</p><p id="7682" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">让我们看看不同之处</p><p id="fcf6" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">喀拉斯</strong>:</p><figure class="ls lt lu lv gt lw gh gi paragraph-image"><div role="button" tabindex="0" class="lx ly di lz bf ma"><div class="gh gi lr"><img src="../Images/f3465a61b87f08e741da20aa15914df2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BPp_jOQC9MEXKjSFaYT_Iw.png"/></div></div></figure><p id="4832" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">还有<strong class="js iu">火炬</strong>:</p><figure class="ls lt lu lv gt lw gh gi paragraph-image"><div role="button" tabindex="0" class="lx ly di lz bf ma"><div class="gh gi mc"><img src="../Images/ee8d85691803ecae8ba3799797e3dbb9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*x9MqwKV3l9lKppKT8u1wPQ.png"/></div></div></figure><p id="4827" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果你马上想到 Keras 的 ImageDataGenerator 看起来更加用户友好，呈现更加整洁，那你就对了。它用目标张量形状以直观的方式处理图像大小调整。另一方面，Torch 使用“中心裁剪”和“调整大小”等术语来分别表示高度和宽度。</p><p id="17a7" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu"> 2。神经网络架构</strong></p><p id="ef71" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">Keras 作为一个包装器在 Tensorflow 后端做了很多繁重的工作。它越来越受欢迎的一个原因是由于它的顺序功能，你可以在“阶段”添加你的输入，隐藏和输出层。</p><p id="1f07" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我使用大致相同的架构重建了相同的 CNN 模型(唯一的例外是辍学率)。</p><p id="cf8a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu"> Keras </strong>脚本:</p><figure class="ls lt lu lv gt lw gh gi paragraph-image"><div role="button" tabindex="0" class="lx ly di lz bf ma"><div class="gh gi md"><img src="../Images/ec377d6e62784cd8cec925a83fb36308.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qRrLbWec0nsz-otz4M73bA.png"/></div></div></figure><p id="5541" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">vs <strong class="js iu">火炬</strong>:</p><figure class="ls lt lu lv gt lw gh gi paragraph-image"><div role="button" tabindex="0" class="lx ly di lz bf ma"><div class="gh gi me"><img src="../Images/65ce293190636268bb5f62a62ee05a33.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vBSxOYzifh8kJhNI94Kpng.png"/></div></div></figure><p id="68a8" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">Torch 要求你建立一个实际的类，所有的层都有相应的输出到每个连接的层。这在迫使用户适应从整体上思考神经网络架构方面是很棒的，但如果手动争论和寻找答案，这确实需要一点时间。</p><p id="84a7" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">一个明显的例子是在 Keras 和 Torch 之间后来的最终输出:</p><p id="959a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在 Keras 中，我们简单地使用一个 softmax 函数来获取模型为 3 个类生成的数值类:{'paper': 0，' rock': 1，'剪刀':2}。</p><p id="46a5" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">另一方面，在 Torch 中，在将最终输出传递给具有张量大小和 3 个 out_channels 的线性函数之前，我们必须通过 out=out.view(out.size(0)，-1)将最终输出处理为 soft max“like”函数。迷茫？我也是！你可能会认为火炬会自动重塑 conv2 函数中的张量，但可惜事实并非如此。</p><p id="792e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu"> 3。训练:</strong></p><p id="ccb2" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu"> Keras </strong>使用标准的“<em class="mf">model . fit”</em>函数，熟悉很多机器学习模型:</p><figure class="ls lt lu lv gt lw gh gi paragraph-image"><div role="button" tabindex="0" class="lx ly di lz bf ma"><div class="gh gi mg"><img src="../Images/c8b154b9709c8430d88f223ffa9a2240.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Zxtbic5LTF5hAaDDaALiMA.png"/></div></div></figure><p id="60f3" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如此简单，干净，优雅，最少的大惊小怪。</p><p id="d8d9" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在<strong class="js iu">火炬</strong>中:</p><figure class="ls lt lu lv gt lw gh gi paragraph-image"><div role="button" tabindex="0" class="lx ly di lz bf ma"><div class="gh gi mh"><img src="../Images/357f3c713f5194eab19907a27b8270f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EdTzjIu1pZtew8axMvpp9A.png"/></div></div></figure><p id="4b5e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">实际上，你必须声明为网络供电所需的回路、清除梯度、计算损耗、训练步骤并测试精度。如果您喜欢灵活地分配自己的训练步骤和验证批次，并且非常擅长循环，Torch 绝对适合您。</p><p id="4caf" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">关于两种包装的想法</strong></p><p id="3352" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">老实说，我在 20 多分钟内就建立、训练并运行了这个 Keras 模型。相比之下，Torch 需要使用在线材料和课程来解决问题，特别是处理与读出的最终层的形状有关的输出张量。Torch 也有非常不直观的词汇来重塑图像大小，这需要在阅读文档后进行实验。</p><p id="c485" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">然而，Torch 确实迫使用户思考所有深度学习模型的根源:张量。人们必须始终考虑张量的形状、输入层、输出层的样子以及模型将产生的表达式。</p><p id="81d4" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果 torch 有一种方法来执行张量形状的迷你输出，或者有一种方法来预览连接层之间的输出，我认为用户会更愿意尝试一下 Torch。</p><p id="a8e9" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">描述 torch 的最佳方式就像是玩一个类似 Darksouls 或 Sekiro 的软游戏:</p><figure class="ls lt lu lv gt lw gh gi paragraph-image"><div role="button" tabindex="0" class="lx ly di lz bf ma"><div class="gh gi mi"><img src="../Images/0dc8b45ecf10fb2e471ea3d125a42256.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Rp-Us7mNo-bpO9bSexf9GQ.png"/></div></div></figure><p id="44f2" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">…或者读尼采和德勒兹。</p><p id="8542" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">当你试图获得事物的机制时，这可能会令人沮丧，但是看到你的模型最终开始前馈和训练步骤的满足感是超越宣泄的。</p><p id="d50b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我将推荐的是，首先使用在线课程尝试 Torch，以获得所有的基础知识，然后使用 Keras 制作生产版本。</p><p id="0556" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">到目前为止，我已经看到了无数不同的训练步骤，作为一名编码人员，从中学习和产生想法是很棒的。正如 Keras 在包装器中为您做的繁重工作一样，为您自己的表达式调整代码的灵活性可能不存在。</p><p id="e986" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果您想查看 CNN Keras 版本的代码，请访问:</p><div class="ko kp gp gr kq kr"><a href="https://github.com/xijianlim/torch_and_keras/blob/master/CNN_RPS_torch.ipynb" rel="noopener  ugc nofollow" target="_blank"><div class="ks ab fo"><div class="kt ab ku cl cj kv"><h2 class="bd iu gy z fp kw fr fs kx fu fw is bi translated">西江林/火炬 _ 和 _ 喀拉斯</h2><div class="ky l"><h3 class="bd b gy z fp kw fr fs kx fu fw dk translated">在 GitHub 上创建一个帐户，为 xijianlim/torch_and_keras 的开发做出贡献。</h3></div><div class="kz l"><p class="bd b dl z fp kw fr fs kx fu fw dk translated">github.com</p></div></div><div class="la l"><div class="lh l lc ld le la lf lg kr"/></div></div></a></div></div></div>    
</body>
</html>