<html>
<head>
<title>Data Imputation to improve model performance</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">提高模型性能的数据插补</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/data-imputation-to-improve-model-performance-c4eb2a9954ad?source=collection_archive---------27-----------------------#2019-08-15">https://towardsdatascience.com/data-imputation-to-improve-model-performance-c4eb2a9954ad?source=collection_archive---------27-----------------------#2019-08-15</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="f386" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">最终是小步骤产生巨大的影响</h2></div><p id="31f5" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在执行任何机器学习项目时，数据插补是数据准备阶段的重要部分。用纯粹的统计学术语来说，它是一个用一些有意义的替代物代替缺失数据的过程。</p><p id="e506" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">例如，请看下面的样本数据，它是从 Kaggle 中选取的自动数据集的子集。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi le"><img src="../Images/e9741888897ccf7e87f6c1bade93c01c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1130/format:webp/1*TxO4bz060vGVeDKWp_A8Gw.png"/></div><figcaption class="lm ln gj gh gi lo lp bd b be z dk">Source: <a class="ae lq" href="https://www.kaggle.com/uciml/autompg-dataset" rel="noopener ugc nofollow" target="_blank">https://www.kaggle.com/uciml/autompg-dataset</a></figcaption></figure><p id="3817" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">有 6 行缺少马力特性的数据。所以作为数据准备阶段的一部分，我们需要去掉缺失的数据。</p><p id="02ee" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">有两种方法可以消除丢失的数据:</p><ol class=""><li id="96f9" class="lr ls it kk b kl km ko kp kr lt kv lu kz lv ld lw lx ly lz bi translated">我们可以从实际数据集中删除所有 6 行。</li><li id="2224" class="lr ls it kk b kl ma ko mb kr mc kv md kz me ld lw lx ly lz bi translated">为丢失的数据添加一些有意义的替代数据。</li></ol><p id="340e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">随便猜！！！哪种方法可以提高模型的准确性？保持你的好奇心，让我们来探索答案。</p><p id="6da7" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">是时候让我们的手接触代码，并找出哪一个在模型准确性方面更好。</p><p id="925a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">加载数据集:</p><pre class="lf lg lh li gt mf mg mh mi aw mj bi"><span id="64cb" class="mk ml it mg b gy mm mn l mo mp">auto_data = pd.read_csv('/kaggle/input/auto-mpg.data', delim_whitespace = True, header = None,<br/>                       names = [<br/>                                'mpg',<br/>                                'cylinders',<br/>                                'displacement',<br/>                                'horsepower',<br/>                                'weight',<br/>                                'aceeleration',<br/>                                'model',<br/>                                'origin',<br/>                                'car_name'<br/>    ])</span></pre><p id="d968" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">下面是数据集的样子:</p><pre class="lf lg lh li gt mf mg mh mi aw mj bi"><span id="98fb" class="mk ml it mg b gy mm mn l mo mp">auto_data.head()</span></pre><p id="c307" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">Out[4]:</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="mr ms di mt bf mu"><div class="gh gi mq"><img src="../Images/e48e55f1bc4d59e94e7b8e01140710ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ii_jrVb3l2s9YxxUUAbXQw.png"/></div></div></figure><p id="cf59" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们可以检查每一列的数据类型:</p><pre class="lf lg lh li gt mf mg mh mi aw mj bi"><span id="dfef" class="mk ml it mg b gy mm mn l mo mp">auto_data.info()</span></pre><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="mr ms di mt bf mu"><div class="gh gi mv"><img src="../Images/c7f0f2745975f828596f9ab8decf5e68.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*I24zsthPy5gjSD1_pzIYmw.png"/></div></div></figure><p id="2b53" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如您所见，马力列有数值，但数据类型为对象。所以稍微偏离一下主题，我们需要改变列的数据类型。</p><pre class="lf lg lh li gt mf mg mh mi aw mj bi"><span id="44a8" class="mk ml it mg b gy mm mn l mo mp">auto_data['horsepower'] = pd.to_numeric(auto_data['horsepower'], errors='coerce')</span><span id="ffa8" class="mk ml it mg b gy mw mn l mo mp">auto_data.info()</span></pre><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="mr ms di mt bf mu"><div class="gh gi mv"><img src="../Images/9fb415959aeed9cd853917f45201a2f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mP1TAgeWArgvY7KZYHg1fQ.png"/></div></div></figure><p id="4bb8" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">此外，car_name 特性并没有增加多少价值，因为在 398 行数据集中有 305 个唯一值。因此，为了简单起见，我们将从数据集中删除特征 car_name。</p><pre class="lf lg lh li gt mf mg mh mi aw mj bi"><span id="d45d" class="mk ml it mg b gy mm mn l mo mp">auto_data = auto_data.drop(['car_name'], axis=1)<br/>auto_data.head()</span></pre><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi mx"><img src="../Images/6ee0f2f811329836034dfeb0ae9a6b33.png" data-original-src="https://miro.medium.com/v2/resize:fit:1102/format:webp/1*ponHfRn3OxMYjpY1UWVgPg.png"/></div></figure><p id="4241" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在，我们都可以尝试这两种方法来处理缺失数据。</p><p id="4e81" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">首先，我们将删除马力特性缺少值的行，并评估模型性能指标。</p><pre class="lf lg lh li gt mf mg mh mi aw mj bi"><span id="709d" class="mk ml it mg b gy mm mn l mo mp">auto_data_final = auto_data.dropna(axis=0)<br/>auto_data_final[auto_data_final.isnull().any(axis=1)]</span></pre><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="mr ms di mt bf mu"><div class="gh gi my"><img src="../Images/689a872d927a34f4fef33b36b6a9f1e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*f3Qf9FUcclzO-CFyuVg5Wg.png"/></div></div></figure><p id="6e63" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">执行上述步骤后，我们已经成功地从数据集中删除了所有丢失的值。</p><p id="f6d0" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">下一步是将数据集分成训练/测试集，并进行模型训练。</p><pre class="lf lg lh li gt mf mg mh mi aw mj bi"><span id="5e99" class="mk ml it mg b gy mm mn l mo mp">from sklearn.model_selection import train_test_split<br/>from sklearn.svm import SVR</span><span id="1a86" class="mk ml it mg b gy mw mn l mo mp">X = auto_data_final.drop('mpg', axis=1)<br/>y = auto_data_final['mpg']</span><span id="1111" class="mk ml it mg b gy mw mn l mo mp">X_train, X_test, y_train, y_test = train_test_split(X, y, train_size=0.8, test_size=0.2, random_state =0)</span><span id="7d5c" class="mk ml it mg b gy mw mn l mo mp">model = SVR(kernel='linear', C=1.0)<br/>model.fit(X_train, y_train)</span></pre><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="mr ms di mt bf mu"><div class="gh gi mz"><img src="../Images/d734c155509217f9770750f9804e8a60.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wS9wjWmDyWGBzMcVgADDVQ.png"/></div></div></figure><p id="9a40" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这是捕捉模型训练的一些重要性能指标的好时机。</p><p id="66e2" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">获得预测的均方误差(MSE)。</p><pre class="lf lg lh li gt mf mg mh mi aw mj bi"><span id="c637" class="mk ml it mg b gy mm mn l mo mp">model.coef_</span></pre><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="mr ms di mt bf mu"><div class="gh gi na"><img src="../Images/6b658a01f3ace3d9ced4cd8f316432c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hp-Zw9FzpvZ-Oo0ZiIqnKg.png"/></div></div></figure><p id="7b10" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">获得对测试数据的预测:</p><pre class="lf lg lh li gt mf mg mh mi aw mj bi"><span id="0bc6" class="mk ml it mg b gy mm mn l mo mp">y_predict = model.predict(X_test)</span></pre><p id="7086" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">计算均方误差:</p><pre class="lf lg lh li gt mf mg mh mi aw mj bi"><span id="d7cd" class="mk ml it mg b gy mm mn l mo mp">from sklearn.metrics import mean_squared_error</span><span id="7505" class="mk ml it mg b gy mw mn l mo mp">model_mse = mean_squared_error(y_predict, y_test)<br/>print(model_mse)</span></pre><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="mr ms di mt bf mu"><div class="gh gi nb"><img src="../Images/6f7feb2715a80989fece85a3026f6888.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6RiZ5ArV8Sqa25V0PHg1-g.png"/></div></div></figure><p id="f08f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">将数字记在某处，我们将对处理缺失数据的第二种方法(即数据插补)重复相同的步骤。</p><p id="30ca" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">为清晰起见，让我们总结一下第一种方法中包含的所有步骤:</p><p id="823c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">a.已加载数据集。</p><p id="0b97" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">b.已将马力特征转换为数字。</p><p id="5521" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">c.已删除汽车名称功能。</p><p id="a3ff" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">d.删除所有丢失数据的行。</p><p id="63fc" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">e.将数据集分成训练/测试集。</p><p id="7c69" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">f.使用训练集训练模型。</p><p id="6a22" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">g.评估训练集和测试集上模型性能度量。</p><p id="36c1" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">对于方法 2(数据插补)，除步骤(d)外，我们需要重复上述所有步骤。步骤(d)将由几个子步骤代替。</p><p id="159a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">假设前 3 个步骤很容易重做，那么我们可以直接从步骤(d)替换开始。</p><p id="78a6" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">数据插补有多种方式，下面是其中一种。我们需要考虑到解释的方式并不完美，只是试图传达数据插补的重要性。</p><p id="d66b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">正如我们所知，完整数据集中只有 6 行缺少马力特性的数据。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi le"><img src="../Images/e9741888897ccf7e87f6c1bade93c01c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1130/format:webp/1*TxO4bz060vGVeDKWp_A8Gw.png"/></div><figcaption class="lm ln gj gh gi lo lp bd b be z dk">Source: <a class="ae lq" href="https://www.kaggle.com/uciml/autompg-dataset" rel="noopener ugc nofollow" target="_blank">https://www.kaggle.com/uciml/autompg-dataset</a></figcaption></figure><p id="eacc" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们可以寻找相关矩阵，并检查是否可以从现有特征中导出马力值。</p><pre class="lf lg lh li gt mf mg mh mi aw mj bi"><span id="23d8" class="mk ml it mg b gy mm mn l mo mp"># Check the correlation matrix to derive horsepower feature by help of other feature<br/>corr = auto_data.corr()<br/>corr.style.background_gradient(cmap='coolwarm').set_precision(4)</span></pre><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi nc"><img src="../Images/d6bedcd9c9e0ac24b93ea7d75b2f4a17.png" data-original-src="https://miro.medium.com/v2/resize:fit:1260/format:webp/1*B6fbRFEF_at5MhRgnPxHBQ.png"/></div></figure><p id="210c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">相关矩阵表明，马力特征与气缸、排量和重量等特征有很强的相关性。</p><p id="8713" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">为简单起见，我们将考虑气缸特性来推导马力特性下的所有缺失值。</p><p id="f12e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">丢失的数据行有 4 列或 6 列。因此，计划将实际数据集中所有行分别分组为 4/6 缸，然后得出马力特性任何缺失值。</p><pre class="lf lg lh li gt mf mg mh mi aw mj bi"><span id="ea52" class="mk ml it mg b gy mm mn l mo mp">auto_data_4_cylinders = auto_data[auto_data['cylinders'] ==4]<br/>print(len(auto_data_4_cylinders))<br/>auto_data_4_cylinders.head()</span></pre><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="mr ms di mt bf mu"><div class="gh gi na"><img src="../Images/8d815a812c3814f1d03ab1ed47a728c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bf2TswnxaHZnzc8eiFF9iQ.png"/></div></div></figure><p id="f819" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">绘制直方图以了解功能马力的数据分布:</p><pre class="lf lg lh li gt mf mg mh mi aw mj bi"><span id="f14a" class="mk ml it mg b gy mm mn l mo mp">%matplotlib inline</span><span id="94cc" class="mk ml it mg b gy mw mn l mo mp">auto_data_4_cylinders['horsepower'].plot.hist(bins=10, alpha=0.5)</span></pre><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="mr ms di mt bf mu"><div class="gh gi mz"><img src="../Images/8baa023a217323aa3bd15689dede5309.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*O84X4vEVn1ddH932jCV3-A.png"/></div></div></figure><p id="5afc" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">由于直方图似乎是正态分布，我们可以选择平均值作为我们的插补策略。</p><pre class="lf lg lh li gt mf mg mh mi aw mj bi"><span id="8310" class="mk ml it mg b gy mm mn l mo mp">import numpy as np<br/>from sklearn.impute import SimpleImputer</span><span id="9b98" class="mk ml it mg b gy mw mn l mo mp">imp_mean = SimpleImputer(missing_values=np.nan, strategy='mean')</span><span id="651a" class="mk ml it mg b gy mw mn l mo mp">auto_data_4_cylinders['horsepower'] = imp_mean.fit_transform(auto_data_4_cylinders[['horsepower']])</span></pre><p id="9049" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">检查是否已移除所有 NaN:</p><pre class="lf lg lh li gt mf mg mh mi aw mj bi"><span id="7539" class="mk ml it mg b gy mm mn l mo mp">auto_data_4_cylinders[auto_data_4_cylinders.isnull().any(axis=1)].head()</span></pre><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="mr ms di mt bf mu"><div class="gh gi nd"><img src="../Images/2cacecb8e2ae8bcc41564760489124dc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MLHD-_Kb3iJkYRpv9zpiJA.png"/></div></div></figure><p id="0b41" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">对 6 缸自动数据下的缺失数据重复相同的技术。</p><pre class="lf lg lh li gt mf mg mh mi aw mj bi"><span id="674d" class="mk ml it mg b gy mm mn l mo mp">auto_data_6_cylinders = auto_data[auto_data['cylinders']==6]<br/>auto_data_6_cylinders.head()</span></pre><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="mr ms di mt bf mu"><div class="gh gi ne"><img src="../Images/88ef35155fc4f9cd9da5b22430038d2f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jM-zeF6DbJwfQ--uteRVzw.png"/></div></div></figure><p id="ec38" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">绘制直方图以了解功能马力的数据分布:</p><pre class="lf lg lh li gt mf mg mh mi aw mj bi"><span id="107f" class="mk ml it mg b gy mm mn l mo mp">%matplotlib inline<br/>auto_data_6_cylinders['horsepower'].plot.hist(bins=10, alpha=0.5)</span></pre><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="mr ms di mt bf mu"><div class="gh gi nb"><img src="../Images/d80f224b960eb2d2d076394629ec9efd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*urEjKEN72cKX0CvoBRER1A.png"/></div></div></figure><p id="9d36" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">似乎如果我们从我们的数据集中排除 160，那么其余直方图将看起来像正态分布，我们可以选择平均值作为插补策略。</p><p id="b53f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">打印插补的目标行:</p><pre class="lf lg lh li gt mf mg mh mi aw mj bi"><span id="08ca" class="mk ml it mg b gy mm mn l mo mp">auto_data_6_cylinders[auto_data_6_cylinders.isnull().any(axis=1)].head()</span></pre><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="mr ms di mt bf mu"><div class="gh gi nf"><img src="../Images/c53239aef8ecfe74d47fdbac49eddabf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Puu6orxamyf4hEML8ST5vw.png"/></div></div></figure><p id="59d9" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在将插补策略应用于目标行:</p><pre class="lf lg lh li gt mf mg mh mi aw mj bi"><span id="0490" class="mk ml it mg b gy mm mn l mo mp">import numpy as np<br/>from sklearn.impute import SimpleImputer</span><span id="d671" class="mk ml it mg b gy mw mn l mo mp">mean_imp = SimpleImputer(missing_values=np.nan, strategy='mean')</span><span id="8983" class="mk ml it mg b gy mw mn l mo mp">mean_imp.fit(auto_data_6_cylinders[auto_data_6_cylinders['horsepower'] &lt; 160][['horsepower']])</span><span id="0ec9" class="mk ml it mg b gy mw mn l mo mp">auto_data_6_cylinders['horsepower'] = mean_imp.transform(auto_data_6_cylinders[['horsepower']])</span></pre><p id="8f72" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">检查是否已移除所有 NaN:</p><pre class="lf lg lh li gt mf mg mh mi aw mj bi"><span id="6923" class="mk ml it mg b gy mm mn l mo mp">auto_data_6_cylinders[auto_data_6_cylinders.isnull().any(axis=1)]</span></pre><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/786b7727dae8706074d05613eccab8d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1344/format:webp/1*eyD5PnXxMArvpjtuAZwTbw.png"/></div></figure><p id="b30a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">由于我们删除了所有 NaN，所以现在是时候将所有数据集合并在一起了。</p><pre class="lf lg lh li gt mf mg mh mi aw mj bi"><span id="e9fc" class="mk ml it mg b gy mm mn l mo mp">auto_data_others = auto_data[~auto_data['cylinders'].isin((4,6))]<br/>print(len(auto_data_others))</span><span id="b809" class="mk ml it mg b gy mw mn l mo mp">auto_data_final = pd.concat([auto_data_others, auto_data_4_cylinders, auto_data_6_cylinders], axis=0)<br/>print(len(auto_data_final))</span></pre><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="mr ms di mt bf mu"><div class="gh gi nh"><img src="../Images/d6e65ae8e6470244bbf8228a67b0f35c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FRtc4cD3TueZUnfdbrID4w.png"/></div></div></figure><p id="7d0b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">下一步是将数据集分成训练/测试集，并进行模型训练。</p><pre class="lf lg lh li gt mf mg mh mi aw mj bi"><span id="a9de" class="mk ml it mg b gy mm mn l mo mp">from sklearn.model_selection import train_test_split</span><span id="3138" class="mk ml it mg b gy mw mn l mo mp">X = auto_data_final.drop('mpg', axis=1)<br/>y = auto_data_final['mpg']</span><span id="c1b8" class="mk ml it mg b gy mw mn l mo mp">X_train, X_test, y_train, y_test = train_test_split(X, y, train_size=0.8, test_size=0.2, random_state =0)</span><span id="3c83" class="mk ml it mg b gy mw mn l mo mp">from sklearn.svm import SVR</span><span id="0bea" class="mk ml it mg b gy mw mn l mo mp">model = SVR(kernel='linear', C=1.0)<br/>model.fit(X_train, y_train)</span></pre><p id="c281" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在，我们将使用插补策略准备的数据来捕获模型再训练的一些重要性能指标。</p><pre class="lf lg lh li gt mf mg mh mi aw mj bi"><span id="aabd" class="mk ml it mg b gy mm mn l mo mp">model.coef_</span></pre><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="mr ms di mt bf mu"><div class="gh gi nh"><img src="../Images/4d92365e2bb63b78d2338f472f2f6f86.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*n1RAU0k3mooANbzr7tP3iA.png"/></div></div></figure><p id="61fd" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">获得预测的均方误差(MSE)。</p><pre class="lf lg lh li gt mf mg mh mi aw mj bi"><span id="9000" class="mk ml it mg b gy mm mn l mo mp">y_predict = model.predict(X_test)</span><span id="e96b" class="mk ml it mg b gy mw mn l mo mp">from sklearn.metrics import mean_squared_error</span><span id="796b" class="mk ml it mg b gy mw mn l mo mp">model_mse = mean_squared_error(y_predict, y_test)<br/>print(model_mse)</span></pre><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="mr ms di mt bf mu"><div class="gh gi nh"><img src="../Images/25dd35db4b5ef84b81055e2a1a523c20.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fw6DUXAMBvVXaXNvE-9fPQ.png"/></div></div></figure><p id="3ec3" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如我们所见，我们能够通过简单的数据插补技术最小化均方误差(MSE ),这是评估训练模型时的性能指标之一。</p><p id="7da1" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">所以回到方法的问题，我们可以说数据插补方法在给定的数据集上效果更好。</p><p id="a2a7" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">你可以参考下面 kaggle 上的笔记本以获得完整的代码示例:</p><div class="ni nj gp gr nk nl"><a href="https://www.kaggle.com/shshankar1/svm-for-linear-regression-predict-automobile-mpg" rel="noopener  ugc nofollow" target="_blank"><div class="nm ab fo"><div class="nn ab no cl cj np"><h2 class="bd iu gy z fp nq fr fs nr fu fw is bi translated">线性回归 SVM 预测汽车 MPG</h2><div class="ns l"><h3 class="bd b gy z fp nq fr fs nr fu fw dk translated">使用来自[私有数据集]的数据</h3></div><div class="nt l"><p class="bd b dl z fp nq fr fs nr fu fw dk translated">www.kaggle.com</p></div></div><div class="nu l"><div class="nv l nw nx ny nu nz lk nl"/></div></div></a></div></div></div>    
</body>
</html>