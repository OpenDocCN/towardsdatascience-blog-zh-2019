<html>
<head>
<title>PyTorch Deep Learning Template</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">PyTorch 深度学习模板</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/pytorch-deep-learning-template-6e638fc2fe64?source=collection_archive---------21-----------------------#2019-11-17">https://towardsdatascience.com/pytorch-deep-learning-template-6e638fc2fe64?source=collection_archive---------21-----------------------#2019-11-17</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><h1 id="6809" class="jq jr it bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">一个干净简单的模板来启动你的下一个 dl 项目🚀🚀</h1><p id="2d06" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">这里的模板是<a class="ae lm" href="https://github.com/FrancescoSaverioZuppichini/PyTorch-Deep-Learning-Template/tree/master" rel="noopener ugc nofollow" target="_blank">这里的</a></p><p id="c7ad" class="pw-post-body-paragraph ko kp it kq b kr ln kt ku kv lo kx ky kz lp lb lc ld lq lf lg lh lr lj lk ll im bi translated">在本文中，我们将向您展示一个基于 Pytorch 的深度学习模板。这个模板旨在让你更容易用 PyTorch 开始一个新的深度学习计算机视觉项目。主要特点是:</p><ul class=""><li id="f8dc" class="ls lt it kq b kr ln kv lo kz lu ld lv lh lw ll lx ly lz ma bi translated">模块化:我们将每个逻辑块分成不同的 python 子模块</li><li id="db74" class="ls lt it kq b kr mb kv mc kz md ld me lh mf ll lx ly lz ma bi translated">数据扩充:我们包括了<a class="ae lm" href="https://imgaug.readthedocs.io/en/latest/" rel="noopener ugc nofollow" target="_blank">伊姆高格</a></li><li id="4367" class="ls lt it kq b kr mb kv mc kz md ld me lh mf ll lx ly lz ma bi translated">蓄势待发:通过使用类似 Keras 的框架<a class="ae lm" href="https://pypi.org/project/Poutyne/" rel="noopener ugc nofollow" target="_blank"> poutyne </a>，你不必编写任何 train 循环。</li><li id="77ca" class="ls lt it kq b kr mb kv mc kz md ld me lh mf ll lx ly lz ma bi translated"><a class="ae lm" href="https://github.com/sksq96/pytorch-summary" rel="noopener ugc nofollow" target="_blank">火炬摘要</a>展示您的模型摘要</li><li id="cb99" class="ls lt it kq b kr mb kv mc kz md ld me lh mf ll lx ly lz ma bi translated">在稳定期降低学习率</li><li id="1a94" class="ls lt it kq b kr mb kv mc kz md ld me lh mf ll lx ly lz ma bi translated">自动保存最佳模型</li><li id="054e" class="ls lt it kq b kr mb kv mc kz md ld me lh mf ll lx ly lz ma bi translated">用<a class="ae lm" href="https://www.comet.ml/" rel="noopener ugc nofollow" target="_blank">彗星</a>进行实验跟踪</li></ul><h1 id="1fc5" class="jq jr it bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">动机</h1><p id="0c08" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">让我们面对它，通常，数据科学家不是软件工程师，他们通常以意大利面条代码结束，大部分时间在一个大的不可用的木星笔记本上。有了这个 repo，你已经提出了一个清晰的例子，说明你的代码应该如何拆分和模块化，以使可伸缩性和可共享性成为可能。在这个例子中，我们将尝试对达斯·维德和卢克·天行者进行分类。我们用谷歌图片收集了每个班级 100 张图片。数据集在这里是<a class="ae lm" href="https://drive.google.com/open?id=1LyHJxUVjOgDIgGJL4MnDhA10xjejWuw7" rel="noopener ugc nofollow" target="_blank">这里是</a>。你只需要在这个文件夹中精确它并运行 main.py。我们正在微调 resnet18，它应该能够在 5/10 个周期内达到 90%的准确性。</p><p id="40d4" class="pw-post-body-paragraph ko kp it kq b kr ln kt ku kv lo kx ky kz lp lb lc ld lq lf lg lh lr lj lk ll im bi translated">模板在<code class="fe mg mh mi mj b">./template</code>里面。</p><p id="d71c" class="pw-post-body-paragraph ko kp it kq b kr ln kt ku kv lo kx ky kz lp lb lc ld lq lf lg lh lr lj lk ll im bi translated"><strong class="kq iu">我们强烈建议使用模板</strong></p><h1 id="584f" class="jq jr it bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">保持你的结构干净简洁</h1><p id="15eb" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">每个深度学习项目至少有三个主要步骤:</p><ul class=""><li id="21f7" class="ls lt it kq b kr ln kv lo kz lu ld lv lh lw ll lx ly lz ma bi translated">数据收集/处理</li><li id="459b" class="ls lt it kq b kr mb kv mc kz md ld me lh mf ll lx ly lz ma bi translated">建模</li><li id="f9e2" class="ls lt it kq b kr mb kv mc kz md ld me lh mf ll lx ly lz ma bi translated">培训/评估</li></ul><p id="9ddc" class="pw-post-body-paragraph ko kp it kq b kr ln kt ku kv lo kx ky kz lp lb lc ld lq lf lg lh lr lj lk ll im bi translated">一个好主意是将所有路径存储在一个感兴趣的位置，例如数据集文件夹，存储在一个共享类中，该文件夹中的任何人都可以访问它。你不应该硬编码任何路径，总是定义一次并导入它们。所以，如果你以后改变你的结构，你只需要修改一个文件。如果我们看一下<code class="fe mg mh mi mj b">Project.py</code>，我们可以看到我们是如何一劳永逸地定义了<code class="fe mg mh mi mj b">data_dir</code>和<code class="fe mg mh mi mj b">checkpoint_dir</code>。我们正在使用“新的”<a class="ae lm" href="https://docs.python.org/3/library/pathlib.html" rel="noopener ugc nofollow" target="_blank">路径</a>API，它支持开箱即用的不同操作系统，并且还使加入和连接路径变得更加容易。</p><figure class="ml mm mn mo gt mp gh gi paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="gh gi mk"><img src="../Images/4867640df5ca234a9dfbc50efd5e644d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*TYBh33kAXdm7dJrJ.png"/></div></div></figure><p id="73d2" class="pw-post-body-paragraph ko kp it kq b kr ln kt ku kv lo kx ky kz lp lb lc ld lq lf lg lh lr lj lk ll im bi translated">例如，如果我们想知道数据位置，我们可以:</p><pre class="ml mm mn mo gt mw mj mx my aw mz bi"><span id="0116" class="na jr it mj b gy nb nc l nd ne">from Project import project<br/>print(projct.data_dir) # /foo/baa/…/dataset</span></pre><p id="7ff0" class="pw-post-body-paragraph ko kp it kq b kr ln kt ku kv lo kx ky kz lp lb lc ld lq lf lg lh lr lj lk ll im bi translated">在<code class="fe mg mh mi mj b">data</code>包中，您可以定义自己的数据集，一如既往地通过子类化<code class="fe mg mh mi mj b">torch.data.utils.Dataset</code>，公开转换和实用程序来处理您的数据。在我们的例子中，我们直接使用了来自<code class="fe mg mh mi mj b">torchvision</code>的<code class="fe mg mh mi mj b">ImageDataset</code>，但是我们在<code class="fe mg mh mi mj b">/data/MyDataset</code>中包含了一个定制<code class="fe mg mh mi mj b">Dataset</code>的框架</p><h1 id="4539" class="jq jr it bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">转换</h1><p id="b76f" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">您通常需要对数据进行一些预处理，例如调整图像大小和应用数据扩充。你所有的转变都应该在<code class="fe mg mh mi mj b">.data.trasformation</code>里面。在我们的模板中，我们包含了一个<a class="ae lm" href="https://imgaug.readthedocs.io/en/latest/" rel="noopener ugc nofollow" target="_blank"> imgaug </a>的包装器</p><figure class="ml mm mn mo gt mp gh gi paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="gh gi mk"><img src="../Images/38b292c168916a925eb0b27af09ffaf4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*AFxEb9HRhh9LJO9W.png"/></div></div></figure><h1 id="de58" class="jq jr it bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">数据加载器</h1><p id="db69" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">如您所知，您必须创建一个<code class="fe mg mh mi mj b">Dataloader</code>来将您的数据输入到模型中。在<code class="fe mg mh mi mj b">data.__init__.py</code>文件中，我们公开了一个非常简单的函数<code class="fe mg mh mi mj b">get_dataloaders</code>，使用几个参数自动配置<em class="nf">训练、val 和测试</em>数据加载器</p><figure class="ml mm mn mo gt mp gh gi paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="gh gi mk"><img src="../Images/052b4b7f655844c23c058e39fa4e7e34.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*fOdkaP0kDmq1PCjE.png"/></div></div></figure><p id="d5b7" class="pw-post-body-paragraph ko kp it kq b kr ln kt ku kv lo kx ky kz lp lb lc ld lq lf lg lh lr lj lk ll im bi translated">你所有的模型都在<code class="fe mg mh mi mj b">models</code>里面，在我们的例子中，我们有一个非常基本的 cnn，我们覆盖<code class="fe mg mh mi mj b">resnet18</code>函数来提供一个冻结的模型来微调。</p><figure class="ml mm mn mo gt mp gh gi paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="gh gi ng"><img src="../Images/7daf049483fd87e43a7289636a75357a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*SOZr_z4eWnZzjMFz"/></div></div></figure><p id="3663" class="pw-post-body-paragraph ko kp it kq b kr ln kt ku kv lo kx ky kz lp lb lc ld lq lf lg lh lr lj lk ll im bi translated">在我们的例子中，我们保持事情简单，所有的训练和评估逻辑都在<code class="fe mg mh mi mj b">.main.py</code>中，我们使用<a class="ae lm" href="https://pypi.org/project/Poutyne/" rel="noopener ugc nofollow" target="_blank"> poutyne </a>作为主库。我们已经定义了一个有用的回调列表:</p><ul class=""><li id="d1fd" class="ls lt it kq b kr ln kv lo kz lu ld lv lh lw ll lx ly lz ma bi translated">学习率调度程序</li><li id="b904" class="ls lt it kq b kr mb kv mc kz md ld me lh mf ll lx ly lz ma bi translated">最佳模型的自动保存</li><li id="d87e" class="ls lt it kq b kr mb kv mc kz md ld me lh mf ll lx ly lz ma bi translated">通常提前停止，这就是你所需要的！</li></ul><figure class="ml mm mn mo gt mp gh gi paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="gh gi nh"><img src="../Images/698fbe0ffeffbea20504bb4a9f161180.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*E8ccwGfMj0ZhNk-8"/></div></div></figure><h1 id="ec4e" class="jq jr it bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">追踪你的实验</h1><p id="ad8b" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">我们使用<a class="ae lm" href="https://www.comet.ml/" rel="noopener ugc nofollow" target="_blank">彗星</a>来自动跟踪我们模型的结果。这是慧星的板子运行了几个模型后的样子。</p><figure class="ml mm mn mo gt mp gh gi paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="gh gi ni"><img src="../Images/ff18b4d03fd48fda02a840e0f6e0be3f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*KuU6geIztk7b3P7s"/></div></div></figure><p id="dcf5" class="pw-post-body-paragraph ko kp it kq b kr ln kt ku kv lo kx ky kz lp lb lc ld lq lf lg lh lr lj lk ll im bi translated">运行<code class="fe mg mh mi mj b">main.py</code>产生以下输出:</p><figure class="ml mm mn mo gt mp gh gi paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="gh gi nj"><img src="../Images/d88dfec9849ad759848082a9390f60b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*TEzwfa2oIcPsIRSB"/></div></div></figure><p id="54c2" class="pw-post-body-paragraph ko kp it kq b kr ln kt ku kv lo kx ky kz lp lb lc ld lq lf lg lh lr lj lk ll im bi translated">我们还创建了不同的工具函数来绘制展位数据集和数据加载器。他们在<code class="fe mg mh mi mj b">utils.py</code>。例如，在我们的 train 和 val 数据集上调用<code class="fe mg mh mi mj b">show_dl</code>会产生以下输出。</p><figure class="ml mm mn mo gt mp gh gi paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="gh gi nk"><img src="../Images/f0e953835f807020f078ec2304143088.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*gXALJF4y4wiDppck"/></div></div></figure><figure class="ml mm mn mo gt mp gh gi paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="gh gi nl"><img src="../Images/d8376bd90b5d9f3fa8c38b714e804f3c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*QWYjydPzhDPCBGY-"/></div></div></figure><p id="efc7" class="pw-post-body-paragraph ko kp it kq b kr ln kt ku kv lo kx ky kz lp lb lc ld lq lf lg lh lr lj lk ll im bi translated">正如你所看到的，数据扩充被正确地应用在训练集上。</p><p id="e1c4" class="pw-post-body-paragraph ko kp it kq b kr ln kt ku kv lo kx ky kz lp lb lc ld lq lf lg lh lr lj lk ll im bi translated">这里的代码是<a class="ae lm" href="https://github.com/FrancescoSaverioZuppichini/PyTorch-Deep-Learning-Template/tree/master" rel="noopener ugc nofollow" target="_blank">这里是</a></p><h1 id="592b" class="jq jr it bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">结论</h1><p id="3103" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">我希望你能找到一些有用的信息，希望这个模板能对你下一个令人惊叹的项目有所帮助:)</p><p id="45c1" class="pw-post-body-paragraph ko kp it kq b kr ln kt ku kv lo kx ky kz lp lb lc ld lq lf lg lh lr lj lk ll im bi translated">如果你有什么改进的想法/建议，请告诉我。</p><p id="79b8" class="pw-post-body-paragraph ko kp it kq b kr ln kt ku kv lo kx ky kz lp lb lc ld lq lf lg lh lr lj lk ll im bi translated">您可能也会发现这些文章很有趣:</p><div class="nm nn gp gr no np"><a rel="noopener follow" target="_blank" href="/a-journey-into-convolutional-neural-network-visualization-1abc71605209"><div class="nq ab fo"><div class="nr ab ns cl cj nt"><h2 class="bd iu gy z fp nu fr fs nv fu fw is bi translated">卷积神经网络可视化之旅</h2><div class="nw l"><h3 class="bd b gy z fp nu fr fs nv fu fw dk translated">弗朗西斯科·萨维里奥·祖皮奇尼</h3></div><div class="nx l"><p class="bd b dl z fp nu fr fs nv fu fw dk translated">towardsdatascience.com</p></div></div><div class="ny l"><div class="nz l oa ob oc ny od mu np"/></div></div></a></div><p id="a61f" class="pw-post-body-paragraph ko kp it kq b kr ln kt ku kv lo kx ky kz lp lb lc ld lq lf lg lh lr lj lk ll im bi translated"><a class="ae lm" rel="noopener" target="_blank" href="/pytorch-how-and-when-to-use-module-sequential-modulelist-and-moduledict-7a54597b5f17">https://towardsdatascience . com/py torch-how-and-when-use-module-sequential-modulelist-and-module prediction-7a 54597 b5 f17</a></p><p id="430e" class="pw-post-body-paragraph ko kp it kq b kr ln kt ku kv lo kx ky kz lp lb lc ld lq lf lg lh lr lj lk ll im bi translated">感谢您的阅读。</p></div></div>    
</body>
</html>