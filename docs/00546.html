<html>
<head>
<title>Deploy your machine learning models with tensorflow serving and kubernetes</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">ä½¿ç”¨ tensorflow æœåŠ¡å’Œ kubernetes éƒ¨ç½²æ‚¨çš„æœºå™¨å­¦ä¹ æ¨¡å‹</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://towardsdatascience.com/deploy-your-machine-learning-models-with-tensorflow-serving-and-kubernetes-9d9e78e569db?source=collection_archive---------6-----------------------#2019-01-25">https://towardsdatascience.com/deploy-your-machine-learning-models-with-tensorflow-serving-and-kubernetes-9d9e78e569db?source=collection_archive---------6-----------------------#2019-01-25</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/2a06a82376205f742abdfd8296255fef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JbRs8n8Vm3xsyhuHD4GuFg.png"/></div></div></figure><p id="230c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">æœºå™¨å­¦ä¹ åº”ç”¨æ­£åœ¨è“¬å‹ƒå‘å±•ï¼Œä½†æ•°æ®å·¥ç¨‹å¸ˆæ²¡æœ‰å¾ˆå¤šå·¥å…·å¯ä»¥å°†è¿™äº›å¼ºå¤§çš„æ¨¡å‹é›†æˆåˆ°ç”Ÿäº§ç³»ç»Ÿä¸­ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘å°†è®¨è®º tensorflow-serving å¦‚ä½•å¸®åŠ©æ‚¨åœ¨äº§å“ä¸­åŠ é€Ÿäº¤ä»˜æ¨¡å‹ã€‚è¿™ç¯‡åšæ–‡æ˜¯å…³äºæœåŠ¡æœºå™¨å­¦ä¹ æ¨¡å‹çš„â€” <em class="kw">ä»€ä¹ˆæ„æ€ï¼Ÿ</em></p><blockquote class="kx ky kz"><p id="17b1" class="jy jz kw ka b kb kc kd ke kf kg kh ki la kk kl km lb ko kp kq lc ks kt ku kv ij bi translated">æœåŠ¡æ˜¯ä½ å¦‚ä½•åœ¨è®­ç»ƒååº”ç”¨ä¸€ä¸ª ML æ¨¡å‹â€”â€”ä»äº‹ tensorflow æœåŠ¡çš„ Noah Fiedel è½¯ä»¶å·¥ç¨‹å¸ˆ</p></blockquote></div><div class="ab cl ld le hu lf" role="separator"><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li"/></div><div class="ij ik il im in"><p id="3e23" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">ä¸ºäº†è¯´æ˜<a class="ae lk" href="https://www.tensorflow.org/serving/" rel="noopener ugc nofollow" target="_blank"> tensorflow æœåŠ¡äº</a>çš„èƒ½åŠ›ï¼Œæˆ‘å°†ä»‹ç»æœåŠ¡äºå¯¹è±¡æ£€æµ‹æ¨¡å‹çš„æ­¥éª¤ã€‚åœ¨æˆ‘çš„ GitHub ä¸Šæ‰¾åˆ°ä¸æœ¬æ–‡ç›¸å…³çš„æ‰€æœ‰ä»£ç :<a class="ae lk" href="https://github.com/fpaupier/tensorflow-serving_sidecar" rel="noopener ugc nofollow" target="_blank">https://github.com/fpaupier/tensorflow-serving_sidecar</a></p><figure class="lm ln lo lp gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ll"><img src="../Images/20aaa4c94e282d0a161b651fcf83f1d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*u1gb4jbIjJmeNDxtkONWXA.png"/></div></div><figcaption class="lq lr gj gh gi ls lt bd b be z dk">Summary of a machine learning pipeline â€” here we focus on serving the model</figcaption></figure><p id="6bd0" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><em class="kw">å¼ é‡æµç®€è€Œè¨€ä¹‹</em></p><p id="ac24" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">Tensorflow æœåŠ¡ä½¿æ‚¨èƒ½å¤Ÿæ— ç¼åœ°æœåŠ¡äºæ‚¨çš„æœºå™¨å­¦ä¹ æ¨¡å‹ã€‚</p><ul class=""><li id="361a" class="lu lv iq ka b kb kc kf kg kj lw kn lx kr ly kv lz ma mb mc bi translated">éƒ¨ç½²æ–°ç‰ˆæœ¬çš„æ¨¡å‹ï¼Œè®© tensorflow æœåŠ¡ä¼˜é›…åœ°å®Œæˆå½“å‰è¯·æ±‚ï¼ŒåŒæ—¶å¼€å§‹ä½¿ç”¨æ–°æ¨¡å‹æœåŠ¡æ–°è¯·æ±‚ã€‚</li><li id="29af" class="lu lv iq ka b kb md kf me kj mf kn mg kr mh kv lz ma mb mc bi translated">åˆ†å¼€è€ƒè™‘ï¼Œæ•°æ®ç§‘å­¦å®¶å¯ä»¥ä¸“æ³¨äºæ„å»ºå‡ºè‰²çš„æ¨¡å‹ï¼Œè€Œè¿è¥éƒ¨é—¨åˆ™å¯ä»¥ä¸“æ³¨äºæ„å»ºå¯æœåŠ¡äºè¿™äº›æ¨¡å‹çš„é«˜åº¦çµæ´»ä¸”å¯æ‰©å±•çš„æ¶æ„ã€‚</li></ul></div><div class="ab cl ld le hu lf" role="separator"><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li"/></div><div class="ij ik il im in"><h1 id="eee1" class="mi mj iq bd mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf bi translated">ç¬¬ 1 éƒ¨åˆ†â€”é¢„çƒ­:è®¾ç½®æœ¬åœ° tensorflow æœåŠ¡å™¨</h1><p id="e033" class="pw-post-body-paragraph jy jz iq ka b kb ng kd ke kf nh kh ki kj ni kl km kn nj kp kq kr nk kt ku kv ij bi translated">åœ¨ä¸Šçº¿ä¹‹å‰ï¼Œæœ€å¥½ç¡®ä¿ä½ çš„æœåŠ¡å™¨åœ¨æœ¬åœ°å·¥ä½œã€‚æˆ‘åœ¨è¿™é‡Œç»™å‡ºäº†å¤§çš„æ­¥éª¤ï¼Œåœ¨é¡¹ç›®<code class="fe nl nm nn no b">readme</code>ä¸­æ‰¾åˆ°æ›´å¤šçš„æ–‡æ¡£ã€‚<br/> <a class="ae lk" href="https://github.com/fpaupier/tensorflow-serving_sidecar/blob/master/docs/setup.md" rel="noopener ugc nofollow" target="_blank">çœ‹çœ‹è®¾ç½®æ­¥éª¤</a>ä»¥ç¡®ä¿æ‚¨èƒ½ä»æœ¬æ•™ç¨‹ä¸­è·å¾—æœ€å¤§æ”¶ç›Š:</p><ol class=""><li id="6fb0" class="lu lv iq ka b kb kc kf kg kj lw kn lx kr ly kv np ma mb mc bi translated">git å…‹éš†<a class="ae lk" href="https://github.com/fpaupier/tensorflow-serving_sidecar" rel="noopener ugc nofollow" target="_blank">https://github.com/fpaupier/tensorflow-serving_sidecar</a>ï¼Œåˆ›å»º python3.6.5 è™šæ‹Ÿç¯å¢ƒå¹¶å®‰è£…<code class="fe nl nm nn no b">requirements.txt</code></li><li id="f197" class="lu lv iq ka b kb md kf me kj mf kn mg kr mh kv np ma mb mc bi translated">è·å– tensorflow æœåŠ¡ docker å›¾ç‰‡<code class="fe nl nm nn no b">docker pull tensorflow/serving</code></li><li id="cfed" class="lu lv iq ka b kb md kf me kj mf kn mg kr mh kv np ma mb mc bi translated">å¾—åˆ°ä¸€ä¸ªæ¨¡å‹æ¥æœåŠ¡â†’æˆ‘ç”¨è¿™ä¸ªï¼Œå®ƒæ‰§è¡Œå¯¹è±¡æ£€æµ‹<a class="ae lk" href="http://download.tensorflow.org/models/object_detection/faster_rcnn_resnet101_coco_2018_01_28.tar.gz" rel="noopener ugc nofollow" target="_blank">æ›´å¿« _rcnn_resnet101_coco </a></li><li id="ec97" class="lu lv iq ka b kb md kf me kj mf kn mg kr mh kv np ma mb mc bi translated">è½¬åˆ°æ¨¡å‹ç›®å½•ï¼Œç”¨ç‰ˆæœ¬å·é‡å‘½å<code class="fe nl nm nn no b">saved model</code>å­ç›®å½•ï¼Œå› ä¸ºæˆ‘ä»¬åœ¨è¿™é‡Œåšçš„æ˜¯ v1ï¼Œè®©æˆ‘ä»¬ç§°å®ƒä¸º<code class="fe nl nm nn no b">00001</code>(å®ƒå¿…é¡»æ˜¯æ•°å­—)ã€‚æˆ‘ä»¬è¿™æ ·åšæ˜¯å› ä¸º tensorflow serving docker image åœ¨æœç´¢è¦æä¾›çš„æ¨¡å‹æ—¶ä¼šæœç´¢ä»¥è¯¥çº¦å®šå‘½åçš„æ–‡ä»¶å¤¹ã€‚</li><li id="fcfa" class="lu lv iq ka b kb md kf me kj mf kn mg kr mh kv np ma mb mc bi translated">ç°åœ¨è¿è¡Œ tensorflow æœåŠ¡å™¨:</li></ol><pre class="lm ln lo lp gt nq no nr ns aw nt bi"><span id="e26e" class="nu mj iq no b gy nv nw l nx ny"># From tensorflow-serving_sidecar/<br/>docker run -t --rm -p 8501:8501 \<br/>   -v "$(pwd)/data/faster_rcnn_resnet101_coco_2018_01_28:/models/faster_rcnn_resnet" \<br/>   -e MODEL_NAME=faster_rcnn_resnet \<br/>   tensorflow/serving &amp;</span></pre><p id="893c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">åœ¨ç»§ç»­ä¹‹å‰ï¼Œè¯·æ³¨æ„:</p><figure class="lm ln lo lp gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nz"><img src="../Images/72752a00c433b785e6113df364fc500e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oCzPBR-ZYFGoKHCBEBhgag.jpeg"/></div></div><figcaption class="lq lr gj gh gi ls lt bd b be z dk">docker -v arg in our use case</figcaption></figure><p id="1046" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">è¿™é‡Œæˆ‘ä»¬ç»‘å®šäº†å®¹å™¨çš„ç«¯å£å’Œæœ¬åœ°ä¸»æœºã€‚å› æ­¤ï¼Œå½“æˆ‘ä»¬åœ¨<code class="fe nl nm nn no b">localhost:8501</code>ä¸Šè°ƒç”¨æ¨æ–­æ—¶ï¼Œæˆ‘ä»¬å®é™…ä¸Šå°†è°ƒç”¨ tensorflow æœåŠ¡å™¨ã€‚</p><p id="31fd" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">æ‚¨è¿˜ä¼šæ³¨æ„åˆ°æˆ‘ä»¬å°†æœ¬åœ°ä¸»æœºç›®å½•<code class="fe nl nm nn no b">faster_rcnn_resnet101_coco_2018_01_28</code>â€”â€”å­˜å‚¨æ¨¡å‹çš„åœ°æ–¹â€”â€”ä¸å®¹å™¨<code class="fe nl nm nn no b">/models/faster_rcnn_resnet</code>è·¯å¾„é“¾æ¥èµ·æ¥ã€‚</p><p id="30ed" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">è¯·è®°ä½ï¼Œæ­¤æ—¶<code class="fe nl nm nn no b">savedModel.pb</code>åªåœ¨æ‚¨çš„æœºå™¨ä¸Šï¼Œè€Œä¸åœ¨å®¹å™¨ä¸­ã€‚</p><p id="df05" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">6.æ‰§è¡Œå®¢æˆ·å‘¼å«:</p><pre class="lm ln lo lp gt nq no nr ns aw nt bi"><span id="4419" class="nu mj iq no b gy nv nw l nx ny"># Don't forget to activate your python3.6.5 venv<br/><br/># From tensorflow-serving_sidecar/<br/>python client.py --server_url "http://localhost:8501/v1/models/faster_rcnn_resnet:predict" \<br/>--image_path "$(pwd)/object_detection/test_images/image1.jpg" \<br/>--output_json "$(pwd)/object_detection/test_images/out_image1.json" \<br/>--save_output_image "True" \<br/>--label_map "$(pwd)/data/labels.pbtxt"</span></pre><p id="7f43" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">å»æŸ¥çœ‹<code class="fe nl nm nn no b">--output_json </code>æŒ‡å®šçš„è·¯å¾„ï¼Œäº«å—ç»“æœã€‚(æä¾› json å’Œ jpeg è¾“å‡º)</p><figure class="lm ln lo lp gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi oa"><img src="../Images/4c9dd8b370c77bdb8d8e1611362ce6e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1300/format:webp/1*7rMW1PVA7g6Sbh4w8xFtUg.jpeg"/></div></div><figcaption class="lq lr gj gh gi ls lt bd b be z dk">expected inference with our object detection model</figcaption></figure><p id="0bc3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">å¾ˆå¥½ï¼Œç°åœ¨æˆ‘ä»¬çš„æ¨¡å‹è¿è¡Œè‰¯å¥½ï¼Œè®©æˆ‘ä»¬å°†å®ƒéƒ¨ç½²åˆ°äº‘ä¸Šã€‚</p></div><div class="ab cl ld le hu lf" role="separator"><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li"/></div><div class="ij ik il im in"><h1 id="29ce" class="mi mj iq bd mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf bi translated">ç¬¬ 2 éƒ¨åˆ†â€”åœ¨å…·æœ‰ tensorflow æœåŠ¡çš„ kubernetes é›†ç¾¤ä¸ŠæœåŠ¡æ‚¨çš„æœºå™¨å­¦ä¹ åº”ç”¨ç¨‹åº</h1><p id="7a52" class="pw-post-body-paragraph jy jz iq ka b kb ng kd ke kf nh kh ki kj ni kl km kn nj kp kq kr nk kt ku kv ij bi translated">åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œæ‚¨å¸Œæœ›èƒ½å¤Ÿéšç€åº”ç”¨ç¨‹åºè´Ÿè½½çš„å¢åŠ è€Œæ‰©å±•ã€‚ä½ ä¸å¸Œæœ›ä½ çš„æœåŠ¡å™¨ä¸å ªé‡è´Ÿã€‚</p><figure class="lm ln lo lp gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ob"><img src="../Images/95aed95ad261b4b86fa833caa93e66d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Jx5Dj0s00JbFtMosWDB0Sw.png"/></div></div><figcaption class="lq lr gj gh gi ls lt bd b be z dk">An exhausted tensorflow server directly exposed over the network</figcaption></figure><p id="1655" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">ä¸ºäº†é¿å…è¿™ä¸ªé—®é¢˜ï¼Œæ‚¨å°†ä½¿ç”¨ kubernetes é›†ç¾¤æ¥æœåŠ¡æ‚¨çš„ tensorflow-server åº”ç”¨ç¨‹åºã€‚é¢„æœŸçš„ä¸»è¦æ”¹è¿›:</p><ul class=""><li id="0dd0" class="lu lv iq ka b kb kc kf kg kj lw kn lx kr ly kv lz ma mb mc bi translated">è´Ÿè½½å°†åœ¨æ‚¨çš„å‰¯æœ¬ä¹‹é—´å¹³è¡¡ï¼Œæ‚¨æ— éœ€è€ƒè™‘è¿™ä¸€ç‚¹ã€‚</li><li id="d20b" class="lu lv iq ka b kb md kf me kj mf kn mg kr mh kv lz ma mb mc bi translated">æ‚¨æ˜¯å¦å¸Œæœ›åœ¨ä¸åœæœºçš„æƒ…å†µä¸‹éƒ¨ç½²æ–°æ¨¡å‹ï¼Ÿæ²¡é—®é¢˜ï¼Œkubernetes æ”¯æŒä½ ã€‚æ‰§è¡Œæ»šåŠ¨æ›´æ–°ï¼Œé€æ­¥ä¸ºæ‚¨çš„æ–°æ¨¡å‹æä¾›æœåŠ¡ï¼ŒåŒæ—¶é€‚åº¦ç»ˆæ­¢æ—§æ¨¡å‹ä¸Šçš„å½“å‰è¯·æ±‚ã€‚</li></ul><figure class="lm ln lo lp gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi oc"><img src="../Images/1c417cc48a4de81d9aa09fe04b000d82.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SZ6-Iwo1fgraBQARcsCfqA.png"/></div></div><figcaption class="lq lr gj gh gi ls lt bd b be z dk">a tensorflow server application running on many replicas in a k8s cluster, ensuring high availability to users</figcaption></figure><p id="d0c8" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">æˆ‘ä»¬å¼€å§‹å§</strong></p><p id="c587" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">é¦–å…ˆï¼Œæˆ‘ä»¬æƒ³è¦åˆ›å»ºä¸€ä¸ªåµŒå…¥äº†å¯¹è±¡æ£€æµ‹æ¨¡å‹çš„å®Œæ•´ docker å›¾åƒã€‚ä¸€æ—¦å®Œæˆï¼Œæˆ‘ä»¬å°†åœ¨ kubernetes é›†ç¾¤ä¸Šéƒ¨ç½²å®ƒã€‚æˆ‘åœ¨<a class="ae lk" href="https://cloud.google.com/" rel="noopener ugc nofollow" target="_blank">è°·æ­Œäº‘å¹³å°</a>ä¸Šè¿è¡Œæˆ‘çš„ä¾‹å­ï¼Œå› ä¸ºå…è´¹å±‚ä½¿å¾—å…è´¹è¿è¡Œè¿™ä¸ªæ•™ç¨‹æˆä¸ºå¯èƒ½ã€‚ä¸ºäº†å¸®åŠ©ä½ åœ¨ GCP å»ºç«‹äº‘ç¯å¢ƒï¼Œä½ å¯ä»¥ç‚¹å‡»è¿™é‡ŒæŸ¥çœ‹æˆ‘çš„æ•™ç¨‹ã€‚</p><h2 id="999b" class="nu mj iq bd mk od oe dn mo of og dp ms kj oh oi mw kn oj ok na kr ol om ne on bi translated">åˆ›å»ºè‡ªå®šä¹‰ tensorflow æœåŠ¡ docker å›¾åƒ</h2><ol class=""><li id="0924" class="lu lv iq ka b kb ng kf nh kj oo kn op kr oq kv np ma mb mc bi translated">å°†æœåŠ¡æ˜ åƒä½œä¸ºå®ˆæŠ¤ç¨‹åºè¿è¡Œ:</li></ol><pre class="lm ln lo lp gt nq no nr ns aw nt bi"><span id="5df2" class="nu mj iq no b gy nv nw l nx ny">docker run -d --name serving_base tensorflow/serving</span></pre><p id="932a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">2.å°†<code class="fe nl nm nn no b">faster_rcnn_resnet101_coco</code>æ¨¡å‹æ•°æ®å¤åˆ¶åˆ°å®¹å™¨çš„<code class="fe nl nm nn no b">models/</code>æ–‡ä»¶å¤¹ä¸­:</p><pre class="lm ln lo lp gt nq no nr ns aw nt bi"><span id="91e2" class="nu mj iq no b gy nv nw l nx ny"># From tensorflow-serving_sidecar/<br/>docker cp $(pwd)/data/faster_rcnn_resnet101_coco_2018_01_28 serving_base:/models/faster_rcnn_resnet</span></pre><p id="5d39" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">3.æäº¤å®¹å™¨ä»¥æœåŠ¡äº<code class="fe nl nm nn no b">faster_rcnn_resnet</code>æ¨¡å‹:</p><pre class="lm ln lo lp gt nq no nr ns aw nt bi"><span id="ee22" class="nu mj iq no b gy nv nw l nx ny">docker commit --change "ENV MODEL_NAME faster_rcnn_resnet" serving_base faster_rcnn_resnet_serving</span></pre><p id="bdf5" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><em class="kw">æ³¨æ„:</em>å¦‚æœæ‚¨ä½¿ç”¨ä¸åŒçš„å‹å·ï¼Œç›¸åº”åœ°æ›´æ”¹<code class="fe nl nm nn no b">--change</code>å‚æ•°ä¸­çš„<code class="fe nl nm nn no b">faster_rcnn_resnet</code>ã€‚</p><p id="5c47" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><code class="fe nl nm nn no b">faster_rcnn_resnet_serving</code>å°†æˆä¸ºæˆ‘ä»¬æ–°çš„æœåŠ¡å½¢è±¡ã€‚æ‚¨å¯ä»¥é€šè¿‡è¿è¡Œ<code class="fe nl nm nn no b">docker images</code>æ¥æ£€æŸ¥è¿™ä¸€ç‚¹ï¼Œæ‚¨åº”è¯¥ä¼šçœ‹åˆ°ä¸€ä¸ªæ–°çš„ docker å›¾åƒ:</p><figure class="lm ln lo lp gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi or"><img src="../Images/75b310f8ff1895830118302330223e26.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NO7yue0KJ_apO8I9-X0_8g.png"/></div></div><figcaption class="lq lr gj gh gi ls lt bd b be z dk">docker images result after creating a custom tensorflow-serving image</figcaption></figure><p id="ad43" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">4.åœæ­¢æœåŠ¡åŸºæœ¬å®¹å™¨</p><pre class="lm ln lo lp gt nq no nr ns aw nt bi"><span id="aca2" class="nu mj iq no b gy nv nw l nx ny">docker kill serving_base<br/>docker rm serving_base</span></pre><p id="56ff" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">å¤ªå¥½äº†ï¼Œä¸‹ä¸€æ­¥æ˜¯æµ‹è¯•æˆ‘ä»¬å…¨æ–°çš„<code class="fe nl nm nn no b">faster_rcnn_resnet_serving </code>å½¢è±¡ã€‚</p><h2 id="e45e" class="nu mj iq bd mk od oe dn mo of og dp ms kj oh oi mw kn oj ok na kr ol om ne on bi translated">æµ‹è¯•å®šåˆ¶æœåŠ¡å™¨</h2><p id="d16e" class="pw-post-body-paragraph jy jz iq ka b kb ng kd ke kf nh kh ki kj ni kl km kn nj kp kq kr nk kt ku kv ij bi translated">åœ¨ kubernetes ä¸Šéƒ¨ç½²æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºä¹‹å‰ï¼Œè®©æˆ‘ä»¬ç¡®ä¿å®ƒæ­£å¸¸å·¥ä½œã€‚</p><ol class=""><li id="cd70" class="lu lv iq ka b kb kc kf kg kj lw kn lx kr ly kv np ma mb mc bi translated">å¯åŠ¨æœåŠ¡å™¨:</li></ol><pre class="lm ln lo lp gt nq no nr ns aw nt bi"><span id="6de4" class="nu mj iq no b gy nv nw l nx ny">docker run -p 8501:8501 -t faster_rcnn_resnet_serving &amp;</span></pre><p id="3a23" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><em class="kw">æ³¨æ„:</em>ç¡®ä¿æ‚¨å·²ç»åœæ­¢(<code class="fe nl nm nn no b">docker stop &lt;CONTAINER_NAME&gt;</code>)ä¹‹å‰è¿è¡Œçš„æœåŠ¡å™¨ï¼Œå¦åˆ™ç«¯å£<code class="fe nl nm nn no b">8501</code>å¯èƒ½ä¼šè¢«é”å®šã€‚</p><p id="4e45" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">2.æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ç›¸åŒçš„å®¢æˆ·ç«¯ä»£ç æ¥è°ƒç”¨æœåŠ¡å™¨ã€‚</p><pre class="lm ln lo lp gt nq no nr ns aw nt bi"><span id="8de9" class="nu mj iq no b gy nv nw l nx ny"># From tensorflow-serving_sidecar/<br/>python client.py --server_url "http://localhost:8501/v1/models/faster_rcnn_resnet:predict" \<br/>--image_path "$(pwd)/object_detection/test_images/image1.jpg" \<br/>--output_json "$(pwd)/object_detection/test_images/out_image2.json" \<br/>--save_output_image "True" \<br/>--label_map "$(pwd)/data/labels.pbtxt"</span></pre><p id="b6bf" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">æˆ‘ä»¬å¯ä»¥æ£€æŸ¥æˆ‘ä»¬æ˜¯å¦æœ‰ç›¸åŒçš„å¥½çš„ï¼Œç°åœ¨è®©æˆ‘ä»¬åœ¨<code class="fe nl nm nn no b">kubernetes</code>é›†ç¾¤ä¸Šè¿è¡Œå®ƒã€‚</p><h2 id="ecde" class="nu mj iq bd mk od oe dn mo of og dp ms kj oh oi mw kn oj ok na kr ol om ne on bi translated">åœ¨ kubernetes ä¸Šéƒ¨ç½²æˆ‘ä»¬çš„åº”ç”¨</h2><p id="2293" class="pw-post-body-paragraph jy jz iq ka b kb ng kd ke kf nh kh ki kj ni kl km kn nj kp kq kr nk kt ku kv ij bi translated">é™¤éä½ å·²ç»åœ¨ GCP ä¸Šè¿è¡Œäº†ä¸€ä¸ªé¡¹ç›®ï¼Œå¦åˆ™æˆ‘å»ºè®®ä½ æ£€æŸ¥ä¸€ä¸‹<a class="ae lk" href="https://github.com/fpaupier/tensorflow-serving_sidecar/blob/master/docs/gcp_setup.md" rel="noopener ugc nofollow" target="_blank">è°·æ­Œäº‘è®¾ç½®æ­¥éª¤</a>ã€‚</p><p id="343c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">æˆ‘å‡è®¾ä½ å·²ç»åˆ›å»ºå¹¶ç™»å½•äº†ä¸€ä¸ªåä¸º<code class="fe nl nm nn no b">tensorflow-serving</code>çš„<code class="fe nl nm nn no b">gcloud</code>é¡¹ç›®</p><p id="3002" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">æ‚¨å°†ä½¿ç”¨ä¹‹å‰æ„å»ºçš„å®¹å™¨æ˜ åƒ<code class="fe nl nm nn no b">faster_rcnn_resnet_serving</code>åœ¨<a class="ae lk" href="https://cloud.google.com/" rel="noopener ugc nofollow" target="_blank"> Google äº‘å¹³å°</a>ä¸­éƒ¨ç½²å¸¦æœ‰<a class="ae lk" href="https://kubernetes.io/" rel="noopener ugc nofollow" target="_blank"> Kubernetes </a>çš„æœåŠ¡é›†ç¾¤ã€‚</p><ol class=""><li id="8cd7" class="lu lv iq ka b kb kc kf kg kj lw kn lx kr ly kv np ma mb mc bi translated">ç™»å½•æ‚¨çš„é¡¹ç›®ï¼Œé¦–å…ˆç”¨<code class="fe nl nm nn no b">gcloud projects list</code>åˆ—å‡ºå¯ç”¨çš„é¡¹ç›®ï¼Œé€‰æ‹©é¡¹ç›®çš„<code class="fe nl nm nn no b">PROJECT_ID</code>å¹¶è¿è¡Œ</li></ol><pre class="lm ln lo lp gt nq no nr ns aw nt bi"><span id="241a" class="nu mj iq no b gy nv nw l nx ny"># Get the PROJECT_ID, not the name<br/>gcloud projects list </span><span id="6d04" class="nu mj iq no b gy os nw l nx ny"># Set the project with the right PROJECT_ID, i.e. for me it is tensorflow-serving-229609<br/>gcloud config set project tensorflow-serving-229609<br/>gcloud auth login</span></pre><p id="61eb" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">2.åˆ›å»ºä¸€ä¸ªå®¹å™¨é›†ç¾¤</p><ul class=""><li id="5af4" class="lu lv iq ka b kb kc kf kg kj lw kn lx kr ly kv lz ma mb mc bi translated">é¦–å…ˆï¼Œæˆ‘ä»¬ä¸ºæœåŠ¡éƒ¨ç½²åˆ›å»ºä¸€ä¸ª<a class="ae lk" href="https://cloud.google.com/container-engine/" rel="noopener ugc nofollow" target="_blank"> Google Kubernetes å¼•æ“</a>é›†ç¾¤ã€‚ç”±äºå…è´¹è¯•ç”¨çš„é™åˆ¶ï¼Œæ‚¨åœ¨è¿™é‡Œä¸èƒ½ä½¿ç”¨è¶…è¿‡ 2 ä¸ªèŠ‚ç‚¹ï¼Œæ‚¨å¯ä»¥å‡çº§æˆ–ä½¿ç”¨ä¸¤ä¸ªèŠ‚ç‚¹ï¼Œè¿™å¯¹æˆ‘ä»¬çš„ç”¨ä¾‹æ¥è¯´å·²ç»è¶³å¤Ÿå¥½äº†ã€‚åœ¨ä½ çš„å…è´¹è¯•ç”¨ä¸­ï¼Œä½ çš„é™é¢æ˜¯ 8 ä¸ª CPUã€‚)</li></ul><pre class="lm ln lo lp gt nq no nr ns aw nt bi"><span id="22ad" class="nu mj iq no b gy nv nw l nx ny">gcloud container clusters create faster-rcnn-serving-cluster --num-nodes 2 --zone 'us-east1'</span></pre><p id="82be" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">æ‚¨å¯ä»¥æ›´æ–°<code class="fe nl nm nn no b">zone</code> argï¼Œæ‚¨å¯ä»¥åœ¨<em class="kw">ä¸­é€‰æ‹©ï¼Œä¾‹å¦‚</em> : <code class="fe nl nm nn no b">europe-west1</code>ï¼Œ<code class="fe nl nm nn no b">asia-east1</code> -æ‚¨å¯ä»¥ä½¿ç”¨<code class="fe nl nm nn no b">gcloud compute zones list</code>æ£€æŸ¥æ‰€æœ‰å¯ç”¨çš„åŒºåŸŸã€‚ä½ åº”è¯¥æœ‰è¿™æ ·çš„ä¸œè¥¿:</p><figure class="lm ln lo lp gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ot"><img src="../Images/494904ca822443354cdcbc6179db50ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MXrZekqAqVIDQShZ-k7QrQ.png"/></div></div><figcaption class="lq lr gj gh gi ls lt bd b be z dk">kubernetes cluster creation output</figcaption></figure><p id="6859" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">3.ä¸º gcloud container å‘½ä»¤è®¾ç½®é»˜è®¤é›†ç¾¤ï¼Œå¹¶å°†é›†ç¾¤å‡­è¯ä¼ é€’ç»™<a class="ae lk" href="https://kubernetes.io/docs/reference/kubectl/overview/" rel="noopener ugc nofollow" target="_blank"> kubectl </a>ã€‚</p><pre class="lm ln lo lp gt nq no nr ns aw nt bi"><span id="1a8f" class="nu mj iq no b gy nv nw l nx ny">gcloud config set container/cluster faster-rcnn-serving-cluster<br/>gcloud container clusters get-credentials faster-rcnn-serving-cluster --zone 'us-east1'</span></pre><p id="1fd5" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">ä¹‹åæ‚¨åº”è¯¥ä¼šçœ‹åˆ°è¿™æ ·çš„å†…å®¹:</p><figure class="lm ln lo lp gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ou"><img src="../Images/f3579e4e6d0fc1e02ea538d6c7c88246.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fZ3THPtLIHBWvn6ca0kANA.png"/></div></div><figcaption class="lq lr gj gh gi ls lt bd b be z dk">gcloud container clusters get-credentials output</figcaption></figure><p id="724b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">4.ä¸Šä¼ æˆ‘ä»¬ä¹‹å‰æ„å»ºçš„è‡ªå®šä¹‰ tensorflow æœåŠ¡ docker å›¾åƒã€‚è®©æˆ‘ä»¬å°†æˆ‘ä»¬çš„å›¾åƒæ¨é€åˆ°<a class="ae lk" href="https://cloud.google.com/container-registry/docs/" rel="noopener ugc nofollow" target="_blank"> Google å®¹å™¨æ³¨å†Œè¡¨</a>ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥åœ¨ Google äº‘å¹³å°ä¸Šè¿è¡Œå®ƒã€‚</p><p id="bb94" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">ä½¿ç”¨å®¹å™¨æ³¨å†Œè¡¨æ ¼å¼å’Œæˆ‘ä»¬çš„é¡¹ç›® id æ ‡è®°<code class="fe nl nm nn no b">faster_rcnn_resnet_serving</code>å›¾åƒï¼Œç”¨æ‚¨çš„<code class="fe nl nm nn no b">PROJECT_ID</code>æ›´æ”¹<code class="fe nl nm nn no b">tensorflow-serving-229609</code>ã€‚æœ€åè¿˜è¦ä¿®æ”¹æ ‡ç­¾ï¼Œè¿™æ˜¯æˆ‘ä»¬çš„ç¬¬ä¸€ä¸ªç‰ˆæœ¬ï¼Œæ‰€ä»¥æˆ‘æŠŠæ ‡ç­¾è®¾ä¸º<code class="fe nl nm nn no b">v0.1.0</code>ã€‚</p><pre class="lm ln lo lp gt nq no nr ns aw nt bi"><span id="4eed" class="nu mj iq no b gy nv nw l nx ny">docker tag faster_rcnn_resnet_serving gcr.io/tensorflow-serving-229609/faster_rcnn_resnet_serving:v0.1.0</span></pre><p id="2d27" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">å¦‚æœä½ è¿è¡Œ<code class="fe nl nm nn no b">docker images</code>ï¼Œä½ ç°åœ¨ä¼šçœ‹åˆ°ä¸€ä¸ªé¢å¤–çš„<code class="fe nl nm nn no b">gcr.io/tensorflow-serving-229609/faster_rcnn_resnet_serving:v0.1.0</code>å›¾åƒã€‚</p><p id="950a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">è¿™ä¸ª<code class="fe nl nm nn no b">gcr.io</code>å‰ç¼€å…è®¸æˆ‘ä»¬å°†å›¾åƒç›´æ¥æ¨é€åˆ°å®¹å™¨æ³¨å†Œä¸­å¿ƒï¼Œ</p><pre class="lm ln lo lp gt nq no nr ns aw nt bi"><span id="2e64" class="nu mj iq no b gy nv nw l nx ny"># To do only once<br/>gcloud auth configure-docker</span><span id="8876" class="nu mj iq no b gy os nw l nx ny">docker push gcr.io/tensorflow-serving-229609/faster_rcnn_resnet_serving:v0.1.0</span></pre><p id="7cce" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">æ‚¨å·²ç»æˆåŠŸåœ°å°†æ‚¨çš„å›¾åƒæ¨é€åˆ° GCP é›†è£…ç®±æ³¨å†Œä¸­å¿ƒï¼Œæ‚¨å¯ä»¥åœ¨çº¿æŸ¥çœ‹:</p><figure class="lm ln lo lp gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ov"><img src="../Images/2733008e38eead7638fe5b4a441d5f13.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QoM7Wpdm33TZil_5xX9oGQ.png"/></div></div><figcaption class="lq lr gj gh gi ls lt bd b be z dk">docker image successfully pushed on Google Container Registry</figcaption></figure><p id="8495" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">5.åˆ›å»º Kubernetes éƒ¨ç½²å’ŒæœåŠ¡</p><p id="2994" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">è¯¥éƒ¨ç½²ç”±ä¸€ä¸ªç”±<a class="ae lk" href="https://kubernetes.io/docs/concepts/workloads/controllers/deployment/" rel="noopener ugc nofollow" target="_blank"> Kubernetes éƒ¨ç½²</a>æ§åˆ¶çš„ fast-rcnn æ¨ç†æœåŠ¡å™¨çš„å•ä¸€å‰¯æœ¬ç»„æˆã€‚å‰¯æœ¬é€šè¿‡<a class="ae lk" href="https://kubernetes.io/docs/concepts/services-networking/service/" rel="noopener ugc nofollow" target="_blank"> Kubernetes æœåŠ¡</a>å’Œ<a class="ae lk" href="https://kubernetes.io/docs/tasks/access-application-cluster/create-external-load-balancer/" rel="noopener ugc nofollow" target="_blank">å¤–éƒ¨è´Ÿè½½å¹³è¡¡å™¨</a>å¯¹å¤–å…¬å¼€ã€‚</p><p id="a5e4" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">ä½¿ç”¨å•ä¸ªå‰¯æœ¬å®é™…ä¸Šæ²¡æœ‰æ„ä¹‰ã€‚æˆ‘è¿™æ ·åšåªæ˜¯ä¸ºäº†åœ¨è‡ªç”±å±‚å†…é€šè¿‡ã€‚å¦‚æœæ‚¨åªæœ‰ä¸€ä¸ªå®ä¾‹æ¥æŒ‡å¯¼æ‚¨çš„æŸ¥è¯¢ï¼Œé‚£ä¹ˆè´Ÿè½½å¹³è¡¡æ˜¯æ²¡æœ‰ç”¨çš„ã€‚åœ¨ç”Ÿäº§è®¾ç½®ä¸­ï¼Œä½¿ç”¨å¤šä¸ªå‰¯æœ¬ã€‚</p><p id="276c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">æˆ‘ä»¬ä½¿ç”¨ç¤ºä¾‹ Kubernetes config<a class="ae lk" href="https://github.com/fpaupier/tensorflow-serving_sidecar/blob/master/faster_rcnn_resnet_k8s.yaml" rel="noopener ugc nofollow" target="_blank">faster _ rcnn _ resnet _ k8s . YAML</a>æ¥åˆ›å»ºå®ƒä»¬ã€‚æ‚¨åªéœ€è¦æ›´æ–° docker å›¾åƒä»¥åœ¨æ–‡ä»¶ä¸­ä½¿ç”¨ï¼Œç”¨æ‚¨çš„å®é™…å›¾åƒå…¨åæ›¿æ¢è¡Œ<code class="fe nl nm nn no b">image: &lt;YOUR_FULL_IMAGE_NAME_HERE&gt;</code>ï¼Œçœ‹èµ·æ¥åƒè¿™æ ·:</p><pre class="lm ln lo lp gt nq no nr ns aw nt bi"><span id="5745" class="nu mj iq no b gy nv nw l nx ny">image: gcr.io/tensorflow-serving-229609/faster_rcnn_resnet_serving@sha256:9f7eca6da7d833b240f7c54b630a9f85df8dbdfe46abe2b99651278dc4b13c53</span></pre><p id="b8bb" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">æ‚¨å¯ä»¥åœ¨å®¹å™¨æ³¨å†Œè¡¨ä¸­æ‰¾åˆ°å®ƒ:</p><figure class="lm ln lo lp gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ow"><img src="../Images/5b1d26e761c5c81e8cb7c49e64cd04f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5d9pt3RpzfmXMrkZCcHXzw.png"/></div></div><figcaption class="lq lr gj gh gi ls lt bd b be z dk">find your docker full image name on google container registry</figcaption></figure><p id="1a66" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">ç„¶åè¿è¡Œä»¥ä¸‹å‘½ä»¤</p><pre class="lm ln lo lp gt nq no nr ns aw nt bi"><span id="0e3a" class="nu mj iq no b gy nv nw l nx ny"># From tensorflow-serving_sidecar/<br/>kubectl create -f faster_rcnn_resnet_k8s.yaml</span></pre><p id="29e0" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">è¦æ£€æŸ¥éƒ¨ç½²å’Œ pod çš„çŠ¶æ€ï¼Œè¯·ä½¿ç”¨<code class="fe nl nm nn no b">kubectl get deployments</code>æ¥ç›‘è§†æ•´ä¸ªéƒ¨ç½²ï¼Œä½¿ç”¨<code class="fe nl nm nn no b">kubectl get pods</code>æ¥ç›‘è§†éƒ¨ç½²çš„æ¯ä¸ªå‰¯æœ¬ï¼Œä½¿ç”¨<code class="fe nl nm nn no b">kubectl get services</code>æ¥ç›‘è§†æœåŠ¡ã€‚</p><figure class="lm ln lo lp gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ox"><img src="../Images/a517c70f5adb2a392a692c9e169c0132.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Bbh5PObnAp86RDNwade-jw.png"/></div></div><figcaption class="lq lr gj gh gi ls lt bd b be z dk">sanity check for deployment</figcaption></figure><p id="f9df" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">ä¸€åˆ‡æ­£å¸¸è¿è¡Œå¯èƒ½éœ€è¦ä¸€æ®µæ—¶é—´ã€‚æœåŠ¡å¤–éƒ¨<code class="fe nl nm nn no b">IP</code>åœ°å€åˆ—åœ¨è´Ÿè½½å¹³è¡¡å™¨å…¥å£çš„æ—è¾¹ã€‚æ‚¨å¯ä»¥ä½¿ç”¨<code class="fe nl nm nn no b">kubectl describe service</code>å‘½ä»¤æ¥æ£€æŸ¥å®ƒ:</p><pre class="lm ln lo lp gt nq no nr ns aw nt bi"><span id="a4e3" class="nu mj iq no b gy nv nw l nx ny">kubectl describe service faster-rcnn-resnet-service</span></pre><figure class="lm ln lo lp gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi oy"><img src="../Images/8729214487fde65313f4e5775648c0f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oVF9YMFtJDvlJZI6hXVTqg.png"/></div></div><figcaption class="lq lr gj gh gi ls lt bd b be z dk">find the IP address to query upon to perform inference</figcaption></figure><h2 id="3ef6" class="nu mj iq bd mk od oe dn mo of og dp ms kj oh oi mw kn oj ok na kr ol om ne on bi translated">æŸ¥è¯¢æ‚¨çš„åœ¨çº¿æ¨¡å‹</h2><p id="98a9" class="pw-post-body-paragraph jy jz iq ka b kb ng kd ke kf nh kh ki kj ni kl km kn nj kp kq kr nk kt ku kv ij bi translated">æœ€åï¼Œè®©æˆ‘ä»¬æ¥æµ‹è¯•ä¸€ä¸‹ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ç›¸åŒçš„<a class="ae lk" href="https://github.com/fpaupier/tensorflow-serving_sidecar/blob/master/client.py" rel="noopener ugc nofollow" target="_blank">å®¢æˆ·ç«¯ä»£ç </a>ã€‚ç®€å•åœ°å°†å‰é¢ä½¿ç”¨çš„<code class="fe nl nm nn no b">--server-url</code>å‚æ•°ä¸­çš„<code class="fe nl nm nn no b">localhost</code>æ›¿æ¢ä¸ºä¸Šé¢æŒ‡å®šçš„è´Ÿè½½å¹³è¡¡å™¨å…¥å£çš„<code class="fe nl nm nn no b">IP</code>åœ°å€ã€‚</p><pre class="lm ln lo lp gt nq no nr ns aw nt bi"><span id="67c0" class="nu mj iq no b gy nv nw l nx ny"># From tensorflow-serving_sidecar/<br/>python client.py --server_url "http://34.73.137.228:8501/v1/models/faster_rcnn_resnet:predict" \<br/>--image_path "$(pwd)/object_detection/test_images/image1.jpg" \<br/>--output_json "$(pwd)/object_detection/test_images/out_image3.json" \<br/>--save_output_image "True" \<br/>--label_map "$(pwd)/data/labels.pbtxt"</span></pre><h1 id="a453" class="mi mj iq bd mk ml oz mn mo mp pa mr ms mt pb mv mw mx pc mz na nb pd nd ne nf bi translated">å¤–å–é£Ÿå“</h1><p id="6d8d" class="pw-post-body-paragraph jy jz iq ka b kb ng kd ke kf nh kh ki kj ni kl km kn nj kp kq kr nk kt ku kv ij bi translated">Tensorflow æœåŠ¡æä¾›äº†ä¸€ä¸ªå¾ˆå¥½çš„åŸºç¡€ï¼Œæ‚¨å¯ä»¥ä¾é å®ƒä»¥å¾ˆå°‘çš„å¼€é”€åœ¨ç”Ÿäº§ä¸­å¿«é€Ÿéƒ¨ç½²æ‚¨çš„æ¨¡å‹ã€‚</p><ul class=""><li id="62e1" class="lu lv iq ka b kb kc kf kg kj lw kn lx kr ly kv lz ma mb mc bi translated">æœºå™¨å­¦ä¹ åº”ç”¨ç¨‹åºçš„å®¹å™¨åŒ–éƒ¨ç½²èƒ½å¤Ÿ<em class="kw">åˆ†ç¦»è¿è¥å’Œæ•°æ®ç§‘å­¦å®¶ä¹‹é—´çš„å…³æ³¨ç‚¹</em></li><li id="708b" class="lu lv iq ka b kb md kf me kj mf kn mg kr mh kv lz ma mb mc bi translated">Kubernetes ç­‰å®¹å™¨ç¼–æ’è§£å†³æ–¹æ¡ˆä¸ tensorflow-serving ç›¸ç»“åˆï¼Œä¸ºä¸ç†Ÿæ‚‰åˆ†å¸ƒå¼è®¡ç®—çš„äººæä¾›äº†åœ¨å‡ åˆ†é’Ÿå†…éƒ¨ç½²é«˜å¯ç”¨æ€§æ¨¡å‹çš„å¯èƒ½æ€§ã€‚</li></ul><p id="e80e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">èµ„æºğŸ“š</strong></p><ul class=""><li id="90f4" class="lu lv iq ka b kb kc kf kg kj lw kn lx kr ly kv lz ma mb mc bi translated">Tensorflow æœåŠ¡ç”±è°·æ­Œçš„è½¯ä»¶å·¥ç¨‹å¸ˆ Noah Fiedel è§£é‡Šï¼Œä»–ä»äº‹ Tensorflow æœåŠ¡ã€‚å®ƒè®©æˆ‘ä»¬æ·±å…¥äº†è§£å®ƒæ˜¯å¦‚ä½•å»ºé€ çš„ä»¥åŠå»ºé€ çš„ç›®çš„æ˜¯ä»€ä¹ˆ<a class="ae lk" href="https://www.youtube.com/watch?v=q_IkJcPyNl0" rel="noopener ugc nofollow" target="_blank">https://www.youtube.com/watch?v=q_IkJcPyNl0</a></li><li id="3622" class="lu lv iq ka b kb md kf me kj mf kn mg kr mh kv lz ma mb mc bi translated">å…è´¹æä¾›é¢„è®­ç»ƒæ¨¡å‹åº“<a class="ae lk" href="https://github.com/tensorflow/models/blob/master/research/object_detection/g3doc/detection_model_zoo.md" rel="noopener ugc nofollow" target="_blank">https://github . com/tensor flow/models/blob/master/research/object _ detection/g3doc/detection _ model _ zoo . MD</a></li><li id="320f" class="lu lv iq ka b kb md kf me kj mf kn mg kr mh kv lz ma mb mc bi translated">Tyler Labonte medium post å°† tensorflow æ¨¡å‹å¯¼å‡ºä¸ºä¿å­˜çš„æ£€æŸ¥ç‚¹<a class="ae lk" href="https://medium.com/@tmlabonte/serving-image-based-deep-learning-models-with-tensorflow-servings-restful-api-d365c16a7dc4" rel="noopener">https://medium . com/@ tmlabonte/serving-image-based-deep-learning-models-with-tensor flow-servings-restful-API-d 365 c 16 a7 DC 4</a></li><li id="a141" class="lu lv iq ka b kb md kf me kj mf kn mg kr mh kv lz ma mb mc bi translated">æä¾›ä¸€ä¸ªæ²¡æœ‰åˆé€‚æ¡†æ¶çš„ ML æ¨¡å‹æ˜¯å¤šä¹ˆéº»çƒ¦çš„ä¾‹å­<a class="ae lk" rel="noopener" target="_blank" href="/how-to-build-and-deploy-a-lyrics-generation-model-framework-agnostic-589f3026fd53">https://towardsdatascience . com/how-to-build-and-deploy-a-lyrics-generation-model-framework-agnostic-589 f 3026 FD 53</a></li><li id="edd6" class="lu lv iq ka b kb md kf me kj mf kn mg kr mh kv lz ma mb mc bi translated">Cloud MLï¼Œç”¨äºéƒ¨ç½² ML æ¨¡å‹çš„ Google æ‰˜ç®¡è§£å†³æ–¹æ¡ˆ:<a class="ae lk" href="https://cloud.google.com/ml-engine/docs/tensorflow/deploying-models" rel="noopener ugc nofollow" target="_blank">https://cloud . Google . com/ML-engine/docs/tensor flow/deploying-models</a></li></ul></div></div>    
</body>
</html>