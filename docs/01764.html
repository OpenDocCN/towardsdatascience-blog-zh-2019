<html>
<head>
<title>Python and Oracle Cloud: loading data</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python 和 Oracle 云:加载数据</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/python-and-oracle-cloud-loading-data-42ec5fc1bbc6?source=collection_archive---------7-----------------------#2019-03-23">https://towardsdatascience.com/python-and-oracle-cloud-loading-data-42ec5fc1bbc6?source=collection_archive---------7-----------------------#2019-03-23</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="cec3" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">使用 OCI Python SDK 和自治 DWH API，您可以轻松地为您的数据科学和 ML 工作加载数据</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/71d2e84ed0fee2f82edf8b35fac82821.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BA-hnz56hqMPuP2ltc3M6Q.jpeg"/></div></div></figure><h1 id="f933" class="la lb it bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">介绍</h1><p id="3b5e" class="pw-post-body-paragraph jq jr it js b jt ly jv jw jx lz jz ka kb ma kd ke kf mb kh ki kj mc kl km kn im bi translated">在<a class="ae md" rel="noopener" target="_blank" href="/python-oracle-adwc-and-machine-learning-27ace24abe22"> <strong class="js iu">之前的文章</strong> </a> <strong class="js iu">，</strong>中，我探讨了我们如何使用 Python 和流行的开源框架，如 Pandas 和 scikit-learn，来分析用<strong class="js iu"> Oracle 自治数据仓库(ADWC) </strong>存储的数据。在这个简短的故事中，我想向您展示如何使用<strong class="js iu"> OCI Python SDK </strong>轻松<strong class="js iu">加载大数据文件</strong>。</p><h1 id="2175" class="la lb it bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated"><strong class="ak">自动化“上了类固醇”</strong></h1><p id="2f4a" class="pw-post-body-paragraph jq jr it js b jt ly jv jw jx lz jz ka kb ma kd ke kf mb kh ki kj mc kl km kn im bi translated">云的一大特点是自动化。在云世界中，更容易动态地提供资源(如 VM，甚至数据库)并使用 API 管理它们。</p><p id="de11" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu"> Oracle 云基础设施(OCI) </strong>有许多工具，您可以在其中选择自己喜欢的工具，以自动化一大组任务(我想说:我需要的一切):</p><ul class=""><li id="6a81" class="me mf it js b jt ju jx jy kb mg kf mh kj mi kn mj mk ml mm bi translated">REST API</li><li id="04b7" class="me mf it js b jt mn jx mo kb mp kf mq kj mr kn mj mk ml mm bi translated">OCI CLI</li><li id="c1b9" class="me mf it js b jt mn jx mo kb mp kf mq kj mr kn mj mk ml mm bi translated">软件开发工具包(Software Development Kit)</li></ul><p id="cf01" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">OCI 命令行界面(CLI)真的很好。但是，如果你想开发你的高度定制的工具，完美地适合你的肩膀，我推荐使用<strong class="js iu"> SDK </strong>。</p><p id="0332" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">正如您在<a class="ae md" href="https://docs.cloud.oracle.com/iaas/Content/API/Concepts/sdks.htm" rel="noopener ugc nofollow" target="_blank">文档</a>中看到的，我们有:</p><ul class=""><li id="a209" class="me mf it js b jt ju jx jy kb mg kf mh kj mi kn mj mk ml mm bi translated">Python SDK</li><li id="6fc2" class="me mf it js b jt mn jx mo kb mp kf mq kj mr kn mj mk ml mm bi translated">Java SDK</li><li id="9253" class="me mf it js b jt mn jx mo kb mp kf mq kj mr kn mj mk ml mm bi translated">Ruby SDK</li><li id="cd31" class="me mf it js b jt mn jx mo kb mp kf mq kj mr kn mj mk ml mm bi translated">Go SDK</li></ul><p id="6bbf" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">既然我们在谈论数据科学和 ML 工程，我毫无疑问会选择<strong class="js iu"> Python </strong>。</p><p id="079c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">有了 OCI Python SDK，你就有了一套完整且易于使用的类，它们都有很好的文档记录，使你能够构建 Python 脚本来自动化你日常数据工作的大部分流程。此外，您甚至可以在 Jupyter 笔记本(或 Jupyter Lab)中使用它。</p><p id="717e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">因此，几天前，我从晚上的任务开始，为我的一个客户构建一些示例，展示如何从平面文件开始在 Oracle ADWC 中加载数据。然后，作为一个不错的副作用，我决定更深入地研究这个主题，并创建了一个脚本来启动/停止 VM，甚至启动/停止我的 ADWC 实例。</p><p id="8e74" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">你可以在我的 G <a class="ae md" href="https://github.com/luigisaetta/ocipy" rel="noopener ugc nofollow" target="_blank"> <strong class="js iu"> ithub repo </strong> </a>里面找到这组例子</p><p id="2e95" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在这个故事中，我想更详细地解释如何从平面文件开始加载数据。</p><h1 id="efe5" class="la lb it bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">安装？轻松点。</h1><p id="6577" class="pw-post-body-paragraph jq jr it js b jt ly jv jw jx lz jz ka kb ma kd ke kf mb kh ki kj mc kl km kn im bi translated">显然，有<a class="ae md" href="https://oracle-cloud-infrastructure-python-sdk.readthedocs.io/en/latest/" rel="noopener ugc nofollow" target="_blank">文档</a>，但是，如果您使用 PyPi，安装只有一行代码:</p><pre class="kp kq kr ks gt ms mt mu mv aw mw bi"><span id="3f90" class="mx lb it mt b gy my mz l na nb">pip install oci</span></pre><p id="e26d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">它也适用于蟒蛇。</p><p id="75d2" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果你想成为第一批尝试新特性的人，只需查看 OCI Python <a class="ae md" href="https://github.com/oracle/oci-python-sdk" rel="noopener ugc nofollow" target="_blank"> Github 库</a>。</p><h1 id="9b74" class="la lb it bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">配置</h1><p id="1269" class="pw-post-body-paragraph jq jr it js b jt ly jv jw jx lz jz ka kb ma kd ke kf mb kh ki kj mc kl km kn im bi translated">然后，您需要执行一些配置任务，以确保您的工作环境和 OCI 云之间的安全通信。我会花一些时间在这里澄清，因为我不想让你在这部分浪费宝贵的时间。</p><p id="8cbb" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">首先，您需要创建一个 PEM 格式的<strong class="js iu"> API 签名密钥对</strong>。您必须在您的环境(运行 Python 程序的计算机)中保持私有密钥的安全，并将公共密钥存储在您的云配置文件中。当你存储它时，你可以从云用户界面读取指纹。</p><p id="ce6a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">更多详情可在此处找到:</p><div class="nc nd gp gr ne nf"><a href="https://docs.cloud.oracle.com/iaas/Content/API/Concepts/apisigningkey.htm" rel="noopener  ugc nofollow" target="_blank"><div class="ng ab fo"><div class="nh ab ni cl cj nj"><h2 class="bd iu gy z fp nk fr fs nl fu fw is bi translated">必需的密钥和 OCIDs</h2><div class="nm l"><h3 class="bd b gy z fp nk fr fs nl fu fw dk translated">了解使用 Oracle 客户机或您自己构建的客户机时所需的键和 OCIDs。</h3></div><div class="nn l"><p class="bd b dl z fp nk fr fs nl fu fw dk translated">docs.cloud.oracle.com</p></div></div></div></a></div><p id="bbed" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">然后，对于每种类型的客户端(对象存储客户端、计算客户端等)。)您需要提供一组(键，值)对，打包成一个字典，以便指定:</p><ul class=""><li id="a685" class="me mf it js b jt ju jx jy kb mg kf mh kj mi kn mj mk ml mm bi translated">您的 OCI 用户名</li><li id="8dc6" class="me mf it js b jt mn jx mo kb mp kf mq kj mr kn mj mk ml mm bi translated">用于保护通信的密钥(API 签名密钥)</li><li id="acd6" class="me mf it js b jt mn jx mo kb mp kf mq kj mr kn mj mk ml mm bi translated">这把钥匙的指纹</li><li id="ab89" class="me mf it js b jt mn jx mo kb mp kf mq kj mr kn mj mk ml mm bi translated">您的云租户标识符</li><li id="540c" class="me mf it js b jt mn jx mo kb mp kf mq kj mr kn mj mk ml mm bi translated">OCI 地区</li></ul><p id="a5fa" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">以下是您需要准备的内容示例(匿名):</p><pre class="kp kq kr ks gt ms mt mu mv aw mw bi"><span id="f01c" class="mx lb it mt b gy my mz l na nb">config = {</span><span id="8ee6" class="mx lb it mt b gy no mz l na nb">“user”: “ocid1.user.oc1..XXXXX”,</span><span id="17fd" class="mx lb it mt b gy no mz l na nb">“key_file”: “/Users/lsaetta/Progetti/xxxx/oci_api_key.pem”,</span><span id="d7b0" class="mx lb it mt b gy no mz l na nb">“fingerprint”: “YYYYY”,</span><span id="f927" class="mx lb it mt b gy no mz l na nb">“tenancy”: “ocid1.tenancy.oc1..ZZZZZZ”,</span><span id="61f0" class="mx lb it mt b gy no mz l na nb">“region”: “eu-frankfurt-1”</span><span id="d384" class="mx lb it mt b gy no mz l na nb">}</span></pre><p id="cd91" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">对于用户和您的云租户，您需要使用的不是名称，而是标识符 OCID，您可以从 OCI 云控制台复制它。</p><h1 id="58b1" class="la lb it bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">在云中加载文件</h1><p id="5921" class="pw-post-body-paragraph jq jr it js b jt ly jv jw jx lz jz ka kb ma kd ke kf mb kh ki kj mc kl km kn im bi translated">此时，您已经准备好将一组文件作为对象加载到 ObjectStore 中。</p><p id="846a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这是加载单个文件的代码，我很快会添加注释:</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="np nq l"/></div></figure><p id="15ec" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如您所见，您需要:</p><ul class=""><li id="e48c" class="me mf it js b jt ju jx jy kb mg kf mh kj mi kn mj mk ml mm bi translated">创建客户机，在本例中是 ObjectStorageClient，并将配置字典传递给构造函数</li><li id="e1db" class="me mf it js b jt mn jx mo kb mp kf mq kj mr kn mj mk ml mm bi translated">以 bucket_name，file_name，file_path 为参数调用方法<strong class="js iu"> put_object </strong></li></ul><p id="956d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">仅此而已。</p><p id="86e5" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在 Github 资源库中，您会发现一个处理一组文件的增强版本。</p><h1 id="41d4" class="la lb it bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">将凭证存储在数据库中</h1><p id="adf6" class="pw-post-body-paragraph jq jr it js b jt ly jv jw jx lz jz ka kb ma kd ke kf mb kh ki kj mc kl km kn im bi translated">现在，是时候将数据从 ObjectStore 复制到 ADWC 表中了。</p><p id="4deb" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">首先:我们需要创建一组凭证并将它们存储在 DB 中，以便使 PL/SQL 代码能够访问 ObjectStorage Bucket。</p><p id="6c50" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">转到 OCI 用户界面，在您的配置文件(右上方的图标和用户设置)中创建一个 AuthToken:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi nr"><img src="../Images/26d820464c58e9903f822ce695df1790.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oM81xDCx9BS9yci7euiV4w.jpeg"/></div></div><figcaption class="ns nt gj gh gi nu nv bd b be z dk">Authentication Token</figcaption></figure><p id="36b2" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">从 UI 复制身份验证令牌。请记住在创建后立即这样做，否则，您将无法重新阅读它。</p><p id="1feb" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">其次，使用下面的代码将云凭证存储在 DB 中；该步骤只需执行一次:</p><pre class="kp kq kr ks gt ms mt mu mv aw mw bi"><span id="dcf9" class="mx lb it mt b gy my mz l na nb">import cx_Oracle</span><span id="5027" class="mx lb it mt b gy no mz l na nb">connection = cx_Oracle.connect(USER, PWD, 'adwc5_medium')</span><span id="2df2" class="mx lb it mt b gy no mz l na nb"># need to create a cursor<br/>cur = connection.cursor()</span><span id="d157" class="mx lb it mt b gy no mz l na nb">statement = """<br/>BEGIN<br/>  DBMS_CLOUD.CREATE_CREDENTIAL(<br/>    credential_name =&gt; 'DEF_CRED_NAME',<br/>    username =&gt; 'adwc_user@oracle.com',<br/>    password =&gt; '&lt;AUTH Token&gt;'<br/>  );<br/>END;<br/>"""<br/>cur.execute(statement)</span></pre><p id="58c5" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">注意:如果您的用户是联邦用户，那么这个名称就是完全限定的名称。它有一个前缀，如:</p><pre class="kp kq kr ks gt ms mt mu mv aw mw bi"><span id="2279" class="mx lb it mt b gy my mz l na nb">oracleidentitycloudservice/</span></pre><p id="0990" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">并且您必须在 CREATE_CREDENTIAL 调用中指定完全限定的名称。</p><h1 id="595c" class="la lb it bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">在 Oracle ADWC 中加载数据</h1><p id="4b1d" class="pw-post-body-paragraph jq jr it js b jt ly jv jw jx lz jz ka kb ma kd ke kf mb kh ki kj mc kl km kn im bi translated">因为我们现在在 ObjectStore 中有了平面文件，所以我们可以使用 PL/SQL 包<strong class="js iu"> DBMS_CLOUD </strong>来加载 ADWC 表中的数据。</p><p id="5ae5" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">好吧，这是 PL/SQL 代码，但不是很复杂，你可以很容易地剪切&amp;粘贴。我们将把这段代码包装在 Python 代码中。</p><p id="c864" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们设想一个更简单的场景:一个用于平面文件的 Oracle 表，文件的格式与表相同(文件和表字段之间一一对应)</p><p id="a75a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们必须在数据库中创建表。例如:</p><pre class="kp kq kr ks gt ms mt mu mv aw mw bi"><span id="8627" class="mx lb it mt b gy my mz l na nb">CREATE TABLE CHANNELS<br/>   (channel_id char(1),<br/>    channel_desc varchar2(20),<br/>    channel_class varchar2(20)<br/>   );<br/>/</span></pre><p id="0e29" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">然后，我们可以用下面的代码加载该表中一个文件中包含的数据:</p><pre class="kp kq kr ks gt ms mt mu mv aw mw bi"><span id="a088" class="mx lb it mt b gy my mz l na nb">import cx_Oracle</span><span id="2a38" class="mx lb it mt b gy no mz l na nb">connection = cx_Oracle.connect(USER, PWD, 'adwc5_medium')</span><span id="e8a3" class="mx lb it mt b gy no mz l na nb"># need to create a cursor<br/>cur = connection.cursor()</span><span id="5aa6" class="mx lb it mt b gy no mz l na nb">statement = """<br/>BEGIN<br/> DBMS_CLOUD.COPY_DATA(<br/>    table_name =&gt;'CHANNELS1',<br/>    credential_name =&gt;'<!-- -->DEF_CRED_NAME<!-- -->',<br/>    file_uri_list =&gt;'<a class="ae md" href="https://swiftobjectstorage.eu-frankfurt-1.oraclecloud.com/v1/rgsbidatalake5/ADWC5/channels1.txt'" rel="noopener ugc nofollow" target="_blank">https://swiftobjectstorage.eu-frankfurt-1.oraclecloud.com/v1/tenant-name/BUCKET_NAME/channels1.txt'</a>,<br/>    format =&gt; json_object('delimiter' value ',')<br/> );<br/>END;<br/>"""</span><span id="f6c3" class="mx lb it mt b gy no mz l na nb">cur.execute(statement)</span></pre><p id="9315" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">一个细节:要引用对象，您需要使用<strong class="js iu"> SWIFT-type </strong> URL。在上面的例子中你需要改变的是:</p><ul class=""><li id="0da0" class="me mf it js b jt ju jx jy kb mg kf mh kj mi kn mj mk ml mm bi translated">地区名称(这里是 eu-frankurt-1)</li><li id="da08" class="me mf it js b jt mn jx mo kb mp kf mq kj mr kn mj mk ml mm bi translated">你的房客的名字</li><li id="be74" class="me mf it js b jt mn jx mo kb mp kf mq kj mr kn mj mk ml mm bi translated">对象存储中存储桶的名称</li><li id="2c5f" class="me mf it js b jt mn jx mo kb mp kf mq kj mr kn mj mk ml mm bi translated">对象的名称(此处:channels1.txt)</li></ul><p id="0a10" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">正如我们所看到的，DBMS_CLOUD 包拥有所有必需的 API 来:</p><ul class=""><li id="2f50" class="me mf it js b jt ju jx jy kb mg kf mh kj mi kn mj mk ml mm bi translated">将凭证存储在数据库中</li><li id="4cfd" class="me mf it js b jt mn jx mo kb mp kf mq kj mr kn mj mk ml mm bi translated">从对象存储复制到数据库</li></ul><p id="afde" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">它还提供了其他一些不错的特性。例如，您可以使用 Apache <strong class="js iu"> Parquet </strong>格式的文件，而不是 CSV。</p><h1 id="fb80" class="la lb it bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">想检查一下吗？</h1><p id="c50f" class="pw-post-body-paragraph jq jr it js b jt ly jv jw jx lz jz ka kb ma kd ke kf mb kh ki kj mc kl km kn im bi translated">如果您想检查数据是否真的已经加载，您可以使用下面的代码片段:</p><pre class="kp kq kr ks gt ms mt mu mv aw mw bi"><span id="b4da" class="mx lb it mt b gy my mz l na nb">import pandas as pd<br/>import cx_Oracle</span><span id="d071" class="mx lb it mt b gy no mz l na nb">connection = cx_Oracle.connect(USER, PWD, 'adwc5_medium')</span><span id="e6aa" class="mx lb it mt b gy no mz l na nb">channel1 = pd.read_sql("select * from CHANNELS1", <br/>                   con=connection)</span><span id="5a4c" class="mx lb it mt b gy no mz l na nb"># if it is a Notebook<br/>channel1.head()</span></pre><h1 id="0f5d" class="la lb it bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">外部表</h1><p id="7ba2" class="pw-post-body-paragraph jq jr it js b jt ly jv jw jx lz jz ka kb ma kd ke kf mb kh ki kj mc kl km kn im bi translated">数据加载的另一个选项是在数据库中创建一个<strong class="js iu">外部表</strong>，引用文件。一旦外部表开始工作，就可以使用 DML 指令将数据加载到数据库中。例如，您可以使用 CTAS:创建表作为选择。</p><p id="e4a8" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">创建外部表的过程是:</p><pre class="kp kq kr ks gt ms mt mu mv aw mw bi"><span id="fdaf" class="mx lb it mt b gy my mz l na nb">DBMS_CLOUD.CREATE_EXTERNAL_TABLE</span></pre><p id="0e34" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">更多详情<a class="ae md" href="https://docs.oracle.com/en/cloud/paas/autonomous-data-warehouse-cloud/user/query-external.html#GUID-72DC8BB6-5245-4262-A100-C35A2E553F70" rel="noopener ugc nofollow" target="_blank"> <strong class="js iu">此处</strong> </a>。</p><h1 id="e494" class="la lb it bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">结论</h1><p id="e9bb" class="pw-post-body-paragraph jq jr it js b jt ly jv jw jx lz jz ka kb ma kd ke kf mb kh ki kj mc kl km kn im bi translated">作为一名数据科学家，你需要与数据打交道。有时你需要自己装载。有时，您会有一个 DBA 来为您加载。</p><p id="d5db" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在本文中，我展示了如何使用 OCI Python SDK 来:</p><ul class=""><li id="76c0" class="me mf it js b jt ju jx jy kb mg kf mh kj mi kn mj mk ml mm bi translated">将文件加载到对象存储中</li><li id="a8a1" class="me mf it js b jt mn jx mo kb mp kf mq kj mr kn mj mk ml mm bi translated">将数据从对象存储复制到 ADWC 表</li></ul><p id="7a9e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">此外，我还近距离观察了 OCI Python SDK 的强大功能。有了它，您可以创建高度定制的工具集来自动化您的日常工作。您甚至可以创建自己的 ADWC 实例，或者对其进行扩展(添加内核和存储空间)。</p><p id="909a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在以后的文章中，我将回到机器学习。差不多到了探索<strong class="js iu"> OML4Py </strong>的时候了。</p><h1 id="af07" class="la lb it bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated"><strong class="ak">还有一件事</strong></h1><p id="92d6" class="pw-post-body-paragraph jq jr it js b jt ly jv jw jx lz jz ka kb ma kd ke kf mb kh ki kj mc kl km kn im bi translated">如果你想找到更多使用 OCI Python SDK 的例子，你可以看一下这里的</p></div></div>    
</body>
</html>