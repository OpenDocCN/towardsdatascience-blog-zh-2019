<html>
<head>
<title>Netflix Show Recommendations Using Twitter’s API and Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">网飞使用 Twitter 的 API 和 Python 展示推荐</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/netflix-show-recommendations-using-twitters-api-and-python-65f347706617?source=collection_archive---------23-----------------------#2019-11-15">https://towardsdatascience.com/netflix-show-recommendations-using-twitters-api-and-python-65f347706617?source=collection_archive---------23-----------------------#2019-11-15</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/010337015543bb21e76f75ac7080c89f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*saRhAhThji8DgL2qHi-Ugg.jpeg"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk">Photo by <a class="ae kf" href="https://www.pexels.com/@jmark" rel="noopener ugc nofollow" target="_blank">John-Mark Smith</a> on <a class="ae kf" href="https://www.pexels.com/photo/photo-of-cup-near-flat-screen-television-2726370/" rel="noopener ugc nofollow" target="_blank">Pexels</a></figcaption></figure><p id="8a18" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在本帖中，我们将分析推特上的网飞秀推荐。首先，你需要申请一个 Twitter 开发者账户:</p><figure class="lf lg lh li gt ju gh gi paragraph-image"><div class="gh gi le"><img src="../Images/8de478e493cd200d2ddb35292f06e27d.png" data-original-src="https://miro.medium.com/v2/resize:fit:808/format:webp/1*0xmSHPJRMafMjW4Zr4atYQ.png"/></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk"><a class="ae kf" href="https://projects.raspberrypi.org/en/projects/getting-started-with-the-twitter-api/3" rel="noopener ugc nofollow" target="_blank">Source</a></figcaption></figure><p id="a903" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">您的开发人员帐户获得批准后，您需要创建一个 Twitter 应用程序:</p><figure class="lf lg lh li gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi lj"><img src="../Images/535749c04db1726dafff300aac41628c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5EGnUjPFY2dF-jUkTdd6QA.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk"><a class="ae kf" href="https://projects.raspberrypi.org/en/projects/getting-started-with-the-twitter-api/4" rel="noopener ugc nofollow" target="_blank">Source</a></figcaption></figure><p id="f9b6" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">申请 Twitter 开发者账户和创建 Twitter 应用程序的步骤在<a class="ae kf" href="https://projects.raspberrypi.org/en/projects/getting-started-with-the-twitter-api/4" rel="noopener ugc nofollow" target="_blank">这里</a>列出。</p><p id="2741" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">为了访问 Twitter API，我们将使用免费的 python 库 tweepy。tweepy 的文档可以在<a class="ae kf" href="https://tweepy.readthedocs.io/en/latest/getting_started.html" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p><ol class=""><li id="44fd" class="lk ll it ki b kj kk kn ko kr lm kv ln kz lo ld lp lq lr ls bi translated"><strong class="ki iu">安装</strong></li></ol><p id="4861" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">首先，确保您已经安装了 tweepy。打开命令行并键入:</p><pre class="lf lg lh li gt lt lu lv lw aw lx bi"><span id="a36d" class="ly lz it lu b gy ma mb l mc md">pip install tweepy</span></pre><p id="8039" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">2.<strong class="ki iu">导入库</strong></p><p id="23e6" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">接下来，打开您最喜欢的编辑器，导入 tweepy 和 pandas 库:</p><pre class="lf lg lh li gt lt lu lv lw aw lx bi"><span id="725b" class="ly lz it lu b gy ma mb l mc md">import tweepy<br/>import pandas as pd</span></pre><p id="9918" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">3.<strong class="ki iu">认证</strong></p><p id="b15e" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">接下来，我们需要我们的消费者密钥和访问令牌:</p><figure class="lf lg lh li gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi me"><img src="../Images/6e8d1ea132e104bb6c262ddad9d50495.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7TxOpsOni5I1HAdafJ9BWw.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk"><a class="ae kf" href="https://projects.raspberrypi.org/en/projects/getting-started-with-the-twitter-api/4" rel="noopener ugc nofollow" target="_blank">Source</a></figcaption></figure><p id="d398" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">请注意，该网站建议您保持您的密钥和令牌私有！这里我们定义了一个假的密钥和令牌，但是在创建 Twitter 应用程序时，您应该使用真正的密钥和令牌，如上所示:</p><pre class="lf lg lh li gt lt lu lv lw aw lx bi"><span id="7ab4" class="ly lz it lu b gy ma mb l mc md">consumer_key = '5GBi0dCerYpy2jJtkkU3UwqYtgJpRd' <br/>consumer_secret = 'Q88B4BDDAX0dCerYy2jJtkkU3UpwqY'<br/>access_token = 'X0dCerYpwi0dCerYpwy2jJtkkU3U'<br/>access_token_secret = 'kly2pwi0dCerYpjJtdCerYkkU3Um'</span></pre><p id="39f9" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">下一步是创建 OAuthHandler 实例。我们传递上面定义的消费者密钥和访问令牌:</p><pre class="lf lg lh li gt lt lu lv lw aw lx bi"><span id="607d" class="ly lz it lu b gy ma mb l mc md">auth = tweepy.OAuthHandler(consumer_key, consumer_secret)<br/>auth.set_access_token(access_token, access_token_secret)</span></pre><p id="6ffd" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">接下来，我们将 OAuthHandler 实例传递给 API 方法:</p><pre class="lf lg lh li gt lt lu lv lw aw lx bi"><span id="7715" class="ly lz it lu b gy ma mb l mc md">api = tweepy.API(auth)</span></pre><p id="58f6" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">4.<strong class="ki iu"> TWITTER API 请求</strong></p><p id="2cca" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">接下来，我们为我们有兴趣分析的字段初始化列表。现在，我们可以查看推文字符串、用户和推文时间。接下来，我们在一个 tweepy“Cursor”对象上编写一个 for 循环。在“Cursor”对象中，我们传递“api.search”方法，为我们想要搜索的内容设置查询字符串(q= "best show 网飞" )，并设置“count”= 1000，这样我们就不会超过 twitter 的速率限制。我们还使用“item()”方法将“Cursor”对象转换为 iterable。</p><p id="c42f" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">为了简化查询，我们可以删除转发，只包含英文推文。为了了解该请求返回的内容，我们还可以打印附加到每个列表的值:</p><pre class="lf lg lh li gt lt lu lv lw aw lx bi"><span id="ada5" class="ly lz it lu b gy ma mb l mc md">twitter_users = []<br/>tweet_time = []<br/>tweet_string = []<br/>for tweet in tweepy.Cursor(api.search,q="best show netflix", count=1000).items(1000):<br/>        if (not tweet.retweeted) and ('RT @' not in tweet.text):<br/>            if tweet.lang == "en":<br/>                twitter_users.append(tweet.user.name)<br/>                tweet_time.append(tweet.created_at)<br/>                tweet_string.append(tweet.text)<br/>                print([tweet.user.name,tweet.created_at,tweet.text])</span></pre><figure class="lf lg lh li gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mf"><img src="../Images/6ffc9a293a9dd56f73575af16d691b58.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hz1i_5fb5T-0ZBt4M0l9vA.png"/></div></div></figure><p id="6696" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在这张推文截图中，人们推荐的节目有<em class="mg">格雷斯和弗兰基</em>、<em class="mg">路西法</em>、<em class="mg">被抓</em>、<em class="mg">Visa vs</em>和<em class="mg">OA</em>。让我们来看看另一张推文截图:</p><figure class="lf lg lh li gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mh"><img src="../Images/01ee297d795ea661d4867b0eddc01e9d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WNnzINPaCTDDNLKrC3oXXw.png"/></div></div></figure><p id="04c6" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在这里，人们推荐<em class="mg">世界末日、黎明、卡明斯基方法、</em>和<em class="mg">山之屋的闹鬼。我们也可以指定一个流派。如果我们想搜索最佳喜剧(电视剧和电影):</em></p><pre class="lf lg lh li gt lt lu lv lw aw lx bi"><span id="cd4b" class="ly lz it lu b gy ma mb l mc md">twitter_users = []<br/>tweet_time = []<br/>tweet_string = []<br/>for tweet in tweepy.Cursor(api.search,q="best comedy netflix", count=1000).items(1000):<br/>        if (not tweet.retweeted) and ('RT @' not in tweet.text):<br/>            if tweet.lang == "en":<br/>                twitter_users.append(tweet.user.name)<br/>                tweet_time.append(tweet.created_at)<br/>                tweet_string.append(tweet.text)<br/>                print([tweet.user.name,tweet.created_at,tweet.text])</span></pre><figure class="lf lg lh li gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mi"><img src="../Images/978b558d7fa53501628d6b0d0a1ea14e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ph17V_lnj5gb-6Vzsn65vQ.png"/></div></div></figure><p id="7091" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在这里，人们对席特的《小溪》、《贪得无厌》、塞斯·迈耶的喜剧特辑以及哈桑·米纳吉的《爱国者法案》赞不绝口。我们也可以从电视剧中来看:</p><figure class="lf lg lh li gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mf"><img src="../Images/fd791602873c1b251106c38b8aabbf12.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MgP8XtJ9CJj8SxoluMzHPw.png"/></div></div></figure><p id="6905" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">和惊悚片:</p><figure class="lf lg lh li gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mj"><img src="../Images/0811cfa2df8a918e0df5974bd19574a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RoA0HxQK41n6lPGeihkZvA.png"/></div></div></figure><p id="779c" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">接下来，我们可以将查询结果存储在数据帧中。为此，让我们定义一个函数，该函数将一个关键字作为参数，并返回一个包含与该关键字相关的 1000 条推文的数据帧:</p><pre class="lf lg lh li gt lt lu lv lw aw lx bi"><span id="1a1f" class="ly lz it lu b gy ma mb l mc md">def get_related_tweets(key_word):<br/>    twitter_users = []<br/>    tweet_time = []<br/>    tweet_string = [] <br/>    for tweet in tweepy.Cursor(api.search,q=key_word, count=1000).items(1000):<br/>            if (not tweet.retweeted) and ('RT @' not in tweet.text):<br/>                if tweet.lang == "en":<br/>                    twitter_users.append(tweet.user.name)<br/>                    tweet_time.append(tweet.created_at)<br/>                    tweet_string.append(tweet.text)<br/>                    #print([tweet.user.name,tweet.created_at,tweet.text])<br/>    df = pd.DataFrame({'name':twitter_users, 'time': tweet_time, 'tweet': tweet_string})<br/>    df.to_csv(f"{key_word}.csv")<br/>    return df</span></pre><p id="e7c4" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">当我们用“最佳惊悚片网飞”调用函数时，定义一个 dataframe 作为函数的返回值，并打印它的前五行，我们得到:</p><pre class="lf lg lh li gt lt lu lv lw aw lx bi"><span id="ff9d" class="ly lz it lu b gy ma mb l mc md">df_thriller = get_related_tweets("best thriller netflix")<br/>print(df_thriller.head(5))</span></pre><figure class="lf lg lh li gt ju gh gi paragraph-image"><div class="gh gi mk"><img src="../Images/762d42c17ef581d1fc00adb05330fb56.png" data-original-src="https://miro.medium.com/v2/resize:fit:792/format:webp/1*L4wFh5ipJCaXzAGu-Q5HJA.png"/></div></figure><p id="3070" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果我们为“网飞最佳喜剧”做同样的事情:</p><pre class="lf lg lh li gt lt lu lv lw aw lx bi"><span id="9c1f" class="ly lz it lu b gy ma mb l mc md">df_comedy = get_related_tweets("best comedy netflix")<br/>print(df_comedy.head(5))</span></pre><figure class="lf lg lh li gt ju gh gi paragraph-image"><div class="gh gi ml"><img src="../Images/0caa17177984662b4a75a69a8b31fe6e.png" data-original-src="https://miro.medium.com/v2/resize:fit:820/format:webp/1*_5NZvdcHJk4ZZ68kY1IR_A.png"/></div></figure><p id="d723" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我就说到这里。这篇文章的代码可以在 Github 上找到。感谢您的阅读！</p></div></div>    
</body>
</html>