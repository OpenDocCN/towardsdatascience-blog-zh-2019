<html>
<head>
<title>Rudimentary k-Nearest Neighbors</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">基本 k 近邻</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/rudimentary-k-nearest-neighbors-6d0d1e5e4c60?source=collection_archive---------27-----------------------#2019-05-20">https://towardsdatascience.com/rudimentary-k-nearest-neighbors-6d0d1e5e4c60?source=collection_archive---------27-----------------------#2019-05-20</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="2012" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsdatascience.com/tagged/rudimentary-ml" rel="noopener" target="_blank">初级 ML </a></h2><div class=""/><div class=""><h2 id="3bd5" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">最直观的 ML 模型</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/188f14bd694caba86860b6e362667cd2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QDU9MYcV66CwBed-ucIbKQ.jpeg"/></div></div></figure><p id="faba" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">有时在数据科学中，你会发现自己拿起一个导弹发射器就是为了杀死一只蚂蚁。</p><p id="8c77" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">不过，在这种情况下，我们将讨论可能是最直观的机器学习算法。然而，不要被愚弄了，尽管它很简单，kNN 算法在某些情况下仍然非常有效。</p><h2 id="b98b" class="lz ma it bd mb mc md dn me mf mg dp mh lm mi mj mk lq ml mm mn lu mo mp mq iz bi translated">一些快速注释:</h2><p id="4ea4" class="pw-post-body-paragraph ld le it lf b lg mr kd li lj ms kg ll lm mt lo lp lq mu ls lt lu mv lw lx ly im bi translated">首先，kNN 是一种非参数算法，这意味着它不假设您的数据遵循任何特定的分布。另一个很酷的事情是，它可以执行分类和回归任务，这两个我们将在这篇文章中触及。</p><h1 id="f687" class="mw ma it bd mb mx my mz me na nb nc mh ki nd kj mk kl ne km mn ko nf kp mq ng bi translated">直觉</h1><p id="b965" class="pw-post-body-paragraph ld le it lf b lg mr kd li lj ms kg ll lm mt lo lp lq mu ls lt lu mv lw lx ly im bi translated">首先，我们将使用一个数据集的简单表示来说明我们将如何使用 kNN 来执行一个<strong class="lf jd">分类</strong>任务。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nh"><img src="../Images/6244ea4c004c7979c25a5c89f0670f9a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eJ1IOO0vZpBDybsbGafQjA.png"/></div></div></figure><p id="9fe2" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">设<strong class="lf jd">洋红色</strong>为 A 型，<strong class="lf jd">黑色</strong>为 b 型。这些点将组成给定的数据。假设<strong class="lf jd">蓝色</strong>是我们希望根据给定数据进行分类的数据点。</p><p id="1764" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">为此，我们将选择一个值<strong class="lf jd"> k </strong>，它将是与我们的新数据点“最相似”的点数。</p><p id="f72b" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">在这个二维例子中，我们将选择我们的<strong class="lf jd">相似性度量</strong>作为欧几里德距离。</p><p id="0143" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">因此，例如，如果我们让<strong class="lf jd"> k=2 </strong>，那么我们将寻找与我们的新数据点最相似的 2 个点。如果我们用距离来表示，我们会寻找最近的两个点。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ni"><img src="../Images/c01526a345cf3228ddcf4cd01a46b513.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*u_JLdF_L-vCHD11untNAlw.png"/></div></div><figcaption class="nj nk gj gh gi nl nm bd b be z dk">The red line touches precisely 2 points.</figcaption></figure><p id="b723" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">之后，我们计算每种类型的数据点在 k 个最近点的集合中所占的比例。然后，我们选择具有最高比例的类型，并将我们的新数据点分配给该类型。</p><p id="752a" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">在我们的例子中，最近的两个点都是黑色的。</p><pre class="ks kt ku kv gt nn no np nq aw nr bi"><span id="20c8" class="lz ma it no b gy ns nt l nu nv">Prop of black = 2/2<br/>Prop magenta = 0/2</span></pre><p id="bca9" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">因此，我们将把我们的新数据点归类为 b 类。</p><p id="54ad" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">另一方面，如果我们选择 k 为 8，我们将:</p><pre class="ks kt ku kv gt nn no np nq aw nr bi"><span id="7fc0" class="lz ma it no b gy ns nt l nu nv">Prop of black = 3/8<br/>Prop magenta = 5/8<br/></span></pre><p id="a79d" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">在这种情况下，我们会将新的数据点分配给类型 a。</p><h1 id="0974" class="mw ma it bd mb mx my mz me na nb nc mh ki nd kj mk kl ne km mn ko nf kp mq ng bi translated">回归设置</h1><p id="bfe7" class="pw-post-body-paragraph ld le it lf b lg mr kd li lj ms kg ll lm mt lo lp lq mu ls lt lu mv lw lx ly im bi translated">在这种情况下，我们在很大程度上遵循同样的想法。</p><p id="c2fe" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">例如，如果我们要使用 kNN 来预测房子的价格，我们可能有如下设置:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nw"><img src="../Images/eb5c4579d91f353d4023b949e3bbfe07.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EN-tSIn5Jm-MD4Hpf4C1xQ.png"/></div></div></figure><p id="8a98" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">我们希望找到 k 个最相似的点，并使用这些点的响应值的平均值作为所讨论的新数据点的预测值。</p><p id="30bf" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">如果我们让 k 为 6，并且我们想要使用这个数据集来预测一个有两个卫生间的房子的价格，那么最相似的数据点将首先是其他有两个卫生间的房子，然后是有一个和三个卫生间的房子。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nx"><img src="../Images/e1e7c55eafbe3989867108e4b86c2ddd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*z75pBD-nw1r8SJ4szfJbwQ.png"/></div></div></figure><p id="0f27" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">实际上，相应的预测价格值是洋红色点的平均价格。得到的预测是蓝点。</p><h1 id="c392" class="mw ma it bd mb mx my mz me na nb nc mh ki nd kj mk kl ne km mn ko nf kp mq ng bi translated">k 的选择</h1><p id="e1b1" class="pw-post-body-paragraph ld le it lf b lg mr kd li lj ms kg ll lm mt lo lp lq mu ls lt lu mv lw lx ly im bi translated">正如我们所见，K 的选择确实很重要。</p><p id="374b" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">请注意 K 值如何在数据没有任何变化的情况下改变模型的性能。任何这样的变量被称为<strong class="lf jd">超参数</strong>。</p><p id="8608" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">的确<strong class="lf jd">超参数优化</strong>本身就值得一整篇帖子。</p><p id="e91e" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">然而，出于本文的目的，我们将只提及<strong class="lf jd">网格搜索</strong>算法。</p><p id="7453" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">内容如下:</p><ul class=""><li id="4140" class="ny nz it lf b lg lh lj lk lm oa lq ob lu oc ly od oe of og bi translated">选择一组超参数值</li><li id="8439" class="ny nz it lf b lg oh lj oi lm oj lq ok lu ol ly od oe of og bi translated">使用这些值中的每一个值来训练模型</li><li id="e7c1" class="ny nz it lf b lg oh lj oi lm oj lq ok lu ol ly od oe of og bi translated">评估每个模型的性能，并选择导致误差最小的值。</li></ul><p id="f713" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">这是一个关于 k 值增加时，这个过程的大概情况。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi om"><img src="../Images/c55ff162e5da042755137eb3328a9d9b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZDoBek5h1Z7pWqsEjjtbtg.png"/></div></div><figcaption class="nj nk gj gh gi nl nm bd b be z dk">Generic Graph Showing How Test Error(Magenta) and Training Errors(Blue) Change over 1/K</figcaption></figure><h1 id="4dcf" class="mw ma it bd mb mx my mz me na nb nc mh ki nd kj mk kl ne km mn ko nf kp mq ng bi translated">最后的想法</h1><p id="83c7" class="pw-post-body-paragraph ld le it lf b lg mr kd li lj ms kg ll lm mt lo lp lq mu ls lt lu mv lw lx ly im bi translated">首先，kNN 受到维数灾难的困扰，因此随着输入变量数量的增加，kNN 可能会越来越困难。值得考虑使用降维技术来解决这个问题。</p><p id="0c95" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">此外，kNN 需要适当缩放的数据。换句话说，您可能必须对数据进行归一化，因为测量值之间的单位差异会严重损害模型的有效性。</p><p id="3ce5" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">另一件需要考虑的事情是，只要数据中的真实关系符合参数模型的假设，线性回归等参数方法往往会优于 kNN 等非参数方法。有趣的是，在一些不遵循所有假设的数据上，参数方法甚至可能比非参数方法表现得更好——所以不要排除它们！</p><p id="ac7e" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">总之，kNN 理解和实现起来相对简单，因此它是一个很好的方法，可以作为其他技术的基准。</p></div><div class="ab cl on oo hx op" role="separator"><span class="oq bw bk or os ot"/><span class="oq bw bk or os ot"/><span class="oq bw bk or os"/></div><div class="im in io ip iq"><p id="39b8" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">我希望你喜欢这本书，并发现它在某种程度上是有用的，无论是学习新的东西还是刷新已经存在的东西。</p><p id="bd9b" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated"><em class="ou">我本人是数学金融专业的应届毕业生，所以我既是一名教师，也是一名学习者。</em></p><p id="29fa" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated"><em class="ou">也就是说，我非常乐意接受任何建议、更正或你在阅读这篇文章时想到的任何一般性反馈。</em></p><p id="58e8" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated"><em class="ou">请随时在 LinkedIn 上与我联系— </em></p><div class="ov ow gp gr ox oy"><a href="https://www.linkedin.com/in/jovanmedforddataanalyst" rel="noopener  ugc nofollow" target="_blank"><div class="oz ab fo"><div class="pa ab pb cl cj pc"><h2 class="bd jd gy z fp pd fr fs pe fu fw jc bi translated">约万·梅德福德-加拿大滑铁卢大学| LinkedIn</h2><div class="pf l"><h3 class="bd b gy z fp pd fr fs pe fu fw dk translated">查看约万·梅德福德在全球最大的职业社区 LinkedIn 上的个人资料。Jovan 的教育列在…</h3></div><div class="pg l"><p class="bd b dl z fp pd fr fs pe fu fw dk translated">www.linkedin.com</p></div></div></div></a></div><p id="c703" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated"><em class="ou">如果你愿意，你也可以在 Twitter 上关注我— </em></p><div class="ov ow gp gr ox oy"><a href="https://twitter.com/JovanMedford" rel="noopener  ugc nofollow" target="_blank"><div class="oz ab fo"><div class="pa ab pb cl cj pc"><h2 class="bd jd gy z fp pd fr fs pe fu fw jc bi translated">约万·梅德福德(@约万麦德福德)|推特</h2><div class="pf l"><h3 class="bd b gy z fp pd fr fs pe fu fw dk translated">约万·梅德福德的最新推文(@JovanMedford)。一点特别的东西🤯|数学、金融和科技作家…</h3></div><div class="pg l"><p class="bd b dl z fp pd fr fs pe fu fw dk translated">twitter.com</p></div></div><div class="ph l"><div class="pi l pj pk pl ph pm lb oy"/></div></div></a></div></div></div>    
</body>
</html>