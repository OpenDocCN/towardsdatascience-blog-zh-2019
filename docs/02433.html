<html>
<head>
<title>A Simple Guide for Deploying A Spam Detector onto Google Cloud</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在 Google Cloud 上部署垃圾邮件检测器的简单指南</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/a-simple-guide-for-deploying-a-spam-detector-onto-google-cloud-ab1cd7163a21?source=collection_archive---------10-----------------------#2019-04-21">https://towardsdatascience.com/a-simple-guide-for-deploying-a-spam-detector-onto-google-cloud-ab1cd7163a21?source=collection_archive---------10-----------------------#2019-04-21</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="d138" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">谷歌云平台，Flask，分类合一</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/de406c13bf47b6b10feb675f9d764aad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9hllD1ZSX6haTSm4gYr_BA.jpeg"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Photo by <a class="ae kv" href="https://unsplash.com/photos/G_xJrvHN9nk?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Samuel Zeller</a> on <a class="ae kv" href="https://unsplash.com/search/photos/spam?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="e3a8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">你好👋！嗯，有很多关于建立各种用途的机器学习模型的指南，我最近看到了一个关于建立垃圾邮件检测器然后使用 Flask 部署它的指南。通过这一点，我决定通过部署到谷歌云平台上更进一步！当然，你也可以使用 Heroku，AWS 等，但这是另一天的另一个主题，我现在只关注 GCP。</p><h2 id="9485" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">项目的简要背景</h2><p id="0f7a" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">这是一种机器学习模型，通过对现有的标有“垃圾”或“火腿”的短信集合进行训练，对<a class="ae kv" href="https://github.com/georgeblu1/Spam-Detector-Web-App" rel="noopener ugc nofollow" target="_blank">垃圾短信</a>进行分类。垃圾邮件检测器采用 scikit-learn 的<a class="ae kv" href="https://scikit-learn.org/stable/modules/naive_bayes.html" rel="noopener ugc nofollow" target="_blank">多项式朴素贝叶斯</a>分类器，该分类器基于朴素贝叶斯算法，用于多项式分布数据:</p><blockquote class="mq mr ms"><p id="21d8" class="kw kx mt ky b kz la jr lb lc ld ju le mu lg lh li mv lk ll lm mw lo lp lq lr ij bi translated">朴素贝叶斯方法是一组基于应用贝叶斯定理的监督学习算法，其“朴素”假设是在给定类变量的值的情况下，每对要素之间的条件独立性。</p><p id="9714" class="kw kx mt ky b kz la jr lb lc ld ju le mu lg lh li mv lk ll lm mw lo lp lq lr ij bi translated">与更复杂的方法相比，朴素贝叶斯学习器和分类器可以非常快。类别条件特征分布的分离意味着每个分布可以被独立地估计为一维分布。这反过来又有助于缓解维数灾难带来的问题。</p></blockquote><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mx"><img src="../Images/5c5a544bf30fc7d087d37e6ad0910eac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ou6FFJJD3zhcIUU8wBZqIw.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Flask Logo</figcaption></figure><p id="b94f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">同时，Flask 作为 web 框架，通过前端接收用户的输入(HTTP 请求)并实现其预测功能。诞生于 2010 年的 Flask 以大多数标准来看都是一个小框架，小到可以被称为“微框架”。Flask 提高了其源代码的可读性和易理解性。Flask 是一个用 Python 编写的轻量级 Web 框架，它已经成为初创企业最广泛使用的 Python web 框架之一，也是大多数企业快速简单解决方案的完美工具。</p><blockquote class="my"><p id="4c4b" class="mz na iq bd nb nc nd ne nf ng nh lr dk translated">Flask 的目标是保持框架的核心小但高度可扩展，从而非常容易和灵活地编写应用程序或扩展，同时使开发人员能够为他们的应用程序选择自己的配置</p></blockquote><figure class="nj nk nl nm nn kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ni"><img src="../Images/9d3e63dcdfd5968b5fa3ccd1391d4671.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uHuMKEBYPiFYRub-UapQcg.jpeg"/></div></div></figure><h2 id="e563" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">在 Google 云平台上部署</h2><p id="7345" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">我们将在标准环境中使用<a class="ae kv" href="https://cloud.google.com/appengine/" rel="noopener ugc nofollow" target="_blank">谷歌应用引擎</a>。它允许我们“在完全托管的无服务器平台上构建高度可扩展的应用程序”。在继续之前，我将提出一些必要条件或假设:</p><ol class=""><li id="2784" class="no np iq ky b kz la lc ld lf nq lj nr ln ns lr nt nu nv nw bi translated">我假设您已经安装了 Flask 和虚拟环境中涉及的库(如果没有，将在后面显示)。</li><li id="61a4" class="no np iq ky b kz nx lc ny lf nz lj oa ln ob lr nt nu nv nw bi translated">您有一个可以访问<a class="ae kv" href="https://console.cloud.google.com" rel="noopener ugc nofollow" target="_blank">谷歌云平台控制台</a>的谷歌账户，并在上面创建了一个新项目。</li></ol><blockquote class="mq mr ms"><p id="a0a5" class="kw kx mt ky b kz la jr lb lc ld ju le mu lg lh li mv lk ll lm mw lo lp lq lr ij bi translated">确保为您的项目启用<strong class="ky ir">计费</strong>。为了将应用程序部署到 App Engine，需要将计费帐户链接到您的项目</p></blockquote><p id="7af6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">3.已安装<a class="ae kv" href="https://cloud.google.com/sdk/" rel="noopener ugc nofollow" target="_blank"> Google Cloud SDK </a>，按照其说明进行安装。</p><p id="af17" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">4.您已经成功地在本地测试了您的应用程序。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/d6ce7cbdc8a3d8a0d3b2a30f971b3e9e.png" data-original-src="https://miro.medium.com/v2/resize:fit:420/format:webp/1*FIdL-eKaYUVkqWlZH55GCQ.png"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Project Folder Structure</figcaption></figure><p id="1776" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">大致来说，您的主文件夹将具有这种结构，请注意“nlp”是我的虚拟环境，我们将在下面创建 app.yaml、appengine_config.py 和 requirements.txt:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="od oe l"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">app.yaml</figcaption></figure><p id="28a3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">示例 app.yaml 指定了应用程序应该运行的运行时，对于这个项目，它将在 Python 3.7 上运行。对于 Python 2.7，可以参考下面的代码:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="od oe l"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Python 2.7 app.yaml</figcaption></figure><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="od oe l"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">app_engine_config.py</figcaption></figure><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="od oe l"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">requirements.txt</figcaption></figure><p id="e1b6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果您没有将必要的库安装到虚拟环境中，您可以使用下面的代码。应该首先激活环境，并使用终端、命令提示符等来访问它，以便根据需求安装新的依赖项。</p><pre class="kg kh ki kj gt of og oh oi aw oj bi"><span id="35b4" class="ls lt iq og b gy ok ol l om on">pip install -t lib -r requirements.txt</span></pre><p id="e372" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> -t lib: </strong>此标志将库复制到 lib 文件夹中，该文件夹在部署期间上传到 App Engine。</p><p id="ebc4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> -r requirements.txt: </strong> pip 安装 requirements.txt 中的所有内容。</p><h1 id="c24d" class="oo lt iq bd lu op oq or lx os ot ou ma jw ov jx md jz ow ka mg kc ox kd mj oy bi translated">部署</h1><p id="4a91" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">在我们开始之前，最好(可选)更新已安装的云 SDK:</p><pre class="kg kh ki kj gt of og oh oi aw oj bi"><span id="6c9e" class="ls lt iq og b gy ok ol l om on">gcloud components update</span></pre><p id="6585" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然后，在<strong class="ky ir">根文件夹</strong>，我们将使用您的 cmd/终端部署它，代码如下:</p><pre class="kg kh ki kj gt of og oh oi aw oj bi"><span id="c3c9" class="ls lt iq og b gy ok ol l om on">gcloud app deploy --project [ID of Project]</span></pre><p id="3aab" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">或者你也可以在没有项目 ID 的情况下完成！</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oz"><img src="../Images/5202b0ed6aaeaad898f3f5cf133a8824.png" data-original-src="https://miro.medium.com/v2/resize:fit:1222/format:webp/1*SAwXomRs9S_zy9c0I1Rpgg.png"/></div></figure><p id="bb9a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">根据您的项目，选择最合适的区域并等待几分钟，它将为您提供一个链接，任何人都可以访问该链接来查看/使用您的 web 应用程序！</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi pa"><img src="../Images/d1af4364079907aafa59538df4e382f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1298/format:webp/1*26E4h-XcFitNOqXwekbGHw.png"/></div></figure><p id="c28c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">或者只使用下面的代码:</p><pre class="kg kh ki kj gt of og oh oi aw oj bi"><span id="5d59" class="ls lt iq og b gy ok ol l om on">gcloud app browse --project=<br/>#the link usually is "projectid".appspot.com</span></pre><h1 id="dc2d" class="oo lt iq bd lu op oq or lx os ot ou ma jw ov jx md jz ow ka mg kc ox kd mj oy bi translated">结论</h1><p id="787d" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">瞧啊。GCP 使部署 web 应用程序的过程变得更快、更容易。我希望我可以尝试在不久的将来或其他项目的其他选择。如果有任何问题，请随时联系我！我的网站可以在这里找到:<a class="ae kv" href="http://spamdetector.appspot.com" rel="noopener ugc nofollow" target="_blank">spamdetector.appspot.com</a></p></div><div class="ab cl pb pc hu pd" role="separator"><span class="pe bw bk pf pg ph"/><span class="pe bw bk pf pg ph"/><span class="pe bw bk pf pg"/></div><div class="ij ik il im in"><p id="401b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">参考</p><ol class=""><li id="9353" class="no np iq ky b kz la lc ld lf nq lj nr ln ns lr nt nu nv nw bi translated">存储库:<a class="ae kv" href="https://github.com/georgeblu1/Spam-Detector-Web-App" rel="noopener ugc nofollow" target="_blank">https://github.com/georgeblu1/Spam-Detector-Web-App</a></li><li id="7fb0" class="no np iq ky b kz nx lc ny lf nz lj oa ln ob lr nt nu nv nw bi translated">用 Python 开发 NLP 模型&amp;用 Flask 逐步部署:<a class="ae kv" rel="noopener" target="_blank" href="/develop-a-nlp-model-in-python-deploy-it-with-flask-step-by-step-744f3bdd7776">https://towardsdatascience . com/develop-a-NLP-Model-in-Python-Deploy-It-with-Flask-Step-Step-744 F3 BDD 7776</a></li><li id="1843" class="no np iq ky b kz nx lc ny lf nz lj oa ln ob lr nt nu nv nw bi translated"><a class="ae kv" href="https://www.packtpub.com/web-development/flask-framework-cookbook" rel="noopener ugc nofollow" target="_blank">烧瓶框架食谱</a></li><li id="0a27" class="no np iq ky b kz nx lc ny lf nz lj oa ln ob lr nt nu nv nw bi translated"><a class="ae kv" href="https://www.oreilly.com/library/view/flask-web-development/9781491991725/" rel="noopener ugc nofollow" target="_blank">砂箱网开发</a></li><li id="e6ef" class="no np iq ky b kz nx lc ny lf nz lj oa ln ob lr nt nu nv nw bi translated"><a class="ae kv" href="https://www.amazon.com/Python-Machine-Learning-Sebastian-Raschka-ebook/dp/B00YSILNL0" rel="noopener ugc nofollow" target="_blank"> Python 机器学习</a></li></ol></div></div>    
</body>
</html>