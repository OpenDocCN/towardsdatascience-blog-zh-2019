<html>
<head>
<title>Clustering in detail</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">详细聚类</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/clustering-in-detail-b439f31c56b7?source=collection_archive---------32-----------------------#2019-10-22">https://towardsdatascience.com/clustering-in-detail-b439f31c56b7?source=collection_archive---------32-----------------------#2019-10-22</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><blockquote class="jq jr js"><p id="1bbc" class="jt ju jv jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr im bi translated">它需要上下文、情节、算法、度量和摆弄！</p></blockquote><p id="acdc" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke ks kg kh ki kt kk kl km ku ko kp kq kr im bi translated">一些数据科学课程的学生向我展示了他们在互联网上找到的关于巴西各州的非常有趣的数据集。</p><blockquote class="jq jr js"><p id="5bfb" class="jt ju jv jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr im bi translated">第一个情节就是爱情！</p></blockquote><p id="39ee" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke ks kg kh ki kt kk kl km ku ko kp kq kr im bi translated">但是要抓住它的一些细微差别，需要的不仅仅是第一个情节。</p><h1 id="6d5c" class="kw kx it bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">背景:巴西，一个联邦共和国</h1><p id="8dd7" class="pw-post-body-paragraph jt ju it jw b jx lu jz ka kb lv kd ke ks lw kh ki kt lx kl km ku ly kp kq kr im bi translated">如果你不是来自巴西，也不是来自以州为单位的国家，让我给你提个醒。</p><p id="114c" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke ks kg kh ki kt kk kl km ku ko kp kq kr im bi translated">在巴西，政治体系分为三级政府:联邦政府、州政府和市政府。</p><p id="d9d2" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke ks kg kh ki kt kk kl km ku ko kp kq kr im bi translated">美国有 26 个州，外加一个联邦区(DF)，分为五个地理区域:</p><figure class="ma mb mc md gt me gh gi paragraph-image"><div role="button" tabindex="0" class="mf mg di mh bf mi"><div class="gh gi lz"><img src="../Images/f9cffab1967726f445e541b599da1d68.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1CyEge4gP-JWTm-lu--hvw.png"/></div></div></figure><h1 id="d49e" class="kw kx it bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">情节:巴西，一个高度不平等的共和国</h1><p id="3d3c" class="pw-post-body-paragraph jt ju it jw b jx lu jz ka kb lv kd ke ks lw kh ki kt lx kl km ku ly kp kq kr im bi translated">作为巴西人，我们总是听到人们谈论圣保罗(SP)在经济方面与该国其他地区有何不同。</p><p id="978c" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke ks kg kh ki kt kk kl km ku ko kp kq kr im bi translated">我去过圣保罗的首府几次，对这个城市的人口过剩有所了解。</p><p id="ae4b" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke ks kg kh ki kt kk kl km ku ko kp kq kr im bi translated">但是没有什么能真正让我为这个阴谋做好准备😵：</p><figure class="ma mb mc md gt me gh gi paragraph-image"><div role="button" tabindex="0" class="mf mg di mh bf mi"><div class="gh gi ml"><img src="../Images/77d7f1f5ff1faff7aa4142c00683f142.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*O8V5SRqfhEkog-Ra3j_gsw.png"/></div></div></figure><p id="db4a" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke ks kg kh ki kt kk kl km ku ko kp kq kr im bi translated">此时，很容易得出结论，SP 是数据中的一个强异常值，应该将其丢弃，以便我们可以更好地理解剩余的数据:</p><figure class="ma mb mc md gt me gh gi paragraph-image"><div role="button" tabindex="0" class="mf mg di mh bf mi"><div class="gh gi mm"><img src="../Images/a0439be6adaf5795552660da74c34d72.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XpEENwD1HQtFav1OKopISA.png"/></div></div><figcaption class="mn mo gj gh gi mp mq bd b be z dk">Zooming by discarding SP from the plot</figcaption></figure><blockquote class="jq jr js"><p id="c219" class="jt ju jv jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr im bi translated">但是是吗？我们真的应该抛弃它吗？</p></blockquote><p id="7151" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke ks kg kh ki kt kk kl km ku ko kp kq kr im bi translated">让我们再坚持一会儿。</p><h1 id="da76" class="kw kx it bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">算法:从简单的开始</h1><p id="4848" class="pw-post-body-paragraph jt ju it jw b jx lu jz ka kb lv kd ke ks lw kh ki kt lx kl km ku ly kp kq kr im bi translated">因为这个数据集非常简单，所以在聚类之前没有太多的 EDA(探索性数据分析)要做。</p><p id="17c1" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke ks kg kh ki kt kk kl km ku ko kp kq kr im bi translated">让我们在选择聚类算法时也保持简单。</p><h2 id="95fc" class="mr kx it bd ky ms mt dn lc mu mv dp lg ks mw mx lk kt my mz lo ku na nb ls nc bi translated">k 均值</h2><blockquote class="jq jr js"><p id="9928" class="jt ju jv jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr im bi translated">k-means 几乎不需要配置。差不多了。</p></blockquote><p id="e668" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke ks kg kh ki kt kk kl km ku ko kp kq kr im bi translated">是的。k-means 假设聚类的数量作为输入，<em class="jv"> k </em>。</p><blockquote class="jq jr js"><p id="68fa" class="jt ju jv jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr im bi translated">但是我们不知道。</p></blockquote><p id="e180" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke ks kg kh ki kt kk kl km ku ko kp kq kr im bi translated">让我们用<a class="ae kv" href="https://orange.biolab.si" rel="noopener ugc nofollow" target="_blank">橙 3 </a>来帮助我们。</p><p id="8923" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke ks kg kh ki kt kk kl km ku ko kp kq kr im bi translated">当您打开 k-means 小部件时，Orange3 允许我们为<em class="jv"> k、</em>选择一系列值，并测试它们以检查我们可以从这些不同的值中获得的轮廓分数:</p><figure class="ma mb mc md gt me gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/c82ac5afdcabbae1eeff9ee22d423e16.png" data-original-src="https://miro.medium.com/v2/resize:fit:1130/format:webp/1*bk8BJS55SzqCKzmqCk-y-w.png"/></div><figcaption class="mn mo gj gh gi mp mq bd b be z dk">k-means widget from Orange3</figcaption></figure><p id="ebaf" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke ks kg kh ki kt kk kl km ku ko kp kq kr im bi translated">正如所料，我们能做的最好的聚类是将 SP 与其余数据隔离开来。</p><blockquote class="jq jr js"><p id="957b" class="jt ju jv jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr im bi translated">这显示了 k-means 如何对异常值敏感，但这不是本文的重点。</p></blockquote><p id="35bd" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke ks kg kh ki kt kk kl km ku ko kp kq kr im bi translated">第二好的<em class="jv"> k </em>值是 4。让我们检查一下侧影图:</p><figure class="ma mb mc md gt me gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/c944c3c9957b38a47b1cf8b2b29a0c93.png" data-original-src="https://miro.medium.com/v2/resize:fit:828/format:webp/1*rGpoTMZKA76ichO23iUF_w.png"/></div><figcaption class="mn mo gj gh gi mp mq bd b be z dk">Silhoutte plot for k-means with four clusters.</figcaption></figure><p id="7a94" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke ks kg kh ki kt kk kl km ku ko kp kq kr im bi translated">在轮廓图中，如果一个观察值与其聚类邻居的相似度大于与另一个聚类中的观察值的相似度，则该观察值将被评为正值(最大值为 1.0)。</p><p id="ee65" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke ks kg kh ki kt kk kl km ku ko kp kq kr im bi translated">让我们看看这种群集是什么样子的:</p><figure class="ma mb mc md gt me gh gi paragraph-image"><div role="button" tabindex="0" class="mf mg di mh bf mi"><div class="gh gi ml"><img src="../Images/029e476769cac7d785eb607c84fc1c39.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TX1kbNWh3s2fPHhzt1IbgQ.png"/></div></div><figcaption class="mn mo gj gh gi mp mq bd b be z dk">Scatter plot for k-means with four clusters. In this plot, São Paulo is the clear outlier.</figcaption></figure><blockquote class="jq jr js"><p id="79bb" class="jt ju jv jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr im bi translated">嗯（表示踌躇等）..很好，但不完美。</p></blockquote><p id="770c" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke ks kg kh ki kt kk kl km ku ko kp kq kr im bi translated">是的，这有时会发生在 k-means 身上。</p><p id="5935" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke ks kg kh ki kt kk kl km ku ko kp kq kr im bi translated">Orange3 显示的分数是 10 次运行的平均值，但单次运行可能不太合适。</p><h2 id="8176" class="mr kx it bd ky ms mt dn lc mu mv dp lg ks mw mx lk kt my mz lo ku na nb ls nc bi translated">分层聚类</h2><p id="fd96" class="pw-post-body-paragraph jt ju it jw b jx lu jz ka kb lv kd ke ks lw kh ki kt lx kl km ku ly kp kq kr im bi translated">另一种简单的集群方法叫做层次化，但是需要更多的工作。</p><p id="a027" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke ks kg kh ki kt kk kl km ku ko kp kq kr im bi translated">关键的一点是，人们可以使用交互式树形图浏览不同的聚类数可能性:</p><figure class="ma mb mc md gt me gh gi paragraph-image"><div role="button" tabindex="0" class="mf mg di mh bf mi"><div class="gh gi nf"><img src="../Images/bd22e71305439e52558cb6c3470e2538.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OGRhwHRfOH60eog3ZJRwlQ.png"/></div></div><figcaption class="mn mo gj gh gi mp mq bd b be z dk">Hierarchical clustering widget using Euclidean distance and Ward’s linkage</figcaption></figure><blockquote class="jq jr js"><p id="8a9b" class="jt ju jv jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr im bi translated">OMG，左边面板这么多选项<em class="it">😱</em></p></blockquote><p id="50c6" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke ks kg kh ki kt kk kl km ku ko kp kq kr im bi translated">是的，这是一个非常<strong class="jw iu">可配置的</strong>算法，你可以谷歌这些选项中的大部分。</p><p id="692a" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke ks kg kh ki kt kk kl km ku ko kp kq kr im bi translated">我只是想说明，对于六个集群，我们得到了以下轮廓图:</p><figure class="ma mb mc md gt me gh gi paragraph-image"><div role="button" tabindex="0" class="mf mg di mh bf mi"><div class="gh gi ng"><img src="../Images/60a492b834bb5fee5aeb9a6b28813ce3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eZkhqXfO72qYCM5yBEFLOA.png"/></div></div><figcaption class="mn mo gj gh gi mp mq bd b be z dk">Silhouette plot for hierarchical clustering with six clusters using Euclidean distance and Ward’s linkage</figcaption></figure><p id="62f6" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke ks kg kh ki kt kk kl km ku ko kp kq kr im bi translated">请注意集群的变化，这不仅仅是因为集群数量的变化:</p><figure class="ma mb mc md gt me gh gi paragraph-image"><div role="button" tabindex="0" class="mf mg di mh bf mi"><div class="gh gi mm"><img src="../Images/71ab8eabe3eb77f2c5302c77774c319a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tkH4v5DNQ7PLdD-HqXCezw.png"/></div></div></figure><p id="7359" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke ks kg kh ki kt kk kl km ku ko kp kq kr im bi translated">从上面的图中，我们可以看到聚类主要是根据它们到原点的距离来划分的。</p><p id="d83c" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke ks kg kh ki kt kk kl km ku ko kp kq kr im bi translated">k-means 和层次聚类都尝试过这样做，因为它们认为如果两个状态在这个二维空间中接近，它们就是相似的。</p><blockquote class="jq jr js"><p id="2d91" class="jt ju jv jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr im bi translated">那就是<strong class="jw iu">欧几里德距离</strong>！</p></blockquote><p id="1c99" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke ks kg kh ki kt kk kl km ku ko kp kq kr im bi translated">没错。</p><h1 id="4e6e" class="kw kx it bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">度量:完全改变你的视角</h1><p id="ea43" class="pw-post-body-paragraph jt ju it jw b jx lu jz ka kb lv kd ke ks lw kh ki kt lx kl km ku ly kp kq kr im bi translated">现在，在我们研究的早期，我和我的学生开始注意到这两个属性之间的比率本身就是一个属性。</p><blockquote class="jq jr js"><p id="dde2" class="jt ju jv jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr im bi translated">人均 GDP！</p></blockquote><p id="d93a" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke ks kg kh ki kt kk kl km ku ko kp kq kr im bi translated">是的，这是一个非常有趣的属性来说明一个国家真正的富裕程度。</p><blockquote class="jq jr js"><p id="c46b" class="jt ju jv jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr im bi translated">所以我们可以通过组合前两个属性来创建第三个属性🙃</p></blockquote><p id="8272" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke ks kg kh ki kt kk kl km ku ko kp kq kr im bi translated">是的，但不是。如果我们已经可以从现有的属性中获取信息，我们通常会避免创建新的属性。</p><blockquote class="jq jr js"><p id="0e8a" class="jt ju jv jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr im bi translated">为什么？<em class="it">🤔</em></p></blockquote><p id="52b1" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke ks kg kh ki kt kk kl km ku ko kp kq kr im bi translated">因为那样的话，我们的绘图将变成 3D 的，更不用说许多其他的问题了(我们正在谈论一个非常简化的数据集)..</p><blockquote class="jq jr js"><p id="27f9" class="jt ju jv jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr im bi translated">等等，我们如何从这个情节中掌握信息？</p></blockquote><p id="012c" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke ks kg kh ki kt kk kl km ku ko kp kq kr im bi translated">我们将把该图的对角线作为参考。</p><p id="3245" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke ks kg kh ki kt kk kl km ku ko kp kq kr im bi translated">位于这条对角线右侧的州人口数量会增加。</p><p id="0513" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke ks kg kh ki kt kk kl km ku ko kp kq kr im bi translated">相反的情况也是如此:这条对角线左边的州有向更大的 GDP 转移的趋势。</p><blockquote class="jq jr js"><p id="fdd7" class="jt ju jv jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr im bi translated">但是，我们如何告诉算法在没有第三个属性的情况下寻找它呢？</p></blockquote><p id="925b" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke ks kg kh ki kt kk kl km ku ko kp kq kr im bi translated">我们改变相似性度量:如果两个状态所代表的向量之间的角度很小，余弦距离使这两个状态变得相似。</p><blockquote class="jq jr js"><p id="1d0f" class="jt ju jv jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr im bi translated">等等，什么？</p></blockquote><p id="f55a" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke ks kg kh ki kt kk kl km ku ko kp kq kr im bi translated">检查情节:</p><figure class="ma mb mc md gt me gh gi paragraph-image"><div role="button" tabindex="0" class="mf mg di mh bf mi"><div class="gh gi ml"><img src="../Images/9c247f850c8190f212004923930418df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*b3UFr-Uu4RasBpVePMG9OA.png"/></div></div><figcaption class="mn mo gj gh gi mp mq bd b be z dk">Scatter plot for hierarchical clustering using cosine distance and Ward’s linkage, with six clusters.</figcaption></figure><blockquote class="jq jr js"><p id="9478" class="jt ju jv jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr im bi translated">我不明白。</p></blockquote><p id="b516" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke ks kg kh ki kt kk kl km ku ko kp kq kr im bi translated">试试这个:</p><figure class="ma mb mc md gt me gh gi paragraph-image"><div role="button" tabindex="0" class="mf mg di mh bf mi"><div class="gh gi ml"><img src="../Images/c26f226ad1e688f68ba18d2e0bae4d86.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EsU0f_i9t7PH_-sKy8Pk1A.png"/></div></div><figcaption class="mn mo gj gh gi mp mq bd b be z dk">Regression lines illustrating that the cosine distance values the angle with regard to the origin.</figcaption></figure><blockquote class="jq jr js"><p id="a8f3" class="jt ju jv jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr im bi translated">操！<em class="it">😱</em></p></blockquote><p id="5b23" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke ks kg kh ki kt kk kl km ku ko kp kq kr im bi translated">是的。</p><h1 id="51a5" class="kw kx it bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">总结:巴西是如何真正分裂的</h1><figure class="ma mb mc md gt me gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/55993ebcc4fe1cc63056feaef51b9b75.png" data-original-src="https://miro.medium.com/v2/resize:fit:828/format:webp/1*oTdoBYAxemSoW5MMH7k4DA.png"/></div></figure><p id="5203" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke ks kg kh ki kt kk kl km ku ko kp kq kr im bi translated">关于最后一个聚类结果，最有趣的事情之一是，当我们分析它时，它很有意义:</p><ul class=""><li id="7ab7" class="nh ni it jw b jx jy kb kc ks nj kt nk ku nl kr nm nn no np bi translated">当谈到财富时，DF 是巴西最重要的局外人，如果你认为 DF 的商业只是政治，那绝对是疯狂的！</li><li id="5cad" class="nh ni it jw b jx nq kb nr ks ns kt nt ku nu kr nm nn no np bi translated">巴西东南部通常被认为是该国最富裕的地区，但除了少数例外，南部和中西部地区超过了它！</li><li id="9440" class="nh ni it jw b jx nq kb nr ks ns kt nt ku nu kr nm nn no np bi translated">到目前为止，巴西的北部和东北部是该国最危急的地区。</li></ul><p id="000b" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke ks kg kh ki kt kk kl km ku ko kp kq kr im bi translated">现在让我们把这当成一个练习:想象另一个巴西，政治不是为了致富，在 SP 堆积的企业遍布北部和东北部。</p><blockquote class="jq jr js"><p id="5849" class="jt ju jv jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr im bi translated">这是我想看的一个情节😆</p></blockquote></div></div>    
</body>
</html>