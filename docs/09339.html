<html>
<head>
<title>Introduction to Papermill</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">造纸厂简介</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/introduction-to-papermill-2c61f66bea30?source=collection_archive---------3-----------------------#2019-12-10">https://towardsdatascience.com/introduction-to-papermill-2c61f66bea30?source=collection_archive---------3-----------------------#2019-12-10</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="5f31" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">如何将您的 Jupyter 笔记本转变为工作流程工具</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/b957e07c9afbfeb8b08cf7dea7ea659d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hvz-MB0_3I_T2gOCGvBzag.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Figure 1. Papermill and Jupyter Project logos</figcaption></figure><h1 id="6a08" class="ky kz it bd la lb lc ld le lf lg lh li jz lj ka lk kc ll kd lm kf ln kg lo lp bi translated">1.介绍</h1><p id="4818" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated"><a class="ae mm" href="https://jupyter.org/" rel="noopener ugc nofollow" target="_blank"> Jupyter 笔记本</a>是探索性数据分析(EDA)的黄金标准，也是记录数据科学项目的绝佳工具。虽然数据科学家通常在其中迭代工作(不遵循自上而下的单元顺序)，但它可以从第一个到最后一个单元运行，逐步再现数据分析。</p><p id="00ae" class="pw-post-body-paragraph lq lr it ls b lt mn ju lv lw mo jx ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated">使用 Jupyter 笔记本执行重复性任务和 ETL 时出现的一个问题是，它缺乏自动化和日志记录功能。缺乏自动化意味着您必须在需要时打开相应的笔记本并手动运行它，并且缺乏日志记录，您无法控制执行过程中可能出现的错误和异常。</p><h2 id="f0bd" class="ms kz it bd la mt mu dn le mv mw dp li lz mx my lk md mz na lm mh nb nc lo nd bi translated">1.1 进入造纸厂</h2><p id="d807" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated"><a class="ae mm" href="https://github.com/nteract/papermill" rel="noopener ugc nofollow" target="_blank"> <strong class="ls iu"> Papermill </strong> </a>是一个可以让我们参数化执行笔记本的工具。它在数据工作流工具上通过顺序执行每个单元格来转换您的 Jupyter 笔记本，而无需打开 JupyterLab(或笔记本)。它试图填补自动化和日志记录的空白，为我们提供了一种将笔记本作为文件执行的方式，并为每次执行生成一份报告。</p></div><div class="ab cl ne nf hx ng" role="separator"><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj"/></div><div class="im in io ip iq"><p id="706d" class="pw-post-body-paragraph lq lr it ls b lt mn ju lv lw mo jx ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated"><strong class="ls iu">目标</strong>:本文的目标是集成 Papermill 和 Jupyter 笔记本来创建数据工作流。为了说明这一点，我们将开发一个 Python 笔记本，使用天气预报 API ( <a class="ae mm" href="https://pyowm.readthedocs.io/en/latest/" rel="noopener ugc nofollow" target="_blank"> <strong class="ls iu"> PyOWM </strong> </a>)运行一个简单的分析，执行数据辩论，生成一些可视化结果，并创建一个最终报告。</p></div><div class="ab cl ne nf hx ng" role="separator"><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj"/></div><div class="im in io ip iq"><p id="86d6" class="pw-post-body-paragraph lq lr it ls b lt mn ju lv lw mo jx ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated">Jupyter 笔记本和其他具有更多数据分析细节的文件可以在<a class="ae mm" href="https://github.com/GabrielSGoncalves/papermill_medium" rel="noopener ugc nofollow" target="_blank"> <strong class="ls iu"> GitHub 项目资源库</strong> </a> <strong class="ls iu">中找到。</strong>要重现分析，您需要安装<a class="ae mm" href="https://github.com/GabrielSGoncalves/papermill_medium/blob/master/papermill_env.yaml" rel="noopener ugc nofollow" target="_blank"><strong class="ls iu">paper mill _ env . YAML</strong>上列出的库。</a></p></div><div class="ab cl ne nf hx ng" role="separator"><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj"/></div><div class="im in io ip iq"><h1 id="6f8a" class="ky kz it bd la lb nl ld le lf nm lh li jz nn ka lk kc no kd lm kf np kg lo lp bi translated">2.配置我们的开发环境</h1><h2 id="c7bb" class="ms kz it bd la mt mu dn le mv mw dp li lz mx my lk md mz na lm mh nb nc lo nd bi translated">2.1 安装 Papermill 和 JupyterLab</h2><p id="a526" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">我们将首先使用 Conda <strong class="ls iu"> (1，2) </strong>创建一个开发环境，并安装 JupyterLab 和其他用于分析的库<strong class="ls iu"> (3) </strong>。</p><pre class="kj kk kl km gt nq nr ns nt aw nu bi"><span id="8bba" class="ms kz it nr b gy nv nw l nx ny"><strong class="nr iu"># 1) Create a conda environment<br/></strong>conda create -n papermill python=3.7</span><span id="2851" class="ms kz it nr b gy nz nw l nx ny"><strong class="nr iu"># 2) Activate it<br/></strong>conda activate papermill </span><span id="1298" class="ms kz it nr b gy nz nw l nx ny"><strong class="nr iu"># 3) Install the libraries using pip (or conda)<br/></strong>pip install papermill pyowm jupyterlab pandas seaborn boto3 pdfkit</span></pre><p id="63aa" class="pw-post-body-paragraph lq lr it ls b lt mn ju lv lw mo jx ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated">有关如何使用<a class="ae mm" href="https://docs.conda.io/en/latest/miniconda.html" rel="noopener ugc nofollow" target="_blank"> conda </a>和其他开源工具来组织您的项目的更多信息，请查看我以前的文章<a class="ae mm" rel="noopener" target="_blank" href="/creating-a-solid-data-science-development-environment-60df14ce3a34"> <strong class="ls iu">“创建坚实的数据科学开发环境”。</strong> </a></p><p id="0f90" class="pw-post-body-paragraph lq lr it ls b lt mn ju lv lw mo jx ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated">安装 Papermill 后，我们可以通过终端<strong class="ls iu"> (4) </strong>获得更多信息。</p><pre class="kj kk kl km gt nq nr ns nt aw nu bi"><span id="7b5e" class="ms kz it nr b gy nv nw l nx ny"><strong class="nr iu"># 4) Papermill Documentation<br/></strong>papermill -h</span><span id="44eb" class="ms kz it nr b gy nz nw l nx ny">Usage: papermill [OPTIONS] NOTEBOOK_PATH OUTPUT_PATH</span><span id="48d2" class="ms kz it nr b gy nz nw l nx ny">This utility executes a single notebook in a subprocess.</span><span id="75f6" class="ms kz it nr b gy nz nw l nx ny">Papermill takes a source notebook, applies parameters to the source<br/>  notebook, executes the (4)notebook with the specified kernel, and saves the<br/>  output in the destination notebook.</span><span id="974e" class="ms kz it nr b gy nz nw l nx ny">The NOTEBOOK_PATH and OUTPUT_PATH can now be replaced by `-` representing<br/>  stdout and stderr, or by the presence of pipe inputs / outputs. Meaning<br/>  that</span><span id="aef0" class="ms kz it nr b gy nz nw l nx ny">`&lt;generate input&gt;... | papermill | ...&lt;process output&gt;`</span><span id="88a6" class="ms kz it nr b gy nz nw l nx ny">with `papermill - -` being implied by the pipes will read a notebook from<br/>  stdin and write it out to stdout.</span><span id="83b9" class="ms kz it nr b gy nz nw l nx ny">Options:<br/>  -p, --parameters TEXT...        Parameters to pass to the parameters cell.<br/>  -r, --parameters_raw TEXT...    Parameters to be read as raw string.<br/>  -f, --parameters_file TEXT      Path to YAML file containing parameters.<br/>  -y, --parameters_yaml TEXT      YAML string to be used as parameters.<br/>  -b, --parameters_base64 TEXT    Base64 encoded YAML string as parameters.<br/>  --inject-input-path             Insert the path of the input notebook as<br/>                                  PAPERMILL_INPUT_PATH as a notebook<br/>                                  parameter.<br/>  --inject-output-path            Insert the path of the output notebook as<br/>                                  PAPERMILL_OUTPUT_PATH as a notebook<br/>                                  parameter.<br/>  --inject-paths                  Insert the paths of input/output notebooks<br/>                                  as<br/>                                  PAPERMILL_INPUT_PATH/PAPERMILL_OUTPUT_PATH<br/>                                  as notebook parameters.<br/>  --engine TEXT                   The execution engine name to use in<br/>                                  evaluating the notebook.<br/>  --request-save-on-cell-execute / --no-request-save-on-cell-execute<br/>                                  Request save notebook after each cell<br/>                                  execution<br/>  --prepare-only / --prepare-execute<br/>                                  Flag for outputting the notebook without<br/>                                  execution, but with parameters applied.<br/>  -k, --kernel TEXT               Name of kernel to run.<br/>  --cwd TEXT                      Working directory to run notebook in.<br/>  --progress-bar / --no-progress-bar<br/>                                  Flag for turning on the progress bar.<br/>  --log-output / --no-log-output  Flag for writing notebook output to the<br/>                                  configured logger.<br/>  --stdout-file FILENAME          File to write notebook stdout output to.<br/>  --stderr-file FILENAME          File to write notebook stderr output to.<br/>  --log-level [NOTSET|DEBUG|INFO|WARNING|ERROR|CRITICAL]<br/>                                  Set log level<br/>  --start_timeout INTEGER         Time in seconds to wait for kernel to start.<br/>  --report-mode / --no-report-mode<br/>                                  Flag for hiding input.<br/>  --version                       Flag for displaying the version.<br/>  -h, --help                      Show this message and exit.</span></pre><p id="a00d" class="pw-post-body-paragraph lq lr it ls b lt mn ju lv lw mo jx ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated">正如我们从<a class="ae mm" href="https://papermill.readthedocs.io/en/latest/" rel="noopener ugc nofollow" target="_blank"> <strong class="ls iu"> Papermill 文档</strong> </a>中看到的，基本用法非常简单，我们只需要提供目标 Jupyter 笔记本的路径和输出笔记本的名称(作为日志工作)。我们将在本文后面探讨一些额外的选项。</p><h2 id="8c1e" class="ms kz it bd la mt mu dn le mv mw dp li lz mx my lk md mz na lm mh nb nc lo nd bi translated"><strong class="ak"> 2.2 安装 Jupyter 内核</strong></h2><p id="d337" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">尽管 Jupyter 笔记本以运行 Python 而闻名，但我们可以通过安装不同的内核来使用几乎任何编程语言。有了特定的内核，我们可以在 Papermill 定义的环境中运行我们的笔记本，避免了缺少库的问题<strong class="ls iu"> (5) </strong>。</p><pre class="kj kk kl km gt nq nr ns nt aw nu bi"><span id="e6a1" class="ms kz it nr b gy nv nw l nx ny"><strong class="nr iu"># 5) Install Jupyter kernel for papermill environment<br/></strong>pip install ipykernel<strong class="nr iu"><br/></strong>ipython kernel install --user --name=papermill-tutorial</span></pre></div><div class="ab cl ne nf hx ng" role="separator"><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj"/></div><div class="im in io ip iq"><h1 id="0b6d" class="ky kz it bd la lb nl ld le lf nm lh li jz nn ka lk kc no kd lm kf np kg lo lp bi translated">3.创建工作流</h1><p id="0757" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">我们将使用 Jupyter 笔记本进行天气预报数据分析。其想法是创建一个简单的工作流，使用名为<a class="ae mm" href="https://pyowm.readthedocs.io/en/latest/" rel="noopener ugc nofollow" target="_blank"> <strong class="ls iu">的 Python API 获取特定城市的数据，执行数据争论，创建一些图表并在 pdf 报告上组织信息。</strong></a></p><h2 id="c397" class="ms kz it bd la mt mu dn le mv mw dp li lz mx my lk md mz na lm mh nb nc lo nd bi translated">3.1 使用 PyOWM 天气 API</h2><p id="8bc4" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">如<a class="ae mm" href="https://pyowm.readthedocs.io/en/latest/" rel="noopener ugc nofollow" target="_blank">库主页</a>所述，“PyOWM 是 OpenWeatherMap web APIs 的客户端 Python 包装库”。它通过提供一个“简单的对象模型”来方便访问天气数据。使用这个库的唯一要求是一个 API 密匙，可以在<a class="ae mm" href="https://openweathermap.org/appid" rel="noopener ugc nofollow" target="_blank"> OpenWeather 链接</a>上免费获得。</p><h2 id="c28a" class="ms kz it bd la mt mu dn le mv mw dp li lz mx my lk md mz na lm mh nb nc lo nd bi translated">3.2 工作流第 1 部分:使用 PyOWM API 获取天气数据</h2><p id="69f8" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">工作流的第一部分包括使用 PyOWM 库获取关于预定义的<code class="fe oa ob oc nr b">city</code>(圣保罗，BR 在原始笔记本上)的信息。我们迭代<code class="fe oa ob oc nr b">forecast</code>对象，在 DataFrame 上组织返回的信息，使我们在接下来的步骤中更加轻松。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="od oe l"/></div></figure><h2 id="6f6e" class="ms kz it bd la mt mu dn le mv mw dp li lz mx my lk md mz na lm mh nb nc lo nd bi translated">3.3 工作流第 2 部分:使用 PyOWM API 获取天气数据</h2><p id="e4f2" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">在工作流程的第二部分，我们将汇总白天的数据，并在一个图中绘制温度信息，在另一个图中绘制降雨、湿度和云量百分比信息。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="od oe l"/></div></figure><h2 id="192a" class="ms kz it bd la mt mu dn le mv mw dp li lz mx my lk md mz na lm mh nb nc lo nd bi translated"><strong class="ak"> 3.4 工作流程第 3 部分:创建 PDF 格式的天气报告</strong></h2><p id="e790" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">在我们工作流程的最后一部分，我们将使用为城市和地块收集的数据创建天气报告。我们将使用库<a class="ae mm" href="https://pypi.org/project/pdfkit/" rel="noopener ugc nofollow" target="_blank"> <em class="of"> pdfkit </em> </a>将我们的 HTML 模板转换成 pdf 文件。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="od oe l"/></div></figure><h2 id="fa54" class="ms kz it bd la mt mu dn le mv mw dp li lz mx my lk md mz na lm mh nb nc lo nd bi translated">3.5 使用造纸厂前的最终测试</h2><p id="2f08" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">在我们的 Jupyter 笔记本上完成分析后，建议通过重启内核并运行所有单元来测试工作流(<em class="of"> Run &gt; Run all cells </em>)。如果我们观察到所有的单元都被成功地执行了，并且输出完全符合我们的预期，那么我们的笔记本就可以和 Papermill 一起使用了。我们的工作流 can 生成的圣保罗市(巴西)的预期天气报告如图 2 所示。在接下来的会话中，我们将配置 Jupyter 笔记本，以接受任何城市作为工作流的参数，并使用 Papermill 自动执行它。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi og"><img src="../Images/ef9cd9a41dcac72521d61a149b9a7bb9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cRG003siPr2rntxO4Uu53A.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Figure 2. The weather forecast report created with our workflow for the city of Sao Paulo, BR.</figcaption></figure></div><div class="ab cl ne nf hx ng" role="separator"><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj"/></div><div class="im in io ip iq"><h1 id="4266" class="ky kz it bd la lb nl ld le lf nm lh li jz nn ka lk kc no kd lm kf np kg lo lp bi translated">4.为 Papermill 配置笔记本</h1><p id="54be" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">现在我们已经为生产准备好了笔记本，我们只需要对配置进行一些更改，就可以在 Papermill 中使用它了。您可以选择使用 Jupyter Lab 或与 Papermill 集成的 Jupyter Notebook。对于每个平台，带有参数的单元的配置是不同的，因此我们在进行这一步时需要注意。</p><h2 id="e701" class="ms kz it bd la mt mu dn le mv mw dp li lz mx my lk md mz na lm mh nb nc lo nd bi translated"><strong class="ak"> 4.1 在 Jupyter Lab 上定义参数</strong></h2><p id="5c54" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">当使用 Jupyter Lab 运行笔记本时，我们必须为工作流中使用的参数创建一个缺省值的单元格。接下来，我们选择带有参数的单元格，单击<em class="of">笔记本工具</em>(左侧面板上的扳手图标)和<em class="of">高级工具</em>(图 3) <em class="of">。</em></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oh"><img src="../Images/5bbb70ac6869ecf5c6163a1b068dc91b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WQN9UFFlZpTXmZqXHnnpQA.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Figure 3. Configuring a notebook cell to receive the parameters from Papermill on JupyterLab.</figcaption></figure><p id="1132" class="pw-post-body-paragraph lq lr it ls b lt mn ju lv lw mo jx ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated">在<em class="of">单元元数据</em>框中，我们需要添加以下描述:</p><pre class="kj kk kl km gt nq nr ns nt aw nu bi"><span id="7c86" class="ms kz it nr b gy nv nw l nx ny">{<br/>    "tags": [<br/>        "parameters"<br/>    ]<br/>}</span></pre><p id="4063" class="pw-post-body-paragraph lq lr it ls b lt mn ju lv lw mo jx ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated">不要忘记点击方框上方的勾号图标保存它。现在，您的 Jupyter 实验室笔记本已准备好接收来自 Papermill 的参数。</p><h2 id="44ee" class="ms kz it bd la mt mu dn le mv mw dp li lz mx my lk md mz na lm mh nb nc lo nd bi translated">4.2 在 Jupyter 笔记本上定义参数</h2><p id="8870" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">要在 Jupyter 笔记本上配置参数单元格，我们需要点击<em class="of">视图&gt;单元格工具栏&gt;标签。</em>然后将标签<code class="fe oa ob oc nr b">parameters</code>写入并添加到相应的笔记本单元格中(图 4)。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oi"><img src="../Images/00c733233d2124fdb88f70019223a03a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*O06H35JPUes-9X0jw9nPKg.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Figure 4. Configuring a notebook cell to receive the parameters from Papermill on JupyterNotebook.</figcaption></figure></div><div class="ab cl ne nf hx ng" role="separator"><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj"/></div><div class="im in io ip iq"><h1 id="0600" class="ky kz it bd la lb nl ld le lf nm lh li jz nn ka lk kc no kd lm kf np kg lo lp bi translated">5.执行 Papermill</h1><p id="5d85" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">我们可以通过命令行或者使用 Python API 来执行 Papermill <a class="ae mm" href="https://papermill.readthedocs.io/en/latest/usage-execute.html#execute-via-the-python-api" rel="noopener ugc nofollow" target="_blank">。</a>为了使用终端运行 Jupyter 笔记本，我们运行命令<strong class="ls iu"> (6): </strong></p><pre class="kj kk kl km gt nq nr ns nt aw nu bi"><span id="130f" class="ms kz it nr b gy nv nw l nx ny"><strong class="nr iu"># 6) To execute Papermill from the terminal<br/></strong>papermill weather_forecast_using_pyowm.ipynb \<br/>          weather_forecast_using_pyowm_output.ipynb \<br/>          -p city 'Sao Paulo,BR' \<br/>          -k papermill-tutorial</span></pre><p id="3ce6" class="pw-post-body-paragraph lq lr it ls b lt mn ju lv lw mo jx ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated">前两个参数是目标 Jupyter 笔记本的名称(来自会话 3)和输出笔记本的名称(输入的执行版本)。<code class="fe oa ob oc nr b">-p</code>代表参数，所以我们描述每个参数的名称及其各自的值(在我们的例子中，我们只有<code class="fe oa ob oc nr b">city</code>)。最后，<code class="fe oa ob oc nr b">-k</code>代表内核，我们选择在第 5 步中创建的<code class="fe oa ob oc nr b">papermill-tutorial</code>内核。</p><p id="6c50" class="pw-post-body-paragraph lq lr it ls b lt mn ju lv lw mo jx ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated">如果我们想要使用 Papermil Python API 来运行相同的过程，我们必须键入以下命令:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="od oe l"/></div></figure><h2 id="2fd8" class="ms kz it bd la mt mu dn le mv mw dp li lz mx my lk md mz na lm mh nb nc lo nd bi translated">5.1 输出笔记本</h2><p id="6a25" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">Papermill Python API 可用于将笔记本的执行与其他操作集成在一起。例如，如果在执行过程中出现错误，我们可以解析输出文件，识别问题并将其保存在数据库结构中。</p><p id="9804" class="pw-post-body-paragraph lq lr it ls b lt mn ju lv lw mo jx ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated"><a class="ae mm" href="https://nbformat.readthedocs.io/en/latest/" rel="noopener ugc nofollow" target="_blank">朱庇特笔记本文件</a>(。ipynb 扩展)是 JSON 文件，包含每个单元格文本、源代码、输出和元数据的信息。Papermill 会创建一个输出文件，该文件对应于使用用户指定的参数执行的输入笔记本。它基本上包含了记录流程所需的所有信息，这意味着我们可以将它作为类似日志的数据来记录我们的工作流执行。因此，保存输出 JSON 文件的一种方法是使用 NoSQL 键值数据库(<a class="ae mm" href="https://aws.amazon.com/dynamodb/?nc1=h_ls" rel="noopener ugc nofollow" target="_blank"> Amazon DynamoDB </a>、<a class="ae mm" href="https://www.mongodb.com/" rel="noopener ugc nofollow" target="_blank"> MongoDB </a>、<a class="ae mm" href="http://cassandra.apache.org/" rel="noopener ugc nofollow" target="_blank"> CassandraDB </a>、<a class="ae mm" href="https://cloud.google.com/bigtable/" rel="noopener ugc nofollow" target="_blank"> BigTable </a>等)。</p></div><div class="ab cl ne nf hx ng" role="separator"><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj"/></div><div class="im in io ip iq"><h1 id="27ab" class="ky kz it bd la lb nl ld le lf nm lh li jz nn ka lk kc no kd lm kf np kg lo lp bi translated">6.最后的想法</h1><p id="5b44" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">Papermill 是一个简单方便的工具，可以将 Jupyter 笔记本转换为数据工作流。它扩展了笔记本电脑的使用可能性，打破了可视化/文档环境的障碍，成为一个生产就绪的平台。在创建最终的 ETL 以在更复杂的数据管道工具如<a class="ae mm" href="https://github.com/apache/airflow" rel="noopener ugc nofollow" target="_blank"> Airflow </a>或<a class="ae mm" href="https://github.com/spotify/luigi" rel="noopener ugc nofollow" target="_blank"> Luigi </a>上运行之前，它可以作为一个快速便捷的工具用于数据工作流的原型化。</p><p id="ee05" class="pw-post-body-paragraph lq lr it ls b lt mn ju lv lw mo jx ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated">我们试图向读者简单介绍 Papermill，但是将该工具与其他资源集成的可能性是无限的。我们相信一个活跃的社区将围绕它成长，将这个项目转化为一个更成熟的工具。</p></div><div class="ab cl ne nf hx ng" role="separator"><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj"/></div><div class="im in io ip iq"><h1 id="0d28" class="ky kz it bd la lb nl ld le lf nm lh li jz nn ka lk kc no kd lm kf np kg lo lp bi translated">非常感谢你阅读我的文章！</h1><ul class=""><li id="5d0f" class="oj ok it ls b lt lu lw lx lz ol md om mh on ml oo op oq or bi translated">你可以在我的<a class="ae mm" href="https://medium.com/@gabrielsgoncalves" rel="noopener">个人资料页面</a> <strong class="ls iu">找到我的其他文章🔬</strong></li><li id="2196" class="oj ok it ls b lt os lw ot lz ou md ov mh ow ml oo op oq or bi translated">如果你喜欢并且<strong class="ls iu">想成为中级会员</strong>，你可以使用我的<a class="ae mm" href="https://medium.com/@gabrielsgoncalves/membership" rel="noopener"> <strong class="ls iu">推荐链接</strong> </a> <strong class="ls iu"> </strong>来支持我👍</li></ul></div><div class="ab cl ne nf hx ng" role="separator"><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj"/></div><div class="im in io ip iq"><h1 id="2786" class="ky kz it bd la lb nl ld le lf nm lh li jz nn ka lk kc no kd lm kf np kg lo lp bi translated">其他资源</h1><div class="ox oy gp gr oz pa"><a rel="noopener follow" target="_blank" href="/creating-a-solid-data-science-development-environment-60df14ce3a34"><div class="pb ab fo"><div class="pc ab pd cl cj pe"><h2 class="bd iu gy z fp pf fr fs pg fu fw is bi translated">创建可靠的数据科学开发环境</h2><div class="ph l"><h3 class="bd b gy z fp pf fr fs pg fu fw dk translated">如何使用 Conda、Git、DVC 和 JupyterLab 来组织和复制您的开发环境。</h3></div><div class="pi l"><p class="bd b dl z fp pf fr fs pg fu fw dk translated">towardsdatascience.com</p></div></div><div class="pj l"><div class="pk l pl pm pn pj po ks pa"/></div></div></a></div><div class="ox oy gp gr oz pa"><a href="https://medium.com/capital-fund-management/automated-reports-with-jupyter-notebooks-using-jupytext-and-papermill-619e60c37330" rel="noopener follow" target="_blank"><div class="pb ab fo"><div class="pc ab pd cl cj pe"><h2 class="bd iu gy z fp pf fr fs pg fu fw is bi translated">使用 Jupyter 笔记本自动生成报告(使用 Jupytext 和 Papermill)</h2><div class="ph l"><h3 class="bd b gy z fp pf fr fs pg fu fw dk translated">Jupyter 笔记本是交互式运行代码和用数据编写叙述的最佳可用工具之一…</h3></div><div class="pi l"><p class="bd b dl z fp pf fr fs pg fu fw dk translated">medium.com</p></div></div><div class="pj l"><div class="pp l pl pm pn pj po ks pa"/></div></div></a></div><div class="ox oy gp gr oz pa"><a href="https://medium.com/y-data-stories/automating-jupyter-notebooks-with-papermill-4b8543ece92f" rel="noopener follow" target="_blank"><div class="pb ab fo"><div class="pc ab pd cl cj pe"><h2 class="bd iu gy z fp pf fr fs pg fu fw is bi translated">使用 Papermill 自动化 Jupyter 笔记本</h2><div class="ph l"><h3 class="bd b gy z fp pf fr fs pg fu fw dk translated">Jupyter 笔记本是探索数据、测试假设、协作和报告发现的绝佳方式。与 Jupyter 一起…</h3></div><div class="pi l"><p class="bd b dl z fp pf fr fs pg fu fw dk translated">medium.com</p></div></div><div class="pj l"><div class="pq l pl pm pn pj po ks pa"/></div></div></a></div><div class="ox oy gp gr oz pa"><a rel="noopener follow" target="_blank" href="/data-pipelines-luigi-airflow-everything-you-need-to-know-18dc741449b7"><div class="pb ab fo"><div class="pc ab pd cl cj pe"><h2 class="bd iu gy z fp pf fr fs pg fu fw is bi translated">数据管道、Luigi、气流:你需要知道的一切</h2><div class="ph l"><h3 class="bd b gy z fp pf fr fs pg fu fw dk translated">这篇文章是基于我最近给同事们做的关于气流的演讲。</h3></div><div class="pi l"><p class="bd b dl z fp pf fr fs pg fu fw dk translated">towardsdatascience.com</p></div></div><div class="pj l"><div class="pr l pl pm pn pj po ks pa"/></div></div></a></div></div></div>    
</body>
</html>