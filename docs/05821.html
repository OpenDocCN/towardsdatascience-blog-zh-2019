<html>
<head>
<title>Merging Spreadsheets with Python–Append</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用 Python 合并电子表格–追加</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/merging-spreadsheets-with-python-append-f6de2d02e3f3?source=collection_archive---------0-----------------------#2019-08-25">https://towardsdatascience.com/merging-spreadsheets-with-python-append-f6de2d02e3f3?source=collection_archive---------0-----------------------#2019-08-25</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="f948" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">将多个电子表格合并在一起是一项常见的任务。合并有两种方式:</p><ol class=""><li id="e98c" class="kl km iq jp b jq jr ju jv jy kn kc ko kg kp kk kq kr ks kt bi translated"><strong class="jp ir">追加</strong> —电子表格层叠在一起</li></ol><figure class="kv kw kx ky gt kz gh gi paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><div class="gh gi ku"><img src="../Images/ee76ae5d018ed758c09b0c97f4f5c994.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*g7U9A-PV-3FBWWSc_X_HIQ.png"/></div></div><figcaption class="lg lh gj gh gi li lj bd b be z dk">Three spreadsheets are appended into one based on column names</figcaption></figure><p id="732e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">2.<strong class="jp ir">联接</strong> —基于所选列的相同值水平联接电子表格列</p><figure class="kv kw kx ky gt kz gh gi paragraph-image"><div class="gh gi lk"><img src="../Images/e3c997bb31581a8407a143d3eb1ab55c.png" data-original-src="https://miro.medium.com/v2/resize:fit:844/format:webp/1*1Hb5-r8FSoC6SL7WkpYPkQ.png"/></div><figcaption class="lg lh gj gh gi li lj bd b be z dk">Two spreadsheets are joined into one based on the same Name values</figcaption></figure><p id="6c4a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> <em class="ll">在本教程中，我们将侧重于追加。我将会写另一篇关于加入的教程。</em> </strong></p></div><div class="ab cl lm ln hu lo" role="separator"><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr"/></div><div class="ij ik il im in"><h1 id="9b94" class="lt lu iq bd lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq bi translated">放弃</h1><p id="eb3f" class="pw-post-body-paragraph jn jo iq jp b jq mr js jt ju ms jw jx jy mt ka kb kc mu ke kf kg mv ki kj kk ij bi translated">我建立了一个工具<a class="ae mw" href="http://mergespreadsheets.com/" rel="noopener ugc nofollow" target="_blank">mergespreadsheets.com</a>可以很容易地附加文件。如果您需要快速追加，请随意尝试</p></div><div class="ab cl lm ln hu lo" role="separator"><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr"/></div><div class="ij ik il im in"><h1 id="c84e" class="lt lu iq bd lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq bi translated">先决条件</h1><p id="286a" class="pw-post-body-paragraph jn jo iq jp b jq mr js jt ju ms jw jx jy mt ka kb kc mu ke kf kg mv ki kj kk ij bi translated"><em class="ll">如果您不知道如何使用终端和 Python，或者如何使用 Python 和 Pandas 读写文件，那么请先阅读并浏览本教程:</em><a class="ae mw" href="https://medium.com/@lovespreadsheets/intro-to-handling-spreadsheets-with-python-c6a35e0d8de8" rel="noopener"><em class="ll">https://medium . com/@ love spreadsheets/intro-to-handling-spreadsheets-with-Python-c 6 a 35 E0 D8 de 8</em></a></p><h1 id="af99" class="lt lu iq bd lv lw mx ly lz ma my mc md me mz mg mh mi na mk ml mm nb mo mp mq bi translated">文件</h1><p id="b160" class="pw-post-body-paragraph jn jo iq jp b jq mr js jt ju ms jw jx jy mt ka kb kc mu ke kf kg mv ki kj kk ij bi translated">在本教程中，我们将使用三个文件。可以点击链接下载:<a class="ae mw" href="https://lovespreadsheet-tutorials.s3.amazonaws.com/MarketingAnalystNames.xlsx" rel="noopener ugc nofollow" target="_blank">marketing analyst names . xlsx</a>，<a class="ae mw" href="https://lovespreadsheet-tutorials.s3.amazonaws.com/SalesRepNames.xlsx" rel="noopener ugc nofollow" target="_blank"> SalesRepNames.xlsx </a>，<a class="ae mw" href="https://lovespreadsheet-tutorials.s3.amazonaws.com/SeniorLeadershipNames.xlsx" rel="noopener ugc nofollow" target="_blank">senior leadershipnames . xlsx</a></p><h1 id="1841" class="lt lu iq bd lv lw mx ly lz ma my mc md me mz mg mh mi na mk ml mm nb mo mp mq bi translated">完整代码</h1><p id="ab79" class="pw-post-body-paragraph jn jo iq jp b jq mr js jt ju ms jw jx jy mt ka kb kc mu ke kf kg mv ki kj kk ij bi translated">这是追加三个文件的完整代码</p><figure class="kv kw kx ky gt kz"><div class="bz fp l di"><div class="nc nd l"/></div><figcaption class="lg lh gj gh gi li lj bd b be z dk">Full Code for this tutorial</figcaption></figure></div><div class="ab cl lm ln hu lo" role="separator"><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr"/></div><div class="ij ik il im in"><h1 id="4a08" class="lt lu iq bd lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq bi translated">I .阅读所有三个电子表格</h1><p id="c460" class="pw-post-body-paragraph jn jo iq jp b jq mr js jt ju ms jw jx jy mt ka kb kc mu ke kf kg mv ki kj kk ij bi translated">在与三个电子表格相同的文件夹中创建一个 python 文件，并将其命名为<em class="ll"> append.py </em></p><p id="9130" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">首先我们要导入我们的<em class="ll"> pandas </em>库，并给它一个缩写<em class="ll"> pd </em>。<em class="ll"> pd </em>缩写是约定俗成的，从技术上来说你可以使用<em class="ll"> import pandas </em>照原样，将代码中的所有<em class="ll"> pd </em>替换为<em class="ll"> pandas </em></p><pre class="kv kw kx ky gt ne nf ng nh aw ni bi"><span id="0063" class="nj lu iq nf b gy nk nl l nm nn">import pandas as pd</span></pre><p id="6801" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们将在没有任何额外参数的情况下读取第一个表，因为我们只有文本数据，第一行是列名，所以我们可以使用 pandas <em class="ll"> read_excel </em>命令读取所有三个文件，而没有任何参数</p><pre class="kv kw kx ky gt ne nf ng nh aw ni bi"><span id="48d7" class="nj lu iq nf b gy nk nl l nm nn">marketing_analyst_names = pd.read_excel("MarketingAnalystNames.xlsx")sales_rep_names = pd.read_excel("SalesRepNames.xlsx")senior_leadership_names =   pd.read_excel("SeniorLeadershipNames.xlsx")</span></pre><p id="a97b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在我们有了三个变量，它们包含了包含 excel 文件中所有行列格式的值的数据框</p><h1 id="2ee7" class="lt lu iq bd lv lw mx ly lz ma my mc md me mz mg mh mi na mk ml mm nb mo mp mq bi translated">二。合并所有三个数据框</h1><p id="b7e4" class="pw-post-body-paragraph jn jo iq jp b jq mr js jt ju ms jw jx jy mt ka kb kc mu ke kf kg mv ki kj kk ij bi translated">现在，我们将合并所有三个数据框</p><ol class=""><li id="0d43" class="kl km iq jp b jq jr ju jv jy kn kc ko kg kp kk kq kr ks kt bi translated">我们将创建一个包含所有三个数据框的列表。列表中数据框的顺序将决定文件的追加方式</li></ol><pre class="kv kw kx ky gt ne nf ng nh aw ni bi"><span id="1e13" class="nj lu iq nf b gy nk nl l nm nn">all_df_list = [marketing_analyst_names, sales_rep_names, senior_leadership_names]</span></pre><p id="6549" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">2.追加所有三个数据帧的命令是一个单行函数。我们将使用我们的列表调用<em class="ll"> pd.concat </em>函数，它将按照这个顺序追加我们的所有数据帧，并将追加的数据帧赋给变量<em class="ll"> appended_df </em></p><pre class="kv kw kx ky gt ne nf ng nh aw ni bi"><span id="bdd8" class="nj lu iq nf b gy nk nl l nm nn">appended_df = pd.concat(all_df_list)</span></pre><p id="36e5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">追加是通过匹配相似的列名来完成的。如果列名不同，则追加不会将值堆叠在彼此之上。</p><p id="fca1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="ll">我鼓励你们用不同的列名创建虚拟电子表格，看看追加是如何被影响的</em></p><h1 id="5f84" class="lt lu iq bd lv lw mx ly lz ma my mc md me mz mg mh mi na mk ml mm nb mo mp mq bi translated">三。写入 Excel 文件</h1><p id="1053" class="pw-post-body-paragraph jn jo iq jp b jq mr js jt ju ms jw jx jy mt ka kb kc mu ke kf kg mv ki kj kk ij bi translated">既然我们已经有了追加的数据框，我们可以将其写入 Excel 文件。我们在附加的数据框上使用<em class="ll"> to_excel </em>函数来实现这一点。我们还将添加参数<em class="ll"> index=False </em>，它不会输出任何行号。<em class="ll">(摆弄参数，看看哪个对你有意义</em>)</p><pre class="kv kw kx ky gt ne nf ng nh aw ni bi"><span id="4387" class="nj lu iq nf b gy nk nl l nm nn">appended_df.to_excel("AllCompanyNames.xlsx", index=False)</span></pre><p id="cf6c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在我们已经完成了代码，我们需要打开我们的<strong class="jp ir">终端</strong>并转到保存所有三个文件和我们的<em class="ll"> append.py </em>文件的文件夹</p><p id="ab18" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="ll">如果你跟终端走散了，请先过一遍本教程:</em><a class="ae mw" href="https://medium.com/@lovespreadsheets/intro-to-handling-spreadsheets-with-python-c6a35e0d8de8" rel="noopener"><em class="ll">https://medium . com/@ love spreadsheets/intro-to-handling-spreadsheets-with-python-c 6 a 35 e 0d 8 de 8</em></a></p><p id="7b07" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们将从我们的终端运行这个脚本</p><pre class="kv kw kx ky gt ne nf ng nh aw ni bi"><span id="b35e" class="nj lu iq nf b gy nk nl l nm nn">$ python append.py</span></pre><p id="545e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">瞧啊。我们现在应该有一个名为<strong class="jp ir"> AllCompanyNames.xlsx </strong>的文件，与我们的三个电子表格和包含所有三个附加文件的 Python 脚本在同一个文件夹中！</p></div></div>    
</body>
</html>