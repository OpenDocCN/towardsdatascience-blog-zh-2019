<html>
<head>
<title>Weather forecasting with data science approaches</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用数据科学方法进行天气预报</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/weather-forecasting-with-data-science-approaches-cb8f2afd3f38?source=collection_archive---------5-----------------------#2019-10-07">https://towardsdatascience.com/weather-forecasting-with-data-science-approaches-cb8f2afd3f38?source=collection_archive---------5-----------------------#2019-10-07</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="2add" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在本文中，我将展示我们如何使用数据科学算法进行天气预报，并比较一些分类和回归任务的框架。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi kp"><img src="../Images/56a3811d0307f985f551f7fcb3bb9ef8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Gx1Rv0T05iM5oVH2.jpeg"/></div></div><figcaption class="lb lc gj gh gi ld le bd b be z dk"><a class="ae lf" href="https://unsplash.com/search/photos/central-otago-district%2C-new-zealand" rel="noopener ugc nofollow" target="_blank">Central Otago District, New Zealand</a></figcaption></figure><p id="f809" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">天气预报<em class="ko">是一项相当困难的任务。维基上说，“</em> <strong class="js iu">天气预报</strong>是应用科学技术预测给定<strong class="js iu">位置</strong>和<strong class="js iu">时间</strong>的大气<strong class="js iu">状况。<strong class="js iu">天气预报</strong>是通过收集<strong class="js iu">关于给定地点<strong class="js iu">当前大气状态</strong>的定量数据</strong>并利用气象学预测大气将如何变化而做出的。”</strong></p><p id="1286" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">所以总的来说，天气预报是关于大气的数据。当然，我不会模拟大气条件，但我可以使用大量的数据进行天气预报。在本文中，我将尝试预测未来 3 小时的降水量。我将尝试用两种方法来解决这个任务—作为二元分类(1-降水量，0-无降水量)和回归，其中我将尝试预测以毫米为单位的降水量。</p><p id="bfe2" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">那么，什么是沉淀呢？还是在<a class="ae lf" href="https://en.wikipedia.org/wiki/Precipitation" rel="noopener ugc nofollow" target="_blank"> Wiki </a>里问吧。在气象学中，<strong class="js iu">降水</strong>是大气中的水蒸气在重力作用下凝结的产物。降水的主要形式包括毛毛雨、雨、雨夹雪、雪、霰和冰雹。当大气的一部分被水蒸气饱和，水凝结并“沉淀”时，就发生了降水。让我们看一下图解，它显示了水循环和降水发生的过程。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi lg"><img src="../Images/2225243204eb8cdef4ae0e8912e7a110.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*wSep581Iz8UX4PJk.png"/></div></div><figcaption class="lb lc gj gh gi ld le bd b be z dk">Condensation and coalescence are important parts of the water cycle.</figcaption></figure><p id="448c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">当然，降水的发生是一个非常复杂的过程，这些图式并不能显示整个过程。维基说，“降水是水循环的主要组成部分，是地球上大部分淡水沉积的原因。产生降水的机制包括对流、层状和地形降雨。对流过程涉及强烈的垂直运动，可在一小时内导致该位置的大气翻转，并导致强降水，而层状过程涉及较弱的上升运动和较不强烈的降水。根据降水是以液态水、与地表接触时冻结的液态水还是冰的形式降落，降水可以分为三类。不同类型降水的混合物，包括不同类别的降水，可以同时降落。液态形式的降水包括雨和毛毛雨。在冰点以下的气团中接触时冻结的雨或毛毛雨被称为“冻雨”或“冻雨”。降水的冻结形式包括雪、冰针、冰粒、冰雹和霰</p><h1 id="8576" class="lh li it bd lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me bi translated">探索性数据分析</h1><p id="658b" class="pw-post-body-paragraph jq jr it js b jt mf jv jw jx mg jz ka kb mh kd ke kf mi kh ki kj mj kl km kn im bi translated">所以，让我们试着找一些数据，试着预测这种自然现象。在我的实验中，我将使用一个气象站的数据。让我们检查数据的标题。</p><p id="d3e6" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">所以，我得到了<strong class="js iu"> 29 个变量</strong>和<strong class="js iu"> 22 064 个记录</strong>。让我描述一下列名:</p><ul class=""><li id="9cb9" class="mk ml it js b jt ju jx jy kb mm kf mn kj mo kn mp mq mr ms bi translated"><strong class="js iu"> T </strong> —地球表面以上 2 米高度的空气温度(摄氏度)；</li><li id="2c97" class="mk ml it js b jt mt jx mu kb mv kf mw kj mx kn mp mq mr ms bi translated"><strong class="js iu"> Po </strong> —气象站级别的大气压力(毫米汞柱)；</li><li id="bd4f" class="mk ml it js b jt mt jx mu kb mv kf mw kj mx kn mp mq mr ms bi translated"><strong class="js iu"> P </strong> —大气压力降低至平均海平面(毫米汞柱)；</li><li id="9b47" class="mk ml it js b jt mt jx mu kb mv kf mw kj mx kn mp mq mr ms bi translated"><strong class="js iu"> Pa </strong> —压力趋势:最近三个小时的大气压力变化(毫米汞柱)；</li><li id="4892" class="mk ml it js b jt mt jx mu kb mv kf mw kj mx kn mp mq mr ms bi translated"><strong class="js iu">U</strong>——地面以上 2 米高度的相对湿度(%)；</li><li id="ea23" class="mk ml it js b jt mt jx mu kb mv kf mw kj mx kn mp mq mr ms bi translated"><strong class="js iu"> DD </strong> —在观测前 10 分钟内，地球表面以上 10-12 米高度的平均风向(罗经点);</li><li id="5187" class="mk ml it js b jt mt jx mu kb mv kf mw kj mx kn mp mq mr ms bi translated"><strong class="js iu">Ff</strong>——观测前 10 分钟内地面以上 10-12 米高度的平均风速(米/秒)；</li><li id="9d3c" class="mk ml it js b jt mt jx mu kb mv kf mw kj mx kn mp mq mr ms bi translated"><strong class="js iu">ff10</strong>——观测前 10 分钟内，地面以上 10-12 米高度的最大阵风值(米/秒)；</li><li id="a7bb" class="mk ml it js b jt mt jx mu kb mv kf mw kj mx kn mp mq mr ms bi translated"><strong class="js iu">ff3</strong>——观测周期内，地面以上 10-12 米高度的最大阵风值(米/秒)；</li><li id="be0f" class="mk ml it js b jt mt jx mu kb mv kf mw kj mx kn mp mq mr ms bi translated"><strong class="js iu"> N </strong> —总云量；</li><li id="12da" class="mk ml it js b jt mt jx mu kb mv kf mw kj mx kn mp mq mr ms bi translated"><strong class="js iu"> WW </strong> —从气象站报告的当前天气；</li><li id="8523" class="mk ml it js b jt mt jx mu kb mv kf mw kj mx kn mp mq mr ms bi translated"><strong class="js iu"> W1 </strong> —过往天气(观测时段之间的天气)1；</li><li id="b838" class="mk ml it js b jt mt jx mu kb mv kf mw kj mx kn mp mq mr ms bi translated"><strong class="js iu"> W2 </strong> —过往天气(观测期间的天气)2；</li><li id="3a34" class="mk ml it js b jt mt jx mu kb mv kf mw kj mx kn mp mq mr ms bi translated"><strong class="js iu"> Tn </strong> —过去一段时间(不超过 12 小时)的最低气温(摄氏度)；</li><li id="d5c5" class="mk ml it js b jt mt jx mu kb mv kf mw kj mx kn mp mq mr ms bi translated"><strong class="js iu"> Tx </strong> —过去一段时间(不超过 12 小时)的最高气温(摄氏度)；</li><li id="ebb1" class="mk ml it js b jt mt jx mu kb mv kf mw kj mx kn mp mq mr ms bi translated"><strong class="js iu"> Cl </strong> —层积云、层云、积云和积雨云属的云；</li><li id="e42f" class="mk ml it js b jt mt jx mu kb mv kf mw kj mx kn mp mq mr ms bi translated"><strong class="js iu"> Nh </strong> —存在的所有 CL 云的量，或者，如果不存在 CL 云，存在的所有 CM 云的量；</li><li id="66cc" class="mk ml it js b jt mt jx mu kb mv kf mw kj mx kn mp mq mr ms bi translated"><strong class="js iu">H</strong>——最低云层底部的高度(米)；</li><li id="eb40" class="mk ml it js b jt mt jx mu kb mv kf mw kj mx kn mp mq mr ms bi translated"><strong class="js iu">Cm</strong>——高积云、高层云和雨层云属的云；</li><li id="caa7" class="mk ml it js b jt mt jx mu kb mv kf mw kj mx kn mp mq mr ms bi translated">卷云、卷积云和卷层云属的云；</li><li id="52fe" class="mk ml it js b jt mt jx mu kb mv kf mw kj mx kn mp mq mr ms bi translated"><strong class="js iu"> VV </strong> —水平能见度(公里)；</li><li id="4407" class="mk ml it js b jt mt jx mu kb mv kf mw kj mx kn mp mq mr ms bi translated"><strong class="js iu"> Td </strong> —地球表面以上 2 米高度的露点温度(摄氏度)；</li><li id="9df5" class="mk ml it js b jt mt jx mu kb mv kf mw kj mx kn mp mq mr ms bi translated"><strong class="js iu">RRR</strong>——降水量(毫米)；</li><li id="85d5" class="mk ml it js b jt mt jx mu kb mv kf mw kj mx kn mp mq mr ms bi translated"><strong class="js iu">tR</strong>——累计规定量降水的时段；</li><li id="4ccf" class="mk ml it js b jt mt jx mu kb mv kf mw kj mx kn mp mq mr ms bi translated"><strong class="js iu">E</strong>——地面无积雪或可测冰盖的状态；</li><li id="c585" class="mk ml it js b jt mt jx mu kb mv kf mw kj mx kn mp mq mr ms bi translated"><strong class="js iu">Tg</strong>——夜间土壤表面最低温度。(摄氏度)；</li><li id="1a51" class="mk ml it js b jt mt jx mu kb mv kf mw kj mx kn mp mq mr ms bi translated"><strong class="js iu">E</strong>——地面有雪或可测冰覆盖的状态；</li><li id="815c" class="mk ml it js b jt mt jx mu kb mv kf mw kj mx kn mp mq mr ms bi translated"><strong class="js iu"> sss </strong> —积雪深度(厘米)。</li></ul><p id="b26d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">首先，我想知道这个数据集的摘要，然后选择一个有用的列进行进一步的分析。</p><p id="5c67" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我用平均值替换空数值，然后我可以可视化这个数据集。先说温度(T)。</p><p id="21ae" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">首先，我想画出温度的时间序列。在图上，你可以看到“2012 年 2 月 1 日”到“2019 年 7 月 13 日”期间的温度变化。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi my"><img src="../Images/4d3a7ae7026872d79b0acb23e8eadadb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*7ZBMrl1g1ydY6iVU.jpeg"/></div></div></figure><p id="b0a7" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在这里，我们可以找到我们的数据季节性，但我想检查它更详细。为了检查每年的变化，我画了一个方框图。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi mz"><img src="../Images/10d3b715981f796d8896163338bd0205.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*oNoS7Gmuqsd_7Hxr.jpeg"/></div></div></figure><p id="c006" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这张图表上的变化很小，所以让我们按月份和年份来检查一下。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi na"><img src="../Images/ec8a8f1c70f9278bc979f2c615e7d767.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*OkD2C2oT6GSr3sPK.jpeg"/></div></div></figure><p id="fbad" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">哇，有趣的是发现大多数年份的夏天都是相似的，但是秋天和春天是不同的。此外，绘制整个时期内最高、最低和中间温度的趋势图也很有意思。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi nb"><img src="../Images/6cf8fa8303fac2da20d1f9e9c3ec8c15.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*n96Za4ex4zabhOqm.jpeg"/></div></div></figure><p id="771a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">有趣的是，最近几年的最低温度变高了。有关更多细节，您可以在下一个表格中查看。</p><p id="6223" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我的数据分析的下一阶段是计算所有数值之间的相关性。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi gj"><img src="../Images/dbfef72611695a3f9b052175ebb1c9f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*jZD542cKKXpC18lu.jpeg"/></div></div></figure><p id="95fa" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在这张图上，我们可以看到三个有趣的关联:</p><ul class=""><li id="e658" class="mk ml it js b jt ju jx jy kb mm kf mn kj mo kn mp mq mr ms bi translated">温度与水平能见度呈正相关(0.4)；</li><li id="5cc5" class="mk ml it js b jt mt jx mu kb mv kf mw kj mx kn mp mq mr ms bi translated">温度和相对湿度呈负相关(-0.6)；</li><li id="66f3" class="mk ml it js b jt mt jx mu kb mv kf mw kj mx kn mp mq mr ms bi translated">相对湿度和水平能见度之间的负相关(-0.7)。</li></ul><p id="1092" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">此外，我想分析更详细的降水量，并绘制类似于温度的图表。</p><p id="af9f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">让我们从时间序列图开始。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi nc"><img src="../Images/9fc870ab86625dfbe39d2130d9f2f282.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*wUEG_KnjOHKRX4uo.jpeg"/></div></div></figure><p id="20ed" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">2013 年秋季的总降水量是近 5 年来最高的。让我们计算非零降水值的汇总统计数据。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi nd"><img src="../Images/b299fc8cc8cb9090e38e10187b78be46.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*lgf4QSJDUCfh37Wd.jpeg"/></div></div></figure><p id="6472" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我还想知道整个时期降水量的汇总值。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi ne"><img src="../Images/754ef391f80a6586a7517d7358c5b82a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*1MQDfid4KB_PvFH9.jpeg"/></div></div></figure><p id="0cd0" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这里我们可以看到，2014 年和 2015 年是这一时期降水量的最低水平。</p><p id="0617" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">分类数据及其对降水的影响如何？先说风向(DD)。数据集中有 16 个不同的方向和一个无风事件。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi nf"><img src="../Images/6457cd0e3c1761cd3c687bd753121727.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*EzuuWS0EQbAB0EZs.jpeg"/></div></div></figure><p id="44c2" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们可以看到，大部分降水可能来自北部或西北部。</p><p id="61d4" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">下一阶段是对云的分析。首先，我想分析有云的一天的计数和分析云的特征对降水的影响。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi ng"><img src="../Images/4b0b430891e0c480935f54dd8ec871f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*CtKtpqdWvwNKjVoh.jpeg"/></div></div></figure><p id="fa9d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">总的来说，云量是一个非常相似的时期，而且大部分时间都没有变化。我们也来分析一下云的特性。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi nh"><img src="../Images/bd7f8f08880980abc54eb2ddce812c3a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*k7vB9-Z1KmlF-Kxn.jpeg"/></div></div></figure><p id="4837" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这张图表显示，大部分降水伴随着 300-600 米高的云。这就是我在探索性数据分析中想要的。</p><h1 id="8c27" class="lh li it bd lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me bi translated">特征工程和目标准备</h1><p id="8043" class="pw-post-body-paragraph jq jr it js b jt mf jv jw jx mg jz ka kb mh kd ke kf mi kh ki kj mj kl km kn im bi translated">首先，我计算日期特性—季度、月、周、工作日、月日、年日、小时。所有这些特性我都可以用<a class="ae lf" href="https://lubridate.tidyverse.org/" rel="noopener ugc nofollow" target="_blank"> lubridate </a>库来计算。</p><p id="c0db" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">特征工程的第二阶段是计算某些数字特征的滞后值。对于我的分析，我想计算 T，Po，P，U，Ff，N，Nh，VV 和我的目标 RRR 的滞后值。某一天会有 3 个滞后，前一天会有 1 个滞后。最终数据集:</p><p id="16e3" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">因此，是时候为训练、验证和测试子集拆分数据集了。“2012–02–02 02:00:00”-“2018–12–31 23:00:00”范围内的训练数据集，“2019–01–01 02:00:00”-“2019–03–31 21:00:00”范围内的验证数据集，以及“2019–04–01 00:00”-“2019–07–19</p><p id="9512" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">此外，检查子集中类的平衡和回归任务目标值的分布也很重要。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi ni"><img src="../Images/9d8d6624cf2b9297172d4602e35a17d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*59zUqXqbxLIH4VR1.jpeg"/></div></div></figure><p id="ca3e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">因此，结果是，我们得到了用于分类的不平衡数据集和用于回归的稍微不同的分布。</p><h1 id="6edc" class="lh li it bd lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me bi translated">建模</h1><p id="2257" class="pw-post-body-paragraph jq jr it js b jt mf jv jw jx mg jz ka kb mh kd ke kf mi kh ki kj mj kl km kn im bi translated"><strong class="js iu"> <em class="ko">分类</em> </strong></p><p id="2fe4" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">好了，开始建模吧。我想测试的框架是 H2O。</p><p id="fa15" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><a class="ae lf" href="http://docs.h2o.ai/h2o/latest-stable/h2o-docs/index.html" rel="noopener ugc nofollow" target="_blank"> H2O </a>是一个完全开源的分布式内存机器学习平台，具有线性可扩展性。H2O 支持最广泛使用的统计&amp;机器学习算法，包括梯度增强机器、广义线性模型、深度学习等。H2O 还拥有行业领先的 AutoML 功能，可自动运行所有算法及其超参数，生成最佳模型排行榜。</p><p id="e085" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在我的实验中，我想使用梯度增强机器、广义线性模型、深度学习和 AutoML。H2O 的好处之一是对因素重要性的综合分析。</p><p id="7524" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我的第一个模型是——分类任务的广义线性模型。正如我们之前看到的，我们的标签是不平衡的，所以我们需要设置<em class="ko"> balance_classes = TRUE </em>。同样为了分类，我们需要设置<em class="ko">family =‘二项式’</em>。所以，让我们构建它，看看特性的重要性。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi nj"><img src="../Images/eb74d1d3201eb7f214253566027c6c44.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*wt4uPq4twVjmsR85.jpeg"/></div></div></figure><p id="4098" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">正如我们所看到的，最重要的因素是降水前一小时的湿度。准确性呢？让我们计算所有主要指标:</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/97c9f5ae495fb372d7c799fcec47d6b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:498/format:webp/0*KPowZS0EpbW0Wk9N.jpeg"/></div></figure><p id="b3ea" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">所以总的来说，我们的模型预测不错，但是我们能预测的降水量只有 56%。</p><p id="9703" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">让我们试试另一个模型。我的第二个模型是梯度推进机器。我还要设置<em class="ko"> balance_classes = TRUE </em>。这些特性的重要性看起来会像:</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi nl"><img src="../Images/c24a6d824dd2ae9cb47ff91468ec1702.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*aYGMPWXQn_1jdHbr.jpeg"/></div></div></figure><p id="4bd8" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">最重要的因素是降水和云量的不同滞后。这个模型的准确性如何？</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/7d4e297a998909a72e5a14c52ed527e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:508/format:webp/0*sHVJMEantVsNIXKx.jpeg"/></div></figure><p id="c502" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">结果比较好。我们可以更准确地预测降水。我想试试更复杂的型号。这将是一种深度学习算法，H2O 也提供了这种算法。我还要设置<em class="ko"> balance_classes = TRUE </em>。这些特性的重要性看起来会像:</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi nn"><img src="../Images/9c0c1dd5d790cb59ff8b349b1762f023.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*sfSE8JGC5ICArDot.jpeg"/></div></div></figure><p id="7ece" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">哇，这是有趣的最重要的因素，如果所有的降水滞后，然后才是湿度和云量。精确度呢:</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div class="gh gi no"><img src="../Images/13bb70fd06782f4bf561fd5fd85b1770.png" data-original-src="https://miro.medium.com/v2/resize:fit:492/format:webp/0*Jcn6MUyYIlVZZlpg.jpeg"/></div></figure><p id="d593" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在 GBM 算法中，结果最差，这可能与我的深度学习模型过拟合有关。</p><p id="d0ea" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">H2o 也有自动机器学习。让我们建立 50 个模型，看看结果。创建的前 5 个模型—具有不同超参数的 GBM。像往常一样。让我们看看最重要的因素:</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi np"><img src="../Images/765eee37c3bb625b985db104c6ae3dad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*9K7zGCfrteDqr9Hd.jpeg"/></div></div></figure><p id="d5d0" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">您可以看到因素重要性与我自己的 GBM 模型非常相似，那么准确性呢:</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/766d97c863a3ef8e7f88a72dcb5c9cd0.png" data-original-src="https://miro.medium.com/v2/resize:fit:500/format:webp/0*Zqm8PIh-dgs8EYJU.jpeg"/></div></figure><p id="33ae" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">AUC 比我自己的 GBM 模型要好，但 TNR 最差。此外，它需要更多的时间进行计算。</p><p id="80c6" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu"> <em class="ko">回归</em> </strong></p><p id="8cf8" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">让我们建立回归模型，并尝试预测降水量。</p><p id="59c6" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们的第一个模型是线性回归。在分类任务中，我们可以查看特性的重要性:</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi nr"><img src="../Images/5a71f2a7f175d0a043e7c7862b59d5d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*BH50RWwYutdmt8u-.png"/></div></div></figure><p id="05cc" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">湿度具有最重要的值。准确性呢？在这项任务中，我想使用 3 个指标:MAPE，平均误差，均方误差。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/6b043c72b31003e07dd39d2a933564df.png" data-original-src="https://miro.medium.com/v2/resize:fit:318/format:webp/0*XrTFnrPBW2GEzYZj.png"/></div></figure><p id="b832" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">GLM 模型的结果相当糟糕。</p><p id="8b11" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">让我们试试另一个模型——梯度推进机器。首先，我想看看这些特性的重要性:</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi nt"><img src="../Images/4fdddc7560ce366d79ebc96ad6b10415.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*pk4ImgepZ6zgfw3P.png"/></div></div></figure><p id="00f0" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">与 GLM 模型不同，这里我们可以看到前一小时的特征<strong class="js iu">降水量最有价值。</strong></p><p id="80b6" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">指标相当不错:</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/7f92180ab46ccf967e25d32603354273.png" data-original-src="https://miro.medium.com/v2/resize:fit:354/format:webp/0*EnOfq8hBaN3l14rv.png"/></div></figure><p id="91d1" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们在分类任务中的复杂模型是深度学习。功能的重要性如下所示:</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi nv"><img src="../Images/2f2a8c7bffc24c9e5dacfec618049265.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*IY11ojWsGdh6kq3C.png"/></div></div></figure><p id="2924" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">最重要的特征是前几个小时和当前几个小时的<strong class="js iu">降水量。准确性如何:</strong></p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/5b6317ef31f41ae7061db9683ee18593.png" data-original-src="https://miro.medium.com/v2/resize:fit:332/format:webp/0*302n6NJ773MFghI6.png"/></div></figure><p id="7667" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在 GBM 模型中准确性较差，我认为这是因为 DL 太复杂了。</p><p id="e743" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">最后一个是 AML。排名前五的车型是:</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi nx"><img src="../Images/dc8a20e9344ac22cfd96df513defba77.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*fuWRCMSYP7n67-Si.png"/></div></div></figure><p id="d035" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">像往常一样。让我们从反洗钱角度来看 GBM 模型的最重要因素:</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi ny"><img src="../Images/f9d68d03a699f57e44b20d3573b0226a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*BFINJ0ZWrg5borWI.png"/></div></div></figure><p id="e130" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">结果和我的 GBM 模型很像。</p><p id="3c33" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">让我们看看最佳 AML 模型的结果—stacked ensemble _ all models _ AutoML:</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div class="gh gi nz"><img src="../Images/e36569185d8bd48dc2de00d014fbf3a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:330/format:webp/0*0rF6OVPql1YpEUuA.png"/></div></figure><p id="74e8" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这是我创造的所有模型中最好的结果。</p><p id="b87b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">H2O 框架很好，也很容易使用。它可以在最短的实施时间内产生良好的效果。它还有很多超参数需要优化。</p><p id="dfc9" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">让我们试试另一个——KERAS。</p><p id="7d35" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><a class="ae lf" href="https://keras.io/" rel="noopener ugc nofollow" target="_blank"> Keras </a>是一个高级神经网络 API，致力于实现快速实验。能够以尽可能少的延迟从想法到结果是做好研究的关键。 Keras 具有以下主要特性:</p><ul class=""><li id="505d" class="mk ml it js b jt ju jx jy kb mm kf mn kj mo kn mp mq mr ms bi translated">允许相同的代码在 CPU 或 GPU 上无缝运行。</li><li id="50fb" class="mk ml it js b jt mt jx mu kb mv kf mw kj mx kn mp mq mr ms bi translated">用户友好的 API，使快速原型深度学习模型变得容易。</li><li id="dafd" class="mk ml it js b jt mt jx mu kb mv kf mw kj mx kn mp mq mr ms bi translated">内置对卷积网络(用于计算机视觉)、递归网络(用于序列处理)以及两者任意组合的支持。</li><li id="d4d5" class="mk ml it js b jt mt jx mu kb mv kf mw kj mx kn mp mq mr ms bi translated">支持任意网络架构:多输入或多输出模型、层共享、模型共享等。这意味着 Keras 适用于构建任何深度学习模型，从记忆网络到神经图灵机。</li><li id="fc7b" class="mk ml it js b jt mt jx mu kb mv kf mw kj mx kn mp mq mr ms bi translated">能够在多个后端之上运行，包括<a class="ae lf" href="https://github.com/tensorflow/tensorflow" rel="noopener ugc nofollow" target="_blank"> TensorFlow </a>、<a class="ae lf" href="https://github.com/Microsoft/cntk" rel="noopener ugc nofollow" target="_blank"> CNTK </a>或<a class="ae lf" href="https://github.com/Theano/Theano" rel="noopener ugc nofollow" target="_blank">theno</a>。</li></ul><p id="f41e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我想建立一个多输入多输出的神经网络。</p><p id="ae5d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">对于输入，我想使用与 H2O 车型相同的功能。对于分类特征，我会使用实体嵌入方法。关于这种方法的更多细节，您可以在本文中阅读— <a class="ae lf" href="https://arxiv.org/pdf/1604.06737.pdf" rel="noopener ugc nofollow" target="_blank">链接</a>。</p><p id="f77a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">多输出帮助我同时解决 2 个任务(分类和回归)。</p><p id="b553" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">Keras 框架没有自己的特性重要性模块，但是你可以使用<a class="ae lf" href="https://uc-r.github.io/lime" rel="noopener ugc nofollow" target="_blank"> Lime </a>。</p><p id="8f93" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">让我们来看看结果:</p><ul class=""><li id="d67f" class="mk ml it js b jt ju jx jy kb mm kf mn kj mo kn mp mq mr ms bi translated">分类:</li></ul><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div class="gh gi no"><img src="../Images/8bdc52f0dbb5b95024b90c332b2fe7ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:492/format:webp/0*8Wein1JSGP6ATyUz.png"/></div></figure><ul class=""><li id="0d40" class="mk ml it js b jt ju jx jy kb mm kf mn kj mo kn mp mq mr ms bi translated">回归:</li></ul><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div class="gh gi nz"><img src="../Images/c01e2631df8b9c9fcbdfe4a3fada42be.png" data-original-src="https://miro.medium.com/v2/resize:fit:330/format:webp/0*8VipV_QgrLkfSaoK.png"/></div></figure><p id="3e8f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">Keras 的神经网络带来了很酷的结果。这种型号比以前的型号性能好得多。</p><h1 id="8ef6" class="lh li it bd lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me bi translated">结论</h1><p id="7940" class="pw-post-body-paragraph jq jr it js b jt mf jv jw jx mg jz ka kb mh kd ke kf mi kh ki kj mj kl km kn im bi translated">天气预报是一项非常困难的任务。机器学习算法有助于短期预测。为了得到好的结果，我们需要在神经网络中使用滞后特征或使用 RNN 结构。</p><p id="f6c9" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">你能在 Git 仓库中找到的所有代码— <a class="ae lf" href="https://github.com/AndriiShchur/weather-forecast.git" rel="noopener ugc nofollow" target="_blank">链接</a>。</p></div></div>    
</body>
</html>