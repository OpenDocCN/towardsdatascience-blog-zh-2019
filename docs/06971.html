<html>
<head>
<title>How to use H2O AutoML for Kannada MNIST Digits Classification</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用 H2O AutoML 进行卡纳达语 MNIST 数字分类</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-use-h2o-automl-for-kannada-mnist-digits-classification-c0bb21ee3774?source=collection_archive---------27-----------------------#2019-10-02">https://towardsdatascience.com/how-to-use-h2o-automl-for-kannada-mnist-digits-classification-c0bb21ee3774?source=collection_archive---------27-----------------------#2019-10-02</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/0acfa40556ed2ba1036c86012a194cc7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*f-H33sCzMntSHuPv7aKSSw.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Kaggle Kannada MNIST</figcaption></figure><p id="0b21" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">卡纳达语 MNIST 数据集是另一个 MNIST 类型的卡纳达语(印度)的数字数据集。数据集管理的所有细节已在题为:“<a class="ae la" href="https://arxiv.org/abs/1908.01242" rel="noopener ugc nofollow" target="_blank">卡纳达语-MNIST:一个新的卡纳达语手写数字数据集”的论文中捕获。</a>作者<strong class="ke ir">维奈乌代帕布</strong>。作者<a class="ae la" href="https://github.com/vinayprabhu/Kannada_MNIST" rel="noopener ugc nofollow" target="_blank">的 github repo 可以在这里</a>找到。</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lb"><img src="../Images/734eb7279a96c2f6f008ca02d9473190.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*csnOhs5KLBo8Zt1x.png"/></div></div></figure><p id="db88" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">这篇文章的目的是演示如何使用<code class="fe lg lh li lj b">h2o.ai</code>的<code class="fe lg lh li lj b">automl</code>函数快速获得(更好的)基线。这也证明了一点，这些<code class="fe lg lh li lj b">automl</code>工具如何帮助机器学习模型构建过程民主化。</p><h1 id="d3b4" class="lk ll iq bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated"><a class="ae la" href="https://datacamp.pxf.io/c/2888696/1240322/13294?u=https%3A%2F%2Fpromo.datacamp.com" rel="noopener ugc nofollow" target="_blank"> 78%的数据营折扣</a></h1><figure class="lc ld le lf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mi"><img src="../Images/9fea34c037026365bb3977d24ffbf70d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*gjxbRq7Gw6nNoxVk.png"/></div></div></figure><h1 id="4c91" class="lk ll iq bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated">加载所需的库</h1><ul class=""><li id="0023" class="mj mk iq ke b kf ml kj mm kn mn kr mo kv mp kz mq mr ms mt bi translated"><code class="fe lg lh li lj b">h2o</code> -用于机器学习</li><li id="7e8c" class="mj mk iq ke b kf mu kj mv kn mw kr mx kv my kz mq mr ms mt bi translated"><code class="fe lg lh li lj b">tidyverse</code> -用于数据操作</li></ul><pre class="lc ld le lf gt mz lj na nb aw nc bi"><span id="36d1" class="nd ll iq lj b gy ne nf l ng nh">library(h2o)<br/>library(tidyverse)</span></pre><h1 id="1036" class="lk ll iq bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated">正在初始化 H2O 集群</h1><pre class="lc ld le lf gt mz lj na nb aw nc bi"><span id="62bc" class="nd ll iq lj b gy ne nf l ng nh">h2o::h2o.init()</span></pre><h1 id="553d" class="lk ll iq bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated">读取输入文件(数据)</h1><pre class="lc ld le lf gt mz lj na nb aw nc bi"><span id="8d94" class="nd ll iq lj b gy ne nf l ng nh">train &lt;- read_csv("/Kannada-MNIST/train.csv")<br/>test &lt;- read_csv("/Kannada-MNIST/test.csv")<br/>valid &lt;- read_csv("/Kannada-MNIST/Dig-MNIST.csv")<br/>submission &lt;- read_csv("/Kannada-MNIST//sample_submission.csv")</span></pre><h1 id="ef19" class="lk ll iq bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated">检查数据框的形状/尺寸</h1><pre class="lc ld le lf gt mz lj na nb aw nc bi"><span id="c515" class="nd ll iq lj b gy ne nf l ng nh">dim(train)</span></pre><p id="2cd4" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">784 个像素值+ 1 个表示数字的标签。</p><h1 id="c87e" class="lk ll iq bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated">标签计数</h1><pre class="lc ld le lf gt mz lj na nb aw nc bi"><span id="3c76" class="nd ll iq lj b gy ne nf l ng nh">train  %&gt;% count(label)</span></pre><h1 id="7d02" class="lk ll iq bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated">可视化卡纳达语 MNIST 数字</h1><pre class="lc ld le lf gt mz lj na nb aw nc bi"><span id="e519" class="nd ll iq lj b gy ne nf l ng nh"># visualize the digits<br/>par(mfcol=c(6,6))</span><span id="e879" class="nd ll iq lj b gy ni nf l ng nh">par(mar=c(0, 0, 3, 0), xaxs='i', yaxs='i')</span><span id="9a59" class="nd ll iq lj b gy ni nf l ng nh">for (idx in 1:36) { </span><span id="3701" class="nd ll iq lj b gy ni nf l ng nh">im&lt;-matrix((train[idx,2:ncol(train)]), nrow=28, ncol=28)</span><span id="2253" class="nd ll iq lj b gy ni nf l ng nh">im_numbers &lt;- apply(im, 2, as.numeric)</span><span id="082e" class="nd ll iq lj b gy ni nf l ng nh">image(1:28, 1:28, im_numbers, col=gray((0:255)/255), main=paste(train$label[idx]))<br/>}</span></pre><figure class="lc ld le lf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nj"><img src="../Images/a8e6eef5172eff0c23818b8b99783e80.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*J70g0QCy3-te9gBC.png"/></div></div></figure><h1 id="750b" class="lk ll iq bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated">将 R 数据帧转换成 H2O 函数所需的 H2O 对象</h1><pre class="lc ld le lf gt mz lj na nb aw nc bi"><span id="409f" class="nd ll iq lj b gy ne nf l ng nh">train_h &lt;- as.h2o(train)<br/>test_h &lt;- as.h2o(test)<br/>valid_h &lt;- as.h2o(valid)</span></pre><h1 id="7961" class="lk ll iq bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated">将我们的数字目标变量转换为算法执行分类的因子</h1><pre class="lc ld le lf gt mz lj na nb aw nc bi"><span id="6b8a" class="nd ll iq lj b gy ne nf l ng nh">train_h$label &lt;- as.factor(train_h$label)<br/>valid_h$label &lt;- as.factor(valid_h$label)</span></pre><h1 id="9ad0" class="lk ll iq bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated">解释变量和响应变量</h1><pre class="lc ld le lf gt mz lj na nb aw nc bi"><span id="9f3d" class="nd ll iq lj b gy ne nf l ng nh">x &lt;- names(train)[-1]<br/>y &lt;- 'label'</span></pre><h1 id="c2c0" class="lk ll iq bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated">行动中的汽车</h1><pre class="lc ld le lf gt mz lj na nb aw nc bi"><span id="c104" class="nd ll iq lj b gy ne nf l ng nh">aml &lt;- h2o::h2o.automl(x = x, <br/>                       y = y,<br/>                       training_frame = train_h,<br/>                       nfolds = 3,<br/>                       leaderboard_frame = valid_h,<br/>                       max_runtime_secs = 1000)</span></pre><p id="011d" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><code class="fe lg lh li lj b">nfolds</code>表示交叉验证的折叠次数，而<code class="fe lg lh li lj b">max_runtime_secs</code>表示 AutoML 过程可以持续的最大时间。</p><h1 id="3739" class="lk ll iq bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated">AutoML 排行榜</h1><p id="c05a" class="pw-post-body-paragraph kc kd iq ke b kf ml kh ki kj mm kl km kn nk kp kq kr nl kt ku kv nm kx ky kz ij bi translated">排行榜是 AutoML 列出表现最佳车型的地方。</p><pre class="lc ld le lf gt mz lj na nb aw nc bi"><span id="6d1d" class="nd ll iq lj b gy ne nf l ng nh">aml@leaderboard</span></pre><h1 id="10f7" class="lk ll iq bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated">预测和提交</h1><pre class="lc ld le lf gt mz lj na nb aw nc bi"><span id="92e6" class="nd ll iq lj b gy ne nf l ng nh">pred &lt;- h2o.predict(aml, test_h)  </span><span id="236e" class="nd ll iq lj b gy ni nf l ng nh">submission$label &lt;- as.vector(pred$predict)</span><span id="c11b" class="nd ll iq lj b gy ni nf l ng nh">#write_csv(submission, "submission_automl.csv")</span></pre><h1 id="23a1" class="lk ll iq bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated">提交(为 Kaggle)</h1><pre class="lc ld le lf gt mz lj na nb aw nc bi"><span id="f836" class="nd ll iq lj b gy ne nf l ng nh">write_csv(submission, "submission_automl.csv")</span></pre><p id="f16d" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">这是目前 Kaggle 上的一个游乐场比赛。所以，这个提交文件可以提交给这个比赛。根据上述参数，提交的内容在公共排行榜上的得分为<code class="fe lg lh li lj b">0.90720</code>。<code class="fe lg lh li lj b">0.90</code>在 MNIST 分类中得分接近于零，但我希望这段代码片段可以作为任何试图开始使用 AutoML 的人的快速入门模板。</p><h1 id="bd11" class="lk ll iq bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated">参考</h1><ul class=""><li id="d639" class="mj mk iq ke b kf ml kj mm kn mn kr mo kv mp kz mq mr ms mt bi translated"><a class="ae la" href="https://www.kaggle.com/nulldata/kannada-mnist-h2o-automl-in-r" rel="noopener ugc nofollow" target="_blank">卡纳达 MNIST H2O 汽车在 R-Kaggle 笔记本</a></li><li id="c68c" class="mj mk iq ke b kf mu kj mv kn mw kr mx kv my kz mq mr ms mt bi translated"><a class="ae la" href="https://www.kaggle.com/c/Kannada-MNIST" rel="noopener ugc nofollow" target="_blank">卡纳达语-MNIST 卡格尔语比赛</a></li><li id="b5a3" class="mj mk iq ke b kf mu kj mv kn mw kr mx kv my kz mq mr ms mt bi translated"><a class="ae la" href="http://docs.h2o.ai/h2o/latest-stable/h2o-docs/automl.html" rel="noopener ugc nofollow" target="_blank"> H2O 汽车文件</a></li></ul><p id="2b3e" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><strong class="ke ir"> <em class="nn">此文最初发表于</em></strong><a class="ae la" href="https://www.programmingwithr.com/kannada-mnist-prediction-classification-using-h2o-automl-in-r/" rel="noopener ugc nofollow" target="_blank"><strong class="ke ir"><em class="nn"/></strong></a></p><p id="942a" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><strong class="ke ir"> <em class="nn">如果你喜欢这个，请订阅我的</em> </strong> <a class="ae la" href="https://nulldata.substack.com/" rel="noopener ugc nofollow" target="_blank"> <strong class="ke ir"> <em class="nn">语言无关的数据科学时事通讯</em> </strong> </a> <strong class="ke ir"> <em class="nn">并分享给你的朋友！</em> </strong></p></div></div>    
</body>
</html>