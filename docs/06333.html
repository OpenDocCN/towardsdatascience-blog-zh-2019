<html>
<head>
<title>Is ReLU ReLUvant?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">ReLU 是 ReLUvant 吗？</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/is-relu-reluvant-52b03bc48daa?source=collection_archive---------33-----------------------#2019-09-11">https://towardsdatascience.com/is-relu-reluvant-52b03bc48daa?source=collection_archive---------33-----------------------#2019-09-11</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="ab25" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">质疑深层神经网络中非常基本的元素</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi kf"><img src="../Images/330d675e69c1272d4a96e4ac585d52fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1260/format:webp/0*Upg3BHFI3aw41VjL.jpg"/></div><figcaption class="kn ko gj gh gi kp kq bd b be z dk">Photo by: <a class="ae kr" href="https://twitter.com/nurikolan?lang=en" rel="noopener ugc nofollow" target="_blank">Nur Lan</a></figcaption></figure><p id="c53a" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">近年来，深度神经网络被广泛应用于不同的领域。即使在今天，我们也在尝试构建更广泛、更深入的架构来解决现实世界的问题。深度神经网络的关键方面是它的非线性，这通过激活函数来实现。在 CNN 中，用于对象识别的大多数现有技术模型在网络架构内的卷积层之前或之后具有激活函数。但是有激活功能有多重要呢？我们真的需要为执行的每个卷积设置一个激活函数吗？我们将在本文中讨论其中的一些问题。</p></div><div class="ab cl lo lp hu lq" role="separator"><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt"/></div><div class="ij ik il im in"><h1 id="adc6" class="lv lw iq bd lx ly lz ma mb mc md me mf jw mg jx mh jz mi ka mj kc mk kd ml mm bi translated">激活有各种形式</h1><p id="3975" class="pw-post-body-paragraph ks kt iq ku b kv mn jr kx ky mo ju la lb mp ld le lf mq lh li lj mr ll lm ln ij bi translated">近年来，已经设计了不同的激活函数。随着大量实验集中于确定 CNN 的“最佳”激活，每篇论文都声称比同行的表现更好。一些广为人知的激活有:</p><p id="d964" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated"><strong class="ku ir"> ReLU </strong></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="gh gi ms"><img src="../Images/dbbae2653703e04c315370e08ae59a44.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*n_ZGycAljU90iweS.png"/></div></div></figure><pre class="kg kh ki kj gt mx my mz na aw nb bi"><span id="e175" class="nc lw iq my b gy nd ne l nf ng">ReLU(x) = max(0, x)</span></pre><p id="971d" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated"><strong class="ku ir">漏 ReLU 和 P ReLU </strong></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="gh gi nh"><img src="../Images/3c5225be2d604131a7b9ff6465c0c407.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*2ZqmbbtXYKl_7bij.png"/></div></div></figure><p id="ddf5" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">泄漏 ReLU 和参数 ReLU 与正值 x 的 ReLU 相似，但负值的斜率较小。在泄漏 ReLU 中，该斜率常数为 0.01。</p><pre class="kg kh ki kj gt mx my mz na aw nb bi"><span id="d60d" class="nc lw iq my b gy nd ne l nf ng"><em class="ni">Leaky ReLU = 0.01x</em> ∀ <em class="ni">x &lt; 0<br/>Parametric ReLU = ax &amp; 0&lt;a&lt;1 </em>∀<em class="ni"> x&lt; 0</em></span></pre><p id="0ed4" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated"><strong class="ku ir"> ELU 和 SELU </strong></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="gh gi nj"><img src="../Images/6a5d7ca8f5ecde8f69c0a96d235d0aeb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*SBr_q8_rfEDSDiTF.png"/></div></div></figure><pre class="kg kh ki kj gt mx my mz na aw nb bi"><span id="82c2" class="nc lw iq my b gy nd ne l nf ng">Exponential Linear Unit = α.(e^x –1) ∀ x&lt;=0 <br/><em class="ni">Scaled Exponential Linear Units =  </em>λx ∀ x&gt;0<em class="ni"><br/>                                =  </em>λ(α.(e^x –1)) ∀ x&lt;=0</span></pre><p id="9aa8" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">与 ReLU 相比，ELU 和 SELU 在 x=0 时具有更平滑的曲线。</p></div><div class="ab cl lo lp hu lq" role="separator"><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt"/></div><div class="ij ik il im in"><p id="9f71" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">尽管有如此花哨的激活功能可用，但最近大多数 CNN 模型都只采用了 ReLU，这可能意味着，如果不是最好的，它的性能与任何其他激活功能一样好。可能的原因是:这很简单，使得反向传播更容易校正权重和保持更少的参数。因此，它有助于模型更快地训练和收敛。</p><p id="423c" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">这在很大程度上证明了 ReLU 的优势，但是我们还没有得到第二个问题的答案:在网络中的每个卷积层之后是否需要使用激活函数？为了回答这个问题，让我们开始我们的实验。</p><h1 id="5520" class="lv lw iq bd lx ly nk ma mb mc nl me mf jw nm jx mh jz nn ka mj kc no kd ml mm bi translated">实验</h1><p id="95ae" class="pw-post-body-paragraph ks kt iq ku b kv mn jr kx ky mo ju la lb mp ld le lf mq lh li lj mr ll lm ln ij bi translated">让我们从具有完全预激活的 ResNet 块的 ResNet18 模型开始。在这个实验中，我们将随机丢弃一些 ReLU 激活函数，从 100%开始，在每个后续实验中丢弃 10%，保持所有其他参数一致。</p><blockquote class="np nq nr"><p id="6159" class="ks kt ni ku b kv kw jr kx ky kz ju la ns lc ld le nt lg lh li nu lk ll lm ln ij bi translated">在本实验中，我们将使用 CIFAR10 数据集。</p></blockquote><h2 id="cecc" class="nc lw iq bd lx nv nw dn mb nx ny dp mf lb nz oa mh lf ob oc mj lj od oe ml of bi translated"><strong class="ak">超参数</strong></h2><pre class="kg kh ki kj gt mx my mz na aw nb bi"><span id="1f66" class="nc lw iq my b gy nd ne l nf ng">BATCH_SIZE = 512<br/>MOMENTUM = 0.9<br/>WEIGHT_DECAY = 5e-4<br/>LEARNING_RATE = 0.4<br/>EPOCHS = 24<br/>ReLUPercent =100</span></pre><h2 id="fbad" class="nc lw iq bd lx nv nw dn mb nx ny dp mf lb nz oa mh lf ob oc mj lj od oe ml of bi translated"><strong class="ak">图像增强</strong></h2><pre class="kg kh ki kj gt mx my mz na aw nb bi"><span id="76b7" class="nc lw iq my b gy nd ne l nf ng">Height and Width shift range = 0.15625,<br/>Rotation range = 12<br/>Random LR Flip</span></pre><h2 id="915d" class="nc lw iq bd lx nv nw dn mb nx ny dp mf lb nz oa mh lf ob oc mj lj od oe ml of bi translated"><strong class="ak">优化器</strong></h2><p id="280f" class="pw-post-body-paragraph ks kt iq ku b kv mn jr kx ky mo ju la lb mp ld le lf mq lh li lj mr ll lm ln ij bi translated">使用动量为 0.9，重量衰减为 5e-4 的 SGD。一个周期的学习率策略，在第 5 个时期具有 0.4 的最大 LR，并向后面的时期逐渐下降。</p><h2 id="8311" class="nc lw iq bd lx nv nw dn mb nx ny dp mf lb nz oa mh lf ob oc mj lj od oe ml of bi translated">体系结构</h2><p id="54c2" class="pw-post-body-paragraph ks kt iq ku b kv mn jr kx ky mo ju la lb mp ld le lf mq lh li lj mr ll lm ln ij bi translated">该模型有 4 个 ResNet 块。与传统的 ResNet 不同，在 ResNet 块的末尾，我们连接输入和残差路径，然后进行逐点卷积，以过滤前面获取的信息。<br/>该模型有 25 个激活层(24 个 ReLUs 和 1 个 softMax)。</p><h2 id="74d3" class="nc lw iq bd lx nv nw dn mb nx ny dp mf lb nz oa mh lf ob oc mj lj od oe ml of bi translated">基准</h2><p id="d0a3" class="pw-post-body-paragraph ks kt iq ku b kv mn jr kx ky mo ju la lb mp ld le lf mq lh li lj mr ll lm ln ij bi translated">在 CIFAR10 数据集上，该模型在 Google Colab 上 800 秒下的 24 个历元中给出了约 88%的验证准确率。该模型有大约 27M 个参数。</p><h2 id="31d1" class="nc lw iq bd lx nv nw dn mb nx ny dp mf lb nz oa mh lf ob oc mj lj od oe ml of bi translated"><strong class="ak">训练</strong></h2><div class="kg kh ki kj gt ab cb"><figure class="og kk oh oi oj ok ol paragraph-image"><img src="../Images/5f4f5ffad4c045fd419b509ae380e8e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:990/format:webp/1*4hKmqU6T34xKhY6iDBcDeA.png"/></figure><figure class="og kk oh oi oj ok ol paragraph-image"><img src="../Images/6c9caa143c4a5d50ae83ec9b3c757282.png" data-original-src="https://miro.medium.com/v2/resize:fit:990/format:webp/1*sep57SXmYqlvr8rtU7CMqA.png"/><figcaption class="kn ko gj gh gi kp kq bd b be z dk om di on oo">Plot 1: a)Validation Accuracy Curve, b) Training Accuracy Curve</figcaption></figure></div><p id="b140" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated"><strong class="ku ir">结果</strong></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="gh gi op"><img src="../Images/ab8dea1f276d99dd6d990aa4ac208262.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fZC6IqrhGKcSWsJ-7Ffj4w.png"/></div></div><figcaption class="kn ko gj gh gi kp kq bd b be z dk">Table1: Accuracy Comparision</figcaption></figure><p id="4567" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">令人惊讶的是，当随机丢弃 10%的 ReLUs 时，获得了最佳的精度。第二好的准确度是当模型使用原始网络中总 ReLUs 的 80%时。对于一个卷积 100%次，我们有一个 ReLU 的精度是在最佳精度之后的<strong class="ku ir"> 1.58% </strong>。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oq"><img src="../Images/aab0d6a530695e26286fdf9917acbccd.png" data-original-src="https://miro.medium.com/v2/resize:fit:772/format:webp/1*4goi7jyz49_ZY-Xo5a_Kkg.png"/></div><figcaption class="kn ko gj gh gi kp kq bd b be z dk">Plot 2: Max Validation Accuracy</figcaption></figure><p id="2df4" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">有了这些结果，我们可以部分回答我们的问题</p><blockquote class="np nq nr"><p id="4cca" class="ks kt ni ku b kv kw jr kx ky kz ju la ns lc ld le nt lg lh li nu lk ll lm ln ij bi translated">在每个卷积后盲目添加 ReLU 是构建 CNN 架构的正确方式吗？<br/>大概不会！<br/>有没有更好的办法？<br/>肯定是的！<br/>如何决定是否需要添加 ReLU？<br/>网格搜索可以是一种方式，但我想不出任何其他最优方式来决定是否在一次卷积后添加 ReLU。</p></blockquote><p id="4b6f" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">虽然我们仍然不知道卷积层是否具有 ReLU 的适当方法，但希望这确实有助于我们理解，在设计深度神经网络时，仍然需要质疑非常基本的元素的使用。</p><p id="939b" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">实验可以在这个<a class="ae kr" href="https://colab.research.google.com/drive/1F6MZPmOyMmZfXuVVuUC_AuRBfimKwHH2" rel="noopener ugc nofollow" target="_blank"> Colab 笔记本</a>里找到。</p><p id="5cb6" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated"><strong class="ku ir">感谢您的阅读！请在评论中告诉我你的想法。再次感谢，继续学习！</strong></p></div><div class="ab cl lo lp hu lq" role="separator"><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt"/></div><div class="ij ik il im in"><p id="f87d" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">[1]:何、、张、向宇、任、、孙、简。(2016).<a class="ae kr" href="https://arxiv.org/pdf/1512.03385.pdf" rel="noopener ugc nofollow" target="_blank">用于图像识别的深度残差学习</a>。770–778.10.1109/cvpr . 2016.90 .<br/>【2】:克日涅夫斯基，亚历克斯。(2012).<a class="ae kr" href="https://www.cs.toronto.edu/~kriz/learning-features-2009-TR.pdf" rel="noopener ugc nofollow" target="_blank">从微小图像中学习多层特征</a>。多伦多大学。</p></div></div>    
</body>
</html>