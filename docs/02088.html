<html>
<head>
<title>Ten random useful things in R that you might not know about</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">R 中十个你可能不知道的随机有用的东西</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/ten-random-useful-things-in-r-that-you-might-not-know-about-54b2044a3868?source=collection_archive---------7-----------------------#2019-04-06">https://towardsdatascience.com/ten-random-useful-things-in-r-that-you-might-not-know-about-54b2044a3868?source=collection_archive---------7-----------------------#2019-04-06</a></blockquote><div><div class="fc ij ik il im in"/><div class="io ip iq ir is"><div class=""/><div class=""><h2 id="26fe" class="pw-subtitle-paragraph js iu iv bd b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj dk translated">r 充满了有用的东西。这里有一些我经常使用的东西，其他人可能不知道。</h2></div><p id="757f" class="pw-post-body-paragraph kk kl iv km b kn ko jw kp kq kr jz ks kt ku kv kw kx ky kz la lb lc ld le lf io bi translated">我经常发现自己告诉我的同事和程序员同事一些我在 R 中使用的简单的事情，这些事情真的对我需要继续前进的任务有帮助。这些范围从琐碎的快捷方式，到鲜为人知的功能，到方便的小技巧。</p><p id="ab9f" class="pw-post-body-paragraph kk kl iv km b kn ko jw kp kq kr jz ks kt ku kv kw kx ky kz la lb lc ld le lf io bi translated">因为 R 生态系统是如此丰富和不断增长，人们可能经常错过了解一些真正能帮助他们完成任务的东西。所以我经常会从我的观众那里得到惊讶的反应，比如“我从来不知道这件事！”。</p><p id="7f35" class="pw-post-body-paragraph kk kl iv km b kn ko jw kp kq kr jz ks kt ku kv kw kx ky kz la lb lc ld le lf io bi translated">以下是让我在 r 工作更轻松的十件事。如果你已经全部知道了，很抱歉浪费了你的阅读时间，请考虑添加一些你认为对其他读者有益的评论。</p><h2 id="a508" class="lg lh iv bd li lj lk dn ll lm ln dp lo kt lp lq lr kx ls lt lu lb lv lw lx ly bi translated">1.<code class="fe lz ma mb mc b">switch</code>功能</h2><p id="29eb" class="pw-post-body-paragraph kk kl iv km b kn md jw kp kq me jz ks kt mf kv kw kx mg kz la lb mh ld le lf io bi translated">我爱<code class="fe lz ma mb mc b">switch()</code>。它基本上是一个根据另一个变量的值选择其值的<code class="fe lz ma mb mc b">if</code>语句的简化。我发现当我编写需要根据您之前的选择加载不同数据集的代码时，它特别有用。例如，如果你有一个名为<code class="fe lz ma mb mc b">animal</code>的变量，你想根据<code class="fe lz ma mb mc b">animal</code>是狗、猫还是兔子来加载一组不同的数据，你可以这样写:</p><pre class="mi mj mk ml gt mm mc mn mo aw mp bi"><span id="44ac" class="lg lh iv mc b gy mq mr l ms mt">data &lt;- read.csv(<br/>  switch(animal, <br/>         "dog" = "dogdata.csv", <br/>         "cat" = "catdata.csv",<br/>         "rabbit" = "rabbitdata.csv")<br/>)</span></pre><p id="78c7" class="pw-post-body-paragraph kk kl iv km b kn ko jw kp kq kr jz ks kt ku kv kw kx ky kz la lb lc ld le lf io bi translated">这在闪亮的应用程序中特别有用，在这些应用程序中，您可能希望根据一个或多个输入菜单选项来加载不同的数据集甚至环境文件。</p><h2 id="410a" class="lg lh iv bd li lj lk dn ll lm ln dp lo kt lp lq lr kx ls lt lu lb lv lw lx ly bi translated">2.RStudio 快捷键</h2><p id="5fc6" class="pw-post-body-paragraph kk kl iv km b kn md jw kp kq me jz ks kt mf kv kw kx mg kz la lb mh ld le lf io bi translated">这与其说是 R hack，不如说是 RStudio IDE，但是常用命令的快捷键非常有用，可以节省大量的键入时间。我最喜欢的两个是管道操作符<code class="fe lz ma mb mc b">%&gt;%</code>的 Ctrl+Shift+M 和赋值操作符<code class="fe lz ma mb mc b">&lt;-</code>的 Alt+。如果你想看到这些令人敬畏的快捷键的完整集合，只需在 RStudio 中键入 Atl+Shift+K。</p><h2 id="52a1" class="lg lh iv bd li lj lk dn ll lm ln dp lo kt lp lq lr kx ls lt lu lb lv lw lx ly bi translated">3.flex 仪表板包</h2><p id="6b1c" class="pw-post-body-paragraph kk kl iv km b kn md jw kp kq me jz ks kt mf kv kw kx mg kz la lb mh ld le lf io bi translated">如果你想要一个快速闪亮的仪表板，并以最少的忙乱运行，<code class="fe lz ma mb mc b">flexdashboard</code>包有你需要的一切。它提供了简单的 HTML 快捷方式，可以方便地构建侧栏和将显示组织成行和列。它还有一个超级灵活的标题栏，你可以将你的应用程序组织到不同的页面，并放置图标和链接到 Github 代码或电子邮件地址或其他任何东西。作为一个在<code class="fe lz ma mb mc b">RMarkdown</code>中运行的包，它还允许你将所有的应用保存在一个<code class="fe lz ma mb mc b">Rmd</code>文件中，而不需要像<code class="fe lz ma mb mc b">shinydashboard</code>那样将它分解成单独的服务器和 UI 文件。每当我需要在进入更高级的设计之前创建一个简单的仪表板原型时，我都会使用<code class="fe lz ma mb mc b">flexdashboard</code>。我经常可以使用<code class="fe lz ma mb mc b">flexdashboard</code>在一个小时内设置并运行仪表盘。</p><h2 id="2cf1" class="lg lh iv bd li lj lk dn ll lm ln dp lo kt lp lq lr kx ls lt lu lb lv lw lx ly bi translated">4.R Shiny 中 req 和 validate 函数</h2><p id="9741" class="pw-post-body-paragraph kk kl iv km b kn md jw kp kq me jz ks kt mf kv kw kx mg kz la lb mh ld le lf io bi translated">r 闪亮的开发可能会令人沮丧，尤其是当您得到一般性的错误消息时，这些消息不能帮助您理解到底出了什么问题。随着 Shiny 的发展，越来越多的验证和测试功能被添加进来，以帮助更好地诊断和在特定错误发生时发出警报。<code class="fe lz ma mb mc b">req()</code>功能允许您阻止一个动作的发生，除非环境中存在另一个变量，但这样做是无声的，不会显示错误。因此，您可以使 UI 元素的显示以之前的操作为条件。例如，参考我上面的示例 1:</p><pre class="mi mj mk ml gt mm mc mn mo aw mp bi"><span id="d436" class="lg lh iv mc b gy mq mr l ms mt"><br/>output$go_button &lt;- shiny::renderUI({</span><span id="7062" class="lg lh iv mc b gy mu mr l ms mt">  # only display button if an animal input has been chosen<br/>  <br/>  shiny::req(input$animal)</span><span id="1886" class="lg lh iv mc b gy mu mr l ms mt">  # display button</span><span id="e0c3" class="lg lh iv mc b gy mu mr l ms mt">  shiny::actionButton("go", <br/>                      paste("Conduct", input$animal, "analysis!") <br/>  )<br/>})</span></pre><p id="0175" class="pw-post-body-paragraph kk kl iv km b kn ko jw kp kq kr jz ks kt ku kv kw kx ky kz la lb lc ld le lf io bi translated"><code class="fe lz ma mb mc b">validate()</code>在呈现输出之前进行检查，并使您能够在不满足特定条件时返回定制的错误消息，例如，如果用户上传了错误的文件:</p><pre class="mi mj mk ml gt mm mc mn mo aw mp bi"><span id="15d2" class="lg lh iv mc b gy mq mr l ms mt"># get csv input file</span><span id="0ad4" class="lg lh iv mc b gy mu mr l ms mt">inFile &lt;- input$file1<br/>data &lt;- inFile$datapath</span><span id="131d" class="lg lh iv mc b gy mu mr l ms mt"># render table only if it is dogs</span><span id="968a" class="lg lh iv mc b gy mu mr l ms mt">shiny::renderTable({<br/>  # check that it is the dog file, not cats or rabbits<br/>  shiny::validate(<br/>    need("Dog Name" %in% colnames(data)),<br/>    "Dog Name column not found - did you load the right file?"<br/>  )</span><span id="817d" class="lg lh iv mc b gy mu mr l ms mt">  data<br/>})</span></pre><p id="d5bd" class="pw-post-body-paragraph kk kl iv km b kn ko jw kp kq kr jz ks kt ku kv kw kx ky kz la lb lc ld le lf io bi translated">关于这些函数更多信息，请参见我的另一篇文章<a class="ae mv" rel="noopener" target="_blank" href="/in-r-shiny-when-is-an-error-really-an-error-702205ebb5d5">这里的</a>。</p><h2 id="57eb" class="lg lh iv bd li lj lk dn ll lm ln dp lo kt lp lq lr kx ls lt lu lb lv lw lx ly bi translated">5.使用隐藏凭据。伦韦龙</h2><p id="939a" class="pw-post-body-paragraph kk kl iv km b kn md jw kp kq me jz ks kt mf kv kw kx mg kz la lb mh ld le lf io bi translated">如果您正在共享需要登录数据库等凭证的代码，您可以使用<code class="fe lz ma mb mc b">.Reviron</code>文件来避免将这些凭证发布到 Github 或其他可能存在风险的空间。<code class="fe lz ma mb mc b">.Renviron</code>是一个可以存储重要环境变量的文件，可以使用<code class="fe lz ma mb mc b">usethis</code>包中的<code class="fe lz ma mb mc b">edit_r_environ()</code>函数轻松编辑。例如，您可以在<code class="fe lz ma mb mc b">.Renviron</code>中为您的远程数据库凭证设置一个别名，例如:</p><pre class="mi mj mk ml gt mm mc mn mo aw mp bi"><span id="9864" class="lg lh iv mc b gy mq mr l ms mt">  DSN = "database_name",<br/>  UID = "User ID",<br/>  PASS = "Password"</span></pre><p id="8bad" class="pw-post-body-paragraph kk kl iv km b kn ko jw kp kq kr jz ks kt ku kv kw kx ky kz la lb lc ld le lf io bi translated">然后在你的共享脚本中，你可以调用这些变量。例如:</p><pre class="mi mj mk ml gt mm mc mn mo aw mp bi"><span id="e2e3" class="lg lh iv mc b gy mq mr l ms mt">db &lt;- DBI::dbConnect(<br/>  drv = odbc::odbc(),<br/>  dsn = Sys.getenv("DSN"),<br/>  uid = Sys.getenv("UID"),<br/>  pwd = Sys.getenv("PASS")<br/>)</span></pre><h2 id="49de" class="lg lh iv bd li lj lk dn ll lm ln dp lo kt lp lq lr kx ls lt lu lb lv lw lx ly bi translated">6.使用 styler 自动进行 tidyverse 造型</h2><p id="93f7" class="pw-post-body-paragraph kk kl iv km b kn md jw kp kq me jz ks kt mf kv kw kx mg kz la lb mh ld le lf io bi translated">这是艰难的一天，你已经有很多事情要做了。你的代码不像你想的那样整洁，你没有时间来编辑它。不要害怕。<code class="fe lz ma mb mc b">styler</code>包有许多功能，允许你的代码自动重定风格以匹配 tidyverse 风格。在你混乱的脚本上运行<code class="fe lz ma mb mc b">styler::style_file()</code>很简单，它会为你做很多(虽然不是全部)工作。</p><h2 id="db21" class="lg lh iv bd li lj lk dn ll lm ln dp lo kt lp lq lr kx ls lt lu lb lv lw lx ly bi translated">7.参数化 R 降价文档</h2><p id="b884" class="pw-post-body-paragraph kk kl iv km b kn md jw kp kq me jz ks kt mf kv kw kx mg kz la lb mh ld le lf io bi translated">所以你写了一个可爱的 R Markdown 文档，其中你分析了一大堆关于狗的事实。然后你被告知——“不，我对猫更感兴趣”。不要害怕。如果您将 R markdown 文档参数化，那么只需一个命令就可以自动生成类似的关于 cats 的报告。</p><p id="ed86" class="pw-post-body-paragraph kk kl iv km b kn ko jw kp kq kr jz ks kt ku kv kw kx ky kz la lb lc ld le lf io bi translated">您可以通过在 R Markdown 文档的 YAML 头中定义参数，并给每个参数赋予一个值来做到这一点。例如:</p><pre class="mi mj mk ml gt mm mc mn mo aw mp bi"><span id="7e02" class="lg lh iv mc b gy mq mr l ms mt">---<br/>title: "Animal Analysis"<br/>author: "Keith McNulty"<br/>date: "21 March 2019"<br/>output:<br/>  html_document:<br/>    code_folding: "hide"<br/>params:<br/>  animal_name:<br/>    value: Dog<br/>    choices:<br/>      - Dog<br/>      - Cat<br/>      - Rabbit<br/>  years_of_study:<br/>    input: slider<br/>    min: 2000<br/>    max: 2019<br/>    step: 1<br/>    round: 1<br/>    sep: ''<br/>    value: [2010, 2017]<br/>---</span></pre><p id="5253" class="pw-post-body-paragraph kk kl iv km b kn ko jw kp kq kr jz ks kt ku kv kw kx ky kz la lb lc ld le lf io bi translated">现在，您可以将这些变量作为<code class="fe lz ma mb mc b">params$animal_name</code>和<code class="fe lz ma mb mc b">params$years_of_study</code>写入文档中的 R 代码。如果您正常编织您的文档，它将按照<code class="fe lz ma mb mc b">value</code>变量用这些参数的默认值编织。但是，如果您通过在 RStudio 的编织下拉菜单中选择此选项(或使用<code class="fe lz ma mb mc b">knit_with_parameters()</code>)来编织参数，则会出现一个可爱的菜单选项，供您在编织文档之前选择参数。厉害！</p><figure class="mi mj mk ml gt mx gh gi paragraph-image"><div class="gh gi mw"><img src="../Images/793b278df61f0b21f83666de32b8cc10.png" data-original-src="https://miro.medium.com/v2/resize:fit:1362/format:webp/1*BzZCeP-CM9Oglfmy8SqNKw.jpeg"/></div><figcaption class="na nb gj gh gi nc nd bd b be z dk">Knitting with Parameters</figcaption></figure><h2 id="a4a7" class="lg lh iv bd li lj lk dn ll lm ln dp lo kt lp lq lr kx ls lt lu lb lv lw lx ly bi translated">8.revealjs</h2><p id="3fec" class="pw-post-body-paragraph kk kl iv km b kn md jw kp kq me jz ks kt mf kv kw kx mg kz la lb mh ld le lf io bi translated"><code class="fe lz ma mb mc b">revealjs</code>是一个软件包，可以让你用一个直观的幻灯片导航菜单创建漂亮的 HTML 演示文稿，并嵌入 R 代码。它可以在 R Markdown 中使用，有非常直观的 HTML 快捷方式，允许您创建一个嵌套的、逻辑结构的漂亮幻灯片，有各种样式选项。事实上，演示是 HTML 格式的，这意味着人们可以在平板电脑或手机上听你讲话，这非常方便。您可以通过安装包并在您的 YAML 头文件中调用它来建立一个<code class="fe lz ma mb mc b">revealjs</code>演示。这是我最近用<code class="fe lz ma mb mc b">revealjs</code>做的一个演讲的 YAML 标题的例子</p><pre class="mi mj mk ml gt mm mc mn mo aw mp bi"><span id="e1cc" class="lg lh iv mc b gy mq mr l ms mt">---<br/>title: "Exporing the Edge of the People Analytics Universe"<br/>author: "Keith McNulty"<br/>output:<br/>  revealjs::revealjs_presentation:<br/>    center: yes<br/>    template: starwars.html<br/>    theme: black<br/>date: "HR Analytics Meetup London - 18 March, 2019"<br/>resource_files:<br/>- darth.png<br/>- deathstar.png<br/>- hanchewy.png<br/>- millenium.png<br/>- r2d2-threepio.png<br/>- starwars.html<br/>- starwars.png<br/>- stormtrooper.png<br/>---</span></pre><p id="b994" class="pw-post-body-paragraph kk kl iv km b kn ko jw kp kq kr jz ks kt ku kv kw kx ky kz la lb lc ld le lf io bi translated">这是一个例子。你可以在这里找到代码<a class="ae mv" href="https://github.com/keithmcnulty/hr_meetup_london/blob/master/presentation.Rmd" rel="noopener ugc nofollow" target="_blank">，在这里</a>找到演示<a class="ae mv" href="http://rpubs.com/keithmcnulty/hr_meetup_london" rel="noopener ugc nofollow" target="_blank">。</a></p><figure class="mi mj mk ml gt mx gh gi paragraph-image"><div role="button" tabindex="0" class="nf ng di nh bf ni"><div class="gh gi ne"><img src="../Images/60bd07df3c8d75f488bafc1150943cba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mk3-CcnntnPLYetYjwnQrQ.jpeg"/></div></div><figcaption class="na nb gj gh gi nc nd bd b be z dk">Easy online presentations using revealjs</figcaption></figure><h2 id="018f" class="lg lh iv bd li lj lk dn ll lm ln dp lo kt lp lq lr kx ls lt lu lb lv lw lx ly bi translated">9.R Shiny 中的 HTML 标签(例如在你的 Shiny 应用程序中播放音频)</h2><p id="b71f" class="pw-post-body-paragraph kk kl iv km b kn md jw kp kq me jz ks kt mf kv kw kx mg kz la lb mh ld le lf io bi translated">大多数人没有充分利用 R Shiny 中可用的 HTML 标签。有 110 个标签提供了各种 HTML 格式和其他命令的快捷方式。最近，我开发了一个闪亮的应用程序，它需要很长时间来执行一项任务。知道用户可能会在等待任务完成的同时进行多任务处理，我使用<code class="fe lz ma mb mc b">tags$audio</code>让应用程序播放胜利的号角，在任务完成时提醒用户。</p><h2 id="8b2e" class="lg lh iv bd li lj lk dn ll lm ln dp lo kt lp lq lr kx ls lt lu lb lv lw lx ly bi translated">10.表扬包</h2><p id="8b22" class="pw-post-body-paragraph kk kl iv km b kn md jw kp kq me jz ks kt mf kv kw kx mg kz la lb mh ld le lf io bi translated">可笑的简单，但也很棒，<code class="fe lz ma mb mc b">praise</code>包向用户传递赞美。虽然这看起来像是毫无意义的自我欣赏，但它实际上在编写简历包时非常有用，如果某人做对了，你可以对他进行表扬或鼓励，例如，如果一个过程成功完成。你也可以把它放在一个复杂脚本的末尾，当它成功运行时，给你额外的快乐。</p><figure class="mi mj mk ml gt mx gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/56ed4eb4356bda940b29ec067a8c197b.png" data-original-src="https://miro.medium.com/v2/resize:fit:694/format:webp/1*R4KAUfjJHlh93KbZFc7krA.jpeg"/></div><figcaption class="na nb gj gh gi nc nd bd b be z dk">The praise package</figcaption></figure><p id="dc39" class="pw-post-body-paragraph kk kl iv km b kn ko jw kp kq kr jz ks kt ku kv kw kx ky kz la lb lc ld le lf io bi translated"><em class="nk">最初我是一名纯粹的数学家，后来我成为了一名心理计量学家和数据科学家。我热衷于将所有这些学科的严谨性应用到复杂的人的问题上。我也是一个编码极客和日本 RPG 的超级粉丝。在</em> <a class="ae mv" href="https://www.linkedin.com/in/keith-mcnulty/" rel="noopener ugc nofollow" target="_blank"> <em class="nk"> LinkedIn </em> </a> <em class="nk">或</em><a class="ae mv" href="https://twitter.com/dr_keithmcnulty" rel="noopener ugc nofollow" target="_blank"><em class="nk">Twitter</em></a><em class="nk">上找我。</em></p><figure class="mi mj mk ml gt mx gh gi paragraph-image"><div role="button" tabindex="0" class="nf ng di nh bf ni"><div class="gh gi nl"><img src="../Images/b8062ef2e0fc5f333b56b39698d2de5c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Jh-R8Yqr7g9knYVYVmd7qQ.png"/></div></div></figure></div></div>    
</body>
</html>