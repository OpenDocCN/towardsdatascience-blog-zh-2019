<html>
<head>
<title>Reinforcement Learning — The Value Function</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">强化学习——价值函数</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/reinforcement-learning-value-function-57b04e911152?source=collection_archive---------7-----------------------#2019-06-30">https://towardsdatascience.com/reinforcement-learning-value-function-57b04e911152?source=collection_archive---------7-----------------------#2019-06-30</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="a783" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">利用价值函数的代理学习井字游戏的强化学习算法</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/3d0d11d94bedf5a6bab9a9397393e21a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OgsOwJEzN4wRxexZcqZmYg.png"/></div></div></figure><h2 id="814e" class="ku kv it bd kw kx ky dn kz la lb dp lc ld le lf lg lh li lj lk ll lm ln lo lp bi translated">直觉</h2><p id="c273" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly ld lz ma mb lh mc md me ll mf mg mh mi im bi translated">在漫长的一天工作之后，你在两个选择之间做决定:回家写一篇中型文章或者和朋友去酒吧。如果你选择和朋友出去玩，你的朋友会让你感到快乐；然而，当你回家写文章时，在工作了一整天后，你会感到疲惫。在这个例子中，享受自己是一种奖励，感觉疲劳被视为一种消极的奖励，那么为什么要写文章呢？</p><p id="ed46" class="pw-post-body-paragraph lq lr it ls b lt mj ju lv lw mk jx ly ld ml ma mb lh mm md me ll mn mg mh mi im bi translated">因为在生活中，我们不会只考虑眼前的回报；我们计划了一系列的行动来决定未来可能的回报。也许写一篇文章会让你对某个特定的话题有更好的理解，得到认可，最终让你得到你梦寐以求的工作。在这个场景中，<em class="mo">得到你梦想中的工作</em>是从你采取的一系列行动中得到的延迟回报，然后我们想为处于这些状态的人分配一些<em class="mo">值</em>(例如“回家写一篇文章”)。为了确定一个状态的<em class="mo">值</em>，我们称之为“价值函数”。</p><p id="5ea8" class="pw-post-body-paragraph lq lr it ls b lt mj ju lv lw mk jx ly ld ml ma mb lh mm md me ll mn mg mh mi im bi translated">那么我们如何从过去吸取教训呢？假设你做了一些伟大的决定，并且处于人生中最好的状态。现在回顾一下你为达到这个阶段所做的各种决定:你把你的成功归功于什么？之前让你走向这种成功的状态是什么？你过去做过的哪些行为让你达到这种收到这个奖励的状态？你现在正在做的事情和你将来可能得到的回报有什么关系？</p><h2 id="23b9" class="ku kv it bd kw kx ky dn kz la lb dp lc ld le lf lg lh li lj lk ll lm ln lo lp bi translated">奖励与价值函数</h2><p id="8cc8" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly ld lz ma mb lh mc md me ll mf mg mh mi im bi translated">一个<em class="mo">奖励</em>立竿见影。它可以是在收集硬币的游戏中得分，赢得井字游戏或获得你梦想的工作。这个<em class="mo">奖励</em>就是你(或者代理)想要获取的。</p><p id="9369" class="pw-post-body-paragraph lq lr it ls b lt mj ju lv lw mk jx ly ld ml ma mb lh mm md me ll mn mg mh mi im bi translated">为了获得<em class="mo">奖励</em>，价值函数是确定处于状态的<em class="mo">价值</em>的有效方法。用<em class="mo"> V(s) </em>表示，这个价值函数衡量我们在这种状态<em class="mo"> s </em>下可能获得的潜在未来<em class="mo">回报</em>。</p><h2 id="b262" class="ku kv it bd kw kx ky dn kz la lb dp lc ld le lf lg lh li lj lk ll lm ln lo lp bi translated">定义价值函数</h2><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mp"><img src="../Images/c6f90f193b76387622618726bbd24301.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SHgn1Fs5Cuk7ghi6bbFs1g.png"/></div></div><figcaption class="mq mr gj gh gi ms mt bd b be z dk">Fig 1: State A leads to state B or C</figcaption></figure><p id="0966" class="pw-post-body-paragraph lq lr it ls b lt mj ju lv lw mk jx ly ld ml ma mb lh mm md me ll mn mg mh mi im bi translated">在图 1 中，我们如何确定状态 A 的<em class="mo">值</em>？有 50–50%的机会在下两个可能的状态中结束，状态 B 或 c。状态 A 的值就是所有下一个状态的<em class="mo">概率</em>乘以达到该状态的<em class="mo">奖励</em>。状态 A 的<em class="mo">值</em>为 0.5。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mu"><img src="../Images/a56dd9723fa7ff4c22f9f4545ab9bb32.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aItKdzw6yYQPZfB63G8gIw.png"/></div></div><figcaption class="mq mr gj gh gi ms mt bd b be z dk">Fig 2: One-way future states</figcaption></figure><p id="3816" class="pw-post-body-paragraph lq lr it ls b lt mj ju lv lw mk jx ly ld ml ma mb lh mm md me ll mn mg mh mi im bi translated">在图 2 中，您发现自己处于状态 D，只有一条可能的路径通往状态 E。由于状态 E 给出的<em class="mo">奖励</em>为 1，状态 D 的<em class="mo">值</em>也为 1，因为唯一的结果是获得<em class="mo">奖励</em>。</p><p id="4aac" class="pw-post-body-paragraph lq lr it ls b lt mj ju lv lw mk jx ly ld ml ma mb lh mm md me ll mn mg mh mi im bi translated">如果你处于状态 F(在图 2 中)，这只能导致状态 G，接着是状态 H。由于状态 H 的负<em class="mo">奖励</em>为-1，状态 G 的<em class="mo">值</em>也将为-1，对于状态 F 也是如此</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mv"><img src="../Images/4c65d81db8bca959cfbc279dc47fcfc9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZEAWqU5-zXF1kDlKYKc69w.png"/></div></div><figcaption class="mq mr gj gh gi ms mt bd b be z dk">Fig 3: Being in state J brings you closer to state K</figcaption></figure><p id="364f" class="pw-post-body-paragraph lq lr it ls b lt mj ju lv lw mk jx ly ld ml ma mb lh mm md me ll mn mg mh mi im bi translated"><a class="ae mw" href="https://jinglescode.github.io/reinforcement-learning-tic-tac-toe/" rel="noopener ugc nofollow" target="_blank">在这个井字游戏</a>中，连续得到 2 个<em class="mo"> X </em> s(图 3 中的状态 J)并不能赢得游戏，因此没有<em class="mo">奖励</em>。但是处于状态 J 会使你离状态 K 更近一步，完成一行<em class="mo"> X </em>就能赢得游戏，因此处于状态 J 会产生一个好的<em class="mo">值</em>。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mx"><img src="../Images/14fe94869c0155d1dc33235c3c4eb393.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MarjgZ_UVc1SncjtsV7HHg.png"/></div></div><figcaption class="mq mr gj gh gi ms mt bd b be z dk">Fig 4: State M has a higher value than state N</figcaption></figure><p id="f9b1" class="pw-post-body-paragraph lq lr it ls b lt mj ju lv lw mk jx ly ld ml ma mb lh mm md me ll mn mg mh mi im bi translated">在图 4 中，您会发现自己处于状态 L，正在考虑将下一个<em class="mo"> X </em>放在哪里。您可以将它放在顶部，这样就可以将您带到状态 M，在同一行中有 2 个<em class="mo"> X </em> s。另一种选择是将其放在最下面一行。与状态 N 相比，状态 M 应该具有更高的重要性和<em class="mo">值</em>,因为它导致更高的获胜可能性。</p><p id="6843" class="pw-post-body-paragraph lq lr it ls b lt mj ju lv lw mk jx ly ld ml ma mb lh mm md me ll mn mg mh mi im bi translated">因此，在任何给定的状态下，我们可以执行<em class="mo">动作</em>，通过选择产生最高<em class="mo">值</em>的状态，使我们(或代理人)更接近获得<em class="mo">奖励</em>。</p><h2 id="b15b" class="ku kv it bd kw kx ky dn kz la lb dp lc ld le lf lg lh li lj lk ll lm ln lo lp bi translated">井字游戏—初始化值函数</h2><p id="6320" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly ld lz ma mb lh mc md me ll mf mg mh mi im bi translated">井字游戏的价值函数<em class="mo"> V(s) </em>是达到状态<em class="mo"> s </em>的获胜概率。完成该初始化以定义获胜和失败状态。我们将状态初始化如下:</p><ul class=""><li id="4e70" class="my mz it ls b lt mj lw mk ld na lh nb ll nc mi nd ne nf ng bi translated"><em class="mo"> V(s) </em> = 1 —如果代理在状态<em class="mo"> s </em>中赢得游戏，则为终止状态</li><li id="7075" class="my mz it ls b lt nh lw ni ld nj lh nk ll nl mi nd ne nf ng bi translated"><em class="mo"> V(s) </em> = 0 —如果代理在状态<em class="mo"> s </em>中输掉或打平游戏，则为终止状态</li><li id="8d82" class="my mz it ls b lt nh lw ni ld nj lh nk ll nl mi nd ne nf ng bi translated"><em class="mo">V(s)</em>= 0.5——否则为非终止状态的 0.5，这将在训练期间进行微调</li></ul><h2 id="42f4" class="ku kv it bd kw kx ky dn kz la lb dp lc ld le lf lg lh li lj lk ll lm ln lo lp bi translated">井字游戏—更新值函数</h2><p id="375e" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly ld lz ma mb lh mc md me ll mf mg mh mi im bi translated">更新值函数是代理如何从过去的经验中学习，通过更新在训练过程中经历的那些状态的<em class="mo">值</em>。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/9844b95cb9fcc1aff3a916ba9ca7574e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/1*64gw5WJ_G7yD9Vn8PMcZNg.gif"/></div><figcaption class="mq mr gj gh gi ms mt bd b be z dk">Fig 5: Update the value of state s</figcaption></figure><p id="b29e" class="pw-post-body-paragraph lq lr it ls b lt mj ju lv lw mk jx ly ld ml ma mb lh mm md me ll mn mg mh mi im bi translated">状态<em class="mo">s’</em>是当前状态<em class="mo"> s </em>的下一个状态。我们可以通过添加状态<em class="mo"> s </em>和<em class="mo">s’</em>之间的<em class="mo">值</em>的差值来更新当前状态<em class="mo"> s </em>的<em class="mo">值</em>。α是<em class="mo">学习率</em>。</p><p id="e20b" class="pw-post-body-paragraph lq lr it ls b lt mj ju lv lw mk jx ly ld ml ma mb lh mm md me ll mn mg mh mi im bi translated">由于在任何给定的状态下可以采取多种行动，所以在一个状态下经常只选择一种行动可能会导致错过其他更好的状态。在强化学习中，这就是<a class="ae mw" rel="noopener" target="_blank" href="/striking-a-balance-between-exploring-and-exploiting-5475d9c1e66e">探索-利用困境</a>。</p><p id="aecb" class="pw-post-body-paragraph lq lr it ls b lt mj ju lv lw mk jx ly ld ml ma mb lh mm md me ll mn mg mh mi im bi translated">通过探索策略，代理采取随机行动来尝试未探索的状态，这可能会找到其他方法来赢得游戏。通过利用策略，代理能够增加那些在过去有效的行动的信心，以获得<em class="mo">奖励</em>。在探索和利用之间取得良好的平衡，并通过玩无限多的游戏，每个状态的<em class="mo">值</em>将接近其真实概率。探索和利用之间的良好平衡由<a class="ae mw" rel="noopener" target="_blank" href="/exploration-exploitation-dilemma-c9eee9a460ac">ε贪婪参数</a>决定。</p><p id="0e7d" class="pw-post-body-paragraph lq lr it ls b lt mj ju lv lw mk jx ly ld ml ma mb lh mm md me ll mn mg mh mi im bi translated">当游戏结束时，在知道代理人是赢了(奖励= 1)还是输了/平了(奖励= 0)之后，我们只能更新代理人在该特定游戏中已经玩过的每个状态的<em class="mo">值</em>。终端状态只能是 0 或 1，我们确切地知道哪些是在初始化期间定义的终端状态。</p><p id="b97f" class="pw-post-body-paragraph lq lr it ls b lt mj ju lv lw mk jx ly ld ml ma mb lh mm md me ll mn mg mh mi im bi translated">代理的目标是在游戏结束后更新价值函数，以了解已执行的动作列表。当每个状态的<em class="mo">值</em>使用下一个状态的<em class="mo">值</em>更新时，在每个游戏结束时，更新过程向后读取该特定游戏的状态历史，并微调每个状态的<em class="mo">值</em>。</p><h2 id="8f0e" class="ku kv it bd kw kx ky dn kz la lb dp lc ld le lf lg lh li lj lk ll lm ln lo lp bi translated">井字游戏—利用价值函数</h2><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nn"><img src="../Images/de0b31d442dde444446fcdc7294faa1b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EU_MBwxPOarOYzmNE9EQgA.png"/></div></div><figcaption class="mq mr gj gh gi ms mt bd b be z dk">Fig 6: Values of various next states</figcaption></figure><p id="6558" class="pw-post-body-paragraph lq lr it ls b lt mj ju lv lw mk jx ly ld ml ma mb lh mm md me ll mn mg mh mi im bi translated">给定足够的训练，代理将会学习任何给定状态的<em class="mo">值</em>(或获胜概率)。因此，当我们与我们训练有素的代理人进行游戏时，代理人会使用利用策略来最大化胜率。<a class="ae mw" href="https://jinglescode.github.io/reinforcement-learning-tic-tac-toe/" rel="noopener ugc nofollow" target="_blank">看能不能打赢代理</a>。</p><p id="2c5b" class="pw-post-body-paragraph lq lr it ls b lt mj ju lv lw mk jx ly ld ml ma mb lh mm md me ll mn mg mh mi im bi translated">在游戏的每一个状态，代理循环通过每一种可能性，挑选具有最高<em class="mo">值</em>的下一个状态，从而选择最佳的行动过程。在图 6 中，代理将选择右下角来赢得游戏。</p><h2 id="fb9b" class="ku kv it bd kw kx ky dn kz la lb dp lc ld le lf lg lh li lj lk ll lm ln lo lp bi translated">结论</h2><p id="5074" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly ld lz ma mb lh mc md me ll mf mg mh mi im bi translated">在除了结束阶段(记录了赢、输或平)之外的任何进展状态，代理采取了导致下一个状态的行动，这可能不会产生任何<em class="mo">奖励</em>，但会导致代理向接收<em class="mo">奖励</em>靠近一步。</p><p id="18c6" class="pw-post-body-paragraph lq lr it ls b lt mj ju lv lw mk jx ly ld ml ma mb lh mm md me ll mn mg mh mi im bi translated">价值函数是确定处于一种状态的<em class="mo">值</em>的算法，即获得未来奖励的概率。</p><p id="b448" class="pw-post-body-paragraph lq lr it ls b lt mj ju lv lw mk jx ly ld ml ma mb lh mm md me ll mn mg mh mi im bi translated">每个状态的<em class="mo">值</em>通过游戏的状态历史按时间顺序反向更新，通过使用<a class="ae mw" rel="noopener" target="_blank" href="/exploration-exploitation-dilemma-c9eee9a460ac">探索和利用策略</a>进行足够的训练，代理将能够确定游戏中每个状态的真实<em class="mo">值</em>。</p><p id="ddd6" class="pw-post-body-paragraph lq lr it ls b lt mj ju lv lw mk jx ly ld ml ma mb lh mm md me ll mn mg mh mi im bi translated">有许多方法可以定义一个值函数，这只是一个适合井字游戏的方法。</p><p id="77e5" class="pw-post-body-paragraph lq lr it ls b lt mj ju lv lw mk jx ly ld ml ma mb lh mm md me ll mn mg mh mi im bi translated"><a class="ae mw" href="https://jinglescode.github.io/reinforcement-learning-tic-tac-toe/" rel="noopener ugc nofollow" target="_blank">探索 Github 上的演示</a></p><p id="8faf" class="pw-post-body-paragraph lq lr it ls b lt mj ju lv lw mk jx ly ld ml ma mb lh mm md me ll mn mg mh mi im bi translated"><a class="ae mw" href="https://github.com/jinglescode/reinforcement-learning-tic-tac-toe" rel="noopener ugc nofollow" target="_blank">在 Github 上查看源代码</a></p></div><div class="ab cl no np hx nq" role="separator"><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt"/></div><div class="im in io ip iq"><div class="kj kk kl km gt nv"><a rel="noopener follow" target="_blank" href="/data-scientist-the-dirtiest-job-of-the-21st-century-7f0c8215e845"><div class="nw ab fo"><div class="nx ab ny cl cj nz"><h2 class="bd iu gy z fp oa fr fs ob fu fw is bi translated">数据科学家:21 世纪最肮脏的工作</h2><div class="oc l"><h3 class="bd b gy z fp oa fr fs ob fu fw dk translated">40%的吸尘器，40%的看门人，20%的算命师。</h3></div><div class="od l"><p class="bd b dl z fp oa fr fs ob fu fw dk translated">towardsdatascience.com</p></div></div><div class="oe l"><div class="of l og oh oi oe oj ks nv"/></div></div></a></div></div><div class="ab cl no np hx nq" role="separator"><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt"/></div><div class="im in io ip iq"><p id="d0bb" class="pw-post-body-paragraph lq lr it ls b lt mj ju lv lw mk jx ly ld ml ma mb lh mm md me ll mn mg mh mi im bi translated">嗨！，我是叮当。我喜欢构建机器学习项目/产品，我在<a class="ae mw" href="https://towardsdatascience.com/@jinglesnote" rel="noopener" target="_blank">迈向数据科学</a>上写了它们。在<a class="ae mw" href="https://medium.com/@jinglesnote" rel="noopener"> Medium </a>上关注我或者在<a class="ae mw" href="https://www.linkedin.com/in/jingles/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>上联系我。</p><div class="kj kk kl km gt ab cb"><figure class="ok kn ol om on oo op paragraph-image"><a href="https://towardsdatascience.com/@jinglesnote"><img src="../Images/37b3c6bbeb134b28c91c9382ab95f170.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*i2NzU4j49rZ36Mxz4gp4Sg.png"/></a></figure><figure class="ok kn ol om on oo op paragraph-image"><a href="https://jingles.substack.com/subscribe"><img src="../Images/2e369202b596d5b518dca78b96ab5f91.png" data-original-src="https://miro.medium.com/v2/resize:fit:1002/format:webp/1*oENDSDMTwXi2CJdO1gryug.png"/></a></figure></div></div></div>    
</body>
</html>