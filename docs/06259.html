<html>
<head>
<title>Create a simple image search engine in OpenCV and Flask</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在 OpenCV 和 Flask 中创建一个简单的图片搜索引擎</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/create-a-simple-image-search-engine-in-opencv-and-flask-79384b78ee25?source=collection_archive---------26-----------------------#2019-09-09">https://towardsdatascience.com/create-a-simple-image-search-engine-in-opencv-and-flask-79384b78ee25?source=collection_archive---------26-----------------------#2019-09-09</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="4419" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">了解如何使用 OpenCV 提取图像中像素的颜色，然后通过 CSS 十六进制颜色代码搜索图像</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/afe4d53d6cad35ecbdb2f0f4023f076f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*nwp6EXcw_TskcoeL.png"/></div></div></figure><p id="5f3d" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我最近开始玩<a class="ae ln" href="https://opencv.org/about/" rel="noopener ugc nofollow" target="_blank"> OpenCV </a>，一个用于图像处理的开源计算机视觉库。幸运的是有 Python 绑定可用。更幸运的是，像阿德里安这样的人已经做了一个伟大的服务，他们发布了关于类似主题的书和博客。</p><p id="e406" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">那么这到底是怎么回事呢？嗯，这很简单，或者我说，是最简单的使用 OpenCV 加载图像并找到与该图像相关的颜色，并在基于 Flask 的 web 应用程序中显示见解的演示。这不是一个国家的艺术应用程序，也不是目前我打算做的方式，但嘿，这只是一个开始，而不是结束。除了把我对像素的基础学习转化成一个<strong class="kt ir"> <em class="lo">产品</em> </strong> <em class="lo"> (Google！当心！！)</em></p><p id="b1d6" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我不会深入 OpenCV 和 Flask 的细节，我将介绍应用程序实际上在做什么。</p><p id="34ef" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">该应用程序由两部分组成:一个基于网络的应用程序，用于存储来自网络的图像并显示处理后的图像及其主色；一个命令行脚本，用于运行下载的图像并提取颜色代码。网页图像如下所示:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/79e3ca75769d32981abc22ce619c7595.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*aKoEFRZRMFMbNpsY.png"/></div></div></figure><p id="75ad" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">你通过颜色代码搜索图片，它会返回如下结果:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi lp"><img src="../Images/fe34bb4e1658b3c407576fc1b410de99.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*4OxcMVELctIW2Pq9.png"/></div></div></figure><p id="a339" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">单个图像的视图看起来像:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi lq"><img src="../Images/62c57fb29191c131b3a30b5738e75820.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*dTMdqr7i0RLBOgxC.png"/></div></div></figure><p id="2173" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">让我们讨论系统的核心部分，也就是执行主要工作的命令行脚本。</p><pre class="kg kh ki kj gt lr ls lt lu aw lv bi"><span id="006a" class="lw lx iq ls b gy ly lz l ma mb">def process_image(image_name):<br/>    color_count = {}<br/>    print('Processing the image {}'.format(image_name))<br/>    path = 'website/static/uploaded_images/' + image_name</span><span id="d934" class="lw lx iq ls b gy mc lz l ma mb">image = cv2.imread(path)</span><span id="0ff0" class="lw lx iq ls b gy mc lz l ma mb">for i in range(image.shape[0]):<br/>        for j in range(image.shape[1]):<br/>            (b, g, r) = image[i, j]<br/>            h_value = rgb2hex(r, g, b)</span><span id="07db" class="lw lx iq ls b gy mc lz l ma mb">if h_value in color_count:<br/>                color_count[h_value] += 1<br/>            else:<br/>                color_count[h_value] = 1<br/>    return color_count</span></pre><p id="1acd" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">导入计算机视觉后，我们通过调用<code class="fe md me mf ls b">cv2.imread()</code>从磁盘读取图像。数据以<code class="fe md me mf ls b">numpy</code>数组的形式提供，因此使用它的<code class="fe md me mf ls b">shape</code>方法来查找宽度、高度和通道等细节。顺便说一下，OpenCV 以 BGR 格式存储图像数据，而不是 RGB 颜色空间。一旦数据被检索为 BGR 格式，我们就使用一个定制的<code class="fe md me mf ls b">rgb2hex</code>方法将 RGB 转换为十六进制颜色。该函数然后返回一个字典列表，其中包含十六进制的颜色代码及其频率，我们将使用它来查找图像中颜色的百分比。我还做了一个演示，可以在 youtube 视频中看到<a class="ae ln" href="https://www.youtube.com/watch?v=gG0uVcYGpDc&amp;feature=youtu.be" rel="noopener ugc nofollow" target="_blank">。</a></p><h1 id="a655" class="mg lx iq bd mh mi mj mk ml mm mn mo mp jw mq jx mr jz ms ka mt kc mu kd mv mw bi translated">结论</h1><p id="33fc" class="pw-post-body-paragraph kr ks iq kt b ku mx jr kw kx my ju kz la mz lc ld le na lg lh li nb lk ll lm ij bi translated">这是 OpenCV 中的一个基本图像处理教程。它不是一个成熟的产品，因为它不能告诉你图片中独特的颜色。它只是告诉你基于像素颜色的信息，而不是基于 ML 算法执行颜色分割和聚类。</p><p id="3267" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">希望在接下来的几周内，我会就更高级的话题进一步讨论 OpenCV。</p><p id="c432" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">像往常一样，这些代码可以在 Github 上找到。</p><p id="ec94" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir"> <em class="lo">本帖原载</em> </strong> <a class="ae ln" href="http://blog.adnansiddiqi.me/create-a-simplest-image-search-engine-in-opencv-and-flask/" rel="noopener ugc nofollow" target="_blank"> <strong class="kt ir"> <em class="lo">此处</em> </strong> </a> <strong class="kt ir"> <em class="lo">。</em>T15】</strong></p></div></div>    
</body>
</html>