<html>
<head>
<title>Gale–Shapley algorithm simply explained</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">gale-Shapley 算法简单解释</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/gale-shapley-algorithm-simply-explained-caa344e643c2?source=collection_archive---------4-----------------------#2019-05-26">https://towardsdatascience.com/gale-shapley-algorithm-simply-explained-caa344e643c2?source=collection_archive---------4-----------------------#2019-05-26</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div class="gh gi jn"><img src="../Images/81dd679c903777182e2def59e42f4cfd.png" data-original-src="https://miro.medium.com/v2/resize:fit:962/format:webp/1*Q9fuszSJYriEzJ_L46-JWA.png"/></div></figure><p id="2f34" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">从这篇文章中，你将了解稳定的配对或稳定的婚姻问题。你将学习如何使用<a class="ae ks" href="https://en.wikipedia.org/wiki/Game_theory" rel="noopener ugc nofollow" target="_blank">博弈论</a>和<a class="ae ks" href="https://en.wikipedia.org/wiki/Stable_marriage_problem" rel="noopener ugc nofollow" target="_blank">盖尔-沙普利算法</a>来解决这个问题。我们将使用 Python 来创建我们自己的解决方案，使用 1962 年原始论文中的定理。</p><h1 id="30cc" class="kt ku iq bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">什么是稳定的婚姻或配对问题？</h1><p id="cbfc" class="pw-post-body-paragraph ju jv iq jw b jx lr jz ka kb ls kd ke kf lt kh ki kj lu kl km kn lv kp kq kr ij bi translated">在现实世界中，有些情况下我们会面临配对问题:学生选择他们未来的大学，男人和女人互相寻求建立家庭，互联网服务需要在最短的时间内与用户连接。在所有这些情况下，我们都需要创建满足特定标准的稳定对。我们可以把(A，A)的<em class="lw">稳定对</em>想象成一对，其中没有<strong class="jw ir"> A </strong>或<strong class="jw ir"> a </strong>有任何更好的选择。</p><p id="0fd2" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">理解它的最好方法是解决实际的例子，我可以推荐《博弈论的洞察》这本书，它包含了大量你可以在纸上解决的练习。但是这里我想用 Python 来解决这个问题:)</p><h1 id="d01f" class="kt ku iq bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">问题定义:</h1><p id="db74" class="pw-post-body-paragraph ju jv iq jw b jx lr jz ka kb ls kd ke kf lt kh ki kj lu kl km kn lv kp kq kr ij bi translated">在我们的例子中，我们将有两个组，女性和男性。女性名字会以大写字母开头:<strong class="jw ir"> A、B、C、D </strong>而男性以小写后者:<strong class="jw ir"> a、B、C、d </strong>。我们需要创造稳定的组合。在此之前，我们做了一个调查，收集一些信息作为我们的出发点。他们每个人都被要求根据个人的同情心给异性排序。其中 1 个是他们最喜欢的人，4 个是他们最不喜欢的人。</p><p id="ec3f" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">比如女人 A 这样回答:<strong class="jw ir"> d，c，A，b </strong></p><p id="2812" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">在 python 中，我们可以创建两个数据框男性和女性:</p><figure class="lx ly lz ma gt jr"><div class="bz fp l di"><div class="mb mc l"/></div></figure><p id="5d7f" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">在数据框中，为了方便起见，用数字代替了等级。例如，如果我们想知道女性<strong class="jw ir"> A </strong>的偏好，我们可以读取女性数据框中的列<strong class="jw ir"> A </strong>:分别为男性<strong class="jw ir"> a、b、c、d </strong>的<strong class="jw ir"> 3、4、2、1 </strong>。如果我们想知道男性<strong class="jw ir"> a </strong>的偏好，我们可以读取男性数据框中的<strong class="jw ir"> a </strong>行:<strong class="jw ir"> 1、2、3、4 </strong>分别对应女性<strong class="jw ir"> A、B、C、D </strong>。</p><p id="671c" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">因此，一对男女可以表示为一对数字，例如，对<strong class="jw ir"> A </strong>和<strong class="jw ir"> a </strong>将创建一对数字(3，1)。对女人来说，T4 是第三位，但对男人来说，女人是第一位。</p><p id="9a44" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">因此，在这种情况下，男人<strong class="jw ir"> a </strong>完全快乐，但是女人<strong class="jw ir"> A </strong>可以尝试与她名单中更高的人创造一对，例如，男人<strong class="jw ir"> c，</strong>如果对于<strong class="jw ir"> c 而言</strong><strong class="jw ir"/>与<strong class="jw ir"> A </strong>创造一对比与他当前的伴侣创造一对更好，那么这两对都会崩溃并创造新的一对。</p><p id="9f9f" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">这就是不稳定配对的一个例子，在这种配对中，一个或两个参与者可以改善情况，但会为他们创造更好的配对。</p><p id="61ab" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">所以任务是为所有参与者找到稳定的配对。事实证明有一种方法可以达到平衡！</p><h1 id="861f" class="kt ku iq bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">Python 中的 Gale-Shapley 算法</h1><p id="8f42" class="pw-post-body-paragraph ju jv iq jw b jx lr jz ka kb ls kd ke kf lt kh ki kj lu kl km kn lv kp kq kr ij bi translated">大卫·盖尔和劳埃德·沙普利证明了当两个集合相等时，总有办法产生稳定的配对。我推荐阅读原文[2]来熟悉他们提供的优雅证明。</p><p id="f3ee" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">Python 中有不同的 Gale-Shapley 算法实现[3，4，5]，让我们创建一个更接近伪代码解决方案的算法，而不是进入复杂的 OOP。</p><p id="88dc" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">伪代码解决方案看起来是这样的[6]:</p><pre class="lx ly lz ma gt md me mf mg aw mh bi"><span id="5aa9" class="mi ku iq me b gy mj mk l ml mm"><strong class="me ir">function</strong> stableMatching {<br/>    Initialize all <em class="lw">m</em> ∈ M and <em class="lw">w</em> ∈ W to <em class="lw">free</em><br/>    <strong class="me ir">while</strong> ∃ <em class="lw">free</em> man <em class="lw">m</em> who still has a woman w to propose to {<br/>       w = first woman on m’s list to whom m has not yet proposed<br/>       <strong class="me ir">if</strong> w is <em class="lw">free</em><br/>         (m, w) become <em class="lw">engaged</em><br/>       <strong class="me ir">else</strong> some pair (m', w) already exists<br/>         <strong class="me ir">if</strong> w prefers m to m'<br/>            m' becomes <em class="lw">free</em><br/>           (m, w) become <em class="lw">engaged</em> <br/>         <strong class="me ir">else</strong><br/>           (m', w) remain <em class="lw">engaged</em><br/>    }<br/>}</span></pre><p id="49ea" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">在 Python 中，我能够创建这个解决方案:</p><figure class="lx ly lz ma gt jr"><div class="bz fp l di"><div class="mb mc l"/></div></figure><h1 id="3db3" class="kt ku iq bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">总结:</h1><p id="1333" class="pw-post-body-paragraph ju jv iq jw b jx lr jz ka kb ls kd ke kf lt kh ki kj lu kl km kn lv kp kq kr ij bi translated">博弈论非常有趣，因为它是根据现实世界的情况来操作的。而且它在大多数时候也不需要复杂的数学仪器，尤其是在合作游戏中。</p><p id="4701" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">关于 Gale-Shapley 算法有很多东西我们没有触及:男性人数不等于女性人数时的一般情况以及这个算法可能需要多少次最大迭代。</p><p id="1875" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">在看了开源解决方案后，我确信我将能够创建更简约甚至更 Pythonic 化的解决方案。但是我结束了一个相当混乱的<em class="lw">而</em>周期...🤷‍♂️</p><h2 id="17f0" class="mi ku iq bd kv mn mo dn kz mp mq dp ld kf mr ms lh kj mt mu ll kn mv mw lp mx bi translated">你认为盖尔-沙普利算法最 Pythonic 化的写法是什么？</h2></div><div class="ab cl my mz hu na" role="separator"><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd"/></div><div class="ij ik il im in"><h1 id="23a1" class="kt ku iq bd kv kw nf ky kz la ng lc ld le nh lg lh li ni lk ll lm nj lo lp lq bi translated">参考资料:</h1><ol class=""><li id="e981" class="nk nl iq jw b jx lr kb ls kf nm kj nn kn no kr np nq nr ns bi translated">《对策论的洞见:另一种数学体验》，剑桥大学出版社，即将出版，与 Ein-Ya Gura 合著</li><li id="386b" class="nk nl iq jw b jx nt kb nu kf nv kj nw kn nx kr np nq nr ns bi translated">Gale D .、Shapley L.S. <a class="ae ks" href="http://www.eecs.harvard.edu/cs286r/courses/fall09/papers/galeshapley.pdf" rel="noopener ugc nofollow" target="_blank">大学录取与婚姻的稳定性</a> //美国数学月刊。1962.第 69 卷。第 9-15 页。</li><li id="1f47" class="nk nl iq jw b jx nt kb nu kf nv kj nw kn nx kr np nq nr ns bi translated"><a class="ae ks" href="https://rosettacode.org/wiki/Stable_marriage_problem#Python" rel="noopener ugc nofollow" target="_blank">https://rosettacode.org/wiki/Stable_marriage_problem#Python</a></li><li id="ea0c" class="nk nl iq jw b jx nt kb nu kf nv kj nw kn nx kr np nq nr ns bi translated"><a class="ae ks" href="https://pypi.org/project/matching/" rel="noopener ugc nofollow" target="_blank">https://pypi.org/project/matching/</a></li><li id="c02b" class="nk nl iq jw b jx nt kb nu kf nv kj nw kn nx kr np nq nr ns bi translated">【https://github.com/QuantEcon/MatchingMarkets.py T2】号</li><li id="5c35" class="nk nl iq jw b jx nt kb nu kf nv kj nw kn nx kr np nq nr ns bi translated">【https://en.wikipedia.org/wiki/Stable_marriage_problem T4】</li></ol></div></div>    
</body>
</html>