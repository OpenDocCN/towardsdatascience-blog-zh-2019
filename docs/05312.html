<html>
<head>
<title>Logistic Regression in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python 中的逻辑回归</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/logistic-regression-in-python-f66aeb15e83e?source=collection_archive---------15-----------------------#2019-08-07">https://towardsdatascience.com/logistic-regression-in-python-f66aeb15e83e?source=collection_archive---------15-----------------------#2019-08-07</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="efc4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">逻辑回归是一种相当常见的机器学习算法，用于预测分类结果。在这篇博文中，我将带您浏览使用 Jupyter 笔记本在 python 中创建逻辑回归模型的过程。</p><p id="9cd2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们将使用来自 kaggle 的泰坦尼克号数据集，它是数据点的集合，包括年龄、性别、票价等..泰坦尼克号上所有乘客中。数据集有 891 行和 12 列。目标是看看我们是否能预测任何给定的乘客是死是活。希望你能明白为什么逻辑回归是这个问题的合适模型。</p><h1 id="f223" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">让我们开始吧…</h1><p id="36f2" class="pw-post-body-paragraph jn jo iq jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ij bi translated">无论您正在构建什么模型，第一步都是导入所有的库并探索数据集。</p><figure class="lo lp lq lr gt ls"><div class="bz fp l di"><div class="lt lu l"/></div></figure><p id="eb5f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，让我们加载数据集并查看数据框。</p><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="gh gi lv"><img src="../Images/3ea25813639334153845267339f5bfd9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*o3ilR_q_odCFdSZpUunrHg.png"/></div></div></figure><p id="f4a3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">简短的预览让我们了解我们正在处理的数据类型和空值的种类。它有助于了解如何处理、清理和编码数据。</p><h2 id="8a22" class="mc km iq bd kn md me dn kr mf mg dp kv jy mh mi kz kc mj mk ld kg ml mm lh mn bi translated">汇总数据</h2><p id="fdc5" class="pw-post-body-paragraph jn jo iq jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ij bi translated">这对于一个成功的模型来说并不是必须的，但是我总是这样做，我认为这样可以让代码更干净，更易读。我喜欢在数据集上调用 describe()函数，它产生一个简洁的数据框架，其中包含每一列的标准统计数据。然后，我将每一行存储为一个单独的序列。这将有助于查找异常值或替换空值。</p><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div class="gh gi mo"><img src="../Images/8aec747e1c4d3bbe56a9c9ee08c47c4a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1092/format:webp/1*b45bsguxD5Zak0SvlO-mzA.png"/></div></figure><figure class="lo lp lq lr gt ls"><div class="bz fp l di"><div class="lt lu l"/></div></figure><h1 id="ff68" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">计算异常值</h1><p id="d1b7" class="pw-post-body-paragraph jn jo iq jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ij bi translated">有几种方法可以计算异常值。我选择使用四分位数范围(IQR)。为了简明扼要，我假设您熟悉 IQR 的概念，所以我将只介绍如何用 Python 来编写它。如果你认为你需要刷新你的记忆，我会推荐你看看这篇<a class="ae mp" href="https://medium.com/datadriveninvestor/finding-outliers-in-dataset-using-python-efc3fce6ce32" rel="noopener">博文</a>。</p><p id="8ff1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我从描述计算异常值的步骤开始。</p><ol class=""><li id="e39c" class="mq mr iq jp b jq jr ju jv jy ms kc mt kg mu kk mv mw mx my bi translated">我访问了“年龄”和“费用”列中的第 25 和第 75 百分位值。</li><li id="e148" class="mq mr iq jp b jq mz ju na jy nb kc nc kg nd kk mv mw mx my bi translated">然后，我用这些百分位值计算了四分位间距、下限和上限。</li><li id="09ee" class="mq mr iq jp b jq mz ju na jy nb kc nc kg nd kk mv mw mx my bi translated">我还计算了第 98 和第 2 百分位值。</li><li id="886b" class="mq mr iq jp b jq mz ju na jy nb kc nc kg nd kk mv mw mx my bi translated">我将每一列中的值与上限和下限进行了比较。如果它们超出了界限，我就用第 98 或第 2 百分位值来替换它们。</li></ol><figure class="lo lp lq lr gt ls"><div class="bz fp l di"><div class="lt lu l"/></div></figure><h1 id="6c4c" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">数据可视化</h1><p id="5fc1" class="pw-post-body-paragraph jn jo iq jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ij bi translated">在处理大型数据集时，有时很难掌握变量对结果的影响程度。可视化数据集有助于从不同的角度看待事物。</p><p id="8e0c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">以下是“年龄”和“费用”的分布情况:</p><div class="lo lp lq lr gt ab cb"><figure class="ne ls nf ng nh ni nj paragraph-image"><img src="../Images/4412d0c55a217ef19a6cf955d24b0381.png" data-original-src="https://miro.medium.com/v2/resize:fit:750/format:webp/1*h-wrxlAXvtwTps88C0uHhQ.png"/></figure><figure class="ne ls nk ng nh ni nj paragraph-image"><img src="../Images/6e2fe8d53709490608114aec0b2528bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:732/format:webp/1*pXCFAlna5TO-pFoGtpSk5A.png"/></figure></div><h1 id="6e26" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">创建模型</h1><h2 id="d617" class="mc km iq bd kn md me dn kr mf mg dp kv jy mh mi kz kc mj mk ld kg ml mm lh mn bi translated">识别特征</h2><p id="af7a" class="pw-post-body-paragraph jn jo iq jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ij bi translated">创建模型时，确定所有特征值非常重要。在这种情况下，我去掉了一些类似“passengerid”、“Name”和“Ticket”的列，因为我不认为个人的姓名或 ID 会影响他们的生存机会。</p><p id="3209" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我删除了像“Cabin”这样的其他列，只是因为它们有太多的空值。</p><h2 id="1d02" class="mc km iq bd kn md me dn kr mf mg dp kv jy mh mi kz kc mj mk ld kg ml mm lh mn bi translated">编码值</h2><p id="664d" class="pw-post-body-paragraph jn jo iq jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ij bi translated">在我们确定了要丢弃的特征之后，我们仍然需要对分类值或字符串值进行编码。模型没有性别和机舱位置的概念；这就是为什么我们必须将字符串编码成整数，以模型可以理解的方式来表示这些数据类型。</p><figure class="lo lp lq lr gt ls"><div class="bz fp l di"><div class="lt lu l"/></div></figure><h2 id="8322" class="mc km iq bd kn md me dn kr mf mg dp kv jy mh mi kz kc mj mk ld kg ml mm lh mn bi translated">列车测试分离</h2><p id="62e4" class="pw-post-body-paragraph jn jo iq jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ij bi translated">现在我们已经选择了所有的特性，让我们将数据集分成一个训练集和一个测试集，并创建模型。</p><figure class="lo lp lq lr gt ls"><div class="bz fp l di"><div class="lt lu l"/></div></figure><h1 id="daad" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">分析模型</h1><p id="3d1f" class="pw-post-body-paragraph jn jo iq jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ij bi translated">有几个指标来分析模型的准确性。从 sklearn.metrics 库中，我导入了混淆矩阵、分类报告和 auc/roc 分数。</p><p id="3313" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这些工具在评估模型的有效性时非常方便。</p><figure class="lo lp lq lr gt ls"><div class="bz fp l di"><div class="lt lu l"/></div></figure><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/9e5a93af89e142b6eec4f41a95041e86.png" data-original-src="https://miro.medium.com/v2/resize:fit:824/format:webp/1*TtJGAeTQknAEmabnq6hJOg.png"/></div></figure><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/f21248f81b714293eb33b5f63478a388.png" data-original-src="https://miro.medium.com/v2/resize:fit:730/format:webp/1*g2oe9XG2NEebW_cZL4gKbQ.png"/></div></figure></div></div>    
</body>
</html>