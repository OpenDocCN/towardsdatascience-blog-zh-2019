<html>
<head>
<title>Reconstruct Google Trends Daily Data for Extended Period</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">重建谷歌趋势长期每日数据</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/reconstruct-google-trends-daily-data-for-extended-period-75b6ca1d3420?source=collection_archive---------6-----------------------#2019-11-27">https://towardsdatascience.com/reconstruct-google-trends-daily-data-for-extended-period-75b6ca1d3420?source=collection_archive---------6-----------------------#2019-11-27</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="49d9" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">比较方法以超越每日趋势数据的 9 个月查询限制。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/11f8573ea76760e832721b20b17ae5bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*H8hux4hcBl84VXvbpFpaiQ.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">iPhone search trends, AAPL stock price and Apple key events</figcaption></figure><ul class=""><li id="3572" class="kv kw iq kx b ky kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">我们可以在任何持续时间内以每日分辨率获取搜索趋势数据。</li><li id="821a" class="kv kw iq kx b ky ln la lo lc lp le lq lg lr li lj lk ll lm bi translated">用每周趋势来衡量每日数据可能会产生一些假象。</li><li id="743f" class="kv kw iq kx b ky ln la lo lc lp le lq lg lr li lj lk ll lm bi translated">只要在重叠期间有足够的搜索活动，使用重叠期间进行缩放会更好。</li><li id="e612" class="kv kw iq kx b ky ln la lo lc lp le lq lg lr li lj lk ll lm bi translated">代码可以在这里找到<a class="ae ls" href="https://github.com/qztseng/google-trends-daily/blob/master/gtrend.py" rel="noopener ugc nofollow" target="_blank">。</a></li></ul><p id="81de" class="pw-post-body-paragraph lt lu iq kx b ky kz jr lv la lb ju lw lc lx ly lz le ma mb mc lg md me mf li ij bi translated">随着谷歌获得了互联网搜索的垄断地位，随着时间的推移，我们搜索的任何内容都成为了另一种公众兴趣的衡量标准。<a class="ae ls" href="https://medium.com/google-news-lab/what-is-google-trends-data-and-what-does-it-mean-b48f07342ee8" rel="noopener">谷歌新闻实验室</a>已经很好地解释了这一点，一些文章展示了基于谷歌趋势的数据分析，如<a class="ae ls" rel="noopener" target="_blank" href="/heartbreak-monday-blues-and-pytrends-f1a398591a79">结束与某人关系的循环模式</a>、<a class="ae ls" rel="noopener" target="_blank" href="/elizabeth-warren-is-leading-the-2020-presidential-race-an-analysis-in-python-967e272d15da">预测美国总统竞选</a>等。</p><h2 id="dc97" class="mg mh iq bd mi mj mk dn ml mm mn dp mo lc mp mq mr le ms mt mu lg mv mw mx my bi translated">局限性</h2><p id="8568" class="pw-post-body-paragraph lt lu iq kx b ky mz jr lv la na ju lw lc nb ly lz le nc mb mc lg nd me mf li ij bi translated">为了充分利用搜索趋势数据库，可以使用 python 模块<a class="ae ls" href="https://github.com/GeneralMills/pytrends/blob/master/pytrends/dailydata.py" rel="noopener ugc nofollow" target="_blank"> pytrends </a>或 R 包<a class="ae ls" href="https://cran.r-project.org/web/packages/gtrendsR/index.html" rel="noopener ugc nofollow" target="_blank"> gtrendsR </a>。然而，google 目前基于查询的时间框架限制了时间分辨率。例如，过去 7 天的查询将具有每小时的搜索趋势(所谓的实时数据)，每天的数据仅提供给短于 9 个月且在您搜索之前最多 36 个小时的查询期(如<a class="ae ls" href="https://support.google.com/trends/answer/4365533?hl=en&amp;ref_topic=6248052" rel="noopener ugc nofollow" target="_blank"> Google Trends FAQ </a>所述)，每周的数据提供给 9 个月到 5 年之间的查询，任何长于 5 年的查询将仅返回每月的数据。</p><p id="5533" class="pw-post-body-paragraph lt lu iq kx b ky kz jr lv la lb ju lw lc lx ly lz le ma mb mc lg md me mf li ij bi translated">我研究这个课题的动机最初是受到 Kaggle 的<a class="ae ls" href="https://www.kaggle.com/c/rossmann-store-sales" rel="noopener ugc nofollow" target="_blank"> Rossmann 竞赛</a>的启发，在该竞赛中，谷歌搜索趋势被用来预测销售数字。我发现获取每日搜索趋势并不那么明显，人们使用每周趋势作为替代。但是，对于任何需要每日精度和实时应用的预测模型来说，它并不理想(因为每周数据只在本周结束时可用)。</p><h2 id="a974" class="mg mh iq bd mi mj mk dn ml mm mn dp mo lc mp mq mr le ms mt mu lg mv mw mx my bi translated">比较重建每日趋势的方法</h2><p id="a12e" class="pw-post-body-paragraph lt lu iq kx b ky mz jr lv la na ju lw lc nb ly lz le nc mb mc lg nd me mf li ij bi translated">虽然人们已经想出了规避的方法(比如:这里的<a class="ae ls" href="https://medium.com/@bewerunge.franz/google-trends-how-to-acquire-daily-data-for-broad-time-frames-b6c6dfe200e6" rel="noopener"/>，这里的<a class="ae ls" href="http://erikjohansson.blogspot.com/2013/04/how-to-get-daily-google-trends-data-for.html" rel="noopener ugc nofollow" target="_blank"/>)。我很好奇这些方法是如何相互比较的，如何与原始的每日趋势数据最匹配。因此，我使用“iPhone”作为关键词，通过以下三种方法重建 35 个月的每日趋势数据:</p><ol class=""><li id="197d" class="kv kw iq kx b ky kz la lb lc ld le lf lg lh li ne lk ll lm bi translated">从多个 1 个月的查询中串联的每日数据，并通过相应的每周趋势数据进行标准化。(pytrends 中实现的<a class="ae ls" href="https://github.com/GeneralMills/pytrends/blob/master/pytrends/dailydata.py" rel="noopener ugc nofollow" target="_blank"> dailydata </a>函数)。</li><li id="532a" class="kv kw iq kx b ky ln la lo lc lp le lq lg lr li ne lk ll lm bi translated">查询具有大量重叠时段的多个 9 个月时段，并使用重叠时段来获得一致的缩放比例(类似于此处的目的<a class="ae ls" href="https://github.com/e-271/pytrends/blob/master/pytrends/renormalize.py" rel="noopener ugc nofollow" target="_blank"/>)。</li><li id="b018" class="kv kw iq kx b ky ln la lo lc lp le lq lg lr li ne lk ll lm bi translated">每日数据只是从每周数据中插入的。(供参考)</li></ol><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nf"><img src="../Images/56aee5206903cadfbf4c02ce57832c33.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*50pzporT9p8iu3R8vFBouA.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Comparing daily trend data obtained using the overlapping method(blue), dailydata method from pytrends(orange), interpolation from weekly data(green), and the overlapped period used for scaling (red)</figcaption></figure><p id="2ead" class="pw-post-body-paragraph lt lu iq kx b ky kz jr lv la lb ju lw lc lx ly lz le ma mb mc lg md me mf li ij bi translated">乍一看，我们可以注意到他们给出了完全不同的结果。pytrends 的 dailydata 函数与周数据匹配得相当好，其基线值(重要峰值之间的周期)高于通过重叠方法获得的值。目前，很难说哪个更好，尽管如此，每日数据(绿线)在主要峰值附近有一些明显的下降，例如 2017 年 9 月左右的最低值。</p><p id="a312" class="pw-post-body-paragraph lt lu iq kx b ky kz jr lv la lb ju lw lc lx ly lz le ma mb mc lg md me mf li ij bi translated">为了验证哪些重建的每日趋势与原始数据匹配得更好，直接提取较短时期(&lt; 9 个月)的每日数据进行比较。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ng"><img src="../Images/66c6be61fd278e5993896d4b2f290ac6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QMA566r9eGHlyn23_HQbrQ.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Comparing daily trends data normalized differently with the original daily trends (pink)</figcaption></figure><p id="c09f" class="pw-post-body-paragraph lt lu iq kx b ky kz jr lv la lb ju lw lc lx ly lz le ma mb mc lg md me mf li ij bi translated">现在很清楚，重叠方法(蓝线)与原始日数据(粉线)最匹配，橙色线的下降是由周数据缩放产生的伪影。</p><h2 id="7bba" class="mg mh iq bd mi mj mk dn ml mm mn dp mo lc mp mq mr le ms mt mu lg mv mw mx my bi translated">英国退出欧盟、谷歌趋势和英镑</h2><p id="356b" class="pw-post-body-paragraph lt lu iq kx b ky mz jr lv la na ju lw lc nb ly lz le nc mb mc lg nd me mf li ij bi translated">为了进一步展示长期每日搜索数据的潜在优势和应用，我们使用“英国退出欧盟”作为 2018 年 10 月至 2019 年 11 月期间的搜索词。重建的每日数据与默认的每周数据(因为查询期长于 9 个月)一起绘制，以便进行比较。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/da5ccf5a0be2eb7f974c0c6e51715e04.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kZneRrlfRDmd7sKaavP8IQ.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Compare the daily trend reconstructed by the overlapping method (blue) with the original weekly trend (red).</figcaption></figure><p id="582a" class="pw-post-body-paragraph lt lu iq kx b ky kz jr lv la lb ju lw lc lx ly lz le ma mb mc lg md me mf li ij bi translated">有了重建的每日趋势，我们可以精确地将搜索趋势的激增与这 14 个月期间的每个重大事件相匹配。它还使我们能够比较每个不同事件日期的相对搜索量，而每周趋势失去了分辨率，相邻事件的相对搜索量被平均(或汇集在一起)。</p><p id="7bcf" class="pw-post-body-paragraph lt lu iq kx b ky kz jr lv la lb ju lw lc lx ly lz le ma mb mc lg md me mf li ij bi translated">出于好奇，我试图将英镑汇率叠加在每日趋势图上。当“英国退出欧盟”搜索达到顶峰时，英镑经常在同一天暴跌，这并不奇怪。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/81a915b49fcfc213713138bb937e60d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ov74E3OETGtlOCNDhIJpTQ.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">GBP/USD exchange rate and ‘Brexit’ search trends</figcaption></figure><p id="91a1" class="pw-post-body-paragraph lt lu iq kx b ky kz jr lv la lb ju lw lc lx ly lz le ma mb mc lg md me mf li ij bi translated">也许谷歌会取消这样的限制，并在未来提供一个更方便的 API，但在此之前，缝合和缩放重叠查询可能是最好的方式，以获得长期的每日搜索趋势。</p><p id="f139" class="pw-post-body-paragraph lt lu iq kx b ky kz jr lv la lb ju lw lc lx ly lz le ma mb mc lg md me mf li ij bi translated"><em class="nh">*重构每日走势和生成本文剧情的代码可以在</em> <a class="ae ls" href="https://github.com/qztseng/google-trends-daily" rel="noopener ugc nofollow" target="_blank"> <em class="nh"> github </em> </a> <em class="nh">上找到。</em></p></div></div>    
</body>
</html>