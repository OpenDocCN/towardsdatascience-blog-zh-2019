<html>
<head>
<title>Why Using Mean Squared Error(MSE) Cost Function for Binary Classification is a Bad Idea?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">为什么使用均方误差(MSE)代价函数进行二分类不是一个好主意？</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/why-using-mean-squared-error-mse-cost-function-for-binary-classification-is-a-bad-idea-933089e90df7?source=collection_archive---------4-----------------------#2019-11-14">https://towardsdatascience.com/why-using-mean-squared-error-mse-cost-function-for-binary-classification-is-a-bad-idea-933089e90df7?source=collection_archive---------4-----------------------#2019-11-14</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="68be" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="kl">博文补充部分"</em> <a class="ae km" href="https://medium.com/@rafayak/nothing-but-numpy-understanding-creating-binary-classification-neural-networks-with-e746423c8d5c" rel="noopener"> <em class="kl">无非 NumPy:理解&amp;从零开始用计算图创建二分类神经网络</em></a><em class="kl"/></p></div><div class="ab cl kn ko hu kp" role="separator"><span class="kq bw bk kr ks kt"/><span class="kq bw bk kr ks kt"/><span class="kq bw bk kr ks"/></div><div class="ij ik il im in"><p id="48f6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">对于二元分类问题，均方误差(MSE)不是一个好的选择，原因有两个:</p><p id="14f3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> <em class="kl">首先</em> </strong> <em class="kl">，使用 MSE 意味着我们假设底层数据已经由一个正态分布(一个钟形曲线)</em>生成。在贝叶斯术语中这意味着我们假设一个<a class="ae km" href="https://en.wikipedia.org/wiki/Conjugate_prior" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir"> <em class="kl">高斯先验</em> </strong> </a>。而在现实中，可以分为两类(即二进制)的数据集并非来自正态分布，而是来自<a class="ae km" href="https://en.wikipedia.org/wiki/Bernoulli_distribution" rel="noopener ugc nofollow" target="_blank"> <em class="kl">伯努利分布</em> </a> <em class="kl"> </em>(查看<a class="ae km" href="https://medium.com/@rafayak/where-did-the-binary-cross-entropy-loss-function-come-from-ac3de349a715" rel="noopener"> <em class="kl">的答案二进制交叉熵损失函数从何而来？</em> </a>”了解更多详情以及最大似然估计的介绍)。</p><p id="e583" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果我们使用最大似然估计(MLE)，假设数据来自正态分布(顺便说一下，这是一个错误的假设)，我们将 MSE 作为优化我们模型的成本函数。</p><figure class="kv kw kx ky gt kz gh gi paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><div class="gh gi ku"><img src="../Images/b25a5dddac3646f20d1990ffc911db0e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*859aKqxO45xgOywdjiLxHQ.png"/></div></div><figcaption class="lg lh gj gh gi li lj bd b be z dk">Fig 1. The Normal Distribution of the observed target/label value</figcaption></figure><figure class="kv kw kx ky gt kz gh gi paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><div class="gh gi lk"><img src="../Images/b5893bdd82212c2f4e30f7313fe355cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IJq9aAbwNe3Eil0NYOlORA.png"/></div></div><figcaption class="lg lh gj gh gi li lj bd b be z dk">Fig 2. Deriving MSE through MLE</figcaption></figure><p id="9dd7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> <em class="kl">其次</em> </strong>，MSE 函数对于二分类是非凸的。简单来说，如果用 MSE 代价函数训练一个二元分类模型，<em class="kl">不保证</em>最小化代价函数。这是因为 MSE 函数期望范围<em class="kl"> (-∞，∞)，</em>内的实值输入，而二元分类模型通过 sigmoid/logistic 函数输出范围(0，1)内的概率。让我们想象一下:</p><figure class="kv kw kx ky gt kz gh gi paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><div class="gh gi ll"><img src="../Images/232b1207ba3a0f1481b47fac89d4c294.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_KCYWLVe7DqoDbDz8WpIZQ.png"/></div></div><figcaption class="lg lh gj gh gi li lj bd b be z dk">Fig 3. Non-convexity of MSE when output is from a Sigmoid/Logistic function</figcaption></figure><p id="2f6b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当 MSE 函数被传递一个无界值时，一个漂亮的 U 形(凸形)曲线就是在目标值处有一个清晰的最小点的结果(<strong class="jp ir"> <em class="kl"> y </em> </strong>)。另一方面，当来自 Sigmoid 函数的有界值被传递给 MSE 函数时，结果不是凸的；一方面，函数是凹的，而另一方面，函数是凸的，没有明确的最小点。因此，如果偶然地，二进制分类神经网络被初始化为具有大幅度的权重，使得其落在 MSE 成本函数的凹入部分，梯度下降将不起作用，因此，权重可能不会非常缓慢地更新或改善(在编码部分中尝试这一点)。这也是为什么神经网络在训练时要小心翼翼地用小值初始化的原因之一。</p><figure class="kv kw kx ky gt kz gh gi paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><div class="gh gi lm"><img src="../Images/c3e1fa99cffefb32743fb7fe8f409b19.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XAWsgjAkwH8FWOE9sjZ5QQ.png"/></div></div><figcaption class="lg lh gj gh gi li lj bd b be z dk">Fig 4. MSE convex on one side while concave on the other when using outputs from a Sigmoid/Logistic function</figcaption></figure><p id="3360" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="kl">最后一点，当我们进行线性回归(即通过数据拟合直线进行外推)时，MSE 是一个很好的成本函数选择。</em> <strong class="jp ir"> <em class="kl">在不知道数据如何分布的情况下，假设正态/高斯分布是完全合理的。</em>T11】</strong></p><figure class="kv kw kx ky gt kz gh gi paragraph-image"><div class="gh gi ln"><img src="../Images/5504c661f180136b971300ec6a793bea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1392/format:webp/1*S96RG90CYHgyglvzQg6-0g.jpeg"/></div><figcaption class="lg lh gj gh gi li lj bd b be z dk">Courtesy <a class="ae km" href="https://www.facebook.com/nas.mooty" rel="noopener ugc nofollow" target="_blank">Nas Mouti</a></figcaption></figure><p id="3e1c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如有任何问题，请随时在<a class="ae km" href="https://twitter.com/RafayAK" rel="noopener ugc nofollow" target="_blank">Twitter</a><a class="ae km" href="https://twitter.com/RafayAK" rel="noopener ugc nofollow" target="_blank"><strong class="jp ir">@</strong>RafayAK</a>上联系我，并查看“<a class="ae km" href="https://medium.com/@rafayak/nothing-but-numpy-understanding-creating-binary-classification-neural-networks-with-e746423c8d5c" rel="noopener">二元分类</a>上的其余帖子。</p><figure class="kv kw kx ky gt kz gh gi paragraph-image"><a href="https://www.buymeacoffee.com/rafaykhan"><div class="gh gi lo"><img src="../Images/bdb1aed53d63b0bff2c1599be3aa9dd0.png" data-original-src="https://miro.medium.com/v2/resize:fit:664/format:webp/1*q8O4kAyuVD-9slT_aAKc1Q.png"/></div></a><figcaption class="lg lh gj gh gi li lj bd b be z dk">If you enjoyed it!</figcaption></figure></div></div>    
</body>
</html>