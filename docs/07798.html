<html>
<head>
<title>5 lesser-known pandas tricks</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">5 个鲜为人知的熊猫把戏</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/5-lesser-known-pandas-tricks-e8ab1dd21431?source=collection_archive---------2-----------------------#2019-10-29">https://towardsdatascience.com/5-lesser-known-pandas-tricks-e8ab1dd21431?source=collection_archive---------2-----------------------#2019-10-29</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div class="gh gi jq"><img src="../Images/ff3cea15747789ace8e107057360ceb5.png" data-original-src="https://miro.medium.com/v2/resize:fit:780/format:webp/0*POJPMl2GZ03ROY2D.png"/></div><figcaption class="jx jy gj gh gi jz ka bd b be z dk">Pandas provides high-performance, easy-to-use data structures and data analysis tools for the Python</figcaption></figure><p id="6946" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">pandas 无需介绍，因为它已经成为 Python 中事实上的数据分析工具。作为一名数据科学家，我每天都使用熊猫，我总是对它的众多功能感到惊讶。在这篇文章中，我将向你展示我最近学到的 5 个熊猫技巧，用它们来帮助我更有效率。</p><p id="92b5" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">对于熊猫新手— <a class="ae kz" href="https://pandas.pydata.org/" rel="noopener ugc nofollow" target="_blank">熊猫</a>为 Python 编程语言提供了高性能、易于使用的数据结构和数据分析工具。这个名字来源于术语“面板数据”，这是一个计量经济学术语，指的是包含同一个人在多个时间段的观察结果的数据集。</p><p id="549f" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">要运行示例，请下载这个<a class="ae kz" href="https://romanorac.github.io/assets/notebooks/2019-10-29-5-lesser-known-pandas-tricks.ipynb" rel="noopener ugc nofollow" target="_blank"> Jupyter 笔记本</a>。</p><p id="3ee2" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><strong class="kd iu">这里有几个你可能感兴趣的链接:</strong></p><pre class="la lb lc ld gt le lf lg lh aw li bi"><span id="a134" class="lj lk it lf b gy ll lm l ln lo">- <a class="ae kz" href="https://trymito.io/" rel="noopener ugc nofollow" target="_blank">Complete your Python analyses 10x faster with Mito</a> [Product]</span><span id="cf78" class="lj lk it lf b gy lp lm l ln lo">- <a class="ae kz" href="https://aigents.co/skills" rel="noopener ugc nofollow" target="_blank">Free skill tests for Data Scientists &amp; ML Engineers</a> [Test]</span><span id="1e41" class="lj lk it lf b gy lp lm l ln lo">- <a class="ae kz" href="https://imp.i115008.net/c/2402645/1116216/11298" rel="noopener ugc nofollow" target="_blank">All New Self-Driving Car Engineer Nanodegree</a><strong class="lf iu"> </strong>[Course]</span></pre><p id="9b53" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><em class="lq">你愿意多看一些这样的文章吗？如果是这样，你可以点击上面的任何链接来支持我。其中一些是附属链接，但你不需要购买任何东西。</em></p><h1 id="8116" class="lr lk it bd ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn bi translated">1.日期范围</h1><p id="c46a" class="pw-post-body-paragraph kb kc it kd b ke mo kg kh ki mp kk kl km mq ko kp kq mr ks kt ku ms kw kx ky im bi translated">当从外部 API 或数据库获取数据时，我们经常需要指定一个日期范围。熊猫保护了我们。有一个<a class="ae kz" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.date_range.html" rel="noopener ugc nofollow" target="_blank"> data_range </a>函数，返回按天、月或年等递增的日期。</p><p id="f8da" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">假设我们需要一个按天递增的日期范围。</p><pre class="la lb lc ld gt le lf lg lh aw li bi"><span id="1324" class="lj lk it lf b gy ll lm l ln lo">date_from <strong class="lf iu">=</strong> "2019-01-01"<br/>date_to <strong class="lf iu">=</strong> "2019-01-12"<br/>date_range <strong class="lf iu">=</strong> pd<strong class="lf iu">.</strong>date_range(date_from, date_to, freq<strong class="lf iu">=</strong>"D")<br/>date_range</span></pre><figure class="la lb lc ld gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="mu mv di mw bf mx"><div class="gh gi mt"><img src="../Images/3e2a2e1e9ac5af7b8cfc2df60d68329b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vmsFfmBlZf8U9xxhLovLBg.png"/></div></div></figure><p id="1ca0" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">让我们将生成的 date_range 转换为开始和结束日期，并将其传递给后续函数。</p><pre class="la lb lc ld gt le lf lg lh aw li bi"><span id="2b82" class="lj lk it lf b gy ll lm l ln lo"><strong class="lf iu">for</strong> i, (date_from, date_to) <strong class="lf iu">in</strong> enumerate(zip(date_range[:<strong class="lf iu">-</strong>1], date_range[1:]), 1):<br/>    date_from <strong class="lf iu">=</strong> date_from<strong class="lf iu">.</strong>date()<strong class="lf iu">.</strong>isoformat()<br/>    date_to <strong class="lf iu">=</strong> date_to<strong class="lf iu">.</strong>date()<strong class="lf iu">.</strong>isoformat()<br/>    <strong class="lf iu">print</strong>("%d. date_from: %s, date_to: %s" <strong class="lf iu">%</strong> (i, date_from, date_to))</span><span id="a4f7" class="lj lk it lf b gy lp lm l ln lo">1. date_from: 2019-01-01, date_to: 2019-01-02<br/>2. date_from: 2019-01-02, date_to: 2019-01-03<br/>3. date_from: 2019-01-03, date_to: 2019-01-04<br/>4. date_from: 2019-01-04, date_to: 2019-01-05<br/>5. date_from: 2019-01-05, date_to: 2019-01-06<br/>6. date_from: 2019-01-06, date_to: 2019-01-07<br/>7. date_from: 2019-01-07, date_to: 2019-01-08<br/>8. date_from: 2019-01-08, date_to: 2019-01-09<br/>9. date_from: 2019-01-09, date_to: 2019-01-10<br/>10. date_from: 2019-01-10, date_to: 2019-01-11<br/>11. date_from: 2019-01-11, date_to: 2019-01-12</span></pre><h1 id="4dcb" class="lr lk it bd ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn bi translated">2.与指示器合并</h1><p id="7dfd" class="pw-post-body-paragraph kb kc it kd b ke mo kg kh ki mp kk kl km mq ko kp kq mr ks kt ku ms kw kx ky im bi translated">合并两个数据集是将两个数据集合并为一个数据集，并根据公共属性或列对齐每个数据集的行的过程。</p><p id="d67f" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我错过的合并函数的一个参数是<code class="fe my mz na lf b">indicator</code>参数。Indicator argument 向数据帧添加了一个<code class="fe my mz na lf b">_merge</code>列，它告诉您“该行来自何处”，左侧、右侧或两个数据帧。当处理更大的数据集来检查合并操作的正确性时，<code class="fe my mz na lf b">_merge</code>列非常有用。</p><pre class="la lb lc ld gt le lf lg lh aw li bi"><span id="ba6b" class="lj lk it lf b gy ll lm l ln lo">left <strong class="lf iu">=</strong> pd<strong class="lf iu">.</strong>DataFrame({"key": ["key1", "key2", "key3", "key4"], "value_l": [1, 2, 3, 4]})</span></pre><figure class="la lb lc ld gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="mu mv di mw bf mx"><div class="gh gi nb"><img src="../Images/a6dffd80acf7efaefba9421a59e641cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*P_c5lblDv9cRMbaChiP_IQ.png"/></div></div></figure><p id="149c" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><code class="fe my mz na lf b">right <strong class="kd iu">=</strong> pd<strong class="kd iu">.</strong>DataFrame({"key": ["key3", "key2", "key1", "key6"], "value_r": [3, 2, 1, 6]})</code></p><figure class="la lb lc ld gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="mu mv di mw bf mx"><div class="gh gi nc"><img src="../Images/69c9772b2e60907742642fd6509c213b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fiC6UGQnjUnEWAanmHnvzQ.png"/></div></div></figure><p id="3cc6" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><code class="fe my mz na lf b">df_merge <strong class="kd iu">=</strong> left<strong class="kd iu">.</strong>merge(right, on<strong class="kd iu">=</strong>'key', how<strong class="kd iu">=</strong>'left', indicator<strong class="kd iu">=</strong>True)</code></p><figure class="la lb lc ld gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="mu mv di mw bf mx"><div class="gh gi nd"><img src="../Images/a207ab8a80ec7df68887a6a24189408c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KybxBP5Jw5X59tZ_DcNXDw.png"/></div></div></figure><p id="973a" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><code class="fe my mz na lf b">_merge</code>列可用于检查是否有预期数量的行具有来自两个数据帧的值。</p><pre class="la lb lc ld gt le lf lg lh aw li bi"><span id="0517" class="lj lk it lf b gy ll lm l ln lo">df_merge<strong class="lf iu">.</strong>_merge<strong class="lf iu">.</strong>value_counts()</span><span id="3681" class="lj lk it lf b gy lp lm l ln lo">both          3<br/>left_only     1<br/>right_only    0<br/>Name: _merge, dtype: int64</span></pre><h1 id="f04f" class="lr lk it bd ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn bi translated">3.最近合并</h1><p id="041f" class="pw-post-body-paragraph kb kc it kd b ke mo kg kh ki mp kk kl km mq ko kp kq mr ks kt ku ms kw kx ky im bi translated">当处理股票或加密货币等金融数据时，我们可能需要将报价(价格变化)与实际交易结合起来。假设我们希望将每笔交易与之前几毫秒发生的报价合并。Pandas 有一个 merge_asof 函数，它能够通过最近的键(在我们的例子中是时间戳)合并数据帧。数据集报价和交易取自<a class="ae kz" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.merge.html" rel="noopener ugc nofollow" target="_blank">熊猫的例子</a></p><p id="b0f1" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">报价数据框包含不同股票的价格变化。通常，报价比交易多得多。</p><pre class="la lb lc ld gt le lf lg lh aw li bi"><span id="8fba" class="lj lk it lf b gy ll lm l ln lo">quotes <strong class="lf iu">=</strong> pd<strong class="lf iu">.</strong>DataFrame(<br/>    [<br/>        ["2016-05-25 13:30:00.023", "GOOG", 720.50, 720.93],<br/>        ["2016-05-25 13:30:00.023", "MSFT", 51.95, 51.96],<br/>        ["2016-05-25 13:30:00.030", "MSFT", 51.97, 51.98],<br/>        ["2016-05-25 13:30:00.041", "MSFT", 51.99, 52.00],<br/>        ["2016-05-25 13:30:00.048", "GOOG", 720.50, 720.93],<br/>        ["2016-05-25 13:30:00.049", "AAPL", 97.99, 98.01],<br/>        ["2016-05-25 13:30:00.072", "GOOG", 720.50, 720.88],<br/>        ["2016-05-25 13:30:00.075", "MSFT", 52.01, 52.03],<br/>    ],<br/>    columns<strong class="lf iu">=</strong>["timestamp", "ticker", "bid", "ask"],<br/>)<br/>quotes['timestamp'] <strong class="lf iu">=</strong> pd<strong class="lf iu">.</strong>to_datetime(quotes['timestamp'])</span></pre><figure class="la lb lc ld gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="mu mv di mw bf mx"><div class="gh gi ne"><img src="../Images/d0c48f76674fc210aadb208255dbe5d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*c4hQR96DUArmcyTRBpCh7w.png"/></div></div></figure><p id="c029" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">交易数据框包含不同股票的交易。</p><pre class="la lb lc ld gt le lf lg lh aw li bi"><span id="c8df" class="lj lk it lf b gy ll lm l ln lo">trades <strong class="lf iu">=</strong> pd<strong class="lf iu">.</strong>DataFrame(<br/>    [<br/>        ["2016-05-25 13:30:00.023", "MSFT", 51.95, 75],<br/>        ["2016-05-25 13:30:00.038", "MSFT", 51.95, 155],<br/>        ["2016-05-25 13:30:00.048", "GOOG", 720.77, 100],<br/>        ["2016-05-25 13:30:00.048", "GOOG", 720.92, 100],<br/>        ["2016-05-25 13:30:00.048", "AAPL", 98.00, 100],<br/>    ],<br/>    columns<strong class="lf iu">=</strong>["timestamp", "ticker", "price", "quantity"],<br/>)<br/>trades['timestamp'] <strong class="lf iu">=</strong> pd<strong class="lf iu">.</strong>to_datetime(trades['timestamp'])</span></pre><figure class="la lb lc ld gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="mu mv di mw bf mx"><div class="gh gi nf"><img src="../Images/506beed09adf1368fd46d987c398aa1e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Wc3ckwIKmzoIKw28f4bIpw.png"/></div></div></figure><p id="b345" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我们通过报价器合并交易和报价，最新的报价可能比交易晚 10 毫秒。如果报价落后于交易超过 10 毫秒，或者没有任何报价，该报价的买价和卖价将为空(本例中为 AAPL 股票)。</p><pre class="la lb lc ld gt le lf lg lh aw li bi"><span id="ce8b" class="lj lk it lf b gy ll lm l ln lo">pd<strong class="lf iu">.</strong>merge_asof(trades, quotes, on<strong class="lf iu">=</strong>"timestamp", by<strong class="lf iu">=</strong>'ticker', tolerance<strong class="lf iu">=</strong>pd<strong class="lf iu">.</strong>Timedelta('10ms'), direction<strong class="lf iu">=</strong>'backward')</span></pre><figure class="la lb lc ld gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="mu mv di mw bf mx"><div class="gh gi ng"><img src="../Images/bbe92ffcf3f12550f0c02ff685b15e15.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5kG0Q7B--P9vnPi4wcseJg.png"/></div></div></figure><h1 id="284d" class="lr lk it bd ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn bi translated">4.创建 Excel 报表</h1><figure class="la lb lc ld gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="mu mv di mw bf mx"><div class="gh gi nh"><img src="../Images/5d95a5d2519bba179992e69bbe149d8e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2tnLphzGYjvEpTnPFYWjhA.png"/></div></div></figure><p id="76e8" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">Pandas(带有 XlsxWriter 库)使我们能够从数据框架创建 Excel 报表。这大大节省了时间——不再需要将数据帧保存为 CSV 格式，然后在 Excel 中格式化。我们还可以添加各种<a class="ae kz" href="https://pandas-xlsxwriter-charts.readthedocs.io/" rel="noopener ugc nofollow" target="_blank">图表</a>等。</p><pre class="la lb lc ld gt le lf lg lh aw li bi"><span id="7ec7" class="lj lk it lf b gy ll lm l ln lo">df <strong class="lf iu">=</strong> pd<strong class="lf iu">.</strong>DataFrame(pd<strong class="lf iu">.</strong>np<strong class="lf iu">.</strong>array([[1, 2, 3], [4, 5, 6], [7, 8, 9]]), columns<strong class="lf iu">=</strong>["a", "b", "c"])</span></pre><p id="b24b" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">下面的代码片段创建了一个 Excel 报表。要将数据帧保存到 Excel 文件，取消对<code class="fe my mz na lf b">writer.save()</code>行的注释。</p><pre class="la lb lc ld gt le lf lg lh aw li bi"><span id="3835" class="lj lk it lf b gy ll lm l ln lo">report_name <strong class="lf iu">=</strong> 'example_report.xlsx'<br/>sheet_name <strong class="lf iu">=</strong> 'Sheet1'</span><span id="8246" class="lj lk it lf b gy lp lm l ln lo">writer <strong class="lf iu">=</strong> pd<strong class="lf iu">.</strong>ExcelWriter(report_name, engine<strong class="lf iu">=</strong>'xlsxwriter')<br/>df<strong class="lf iu">.</strong>to_excel(writer, sheet_name<strong class="lf iu">=</strong>sheet_name, index<strong class="lf iu">=</strong>False)<br/><em class="lq"># writer.save()</em></span></pre><p id="b2a0" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">如前所述，该库还支持向 Excel 报表添加图表。我们需要定义图表的类型(我们示例中的折线图)和图表的数据系列(数据系列需要在 Excel 电子表格中)。</p><pre class="la lb lc ld gt le lf lg lh aw li bi"><span id="443f" class="lj lk it lf b gy ll lm l ln lo"><em class="lq"># define the workbook<br/></em>workbook <strong class="lf iu">=</strong> writer<strong class="lf iu">.</strong>book<br/>worksheet <strong class="lf iu">=</strong> writer<strong class="lf iu">.</strong>sheets[sheet_name]</span><span id="3078" class="lj lk it lf b gy lp lm l ln lo"><em class="lq"># create a chart line object<br/></em>chart <strong class="lf iu">=</strong> workbook<strong class="lf iu">.</strong>add_chart({'type': 'line'})</span><span id="0cfe" class="lj lk it lf b gy lp lm l ln lo"><em class="lq"># configure the series of the chart from the spreadsheet<br/># using a list of values instead of category/value formulas:<br/>#     [sheetname, first_row, first_col, last_row, last_col]<br/></em>chart<strong class="lf iu">.</strong>add_series({<br/>    'categories': [sheet_name, 1, 0, 3, 0],<br/>    'values':     [sheet_name, 1, 1, 3, 1],<br/>})</span><span id="e0d9" class="lj lk it lf b gy lp lm l ln lo"><em class="lq"># configure the chart axes<br/></em>chart<strong class="lf iu">.</strong>set_x_axis({'name': 'Index', 'position_axis': 'on_tick'})<br/>chart<strong class="lf iu">.</strong>set_y_axis({'name': 'Value', 'major_gridlines': {'visible': False}})</span><span id="7999" class="lj lk it lf b gy lp lm l ln lo"><em class="lq"># place the chart on the worksheet<br/></em>worksheet<strong class="lf iu">.</strong>insert_chart('E2', chart)</span><span id="9d7a" class="lj lk it lf b gy lp lm l ln lo"><em class="lq"># output the excel file<br/></em>writer<strong class="lf iu">.</strong>save()</span></pre><h1 id="8c64" class="lr lk it bd ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn bi translated">5.节省磁盘空间</h1><p id="013e" class="pw-post-body-paragraph kb kc it kd b ke mo kg kh ki mp kk kl km mq ko kp kq mr ks kt ku ms kw kx ky im bi translated">当处理多个数据科学项目时，您通常会从不同的实验中获得许多预处理数据集。笔记本电脑上的固态硬盘会很快变得凌乱不堪。Pandas 使您能够在保存数据集时对其进行压缩，然后以压缩格式读回。</p><p id="862e" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">让我们用随机数创建一个大熊猫数据框架。</p><pre class="la lb lc ld gt le lf lg lh aw li bi"><span id="bc40" class="lj lk it lf b gy ll lm l ln lo">df <strong class="lf iu">=</strong> pd<strong class="lf iu">.</strong>DataFrame(pd<strong class="lf iu">.</strong>np<strong class="lf iu">.</strong>random<strong class="lf iu">.</strong>randn(50000,300))</span></pre><figure class="la lb lc ld gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="mu mv di mw bf mx"><div class="gh gi ni"><img src="../Images/bd2b4fb692bfe09622e9fbe67fcbb3f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mM4Dpmmq0k6TIjbgLqzwgA.png"/></div></div></figure><p id="2d41" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">当我们将这个文件保存为 CSV 格式时，它会占用硬盘上将近 300 MB 的空间。</p><pre class="la lb lc ld gt le lf lg lh aw li bi"><span id="443d" class="lj lk it lf b gy ll lm l ln lo">df<strong class="lf iu">.</strong>to_csv('random_data.csv', index<strong class="lf iu">=</strong>False)</span></pre><p id="5d4c" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">使用一个参数<code class="fe my mz na lf b">compression='gzip'</code>，我们可以将文件大小减少到 136 MB。</p><pre class="la lb lc ld gt le lf lg lh aw li bi"><span id="599b" class="lj lk it lf b gy ll lm l ln lo">df<strong class="lf iu">.</strong>to_csv('random_data.gz', compression<strong class="lf iu">=</strong>'gzip', index<strong class="lf iu">=</strong>False)</span></pre><p id="a53d" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">将 gzipped 数据读入 DataFrame 也很容易，所以我们不会丢失任何功能。</p><pre class="la lb lc ld gt le lf lg lh aw li bi"><span id="b868" class="lj lk it lf b gy ll lm l ln lo">df <strong class="lf iu">=</strong> pd<strong class="lf iu">.</strong>read_csv('random_data.gz')</span></pre><h1 id="4f35" class="lr lk it bd ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn bi translated">结论</h1><p id="d4ba" class="pw-post-body-paragraph kb kc it kd b ke mo kg kh ki mp kk kl km mq ko kp kq mr ks kt ku ms kw kx ky im bi translated">这些技巧帮助我每天与熊猫相处时更有效率。希望这篇博文向你展示了熊猫的新功能，这将有助于你提高工作效率。</p><h1 id="9419" class="lr lk it bd ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn bi translated">在你走之前</h1><p id="dea3" class="pw-post-body-paragraph kb kc it kd b ke mo kg kh ki mp kk kl km mq ko kp kq mr ks kt ku ms kw kx ky im bi translated">在<a class="ae kz" href="https://twitter.com/romanorac" rel="noopener ugc nofollow" target="_blank"> Twitter </a>上关注我，我经常在那里发布关于数据科学和机器学习的微博。</p></div></div>    
</body>
</html>