<html>
<head>
<title>Create a Marvel Database with SQL and Javascript, the easy way</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用 SQL 和 Javascript 创建一个漫威数据库，简单的方法</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/create-a-marvel-database-with-sql-and-javascript-the-easy-way-573ccdf44673?source=collection_archive---------31-----------------------#2019-07-02">https://towardsdatascience.com/create-a-marvel-database-with-sql-and-javascript-the-easy-way-573ccdf44673?source=collection_archive---------31-----------------------#2019-07-02</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="3efc" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">维基百科是一个很好的数据来源，你可以在你的下一个项目中利用它</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/7f60847972f737c8d8393fda85cf6242.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*EUwUmHAQ8HCb1tpb.jpg"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">I know, this picture is mostly about DC, but this post is not only about Marvel and <a class="ae kv" href="https://unsplash.com/@happilyabstract?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Lena Rose</a> did a great job taking this picture.</figcaption></figure><p id="40ae" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这篇文章中，我将解释如何使用维基百科、Javascript 和 SQL 创建一个漫威数据库(或 DC 数据库)。我们将制作一个灵活的工具，允许您创建不同的表格用于您的项目。这里解释的概念可以扩展到其他学科。这篇文章是写给那些没有时间学习维基数据系统中使用的<em class="ls">修改的 sql </em>的复杂语法，但仍然想玩他们的数据的人的。</p><p id="4e32" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我拥有一个漫画数据库的最初原因是为了创建这种可视化效果，你将在本文结尾再次看到这一点:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi lt"><img src="../Images/7ffe454f75f7e8e6ede107e84bbcfc03.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*TK88U5ty5nRYl6dV.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Legend of Marvel &amp; DC visualization: <a class="ae kv" href="https://heberleh.github.io/comics-universe/" rel="noopener ugc nofollow" target="_blank">https://heberleh.github.io/comics-universe/</a></figcaption></figure><h1 id="3a1c" class="lu lv iq bd lw lx ly lz ma mb mc md me jw mf jx mg jz mh ka mi kc mj kd mk ml bi translated">管道</h1><p id="d97d" class="pw-post-body-paragraph kw kx iq ky b kz mm jr lb lc mn ju le lf mo lh li lj mp ll lm ln mq lp lq lr ij bi translated">这里的想法是通过以下步骤获得一个灵活的数据库:</p><ol class=""><li id="0fea" class="mr ms iq ky b kz la lc ld lf mt lj mu ln mv lr mw mx my mz bi translated">从<strong class="ky ir"> Wikidata </strong>中查询表格并导出为 json 文件</li><li id="813c" class="mr ms iq ky b kz na lc nb lf nc lj nd ln ne lr mw mx my mz bi translated">创建一个<strong class="ky ir"> Alasql </strong>数据库，并插入来自 json 文件的数据</li><li id="1cf1" class="mr ms iq ky b kz na lc nb lf nc lj nd ln ne lr mw mx my mz bi translated">使用创建的数据库执行<strong class="ky ir"> SQL 查询</strong></li></ol><h1 id="e60f" class="lu lv iq bd lw lx ly lz ma mb mc md me jw mf jx mg jz mh ka mi kc mj kd mk ml bi translated">1.从维基百科提取数据</h1><p id="9f1a" class="pw-post-body-paragraph kw kx iq ky b kz mm jr lb lc mn ju le lf mo lh li lj mp ll lm ln mq lp lq lr ij bi translated">维基百科背后有一个很棒的数据库和本体。点击此处进入查询系统:<a class="ae kv" href="https://w.wiki/4iP" rel="noopener ugc nofollow" target="_blank">https://w.wiki/4iP</a></p><p id="c88e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在上面的链接中，你会发现类似的内容(你会在那里找到更多相关信息):</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nf ng l"/></div></figure><p id="9b43" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这段代码中，我选择的实体是<em class="ls">漫画人物</em>的实例，并且在<em class="ls">虚构世界</em> <em class="ls">漫威世界</em>中。乍一看可能有点奇怪，但是这些代码都是维基百科本体的一部分。这就是他们如何处理冗余，并能组织和使一切工作！但是如何创建自己的查询呢？</p><p id="99d3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">首先，会帮助你。尝试键入<code class="fe nh ni nj nk b">wdt:&lt;Ctrl+Space&gt;</code>。您注意到弹出了一个帮助工具提示。尝试键入的<em class="ls">实例。您会看到'</em>的'<em class="ls">实例的代码是<code class="fe nh ni nj nk b">wdt:P31</code>。使用同样的方法，现在对于一个<em class="ls">值</em>，你将输入<code class="fe nh ni nj nk b">wdt:&lt;Ctrl+Space&gt;</code>(这次没有“t ”!)和<em class="ls">漫画人物</em>，回车，瞧，你得到了代码<code class="fe nh ni nj nk b">wd:Q1114461</code>。</em></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/ddc8af6e9e3fb7d7c1c118aa2946c8fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:912/format:webp/0*0N84nXvsKGMhjUSQ.png"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">&lt;Ctrl+Space&gt; opens the helper</figcaption></figure><p id="d844" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">O <em class="ls">好的，亨利，但是我不知道我们可以用什么，我没有时间学习维基百科的语言……</em>而且我理解你！因此，为了克服这一点，我们将在这里打开这一页<a class="ae kv" href="https://www.wikidata.org/wiki/Q841372" rel="noopener ugc nofollow" target="_blank">巨头</a>。这是维基百科条目代码 Q841372，庞然大物！现在看一看，看看有什么关于一个漫画人物的信息。将鼠标指针放在语句部分的项目上。例如，如果您将鼠标放在“实例”上，您将获得 P31 代码！因为它不是一个值，所以对这个值使用<code class="fe nh ni nj nk b">wdt</code>。</p><p id="55f9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">通过浏览该页面，您可以很好地了解可以使用哪些属性。暂停:如果你想创建一个数据库，但还不知道它会是什么，试试<a class="ae kv" href="https://en.wikipedia.org/wiki/Special:Random" rel="noopener ugc nofollow" target="_blank">随机文章</a>功能来获得见解。我们可以对任何维基百科页面做同样的事情。去官方维基百科网站搜索任何东西，比如说… <a class="ae kv" href="https://en.wikipedia.org/wiki/Aluminium" rel="noopener ugc nofollow" target="_blank">铝</a>。现在检查左侧栏，寻找<strong class="ky ir"> Wikidata item </strong>链接。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nm"><img src="../Images/68018164c7544c032af381afdfbb0878.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*gIefPpeevfeo42xY.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Wikidata link is in read on the left</figcaption></figure><p id="97a6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">单击，瞧，它显示了该项目的所有属性。我们看到我们通过使用<code class="fe nh ni nj nk b">wdt:P2067</code>得到了<strong class="ky ir">质量</strong>，以及许多其他可能适用于其他类型金属的属性。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nn"><img src="../Images/f33162f7b5f768ff50a6c321504cc402.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*u2zen4GOWlNkmo3Z.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Each Wikidata entry has many properties. The tooltip tells you the property ID.</figcaption></figure><p id="ba78" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在我们有了维基数据，我们将:</p><ol class=""><li id="ec65" class="mr ms iq ky b kz la lc ld lf mt lj mu ln mv lr mw mx my mz bi translated">为感兴趣的属性创建查询</li><li id="3e54" class="mr ms iq ky b kz na lc nb lf nc lj nd ln ne lr mw mx my mz bi translated">将结果下载为。json</li><li id="42a0" class="mr ms iq ky b kz na lc nb lf nc lj nd ln ne lr mw mx my mz bi translated">始终跟踪 id(Wikidata 项目 URL)和标签</li></ol><p id="33ef" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">例如，我创建了一个性别查询。一个查询职业，以此类推。结果是一个文件夹有许多。我将把 json 文件加载到由许多表组成的数据库中。您可以对所有信息执行单个查询。在我的例子中，我希望它具有延展性，这样我就可以执行 JOIN、LEFT JOIN 和其他 SELECT 命令来获得不同的表。</p><p id="0b19" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">事实上，我没有只获得漫威宇宙，而是丢弃了那个过滤器，获得了一个虚构角色实例的完整数据库(不仅仅是漫画角色——出于某种原因，这个不会查询美国队长)。所以，在我的 json 文件中，你可以找到漫威、DC 和其他人。生成的 jsons 在我的<a class="ae kv" href="https://github.com/heberleh/comics-characters-js-database" rel="noopener ugc nofollow" target="_blank"> GitHub 页面</a>中找到。接下来，我将展示如何在 Javascript 中使用 json 文件和一个简单的 T21 SQL 数据库。</p><p id="0a28" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">正如我在上一段中提到的，我的查询实际上是关于虚构角色类及其子类的。我还查询了伴侣和配偶，因此为此我使用命令|来定义两个 wdt:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nf ng l"/></div></figure><p id="7aa4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">注意，在上面的代码中，我不再过滤漫威了。对于更复杂的查询或处理列表，请参考<a class="ae kv" href="https://www.wikidata.org/wiki/Wikidata:Main_Page" rel="noopener ugc nofollow" target="_blank"> Wikidata 网站</a>。另一个不错的选择是位于<a class="ae kv" href="https://query.wikidata.org/" rel="noopener ugc nofollow" target="_blank">维基数据查询服务</a>顶部的<em class="ls">帮助</em>按钮，在那里你可以找到例子和支持。</p><h1 id="c88a" class="lu lv iq bd lw lx ly lz ma mb mc md me jw mf jx mg jz mh ka mi kc mj kd mk ml bi translated">2.用 Javascript 创建 SQL 数据库</h1><p id="5df7" class="pw-post-body-paragraph kw kx iq ky b kz mm jr lb lc mn ju le lf mo lh li lj mp ll lm ln mq lp lq lr ij bi translated">现在我们有了 json 文件，让我们将它们插入到 SQL 数据库中。为此，我们将使用一个名为<a class="ae kv" href="https://github.com/agershun/alasql" rel="noopener ugc nofollow" target="_blank"> Alasql </a>的工具。使用 Alasql，您可以以不同的方式加载数据和创建表格(<a class="ae kv" href="https://github.com/agershun/alasql/wiki" rel="noopener ugc nofollow" target="_blank">在这里阅读更多信息</a>)。</p><p id="7772" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这里，因为我们有来自 Wikidata 的 json，所以我们将对每个 JSON(文件)应用一个 SELECT 并插入到我们数据库的一个新表中，以便于访问。为了简化，我的代码将只包含两个表；你可以在这里找到完整的<strong class="ky ir">更新版本</strong> <a class="ae kv" href="https://github.com/heberleh/comics-characters-js-database" rel="noopener ugc nofollow" target="_blank">。看起来是这样的:</a></p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nf ng l"/></div></figure><p id="7b24" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们准备好了。我们有一个数据库，可以通过调用<code class="fe nh ni nj nk b">let mydb = MarvelDB()</code>来使用它，并像这样应用 SQL 命令:<code class="fe nh ni nj nk b">mydb.exec('SELECT DISTINCT abilityLabel from abilities')</code>。</p><h1 id="1dc8" class="lu lv iq bd lw lx ly lz ma mb mc md me jw mf jx mg jz mh ka mi kc mj kd mk ml bi translated">3.最终代码和用法</h1><p id="37a6" class="pw-post-body-paragraph kw kx iq ky b kz mm jr lb lc mn ju le lf mo lh li lj mp ll lm ln mq lp lq lr ij bi translated">我定义了一些测试来确保一切正常。它举例说明了我们数据库的用法。如果你不习惯测试，只考虑下面代码中的<code class="fe nh ni nj nk b">let result = this.db.exec(...)</code>和<code class="fe nh ni nj nk b">console.table(result)</code>，忽略其他部分。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nf ng l"/></div></figure><p id="23fc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">上面的<code class="fe nh ni nj nk b">SELECT</code>返回列<code class="fe nh ni nj nk b">charLabel</code>，并重命名为<code class="fe nh ni nj nk b">name</code>。它还连接了角色、性别和能力表，确保条目具有相同的角色 id ( <code class="fe nh ni nj nk b">char</code>)。最后，它通过名为<em class="ls"> agender </em>的特定性别进行过滤。关于这个数据库的更多例子，请到<a class="ae kv" href="https://github.com/heberleh/comics-characters-js-database" rel="noopener ugc nofollow" target="_blank"> GitHub 页面</a> -别忘了开始:)</p><p id="f53e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">本文描述了我为下面的可视化创建数据库的方式。你可以通过在台式机/笔记本电脑上访问<a class="ae kv" href="https://heberleh.github.io/comics-universe/" rel="noopener ugc nofollow" target="_blank">这个网站</a>与它互动(它可以在手机上打开，但互动是有限的)。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi no"><img src="../Images/b9bf680549c425411bf6b4a18854db7b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Fx6bq5ru_094ERPI-nLchQ.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Marvel &amp; DC visualization: <a class="ae kv" href="https://heberleh.github.io/comics-universe/" rel="noopener ugc nofollow" target="_blank">https://heberleh.github.io/comics-universe/</a></figcaption></figure></div><div class="ab cl np nq hu nr" role="separator"><span class="ns bw bk nt nu nv"/><span class="ns bw bk nt nu nv"/><span class="ns bw bk nt nu"/></div><div class="ij ik il im in"><p id="74ef" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这是我漫画人物系列的第一部分:</p><ol class=""><li id="d29a" class="mr ms iq ky b kz la lc ld lf mt lj mu ln mv lr mw mx my mz bi translated"><a class="ae kv" rel="noopener" target="_blank" href="/create-a-marvel-database-with-sql-and-javascript-the-easy-way-573ccdf44673">用 SQL 和 Javascript 创建漫威数据库，最简单的方法</a> [this]</li><li id="d4c5" class="mr ms iq ky b kz na lc nb lf nc lj nd ln ne lr mw mx my mz bi translated"><a class="ae kv" href="https://medium.com/@heberleh/visualizing-comic-characters-genders-and-superpowers-ae7c2311cb89" rel="noopener">可视化漫画人物的性别和超能力</a></li><li id="be56" class="mr ms iq ky b kz na lc nb lf nc lj nd ln ne lr mw mx my mz bi translated"><a class="ae kv" href="https://medium.com/@heberleh/comparing-marvel-and-dc-with-data-visualization-33b8f8486082" rel="noopener">用数据可视化比较漫威和 DC</a></li></ol><p id="9644" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">欢迎添加私人注释和评论。谢谢你看我的文章！</p></div></div>    
</body>
</html>