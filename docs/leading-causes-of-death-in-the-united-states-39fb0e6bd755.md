# 预测心脏病死亡率

> 原文：<https://towardsdatascience.com/leading-causes-of-death-in-the-united-states-39fb0e6bd755?source=collection_archive---------29----------------------->

## [深入分析](https://towardsdatascience.com/in-depth-analysis/home)

## 作为美国死亡的主要原因，我们使用机器学习来识别高危状态。

![](img/fdcc3b4a519f5579031966f19f4c7156.png)

疾病控制中心(CDC)的国家健康统计中心(NCHS)维护着一个按年龄调整的死亡率数据库，并统计了全美十大死亡原因。按照原因、州和年份分组，数据可用于 1999 年至 2016 年，前 10 位死亡原因如下:

*   阿尔茨海默病
*   巨蟹星座
*   慢性下呼吸道疾病(CLRD)
*   糖尿病
*   心脏病
*   流感和肺炎
*   肾脏疾病
*   中风
*   自杀
*   意外伤害

通过 CDC 网站的 HTTP GET 请求访问完整的数据集。

Sample of 2016 data for New York.

因此，人口统计和人口数据可以得到适当的解释，死亡人数将被用来代替年龄调整率。为了计算人均死亡人数，纳入了来自 [CDC 跨种族人口报告工具(WONDER)](https://wonder.cdc.gov/Bridged-Race-v2017.HTML) 的数据，该工具按年份、州、年龄组和性别对人口计数进行分组。将这个数据与死亡统计数据结合起来，人均死亡人数可以按州，按年计算，我们可以开始问一些问题。

## 目标

最终，目标是确定自 1999 年以来美国的主要死亡原因，然后确定 2019 年应被视为高风险的州。为了指导分析，需要回答四个具体问题:

1.  在美国，导致死亡的主要原因是什么？
2.  主要死亡原因的当前趋势是什么？
3.  哪些因素对这些比率影响最大？
4.  今天哪些州应该被视为高风险？

我们开始吧！

## 在美国，导致死亡的主要原因是什么？

如下图所示，根据 1999-2016 年的数据，美国的主要死亡原因是心脏病，占主要死亡原因的 34%。紧随其后的是癌症，占另外 30%。

![](img/b87073c315c33be81bc7c301e0df9b5f.png)

然而，确实想到的一个问题是心脏病和癌症之间的差异是否有统计学意义。换句话说:*年率的正态方差解释这种差异的可能性有多大？*对这个问题进行了双尾学生 t 检验，得到的 p 值为 0.00008 表示 A 偶然遇到这样结果的概率小于万分之一。考虑到这一点，继续分析心脏病是安全的。

## 主要死亡原因的当前趋势是什么？

在州和国家两级审查了这方面的趋势。所有州和年份的最小和最大记录比率被用来限制结果，并获得一段时间内的相对变化。在下面的时间间隔中，绿色代表人均死亡人数最低，而红色代表最高。地图下方的图表显示了同一时期全国的死亡率变化。

![](img/de5141837ce9de9ac272efec13ef6b77.png)

由此可以很容易地观察到，总体比率一直在提高，大部分红色和橙色变成了绿色和黄色。国家一级的明显下降趋势进一步证实了这一点。这是个好消息，但是这种趋势是否会持续到未来还需要确定。

为了实现这一目标，研究对心脏病影响最大的因素是很重要的。

## 哪些因素对这些比率影响最大？

在对该主题进行了一些一般性研究后，决定将重点放在三个方面:

1.  人口统计学(特别是年龄和性别)
2.  饮酒
3.  吸烟

明确地说，这些领域仅仅代表了可能性的一个子集，它们可能被合并到模型的未来版本中。

这里最大的挑战在于收集数据。虽然年龄和性别信息包含在疾病控制中心的人口数据中，但酒精和吸烟的数据还需要进一步挖掘。幸运的是，没有什么是一点研究和网络搜集不能处理的。

吸烟数据可从[联合健康基金会](https://www.americashealthrankings.org/explore/annual/measure/Smoking/)获得，年度数据保存在单独的 CSV 文件中。吸烟率本身定义如下:

> 吸烟的成年人百分比(据报告一生中至少吸烟 100 支，目前每隔一天或几天吸烟一次)

通过网站 API 快速浏览相关年份，可以轻松访问这些数据。剩下的工作就是在本地保存每个文件，将数据连接到一个数据框架中，并执行一些基本的清理工作(删除全国汇总的行，检查数据类型，并选择相关的列)。

Sample of smoking rate data in New York.

很快就会出现问题的一件事是，人们意识到数据源在 2014 年发生了变化。进一步调查显示，收集数据的方法实际上在 2012 年发生了变化，新方法更加准确。然而，这也造成了一种错觉，即在此期间，美国的吸烟率突然飙升。出于本分析的目的，吸烟率的逐年变化比实际吸烟率本身更重要，因此决定解决差异的最佳方法是调整 2012 年及以后的数据，使其与前一年的趋势更加一致。全国范围内的结果如下。

![](img/af3f7dfc56f495b9d9f6f079dc0ab8e1.png)

关于酒精消费，可从[国家酒精滥用和酒精中毒研究所](https://pubs.niaaa.nih.gov/publications/surveillance110/tab4-1_16.htm)获取数据。这里的酒精消耗量报告如下:

> 各州的人均乙醇消费量。[加仑乙醇，基于 14 岁及以上人口。]

此外，酒精消费按饮料类型(啤酒、葡萄酒和烈酒)进行细分。该组织网站上的数据分布在一个 16 页的表格中，因此需要一些漂亮的网页抓取。上面的链接指向数据的第一页，以给出结构的感觉，但 html 的截图和样本也应该有所帮助。

![](img/ceb06b115b1822efd66d4534824298f8.png)

最上面一行使用 *strong* 标签来标识州名，后面是年份行，相关数据由 *datagray* 和 *data* 类标识。这个特定的行将每年重复 40 次，然后显示下一个州。然而，整个表也被包装起来，并用强标签*标记，这意味着对于每个新页面，也将有一个表名而不是州名。下面的代码块用于解析所有的 html 并将结果保存到 dataframe 中。*

既然困难的部分已经过去，数据可以与现有的吸烟、人口统计和疾病预防控制中心的数据结合起来开始分析。在这一点上有 20 个预测变量:每个年龄组、性别、吸烟率和饮酒率各有一个。另外两个更令人好奇的预测指标也包括在内:人均糖尿病死亡人数和人口密度。这些变量的重要性被证明是最小的，尽管后者至少提供了一个相关的见解，这将在后面触及。

所有数据都经过了缩放和对数转换，结果可以用平衡的百分比表示。结果分布如下所示:

![](img/d302543ea5ae60256fa53af660c27b28.png)

虽然某些参数确实表现出一些偏斜，但总体上相当平衡，在稍后将数据输入预测模型时，没有表现出明显的问题。所以，现在终于有可能将数据输入回归模型，找出对死亡率影响最大的因素。在多重线性回归中使用了 4 个预测因子的所有可能组合，以寻找最高的调整 r 平方值。最终，四个变量被发现可以解释 83.4%的心脏病死亡率差异:吸烟率、75-79 岁年龄组、葡萄酒消费量和性别。这里至少有一个结果会让你大吃一惊。

![](img/957da0d1b5649824ffdc8aea47be19ac.png)

最不令人惊讶的项目在底部:随着越来越多的人口达到 75-79 岁年龄段，越来越多的人口可能死于心脏病。从行为的角度来看，吸烟表现出同样类型的关系。

然而，更出乎意料的是，男性似乎比女性更不容易死于心脏病。这并不一定意味着男性较少患心脏病，只是意味着他们死于心脏病的可能性较小。根据疾病控制中心的说法，

> 尽管在过去几十年中人们的意识有所提高，但只有大约一半(56%)的女性认识到心脏病是她们的头号杀手。

所以，对于那些不知道的人来说，这是一个公共服务公告。

另一件令人惊讶的事情是，饮酒似乎对心脏病死亡率没有太大影响。事实上，数据表明，增加葡萄酒消费实际上可以降低这些比率。现在，在你跑出去买你最喜欢的一瓶红酒之前，提醒你一句:葡萄酒消费量的增加也被观察到与吸烟率的降低相关。因此，很可能不一定是葡萄酒消费，而是饮酒者吸烟率的降低导致了心脏病死亡率的降低。

这一点在下面的关联热图中得到了证实，其中深蓝色方块表示强烈的负关联，亮红色表示强烈的正关联。最左栏中的方块重申了回归模型中已知的内容。

![](img/f2a7dda757722f24dc27c7389f6bbb5d.png)

## 今天哪些州应该被视为高风险？

我们几乎准备好建立一些模型并进行预测，但有两个问题需要解决。一、*高危*是怎么定义的？出于本分析的目的，高风险州将被定义为在所有数据范围内人均死亡人数处于所有比率前 33%的州。相反，低风险州是那些利率在底部 33%的州。将需要额外的领域专业知识来调整目标变量以反映行业标准，尽管这不应该降低模型本身的有效性，如果它们产生有希望的结果的话。

然而，第二个问题更具挑战性:我们的目标是对 2019 年进行预测，但只有 2016 年的数据。试图根据同一年获得的信息做出预测是不太现实的。虽然回顾过去有助于获得理解感，但展望未来却毫无用处。那么，解决办法是什么呢？时间滞后！

实际上，假设 2016 年的数据大约在 2017 年年中可用，但可以很容易地进行调整，以考虑这方面的差异。如果一个模型能够根据这些信息做出可靠的预测，那么组织将有一年半的时间来计划预期的变化。此外，该模型在进行预测时也不应该简单地忽略 2015 年和 2014 年的数据。所以，需要做的是使用 3 到 5 年的数据时滞，并将其作为当年死亡率的预测指标。结果将是预测变量的 3 倍，从 22 到 66。为了获得规模感，下面的关联热图突出了每个变量之间关系的性质。在这一点上，围绕多重共线性的问题将被搁置，这是因为预计会有相当数量的自相关。但是，也应该捕获 3 年窗口内的一致变化，这些变化是模型预测的主要关注点。

![](img/43b8f2e08ff3c54a6f01d031c2d56e59.png)

现在，试图用这么多预测变量建立一个模型将是非常低效的，尤其是在 13 英寸的笔记本电脑上。因此，进行了主成分分析(PCA ),以确定解释数据中 99%方差的最小特征组。因此，66 维的数据可以减少到 19 维。剩下的唯一事情就是建立模型，用最好的模型进行预测。

构建、训练和测试了六种不同的模型类型，出于测试目的保留了 20%的数据:

*   决策树分类
*   逻辑回归
*   支持向量机
*   随机森林分类
*   adaboost 算法
*   XGBoost

剩下的 80%使用 5 重交叉验证进行训练。此外，我们还对每个型号进行了网格搜索，以找出表现最佳的型号，结果产生了 1，413 种不同的型号变体。

![](img/c056529b355905490a3c60f3baf12570.png)

除非在课堂回忆或精确度分数上有任何明显的不平衡，F1 分数被选为精确度/性能的主要衡量标准。最终，有一个模型在所有方面都明显优于其他模型:支持向量机。如下所示，它对所有截面的测试数据都达到了 90%的准确率。然而，当根据以前从未见过的测试数据进行预测时，该模型被证明更加有效，达到了几乎 92%的准确率。

![](img/3263bf26b452038d7ea36f6e8e847282.png)

另一项值得注意的是，该模型在精确度方面的表现确实优于召回率，这种差异在高风险状态的预测中最为突出。为什么这很重要？在进行这些类型的预测时，高估风险水平比低估风险水平要好。精确度和回忆分数表明这正是模型容易出错的地方。

完成所有这些后，现在可以使用 2014-2016 年的数据对 2019 年进行预测，并对预测的可靠性有所了解。在下图中，红色、黄色和绿色代表基于实际死亡率的 2016 年实际风险水平。红色代表高风险，绿色代表低风险。时间推移侧重于预计将改变风险水平的状态，并显示 2019 年的预期结果。

![](img/65eaa9183db3d741b31276b817a0d148.png)

这里的结果有点复杂:四个状态从极端移动到中心，而两个状态从中心移动到极端。马萨诸塞州和马里兰州从低风险到中等风险，而密歇根州和宾夕法尼亚州从高风险到中等风险。伊利诺伊州和田纳西州走向相反的极端，分别从中等风险水平到低风险和高风险水平。但是有一个州特别突出:俄克拉荷马州。

俄克拉荷马州在 2016 年是一个高风险州，所以看到它这么快就被预测为低风险是一个很大的惊喜。经过更仔细的检查，很明显，这一变化的原因是吸烟率从 2010 年的 25.5%下降到 2015 年的约 19%，创历史新低。

![](img/23442727f4dfa3a2b517845f60faa54a.png)

目前尚不完全清楚这些结果是如何实现的，尽管该州卫生与公众服务部部长特里·克莱恩(Terry Cline)表示，这至少可以部分归因于该州的禁烟令，以及那些选择加入认证健康俄克拉荷马州计划的组织的商业地产。这绝对值得仔细看看他们在做什么，看看这些结果是否可以在其他地方复制。

再缩小，可以看到整个国家的 2019 年预测图。

![](img/d9d6a7b69ec492b9377e6eb6d4899eb5.png)

最引人注目的是预测风险水平的地区差异。在这 9 个州中，有 8 个在 2016 年已经属于高风险类别，田纳西州今年被添加到列表中。那么，这些州能做些什么来降低各自社区的风险水平呢？

## 推荐

正如俄克拉荷马州所展示的，这些州所能做的最好的事情就是集中精力降低吸烟率。区域的接近性表明，如果俄克拉荷马州的项目在任何地方都有效，那将是在这些可能有相当多文化重叠的州。

此外，针对退休人员和女性的心脏病宣传活动也大有可为。数据中的另一项观察表明，在人口密集地区，妇女占人口的比例更大。因此，在城市中更加重视这些运动可能会产生更好的效果。

当然，看看这些结果是否可以进一步改善也是件好事，特别是在纳入种族数据和人群饮食习惯的情况下。可能性几乎是无穷无尽的，但潜力是显而易见的。

## 最后的想法

心脏病是一种在生活中的某个时刻影响到大多数人的疾病。也许你已经被折磨了。也许某个朋友或家人是幸存者，还在挣扎，或者已经去世。对我来说，那是一个两个月前因心脏病发作去世的叔叔，他还不到 60 岁。根据[疾控中心](https://www.cdc.gov/heartdisease/facts.htm):

*   在 2005 年的一项调查中，大多数受访者(92%)认为胸痛是心脏病发作的一种症状。**只有 27%** 的人知道所有的主要症状，并知道在有人心脏病发作时拨打 9-1-1。
*   **大约 47%** 的心源性猝死发生在医院外。这表明许多心脏病患者不会对早期预警信号采取行动。

如果只有一件事是你从这件事中学到的，我希望它是让你自己检查一下，让你自己意识到可能使你处于高风险水平的因素。

## 参考

Jupyter 笔记本和这个项目使用的所有资源都可以在 [Github](https://github.com/rwilleynyc/heart_disease_mortality) 上找到。