<html>
<head>
<title>How To Use Machine Learning To Possibly Become A Millionaire: Predicting The Stock Market?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何利用机器学习有可能成为百万富翁:预测股市？</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-use-machine-learning-to-possibly-become-a-millionaire-predicting-the-stock-market-33861916e9c5?source=collection_archive---------2-----------------------#2019-08-30">https://towardsdatascience.com/how-to-use-machine-learning-to-possibly-become-a-millionaire-predicting-the-stock-market-33861916e9c5?source=collection_archive---------2-----------------------#2019-08-30</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="1bde" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">我们的置信区间在 50%到 70%之间</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/03895c1e13f6e379c3da5b0763c6f42e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WkKClOMOjsWSLqEViPSfqQ.jpeg"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">When you’re so bored with your stacks</figcaption></figure><p id="bd57" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在华尔街工作和你想象的一样紧张和有回报。许多西装，许多阴沉的脸和大量的香烟烟雾。在你所期待的世界金融中心的疯狂中，每个人的潜在目标都很简单。冒着把事情过于简单化的风险，我现在就告诉你，金融就是用钱(你自己的或者你借的)来获得更多的钱。金融业实际上并不创造任何价值，而是利用其他因素来获得投资回报。</p><p id="3240" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">股票市场是最著名的基础设施之一，通过它任何人都有可能发财。如果有人能破解预测未来股票价格的密码，他们将几乎统治世界。</p><p id="2392" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">只有一个问题。准确预测股票市场的未来几乎是不可能的。那么多的分析师，那么多的研究人员，那么多超级聪明的人都试图弄清楚这一切。没有人能够获得一致的结果。没有人。</p><p id="5ff7" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">那么这篇文章的重点是什么呢？为什么我要写关于使用机器学习来预测股票市场的可能性？我猜主要是为了好玩。然而，更重要的是，对于机器学习和金融来说，这是一个很好的学习练习。</p><h1 id="4f50" class="lu lv it bd lw lx ly lz ma mb mc md me jz mf ka mg kc mh kd mi kf mj kg mk ml bi translated">议程</h1><ol class=""><li id="a495" class="mm mn it la b lb mo le mp lh mq ll mr lp ms lt mt mu mv mw bi translated">储料器模块</li><li id="448d" class="mm mn it la b lb mx le my lh mz ll na lp nb lt mt mu mv mw bi translated">移动平均线</li><li id="35cc" class="mm mn it la b lb mx le my lh mz ll na lp nb lt mt mu mv mw bi translated">简单线性回归</li><li id="7bd1" class="mm mn it la b lb mx le my lh mz ll na lp nb lt mt mu mv mw bi translated">k-最近邻</li><li id="77e2" class="mm mn it la b lb mx le my lh mz ll na lp nb lt mt mu mv mw bi translated">多层感知器</li><li id="2d3d" class="mm mn it la b lb mx le my lh mz ll na lp nb lt mt mu mv mw bi translated">你应该做什么</li><li id="5be8" class="mm mn it la b lb mx le my lh mz ll na lp nb lt mt mu mv mw bi translated">需要改进的地方</li><li id="b15a" class="mm mn it la b lb mx le my lh mz ll na lp nb lt mt mu mv mw bi translated">资源</li></ol><p id="9219" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><em class="nc">如果你想更深入地了解这个项目，或者如果你想添加代码，查看一下</em> <a class="ae nd" href="https://github.com/jerrytigerxu/Stock-Price-Prediction" rel="noopener ugc nofollow" target="_blank"> <em class="nc"> GitHub 库</em> </a> <em class="nc">。</em></p></div><div class="ab cl ne nf hx ng" role="separator"><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj"/></div><div class="im in io ip iq"><h1 id="033d" class="lu lv it bd lw lx nl lz ma mb nm md me jz nn ka mg kc no kd mi kf np kg mk ml bi translated">使用储料器模块</h1><p id="085f" class="pw-post-body-paragraph ky kz it la b lb mo ju ld le mp jx lg lh nq lj lk ll nr ln lo lp ns lr ls lt im bi translated">Stocker 模块是一个简单的 Python 库，包含了许多有用的股票市场预测函数。在初始化时，它们不是那么准确(最好抛硬币决定)。但是通过一些参数的调整，结果会好得多。</p><p id="68e7" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">首先我们需要克隆 GitHub 库。</p><pre class="kj kk kl km gt nt nu nv nw aw nx bi"><span id="a3c8" class="ny lv it nu b gy nz oa l ob oc">!git clone <a class="ae nd" href="https://github.com/WillKoehrsen/Data-Analysis.git" rel="noopener ugc nofollow" target="_blank">https://github.com/WillKoehrsen/Data-Analysis.git</a></span></pre><p id="be06" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们还需要导入一些库。既然已经克隆了 repo，我们也可以导入 Stocker 模块了。</p><pre class="kj kk kl km gt nt nu nv nw aw nx bi"><span id="9e73" class="ny lv it nu b gy nz oa l ob oc">!pip install quandl<br/>!pip install pytrends<br/>import stocker<br/>from stocker import Stocker</span></pre><p id="c882" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们创建一个 Stocker 对象。我选择谷歌作为我的公司，但你没有义务也这样做。Stocker 模块有一个名为 plot_stock()的函数，它自己做了很多工作。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi od"><img src="../Images/b8bd41617aab1a0bd2159da882f0fa85.png" data-original-src="https://miro.medium.com/v2/resize:fit:1238/format:webp/1*J0HEOyS8KuX06yT2o2eJeg.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Google’s stock is very nice</figcaption></figure><p id="c595" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果您注意的话，您会注意到 Stocker 对象的日期不是最新的。止于 2018–3–27。仔细看看实际的模块代码，我们会发现数据来自 Quandl 的 WIKI 交换。也许数据没有更新？</p><p id="9cf0" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们可以使用 Stocker 进行技术股票分析，但现在我们将专注于成为媒介。Stocker 使用了一个由脸书开发的叫做 prophet 的软件包，这是一个很好的附加建模软件。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oe"><img src="../Images/5325c605cd3b3ace0abd5a809725d799.png" data-original-src="https://miro.medium.com/v2/resize:fit:1230/format:webp/1*u_9HdWsdLzRstDe-mrl-nA.png"/></div></div></figure><p id="db21" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在让我们测试一下斯托克的预测。我们需要创建一个测试集和一个训练集。我们将培训时间定在 2014 年至 2016 年，测试时间定在 2017 年。让我们看看这个模型有多精确。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi of"><img src="../Images/0f159c6de4347a8af371adfb4145023c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1394/format:webp/1*AlnIXbH4mnwtKm98oFYLzg.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Look how terrible this prediction is!</figcaption></figure><p id="b431" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">结果相当可怕，预测几乎和掷硬币一样糟糕。让我们调整一些超参数。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi og"><img src="../Images/97ab2e3cca0cb618c450be399b757a6a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1gddoiIQPBo_4VgkC8ROdw.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Here we can see the results of using different changepoints</figcaption></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oh"><img src="../Images/76521d9826028b45e35713efd7d368a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Lu1Xqbs92XzSOKT9KwUDAA.png"/></div></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oi"><img src="../Images/0562020e53c07a937cdacebf69543622.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sIxxdhpXZaR8RFOMRFX28A.png"/></div></div></figure><p id="a014" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">对变点进行验证是调整超参数以更好地调整股票预测算法的有效方法。</p><p id="bbd3" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在，我们可以评估优化的模型，看看预测估计值是否有任何改进。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oi"><img src="../Images/f8f9206d599d4a46ec093f3f025e27e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QMo0uf_E_dC3jn3d6y2WTg.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">This is only SLIGHTLY better than the previous model</figcaption></figure><p id="e281" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在是做终极测试的时候了:去股市碰碰运气(当然是模拟的)。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oj"><img src="../Images/b72fa76fc3f6b980be119f6082268f15.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Em8s_mTTWWWqh6VmVJFzRg.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Looks like it’s just better to buy and hold.</figcaption></figure><p id="82eb" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">即使在所有这些调整之后，很明显，简单地买入并持有会产生更好的回报。</p></div><div class="ab cl ne nf hx ng" role="separator"><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj"/></div><div class="im in io ip iq"><h1 id="b44a" class="lu lv it bd lw lx nl lz ma mb nm md me jz nn ka mg kc no kd mi kf np kg mk ml bi translated">为机器学习准备数据</h1><p id="4275" class="pw-post-body-paragraph ky kz it la b lb mo ju ld le mp jx lg lh nq lj lk ll nr ln lo lp ns lr ls lt im bi translated">现在让我们继续尝试用机器学习来预测股票价格，而不是依赖于一个模块。对于这个例子，我将使用 Stocker 提供的 make_df 函数来使用 Google 股票数据。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ok"><img src="../Images/c8ed1320fb8f91134bd7f7cb6eec7a7b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gW_7YuBI7qrOnDVo1RJFwA.png"/></div></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ol"><img src="../Images/79dc34418222aa3eba239da5af913f5d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*k86_XtBwsI2cuebL6oMP3A.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Narrowing down the dataframe to get the stuff we care about</figcaption></figure></div><div class="ab cl ne nf hx ng" role="separator"><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj"/></div><div class="im in io ip iq"><h1 id="89e5" class="lu lv it bd lw lx nl lz ma mb nm md me jz nn ka mg kc no kd mi kf np kg mk ml bi translated">移动平均线</h1><p id="32a7" class="pw-post-body-paragraph ky kz it la b lb mo ju ld le mp jx lg lh nq lj lk ll nr ln lo lp ns lr ls lt im bi translated">总之，均线是技术分析中常用的指标。这是一个滞后指标，这意味着它使用过去的价格来预测未来的价格。它可以有效地消除任何短期波动，并找到整体趋势。我们将使用移动平均线来看看我们是否能更好地预测股票价格。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="om on l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oo"><img src="../Images/867c55a4a52dd7dca1dd8e298db1d081.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KzeddyS_K63QxM_Pjl3Ykw.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Here’s the closing prices for Google stock</figcaption></figure><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="om on l"/></div></figure><p id="9e5e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们用 RMS(均方根误差)来衡量我们模型的准确性。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi op"><img src="../Images/add2745aaa0a6247c07316b7ea5c2923.png" data-original-src="https://miro.medium.com/v2/resize:fit:1384/format:webp/1*6zMGMU8wfUdRFHR0NJx6yQ.png"/></div></figure><p id="68a4" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在让我们看看我们的预测在实际价格旁边的位置。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oq"><img src="../Images/c4e9b81a91ba1473a4ada81e40e2eb9e.png" data-original-src="https://miro.medium.com/v2/resize:fit:986/format:webp/1*Qq9VqBdDvja72rLcpLCg_A.png"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi or"><img src="../Images/7b0e9d043d1d82408e040d25c2e0fd57.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*m6WlA9CzsMAs690KMcB5Dw.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Yikes</figcaption></figure><p id="db90" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">就找出股票数据的总体趋势而言，移动平均线方法做得不错，但它未能看到价格上涨的全部幅度，这不好。我们肯定不想用这种方法进行实际的算法交易。</p></div><div class="ab cl ne nf hx ng" role="separator"><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj"/></div><div class="im in io ip iq"><h1 id="292f" class="lu lv it bd lw lx nl lz ma mb nm md me jz nn ka mg kc no kd mi kf np kg mk ml bi translated">简单线性回归</h1><p id="1a37" class="pw-post-body-paragraph ky kz it la b lb mo ju ld le mp jx lg lh nq lj lk ll nr ln lo lp ns lr ls lt im bi translated">让我们尝试使用另一种方法来预测未来的股票价格，线性回归。</p><p id="7ea5" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">首先，让我们基于原始数据集创建一个新的数据集。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="om on l"/></div></figure><p id="d7e0" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在，让我们为线性回归算法的数据集添加更多的要素。我们将使用<strong class="la iu"> fastai </strong>模块中的一些函数。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="om on l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi os"><img src="../Images/a0a715aa75a456d58e7819b07b42cd07.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iU2GW_u_QZA-_IVZd7BCqQ.png"/></div></div></figure><p id="890d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在让我们做一个火车测试分裂。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="om on l"/></div></figure><p id="2a13" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在我们可以实现算法并得到一些结果。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="om on l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ot"><img src="../Images/effce1dcb593350bf2cf364d6c268565.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Mh8RhDAdhWVlPVJqp1LSuA.png"/></div></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ou"><img src="../Images/4c8fc2ccb2ebe6afce45c25ea9d8005a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1154/format:webp/1*cENj9Mld1dfAunm7YGRFsg.png"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ov"><img src="../Images/ca5671bb6cd235019819151af980e216.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ooz0gFuZcCoWYWBD9x1yaQ.png"/></div></div></figure><p id="ccba" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">再一次，预测算法在某种程度上指出了总体趋势，但是它没有抓住我们最需要的东西。</p></div><div class="ab cl ne nf hx ng" role="separator"><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj"/></div><div class="im in io ip iq"><h1 id="8c85" class="lu lv it bd lw lx nl lz ma mb nm md me jz nn ka mg kc no kd mi kf np kg mk ml bi translated">k-最近邻</h1><p id="c09e" class="pw-post-body-paragraph ky kz it la b lb mo ju ld le mp jx lg lh nq lj lk ll nr ln lo lp ns lr ls lt im bi translated">让我们继续另一个机器学习算法，KNN。</p><p id="7351" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们用和线性回归一样的数据经历同样的过程。唯一的区别是我们将对数据实施不同的算法。让我们看看哪些预测更好。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="om on l"/></div></figure><p id="ee2b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们的结果是什么？</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ow"><img src="../Images/ca93791cfb6b9e0855f3622f4c56122b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1370/format:webp/1*1iKFkydIywvw5lbwTucv_Q.png"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ox"><img src="../Images/ba1ec2e28afbdb325f2fe6fb8bacfc0b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jKoYLa1V7yDKm2LvZ-PwkA.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">What a horror story</figcaption></figure><p id="d35e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">呀！这是迄今为止我们得到的最糟糕的预测！k-最近邻对于分类问题和小规模回归更有用是有原因的。这似乎是过度拟合的典型案例。因为 KNN 实际上只是计算从一个点到另一个点的距离，它完全无法计算出价格走向的趋势。下一步是什么？</p><h1 id="cf1b" class="lu lv it bd lw lx ly lz ma mb mc md me jz mf ka mg kc mh kd mi kf mj kg mk ml bi translated">多层感知器</h1><p id="370d" class="pw-post-body-paragraph ky kz it la b lb mo ju ld le mp jx lg lh nq lj lk ll nr ln lo lp ns lr ls lt im bi translated">让我们进入一些深度学习，更具体地说，神经网络。多层感知器是最简单的神经网络类型之一，至少比卷积神经网络和长短期记忆简单。我们不需要深入算法实际工作的细节。如果您感兴趣，请查看本文末尾的参考资料。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="om on l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oy"><img src="../Images/e295d96fef0efcd3f09e0b30156fea65.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bBkbrL0YIjjyRlN-R6G_BQ.png"/></div></div></figure><p id="e237" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们看看结果。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oz"><img src="../Images/5bc7853cc97e2db60f509ddac15e0776.png" data-original-src="https://miro.medium.com/v2/resize:fit:1344/format:webp/1*v7VMExbkuX7ONjYacfVW9g.png"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pa"><img src="../Images/00a1c183c356f29ac9947c4aa7b311fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HURylNLcFhPodcelU-tRIA.png"/></div></div></figure><p id="5924" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这比 KNN 还糟糕！关于为什么神经网络在预测股票价格方面如此糟糕，有许多因素，其中之一肯定是缺乏有意义的特征和数据。显然，还有许多超参数可以调整。</p><h1 id="ddc9" class="lu lv it bd lw lx ly lz ma mb mc md me jz mf ka mg kc mh kd mi kf mj kg mk ml bi translated">结论</h1><p id="caf1" class="pw-post-body-paragraph ky kz it la b lb mo ju ld le mp jx lg lh nq lj lk ll nr ln lo lp ns lr ls lt im bi translated">我们今天学了什么？所有这些技术分析向我们展示了什么？答案很简单:如果你不是雷伊·达里奥、沃伦·巴菲特或任何伟大的投资者，那么试图跑赢股市的风险很大，最终也不会那么有利可图。根据一些消息来源，大多数对冲基金甚至不能比标准普尔 500 做得更好！因此，如果你想在你的投资上获得最好的回报，就采取买入并持有的策略。在很大程度上，简单地投资于标准普尔 500 这样的指数基金已经获得了相当不错的回报，即使是在经济出现几次大幅下滑的时候。最后还是要由你来决定。</p><h1 id="58c9" class="lu lv it bd lw lx ly lz ma mb mc md me jz mf ka mg kc mh kd mi kf mj kg mk ml bi translated">需要改进的地方</h1><p id="899a" class="pw-post-body-paragraph ky kz it la b lb mo ju ld le mp jx lg lh nq lj lk ll nr ln lo lp ns lr ls lt im bi translated">感谢您花时间通读这篇文章！请随意查看我的<a class="ae nd" href="https://jerrytigerxu.github.io/?source=post_page---------------------------" rel="noopener ugc nofollow" target="_blank">作品集网站</a>或<a class="ae nd" href="https://github.com/jerrytigerxu?source=post_page---------------------------" rel="noopener ugc nofollow" target="_blank">我的 GitHub </a>。</p><h2 id="99e3" class="ny lv it bd lw pb pc dn ma pd pe dp me lh pf pg mg ll ph pi mi lp pj pk mk pl bi translated">1.使用不同的股票数据</h2><p id="e651" class="pw-post-body-paragraph ky kz it la b lb mo ju ld le mp jx lg lh nq lj lk ll nr ln lo lp ns lr ls lt im bi translated">我只在相对较短的时间内使用了谷歌股票数据。随意使用不同的数据，这些数据可以通过 Stocker 或 Yahoo Finance 或 Quandl 获得。</p><h2 id="1a52" class="ny lv it bd lw pb pc dn ma pd pe dp me lh pf pg mg ll ph pi mi lp pj pk mk pl bi translated">2.尝试不同的机器学习算法</h2><p id="f471" class="pw-post-body-paragraph ky kz it la b lb mo ju ld le mp jx lg lh nq lj lk ll nr ln lo lp ns lr ls lt im bi translated">有许多非常好的机器学习算法。我只使用了其中的一小部分，其中只有一个是深度学习算法。</p><h2 id="e0ba" class="ny lv it bd lw pb pc dn ma pd pe dp me lh pf pg mg ll ph pi mi lp pj pk mk pl bi translated">3.调整更多超参数</h2><p id="edc2" class="pw-post-body-paragraph ky kz it la b lb mo ju ld le mp jx lg lh nq lj lk ll nr ln lo lp ns lr ls lt im bi translated">这是不言自明的。大多数情况下，任何算法的默认设置都不是最优的，因此尝试一些验证来找出哪个超参数最有效是很有用的。</p><h1 id="96d4" class="lu lv it bd lw lx ly lz ma mb mc md me jz mf ka mg kc mh kd mi kf mj kg mk ml bi translated">资源</h1><ol class=""><li id="fc27" class="mm mn it la b lb mo le mp lh mq ll mr lp ms lt mt mu mv mw bi translated"><a class="ae nd" href="https://www.youtube.com/watch?v=p7HKvqRI_Bo" rel="noopener ugc nofollow" target="_blank">了解股市</a></li><li id="4d41" class="mm mn it la b lb mx le my lh mz ll na lp nb lt mt mu mv mw bi translated"><a class="ae nd" href="https://www.youtube.com/watch?v=HzNTUp-WAIE" rel="noopener ugc nofollow" target="_blank">技术分析</a></li><li id="b249" class="mm mn it la b lb mx le my lh mz ll na lp nb lt mt mu mv mw bi translated"><a class="ae nd" href="https://www.youtube.com/watch?v=HcqpanDadyQ&amp;t=7s" rel="noopener ugc nofollow" target="_blank">什么是机器学习？</a></li><li id="321c" class="mm mn it la b lb mx le my lh mz ll na lp nb lt mt mu mv mw bi translated"><a class="ae nd" href="https://www.youtube.com/watch?v=4R2CDbw4g88" rel="noopener ugc nofollow" target="_blank">移动平均线</a></li><li id="9640" class="mm mn it la b lb mx le my lh mz ll na lp nb lt mt mu mv mw bi translated"><a class="ae nd" href="https://www.youtube.com/watch?v=nk2CQITm_eo" rel="noopener ugc nofollow" target="_blank">线性回归</a></li><li id="63ab" class="mm mn it la b lb mx le my lh mz ll na lp nb lt mt mu mv mw bi translated"><a class="ae nd" href="https://www.youtube.com/watch?v=HVXime0nQeI" rel="noopener ugc nofollow" target="_blank">K-最近邻</a></li><li id="02f8" class="mm mn it la b lb mx le my lh mz ll na lp nb lt mt mu mv mw bi translated"><a class="ae nd" href="https://www.youtube.com/watch?v=aircAruvnKk&amp;t=4s" rel="noopener ugc nofollow" target="_blank">神经网络</a></li><li id="c7b0" class="mm mn it la b lb mx le my lh mz ll na lp nb lt mt mu mv mw bi translated"><a class="ae nd" href="https://www.youtube.com/watch?v=UbMDK4UNtPA" rel="noopener ugc nofollow" target="_blank">张量流</a></li><li id="a071" class="mm mn it la b lb mx le my lh mz ll na lp nb lt mt mu mv mw bi translated"><a class="ae nd" href="https://www.youtube.com/watch?v=J6Ok8p463C4" rel="noopener ugc nofollow" target="_blank"> Keras </a></li></ol></div></div>    
</body>
</html>