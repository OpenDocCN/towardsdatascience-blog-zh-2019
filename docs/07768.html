<html>
<head>
<title>Experiments in Classifying Residential Water Flow</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">住宅水流分类实验</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/experiments-in-classifying-residential-water-flow-29656c71b8b?source=collection_archive---------31-----------------------#2019-10-27">https://towardsdatascience.com/experiments-in-classifying-residential-water-flow-29656c71b8b?source=collection_archive---------31-----------------------#2019-10-27</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="f850" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我从中了解到筛选另一个人的 IOT 数据有点令人毛骨悚然。</p><p id="1d64" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">去年，我花了大量时间阅读机器学习算法——它们能做什么，以及如何在 Python 中使用它们。一天晚上，我和几个朋友在吃饭时讨论这些问题，其中一个朋友告诉我，他家里的主水管上连接了一个流量计，看看我们能用它做什么可能会很有趣。在查看数据后，我决定看看我们是否可以训练一个分类器来识别水流并对其进行分类。然后你就可以知道有多少水被用来冲厕所、洗碗池、淋浴等等。一天之内。</p><p id="05bc" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">流量计每秒记录一次流量。一长串随时间变化的值称为“时间序列”，这类问题称为“时间序列分类”。</p><p id="f469" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我使用的是一种叫做监督学习的机器学习，在这种学习中，你提出一种算法，它可以学习一些带标签的例子，然后它对以前从未见过的新数据进行分类。用于实验的训练数据是一小组手写标记的事件，每个事件有 1-4 个示例。我们手动识别了每种类型事件中的一些，很明显房子里的一些东西有不同的波形。早期的一系列训练活动如下所示:</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div class="gh gi kp"><img src="../Images/2230c817d03222c683bd9794739ac9ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/0*2Fux8i0FyRXl6rm_.PNG"/></div></figure><p id="b178" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">你可以看到事件很容易用肉眼区分。从左到右，这些是马桶冲水、淋浴、浴缸注水、水槽水流和一些电器运行的示例。</p><p id="5446" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">隐私问题</strong></p><p id="e1d8" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">当我在筛选我朋友的水流传感器的数据时，我被你能从某人家里的一个传感器推断出的东西震惊了。很简单，你可以看到有人在家。你可以看到房子的主人半夜起床，早上起床，睡觉的时候。人们洗不同的淋浴——观察几天后，你就能知道哪个淋浴属于哪个人。如果一个人离开了一天，也许是去旅行了，你也能看出来。厕所有一个标志，你不仅可以知道哪个冲了水，还可以知道是哪个。由于成年人通常不怎么洗澡，你可以通过对水流分类来推测谁有小孩。这让我想到我想把哪些传感器数据传输到云中，因为如果你有多个不同类型的传感器，我怀疑你可以非常准确地描述谁住在家里。</p><p id="90d4" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">尝试过的方法</strong></p><p id="9651" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">有两种对时间序列数据进行分类的基本方法。第一种是从时间序列中提取特征，如滚动平均值、最小值/最大值等。并将其呈现给学习算法进行分类。这就是使用 RandomForestClassifiers 和 XGBoost 进行学习算法的最初几次程序迭代的工作方式。后来的测试版本使用了一个名为 TSFresh 的特性提取库，从这个系列中提取了几百个特性。在文献中似乎没有关于最佳方法的共识。在尝试这种方法时，我用 TSFresh 特征提取和 XGBoost 得到了最好的结果。</p><p id="8dee" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">第二种方法是将时间序列数据直接呈现给学习算法。根据文献，公认的最佳方法是使用动态时间弯曲(DTW)的距离度量将时间序列切片呈现给 K-最近邻分类器，其中 K 设置为 1。KNN 非常简单，它只是将测试波形分类为与它最匹配的训练示例相同的类别。衡量匹配程度的标准是距离度量，DTW。</p><p id="45c9" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">KNN 与 DTW 的表现优于特征提取方法，虽然它更计算密集型。</p><p id="6374" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在尝试了这些方法之后，我偶然发现了一篇很棒的文章<a class="ae kx" href="https://www.mdpi.com/2073-4441/10/1/46" rel="noopener ugc nofollow" target="_blank">“基于软计算技术的水终端使用分解”</a>，它提供了特征提取方法的一种变体。如果您提取每个流量事件，并计算流量、持续时间和平均速率，您会得到一组三个值。如果你把它们用图表表示出来，你可以看到这些事件很好地聚集在一起。下面的 3D 图显示了一个例子:</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div class="gh gi kp"><img src="../Images/8fd68f68a037f3ebe5e23a4ab8450565.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/0*0dit5rrywIDyA94-.png"/></div></figure><p id="aee4" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">现在，您将每个流量事件总结为一组数字:平均流量、总流量和持续时间。这些可以输入到各种学习算法中。我得到的最好结果是通过用已识别的示例事件制作标记的训练数据，然后在其上训练 KNN 或 XGBoost 分类器来实现的。它的计算量非常小——它可以在不到一分钟的时间内对一天的数据进行分类，包括生成可视化效果。这是迄今为止最成功的方法。</p><p id="df46" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">可视化</strong></p><p id="83c7" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">Matplotlib 和 Seaborn 用于生成图形，每个流用颜色编码以显示分类。</p><p id="ab8e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">分类流量的样本图如下所示。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div class="gh gi kp"><img src="../Images/81a0369d4712f129eb67f403afecca6e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/0*vZ_Ls01bcYs6AuSJ.PNG"/></div></figure><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div class="gh gi kp"><img src="../Images/55bf18ef9d019a149f8b970671dc23e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/0*aRCx0T5NyVaU0R11.PNG"/></div></figure><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div class="gh gi kp"><img src="../Images/85f9a1854571eb4771cb8065e278f686.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/0*VSiSmXNWUhFO3DOp.PNG"/></div></figure><p id="8c55" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">分类性能</strong></p><p id="fa23" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">厕所、淋浴、水槽和浴缸填充通常被正确分类。很容易将这些事件相加，以了解每个事件在某一天使用了多少水。尽管有一些限制。在复杂的流程中，许多事情同时发生，这是很难验证的。该算法对流量进行分类，但我无法判断它做得有多好，因为我无法判断发生了什么。此外，一些设备流量实际上无法与水槽流量或马桶流量区分开来。作为示例，洗碗机的全流程如下所示。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div class="gh gi kp"><img src="../Images/b065ca66aa4cb8f4ca3027eb7e776647.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/0*YeUJG9XpRZ2cq1W-.PNG"/></div></figure><p id="9108" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">开始于样本 920 附近的波形很容易识别。然而，即使对人类来说，较大的尖峰看起来像厕所，较小的看起来像水槽。准确分类这些流量的唯一方法是注意它们出现在识别波形附近。将它们作为洗碗机流量包括在训练数据集中的努力导致高的假阳性率，将水槽流量误分类为洗碗机流量。这就是为什么水槽和设备流量被集中在一个分类下。</p><p id="724a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">关于图形颜色的注释</strong></p><p id="a32a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">Seaborn 的 Color Brewer 调色板工具文档指出，对于像这样的图，您可以区分类别，并且没有增加/减少值的含义，您需要“定性调色板”。这些都是为了易于区分类别而优化的。示例图使用了这些调色板中的一种，可读性比吸引力更好。</p><p id="23fc" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">完整的可用调色板列表可在 https://jiffyclub.github.io/palettable/colorbrewer/<a class="ae kx" href="https://jiffyclub.github.io/palettable/colorbrewer/" rel="noopener ugc nofollow" target="_blank">获得，自定义调色板很容易定义。</a></p></div></div>    
</body>
</html>