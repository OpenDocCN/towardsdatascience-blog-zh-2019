<html>
<head>
<title>Feature Extraction using Principal Component Analysis — A Simplified Visual Demo</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用主成分分析的特征提取——一个简化的可视化演示</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/feature-extraction-using-principal-component-analysis-a-simplified-visual-demo-e5592ced100a?source=collection_archive---------6-----------------------#2019-12-10">https://towardsdatascience.com/feature-extraction-using-principal-component-analysis-a-simplified-visual-demo-e5592ced100a?source=collection_archive---------6-----------------------#2019-12-10</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="6bdb" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">理解特征和主成分之间的转换</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/6ada6b5eb086a0d7da9a2b80238cba16.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KdvxqXIOkb9JY_BeUWvpxg.jpeg"/></div></div></figure><h1 id="dba4" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">介绍</h1><p id="c289" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">没有扎实的线性代数基础，理解主成分分析(PCA)背后的数学是一个挑战。当我在旧金山的 General Assembly 教授数据科学时，我发现帮助学生可视化特征和主成分之间的转换极大地增强了他们的理解。<strong class="ll ir"> PCA 是一种降维技术，它有四个主要部分:特征协方差、特征分解、主分量变换和根据解释的方差选择分量。</strong>这个博客的目的是分享一个视觉演示，这个演示是<strong class="ll ir">帮助学生理解最后两步</strong>。</p><h1 id="1d59" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">降维的快速回顾</h1><h2 id="c9ce" class="mf ks iq bd kt mg mh dn kx mi mj dp lb ls mk ml ld lw mm mn lf ma mo mp lh mq bi translated">维度的诅咒</h2><p id="4abf" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">为了理解 PCA，我们必须知道它的目的。为了理解这个目的，我们必须知道<a class="ae mr" href="https://en.wikipedia.org/wiki/Curse_of_dimensionality" rel="noopener ugc nofollow" target="_blank"> <strong class="ll ir">维数灾难</strong> </a>，这个方法解决的根本问题。虽然我们总是可以在维基百科上找到详尽的定义，但以下提供了更简单直观的解释:</p><blockquote class="ms mt mu"><p id="9350" class="lj lk mv ll b lm mw jr lo lp mx ju lr my mz lu lv na nb ly lz nc nd mc md me ij bi translated">随着要素或维度数量的增长，我们需要精确归纳的数据量也呈指数级增长</p><p id="214b" class="lj lk mv ll b lm mw jr lo lp mx ju lr my mz lu lv na nb ly lz nc nd mc md me ij bi translated">— Charles Isbell，佐治亚理工学院交互计算学院教授</p></blockquote><p id="2e4f" class="pw-post-body-paragraph lj lk iq ll b lm mw jr lo lp mx ju lr ls mz lu lv lw nb ly lz ma nd mc md me ij bi translated"><a class="ae mr" href="https://www.kdnuggets.com/2017/04/must-know-curse-dimensionality.html" rel="noopener ugc nofollow" target="_blank"> <em class="mv">维度的诅咒</em></a><em class="mv">—Prasad Pore 撰写的 KDNuggets 帖子。</em></p><p id="003d" class="pw-post-body-paragraph lj lk iq ll b lm mw jr lo lp mx ju lr ls mz lu lv lw nb ly lz ma nd mc md me ij bi translated">有两种方法可以降低维数:</p><ol class=""><li id="632f" class="ne nf iq ll b lm mw lp mx ls ng lw nh ma ni me nj nk nl nm bi translated">特征消除:我们直接去掉一些特征。</li><li id="c4fe" class="ne nf iq ll b lm nn lp no ls np lw nq ma nr me nj nk nl nm bi translated">特征提取:我们保留所有特征的重要部分。我们应用主成分分析来实现这一点。注意，PCA 不是进行特征提取的唯一方法。</li></ol><h2 id="46af" class="mf ks iq bd kt mg mh dn kx mi mj dp lb ls mk ml ld lw mm mn lf ma mo mp lh mq bi translated">主成分分析</h2><p id="6b68" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">PCA 是一种降维方法，即<strong class="ll ir">识别我们数据中的重要关系</strong>,<strong class="ll ir">根据这些关系转换现有数据</strong>，然后<strong class="ll ir">量化这些关系的重要性</strong>，这样我们就可以保留最重要的关系，丢弃其他关系。为了记住这个定义，我们可以把它分成四个步骤:</p><ol class=""><li id="e60a" class="ne nf iq ll b lm mw lp mx ls ng lw nh ma ni me nj nk nl nm bi translated">我们通过一个<a class="ae mr" href="https://en.wikipedia.org/wiki/Covariance_matrix" rel="noopener ugc nofollow" target="_blank"> <strong class="ll ir">协方差矩阵</strong> </a> <strong class="ll ir">来识别特征之间的关系。</strong></li><li id="d99e" class="ne nf iq ll b lm nn lp no ls np lw nq ma nr me nj nk nl nm bi translated">通过协方差矩阵的线性变换或<a class="ae mr" href="https://en.wikipedia.org/wiki/Eigendecomposition_of_a_matrix" rel="noopener ugc nofollow" target="_blank"> <strong class="ll ir">特征分解</strong> </a>，得到<a class="ae mr" href="https://en.wikipedia.org/wiki/Eigenvalues_and_eigenvectors" rel="noopener ugc nofollow" target="_blank"> <strong class="ll ir">特征向量</strong>和<strong class="ll ir">特征值</strong> </a>。</li><li id="bc4b" class="ne nf iq ll b lm nn lp no ls np lw nq ma nr me nj nk nl nm bi translated">然后，我们使用特征向量将数据转换成主分量。</li><li id="06f4" class="ne nf iq ll b lm nn lp no ls np lw nq ma nr me nj nk nl nm bi translated">最后，我们使用特征值量化这些关系的重要性，并保留重要的主成分<strong class="ll ir">。</strong></li></ol><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ns"><img src="../Images/681a9aa389ff17a08e9f431cf26f503a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LmD4gH0egCdRcNHhFsRJvQ.png"/></div></div><figcaption class="nt nu gj gh gi nv nw bd b be z dk">Figure 1</figcaption></figure><p id="a023" class="pw-post-body-paragraph lj lk iq ll b lm mw jr lo lp mx ju lr ls mz lu lv lw nb ly lz ma nd mc md me ij bi translated">同样，我们可以在维基百科上找到所有术语的完整解释。我发现下面的帖子更直观，也更有帮助。</p><ul class=""><li id="2a29" class="ne nf iq ll b lm mw lp mx ls ng lw nh ma ni me nx nk nl nm bi translated"><a class="ae mr" href="https://stats.stackexchange.com/q/140579" rel="noopener ugc nofollow" target="_blank">PCA</a>——由“阿米巴说恢复莫妮卡”(我觉得很好笑)发布的 Stackoverflow 回复。</li></ul><p id="be60" class="pw-post-body-paragraph lj lk iq ll b lm mw jr lo lp mx ju lr ls mz lu lv lw nb ly lz ma nd mc md me ij bi translated">一个<a class="ae mr" href="https://www.youtube.com/watch?v=PFDu9oVAE-g" rel="noopener ugc nofollow" target="_blank">伟大的可视化</a>由<a class="ae mr" href="https://www.3blue1brown.com/" rel="noopener ugc nofollow" target="_blank"> 3blue1brown </a>为<strong class="ll ir">步骤 2 </strong>发布(事实上，我强烈推荐他们的整个线性代数动画系列)。以下章节包括<strong class="ll ir">步骤 3 </strong>和<strong class="ll ir">步骤 4 </strong>的可视化。</p><h1 id="83fc" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">简化的视觉演示</h1><p id="e669" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">下面的演示使用虹膜数据库中单个数据点的特征向量来呈现特征和主成分之间的线性变换。我描述计算时没有使用任何线性代数术语。但是，如果您了解两个向量之间的点积(因为我们演示了单个数据点的转换)和矩阵乘法(当我们转换所有数据点时)，将会很有帮助。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ns"><img src="../Images/12a7b8d6b88d984805aade4e4db559ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MR32I0BRMWDOYClXOR6QGw.png"/></div></div><figcaption class="nt nu gj gh gi nv nw bd b be z dk">Figure 2</figcaption></figure><ol class=""><li id="991a" class="ne nf iq ll b lm mw lp mx ls ng lw nh ma ni me nj nk nl nm bi translated"><strong class="ll ir">特征</strong>:顶部蓝色横线表示。注意，x1、x2、x3 和 x4 代表单个虹膜的四个特征(即，萼片长度、萼片宽度、花瓣长度和花瓣宽度)，而不是四个不同的虹膜。</li><li id="b2cd" class="ne nf iq ll b lm nn lp no ls np lw nq ma nr me nj nk nl nm bi translated"><strong class="ll ir">特征向量</strong>:用绿色矩阵表示</li><li id="740a" class="ne nf iq ll b lm nn lp no ls np lw nq ma nr me nj nk nl nm bi translated"><strong class="ll ir">主成分</strong>:左侧橙色竖线表示</li></ol><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ns"><img src="../Images/a1db13c38719079c5a95626c7b584dc4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*c4Cu42xAll5cWyxKMWZPQw.png"/></div></div><figcaption class="nt nu gj gh gi nv nw bd b be z dk">Figure 3</figcaption></figure><p id="714c" class="pw-post-body-paragraph lj lk iq ll b lm mw jr lo lp mx ju lr ls mz lu lv lw nb ly lz ma nd mc md me ij bi translated">图 3 包括每个部分的值。学习和理解数学方法的最好方法之一是验证数字相加。从这里，我们将做一些简单的计算。</p><h2 id="fa0e" class="mf ks iq bd kt mg mh dn kx mi mj dp lb ls mk ml ld lw mm mn lf ma mo mp lh mq bi translated">步骤 3 的视觉演示</h2><ol class=""><li id="2d71" class="ne nf iq ll b lm ln lp lq ls ny lw nz ma oa me nj nk nl nm bi translated"><strong class="ll ir">将特征转换成主成分。</strong></li></ol><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ns"><img src="../Images/c83b76db9253ec010e66e3970d636cdf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KZxhvO1y56rUOU8rgs7G0Q.png"/></div></div><figcaption class="nt nu gj gh gi nv nw bd b be z dk">Figure 4</figcaption></figure><p id="2896" class="pw-post-body-paragraph lj lk iq ll b lm mw jr lo lp mx ju lr ls mz lu lv lw nb ly lz ma nd mc md me ij bi translated">为了将特征转换成主分量，我们将特征与特征向量逐个元素相乘，如上面的图 4 所示，并在水平方向上相加。</p><p id="d0e7" class="pw-post-body-paragraph lj lk iq ll b lm mw jr lo lp mx ju lr ls mz lu lv lw nb ly lz ma nd mc md me ij bi translated"><strong class="ll ir"> 2。将主成分转换回特征。</strong></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ns"><img src="../Images/469b388fe667889e210239a928da58ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JcJIZlttEWmYSknPCXGUkQ.png"/></div></div></figure><p id="1e8d" class="pw-post-body-paragraph lj lk iq ll b lm mw jr lo lp mx ju lr ls mz lu lv lw nb ly lz ma nd mc md me ij bi translated">当然，通过执行上面图 5 所示的计算，您可以将主成分转换回原始特征。</p><h2 id="657b" class="mf ks iq bd kt mg mh dn kx mi mj dp lb ls mk ml ld lw mm mn lf ma mo mp lh mq bi translated">步骤 4 的视觉演示</h2><p id="741d" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">在可视化了变换背后的数学之后，让我们演示一下特征消除和特征提取之间的区别。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ns"><img src="../Images/4f36c1b0b2919269954d1ab6d10c7f22.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SIfhs-zMVbD-i70viwtI4A.png"/></div></div><figcaption class="nt nu gj gh gi nv nw bd b be z dk">Figure 6</figcaption></figure><p id="a23f" class="pw-post-body-paragraph lj lk iq ll b lm mw jr lo lp mx ju lr ls mz lu lv lw nb ly lz ma nd mc md me ij bi translated">如上面的图 6 所示，如果我们选择通过特征消除来降低维数，我们将完全删除一些特征，在本例中是 x3 和 x4。当我们将维度从 4 减少到 2 时，由花瓣长度和花瓣宽度提供的所有信息都丢失了。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ns"><img src="../Images/eaed50c106bfa67f9fc1790b5e6b907a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4dGi0pjOJLdqGTT2RT4GDg.png"/></div></div><figcaption class="nt nu gj gh gi nv nw bd b be z dk">Figure 7</figcaption></figure><p id="a3bc" class="pw-post-body-paragraph lj lk iq ll b lm mw jr lo lp mx ju lr ls mz lu lv lw nb ly lz ma nd mc md me ij bi translated">相比之下，当我们通过 PCA 等特征提取方法降低维数时，我们通过选择解释特征之间大多数关系的主成分来保留最重要的信息。这就是特征值发挥作用的地方，它帮助我们了解每个主成分包含多少信息。</p><p id="5f9f" class="pw-post-body-paragraph lj lk iq ll b lm mw jr lo lp mx ju lr ls mz lu lv lw nb ly lz ma nd mc md me ij bi translated">在我们的例子中，基于与每个特征向量相关的归一化特征值，第一和第二主成分(即 pc1 和 pc2)解释了特征变化的 95%以上，如下图 8 所示。因此，我们只保留 pc1 和 pc2。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ob"><img src="../Images/9c0b27580c96dbe3bc34615fc0f4d455.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zCBDFtXsdye84CtEQhyDww.png"/></div></div><figcaption class="nt nu gj gh gi nv nw bd b be z dk"><strong class="bd oc">Lambda is the eigenvalue</strong></figcaption></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi od"><img src="../Images/50aee515e6209381c5f1e03bd4eed67c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Qlv6JGznKsKn4RnDDoqCWQ.png"/></div></div><figcaption class="nt nu gj gh gi nv nw bd b be z dk">Figure 8</figcaption></figure><p id="daa4" class="pw-post-body-paragraph lj lk iq ll b lm mw jr lo lp mx ju lr ls mz lu lv lw nb ly lz ma nd mc md me ij bi translated">注意，每个主成分包含来自所有四个特征的信息。通过只保留 pc1 和 pc2，我们从所有四个特征中提取最重要的信息，并将维数从 4 降低到 2。</p><h1 id="ae3a" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">评论</h1><p id="2cc7" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">我想用几句话来结束我的博客，包括 PCA 的使用，PCA 的利弊，以及何时不使用 PCA。</p><p id="2d76" class="pw-post-body-paragraph lj lk iq ll b lm mw jr lo lp mx ju lr ls mz lu lv lw nb ly lz ma nd mc md me ij bi translated"><strong class="ll ir">数据清理很重要</strong></p><ul class=""><li id="46ee" class="ne nf iq ll b lm mw lp mx ls ng lw nh ma ni me nx nk nl nm bi translated">PCA 对异常值和缺失值很敏感。</li></ul><p id="0fbc" class="pw-post-body-paragraph lj lk iq ll b lm mw jr lo lp mx ju lr ls mz lu lv lw nb ly lz ma nd mc md me ij bi translated"><strong class="ll ir">标准化数据</strong></p><ul class=""><li id="e21d" class="ne nf iq ll b lm mw lp mx ls ng lw nh ma ni me nx nk nl nm bi translated">PCA 使用欧几里德距离作为其特征向量相似性度量，因此确保我们在应用 PCA 之前缩放特征。</li><li id="8734" class="ne nf iq ll b lm nn lp no ls np lw nq ma nr me nx nk nl nm bi translated">如果我们在模型中使用 GridSearchCV，确保我们将 PCA 放在管道中。在运行 GridSearch 之前拟合和转换训练数据会导致 GridSearch 内部交叉验证期间的数据泄漏。详见我上一篇博文。</li></ul><p id="b653" class="pw-post-body-paragraph lj lk iq ll b lm mw jr lo lp mx ju lr ls mz lu lv lw nb ly lz ma nd mc md me ij bi translated"><strong class="ll ir">优点</strong></p><ul class=""><li id="fd3e" class="ne nf iq ll b lm mw lp mx ls ng lw nh ma ni me nx nk nl nm bi translated">PCA 在不丢失任何特征信息的情况下降低了维数。</li><li id="b87e" class="ne nf iq ll b lm nn lp no ls np lw nq ma nr me nx nk nl nm bi translated">减少存储数据所需的存储空间</li><li id="c3ea" class="ne nf iq ll b lm nn lp no ls np lw nq ma nr me nx nk nl nm bi translated">加速学习算法(用更低的维度)。</li><li id="9855" class="ne nf iq ll b lm nn lp no ls np lw nq ma nr me nx nk nl nm bi translated">解决多重共线性问题(所有主成分相互正交)。</li><li id="6cb5" class="ne nf iq ll b lm nn lp no ls np lw nq ma nr me nx nk nl nm bi translated">帮助可视化高维数据(在将维度减少到 2 或 3 之后)。</li></ul><p id="cc44" class="pw-post-body-paragraph lj lk iq ll b lm mw jr lo lp mx ju lr ls mz lu lv lw nb ly lz ma nd mc md me ij bi translated"><strong class="ll ir">缺点</strong></p><ul class=""><li id="4ea4" class="ne nf iq ll b lm mw lp mx ls ng lw nh ma ni me nx nk nl nm bi translated">使用主成分分析可以防止对原始特征的解释，以及它们的影响，因为特征向量是没有意义的。</li></ul><p id="f7a0" class="pw-post-body-paragraph lj lk iq ll b lm mw jr lo lp mx ju lr ls mz lu lv lw nb ly lz ma nd mc md me ij bi translated"><strong class="ll ir">五氯苯甲醚的潜在使用案例(非详尽清单)</strong></p><ul class=""><li id="b333" class="ne nf iq ll b lm mw lp mx ls ng lw nh ma ni me nx nk nl nm bi translated">我们有许多具有高度多重共线性的要素。</li><li id="3d38" class="ne nf iq ll b lm nn lp no ls np lw nq ma nr me nx nk nl nm bi translated">我们有太多的功能导致算法运行非常缓慢。</li></ul><p id="d873" class="pw-post-body-paragraph lj lk iq ll b lm mw jr lo lp mx ju lr ls mz lu lv lw nb ly lz ma nd mc md me ij bi translated"><strong class="ll ir">滥用五氯苯甲醚(并非详尽清单)</strong></p><ul class=""><li id="c9fb" class="ne nf iq ll b lm mw lp mx ls ng lw nh ma ni me nx nk nl nm bi translated">我们不应该使用 PCA 来降低维数，以防止过度拟合。我们应该使用正则化(如 L1 和 L2)来代替。</li><li id="7aff" class="ne nf iq ll b lm nn lp no ls np lw nq ma nr me nx nk nl nm bi translated">在用原始数据运行机器学习模型之前，我们不应该盲目地应用 PCA。如果使用原始数据效果不好，我们应该考虑 PCA 作为替代方法。</li></ul><h1 id="d99a" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">资源和信用</h1><ul class=""><li id="9293" class="ne nf iq ll b lm ln lp lq ls ny lw nz ma oa me nx nk nl nm bi translated">为了进一步研究 PCA，我推荐了 Coursera 上的斯坦福大学吴恩达教授的机器学习课程(第 8 周)。【https://www.coursera.org/learn/machine-learning? T2】号</li><li id="3889" class="ne nf iq ll b lm nn lp no ls np lw nq ma nr me nx nk nl nm bi translated">我还引用了大会全球讲师 Matt Brems 为他的学生准备的材料。他还写了一篇关于 PCA 细节的博文。<a class="ae mr" rel="noopener" target="_blank" href="/a-one-stop-shop-for-principal-component-analysis-5582fb7e0a9c">https://towards data science . com/a-一站式主成分分析-5582fb7e0a9c </a></li></ul></div></div>    
</body>
</html>