<html>
<head>
<title>Build a Multi Digit Detector with Keras and OpenCV</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用 Keras 和 OpenCV 构建多位数检测器</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/build-a-multi-digit-detector-with-keras-and-opencv-b97e3cd3b37?source=collection_archive---------2-----------------------#2019-04-11">https://towardsdatascience.com/build-a-multi-digit-detector-with-keras-and-opencv-b97e3cd3b37?source=collection_archive---------2-----------------------#2019-04-11</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="ec42" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">用数据做很酷的事情！</h2></div><h1 id="fc25" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">介绍</h1><p id="1778" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">数字在我们身边无处不在。无论是闹钟、健身追踪器还是条形码，甚至是亚马逊精心包装的快递包裹，数字无处不在。通过<a class="ae lw" href="http://yann.lecun.com/exdb/mnist/" rel="noopener ugc nofollow" target="_blank"> MNIST </a>数据集，机器学习被用来读取单个手写数字。现在我们可以扩展到读取多个数字，如下所示。底层神经网络既进行手指定位又进行手指检测。这在各种 ML 应用中非常有用，比如读取商店中的标签、车牌、广告等。</p><figure class="ly lz ma mb gt mc gh gi paragraph-image"><div class="gh gi lx"><img src="../Images/abf617df33354d9197ed768aaf337815.png" data-original-src="https://miro.medium.com/v2/resize:fit:1146/format:webp/1*8FCJls4G4rOgRu0hqu-fiQ.png"/></div><figcaption class="mf mg gj gh gi mh mi bd b be z dk">Reading multiple digits</figcaption></figure><p id="fdbf" class="pw-post-body-paragraph la lb it lc b ld mj ju lf lg mk jx li lj ml ll lm ln mm lp lq lr mn lt lu lv im bi translated">但是为什么不仅仅使用 OCR 呢？是的，OCR 可以是自动检测数字的一个很好的起点，但 OCR 并不总是有效，有时我们需要为我们的特定任务训练一个神经网络。</p><h1 id="65be" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated"><strong class="ak">数字检测流水线</strong></h1><p id="ce80" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">数字检测问题可以分为两个部分</p><ol class=""><li id="d3fb" class="mo mp it lc b ld mj lg mk lj mq ln mr lr ms lv mt mu mv mw bi translated">数字本地化</li><li id="99be" class="mo mp it lc b ld mx lg my lj mz ln na lr nb lv mt mu mv mw bi translated">数字识别</li></ol><p id="6fd1" class="pw-post-body-paragraph la lb it lc b ld mj ju lf lg mk jx li lj ml ll lm ln mm lp lq lr mn lt lu lv im bi translated"><strong class="lc iu">数字本地化:</strong></p><p id="b677" class="pw-post-body-paragraph la lb it lc b ld mj ju lf lg mk jx li lj ml ll lm ln mm lp lq lr mn lt lu lv im bi translated">图像可以在任何位置包含数字，对于要检测的数字，我们需要首先找到包含这些数字的区域。数字可以有不同的大小和背景。</p><p id="9a42" class="pw-post-body-paragraph la lb it lc b ld mj ju lf lg mk jx li lj ml ll lm ln mm lp lq lr mn lt lu lv im bi translated">有多种方法可以检测手指的位置。我们可以利用简单的图像形态学操作，如二值化、腐蚀、膨胀来提取图像中的数字区域。然而，由于阈值、内核大小等调整参数的存在，这些可能变得对图像过于具体。我们还可以使用复杂的无监督特征检测器、深度模型等。</p><p id="4191" class="pw-post-body-paragraph la lb it lc b ld mj ju lf lg mk jx li lj ml ll lm ln mm lp lq lr mn lt lu lv im bi translated"><strong class="lc iu">数字识别:</strong></p><p id="7370" class="pw-post-body-paragraph la lb it lc b ld mj ju lf lg mk jx li lj ml ll lm ln mm lp lq lr mn lt lu lv im bi translated">定位的手指区域用作手指识别过程的输入。<a class="ae lw" href="http://yann.lecun.com/exdb/mnist/" rel="noopener ugc nofollow" target="_blank"> <strong class="lc iu"> MNIST </strong>数据集</a>是手写数字识别的规范数据集。大多数数据科学家都用这个数据集做过实验。它包含大约 60，000 个用于训练的手写数字和 10，000 个用于测试的数字。一些例子看起来像:</p><figure class="ly lz ma mb gt mc gh gi paragraph-image"><div class="gh gi nc"><img src="../Images/77c0efaba273306f0bee42feeab9cc71.png" data-original-src="https://miro.medium.com/v2/resize:fit:518/0*ZVycdGwUc3Gy55q-"/></div><figcaption class="mf mg gj gh gi mh mi bd b be z dk">MNIST Images</figcaption></figure><p id="3eaf" class="pw-post-body-paragraph la lb it lc b ld mj ju lf lg mk jx li lj ml ll lm ln mm lp lq lr mn lt lu lv im bi translated">然而，现实生活场景中的数字通常非常不同。它们有不同的颜色，通常像下面的箱子一样印刷。</p><figure class="ly lz ma mb gt mc gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/968d2be00ea17865b8753dcd6bcc1968.png" data-original-src="https://miro.medium.com/v2/resize:fit:580/0*y5wmc1hsDNQovUns"/></div></figure><figure class="ly lz ma mb gt mc gh gi paragraph-image"><div role="button" tabindex="0" class="nf ng di nh bf ni"><div class="gh gi ne"><img src="../Images/201d1123ed9933acb19229d88a07dfef.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/0*G6p7xmKnOhIG5_FB"/></div></div><figcaption class="mf mg gj gh gi mh mi bd b be z dk">Day to day digit images</figcaption></figure><p id="c879" class="pw-post-body-paragraph la lb it lc b ld mj ju lf lg mk jx li lj ml ll lm ln mm lp lq lr mn lt lu lv im bi translated">稍加研究，我们就可以看到另一个公共数据集<a class="ae lw" href="http://ufldl.stanford.edu/housenumbers/" rel="noopener ugc nofollow" target="_blank"><strong class="lc iu">SVHN——街景门牌号数据集</strong> </a>。该数据集由从谷歌街景中收集的门牌号图像组成，并附有注释。下面是来自 SVHN 的示例图像:</p><figure class="ly lz ma mb gt mc gh gi paragraph-image"><div role="button" tabindex="0" class="nf ng di nh bf ni"><div class="gh gi nj"><img src="../Images/4788e8bbc090b67298cbe98191c962df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ehemLS_SMyvDBzVc"/></div></div><figcaption class="mf mg gj gh gi mh mi bd b be z dk">SVHN Images</figcaption></figure><p id="6f77" class="pw-post-body-paragraph la lb it lc b ld mj ju lf lg mk jx li lj ml ll lm ln mm lp lq lr mn lt lu lv im bi translated">该数据集具有针对许多背景的各种数字组合，并且将更好地用于通用模型。</p><h1 id="d61a" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated"><strong class="ak">在 Keras 中建模</strong></h1><p id="2030" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">我们选择这个<a class="ae lw" href="https://github.com/penny4860/SVHN-deep-digit-detector" rel="noopener ugc nofollow" target="_blank"> repo </a>来实现多位数检测器。它写得很好，容易理解。</p><p id="cf66" class="pw-post-body-paragraph la lb it lc b ld mj ju lf lg mk jx li lj ml ll lm ln mm lp lq lr mn lt lu lv im bi translated">使用作为稳定特征检测器的<strong class="lc iu">最大稳定极值区域(MSER) </strong>方法进行手指定位。MSER 主要用于图像中的斑点检测。斑点是像素的连续集合，其外部边界像素强度比内部边界像素强度高(给定阈值)。如果这些区域在变化的强度范围内没有太大的变化，那么这些区域被认为是最稳定的。MSER 的运行时复杂度较低，为 O(nlog(log(n)))，其中 n 是图像上的像素总数。该算法对模糊和缩放也是鲁棒的。这使得它成为提取文本/数字的良好候选。想了解更多关于 MSER 的信息，请点击<a class="ae lw" href="https://www.toptal.com/machine-learning/real-time-object-detection-using-mser-in-ios" rel="noopener ugc nofollow" target="_blank">链接</a>。</p><p id="439f" class="pw-post-body-paragraph la lb it lc b ld mj ju lf lg mk jx li lj ml ll lm ln mm lp lq lr mn lt lu lv im bi translated">使用具有卷积、最大池和 FC 层的 CNN 来完成数字识别，这些层将每个检测到的区域分类成 10 个不同的数字。该分类器在测试集上达到 95%的准确率。</p><p id="175b" class="pw-post-body-paragraph la lb it lc b ld mj ju lf lg mk jx li lj ml ll lm ln mm lp lq lr mn lt lu lv im bi translated">我们在各种例子上测试了回购，发现它运行得相当好。见上面分享的例子。</p><p id="83e4" class="pw-post-body-paragraph la lb it lc b ld mj ju lf lg mk jx li lj ml ll lm ln mm lp lq lr mn lt lu lv im bi translated">有一些差距，要么是定位器没有完美地工作(没有检测到数字 1 的位置)，要么是检测器失败了(检测为 5)。</p><figure class="ly lz ma mb gt mc gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/ce0806fe195046925917a3626690a7d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:766/format:webp/1*9CMVuyPp-GJl6_8GYLIM5A.png"/></div></figure><h1 id="1c07" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated"><strong class="ak">结论</strong></h1><p id="3652" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">我们希望这篇博客能成为理解多位数检测管道如何工作的良好起点。我们分享了一个很好的 github 链接，可以用来在 SVHN 数据集上建立模型。如果这种模式效果不好。你可以收集自己的数据，对训练好的模型进行微调。</p><p id="0614" class="pw-post-body-paragraph la lb it lc b ld mj ju lf lg mk jx li lj ml ll lm ln mm lp lq lr mn lt lu lv im bi translated">我有自己的深度学习咨询公司，喜欢研究有趣的问题。我已经帮助许多初创公司部署了基于人工智能的创新解决方案。请到 http://deeplearninganalytics.org/<a class="ae lw" href="http://deeplearninganalytics.org/" rel="noopener ugc nofollow" target="_blank">来看看我们。如果你有一个我们可以合作的项目，那么请通过我的网站或在<strong class="lc iu">info@deeplearninganalytics.org</strong>联系我</a></p><p id="9712" class="pw-post-body-paragraph la lb it lc b ld mj ju lf lg mk jx li lj ml ll lm ln mm lp lq lr mn lt lu lv im bi translated">你也可以在<a class="ae lw" href="https://medium.com/@priya.dwivedi" rel="noopener">https://medium.com/@priya.dwivedi</a>看到我的其他作品</p><p id="3185" class="pw-post-body-paragraph la lb it lc b ld mj ju lf lg mk jx li lj ml ll lm ln mm lp lq lr mn lt lu lv im bi translated"><strong class="lc iu">参考文献:</strong></p><ul class=""><li id="7e76" class="mo mp it lc b ld mj lg mk lj mq ln mr lr ms lv nl mu mv mw bi translated"><a class="ae lw" href="http://ufldl.stanford.edu/housenumbers/" rel="noopener ugc nofollow" target="_blank"> SVHN 数据集</a></li><li id="33c2" class="mo mp it lc b ld mx lg my lj mz ln na lr nb lv nl mu mv mw bi translated"><a class="ae lw" href="https://en.wikipedia.org/wiki/Maximally_stable_extremal_regions" rel="noopener ugc nofollow" target="_blank">了解 MSER </a></li><li id="c5c5" class="mo mp it lc b ld mx lg my lj mz ln na lr nb lv nl mu mv mw bi translated"><a class="ae lw" href="https://github.com/penny4860/SVHN-deep-digit-detector" rel="noopener ugc nofollow" target="_blank">多位检测器代码</a></li></ul></div></div>    
</body>
</html>