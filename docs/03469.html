<html>
<head>
<title>MCMC Intuition for Everyone</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">每个人的直觉</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/mcmc-intuition-for-everyone-5ae79fff22b1?source=collection_archive---------1-----------------------#2019-06-03">https://towardsdatascience.com/mcmc-intuition-for-everyone-5ae79fff22b1?source=collection_archive---------1-----------------------#2019-06-03</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="912e" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">容易吗？我试过了。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/88e30747c97fecf44a3333f7a57101ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QhNsD7ihyJCYADRvT8AywA.png"/></div></div></figure><p id="68e5" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们都曾听说过蒙特卡洛马尔可夫链。有时在阅读贝叶斯统计时。有时在使用像 Prophet 这样的工具时。</p><p id="9645" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">但是 MCMC 很难理解。每当我读到它，我都注意到症结通常隐藏在数学噪音的深层，不容易破译。</p><p id="4609" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我不得不花很多时间去理解这个概念。</p><p id="0aee" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><strong class="kw iu"> <em class="lq">这篇博客旨在简单地解释</em></strong><a class="ae lr" href="https://amzn.to/2SxJurV" rel="noopener ugc nofollow" target="_blank"><strong class="kw iu"><em class="lq">MCMC</em></strong></a><strong class="kw iu"><em class="lq">方法，并知道它们的用处。</em></strong>我将在我的下一篇<a class="ae lr" rel="noopener" target="_blank" href="/applications-of-mcmc-for-cryptography-and-optimization-1f99222b7132">文章</a>中深入探讨更多的应用。</p><p id="ae56" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">所以让我们开始吧。</p></div><div class="ab cl ls lt hx lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="im in io ip iq"><p id="8949" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">MCMC 由两项组成<strong class="kw iu"> <em class="lq">蒙特卡罗</em> </strong>和<strong class="kw iu"> <em class="lq">马尔可夫链</em> </strong>。让我们一个一个地谈论个别术语。</p><h1 id="49ca" class="lz ma it bd mb mc md me mf mg mh mi mj jz mk ka ml kc mm kd mn kf mo kg mp mq bi translated">蒙特卡洛？</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mr"><img src="../Images/344a11730f31206188c0f82f7c0d352a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*NQggCgCcJ6eVhQld"/></div></div><figcaption class="ms mt gj gh gi mu mv bd b be z dk">Simulation</figcaption></figure><p id="bf89" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">简单来说，我们可以把蒙特卡罗方法看作简单的模拟。</p><p id="655d" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><a class="ae lr" href="https://en.wikipedia.org/wiki/Monte_Carlo_method" rel="noopener ugc nofollow" target="_blank"> <strong class="kw iu">蒙特卡洛</strong> </a>方法得名于摩纳哥的蒙特卡洛赌场。许多纸牌游戏需要赢庄家的概率。</p><p id="211e" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">有时候，计算这种概率可能在数学上很复杂或者非常棘手。但是我们总是可以运行一个计算机模拟来多次模拟整个游戏，并且将概率视为赢的数目除以玩的游戏数目。</p><p id="d1f4" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这就是你需要知道的蒙特卡罗方法。</p><p id="542b" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><strong class="kw iu"> <em class="lq">没错，只是一种简单的模拟技术，名字很花哨。</em> </strong></p><h1 id="de84" class="lz ma it bd mb mc md me mf mg mh mi mj jz mk ka ml kc mm kd mn kf mo kg mp mq bi translated">马尔可夫链？</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mw"><img src="../Images/0c26431eafddec9bd0f79fe1b6a2a56d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*xqr7ifek9BjrIJRK"/></div></div></figure><p id="836e" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">那么既然我们已经得到了 MCMC 的第一部分，我们还需要了解什么是<a class="ae lr" href="https://en.wikipedia.org/wiki/Markov_chain" rel="noopener ugc nofollow" target="_blank"> <strong class="kw iu"> <em class="lq">马尔可夫链</em> </strong> </a>。但是，在跳到马尔可夫链之前，让我们先了解一点关于<strong class="kw iu">马尔可夫性质</strong>的知识。</p><p id="8ea6" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">假设你有一个 M 个可能状态的系统，你从一个状态跳到另一个状态。</p><p id="bdda" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">先不要迷茫。系统的一个具体例子是天气从热到冷再到温和状态的变化。或者另一个系统可能是股票市场，它从熊市跳到牛市，再跳到停滞状态。</p><p id="8d10" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><em class="lq">马尔可夫性质</em>表示，给定一个在特定时间点处于状态<code class="fe mx my mz na b">Xn</code>的过程，概率<code class="fe mx my mz na b">Xn+1</code> =k，其中 k 是该过程可以跳转到的 M 个状态中的任何一个，将仅取决于它在给定时刻处于哪个状态。而不是它是如何达到当前状态的。</p><p id="ba67" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">从数学角度来说:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nb"><img src="../Images/5c596b46a0081bce537616113401c68a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tC95KJUr4OvQKZcNKvF40g.png"/></div></div></figure><p id="4841" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">直觉上，你不关心市场到达牛市的状态顺序。下一个状态是“熊”状态的概率仅仅由市场当前处于“牛”状态的事实决定。</p><p id="5b43" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">从实际情况来看，这也是有道理的。</p><p id="6a5e" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">如果一个过程表现出马尔可夫性质，那么它被称为马尔可夫过程。</p><p id="10ff" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">为什么马尔可夫链很重要？</p><p id="bf5c" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">重要的是因为它的<strong class="kw iu">静止</strong> <a class="ae lr" href="https://amzn.to/32AORLH" rel="noopener ugc nofollow" target="_blank"> <strong class="kw iu">分布</strong> </a>。</p><p id="5fc7" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">那么什么是<strong class="kw iu">平稳分布</strong></p><p id="7ad6" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在下面的例子中，我将通过实际计算来解释平稳分布。假设你有一个股票市场的马尔可夫过程，如下所示。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nc"><img src="../Images/5768e06aef6031803f51fe5633d87c4a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*T-uG0008MaQfklAeOA7gZA.png"/></div></div></figure><p id="5258" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">你有一个转移概率矩阵</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/b5942bc773af751f581c52ffaff68f7d.png" data-original-src="https://miro.medium.com/v2/resize:fit:756/format:webp/1*EedW8ikUW88GeFBfQay4LQ.png"/></div><figcaption class="ms mt gj gh gi mu mv bd b be z dk">transition Probabilities, Q</figcaption></figure><p id="7156" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><strong class="kw iu"> <em class="lq">定义了从 Xi 状态到 Xj 状态的概率。在上面的转移矩阵 Q 中，</em> </strong></p><p id="af70" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">给定当前状态，下一个状态为“牛市”的概率为“牛市”=0.9</p><p id="7abb" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">给定当前状态，下一个状态将是“熊”的概率是“牛”=0.075</p><p id="4d73" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">诸如此类。</p><p id="5e3d" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">现在，我们从一个特定的状态开始。让我们从熊市开始。我们可以用向量的形式把自己的状态定义为【牛、熊、停滞】。所以我们的起始状态是[0，1，0]</p><p id="9b5a" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们可以通过将当前状态向量乘以转移矩阵来计算下一个状态的概率分布。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/276f16d5d23dc6164d1e7a66b0dc07ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1088/format:webp/1*3h3VFyMs90AD6ovfUmHa6A.png"/></div></figure><p id="419f" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><strong class="kw iu">看看概率加起来是怎样的 1。</strong>下一个状态分布可以由下式求出</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/d034aa01dfacfb4a997c4dc7c3efab9e.png" data-original-src="https://miro.medium.com/v2/resize:fit:504/format:webp/1*4PPaSmKnI712nf6Z-BoWEw.png"/></div></figure><p id="2a82" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">诸如此类。最终，你会到达一个稳定状态 s，在那里我们会收敛:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/a61a3f8fed97776a06ba751bb815e238.png" data-original-src="https://miro.medium.com/v2/resize:fit:324/format:webp/1*Hq-9lyRrafpzxqRHcAZnIg.png"/></div></figure><p id="e13a" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">对于上述转移矩阵 Q，平稳分布 s 是:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nh"><img src="../Images/eef488c6fdadf9cb94ff43266689e0a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1052/format:webp/1*gAOpVCXbHZdzv6ogMgzGBw.png"/></div></figure><p id="0b10" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">您可以通过编程获得静态分布，如下所示:</p><pre class="kj kk kl km gt ni na nj nk aw nl bi"><span id="3d96" class="nm ma it na b gy nn no l np nq">Q = np.matrix([[0.9,0.075,0.025],[0.15,0.8,0.05],[0.25,0.25,0.5]])<br/>init_s = np.matrix([[0, 1 , 0]])<br/>epsilon =1<br/>while epsilon&gt;10e-9:<br/>    next_s = np.dot(init_s,Q)<br/>    epsilon = np.sqrt(np.sum(np.square(next_s - init_s)))<br/>    init_s = next_s</span><span id="e902" class="nm ma it na b gy nr no l np nq">print(init_s)<br/>------------------------------------------------------------------<br/>matrix([[0.62499998, 0.31250002, 0.0625    ]])</span></pre><p id="2ee6" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><strong class="kw iu"> <em class="lq">你也可以从任何其他状态开始；你会达到同样的平稳分布。</em> </strong>改变代码中的初始状态，如果你想看的话。</p><p id="9d0b" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">现在我们可以回答这个问题了- <strong class="kw iu"> <em class="lq">为什么平稳分布很重要？</em>T25】</strong></p><p id="0e10" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">稳态分布很重要，因为它可以让你定义一个系统在随机时间的每个状态的概率。T29】</p><p id="4960" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">对于这个特定的例子，你可以说 62.5%的时间市场将处于牛市状态，31.25%的时间将处于熊市，6.25%的时间将处于停滞状态。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ns"><img src="../Images/457242adeec88ae376617026a717cff0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Unv4XoecveAKGI2W"/></div></div><figcaption class="ms mt gj gh gi mu mv bd b be z dk">Random Walk</figcaption></figure><p id="d770" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">直觉上，你可以把它想象成一个链条上的随机行走。<strong class="kw iu"> <em class="lq">你处于一个状态，你在给定当前状态的情况下，通过看到下一个状态的概率分布来决定下一个状态。</em> </strong>根据节点概率，我们可能会比其他节点更频繁地访问一些节点。</p><p id="cdff" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这就是谷歌在早期互联网时代解决搜索问题的方式。问题是根据页面重要性对页面进行排序。谷歌用 Pagerank 算法解决了。</p><p id="d408" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在<em class="lq"> Google Pagerank </em>算法中，你可能认为一个州是一个页面，而一个页面在稳定分布中的概率是它的相对重要性。</p><p id="c3c1" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><strong class="kw iu"> <em class="lq"> Woah！这是很多信息，我们还没有开始讨论 MCMC 方法。如果你现在还和我在一起，我们现在可以进入正题了。</em></strong></p><h1 id="c8e5" class="lz ma it bd mb mc md me mf mg mh mi mj jz mk ka ml kc mm kd mn kf mo kg mp mq bi translated">那么什么是蒙特卡罗马尔可夫链(MCMC)？</h1><p id="ff0f" class="pw-post-body-paragraph ku kv it kw b kx nt ju kz la nu jx lc ld nv lf lg lh nw lj lk ll nx ln lo lp im bi translated">在回答这个关于 MCMC 的问题之前，我先问一个问题。我们都知道贝塔分布。我们知道它的 pdf 函数。但是我们能从这个分布中抽取一个样本吗？你能想出一个办法吗？</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ny"><img src="../Images/e51e8a7b02c78b83b0eda7cb429c400e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*dXTCfXdOoLowme8s"/></div></div><figcaption class="ms mt gj gh gi mu mv bd b be z dk">Think….</figcaption></figure><p id="98a9" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><strong class="kw iu"> <em class="lq"> MCMC 为我们提供了从任意概率分布中抽样的方法。当我们想从后验分布中取样时，这是最需要的。</em>T13】</strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nz"><img src="../Images/bda531b856c810f0dc4a002cfef1d5db.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*TCXuUhI24JQJfRUd.png"/></div></div></figure><p id="e4a1" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">以上是贝叶斯定理。有时我们需要从后面取样。但是计算后验概率和归一化常数(也称为证据)容易吗？在大多数情况下，我们能够找到<em class="lq">可能性 x 先验的函数形式。</em></p><p id="d8f5" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">但是我们无法计算证据(p(D))。为什么？</p><p id="419d" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">让我们扩大证据。</p><p id="7271" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">如果 H 只取 3 个值:</p><p id="fd43" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">p(D) = p(H=H1)。p(D|H=H1) + p(H=H2)。p(D|H=H2) + p(H=H3)。H3</p><p id="09e4" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">P(D)很容易计算。如果 H 的值是连续的呢？能不能像现在这样简单地写出来，H 可以取无穷大的值？这将是一个很难解决的积分。</p><p id="8213" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们想从后面取样，但我们想把 p(D)当作一个常数。</p><p id="1bee" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">根据<a class="ae lr" href="https://en.wikipedia.org/wiki/Markov_chain_Monte_Carlo" rel="noopener ugc nofollow" target="_blank"> <strong class="kw iu">维基百科</strong> </a>:</p><blockquote class="oa ob oc"><p id="5ec0" class="ku kv lq kw b kx ky ju kz la lb jx lc od le lf lg oe li lj lk of lm ln lo lp im bi translated"><strong class="kw iu">马尔可夫链蒙特卡罗</strong> <em class="it"> (MCMC)方法是一类基于构建以期望分布为其平稳分布的马尔可夫链，从概率分布 <em class="it">中进行</em> <strong class="kw iu">采样的算法。在许多步骤之后，链的状态被用作期望分布的样本。样品的质量随着步骤数的增加而提高。</strong></em></p></blockquote><p id="5889" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">所以让我们用一个例子来解释这一点:</p><p id="2453" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">假设<strong class="kw iu">我们要从</strong> <a class="ae lr" href="https://en.wikipedia.org/wiki/Beta_distribution" rel="noopener ugc nofollow" target="_blank"> <strong class="kw iu">贝塔分布</strong> </a>中抽取样本。测试版的<em class="lq"> PDF 为:</em></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi og"><img src="../Images/2b5692b810851f72dc0d295c4803da2b.png" data-original-src="https://miro.medium.com/v2/resize:fit:888/format:webp/1*MPxR7d4ceSjH6Nr_4ZVdXQ.png"/></div></figure><p id="6e94" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">其中 C 是归一化常数。它实际上是α和β的一些函数，但我想说明我们并不真的需要它来从β分布中采样，所以我把它当作一个常数。</p><p id="163f" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">对于 Beta 版来说，这是一个有点棘手的问题。</p><p id="7598" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">实际上，你可能需要处理更难的分布函数，有时你不知道归一化常数。</p><p id="39c2" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">MCMC 方法让我们的生活变得更容易，因为它为我们提供了可以创建马尔可夫链的算法，该马尔可夫链将 Beta 分布作为其<strong class="kw iu">平稳分布</strong>，因为我们可以从均匀分布中采样(这相对容易)。</p><p id="9a0c" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">如果我们从一个随机状态开始，并基于某种算法反复遍历下一个状态，我们将最终创建一个马尔可夫链，该马尔可夫链将贝塔分布作为其<strong class="kw iu">平稳分布</strong>，并且我们在很长时间后所处的状态可以用作贝塔分布的样本。</p><p id="63ca" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">一种这样的 MCMC 算法是<a class="ae lr" href="https://en.wikipedia.org/wiki/Metropolis%E2%80%93Hastings_algorithm" rel="noopener ugc nofollow" target="_blank"> <strong class="kw iu"> Metropolis-Hastings 算法</strong> </a></p><h1 id="95ca" class="lz ma it bd mb mc md me mf mg mh mi mj jz mk ka ml kc mm kd mn kf mo kg mp mq bi translated">大都会-黑斯廷斯算法</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oh"><img src="../Images/7017575c4ac78f3d921f246a444065cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*mEDbMH0ji9VwWLhG"/></div></div><figcaption class="ms mt gj gh gi mu mv bd b be z dk">Hill Climbing</figcaption></figure><h2 id="3236" class="nm ma it bd mb oi oj dn mf ok ol dp mj ld om on ml lh oo op mn ll oq or mp os bi translated">直觉:</h2><p id="14fe" class="pw-post-body-paragraph ku kv it kw b kx nt ju kz la nu jx lc ld nv lf lg lh nw lj lk ll nx ln lo lp im bi translated">第一，目标是什么？</p><p id="00ab" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><em class="lq">直觉上，我们想要做的是在某个(凹凸不平的)表面(我们的马尔可夫链)上走来走去，以这样一种方式，我们在每个位置花费的时间量与该位置的表面高度成正比(我们需要从中采样的期望 pdf)。</em></p><p id="ded7" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">例如，我们愿意在海拔 100 米的山顶上花费两倍于在附近海拔 50 米的山上花费的时间。好的一面是，即使我们不知道表面上点的绝对高度，我们也可以这样做:我们只需要知道相对高度。例如，如果一个山顶 A 的高度是山顶 B 的两倍，那么我们在 A 的时间将是在 B 的两倍。</p><p id="5d3f" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><em class="lq">提出新地点的方案和接受新地点的规则更复杂，但基本思想仍然是:</em></p><p id="080d" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><strong class="kw iu"> <em class="lq"> (1)挑选一个新的“拟定”位置；</em> </strong></p><p id="c31b" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><strong class="kw iu"> <em class="lq"> (2)算出那个位置比你现在的位置高多少或低多少；</em> </strong></p><p id="1948" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><strong class="kw iu"> <em class="lq"> (3)从概率上来说，按照与地点高度成比例地花费时间的总体目标，留在原地或移动到那个地点。</em> </strong></p><p id="dfaa" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><em class="lq">MCMC 的目标是</em> <strong class="kw iu"> <em class="lq">从某种概率分布</em> </strong> <em class="lq">中抽取样本，而不必知道它在任何一点的确切高度(我们不需要知道 C)。</em></p><p id="ad9e" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><em class="lq">如果正确设置了“漫游”过程，您可以确保达到这一比例(花费的时间和分布的高度之间)。</em></p><h2 id="a055" class="nm ma it bd mb oi oj dn mf ok ol dp mj ld om on ml lh oo op mn ll oq or mp os bi translated">算法:</h2><p id="a0a7" class="pw-post-body-paragraph ku kv it kw b kx nt ju kz la nu jx lc ld nv lf lg lh nw lj lk ll nx ln lo lp im bi translated">现在让我们更正式地定义这个问题。</p><p id="00ca" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">设 s=(s1，s2，…)。sM)是期望的平稳分布。我们想创建一个具有这种平稳分布的马尔可夫链。我们从具有 M 个状态的任意马尔可夫链开始，转移矩阵为 P，因此 pij 表示从状态 I 到 j 的概率。</p><p id="0c23" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">直觉上我们知道如何在这个马尔可夫链上徘徊，但是这个马尔可夫链并不具备所需的平稳分布。</p><p id="5173" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这个链确实有一些平稳分布(这对我们没有用)</p><p id="a985" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们的目标是改变我们在这个马尔可夫链上徘徊的方式，使得这个链具有期望的平稳分布。</p><p id="2c08" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">为此，我们:</p><ol class=""><li id="eeec" class="ot ou it kw b kx ky la lb ld ov lh ow ll ox lp oy oz pa pb bi translated">从随机的初始状态 I 开始。</li><li id="7372" class="ot ou it kw b kx pc la pd ld pe lh pf ll pg lp oy oz pa pb bi translated">通过查看转移矩阵 p 的第 I 行中的转移概率，随机选择新的<em class="lq">提议状态</em>。</li><li id="296a" class="ot ou it kw b kx pc la pd ld pe lh pf ll pg lp oy oz pa pb bi translated">计算称为<em class="lq">接受概率</em>的度量，其定义为:aij=min(sj.pji/si.pij，1)。</li><li id="4b20" class="ot ou it kw b kx pc la pd ld pe lh pf ll pg lp oy oz pa pb bi translated">现在掷一枚硬币，正面朝上。如果硬币正面朝上，接受提议，即移动到下一个状态，否则拒绝提议，即停留在当前状态。</li><li id="86f7" class="ot ou it kw b kx pc la pd ld pe lh pf ll pg lp oy oz pa pb bi translated">重复很长时间</li></ol><p id="0f4a" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">很长一段时间后，这个链将会收敛，并且将会有一个稳定的分布 s。<strong class="kw iu">然后我们可以使用这个链的状态作为来自任何分布的样本。</strong></p><p id="ab22" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在对 Beta 分布进行采样时，我们使用 PDF 的唯一时间是找到接受概率，在这种情况下，我们将 sj 除以 si，即<strong class="kw iu">归一化常数</strong> C <strong class="kw iu">被取消</strong>。</p><h2 id="28da" class="nm ma it bd mb oi oj dn mf ok ol dp mj ld om on ml lh oo op mn ll oq or mp os bi translated">贝塔分布的抽样:</h2><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ph"><img src="../Images/e1fefd8a0d4991e32eacf201482dca78.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*e1IjFub0HM1aT0BD"/></div></div><figcaption class="ms mt gj gh gi mu mv bd b be z dk">MCMC Sampler</figcaption></figure><p id="462e" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">现在让我们继续讨论贝塔分布的抽样问题。</p><p id="06f5" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">贝塔分布是[0，1]上的连续分布，它在[0，1]上可以有无限个状态。</p><p id="3534" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">让我们假设在[0，1]上具有无限状态的任意马尔可夫链 P 具有转移矩阵 P，使得 pij = pji =矩阵中的所有元素。</p><p id="e5c7" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们不需要矩阵 P，正如我们将在后面看到的，但我想让问题描述尽可能接近我们建议的算法。</p><ul class=""><li id="3fb0" class="ot ou it kw b kx ky la lb ld ov lh ow ll ox lp pi oz pa pb bi translated">从 Unif(0，1)给定的随机初始状态 i 开始。</li><li id="052e" class="ot ou it kw b kx pc la pd ld pe lh pf ll pg lp pi oz pa pb bi translated">通过查看转移矩阵 p 的第 I 行中的转移概率，随机选取一个新的<strong class="kw iu">提议状态</strong>。假设我们选取另一个 Unif(0，1)状态作为提议状态 j。</li><li id="3796" class="ot ou it kw b kx pc la pd ld pe lh pf ll pg lp pi oz pa pb bi translated">计算一个称为<strong class="kw iu">接受概率</strong>的度量:</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pj"><img src="../Images/03439cee88316b1bd4e5c8d300346ccd.png" data-original-src="https://miro.medium.com/v2/resize:fit:792/format:webp/1*i-6SueuJ-XCQglWL5MXv-g.png"/></div></figure><p id="8bdb" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这简化为:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pk"><img src="../Images/a7c43f52af6ae4c6b4589e05f9dc22ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:596/format:webp/1*PBdbYAVQWbBwaVqOvQVx1Q.png"/></div></figure><p id="fee8" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">因为 pji=pij，并且在哪里</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi og"><img src="../Images/45e54cf9cee20614f818b5cff0cc5312.png" data-original-src="https://miro.medium.com/v2/resize:fit:888/format:webp/1*5-yjvCFqqtBngzzCQBlGCw.png"/></div></figure><ul class=""><li id="9e92" class="ot ou it kw b kx ky la lb ld ov lh ow ll ox lp pi oz pa pb bi translated">现在扔一枚硬币，很有可能击中头部。如果问题悬而未决，接受提议，即进入下一个州，否则拒绝提议，即停留在当前州。</li><li id="3845" class="ot ou it kw b kx pc la pd ld pe lh pf ll pg lp pi oz pa pb bi translated">长时间重复</li></ul><h2 id="37e2" class="nm ma it bd mb oi oj dn mf ok ol dp mj ld om on ml lh oo op mn ll oq or mp os bi translated">代码:</h2><p id="47c2" class="pw-post-body-paragraph ku kv it kw b kx nt ju kz la nu jx lc ld nv lf lg lh nw lj lk ll nx ln lo lp im bi translated">理论已经讲够了，让我们继续讨论 python，来创建我们的 Beta 采样器。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="pl pm l"/></div></figure><p id="25b0" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">让我们对照实际的β分布检查 MCMC 采样β分布的结果。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="pl pm l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pn"><img src="../Images/74a809c04a70ab5df73cab0ae3bf31c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*NtNUpbXTE9ijqMc3.png"/></div></div></figure><p id="273d" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">正如我们所看到的，我们的采样β值与β分布非常相似。因此，我们的 MCMC 链达到了稳定状态。</p><p id="7799" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们确实在上面的代码中创建了一个 beta 采样器，但是相同的概念普遍适用于我们想要从中采样的任何其他分布。</p><h1 id="a02e" class="lz ma it bd mb mc md me mf mg mh mi mj jz mk ka ml kc mm kd mn kf mo kg mp mq bi translated">结论</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi po"><img src="../Images/393478f5495971a5e7f6851161ea9087.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Mw95iC8lNQChTFih"/></div></div></figure><p id="4b2a" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">那是一个大帖子。恭喜你走到了尽头。</p><p id="7b3d" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">本质上,<a class="ae lr" href="https://amzn.to/2SxJurV" rel="noopener ugc nofollow" target="_blank"> MCMC </a>方法可能比较复杂，但是它们给了我们很大的灵活性。您可以使用 MCMC Sampling 对任何分布函数进行采样。它们通常用于在推断时对后验分布进行采样。</p><p id="2ff3" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">您也可以使用 MCMC 来<strong class="kw iu"> <em class="lq">求解具有大状态空间的问题。</em> </strong>例如:背包问题或解密。你可以在我的下一篇博文中看到一些有趣的例子。继续收听。</p></div><div class="ab cl ls lt hx lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="im in io ip iq"><p id="5504" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">您可以关注的最新、最好的资源之一是加利福尼亚大学的<a class="ae lr" href="https://coursera.pxf.io/3PqL3r" rel="noopener ugc nofollow" target="_blank">贝叶斯统计专业。</a></p></div><div class="ab cl ls lt hx lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="im in io ip iq"><p id="58a0" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我将来也会写更多这样的帖子。让我知道你对这个系列的看法。在<a class="ae lr" href="https://medium.com/@rahul_agarwal" rel="noopener"> <strong class="kw iu">中</strong> </a>等我，或者订阅我的<a class="ae lr" href="https://mlwhiz.ck.page/a9b8bda70c" rel="noopener ugc nofollow" target="_blank"> <strong class="kw iu">博客</strong> </a>了解他们。和往常一样，我欢迎反馈和建设性的批评，可以在推特<a class="ae lr" href="https://twitter.com/MLWhiz" rel="noopener ugc nofollow" target="_blank">@ mlwish}</a>上找到。</p></div><div class="ab cl ls lt hx lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="im in io ip iq"><h1 id="07f3" class="lz ma it bd mb mc pp me mf mg pq mi mj jz pr ka ml kc ps kd mn kf pt kg mp mq bi translated">参考</h1><ol class=""><li id="8678" class="ot ou it kw b kx nt la nu ld pu lh pv ll pw lp oy oz pa pb bi translated"><a class="ae lr" href="http://www.amazon.com/Introduction-Probability-Chapman-Statistical-Science-ebook/dp/B00MMOJ19I" rel="noopener ugc nofollow" target="_blank"> <strong class="kw iu">概率导论约瑟夫·K·布利茨坦，杰西卡·黄</strong> </a></li><li id="8889" class="ot ou it kw b kx pc la pd ld pe lh pf ll pg lp oy oz pa pb bi translated"><a class="ae lr" href="https://en.wikipedia.org/wiki/" rel="noopener ugc nofollow" target="_blank"> <strong class="kw iu">维基</strong> </a></li><li id="a31d" class="ot ou it kw b kx pc la pd ld pe lh pf ll pg lp oy oz pa pb bi translated"><a class="ae lr" href="http://stats.stackexchange.com/a/12657" rel="noopener ugc nofollow" target="_blank"> <strong class="kw iu">堆叠交换</strong> </a></li></ol></div></div>    
</body>
</html>