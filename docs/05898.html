<html>
<head>
<title>AI Learning to land a Rocket(Lunar Lander) | Reinforcement Learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">人工智能学习着陆火箭(月球着陆器)|强化学习</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/ai-learning-to-land-a-rocket-reinforcement-learning-84d61f97d055?source=collection_archive---------4-----------------------#2019-08-28">https://towardsdatascience.com/ai-learning-to-land-a-rocket-reinforcement-learning-84d61f97d055?source=collection_archive---------4-----------------------#2019-08-28</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="56ff" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">看到人工智能通过从错误中学习来学习着陆火箭，直到它平稳地开始着陆火箭。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/1f1c87cf8bcb6f0dbae089f9851e3669.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TBp5k_85gauhZSh7eS1YlA.jpeg"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Image Credits: <a class="ae ky" href="https://www.nasa.gov/image-feature/intuitive-machines-concept-for-a-commercial-lunar-lander" rel="noopener ugc nofollow" target="_blank">NASA</a></figcaption></figure><p id="7c53" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本文中，我们将简要介绍<strong class="lb iu">强化学习</strong>，并通过训练一个<strong class="lb iu">深度 Q-Network(DQN) </strong>智能体来解决 OpenAI gym 中的<strong class="lb iu"/><em class="lv">【月球着陆器】</em>环境。</p><p id="7865" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们将看到这个<strong class="lb iu">人工智能代理最初如何不做任何</strong>关于如何控制和着陆火箭的事情，但是随着时间的推移<strong class="lb iu">它从它的错误中学习</strong>并开始改善它的性能<strong class="lb iu">最终学会完全控制</strong>火箭并完美着陆。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi lw"><img src="../Images/664e8739297f2dfa256dfd577e8530e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/0*OeoznZ1fcM56p0Jm.gif"/></div></figure><p id="cbb0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">强化学习是一个庞大的话题，我们不打算在这里详细讨论所有的内容。相反，本文旨在用一些强化学习的实际例子来弄脏我们的手，并展示 RL 在解决真实世界用例中的实现。</p><p id="25a6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们将讨论使用 DQN 背后的基本原理，并将涵盖训练神经网络时遇到的<em class="lv">经验回放</em>和<em class="lv">探索-开发困境</em>。最后，我们将讨论智能体的训练和测试性能以及超参数对智能体性能的影响。</p><p id="9c66" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">完整的代码可以在这里的<a class="ae ky" href="https://github.com/fakemonk1/Reinforcement-Learning-Lunar_Lander" rel="noopener ugc nofollow" target="_blank"> Github 库</a>找到。</p></div><div class="ab cl lx ly hx lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="im in io ip iq"><h1 id="1993" class="me mf it bd mg mh mi mj mk ml mm mn mo jz mp ka mq kc mr kd ms kf mt kg mu mv bi translated">什么是强化学习？</h1><p id="19e8" class="pw-post-body-paragraph kz la it lb b lc mw ju le lf mx jx lh li my lk ll lm mz lo lp lq na ls lt lu im bi translated">强化学习是人工智能(AI)中讨论最多、关注最多和思考最多的主题之一，因为它有可能改变大多数业务。</p><p id="0f5e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">强化学习的核心是这样一个概念:积极的奖励可以强化最佳的行为或行动。与初学走路的孩子学习如何走路类似，世卫组织根据他们经历的结果调整行动，例如，如果之前的大步使他们摔倒，就迈出一小步。机器和人工智能代理使用强化学习算法，根据环境的反馈来确定理想的行为。这是机器学习的一种形式，因此也是人工智能<a class="ae ky" href="https://en.wikipedia.org/wiki/Artificial_intelligence" rel="noopener ugc nofollow" target="_blank">的一个分支。</a></p><h1 id="5b71" class="me mf it bd mg mh nb mj mk ml nc mn mo jz nd ka mq kc ne kd ms kf nf kg mu mv bi translated">强化学习在行动中</h1><p id="a6fc" class="pw-post-body-paragraph kz la it lb b lc mw ju le lf mx jx lh li my lk ll lm mz lo lp lq na ls lt lu im bi translated">强化学习在行动中的一个例子是 2017 年头条新闻中的<a class="ae ky" href="https://deepmind.com/blog/alphago-zero-learning-scratch/" rel="noopener ugc nofollow" target="_blank"> AlphaGo Zero </a>。<a class="ae ky" href="https://deepmind.com/blog/alphago-zero-learning-scratch/" rel="noopener ugc nofollow" target="_blank"> AlphaGo </a>是 Deepmind 开发的一个机器人，它利用强化学习，在中国古代围棋比赛中击败了一名世界冠军。这是人工智能(AI)首次击败职业围棋选手。围棋被认为比国际象棋等其他游戏更难让计算机获胜，因为它的大得多的<a class="ae ky" href="https://en.wikipedia.org/wiki/Branching_factor" rel="noopener ugc nofollow" target="_blank"> <em class="lv">分支因子</em> </a>使得使用传统的人工智能方法非常困难，例如<a class="ae ky" href="https://en.wikipedia.org/wiki/Alpha%E2%80%93beta_pruning" rel="noopener ugc nofollow" target="_blank"> <em class="lv"> alpha-beta 剪枝</em> </a>、<a class="ae ky" href="https://en.wikipedia.org/wiki/Tree_traversal" rel="noopener ugc nofollow" target="_blank"> <em class="lv">树遍历</em> </a> <em class="lv">、</em>和<em class="lv">启发式</em>  <em class="lv">搜索。</em></p><h1 id="f51f" class="me mf it bd mg mh nb mj mk ml nc mn mo jz nd ka mq kc ne kd ms kf nf kg mu mv bi translated">月球着陆器环境</h1><p id="7ad1" class="pw-post-body-paragraph kz la it lb b lc mw ju le lf mx jx lh li my lk ll lm mz lo lp lq na ls lt lu im bi translated">我们正在使用 OpenAI gym 的“月球着陆器”环境。这个环境处理着陆器在着陆台上着陆的问题。在<a class="ae ky" href="https://github.com/openai/gym" rel="noopener ugc nofollow" target="_blank"> OpenAI gym 的 GitHub 页面</a>和<a class="ae ky" href="http://gym.openai.com/docs/" rel="noopener ugc nofollow" target="_blank"> OpenAI 的文档</a>中提到了设置这个环境的步骤。下面是简单的 env 变量，以便理解我们工作的环境。</p><ol class=""><li id="8936" class="ng nh it lb b lc ld lf lg li ni lm nj lq nk lu nl nm nn no bi translated"><strong class="lb iu">状态</strong>:状态/观察就是环境的当前状态。有一个 8 维连续的状态空间和一个离散的动作空间。</li><li id="273c" class="ng nh it lb b lc np lf nq li nr lm ns lq nt lu nl nm nn no bi translated"><strong class="lb iu">动作</strong>:对于环境的每种状态，代理基于其当前状态采取动作。代理可以从四个独立的操作中选择操作:不执行任何操作、fire_left_engine、fire_right_engine 和 fire_main_engine。</li><li id="927f" class="ng nh it lb b lc np lf nq li nr lm ns lq nt lu nl nm nn no bi translated"><strong class="lb iu">奖励</strong>:代理每行动一次，获得一个小的负奖励。这样做是为了教会代理人尽可能快速有效地着陆火箭。如果着陆器坠毁或停止，这一集被认为是完整的，它将获得额外的-100 或+100 分，这取决于结果。</li></ol><h1 id="4750" class="me mf it bd mg mh nb mj mk ml nc mn mo jz nd ka mq kc ne kd ms kf nf kg mu mv bi translated">DQN 算法</h1><p id="43a1" class="pw-post-body-paragraph kz la it lb b lc mw ju le lf mx jx lh li my lk ll lm mz lo lp lq na ls lt lu im bi translated">包括经验重放和ϵ-greedy 探索的深度 q 学习算法如下:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nu nv l"/></div></figure><h1 id="6935" class="me mf it bd mg mh nb mj mk ml nc mn mo jz nd ka mq kc ne kd ms kf nf kg mu mv bi translated">模型训练和超参数选择</h1><p id="80e8" class="pw-post-body-paragraph kz la it lb b lc mw ju le lf mx jx lh li my lk ll lm mz lo lp lq na ls lt lu im bi translated">为了运行“登月”环境的完整实验，我们将首先训练一个基准模型，然后做更多的实验来找出改变超参数对模型性能的影响。</p><p id="67cd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最初，正如我们在下面看到的，代理非常不擅长着陆，它采取随机行动来控制火箭并试图着陆。它大部分时间都失败了，并且因为撞毁火箭而获得负奖励。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi lw"><img src="../Images/75dd4eed4e993cef656e1ac29a13bc71.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/0*jY_xUZxuwR2mpGR1.gif"/></div></figure><p id="2015" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于训练模型，没有经验法则来找出在神经网络中需要多少隐藏层。我进行了不同的实验来尝试输入层和隐藏层的节点大小的不同组合。下面的基准模型是根据训练时间、训练所需的集数和训练模型性能等参数最终确定的。</p><ul class=""><li id="7bcf" class="ng nh it lb b lc ld lf lg li ni lm nj lq nk lu nw nm nn no bi translated"><strong class="lb iu">输入层</strong> : 512 个节点，观测空间计数为 input_dim 和“relu”激活函数</li><li id="fff6" class="ng nh it lb b lc np lf nq li nr lm ns lq nt lu nw nm nn no bi translated"><strong class="lb iu">隐藏层</strong> : 1 层，256 个节点，带“relu”激活功能</li><li id="8c39" class="ng nh it lb b lc np lf nq li nr lm ns lq nt lu nw nm nn no bi translated"><strong class="lb iu">输出层</strong> : 4 节点，带“线性”激活功能</li></ul><p id="dce7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">尽管如此，这种模式有时会在平均奖励 170 美元后出现分歧，并需要超过 1000 集才能出现分歧。我发现这种行为可能是由于模型的过度训练，并实施了'<strong class="lb iu"> <em class="lv">提前停止</em> ' </strong>。早期停止是停止神经网络过度训练的实践。为了实现这一点，如果最近 10 次奖励的平均值超过 180，我会避免为特定的剧集训练模型。</p><p id="9779" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">缓冲区容量大小选择为 500000，以避免因经验元组过大而发生溢出。针对 2000 集的最大集数来训练模型，并且已训练模型的停止标准是最后 100 集的平均奖励 200。</p><p id="0789" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最终基准模型具有以下超参数:</p><ul class=""><li id="4d5c" class="ng nh it lb b lc ld lf lg li ni lm nj lq nk lu nw nm nn no bi translated"><strong class="lb iu"> <em class="lv">学习率</em> </strong> <em class="lv"> = 0.001 </em></li><li id="73fd" class="ng nh it lb b lc np lf nq li nr lm ns lq nt lu nw nm nn no bi translated"><strong class="lb iu"><em class="lv"/></strong><em class="lv">= 0.99</em></li><li id="0d29" class="ng nh it lb b lc np lf nq li nr lm ns lq nt lu nw nm nn no bi translated"><strong class="lb iu"> <em class="lv">重放 _ 内存 _ 缓冲 _ 大小</em> </strong> <em class="lv"> = 500000 </em></li><li id="8bc9" class="ng nh it lb b lc np lf nq li nr lm ns lq nt lu nw nm nn no bi translated"><strong class="lb iu"><em class="lv">ε_ 衰变</em> </strong> <em class="lv"> = 0.995 </em></li></ul><p id="0f28" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">经过大约 300 次训练，它开始学习如何控制和着陆火箭。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi lw"><img src="../Images/da034288a125b56b3c58547ab2ff75b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/0*LCwBn01NbkUZ_4lq.gif"/></div></figure><p id="c1c9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">600 以后代理人就完全训练好了。它学会完美地操纵火箭，每次都能完美地着陆。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi lw"><img src="../Images/65de29cc66ea12274aa77089f933e9a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/0*msc7rx4JWfLPC-N9.gif"/></div></figure><h1 id="bc0b" class="me mf it bd mg mh nb mj mk ml nc mn mo jz nd ka mq kc ne kd ms kf nf kg mu mv bi translated">结果分析</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nx"><img src="../Images/3ef50a44151f1f6610972c6df8b36450.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*R4qCSftce1RCVzYF.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Figure: Reward per each training episodes</figcaption></figure><p id="c53f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">上图显示的是培训时每次经历的奖励值。蓝线表示每一集训练的奖励，橙线表示过去 100 集的滚动平均值。代理随着时间不断学习，并且滚动平均值的值随着训练集的增加而增加。</p><p id="2091" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">前几集的平均回报大多是负的，因为代理人刚刚开始学习。最终，代理人开始表现得相对更好，平均回报开始上升，并在 300 集后变为正值。在 514 集之后，滚动平均值超过 200，训练结束。有几集代理人在这个时候收到了负面的奖励，但我相信如果代理人被允许继续培训，这些情况会减少。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nx"><img src="../Images/b78876961b9d0f5699ad1f198f78d44c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*fQhFCXM1_80HUm3F.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Figure: reward per testing episode</figcaption></figure><p id="11f5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">上图是训练好的模型在月球着陆器环境下 100 集的表现。经过训练的模型在环境中表现良好，所有的回报都是积极的。100 集测试的平均奖励是 205。</p><h1 id="52b4" class="me mf it bd mg mh nb mj mk ml nc mn mo jz nd ka mq kc ne kd ms kf nf kg mu mv bi translated">超参数效应</h1><h2 id="aa9a" class="ny mf it bd mg nz oa dn mk ob oc dp mo li od oe mq lm of og ms lq oh oi mu oj bi translated">A.学习率(α)</h2><p id="ceee" class="pw-post-body-paragraph kz la it lb b lc mw ju le lf mx jx lh li my lk ll lm mz lo lp lq na ls lt lu im bi translated"><em class="lv">学习率</em>，设置在 0 和 1 之间，定义为我们接受新值和旧值的程度。这个值然后被加到我们先前的 q 值上，这实质上使它朝着我们最新更新的方向移动。将其设置为 0 意味着 Q 值永远不会更新，因此什么也学不到。设置较高的值(如 0.9)意味着学习可以快速进行。</p><p id="1a9d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了验证不同学习速率对模型性能的影响，我用不同的学习速率训练了不同的代理。本实验选择的学习率为<em class="lv"> 0.0001，0.001，0.01，0.1 </em>。对于学习率的中间值 0.001，观察到最佳性能。图 3 中的橙色线对应于这个值，提供了最大的回报。代理不能以更高的学习速率学习，并且奖励值是发散的。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nx"><img src="../Images/b76953a8226d76de79f9733b1a14bd49.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ahFeXBCP0eTzMFVwmZREBw.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Rewards per episode for different learning rate</figcaption></figure><h2 id="9271" class="ny mf it bd mg nz oa dn mk ob oc dp mo li od oe mq lm of og ms lq oh oi mu oj bi translated">B.折扣系数(γ)</h2><p id="6c30" class="pw-post-body-paragraph kz la it lb b lc mw ju le lf mx jx lh li my lk ll lm mz lo lp lq na ls lt lu im bi translated"><em class="lv">折扣因子</em>影响其在价值函数中给予未来奖励的权重。一个<em class="lv">折扣因子</em> 𝛾=0 将产生代表即时奖励的状态/行动值，而一个更高的折扣因子𝛾=0.9 将产生代表代理期望获得的累积折扣未来奖励的值。下图显示了不同折扣系数下模型性能的变化。该代理在 gamma 值为 0.99 时具有最佳性能，用蓝线表示。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nx"><img src="../Images/e66df2ac59d879bfee71a3d73c546dd5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8wGLiNJS2RPI4bPqx_Um1Q.png"/></div></div></figure><h2 id="3469" class="ny mf it bd mg nz oa dn mk ob oc dp mo li od oe mq lm of og ms lq oh oi mu oj bi translated">C.ε衰变</h2><p id="7eb0" class="pw-post-body-paragraph kz la it lb b lc mw ju le lf mx jx lh li my lk ll lm mz lo lp lq na ls lt lu im bi translated">如上所述，<em class="lv"> ε </em>是我们不选择具有最高 Q 值的“贪婪”行为，而是选择随机行为的概率。<em class="lv"> epsilon(ε) decay </em>是该值在一次发作后下降的衰减率。<strong class="lb iu"> <em class="lv"> </em> </strong>图 5 示出了对于不同的<em class="lv">ε(ε)衰减值的奖励值的变化。</em>ε衰减值为 0.999 时观察到最差的药剂性能，ε衰减值为 0.9 时观察到最佳性能，如图 3 中红色所示。这种行为可能是因为ε衰减值在勘探-开采之间提供了更好的平衡。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nx"><img src="../Images/98a404d48770aa9b44233f681376f3cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0DHIBfaazjRrPQWSDDryAg.png"/></div></div></figure><p id="7e25" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">自深度 Q 学习首次推出以来，它已经取得了许多进展。在下一篇文章中，我将尝试更多的改进，如<a class="ae ky" href="http://arxiv.org/abs/1509.06461" rel="noopener ugc nofollow" target="_blank">双 Q 学习</a>、<a class="ae ky" href="http://arxiv.org/abs/1511.05952" rel="noopener ugc nofollow" target="_blank">优先体验回放</a>、<a class="ae ky" href="http://arxiv.org/abs/1511.06581" rel="noopener ugc nofollow" target="_blank">决斗网络架构</a>以及<a class="ae ky" href="http://arxiv.org/abs/1509.02971" rel="noopener ugc nofollow" target="_blank">扩展到连续<em class="lv">动作空间</em> </a> <em class="lv">。</em></p><blockquote class="ok ol om"><p id="eefa" class="kz la lv lb b lc ld ju le lf lg jx lh on lj lk ll oo ln lo lp op lr ls lt lu im bi translated">附:这是我第一篇关于媒介的文章。请让我知道你的观点。如果您发现任何错误或对代码/算法改进有任何想法，请发表评论。</p></blockquote></div></div>    
</body>
</html>