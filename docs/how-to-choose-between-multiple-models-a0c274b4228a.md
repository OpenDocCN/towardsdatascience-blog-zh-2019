# 如何在多种模式中选择

> 原文：<https://towardsdatascience.com/how-to-choose-between-multiple-models-a0c274b4228a?source=collection_archive---------13----------------------->

## 比较模型时要记住的关键概念

![](img/1ce14681c409bd28713a3c59cde501c0.png)

在[之前的文章](/a-primer-on-model-fitting-e09e757fe6be)中，我们讨论了欠拟合和过拟合的概念，它们如何导致模型与可用数据不匹配，如何识别每个问题，以及如何识别与数据非常匹配的模型。这些概念可以帮助您避免重大失误，并生成合理准确地拟合数据的模型；然而，有令人难以置信的数量的模型符合这一描述。这意味着下一步，除了生成一个合适的模型之外，还要确定哪个模型最合适。

在确定模型与数据集的拟合程度时，将模型预测与数据集进行比较来计算统计值非常重要。这超出了这篇概念性文章的范围，但更多信息可以在[从头开始的数据科学](https://www.amazon.com/gp/product/1492041130/ref=as_li_qf_asin_il_tl?ie=UTF8&tag=petergrantpub-20&creative=9325&linkCode=as2&creativeASIN=1492041130&linkId=2dcc2052808e20a054ebedf1475ce2fc)或[数据科学家实用统计](https://www.amazon.com/gp/product/1491952962/ref=as_li_tl?ie=UTF8&camp=1789&creative=9325&creativeASIN=1491952962&linkCode=as2&tag=petergrantpub-20&linkId=0530f46ce51b89ce83cd4e7bf93e6789)中找到。在本文中，我们将讨论**开发**、**验证**以及**测试**模型的过程。

## 什么是模型开发、验证和测试阶段，为什么它们是必要的？

这里要注意的基本问题是，你不能仅仅因为你开发的模型与训练数据吻合，就相信它。这是因为一个简单的原因:您强制模型很好地适应了训练数据。如果在创建一个模型后，统计计算显示它与数据匹配良好，这意味着可以使用数学方法来迫使模型与数据匹配良好。这并不意味着模型正在捕捉真正发生的趋势，或者模型能够预测其他情况。我在[上一篇文章](/a-primer-on-model-fitting-e09e757fe6be)中的 overfit 模型的例子很好地突出了这一点。

这个问题的解决方案是模型验证。验证是使用模型来预测其他有数据的情况下的输出，并根据这些结果计算相同的统计度量的实践。请注意，这意味着您需要将数据集分成两个不同的数据文件。第一个是训练数据集，用于生成模型。第二个是验证数据集，用于对照未用于训练模型的数据来检查模型的准确性。

一般来说，一个项目中会创建多个模型。如果创建了许多模型，则将最适合训练数据的模型与验证数据进行比较。那么自然的选择是选择最符合验证数据的模型，然后继续前进。然而，这带来了另一个潜在的陷阱。类似于将模型与训练数据进行比较，仅仅因为模型最接近地匹配验证数据仍然不意味着它匹配现实。虽然它在这个测试中表现最好，但它仍然可能是错误的。

最后一步，也是该问题的解决方案，是将在验证阶段表现最佳的模型与第三组数据(测试数据)进行比较。这个测试数据也是来自原始数据源的数据的子集。它只包含模型开发或验证中未使用的点。只有当模型与测试数据进行比较，并且统计计算显示出令人满意的匹配时，才认为模型可以使用。

## 这整个过程是如何分解的？

这个过程分为以下七个步骤。

*   **创建开发、验证和测试数据集**:最初你有一个单一的大型数据集。正如上一节所讨论的，您需要将它分成三个独立的数据集，每个数据集只用于项目的一个阶段。在创建每个数据集时，确保它们包含位于每个变量的高/低极限值和中间值的混合数据点。这确保了该模型能够并且必须在光谱的所有范围内都是准确的。此外，确保大多数数据都包含在训练数据集中。模型只能和用来创建它的数据集一样精确，更多的数据给了它更多的机会。
*   **使用训练数据集开发您的模型**:将数据集输入到您的模型开发脚本中，并使用它来开发您选择的模型。根据可用的数据源和需要回答的问题，您可以开发几种不同的模型。关于模型类型的更多信息可以在[从头开始的数据科学](https://www.amazon.com/gp/product/1492041130/ref=as_li_tl?ie=UTF8&camp=1789&creative=9325&creativeASIN=1492041130&linkCode=as2&tag=petergrantpub-20&linkId=b8ad9179ae1f22b7e9bb6d5f6df8245c)中找到。在这个阶段，您可能想要创建几个不同的模型。它们可以是不同结构的模型，或者是不同阶的几个回归模型。生成您认为可能表现良好的任何模型。
*   **计算识别模型开发性能的统计值**:一旦模型被开发出来，你需要将它们与用来创建它们的训练数据进行比较。性能较高的模型比性能较低的模型更适合数据。为此，您需要计算为此目的设计的统计值。例如，检查回归模型性能的一种常用方法是计算 r 值。根据这些统计计算，将模型与训练数据集进行比较，确定表现最佳的模型。
*   **计算验证数据集中数据点的模型结果**:在这一步中，您使用验证数据集中的输入来驱动模型，为这些数据点生成预测。一旦完成，您就有了真实值(来自数据集)和预测值(来自模型)。这允许您将不同模型的性能与验证数据集中的数据进行比较。
*   **计算统计值，将模型结果与验证数据进行比较**:现在您已经有了验证数据集中每个实例的数据值和模型预测，您可以计算与将模型预测与验证数据集进行比较之前相同的统计值。这是流程的关键部分。第一次统计计算确定了模型与被迫拟合的数据集的拟合程度。在这种情况下，您要确保模型能够匹配一个单独的数据集，一个对模型开发没有影响的数据集。对每个型号完成您选择的统计计算，然后选择性能最高的型号。
*   **计算测试数据集**中数据点的模型结果:使用测试数据集的输入来驱动模型，在这些点上生成模型的预测输出。仅使用验证阶段性能最高的模型来执行此任务。完成后，您将获得每个输入的输出的模型预测值和实际值。
*   **计算统计值，将模型结果与测试数据进行比较**:最后一次，执行您选择的统计计算，将模型预测与数据集进行比较。在这种情况下，你只有一个模型，所以你不是在寻找最合适的。相反，您正在检查以确保您的模型与测试数据集足够接近，令人满意。

一旦你开发了一个令人满意地匹配测试数据集的模型，你就可以开始生成预测了。但是，不要认为这意味着您已经完全完成了模型开发；很有可能有一天你会决定需要根据新的可用数据集来调整你的模型。

## 包装它

本文中讨论的基本挑战是，模型在特定数据集上的性能并不能保证它在其他数据集上也能表现良好。强制一个数学模型匹配一个给定的数据集只能确保它匹配那个特定的数据集，并不能说明它的预测能力。

这个挑战可以通过使用不同数据集的开发、验证和测试来克服。第一步是根据训练数据集开发模型，并确保模型可以在最简单的情况下准确预测结果。第二步是将表现最好的模型与第二个数据集(验证数据集)进行比较。验证数据集应包含跨越训练数据集中包含的值范围的点，但不应包含任何相同的点。这第二次检查对确保模型具有合理的预测能力大有帮助。最后一步是选择对验证数据集表现最好的模型，并将其与第三个数据集(测试数据集)进行比较。如果模型在数据集上表现良好，那么它可以合理地用于创建预测。