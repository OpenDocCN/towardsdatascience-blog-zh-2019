<html>
<head>
<title>Using Deep Learning for Image Analogies</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用深度学习进行图像类比</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/using-deep-learning-for-image-analogies-aa2e7d7af337?source=collection_archive---------20-----------------------#2019-07-27">https://towardsdatascience.com/using-deep-learning-for-image-analogies-aa2e7d7af337?source=collection_archive---------20-----------------------#2019-07-27</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="f42b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我将回答以下问题:</p><p id="b15a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">狗对于狼就像猫对于 __？</p><p id="0d88" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">通过使用经过训练的深度卷积神经网络对照片进行分类。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi kp"><img src="../Images/48dd15af16f366c88b0fd23df3b9228d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mM9niltqGtqXwpxgcomd2Q.png"/></div></div><figcaption class="lb lc gj gh gi ld le bd b be z dk"><em class="lf">A dog is to wolf as a cat is to ___ ?</em></figcaption></figure><h1 id="e4d3" class="lg lh it bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">卷积神经网络</h1><p id="9ecb" class="pw-post-body-paragraph jq jr it js b jt me jv jw jx mf jz ka kb mg kd ke kf mh kh ki kj mi kl km kn im bi translated">我会使用预先训练好的 VGG16 图像分类模型。该模型由一个接一个堆叠的 CNN 层组成，由 max pooling 层连接。网络的输入是 244×244×3 的图像(即图像宽度和长度是 244 像素，3 个通道)，在应用所有卷积层之后，我们得到 7×7×512 的阵列。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi mj"><img src="../Images/224e348eea3cabb756939fb59fc3e518.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uQ6UKWiGmBoT4x4Caa2QOA.png"/></div></div><figcaption class="lb lc gj gh gi ld le bd b be z dk">(diagram taken from <a class="ae mk" href="https://www.deeplearning.ai/" rel="noopener ugc nofollow" target="_blank">deeplearning.ai</a> course by Andrew Ng, “Convolutional Neural Networks”)</figcaption></figure><p id="34d5" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在网络的末端，我们有一个额外的展平层、两个完全连接的密集层和一个 softmax 层，它输出图像属于第 I 个标签的概率 P(x∈i)，其中 i=1，…，1000(标签数)。</p><h1 id="169c" class="lg lh it bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">单词嵌入和类推</h1><p id="3252" class="pw-post-body-paragraph jq jr it js b jt me jv jw jx mf jz ka kb mg kd ke kf mh kh ki kj mi kl km kn im bi translated">另一个与语言处理和深度学习相关的概念是<em class="ko">单词嵌入</em>。给定一个大的文本语料库，比方说有 100，000 个单词，我们建立一个嵌入或映射，给每个单词一个在 n=500 维的较小空间中的向量。</p><p id="08da" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这种维度的减少给了我们一个单词的紧凑表示。事实上，单词嵌入对许多任务都很有用，包括情感分析、机器翻译，还有单词类比(例如这里的)也就是说，解决一个类比形式的问题<em class="ko">“一个男人是国王还是一个女人是 ____？”</em>。特别是，一旦我们有了嵌入，解决类比就非常简单了——我们使用向量空间的结构来应用线性运算。</p><h1 id="9db3" class="lg lh it bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">图像类比</h1><p id="f508" class="pw-post-body-paragraph jq jr it js b jt me jv jw jx mf jz ka kb mg kd ke kf mh kh ki kj mi kl km kn im bi translated">我试图采用使用单词嵌入的概念来解决使用文本的类比，使用预先训练的图像分类模型来解决使用图像的嵌入。想法是使用网络在最后完全连接的层之前，得到一个特征提取地图</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div class="gh gi ml"><img src="../Images/abae01909f2cda6989aa1b13087cc56e.png" data-original-src="https://miro.medium.com/v2/resize:fit:690/format:webp/1*nOhnf7SAHTZHfKcinqFfEA.png"/></div></figure><p id="096e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这个方法似乎很有效，并为我们的类比提供了一个解决方案:</p><p id="ad71" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><em class="ko">狗之于狼如同猫之于</em> <strong class="js iu"> <em class="ko">猞猁</em> </strong></p><p id="48ef" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这也给出了一个不寻常的方法来解决一个单词类比问题，对不对？</p><p id="dfed" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">下面是代码的概述。我们首先加载 VGG16 模型和图像。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi mm"><img src="../Images/dd503c73655a8c40ca9f8b2d8125fd61.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*U7g6pZhonCfE829raGoyBw.png"/></div></div></figure><p id="8d32" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">然后，我们以与使用单词嵌入相同的方式解决类比，但是使用我们的 CNN 特征提取图:</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi mn"><img src="../Images/c7549ecc33ef967cdc9427f64cfcf7d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NSXE6xbRlpSw-fAv1rH-wQ.png"/></div></div></figure><p id="b902" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这是结果:</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div class="gh gi mo"><img src="../Images/192defb2fbcbad56e02457dc4c4f5f7d.png" data-original-src="https://miro.medium.com/v2/resize:fit:914/format:webp/1*wI-Vcjujel7ZGm1pTI2J6g.png"/></div></figure><p id="5043" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们有将近 50%的可能性得到“山猫”。</p><p id="4130" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">总而言之，我们的类比完成得很好！如果你不知道什么是猞猁，这里有一张参考照片:</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div class="gh gi mp"><img src="../Images/aa9691000fdf78715224ba74c78a96af.png" data-original-src="https://miro.medium.com/v2/resize:fit:644/format:webp/1*Icb5ZC-9jv2BaOq8SB3rlg.png"/></div><figcaption class="lb lc gj gh gi ld le bd b be z dk">lynx</figcaption></figure></div></div>    
</body>
</html>