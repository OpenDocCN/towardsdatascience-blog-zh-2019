<html>
<head>
<title>Follow &amp; Learn: Statistical Significance With Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">跟随和学习:Python 的统计意义</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/follow-learn-statistical-significance-with-python-6d31c8d0c744?source=collection_archive---------11-----------------------#2019-06-21">https://towardsdatascience.com/follow-learn-statistical-significance-with-python-6d31c8d0c744?source=collection_archive---------11-----------------------#2019-06-21</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/b76c08764867d786129df24ad921c30a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*FQW2ueiDmhnxUoL9"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk">Photo by <a class="ae kf" href="https://unsplash.com/@dylan_nolte?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">dylan nolte</a> on <a class="ae kf" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="e47b" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果你使用互联网，你很有可能在不知情的情况下参与了某人的统计实验。它通常是一个微妙的变化，如页面的颜色、按钮的形状或一些额外的文本。</p><p id="9018" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">Google Analytics 为其客户提供以测试为中心的服务，以优化网络流量。在这篇文章中，我们想探索如何从玩具数据集中得出统计意义。</p><p id="243e" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">建议在进入本帖之前熟悉<a class="ae kf" href="https://en.wikipedia.org/wiki/Design_of_experiments" rel="noopener ugc nofollow" target="_blank">实验设计</a>、<a class="ae kf" href="https://en.wikipedia.org/wiki/Binomial_distribution" rel="noopener ugc nofollow" target="_blank">二项分布</a>和<a class="ae kf" href="https://en.wikipedia.org/wiki/P-value" rel="noopener ugc nofollow" target="_blank"> p 值</a>。请随意浏览<a class="ae kf" href="https://github.com/NadimKawwa/Statistics/blob/master/Statistical_Significance.ipynb" rel="noopener ugc nofollow" target="_blank">笔记本</a>了解更多信息。</p><h1 id="4f4c" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">数据</h1><p id="b8a1" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">假设我们想要增加点击下载按钮的用户数量。看看下面的<a class="ae kf" href="https://github.com/NadimKawwa/Statistics/blob/master/data/statistical_significance_data.csv" rel="noopener ugc nofollow" target="_blank">数据表</a>:</p><figure class="mi mj mk ml gt ju gh gi paragraph-image"><div class="gh gi mh"><img src="../Images/4eb703f40acacf12905b733d4d919ede.png" data-original-src="https://miro.medium.com/v2/resize:fit:592/format:webp/1*Hvv5Wdu820mio6Ulfg2xEg.png"/></div></figure><p id="17d8" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="mm">条件</em>列取两个值:</p><ul class=""><li id="a04c" class="mn mo it ki b kj kk kn ko kr mp kv mq kz mr ld ms mt mu mv bi translated">对照组为 0</li><li id="a838" class="mn mo it ki b kj mw kn mx kr my kv mz kz na ld ms mt mu mv bi translated">1 个用于实验组</li></ul><p id="551c" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="mm">点击</em>列也取两个值:</p><ul class=""><li id="e6d1" class="mn mo it ki b kj kk kn ko kr mp kv mq kz mr ld ms mt mu mv bi translated">0 表示不下载</li><li id="7dad" class="mn mo it ki b kj mw kn mx kr my kv mz kz na ld ms mt mu mv bi translated">1 个用于下载</li></ul><h1 id="69ab" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">不变度量</h1><p id="2fed" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">这里的条件是我们的不变度量，我们希望测试组和对照组在理想情况下是不可区分的。如果这个条件不成立，那么我们就不能把我们的研究建立在可靠的信息上:我们想在两个几乎相同的组中测试一个类似的事件。</p><h2 id="fef3" class="nb lf it bd lg nc nd dn lk ne nf dp lo kr ng nh ls kv ni nj lw kz nk nl ma nm bi translated">模拟方法</h2><p id="0e0e" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">我们可以通过随机的 50/50 分割来模拟组的分配。这是如何做到的:</p><ul class=""><li id="5058" class="mn mo it ki b kj kk kn ko kr mp kv mq kz mr ld ms mt mu mv bi translated">记录对照组/实验组的参与者人数</li><li id="374d" class="mn mo it ki b kj mw kn mx kr my kv mz kz na ld ms mt mu mv bi translated">对该组执行<a class="ae kf" href="https://en.wikipedia.org/wiki/Bernoulli_trial" rel="noopener ugc nofollow" target="_blank">伯努利试验</a></li><li id="6cdb" class="mn mo it ki b kj mw kn mx kr my kv mz kz na ld ms mt mu mv bi translated">将结果与原始分布进行比较</li><li id="2b62" class="mn mo it ki b kj mw kn mx kr my kv mz kz na ld ms mt mu mv bi translated">报告异常值的比例</li></ul><p id="90df" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">下面的代码块显示了我们可以模拟 n 次随机抽取并记录异常情况。</p><figure class="mi mj mk ml gt ju"><div class="bz fp l di"><div class="nn no l"/></div></figure><p id="91dd" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">该脚本返回 0.613，表明两组之间的差异在统计上不显著。我们关于两组相同的假设是正确的。</p><h2 id="2c1c" class="nb lf it bd lg nc nd dn lk ne nf dp lo kr ng nh ls kv ni nj lw kz nk nl ma nm bi translated">分析方法</h2><p id="5379" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">二项式分布的标准差由下式给出:</p><figure class="mi mj mk ml gt ju gh gi paragraph-image"><div class="gh gi np"><img src="../Images/901569d3a0f22b418526a5d9e59b09de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1194/format:webp/1*IZetFxsQ3yCIhSPVzfFSDw.png"/></div></figure><ul class=""><li id="589f" class="mn mo it ki b kj kk kn ko kr mp kv mq kz mr ld ms mt mu mv bi translated">n=样本量</li><li id="95b3" class="mn mo it ki b kj mw kn mx kr my kv mz kz na ld ms mt mu mv bi translated">p =成功的概率</li><li id="b9d7" class="mn mo it ki b kj mw kn mx kr my kv mz kz na ld ms mt mu mv bi translated">q =故障概率= (1-p)</li></ul><p id="9080" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">z 得分是标准偏差的度量，例如，z 得分为 2 表示我们距离平均值有 2 个标准偏差。在我们的例子中，z 分数由下式给出:</p><figure class="mi mj mk ml gt ju gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/5697b45cc5dae822b536253d5a066c80.png" data-original-src="https://miro.medium.com/v2/resize:fit:526/format:webp/1*8-8cKEPHBAnyHNLKRQ26nw.png"/></div></figure><ul class=""><li id="597a" class="mn mo it ki b kj kk kn ko kr mp kv mq kz mr ld ms mt mu mv bi translated">x =对照组的人数</li><li id="4cbc" class="mn mo it ki b kj mw kn mx kr my kv mz kz na ld ms mt mu mv bi translated">μ=平均值</li><li id="2c65" class="mn mo it ki b kj mw kn mx kr my kv mz kz na ld ms mt mu mv bi translated">σ =标准偏差</li></ul><p id="cde3" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">注意，我们需要通过加或减 0.5 对 x 进行<a class="ae kf" href="https://en.wikipedia.org/wiki/Continuity_correction" rel="noopener ugc nofollow" target="_blank">连续性校正</a>。一旦我们有了 z 值，我们就可以从<a class="ae kf" href="https://www.math.arizona.edu/~rsims/ma464/standardnormaltable.pdf" rel="noopener ugc nofollow" target="_blank"> z 得分表</a>中得到分布两边曲线下的面积。</p><p id="3c08" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">多亏了大样本和<a class="ae kf" href="https://en.wikipedia.org/wiki/Central_limit_theorem" rel="noopener ugc nofollow" target="_blank">中心极限定理，我们才能够完成上述步骤。</a>下面的直方图显示了模拟中样本的分布，有助于我们的主张。</p><figure class="mi mj mk ml gt ju gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/f7c4bd1405e72ac69f1f9a905cc429c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:864/format:webp/1*O6z44Ta6Bmr7VJWVStgGnQ.png"/></div></figure><p id="66c3" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在 python 代码中，我们使用与上一部分相同的变量运行下面的代码块。</p><p id="eeff" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">成功！我们获得与模拟相同的 p 值！</p><figure class="mi mj mk ml gt ju"><div class="bz fp l di"><div class="nn no l"/></div></figure><h1 id="2e3a" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">评估指标</h1><p id="dc91" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">现在我们来看一下评估指标，即点击率(CTR)。我们的测试组和对照组之间的点击量差异显著吗？</p><p id="347a" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们的零假设是，使用单尾检验，两组的 CTR 是相同的。</p><p id="1bf2" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">首先让我们用下面的代码块记录一些统计数据。</p><figure class="mi mj mk ml gt ju"><div class="bz fp l di"><div class="nn no l"/></div></figure><h2 id="3ea0" class="nb lf it bd lg nc nd dn lk ne nf dp lo kr ng nh ls kv ni nj lw kz nk nl ma nm bi translated">模拟方法</h2><p id="9b75" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">该方法类似于我们为不变度量所做的方法，但有一些变化:</p><ul class=""><li id="79b9" class="mn mo it ki b kj kk kn ko kr mp kv mq kz mr ld ms mt mu mv bi translated">对控制组进行伯努利试验，成功概率为 p_null</li><li id="c7ed" class="mn mo it ki b kj mw kn mx kr my kv mz kz na ld ms mt mu mv bi translated">以 p_null 的成功概率对<em class="mm">实验组</em>进行伯努利试验</li><li id="30f4" class="mn mo it ki b kj mw kn mx kr my kv mz kz na ld ms mt mu mv bi translated">记录两次试验平均值的差异</li></ul><p id="d265" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这可以在 Python 中完成，如下所示:</p><figure class="mi mj mk ml gt ju"><div class="bz fp l di"><div class="nn no l"/></div></figure><p id="cd2b" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这返回 0.0395 的 p 值&lt;0.05, this means our result is statistically significant and we should reject the null hypothesis. Again the central limit theorem is at work here by looking at the distribution of the differences in means.</p><figure class="mi mj mk ml gt ju gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/91b68ea43e607ddf37c5caf1e9ec056c.png" data-original-src="https://miro.medium.com/v2/resize:fit:864/format:webp/1*PFgJbzlmQEyjvLil0bVBLQ.png"/></div></figure><h2 id="e747" class="nb lf it bd lg nc nd dn lk ne nf dp lo kr ng nh ls kv ni nj lw kz nk nl ma nm bi translated">Analytical Approach</h2><p id="fc34" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">We need to evaluate the pooled CTR for the analytical solution. To get there we calculate the pooled standard deviation using the formula below.</p><figure class="mi mj mk ml gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi ns"><img src="../Images/43d6eb842fa3d3e62ffdb1d63143f779.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WhWdU1CBQnrDBmpOPjqIFw.png"/></div></div></figure><p id="7281" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">In python code the process is:</p><figure class="mi mj mk ml gt ju"><div class="bz fp l di"><div class="nn no l"/></div></figure><p id="cf43" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">We obtain the same p value as in the simulation approach and again reject the null hypothesis.</p><h1 id="2dd4" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">Conclusion</h1><p id="a1f9" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">Through analytical and simulation approaches, we have reached the same conclusions for the invariant and evaluation metrics respectively.</p><p id="39c1" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">We can now solve similar problems using either approach! How many observations do we need for our experiment is covered in a post on <a class="ae kf" rel="noopener" target="_blank" href="/follow-learn-experiment-size-with-python-7651251e027b">实验规模</a>我们使用类似的概念。</p></div></div>    
</body>
</html>