<html>
<head>
<title>Natural Language Processing — Event Extraction</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">自然语言处理—事件提取</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/natural-language-processing-event-extraction-f20d634661d3?source=collection_archive---------5-----------------------#2019-05-02">https://towardsdatascience.com/natural-language-processing-event-extraction-f20d634661d3?source=collection_archive---------5-----------------------#2019-05-02</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="62e4" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">从新闻文章中提取事件</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/d7902762ccbcc75265a676ba4aee1246.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lPK5v5TYsiNHoq8rzllRPQ.jpeg"/></div></div></figure><p id="1849" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">每天生成的文本量令人震惊。数以百万计的数据以新闻文章、博客、消息、手稿等形式发布，自动组织和处理它们的能力变得不可或缺。</p><p id="423e" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">随着神经网络算法的改进，计算机能力的显著提高，以及对综合框架的轻松访问，自然语言处理似乎从未如此吸引人。它的一个常见应用称为事件提取，这是一个收集文本中发现的周期性事件的知识的过程，自动识别关于发生了什么以及何时发生的信息。</p><p id="6210" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">例如:</p><blockquote class="ln lo lp"><p id="3626" class="kr ks lq kt b ku kv jr kw kx ky ju kz lr lb lc ld ls lf lg lh lt lj lk ll lm ij bi translated">2018/10-唐纳德·特朗普总统的政府禁止各国进口伊朗石油，七个国家除外。</p><p id="c8a4" class="kr ks lq kt b ku kv jr kw kx ky ju kz lr lb lc ld ls lf lg lh lt lj lk ll lm ij bi translated">2019/04-美国国务卿迈克·蓬佩奥宣布，他的国家将不会在最后期限后开放更多的例外。</p><p id="c228" class="kr ks lq kt b ku kv jr kw kx ky ju kz lr lb lc ld ls lf lg lh lt lj lk ll lm ij bi translated">2019/05-美国结束了允许各国从伊朗进口石油而不受美国制裁的豁免。</p></blockquote><p id="217e" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这种将信息置于背景中的能力让我们能够将时间分布的事件联系起来，吸收它们的影响，以及一系列事件如何随着时间的推移而展开。这些有价值的见解推动了像<a class="ae lu" href="https://eventregistry.org/" rel="noopener ugc nofollow" target="_blank"> EventRegistry </a>和<a class="ae lu" href="https://primer.ai/" rel="noopener ugc nofollow" target="_blank"> Primer 这样的组织。AI </a>，为不同的市场领域提供技术。</p><p id="6c54" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在本文中，我们将构建一个简单的事件提取脚本，它接收新闻提要并输出事件。</p><h2 id="f4a3" class="lv lw iq bd lx ly lz dn ma mb mc dp md la me mf mg le mh mi mj li mk ml mm mn bi translated">获取数据</h2><p id="f0e8" class="pw-post-body-paragraph kr ks iq kt b ku mo jr kw kx mp ju kz la mq lc ld le mr lg lh li ms lk ll lm ij bi translated">第一步是收集数据。它可以是任何类型的文本内容，只要它可以在时间线中表示。这里我选择使用<a class="ae lu" href="https://newsapi.org/" rel="noopener ugc nofollow" target="_blank"> newsapi </a>，这是一个简单的新闻源 api，免费开发者计划每天最多 500 个请求。以下是为处理请求而构建的函数:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mt"><img src="../Images/018d398977b87700cead80100173094b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JA_gLfz045e5A-HCnRu18w.png"/></div></div></figure><p id="dab6" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">给定一个特定的查询，最后一个函数返回大约 2，000 篇文章的列表。我们的目的只是提取事件，因此，为了简化过程，我们只保留标题(理论上，标题应该包含新闻背后的核心信息)。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mu"><img src="../Images/bac02165910664d68209fc94fd488e2b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FB76WUMZMfO5gwHOznnxew.png"/></div></div></figure><p id="d318" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这给我们留下了一个类似下面的数据框，包括日期、描述和标题。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mv"><img src="../Images/3b5f4a67d02de874c670e8f7eb29736d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*b9CGmqRiq4MmSXWeQbav7Q.png"/></div></div></figure><h2 id="1774" class="lv lw iq bd lx ly lz dn ma mb mc dp md la me mf mg le mh mi mj li mk ml mm mn bi translated">赋予句子意义</h2><p id="9d6b" class="pw-post-body-paragraph kr ks iq kt b ku mo jr kw kx mp ju kz la mq lc ld le mr lg lh li ms lk ll lm ij bi translated">准备好标题后，我们需要用机器可读的方式来表示它们。注意，我们在这里跳过了整个预处理阶段，因为这不是本文的目的。但是如果你从 NLP 开始，确保在应用模型之前包括那些基本的预处理步骤→ <a class="ae lu" href="https://machinelearningmastery.com/clean-text-machine-learning-python/" rel="noopener ugc nofollow" target="_blank">这里有一个很好的教程</a>。</p><p id="6466" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">为了给独立的单词赋予意义，从而给整个句子赋予意义，让我们使用 Spacy 的预训练单词嵌入模型(<a class="ae lu" href="https://spacy.io/models/en#en_core_web_lg" rel="noopener ugc nofollow" target="_blank"> en_core_web_lg </a>)。或者，您可以使用任何预先训练的单词表示模型(Word2Vec、FastText、GloVe……)。</p><p id="4115" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">默认情况下，Spacy 将句子的向量视为其标记向量之间的平均值。这是一种简单的方法，不考虑单词的顺序来编码句子。对于更复杂的策略，看看像<a class="ae lu" href="https://github.com/epfml/sent2vec" rel="noopener ugc nofollow" target="_blank"> Sent2Vec </a>和<a class="ae lu" href="https://github.com/ryankiros/skip-thoughts" rel="noopener ugc nofollow" target="_blank"> SkipThoughts </a>这样的模型。这篇关于无监督摘要的文章很好地介绍了跳过思想。</p><p id="470b" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">现在，让我们保持简单:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mw"><img src="../Images/2f7425b7d40de4354bd2dcd3c34f7d16.png" data-original-src="https://miro.medium.com/v2/resize:fit:1372/format:webp/1*sh_96iPqOj8C2rsQu2CTzQ.png"/></div></figure><p id="1db0" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">因此，每个标题都有一个第 300 维的数组，如下所示:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mx"><img src="../Images/006dcb7d5655e7f9b65b864ff7bb184d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZDVQkoMT4IIfl5S9WrPPqQ.png"/></div></div></figure><h2 id="c7e6" class="lv lw iq bd lx ly lz dn ma mb mc dp md la me mf mg le mh mi mj li mk ml mm mn bi translated">聚集这些向量</h2><p id="955f" class="pw-post-body-paragraph kr ks iq kt b ku mo jr kw kx mp ju kz la mq lc ld le mr lg lh li ms lk ll lm ij bi translated">即使我们是通过搜索词来过滤文章，不同的主题也可能出现在同一个查询中。例如，搜索“巴黎”可能会得到:</p><blockquote class="ln lo lp"><p id="653e" class="kr ks lq kt b ku kv jr kw kx ky ju kz lr lb lc ld ls lf lg lh lt lj lk ll lm ij bi translated">一场毁灭性的火灾后，巴黎团结起来</p></blockquote><p id="1b3b" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">或者:</p><blockquote class="ln lo lp"><p id="002f" class="kr ks lq kt b ku kv jr kw kx ky ju kz lr lb lc ld ls lf lg lh lt lj lk ll lm ij bi translated">巴西足球传奇人物贝利在巴黎住进医院</p></blockquote><p id="edb4" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">为了对不同主题的文章进行分组，我们将使用聚类算法。</p><p id="2192" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在这个特殊的例子中，我想尝试 DBSCAN 算法，因为它不需要预先指定集群的数量。相反，它自己决定要创建多少个集群，以及它们的大小。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi my"><img src="../Images/d6c3b6a1b1dc52065a762dd86b8dfbc1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-2LUQxh4VWMZIfwD-6JwCg.png"/></div></div></figure><p id="0f51" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><em class="lq">ε</em>参数决定了两个样本之间的最大距离，使它们被视为处于相同的邻域中，这意味着如果<em class="lq"> eps </em>太大，将形成较少的聚类，但如果太小，大多数点将被分类为不属于某个聚类，这也将导致一些聚类。下图显示了 epsilon 的集群数量:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mz"><img src="../Images/44885ab8eaa1662a076169075b52ee9c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4C9McKZpjxZiwRE0uoEKoQ.png"/></div></div></figure><p id="6572" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">调整<em class="lq"> eps </em>值可能是最微妙的步骤之一，因为结果会根据您认为句子相似的程度而有所不同。正确的值将通过实验得出，试图保留句子之间的相似性，而不会将相近的句子分成不同的组。</p><p id="9847" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">一般来说，因为我们希望在同一个集群中得到非常相似的句子，所以目标应该是返回更多类别的值。因此，我选择了一个介于 0.08 和 0.12 之间的数字。查看<a class="ae lu" href="https://scikit-learn.org/stable/modules/generated/sklearn.cluster.DBSCAN.html" rel="noopener ugc nofollow" target="_blank"> Scikit Learn </a>文档，了解更多关于该参数和其他参数的信息。</p><p id="6825" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">以下是一些集群及其大小:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi na"><img src="../Images/512438f3564c740dda6866a9dd018529.png" data-original-src="https://miro.medium.com/v2/resize:fit:588/format:webp/1*3XKfzxvelBp1yQ2CTjXCKA.png"/></div></figure><p id="c3ed" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir"> -1 </strong>类代表没有聚类的句子，其余为聚类索引。最大的集群应该代表评论最多的主题。</p><p id="b0a5" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">让我们来看看其中的一个集群:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nb"><img src="../Images/3df99cd0fb65f17083a3f91489f4d4d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wdfYwOpxyjFr91wrQ649yQ.png"/></div></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nc"><img src="../Images/8d9d940d6953d3b4938c804bf9723bcb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9F7AlnVOAtE7B2uO-aPXdw.png"/></div></div></figure><h2 id="7213" class="lv lw iq bd lx ly lz dn ma mb mc dp md la me mf mg le mh mi mj li mk ml mm mn bi translated">转换成事件</h2><p id="d5b8" class="pw-post-body-paragraph kr ks iq kt b ku mo jr kw kx mp ju kz la mq lc ld le mr lg lh li ms lk ll lm ij bi translated">下一步是按时间顺序排列这些句子，并根据相关性进行过滤。这里，我选择每天显示一篇文章，这样时间线就清晰一致了。</p><p id="d0c5" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">由于每天都有很多关于同一主题的句子，我们需要一个标准来从中选择一个。它应该是最能代表事件本身的，也就是那些标题试图传达的意思。</p><p id="0680" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">为此，我们可以对每日标题进行聚类，并为每个聚类选择离聚类中心最近的标题。给定一系列句子，下面是查找中心向量的函数:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nd"><img src="../Images/152e9de865c1467ea40566a26912eb81.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JJOGJFcSUHlZAAG1HklNaQ.png"/></div></div><figcaption class="ne nf gj gh gi ng nh bd b be z dk">s</figcaption></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ni"><img src="../Images/019515062f195cdf627b428c70929843.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*piXppqSq7x94rgxXm5iMmQ.png"/></div></div></figure><p id="57d3" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">最后，使用 Plotly，我们可以想出一种方法来绘制一个方便的时间线图:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nj"><img src="../Images/079e0b82b2d426c5020dde784a37e8ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DzyLoADpOmvp3pE4cKu2UA.png"/></div></div></figure><p id="8861" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">就是这样。使用 2000 篇随机文章，我们制作了一个脚本来提取和组织事件。想象一下，每天将这种技术应用到数百万篇文章中会有多有用。以股票市场和每日新闻的影响为例，我们可以开始窥视事件提取的价值。</p><p id="0bb0" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">可以包括几个组件来改善结果，比如适当地预处理数据，包括<a class="ae lu" href="https://spacy.io/usage/linguistic-features" rel="noopener ugc nofollow" target="_blank">词性标注和 NER </a>，应用更好的句子到向量模型，等等。但是从这一点出发，可以很快达到一个理想的结果。</p></div><div class="ab cl nk nl hu nm" role="separator"><span class="nn bw bk no np nq"/><span class="nn bw bk no np nq"/><span class="nn bw bk no np"/></div><div class="ij ik il im in"><p id="7426" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">感谢你阅读这篇文章。这是一篇关注自然语言处理和事件提取的文章。如果你想了解更多关于数据科学和机器学习的知识，请确保关注我的个人资料，并随时留下任何想法、评论或担忧。</p></div></div>    
</body>
</html>