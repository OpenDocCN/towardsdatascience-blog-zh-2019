<html>
<head>
<title>Linear Regression Derivation</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">线性回归推导</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/linear-regression-derivation-d362ea3884c2?source=collection_archive---------1-----------------------#2019-05-08">https://towardsdatascience.com/linear-regression-derivation-d362ea3884c2?source=collection_archive---------1-----------------------#2019-05-08</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="7f8e" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">线性回归中的 2/3 部分</h2></div><p id="4835" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">第 1/3 部分:<a class="ae le" href="https://medium.com/@leisyridley/linear-regression-intuition-172b52758321" rel="noopener">线性回归直觉</a></p><p id="0c9e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">第 3/3 部分:<a class="ae le" href="https://medium.com/@leisyridley/implementation-of-linear-regression-8a6ff13dc727" rel="noopener">线性回归实现</a></p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi lf"><img src="../Images/f7c8a599d5237771b8860c7c8d5c4e77.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9UhHkvTAQRVAWdOp9MsMuQ.png"/></div></div></figure><p id="63ff" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">经典的线性回归图像，但你知道吗，它背后的数学是<strong class="kk iu">甚至</strong>更性感。让我们揭开它。</p><p id="b6a0" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在开始之前，您应该了解</p><blockquote class="lr ls lt"><p id="8174" class="ki kj lu kk b kl km ju kn ko kp jx kq lv ks kt ku lw kw kx ky lx la lb lc ld im bi translated">偏导数</p><p id="fe4b" class="ki kj lu kk b kl km ju kn ko kp jx kq lv ks kt ku lw kw kx ky lx la lb lc ld im bi translated">总和</p></blockquote></div><div class="ab cl ly lz hx ma" role="separator"><span class="mb bw bk mc md me"/><span class="mb bw bk mc md me"/><span class="mb bw bk mc md"/></div><div class="im in io ip iq"><h1 id="4006" class="mf mg it bd mh mi mj mk ml mm mn mo mp jz mq ka mr kc ms kd mt kf mu kg mv mw bi translated"><strong class="ak">准备好寻找最适合的线条了吗？</strong></h1><h2 id="34d3" class="mx mg it bd mh my mz dn ml na nb dp mp kr nc nd mr kv ne nf mt kz ng nh mv ni bi translated">让我们从定义几件事情开始。</h2><ol class=""><li id="25be" class="nj nk it kk b kl nl ko nm kr nn kv no kz np ld nq nr ns nt bi translated">给定 N 个输入和输出…</li></ol><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/d5fdcdc49103dc7d380fb4ba330dcfdc.png" data-original-src="https://miro.medium.com/v2/resize:fit:246/format:webp/1*JD96_Lf8kXdaAyP7xet7kw.png"/></div></figure><p id="5982" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">2.我们将最佳拟合线定义为…</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/0fa0c6b32ff90b33c059acbc397e1300.png" data-original-src="https://miro.medium.com/v2/resize:fit:462/format:webp/1*dfv-aZ1r5iyGf1ZNDmqZFg.png"/></div></figure><p id="fa14" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">3.使得最佳拟合线看起来最小化我们命名为 S 的成本函数…</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/e40491a15b4130ca8ff10c3815eeb6a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:718/format:webp/1*igxhwJsE9O5ZPumQjON69A.png"/></div></figure><p id="ed54" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">作为参考，我们将把最佳拟合线输入到分配减法的成本函数中，结果是…</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/8714a853c2651817652609ac2ea075a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:920/format:webp/1*jkaTM6cPUqUA-4apDUavgQ.png"/></div></figure></div><div class="ab cl ly lz hx ma" role="separator"><span class="mb bw bk mc md me"/><span class="mb bw bk mc md me"/><span class="mb bw bk mc md"/></div><div class="im in io ip iq"><p id="a7fb" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">为了最小化我们的成本函数 S，我们必须找到 S 相对于<strong class="kk iu"> a </strong>和<strong class="kk iu"> B 的一阶导数等于 0 的位置。</strong>a<strong class="kk iu">a</strong>和<strong class="kk iu"> B </strong>越接近 0，每个点的总误差越小。先从<strong class="kk iu"> a </strong>的<a class="ae le" href="https://mathinsight.org/partial_derivative_introduction" rel="noopener ugc nofollow" target="_blank">偏导数</a>说起。</p></div><div class="ab cl ly lz hx ma" role="separator"><span class="mb bw bk mc md me"/><span class="mb bw bk mc md me"/><span class="mb bw bk mc md"/></div><div class="im in io ip iq"><h1 id="1d25" class="mf mg it bd mh mi mj mk ml mm mn mo mp jz mq ka mr kc ms kd mt kf mu kg mv mw bi translated"><strong class="ak">找一个</strong></h1><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/d86eaa5af1903644b8cb982069b1e8df.png" data-original-src="https://miro.medium.com/v2/resize:fit:934/format:webp/1*_SaRI7-cjGpjdB-H1GU0Zw.png"/></div></figure><p id="6267" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">使用链式法则，从指数开始，然后是括号中的等式。注意，对括号之间的方程求导可以简化为<strong class="kk iu"> -1 </strong>。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi nz"><img src="../Images/49d589c0d6e8b49cc0b32d63c866786a.png" data-original-src="https://miro.medium.com/v2/resize:fit:996/format:webp/1*K2fcejAVD2FofiACwDDvWw.png"/></div></figure><p id="7ddd" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们从求和中取出-2，然后将两个方程除以-2。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi oa"><img src="../Images/224c520d88226711bedba29a72c85c18.png" data-original-src="https://miro.medium.com/v2/resize:fit:870/format:webp/1*sUioFSJOYvAnY0qhOms05Q.png"/></div></figure><p id="3816" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们做一些半聪明的事情。让我们把总和分成 3 部分，把常数 B 从总和中抽出来</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/9ad03da30ee9c7bded243597c4dfb80a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1114/format:webp/1*EkWA46l-qMkvtzpDxhuodA.png"/></div></figure><p id="70dd" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们注意到 a 到 n 的和只是…</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/a9666c95f120c81f7f0b480248c9c8f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:430/format:webp/1*HJJpoGjM60N6pztGRh06sQ.png"/></div></figure><p id="099e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">把这个代入并重新排列 B，给我们…</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi od"><img src="../Images/84b7b5c2e3f345bbcb5d7695f1dfa6e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1026/format:webp/1*2qCzJT6V7ukgjoFV30DaSg.png"/></div></figure><p id="d12a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们快到了！我们需要做的最后一件事是求解<strong class="kk iu"> a，</strong>所以我们将<strong class="kk iu"> na </strong>加到两边，然后除以<strong class="kk iu"> n </strong>。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi oe"><img src="../Images/22a64c9ca72d7371b22a00a682162cf9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*jLlu68DYDfsnXV0jE4aiGw.png"/></div></figure><p id="81f8" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">看看这个。Y 和 x 的两个总和除以观察次数就是平均值:)。所以在所有这些工作之后，最小化相对于<strong class="kk iu"> a </strong>的<strong class="kk iu"> S </strong>的成本函数是简单的…</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi of"><img src="../Images/4b1e5ef6f8b296b332dd462aa48ada6b.png" data-original-src="https://miro.medium.com/v2/resize:fit:480/format:webp/1*DItN9YstG4OAOatyNJa6cA.png"/></div></figure></div><div class="ab cl ly lz hx ma" role="separator"><span class="mb bw bk mc md me"/><span class="mb bw bk mc md me"/><span class="mb bw bk mc md"/></div><div class="im in io ip iq"><h1 id="2c77" class="mf mg it bd mh mi mj mk ml mm mn mo mp jz mq ka mr kc ms kd mt kf mu kg mv mw bi translated"><strong class="ak">调查结果 B </strong></h1><p id="6ce4" class="pw-post-body-paragraph ki kj it kk b kl nl ju kn ko nm jx kq kr og kt ku kv oh kx ky kz oi lb lc ld im bi translated">我们已经最小化了 S 相对于 a 的成本函数，让我们找到 S 相对于 b 的最后一部分。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/1fd4d8609d415194c39e7e44019c4885.png" data-original-src="https://miro.medium.com/v2/resize:fit:934/format:webp/1*IwWCl-OgPGSTJwE1UvAJyA.png"/></div></figure><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/53ac7967c652c8d72850a4fc76224bd2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1076/format:webp/1*Bs2r9MFuuBd1I9cNd-ALmw.png"/></div></figure><p id="548a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们把-2 剥掉，两边分。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi ok"><img src="../Images/36c243335f6b2699539226b4237fc1b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:962/format:webp/1*zX_JncHZqUlOcUrEIw4Cxg.png"/></div></figure><p id="4abe" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">为了便于查看，我们来分发 x。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi ol"><img src="../Images/d54d6e26e57002faf8d5a7a486ce9456.png" data-original-src="https://miro.medium.com/v2/resize:fit:1038/format:webp/1*t9HNFA6yGMwh4z5UWpvl1A.png"/></div></figure><p id="e5e2" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在，让我们做一些有创意的事情。还记得我们已经解决了。我们把<strong class="kk iu"> a </strong>(下面推导的公式)代入 S 关于上面 B 的偏导数。我们这样做是为了得到一个只有 x 和 y 的 a 和 B 的函数。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi of"><img src="../Images/4b1e5ef6f8b296b332dd462aa48ada6b.png" data-original-src="https://miro.medium.com/v2/resize:fit:480/format:webp/1*DItN9YstG4OAOatyNJa6cA.png"/></div></figure><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi om"><img src="../Images/3899acdb8d8741265b5656e9d62cdcd5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1354/format:webp/1*H-tKxqHg50e_8UMx7gxeMA.png"/></div></figure><p id="e813" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们分配负号和 x</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi on"><img src="../Images/f91ac67a7c7e61ad3149cd792f44d046.png" data-original-src="https://miro.medium.com/v2/resize:fit:1362/format:webp/1*plsB8V6qfdEnPV-xn5UW8g.png"/></div></figure><p id="a18e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这看起来很乱，但代数在这方面很厉害。让我们把总数分成两笔。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi oo"><img src="../Images/45772a2b4eb5a5d93cd5c27df80aeaf0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rYcuirM1qg60UG84vr48pQ.png"/></div></div></figure><p id="3e30" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们把右边的求和项中的<strong class="kk iu"> -B </strong>去掉，这样我们就可以分离出变量，并重新排列求和项中剩余的项。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi op"><img src="../Images/8ae21337a751dd6a7e7e72c7e3ef9d29.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1-Rhdw9rkKGjcsE8xUj58w.png"/></div></div></figure><p id="be0c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">通过减去第一个总和并除以第二个总和来隔离 B。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi oq"><img src="../Images/4bdf5524ef3665fd3b071d52bcb3ee0e.png" data-original-src="https://miro.medium.com/v2/resize:fit:924/format:webp/1*mG-E3M2Oml5xfYsXVKXQ6A.png"/></div></figure><p id="6d33" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们做到了！我们现在已经根据 x 和 y 分离出了<strong class="kk iu"> B </strong>和<strong class="kk iu"> a </strong>。这看起来像一个可怕的公式！不要担心，通过进一步操作公式，还有更简单的版本——你可以在这里查看这些<a class="ae le" href="https://www.andrews.edu/~calkins/math/edrm611/edrm06.htm" rel="noopener ugc nofollow" target="_blank"/>。</p></div><div class="ab cl ly lz hx ma" role="separator"><span class="mb bw bk mc md me"/><span class="mb bw bk mc md me"/><span class="mb bw bk mc md"/></div><div class="im in io ip iq"><h1 id="429a" class="mf mg it bd mh mi mj mk ml mm mn mo mp jz mq ka mr kc ms kd mt kf mu kg mv mw bi translated"><strong class="ak">总结一下:)</strong></h1><p id="50bb" class="pw-post-body-paragraph ki kj it kk b kl nl ju kn ko nm jx kq kr og kt ku kv oh kx ky kz oi lb lc ld im bi translated">如果数据集只有一个独立变量，可以通过计算<strong class="kk iu"> B </strong>找到最佳拟合线</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi oq"><img src="../Images/4bdf5524ef3665fd3b071d52bcb3ee0e.png" data-original-src="https://miro.medium.com/v2/resize:fit:924/format:webp/1*mG-E3M2Oml5xfYsXVKXQ6A.png"/></div></figure><p id="94ff" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后将<strong class="kk iu"> B </strong>代入<strong class="kk iu"> a </strong></p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi of"><img src="../Images/4b1e5ef6f8b296b332dd462aa48ada6b.png" data-original-src="https://miro.medium.com/v2/resize:fit:480/format:webp/1*DItN9YstG4OAOatyNJa6cA.png"/></div></figure><p id="6cff" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">最后，将<strong class="kk iu"> B </strong>和<strong class="kk iu"> a </strong>代入最佳拟合线！</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/0fa0c6b32ff90b33c059acbc397e1300.png" data-original-src="https://miro.medium.com/v2/resize:fit:462/format:webp/1*dfv-aZ1r5iyGf1ZNDmqZFg.png"/></div></figure><h1 id="cf04" class="mf mg it bd mh mi or mk ml mm os mo mp jz ot ka mr kc ou kd mt kf ov kg mv mw bi translated">向前移动</h1><p id="4083" class="pw-post-body-paragraph ki kj it kk b kl nl ju kn ko nm jx kq kr og kt ku kv oh kx ky kz oi lb lc ld im bi translated">那么…有多个自变量的数据集呢？我们能找到最适合这些的路线吗？你打赌！我们很快会讨论多元线性回归。同时，看看本系列的第 3 部分，我们将上面的方程与 Sklearn 的线性模型进行了比较。</p></div></div>    
</body>
</html>