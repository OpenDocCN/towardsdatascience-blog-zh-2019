# é¢å‘æ•°æ®ç§‘å­¦å®¶çš„ SQL ç®€å•ä»‹ç»

> åŸæ–‡ï¼š<https://towardsdatascience.com/an-easy-introduction-to-sql-for-data-scientists-83363ae004b9?source=collection_archive---------6----------------------->

![](img/e42dcd0b2983396c452048ebae38ff4a.png)

> æƒ³è·å¾—çµæ„Ÿï¼Ÿå¿«æ¥åŠ å…¥æˆ‘çš„ [**è¶…çº§è¡Œæƒ…å¿«è®¯**](https://www.superquotes.co/?utm_source=mediumtech&utm_medium=web&utm_campaign=sharing) ã€‚ğŸ˜

SQL(ç»“æ„åŒ–æŸ¥è¯¢è¯­è¨€)æ˜¯ä¸€ç§ä¸ºæ•°æ®å­˜å‚¨å’Œç®¡ç†è€Œè®¾è®¡çš„æ ‡å‡†åŒ–ç¼–ç¨‹è¯­è¨€ã€‚å®ƒå…è®¸äººä»¬å¿«é€Ÿã€è½»æ¾åœ°åˆ›å»ºã€è§£æå’Œæ“ä½œæ•°æ®ã€‚

éšç€è¿‘å¹´æ¥äººå·¥æ™ºèƒ½çš„å¤§è‚†å®£ä¼ ï¼ŒæœåŠ¡äºå„ç§è¡Œä¸šçš„æŠ€æœ¯å…¬å¸è¢«è¿«å˜å¾—æ›´åŠ æ•°æ®é©±åŠ¨ã€‚å½“ä¸€å®¶ä¸ºæ•°ä»¥åƒè®¡çš„å®¢æˆ·æä¾›æœåŠ¡çš„å…¬å¸ç”±æ•°æ®é©±åŠ¨æ—¶ï¼Œä»–ä»¬å°†éœ€è¦ä¸€ç§æ–¹æ³•æ¥å­˜å‚¨å’Œé¢‘ç¹è®¿é—®å¤§çº¦*æ•°ç™¾ä¸‡*ç”šè‡³*æ•°åäº¿*ä¸ªæ•°æ®ç‚¹çš„æ•°æ®ã€‚

è¿™å°±æ˜¯ SQL çš„ç”¨æ­¦ä¹‹åœ°ã€‚

SQL å¾ˆå—æ¬¢è¿ï¼Œå› ä¸ºå®ƒæ—¢å¿«åˆå®¹æ˜“ç†è§£ã€‚å®ƒè¢«è®¾è®¡æˆä»¥ç±»ä¼¼äºè‹±è¯­çš„æ–¹å¼é˜…è¯»å’Œä¹¦å†™ã€‚å½“ä½¿ç”¨ SQL æŸ¥è¯¢æ¥æ£€ç´¢æ•°æ®æ—¶ï¼Œæ•°æ®ä¸ä¼šè¢«å¤åˆ¶åˆ°ä»»ä½•åœ°æ–¹ï¼Œè€Œæ˜¯ç›´æ¥åœ¨å­˜å‚¨æ•°æ®çš„åœ°æ–¹è¢«è®¿é—®ï¼Œè¿™ä½¿å¾—è¯¥è¿‡ç¨‹æ¯”å…¶ä»–æ–¹æ³•å¿«å¾—å¤šã€‚

æœ¬æ•™ç¨‹å°†æ•™æ‚¨ SQL çš„åŸºç¡€çŸ¥è¯†ï¼ŒåŒ…æ‹¬:

*   åˆ›å»ºæ•°æ®åº“è¡¨
*   ç”¨çœŸå®æ•°æ®å¡«å……æ•°æ®åº“è¡¨
*   æ£€ç´¢æ•°æ®ä»¥ç”¨äºæ•°æ®ç§‘å­¦æˆ–æœºå™¨å­¦ä¹ ä»»åŠ¡

è®©æˆ‘ä»¬ç›´æ¥å¼€å§‹å§ï¼

# å®‰è£… MySQL

æˆ‘ä»¬è¦åšçš„ç¬¬ä¸€ä»¶äº‹å°±æ˜¯å®‰è£…æˆ‘ä»¬çš„ SQL serverï¼è¿™å°†ä¸ºæˆ‘ä»¬æä¾›ä¸€ä¸ªå·¥ä½œå°ï¼Œå¼€å§‹ä½¿ç”¨æ•°æ®åº“å’Œ SQL æŸ¥è¯¢ã€‚

è¦å®‰è£… MySQL æœåŠ¡å™¨ï¼Œæ‚¨å¯ä»¥ä»ç»ˆç«¯è¿è¡Œä»¥ä¸‹å‘½ä»¤:

```
sudo apt-get install mysql-server
```

ç°åœ¨æˆ‘ä»¬å°†å¯åŠ¨æˆ‘ä»¬çš„ MySQL æœåŠ¡å™¨ã€‚è¿™ç±»ä¼¼äºæˆ‘ä»¬åœ¨ç»ˆç«¯ä¸­é€šè¿‡é”®å…¥â€œpythonâ€æ¥å¯åŠ¨ Pythonã€‚è¿™é‡Œå”¯ä¸€çš„åŒºåˆ«æ˜¯ç»™æˆ‘ä»¬çš„æœåŠ¡å™¨ root ç‰¹æƒå¾ˆæ–¹ä¾¿ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥çµæ´»åœ°è®¿é—®ä»»ä½•ä¸œè¥¿ã€‚

```
sudo mysql -u root -p
```

å¤ªå¥½äº†ï¼ç°åœ¨æˆ‘ä»¬çš„ mysql æœåŠ¡å™¨æ­£åœ¨è¿è¡Œï¼Œæˆ‘ä»¬å¯ä»¥å¼€å§‹å‘å‡º MySQL å‘½ä»¤äº†ã€‚

åœ¨æˆ‘ä»¬ç»§ç»­å‰è¿›ä¹‹å‰ï¼Œéœ€è¦è®°ä½å‡ ä»¶äº‹:

*   æ‰€æœ‰ MySQL å‘½ä»¤éƒ½ä»¥åˆ†å·ç»“å°¾ã€‚å¦‚æœä½ è¾“å…¥çš„å‘½ä»¤ä¸æ˜¯ä»¥åˆ†å·ç»“å°¾ï¼Œé‚£ä¹ˆå®ƒå°±ä¸èµ·ä½œç”¨ï¼
*   MySQL å‘½ä»¤é€šå¸¸ä»¥å¤§å†™å­—æ¯ä¹¦å†™ï¼Œè€Œä»»ä½•ç”¨æˆ·å®šä¹‰çš„æ–‡æœ¬æˆ–æ•°å­—éƒ½ä»¥å°å†™å­—æ¯ä¹¦å†™ï¼Œä»¥ä¾¿äºåŒºåˆ†ã€‚è¿™å¹¶ä¸æ˜¯ä¸¥æ ¼è¦æ±‚çš„(å¦‚æœä¸éµå¾ªè¿™ä¸€ç‚¹ï¼Œæ‚¨ä¸ä¼šå¾—åˆ°ä»»ä½•é”™è¯¯)ï¼Œä½†æ˜¯ä¸ºäº†å¯è¯»æ€§ï¼Œé€šå¸¸æ¨èè¿™æ ·åšã€‚

# åˆ›å»º SQL æ•°æ®åº“å’Œè¡¨

ç°åœ¨æˆ‘ä»¬å‡†å¤‡åˆ›å»ºæˆ‘ä»¬çš„ç¬¬ä¸€ä¸ª SQL æ•°æ®åº“ã€‚

[*æ•°æ®åº“*](http://en.wikipedia.org/wiki/Database) æ˜¯æœ‰ç»„ç»‡çš„æ•°æ®é›†åˆã€‚å®é™…ä¸Šï¼Œæ‚¨å¯ä»¥å°†æ•°æ®åº“è§†ä¸ºå±‚æ¬¡ç»“æ„ä¸­çš„æœ€é«˜çº§åˆ«ã€‚

ä¸€ä¸ª*è¡¨*åœ¨è¡Œ(å…ƒç»„)å’Œåˆ—(å±æ€§)ä¸­å­˜å‚¨æ•°æ®ã€‚ä¸€ä¸ªæ•°æ®åº“å¯ä»¥å¹¶ä¸”é€šå¸¸ç”±å¤šä¸ªè¡¨ç»„æˆ

åœ¨æœ¬æ•™ç¨‹çš„å…¶ä½™éƒ¨åˆ†ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨è¶³çƒ(æˆ–è€…æ‚¨å–œæ¬¢çš„è¶³çƒ)è¿åŠ¨å‘˜çš„ç»Ÿè®¡æ•°æ®ä½œä¸ºæ•°æ®åº“ä¸­çš„æ•°æ®ã€‚

æˆ‘ä»¬è¦åšçš„ç¬¬ä¸€ä»¶äº‹æ˜¯ç”¨â€œcreateâ€å‘½ä»¤åˆ›å»ºä¸€ä¸ªåä¸ºâ€œsoccer_dataâ€çš„æ•°æ®åº“ã€‚ç„¶åï¼Œæˆ‘ä»¬å¯ä»¥ç”¨â€œUSEâ€å‘½ä»¤â€œæ¿€æ´»â€æˆ‘ä»¬çš„æ–°æ•°æ®åº“ã€‚

```
CREATE DATABASE soccer_stats
USE soccer_stats
```

å°±åƒæˆ‘ä»¬åœ¨ Excel æˆ– Google Sheets ä¸­åˆ›å»ºä»»ä½•è¡¨æ ¼ä¸€æ ·ï¼Œæˆ‘ä»¬å°†å®šä¹‰æ¯ä¸€åˆ—çš„åç§°ï¼Œä»¥åŠè¯¥åˆ—ä¸­çš„æ•°æ®ç±»å‹ã€‚

æˆ‘ä»¬çš„â€œç»Ÿè®¡â€è¡¨å°†è·Ÿè¸ªæ¯ä¸ªè¶³çƒè¿åŠ¨å‘˜çš„è¿›çƒã€åŠ©æ”»ã€å¾—åˆ†å’Œå°„é—¨æ¬¡æ•°:

```
CREATE TABLE stats (id INTEGER NOT NULL PRIMARY KEY AUTO_INCREMENT, name TEXT, goals INTEGER, assists INTEGER, points INTEGER, shots INTEGER);
```

ä¸Šé¢çš„å‘½ä»¤ä¸ºæˆ‘ä»¬åšäº†å‡ ä»¶äº‹:

1.  å®ƒåœ¨â€œsoccer_statsâ€æ•°æ®åº“ä¸­åˆ›å»ºäº†ä¸€ä¸ªåä¸ºâ€œstatsâ€çš„è¡¨
2.  æˆ‘ä»¬åœ¨è¡¨æ ¼ä¸­è®¾ç½®äº† 6 åˆ—â€”â€”idã€å§“åã€è¿›çƒã€åŠ©æ”»ã€å¾—åˆ†å’Œå°„é—¨
3.  å¯¹äºæ¯ä¸€åˆ—ï¼Œæˆ‘ä»¬å·²ç»å®šä¹‰äº†å¸Œæœ›è¯¥åˆ—å­˜å‚¨çš„æ•°æ®ç±»å‹ã€‚
4.  â€œidâ€åˆ—æœ‰ä¸€ä¸ªç‰¹æ®Šçš„ç±»å‹(INTEGER NOT NULL PRIMARY KEY AUTO _ INCREMENT ),å®ƒè‡ªåŠ¨å¯¹æ¯ä¸€è¡Œè¿›è¡Œç¼–å·ã€‚åœ¨æ„å»º SQL è¡¨æ—¶ï¼Œæœ€å¥½ç»™æ¯ä¸€è¡Œä¸€ä¸ªæƒŸä¸€çš„ idï¼Œä»¥é˜²ä¸¤è¡Œæ•°æ®å®Œå…¨ç›¸åŒã€‚

æˆ‘ä»¬å¯ä»¥æ£€æŸ¥æ•°æ®åº“ä¸­æœ‰å“ªäº›è¡¨ï¼Œå¦‚ä¸‹æ‰€ç¤º:

```
SHOW TABLES;+------------------------+
| Tables_in_soccer_stats |
+------------------------+
| stats                  |
+------------------------+
```

æ›´è¿›ä¸€æ­¥ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°å…³äºæˆ‘ä»¬æ–°åˆ›å»ºçš„è¡¨çš„ä¸€äº›ä¿¡æ¯:

```
DESCRIBE stats;+---------+---------+------+-----+---------+----------------+
| Field   | Type    | Null | Key | Default | Extra          |
+---------+---------+------+-----+---------+----------------+
| id      | int(11) | NO   | PRI | NULL    | auto_increment |
| name    | text    | YES  |     | NULL    |                |
| goals   | int(11) | YES  |     | NULL    |                |
| assists | int(11) | YES  |     | NULL    |                |
| points  | int(11) | YES  |     | NULL    |                |
| shots   | int(11) | YES  |     | NULL    |                |
+---------+---------+------+-----+---------+----------------+
```

# å‘æˆ‘ä»¬çš„ SQL è¡¨æ·»åŠ æ•°æ®

ç°åœ¨æˆ‘ä»¬å¼€å§‹ç”¨è¶³çƒç»Ÿè®¡æ•°æ®å¡«å……æˆ‘ä»¬çš„è¡¨ï¼

è¿˜è®°å¾—æˆ‘è¯´è¿‡ SQL éå¸¸æ˜“è¯»å—ï¼Ÿå¯ä»¥ä½¿ç”¨åä¸º INSERT çš„å‘½ä»¤å°†æ•°æ®æ’å…¥åˆ°æˆ‘ä»¬çš„è¡¨ä¸­ï¼Œè¯¥å‘½ä»¤åè·Ÿè¡¨åå’Œæˆ‘ä»¬æƒ³è¦æ’å…¥çš„æ•°æ®çš„ç®€å•å…ƒç»„ã€‚

```
INSERT INTO stats VALUES (NULL, "John", 26, 22, 26+22, 104);
INSERT INTO stats VALUES (NULL, "Jessica", 126, 82, 126+82, 312);
INSERT INTO stats VALUES (NULL, "Nick", 8, 25, 8+25, 51);
INSERT INTO stats VALUES (NULL, "Mike", 52, 12, 52+12, 174);
INSERT INTO stats VALUES (NULL, "Katie", 26, 92, 26+92, 188);
```

æ’å…¥æ•°æ®æ—¶è¦è®°ä½å‡ ä»¶äº‹:

*   æˆ‘ä»¬å¯ä»¥å°† id è®¾ç½®ä¸º NULLï¼Œå› ä¸ºå®ƒä¼šè‡ªåŠ¨é€’å¢(å¦‚å‰ä¸€èŠ‚æ‰€è¿°)
*   è¯·ç¡®ä¿æ­£åœ¨æ’å…¥çš„æ•°æ®çš„æ•°æ®ç±»å‹ä¸å·²å®šä¹‰çš„è¡¨çš„æ•°æ®ç±»å‹ç›¸åŒ¹é…

è¦æ˜¾ç¤ºè¡¨ä¸­çš„æ‰€æœ‰æ•°æ®ï¼Œåªéœ€è¿è¡Œ:

```
SELECT * FROM stats;+----+---------+-------+---------+--------+-------+
| id | name    | goals | assists | points | shots |
+----+---------+-------+---------+--------+-------+
|  1 | John    |    26 |      22 |     48 |   104 |
|  2 | Jessica |   126 |      82 |    208 |   312 |
|  3 | Nick    |     8 |      25 |     33 |    31 |
|  4 | Mike    |    52 |      12 |     64 |   174 |
|  5 | Katie   |    26 |      92 |    118 |    88 |
+----+---------+-------+---------+--------+-------+
```

è¿™æ˜¯æˆ‘ä»¬æ‰€æœ‰çš„è¶³çƒæ•°æ®ã€‚

è¯·æ³¨æ„â€œSELECT *â€æ˜¯å¦‚ä½•ä»æˆ‘ä»¬çš„è¡¨ä¸­è·å–æ‰€æœ‰å†…å®¹çš„ã€‚å¦‚æœæ‚¨åªéœ€è¦ç›®æ ‡çš„åç§°å’Œæ•°é‡ï¼Œæ‚¨å¯ä»¥æŒ‡å®šè¦æ£€ç´¢çš„åˆ—:

```
SELECT name,goals FROM stats;
+---------+-------+
| name    | goals |
+---------+-------+
| John    |    26 |
| Jessica |   126 |
| Nick    |     8 |
| Mike    |    52 |
| Katie   |    26 |
+---------+-------+
```

è¦æ›´æ–°è¡¨ä¸­çš„ä¸€è¡Œï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨â€¦..ä½ çŒœå¯¹äº†ï¼Œæ›´æ–°å‘½ä»¤ï¼

```
UPDATE stats SET goals=28 WHERE name="John";
SELECT * FROM stats;+----+---------+-------+---------+--------+-------+
| id | name    | goals | assists | points | shots |
+----+---------+-------+---------+--------+-------+
|  1 | John    |    28 |      22 |     48 |   104 |
|  2 | Jessica |   126 |      82 |    208 |   312 |
|  3 | Nick    |     8 |      25 |     33 |    31 |
|  4 | Mike    |    52 |      12 |     64 |   174 |
|  5 | Katie   |    26 |      92 |    118 |    88 |
+----+---------+-------+---------+--------+-------+
```

åœ¨ä¸Šé¢çš„æŸ¥è¯¢ä¸­:

*   æ›´æ–°å…è®¸æˆ‘ä»¬é€‰æ‹©è¦æ›´æ–°æ•°æ®çš„è¡¨
*   SET æ‰§è¡Œå®é™…çš„æ›´æ–°
*   å…¶ä¸­å®šä¹‰äº†å“ªä¸ªæ•°æ®å•å…ƒå°†æ¥æ”¶ç‰¹å®šçš„æ›´æ–°

# ä½¿ç”¨ SQL æŸ¥è¯¢æ£€ç´¢æ•°æ®

ç°åœ¨æˆ‘ä»¬å·²ç»ç”¨æ•°æ®å¡«å……äº†è¡¨ï¼Œæˆ‘ä»¬å°†å­¦ä¹ å¦‚ä½•å®é™…æ£€ç´¢å®ƒã€‚å¯¹äºé‚£äº›ä»äº‹æ•°æ®ç§‘å­¦æˆ–æœºå™¨å­¦ä¹ çš„äººæ¥è¯´ï¼Œè¿™å°†æ˜¯å¤§é‡ SQL å·¥ä½œçš„åœ°æ–¹â€”â€”æ£€ç´¢æ•°æ®ï¼Œä¸ºæ¢ç´¢å’ŒåŸ¹è®­åšå‡†å¤‡ã€‚

åœ¨ä¸Šä¸€èŠ‚ä¸­ï¼Œæ‚¨å·²ç»ä½¿ç”¨ SELECT å‘½ä»¤å®Œæˆäº†ä¸€ä¸ªæŸ¥è¯¢ã€‚è¿™æ¬¡æˆ‘ä»¬å°†è¿è¡Œä¸€äº›æ›´å¤æ‚çš„æŸ¥è¯¢ã€‚

æˆ‘ä»¬å¯ä»¥é™åˆ¶æ£€ç´¢çš„è¡Œæ•°:

```
SELECT * FROM stats LIMIT 3;+----+---------+-------+---------+--------+-------+
| id | name    | goals | assists | points | shots |
+----+---------+-------+---------+--------+-------+
|  1 | John    |    28 |      22 |     48 |   104 |
|  2 | Jessica |   126 |      82 |    208 |   312 |
|  3 | Nick    |     8 |      25 |     33 |    31 |
+----+---------+-------+---------+--------+-------+
```

æˆ–è€…æ ¹æ®çƒå‘˜çš„è¿›çƒæ•°å¯¹æˆ‘ä»¬çš„è¾“å‡ºè¿›è¡Œæ’åº:

```
SELECT * FROM stats ORDER BY goals DESC;+----+---------+-------+---------+--------+-------+
| id | name    | goals | assists | points | shots |
+----+---------+-------+---------+--------+-------+
|  2 | Jessica |   126 |      82 |    208 |   312 |
|  4 | Mike    |    52 |      12 |     64 |   174 |
|  1 | John    |    28 |      22 |     48 |   104 |
|  5 | Katie   |    26 |      92 |    118 |    88 |
|  3 | Nick    |     8 |      25 |     33 |    31 |
+----+---------+-------+---------+--------+-------+
```

æˆ‘ä»¬å¯ä»¥å°† SELECT è¯­å¥ä¸ WHERE å‘½ä»¤ç»“åˆèµ·æ¥ï¼Œåˆ›å»ºä¸€ç§ç”¨äºæ£€ç´¢æ•°æ®çš„ if-else æŸ¥è¯¢:

```
SELECT * FROM stats WHERE goals > 20 and assists > 50;+----+---------+-------+---------+--------+-------+
| id | name    | goals | assists | points | shots |
+----+---------+-------+---------+--------+-------+
|  2 | Jessica |   126 |      82 |    208 |   312 |
|  5 | Katie   |    26 |      92 |    118 |    88 |
+----+---------+-------+---------+--------+-------+
```

MySQL ç”šè‡³ä¸ºæˆ‘ä»¬æä¾›äº†æ‰§è¡Œè®¡ç®—çš„èƒ½åŠ›ã€‚çœ‹çœ‹æˆ‘ä»¬å¦‚ä½•è®¡ç®—æ¯ä¸ªçƒå‘˜çš„æŠ•ç¯®å‘½ä¸­ç‡ï¼Œå¹¶æ ¹æ®è¿™äº›æ•°å­—å¯¹è¡¨æ ¼è¿›è¡Œæ’åº:

```
SELECT *, points/shots FROM stats ORDER BY points / shots DESC;+----+---------+-------+---------+--------+-------+--------------+
| id | name    | goals | assists | points | shots | points/shots |
+----+---------+-------+---------+--------+-------+--------------+
|  2 | Jessica |   126 |      82 |    208 |   312 |       0.6667 |
|  3 | Nick    |     8 |      25 |     33 |    51 |       0.6471 |
|  5 | Katie   |    26 |      92 |    118 |   188 |       0.6277 |
|  1 | John    |    28 |      22 |     48 |   104 |       0.4615 |
|  4 | Mike    |    52 |      12 |     64 |   174 |       0.3678 |
+----+---------+-------+---------+--------+-------+--------------+
```

æˆ‘ä»¬å¯¹ SQL çš„ç®€å•ä»‹ç»åˆ°æ­¤ç»“æŸï¼

å¦‚æœä½ æƒ³ç»ƒä¹ ä½¿ç”¨ SQL æŸ¥è¯¢ï¼Œæˆ‘å¼ºçƒˆå»ºè®®ä½ è¯•è¯• [HackerRank challenges](https://www.hackerrank.com/domains/sql) ï¼Œå®ƒå·²ç»ä¸ºæŸ¥è¯¢ç»ƒä¹ æä¾›äº†é¢„æ„å»ºçš„æ•°æ®åº“å’Œè¡¨æ ¼ã€‚

# å–œæ¬¢å­¦ä¹ ï¼Ÿ

åœ¨[æ¨ç‰¹](https://twitter.com/GeorgeSeif94)ä¸Šå…³æ³¨æˆ‘ï¼Œæˆ‘ä¼šåœ¨é‚£é‡Œå‘å¸ƒæ‰€æœ‰æœ€æ–°æœ€æ£’çš„äººå·¥æ™ºèƒ½ã€æŠ€æœ¯å’Œç§‘å­¦ï¼ä¹Ÿåœ¨ [LinkedIn](https://www.linkedin.com/in/georgeseif/) ä¸Šå’Œæˆ‘è”ç³»å§ï¼