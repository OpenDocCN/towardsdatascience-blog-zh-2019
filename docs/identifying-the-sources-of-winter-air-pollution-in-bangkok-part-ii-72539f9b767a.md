# 确定曼谷冬季空气污染的来源第二部分

> 原文：<https://towardsdatascience.com/identifying-the-sources-of-winter-air-pollution-in-bangkok-part-ii-72539f9b767a?source=collection_archive---------1----------------------->

![](img/2da8bf20cf4e4ad6d4a4e8760c003ce7.png)

Mae Fah Luang University Campus on March 2019\. (Photo by MFU Photoclub with permission)

在之前的[博客](/identifying-the-sources-of-winter-air-pollution-in-bangkok-part-i-d4392ea608dc)里，我看了一下曼谷冬天的空气污染。主要污染源来自小于 2.5 微米的颗粒物(PM 2.5 颗粒物)。这些颗粒比人类头发的宽度还小，可以很容易地进入我们的身体，甚至进入我们的血液。上周(2019 年 3 月 17 日)，泰国北部多个省份因颗粒污染出现全球最差的空气质量指数(AQI)。到目前为止，还没有提出长期的解决方案，因为 PM 2.5 颗粒污染的来源还没有明确指出。在这本笔记本中，我通过机器学习模型识别了曼谷高 PM 2.5 颗粒物的来源。代码可以在我的 [GitHub](https://github.com/worasom/aqi_thailand) 页面找到。

# 高 PM2.5，罪魁祸首是谁？

关于曼谷的空气污染源有三个主要的理论:(1)[逆温效应](https://sciencing.com/effects-temperature-inversion-8447465.html)，冷空气和污染物被困在接近地球表面的地方。这一理论是政府在 2019 年冬季开始时提出的。政府将污染归咎于旧柴油发动机的排放。(2)农业焚烧，无论是本地的还是周边省份的。在冬天，全国各地都有大量露天农业焚烧。一些官员试图通过减少露天农业燃烧来解决空气污染问题。(3)来自其他省份或国家的污染。一些非政府组织将污染归咎于发电厂附近。

我的分析过程如下:建立一个机器学习模型(ML)来预测曼谷的空气污染水平，使用环境因素，如天气，交通指数和火灾地图。在模型中包括日期-时间特征，如当地时间、工作日与周末，以捕捉人类活动的其他影响。使用 ML 模型提供的重要性特征识别主要污染源。

如果污染源是本地的，那么空气质量指数将取决于天气模式(风速、湿度、平均温度)、本地交通和一天中的时间等因素。如果污染来自农业燃烧，空气质量指数将取决于活跃的火灾，并有一定的时间滞后，以说明地理分离。根据与曼谷的距离，包括消防活动。另一方面，如果污染与火灾地图不相关，那么模型应该更加重视天气模式，例如风向和风速。

以下是我考虑的特性及其数据来源的列表:

*   来自美国宇航局[公司](https://firms.modaps.eosdis.nasa.gov)项目的主动火力信息
*   天气模式:温度、风速、湿度和降雨，从天气地下网站上刮来
*   交通指数来自[龙道交通](http://traffic.longdo.com/trafficindex)
*   日期时间特性:一天中的小时、一天中的时间和假日模式(在第一部分博客文章中探讨)

让我首先介绍一下该模型中包含的所有功能。

# 农业烧荒是个大问题！

东南亚的农民选择一月至三月作为焚烧季节。对于泰国北部和东北部省份来说，这些燃烧活动的规模足以使这些省份成为这段时间世界上污染最严重的地方之一。对于曼谷，有人可能会说，因为该地区是重工业而不是农业，它可能不会受到农业燃烧的影响。但事实并非如此。

由于 PM 2.5 颗粒的尺寸很小，它们可以长时间悬浮在大气中，并且可以传播很远的距离。从天气数据来看，平均风速为 10 公里/小时。报告的 PM 2.5 水平是 24 小时的滚动平均值。粗略估计，目前的 PM 2.5 读数可能来自 240 公里以外的来源。下图显示了美国宇航局的卫星在 2018 年 1 月 8 日和 2018 年 2 月 8 日测量的火灾地图，指示了农业燃烧。黄圈表示曼谷 240 公里以内的区域。1 月 8 日的火灾数量(污染水平可接受)远低于 2 月 8 日的火灾数量(污染水平不健康)。

![](img/9c62d3c05f3a1ae3b40a803c9ed07c06.png)

Fire spots from NASA’s satellites

事实上，火灾模式与 PM 2.5 模式密切相关。

![](img/bd7ceaee7d7f24a204b6079a04f2e54c.png)

The number of fires aligns with spikes in PM 2.5 levels

# **天气模式**

逆温效应经常发生在冬季，因为近地面温度较低。顶部较热的空气阻碍了冷空气的流动。这种停滞的大气条件使 PM 2.5 颗粒在空气中悬浮的时间更长。另一方面，较高的湿度或雨水将有助于清除大气中的颗粒。这也是过去空气污染严重时，政府向空气中喷水的原因之一。不幸的是，这种缓解措施似乎并不有效，因为水量与实际降雨量相比微不足道。天气模式对空气污染的影响有多大？让我们比较一下冬天和其他季节的天气。

![](img/996b907789afa36956c38bf1083d9ec4.png)

compare the weather pattern in winter and other seasons

冬天的温度、风速和湿度都较低，但幅度不大。现在，让我们来看看其中每一项与 PM 2.5 水平的关系。

![](img/e017d7b2742c206c00637a93abd13b7a.png)

Effect of temperature, wind speed, and humidity on PM 2.5 level in winter

较高的温度(这破坏了逆温效应)、风速和湿度与污染水平呈负相关。

![](img/4a18214ca5c7a11dd88bbbac9f830e1e.png)

Effect of wind on PM 2.5 level in winter

在有风的日子里，污染明显更好。与无风天气相比，有风天气 PM 2.5 水平分布的中值较低。

事实上，污染程度也取决于风向，正如这个图所示。为了简单起见，我只选择了四个主要的风向。

![](img/e954a59a6001d3b387689eb78efb7328.png)

PM2.5 relationship with the wind direction in winter

在风从南方吹来的日子，污染水平可能较低，因为泰国湾在曼谷的南面。干净的海风改善了空气质量。来自其他三个方向的风通过陆路。然而，在风平浪静的日子里，有任何风都比停滞不前的大气条件要好。

在雨天和无雨天，PM 2.5 中值水平的变化较小。冬季的雨天较少，因此数据有些嘈杂，但在累积密度函数中可以观察到差异。

![](img/50ae16b7864fdbc743a64676b6ace82e.png)

Effect of rain PM 2.5 level in winter

# **交通指数**

PM 2.5 颗粒物的来源之一是汽车发动机尾气。虽然争取更多公共交通的使用总体上有利于环境，但减少 PM 2.5 污染的有效性尚不清楚。原因如下。

![](img/ef473b5cccfd079292d62121aeaa5179.png)

traffic index and air pollution

我们已经看到 PM 2.5 水平与一天中的时间有关。下午 3 点左右污染程度较低，但在夜间仍然很高。当相对于交通数据绘图时，与污染水平的关系非常嘈杂。似乎没有很强的相关性。

![](img/55bab8373410ea479e3fb330eafe3b9f.png)

PM2.5 relationship with traffic index

将一天中的时间和工作日与周末的信息包含到模型中可能会使关系更加清晰。

# 自回归过程

当前的 PM 2.5 值也可以依赖于之前的值。下面的部分自相关图显示了 1 小时时滞的强相关性，这意味着 PM 2.5 水平是一个自回归过程。因此，我在模型中包括了 24 小时的平均值，并限制模型只允许查看以前的值来进行未来预测。这个特征的重要性应该与粒子在大气中停留的时间直接相关。

![](img/429857aeac14606cfb699fbc957c54b5.png)

# 机器学习模型

下图显示了根据 Spearman 相关性计算的所有输入特征的 dedrogram。树状图有助于识别可以从模型中移除的冗余特征。各种距离内的火灾数量和 PM 2.5 的水平密切相关。其他功能就更远了。我最终在模型中使用了所有这些特性。

![](img/7cd91e303ab1971ff49c9176f5071c62.png)

dendrogram of inputfeatures

为了确定污染的主要原因，我使用了随机森林回归来拟合模型，因为它简单且易于解释。在超参数调整期间，25%的数据分配给验证集。使用整个数据集再次重新训练该模型。该模型在训练集上达到 0.99 的 R 平方。由于这项研究的目的是了解过去空气污染的来源，所以我将重点放在训练集上。下图对每个影响因素的重要性进行了排序。重要性是根据置换列时 R 平方值的减少以及重新归一化所有列的总和来计算的。

![](img/82e7ce1c42e2fb70b9cf0fcf152b0efd.png)

feature of importance

不出所料，之前的污染水平是最重要的预测指标。其次是从最近到最远的火灾次数。远在 720 公里以外的火灾数量对空气质量的影响比当地的湿度、交通甚至降雨更大。一天中的时间是比交通指数更重要的预测因素。在天气特征中，湿度是最重要的特征。

下面使用 2019 年 1 月 13 日上午 8 点 96 分 2.5 级的数据的树解释器来说明每个特征的影响。

![](img/2d84d4f7cd445983c0f739d0ed840a2e.png)

model interpretation on Jan 23, 2019

我们从平均值 26 开始。前一个小时的 PM 2.5 水平是 62，因此该模型增加了一个值 20。在 240 公里的半径范围内有 150 起火灾，因此该模型将污染水平增加了 10 级。现在的值是 56。240-480 km 之间有 1649 处起火，480-720 km 之间有 896 处起火，模型分别加值 9 和 8。低风速和早高峰时间(早上 8 点)给模型增加了 8。在预测 PM 2.5 水平的 96 个因素中，这六个因素占了 81 个。右侧的其余要素不太重要，因此增加的预测污染值较少。

![](img/33bebdbc5b7f71de8e62c331f0c4be31.png)

model interpretation on Feb 2, 2019

在一个美好的日子，如 2019 年 2 月 2 日晚上 7 点，PM 2.5 水平为 10。前一小时的污染水平较低，因此模型减去了 10 的值。该地区仍然有许多火灾，该模型增加了值 2。风速很高，使数值降低了 2。天气和交通都很好。许多因素的综合导致 PM 2.5 的预测水平较低，为 10。

# 结论

PM 2.5 水平与各种因素有着复杂的关系:火灾数量、天气模式和交通。但这个分析证实了很多人的怀疑——农业焚烧是泰国 PM 2.5 污染的根本原因。燃烧活动远至 720 公里以外的曼谷，一个延伸到缅甸，老挝和柬埔寨的地区，会导致曼谷的空气问题。解决这个问题并不容易。这需要东南亚国家的国际合作。

我留给你一张 2019 年 3 月 17 日的火灾地图，这是有史以来最糟糕的一天！

![](img/656f4c640ac742f57002db75564cf21a.png)