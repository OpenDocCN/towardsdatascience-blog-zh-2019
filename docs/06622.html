<html>
<head>
<title>Beyond Linear Regression: An Introduction to GLMs</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">超越线性回归:GLMs 导论</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/beyond-linear-regression-an-introduction-to-glms-7ae64a8fad9c?source=collection_archive---------5-----------------------#2019-09-22">https://towardsdatascience.com/beyond-linear-regression-an-introduction-to-glms-7ae64a8fad9c?source=collection_archive---------5-----------------------#2019-09-22</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/928b3d2473cc83540fc16debf880958b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZsiQGKu5Pj0AEi9OiENHMw.jpeg"/></div></div></figure><div class=""/><p id="a31e" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">来自统计学背景，我第一次涉足数据科学和机器学习是通过线性回归。当时，我真的相信没有什么统计建模问题如此复杂，以至于不能用一个适当定义的线性回归模型来解决。</p><p id="7336" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">同时，我也认为包含 5000 个数据点的数据集是“大”的；学习 SAS 对我的职业生涯来说比学习 R 更有价值；《吸血鬼猎人巴菲》是有史以来最棒的电视剧。</p><p id="8a47" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我当时是本科生，世界观极其狭隘。</p><p id="f7cf" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">然而，在我大学二年级统计学课上定义的宇宙中，我实际上是对的。T2 真的没有复杂到无法用线性回归模型建模的问题。任何对线性回归模型来说太复杂的问题都被我们轻易隐藏了，所以实际上，在那个世界里不存在。</p><p id="4e28" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这凸显了许多数据科学家，尤其是那些职业生涯初期的数据科学家，可能会陷入的陷阱。</p><p id="386d" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">许多介绍性的机器学习课程只教给学生一组有限的可能模型(通常是线性和逻辑回归、决策树、朴素贝叶斯、支持向量机和神经网络)，并且只提供使用数据集的示例，其中一个或多个模型是合适的。</p><p id="683e" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这可能导致数据科学家错误地认为，所有监督学习问题都可以用一小组机器学习模型中的一个来解决。</p><p id="b66e" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">但是，在机器学习入门课程中教授的模型肯定不是唯一的统计或机器学习模型。</p><p id="e8aa" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">其中一个很少在机器学习 MOOCs 或大学数据科学学位中教授的模型是广义线性模型或 GLM。GLMs 经常用于保险费设定，并且已经被证明是我职业生涯中迄今为止遇到的最有用的统计模型之一。</p><p id="5004" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在本文中，我们将仔细研究这个高度通用但经常被忽视的模型。</p><h1 id="b7f8" class="la lb je bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">线性回归概述</h1><p id="3185" class="pw-post-body-paragraph kb kc je kd b ke ly kg kh ki lz kk kl km ma ko kp kq mb ks kt ku mc kw kx ky im bi translated">(多元)线性回归模型由三部分组成:</p><ol class=""><li id="971b" class="md me je kd b ke kf ki kj km mf kq mg ku mh ky mi mj mk ml bi translated">一个输出(或响应/相关)变量 Y，其中该变量的所有观测值都被假设为独立地取自具有恒定方差 s2 的正态分布；</li><li id="404a" class="md me je kd b ke mm ki mn km mo kq mp ku mq ky mi mj mk ml bi translated">k 个输入(或解释/独立)变量的向量，X1，X2，…，Xk；和</li><li id="8458" class="md me je kd b ke mm ki mn km mo kq mp ku mq ky mi mj mk ml bi translated">k+1 个参数的向量，b0，b1，…，bk，允许我们将 Y 的平均值表示为输入变量的线性组合:</li></ol><p id="3816" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这三个分量一起将 Y 的概率分布定义为 Yi ~ iid N(mi，s2)，我们拟合线性回归模型的目的是确定参数值，这些参数值将最佳地定义我们数据的分布。</p><p id="342b" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这可以使用几种不同的方法来完成，包括普通最小二乘法(通常用于较小的数据集)和梯度下降法(通常用于较大的数据集)。</p><p id="2580" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">线性回归的主要优势在于线性回归模型具有以下特点:</p><ul class=""><li id="02ba" class="md me je kd b ke kf ki kj km mf kq mg ku mh ky mr mj mk ml bi translated">快速训练和查询；</li><li id="0552" class="md me je kd b ke mm ki mn km mo kq mp ku mq ky mr mj mk ml bi translated">不易过拟合，能有效利用数据，因此可应用于相对较小的数据集；和</li><li id="f396" class="md me je kd b ke mm ki mn km mo kq mp ku mq ky mr mj mk ml bi translated">很容易解释，即使对非技术背景的人也是如此。</li></ul><p id="ab7a" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">然而，线性回归的一个关键弱点是其背后的限制性假设，这对于模型提供良好的数据拟合来说必须成立。特别是正态假设。</p><p id="33d7" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">根据定义，正态分布的数据是连续的、对称的，并且定义在整个数字线上。这意味着任何离散的、不对称的或只能在有限范围内取值的数据，都不应该用线性回归来建模。</p><p id="5501" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">任何学过本科统计学的人都知道，如果你的数据没有表现出一个或多个这些特征，你可以做一些工作。例如，如果我们的数据是倾斜的，我们可以通过取输出的对数或平方根来转换它。</p><p id="2b56" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">然而，这可以被视为将我们的数据拟合到我们的模型的经典案例，这从来都不是问题的最佳解决方案。另一种方法是使用不同类型的回归模型，该模型专门设计用于非正态数据。这就是广义线性模型的用武之地。</p><h1 id="e93d" class="la lb je bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">介绍广义线性模型</h1><p id="c766" class="pw-post-body-paragraph kb kc je kd b ke ly kg kh ki lz kk kl km ma ko kp kq mb ks kt ku mc kw kx ky im bi translated">广义线性模型(GLMs)可以被认为是多元线性回归模型的推广。glm 也由三个组件组成，这三个组件类似于线性回归模型的组件，但略有不同。具体来说，GLMs 由以下部分组成:</p><ol class=""><li id="bb58" class="md me je kd b ke kf ki kj km mf kq mg ku mh ky mi mj mk ml bi translated">输出变量 Y，其中该变量的所有观察值被假设为从指数族分布中独立提取<strong class="kd jf">；</strong></li><li id="a1df" class="md me je kd b ke mm ki mn km mo kq mp ku mq ky mi mj mk ml bi translated">k 个输入变量的向量，X1，X2，…，Xk；和</li><li id="1796" class="md me je kd b ke mm ki mn km mo kq mp ku mq ky mi mj mk ml bi translated">k+1 个参数的向量，b0，b1，…，bk，<strong class="kd jf">和一个链接函数 g() </strong>，它允许我们将<strong class="kd jf"> g(E(Y)) </strong>写成我们输入变量的线性组合。那就是:</li></ol><p id="086f" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">其中 m = E(Y)。</p><p id="431a" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">同样，我们的目标是确定最佳参数值来定义 Y 的概率分布，但我们现在不再局限于 Y 仅遵循正态分布。</p><p id="2151" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">根据 GLM 假设，Y 现在可以遵循“指数族”内的任何概率分布，这不仅包括指数分布，还包括正态分布、伽玛分布、卡方分布、泊松分布、二项式分布(对于固定数量的试验)、负二项式分布(对于固定数量的故障)、贝塔分布和对数正态分布等。</p><p id="0be6" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">几乎所有在本科和硕士统计学课程中教授的概率分布都是指数家族的成员。</p><p id="6ad4" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我们的链接函数的目的是转换我们的输出变量，以便我们可以将它表示为我们的输入变量的线性组合(这是，而不是，将我们的输出变量转换为正态，正如人们经常错误地认为的那样)。</p><p id="4f18" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">根据我们假设的输出分布的概率分布，有一些常用的连接函数。</p><p id="1136" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">例如:</p><figure class="mt mu mv mw gt iv gh gi paragraph-image"><div class="gh gi ms"><img src="../Images/4fb81ae46a3586c36fa74b9fc5ff0fd7.png" data-original-src="https://miro.medium.com/v2/resize:fit:968/format:webp/0*h6rl0tk6RmS_pfAw.jpg"/></div></figure><p id="579f" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">因此，当指定 GLM 时，有必要指定输出概率分布函数和链接函数。</p><p id="ec93" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">标准线性回归模型是 GLM 的一种特殊情况，其中我们假设正态概率分布和身份链接。</p><h1 id="3473" class="la lb je bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">GLMs 优于线性回归的三种情况</h1><p id="af2c" class="pw-post-body-paragraph kb kc je kd b ke ly kg kh ki lz kk kl km ma ko kp kq mb ks kt ku mc kw kx ky im bi translated">在违反正态假设的情况下，GLMs 通常优于线性回归模型。可能发生这种情况的三种情况是:计数数据；扭曲的数据；和二进制数据。</p><p id="ccfe" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">让我们看看 GLMs 在这些情况下是如何使用的。</p><h1 id="c895" class="la lb je bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">案例 1:计数数据</h1><p id="efb9" class="pw-post-body-paragraph kb kc je kd b ke ly kg kh ki lz kk kl km ma ko kp kq mb ks kt ku mc kw kx ky im bi translated">计数数据是任何只能取非负整数值的数据。顾名思义，它通常出现在对特定类型的事件在一段时间内的观察进行计数时。比如一个路口每年的车祸次数；或者进程每天失败的次数。</p><p id="def7" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">为了拟合 GLM 来计算数据，我们需要为我们的模型假设一个概率分布和链接函数。因为计数数据是离散的，所以概率分布也必须是离散的。</p><p id="04d4" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在这种情况下，最常见的选择是泊松或负二项分布，具有对数关联函数。</p><p id="4c28" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">要将泊松或负二项式 GLM 拟合到我们的数据中，我们可以使用 Python 的 statsmodels 包，语法如下:</p><pre class="mt mu mv mw gt mx my mz na aw nb bi"><span id="73bc" class="nc lb je my b gy nd ne l nf ng">import pandas as pd <br/>import statsmodels.api as sm </span><span id="5a78" class="nc lb je my b gy nh ne l nf ng">count_model = sm.GLM(count_data['Y'], sm.add_constant(count_data[['X1', 'X2']]), family=sm.families.Poisson(sm.genmod.families.links.log)).fit()</span></pre><p id="0944" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">该语法假设我们的数据集是名为 count_data 的熊猫数据帧的形式，具有输出变量 Y 和输入变量 X1 和 X2，并且我们想要拟合泊松 GLM。</p><p id="b786" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">为了拟合负二项式 GLM，而不是泊松 GLM，我们需要做的就是将 sm.families.Poisson 改为 sm.families.NegativeBinomial</p><h1 id="c314" class="la lb je bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">案例 2:扭曲的数据</h1><p id="f6c5" class="pw-post-body-paragraph kb kc je kd b ke ly kg kh ki lz kk kl km ma ko kp kq mb ks kt ku mc kw kx ky im bi translated">尽管不对称数据可能会向两个方向倾斜。在实践中，您将遇到的大多数不对称数据都是右偏或正偏的，如下图所示的数据集。</p><figure class="mt mu mv mw gt iv gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/ad28c3e9282ca6d4514bbe8edf6ab743.png" data-original-src="https://miro.medium.com/v2/resize:fit:976/format:webp/0*YFz5utMPF5zrKOSN.png"/></div></figure><p id="ed02" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">如前所述，要对此数据拟合 GLM，我们需要选择一个概率分布和链接函数。我们的概率函数需要正偏，在这种情况下最常见的选择是带有对数链接的伽马分布。</p><p id="6f86" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">要使用 statsmodels 包拟合带有数据对数链接的伽玛分布，我们可以使用与泊松 GLM 相同的语法，但用 sm.families.Gamma 替换 sm.families.Poisson</p><p id="5c74" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">伽玛分布仅针对大于 0 的值定义。因此，如果我们的输出变量 Y 可以取负或零，那么在拟合模型之前，可能有必要通过向输出变量添加足够大的常数来转换我们的数据。</p><p id="ecd2" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">例如，如果我们的输出变量可以采用任何非负值，包括零，我们可以通过在拟合模型之前将 0.01 添加到所有 Y 值来转换它，将最小值移动到 0.01。</p><h1 id="88fd" class="la lb je bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">案例 3:二进制数据</h1><p id="124e" class="pw-post-body-paragraph kb kc je kd b ke ly kg kh ki lz kk kl km ma ko kp kq mb ks kt ku mc kw kx ky im bi translated">与前两个示例一样，上述 GLM 可以使用 statsmodels 包进行拟合，使用与前面相同的语法，但将 sm.families.Poisson 替换为 sm.families.Binomial，将 sm.genmod.families.links.log 替换为 sm.genmod.families.links.logit</p><p id="725e" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">也就是说，如果我们假设我们的数据集名为 binary_data，并且我们的输入和输出变量与前面定义的一样，使用命令:</p><pre class="mt mu mv mw gt mx my mz na aw nb bi"><span id="3e67" class="nc lb je my b gy nd ne l nf ng">binary_model = sm.GLM(binary_data['Y'], sm.add_constant(binary _data[['X1', 'X2']]), family=sm.families.Binomial(sm.genmod.families.links.logit)).fit()</span></pre><p id="08fd" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">或者，我们也可以使用 Python scikit-learn 包的 sklearn.linear_model 来拟合这个模型。逻辑回归函数。</p><p id="9456" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">引用莎士比亚的话，“天地万物，远非你的哲学所能想象，”数据科学和机器学习不仅仅是普通入门 MOOC 的内容。</p><p id="bf9e" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在本文中，我们介绍了一种许多早期职业数据科学家都不熟悉的模型，但这只是冰山一角，还有更多这种模型。</p><p id="daa4" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这并不是说，每个数据科学家都需要了解关于现有的每个统计或机器学习模型的一切。</p><p id="9da5" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">然而，只要意识到数据科学不仅仅是基本模型，你就不太可能犯将数据拟合到模型的错误，而实际上你应该将模型拟合到数据。</p></div><div class="ab cl nj nk hx nl" role="separator"><span class="nm bw bk nn no np"/><span class="nm bw bk nn no np"/><span class="nm bw bk nn no"/></div><div class="im in io ip iq"><p id="047c" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><em class="kz">Genevieve Hayes 博士是数据科学家、教育家和人工智能及分析专家，拥有</em><a class="ae nq" href="https://www.genevievehayes.com/" rel="noopener ugc nofollow" target="_blank"><em class="kz">Genevieve Hayes Consulting</em></a><em class="kz">。你可以在</em><a class="ae nq" href="https://www.linkedin.com/in/gkhayes/" rel="noopener ugc nofollow" target="_blank"><em class="kz">LinkedIn</em></a><em class="kz">或者</em><a class="ae nq" href="https://twitter.com/genevievekhayes" rel="noopener ugc nofollow" target="_blank"><em class="kz">Twitter</em></a><em class="kz">上关注她。她还是</em> <a class="ae nq" href="https://www.genevievehayes.com/episodes/" rel="noopener ugc nofollow" target="_blank"> <em class="kz">价值驱动数据科学</em> </a> <em class="kz">的主持人，这是一个每月两次的播客，面向希望最大化其数据和数据团队价值的企业。</em></p><p id="6735" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><em class="kz">想要发掘企业数据的价值，但不知道从何入手？</em> <strong class="kd jf"> <em class="kz"> </em> </strong> <a class="ae nq" href="https://www.genevievehayes.com/discovery-guide/" rel="noopener ugc nofollow" target="_blank"> <strong class="kd jf"> <em class="kz">下载免费的数据科学项目探索指南。</em> </strong> </a></p></div></div>    
</body>
</html>