<html>
<head>
<title>Data Augmentation techniques in python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">python 中的数据扩充技术</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/data-augmentation-techniques-in-python-f216ef5eed69?source=collection_archive---------1-----------------------#2019-12-11">https://towardsdatascience.com/data-augmentation-techniques-in-python-f216ef5eed69?source=collection_archive---------1-----------------------#2019-12-11</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="0571" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用 imgaug 一瞥 Python 中的数据扩充技术</h2></div><p id="bf38" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="le">在本文中，我们将使用 imgaug 库</em>探索 Python 中不同的数据扩充技术</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi lf"><img src="../Images/57f59595f1952ac3eb53e065271b42e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wgGeb53g8K6ib8ZxJ_T1Ug.png"/></div></div></figure><h1 id="ad29" class="lr ls it bd lt lu lv lw lx ly lz ma mb jz mc ka md kc me kd mf kf mg kg mh mi bi translated">什么是图像增强？</h1><p id="4ca6" class="pw-post-body-paragraph ki kj it kk b kl mj ju kn ko mk jx kq kr ml kt ku kv mm kx ky kz mn lb lc ld im bi translated">图像增强是一种非常强大的技术，用于在现有图像中人工创建变化，以扩展现有图像数据集。这从代表可能图像的综合集合的现有图像数据集中创建新的和不同的图像。</p><p id="ab70" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这是通过应用不同的变换技术来实现的，如缩放现有图像、将现有图像旋转几度、剪切或裁剪现有图像集等。</p><h1 id="6069" class="lr ls it bd lt lu lv lw lx ly lz ma mb jz mc ka md kc me kd mf kf mg kg mh mi bi translated">为什么我们需要图像增强？</h1><p id="47be" class="pw-post-body-paragraph ki kj it kk b kl mj ju kn ko mk jx kq kr ml kt ku kv mm kx ky kz mn lb lc ld im bi translated">深度学习卷积神经网络(CNN)需要大量的图像来有效地训练模型。<strong class="kk iu">这有助于通过更好地概括来提高模型的性能，从而减少过度拟合</strong>。大多数用于分类和对象检测数据集的流行数据集具有几千到几百万个图像。</p><p id="895e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">泛化指的是在训练过程中根据以前见过的数据，对照以前从未见过的测试或验证数据来评估模型的性能。</p><p id="598b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">CNN 由于其方差属性，即使在不同大小、方向或不同照明下可见，也可以对对象进行分类。</strong>因此，我们可以利用图像的小数据集，通过放大或缩小、垂直或水平翻转或改变亮度(只要对对象有意义)，将对象转换为不同的大小。这样我们就创建了一个丰富多样的数据集。</p><blockquote class="mo"><p id="1ea9" class="mp mq it bd mr ms mt mu mv mw mx ld dk translated">图像增强从一小组图像中创建一组丰富多样的图像，用于图像分类、对象检测或图像分割。</p></blockquote><p id="b267" class="pw-post-body-paragraph ki kj it kk b kl my ju kn ko mz jx kq kr na kt ku kv nb kx ky kz nc lb lc ld im bi translated">在仔细理解问题域之后，需要应用增加训练数据集大小的增强策略。</p><p id="338f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="le">如果我们正在对不同类型的汽车进行分类，那么通过垂直翻转汽车来应用图像增强对于问题域是没有用的，或者当我们正在对手写数字进行图像分类时，垂直翻转数字 6 不会增加价值</em></p><h1 id="6730" class="lr ls it bd lt lu lv lw lx ly lz ma mb jz mc ka md kc me kd mf kf mg kg mh mi bi translated">什么时候应用图像增强？</h1><p id="6898" class="pw-post-body-paragraph ki kj it kk b kl mj ju kn ko mk jx kq kr ml kt ku kv mm kx ky kz mn lb lc ld im bi translated">图像增强可以在我们训练模型之前作为预处理步骤来应用，或者可以实时应用。</p><h2 id="d994" class="nd ls it bd lt ne nf dn lx ng nh dp mb kr ni nj md kv nk nl mf kz nm nn mh no bi translated">离线或预处理增强</h2><p id="d605" class="pw-post-body-paragraph ki kj it kk b kl mj ju kn ko mk jx kq kr ml kt ku kv mm kx ky kz mn lb lc ld im bi translated">扩充作为预处理步骤被应用以增加数据集的大小。当我们想要扩展一个小的训练数据集时，通常会这样做。</p><p id="b537" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在较小的数据集上生成增强是有帮助的，但是在应用于较大的数据集时，我们需要考虑磁盘空间</p><h2 id="b871" class="nd ls it bd lt ne nf dn lx ng nh dp mb kr ni nj md kv nk nl mf kz nm nn mh no bi translated">在线或实时增强</h2><p id="201b" class="pw-post-body-paragraph ki kj it kk b kl mj ju kn ko mk jx kq kr ml kt ku kv mm kx ky kz mn lb lc ld im bi translated">顾名思义，增强是实时应用的。这通常适用于较大的数据集，因为我们不需要将增强的图像保存在磁盘上。</p><p id="84ae" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在这种情况下，我们以小批量的方式应用转换，然后将其提供给模型。</p><p id="1656" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在线增强模型将在每个时期看到不同的图像。在离线增强中，增强图像是训练集的一部分，它根据历元数多次查看增强图像。</p><p id="8e63" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">该模型通过在线增强进行更好的概括，因为它在使用在线数据增强进行训练的过程中看到了更多的样本。</p><p id="e68f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们将使用<strong class="kk iu"> <em class="le"> imgaug </em> </strong>类来演示图像增强。</p><p id="8e86" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">imgaug 支持多种数据增强技术</p><h1 id="3a2a" class="lr ls it bd lt lu lv lw lx ly lz ma mb jz mc ka md kc me kd mf kf mg kg mh mi bi translated">基本数据扩充技术</h1><ul class=""><li id="e262" class="np nq it kk b kl mj ko mk kr nr kv ns kz nt ld nu nv nw nx bi translated"><strong class="kk iu">翻转</strong>:垂直或水平翻转图像</li><li id="db1a" class="np nq it kk b kl ny ko nz kr oa kv ob kz oc ld nu nv nw nx bi translated"><strong class="kk iu">旋转</strong>:将图像旋转指定的角度。</li><li id="2786" class="np nq it kk b kl ny ko nz kr oa kv ob kz oc ld nu nv nw nx bi translated"><strong class="kk iu">剪切</strong>:像平行四边形一样移动图像的一部分</li><li id="06e7" class="np nq it kk b kl ny ko nz kr oa kv ob kz oc ld nu nv nw nx bi translated"><strong class="kk iu">裁剪</strong>:对象以不同的比例出现在图像的不同位置</li><li id="3e7e" class="np nq it kk b kl ny ko nz kr oa kv ob kz oc ld nu nv nw nx bi translated"><strong class="kk iu">放大，缩小</strong></li><li id="b818" class="np nq it kk b kl ny ko nz kr oa kv ob kz oc ld nu nv nw nx bi translated"><strong class="kk iu">改变亮度或对比度</strong></li></ul><p id="c47a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们现在将使用 imgaug 库来探索这些数据扩充技术</p><h1 id="dbb0" class="lr ls it bd lt lu lv lw lx ly lz ma mb jz mc ka md kc me kd mf kf mg kg mh mi bi translated">伊姆高格</h1><p id="7e12" class="pw-post-body-paragraph ki kj it kk b kl mj ju kn ko mk jx kq kr ml kt ku kv mm kx ky kz mn lb lc ld im bi translated">imgaug 是一个用于图像增强以及关键点/界标、边界框、热图和分割图的库。</p><h2 id="d15b" class="nd ls it bd lt ne nf dn lx ng nh dp mb kr ni nj md kv nk nl mf kz nm nn mh no bi translated">安装库</h2><pre class="lg lh li lj gt od oe of og aw oh bi"><span id="9837" class="nd ls it oe b gy oi oj l ok ol">pip install imgaug</span></pre><p id="55e4" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在某些情况下，我们得到一个 Shapely 错误，在这种情况下，我们可以尝试以下命令</p><pre class="lg lh li lj gt od oe of og aw oh bi"><span id="79c7" class="nd ls it oe b gy oi oj l ok ol">pip install imgaug — upgrade — no-deps</span></pre><p id="86ed" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们将拍摄一张图像，并使用基本的数据增强技术对其进行转换。</p><h2 id="8251" class="nd ls it bd lt ne nf dn lx ng nh dp mb kr ni nj md kv nk nl mf kz nm nn mh no bi translated">导入所需的库</h2><pre class="lg lh li lj gt od oe of og aw oh bi"><span id="6377" class="nd ls it oe b gy oi oj l ok ol">import imageio<br/>import imgaug as ia<br/>import imgaug.augmenters as iaa<br/>import numpy as np<br/>import pandas as pd<br/>import matplotlib.pyplot as plt<br/>import matplotlib.patches as patches<br/>import matplotlib<br/>%matplotlib inline</span></pre><h2 id="6ef4" class="nd ls it bd lt ne nf dn lx ng nh dp mb kr ni nj md kv nk nl mf kz nm nn mh no bi translated">显示原始图像</h2><p id="c7da" class="pw-post-body-paragraph ki kj it kk b kl mj ju kn ko mk jx kq kr ml kt ku kv mm kx ky kz mn lb lc ld im bi translated">我们使用<strong class="kk iu"> imageio </strong>显示原始图像</p><pre class="lg lh li lj gt od oe of og aw oh bi"><span id="a86e" class="nd ls it oe b gy oi oj l ok ol">image = imageio.imread(“.\\car2.jpeg”)<br/>ia.imshow(image)</span></pre><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi om"><img src="../Images/7beff6527d27389dde82f3fcb94e98e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:690/format:webp/1*603y0l0xF4gK3syf1CbjTQ.png"/></div><figcaption class="on oo gj gh gi op oq bd b be z dk">Original Image</figcaption></figure><h2 id="f6d6" class="nd ls it bd lt ne nf dn lx ng nh dp mb kr ni nj md kv nk nl mf kz nm nn mh no bi translated">旋转图像</h2><p id="b4cf" class="pw-post-body-paragraph ki kj it kk b kl mj ju kn ko mk jx kq kr ml kt ku kv mm kx ky kz mn lb lc ld im bi translated">我们可以通过指定旋转度数来旋转图像。我们将图像旋转-50 度到 30 度</p><pre class="lg lh li lj gt od oe of og aw oh bi"><span id="d475" class="nd ls it oe b gy oi oj l ok ol"><strong class="oe iu">rotate=iaa.Affine(rotate=(-50, 30))<br/>rotated_image=rotate.augment_image(image)</strong><br/>ia.imshow(rotated_image)</span></pre><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi or"><img src="../Images/d7f2d4f469b96e45c3735d319239895b.png" data-original-src="https://miro.medium.com/v2/resize:fit:684/format:webp/1*meevtzo2zKB2RtJxoEMQ-g.png"/></div><figcaption class="on oo gj gh gi op oq bd b be z dk">Image rotated by -50 to 30 degrees</figcaption></figure><h2 id="85dc" class="nd ls it bd lt ne nf dn lx ng nh dp mb kr ni nj md kv nk nl mf kz nm nn mh no bi translated">向图像添加噪声</h2><p id="4c2b" class="pw-post-body-paragraph ki kj it kk b kl mj ju kn ko mk jx kq kr ml kt ku kv mm kx ky kz mn lb lc ld im bi translated">我们将从高斯分布采样的不同噪声值按元素添加到图像中。</p><pre class="lg lh li lj gt od oe of og aw oh bi"><span id="8aba" class="nd ls it oe b gy oi oj l ok ol"><strong class="oe iu">gaussian_noise=iaa.AdditiveGaussianNoise(10,20)</strong><br/><strong class="oe iu">noise_image=gaussian_noise.augment_image(image)</strong><br/>ia.imshow(noise_image)</span></pre><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi os"><img src="../Images/c2f7d8a7975403733ba08744d7bb3d77.png" data-original-src="https://miro.medium.com/v2/resize:fit:682/format:webp/1*r6ZoDptRlKZpathP2jHo6g.png"/></div><figcaption class="on oo gj gh gi op oq bd b be z dk">Adding Gaussian noise</figcaption></figure><h2 id="9b2d" class="nd ls it bd lt ne nf dn lx ng nh dp mb kr ni nj md kv nk nl mf kz nm nn mh no bi translated">裁剪图像</h2><p id="b2cd" class="pw-post-body-paragraph ki kj it kk b kl mj ju kn ko mk jx kq kr ml kt ku kv mm kx ky kz mn lb lc ld im bi translated">裁剪会移除图像两侧的像素列/行。在下面的例子中，我们将图像的一边裁剪 30%</p><pre class="lg lh li lj gt od oe of og aw oh bi"><span id="5390" class="nd ls it oe b gy oi oj l ok ol"><strong class="oe iu">crop = iaa.Crop(percent=(0, 0.3)) # crop image<br/>corp_image=crop.augment_image(image)</strong><br/>ia.imshow(corp_image)</span></pre><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi ot"><img src="../Images/71a6093339183d1d1f3b5bd0d20fc128.png" data-original-src="https://miro.medium.com/v2/resize:fit:686/format:webp/1*_hDjY_iV2W0-LsNI2ZwXFg.png"/></div><figcaption class="on oo gj gh gi op oq bd b be z dk">cropped one side of the image by 30%</figcaption></figure><h2 id="a6bf" class="nd ls it bd lt ne nf dn lx ng nh dp mb kr ni nj md kv nk nl mf kz nm nn mh no bi translated">剪切图像</h2><p id="84d1" class="pw-post-body-paragraph ki kj it kk b kl mj ju kn ko mk jx kq kr ml kt ku kv mm kx ky kz mn lb lc ld im bi translated">将图像剪切 0 到 40 度</p><pre class="lg lh li lj gt od oe of og aw oh bi"><span id="b271" class="nd ls it oe b gy oi oj l ok ol">shear = iaa.Affine(shear=(0,40))<br/>shear_image=shear.augment_image(image)<br/>ia.imshow(shear_image)</span></pre><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi ou"><img src="../Images/936a32696a2349395976edf0f4f866d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:712/format:webp/1*NbfLw33lTwdsW-aSwRBT3g.png"/></div><figcaption class="on oo gj gh gi op oq bd b be z dk">Sheared image by 0 to 45 degrees</figcaption></figure><h2 id="8293" class="nd ls it bd lt ne nf dn lx ng nh dp mb kr ni nj md kv nk nl mf kz nm nn mh no bi translated">翻转图像</h2><p id="8b89" class="pw-post-body-paragraph ki kj it kk b kl mj ju kn ko mk jx kq kr ml kt ku kv mm kx ky kz mn lb lc ld im bi translated">我们可以垂直或水平翻转图像。<strong class="kk iu"> Fliplr </strong>水平翻转图像</p><pre class="lg lh li lj gt od oe of og aw oh bi"><span id="158d" class="nd ls it oe b gy oi oj l ok ol">#flipping image horizontally<br/>flip_hr=iaa.Fliplr(p=1.0)<br/>flip_hr_image= flip_hr.augment_image(image)<br/>ia.imshow(flip_hr_image)</span></pre><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi os"><img src="../Images/5a0d09a4efaaa6f992400521d24aac1b.png" data-original-src="https://miro.medium.com/v2/resize:fit:682/format:webp/1*fF7QRgVt5lieNnBVtSKtBQ.png"/></div><figcaption class="on oo gj gh gi op oq bd b be z dk">Flipping image horizontally</figcaption></figure><p id="3ce9" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">翻转</strong>垂直翻转图像</p><pre class="lg lh li lj gt od oe of og aw oh bi"><span id="ec5c" class="nd ls it oe b gy oi oj l ok ol">flip_vr=iaa.Flipud(p=1.0)<br/>flip_vr_image= flip_vr.augment_image(image)<br/>ia.imshow(flip_vr_image)</span></pre><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi ov"><img src="../Images/d1659d59115ee17db2c993346ecfea28.png" data-original-src="https://miro.medium.com/v2/resize:fit:700/format:webp/1*cCQAU-v2YtFBoabWHrGKGQ.png"/></div></div><figcaption class="on oo gj gh gi op oq bd b be z dk">Flipping image vertically</figcaption></figure><h2 id="4474" class="nd ls it bd lt ne nf dn lx ng nh dp mb kr ni nj md kv nk nl mf kz nm nn mh no bi translated">改变图像的亮度</h2><p id="96be" class="pw-post-body-paragraph ki kj it kk b kl mj ju kn ko mk jx kq kr ml kt ku kv mm kx ky kz mn lb lc ld im bi translated">我们使用<strong class="kk iu"> GammaContrast </strong>通过缩放像素值来调整图像亮度。范围<code class="fe ow ox oy oe b">gamma=(0.5, 2.0)</code>内的值似乎是合理的。我们可以使用<strong class="kk iu">s 形对比度</strong>或<strong class="kk iu">线性对比度</strong>来改变图像的亮度</p><pre class="lg lh li lj gt od oe of og aw oh bi"><span id="73e1" class="nd ls it oe b gy oi oj l ok ol">image = imageio.imread(“.\\img Aug\\car2.jpeg”)<br/>contrast=iaa.GammaContrast(gamma=2.0)<br/>contrast_image =contrast.augment_image(image)<br/>ia.imshow(contrast_image)<br/></span></pre><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi oz"><img src="../Images/fa21715a6b4acef7705fba26f4c46abc.png" data-original-src="https://miro.medium.com/v2/resize:fit:694/format:webp/1*8ikLe50o4Pn_kxNXwyWwJQ.png"/></div><figcaption class="on oo gj gh gi op oq bd b be z dk">adding contrast to the image</figcaption></figure><h2 id="626f" class="nd ls it bd lt ne nf dn lx ng nh dp mb kr ni nj md kv nk nl mf kz nm nn mh no bi translated">缩放图像</h2><p id="6125" class="pw-post-body-paragraph ki kj it kk b kl mj ju kn ko mk jx kq kr ml kt ku kv mm kx ky kz mn lb lc ld im bi translated">我们可以使用缩放来放大或缩小图像。我们将下面的图像缩放到图像高度/宽度的 150%到 80%。我们可以独立缩放每个轴</p><pre class="lg lh li lj gt od oe of og aw oh bi"><span id="e916" class="nd ls it oe b gy oi oj l ok ol">image = imageio.imread("C:\\Data\\img Aug\\car2.jpeg")<br/>scale_im=iaa.Affine(scale={"x": (1.5, 1.0), "y": (1.5, 1.0)})<br/>scale_image =scale_im.augment_image(image)<br/>ia.imshow(scale_image)</span></pre><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi ou"><img src="../Images/72651846db5941efd643530a4cd1604d.png" data-original-src="https://miro.medium.com/v2/resize:fit:712/format:webp/1*Rm-CJXcH9cKYYcvWKkLBBg.png"/></div><figcaption class="on oo gj gh gi op oq bd b be z dk">scaling image 150% to 80% of its height/width.</figcaption></figure><h2 id="fdbf" class="nd ls it bd lt ne nf dn lx ng nh dp mb kr ni nj md kv nk nl mf kz nm nn mh no bi translated">用于目标检测的增强</h2><p id="4f7f" class="pw-post-body-paragraph ki kj it kk b kl mj ju kn ko mk jx kq kr ml kt ku kv mm kx ky kz mn lb lc ld im bi translated">我们绘制物体检测的包围盒。当我们放大图像时，我们希望边界框也相应地更新。</p><p id="74a8" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">imgaug 提供了对边界框的支持。当我们旋转、剪切或裁剪图像时，对象周围的边界框也会相应地更新。</p><p id="5786" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">从 imgaug 导入边界框</strong></p><pre class="lg lh li lj gt od oe of og aw oh bi"><span id="f11c" class="nd ls it oe b gy oi oj l ok ol">from imgaug.augmentables.bbs import BoundingBox, BoundingBoxesOnImage</span></pre><p id="9b83" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">初始化原图像周围的包围盒</strong></p><pre class="lg lh li lj gt od oe of og aw oh bi"><span id="979a" class="nd ls it oe b gy oi oj l ok ol">bbs = BoundingBoxesOnImage([<br/> BoundingBox(x1=10, x2=520, y1=10, y2=300)<br/>], shape=image.shape)</span></pre><p id="5e3a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在原始图像的顶部显示边界框</p><pre class="lg lh li lj gt od oe of og aw oh bi"><span id="71d9" class="nd ls it oe b gy oi oj l ok ol">ia.imshow(bbs.draw_on_image(image, size=2))</span></pre><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi pa"><img src="../Images/4d4f8ec671e96ae6756852ef2c64d2e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:704/format:webp/1*QmVN5wbyhhHI9LK_9sD4hQ.png"/></div></div></figure><p id="fe23" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在下面的代码中，我们使用 translate_percentage 移动图像，增大边界框并将其应用到图像上</p><pre class="lg lh li lj gt od oe of og aw oh bi"><span id="b1e1" class="nd ls it oe b gy oi oj l ok ol">move=iaa.Affine(translate_percent={"x": 0.1}, scale=0.8)<br/>image_aug, bbs_aug = move(image=image, bounding_boxes=bbs)<br/>ia.imshow(bbs_aug.draw_on_image(image_aug, size=2))</span></pre><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi pb"><img src="../Images/bc32a332b492b994707a4bc5c72f8ec6.png" data-original-src="https://miro.medium.com/v2/resize:fit:710/format:webp/1*Oz01tpMVDXadJxRyfslpig.png"/></div><figcaption class="on oo gj gh gi op oq bd b be z dk">bounding box on the augmented image</figcaption></figure><h2 id="f158" class="nd ls it bd lt ne nf dn lx ng nh dp mb kr ni nj md kv nk nl mf kz nm nn mh no bi translated">在应用图像增强后处理图像外部的边界框</h2><p id="ad64" class="pw-post-body-paragraph ki kj it kk b kl mj ju kn ko mk jx kq kr ml kt ku kv mm kx ky kz mn lb lc ld im bi translated">边界框有时可能会超出图像，我们需要额外的代码来处理这种情况</p><p id="be48" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们旋转图像，并尝试在对象周围绘制边界框</p><pre class="lg lh li lj gt od oe of og aw oh bi"><span id="2fba" class="nd ls it oe b gy oi oj l ok ol">rotate_bb=iaa.Affine(rotate=(-50, 30))<br/>image_aug, bbs_aug = rotate_bb(image=image, bounding_boxes=bbs)<br/>ia.imshow(bbs_aug.draw_on_image(image_aug, size=2))</span></pre><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi pc"><img src="../Images/a23ab59dcd9355b0422e1a8dca90fd49.png" data-original-src="https://miro.medium.com/v2/resize:fit:666/format:webp/1*75YaOJXbCBBlfVXRULydcA.png"/></div></figure><p id="704a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">部分边界框位于图像之外。在下面的代码中，我们将</p><ul class=""><li id="b9f1" class="np nq it kk b kl km ko kp kr pd kv pe kz pf ld nu nv nw nx bi translated">将边框完全或部分移出图像</li><li id="dd32" class="np nq it kk b kl ny ko nz kr oa kv ob kz oc ld nu nv nw nx bi translated">裁剪部分在外的边界框，使它们完全在图像内</li></ul><p id="48a7" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们创建一个填充函数，用 1 个像素的白色和 1 个像素的黑色边框填充图像:</p><pre class="lg lh li lj gt od oe of og aw oh bi"><span id="4685" class="nd ls it oe b gy oi oj l ok ol"><strong class="oe iu">def pad(image, by)</strong>:<br/>    image_border1 = ia.pad(image, top=1, right=1, bottom=1, left=1,<br/>                           mode="constant", cval=255)<br/>    image_border2 = ia.pad(image_border1, top=by-1, right=by-1,<br/>                           bottom=by-1, left=by-1,<br/>                           mode="constant", cval=0)<br/>    return image_border2</span></pre><p id="8e74" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后，我们在图像上绘制边界框。我们首先通过边界像素扩展图像平面，然后标记图像平面内的边界框</p><pre class="lg lh li lj gt od oe of og aw oh bi"><span id="674f" class="nd ls it oe b gy oi oj l ok ol">def draw_bbs(image, bbs, border):<br/>    GREEN = [0, 255, 0]<br/>    ORANGE = [255, 140, 0]<br/>    RED = [255, 0, 0]<br/>    <strong class="oe iu">image_border = pad(image, border)</strong><br/>    for bb in bbs.bounding_boxes:<br/>       <strong class="oe iu"> if bb.is_fully_within_image(image.shape):</strong><br/>            color = GREEN<br/>        <strong class="oe iu">elif bb.is_partly_within_image(image.shape):</strong><br/>            color = ORANGE<br/>        else:<br/>            color = RED<br/>        <strong class="oe iu">image_border = bb.shift(left=border, top=border)\<br/>                         .draw_on_image(image_border, size=2, color=color)</strong></span><span id="ec90" class="nd ls it oe b gy pg oj l ok ol">return image_border</span></pre><p id="c291" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们现在对图像应用相同的旋转，并绘制边界框</p><pre class="lg lh li lj gt od oe of og aw oh bi"><span id="bc2c" class="nd ls it oe b gy oi oj l ok ol">rotate=iaa.Affine(rotate=(-50, 30))<br/>image_aug, bbs_aug = rotate(image=image, bounding_boxes=bbs)</span><span id="36c8" class="nd ls it oe b gy pg oj l ok ol">image_after = draw_bbs(image_aug, bbs_aug.remove_out_of_image().clip_out_of_image(), 100)<br/>ia.imshow(image_after)</span></pre><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi ph"><img src="../Images/c9aeeb8a30542cdb10ed1e85c6f968e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:920/format:webp/1*AVLwzHCWl-Ory9H4qd4Zog.png"/></div></figure><p id="8b04" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu"> <em class="le">在下一篇文章中，我们将探讨用于图像增强的 Keras imagedata generator</em></strong></p><h1 id="e549" class="lr ls it bd lt lu lv lw lx ly lz ma mb jz mc ka md kc me kd mf kf mg kg mh mi bi translated">参考资料:</h1><div class="pi pj gp gr pk pl"><a href="https://imgaug.readthedocs.io/en/latest/index.html" rel="noopener  ugc nofollow" target="_blank"><div class="pm ab fo"><div class="pn ab po cl cj pp"><h2 class="bd iu gy z fp pq fr fs pr fu fw is bi translated">imgaug - imgaug 0.3.0 文档</h2><div class="ps l"><h3 class="bd b gy z fp pq fr fs pr fu fw dk translated">imgaug 是一个用于机器学习实验中图像增强的库。它支持大范围的增强…</h3></div><div class="pt l"><p class="bd b dl z fp pq fr fs pr fu fw dk translated">imgaug.readthedocs.io</p></div></div></div></a></div><p id="742c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><a class="ae pu" href="https://blog.keras.io/building-powerful-image-classification-models-using-very-little-data.html" rel="noopener ugc nofollow" target="_blank">https://blog . keras . io/building-powerful-image-class ification-models-using-very-little-data . html</a></p><p id="f4b9" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><a class="ae pu" href="https://nanonets.com/blog/data-augmentation-how-to-use-deep-learning-when-you-have-limited-data-part-2/" rel="noopener ugc nofollow" target="_blank">https://nano nets . com/blog/data-augmentation-how-to-use-deep-learning-when-you-have-limited-data-part-2/</a></p><p id="4dc8" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><a class="ae pu" href="https://github.com/Lexie88rus/augmentation-packages-overview/blob/master/data-augmentation-packages-overview.ipynb" rel="noopener ugc nofollow" target="_blank">https://github . com/lexie 88 RUS/augmentation-packages-overview/blob/master/data-augmentation-packages-overview . ipynb</a></p><p id="520d" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><a class="ae pu" href="https://link.springer.com/content/pdf/10.1186%2Fs40537-019-0197-0.pdf" rel="noopener ugc nofollow" target="_blank">https://link . springer . com/content/pdf/10.1186% 2fs 40537-019-0197-0 . pdf</a></p></div></div>    
</body>
</html>