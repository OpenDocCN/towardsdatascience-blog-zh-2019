<html>
<head>
<title>WatermelonBlock and Google BERT | Till Better NLP Models Do Us Part</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">WatermelonBlock 和 Google BERT |直到更好的 NLP 模型将我们分开</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/watermelonblock-and-bert-till-better-nlp-models-do-us-part-555ad7839a7c?source=collection_archive---------26-----------------------#2019-01-07">https://towardsdatascience.com/watermelonblock-and-bert-till-better-nlp-models-do-us-part-555ad7839a7c?source=collection_archive---------26-----------------------#2019-01-07</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="cee8" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">BERT——任何 NLP 工程师都渴望得到的完美新年礼物。</h2></div><p id="1976" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><a class="ae lb" href="https://www.watermelonblock.io/" rel="noopener ugc nofollow" target="_blank"> WatermelonBlock </a>的数据科学团队已经接受了实验，我们已经开始实施深度文本挖掘算法，以便不时提高准确率，从而产生高效的数据管道。这种管道可以处理我们从网络上获得的大量自然语言语料库，并轻松实现偏差-方差权衡。</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="gh gi lc"><img src="../Images/14b9d4cd4739120a5f48e8a90987455c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*VQkARnAyFman-YoX.png"/></div></div><figcaption class="lo lp gj gh gi lq lr bd b be z dk"><strong class="bd ls">Source:</strong> WatermelonBlock</figcaption></figure><p id="ddd1" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><a class="ae lb" href="https://finance.yahoo.com/news/watermelonblock-partners-ibm-watson-using-123000544.html" rel="noopener ugc nofollow" target="_blank">我们在 IBM </a>的合作伙伴在<a class="ae lb" href="https://developer.ibm.com/linuxonpower/deep-learning-powerai/" rel="noopener ugc nofollow" target="_blank">与我们合作，利用 IBM PowerAI 服务器</a>进行这些实验，并获得预期的结果。该团队一直在开发一些令人难以置信的自然语言处理模型，以便为我们的客户提供智能但通用的实时洞察应用程序。一个这样的模型是趋势开源 NLP 模型——最近由 Google 开发的<em class="lt">【BERT】</em>。我们在为我们的应用测试 BERT 框架时获得的初步结果表明，分类错误减少了 20%,并且仅用了 4 个小时来训练包含超过 140 万个示例的非结构化数据集的集成模型。</p><p id="5fa4" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><a class="ae lb" href="https://twitter.com/watermelonblock/status/1078929013094010885" rel="noopener ugc nofollow" target="_blank">https://Twitter . com/watermelon block/status/1078929013094010885</a></p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="gh gi lu"><img src="../Images/546adb0afc95ca6e0d6220709272fca7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OogWtHlUd9NRaj7-8FAqiw.png"/></div></div></figure><p id="2714" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这好得令人难以置信，但的确，这是我们迄今为止最好的成绩之一。任何数据科学团队都渴望得到的完美新年礼物。事实上，我们已经爱上了这个框架，迫不及待地将它部署到生产中。</p><p id="606b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">那么什么是 BERT，它是如何工作的？</p><p id="b34a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">来自 Transformer 的 BERT a.k.a <em class="lt">双向编码器表示法是一种预训练语言表示法的新方法，它在各种自然语言处理任务(如语际机器翻译和事实核查)上提供了最先进的结果。让我们从模型基础背后的概念开始。</em></p><h2 id="67a8" class="lv lw iq bd lx ly lz dn ma mb mc dp md ko me mf mg ks mh mi mj kw mk ml mm mn bi translated"><strong class="ak">伯特的内脏(来源:插图伯特|杰伊·阿拉玛)</strong></h2><p id="b7cf" class="pw-post-body-paragraph kf kg iq kh b ki mo jr kk kl mp ju kn ko mq kq kr ks mr ku kv kw ms ky kz la ij bi translated">BERT 基本上是一个带有关注机制的变压器编码器堆栈。</p><p id="ad80" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果你不知道什么是注意力机制，<a class="ae lb" href="http://www.wildml.com/2016/01/attention-and-memory-in-deep-learning-and-nlp/" rel="noopener ugc nofollow" target="_blank">这篇由 WildML </a>撰写的精彩文章将让你快速了解！另一方面，转换器是一种深度学习模型，它通过将输入数据表示为合适的形式来加速整个堆栈的训练过程。虽然转换器由两个重要的组件组成，即相互连接的<em class="lt">编码组件</em>和<em class="lt">解码组件</em>，但是 BERT 只使用编码组件进行操作。</p><p id="f096" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">下图是一个使用转换系统将法语句子翻译成英语的简单黑盒案例。</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="gh gi lc"><img src="../Images/467844eedd9161b05e588775ad674117.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*3aP1og5woC3k_Phn.png"/></div></div><figcaption class="lo lp gj gh gi lq lr bd b be z dk"><strong class="bd ls">A transformer stack | Source: </strong><em class="mt">The Illustrated BERT, Jay Alammar</em></figcaption></figure><p id="979f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">编码组件是一个编码器堆栈(为了给出一个例子，我们将 6 个编码器堆叠在一起，但是也可以尝试其他的排列)。每个编码器都有一个<em class="lt">前馈网络</em>层和一个<em class="lt">自关注机制</em>层，而每个解码器都有一个相同的附加层— <em class="lt">编码器-解码器关注。</em></p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="gh gi mu"><img src="../Images/c3094b591463feeb4d3008ebfd4ee089.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*1vzPkj6j3rlgeSId.png"/></div></div><figcaption class="lo lp gj gh gi lq lr bd b be z dk"><strong class="bd ls">Encoder &amp; Decoder Components | Source: </strong>The Illustrated BERT, Jay Alammar</figcaption></figure><p id="b1c8" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">编码器的输入最初流经<em class="lt">自我关注层</em>，这是一个神经层，帮助编码器在编码特定单词时查看输入句子中的其他单词。</p><p id="b603" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">自关注层的输出然后被馈送到<em class="lt">前馈层</em>——该层分配权重并将编码的单词向量向前传播到下一个编码组件。</p><p id="4c71" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">解码器有这两层，但在它们之间有一个<em class="lt">编码器-解码器</em> <em class="lt">注意层</em>，这是一种安全措施，有助于解码器关注给定输入句子的相关部分。</p><h2 id="53de" class="lv lw iq bd lx ly lz dn ma mb mc dp md ko me mf mg ks mh mi mj kw mk ml mm mn bi translated">伯特的建筑(来源:插图伯特|杰伊·阿拉玛)</h2><p id="78db" class="pw-post-body-paragraph kf kg iq kh b ki mo jr kk kl mp ju kn ko mq kq kr ks mr ku kv kw ms ky kz la ij bi translated">已经开发了两种类型的 BERT 模型:</p><p id="c184" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">1.<strong class="kh ir"> <em class="lt"> BERT Base: </em> </strong>体积较小，计算负担得起，不适用于复杂的文本挖掘操作。</p><p id="4e8a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">2.<strong class="kh ir"> <em class="lt"> BERT Large: </em> </strong>体积较大，计算开销大，处理文本数据只是为了提供最佳结果。</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="gh gi lc"><img src="../Images/c9118e9c42fe773eff747c3e00dee87c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*PNghi2ky5NtGjfIO.png"/></div></div><figcaption class="lo lp gj gh gi lq lr bd b be z dk"><strong class="bd ls">BERT Variants | Source:</strong> The Illustrated BERT, Jay Alammar</figcaption></figure><p id="fb32" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">两种 BERT 模型都有<em class="lt">‘N’</em>编码器层(也称为变压器模块)，形成了一个大规模的数据编码堆栈。通常基础版<em class="lt"> N = 12 </em>，大版<em class="lt"> N = 24 </em>。他们有更大的前馈层(分别为 768 和 1024 个隐藏单元)，以及自我关注层(分别为 12 和 16)。</p><p id="7eaa" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">出于解释的目的，让我们使用具有 6 个编码器层、512 个前馈层和 8 个自我关注层的迷你版 BERT 来对垃圾文本或真实文本进行分类。</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="gh gi lc"><img src="../Images/a95c2382d36a155ce98b58fde50565db.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*DEqXQwv0Y7KEDM8H.png"/></div></div><figcaption class="lo lp gj gh gi lq lr bd b be z dk"><strong class="bd ls">Encoder Block | Source:</strong> The Illustrated BERT, Jay Alammar</figcaption></figure><p id="f2c0" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">就像变压器中的典型编码器一样，BERT 接受一系列单词作为输入，这些单词在堆栈中不断向上流动。每一层应用自我关注，并通过前馈网络传递其结果，然后将其交给下一个编码器。第一个输入令牌是分类器令牌<strong class="kh ir">【CLS】</strong>，它通过前馈网络和 softmax 函数将该层中输入的编码版本传送到下一个编码器层。</p><p id="81de" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">就输出而言，转换器堆栈中的每个编码器位置给出一个隐藏大小为 768 的合成向量(在 BERT Base 的情况下)</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="gh gi lc"><img src="../Images/fa17e35db0a1d6d08279f66b9847a0fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*r91cgNG5YGeW2JL1.png"/></div></div><figcaption class="lo lp gj gh gi lq lr bd b be z dk"><strong class="bd ls">Encoded Output Flow | Source:</strong> The Illustrated BERT</figcaption></figure><p id="0bca" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">对于垃圾邮件分类的任务，仅仅单个编码器位置就足够了。生成的向量然后被发送到我们选择的分类器，它通常是一个单层神经网络，具有分配最终权重的前馈网络和用于非线性的<a class="ae lb" href="https://en.wikipedia.org/wiki/Softmax_function" rel="noopener ugc nofollow" target="_blank"> softmax 函数</a>。softmax 是一个很棒的激活函数，它将数值上不正确的逻辑转换成一个平衡的概率分布，所有的概率总和为一。</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="gh gi lc"><img src="../Images/42b51eb4878654940b1e4fe9ff05cc66.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*8aWn6Pqe7soQ47q8.jpg"/></div></div><figcaption class="lo lp gj gh gi lq lr bd b be z dk"><strong class="bd ls">Probabilistic Classification | Source:</strong> The Illustrated BERT, Jay Alammar</figcaption></figure><p id="8a60" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果有更多的目标标签可以自动将电子邮件分类为“社交帖子”或“推广电子邮件”，那么调整分类器网络以具有更多最终通过 softmax 函数的输出神经元(在本例中为 4 个输出神经元)就足够了。</p><p id="4b60" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">从分类器获得的概率值给出了电子邮件是垃圾邮件或其他邮件的可能性。虽然垃圾邮件分类只是 BERT 如何轻松做到更好的要点，但假新闻检测、社会情绪分类、令牌审查监控等复杂任务都有发挥的空间。</p><p id="06e5" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">就我们在 WatermelonBlock 的实验而言，BERT 是 ELMo、ULMFiT 等众多模型中的一个，我们努力通过快速集思广益会议为我们的客户创建最佳洞察应用程序。</p><p id="7f0b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果您喜欢这个技术博客，并想了解更多关于 WatermelonBlock 的<a class="ae lb" href="https://www.watermelonblock.io/#team" rel="noopener ugc nofollow" target="_blank">工程师和数据科学家如何构建下一代产品的信息，请热烈鼓掌欢迎这篇文章，并关注我们的中型博客频道，网址为</a><a class="mv mw ep" href="https://medium.com/u/2e4ae63ee111?source=post_page-----555ad7839a7c--------------------------------" rel="noopener" target="_blank"> WatermelonBlock </a>，也可以访问我们网站上的<a class="ae lb" href="https://www.watermelonblock.io/blog/" rel="noopener ugc nofollow" target="_blank">公告页面，了解即将发布的新闻！</a></p><h2 id="6435" class="lv lw iq bd lx ly lz dn ma mb mc dp md ko me mf mg ks mh mi mj kw mk ml mm mn bi translated">参考资料:</h2><p id="a300" class="pw-post-body-paragraph kf kg iq kh b ki mo jr kk kl mp ju kn ko mq kq kr ks mr ku kv kw ms ky kz la ij bi translated">1.<em class="lt">《图解变形金刚》，杰·阿拉玛，2018，</em>【https://jalammar.github.io/illustrated-transformer/ T2】</p><p id="31af" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">2.<em class="lt">“自然语言处理中的自我注意机制”</em>，<a class="ae lb" href="https://dzone.com/articles/self-attention-mechanisms-in-natural-language-proc" rel="noopener ugc nofollow" target="_blank">https://dzone . com/articles/Self-Attention-Mechanisms-in-Natural-Language-proc</a></p><p id="7341" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">3.<em class="lt">《开源 BERT:自然语言处理最先进的预训练》，</em> <em class="lt"> Google AI，2018 </em></p></div></div>    
</body>
</html>