<html>
<head>
<title>Splitting your data to fit any machine learning model</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">拆分数据以适应任何机器学习模型</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/splitting-your-data-to-fit-any-machine-learning-model-5774473cbed2?source=collection_archive---------14-----------------------#2019-10-23">https://towardsdatascience.com/splitting-your-data-to-fit-any-machine-learning-model-5774473cbed2?source=collection_archive---------14-----------------------#2019-10-23</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="e788" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用 scikit-learn，只需几行代码就可以将数据集分成训练和测试，并将特征从目标中分离出来。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/2cf8102705fdc0b87d4f67b298216fd1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-Y6CVa_Tj6_14WoIQ0whhw.jpeg"/></div></div></figure></div><div class="ab cl ku kv hx kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="im in io ip iq"><p id="f63c" class="pw-post-body-paragraph lb lc it ld b le lf ju lg lh li jx lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated"><strong class="ld iu">简介</strong></p><p id="02ad" class="pw-post-body-paragraph lb lc it ld b le lf ju lg lh li jx lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">在您执行了数据清理、数据可视化并了解了数据的详细信息后，是时候将第一个机器学习模型放入其中了。今天，我想与大家分享几行非常简单的代码，这些代码将把任何数据集划分为变量，您可以将这些变量传递给任何机器学习模型，并开始训练它。</p><p id="18c5" class="pw-post-body-paragraph lb lc it ld b le lf ju lg lh li jx lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">这非常简单，但是对于任何数据科学家来说，理解训练和测试数据集的 split 函数是如何工作的是至关重要的。让我们深入研究一下。</p></div><div class="ab cl ku kv hx kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="im in io ip iq"><p id="88ed" class="pw-post-body-paragraph lb lc it ld b le lf ju lg lh li jx lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated"><strong class="ld iu">准备数据</strong></p><p id="7e9d" class="pw-post-body-paragraph lb lc it ld b le lf ju lg lh li jx lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">我们将为可视化目的创建一个简单的医疗数据集。想象一下，我们正试图根据患者的体重、身高以及他是否饮酒的信息来预测他是否健康。因此，我们将有三列包含此信息，第四列包含患者是否健康的记录。这是我们的目标变量，我们想要预测的东西。为了简单起见，这里我们将只有 10 个病人。让我们创建这个数据框:</p><pre class="kj kk kl km gt lx ly lz ma aw mb bi"><span id="53b4" class="mc md it ly b gy me mf l mg mh">import pandas as pd<br/>import numpy as np<br/>client_dictionary = {'weight': [112, 123, 176, 145, 198, 211, 145, 181, 90, 101], <br/>                     'height': [181, 165, 167, 154, 181, 202, 201, 153, 142, 169],<br/>                     'drinks alcohol': [0, 1, 1, 1, 0, 1, 1, 1, 0, 1],<br/>                     'healthy': [0, 1, 1, 1, 0, 0, 1, 1, 1, 1],}<br/>df = pd.DataFrame(client_dictionary)<br/>df.head(10)</span></pre><p id="dd0e" class="pw-post-body-paragraph lb lc it ld b le lf ju lg lh li jx lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">我们的数据框如下所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mi"><img src="../Images/5c3e8b13531357d9885e431d0578ff22.png" data-original-src="https://miro.medium.com/v2/resize:fit:560/format:webp/1*Q67xXrnaVnGUriIsUYC6HQ.png"/></div></figure></div><div class="ab cl ku kv hx kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="im in io ip iq"><p id="7eb8" class="pw-post-body-paragraph lb lc it ld b le lf ju lg lh li jx lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated"><strong class="ld iu">从目标变量中分离特征</strong></p><p id="5d69" class="pw-post-body-paragraph lb lc it ld b le lf ju lg lh li jx lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">我们应该从将模型的特征从目标变量中分离出来开始。注意，在我们的例子中，除了<em class="mj">‘healthy’</em>之外的所有列都是我们想要用于模型的特性。我们的目标变量是“健康”。我们可以使用下面的代码来进行目标分离。</p><pre class="kj kk kl km gt lx ly lz ma aw mb bi"><span id="99f7" class="mc md it ly b gy me mf l mg mh">x_data = df[['weight', 'height', 'drinks alcohol']]<br/>y_data = df['healthy']</span></pre><p id="4742" class="pw-post-body-paragraph lb lc it ld b le lf ju lg lh li jx lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">现在我们的 x_data 看起来像这样:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mk"><img src="../Images/60c9dd72ba76efc17a6a6aae160993ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:676/format:webp/1*GRJHr807uQcIDbRF4c8L5Q.png"/></div></div></figure></div><div class="ab cl ku kv hx kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="im in io ip iq"><p id="0126" class="pw-post-body-paragraph lb lc it ld b le lf ju lg lh li jx lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">y_data 是这样的:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ml"><img src="../Images/12d84a0e12b092077ad54f9c451b7885.png" data-original-src="https://miro.medium.com/v2/resize:fit:804/format:webp/1*zYgR4rZjWEPMJ0lqajb0vw.png"/></div></div></figure></div><div class="ab cl ku kv hx kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="im in io ip iq"><p id="54cc" class="pw-post-body-paragraph lb lc it ld b le lf ju lg lh li jx lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated"><strong class="ld iu">使用 train_test_split </strong></p><p id="b4d1" class="pw-post-body-paragraph lb lc it ld b le lf ju lg lh li jx lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">现在让我们使用 scikit-learn 函数中的 train_test_split 将特征数据(x_data)和目标数据(y_data)进一步划分为 train 和 test。</p><pre class="kj kk kl km gt lx ly lz ma aw mb bi"><span id="de63" class="mc md it ly b gy me mf l mg mh">from sklearn.model_selection import train_test_split<br/>x_train, x_test, y_train, y_test = train_test_split(x_data, y_data ,test_size = 0.2, shuffle=False)</span></pre><p id="5d0c" class="pw-post-body-paragraph lb lc it ld b le lf ju lg lh li jx lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">因此，我们将初始数据框划分为四个不同的数据集，如下图所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mm"><img src="../Images/ded954e2c792755572795a57a1228834.png" data-original-src="https://miro.medium.com/v2/resize:fit:1074/format:webp/1*T1LGCmPE6RK4LPgVFeoxvg.png"/></div></figure><p id="a9ad" class="pw-post-body-paragraph lb lc it ld b le lf ju lg lh li jx lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">当调用 train_test_split 函数时，我使用了参数<em class="mj"> shuffle=False </em>来实现你在上图中看到的结果。前 80 %的数据用于训练，剩下的 20%用于测试。shuffle 的默认参数是<em class="mj"> True </em>，这是您在现实生活中通常使用的参数。这意味着在数据被分成 test 和 train 之前的行被混洗，因此它们的顺序被改变。</p></div><div class="ab cl ku kv hx kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="im in io ip iq"><p id="2058" class="pw-post-body-paragraph lb lc it ld b le lf ju lg lh li jx lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated"><strong class="ld iu">控制测试列车分割比例</strong></p><p id="c549" class="pw-post-body-paragraph lb lc it ld b le lf ju lg lh li jx lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">您可以通过使用<em class="mj">测试大小</em>参数来控制训练测试分割分数。请注意，在我们的示例中，我们将其设置为 0.2。它可以是 0.0 到 1.0 之间的任何数字。您不必指定训练集的分数，因为默认情况下，它将使用测试集未获取的所有剩余数据。</p></div><div class="ab cl ku kv hx kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="im in io ip iq"><p id="fa76" class="pw-post-body-paragraph lb lc it ld b le lf ju lg lh li jx lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated"><strong class="ld iu">训练你的机器学习模型</strong></p><p id="5846" class="pw-post-body-paragraph lb lc it ld b le lf ju lg lh li jx lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">您准备的数据现在可以输入到机器学习模型中了。我们就用一个非常简单的线性回归模型来说明吧。</p><pre class="kj kk kl km gt lx ly lz ma aw mb bi"><span id="c1d4" class="mc md it ly b gy me mf l mg mh">from sklearn import linear_model<br/>linear_regression_model = linear_model.LinearRegression()<br/>linear_regression_model.fit(x_train, y_train)</span></pre><p id="5555" class="pw-post-body-paragraph lb lc it ld b le lf ju lg lh li jx lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">上面的模型是使用 x_train 和 y_train 样本训练的。现在，您可以使用以下代码对测试集进行预测。</p><pre class="kj kk kl km gt lx ly lz ma aw mb bi"><span id="3757" class="mc md it ly b gy me mf l mg mh">y_pred = linear_regression_model.predict(x_test)</span></pre><p id="4f6a" class="pw-post-body-paragraph lb lc it ld b le lf ju lg lh li jx lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">现在，如果您想评估您的模型有多好，您需要将您在测试集(y_pred)上的预测与测试集(y_test)的实际目标值进行比较。但这是一个不同的故事，我们不会在这里讨论。</p></div><div class="ab cl ku kv hx kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="im in io ip iq"><p id="4655" class="pw-post-body-paragraph lb lc it ld b le lf ju lg lh li jx lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated"><strong class="ld iu">结论</strong></p><p id="b0e0" class="pw-post-body-paragraph lb lc it ld b le lf ju lg lh li jx lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">您已经学习了如何将数据集分成特征和目标变量，然后进一步将其分成测试和训练部分。而这一切只需要几行代码，优雅而简单。</p><p id="cc56" class="pw-post-body-paragraph lb lc it ld b le lf ju lg lh li jx lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">此外，我希望你能理解拆分是如何工作的，并且从现在开始你会明智地使用它，而不是仅仅复制粘贴你找到的代码。</p><p id="1cd8" class="pw-post-body-paragraph lb lc it ld b le lf ju lg lh li jx lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated"><em class="mj">如果你不时地复制粘贴代码，那也没问题，但是当你真正理解它的时候，你会感到多么满足。</em></p></div><div class="ab cl ku kv hx kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="im in io ip iq"><p id="0f61" class="pw-post-body-paragraph lb lc it ld b le lf ju lg lh li jx lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated"><em class="mj">最初发表于 aboutdatablog.com: </em> <a class="ae mn" href="https://www.aboutdatablog.com/post/splitting-your-data-to-fit-any-machine-learning-model" rel="noopener ugc nofollow" target="_blank">拆分你的数据以适合任何机器学习模型</a>，<em class="mj">2019 年 10 月 23 日。</em></p></div><div class="ab cl ku kv hx kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="im in io ip iq"><p id="0836" class="pw-post-body-paragraph lb lc it ld b le lf ju lg lh li jx lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated"><em class="mj"> PS:我正在 Medium 和</em><a class="ae mn" href="https://www.aboutdatablog.com/" rel="noopener ugc nofollow" target="_blank"><strong class="ld iu"><em class="mj">aboutdatablog.com</em></strong></a><em class="mj">上撰写深入浅出地解释基本数据科学概念的文章。你可以订阅我的</em> <a class="ae mn" href="https://medium.com/subscribe/@konkiewicz.m" rel="noopener"> <strong class="ld iu"> <em class="mj">邮件列表</em> </strong> </a> <em class="mj">以便在我每次写新文章时得到通知。如果你还不是中等会员，你可以在这里加入</em><a class="ae mn" href="https://medium.com/@konkiewicz.m/membership" rel="noopener"><strong class="ld iu"><em class="mj"/></strong></a><em class="mj">。</em></p><p id="e435" class="pw-post-body-paragraph lb lc it ld b le lf ju lg lh li jx lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">下面还有一些你可能喜欢的帖子</p><div class="mo mp gp gr mq mr"><a rel="noopener follow" target="_blank" href="/what-are-lambda-functions-in-python-and-why-you-should-start-using-them-right-now-75ab85655dc6"><div class="ms ab fo"><div class="mt ab mu cl cj mv"><h2 class="bd iu gy z fp mw fr fs mx fu fw is bi translated">python 中的 lambda 函数是什么，为什么你现在就应该开始使用它们</h2><div class="my l"><h3 class="bd b gy z fp mw fr fs mx fu fw dk translated">初学者在 python 和 pandas 中开始使用 lambda 函数的快速指南。</h3></div><div class="mz l"><p class="bd b dl z fp mw fr fs mx fu fw dk translated">towardsdatascience.com</p></div></div><div class="na l"><div class="nb l nc nd ne na nf ks mr"/></div></div></a></div><div class="mo mp gp gr mq mr"><a rel="noopener follow" target="_blank" href="/jupyter-notebook-autocompletion-f291008c66c"><div class="ms ab fo"><div class="mt ab mu cl cj mv"><h2 class="bd iu gy z fp mw fr fs mx fu fw is bi translated">Jupyter 笔记本自动完成</h2><div class="my l"><h3 class="bd b gy z fp mw fr fs mx fu fw dk translated">数据科学家的最佳生产力工具，如果您还没有使用它，您应该使用它…</h3></div><div class="mz l"><p class="bd b dl z fp mw fr fs mx fu fw dk translated">towardsdatascience.com</p></div></div><div class="na l"><div class="ng l nc nd ne na nf ks mr"/></div></div></a></div><div class="mo mp gp gr mq mr"><a rel="noopener follow" target="_blank" href="/7-practical-pandas-tips-when-you-start-working-with-the-library-e4a9205eb443"><div class="ms ab fo"><div class="mt ab mu cl cj mv"><h2 class="bd iu gy z fp mw fr fs mx fu fw is bi translated">当你开始与图书馆合作时，7 个实用的熊猫提示</h2><div class="my l"><h3 class="bd b gy z fp mw fr fs mx fu fw dk translated">解释一些乍一看不那么明显的东西…</h3></div><div class="mz l"><p class="bd b dl z fp mw fr fs mx fu fw dk translated">towardsdatascience.com</p></div></div><div class="na l"><div class="nh l nc nd ne na nf ks mr"/></div></div></a></div></div></div>    
</body>
</html>