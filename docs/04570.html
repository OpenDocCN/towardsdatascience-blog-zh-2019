<html>
<head>
<title>Generate News Sentiment Scores in Excel</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在 Excel 中生成新闻情感评分</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/https-towardsdatascience-com-generate-news-sentiment-scores-in-excel-1edddfc25163?source=collection_archive---------15-----------------------#2019-07-13">https://towardsdatascience.com/https-towardsdatascience-com-generate-news-sentiment-scores-in-excel-1edddfc25163?source=collection_archive---------15-----------------------#2019-07-13</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="e76b" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">具有单一功能</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi kf"><img src="../Images/8b9c51ce64de1dad64b58c0ded77d133.png" data-original-src="https://miro.medium.com/v2/resize:fit:1398/1*ICeggibzLhNitrg0PCn4pQ.gif"/></div><figcaption class="kn ko gj gh gi kp kq bd b be z dk">Null result for days which have no news articles on The Business Times</figcaption></figure><p id="07fa" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir">刮掉的新闻文章</strong></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="lo lp di lq bf lr"><div class="gh gi ln"><img src="../Images/3b34a7de37cbd80d5717966a829904b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*leB-XJJaUZD30RCHHQzWLg.png"/></div></div><figcaption class="kn ko gj gh gi kp kq bd b be z dk">Search result for USD on the 8th July, Sentiment Score: -0.1409</figcaption></figure><p id="d798" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我收到了我的一个读者的请求，他在<a class="ae ls" rel="noopener" target="_blank" href="/https-towardsdatascience-com-algorithmic-trading-using-sentiment-analysis-on-news-articles-83db77966704">的算法交易中使用了对新闻文章</a>的情绪分析，来创建一个通用工具，让你可以从网上搜集的新闻文章(<a class="ae ls" href="https://www.businesstimes.com.sg/" rel="noopener ugc nofollow" target="_blank">《商业时报》</a>)中获得情绪分数。我以前在 algo 交易中用它作为衡量标准，但我认为它对投资组合管理或金融风险方面的人也非常有用。</p><h1 id="9673" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">想法</h1><p id="4ea4" class="pw-post-body-paragraph kr ks iq kt b ku ml jr kw kx mm ju kz la mn lc ld le mo lg lh li mp lk ll lm ij bi translated">这个想法是为了让非技术用户更容易在 Excel 上根据他们在不同的日子里感兴趣的各种术语得到简单的一对一的分数。我可以想象这将被用于投资组合的重新平衡，甚至作为媒体监控的自动化形式。我在之前的<a class="ae ls" rel="noopener" target="_blank" href="/https-towardsdatascience-com-algorithmic-trading-using-sentiment-analysis-on-news-articles-83db77966704">帖子</a>中描述了网络抓取和情感评分。</p><h1 id="3be3" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">设置的 9 个简单步骤</h1><p id="40af" class="pw-post-body-paragraph kr ks iq kt b ku ml jr kw kx mm ju kz la mn lc ld le mo lg lh li mp lk ll lm ij bi translated"><strong class="kt ir">*仅限 Windows *</strong></p><h2 id="66f3" class="mq lu iq bd lv mr ms dn lz mt mu dp md la mv mw mf le mx my mh li mz na mj nb bi translated"><span class="l nc nd ne bm nf ng nh ni nj di"> 1。</span> <a class="ae ls" href="https://www.linkedin.com/in/jasonyip184/" rel="noopener ugc nofollow" target="_blank"> LinkedIn 消息</a>我用你的电子邮件获取了项目文件夹</h2><h2 id="2e6a" class="mq lu iq bd lv mr ms dn lz mt mu dp md la mv mw mf le mx my mh li mz na mj nb bi translated"><span class="l nc nd ne bm nf ng nh ni nj di"> 2。</span>打开项目文件夹中的 perspective . py</h2><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="lo lp di lq bf lr"><div class="gh gi nk"><img src="../Images/74794e66b7be8bc013149800f3c4492b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*Gg7359VFmj1k9o1EgEI1Mw.gif"/></div></div><figcaption class="kn ko gj gh gi kp kq bd b be z dk">Replace the highlighted path with your own aka C:/Users/bob/Desktop/sentiment/stock_lexicon.pickle</figcaption></figure><h2 id="59b8" class="mq lu iq bd lv mr ms dn lz mt mu dp md la mv mw mf le mx my mh li mz na mj nb bi translated">3.下载并安装 Anaconda (Python)</h2><p id="8e66" class="pw-post-body-paragraph kr ks iq kt b ku ml jr kw kx mm ju kz la mn lc ld le mo lg lh li mp lk ll lm ij bi translated"><a class="ae ls" href="https://www.anaconda.com/distribution/#download-section" rel="noopener ugc nofollow" target="_blank">https://www.anaconda.com/distribution/#download-section</a></p><h2 id="4109" class="mq lu iq bd lv mr ms dn lz mt mu dp md la mv mw mf le mx my mh li mz na mj nb bi translated"><span class="l nc nd ne bm nf ng nh ni nj di"> 4。</span>打开命令提示符，创建 conda 环境</h2><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="lo lp di lq bf lr"><div class="gh gi nl"><img src="../Images/63ffb0b746f42496300945bc5767b3a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6sVnms_in2QZxJDmdTASPw.png"/></div></div><figcaption class="kn ko gj gh gi kp kq bd b be z dk">conda create -n py36 python=3.6 &amp;&amp; activate py36</figcaption></figure><h2 id="bda2" class="mq lu iq bd lv mr ms dn lz mt mu dp md la mv mw mf le mx my mh li mz na mj nb bi translated"><span class="l nc nd ne bm nf ng nh ni nj di"> 5。</span>进入情感项目目录并安装包</h2><p id="5a93" class="pw-post-body-paragraph kr ks iq kt b ku ml jr kw kx mm ju kz la mn lc ld le mo lg lh li mp lk ll lm ij bi translated">假设文件夹在您的桌面上</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="lo lp di lq bf lr"><div class="gh gi nm"><img src="../Images/68a839d8d0907d8a4f3cb692d2d79a67.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xKHlF1YoWqziOVCdLtra-Q.png"/></div></div><figcaption class="kn ko gj gh gi kp kq bd b be z dk">cd desktop/sentiment &amp;&amp; pip install -r requirements.txt</figcaption></figure><h2 id="7216" class="mq lu iq bd lv mr ms dn lz mt mu dp md la mv mw mf le mx my mh li mz na mj nb bi translated">6。在 Excel 中显示开发者标签</h2><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="lo lp di lq bf lr"><div class="gh gi nn"><img src="../Images/dea81132324a67155ebcd22f350350cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*Zy-XJ5Tj6FrSG42Jp7emtw.gif"/></div></div><figcaption class="kn ko gj gh gi kp kq bd b be z dk">File &gt; Options &gt; Customize Ribbon</figcaption></figure><h2 id="4847" class="mq lu iq bd lv mr ms dn lz mt mu dp md la mv mw mf le mx my mh li mz na mj nb bi translated">7。启用设置</h2><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="lo lp di lq bf lr"><div class="gh gi no"><img src="../Images/05a12397e8f262d6c4e0cc58b363fc7f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*DAErtFT_hdArJKGBtERaMA.gif"/></div></div><figcaption class="kn ko gj gh gi kp kq bd b be z dk">File &gt; Options &gt; Trust Center &gt; Trust Center Settings &gt; Macro Settings &gt; Trust access to the VBA project object model</figcaption></figure><h2 id="6702" class="mq lu iq bd lv mr ms dn lz mt mu dp md la mv mw mf le mx my mh li mz na mj nb bi translated">8。打开 perspective . xlsm 并启用 xlwings</h2><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="lo lp di lq bf lr"><div class="gh gi np"><img src="../Images/7fb082cc0eaa117cfe1aabab17bb1378.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*oFitaJPMht8F_xZ7VqbWhw.gif"/></div></div></figure><h2 id="8dfb" class="mq lu iq bd lv mr ms dn lz mt mu dp md la mv mw mf le mx my mh li mz na mj nb bi translated">9。将 xlwings 指向您的 conda 环境并导入 python 函数</h2><p id="da5c" class="pw-post-body-paragraph kr ks iq kt b ku ml jr kw kx mm ju kz la mn lc ld le mo lg lh li mp lk ll lm ij bi translated">指定 Anaconda3 的安装路径</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="lo lp di lq bf lr"><div class="gh gi nq"><img src="../Images/9899937671a9cae1b5efd8359a72abc2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*TpiSRKL8AtaJ_rqOTqp69g.gif"/></div></div><figcaption class="kn ko gj gh gi kp kq bd b be z dk">Conda Base: C:\Users\bob\Anaconda3</figcaption></figure><h1 id="a742" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">和..我们完了！</h1><p id="3524" class="pw-post-body-paragraph kr ks iq kt b ku ml jr kw kx mm ju kz la mn lc ld le mo lg lh li mp lk ll lm ij bi translated">欢迎分享任何意见或想法！</p></div></div>    
</body>
</html>