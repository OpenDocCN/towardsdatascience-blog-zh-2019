<html>
<head>
<title>Using Machine Learning to Predict Home Prices</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用机器学习来预测房价</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/using-machine-learning-to-predict-home-prices-d5d534e42d38?source=collection_archive---------14-----------------------#2019-01-07">https://towardsdatascience.com/using-machine-learning-to-predict-home-prices-d5d534e42d38?source=collection_archive---------14-----------------------#2019-01-07</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="176d" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">LassoCV、RidgeCV 和线性回归机器学习算法。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/ddf67821025ef4405700f8313bcc4082.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*c1mB6CARbRwBwg_M"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Photo by <a class="ae kv" href="https://unsplash.com/@gusruballo?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Gus Ruballo</a> on <a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="da26" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这篇文章中，我将向你展示我使用机器学习来预测房价的数据科学过程。在开始之前，我想概述一下数据科学流程:</p><ul class=""><li id="284c" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr lx ly lz ma bi translated">定义问题</li><li id="0abb" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">收集数据</li><li id="fc8b" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">清理和探索数据</li><li id="b873" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">对数据建模</li><li id="f920" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">评估模型</li><li id="dec9" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">回答问题</li></ul></div><div class="ab cl mg mh hu mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="ij ik il im in"><h1 id="c219" class="mn mo iq bd mp mq mr ms mt mu mv mw mx jw my jx mz jz na ka nb kc nc kd nd ne bi translated">定义问题</h1><p id="fb1e" class="pw-post-body-paragraph kw kx iq ky b kz nf jr lb lc ng ju le lf nh lh li lj ni ll lm ln nj lp lq lr ij bi translated">我的任务是<strong class="ky ir">创建一个机器学习模型，使用 Kaggle 的 Ames 住房数据集预测房价</strong>。为了使数据科学问题更加现实，我添加了提高<a class="ae kv" href="https://www.zillow.com/zestimate/" rel="noopener ugc nofollow" target="_blank"> Zillow 的 Zestimate 准确性(星级)</a>的需求，用于像 Ames 这样有 3 颗星的地区(良好的 Zestimate)。这可能是由于假设的三星级酒店的用户网络流量增加。</p><h1 id="3acb" class="mn mo iq bd mp mq nk ms mt mu nl mw mx jw nm jx mz jz nn ka nb kc no kd nd ne bi translated">收集数据</h1><p id="1008" class="pw-post-body-paragraph kw kx iq ky b kz nf jr lb lc ng ju le lf nh lh li lj ni ll lm ln nj lp lq lr ij bi translated">该数据集包含来自评估人办公室的<a class="ae kv" href="http://jse.amstat.org/v19n3/decock/DataDocumentation.txt" rel="noopener ugc nofollow" target="_blank">信息</a>，用于计算 2006 年至 2010 年在爱荷华州埃姆斯出售的个人住宅物业的评估价值。数据集包含 2051 行和 81 列(特征)信息。这些数据由 Kaggle 收集和提供。如果没有提供数据，我收集数据的方法是做研究，看看它是否公开，或者通过 Zillow 的 API 下载。</p><h1 id="2710" class="mn mo iq bd mp mq nk ms mt mu nl mw mx jw nm jx mz jz nn ka nb kc no kd nd ne bi translated">清理和探索数据</h1><p id="1336" class="pw-post-body-paragraph kw kx iq ky b kz nf jr lb lc ng ju le lf nh lh li lj ni ll lm ln nj lp lq lr ij bi translated">接下来，我执行了数据清理和探索性分析。对于前者，我检查空值和数据输入错误并做出决定。对于后者，我将数据可视化，以便更好地查看和理解关系和分布。</p><p id="9203" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">下面是我的目标变量——销售价格的两个可视化视图。我想了解它的分布。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi np"><img src="../Images/c615a25de66fe5b1b10d727a6c084f10.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*H40H_nFexduawYtLiekZNw.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">the distribution of Sale Price, the target, which we can see is right-skewed</figcaption></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi np"><img src="../Images/84f4e3b229708167f162c27de7d2f9d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xzhE7GMAfBZ_QeS4UVnDGw.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">the distribution of Sale Price, the target, after taking the log — now it’s more normally distributed</figcaption></figure><p id="f5d0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我把目标的日志输入到模型中。我这样做是因为该模型将试图找到我们目标的满意中值，但如果不加处理，它会一直低估离群值，这会对 R 平方得分产生负面影响。根据 R 平方公式，我们的模型越错误，它将受到越多的惩罚，因为分子中的残差(误差)被平方。因此，对我们记录的目标进行预测将允许模型具有与欠猜一样多的过猜或更正态分布的预测。</p><p id="09b3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">接下来，我想了解我的特征与我的目标变量之间的关系，所以我绘制了我的特征与售价 0.50 或更高的相关性的热图。没有一个与销售价格呈负相关，相关系数为-0.50 或更低。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nq"><img src="../Images/1c140b01c8f993d2d43f018309babd9a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*eCxBt8CFzW-RZEEE"/></div></div></figure><p id="e0c2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我想进一步研究这些关系，所以我从上面的关联热图中绘制了六个特征的散点图。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nr"><img src="../Images/2f07f26f24a8ed74dc8f6d9879ee4741.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ohp4K8nxL0meQGR9"/></div></div></figure><p id="07c5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如您所见，与 0.80 的销售价格具有最强相关性的<strong class="ky ir"><em class="ns">total _ qual</em></strong>在所选的六个中显示了最强的线性关系。</p><h1 id="0720" class="mn mo iq bd mp mq nk ms mt mu nl mw mx jw nm jx mz jz nn ka nb kc no kd nd ne bi translated">对数据建模</h1><p id="4df7" class="pw-post-body-paragraph kw kx iq ky b kz nf jr lb lc ng ju le lf nh lh li lj ni ll lm ln nj lp lq lr ij bi translated">在这一步中，我将我的数据分为训练集和测试集，选择我的特征以馈入模型、特征工程方法和模型。我最初从一个向前选择的过程开始——选择一个特性，运行我的模型，检查性能，然后重复这些步骤。我还手动创建了一些交互术语，dummied(将分类特征转换为布尔矩阵)，并映射(评分/加权分类特征)了一些我的分类特征。我选择的每一个功能都是有意为之的，无论是原样还是手工设计的。我主要依赖于该功能与销售价格的强相关性，以及我对某个功能是否会影响销售价格所做的直觉假设。使用这种方法，我得到了很好的结果，但后来我变得急切，并做出了(不正确的)假设，即如果我模拟或映射每个分类特征，然后在它们是数字后对所有特征应用多项式特征(整体相互作用项),那么我的所有特征对我的模型都将发挥最佳作用。</p><p id="2134" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我检查了我新设计的功能与我的目标变量销售价格的相关性。你可以看到下面几个的结果。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nq"><img src="../Images/ed39112f0cfd71e26dc34f7e72a91d61.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*JPG-zT519rbroNPB"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">correlations of the new dummied features to Sale Price</figcaption></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nq"><img src="../Images/46caef9a42a47f77f4950a726812a98a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*xbEv27JH4mp0hXri"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">correlations of the new mapped features to Sale Price</figcaption></figure><p id="f991" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">正如你所看到的，我绘制的特征(第二张图)比我模拟的特征与销售价格有更强的相关性。我仍然坚持我的假设，继续给我的模型添加我所有的特征(当然除了售价)。</p><p id="6e71" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我选择了三种机器学习算法，分别是线性回归、RidgeCV 和 LassoCV。我知道有了大量的特征，我会提高我的过度拟合的潜力，所以我想包括后面的模型，因为它们有严格的正则化方法。我还假设多项式要素会处理我的要素之间的任何多重共线性。</p><h1 id="0560" class="mn mo iq bd mp mq nk ms mt mu nl mw mx jw nm jx mz jz nn ka nb kc no kd nd ne bi translated">评估模型</h1><p id="0267" class="pw-post-body-paragraph kw kx iq ky b kz nf jr lb lc ng ju le lf nh lh li lj ni ll lm ln nj lp lq lr ij bi translated">我的模特是拉索夫。它在我的训练数据上达到了 94%的 R 平方，在看不见的数据上达到了 86%。我的测试数据的 RMSE 是 37，334。这意味着两件事:1)模型解释了数据中 86%的可变性，2)模型过度拟合。</p><p id="665e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">下面你可以看到我的预测(yhat)的分布覆盖在目标变量(y)上。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi np"><img src="../Images/9aa1757c832c430f67475acf5c0cf7af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*cFslzhDv11rCAbYv"/></div></div></figure><p id="1edb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">最终的模型不是我最好的模型。不幸的是，我重写了我的最佳模型中的特征——在我的特征选择和工程过程中我是故意的——因为做出了错误的假设，即把所有特征转换为数值并使用多项式特征会产生更好的结果。</p><h1 id="1273" class="mn mo iq bd mp mq nk ms mt mu nl mw mx jw nm jx mz jz nn ka nb kc no kd nd ne bi translated">回答问题</h1><p id="f856" class="pw-post-body-paragraph kw kx iq ky b kz nf jr lb lc ng ju le lf nh lh li lj ni ll lm ln nj lp lq lr ij bi translated">LassoCV 模型很好地处理了看不见的数据，所以我会用它来预测房价。</p><h2 id="9e8f" class="nt mo iq bd mp nu nv dn mt nw nx dp mx lf ny nz mz lj oa ob nb ln oc od nd oe bi translated">建议</h2><p id="1786" class="pw-post-body-paragraph kw kx iq ky b kz nf jr lb lc ng ju le lf nh lh li lj ni ll lm ln nj lp lq lr ij bi translated">我的一个建议是，通过以下方式继续测试/学习改进模型:</p><ul class=""><li id="795a" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr lx ly lz ma bi translated">重新审视我最初的正向选择流程</li><li id="fef7" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">选择与销售价格高度相关的功能</li><li id="1af0" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">创建新的并检查它们的相关性</li><li id="c48b" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">输入模型并检查结果</li><li id="e484" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">跟踪改进模型的特性，并丢弃(但也跟踪)不改进模型的特性</li></ul><p id="8e36" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">查看<a class="ae kv" href="https://github.com/traintestbritt/predicting_house_prices" rel="noopener ugc nofollow" target="_blank"> <strong class="ky ir">我的代码</strong> </a>和<a class="ae kv" href="https://docs.google.com/presentation/d/18HFR4V_COfimNcqGskrFQk7IxSU8_tn7iLrRXwrEkTg/edit?usp=sharing" rel="noopener ugc nofollow" target="_blank"> <strong class="ky ir">我的演示</strong> </a>。请评论任何问题。感谢阅读！</p></div></div>    
</body>
</html>