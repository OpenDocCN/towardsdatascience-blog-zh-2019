<html>
<head>
<title>Full Stack Development Tutorial: Integrate AWS Lambda Serverless Service into Angular SPA</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">全栈开发教程:将 AWS Lambda 无服务器服务集成到 Angular SPA 中</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/full-stack-development-tutorial-integrate-aws-lambda-serverless-service-into-angular-spa-abb70bcf417f?source=collection_archive---------9-----------------------#2019-12-01">https://towardsdatascience.com/full-stack-development-tutorial-integrate-aws-lambda-serverless-service-into-angular-spa-abb70bcf417f?source=collection_archive---------9-----------------------#2019-12-01</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/4cd6bf4ae63a5a8209dd01c171bd7f79.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ObxhgyK7OTh41ixz"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk">Photo by <a class="ae kf" href="https://unsplash.com/@srd844?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Stephen Dawson</a> on <a class="ae kf" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="d131" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">(这篇文章也可以在<a class="ae kf" href="https://kylelix7.github.io/" rel="noopener ugc nofollow" target="_blank">我的博客</a>中找到)</p><p id="27e0" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这篇文章是我的全栈开发教程系列的最后一篇文章。在这篇文章中，我们将把后端 Lambda REST API 集成到我们之前开发的 Angular App 中。以前的帖子是<a class="ae kf" rel="noopener" target="_blank" href="/full-stack-development-tutorial-visualize-trading-data-on-angular-spa-7ec2a5749a38">在 Angular SPA </a>上可视化交易数据和<a class="ae kf" rel="noopener" target="_blank" href="/full-stack-development-tutorial-serverless-rest-api-running-on-aws-lambda-a9a501f54405">在 AWS Lambda </a>上运行无服务器 REST API 提供交易数据。</p><p id="56da" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu">更新 angular 服务，从 Lambda 调用 REST API</strong></p><p id="a75e" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">首先，我们需要更新 SPA 中的服务，从 Lambda 调用 REST API，而不是返回哑数据。注意，我们已经定义了一个主题，以便图表组件可以被订阅。REST API 调用完成后。它发出历史数据。从图表组件中，它将接收该响应并对其进行一些业务逻辑处理。</p><figure class="le lf lg lh gt ju"><div class="bz fp l di"><div class="li lj l"/></div></figure><p id="0408" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">更新图表组件以使用 Lambda 中的历史数据来可视化图表。在这个 typescript 中，我们从 StockDataService 订阅了 Observerable。然后，它将 Lambda 的响应分配给图表。</p><figure class="le lf lg lh gt ju"><div class="bz fp l di"><div class="li lj l"/></div></figure><p id="a14a" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu">发布 web 应用</strong></p><p id="09a1" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在，我们可以为您的应用程序创建一个公共网站。首先，我们需要为 angular 应用程序部署构建生产代码。从终端运行以下命令。</p><pre class="le lf lg lh gt lk ll lm ln aw lo bi"><span id="981c" class="lp lq it ll b gy lr ls l lt lu">ng build --prod</span></pre><p id="2db9" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">此命令将导致 dist 文件夹，其中包含此 SPA 的所有静态文件。我们将部署到 S3 建立一个公共网站。</p><p id="c9f9" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu">创建一个 S3 存储桶</strong></p><p id="9719" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">创建新的存储桶。除非您购买了自己的域名并为您的 web 应用程序设置了域名，否则您的域名将成为网站 url 的一部分。</p><figure class="le lf lg lh gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi lv"><img src="../Images/e573a88509cd49f413fad9bf94f60648.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fTgk_xchMhpR2plTi6TTdA.png"/></div></div></figure><p id="3ce3" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">接受所有默认选项并创建它。然后选择新创建的存储桶，单击 permisions。在阻止公共访问中，我们必须取消选中阻止“通过新公共存储桶策略授予的对存储桶和对象的公共访问”和“通过任何公共存储桶策略阻止对存储桶和对象的公共和跨帐户访问”，以便公共用户可以访问此 web 应用程序。</p><figure class="le lf lg lh gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi lw"><img src="../Images/29320f3f4858f8bae88c820b0a108873.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mPyBleqyanCcsEOgwiYOZA.png"/></div></div></figure><p id="8f5e" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们还需要添加一个存储桶策略。</p><figure class="le lf lg lh gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi lx"><img src="../Images/4c0dc3b765558724913d66106de16d85.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9ntsY78rdQ6vesk64VflCg.png"/></div></div></figure><pre class="le lf lg lh gt lk ll lm ln aw lo bi"><span id="db54" class="lp lq it ll b gy lr ls l lt lu">{<br/>    "Version": "2012-10-17",<br/>    "Statement": [<br/>        {<br/>            "Effect": "Allow", <br/>            "Principal": "*", <br/>            "Action": "s3:GetObject", <br/>            "Resource": "arn:aws:s3:::[YOUR_BUCKET_NAME]/*" <br/>        } <br/>    ] <br/>}</span></pre><p id="4482" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu">上传内容</strong></p><p id="b1b3" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">将 dist/stock-app 文件夹中的文件上传到存储桶</p><p id="ef80" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu">启用虚拟主机</strong></p><p id="71c0" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">打开属性，选择“静态网站托管”。为索引 documemt 键入 index.html，然后选中“使用此存储桶托管网站”。</p><figure class="le lf lg lh gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi ly"><img src="../Images/0ff4d01d1a9ed731f4e5e5934848fb8b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ABYdUBSOeCZ9wkMBBJZm1A.png"/></div></div></figure><p id="6de5" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在，你应该可以在<a class="ae kf" href="http://stock-spa-jli.s3-website-us-west-2.amazonaws.com/" rel="noopener ugc nofollow" target="_blank"> http:// &lt; bucket_name &gt;开你的 SPA 了。&lt;your-region&gt;. Amazon AWS . com/</a>，我这里是 http://stock-spa-jli.s3-website-us-west-2.amazonaws.com/<a class="ae kf" href="http://stock-spa-jli.s3-website-us-west-2.amazonaws.com/" rel="noopener ugc nofollow" target="_blank"/>。但是，你会遇到一个问题。您看不到任何数据。那是因为我们的 REST API 和 API 网关不允许 CORS。我们将明确地启用它。</p><p id="3364" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu">启用 CORS </strong></p><p id="9db1" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">接下来，我们需要在 API 网关中启用 CORS，以便 Lambda 中的 API 可以接受跨源请求。</p><p id="4b3a" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在 AWS 控制台中打开 API 网关服务，并为我们在上一篇文章中开发的 Lambda 选择网关。选择要启用 CORS 的端点。为简单起见，我选择任意。然后在操作下拉列表中，选择启用 CORS 并确认。</p><figure class="le lf lg lh gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi lz"><img src="../Images/4eb8a791629beb0a39d18bfc0f734d92.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*L27d5eq1bgf9zHECj39yVw.png"/></div></div></figure><figure class="le lf lg lh gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi ma"><img src="../Images/179d40e444cc8bbd87b1fa6d978d44d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0tKYGWX8DHp-Nt9oRreveg.png"/></div></div></figure><p id="82e4" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu">验证</strong></p><p id="191f" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在，我们都准备好了。您的 Lambda 应该能够为您的 SPA 提供数据。回到你在 S3 的网站。你会看到间谍的股票图表。</p><figure class="le lf lg lh gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mb"><img src="../Images/369cef8b037b11952867ca8a2f139857.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*L92MhDDII5A7_AjGxARNDg.png"/></div></div></figure><p id="b76f" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">仅此而已。我们用 Angular 开发了一个简单的全栈 web 应用，使用无服务器框架，AWS Lambda，API gateway，S3。它是用云编队部署的。几乎所有后端 AWS Lambda 都由无服务器框架轻松处理。</p></div><div class="ab cl mc md hx me" role="separator"><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh"/></div><div class="im in io ip iq"><p id="aa22" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">建议读取:</p><p id="c40d" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><a class="ae kf" href="https://www.educative.io/courses/learn-the-a-to-z-of-amazon-web-services-aws?aff=VEzk" rel="noopener ugc nofollow" target="_blank">全面了解亚马逊网络服务(AWS) </a></p><p id="b570" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><a class="ae kf" href="https://www.amazon.com/gp/product/B07L9GHD6W/ref=as_li_tl?ie=UTF8&amp;camp=1789&amp;creative=9325&amp;creativeASIN=B07L9GHD6W&amp;linkCode=as2&amp;tag=blog023b-20&amp;linkId=8ed2825229096ab702683372bc52497a" rel="noopener ugc nofollow" target="_blank"> AWS Lambda 在行动:事件驱动的无服务器应用第 1 版</a></p><p id="9d87" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><a class="ae kf" href="https://www.amazon.com/gp/product/1617295116/ref=as_li_tl?ie=UTF8&amp;camp=1789&amp;creative=9325&amp;creativeASIN=1617295116&amp;linkCode=as2&amp;tag=blog023b-20&amp;linkId=524b38e985a6ff114380a3fa96d6618c" rel="noopener ugc nofollow" target="_blank">亚马逊网络服务第二版</a></p></div><div class="ab cl mc md hx me" role="separator"><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh"/></div><div class="im in io ip iq"><p id="007d" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我的旧帖子:</p><p id="f438" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><a class="ae kf" href="https://medium.com/@fin.techology/my-posts-about-finance-and-tech-7b7e6b2e57f4?source=your_stories_page---------------------------" rel="noopener">我关于金融和科技的帖子</a></p><p id="f7ff" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><a class="ae kf" href="https://medium.com/@fin.techology/my-posts-about-faang-interview-20e529c5f13f?source=your_stories_page---------------------------" rel="noopener">我关于 FAANG 访谈的帖子</a></p><p id="4395" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><a class="ae kf" href="https://medium.com/@fin.techology/from-crud-app-dev-to-sde-in-voice-assistant-my-ongoing-journey-to-ml-4ea11ec4966e?" rel="noopener">从 CRUD web 应用开发到语音助手中的 SDE——我正在进行的机器学习之旅</a></p><p id="4eb5" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><a class="ae kf" rel="noopener" target="_blank" href="/full-stack-development-tutorial-serverless-rest-api-running-on-aws-lambda-a9a501f54405">全栈开发教程:用运行在 AWS Lambda 上的无服务器 REST API 提供交易数据</a></p><p id="e02d" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><a class="ae kf" rel="noopener" target="_blank" href="/full-stack-development-tutorial-visualize-trading-data-on-angular-spa-7ec2a5749a38">全栈开发教程:在 Angular SPA 上可视化交易数据</a></p><p id="e279" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><a class="ae kf" href="https://medium.com/@kyle.jinhai.li/reinforcement-learning-introduction-to-q-learning-444c951e292c" rel="noopener">强化学习:Q 学习简介</a></p></div></div>    
</body>
</html>