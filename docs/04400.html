<html>
<head>
<title>Wimbledon Predictions using Neural Network.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用神经网络预测温布尔登。</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/predicting-wimbledon-matches-using-neural-network-e2ee4d3dead2?source=collection_archive---------25-----------------------#2019-07-08">https://towardsdatascience.com/predicting-wimbledon-matches-using-neural-network-e2ee4d3dead2?source=collection_archive---------25-----------------------#2019-07-08</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="45d2" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">神经网络预测<strong class="ak">诺瓦克·德约科维奇</strong>将在决赛中击败<strong class="ak">罗杰·费德勒</strong>成为最终的冠军。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/eeecd48da7c6372d858414b0244bf1e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vBjSNyBavBI13GC_pylkOQ.jpeg"/></div></div></figure><p id="9afe" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">随着第二周的<a class="ae lq" href="https://www.wimbledon.com/" rel="noopener ugc nofollow" target="_blank"> <strong class="kw iu">温布尔登</strong> </a>即将来临，有许多激动人心的比赛值得期待。温布尔登网球公开赛第二周的周一可以说是全年最激动人心的一天。周一，16 名最优秀的男女网球运动员将在温布尔登网球公开赛四分之一决赛中争夺一席之地。将会有很多体育评论员和分析家预测谁会进入 8 强，4 强，并最终成为冠军。</p><p id="635d" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">然而，我还没有遇到任何使用<strong class="kw iu">机器学习/人工智能</strong>做出的预测。因此，我认为这将是一个很好的机会，让我实施我一直在学习的一些机器学习技能，以预测温布尔登第二周的比赛。更具体地说，我将实现一个简单的<strong class="kw iu">2-隐层神经网络</strong>来预测比赛的结果。</p></div><div class="ab cl lr ls hx lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="im in io ip iq"><h1 id="dccf" class="ly lz it bd ma mb mc md me mf mg mh mi jz mj ka mk kc ml kd mm kf mn kg mo mp bi translated"><strong class="ak">我如何得出我的预测:</strong></h1><ul class=""><li id="adbe" class="mq mr it kw b kx ms la mt ld mu lh mv ll mw lp mx my mz na bi translated"><strong class="kw iu">第一步:创建可以帮助预测比赛获胜者的特征</strong>。</li><li id="240e" class="mq mr it kw b kx nb la nc ld nd lh ne ll nf lp mx my mz na bi translated"><strong class="kw iu">步骤 2:使用<a class="ae lq" href="https://keras.io/" rel="noopener ugc nofollow" target="_blank"> Keras </a>建立、验证和微调模型神经网络</strong>，并检查过拟合/损失函数/测试精度。</li><li id="997f" class="mq mr it kw b kx nb la nc ld nd lh ne ll nf lp mx my mz na bi translated">第三步:做预测</li></ul></div><div class="ab cl lr ls hx lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="im in io ip iq"><h1 id="e7cb" class="ly lz it bd ma mb mc md me mf mg mh mi jz mj ka mk kc ml kd mm kf mn kg mo mp bi translated">步骤 1:创建特征:</h1><p id="7f41" class="pw-post-body-paragraph ku kv it kw b kx ms ju kz la mt jx lc ld ng lf lg lh nh lj lk ll ni ln lo lp im bi translated">神经网络或任何预测模型最重要的部分之一是创建能够解释结果变量的特征。像<strong class="kw iu">选手排名、整体胜率、草地胜率</strong>这样的特征将在很大程度上帮助解释一场网球比赛的结果。此外，根据<strong class="kw iu">过去 52 周的胜率</strong>和单挑记录捕捉到的玩家状态可以进一步帮助预测结果。总的来说，我创建了 21 个特征作为神经网络的输入层，下面是我认为最重要的 5 个特征。</p><ol class=""><li id="2387" class="mq mr it kw b kx ky la lb ld nj lh nk ll nl lp nm my mz na bi translated">排名。</li><li id="41df" class="mq mr it kw b kx nb la nc ld nd lh ne ll nf lp nm my mz na bi translated">匹配胜率。</li><li id="2869" class="mq mr it kw b kx nb la nc ld nd lh ne ll nf lp nm my mz na bi translated">在草地上头对头。</li><li id="b264" class="mq mr it kw b kx nb la nc ld nd lh ne ll nf lp nm my mz na bi translated">过去 60 周在草地上的比赛胜率。</li><li id="9a85" class="mq mr it kw b kx nb la nc ld nd lh ne ll nf lp nm my mz na bi translated">五局三胜的百分比。</li></ol><p id="3a98" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">注意:对于每个特征，我计算两个玩家之间的差异。例如排名=(玩家 0 的排名)——(玩家 1 的排名)。</p></div><div class="ab cl lr ls hx lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="im in io ip iq"><h1 id="0e31" class="ly lz it bd ma mb mc md me mf mg mh mi jz mj ka mk kc ml kd mm kf mn kg mo mp bi translated">第二步:建立并微调神经网络。</h1><p id="ac2d" class="pw-post-body-paragraph ku kv it kw b kx ms ju kz la mt jx lc ld ng lf lg lh nh lj lk ll ni ln lo lp im bi translated">在我描述神经网络的实现之前，下面是带有特征的数据的一个片段。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nn"><img src="../Images/71a92b9a8d1f6fcafe5122c7413cb836.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1BhJDreyGI06_Fq1X4_UUA.png"/></div></div><figcaption class="no np gj gh gi nq nr bd b be z dk">Training Sample Snippet</figcaption></figure><p id="5d83" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我的<a class="ae lq" href="http://www.tennis-data.co.uk/alldata.php" rel="noopener ugc nofollow" target="_blank">数据</a>由 2010 年到 2018 年的所有温网比赛组成。为了使事情更简单，可读性更强，我总是把排名较高的玩家作为 0 号玩家，排名较低的玩家作为 1 号玩家。因此，结果 0 表示玩家 0 赢了(不是一次翻盘)，结果 1 表示玩家 1 赢了(一次翻盘)。</p><p id="5281" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">接下来，我将我的数据分为训练和测试(dev)数据，以便根据训练数据优化神经网络，并在样本测试数据上验证它。下面的代码构建了神经网络。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ns nt l"/></div></figure><p id="272a" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">下面是神经网络的一些细节。</p><blockquote class="nu nv nw"><p id="3c24" class="ku kv nx kw b kx ky ju kz la lb jx lc ny le lf lg nz li lj lk oa lm ln lo lp im bi translated"><code class="fe ob oc od oe b">- Number of Layers: 3. (2 Hidden Layers)<br/>- Number of Neuros in each layer: 64-&gt;32-&gt;1<br/>- Activation relu-&gt;relu-&gt;sigmoid<br/>- Stop if validation loss does not improve for 500 epochs<br/>- Save the best model which gives the minimum validation set loss</code></p></blockquote><p id="c60d" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这里需要注意的一件重要事情是，经过下图所示的几轮时期后，神经网络开始过度拟合训练样本。即，它在训练样本上获得了准确性，同时对于测试样本失去了准确性。因此，为了做出好的预测，避免使用过度拟合的神经网络是很重要的。因此，我使用给出最小验证集损失的模型。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi of"><img src="../Images/78df993f646e5faf7831f9b7ffc4c018.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Dba4YczZjghawW4PBHT7xQ.jpeg"/></div></div><figcaption class="no np gj gh gi nq nr bd b be z dk">Loss and accuracy level after each Epoch</figcaption></figure><p id="dfef" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在测试和训练集上，最好的模型具有下面的准确度水平，作为预测网球比赛的基准，这似乎是相当合理的。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi og"><img src="../Images/b68e8403d19930797d8f890906c058a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sU06ne6Ea8YhCPyyEFFWLA.png"/></div></div></figure></div><div class="ab cl lr ls hx lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="im in io ip iq"><h1 id="6a82" class="ly lz it bd ma mb mc md me mf mg mh mi jz mj ka mk kc ml kd mm kf mn kg mo mp bi translated">第三步:预测结果。</h1><p id="f315" class="pw-post-body-paragraph ku kv it kw b kx ms ju kz la mt jx lc ld ng lf lg lh nh lj lk ll ni ln lo lp im bi translated">一旦我有了一个训练好的神经网络并保存了最佳模型。我可以使用最佳模型来预测即将到来的比赛。以下是从第 16 轮开始以表格和括号格式对预定和潜在比赛的预测片段。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oh"><img src="../Images/38800b67c6193d00fb6edf63e767b293.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HP84uHoIObEb7OTSqk2Vvg.jpeg"/></div></div><figcaption class="no np gj gh gi nq nr bd b be z dk">Final prediction table and bracket.</figcaption></figure></div><div class="ab cl lr ls hx lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="im in io ip iq"><h1 id="cc27" class="ly lz it bd ma mb mc md me mf mg mh mi jz mj ka mk kc ml kd mm kf mn kg mo mp bi translated"><strong class="ak">总决赛感想:</strong></h1><p id="a9e6" class="pw-post-body-paragraph ku kv it kw b kx ms ju kz la mt jx lc ld ng lf lg lh nh lj lk ll ni ln lo lp im bi translated">神经网络预测<strong class="kw iu">诺瓦克·德约科维奇</strong>将在决赛中击败<strong class="kw iu">罗杰·费德勒</strong>成为最终的冠军。根据模式，最接近的比赛将是费德勒和纳达尔在半决赛中的对决。考虑到这一点，根据模型，如果德约科维奇在决赛中对阵费德勒，他有 70%的胜算，而如果他在决赛中对阵纳达尔，他有 59%的胜算。</p><p id="661b" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我会在所有比赛结束后更新这篇文章，看看这个模型的表现如何。然而，这篇文章的重点是<strong class="kw iu">而不是</strong>建立一个给出最准确预测的神经网络，而是这篇文章的重点是探索神经网络和其他机器学习技术可以帮助使用数据回答简单问题的方法。这篇文章的问题是“今年谁会赢得温布尔登网球赛？”</p><p id="50ae" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">本文使用的代码和数据可以在下面的 github 资源库中找到。包含模型和结果的最终笔记本可通过<a class="ae lq" href="https://nbviewer.jupyter.org/github/jugalm/predicting-wimbledon-matches/blob/master/nn_model.ipynb" rel="noopener ugc nofollow" target="_blank"> <strong class="kw iu">链接</strong> </a>查看。如果你有任何建议，请随时联系我。(github.com/jugalm)</p><div class="oi oj gp gr ok ol"><a href="https://github.com/jugalm/predicting-wimbledon-matches" rel="noopener  ugc nofollow" target="_blank"><div class="om ab fo"><div class="on ab oo cl cj op"><h2 class="bd iu gy z fp oq fr fs or fu fw is bi translated">朱加尔姆/预测-温布尔登-比赛</h2><div class="os l"><h3 class="bd b gy z fp oq fr fs or fu fw dk translated">预测温布尔登比赛:。通过在…上创建一个帐户，为 jugalm/predicting-Wimbledon-matches 的发展做出贡献</h3></div><div class="ot l"><p class="bd b dl z fp oq fr fs or fu fw dk translated">github.com</p></div></div><div class="ou l"><div class="ov l ow ox oy ou oz ks ol"/></div></div></a></div><h1 id="0a88" class="ly lz it bd ma mb pa md me mf pb mh mi jz pc ka mk kc pd kd mm kf pe kg mo mp bi translated"><strong class="ak">参考文献:</strong></h1><ul class=""><li id="811f" class="mq mr it kw b kx ms la mt ld mu lh mv ll mw lp mx my mz na bi translated">数据:<a class="ae lq" href="http://www.tennis-data.co.uk/alldata.php" rel="noopener ugc nofollow" target="_blank">http://www.tennis-data.co.uk/alldata.php</a></li><li id="1bc5" class="mq mr it kw b kx nb la nc ld nd lh ne ll nf lp mx my mz na bi translated">康曼、安德烈、格兰特·斯佩尔曼和丹尼尔·赖特。"用于职业网球比赛预测和投注的机器学习."</li></ul></div></div>    
</body>
</html>