<html>
<head>
<title>Implementing YOLO on a custom dataset</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在自定义数据集上实现 YOLO</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/implementing-yolo-on-a-custom-dataset-20101473ce53?source=collection_archive---------4-----------------------#2019-11-23">https://towardsdatascience.com/implementing-yolo-on-a-custom-dataset-20101473ce53?source=collection_archive---------4-----------------------#2019-11-23</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="f253" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu"> <em class="ko">在本文中，我们将逐步了解在自定义数据集上使用 keras 实施 YOLO v2，以及一些常见问题及其解决方案</em> </strong></p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi kp"><img src="../Images/348c2ada46cb080db56e71d792c847ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aDCMw6f3MvyyoDhHejohwQ.png"/></div></div></figure><h1 id="c08c" class="lb lc it bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">了解 YOLO——你只需看一眼</h1><p id="cc14" class="pw-post-body-paragraph jq jr it js b jt lz jv jw jx ma jz ka kb mb kd ke kf mc kh ki kj md kl km kn im bi translated"><a class="ae me" href="https://medium.com/@arshren/computer-vision-a-journey-from-cnn-to-mask-r-cnn-and-yolo-1d141eba6e04" rel="noopener">从 CNN 到面具 R-CNN 和 Yolo </a>第 1 部分</p><p id="9baf" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><a class="ae me" href="https://medium.com/@arshren/computer-vision-a-journey-from-cnn-to-mask-r-cnn-and-yolo-part-2-b0b9e67762b1" rel="noopener">从 CNN 到 Mask R-CNN 和 Yolo Part 2 </a></p><p id="89f4" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><a class="ae me" href="https://medium.com/@arshren/object-detection-using-yolov3-using-keras-80bf35e61ce1" rel="noopener">使用 Yo </a> lov3 进行物体检测</p><p id="0b4b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><a class="ae me" href="https://pjreddie.com/darknet/yolov2/" rel="noopener ugc nofollow" target="_blank">Yolo 上的原始文件</a></p><p id="00c5" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我将使用<a class="ae me" href="https://github.com/experiencor/kangaroo" rel="noopener ugc nofollow" target="_blank">袋鼠数据集</a>作为我的自定义数据集</p><h1 id="3dc7" class="lb lc it bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">必需的库</h1><ul class=""><li id="47db" class="mf mg it js b jt lz jx ma kb mh kf mi kj mj kn mk ml mm mn bi translated">Python 3.5 或更高版本</li><li id="bbb7" class="mf mg it js b jt mo jx mp kb mq kf mr kj ms kn mk ml mm mn bi translated">Tensorflow:我用过 CPU 版本</li><li id="0dd7" class="mf mg it js b jt mo jx mp kb mq kf mr kj ms kn mk ml mm mn bi translated">OpenCV</li><li id="2797" class="mf mg it js b jt mo jx mp kb mq kf mr kj ms kn mk ml mm mn bi translated">VC++ build 14</li></ul><h1 id="a34e" class="lb lc it bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">下载使用 keras 实现的 Yolo 代码</h1><p id="f1af" class="pw-post-body-paragraph jq jr it js b jt lz jv jw jx ma jz ka kb mb kd ke kf mc kh ki kj md kl km kn im bi translated">我们将使用暗流回购，可以从这里下载:<a class="ae me" href="https://github.com/thtrieu/darkflow" rel="noopener ugc nofollow" target="_blank"><strong class="js iu">https://github.com/thtrieu/darkflow</strong></a></p><h1 id="d2d3" class="lb lc it bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated"><strong class="ak">降低预训练的重量</strong></h1><p id="754b" class="pw-post-body-paragraph jq jr it js b jt lz jv jw jx ma jz ka kb mb kd ke kf mc kh ki kj md kl km kn im bi translated">重量可以从<a class="ae me" href="https://pjreddie.com/darknet/yolov2/" rel="noopener ugc nofollow" target="_blank">https://pjreddie.com/darknet/yolov2/</a>下载</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi mt"><img src="../Images/97f635c2df46558a6d71b6a5edc72970.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LYfDxndjST035Vtu-uNBOw.png"/></div></div><figcaption class="mu mv gj gh gi mw mx bd b be z dk"><a class="ae me" href="https://pjreddie.com/darknet/yolov2/" rel="noopener ugc nofollow" target="_blank">https://pjreddie.com/darknet/yolov2/</a></figcaption></figure><p id="bcbf" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我创建了一个名为 bin 的新文件夹，并将下载的权重放在那里，如下所示</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div class="gh gi my"><img src="../Images/f89a8cb1fa8716dbf9a93112c7beb709.png" data-original-src="https://miro.medium.com/v2/resize:fit:1312/format:webp/1*Omq62O47hjKxcYht9giqeQ.png"/></div></figure><h2 id="02fd" class="mz lc it bd ld na nb dn lh nc nd dp ll kb ne nf lp kf ng nh lt kj ni nj lx nk bi translated"><strong class="ak">提示:配置(cfg)文件和权重应匹配</strong></h2><p id="7737" class="pw-post-body-paragraph jq jr it js b jt lz jv jw jx ma jz ka kb mb kd ke kf mc kh ki kj md kl km kn im bi translated">如果配置(cfg)文件和权重不匹配，我们会得到以下错误</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/b944371496856ba3f1eae102e0cdd084.png" data-original-src="https://miro.medium.com/v2/resize:fit:1036/format:webp/1*XMB_5nurnRBleKaN3x7EkA.png"/></div></figure><p id="a13d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">Darkflow 通过读取。当权重和配置文件之间的层不匹配时，从. weights 中读取相应的字节块。当权重解析器已经到达. weights 的结尾时，配置文件可能仍有要读取的层。这将生成 over read 断言错误。</p><h1 id="b5bc" class="lb lc it bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">构建代码</h1><p id="316a" class="pw-post-body-paragraph jq jr it js b jt lz jv jw jx ma jz ka kb mb kd ke kf mc kh ki kj md kl km kn im bi translated">构建代码有三种选择。</p><p id="1f5e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">选项 1: </strong></p><pre class="kq kr ks kt gt nm nn no np aw nq bi"><span id="37d4" class="mz lc it nn b gy nr ns l nt nu">python setup.py build_ext --inplace<br/></span></pre><p id="1fa2" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">选项 2: </strong> pip 在开发模式下全局安装暗流</p><pre class="kq kr ks kt gt nm nn no np aw nq bi"><span id="e169" class="mz lc it nn b gy nr ns l nt nu">pip install -e .</span></pre><p id="f369" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">选项 3:全球安装 pip</p><pre class="kq kr ks kt gt nm nn no np aw nq bi"><span id="48c3" class="mz lc it nn b gy nr ns l nt nu">pip install .</span></pre><p id="5e1a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">对我来说，选项 2 和 3 效果不错。</p><p id="2476" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们现在准备处理图像或视频文件。</p><h1 id="12c1" class="lb lc it bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">使用 Yolo 处理图像文件</h1><p id="a2fc" class="pw-post-body-paragraph jq jr it js b jt lz jv jw jx ma jz ka kb mb kd ke kf mc kh ki kj md kl km kn im bi translated">导入所需的库</p><pre class="kq kr ks kt gt nm nn no np aw nq bi"><span id="cf63" class="mz lc it nn b gy nr ns l nt nu">import cv2<br/>from darkflow.net.build import TFNet<br/>import matplotlib.pyplot as plt</span><span id="e055" class="mz lc it nn b gy nv ns l nt nu">%config InlineBackend.figure_format = 'svg'</span></pre><p id="ef21" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">要定义模型，我们可以使用以下选项</p><p id="9132" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu"> 1。型号</strong>:配置<strong class="js iu">文件</strong>(*。cfg)包含模型的细节</p><p id="1a5b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu"> 2。加载</strong> : <strong class="js iu">预训练重量</strong>文件</p><p id="da99" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu"> 3。批次</strong>:每批次要训练的数据数量</p><p id="82e7" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu"> 4。纪元</strong>:训练的迭代次数</p><p id="3fe8" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu"> 5。gpu </strong>:如果想充分利用 gpu 硬件，设置<strong class="js iu"> 1.0 </strong>。如果您需要使用 cpu，则排除此选项</p><p id="893b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu"> 6。训练</strong>:训练数据集时使用此选项</p><p id="8169" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu"> 7。注释</strong>:存储注释文件的目录</p><p id="f33e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu"> 8。数据集</strong>:存储图像文件的目录</p><pre class="kq kr ks kt gt nm nn no np aw nq bi"><span id="ecaf" class="mz lc it nn b gy nr ns l nt nu">options = {<br/> 'model': 'cfg/yolo.cfg',<br/> 'load': 'bin/yolov2.weights',<br/> 'threshold': 0.3<br/>}<br/>tfnet = TFNet(options)</span></pre><h2 id="cc32" class="mz lc it bd ld na nb dn lh nc nd dp ll kb ne nf lp kf ng nh lt kj ni nj lx nk bi translated">使用 Yolo 加载图像并识别图像中的对象</h2><pre class="kq kr ks kt gt nm nn no np aw nq bi"><span id="8a05" class="mz lc it nn b gy nr ns l nt nu"># read the color image and covert to RGB</span><span id="3a32" class="mz lc it nn b gy nv ns l nt nu">img = cv2.imread(‘sample_img\sample_dog.jpg’, cv2.IMREAD_COLOR)<br/>img = cv2.cvtColor(img, cv2.COLOR_BGR2RGB)</span><span id="62d6" class="mz lc it nn b gy nv ns l nt nu"># use YOLO to predict the image<br/><strong class="nn iu">result = tfnet.return_predict(img)<br/>result</strong></span></pre><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/e468540e6b8a97367f1cbffa66fa1d65.png" data-original-src="https://miro.medium.com/v2/resize:fit:938/format:webp/1*xUntIMR48xa3gxFkE454ew.png"/></div><figcaption class="mu mv gj gh gi mw mx bd b be z dk">predicting the class, confidence and bounding box in the image</figcaption></figure><h2 id="e6e3" class="mz lc it bd ld na nb dn lh nc nd dp ll kb ne nf lp kf ng nh lt kj ni nj lx nk bi translated">在图像上显示类和边界框</h2><pre class="kq kr ks kt gt nm nn no np aw nq bi"><span id="2697" class="mz lc it nn b gy nr ns l nt nu"># pull out some info from the results<br/>for i in range(0, len(result)):<br/>    <strong class="nn iu">tl = (result[i]['topleft']['x'], result[i]['topleft']['y'])<br/>    br = (result[i]['bottomright']['x'], result[i]['bottomright']['y'])<br/>    label = result[i]['label']</strong></span><span id="678c" class="mz lc it nn b gy nv ns l nt nu"># add the box and label and display it<br/>    <strong class="nn iu">img = cv2.rectangle(img, tl, br, (0, 255, 0), 7)<br/>    img = cv2.putText(img, label, tl, cv2.FONT_HERSHEY_COMPLEX, 1, (0, 0, 0), 2)<br/>    plt.imshow(img)</strong><br/><strong class="nn iu">plt.show()</strong></span></pre><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/9516f07b04b4eff70636fa5aa028b7e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1288/format:webp/1*NQOHMzUm2FAtYcHQTzeAOA.png"/></div></figure><h1 id="ef55" class="lb lc it bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">使用 Yolov2 对新数据集进行训练</h1><p id="a01b" class="pw-post-body-paragraph jq jr it js b jt lz jv jw jx ma jz ka kb mb kd ke kf mc kh ki kj md kl km kn im bi translated">我正在使用<a class="ae me" href="https://github.com/experiencor/kangaroo" rel="noopener ugc nofollow" target="_blank">袋鼠数据集</a>作为我的自定义数据集。</p><p id="e5f7" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">注释应该是 Pascal VOC(可视对象分类)兼容的。这种格式为对象类别识别提供了标准化的图像数据集。</p><p id="d99d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在暗流文件夹下创建一个文件夹，存储图像和注释。我创建了一个新文件夹 new_data，并在它下面创建了 images 和 annots 文件夹，如下所示</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi ny"><img src="../Images/dfea5f3f80b3846cdbd045e66b44e5d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*txxpneLD386kFMo_57uo3g.png"/></div></div></figure><h2 id="c01b" class="mz lc it bd ld na nb dn lh nc nd dp ll kb ne nf lp kf ng nh lt kj ni nj lx nk bi translated">用自定义类名更新 labels.txt</h2><p id="d46d" class="pw-post-body-paragraph jq jr it js b jt lz jv jw jx ma jz ka kb mb kd ke kf mc kh ki kj md kl km kn im bi translated">暗流使用标签选项从自定义标签文件加载对象类。当 lables 标志未设置时，默认情况下，darkflow 将从<code class="fe nz oa ob nn b">labels.txt</code>加载。</p><h2 id="71c9" class="mz lc it bd ld na nb dn lh nc nd dp ll kb ne nf lp kf ng nh lt kj ni nj lx nk bi translated">在中更新模型。cfg 文件</h2><p id="fd38" class="pw-post-body-paragraph jq jr it js b jt lz jv jw jx ma jz ka kb mb kd ke kf mc kh ki kj md kl km kn im bi translated">我们在。cfg 文件。我们需要更新 cfg 文件中最后一个卷积层的类和过滤器的数量。</p><p id="a830" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">过滤器数量= (5 +类别数量)*5</p><p id="a851" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在我们的例子中，因为我们只有一个袋鼠类，我们将有 5*(5+1)=30 个过滤器，如下所示</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi oc"><img src="../Images/48a28fc28155dd6ea87b305f266488c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2M6C6pqc-NYSi0UQLGCjMg.png"/></div></div><figcaption class="mu mv gj gh gi mw mx bd b be z dk">cgf file for the custom dataset</figcaption></figure><h2 id="def3" class="mz lc it bd ld na nb dn lh nc nd dp ll kb ne nf lp kf ng nh lt kj ni nj lx nk bi translated">技巧 2:将 labels.txt 中的类与。cfg 文件</h2><p id="5fa8" class="pw-post-body-paragraph jq jr it js b jt lz jv jw jx ma jz ka kb mb kd ke kf mc kh ki kj md kl km kn im bi translated">默认情况下，Darkflow 会尝试从 labels.txt 加载标签。与中的类相比，当模型在 labels.txt 中发现错误的标签数量时，会出现以下错误。cfg 文件</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi od"><img src="../Images/4f82b6586ab45972cc3a7b072f2b3082.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RwHWUixbLhUC9urDMNZW4A.png"/></div></div></figure><h2 id="540d" class="mz lc it bd ld na nb dn lh nc nd dp ll kb ne nf lp kf ng nh lt kj ni nj lx nk bi translated">定义模型选项</h2><pre class="kq kr ks kt gt nm nn no np aw nq bi"><span id="3286" class="mz lc it nn b gy nr ns l nt nu"><br/>options = {"model": "cfg/yolo.cfg", <br/>           "load": "bin/yolov2.weights",<br/>           "batch": 2,<br/>           "epoch": 5,<br/>           "train": True,<br/>           "annotation": "new_data/annots/",<br/>           "dataset": "new_data/images/"}</span></pre><h2 id="3969" class="mz lc it bd ld na nb dn lh nc nd dp ll kb ne nf lp kf ng nh lt kj ni nj lx nk bi translated">构建暗流的实例</h2><pre class="kq kr ks kt gt nm nn no np aw nq bi"><span id="b84d" class="mz lc it nn b gy nr ns l nt nu">from darkflow.net.build import TFNet<br/>tfnet = TFNet(options)</span></pre><h2 id="3676" class="mz lc it bd ld na nb dn lh nc nd dp ll kb ne nf lp kf ng nh lt kj ni nj lx nk bi translated">训练模型</h2><pre class="kq kr ks kt gt nm nn no np aw nq bi"><span id="3040" class="mz lc it nn b gy nr ns l nt nu">tfnet.train()</span></pre><h2 id="3760" class="mz lc it bd ld na nb dn lh nc nd dp ll kb ne nf lp kf ng nh lt kj ni nj lx nk bi translated"><strong class="ak">使用命令提示符训练模型</strong></h2><p id="5ce6" class="pw-post-body-paragraph jq jr it js b jt lz jv jw jx ma jz ka kb mb kd ke kf mc kh ki kj md kl km kn im bi translated">我们还可以使用命令行通过以下命令来训练自定义数据集</p><pre class="kq kr ks kt gt nm nn no np aw nq bi"><span id="ce7e" class="mz lc it nn b gy nr ns l nt nu"><strong class="nn iu">python flow --model cfg/yolo.cfg --load bin/yolov2.weights --train --annotation new_data\annots --dataset new_data\images --epoch 1</strong></span></pre><h2 id="dd17" class="mz lc it bd ld na nb dn lh nc nd dp ll kb ne nf lp kf ng nh lt kj ni nj lx nk bi translated">使用在新数据集上训练的权重来预测图像</h2><pre class="kq kr ks kt gt nm nn no np aw nq bi"><span id="0d5c" class="mz lc it nn b gy nr ns l nt nu">options = {<br/> 'model': 'cfg/yolo-1c.cfg',<br/> 'load': 50,<br/> 'threshold': 0.3,<br/> 'backup':'ckpt/'<br/> <br/>}<br/>tfnet2 = TFNet(options)</span></pre><h2 id="e68d" class="mz lc it bd ld na nb dn lh nc nd dp ll kb ne nf lp kf ng nh lt kj ni nj lx nk bi translated">加载检查点</h2><p id="49c8" class="pw-post-body-paragraph jq jr it js b jt lz jv jw jx ma jz ka kb mb kd ke kf mc kh ki kj md kl km kn im bi translated">这将从我们刚刚在 options 中指定的检查点加载预先训练的参数。</p><pre class="kq kr ks kt gt nm nn no np aw nq bi"><span id="e8e6" class="mz lc it nn b gy nr ns l nt nu">tfnet2.load_from_ckpt()</span></pre><h2 id="26ff" class="mz lc it bd ld na nb dn lh nc nd dp ll kb ne nf lp kf ng nh lt kj ni nj lx nk bi translated">根据自定义数据集对影像进行预测</h2><p id="44b0" class="pw-post-body-paragraph jq jr it js b jt lz jv jw jx ma jz ka kb mb kd ke kf mc kh ki kj md kl km kn im bi translated">我们将采用一幅未用于训练的图像来预测类别、包围盒和置信度</p><pre class="kq kr ks kt gt nm nn no np aw nq bi"><span id="8014" class="mz lc it nn b gy nr ns l nt nu">original_img = cv2.imread(“new_data/images/00001.jpg”)<br/>original_img = cv2.cvtColor(original_img, cv2.COLOR_BGR2RGB)<br/>results = tfnet2.return_predict(original_img)<br/>print(results)</span></pre><p id="f84d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我在实验中遇到的一个错误是</p><p id="5b57" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu"> <em class="ko">转换时有四个字节大小差异的断言错误。</em> </strong></p><p id="fe7a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">解决方案是更改 utils 文件夹 weights_walker 中的 loader.py 文件。__init__()方法</p><pre class="kq kr ks kt gt nm nn no np aw nq bi"><span id="824b" class="mz lc it nn b gy nr ns l nt nu"> change <strong class="nn iu">self.offset = 16 to self.offset = 20 </strong></span></pre><p id="f904" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">根据字节误差，您可能需要对偏移量进行调整。一个通用公式将是</p><h2 id="92cd" class="mz lc it bd ld na nb dn lh nc nd dp ll kb ne nf lp kf ng nh lt kj ni nj lx nk bi translated">self.offset = old_offset_value +(发现值-预期值)</h2><p id="ce45" class="pw-post-body-paragraph jq jr it js b jt lz jv jw jx ma jz ka kb mb kd ke kf mc kh ki kj md kl km kn im bi translated">文件中的 old_offset_value 是 16。错误将为您提供发现值和预期值的值</p><h1 id="00c6" class="lb lc it bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">参考资料:</h1><p id="41a4" class="pw-post-body-paragraph jq jr it js b jt lz jv jw jx ma jz ka kb mb kd ke kf mc kh ki kj md kl km kn im bi translated"><a class="ae me" href="https://pjreddie.com/darknet/yolov2/" rel="noopener ugc nofollow" target="_blank">https://pjreddie.com/darknet/yolov2/</a></p><div class="oe of gp gr og oh"><a href="https://github.com/thtrieu/darkflow" rel="noopener  ugc nofollow" target="_blank"><div class="oi ab fo"><div class="oj ab ok cl cj ol"><h2 class="bd iu gy z fp om fr fs on fu fw is bi translated">thtrieu/darkflow</h2><div class="oo l"><h3 class="bd b gy z fp om fr fs on fu fw dk translated">实时目标检测和分类。纸张:第一版，第二版。阅读更多关于 YOLO 的信息(在暗网上)和…</h3></div><div class="op l"><p class="bd b dl z fp om fr fs on fu fw dk translated">github.com</p></div></div><div class="oq l"><div class="or l os ot ou oq ov kz oh"/></div></div></a></div><div class="oe of gp gr og oh"><a href="https://github.com/markjay4k/YOLO-series" rel="noopener  ugc nofollow" target="_blank"><div class="oi ab fo"><div class="oj ab ok cl cj ol"><h2 class="bd iu gy z fp om fr fs on fu fw is bi translated">markjay4k/YOLO 系列</h2><div class="oo l"><h3 class="bd b gy z fp om fr fs on fu fw dk translated">此时您不能执行该操作。您已使用另一个标签页或窗口登录。您已在另一个选项卡中注销，或者…</h3></div><div class="op l"><p class="bd b dl z fp om fr fs on fu fw dk translated">github.com</p></div></div><div class="oq l"><div class="ow l os ot ou oq ov kz oh"/></div></div></a></div><p id="80f3" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><a class="ae me" href="https://github.com/deep-diver/Soccer-Ball-Detection-YOLOv2/blob/master/YOLOv2-Train.ipynb" rel="noopener ugc nofollow" target="_blank"> Github </a></p></div></div>    
</body>
</html>