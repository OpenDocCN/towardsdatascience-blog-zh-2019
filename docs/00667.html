<html>
<head>
<title>How to combine LaTeX and R for report generation</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何结合 LaTeX 和 R 生成报表</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-combine-latex-and-r-for-report-generation-82f23787fc43?source=collection_archive---------8-----------------------#2019-01-31">https://towardsdatascience.com/how-to-combine-latex-and-r-for-report-generation-82f23787fc43?source=collection_archive---------8-----------------------#2019-01-31</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="639d" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">如何获得最佳数据科学报告的简单教程！</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/211de75fbd0857ade83b008ce36ee9d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8eVWat6A02qS3bCDDqkw1Q.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">(<em class="ky">Image by author</em>)</figcaption></figure><p id="f3e9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您必须创建一个报告，LaTeX 绝对是您的选择，LaTeX 中的所有内容看起来都更好！</p><p id="5c13" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在你的学术生涯中，你可能用它来写论文或做一些分析。事实上，像 texstudio 或最近的 Overleaf 这样的环境非常适合单个项目。但现在在你的日常工作中，他们真的能扩大它的规模，让乳胶仍然有用吗？</p><p id="842d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你需要的是一个自动生成报告<strong class="lb iu"/>(也许，就在你的管道末端)的方法，它根据你的代码的发现动态地<strong class="lb iu">改变它的内容</strong>，它是<strong class="lb iu">视觉上令人愉快的</strong>(对你的老板来说)，并且它能够<em class="lv">快</em>到足以<strong class="lb iu">批量产生</strong>结果。</p><p id="1535" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果是这种情况，我最喜欢的解决方案是 R 包“<em class="lv">knitter</em>”，它允许我们直接从 R 代码创建 LaTeX 文档。结合了编程语言的灵活性和 LaTeX 美学。</p><p id="beeb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这篇文章中，我想给你一个基本的教程和一些如何成功做到这一点的技巧。<br/>我知道知道 R 和 LaTeX 的人不多，我会尽量保持简单，但这两种编码系统及其组合无法在一篇文章中解释，我希望，如果您点击了这篇文章并一直阅读到现在，您已经对这两者有了一些基本的了解。</p><p id="e794" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">事不宜迟，让我们用 r 创建一个 LaTeX 报表。</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><p id="b888" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">其中两个是创建 R/tex 报告所需的步骤，一个创建最终 pdf 的“starter”R 脚本，以及。Rnw 文件，我们所有的代码都将存储在这里。让我们看看他们:</p><h1 id="7ced" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">起始脚本</h1><p id="369d" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">“starter”脚本必须完成两个基本功能:</p><ol class=""><li id="897b" class="na nb it lb b lc ld lf lg li nc lm nd lq ne lu nf ng nh ni bi translated">加载并传递 Rnw 文件到<strong class="lb iu">编织器</strong>包的<strong class="lb iu">编织</strong>命令。这个过程叫做<em class="lv">编织</em>。这将执行 R 代码并生成一系列文件，其中有一个我们通常在 texstudio 中使用的. tex 文件。</li><li id="5b57" class="na nb it lb b lc nj lf nk li nl lm nm lq nn lu nf ng nh ni bi translated">执行两次。tex 文件，以便创建最终的 PDF 报告</li></ol><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="no np l"/></div></figure><p id="a729" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了使整个过程更容易，我建议创建一个名为 starter 的独立文件。r 使用上面的代码，并在需要时使用下面的命令运行它:</p><pre class="kj kk kl km gt nq nr ns nt aw nu bi"><span id="7b2a" class="nv me it nr b gy nw nx l ny nz">R CMD BATCH starter.R</span></pre><p id="1ce7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">或者，您可以在命令行或任何您可能需要的地方复制/粘贴这三行代码。</p><p id="7f3c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">别忘了在 r 中安装 knitr。</p><pre class="kj kk kl km gt nq nr ns nt aw nu bi"><span id="0b8e" class="nv me it nr b gy nw nx l ny nz">install.packages('knitr')</span></pre><h1 id="ae38" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">Rnw 文件</h1><p id="d702" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">的。Rnw(或 Sweave)文件本质上是一个. tex 文件，可以在其中插入 R 代码块。</p><p id="cb3b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">文件的结构遵循 LaTeX 作品的正常结构，从 document 类的声明开始，但是在代码中的任何地方，您都可以添加 R 个代码块。</p><p id="3d8b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这些是在两个元素之间定义的:a <strong class="lb iu"> &lt; &lt; … &gt; &gt; </strong>，在其中传递 R 代码块的设置，以及一个<strong class="lb iu"> @ </strong>，定义其结束。</p><p id="8e57" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们看一个例子:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="no np l"/></div></figure><p id="6830" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">到目前为止，这是一个常见的代码，你可以在任何。tex 文件并生成图 1 中的<strong class="lb iu">页面。它产生一个首页、目录和第一章:</strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oa"><img src="../Images/ae1a0839fa5d5804229888d35abf1e38.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oQbi1c9gL56UZxlsZoaTWw.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk"><strong class="bd ob">Fig 1: </strong>The first three pages of the final document (<em class="ky">Image by author</em>)</figcaption></figure><p id="f9f7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们继续，看看第一个 R 块，它用 R 创建了一个图，并在 LaTeX 中导入图形:</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h2 id="8e47" class="nv me it bd mf oc od dn mj oe of dp mn li og oh mp lm oi oj mr lq ok ol mt om bi translated">其余块:</h2><p id="4bdc" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">在小于号和大于号之间，我们可以传递执行 R 块的参数；要通过的最重要的要素是:</p><ul class=""><li id="05d8" class="na nb it lb b lc ld lf lg li nc lm nd lq ne lu on ng nh ni bi translated"><strong class="lb iu"> Name </strong>:这只是程序块的名字，每个程序块必须有一个唯一的名字。在调试阶段，识别名称将对您有很大帮助</li><li id="0798" class="na nb it lb b lc nj lf nk li nl lm nm lq nn lu on ng nh ni bi translated"><strong class="lb iu"> echo </strong>:该 TRUE 或 FALSE 值将指示代码是否会显示在最终的 pdf 文档中。</li><li id="16eb" class="na nb it lb b lc nj lf nk li nl lm nm lq nn lu on ng nh ni bi translated"><strong class="lb iu">结果</strong>可以取值‘asis’或‘hide ’,它将显示或隐藏程序块的结果(输出)</li></ul><p id="5f39" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">其他参数是布尔值“include ”,它决定该块是否必须运行,“warning”和“message”都决定调试消息是否必须在 pdf 最终版本中显示。</p><p id="850b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们看一个实际的例子，其中我们将加载 Iris 数据库并在 R 代码块中创建一个绘图:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="no np l"/></div></figure><p id="b89a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在上面的代码中，我们定义了一个名为 CreatePlot 的代码块，其中我们要求在 pdf 中显示下划线 R 代码，但是结果图是隐藏的，它将使用\includegraphics{}加载。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oo"><img src="../Images/1d474f6b0285d44c6d1e3c9f15a5ed74.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fxW4R56QwigbI0EEUsNPxw.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk"><strong class="bd ob">Fig 2</strong>: The resulting pages from the code above. (<em class="ky">Image by author</em>)</figcaption></figure><p id="6447" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在图 2 的<strong class="lb iu">中，我们可以看到上面代码的结果。<br/>标题、显示为 echo 请求的 R 代码块和用于加载图形的 latex 代码。</strong></p><p id="3a67" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我已经手动添加了图 2 中的图来显示 R 代码的结果，否则它将在不同的 pdf 页面中。</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><p id="f694" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们以<em class="lv">表格</em>为例来看另一种情况:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="no np l"/></div></figure><p id="7308" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">通过这段代码，我们使用 iris 数据库创建了一个表格，代码和表格立即显示出来，如下图<strong class="lb iu">图 3 </strong>所示。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi op"><img src="../Images/b3bf6f499202a7fbcf776a57c2e9119d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AideE2FC3a4PqSCwnSg10Q.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk"><strong class="bd ob">Fig 3:</strong> PDF page resulting from the code. (<em class="ky">Image by author</em>)</figcaption></figure><p id="ab17" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以看到，上面的块创建了一个表，其中包含 Iris 数据库(没有完全报告)和生成它的 R 代码。</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="aa14" class="md me it bd mf mg oq mi mj mk or mm mn jz os ka mp kc ot kd mr kf ou kg mt mu bi translated">提示和有用的链接</h1><p id="0f50" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">就我个人的经验来说。Rnw 文件是一个非常强大的工具，但是，我建议将 R 代码保持在最低限度，并且只使用块来导入在其他地方生成的图和 CSV/表。<br/>如果你更喜欢直接在 Rnw 中计算和生成内容，它很快就会变得混乱。</p><p id="b2fb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我希望这篇文章能为你使用 LaTeX 和 r 创建第一个报告提供具体的帮助。</p><p id="3be2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">完整的扩展代码存在于这个<a class="ae ov" href="https://github.com/MattiaCinelli/fromRtoLatex" rel="noopener ugc nofollow" target="_blank"> GitHub 库</a>中:</p><p id="628e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">上面的脚本会产生下面的<a class="ae ov" href="https://mattiacinelli.com/document/" rel="noopener ugc nofollow" target="_blank"> pdf </a>(点击链接内的图片)。</p><p id="8687" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">关于编织者的更多信息:来源<a class="ae ov" href="https://yihui.name/knitr/" rel="noopener ugc nofollow" target="_blank">一</a>和<a class="ae ov" href="https://cran.r-project.org/web/packages/knitr/knitr.pdf" rel="noopener ugc nofollow" target="_blank">二</a>。</p><p id="2bbf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="lv">我希望这篇文章对你有所帮助</em></p></div></div>    
</body>
</html>