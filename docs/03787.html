<html>
<head>
<title>Streaming From S3 Buckets To Snowflake DB for Data Engineers</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">面向数据工程师的从 S3 存储桶到雪花数据库的数据流</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/streaming-from-s3-buckets-to-snowflake-db-for-data-engineers-8e4827b81b16?source=collection_archive---------7-----------------------#2019-06-15">https://towardsdatascience.com/streaming-from-s3-buckets-to-snowflake-db-for-data-engineers-8e4827b81b16?source=collection_archive---------7-----------------------#2019-06-15</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="e88f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如何使用 Snowpipe REST API 调用将文件加载到表中的工作示例。这是一个关于如何连接雪花以及如何使用 Snowpipe 将文件摄取到雪花表中的小教程。因此，为了向我们亲爱的读者提供本教程，我们在雪花开设了一个免费试用账户。本课包含三个步骤，第一步是将数据从您的计算机加载到内部阶段，第二步是将数据从 S3 存储桶手动加载到外部阶段，最后一步是使用 AWS Lambda 函数将数据加载到外部阶段。</p><p id="77f8" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们为什么要这么做？为什么我们不把它从 S3 桶自动加载到雪花表呢？</p><p id="faa8" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这个过程背后的原因是为了更好地理解 S3 桶和雪花表如何和谐地一起工作。所以你可以用更少的工作，最少的努力享受更多的满足感。但是在我们开始玩雪花和 S3 之前，让我们检查一下需求。</p><h1 id="0085" class="ko kp it bd kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll bi translated">要求</h1><ol class=""><li id="8d9a" class="lm ln it js b jt lo jx lp kb lq kf lr kj ls kn lt lu lv lw bi translated">通过 AWS 帐户访问 S3 时段。</li><li id="dcb5" class="lm ln it js b jt lx jx ly kb lz kf ma kj mb kn lt lu lv lw bi translated">通过雪花帐户访问雪花控制台。</li><li id="0539" class="lm ln it js b jt lx jx ly kb lz kf ma kj mb kn lt lu lv lw bi translated">通过 AWS 帐户访问 EC2 实例。</li></ol><h1 id="0aa9" class="ko kp it bd kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll bi translated">第一步:从内部阶段加载数据</h1><p id="4872" class="pw-post-body-paragraph jq jr it js b jt lo jv jw jx lp jz ka kb mc kd ke kf md kh ki kj me kl km kn im bi translated">在本文档的这一部分中，您将在 Snowflake 中准备好创建表、阶段和管道的环境，通过遵循以下语句，您将能够实现这一点:</p><ul class=""><li id="f5aa" class="lm ln it js b jt ju jx jy kb mf kf mg kj mh kn mi lu lv lw bi translated">在文件~/中定义与您的用户、帐户和密码的连接。snowsql/config，连接的名称是 zaid_connection</li><li id="505d" class="lm ln it js b jt lx jx ly kb lz kf ma kj mb kn mi lu lv lw bi translated">在您终端和雪花工作表中运行这些命令</li></ul><pre class="mj mk ml mm gt mn mo mp mq aw mr bi"><span id="4647" class="ms kp it mo b gy mt mu l mv mw">snowsql -c zaid_connection -o log_level=DEBUG</span><span id="3ecb" class="ms kp it mo b gy mx mu l mv mw">alter user almalikz set RSA_PUBLIC_KEY="your_public_key"</span><span id="51b6" class="ms kp it mo b gy mx mu l mv mw">desc user almalikz</span><span id="6e22" class="ms kp it mo b gy mx mu l mv mw">create user zaid_user password='your_password';</span><span id="a87c" class="ms kp it mo b gy mx mu l mv mw">alter user zaid_user set rsa_public_key='your_public_key';</span><span id="8b54" class="ms kp it mo b gy mx mu l mv mw">use role securityadmin; create or replace role snowpipe_s3; grant usage on warehouse compute_wh to role snowpipe_s3; grant usage on database demo_db to role snowpipe_s3; grant usage on schema demo_db.public to role snowpipe_s3; grant insert, select on demo_db.public.TABLE_S3 to role snowpipe_s3; grant read on stage demo_db.public.STAGE_S3 to role snowpipe_s3; grant ownership on pipe demo_db.public.PIPE_S3 to role snowpipe_s3; grant role snowpipe_s3 to user zaid_user; alter user zaid_user set default_role = snowpipe_s3;</span><span id="31d3" class="ms kp it mo b gy mx mu l mv mw">create or replace table TABLE_S3(c1 number, c2 string); <br/>create or replace stage STAGE_S3; <br/>put <!-- -->file:///data/test_file.csv<!-- --> @STAGE_S3; <br/>create or replace pipe demo_db.public.PIPE_S3 as copy into TABLE_S3 from @STAGE_S3;</span></pre><p id="7de3" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">所以我们创建了这个程序<em class="my">simple _ ingest _ snow flake . py</em>来访问雪花，使用用户、帐户、主机、端口、管道名、pem 格式的私钥，在下面的文件中检查这些参数:</p><figure class="mj mk ml mm gt na gh gi paragraph-image"><div class="gh gi mz"><img src="../Images/31960adf4de822b06177a01810851358.png" data-original-src="https://miro.medium.com/v2/resize:fit:1258/format:webp/0*Tyb5W1xqk_XjQXoE.png"/></div></figure><pre class="mj mk ml mm gt mn mo mp mq aw mr bi"><span id="40b8" class="ms kp it mo b gy mt mu l mv mw">ingest_manager = SimpleIngestManager(account='by16910',<br/> user='almalikz',<br/> private_key=private_key_pem, <br/> pipe=pipe_name,<br/> scheme='https',<br/> host='by16910.eu-west-1.snowflakecomputing.com',<br/> port=443)</span></pre><p id="3eaf" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在上面提到的 python 程序中，我们使用这些参数来构建 JWT。让我们从一个抽象的定义开始。</p><blockquote class="nd"><p id="3f55" class="ne nf it bd ng nh ni nj nk nl nm kn dk translated">JSON Web 令牌(JWT)是一个<a class="ae nn" href="https://json.org/" rel="noopener ugc nofollow" target="_blank"> JSON 对象</a>，它在<a class="ae nn" href="https://tools.ietf.org/html/rfc7519" rel="noopener ugc nofollow" target="_blank"><em class="no">RFC 7519</em></a><em class="no"/>中被定义为一种安全的方式来表示双方之间的一组信息。令牌由报头、有效载荷和签名组成。</p><p id="455a" class="ne nf it bd ng nh ni nj nk nl nm kn dk translated"><em class="no">米奇·斯泰基-埃凡蒂斯</em></p></blockquote><p id="75c8" class="pw-post-body-paragraph jq jr it js b jt np jv jw jx nq jz ka kb nr kd ke kf ns kh ki kj nt kl km kn im bi translated">在 Snowflake 中，jwt 的生成是预先构建到 Snowflake API 提供的 python 库中的(并且记录在 Snowflake 文档中)，所以理想情况下，我们只需编写一个简单的脚本，使用这些库来为我们自动处理 jwt。通过包装器的 python 代码<a class="ae nn" href="https://github.com/snowflakedb/snowflake-ingest-python" rel="noopener ugc nofollow" target="_blank"> <em class="my">简单-摄取-雪花</em> </a></p><p id="d098" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在我们运行程序几秒钟后，我们成功地将文件从内部暂存区摄取到雪花的表区，您可以检查接下来的日志，一切都很顺利。</p><pre class="mj mk ml mm gt mn mo mp mq aw mr bi"><span id="a281" class="ms kp it mo b gy mt mu l mv mw">DEBUG:botocore.vendored.requests.packages.urllib3.connectionpool:"POST/v1/data/pipes/demo_db.public.PIPE_S3/insertFiles?requestId=b9f27491-6434-4c5f-93b6-c6831afae12d HTTP/1.1" 200 88 DEBUG:snowflake.ingest.simple_ingest_manager:Ingest response: {'requestId': 'b9f27491-6434-4c5f-93b6-c6831afae12d', 'responseCode': 'SUCCESS'}</span></pre><p id="b968" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果您检查上面的日志，您可以看到，首先是 POST 操作，其次是响应代码成功，这是积极的反馈。</p><pre class="mj mk ml mm gt mn mo mp mq aw mr bi"><span id="c069" class="ms kp it mo b gy mt mu l mv mw">'pipe': 'DEMO_DB.PUBLIC.PIPE_S3', 'completeResult': True, 'nextBeginMark': '1_0', 'files': [ {'path': test_file.csv.gz', 'stageLocation': 'stages/b3767d50-e0f8-4bb2-a52a-6677122c8223/', 'fileSize': 64, 'timeReceived': '2019-05-14T13:48:30.725Z', 'lastInsertTime': '2019-05-14T13:49:00.579Z', 'rowsInserted': 4, 'rowsParsed': 4, 'errorsSeen': 0, 'errorLimit': 1, 'complete': True, 'status': 'LOADED'}</span></pre><p id="f1f9" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">然而，第二个日志是一个 GET 操作，由我们代码中的表达式调用，用于检查文件大小、接收时间、看到的错误、是否完成以及状态类型(在我们的例子中是 loaded)。</p><h1 id="48bd" class="ko kp it bd kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll bi translated">第二步:从 S3 外部阶段加载数据</h1><p id="0e18" class="pw-post-body-paragraph jq jr it js b jt lo jv jw jx lp jz ka kb mc kd ke kf md kh ki kj me kl km kn im bi translated">在本节中，我们将讨论如何使用雪花和通知事件的自动摄取新功能来摄取数据，我们成功地将数据从 S3 存储桶传输到雪花表，但我们是手动完成的，为什么要手动呢？因为我们的免费帐户没有自动摄取激活选项，这就是为什么我们没有通知和自动摄取。我们通过执行以下任务来完成这一步:</p><h2 id="7b8c" class="ms kp it bd kq nu nv dn ku nw nx dp ky kb ny nz lc kf oa ob lg kj oc od lk oe bi translated">第一项任务:设置你的 AWS 账户。</h2><p id="37d0" class="pw-post-body-paragraph jq jr it js b jt lo jv jw jx lp jz ka kb mc kd ke kf md kh ki kj me kl km kn im bi translated">对于此任务，您必须遵循 AWS 安全的良好实践，并考虑以下规则:</p><ol class=""><li id="4d05" class="lm ln it js b jt ju jx jy kb mf kf mg kj mh kn lt lu lv lw bi translated">删除 root 密码。</li><li id="60cf" class="lm ln it js b jt lx jx ly kb lz kf ma kj mb kn lt lu lv lw bi translated">创建一个 IAM 用户。</li><li id="08e9" class="lm ln it js b jt lx jx ly kb lz kf ma kj mb kn lt lu lv lw bi translated">创建一个新组。</li><li id="7994" class="lm ln it js b jt lx jx ly kb lz kf ma kj mb kn lt lu lv lw bi translated">定义新的 IAM 密码策略。</li></ol><h2 id="40a9" class="ms kp it bd kq nu nv dn ku nw nx dp ky kb ny nz lc kf oa ob lg kj oc od lk oe bi translated">第二项任务:更改仓库以支持自动恢复模式</h2><p id="3abc" class="pw-post-body-paragraph jq jr it js b jt lo jv jw jx lp jz ka kb mc kd ke kf md kh ki kj me kl km kn im bi translated">我们有两种类型的用户，一种是管理员用户<em class="my"> almalikz </em>，另一种是普通用户<em class="my"> zaid_user </em>，因此该任务只能使用管理员用户激活:</p><pre class="mj mk ml mm gt mn mo mp mq aw mr bi"><span id="6e04" class="ms kp it mo b gy mt mu l mv mw"><em class="my">alter warehouse compute_wh resume;</em></span></pre><h2 id="3132" class="ms kp it bd kq nu nv dn ku nw nx dp ky kb ny nz lc kf oa ob lg kj oc od lk oe bi translated">第三个任务:将数据加载到雪花表中</h2><p id="bd88" class="pw-post-body-paragraph jq jr it js b jt lo jv jw jx lp jz ka kb mc kd ke kf md kh ki kj me kl km kn im bi translated">在此任务中，我们使用普通用户帐户 zaid_user，而不是管理员用户。</p><pre class="mj mk ml mm gt mn mo mp mq aw mr bi"><span id="9b13" class="ms kp it mo b gy mt mu l mv mw"><em class="my">create or replace stage s3_stage</em><br/> <em class="my">url= 's3://outputzaid/'</em><br/> <em class="my">credentials = (AWS_KEY_ID = 'your_key' AWS_SECRET_KEY='your_secret');<br/>create or replace table s3_table(c1 number, c2 string);<br/>copy into s3_table</em><br/> <em class="my">from s3://outputzaid/test_file_trusted.csv credentials=(AWS_KEY_ID = 'your_key' AWS_SECRET_KEY='your_secret')</em><br/> <em class="my">file_format = (type = csv field_delimiter = ',' );</em></span></pre><h1 id="4d14" class="ko kp it bd kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll bi translated">第三步:使用 Lambda 函数从 S3 阶段加载数据</h1><p id="dad5" class="pw-post-body-paragraph jq jr it js b jt lo jv jw jx lp jz ka kb mc kd ke kf md kh ki kj me kl km kn im bi translated">在这一节中，我们将引导您完成使用 AWS Lambda 函数自动化 Snowpipe 的过程。</p><p id="8005" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">AWS Lambda 是一个事件驱动的无服务器计算平台，由 Amazon 作为 Amazon Web Service 的一部分提供。它在被事件触发时运行，并执行已经加载到系统中的代码。您可以修改本主题中提供的示例 python 代码，并创建一个 Lambda 函数，该函数调用 Snowpipe REST API 从外部阶段 S3 加载数据。该功能部署到您的 AWS 帐户中，在那里托管它。您在 Lambda 中定义的事件(例如，当您的 S3 存储桶中的文件被更新时)调用 Lambda 函数并运行 python 代码。</p><p id="ed6c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">本节描述了配置 Lambda 函数以使用 Snowpipe 连续地以微批处理方式自动加载数据的必要步骤。因此，让我们开始遵循以下步骤:</p><h2 id="985c" class="ms kp it bd kq nu nv dn ku nw nx dp ky kb ny nz lc kf oa ob lg kj oc od lk oe bi translated">第一项任务:访问 AWS 实例</h2><ol class=""><li id="ad58" class="lm ln it js b jt lo jx lp kb lq kf lr kj ls kn lt lu lv lw bi translated">访问您的 EC2 微实例，并检查关于 your-ssh-key-name 的信息。</li><li id="cc41" class="lm ln it js b jt lx jx ly kb lz kf ma kj mb kn lt lu lv lw bi translated">使用 AWS 控制台的 web 向导创建并运行 EC2 的实例。</li><li id="2262" class="lm ln it js b jt lx jx ly kb lz kf ma kj mb kn lt lu lv lw bi translated">下载 ssh-key。</li><li id="8b75" class="lm ln it js b jt lx jx ly kb lz kf ma kj mb kn lt lu lv lw bi translated">使用 ssh 命令选项连接实例。</li></ol><pre class="mj mk ml mm gt mn mo mp mq aw mr bi"><span id="1209" class="ms kp it mo b gy mt mu l mv mw"><em class="my">ssh -i "zaid_key.pem" ubuntu@ec2-3-91-26-48.compute-1.amazonaws.com</em></span></pre><h2 id="8afa" class="ms kp it bd kq nu nv dn ku nw nx dp ky kb ny nz lc kf oa ob lg kj oc od lk oe bi translated">第二个任务:创建 Lambda 执行环境</h2><p id="a66a" class="pw-post-body-paragraph jq jr it js b jt lo jv jw jx lp jz ka kb mc kd ke kf md kh ki kj me kl km kn im bi translated">为了完成本指南，您需要首先创建一个包含您的代码及其依赖项的部署包。一种简单的方法是获取一个<a class="ae nn" href="https://aws.amazon.com/ec2/instance-types/t2/" rel="noopener ugc nofollow" target="_blank"> t2.micro </a>实例，并建立一个模拟 python Lambda 运行环境的执行环境。这是您必须在 EC2 微实例中执行的步骤，遵循以下命令:</p><pre class="mj mk ml mm gt mn mo mp mq aw mr bi"><span id="a568" class="ms kp it mo b gy mt mu l mv mw"><em class="my">sudo apt-get install gcc make zip awscli libffi-dev openssl libssl-dev zlib1g-dev<br/>wget </em><a class="ae nn" href="https://www.python.org/ftp/python/3.6.1/Python-3.6.1.tgz" rel="noopener ugc nofollow" target="_blank"><em class="my">https://www.python.org/ftp/python/3.6.1/Python-3.6.1.tgz</em></a><em class="my"><br/>tar -xzvf Python-3.6.1.tgz<br/>cd Python-3.6.1 &amp;&amp; ./configure &amp;&amp; make<br/>sudo make install<br/>sudo pip3 install --upgrade pip <br/>/usr/local/bin/virtualenv ~/zaid_venv</em> <br/>s<em class="my">ource zaid_venv/bin/activate<br/>pip install Pillow<br/>pip install boto3<br/>pip install requests<br/>pip install snowflake-ingest</em></span></pre><h2 id="8653" class="ms kp it bd kq nu nv dn ku nw nx dp ky kb ny nz lc kf oa ob lg kj oc od lk oe bi translated">第三个任务:创建 Python 部署包</h2><ol class=""><li id="7f7e" class="lm ln it js b jt lo jx lp kb lq kf lr kj ls kn lt lu lv lw bi translated"><strong class="js iu">编辑 lambda 处理函数<br/> </strong>为一个基本的 Lambda 处理函数创建文件<a class="ae nn" href="https://github.com/snowflakedb/examples/blob/master/lambda_function/lambda_function.py" rel="noopener ugc nofollow" target="_blank"><em class="my">【Lambda _ Function . py</em></a>，该函数使用 python 的雪花连接器。调整连接变量、表名和 S3 存储桶，以匹配您的环境。</li><li id="501c" class="lm ln it js b jt lx jx ly kb lz kf ma kj mb kn lt lu lv lw bi translated"><strong class="js iu">创建并打包 python 虚拟环境<br/> </strong>脚本<a class="ae nn" href="https://github.com/snowflakedb/examples/blob/master/lambda_function/package-lambda-function.sh" rel="noopener ugc nofollow" target="_blank"><em class="my">Package _ lambda _ function . sh</em></a>包含为您的 Lambda 函数创建并打包 Python 环境的命令。这里要小心，因为如果你改变包含 Lambda 处理程序的文件名，你也必须修改这个脚本。</li><li id="3ceb" class="lm ln it js b jt lx jx ly kb lz kf ma kj mb kn lt lu lv lw bi translated"><strong class="js iu">使用<br/> </strong>将代码复制到 AWS EC2 实例运行<a class="ae nn" href="https://github.com/snowflakedb/examples/blob/master/lambda_function/package-lambda-function.sh" rel="noopener ugc nofollow" target="_blank"><em class="my">package _ Lambda _ function . sh</em></a>后，将生成文件<em class="my"> lambda_function.zip </em>包含您的 python Lambda 处理程序代码/文件以及在 AWS Lambda 环境中运行所需的 python 依赖项。</li><li id="0de2" class="lm ln it js b jt lx jx ly kb lz kf ma kj mb kn lt lu lv lw bi translated"><strong class="js iu">在雪花中创建阶段、表格和管道</strong></li></ol><pre class="mj mk ml mm gt mn mo mp mq aw mr bi"><span id="89db" class="ms kp it mo b gy mt mu l mv mw"><em class="my">create or replace stage s3_stage url= 's3://outputzaid/' credentials = (AWS_KEY_ID = 'your_key' AWS_SECRET_KEY='your_secret');create or replace table s3_table(c1 number, c2 string);create or replace pipe s3_pipe as copy into s3_table from @s3_stage file_format = (type = 'CSV');create or replace pipe s3_pipe as copy into s3_table from @s3_stage file_format = (type = 'CSV');</em></span></pre><h2 id="dfea" class="ms kp it bd kq nu nv dn ku nw nx dp ky kb ny nz lc kf oa ob lg kj oc od lk oe bi translated">第四项任务:创建和配置 AWS Lambda 权限</h2><ol class=""><li id="1cba" class="lm ln it js b jt lo jx lp kb lq kf lr kj ls kn lt lu lv lw bi translated">运行<em class="my"> aws configure </em>并编写您的凭证和您的默认区域</li><li id="973b" class="lm ln it js b jt lx jx ly kb lz kf ma kj mb kn lt lu lv lw bi translated">为了执行 Lambda，您需要使用 aws 命令为角色和策略创建和设置适当的权限，然后上传包含我们的 python 环境的 zip 存档。这些命令可以在文件<a class="ae nn" href="https://github.com/snowflakedb/examples/blob/master/lambda_function/aws-lambda-setup.sh" rel="noopener ugc nofollow" target="_blank"><em class="my">AWS _ lambda _ setup . sh</em></a>中找到</li></ol><h2 id="6703" class="ms kp it bd kq nu nv dn ku nw nx dp ky kb ny nz lc kf oa ob lg kj oc od lk oe bi translated">第五项任务:使用测试文件测试 Lambda 函数</h2><p id="4799" class="pw-post-body-paragraph jq jr it js b jt lo jv jw jx lp jz ka kb mc kd ke kf md kh ki kj me kl km kn im bi translated">此时，您可以测试启动 Lambda，并在 AWS Web 控制台 UI 中查看输出。导航至λ&gt;函数&gt;λ_ 函数。</p><figure class="mj mk ml mm gt na gh gi paragraph-image"><div role="button" tabindex="0" class="og oh di oi bf oj"><div class="gh gi of"><img src="../Images/80e9167f816d727e76686a7ed35fa844.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*aXhqRhLK7gFupoaY.png"/></div></div></figure><p id="829d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">您现在应该看到右上方的列表框，因此您需要在这里配置一个测试，您选择一个名称，并将以下语句放入测试框中</p><pre class="mj mk ml mm gt mn mo mp mq aw mr bi"><span id="0e6c" class="ms kp it mo b gy mt mu l mv mw">{ "Records": [ { "eventVersion": "2.0", "eventSource": "aws:s3", "awsRegion": "us-east-1", "eventTime": "1970-01-01T00:00:00.000Z", "eventName": "ObjectCreated:Put", "userIdentity": { "principalId": "AIDAJDPLRKLG7UEXAMPLE" }, "s3": { "s3SchemaVersion": "1.0", "configurationId": "testConfigRule", "bucket": { "name": "outputzaid", "ownerIdentity": { "principalId": "A3NL1KOZZKExample" }, "arn": "arn:aws:s3:::sourcebucket" }, "object": { "key": "test_file_lambda.csv", "size": 1024, "eTag": "d41d8cd98f00b204e9800998ecf8427e", "versionId": "096fKKXTRTtl3on89fVO.nfljtsv6qko" } } } ] }</span></pre><h1 id="34cc" class="ko kp it bd kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll bi translated">结论</h1><p id="8130" class="pw-post-body-paragraph jq jr it js b jt lo jv jw jx lp jz ka kb mc kd ke kf md kh ki kj me kl km kn im bi translated">你完成了任务，我亲爱的朋友，干得好！<br/> <strong class="js iu">您已经创建了一个 Lambda 函数，将数据从 S3 桶传输到雪花表，这是您成为数据工程师的第一步！</strong> <br/>我已经创建了相当多的教程来告诉你如何做流数据。所有这些都是从最基本的开始。我们将在接下来的几周开始放更多的文章。因此，请与我们保持联系，并探索一种学习流式数据的简单方法。</p><p id="6a11" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">干杯，<br/> <strong class="js iu">扎伊德·阿利萨·阿尔马利基</strong></p></div><div class="ab cl ok ol hx om" role="separator"><span class="on bw bk oo op oq"/><span class="on bw bk oo op oq"/><span class="on bw bk oo op"/></div><div class="im in io ip iq"><p id="0df3" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">或者，你可以<a class="ae nn" href="https://medium.com/@dataakkadian/membership" rel="noopener">获得 5 美元/月的中等订阅。如果你使用这个链接，它会支持我。</a></p></div></div>    
</body>
</html>