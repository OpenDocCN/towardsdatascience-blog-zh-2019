<html>
<head>
<title>Confusion Matrix — What is it?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">困惑矩阵——它是什么？</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/confusion-matrix-what-is-it-e859e1bbecdc?source=collection_archive---------7-----------------------#2019-06-22">https://towardsdatascience.com/confusion-matrix-what-is-it-e859e1bbecdc?source=collection_archive---------7-----------------------#2019-06-22</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="ip iq gp gr ir is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/c1937e47b1cfe51cad05a497b9868b85.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*d78MfBLbQEvPDzT9"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Source: <a class="ae jd" href="https://unsplash.com/photos/Zq6HerrBPEs" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h2 id="02ad" class="je jf jg bd b dl jh ji jj jk jl jm dk jn translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsai.net/p/category/machine-learning" rel="noopener ugc nofollow" target="_blank">机器学习</a></h2><div class=""/><div class=""><h2 id="9623" class="pw-subtitle-paragraph km jp jg bd b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld dk translated">计算评估二元分类所需的矩阵</h2></div><p id="d2d7" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">你手头有一个二进制分类问题。让我们将目标变量中的两个类分别表示为“负”和“正”。您已经有了用于开发分类器的数据集，执行了探索性数据分析、特征工程，并得出了应该训练什么模型的结论。您已经将数据分为定型集和测试集，并使用定型集来定型您的模型。然后，将测试数据中的每个实例提供给训练好的模型，并获得两个类中的一个作为相应的输出。</p><p id="d028" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">现在，你如何知道你的模型是否表现良好？并非所有被模型分类为“负”的测试集行将实际上是“负”的。同样适用于‘积极’。换句话说，你如何评价自己？这就是混淆矩阵发挥作用的地方。</p><p id="8df1" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">混淆矩阵是具有以下结构的 2x2 矩阵:</p><figure class="mb mc md me gt is gh gi paragraph-image"><div class="gh gi ma"><img src="../Images/7a1c9136c488df6ba08dc7f05d45aa18.png" data-original-src="https://miro.medium.com/v2/resize:fit:1162/format:webp/1*b2Rrhg7FUuhB3HrEyK111w.png"/></div></figure><p id="e00b" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">元素<em class="mf">真阴性的数量</em>是被模型分类为‘阴性’但实际上是‘阴性’的行数。</p><p id="219e" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">元素<em class="mf">假阴性的数量</em>是被模型分类为‘阳性’但实际上是‘阴性’的行数。</p><p id="d63a" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">同样的道理，我们可以理解<em class="mf">真阳性数和</em> <em class="mf">假阳性数</em>是什么意思<em class="mf">。</em></p><p id="dbc6" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">列标签<strong class="lg jq">阴性(预测)</strong>表示第一列包含预测的“阴性”数&amp;列标签<strong class="lg jq">阳性(预测)</strong>表示第二列包含预测的“阳性”数。同样，行标签<strong class="lg jq">负数(实际)</strong> &amp; <strong class="lg jq">正数(实际)</strong>表示这两行包含实际“负数”和“正数”的数字。</p><p id="ef19" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">让我们看一个例子。假设测试集包含 100 行，其中 75 行为“负”，其余为“正”。假设经过训练的模型正确地将 50%的实际“负面”和 15%的实际“正面”分类。这意味着它错误地将 25 个实际“负面”和 10 个实际“正面”分类。这意味着，</p><p id="33ae" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated"><em class="mf">真正否定的数量= 50 </em></p><p id="06d8" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated"><em class="mf">假阴性的数量= 25 </em></p><p id="bb8b" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated"><em class="mf">真阳性的数量= 15 </em></p><p id="350c" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated"><em class="mf">误报数量= 10 </em></p><p id="e307" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">因此，本例中的混淆矩阵如下所示:</p><figure class="mb mc md me gt is gh gi paragraph-image"><div class="gh gi mg"><img src="../Images/4f6e9388abffae3ea4c4b1c5595c9944.png" data-original-src="https://miro.medium.com/v2/resize:fit:1160/format:webp/1*56mRh48aE88xCbQKBML1eg.png"/></div></figure><p id="229c" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">为了表示简单，让我们将<em class="mf">个真阴性</em>表示为<em class="mf"> </em> <strong class="lg jq"> TN </strong>，<em class="mf">个假阴性</em>表示为<strong class="lg jq"> FN </strong>，<em class="mf">个真阳性</em>表示为<strong class="lg jq"> TP，</strong>和<em class="mf">个假阳性</em>表示为<strong class="lg jq"> FP </strong>。因此，混淆矩阵的简化表示为:</p><figure class="mb mc md me gt is gh gi paragraph-image"><div class="gh gi mh"><img src="../Images/31cb0e9bac3fda7df8cac5707afdca92.png" data-original-src="https://miro.medium.com/v2/resize:fit:1164/format:webp/1*XtZZWwT5SUvyGUItBQAkyA.png"/></div></figure><p id="e259" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">不难理解，<em class="mf">真阴性数</em> (TN)和<em class="mf">假阴性数</em> (FN)之和等于<em class="mf">总数</em> <em class="mf">模型预测的</em>阴性数，即 FN +TN =预测阴性总数。</p><p id="c032" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">类似地，<em class="mf">真阴性数</em> (TN)和<em class="mf">假阳性数</em> (FP)之和等于<em class="mf">真阴性总数，</em>即 TN + FP =真阴性总数。</p><p id="8a07" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">根据同样的推理，我们理解，</p><p id="e183" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">FP + TP =预测阳性总数</p><p id="a686" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">FN + TP =实际阳性总数。</p><p id="fbf7" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">当然，<em class="mf">预测阴性总数</em> +预测阳性总数<em class="mf"/>=<em class="mf">测试集行数</em></p><p id="e1f5" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">类似地，<em class="mf">实际阴性总数+实际阳性总数=测试集行数。</em></p><p id="7c47" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">将此信息添加到混淆矩阵中:</p><figure class="mb mc md me gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mi"><img src="../Images/48b815d7cecd4d853d845f6c0ed91e60.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Q0YvVQZONifIBzGIUUSRCg.png"/></div></div></figure><p id="f14a" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">将这些附加信息添加到前面讨论的例子中的混淆矩阵中:</p><figure class="mb mc md me gt is gh gi paragraph-image"><div class="gh gi mj"><img src="../Images/070660a081905cba8dd93fbe845076f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:910/format:webp/1*QKkA3md46QToVsVW86mwXw.png"/></div></figure><p id="bb62" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">让我们看看如何使用 scikit-learn 的<em class="mf">度量</em>模块在 Python 中计算混淆矩阵。让我们在测试集中取 10 行，并将“负”和“正”分别表示为 0 和 1。在下面的 Python 代码中，我们从<em class="mf">度量</em>模块中导入了<em class="mf">混淆 _ 矩阵</em>函数。然后将实际的和预测的类作为输入给<em class="mf">混淆矩阵</em>函数，我们得到矩阵作为输出。</p><figure class="mb mc md me gt is"><div class="bz fp l di"><div class="mk ml l"/></div></figure><p id="d99a" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">检查代码中的<em class="mf">实际</em>和<em class="mf">预测</em>列表，</p><p id="4cfa" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated"><em class="mf">真底片数</em> (TN) <em class="mf"> </em> = 1</p><p id="25c2" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated"><em class="mf">真阳性的数量</em> (TP) = 4</p><p id="59bd" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated"><em class="mf">假阴性数量</em> (FN) = 2</p><p id="f167" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated"><em class="mf">误报数量</em> (FP) <em class="mf"> = </em> 3</p><p id="b2db" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated"><em class="mf">实际底片总数</em> (TN + FP) <em class="mf"> = </em> 4</p><p id="1415" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated"><em class="mf">实际阳性总数</em> (TP + FN) <em class="mf"> = </em> 6</p><p id="babd" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated"><em class="mf">预测否定总数</em> (TN + FN) <em class="mf"> = </em> 3</p><p id="df77" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated"><em class="mf">预测阳性总数</em> (TP + FP) <em class="mf"> </em> = 7</p><p id="3506" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">在上面的代码中打印混淆矩阵会得到以下输出:</p><p id="2f7c" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">[[1 3] <br/> [2 4]]</p><p id="e86e" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">程序给出了正确的混淆矩阵。</p><p id="22b8" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">在我以后的文章中，我将解释如何使用混淆矩阵来评估二元分类器的性能。</p><p id="a40f" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">现在结束！</p><p id="7d31" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">延伸阅读:</p><p id="98ab" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">neptune.ai 的以下帖子详细解释了可以使用混淆矩阵计算的 24 个性能指标，以评估二进制分类:</p><div class="ip iq gp gr ir mm"><a href="https://neptune.ai/blog/evaluation-metrics-binary-classification" rel="noopener  ugc nofollow" target="_blank"><div class="mn ab fo"><div class="mo ab mp cl cj mq"><h2 class="bd jq gy z fp mr fr fs ms fu fw jp bi translated">二元分类的 24 个评估指标(以及何时使用)- neptune.ai</h2><div class="mt l"><h3 class="bd b gy z fp mr fr fs ms fu fw dk translated">分类度量让您可以评估机器学习模型的性能，但它们有这么多，每个…</h3></div><div class="mu l"><p class="bd b dl z fp mr fr fs ms fu fw dk translated">海王星. ai</p></div></div><div class="mv l"><div class="mw l mx my mz mv na ix mm"/></div></div></a></div><h2 id="a872" class="nb nc jg bd nd ne nf dn ng nh ni dp nj ln nk nl nm lr nn no np lv nq nr ns jm bi translated">参考资料:</h2><div class="ip iq gp gr ir mm"><a href="https://skymind.ai/wiki/accuracy-precision-recall-f1" rel="noopener  ugc nofollow" target="_blank"><div class="mn ab fo"><div class="mo ab mp cl cj mq"><h2 class="bd jq gy z fp mr fr fs ms fu fw jp bi translated">Skymind</h2><div class="mt l"><h3 class="bd b gy z fp mr fr fs ms fu fw dk translated">关于混淆矩阵的文章— skymind.ai</h3></div></div></div></a></div><div class="ip iq gp gr ir mm"><a href="https://www.geeksforgeeks.org/confusion-matrix-machine-learning/" rel="noopener  ugc nofollow" target="_blank"><div class="mn ab fo"><div class="mo ab mp cl cj mq"><h2 class="bd jq gy z fp mr fr fs ms fu fw jp bi translated">机器学习中的混淆矩阵</h2><div class="mt l"><h3 class="bd b gy z fp mr fr fs ms fu fw dk translated">在机器学习领域，特别是统计分类问题，混淆矩阵，也…</h3></div><div class="mu l"><p class="bd b dl z fp mr fr fs ms fu fw dk translated">www.geeksforgeeks.org</p></div></div><div class="mv l"><div class="nt l mx my mz mv na ix mm"/></div></div></a></div></div></div>    
</body>
</html>