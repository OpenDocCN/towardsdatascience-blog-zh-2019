<html>
<head>
<title>How To Use Deep Learning Even with Small Data</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用深度学习，即使是小数据</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-use-deep-learning-even-with-small-data-e7f34b673987?source=collection_archive---------2-----------------------#2019-11-09">https://towardsdatascience.com/how-to-use-deep-learning-even-with-small-data-e7f34b673987?source=collection_archive---------2-----------------------#2019-11-09</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="99de" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">以及为什么它如此重要</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/f163394da6d1f0ce895a1d55a86dc819.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*e7OX77HRbWgVWEoQyToUoA.jpeg"/></div></div></figure><p id="4cd0" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">你已经听说了这个消息——深度学习是自切片面包以来最热门的东西。它承诺以极小的代价解决大量数据中最复杂的问题。唯一的问题是，你既不是在谷歌也不是在脸书工作，数据很少。那你打算怎么办？你还能利用深度学习的力量吗？还是你运气不好？让我们来看看<strong class="kw iu">你如何能够利用深度学习，即使数据有限</strong>，以及为什么我认为这可能是未来研究中最令人兴奋的领域之一。</p><h1 id="dfed" class="lq lr it bd ls lt lu lv lw lx ly lz ma jz mb ka mc kc md kd me kf mf kg mg mh bi translated">从简单开始</h1><p id="16fc" class="pw-post-body-paragraph ku kv it kw b kx mi ju kz la mj jx lc ld mk lf lg lh ml lj lk ll mm ln lo lp im bi translated">在我们讨论利用深度学习处理有限数据的方法之前，请从神经网络后退一步，建立一个简单的基线。通常不需要很长时间就可以试验一些传统的模型，比如随机森林。这将帮助你衡量深度学习的任何潜在提升，并为你的问题提供深度学习与其他方法之间的权衡的大量见解。</p><h1 id="ebf4" class="lq lr it bd ls lt lu lv lw lx ly lz ma jz mb ka mc kc md kd me kf mf kg mg mh bi translated">获取更多数据</h1><p id="14b7" class="pw-post-body-paragraph ku kv it kw b kx mi ju kz la mj jx lc ld mk lf lg lh ml lj lk ll mm ln lo lp im bi translated">这听起来可能很荒谬，但是你真的考虑过你是否能收集更多的数据吗？我惊讶地发现，我经常向公司提出这样的建议，他们看着我，好像我疯了一样。<strong class="kw iu">是的——投入时间和金钱来收集更多的数据是可以的。</strong>事实上，这通常是你的最佳选择。例如，也许你正在尝试对稀有鸟类进行分类，但数据非常有限。几乎可以肯定的是，只要标注更多的数据，解决这个问题会更容易。不确定需要收集多少数据？尝试绘制<a class="ae mn" href="https://www.dataquest.io/blog/learning-curves-machine-learning/" rel="noopener ugc nofollow" target="_blank">学习曲线</a>，添加额外的数据并观察模型性能的变化。</p><h1 id="af5f" class="lq lr it bd ls lt lu lv lw lx ly lz ma jz mb ka mc kc md kd me kf mf kg mg mh bi translated"><strong class="ak">微调</strong></h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mo"><img src="../Images/4b6dee87889af5387a2fcbdbf522a46d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*yCitvhRPHOazx4YX"/></div></div><figcaption class="mp mq gj gh gi mr ms bd b be z dk">Photo by <a class="ae mn" href="https://unsplash.com/@drewpatrickmiller?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Drew Patrick Miller</a> on <a class="ae mn" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="9151" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">好吧。让我们假设您现在有一个简单的基线模型，并且收集更多的数据要么是不可能的，要么太昂贵。在这一点上，最可靠的方法是利用预先训练好的模型，然后针对您的问题对它们进行微调。</p><p id="6e08" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">微调的基本思想是获取一个非常大的数据集，希望它与您的领域有些相似，训练一个神经网络，然后用较小的数据集微调这个预训练的网络。你可以在这篇<a class="ae mn" href="https://flyyufelix.github.io/2016/10/03/fine-tuning-in-keras-part1.html" rel="noopener ugc nofollow" target="_blank">文章</a>中了解更多。</p><p id="ae65" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">对于图像分类问题，要去的数据集是<a class="ae mn" href="https://machinelearningmastery.com/introduction-to-the-imagenet-large-scale-visual-recognition-challenge-ilsvrc/" rel="noopener ugc nofollow" target="_blank"> ImageNet </a>。该数据集包含跨越许多对象类别的数百万幅图像，因此可用于许多类型的图像问题。它甚至包括动物，因此可能有助于珍稀鸟类的分类。</p><p id="8328" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">要开始微调一些代码，请查看 Pytorch 的伟大的<a class="ae mn" href="https://pytorch.org/tutorials/beginner/finetuning_torchvision_models_tutorial.html" rel="noopener ugc nofollow" target="_blank">教程</a>。</p><h1 id="a750" class="lq lr it bd ls lt lu lv lw lx ly lz ma jz mb ka mc kc md kd me kf mf kg mg mh bi translated">数据扩充</h1><p id="7cfd" class="pw-post-body-paragraph ku kv it kw b kx mi ju kz la mj jx lc ld mk lf lg lh ml lj lk ll mm ln lo lp im bi translated">如果您无法获得更多数据，并且在大型数据集上的微调没有任何成功，那么数据扩充通常是您的下一个最佳选择。它也可以与微调结合使用。</p><p id="61af" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">数据扩充背后的想法很简单:<strong class="kw iu">以提供新数据的方式改变输入，同时不改变标签值。</strong></p><p id="3560" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">例如，如果你有一张猫的图片，旋转图像，它仍然是一张猫的图片。因此，这将是很好的数据扩充。另一方面，如果你有一张道路的照片，并希望预测合适的转向角度(自动驾驶汽车)，旋转图像会改变合适的转向角度。这是不行的，除非你也适当地调整转向角度。</p><p id="2959" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">数据扩充是最常见的图像分类问题，你可以在这里找到技术<a class="ae mn" href="https://nanonets.com/blog/data-augmentation-how-to-use-deep-learning-when-you-have-limited-data-part-2/" rel="noopener ugc nofollow" target="_blank"/>。</p><p id="c9f2" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">你可以经常想到创造性的方法来增加其他领域的数据，如 NLP(参见这里的一些例子<a class="ae mn" rel="noopener" target="_blank" href="/these-are-the-easiest-data-augmentation-techniques-in-natural-language-processing-you-can-think-of-88e393fd610"/>)，人们也在尝试用<a class="ae mn" href="https://medium.com/reality-engines/gans-for-data-augmentation-21a69de6c60b" rel="noopener"> GANs </a>来生成新数据。如果对 GAN 方法感兴趣，我会看看<a class="ae mn" href="https://github.com/SchafferZhang/DADA" rel="noopener ugc nofollow" target="_blank"> DADA </a>:深度对抗数据增强。</p><h1 id="e09d" class="lq lr it bd ls lt lu lv lw lx ly lz ma jz mb ka mc kc md kd me kf mf kg mg mh bi translated">余弦损失</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mt"><img src="../Images/73316ca39e83bac5c63540cff7e03b0c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xIu4AU5qfsPoKh0hmueAyw.png"/></div></div></figure><p id="c658" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">最近的一篇<a class="ae mn" href="https://arxiv.org/pdf/1901.09054.pdf" rel="noopener ugc nofollow" target="_blank">论文</a>，在没有使用余弦损失进行预训练的情况下对小数据集进行深度学习，发现当将损失函数从分类交叉熵损失切换到分类问题的余弦损失时，小数据集的准确性提高了 30%。余弦损失简单来说就是 1 — <a class="ae mn" href="https://en.wikipedia.org/wiki/Cosine_similarity" rel="noopener ugc nofollow" target="_blank">余弦相似度</a>。</p><p id="b00d" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在上面的图表中，您可以看到性能如何根据每个类的样本数量而变化，以及微调如何对一些小数据集(CUB)非常有价值，而对其他数据集(CIFAR-100)没有价值。</p><h1 id="c918" class="lq lr it bd ls lt lu lv lw lx ly lz ma jz mb ka mc kc md kd me kf mf kg mg mh bi translated">深入</h1><p id="122e" class="pw-post-body-paragraph ku kv it kw b kx mi ju kz la mj jx lc ld mk lf lg lh ml lj lk ll mm ln lo lp im bi translated">在 NIPs <a class="ae mn" href="https://papers.nips.cc/paper/7620-modern-neural-networks-generalize-on-small-data-sets.pdf" rel="noopener ugc nofollow" target="_blank">的一篇论文</a>中，现代神经网络对小数据集进行归纳，他们将深度神经网络视为整体。具体来说，“不是每一层都呈现出不断增加的特征层次，而是最终层提供了一个整体机制。”</p><p id="23d3" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我对此的看法是，对于小数据，确保你建立了深厚的人际网络，以利用这种整体效应。</p><h1 id="d57d" class="lq lr it bd ls lt lu lv lw lx ly lz ma jz mb ka mc kc md kd me kf mf kg mg mh bi translated">自动编码器</h1><p id="086f" class="pw-post-body-paragraph ku kv it kw b kx mi ju kz la mj jx lc ld mk lf lg lh ml lj lk ll mm ln lo lp im bi translated">已经有一些<a class="ae mn" href="https://www.sciencedirect.com/science/article/pii/S0264127518308682" rel="noopener ugc nofollow" target="_blank">成功</a>使用堆叠式自动编码器用更优的起始权重来预训练网络。这可以让你避免局部优化和其他不好的初始化陷阱。不过，安德烈·卡帕西<a class="ae mn" href="http://karpathy.github.io/2019/04/25/recipe/" rel="noopener ugc nofollow" target="_blank">建议</a>不要对无人监督的预训过于兴奋。</p><p id="5f1b" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">如果你需要温习自动编码器，你可以查看斯坦福深度学习教程<a class="ae mn" href="http://ufldl.stanford.edu/tutorial/unsupervised/Autoencoders/" rel="noopener ugc nofollow" target="_blank"/>。基本想法是建立一个预测输入的神经网络。</p><h1 id="d41e" class="lq lr it bd ls lt lu lv lw lx ly lz ma jz mb ka mc kc md kd me kf mf kg mg mh bi translated">先验知识</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mu"><img src="../Images/1e16451613e2bbd1b886ddf4d840e5af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*VkVBWTiv1I_gY0xg"/></div></div><figcaption class="mp mq gj gh gi mr ms bd b be z dk">Photo by <a class="ae mn" href="https://unsplash.com/@glennoble?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Glen Noble</a> on <a class="ae mn" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="a6b2" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">最后，但同样重要的是，尝试并找到整合特定领域知识的方法来指导学习过程。例如，在<a class="ae mn" href="https://science.sciencemag.org/content/350/6266/1332" rel="noopener ugc nofollow" target="_blank">通过概率程序归纳的人类级概念学习</a>中，作者构建了一个模型，该模型通过利用过程中的先验知识从零件构建概念。这导致了人类水平的性能，并超过了当时的深度学习方法。</p><p id="7636" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">您还可以使用领域知识来限制网络的输入，以减少维数或将网络架构调整得更小。</p><p id="5464" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我把这作为最后一个选项，因为整合先前的知识可能具有挑战性，并且通常是最耗时的选项。</p><h1 id="f162" class="lq lr it bd ls lt lu lv lw lx ly lz ma jz mb ka mc kc md kd me kf mf kg mg mh bi translated"><strong class="ak">再次制造小爽</strong></h1><p id="ff97" class="pw-post-body-paragraph ku kv it kw b kx mi ju kz la mj jx lc ld mk lf lg lh ml lj lk ll mm ln lo lp im bi translated">希望这篇文章给了你一些关于如何利用深度学习技术的想法，即使数据有限。我个人发现，这个问题目前没有得到应有的讨论，但它有着非常令人兴奋的影响。</p><p id="40a3" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">有大量的问题只有非常有限的数据，而获取更多的数据是非常昂贵或不可能的。比如检测罕见病或者教育成果。找到将我们的一些最佳技术(如深度学习)应用于这些问题的方法是非常令人兴奋的！甚至吴恩达也同意:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mv mw l"/></div></figure><p id="13d1" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这个故事也可以在<a class="ae mn" href="https://learningwithdata.com/posts/tylerfolkman/how-to-use-deep-learning-even-with-small-data-e7f34b673987/" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p></div></div>    
</body>
</html>