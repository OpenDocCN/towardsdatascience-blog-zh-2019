<html>
<head>
<title>Python Pro Tip: Start using Python defaultdict and Counter in place of dictionary</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python Pro 提示:开始使用 Python defaultdict 和 Counter 代替字典</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/python-pro-tip-start-using-python-defaultdict-and-counter-in-place-of-dictionary-d1922513f747?source=collection_archive---------7-----------------------#2019-04-22">https://towardsdatascience.com/python-pro-tip-start-using-python-defaultdict-and-counter-in-place-of-dictionary-d1922513f747?source=collection_archive---------7-----------------------#2019-04-22</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="1877" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsdatascience.com/tagged/python-shorts" rel="noopener" target="_blank">蟒蛇短裤</a></h2><div class=""/><div class=""><h2 id="1e7b" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">如何使用 defaultdict 和 Counter 使你的代码简短易读</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/c5df5132c7524c3d9a0f493d73b232b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*c3GbEX7Wao3oHm_0"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk">Photo by <a class="ae lh" href="https://unsplash.com/@brookelark?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Brooke Lark</a> on <a class="ae lh" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="a5df" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">学习一门语言很容易。每当我开始学习一门新的语言时，我会按照下面的顺序专注于几件事情，开始用任何语言编写代码都是轻而易举的事情。</p><ul class=""><li id="247d" class="mf mg it lk b ll lm lo lp lr mh lv mi lz mj md mk ml mm mn bi translated">运算符和数据类型:+，-，int，float，str</li><li id="cc19" class="mf mg it lk b ll mo lo mp lr mq lv mr lz ms md mk ml mm mn bi translated">条件语句:if，else，case，switch</li><li id="bd6d" class="mf mg it lk b ll mo lo mp lr mq lv mr lz ms md mk ml mm mn bi translated">循环:For，while</li><li id="c6dc" class="mf mg it lk b ll mo lo mp lr mq lv mr lz ms md mk ml mm mn bi translated">数据结构:列表，数组，字典，散列表</li><li id="0859" class="mf mg it lk b ll mo lo mp lr mq lv mr lz ms md mk ml mm mn bi translated">定义函数</li></ul><p id="f780" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><strong class="lk jd"> <em class="me">但是，学会写语言和用优化的方式写语言是两回事。</em>T15】</strong></p><p id="9368" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">每种语言都有一些独特的成分。</p><p id="d9c8" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">然而，<strong class="lk jd"> <em class="me">一个新的程序员对任何语言总会做一些被迫的过度适应。</em> </strong>举例来说，一个刚接触<a class="ae lh" href="https://amzn.to/2XPSiiG" rel="noopener ugc nofollow" target="_blank"> python </a>的 Java 程序员，可能会编写这段代码来添加列表中的数字。</p><pre class="ks kt ku kv gt mt mu mv mw aw mx bi"><span id="1705" class="my mz it mu b gy na nb l nc nd">x=[1,2,3,4,5]</span><span id="58ae" class="my mz it mu b gy ne nb l nc nd">sum_x = 0<br/>for i in range(len(x)):<br/>    sum_x+=x[i]</span></pre><p id="416a" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">虽然 python 程序员会很自然地这样做:</p><pre class="ks kt ku kv gt mt mu mv mw aw mx bi"><span id="6a62" class="my mz it mu b gy na nb l nc nd">sum_x = sum(x)</span></pre><p id="4904" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在这一系列名为<strong class="lk jd">‘Python Shorts’</strong>的帖子中，我将解释由<a class="ae lh" href="https://amzn.to/2XPSiiG" rel="noopener ugc nofollow" target="_blank"> Python </a>提供的一些简单构造、一些基本技巧以及我在数据科学工作中经常遇到的一些用例。</p><p id="97c6" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><strong class="lk jd"> <em class="me">这个系列讲的是高效可读的代码。</em>T29】</strong></p></div><div class="ab cl nf ng hx nh" role="separator"><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk"/></div><div class="im in io ip iq"><h1 id="bfe3" class="nm mz it bd nn no np nq nr ns nt nu nv ki nw kj nx kl ny km nz ko oa kp ob oc bi translated">计数器和默认值—用例</h1><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi od"><img src="../Images/18e5e0a7276f4ba53359b14f1921661a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*pxVbW7V5iXP4VBfU.jpg"/></div></div></figure><p id="d5e1" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><strong class="lk jd"> <em class="me">假设我需要统计一段文本中出现的单词数。</em> </strong>也许对于《哈姆雷特》这样的书来说。我怎么能这么做呢？</p><p id="aa8f" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">Python 总是为我们提供多种方法来做同样的事情。但只有一种方式我觉得很优雅。</p><p id="a635" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">这是一个使用<code class="fe oe of og mu b">dict</code>对象的<strong class="lk jd"> <em class="me">幼稚 Python 实现</em> </strong>。</p><pre class="ks kt ku kv gt mt mu mv mw aw mx bi"><span id="8bf5" class="my mz it mu b gy na nb l nc nd">text = "I need to count the number of word occurrences in a piece of text. How could I do that? Python provides us with multiple ways to do the same thing. But only one way I find beautiful."</span><span id="f375" class="my mz it mu b gy ne nb l nc nd">word_count_dict = {}<br/>for w in text.split(" "):<br/>    if w in word_count_dict:<br/>        word_count_dict[w]+=1<br/>    else:<br/>        word_count_dict[w]=1</span></pre><p id="44bd" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我们可以使用<code class="fe oe of og mu b"><strong class="lk jd"><em class="me">defaultdict</em></strong></code>来减少代码中的行数。</p><pre class="ks kt ku kv gt mt mu mv mw aw mx bi"><span id="f23e" class="my mz it mu b gy na nb l nc nd">from collections import defaultdict<br/>word_count_dict = defaultdict(int)<br/>for w in text.split(" "):<br/>    word_count_dict[w]+=1</span></pre><p id="603d" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我们也可以使用<code class="fe oe of og mu b"><strong class="lk jd"><em class="me">Counter</em></strong></code>来做到这一点，在我看来，这是解决这个问题的最佳方法。</p><pre class="ks kt ku kv gt mt mu mv mw aw mx bi"><span id="d413" class="my mz it mu b gy na nb l nc nd">from collections import Counter<br/>word_count_dict = Counter()<br/>for w in text.split(" "):<br/>    word_count_dict[w]+=1</span></pre><p id="57ce" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">如果我们使用<code class="fe oe of og mu b">Counter</code>，我们也可以使用一个简单的函数得到最常见的单词。</p><pre class="ks kt ku kv gt mt mu mv mw aw mx bi"><span id="ef35" class="my mz it mu b gy na nb l nc nd">word_count_dict.most_common(10)<br/>---------------------------------------------------------------<br/>[('I', 3), ('to', 2), ('the', 2)]</span></pre><p id="2225" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">计数器的其他使用案例:</p><pre class="ks kt ku kv gt mt mu mv mw aw mx bi"><span id="ed1c" class="my mz it mu b gy na nb l nc nd"># Count Characters<br/>Counter('abccccccddddd')<br/>---------------------------------------------------------------<br/>Counter({'a': 1, 'b': 1, 'c': 6, 'd': 5})</span><span id="6941" class="my mz it mu b gy ne nb l nc nd"># Count List elements<br/>Counter([1,2,3,4,5,1,2])<br/>---------------------------------------------------------------<br/>Counter({1: 2, 2: 2, 3: 1, 4: 1, 5: 1})</span></pre><h1 id="42df" class="nm mz it bd nn no oh nq nr ns oi nu nv ki oj kj nx kl ok km nz ko ol kp ob oc bi translated">那么，为什么曾经使用过<code class="fe oe of og mu b">defaultdict</code>？</h1><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi om"><img src="../Images/4804f0bf7ca0ff058cb36044665c6bc4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*yd_caXBbrX84ZL-B"/></div></div></figure><p id="d047" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">注意在<code class="fe oe of og mu b">Counter</code>中，值总是一个整数。</p><p id="fcd8" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">如果我们想解析一个包含颜色和水果的元组列表会怎么样。并希望创建一个键和值列表的字典。</p><p id="38c5" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">一个<code class="fe oe of og mu b">defaultdict</code>提供的主要功能是，如果在<code class="fe oe of og mu b">defaultdict</code>中没有找到，它默认一个键为空/零。</p><pre class="ks kt ku kv gt mt mu mv mw aw mx bi"><span id="90b3" class="my mz it mu b gy na nb l nc nd">s = [('color', 'blue'), ('color', 'orange'), ('color', 'yellow'), ('fruit', 'banana'), ('fruit', 'orange'),('fruit','banana')]</span><span id="70df" class="my mz it mu b gy ne nb l nc nd">d = defaultdict(list)</span><span id="d792" class="my mz it mu b gy ne nb l nc nd">for k, v in s:<br/>     d[k].append(v)</span><span id="4dcb" class="my mz it mu b gy ne nb l nc nd">print(d)<br/>---------------------------------------------------------------<br/>defaultdict(&lt;class 'list'&gt;, {'color': ['blue', 'orange', 'yellow'], 'fruit': ['banana', 'orange', 'banana']})</span></pre><p id="a82f" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><code class="fe oe of og mu b">banana</code>在<code class="fe oe of og mu b">fruit</code>中出现两次，我们可以用<code class="fe oe of og mu b">set</code></p><pre class="ks kt ku kv gt mt mu mv mw aw mx bi"><span id="2f03" class="my mz it mu b gy na nb l nc nd">d = defaultdict(set)</span><span id="0551" class="my mz it mu b gy ne nb l nc nd">for k, v in s:<br/>     d[k].add(v)</span><span id="b2c7" class="my mz it mu b gy ne nb l nc nd">print(d)<br/>---------------------------------------------------------------<br/>defaultdict(&lt;class 'set'&gt;, {'color': {'yellow', 'blue', 'orange'}, 'fruit': {'banana', 'orange'}})</span></pre><h1 id="abdd" class="nm mz it bd nn no oh nq nr ns oi nu nv ki oj kj nx kl ok km nz ko ol kp ob oc bi translated">结论</h1><p id="0948" class="pw-post-body-paragraph li lj it lk b ll on kd ln lo oo kg lq lr op lt lu lv oq lx ly lz or mb mc md im bi translated">总结一下，我要说的是<strong class="lk jd"> <em class="me">在</em></strong><a class="ae lh" href="https://amzn.to/2XPSiiG" rel="noopener ugc nofollow" target="_blank"><strong class="lk jd"><em class="me">Python</em></strong></a>中总有一种做任何事情的美好方式。在编写代码之前搜索它。去 StackOverflow 没问题。我被困的时候去过很多次。永远记住:</p><blockquote class="os"><p id="d453" class="ot ou it bd ov ow ox oy oz pa pb md dk translated">为已经提供的东西创建一个函数不是 pythonic 式的。</p></blockquote></div><div class="ab cl nf ng hx nh" role="separator"><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk"/></div><div class="im in io ip iq"><p id="271e" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">另外，如果你想了解更多关于 Python 3 的知识，我想向你推荐密歇根大学的一门优秀的中级 Python 课程。一定要去看看。</p><p id="29c2" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">将来我也会写更多初学者友好的帖子。让我知道你对这个系列的看法。在<a class="ae lh" href="https://medium.com/@rahul_agarwal" rel="noopener"> <strong class="lk jd">媒体</strong> </a>关注我，或者订阅我的<a class="ae lh" href="http://eepurl.com/dbQnuX" rel="noopener ugc nofollow" target="_blank"> <strong class="lk jd">博客</strong> </a>了解他们。一如既往，我欢迎反馈和建设性的批评，可以通过 Twitter <a class="ae lh" href="https://twitter.com/MLWhiz" rel="noopener ugc nofollow" target="_blank"> @mlwhiz </a>联系。</p></div></div>    
</body>
</html>