<html>
<head>
<title>Minimize for loop usage in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">尽量减少 Python 中 for 循环的使用</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/minimize-for-loop-usage-in-python-78e3bc42f03f?source=collection_archive---------10-----------------------#2019-04-23">https://towardsdatascience.com/minimize-for-loop-usage-in-python-78e3bc42f03f?source=collection_archive---------10-----------------------#2019-04-23</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="d0cd" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsdatascience.com/tagged/python-shorts" rel="noopener" target="_blank">蟒蛇短裤</a></h2><div class=""/><div class=""><h2 id="60e7" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">如何以及为什么应该在 Python 代码中最小化 for 循环的使用？</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/6e62b7c630b271186534d8049f6cf507.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*aYSzzvJDJ28kV200"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk">Photo by <a class="ae lh" href="https://unsplash.com/@etiennegirardet?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Etienne Girardet</a> on <a class="ae lh" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="6882" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><a class="ae lh" href="https://amzn.to/2XPSiiG" rel="noopener ugc nofollow" target="_blank"> Python </a>为我们提供了多种风格的编码。</p><p id="5b4d" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在某种程度上，它是相当包容的。</p><p id="4f52" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">一个人可以来自任何语言，开始写 Python。</p><p id="bf85" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><strong class="lk jd"> <em class="me">但是，学会写语言和用优化的方式写语言是两回事。</em>T12】</strong></p><p id="29b1" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在这一系列名为<a class="ae lh" href="https://towardsdatascience.com/tagged/python-shorts" rel="noopener" target="_blank"> <strong class="lk jd"> Python Shorts </strong> </a>的帖子中，我将解释 Python 提供的一些简单但非常有用的构造，一些基本的技巧和我在数据科学工作中经常遇到的一些用例。</p><p id="b155" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在这篇文章中，<strong class="lk jd"> <em class="me">我将谈论 Python 中的</em> </strong> <code class="fe mf mg mh mi b"><strong class="lk jd"><em class="me">for</em></strong></code> <strong class="lk jd"> <em class="me">循环以及你应该如何尽可能避免它们。</em>T24】</strong></p><h1 id="e135" class="mj mk it bd ml mm mn mo mp mq mr ms mt ki mu kj mv kl mw km mx ko my kp mz na bi translated">编写 for 循环的 3 种方法:</h1><p id="7a6b" class="pw-post-body-paragraph li lj it lk b ll nb kd ln lo nc kg lq lr nd lt lu lv ne lx ly lz nf mb mc md im bi translated">让我用一个简单的例子来解释这一点。</p><p id="7c52" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">假设你想在一个列表中取<strong class="lk jd"> <em class="me">的平方和。</em> </strong></p><p id="d233" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">每当我们想要计算 n 维中两点之间的距离时，这是机器学习中我们都面临的一个有效问题。</p><p id="0610" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">使用循环可以很容易地做到这一点。</p><p id="a1d5" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">事实上，我将向你展示三种我见过人们使用的完成相同任务的方法，并让你自己选择你认为最好的方法。</p><pre class="ks kt ku kv gt ng mi nh ni aw nj bi"><span id="26f8" class="nk mk it mi b gy nl nm l nn no">x = [1,3,5,7,9]<br/>sum_squared = 0</span><span id="2959" class="nk mk it mi b gy np nm l nn no">for i in range(len(x)):<br/>    sum_squared+=x[i]**2</span></pre><p id="cb3a" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">每当我在一个 python 代码库中看到上面的代码，我就明白这个人来自 C 或 Java 背景。</p><p id="eba4" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">一个<strong class="lk jd">稍微大一点的</strong>的做法是:</p><pre class="ks kt ku kv gt ng mi nh ni aw nj bi"><span id="5965" class="nk mk it mi b gy nl nm l nn no">x = [1,3,5,7,9]<br/>sum_squared = 0</span><span id="62e3" class="nk mk it mi b gy np nm l nn no">for y in x:<br/>    sum_squared+=y**2</span></pre><p id="1e09" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">好多了。</p><p id="c001" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我没有给名单编索引。我的代码可读性更好。</p><p id="964b" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">但是，pythonic 的方法仍然是在一行中。</p><pre class="ks kt ku kv gt ng mi nh ni aw nj bi"><span id="4854" class="nk mk it mi b gy nl nm l nn no">x = [1,3,5,7,9]<br/>sum_squared = sum([y**2 for y in x])</span></pre><p id="fc55" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">这种方法叫做列表理解，这可能是我喜欢 Python 的原因之一。 </p><p id="77ff" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在列表理解中也可以使用<code class="fe mf mg mh mi b">if</code>。</p><p id="0678" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">假设我们想要一个偶数的平方数列表。</p><pre class="ks kt ku kv gt ng mi nh ni aw nj bi"><span id="898a" class="nk mk it mi b gy nl nm l nn no">x = [1,2,3,4,5,6,7,8,9]<br/>even_squared = [y**2 for y in x if y%2==0]<br/>--------------------------------------------<br/>[4,16,36,64]</span></pre><p id="fb6b" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><code class="fe mf mg mh mi b"><strong class="lk jd"><em class="me">if-else?</em></strong></code></p><p id="4657" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">如果我们想要偶数的平方和奇数的立方呢？</p><pre class="ks kt ku kv gt ng mi nh ni aw nj bi"><span id="07d3" class="nk mk it mi b gy nl nm l nn no">x = [1,2,3,4,5,6,7,8,9]<br/>squared_cubed = [y**2 if y%2==0 else y**3 for y in x]<br/>--------------------------------------------<br/>[1, 4, 27, 16, 125, 36, 343, 64, 729]</span></pre><p id="780f" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">太好了！！！</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/f54fd5c48abc8974768bd13b46c1b942.png" data-original-src="https://miro.medium.com/v2/resize:fit:1244/format:webp/0*E3GXaHSrdRSdcikf.png"/></div></figure><p id="c863" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">所以基本上遵循特定的<strong class="lk jd">准则:</strong>每当你想写一个<code class="fe mf mg mh mi b">for</code>陈述的时候，你应该问自己以下问题:</p><ul class=""><li id="6cb3" class="nr ns it lk b ll lm lo lp lr nt lv nu lz nv md nw nx ny nz bi translated">没有<code class="fe mf mg mh mi b">for</code>环能做到吗？大多数蟒蛇</li><li id="3697" class="nr ns it lk b ll oa lo ob lr oc lv od lz oe md nw nx ny nz bi translated">使用<strong class="lk jd">列表理解</strong>可以做到吗？如果有，就用吧。</li><li id="c44a" class="nr ns it lk b ll oa lo ob lr oc lv od lz oe md nw nx ny nz bi translated">不索引数组可以吗？如果没有，可以考虑使用<code class="fe mf mg mh mi b">enumerate</code></li></ul><p id="6a0b" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">什么是<code class="fe mf mg mh mi b">enumerate?</code></p><p id="9a48" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">有时我们既需要数组中的索引，也需要数组中的值。</p><p id="abe6" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在这种情况下，我更喜欢用<strong class="lk jd">枚举</strong>而不是索引列表。</p><pre class="ks kt ku kv gt ng mi nh ni aw nj bi"><span id="5db3" class="nk mk it mi b gy nl nm l nn no">L = ['blue', 'yellow', 'orange']<br/>for i, val in enumerate(L):<br/>    print("index is %d and value is %s" % (i, val))<br/>---------------------------------------------------------------<br/>index is 0 and value is blue<br/>index is 1 and value is yellow<br/>index is 2 and value is orange</span></pre><p id="2379" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">规则是:</p><blockquote class="of"><p id="81bb" class="og oh it bd oi oj ok ol om on oo md dk translated">如果没有列表也可以，那就不要索引列表。</p></blockquote><h1 id="08cb" class="mj mk it bd ml mm mn mo mp mq mr ms mt ki op kj mv kl oq km mx ko or kp mz na bi translated">试着用字典理解</h1><p id="76f2" class="pw-post-body-paragraph li lj it lk b ll nb kd ln lo nc kg lq lr nd lt lu lv ne lx ly lz nf mb mc md im bi translated">还可以尝试使用<strong class="lk jd">字典理解</strong>，这是 Python 中一个相对较新的功能。语法非常类似于列表理解。</p><p id="9d23" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">让我用一个例子来解释。我想为 x 中的每个值得到一个(key: squared value)的字典。</p><pre class="ks kt ku kv gt ng mi nh ni aw nj bi"><span id="abfa" class="nk mk it mi b gy nl nm l nn no">x = [1,2,3,4,5,6,7,8,9]<br/>{k:k**2 for k in x}<br/>---------------------------------------------------------<br/>{1: 1, 2: 4, 3: 9, 4: 16, 5: 25, 6: 36, 7: 49, 8: 64, 9: 81}</span></pre><p id="bbc2" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">如果我想要一个偶数值的字典呢？</p><pre class="ks kt ku kv gt ng mi nh ni aw nj bi"><span id="bc17" class="nk mk it mi b gy nl nm l nn no">x = [1,2,3,4,5,6,7,8,9]<br/>{k:k**2 for k in x if x%2==0}<br/>---------------------------------------------------------<br/>{2: 4, 4: 16, 6: 36, 8: 64}</span></pre><p id="65d5" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">如果我们想要偶数键的平方值和奇数键的立方数呢？</p><pre class="ks kt ku kv gt ng mi nh ni aw nj bi"><span id="2a92" class="nk mk it mi b gy nl nm l nn no">x = [1,2,3,4,5,6,7,8,9]<br/>{k:k**2 if k%2==0 else k**3 for k in x}<br/>---------------------------------------------------------<br/>{1: 1, 2: 4, 3: 27, 4: 16, 5: 125, 6: 36, 7: 343, 8: 64, 9: 729}</span></pre><h1 id="3f67" class="mj mk it bd ml mm mn mo mp mq mr ms mt ki mu kj mv kl mw km mx ko my kp mz na bi translated">结论</h1><p id="ed34" class="pw-post-body-paragraph li lj it lk b ll nb kd ln lo nc kg lq lr nd lt lu lv ne lx ly lz nf mb mc md im bi translated">最后，我要说的是，虽然将你从其他语言中获得的知识转移到 Python 中似乎很容易，但如果你一直这样做，你将无法欣赏到 Python 的美妙之处。当我们使用 Python 的方式时，它会更加强大，也更有趣。</p><p id="2753" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><strong class="lk jd">所以，当你需要一个</strong> <code class="fe mf mg mh mi b"><strong class="lk jd">for</strong></code> <strong class="lk jd">循环的时候，使用列表理解和字典理解。如果需要数组索引，使用</strong> <code class="fe mf mg mh mi b"><strong class="lk jd">enumerate</strong></code> <strong class="lk jd">。</strong></p><blockquote class="of"><p id="75fc" class="og oh it bd oi oj ok ol om on oo md dk translated">避免像瘟疫一样形成循环</p></blockquote><p id="c258" class="pw-post-body-paragraph li lj it lk b ll os kd ln lo ot kg lq lr ou lt lu lv ov lx ly lz ow mb mc md im bi translated">从长远来看，您的代码将更具可读性和可维护性。</p><p id="5d9a" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">另外，如果你想了解更多关于 Python 3 的知识，我想向你推荐密歇根大学的一门优秀的中级 Python 课程。一定要去看看。</p><p id="29c2" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">将来我也会写更多初学者友好的帖子。让我知道你对这个系列的看法。在<a class="ae lh" href="https://medium.com/@rahul_agarwal" rel="noopener"> <strong class="lk jd">媒体</strong> </a>关注我或者订阅我的<a class="ae lh" href="https://mlwhiz.com/" rel="noopener ugc nofollow" target="_blank"> <strong class="lk jd">博客</strong> </a>了解他们。</p><p id="e208" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">一如既往，我欢迎反馈和建设性的批评，可以通过 Twitter <a class="ae lh" href="https://twitter.com/MLWhiz" rel="noopener ugc nofollow" target="_blank"> @mlwhiz </a>联系。</p></div><div class="ab cl ox oy hx oz" role="separator"><span class="pa bw bk pb pc pd"/><span class="pa bw bk pb pc pd"/><span class="pa bw bk pb pc"/></div><div class="im in io ip iq"><p id="acb8" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><em class="me">原载于 2019 年 4 月 23 日</em><a class="ae lh" href="https://mlwhiz.com/blog/2019/04/22/python_forloops/" rel="noopener ugc nofollow" target="_blank"><em class="me">https://mlwhiz.com</em></a><em class="me">。</em></p></div></div>    
</body>
</html>