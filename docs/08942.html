<html>
<head>
<title>ANOVA’s three types of estimating Sums of Squares: don’t make the wrong choice!</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">ANOVA 估计平方和的三种类型:不要选错！</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/anovas-three-types-of-estimating-sums-of-squares-don-t-make-the-wrong-choice-91107c77a27a?source=collection_archive---------0-----------------------#2019-11-29">https://towardsdatascience.com/anovas-three-types-of-estimating-sums-of-squares-don-t-make-the-wrong-choice-91107c77a27a?source=collection_archive---------0-----------------------#2019-11-29</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="7c55" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在本文中，我将解释计算方差分析平方和的三种不同方法，方差分析是一种使用统计显著性比较不同组平均值的常用统计方法。</p><p id="c551" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这篇文章直接进入双向方差分析。如果你需要回到更基本的单因素方差分析，请查阅我以前的文章。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div class="gh gi kp"><img src="../Images/bd43e995c0d60acf1a3e2b3689ae3f3b.png" data-original-src="https://miro.medium.com/v2/resize:fit:582/0*8_zY0PLbK1Lzax8i.JPG"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk">Ronald Fisher, the guy who invented ANOVA.</figcaption></figure><h1 id="5b59" class="lb lc it bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">1.双向方差分析基础概述</h1><p id="71ab" class="pw-post-body-paragraph jq jr it js b jt lz jv jw jx ma jz ka kb mb kd ke kf mc kh ki kj md kl km kn im bi translated">双向方差分析的目的是将因变量的总变异(以平方和衡量)分成不同的变异源。这使我们能够发现我们的自变量是否对因变量有显著影响。</p><blockquote class="me"><p id="1ca8" class="mf mg it bd mh mi mj mk ml mm mn kn dk translated">双向方差分析是有 2 个独立变量的方差分析。</p></blockquote><p id="b164" class="pw-post-body-paragraph jq jr it js b jt mo jv jw jx mp jz ka kb mq kd ke kf mr kh ki kj ms kl km kn im bi translated">存在三种不同的分裂变异方法:第一类、第二类和第三类平方和。在不平衡数据的情况下，它们不会给出相同的结果。</p><blockquote class="me"><p id="6d6e" class="mf mg it bd mh mi mj mk ml mm mn kn dk translated">I 型、II 型和 III 型方差分析结果不同！</p></blockquote><h2 id="58be" class="mt lc it bd ld mu mv dn lh mw mx dp ll kb my mz lp kf na nb lt kj nc nd lx ne bi translated">根据工作日和天气解释销售<a class="ae ko" href="http://bit.ly/anova-types" rel="noopener ugc nofollow" target="_blank">(笔记本在这里)</a></h2><p id="78c4" class="pw-post-body-paragraph jq jr it js b jt lz jv jw jx ma jz ka kb mb kd ke kf mc kh ki kj md kl km kn im bi translated">我将在一个实际的例子中应用这三种平方和来看它们的区别:</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="ng nh di ni bf nj"><div class="gh gi nf"><img src="../Images/0c79674010d57f8d105a368a6fa65174.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4QxfLWgf_T9j-Wm1LNxRJw.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk">An example with data for two way ANOVA</figcaption></figure><h1 id="4da1" class="lb lc it bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">2.第一类平方和</h1><p id="325b" class="pw-post-body-paragraph jq jr it js b jt lz jv jw jx ma jz ka kb mb kd ke kf mc kh ki kj md kl km kn im bi translated">第一类平方和，也称为序列平方和，以序列顺序分配变量。</p><p id="c960" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果模型有两个自变量 A 和 B 以及交互作用效应，按顺序指定，I 类平方和将:</p><ul class=""><li id="e045" class="nk nl it js b jt ju jx jy kb nm kf nn kj no kn np nq nr ns bi translated">首先给变量 A 分配一个最大变化量</li><li id="505b" class="nk nl it js b jt nt jx nu kb nv kf nw kj nx kn np nq nr ns bi translated">在剩余的变化中，将最大变化分配给变量 B</li><li id="7b84" class="nk nl it js b jt nt jx nu kb nv kf nw kj nx kn np nq nr ns bi translated">在剩余的变化中，将最大变化分配给交互效果</li><li id="827a" class="nk nl it js b jt nt jx nu kb nv kf nw kj nx kn np nq nr ns bi translated">把剩下的分配给剩余平方和。</li></ul><blockquote class="me"><p id="2a42" class="mf mg it bd mh mi ny nz oa ob oc kn dk translated">第一类平方和是连续的，因此模型中变量的顺序有所不同。这在实践中很少是我们想要的！</p></blockquote><p id="67ec" class="pw-post-body-paragraph jq jr it js b jt mo jv jw jx mp jz ka kb mq kd ke kf mr kh ki kj ms kl km kn im bi translated"><strong class="js iu">平方和在数学上定义为:</strong></p><ul class=""><li id="5c1c" class="nk nl it js b jt ju jx jy kb nm kf nn kj no kn np nq nr ns bi translated">自变量 A 的 SS(A)</li><li id="fd6d" class="nk nl it js b jt nt jx nu kb nv kf nw kj nx kn np nq nr ns bi translated">自变量 B 的 SS(B | A)</li><li id="6e85" class="nk nl it js b jt nt jx nu kb nv kf nw kj nx kn np nq nr ns bi translated">相互作用效应的 SS(AB | B，A)</li></ul><p id="8b21" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">I 型方差分析结论为:</strong></p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="ng nh di ni bf nj"><div class="gh gi od"><img src="../Images/7d459fa8039678b1e171d26b78cfc1fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QaKvwNRlecfi8etw3SwROQ.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk">ANOVA table for the Type I Sums of Squares</figcaption></figure><blockquote class="me"><p id="b130" class="mf mg it bd mh mi ny nz oa ob oc kn dk translated">在 I 型平方和中，weekday 被错误地选为最重要的变量，只是因为它在模型中首先被指定。</p></blockquote><h1 id="f6ec" class="lb lc it bd ld le lf lg lh li lj lk ll lm oe lo lp lq of ls lt lu og lw lx ly bi translated">3.第二类平方和</h1><p id="a070" class="pw-post-body-paragraph jq jr it js b jt lz jv jw jx ma jz ka kb mb kd ke kf mc kh ki kj md kl km kn im bi translated">第二类平方和在两个方面采取了不同的方法。</p><ul class=""><li id="ea49" class="nk nl it js b jt ju jx jy kb nm kf nn kj no kn np nq nr ns bi translated">首先，分配给自变量 A 的变化是对 B 的解释，而分配给 B 的变化是对 A 的解释。</li><li id="036b" class="nk nl it js b jt nt jx nu kb nv kf nw kj nx kn np nq nr ns bi translated">第二，第二类平方和没有交互作用的影响。</li></ul><blockquote class="me"><p id="7f3f" class="mf mg it bd mh mi ny nz oa ob oc kn dk translated">如果自变量之间没有交互作用，则应使用第二类平方和。</p></blockquote><p id="00c4" class="pw-post-body-paragraph jq jr it js b jt mo jv jw jx mp jz ka kb mq kd ke kf mr kh ki kj ms kl km kn im bi translated"><strong class="js iu">平方和在数学上定义为:</strong></p><ul class=""><li id="b431" class="nk nl it js b jt ju jx jy kb nm kf nn kj no kn np nq nr ns bi translated">自变量 A 的 SS(A | B)</li><li id="3798" class="nk nl it js b jt nt jx nu kb nv kf nw kj nx kn np nq nr ns bi translated">自变量 B 的 SS(B | A)</li><li id="633f" class="nk nl it js b jt nt jx nu kb nv kf nw kj nx kn np nq nr ns bi translated">无交互效应</li></ul><p id="8165" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">第二类方差分析结果为:</strong></p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="ng nh di ni bf nj"><div class="gh gi oh"><img src="../Images/06275614118cd2582ad727d469254a28.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HBZqy-jyM_AseodIBmCdSQ.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk">ANOVA table for the Type II Sums of Squares</figcaption></figure><blockquote class="me"><p id="b804" class="mf mg it bd mh mi ny nz oa ob oc kn dk translated">在第二类平方和中，天气是唯一重要的变量。这比 I 型平方和好得多。</p></blockquote><h1 id="569e" class="lb lc it bd ld le lf lg lh li lj lk ll lm oe lo lp lq of ls lt lu og lw lx ly bi translated">4.第三类平方和</h1><p id="12a7" class="pw-post-body-paragraph jq jr it js b jt lz jv jw jx ma jz ka kb mb kd ke kf mc kh ki kj md kl km kn im bi translated">第三类平方和也称为部分平方和，这是计算平方和的另一种方法:</p><ul class=""><li id="b4c5" class="nk nl it js b jt ju jx jy kb nm kf nn kj no kn np nq nr ns bi translated">与类型 II 一样，类型 III 的平方和不是连续的，因此说明的顺序并不重要。</li><li id="fb5d" class="nk nl it js b jt nt jx nu kb nv kf nw kj nx kn np nq nr ns bi translated">与第二类不同，第三类平方和确实规定了一种相互作用效应。</li></ul><p id="065a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">平方和在数学上定义为:</strong></p><ul class=""><li id="67f0" class="nk nl it js b jt ju jx jy kb nm kf nn kj no kn np nq nr ns bi translated">独立变量 A 的 SS(A | B，AB)</li><li id="3819" class="nk nl it js b jt nt jx nu kb nv kf nw kj nx kn np nq nr ns bi translated">独立变量 B 的 SS(B | A，AB)</li></ul><p id="3df5" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">III 型方差分析结果为:</strong></p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="ng nh di ni bf nj"><div class="gh gi oi"><img src="../Images/02293fed190420fd8a57842c9ecf4e8b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1qSCGhG3IjYaedPyMnD3wQ.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk">ANOVA table for Type III Sums of Squares</figcaption></figure><blockquote class="me"><p id="b6ea" class="mf mg it bd mh mi ny nz oa ob oc kn dk translated">在第三类平方和中，天气和工作日都很重要。给定我们的示例数据，这似乎是一个可以接受的结果。</p></blockquote><h1 id="476c" class="lb lc it bd ld le lf lg lh li lj lk ll lm oe lo lp lq of ls lt lu og lw lx ly bi translated">5.不同的软件—不同的结果</h1><p id="fd0b" class="pw-post-body-paragraph jq jr it js b jt lz jv jw jx ma jz ka kb mb kd ke kf mc kh ki kj md kl km kn im bi translated">关于使用哪种平方和存在激烈的争论。</p><blockquote class="me"><p id="0d1c" class="mf mg it bd mh mi mj mk ml mm mn kn dk translated">r 给出 I 型，Python 给出 II 型，SAS 给出 III 型。</p></blockquote><p id="f755" class="pw-post-body-paragraph jq jr it js b jt mo jv jw jx mp jz ka kb mq kd ke kf mr kh ki kj ms kl km kn im bi translated">I 型和 II 型在<strong class="js iu"> R 软件</strong>社区更受欢迎。在 R 的<em class="oj"> anova() </em>和<em class="oj"> aov() </em>函数中，平方和的实现类型是类型 I，即顺序计算。对于其他类型的平方和，使用<em class="oj"> car </em>包中的<em class="oj"> Anova() </em>函数，该函数带有一个<em class="oj">类型</em>参数。</p><p id="17a1" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在<strong class="js iu"> SAS 软件社区中，</strong>类型 III 平方和被更多地使用，因为这通常是 SAS 的默认实现。</p><p id="36fe" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在<strong class="js iu"> Python </strong> statsmodels 库中，默认实现是 Type II，但是<em class="oj"> type </em>参数使得使用 Type I 或 Type II 变得非常容易。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="ng nh di ni bf nj"><div class="gh gi ok"><img src="../Images/f47cdaa8ec086fa14bb3575cfa3b8aa8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TSk9b4K0MbnKuok54Wyajg.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk">Default Types of Sums of Squares for different programming languages</figcaption></figure><h1 id="a488" class="lb lc it bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">6.结论:不同的平方和——不同的问题</h1><p id="a34b" class="pw-post-body-paragraph jq jr it js b jt lz jv jw jx ma jz ka kb mb kd ke kf mc kh ki kj md kl km kn im bi translated">仔细观察，每种平方和都给出了划分共享变量的不同方法。在我们的例子中，我们根本不知道哪个答案是正确的，所以我们可以采取多种策略:</p><blockquote class="me"><p id="e54c" class="mf mg it bd mh mi mj mk ml mm mn kn dk translated">只有在理论上有充分理由时才使用 I 型，没有相互作用时使用 II 型，有相互作用时使用 III 型。</p></blockquote><p id="611e" class="pw-post-body-paragraph jq jr it js b jt mo jv jw jx mp jz ka kb mq kd ke kf mr kh ki kj ms kl km kn im bi translated">在类型 I 中，我们选择最“重要”的自变量，它将得到最大可能的变化量。</p><p id="d50f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在类型 II 中，我们忽略了共享变量:没有假设交互作用。如果这是真的，第二类平方和在统计上更有力量。然而，如果在现实中有一个相互作用的影响，该模型将是错误的，将有一个问题的分析结论。</p><p id="8494" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果存在交互作用效应，并且我们正在寻找自变量之间的“相等”分割，则应使用类型 III。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div class="gh gi ol"><img src="../Images/fbd60505ba0d86127d4eb018927744f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1276/format:webp/1*wnwRJ4dG6Sin5PsdgUr9IQ.png"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk">Decision Tree for Different Types of Sums of Squares in ANOVA</figcaption></figure><p id="41f4" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">所以这个综述的结论是:只有在有严肃的理论理由时才使用 I 型，没有相互作用时使用 II 型，有相互作用时使用 III 型。</p><p id="76f6" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><em class="oj">回顾 ANOVA 理论真的很有趣，我希望这些内容能帮助你踏上数据科学之旅。</em> <strong class="js iu"> <em class="oj">感谢阅读！</em> </strong></p></div></div>    
</body>
</html>