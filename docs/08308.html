<html>
<head>
<title>Protect your Deep Neural Network by Embedding Watermarks!</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">通过嵌入水印来保护您的深层神经网络！</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/protect-your-deep-neural-network-by-embedding-watermarks-ed4898ec4ad7?source=collection_archive---------22-----------------------#2019-11-12">https://towardsdatascience.com/protect-your-deep-neural-network-by-embedding-watermarks-ed4898ec4ad7?source=collection_archive---------22-----------------------#2019-11-12</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="80ac" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们对图像、音乐等媒体内容进行知识产权(IP)保护<strong class="js iu">水印</strong>。深度神经网络(DNN)怎么样？</p><h1 id="dad8" class="ko kp it bd kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll bi translated">什么是水印？</h1><p id="0eb5" class="pw-post-body-paragraph jq jr it js b jt lm jv jw jx ln jz ka kb lo kd ke kf lp kh ki kj lq kl km kn im bi translated">水印就像是赋予你的媒体内容的一个身份，例如，你画一个免费的内容并上传到一个媒体平台，你将在内容上签名或者只是在内容上放一些标志。这是为了确认内容是你制作的，使用你内容的人应该付给你一些钱。</p><p id="3e35" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们可以把同样的方法应用到 DNN，因为 DNN 的发展每年都在进步，很多公司开始在他们的业务中使用 DNN。</p><h1 id="e202" class="ko kp it bd kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll bi translated">为什么我们需要在 DNN 上嵌入水印？</h1><p id="49e6" class="pw-post-body-paragraph jq jr it js b jt lm jv jw jx ln jz ka kb lo kd ke kf lp kh ki kj lq kl km kn im bi translated">假设你已经投入了大量资源(例如时间、GPU)来创建强大的模型，然后你将它发布到你的 github 库，但是现在一些坏人未经你同意就拿着你的模型做生意，你发现坏人使用了你的模型，但是你没有证据，因为模型上没有水印。就像免费内容如何在网上分享一样，不是所有人都给学分:(</p><p id="8ced" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">还记得三星赔偿苹果侵犯设计专利吗？同一案件可以申请某公司(如 A 公司)起诉其他公司使用 A 公司发布(甚至窃取)的 DNN 而不支付版权费。</p><p id="d878" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">接下来，我们将讨论通过嵌入水印来保护 DNN 的常用方法。</p><h1 id="e060" class="ko kp it bd kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll bi translated">白盒方法</h1><p id="8dc1" class="pw-post-body-paragraph jq jr it js b jt lm jv jw jx ln jz ka kb lo kd ke kf lp kh ki kj lq kl km kn im bi translated">有很多方法使用白盒方法，我将谈论最简单的方法，而其他方法是类似的过程，只是不同的嵌入方式。</p><h2 id="bdb7" class="lr kp it bd kq ls lt dn ku lu lv dp ky kb lw lx lc kf ly lz lg kj ma mb lk mc bi translated">白盒嵌入</h2><p id="88f1" class="pw-post-body-paragraph jq jr it js b jt lm jv jw jx ln jz ka kb lo kd ke kf lp kh ki kj lq kl km kn im bi translated">为了通过嵌入水印来保护 DNN 模型，在由[1]建议的方法中，他们使用变换矩阵来执行水印嵌入。</p><p id="9714" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在训练阶段，模型是在原始分类任务上进行训练，然而，模型还有一个目标，即<strong class="js iu">嵌入水印</strong>。</p><p id="5b36" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">作者首先选择 DNN 中的哪一层来嵌入期望的水印(例如二进制数据)</p><figure class="me mf mg mh gt mi gh gi paragraph-image"><div class="gh gi md"><img src="../Images/b6e6ce38eda4d5e52a65ac35036d1397.png" data-original-src="https://miro.medium.com/v2/resize:fit:1096/format:webp/1*RN_2LtaBbDtNqLDHSSSsrg.png"/></div></figure><p id="024d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">然后，所选层中的<strong class="js iu">权重</strong>将与变换矩阵进行矩阵乘法，以获得所需的信息位数，例如 64 位。</p><figure class="me mf mg mh gt mi gh gi paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><div class="gh gi ml"><img src="../Images/7f24bec3b76b03f77ea44c7f7284cecd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nX3ihPdaRNq0p2b2MCmImA.png"/></div></div><figcaption class="mq mr gj gh gi ms mt bd b be z dk">dot between weights and transformation matrix</figcaption></figure><p id="f14b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在对原始任务(即分类)进行训练时，权重和变换矩阵都将通过作者设计的损失函数(即正确嵌入 64 位信息的损失函数)来更新</p><h2 id="ea42" class="lr kp it bd kq ls lt dn ku lu lv dp ky kb lw lx lc kf ly lz lg kj ma mb lk mc bi translated">白盒检测</h2><p id="e8ee" class="pw-post-body-paragraph jq jr it js b jt lm jv jw jx ln jz ka kb lo kd ke kf lp kh ki kj lq kl km kn im bi translated">对于大公司来说，他们可能会从各个地方收集证据，这样他们就可以起诉涉嫌非法使用他们 DNN 模型的公司。一旦他们有证据，他们将需要有一个验证过程，即从 DNN 模型中提取水印，并比较水印是否来自大公司。</p><p id="a157" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">他们基本上是在做同样的事情来提取他们在训练中所做的水印。再次执行平坦化权重和变换矩阵之间的点运算，然后提取水印。</p><p id="2b8f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">然而，这个过程是一个白盒验证，这意味着<strong class="js iu">他们需要物理访问模型</strong>，通常可能需要通过执法部门。</p><h1 id="7cdd" class="ko kp it bd kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll bi translated">黑箱方法</h1><p id="7921" class="pw-post-body-paragraph jq jr it js b jt lm jv jw jx ln jz ka kb lo kd ke kf lp kh ki kj lq kl km kn im bi translated">在阅读了一些研究论文[2，3，4]后，我意识到所有论文中的黑盒方法都是相似的。我要讲的例子来自[2]。</p><h2 id="0e59" class="lr kp it bd kq ls lt dn ku lu lv dp ky kb lw lx lc kf ly lz lg kj ma mb lk mc bi translated">黑盒嵌入</h2><p id="cd02" class="pw-post-body-paragraph jq jr it js b jt lm jv jw jx ln jz ka kb lo kd ke kf lp kh ki kj lq kl km kn im bi translated">在培训阶段，培训任务分为两部分:</p><ol class=""><li id="486c" class="mu mv it js b jt ju jx jy kb mw kf mx kj my kn mz na nb nc bi translated">原始分类任务</li><li id="ce7e" class="mu mv it js b jt nd jx ne kb nf kf ng kj nh kn mz na nb nc bi translated">触发设置任务</li></ol><p id="f625" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">什么是触发集任务？<strong class="js iu">这实际上是一份被故意贴错标签的数据清单。</strong></p><figure class="me mf mg mh gt mi gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/92d91d88db12f0b06d24fbdb0716a99e.png" data-original-src="https://miro.medium.com/v2/resize:fit:558/format:webp/1*r3UcdmdxhNOojhL8xfkMdA.png"/></div><figcaption class="mq mr gj gh gi ms mt bd b be z dk">Example trigger set data wrongly labelled</figcaption></figure><p id="47a5" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">错误标记的数据是一种水印，目的是让模型“记忆”准确的输入和标记，这种记忆形成了水印嵌入效果。<strong class="js iu">虽然它可能会影响模型的特征学习</strong>，但是在【3】中有一些替代方案。</p><p id="aa4f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">错误标记的数据与原始数据集</strong>结合，然后将经过原始训练目标(如交叉熵)</p><h2 id="c897" class="lr kp it bd kq ls lt dn ku lu lv dp ky kb lw lx lc kf ly lz lg kj ma mb lk mc bi translated">黑盒检测</h2><p id="c58d" class="pw-post-body-paragraph jq jr it js b jt lm jv jw jx ln jz ka kb lo kd ke kf lp kh ki kj lq kl km kn im bi translated">这种水印嵌入方式在验证方面实际上优于白盒嵌入方式。这是因为您<strong class="js iu">可以将一个触发集数据列表作为查询</strong>提交给机器学习在线服务<strong class="js iu">(例如，小偷偷了您的模型并创建了一个与您的相似的服务)</strong></p><figure class="me mf mg mh gt mi gh gi paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><div class="gh gi nj"><img src="../Images/5640fc183ca81da624bef703b8edf574.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bg-xKABuCWa6F9ATjruL7g.png"/></div></div><figcaption class="mq mr gj gh gi ms mt bd b be z dk">a typical black-box verification</figcaption></figure><p id="75c2" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在通过 API 调用查询 ML 在线服务之后，您将得到预期的标签。如果预期标签与原始错误标签匹配，那么您可以确认该 ML 在线服务正在使用您的模型<strong class="js iu">，因为在您的触发集数据上不可能有精确匹配(或高精度)。</strong>如果一个模特不是从你那偷来的，那么这个模特应该能把猫的形象归类为猫，而不是狗。</p><h1 id="78d2" class="ko kp it bd kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll bi translated">结论</h1><p id="3afb" class="pw-post-body-paragraph jq jr it js b jt lm jv jw jx ln jz ka kb lo kd ke kf lp kh ki kj lq kl km kn im bi translated">我们需要保护我们的 DNN 模式，以防其他人窃取我们的信用而不付钱给我们！我们可以进行黑盒验证，以便对小偷有一个初步的嫌疑人，然后在我们向警方报告后，我们可以通过执法部门进行白盒验证。(虽然我认为这只是大公司之间的战争😅)</p><p id="ea75" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">希望现在你对在 DNN 中嵌入水印有了更多的了解。感谢您的阅读！</p><h1 id="33c7" class="ko kp it bd kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll bi translated">参考</h1><p id="6be6" class="pw-post-body-paragraph jq jr it js b jt lm jv jw jx ln jz ka kb lo kd ke kf lp kh ki kj lq kl km kn im bi translated">[1]将水印嵌入深度神经网络。<a class="ae nk" href="https://arxiv.org/abs/1701.04082" rel="noopener ugc nofollow" target="_blank">https://arxiv.org/abs/1701.04082</a></p><p id="b1ea" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">[2]化弱为强:通过走后门给深度神经网络加水印。<a class="ae nk" href="https://arxiv.org/abs/1802.04633" rel="noopener ugc nofollow" target="_blank">https://arxiv.org/abs/1802.04633</a></p><p id="6cd5" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">[3]利用水印技术保护深度神经网络的知识产权。https://dl.acm.org/citation.cfm?id=3196550<a class="ae nk" href="https://dl.acm.org/citation.cfm?id=3196550" rel="noopener ugc nofollow" target="_blank"/></p><p id="8f16" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">[4] DeepSigns:保护深度学习模型所有权的通用水印框架。【https://arxiv.org/abs/1804.00750 T4】</p></div></div>    
</body>
</html>