<html>
<head>
<title>A Common Data Science Mistake: Prediction/Recommendation by Manipulating Model Inputs</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">一个常见的数据科学错误:通过操纵模型输入进行预测/推荐</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/a-common-data-science-mistake-prediction-recommendation-by-manipulating-model-inputs-f7eac2d12a84?source=collection_archive---------16-----------------------#2019-01-20">https://towardsdatascience.com/a-common-data-science-mistake-prediction-recommendation-by-manipulating-model-inputs-f7eac2d12a84?source=collection_archive---------16-----------------------#2019-01-20</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/9d29d4a4fde85ecc32180a8bf5a76f1c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*i2Dcj4Heirqm-Bvg4OqJDw.png"/></div></div></figure><p id="53bb" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">“我们训练了一个高性能的机器学习模型。然而，这并不奏效，在实践中也没有用。”这句话我听过好几次，每次都急于找出原因。一个模型在实践中失败可能有不同的原因。由于这些问题通常不会在数据科学课程中解决，因此在本文中，我将解决设计和部署机器学习模型时的一个常见错误。</p><p id="91dd" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在本文的其余部分，首先，我将讨论导致机器学习模型误用的相关性和因果性之间的混淆。我将用一个例子来说明这个讨论。之后，显示了模型的输入和输出之间的不同可能性。最后，我提供一些建议来避免这个错误。</p><h1 id="cffa" class="kw kx iq bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">相关性而非因果关系</h1><p id="0d0b" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">将相关性误认为因果关系会导致错误的结果。混淆相关性和因果关系的一个例子是对魔鬼经济学的分析，伊利诺伊州给学生发了书，因为分析显示，家里有书与高分直接相关。然而，现实是，父母通常买书的房子有一个令人愉快的学习环境。进一步的分析显示，那些家里有几本书的学生在学业上表现更好，即使他们从未读过这些书。事实上，获得更高的分数并不是书本的结果，而是环境的结果。</p><p id="6f8d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">回到我们的主题，在您开发一个模型之后，您不能操作输入参数(特征)来查看对输出的影响。原因是输入要素可能是输出的结果，而不一定是输出的原因。高性能机器学习模型告诉你的是，输入和输出之间存在相关性。您无法调整输入以获得所需的输出，然后根据调整后的输入提供建议。</p><h1 id="4a4f" class="kw kx iq bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">例子</h1><p id="da8e" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">这里有一个例子，我们开发了一个回归模型，但该模型提供了一个错误的预测/建议。假设我们有室外温度和室内温度。我们可以开发一个线性回归模型，根据室内温度来估算室外温度。</p><p id="f59c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><em class="lz"> T(外)= C1*T(内)+C2 </em></p><p id="6b3b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">其中<em class="lz"> C1 </em>和<em class="lz"> C2 </em>是从数据中导出的常系数。假设该模型具有非常高的性能(例如，超过 99%)。</p><p id="e9a5" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">通过使用该模型，我们发现如果室内温度增加 5C，室外温度将增加 10C。我们能为房间买一个加热器并提高室内温度来享受温暖的一天吗？？！！当然不是。原因是内部温度是结果，而不是原因。当数据科学家操纵模型的输入(例如内部温度)以获得期望的输出(例如外部温度)时，也会发生同样的事情。基于操纵输入的建议在实践中通常是无用的。</p><h1 id="b989" class="kw kx iq bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">投入产出关系</h1><p id="48a1" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">现在，让我们看看当特征之一<em class="lz"> A </em>和输出<em class="lz"> B </em>之间存在相关性时的不同情况。下图显示了不同的情况。</p><figure class="mb mc md me gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ma"><img src="../Images/f9326235cb5de24fb8bc75bce7a15866.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fGg3k813Fvgg975kTtBrQg.png"/></div></div><figcaption class="mf mg gj gh gi mh mi bd b be z dk"><em class="mj">Case 1: A causes B. Manipulating A affects B in the real world.</em></figcaption></figure><figure class="mb mc md me gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mk"><img src="../Images/08d7015a5bce786a394ecf30dcd708c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WJ30Q7bFbVF1ZsYF6VBYJg.png"/></div></div><figcaption class="mf mg gj gh gi mh mi bd b be z dk"><em class="mj">Case 2: B causes A. Manipulating A does not affect B in the real world.</em></figcaption></figure><figure class="mb mc md me gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ma"><img src="../Images/014e3d1e7044586fdb75ec90647d076c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ANWQv5xn1ghoyqyl5xeqkw.png"/></div></div><figcaption class="mf mg gj gh gi mh mi bd b be z dk"><em class="mj">Case 3: A causes B and B causes A. Manipulating A affects B but it is not a direct effect.</em></figcaption></figure><figure class="mb mc md me gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mk"><img src="../Images/6e472c27b869469180358ddf8ac7af1d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*chaaq5IEyQw80uO7-0BOaQ.png"/></div></div><figcaption class="mf mg gj gh gi mh mi bd b be z dk"><em class="mj">Case 4: A and B are consequences of a common cause C. Manipulating A does not affect B.</em></figcaption></figure><p id="2357" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">很明显，在情况 2、3 和 4 中，模型的输出对于<em class="lz"> A </em>的操纵值与我们在现实世界中看到的不同。应该注意的是，即使在情况 1 中，输出也可能不同，因为<em class="lz"> A </em>可能与模型的其他输入具有某种相关性。这意味着当<em class="lz"> A </em>的值改变时，其他输入也会改变。因此，仅更改其中一个输入要素并研究其效果是不正确的。</p><h1 id="be18" class="kw kx iq bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">如何避免？</h1><p id="04c5" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">首先，要意识到这个问题。你应该知道，通过操纵输入，你无法预测输出。记住这一点会影响你如何设计模型，如何选择未来。</p><p id="0c46" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">第二，如果你想设计一个预测模型，你需要有历史数据来告诉你的模型改变输入的影响。通过快照，您无法预测如果输入发生变化会发生什么。在这种情况下，您可以根据历史数据来定型模型。在我们的示例中，当我们想要查看室内温度对室外温度的影响时，我们需要一些样本，包括室内温度的变化及其对室外温度的影响(例如，1 小时后)。在这种情况下，模型了解到室内温度对室外温度没有影响。</p><p id="1253" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">第三，利用你的领域知识或与专家交谈，看看你的预测/推荐结果是否有意义。这不仅可以避免这个错误，还可以避免其他逻辑错误。例如，您的编码中可能有一些您没有意识到的错误。感觉检查可以帮助您从总体上验证模型。</p><h1 id="a909" class="kw kx iq bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">结论</h1><p id="13cb" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">设计机器学习模型是一项棘手的任务。尽管模型在训练数据上有很高的性能，但在实践中可能不起作用。在本文中，我讨论了机器学习模型的误用，它导致预测在现实世界中不起作用。其他原因可能是过度拟合、重复样本和无偏数据。利用你的领域知识或与一些专家交谈，看看你的预测/推荐结果是否有意义，这总是好的。</p><p id="ec94" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果您有任何问题或意见，请在下面留下您的反馈，或者您可以随时通过<a class="ae ml" href="https://www.linkedin.com/in/aminsadri/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>联系我。</p></div></div>    
</body>
</html>