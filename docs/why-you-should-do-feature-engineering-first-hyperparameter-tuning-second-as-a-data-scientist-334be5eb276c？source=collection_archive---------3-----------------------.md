# 作为一名数据科学家，为什么应该首先进行功能工程，然后进行超参数调整

> 原文：<https://towardsdatascience.com/why-you-should-do-feature-engineering-first-hyperparameter-tuning-second-as-a-data-scientist-334be5eb276c?source=collection_archive---------3----------------------->

![](img/908c5ca06b0f3ef7bdc1f079261827d4.png)

事实上，特征工程比超参数调整更重要的认识对我来说是一个教训——**一个觉醒和重要的教训**——它彻底改变了我处理问题和处理数据的方式，甚至在建立任何机器学习模型之前。

当我第一次开始我的第一份全职工作时，我是机器学习领域的研究工程师，我非常兴奋，沉迷于构建花哨的机器学习模型，而没有真正关注我拥有的数据。

**事实上，我很不耐烦。**

我太想要结果了，以至于我只关心从我的模型中榨取每一个百分比的性能。不用说，我尝试了这么多次都失败了，想知道为什么。

> “你应该更专注于获得好的特性**(特性工程)**，而不是优化你的模型的超参数**(超参数调整)**。你看…如果你没有模型可以学习的好的特征，即使你有最佳的超参数，它也不会提高你的模型的性能，”
> 
> —我的一个团队成员这样对我说。

从那一刻起，我知道有些事情必须改变——我的方法必须改变，我的心态必须改变，以接受别人的意见，实际上是一切。

一旦我试图理解我试图解决的实际业务问题和我拥有的数据，我就添加一些新的特性来更好地表示问题，以便模型可以有效地学习底层模式。

结果？

与使用超参数调整很少或没有改善相比，我设法显著改善了模型的 [AUC](https://stats.stackexchange.com/questions/132777/what-does-auc-stand-for-and-what-is-it) (这是一个分类问题)。

这就是我如何学会特征工程的重要性的，艰难的方式。并且希望和大家分享一下特征工程和超参数调优的重要性。

在本文结束时，我希望您能够理解为什么特性工程比超参数调优更重要，并在进入调优部分解决您的问题之前使用这种方法。

> 记住。如果你愿意倾听，数据会和你说话。

我们开始吧！

# 特征工程的重要性

我记得当我第一次开始学习数据科学的东西时，功能工程并不总是书籍和在线课程的主题。

这给了我一个错误的印象，也许特征工程在应用机器学习解决问题方面并不那么重要。

在讲什么是特征工程及其重要性之前。让我们退一步，试着理解机器学习模型是如何工作的。

**机器学习模型如何工作？**本质上，机器学习模型只是一种算法，通过对历史数据进行训练来学习 ***【模式】*** ，最终基于看不见的测试数据做出预测。

换句话说，如果数据没有足够的代表性来描述您试图解决的问题，您的模型将无法学习底层的 ***【模式】*** 。这就是特征工程发挥作用的地方。

> **什么是特征工程？**特征工程是将原始数据转化为更好地代表预测模型潜在问题的特征，从而提高未知数据的模型准确性的过程。
> 
> —杰森·布朗利(Jason Brownlee)，一位出色的机器学习实践者，他创立了[机器学习大师](https://machinelearningmastery.com/)。

尽管模型的性能取决于几个因素——准备的数据和特性、模型在训练中的使用、问题陈述、衡量模型成功的指标等——但优秀的特性仍然是决定模型成功的关键因素。

**特征工程的重要性是什么？**在我看来，虽然你可以聚合数据生成额外的特征(均值和最大值等。)，拥有强大的业务领域知识将让您对您拥有的数据有更多的了解，并基于其相关性和关系生成新的功能。

凭借出色的功能，它为型号选择提供了更大的空间。您可以**选择一个更简单的模型**但仍然能够获得良好的结果，因为您的数据现在更具代表性，并且不太复杂的模型可以轻松地学习底层模式。

最终，特征工程归结为**问题表示**。如果你的数据有很好地代表问题的特征，你的模型很可能会给出更好的结果，因为它已经很好地学习了模式。

就我个人而言，我觉得这篇文章写得很好，非常有助于您开始学习和使用特性工程— [发现特性工程，如何设计特性以及如何擅长它](https://machinelearningmastery.com/discover-feature-engineering-how-to-engineer-features-and-how-to-get-good-at-it/)。看看就知道我什么意思了。

# **超参数调整的重要性**

这里我想说一下超参数调优的重要性，让大家在对比中有一个整体的了解。

> **什么是超参数调谐？**在机器学习中，超参数调整就是为一个学习算法选择一组最优超参数的问题。
> 
> — [维基百科](https://en.wikipedia.org/wiki/Hyperparameter_optimization)

[模型超参数是模型外部的一种配置，其值无法从数据中估计。](https://www.datacamp.com/community/tutorials/parameter-optimization-machine-learning-models)作为一个数据科学家(或者机器学习实践者，不管叫什么名字)，模型超参数对我们来说是未知的。

我们只能通过搜索超参数的离散空间，根据给定的默认值、经验法则或反复试验来找到最佳值。

为了让您更清楚地了解情况，一些超参数是训练神经网络的学习率、支持向量机的 C 和 sigma 值(SVM)，或者 k-最近邻中的 k 值(KNN)。

**超参数调优的重要性是什么？**超参数至关重要，因为它们控制着机器学习模型的整体行为。最终目标是找到超参数的最佳组合，使预定义的损失函数最小化，以给出更好的结果。

不这样做将给出次优的结果，因为模型不收敛并且不能有效地最小化损失函数。

这就像探索一系列的可能性，并试图找到给你最好结果的最佳组合。用于调整超参数的一些常用技术包括 [**网格搜索、随机搜索、贝叶斯优化和其他**](https://en.wikipedia.org/wiki/Hyperparameter_optimization) 。

# **为什么对于数据科学家来说，功能工程比超参数调整更重要？**

![](img/58236980f6bb8ffdde0f56418b00971b.png)

[(Source)](https://unsplash.com/photos/Wj1D-qiOseE)

既然我们已经理解了特征工程和超参数调整的重要性，让我们更深入地了解一下为什么前者比后者更重要。

这并不是说超参数调整不重要，而是说当我们谈论改善模型的性能和最终结果时，这是一个优先事项，特别是在现实生活的业务场景中(我将在后面解释)。

**首先。**我们必须明白，大多数机器学习库中的超参数的默认值足以迎合大多数用例。通常情况下，**很难显著提高性能**。[在 Kaggle，超参数调整非常重要。在现实生活中，这几乎无关紧要。](https://www.quora.com/What-generally-improves-a-models-score-more-on-average-feature-engineering-or-hyperparameter-tuning)

**其次。面对现实吧。超参数调谐**耗时且计算量大**。迭代不同的超参数组合来实现较小的改进需要花费很多时间。更糟糕的是，如果您有大量的数据和复杂的模型，每次迭代都需要大量的资源。**在商业领域，时间就是金钱**。如果寻找最佳超参数所需的努力和时间不能证明最终 ROI(金钱！)，如果给定一组具有很好特性的数据，您的模型对于部署来说足够好，那么很可能根本不需要超参数调整。**

第三个也是最后一个。在现实生活中，由于时间限制，很难同时获得最佳特性和超参数**。因此，要在更短的时间内实现巨大的改进，更明智的选择是首先执行特征工程，以足够好地表示问题，以便模型可以学习和准确预测。只有在我们拥有了出色的特性之后，如果时间允许或者业务环境需要，我们才能考虑调优超参数。这就是为什么特性工程应该放在第一位，超参数调整应该放在第二位的主要原因。**

# 最后的想法

![](img/b2ce804e58f8b8e7d04beab04504ecf2.png)

[(Source)](https://unsplash.com/photos/G5olxxSuHcs)

感谢您的阅读。

通过分享我的错误和学习经验，我希望你已经理解了这两者的重要性，以及为什么在提高你的模型的性能时，特性工程应该是优先考虑的。

如果你想了解更多关于特征工程的知识，以及如何将其应用到你的机器学习问题中，那么这本书就是给你的——[机器学习的特征工程](https://amzn.to/2DnYTVu)。在典型的机器学习课程中，特征工程不是一个正式的主题，因此这本书旨在通过整本书的练习，用几种特征工程技术给你实际的应用。

希望有所帮助！

一如既往，如果您有任何问题或意见，请随时在下面留下您的反馈，或者您可以随时通过 [LinkedIn](https://www.linkedin.com/in/admond1994/) 联系我。在那之前，下一篇文章再见！😄

## 关于作者

[**Admond Lee**](https://www.linkedin.com/in/admond1994/) 目前是东南亚排名第一的商业银行 API 平台 [**Staq**](https://www.trystaq.com) **—** 的联合创始人/首席技术官。

想要获得免费的每周数据科学和创业见解吗？

你可以在 [LinkedIn](https://www.linkedin.com/in/admond1994/) 、 [Medium](https://medium.com/@admond1994) 、 [Twitter](https://twitter.com/admond1994) 、[脸书](https://www.facebook.com/admond1994)上和他联系。

[](https://www.admondlee.com/) [## 阿德蒙德·李

### 让每个人都能接触到数据科学。Admond 正在通过先进的社交分析和机器学习，利用可操作的见解帮助公司和数字营销机构实现营销投资回报。

www.admondlee.com](https://www.admondlee.com/)