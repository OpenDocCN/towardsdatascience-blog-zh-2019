<html>
<head>
<title>How to use Selenium as life-saver when dealing with boring tasks</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在处理无聊任务时使用硒作为救命稻草</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-use-selenium-as-life-saver-when-dealing-with-boring-tasks-ca264d1ce88?source=collection_archive---------18-----------------------#2019-10-05">https://towardsdatascience.com/how-to-use-selenium-as-life-saver-when-dealing-with-boring-tasks-ca264d1ce88?source=collection_archive---------18-----------------------#2019-10-05</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="aa80" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">以 Selenium 的方式自动化永无止境的重复任务</h2></div><p id="4a3a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果您是一名开发人员，那么您可能不需要介绍 selenium。Selenium 是一个强大的工具，用于与 web 服务器交互，以编程的方式处理请求。它用于自动执行各种各样的任务，包括与远程 web 服务器的交互。在本文中，我将通过一个简单的例子来演示它的强大用法。</p><p id="3538" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我们考虑使用在线服务从扫描图像样本中自动提取文本的任务，称为光学字符识别(OCR)。该过程包括以下步骤。</p><ol class=""><li id="ac35" class="lb lc iq kh b ki kj kl km ko ld ks le kw lf la lg lh li lj bi translated">从本地存储器上传图像。</li><li id="2ffa" class="lb lc iq kh b ki lk kl ll ko lm ks ln kw lo la lg lh li lj bi translated">启动 OCR 提取过程</li><li id="e941" class="lb lc iq kh b ki lk kl ll ko lm ks ln kw lo la lg lh li lj bi translated">等待文本提取完成</li><li id="aa2e" class="lb lc iq kh b ki lk kl ll ko lm ks ln kw lo la lg lh li lj bi translated">找到文本元素并检索</li><li id="befd" class="lb lc iq kh b ki lk kl ll ko lm ks ln kw lo la lg lh li lj bi translated">将它写在 txt 文件中</li></ol><p id="b64c" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我正在使用<a class="ae lp" href="https://www.newocr.com/" rel="noopener ugc nofollow" target="_blank"> newocr </a>在线 ocr 服务进行任务演示。当我们一步一步地看代码时，我会解释正在做什么。代码是用 python 写的，但是没有 python 知识的读者也能理解这里讨论的概念。我已经挑选了一个样本扫描图像。让我们来看看样本图像。</p><figure class="lr ls lt lu gt lv gh gi paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="gh gi lq"><img src="../Images/e37b3675f9476b2af1a1954a3bcbc9a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xtvoBHq0z0MODlE-MVPbbw.png"/></div></div></figure><h1 id="0b04" class="mc md iq bd me mf mg mh mi mj mk ml mm jw mn jx mo jz mp ka mq kc mr kd ms mt bi translated">1.导入所需的库</h1><figure class="lr ls lt lu gt lv"><div class="bz fp l di"><div class="mu mv l"/></div></figure><p id="8c1a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir"> webdriver </strong> —与服务器交互的 Selenium 驱动类对象</p><p id="6ce3" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir"> WebDriverWait </strong> —暂停执行一段时间的功能</p><p id="98d4" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">预期条件</strong> —等待条件通过</p><p id="8333" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">超时异常</strong> —用于处理因服务器响应延迟而导致的错误</p><p id="a00f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir"> By </strong> —用于指定要查找的元素类型</p><p id="347e" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir"> ChromeDriverManager </strong> —用于启动浏览器的 Chrome 版本</p><figure class="lr ls lt lu gt lv"><div class="bz fp l di"><div class="mu mv l"/></div></figure><p id="cc69" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">列出文件名以'结尾的所有文件。工作目录中的 jpeg' (jpeg 图像)。此外，你应该会看到一个 Chrome 浏览器自动启动，并登陆到 Newocr 主页。</p><p id="28b1" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">注意</strong>:如果 chromedriver.exe 在 executable_path 中不可用，那么您将遇到“<strong class="kh ir">web driver exception”</strong>这意味着驱动程序存储在其他地方或者驱动程序不存在。如果 chromedriver.exe 不存在，下载它并指定位置的完整路径。</p><h1 id="4608" class="mc md iq bd me mf mg mh mi mj mk ml mm jw mn jx mo jz mp ka mq kc mr kd ms mt bi translated">2.找到元素标签</h1><p id="af95" class="pw-post-body-paragraph kf kg iq kh b ki mw jr kk kl mx ju kn ko my kq kr ks mz ku kv kw na ky kz la ij bi translated">对于每个动作，我们希望 selenium 在元素上执行，我们需要提供相应的元素路径。元素路径是指向 HTML 文档中给定标签的东西。这样做背后的想法是，我们要求 Selenium 在给定的位置标记并对其执行指定的操作。按照下面显示的步骤获取元素路径。</p><figure class="lr ls lt lu gt lv gh gi paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="gh gi nb"><img src="../Images/cbfffa20bace7ab43b552c8a40c3a48a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*S5jPgid4XdSVunG55TarSg.gif"/></div></div></figure><p id="7085" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">有许多方法可以定位元素，“CCS 选择器”是其中之一。一旦你做了上面的步骤，CSS 选择器的元素就会被复制到剪贴板上。然后使用这个选择器来定位元素。下面是从图像中提取文本的代码片段。</p><figure class="lr ls lt lu gt lv"><div class="bz fp l di"><div class="mu mv l"/></div></figure><p id="57ba" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">上面的代码片段做了以下事情:</p><ol class=""><li id="f2c5" class="lb lc iq kh b ki kj kl km ko ld ks le kw lf la lg lh li lj bi translated">找到“选择文件”按钮并发送图像文件的完整路径</li><li id="0a95" class="lb lc iq kh b ki lk kl ll ko lm ks ln kw lo la lg lh li lj bi translated">找到“预览”按钮，并执行触发上传过程的点击操作。</li><li id="6016" class="lb lc iq kh b ki lk kl ll ko lm ks ln kw lo la lg lh li lj bi translated">等待，直到“#ocr”元素出现，这意味着上传过程已完成，但不会超过 25 秒。</li><li id="fb93" class="lb lc iq kh b ki lk kl ll ko lm ks ln kw lo la lg lh li lj bi translated">一旦元素“#ocr”出现，就执行触发文本提取过程的点击动作。</li><li id="d2bb" class="lb lc iq kh b ki lk kl ll ko lm ks ln kw lo la lg lh li lj bi translated">等待提取完成。</li><li id="504c" class="lb lc iq kh b ki lk kl ll ko lm ks ln kw lo la lg lh li lj bi translated">定位检索到的文本元素，然后复制结果并存储在变量“txt”中。</li></ol><p id="9127" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我们付诸行动吧。</p><figure class="lr ls lt lu gt lv gh gi paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="gh gi nb"><img src="../Images/c2d97e44034311bde60b0e63fb15bbbb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*yGe0WXHw-KFPOomsB3uxDw.gif"/></div></div></figure><p id="99f4" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">您可能想知道手动执行过程是否比编程更容易，为什么要编写代码。想象一下你自己处于这样一种情况，你必须处理 100 张图像来从中提取文本，这是一个繁琐的过程。在这种情况下，硒可能是救命稻草。当你在办公室自助餐厅和同事聊天、喝咖啡时，Selenium 会让你的机器完成工作。让我们看看它是怎么做的。</p><figure class="lr ls lt lu gt lv"><div class="bz fp l di"><div class="mu mv l"/></div></figure><p id="642f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">该代码循环遍历每个图像，并应用前面讨论过的操作。对样本图像运行的代码片段产生以下结果。</p><pre class="lr ls lt lu gt nc nd ne nf aw ng bi"><span id="158e" class="nh md iq nd b gy ni nj l nk nl">Output from the Sample_1.jpeg :</span><span id="d076" class="nh md iq nd b gy nm nj l nk nl">In 1830 there were Dut twenty-three<br/>miles of railroad in operation in the<br/>United States, and in that year Ken-<br/>tucky took the initial step in the work<br/>weat of the Alleghanies. An Act to<br/>incorporate the Lexington &amp; Ohio<br/>Railway Company was approved by<br/>Gov. Metcalf, January 27, 1830.. {t<br/>provided for the construction and re.</span><span id="12fd" class="nh md iq nd b gy nm nj l nk nl">Output from the Sample_2.jpeg :</span><span id="56a2" class="nh md iq nd b gy nm nj l nk nl">When you skim and scan, you need to cover<br/>everything, even titles, subtitles, side features, and<br/>visuals. That bit of information you need may not be<br/>tidily packaged in a paragraph, so you need to check<br/>the entire page--not just the main body of the text,<br/>there are also many visual clues that help you to<br/>find information. Heads and subheads break up the<br/>text and identify the content of each part. Where<br/>key terms are introduced and defined, they appear<br/>in boldface type. Graphs and charts have titles<br/>and/or captions that tell you what they are about.<br/>These clues will help you to find information. . . but<br/>only if you use them.</span><span id="9c1f" class="nh md iq nd b gy nm nj l nk nl">Output from the Sample_3.jpeg :</span><span id="77c0" class="nh md iq nd b gy nm nj l nk nl">irks Scan</span><span id="93f5" class="nh md iq nd b gy nm nj l nk nl">Tris scanning meusures the iris pattern in the cotored part of the eye,<br/>although the iris color has nothing to do with the biornetric. tris<br/>patterns are formed randomly. As a result, the iris patterns in your<br/>left and right eyes are different, and so are the iris patterns of identi-<br/>cal twins, Iris scan templates ure typically around 256 bytes. bis<br/>scanning can be used quickly for both identification and verification<br/>applications because of its large number of degrees of freedom, Cur-<br/>Tent pilot programs and applications include ATMs (“Eye-TMs"),<br/>grocery stores (for checking out), and the Charlotte/Douglas Inter-<br/>national Airport (physical access}. During the Winter Otympics in<br/>Nagano, Japan, an iris scanning identification system controlled<br/>access to the rifles used in the biathlon.</span></pre><p id="9e2a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">感谢您的阅读。</p></div></div>    
</body>
</html>