# 通过数据驱动的体育博彩策略“赚大钱”

> 原文：<https://towardsdatascience.com/making-big-bucks-with-a-data-driven-sports-betting-strategy-6c21a6869171?source=collection_archive---------0----------------------->

## [**深度剖析**](https://medium.com/towards-data-science/in-depth-analysis/home)

## *或者如何在自己的号码上击败庄家*

![](img/1f5cbdb6d19bc6d69c7c1bea7545dd69.png)

[pixabay](https://pixabay.com/de/photos/roulette-tisch-chips-kasino-spiel-2246562/)

几个月前，我开发了一个 ML-free 算法，用一个简单的泊松过程来预测英超联赛的结果。该程序的跟踪记录比我想象的更令人印象深刻，在第一轮比赛中正确预测了 7/10 场比赛的结果(其中 3 场比赛有确切的比分)。

![](img/8a11d777f1e3769d9908838ca8d1d24e.png)

所以我完成了这个项目，把它放在一边，专注于我的功课。

我上周末看了阿森纳和曼联的比赛，在这场比赛中，主队被普遍认为是失败者。

![](img/ce28cc2438e1f37cf331b1f8c9abe08d.png)

Image by author. Screenshot from Google.

出乎所有人的意料，阿森纳队名列榜首。任何一种情况都有可能发生。联队在上半场两次击中门柱。但是，在这个混乱的赛季中，大卫·德基对查卡突然转身射门的罕见误判和慷慨的点球又增加了一个不可预测的结果。

我有没有提到托特纳姆热刺队在同一个周末被南安普顿队击败了？

随着英超联赛另一轮令人惊讶的结果的展开，我一直在思考我开发的算法。它能在一致的基础上正确预测结果吗？在这个模型中有一些内在的随机性，但这足以成为 PL 诱人的泰然自若的因素吗？在那里，降级区南安普顿队击败了全明星热刺队。

> 所以我决定把它带回来重新测试。

# **1。对抗专家的算法**

测试一个算法的困难之一是找到一个好的性能基准。比方说，如果我的预测在 200 次匹配中有 50%的准确率，那么它是好的、坏的还是平庸的？这肯定比随机猜测要好(赢、平、输的概率都是 1/3)，但听起来没那么好，不是吗？

> 把我的结果和职业足球专家比较怎么样？

所以我发现，每周，天空体育网站都会发布一个由保罗·默森[【1】](https://www.skysports.com/football/news/15205/11657461/paul-mersons-predictions-arsenal-vs-manchester-united-chelsea-vs-wolves-and-more)对那周比赛的预测，他是一位前阿森纳球员，后成为赢得过几个冠军的权威人士。

老实说，我不是保罗·默森的忠实粉丝，因为我认为他对他的前俱乐部进行了无情的批评。

听听阿森纳前主教练温格对他的评价:

> 我听到的这些辩论是一个笑话，一场闹剧。管理零场比赛的人，他们教每个人你应该如何表现。简直是闹剧。

尽管如此，这对我来说是一个金矿，因为我现在可以将我的算法与“专家”进行比较。不管你对他有什么看法，一个前阿森纳球员对阿森纳对曼联比赛的预测肯定会比一个随机产生数字的模糊模型更可靠。

![](img/806b0ecf1c786cb1eaa2347b5fab561d.png)

The confusion matrix that shows how accurate Merson’s and my algorithm’s predictions are, over 273 matches. Left: Merson’s correctly predicts 150 matches or 54.9%. Right: The Poisson process algorithm got 51+7+117 = 175 matches, a whopping 64.1%

在这里，我比较了默森预测的本赛季 273 场比赛的结果。他达到了 54.9%的准确率(T1)，而我的泊松过程算法达到了令人惊讶的 64.1%的准确率(T3)。

有趣的是，默森预测了阿森纳和曼联之间的 2-2 平局，他说“*两队将会相互较量，并且会有进球。*“我的算法，通过平均阿森纳主场的进球数和失球数，给阿森纳分配了 45%的微弱优势和获胜概率，相比之下，曼联为 27%。

# **2。从预测到体育博彩**

结果让我大吃一惊。超过专家意见 10%的优势是巨大的。除了让心爱的泊松过程剔除数字之外，我甚至不用做太多事情。

这是我开始研究体育博彩的时候。而我进入新游戏对阵新对手: ***是我对阵庄家*** 。

# 3.理解书签:赔率是如何工作的？

如果你曾经认为你信用卡上的条款和报价很复杂，试着去那些博彩网站试试。他们简直是疯了。

以美国的赔率为例。如果你看到一个+300 的赔率，这意味着如果你赌 100 并且赢了，你的收益是 300 美元。这很好，但是他们有负赔率，比如 150 的赔率。*搞什么@#*！$%那是？*这意味着为了赚取 100 美元的利润，你需要下 150 美元的赌注。因此，美国赔率是一个大于或等于 100 的数字，有时前面加一个+,表示这个数字是你的利润，有时前面加一个——表示你赢得 100 美元需要下注的金额。

> 我的意思是，他们仍然使用英尺和华氏温度

![](img/aef9cc556b7fe162a406cce8d138bcc7.png)

为了这个项目的目的，我们将使用一个更好的系统:**欧洲赔率**。很简单:他们告诉我，如果我赌 1 美元，我会赢回多少钱。例如， *Bet365* 给出阿森纳击败曼联的赔率为 2.4，平局为 3.6，马努获胜为 3。这意味着，如果我为阿森纳下了 1 美元的赌注，我的口袋里会有 2.4 美元(1.4 美元的利润)。

# **4。肮脏的小秘密**

但是事情并不总是美好而简单的。实际上，为了实现利润最大化，博彩公司雇佣数据科学家团队来分析几十年的体育数据，并开发高度准确的模型来预测体育赛事的结果，并给出对他们有利的赔率。

让我们假设博彩公司的赔率是各个球队赢、平或输的概率的完美反映。因此，对于阿森纳和曼联的比赛，由于阿森纳获胜的赔率是 2.4，所以他们获胜的概率是 1/2.4 = 41.6%，出乎意料地接近我预测的 45%。同样，曼联获胜的概率是 1/3.0 = 33.3%，平局的概率是 1/3.6 = 27.8%。

> 等一下！！！

41.6% + 33.3% + 27.8% = 102.7%! ***真是奇怪(没有双关语！！！)***

概率加起来不是 100%的原因是**几率不公平**。那多出来的 2.7%就是**庄家的优势**。为了得到真实的概率，我们需要通过除以 102.7 来修正利润。所以博彩公司认为阿森纳获胜的真实概率是 41.6/102.7 = 40.5%，曼联获胜的概率是 33.3/102.7 = 32.5%，平局的概率是 27.8/102.7 = 27.06%。对于一个完全有效的博彩公司来说，这些是每种结果的概率。

现在，这是一件有趣的事情:如果赔率完美地反映了现实，那么我赌哪个结果并不重要——我的*预期利润*总是一样的。

如果我在阿森纳身上赌 1 美元，我希望能赢回来:

![](img/5e16924713e50cfe92661a5d023ec8b3.png)

如果我为曼联下注，预期利润是一样的:

![](img/e3927a1179d775d938741cfa0632bcb5.png)

而且——你猜对了——如果我赌平局，我希望能赢回 97 美分。平均来说，每下 1 美元赌注，庄家会从我这里拿走大约 3 美分。

# 4.下注策略:

这种理解并没有阻止我试图利用市场中任何潜在的低效率。首先，我设计了一般的下注策略。

*   我列出了 1000 美元的预算，平均分配给前 30 轮英超联赛。所以每个周末我都有大约 33 美元可以下注。
*   对于每场比赛，将通过以下三种方法之一进行预测:(a)保罗·默森预测，(b)我的泊松过程算法，以及(c)等概率随机分配赢、平、输。
*   通过预测，我找到了 6 家在线投注站中**赔率最高的**。这意味着如果我赢了，我会得到最高的利润。这将是我下注的赔率。
*   对于每场比赛，赌注的金额将由凯利标准计算，该标准的工作原理是:你应该只投资你财富的一部分。通过保留一些，你不会以破产告终。最佳分数( *f* )取决于每个单独的赌注:

![](img/5a85b8a9aa4fc4c2fdec700e269664c4.png)

where p* is the probability that the event occurs and x is an odds

在 R 中实现凯利标准非常简单:

在凯利标准的公式中，问题仍然是什么被认为是事件的真实概率( *p** )。*正如我们在前面的部分中所看到的，我们可以对任何特定的博彩公司给出的赔率取倒数，但这不会以很大的优势结束，因为他们倾向于对该公司有利。*然而，如果我们汇总来自许多不同博彩公司的所有赔率，我们应该能更好地反映博彩公司如何看待某个事件的概率，例如阿森纳击败曼联:

![](img/5c79a222685748cd9dddcf85e522acd1.png)

where n is the number of betting houses and xi is a given odds by the house i

![](img/dc2717474c03f2b8655a90c4e044066f.png)

The result of this betting strategy using the Poisson-process prediction for the last Matchweek, Round 30\. This table shows how the max_odd, probabilities of prediction events, Kelly bet fraction, bet_amount are calculated

对于第 30 轮比赛，正确预测了 5 场比赛，从 6 家赌场中选择了最佳赔率，由于我们的下注策略中嵌入了泊松预测，这一轮我们总共**净亏损 0.9 美元或 90 美分**。我们最大的损失来自于切尔西主场对狼队没能抢下 3 分。

# **5。下面是最终结果**

现在，假设我从英超联赛一开始就使用这个策略，让我们看看我们是如何迅速致富的。

我的算法和默森的预测——当结合凯利标准的最大奇数策略时，到第 30 个比赛周结束时，净正回报，泊松过程预测实现了惊人的 **9.1%** 回报，每个比赛周的归一化回报为 **0.3%** 。客观来看，先锋 S & P 500 ETF 的市场价格回报率为**4.6%**【4】。

随机法**第一次迭代净亏 19%** 主要是因为这里那里的几个幸运投注(曼联输给西汉姆)无法弥补大量的烂注(莱斯特，哈德斯菲尔德赢了伊蒂哈德，热刺输给伯恩茅斯，像老实说？).即使我多次重新运行随机预测，也足以说我见过随机方法有正回报的情况不到 10%。

![](img/80a2cf478bcbd13dc5e5650e623c5d21.png)

显然，这种最优泊松模型存在固有风险。以第 24 轮比赛为例，我们净亏损 14 美元。默森和泊松过程模型(还有我！！！)对利物浦、曼城、曼联、切尔西分别拿下莱斯特、纽卡斯尔、伯恩利、伯恩茅斯 3 分非常有信心，提出总赌注 **$19。结果:利物浦和曼联未能全取 3 分，而切尔西和曼城则被击败。都在同一个周末！！！**

# 最后的话:

在你克隆我的 Github 回购协议并为你的体育对冲基金筹集资金之前，我应该明确表示，没有任何担保。你需要一大笔启动资金(我用 1000 美元模拟，但每周我只有 33 美元可以下注)，大量的耐心和冷静的头脑。

如果有的话，这篇文章是一个玩具的例子，你可以做什么。但是博彩公司使得任何人都很难获得可持续的利润。如果博彩公司认为赢的概率是 1/6，那么他会通过将赔率设置为小于 5，也许是 4.6 这样的值来保证他的预期收入减去支出是正的。如果仍然有很多人以 4.6 的赔率下注，那么庄家肯定意识到赢的概率肯定高于他自己的估计，并将赔率调整为 4。很有可能当代码推断出最佳几率时，它已经被修改了。

此外，如果你开始定期盈利，博彩公司可以简单地感谢你的业务，支付你的奖金并取消你的账户。这就是发生在东京大学一个研究小组身上的事情。

> 在我们开始用真钱下注的几个月后，庄家开始严格限制我们的账户。我们的一些赌注被限制在我们可以下注的赌注金额内，庄家有时要求在接受之前对我们的赌注进行“人工检查”

*   *** *重要免责声明:**本文纯粹用作*教育材料，*不得视为法律或财务建议。也不建议打赌或赌博。请注意，体育博彩在美国的几个州是不合法的。

如果你喜欢这篇文章，你可能也会喜欢我的另一篇关于有趣的统计事实和经验法则的文章

*   迪士尼电影是对的——我们都是特殊的，从统计数据上看也是如此
*   [优化生活的统计法则:呼唤效应](/a-statistical-rule-to-optimize-your-life-the-lindys-effect-96d2c75b080d)
*   [规则三:计算尚未发生事件的概率](/the-rule-of-three-calculating-the-probability-of-events-that-have-not-yet-occurred-106144dc2c39)

对于其他深潜分析:

*   [疫情时代的爱情:约会的概率方法](/love-in-the-time-of-pandemic-a-probabilistic-approach-to-dating-ba888880cd12)
*   [贝叶斯统计如何说服我去健身房？](/how-bayesian-statistics-convinced-me-to-hit-the-gym-fa737b0a7ac)
*   [用 Python 构建自己的图书推荐引擎](/building-my-own-2021-book-recommendation-engine-903ea10d5021)

这个项目的完整代码可以在我的 [Github 简介](https://github.com/tuangauss/Various-projects/tree/master/R/EPL)中找到

[1][https://www . sky sports . com/football/news/15205/11657461/保罗-莫森斯-预测-阿森纳-曼联-切尔西-狼队-还有更多](https://www.skysports.com/football/news/15205/11657461/paul-mersons-predictions-arsenal-vs-manchester-united-chelsea-vs-wolves-and-more)

[2] [凯利，J. L.](https://en.wikipedia.org/wiki/John_Larry_Kelly,_Jr.) (1956)。[《信息率新解》](http://www.herrold.com/brokerage/kelly.pdf) (PDF)。 [*贝尔系统技术期刊*](https://en.wikipedia.org/wiki/Bell_System_Technical_Journal) 。**35**(4):917–926。[doi](https://en.wikipedia.org/wiki/Digital_object_identifier):[10.1002/j . 1538–7305.1956 . TB 03809 . x](https://doi.org/10.1002%2Fj.1538-7305.1956.tb03809.x)

[3] [考尼茨](https://arxiv.org/search/stat?searchtype=author&query=Kaunitz%2C+L)，l .等人(2017)。“用他们自己的数字击败博彩公司——以及在线体育博彩市场是如何被操纵的”(PDF)。阿尔维克斯

[4][https://advisors . vanguard . com/web/C1/Fas-investment products/VOO/performance](https://advisors.vanguard.com/web/c1/fas-investmentproducts/VOO/performance)