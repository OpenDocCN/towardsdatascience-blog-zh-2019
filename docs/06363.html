<html>
<head>
<title>Building own Logistic Classifier in R [Logistic Trilogy, Part 2]</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">åœ¨ R ä¸­æ„å»ºè‡ªå·±çš„é€»è¾‘åˆ†ç±»å™¨[é€»è¾‘ä¸‰éƒ¨æ›²ï¼Œç¬¬ 2 éƒ¨åˆ†]</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://towardsdatascience.com/building-own-logistic-classifier-in-r-logistic-trilogy-part-2-a36be209d2c?source=collection_archive---------25-----------------------#2019-09-12">https://towardsdatascience.com/building-own-logistic-classifier-in-r-logistic-trilogy-part-2-a36be209d2c?source=collection_archive---------25-----------------------#2019-09-12</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="3590" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">å¦‚æœæœ‰äººä»ä¸ºæ•°æ®ç§‘å­¦é¡¹ç›®æˆ–ç»Ÿè®¡é¡¹ç›®å¼€å‘è‡ªå·±çš„ä»£ç ä¸­è·å¾—äº†å·¨å¤§çš„ä¹è¶£ï¼Œé‚£ä¹ˆè¿™å°±æ˜¯é€‚åˆä»–/å¥¹çš„æ–‡ç« ã€‚</p><p id="0f3f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">ä½ å¯èƒ½åœ¨ Rï¼Œ<br/> <strong class="js iu"> <em class="ko"> glm(y~xï¼Œdataï¼Œfamily=binomial)ä¸­ç”¨è¿‡æˆ–è€…å­¦è¿‡ glm å‡½æ•°ã€‚</em> </strong>å¯¹æä¾›çš„æ•°æ®è¿›è¡Œé€»è¾‘å›å½’æ‹Ÿåˆï¼Œå– y ä¸ºå“åº”å˜é‡ï¼Œx ä¸ºé¢„æµ‹å˜é‡ã€‚ä½†ä½ æœ‰æ²¡æœ‰æƒ³è¿‡èƒŒååˆ°åº•å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿå¦‚æœæˆ‘ä»¬èƒ½ç†è§£è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬èƒ½åœ¨ R ä¸­ä¸ºé€»è¾‘æ„å»ºæˆ‘ä»¬è‡ªå·±çš„å‡½æ•°å—ï¼Ÿè®©æˆ‘ä»¬ä¸€èµ·è¯•è¯•ã€‚åªæœ‰ä¸€ä¸ªæ¡ä»¶ï¼Œæˆ‘ä»¬å°†é™åˆ¶è‡ªå·±åªè¿›è¡ŒäºŒå…ƒåˆ†ç±»ã€‚</p><p id="0d65" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">å¼€å‘ä¸€ä¸ªæ¨¡å‹é¦–å…ˆéœ€è¦ä»€ä¹ˆï¼Ÿæ•°æ®ï¼Œåˆ†æä¸­æœ€é‡è¦çš„éƒ¨åˆ†ã€‚æˆ‘ä»¬éœ€è¦ä¸€ä¸ªå¯ä»¥æ˜¯ 1 æˆ– 0 çš„å“åº”å˜é‡ Y å’Œ p ä¸ªé¢„æµ‹å˜é‡ X1ï¼ŒX2ï¼Œâ€¦ï¼ŒXpã€‚å‡è®¾è§‚å¯Ÿæ€»æ•°ä¸º nã€‚æ¯ä¸ªæ¨¡å‹éƒ½æœ‰ä¸€äº›å‡è®¾ï¼Œ</p><p id="5e8f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">ä¸€èˆ¬æ¥è¯´ï¼Œå‡è®¾æ˜¯-</p><ol class=""><li id="4400" class="kp kq it js b jt ju jx jy kb kr kf ks kj kt kn ku kv kw kx bi translated">Yi æ˜¯ç‹¬ç«‹çš„ï¼Œå¹¶ä¸”æ¯ä¸ª Yi éµå¾ªå…·æœ‰å‚æ•°<strong class="js iu"> pi </strong>çš„ä¼¯åŠªåˆ©åˆ†å¸ƒ</li><li id="48c3" class="kp kq it js b jt ky jx kz kb la kf lb kj lc kn ku kv kw kx bi translated">é¢„æµ‹å› å­ X1ï¼ŒX2ï¼Œâ€¦Xp æ˜¯ä¸ç›¸å…³çš„</li></ol><p id="4232" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">åœ¨é€»è¾‘æ¡†æ¶ä¸‹ï¼Œå‡è®¾æ˜¯<strong class="js iu"> pi= </strong></p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi ld"><img src="../Images/073552dd584cf350e2f02ad3a2fb8ea4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YRNQSjRI8ezwWzh0EsVEkw.png"/></div></div><figcaption class="lp lq gj gh gi lr ls bd b be z dk">Logistic Inverse link function (CDF of standard Logistic Distribution)</figcaption></figure><p id="73d0" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">é‚£ä¹ˆå¯èƒ½æ€§å‡½æ•°æ˜¯-</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div class="gh gi lt"><img src="../Images/76c3b064fd278bf25139cd0a0f4edca2.png" data-original-src="https://miro.medium.com/v2/resize:fit:840/format:webp/1*nmQHzxp3RcfsjvdaYjb1Dw.png"/></div></figure><p id="49f1" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">å› æ­¤å¯¹æ•°å¯èƒ½æ€§æ˜¯-</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div class="gh gi lu"><img src="../Images/53535d57430c6fa953e06ac06c3c6d54.png" data-original-src="https://miro.medium.com/v2/resize:fit:982/format:webp/1*VNG9oSSl4bghyUnjWhO1Gg.png"/></div></figure><p id="4fb7" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">ç»è¿‡ç®€åŒ–ï¼Œå®ƒå¯ä»¥å½’ç»“ä¸ºä»¥ä¸‹å†…å®¹(æˆ‘ä¸åŒ…æ‹¬è¿™äº›æ­¥éª¤ï¼Œå› ä¸ºé”®å…¥æ–¹ç¨‹ä»ç„¶æ˜¯ä¸€é¡¹å•è°ƒä¹å‘³çš„ä»»åŠ¡ğŸ˜…)</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div class="gh gi lv"><img src="../Images/c5bfb71440345b53d9135f33c1111de5.png" data-original-src="https://miro.medium.com/v2/resize:fit:912/format:webp/1*uqkkpo_CV78O1SzQk-F4_w.png"/></div></figure><p id="1b57" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">å…¶ä¸­Î²æ˜¯ç»´æ•°ä¸º(p+1)Ã—1 çš„å‚æ•°å‘é‡ï¼Œxi æ˜¯ 1Ã—(p+1)é˜¶çš„ç¬¬ I ä¸ªè§‚æµ‹å‘é‡ã€‚é‚£å°±æ˜¯<strong class="js iu"><em class="ko">Xi =ã€1x1i x2i x3iâ€¦xpiã€‘ã€‚</em> </strong>ç°åœ¨æˆ‘ä»¬éœ€è¦è®­ç»ƒçš„æ¨¡å‹æ— éæ˜¯æ ¹æ®æ‰‹å¤´çš„æ•°æ®ä¼°è®¡æœªçŸ¥çš„å‚æ•°ã€‚è™½ç„¶æœ‰å‡ ç§ä¼°è®¡æ–¹æ³•ï¼Œä½†æœ€å¤§ä¼¼ç„¶ä¼°è®¡å› å…¶ç®€å•è€Œè¢«å¹¿æ³›ä½¿ç”¨ã€‚å‚æ•°çš„æœ€å¤§ä¼¼ç„¶æ˜¯</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div class="gh gi lw"><img src="../Images/e6999711faefe9bf053cf518c2424520.png" data-original-src="https://miro.medium.com/v2/resize:fit:648/format:webp/1*zAzuz_EO-ZrxxEIb0nz8EA.png"/></div></figure><p id="ab9b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">è®©æˆ‘ä»¬æ‰¾åˆ°å¯¹æ•°ä¼¼ç„¶å‡½æ•°ç›¸å¯¹äºå‚æ•°å‘é‡çš„ä¸€é˜¶å¯¼æ•°ï¼Œ</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi lx"><img src="../Images/2c8606a12faa982e0932256fe0a2286f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1146/format:webp/1*d3vJbw-j_d0UinVnYkhucg.png"/></div></div></figure><blockquote class="ly"><p id="9a92" class="lz ma it bd mb mc md me mf mg mh kn dk translated">Î²å‘é‡çš„æå¤§ä¼¼ç„¶ä¼°è®¡å¿…é¡»æ»¡è¶³æ¡ä»¶ D=0ã€‚æ˜¯ä¸æ˜¯å¾ˆç¾ï¼Ÿ<br/>æ˜“-çš®åªä¸è¿‡æ˜¯ç”¨çš®é¢„æµ‹æ˜“æ‰€çŠ¯çš„é”™è¯¯ã€‚å®ƒè¡¨æ˜è¯¯å·®å’Œé¢„æµ‹å€¼æ˜¯æ­£äº¤çš„ã€‚åœ¨ç®€å•çº¿æ€§å›å½’çš„æƒ…å†µä¸‹ï¼Œè¿™ä¸æ˜¯ç¬¬ä¸€æ­£è§„æ–¹ç¨‹æ‰€è¯´çš„å—ï¼Ÿ</p></blockquote><p id="976d" class="pw-post-body-paragraph jq jr it js b jt mi jv jw jx mj jz ka kb mk kd ke kf ml kh ki kj mm kl km kn im bi translated">æˆ‘ä»¬ä½¿ç”¨é€»è¾‘å›å½’ï¼Œå› ä¸ºçº¿æ€§å›å½’æ¨¡å‹çš„å‡è®¾åœ¨åˆ†ç±»å“åº”å˜é‡çš„æƒ…å†µä¸‹ä¸æ»¡è¶³ã€‚ä½†æ˜¯æˆ‘ä»¬åˆå›åˆ°äº†çº¿æ€§æ¨¡å‹ã€‚è¿™å°±æ˜¯å›å½’ç†è®ºçš„å¦™å¤„ã€‚çœŸæ˜¯å¤ªç¥å¥‡äº†ã€‚</p><p id="7f42" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">ä½†ä¸å¹¸çš„æ˜¯ï¼Œä¸é‚£ä¹ˆç¥å¥‡çš„æ˜¯ï¼Œä¸Šè¿°æ–¹ç¨‹æ²¡æœ‰å°é—­å½¢å¼çš„è§£ã€‚ğŸ˜¥ğŸ˜¥ğŸ˜¥ğŸ˜¥ğŸ˜¥</p><p id="320b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">æˆ‘ä»¬éœ€è¦ä¸€äº›ä¼˜åŒ–æŠ€æœ¯ã€‚<strong class="js iu">æ¢¯åº¦ä¸‹é™</strong>å’Œ<strong class="js iu">ç‰›é¡¿-æ‹‰å¤«æ£®</strong>æ³•å¯èƒ½æ˜¯åº”ç”¨æœ€å¹¿æ³›çš„ã€‚è¿™é‡Œæˆ‘åšæŒä½¿ç”¨ç‰›é¡¿-æ‹‰å¤«æ£®æ–¹æ³•(è¿™æ ·æˆ‘å°±ä¸éœ€è¦è°ƒæ•´å­¦ä¹ é€Ÿåº¦)ã€‚</p><p id="f7d5" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">æˆ‘ä¸æ‰“ç®—æ·±å…¥ç ”ç©¶ç‰›é¡¿-æ‹‰å¤«é€Šæ–¹æ³•ã€‚ç²—ç•¥åœ°è¯´ï¼Œå®ƒé€šè¿‡å¦‚ä¸‹è¿­ä»£è¿‡ç¨‹æ‰¾åˆ°å‡½æ•° f(x)çš„æ ¹</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div class="gh gi mn"><img src="../Images/ead2f7b2750091dfbbfdd6e3d965cb08.png" data-original-src="https://miro.medium.com/v2/resize:fit:664/format:webp/1*MAFliULcvlOknAbQ15hJ1Q.png"/></div></figure><p id="dc6a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">å¹¶ä¸”å½“ä¸¤ä¸ªè¿ç»­æ­¥éª¤çš„è¾“å‡ºä¹‹é—´çš„å·®å¼‚å˜å¾—å¤ªå°æ—¶ï¼Œæˆ‘ä»¬åœæ­¢ã€‚åœ¨æˆ‘ä»¬çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬éœ€è¦æ‰¾åˆ°å¯¹æ•°ä¼¼ç„¶å‡½æ•°çš„ä¸€é˜¶å¯¼æ•°çš„æ ¹ã€‚</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div class="gh gi mo"><img src="../Images/9ad40a2c00be414035d347ba54cf193d.png" data-original-src="https://miro.medium.com/v2/resize:fit:716/format:webp/1*sdbELm2KM5kJ9PJSM6W1yA.png"/></div></figure><p id="4572" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">ä¸€é˜¶å¯¼æ•°æˆ‘ä»¬å·²ç»æ‰¾åˆ°äº†ï¼ŒäºŒé˜¶å¯¼æ•°æ˜¯</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div class="gh gi mp"><img src="../Images/d7ebdf93aaf87c230b21a18be0b5122d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1004/format:webp/1*uB0XSduN_SnijV64YQIc6g.png"/></div></figure><p id="05b7" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">å®ƒæ‹¥æœ‰å¦ä¸€ç§ç¾ã€‚è¿™ä¸€é¡¹æ€»æ˜¯è´Ÿçš„ï¼Œæˆ–è€…å°±çŸ©é˜µè€Œè¨€ï¼Œå®ƒæ€»æ˜¯è´Ÿå®šçŸ©é˜µã€‚<strong class="js iu">Logit æ¨¡å‹çš„ä¼¼ç„¶å‡½æ•°æ»¡è¶³å…¨å±€å‡¹æ€§ã€‚D=0 çš„è§£æ€»ä¼šä½¿å¯èƒ½æ€§æœ€å¤§åŒ–ã€‚</strong></p><p id="ade4" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">ç”±äºæˆ‘ä»¬è¦å¤„ç†ä¸æ­¢ä¸€ä¸ªé¢„æµ‹å€¼ï¼Œè®©æˆ‘ä»¬æ‰¾å‡ºä¸Šè¿°é‡çš„çŸ©é˜µå¯¹åº”é¡¹ï¼Œ</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div class="gh gi mq"><img src="../Images/5e862f6754ad96a2ebe6cc687942a44a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1040/format:webp/1*HINTdBsFXpUPJl-UJxnAwg.png"/></div></figure><p id="92b9" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">åœ¨å“ªé‡Œï¼Œ</p><ol class=""><li id="1538" class="kp kq it js b jt ju jx jy kb kr kf ks kj kt kn ku kv kw kx bi translated">x æ˜¯ N é˜¶ x (p+1)é¢„æµ‹å€¼çš„çŸ©é˜µï¼Œç¬¬ä¸€åˆ—å…¨ä¸º 1ã€‚</li><li id="c610" class="kp kq it js b jt ky jx kz kb la kf lb kj lc kn ku kv kw kx bi translated">y æ˜¯å“åº”å˜é‡çš„åˆ—å‘é‡ã€‚</li><li id="1271" class="kp kq it js b jt ky jx kz kb la kf lb kj lc kn ku kv kw kx bi translated">p-hat æ˜¯æ›´æ–°æ¦‚ç‡ P[Y=1| X=x]çš„åˆ—å‘é‡ã€‚</li><li id="4800" class="kp kq it js b jt ky jx kz kb la kf lb kj lc kn ku kv kw kx bi translated">p æ˜¯ NÃ—N å¯¹è§’çŸ©é˜µï¼Œç¬¬ I ä¸ªå¯¹è§’å…ƒç´ æ˜¯ pi(1-pi)ã€‚</li><li id="28d4" class="kp kq it js b jt ky jx kz kb la kf lb kj lc kn ku kv kw kx bi translated">n è¡¨ç¤ºç¬¬ n æ¬¡è¿­ä»£ã€‚</li></ol></div><div class="ab cl mr ms hx mt" role="separator"><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw"/></div><div class="im in io ip iq"><p id="e029" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">æˆ‘ä»¬çš„ç†è®ºèƒŒæ™¯å·²ç»å‡†å¤‡å¥½äº†ï¼Œç°åœ¨æ˜¯ç¼–ç çš„æ—¶å€™äº†ã€‚æˆ‘åœ¨è¿™é‡Œç”¨ Rã€‚</p><pre class="le lf lg lh gt my mz na nb aw nc bi"><span id="b303" class="nd ne it mz b gy nf ng l nh ni">#at first lets write a function to find the pi values for given predictors and betas</span><span id="8bed" class="nd ne it mz b gy nj ng l nh ni">#x is the matrix of predictors, param is the vector of betas</span><span id="5bab" class="nd ne it mz b gy nj ng l nh ni"><strong class="mz iu">pi_finder=function(x,param){</strong><br/> <strong class="mz iu">pi=array(dim=1)</strong>               #initializing an array<br/> <strong class="mz iu">for(i in 1:nrow(x)){</strong><br/>  <strong class="mz iu">val=0</strong>                        #temporary variable<br/>  <strong class="mz iu">for(j in 1:ncol(x)){<br/>   val=val+x[i,j]*param[j]</strong>     #x[i,j]=ith value of jth predictor<br/>  <strong class="mz iu">}<br/>  pi[i]=1/(1+exp(-val))<br/> }<br/>return(pi)</strong>                     # it will return the updated pi<br/><strong class="mz iu">}</strong></span><span id="f6c6" class="nd ne it mz b gy nj ng l nh ni">#now lets write a function to construct the P matrix<br/>#as input we only need the pi values</span><span id="b7d6" class="nd ne it mz b gy nj ng l nh ni"><strong class="mz iu">P_matrix_finder=function(pi){ </strong><br/> <strong class="mz iu">P=diag(pi*(1-pi))</strong>   #diagonal matrix with ith diagonal=pi(1-pi)<br/> <strong class="mz iu">return(P)</strong>           #returning the matrix<br/><strong class="mz iu">}</strong></span><span id="3af0" class="nd ne it mz b gy nj ng l nh ni">#and finally the logistic function equivalent to glm.<br/># as input it will take the matrix of predictors, response variable and the precision for the convergence of Newton Raphson method.</span><span id="7cb0" class="nd ne it mz b gy nj ng l nh ni"><strong class="mz iu">logistic_own=function(predictor,response,precision){</strong><br/><strong class="mz iu"> predictor_new=as.matrix(predictor)</strong>   # just to be on the safe side<br/> <strong class="mz iu">distinct=sort(unique(as.numeric(response)),decreasing=FALSE)<br/> response_new=array(dim=1)<br/> for(i in 1:length(response)){<br/>  if(response[i]==distinct[1])<br/>   response_new[i]=0<br/>  else<br/>   response_new[i]=1</strong><br/> <strong class="mz iu">}</strong>                     #in case response is in factor (not numeric)<br/> <strong class="mz iu">constant=rep(1:length(response_new))</strong>  #the first column of X matrix<br/> <strong class="mz iu">X_matrix=cbind(constant,predictor_new)</strong><br/> <strong class="mz iu">beta=rep(0,ncol(X_matrix))</strong>          #initializing beta to 0 vector<br/> <strong class="mz iu">dif=100</strong>              #since do while loop does not exist in R  :(<br/> <strong class="mz iu">while(dif&gt;precision){<br/>  pi=pi_finder(X_matrix,beta)<br/>  P=P_matrix_finder(pi)<br/>  updated=solve(t(X_matrix)%*%P%*%X_matrix)%*%t(X_matrix)%*%(response_new-pi)   </strong><br/>  <strong class="mz iu">beta=beta+updated</strong>   #updating beta <br/>  <strong class="mz iu">dif=sum(updated^2)</strong>   #euclidean distance between old and new beta<br/> <strong class="mz iu">}<br/> return(beta)<br/>}</strong></span></pre><p id="9ab4" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">æ¨¡å‹åŸ¹è®­æ¡†æ¶å®Œæˆã€‚æˆ‘ä¸€ç›´ä¿æŒç®€å•ã€‚<em class="ko">å¤šç±»åˆ†ç±»ä¼šå¤±è´¥ã€‚</em></p><p id="a00a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">æˆ‘ä»¬è¦ä¸è¦åœ¨æ•°æ®é›†ä¸Šè¯•ä¸€è¯•ï¼Œå¹¶ä¸ glm å‡½æ•°çš„ç»“æœè¿›è¡Œæ¯”è¾ƒï¼Ÿæˆ‘æ­£åœ¨ä½¿ç”¨è‘—åçš„<em class="ko">è™¹è†œæ•°æ®é›†ã€‚</em></p><pre class="le lf lg lh gt my mz na nb aw nc bi"><span id="5f14" class="nd ne it mz b gy nf ng l nh ni"><strong class="mz iu">library(datasets)<br/>iris=iris<br/>iris_new=iris[which(iris$Species!="setosa"),]</strong> #taking only 2 outputs</span></pre><p id="b75c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">æ•°æ®çœ‹èµ·æ¥åƒè¿™æ ·:</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi gj"><img src="../Images/b481f263032dbc69a852004ef8c9bc3f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8_gQtB9f9h6u6BHYbMyljg.png"/></div></div></figure><pre class="le lf lg lh gt my mz na nb aw nc bi"><span id="9f4f" class="nd ne it mz b gy nf ng l nh ni">#train test split. I am considering 75:25 ratio<br/><strong class="mz iu">samples=sample(1:nrow(iris_new),size=nrow(iris_new)*0.75,replace=F)</strong><br/><strong class="mz iu">iris_new_train=iris_new[samples,]</strong>   #training data<br/><strong class="mz iu">iris_new_test=iris_new[-samples,]</strong>   #test data</span><span id="b791" class="nd ne it mz b gy nj ng l nh ni">#model training using glm function<br/><strong class="mz iu">inbuilt=glm(Species~Sepal.Length+Sepal.Width+Petal.Length+Petal.Width,data=iris_new_train,family=binomial(link="logit"))<br/>inbuilt$coefficients</strong></span></pre><p id="c149" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">è¾“å‡ºæ˜¯</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi nk"><img src="../Images/099e896ff677f28109a354503acc9b40.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CU-bcDcNzohS-sdDDCtRiw.png"/></div></div></figure><p id="408e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">è®©æˆ‘ä»¬è¯•è¯•æˆ‘ä»¬çš„åŠŸèƒ½ï¼Œ</p><pre class="le lf lg lh gt my mz na nb aw nc bi"><span id="b216" class="nd ne it mz b gy nf ng l nh ni"><strong class="mz iu">model=own_logistic(iris_new_train[,1:4],iris_new_train[,5],0.000000001)<br/>model</strong></span></pre><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi nl"><img src="../Images/19fbfba618011b742f5215b244a9bf64.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SV7RApjCbypnSR4vBZ2zxw.png"/></div></div></figure><p id="1ce7" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">ç­”å¯¹äº†ã€‚ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ğŸ˜€ğŸ˜€ğŸ˜€</p><p id="6d72" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">ä½†æ˜¯å·¥ä½œè¿˜æ²¡æœ‰å®Œæˆï¼Œæˆ‘ä»¬ä»ç„¶éœ€è¦æµ‹è¯•æˆ‘ä»¬çš„æ¨¡å‹ã€‚R ä¸­æœ‰ä¸€ä¸ªå†…ç½®å‡½æ•°<strong class="js iu"> predict </strong>ï¼Œå®ƒç»™å‡ºäº†æµ‹è¯•æ•°æ®ç‚¹çš„é¢„æµ‹æ¦‚ç‡ã€‚æˆ‘ä»¬èƒ½å¼€å‘ç±»ä¼¼çš„ä¸œè¥¿å—ï¼Ÿ</p><p id="b2ce" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">æˆ‘ä»¬å½“ç„¶å¯ä»¥ã€‚æˆ‘ä»¬å·²ç»æœ‰äº†è®­ç»ƒå¥½çš„ç³»æ•°ã€‚åªéœ€è¦æµ‹è¯•æ•°æ®é›†ã€‚</p><pre class="le lf lg lh gt my mz na nb aw nc bi"><span id="a568" class="nd ne it mz b gy nf ng l nh ni">#takes our model output and test data predictors as inputs<br/><strong class="mz iu">fitted=function(model,test_data_predictors){<br/>  predictors=as.matrix(test_data_predictors)<br/>  constant=rep(1,nrow(predictors))<br/>  X_matrix=cbind(constant,predictors)<br/>  pred=pi_finder(X_matrix,model)</strong>   # the predicted probabilities<br/>  <strong class="mz iu">return(pred) <br/>}</strong></span></pre><p id="2b51" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">åœ¨ R ä¸­ä½¿ç”¨å†…ç½®å‡½æ•°:</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi nm"><img src="../Images/63476237ba7dce18eb4d4b895ebdb339.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iYSbSHTjgBWNH-7EUD4AnQ.png"/></div></div></figure><p id="a4bf" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">è®©æˆ‘ä»¬çœ‹çœ‹æˆ‘ä»¬çš„å‡½æ•°ç»™å‡ºäº†ä»€ä¹ˆ:</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi nn"><img src="../Images/f5db5b692a44a4dd4d4ac45ecbf34604.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5AAbQJC19gLYPCBuPQYcBQ.png"/></div></div></figure><p id="dab7" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">è¿™æœ‰ç‚¹ç¬¨æ‹™ï¼Œè®©æˆ‘ä»¬æŠŠå®ƒä»¬æ”¾åœ¨ä¸€èµ·:</p><pre class="le lf lg lh gt my mz na nb aw nc bi"><span id="391a" class="nd ne it mz b gy nf ng l nh ni"><strong class="mz iu">R_inbuilt_pred=predict(inbuilt,iris_new_test[,1:4],type="response")<br/>Our_own_pred=fitted(model,iris_new_test[,1:4])<br/>cbind(R_inbuilt_pred,Our_own_pred)</strong></span></pre><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi no"><img src="../Images/992804834adae31cdcf632acd57e5f31.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*B36JyzmgPabiOgcRzWKgVw.png"/></div></div></figure><blockquote class="ly"><p id="457f" class="lz ma it bd mb mc md me mf mg mh kn dk translated">æ­å–œä½ ï¼ï¼ï¼ï¼ï¼ä½ å·²ç»å­¦ä¼šäº†å¦‚ä½•ä¸ºäºŒå…ƒåˆ†ç±»åˆ›å»ºè‡ªå·±çš„é€»è¾‘åˆ†ç±»å™¨ã€‚</p></blockquote></div><div class="ab cl mr ms hx mt" role="separator"><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw"/></div><div class="im in io ip iq"><p id="535e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">ç¼–å†™è‡ªå·±çš„ä»£ç æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„å®è·µã€‚è¿™æ ·ä½ ä¼šå˜å¾—æ›´æœ‰åˆ›é€ åŠ›ï¼Œå¹¶ä¸”å¯¹ä¸åŒçš„æœ€å¤§ä¼¼ç„¶ç®—æ³•çš„èƒŒæ™¯ç†è®ºæœ‰å¾ˆå¼ºçš„æŠŠæ¡ã€‚</p><p id="8f35" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">å¦‚æœä½ éœ€è¦é€šè¿‡åˆ›é€ åŠ›æ¥ç†è§£é€»è¾‘å›å½’èƒŒåçš„æ€æƒ³ï¼Œä½ å¯ä»¥å»çœ‹çœ‹æˆ‘ä¹‹å‰çš„æ–‡ç« <a class="ae np" rel="noopener" target="_blank" href="/logistic-regression-derived-from-intuition-d1211fc09b10"> <strong class="js iu">é€»è¾‘å›å½’â€”â€”æºè‡ªç›´è§‰ã€é€»è¾‘ä¸‰éƒ¨æ›²ï¼Œç¬¬ 1 éƒ¨åˆ†ã€‘</strong> </a>ã€‚ä½ è‡ªå·±å°†ä»çº¯ç²¹çš„ç›´è§‰å’Œé€»è¾‘ä¸­æ¨å¯¼å‡ºé€»è¾‘å›å½’ã€‚</p><div class="nq nr gp gr ns nt"><a rel="noopener follow" target="_blank" href="/logistic-regression-derived-from-intuition-d1211fc09b10"><div class="nu ab fo"><div class="nv ab nw cl cj nx"><h2 class="bd iu gy z fp ny fr fs nz fu fw is bi translated">é€»è¾‘å›å½’â€”â€”æºè‡ªç›´è§‰</h2><div class="oa l"><h3 class="bd b gy z fp ny fr fs nz fu fw dk translated">è®©æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªæ•…äº‹ä»å¤´å¼€å§‹æ¨å¯¼é€»è¾‘å›å½’ã€‚æˆ‘å¸Œæœ›è¿™å°†æ˜¯æœ‰è¶£å’Œå¥½ç©çš„â€¦</h3></div><div class="ob l"><p class="bd b dl z fp ny fr fs nz fu fw dk translated">towardsdatascience.com</p></div></div><div class="oc l"><div class="od l oe of og oc oh ln nt"/></div></div></a></div></div><div class="ab cl mr ms hx mt" role="separator"><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw"/></div><div class="im in io ip iq"><p id="64e6" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">åˆ›é€ åŠ›å’Œåˆ›æ–°åœ¨ä»»ä½•é¢†åŸŸéƒ½éå¸¸é‡è¦ã€‚å®ƒä¼šæŠŠä½ å’Œå…¶ä»–äººåˆ†å¼€ã€‚æœ€é‡è¦çš„æ˜¯ï¼Œæ•°æ®ç§‘å­¦å®¶éœ€è¦æœ‰åˆ›é€ åŠ›ã€‚</p><p id="1af5" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">å¦‚æœä½ ä¸ç›¸ä¿¡ï¼Œæˆ–è€…æœ‰ä»»ä½•ç–‘é—®æˆ–å»ºè®®ï¼Œè¯·åœ¨è¯„è®ºåŒºæé—®ï¼Œæˆ–è€…é€šè¿‡æˆ‘çš„ LinkedIn ä¸ªäººèµ„æ–™è”ç³»æˆ‘ã€‚</p><div class="nq nr gp gr ns nt"><a href="https://www.linkedin.com/in/soumalya-nandi-95176569/" rel="noopener  ugc nofollow" target="_blank"><div class="nu ab fo"><div class="nv ab nw cl cj nx"><h2 class="bd iu gy z fp ny fr fs nz fu fw is bi translated">SOUMALYA NANDI -è”åˆå¥åº·ç»„ç»‡(L2)åŠ©ç†æ•°æ®ç§‘å­¦å®¶| LinkedIn</h2><div class="oa l"><h3 class="bd b gy z fp ny fr fs nz fu fw dk translated">æŸ¥çœ‹ SOUMALYA NANDI åœ¨å…¨çƒæœ€å¤§çš„èŒä¸šç¤¾åŒº LinkedIn ä¸Šçš„ä¸ªäººèµ„æ–™ã€‚SOUMALYA æœ‰ 4 ä»½å·¥ä½œåˆ—åœ¨â€¦</h3></div><div class="ob l"><p class="bd b dl z fp ny fr fs nz fu fw dk translated">www.linkedin.com</p></div></div><div class="oc l"><div class="oi l oe of og oc oh ln nt"/></div></div></a></div></div></div>    
</body>
</html>