<html>
<head>
<title>Practical Statistics &amp; Visualization With Python &amp; Plotly</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用 Python 和 Plotly 实现实用统计和可视化</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/practical-statistics-visualization-with-python-plotly-770e96e35067?source=collection_archive---------3-----------------------#2019-05-14">https://towardsdatascience.com/practical-statistics-visualization-with-python-plotly-770e96e35067?source=collection_archive---------3-----------------------#2019-05-14</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="ip iq gp gr ir is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/1420572d013f94a1043431a3f7dec473.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*O7oqV37UCXXe9SS8Lelsyg.jpeg"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Photo credit: Pixabay</figcaption></figure><div class=""/><div class=""><h2 id="4cdf" class="pw-subtitle-paragraph kc je jf bd b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt dk translated">如何使用 Python 和 Plotly 进行统计可视化、推理和建模</h2></div><p id="58cd" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">上周有一天，我在用 Python  谷歌“<strong class="kw jg"> <em class="lq">统计”，结果有些毫无收获。大部分文献、教程、文章都以<a class="ae lr" href="https://www.r-project.org/" rel="noopener ugc nofollow" target="_blank"> <strong class="kw jg"> <em class="lq"> R </em> </strong> </a>为统计重点，因为<a class="ae lr" href="https://www.r-project.org/" rel="noopener ugc nofollow" target="_blank"> <strong class="kw jg"> <em class="lq"> R </em> </strong> </a>是一种专门用于统计的语言，比 Python 有更多的统计分析特性。</em></strong></p><p id="a224" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">在两本优秀的统计学书籍中，《面向数据科学家的<a class="ae lr" href="https://www.amazon.ca/Practical-Statistics-Data-Scientists-Essential-ebook/dp/B071NVDFD6/ref=dp_kinw_strp_1" rel="noopener ugc nofollow" target="_blank"> <strong class="kw jg"> <em class="lq">实用</em> </strong> <strong class="kw jg"> <em class="lq">统计学》、《统计学习入门<a class="ae lr" href="http://www-bcf.usc.edu/~gareth/ISL/" rel="noopener ugc nofollow" target="_blank"><strong class="kw jg"><em class="lq"/></strong></a>》中，统计概念均在<strong class="kw jg"> <em class="lq"> R </em> </strong>中实现。</em></strong></a></p><p id="14de" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated"><a class="ae lr" href="https://learning.oreilly.com/library/view/practical-statistics-for/9781491952955/preface01.html" rel="noopener ugc nofollow" target="_blank">数据科学融合了多个学科，包括统计学、计算机科学、信息技术和特定领域</a>。我们每天使用强大的开源<a class="ae lr" href="https://www.python.org/" rel="noopener ugc nofollow" target="_blank"><strong class="kw jg"><em class="lq">Python</em></strong></a>工具来操作、分析和可视化数据集。</p><p id="8fb1" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">我当然会建议任何对成为数据科学家或机器学习工程师感兴趣的人深入理解并不断实践统计学习理论。</p><p id="e1a2" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">这促使我为这个主题写一篇文章。我将使用一个数据集来回顾尽可能多的统计概念，让我们开始吧！</p><h1 id="6176" class="ls lt jf bd lu lv lw lx ly lz ma mb mc kl md km me ko mf kp mg kr mh ks mi mj bi translated">数据</h1><p id="ee09" class="pw-post-body-paragraph ku kv jf kw b kx mk kg kz la ml kj lc ld mm lf lg lh mn lj lk ll mo ln lo lp ij bi translated">数据是房价数据集，可以在<a class="ae lr" href="https://www.kaggle.com/c/house-prices-advanced-regression-techniques/data" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p><pre class="mp mq mr ms gt mt mu mv mw aw mx bi"><span id="706d" class="my lt jf mu b gy mz na l nb nc">import numpy as np<br/>import pandas as pd<br/>import matplotlib.pyplot as plt<br/>import seaborn as sns<br/>from plotly.offline import init_notebook_mode, iplot<br/>import plotly.figure_factory as ff<br/>import cufflinks<br/>cufflinks.go_offline()<br/>cufflinks.set_config_file(world_readable=True, theme='pearl')<br/>import plotly.graph_objs as go<br/>import plotly.plotly as py<br/>import plotly<br/>from plotly import tools<br/>plotly.tools.set_credentials_file(username='XXX', api_key='XXX')<br/>init_notebook_mode(connected=True)<br/>pd.set_option('display.max_columns', 100)</span><span id="95da" class="my lt jf mu b gy nd na l nb nc">df = pd.read_csv('house_train.csv')<br/>df.drop('Id', axis=1, inplace=True)<br/>df.head()</span></pre><figure class="mp mq mr ms gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ne"><img src="../Images/26df9e43a709e1c61c1ee7c1052ca244.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AJE1ppBRt5swmgh6-OJosw.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Table 1</figcaption></figure><h1 id="0fa5" class="ls lt jf bd lu lv lw lx ly lz ma mb mc kl md km me ko mf kp mg kr mh ks mi mj bi translated">单变量数据分析</h1><p id="0aa8" class="pw-post-body-paragraph ku kv jf kw b kx mk kg kz la ml kj lc ld mm lf lg lh mn lj lk ll mo ln lo lp ij bi translated"><a class="ae lr" href="https://en.wikipedia.org/wiki/Univariate_analysis" rel="noopener ugc nofollow" target="_blank"> <strong class="kw jg">单变量分析</strong>也许是最简单的统计分析形式，关键事实是只涉及一个变量</a>。</p><h2 id="e5f5" class="my lt jf bd lu nf ng dn ly nh ni dp mc ld nj nk me lh nl nm mg ll nn no mi np bi translated">描述数据</h2><p id="9ebe" class="pw-post-body-paragraph ku kv jf kw b kx mk kg kz la ml kj lc ld mm lf lg lh mn lj lk ll mo ln lo lp ij bi translated">数字数据的统计摘要包括数据的平均值、最小值和最大值，对于了解一些变量有多大以及哪些变量可能是最重要的非常有用。</p><pre class="mp mq mr ms gt mt mu mv mw aw mx bi"><span id="885a" class="my lt jf mu b gy mz na l nb nc">df.describe().T</span></pre><figure class="mp mq mr ms gt is gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/3f1b2562b0ff05d8209d91238eec1855.png" data-original-src="https://miro.medium.com/v2/resize:fit:1068/format:webp/1*Dm_A0NZKDSZzYQ6i7cO9pw.png"/></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Table 2</figcaption></figure><p id="d996" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">分类或字符串变量的统计摘要将显示“计数”、“唯一”、“前几名”和“频率”。</p><pre class="mp mq mr ms gt mt mu mv mw aw mx bi"><span id="cbf2" class="my lt jf mu b gy mz na l nb nc">table_cat = ff.create_table(df.describe(include=['O']).T, index=True, index_title='Categorical columns')<br/>iplot(table_cat)</span></pre><figure class="mp mq mr ms gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nr"><img src="../Images/b813e0ce47ffe89b37f35606e07a9a75.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1J9yPJdwZjxw7nHlb_up7A.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Table 3</figcaption></figure><h2 id="55e1" class="my lt jf bd lu nf ng dn ly nh ni dp mc ld nj nk me lh nl nm mg ll nn no mi np bi translated">柱状图</h2><p id="db74" class="pw-post-body-paragraph ku kv jf kw b kx mk kg kz la ml kj lc ld mm lf lg lh mn lj lk ll mo ln lo lp ij bi translated">绘制数据中所有房屋销售价格的直方图。</p><pre class="mp mq mr ms gt mt mu mv mw aw mx bi"><span id="b92a" class="my lt jf mu b gy mz na l nb nc">df['SalePrice'].iplot(<br/>    kind='hist',<br/>    bins=100,<br/>    xTitle='price',<br/>    linecolor='black',<br/>    yTitle='count',<br/>    title='Histogram of Sale Price')</span></pre><figure class="mp mq mr ms gt is"><div class="bz fp l di"><div class="ns nt l"/></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Figure 1</figcaption></figure><h2 id="711b" class="my lt jf bd lu nf ng dn ly nh ni dp mc ld nj nk me lh nl nm mg ll nn no mi np bi translated">箱线图</h2><p id="d044" class="pw-post-body-paragraph ku kv jf kw b kx mk kg kz la ml kj lc ld mm lf lg lh mn lj lk ll mo ln lo lp ij bi translated">绘制数据中所有房屋销售价格的箱线图。箱线图没有显示分布的形状，但它们可以让我们更好地了解分布的中心和分布，以及可能存在的任何潜在异常值。箱线图和直方图通常相互补充，帮助我们了解更多的数据。</p><pre class="mp mq mr ms gt mt mu mv mw aw mx bi"><span id="ffc5" class="my lt jf mu b gy mz na l nb nc">df['SalePrice'].iplot(kind='box', title='Box plot of SalePrice')</span></pre><figure class="mp mq mr ms gt is"><div class="bz fp l di"><div class="ns nt l"/></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Figure 2</figcaption></figure><h2 id="81c1" class="my lt jf bd lu nf ng dn ly nh ni dp mc ld nj nk me lh nl nm mg ll nn no mi np bi translated">按组划分的直方图和箱线图</h2><p id="c70c" class="pw-post-body-paragraph ku kv jf kw b kx mk kg kz la ml kj lc ld mm lf lg lh mn lj lk ll mo ln lo lp ij bi translated">通过分组绘图，我们可以看到一个变量如何响应另一个变量而变化。例如，如果有或没有中央空调的房屋销售价格不同。或者房屋销售价格是否根据车库的大小而变化，等等。</p><h2 id="a425" class="my lt jf bd lu nf ng dn ly nh ni dp mc ld nj nk me lh nl nm mg ll nn no mi np bi translated">按有无空调分组的房屋销售价格箱线图和直方图</h2><figure class="mp mq mr ms gt is"><div class="bz fp l di"><div class="nu nt l"/></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">boxplot.aircon.py</figcaption></figure><figure class="mp mq mr ms gt is"><div class="bz fp l di"><div class="ns nt l"/></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Figure 3</figcaption></figure><figure class="mp mq mr ms gt is"><div class="bz fp l di"><div class="nu nt l"/></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">histogram_aircon.py</figcaption></figure><figure class="mp mq mr ms gt is"><div class="bz fp l di"><div class="ns nt l"/></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Figure 4</figcaption></figure><pre class="mp mq mr ms gt mt mu mv mw aw mx bi"><span id="0c4c" class="my lt jf mu b gy mz na l nb nc">df.groupby('CentralAir')['SalePrice'].describe()</span></pre><figure class="mp mq mr ms gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nv"><img src="../Images/bd65b931ce671a7c7277df0868642c9f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kS9gjYu6MzAsvNzUGnkJ_w.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Table 4</figcaption></figure><p id="394d" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">显然，没有空调的房子的平均和中间销售价格比有空调的房子低得多。</p><h2 id="ddb4" class="my lt jf bd lu nf ng dn ly nh ni dp mc ld nj nk me lh nl nm mg ll nn no mi np bi translated">按车库大小分组的房屋销售价格箱线图和直方图</h2><figure class="mp mq mr ms gt is"><div class="bz fp l di"><div class="nu nt l"/></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">boxplot_garage.py</figcaption></figure><figure class="mp mq mr ms gt is"><div class="bz fp l di"><div class="ns nt l"/></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Figure 5</figcaption></figure><p id="6e88" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">车库越大，房子的中间价格越高，这种情况一直持续到我们有 3 辆车的车库。显然，有 3 个车库的房子的中间价格最高，甚至高于有 4 个车库的房子。</p><h2 id="8078" class="my lt jf bd lu nf ng dn ly nh ni dp mc ld nj nk me lh nl nm mg ll nn no mi np bi translated">无车库房屋销售价格柱状图</h2><pre class="mp mq mr ms gt mt mu mv mw aw mx bi"><span id="236d" class="my lt jf mu b gy mz na l nb nc">df.loc[df['GarageCars'] == 0]['SalePrice'].iplot(<br/>    kind='hist',<br/>    bins=50,<br/>    xTitle='price',<br/>    linecolor='black',<br/>    yTitle='count',<br/>    title='Histogram of Sale Price of houses with no garage')</span></pre><figure class="mp mq mr ms gt is"><div class="bz fp l di"><div class="ns nt l"/></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Figure 6</figcaption></figure><h2 id="1284" class="my lt jf bd lu nf ng dn ly nh ni dp mc ld nj nk me lh nl nm mg ll nn no mi np bi translated">单车库房屋销售价格柱状图</h2><pre class="mp mq mr ms gt mt mu mv mw aw mx bi"><span id="e9d3" class="my lt jf mu b gy mz na l nb nc">df.loc[df['GarageCars'] == 1]['SalePrice'].iplot(<br/>    kind='hist',<br/>    bins=50,<br/>    xTitle='price',<br/>    linecolor='black',<br/>    yTitle='count',<br/>    title='Histogram of Sale Price of houses with 1-car garage')</span></pre><figure class="mp mq mr ms gt is"><div class="bz fp l di"><div class="ns nt l"/></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Figure 7</figcaption></figure><h2 id="2f08" class="my lt jf bd lu nf ng dn ly nh ni dp mc ld nj nk me lh nl nm mg ll nn no mi np bi translated">带两个车库的房屋销售价格直方图</h2><pre class="mp mq mr ms gt mt mu mv mw aw mx bi"><span id="b55c" class="my lt jf mu b gy mz na l nb nc">df.loc[df['GarageCars'] == 2]['SalePrice'].iplot(<br/>    kind='hist',<br/>    bins=100,<br/>    xTitle='price',<br/>    linecolor='black',<br/>    yTitle='count',<br/>    title='Histogram of Sale Price of houses with 2-car garage')</span></pre><figure class="mp mq mr ms gt is"><div class="bz fp l di"><div class="ns nt l"/></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Figure 8</figcaption></figure><h2 id="34ed" class="my lt jf bd lu nf ng dn ly nh ni dp mc ld nj nk me lh nl nm mg ll nn no mi np bi translated">带 3 个车库的房屋销售价格直方图</h2><pre class="mp mq mr ms gt mt mu mv mw aw mx bi"><span id="43db" class="my lt jf mu b gy mz na l nb nc">df.loc[df['GarageCars'] == 3]['SalePrice'].iplot(<br/>    kind='hist',<br/>    bins=50,<br/>    xTitle='price',<br/>    linecolor='black',<br/>    yTitle='count',<br/>    title='Histogram of Sale Price of houses with 3-car garage')</span></pre><figure class="mp mq mr ms gt is"><div class="bz fp l di"><div class="ns nt l"/></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Figure 9</figcaption></figure><h2 id="bf63" class="my lt jf bd lu nf ng dn ly nh ni dp mc ld nj nk me lh nl nm mg ll nn no mi np bi translated">带 4 个车库的房屋销售价格直方图</h2><pre class="mp mq mr ms gt mt mu mv mw aw mx bi"><span id="404b" class="my lt jf mu b gy mz na l nb nc">df.loc[df['GarageCars'] == 4]['SalePrice'].iplot(<br/>    kind='hist',<br/>    bins=10,<br/>    xTitle='price',<br/>    linecolor='black',<br/>    yTitle='count',<br/>    title='Histogram of Sale Price of houses with 4-car garage')</span></pre><figure class="mp mq mr ms gt is"><div class="bz fp l di"><div class="ns nt l"/></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Figure 10</figcaption></figure><h2 id="9625" class="my lt jf bd lu nf ng dn ly nh ni dp mc ld nj nk me lh nl nm mg ll nn no mi np bi translated">频率表</h2><p id="9da3" class="pw-post-body-paragraph ku kv jf kw b kx mk kg kz la ml kj lc ld mm lf lg lh mn lj lk ll mo ln lo lp ij bi translated">频率告诉我们事情发生的频率。频率表给了我们数据的快照，让我们能够找到模式。</p><h2 id="c531" class="my lt jf bd lu nf ng dn ly nh ni dp mc ld nj nk me lh nl nm mg ll nn no mi np bi translated">总体质量频率表</h2><pre class="mp mq mr ms gt mt mu mv mw aw mx bi"><span id="d09b" class="my lt jf mu b gy mz na l nb nc">x = df.OverallQual.value_counts()<br/>x/x.sum()</span></pre><figure class="mp mq mr ms gt is gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/abe94896dbd3646624d956f724290c07.png" data-original-src="https://miro.medium.com/v2/resize:fit:944/format:webp/1*stBFfermLumPUH11K1HPwQ.png"/></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Table 5</figcaption></figure><h2 id="38c5" class="my lt jf bd lu nf ng dn ly nh ni dp mc ld nj nk me lh nl nm mg ll nn no mi np bi translated">车库大小频率表</h2><pre class="mp mq mr ms gt mt mu mv mw aw mx bi"><span id="27db" class="my lt jf mu b gy mz na l nb nc">x = df.GarageCars.value_counts()<br/>x/x.sum()</span></pre><figure class="mp mq mr ms gt is gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/eb2cd6c06435a65963d6125fe7e5140b.png" data-original-src="https://miro.medium.com/v2/resize:fit:834/format:webp/1*NTkZrpS33R79UUUQr4rUoQ.png"/></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Table 6</figcaption></figure><h2 id="c83c" class="my lt jf bd lu nf ng dn ly nh ni dp mc ld nj nk me lh nl nm mg ll nn no mi np bi translated">中央空调频率表</h2><pre class="mp mq mr ms gt mt mu mv mw aw mx bi"><span id="c167" class="my lt jf mu b gy mz na l nb nc">x = df.CentralAir.value_counts()<br/>x/x.sum()</span></pre><figure class="mp mq mr ms gt is gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/c55075a16f7b27fde70551b6b1c86fdf.png" data-original-src="https://miro.medium.com/v2/resize:fit:834/format:webp/1*JKUW3UdbIMG0EUeWKap1AQ.png"/></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Table 7</figcaption></figure><h2 id="7e67" class="my lt jf bd lu nf ng dn ly nh ni dp mc ld nj nk me lh nl nm mg ll nn no mi np bi translated">数字摘要</h2><p id="ef50" class="pw-post-body-paragraph ku kv jf kw b kx mk kg kz la ml kj lc ld mm lf lg lh mn lj lk ll mo ln lo lp ij bi translated">获得定量变量的一组数字汇总的快速方法是使用 describe 方法。</p><pre class="mp mq mr ms gt mt mu mv mw aw mx bi"><span id="0cd9" class="my lt jf mu b gy mz na l nb nc">df.SalePrice.describe()</span></pre><figure class="mp mq mr ms gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ny"><img src="../Images/86fb0c136366879a0189f81dc50aa1ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:964/format:webp/1*7tk5SeWxKCP7we7wFpzctA.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Table 8</figcaption></figure><p id="ef1c" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">我们还可以计算 SalePrice 的个别汇总统计数据。</p><pre class="mp mq mr ms gt mt mu mv mw aw mx bi"><span id="6737" class="my lt jf mu b gy mz na l nb nc">print("The mean of sale price, - Pandas method: ", df.SalePrice.mean())<br/>print("The mean of sale price, - Numpy function: ", np.mean(df.SalePrice))<br/>print("The median sale price: ", df.SalePrice.median())<br/>print("50th percentile, same as the median: ", np.percentile(df.SalePrice, 50))<br/>print("75th percentile: ", np.percentile(df.SalePrice, 75))<br/>print("Pandas method for quantiles, equivalent to 75th percentile: ", df.SalePrice.quantile(0.75))</span></pre><figure class="mp mq mr ms gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nz"><img src="../Images/d8c57a122dd8e2af393553522ff6f6c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oHXlxPnDuH-EJBHeGYs1EA.png"/></div></div></figure><p id="9a6e" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">计算售价在第 25 百分位(129975)和第 75 百分位(214000)之间的房屋比例。</p><pre class="mp mq mr ms gt mt mu mv mw aw mx bi"><span id="b59e" class="my lt jf mu b gy mz na l nb nc">print('The proportion of the houses with prices between 25th percentile and 75th percentile: ', np.mean((df.SalePrice &gt;= 129975) &amp; (df.SalePrice &lt;= 214000)))</span></pre><figure class="mp mq mr ms gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi oa"><img src="../Images/0472c71588aac3cc232354a09850ff42.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qCO94Suyg-WsV3H6JcMCxw.png"/></div></div></figure><p id="54c6" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">计算地下室面积总平方英尺在第 25 百分位(795.75)和第 75 百分位(1298.25)之间的房屋比例。</p><pre class="mp mq mr ms gt mt mu mv mw aw mx bi"><span id="9b20" class="my lt jf mu b gy mz na l nb nc">print('The proportion of house with total square feet of basement area between 25th percentile and 75th percentile: ', np.mean((df.TotalBsmtSF &gt;= 795.75) &amp; (df.TotalBsmtSF &lt;= 1298.25)))</span></pre><figure class="mp mq mr ms gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ob"><img src="../Images/fee728d47d52e0d1202119d79f302d9c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*H5kNLBfSosZCtQZG4LIkOA.png"/></div></div></figure><p id="deda" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">最后，我们计算每种情况下的房屋比例。由于有些房子同时符合这两个标准，所以下面的比例小于上面计算的两个比例之和。</p><pre class="mp mq mr ms gt mt mu mv mw aw mx bi"><span id="04eb" class="my lt jf mu b gy mz na l nb nc">a = (df.SalePrice &gt;= 129975) &amp; (df.SalePrice &lt;= 214000)<br/>b = (df.TotalBsmtSF &gt;= 795.75) &amp; (df.TotalBsmtSF &lt;= 1298.25)<br/>print(np.mean(a | b))</span></pre><figure class="mp mq mr ms gt is gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/599f0d2be0ccffc24207851f7e1a422c.png" data-original-src="https://miro.medium.com/v2/resize:fit:606/format:webp/1*7SOeHShi5BRXioidBjAzxg.png"/></div></figure><p id="b3c3" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">计算没有空调的房子在 IQR 的销售价格。</p><pre class="mp mq mr ms gt mt mu mv mw aw mx bi"><span id="d56a" class="my lt jf mu b gy mz na l nb nc">q75, q25 = np.percentile(df.loc[df['CentralAir']=='N']['SalePrice'], [75,25])<br/>iqr = q75 - q25<br/>print('Sale price IQR for houses with no air conditioning: ', iqr)</span></pre><figure class="mp mq mr ms gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi od"><img src="../Images/b65e7b9151d5c10b2bf23b328e9261d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Nn_2qaUgRzaNel7loI-n-Q.png"/></div></div></figure><p id="c1a1" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">计算带空调房屋 IQR 销售价格。</p><pre class="mp mq mr ms gt mt mu mv mw aw mx bi"><span id="40f2" class="my lt jf mu b gy mz na l nb nc">q75, q25 = np.percentile(df.loc[df['CentralAir']=='Y']['SalePrice'], [75,25])<br/>iqr = q75 - q25<br/>print('Sale price IQR for houses with air conditioning: ', iqr)</span></pre><figure class="mp mq mr ms gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi oe"><img src="../Images/888e9909011d698dc8e2a7442215f9fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ln1v_8-zMlgEowI9WxG0rg.png"/></div></div></figure><h2 id="59b1" class="my lt jf bd lu nf ng dn ly nh ni dp mc ld nj nk me lh nl nm mg ll nn no mi np bi translated">分层</h2><p id="eeec" class="pw-post-body-paragraph ku kv jf kw b kx mk kg kz la ml kj lc ld mm lf lg lh mn lj lk ll mo ln lo lp ij bi translated">从数据集中获取更多信息的另一种方法是将其分成更小、更统一的子集，并单独分析这些“层”。我们将创建一个新的 HouseAge 列，然后将数据划分到 HouseAge 层，并在每个层内构建并排的销售价格箱线图。</p><pre class="mp mq mr ms gt mt mu mv mw aw mx bi"><span id="5c01" class="my lt jf mu b gy mz na l nb nc">df['HouseAge'] = 2019 - df['YearBuilt']<br/>df["AgeGrp"] = pd.cut(df.HouseAge, [9, 20, 40, 60, 80, 100, 147]) # Create age strata based on these cut points<br/>plt.figure(figsize=(12, 5)) <br/>sns.boxplot(x="AgeGrp", y="SalePrice", data=df);</span></pre><figure class="mp mq mr ms gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi of"><img src="../Images/3842e57790075648e97df2c72e169db7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hwhm8BA_SEAhSqiXesAtuQ.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Figure 11</figcaption></figure><p id="048a" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">房子越老，价格中位数越低，也就是房价随着年龄的增长趋于降低，直到 100 岁。超过 100 年的房屋的中间价格高于 80 至 100 年的房屋的中间价格。</p><pre class="mp mq mr ms gt mt mu mv mw aw mx bi"><span id="d5fd" class="my lt jf mu b gy mz na l nb nc">plt.figure(figsize=(12, 5))<br/>sns.boxplot(x="AgeGrp", y="SalePrice", hue="CentralAir", data=df)<br/>plt.show();</span></pre><figure class="mp mq mr ms gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi og"><img src="../Images/4aca25b79f283de8fe57df0093582418.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GcEmdRobdhFnW_dh36bM5g.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Figure 12</figcaption></figure><p id="fb39" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">我们之前已经知道，有空调和没有空调的房价会有所不同。从上图中，我们还发现最近的房子(9-40 年)都装有空调。</p><pre class="mp mq mr ms gt mt mu mv mw aw mx bi"><span id="b8de" class="my lt jf mu b gy mz na l nb nc">plt.figure(figsize=(12, 5))<br/>sns.boxplot(x="CentralAir", y="SalePrice", hue="AgeGrp", data=df)<br/>plt.show();</span></pre><figure class="mp mq mr ms gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi oh"><img src="../Images/301125ed322364e121e241819143d025.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kEy19cGs8qSRyZLVZ8FBSQ.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Figure 13</figcaption></figure><p id="73e9" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">我们现在先按空调分组，然后在空调内按年龄段分组。每种方法突出了数据的不同方面。</p><p id="53e9" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">我们还可以通过房屋年龄和空调来共同分层，以探索建筑类型如何同时受这两个因素的影响而变化。</p><pre class="mp mq mr ms gt mt mu mv mw aw mx bi"><span id="67af" class="my lt jf mu b gy mz na l nb nc">df1 = df.groupby(["AgeGrp", "CentralAir"])["BldgType"]<br/>df1 = df1.value_counts()<br/>df1 = df1.unstack()<br/>df1 = df1.apply(lambda x: x/x.sum(), axis=1)<br/>print(df1.to_string(float_format="%.3f"))</span></pre><figure class="mp mq mr ms gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi oi"><img src="../Images/f959201d9deafb1c553121194b3fc523.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iAqxzykZzfkwWPJ474phQQ.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Table 9</figcaption></figure><p id="51fe" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">对于所有住宅年龄组，数据中绝大多数住宅类型为 1Fam。房子越老，越有可能没有空调。但是，对于 100 年以上的 1Fam 房子来说，有空调的可能性比没有空调的可能性大一点。既没有很新也没有很旧的复式房屋类型。对于一个 40-60 岁的复式房子，它更有可能没有空调。</p><h1 id="de65" class="ls lt jf bd lu lv lw lx ly lz ma mb mc kl md km me ko mf kp mg kr mh ks mi mj bi translated">多变量分析</h1><p id="ed97" class="pw-post-body-paragraph ku kv jf kw b kx mk kg kz la ml kj lc ld mm lf lg lh mn lj lk ll mo ln lo lp ij bi translated"><a class="ae lr" href="https://en.wikipedia.org/wiki/Multivariate_analysis" rel="noopener ugc nofollow" target="_blank"> <strong class="kw jg">多元分析</strong>基于多元统计的统计原理，涉及一次对多个统计结果变量的观察和分析</a>。</p><h2 id="5762" class="my lt jf bd lu nf ng dn ly nh ni dp mc ld nj nk me lh nl nm mg ll nn no mi np bi translated">散点图</h2><p id="571c" class="pw-post-body-paragraph ku kv jf kw b kx mk kg kz la ml kj lc ld mm lf lg lh mn lj lk ll mo ln lo lp ij bi translated"><a class="ae lr" href="https://en.wikipedia.org/wiki/Scatter_plot" rel="noopener ugc nofollow" target="_blank">散点图</a>是一种非常常见且易于理解的定量双变量数据可视化。下面我们做一个销售价格与地面居住面积平方英尺的散点图。这显然是一种线性关系。</p><pre class="mp mq mr ms gt mt mu mv mw aw mx bi"><span id="1aef" class="my lt jf mu b gy mz na l nb nc">df.iplot(<br/>    x='GrLivArea',<br/>    y='SalePrice',<br/>    xTitle='Above ground living area square feet',<br/>    yTitle='Sale price',<br/>    mode='markers',<br/>    title='Sale Price vs Above ground living area square feet')</span></pre><figure class="mp mq mr ms gt is"><div class="bz fp l di"><div class="ns nt l"/></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Figure 14</figcaption></figure><h2 id="9b5c" class="my lt jf bd lu nf ng dn ly nh ni dp mc ld nj nk me lh nl nm mg ll nn no mi np bi translated">2D 密度联合图</h2><p id="59db" class="pw-post-body-paragraph ku kv jf kw b kx mk kg kz la ml kj lc ld mm lf lg lh mn lj lk ll mo ln lo lp ij bi translated">以下两个地块边界分别显示了销售价格和地上居住面积的密度，而中间的地块共同显示了它们的密度。</p><figure class="mp mq mr ms gt is"><div class="bz fp l di"><div class="nu nt l"/></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">price_GrLivArea.py</figcaption></figure><figure class="mp mq mr ms gt is"><div class="bz fp l di"><div class="ns nt l"/></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Figure 15</figcaption></figure><h2 id="fe4a" class="my lt jf bd lu nf ng dn ly nh ni dp mc ld nj nk me lh nl nm mg ll nn no mi np bi translated">异质性和分层</h2><p id="fa24" class="pw-post-body-paragraph ku kv jf kw b kx mk kg kz la ml kj lc ld mm lf lg lh mn lj lk ll mo ln lo lp ij bi translated">我们继续探索销售价格和 GrLivArea 之间的关系，按建筑类型分层。</p><figure class="mp mq mr ms gt is"><div class="bz fp l di"><div class="nu nt l"/></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">stratify.py</figcaption></figure><figure class="mp mq mr ms gt is gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/f938392c4ce86255292927c153659e9f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1370/format:webp/1*azbkgnry22u3JmG6_fNTAQ.png"/></div></figure><figure class="mp mq mr ms gt is"><div class="bz fp l di"><div class="ns nt l"/></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Figure 16</figcaption></figure><p id="93fb" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">在几乎所有的建筑类型中，SalePrice 和 GrLivArea 呈现出正的线性关系。在下面的结果中，我们看到 1Fam 建筑类型的 SalepPrice 和 GrLivArea 之间的相关性最高，为 0.74，而复式建筑类型的相关性最低，为 0.49。</p><pre class="mp mq mr ms gt mt mu mv mw aw mx bi"><span id="851b" class="my lt jf mu b gy mz na l nb nc">print(df.loc[df.BldgType=="1Fam", ["GrLivArea", "SalePrice"]].corr())<br/>print(df.loc[df.BldgType=="TwnhsE", ["GrLivArea", "SalePrice"]].corr())<br/>print(df.loc[df.BldgType=='Duplex', ["GrLivArea", "SalePrice"]].corr())<br/>print(df.loc[df.BldgType=="Twnhs", ["GrLivArea", "SalePrice"]].corr())<br/>print(df.loc[df.BldgType=="2fmCon", ["GrLivArea", "SalePrice"]].corr())</span></pre><figure class="mp mq mr ms gt is gh gi paragraph-image"><div class="gh gi ok"><img src="../Images/0ecc7eb0f4909accde39095f1c96ab1d.png" data-original-src="https://miro.medium.com/v2/resize:fit:896/format:webp/1*Af929crpavauw5d2PKvvZA.png"/></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Table 10</figcaption></figure><h2 id="7a73" class="my lt jf bd lu nf ng dn ly nh ni dp mc ld nj nk me lh nl nm mg ll nn no mi np bi translated">分类双变量分析</h2><p id="8905" class="pw-post-body-paragraph ku kv jf kw b kx mk kg kz la ml kj lc ld mm lf lg lh mn lj lk ll mo ln lo lp ij bi translated">我们创建一个列联表，计算由建筑类型和一般分区分类组合定义的每个单元中的房屋数量。</p><pre class="mp mq mr ms gt mt mu mv mw aw mx bi"><span id="cb0c" class="my lt jf mu b gy mz na l nb nc">x = pd.crosstab(df.MSZoning, df.BldgType)<br/>x</span></pre><figure class="mp mq mr ms gt is gh gi paragraph-image"><div class="gh gi ol"><img src="../Images/d9fd0efd297897aa74f29005c5fb1af8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1044/format:webp/1*OO-jwdA9Rkp-gZWPjnGbSg.png"/></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Table 11</figcaption></figure><p id="93d9" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">下面我们在行内标准化。这就给出了每个分区分类中属于每个建筑类型变量的房屋比例。</p><pre class="mp mq mr ms gt mt mu mv mw aw mx bi"><span id="f767" class="my lt jf mu b gy mz na l nb nc">x.apply(lambda z: z/z.sum(), axis=1)</span></pre><figure class="mp mq mr ms gt is gh gi paragraph-image"><div class="gh gi om"><img src="../Images/9cf406d28018b0148d0050fd0fbd7fd3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1210/format:webp/1*xidmzkz3iqKiHa2EcHMvIw.png"/></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Table 12</figcaption></figure><p id="d8c9" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">我们也可以在列内标准化。这给了我们属于每个分区分类的每种建筑类型中的房屋比例。</p><pre class="mp mq mr ms gt mt mu mv mw aw mx bi"><span id="c128" class="my lt jf mu b gy mz na l nb nc">x.apply(lambda z: z/z.sum(), axis=0)</span></pre><figure class="mp mq mr ms gt is gh gi paragraph-image"><div class="gh gi on"><img src="../Images/617616798d9d6fb4cf497f4e164a70f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1184/format:webp/1*1bW52-WXsEJRVOwVAwmKSg.png"/></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Table 13</figcaption></figure><p id="a20c" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">更进一步，我们将针对空调和建筑类型变量的每个组合，查看每个分区类别中房屋的比例。</p><pre class="mp mq mr ms gt mt mu mv mw aw mx bi"><span id="ab05" class="my lt jf mu b gy mz na l nb nc">df.groupby(["CentralAir", "BldgType", "MSZoning"]).size().unstack().fillna(0).apply(lambda x: x/x.sum(), axis=1)</span></pre><figure class="mp mq mr ms gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi oo"><img src="../Images/2474c8339ab3e5554eda3ba11e090a14.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aIdQw1skS83ZtgL-QC5KTw.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Table 14</figcaption></figure><p id="f378" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">数据中比例最高的房屋是分区 RL、带空调和 1Fam 建筑类型的房屋。由于没有空调，最高比例的房屋是分区 RL 和复式建筑类型的房屋。</p><h2 id="5b80" class="my lt jf bd lu nf ng dn ly nh ni dp mc ld nj nk me lh nl nm mg ll nn no mi np bi translated">混合分类和定量数据</h2><p id="6716" class="pw-post-body-paragraph ku kv jf kw b kx mk kg kz la ml kj lc ld mm lf lg lh mn lj lk ll mo ln lo lp ij bi translated">为了更有趣，我们将绘制一个小提琴图来显示每个建筑类型类别中房屋的销售价格分布。</p><figure class="mp mq mr ms gt is"><div class="bz fp l di"><div class="nu nt l"/></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">price_violin_plot.py</figcaption></figure><figure class="mp mq mr ms gt is"><div class="bz fp l di"><div class="ns nt l"/></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Figure 17</figcaption></figure><p id="9592" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">我们可以看到，1Fam 建筑类型的销售价格分布略微右偏，而对于其他建筑类型，销售价格分布接近正态分布。</p><p id="4690" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">这个帖子的 Jupyter 笔记本可以在<a class="ae lr" href="https://github.com/susanli2016/Machine-Learning-with-Python/blob/master/Practical%20Statistics%20House%20Python_update.ipynb" rel="noopener ugc nofollow" target="_blank"> Github </a>上找到，还有一个<a class="ae lr" href="https://nbviewer.jupyter.org/github/susanli2016/Machine-Learning-with-Python/blob/master/Practical%20Statistics%20House%20Python_update.ipynb" rel="noopener ugc nofollow" target="_blank"> nbviewer 版本</a>。</p><p id="81a4" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">参考:</p><div class="ip iq gp gr ir op"><a href="https://www.coursera.org/specializations/statistics-with-python?" rel="noopener  ugc nofollow" target="_blank"><div class="oq ab fo"><div class="or ab os cl cj ot"><h2 class="bd jg gy z fp ou fr fs ov fu fw je bi translated">使用 Python | Coursera 进行统计</h2><div class="ow l"><h3 class="bd b gy z fp ou fr fs ov fu fw dk translated">这种专业化的目的是教学习者开始和中级概念的统计分析使用？…</h3></div><div class="ox l"><p class="bd b dl z fp ou fr fs ov fu fw dk translated">www.coursera.or</p></div></div><div class="oy l"><div class="oz l pa pb pc oy pd ix op"/></div></div></a></div></div></div>    
</body>
</html>