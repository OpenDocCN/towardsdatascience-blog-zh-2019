<html>
<head>
<title>Hyperparameters in Deep Learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">深度学习中的超参数</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/hyperparameters-in-deep-learning-927f7b2084dd?source=collection_archive---------4-----------------------#2019-02-09">https://towardsdatascience.com/hyperparameters-in-deep-learning-927f7b2084dd?source=collection_archive---------4-----------------------#2019-02-09</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="9d60" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">超参数调音就像调音你的吉他。然后奇迹发生了！</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/8b3be82c2c4160f373a31a8d41954dc7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*5MNc2Ge7caYIksRY"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Photo by <a class="ae ky" href="https://unsplash.com/@robertina?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Roberta Sorge</a> on <a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="038d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi lv translated">当你处于学习阶段时，为你的吉他调音是至关重要的，因为你正在创造不同感官之间的联系。你的耳朵、手指和眼睛都在学吉他。习惯吉他走音就像养成了一个坏习惯，一个会破坏你爱上吉他学习过程的整个体验的习惯。</p><p id="2097" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">给你的吉他调音真的可以帮助你爱上吉他。机器学习和深度学习的超参数调整也是如此</p><p id="652b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">超参数是我们在将学习算法应用于数据集之前需要设置的变量。</p><p id="50ef" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">超参数的挑战在于，不存在放之四海而皆准的神奇数字。最佳数字取决于每个任务和每个数据集</p><p id="9ea7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">超参数可分为两类:</p><p id="889e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu"> 1)优化器超参数</strong></p><ul class=""><li id="b725" class="me mf it lb b lc ld lf lg li mg lm mh lq mi lu mj mk ml mm bi translated">1.1 —学习率</li><li id="516e" class="me mf it lb b lc mn lf mo li mp lm mq lq mr lu mj mk ml mm bi translated">1.2 —小批量</li><li id="cc7c" class="me mf it lb b lc mn lf mo li mp lm mq lq mr lu mj mk ml mm bi translated">1.3 —历元数</li></ul><p id="f47c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu"> 2)模型特定超参数</strong></p><ul class=""><li id="6963" class="me mf it lb b lc ld lf lg li mg lm mh lq mi lu mj mk ml mm bi translated">2.1 —隐藏单元的数量</li><li id="7fad" class="me mf it lb b lc mn lf mo li mp lm mq lq mr lu mj mk ml mm bi translated">2.2 —第一层</li><li id="1758" class="me mf it lb b lc mn lf mo li mp lm mq lq mr lu mj mk ml mm bi translated">2.3 —层数</li></ul></div><div class="ab cl ms mt hx mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="im in io ip iq"><h1 id="8063" class="mz na it bd nb nc nd ne nf ng nh ni nj jz nk ka nl kc nm kd nn kf no kg np nq bi translated">1.优化程序超参数</h1><p id="067f" class="pw-post-body-paragraph kz la it lb b lc nr ju le lf ns jx lh li nt lk ll lm nu lo lp lq nv ls lt lu im bi translated">它们更多地与优化和训练过程相关</p><h2 id="2c13" class="nw na it bd nb nx ny dn nf nz oa dp nj li ob oc nl lm od oe nn lq of og np oh bi translated"><strong class="ak"> 1.1 学习率:</strong></h2><blockquote class="oi"><p id="e3cd" class="oj ok it bd ol om on oo op oq or lu dk translated">一个最重要的超参数，你应该始终确保它已被调整 Yoshua Bengio</p></blockquote><p id="118a" class="pw-post-body-paragraph kz la it lb b lc os ju le lf ot jx lh li ou lk ll lm ov lo lp lq ow ls lt lu im bi translated">良好的起点= 0.01</p><p id="ad20" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果我们的学习率比最优值小，那么将需要更长的时间(数百或数千个)才能达到理想状态</p><p id="c337" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">或者，另一方面</p><p id="bd5d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果我们的学习速率比最优值大得多，那么它将超过理想状态，并且我们的算法可能不收敛</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ox"><img src="../Images/8fc60357f13158fde42ad9d212af2e5c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XV7-i1NwZ27_QYbcPkW8hQ.png"/></div></div></figure><p id="c7f7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这只是一个例证。在现实世界中，事情要复杂得多。</p><p id="5494" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">a)您的模型将有成百上千个参数，每个参数都有自己的误差曲线。学习率必须指导他们所有人</p><p id="582a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">b)误差曲线不是整齐的 u 形。它们有更复杂的局部极小值形状</p><h2 id="17f3" class="nw na it bd nb nx ny dn nf nz oa dp nj li ob oc nl lm od oe nn lq of og np oh bi translated"><strong class="ak"> 1.2 小批量尺寸:</strong></h2><p id="5025" class="pw-post-body-paragraph kz la it lb b lc nr ju le lf ns jx lh li nt lk ll lm nu lo lp lq nv ls lt lu im bi translated">批量大小对训练过程的资源需求、速度和迭代次数有影响，这种影响可能不像你想的那么微不足道</p><p id="5c97" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在历史上，有一个关于进行随机训练的争论，其中您将数据集的<em class="oy">单个示例拟合到模型，并且仅使用一个示例，进行正向传递，计算误差，然后反向传递，并为所有超参数设置调整值。然后对数据集中的每个示例重复此操作。</em></p><p id="57f3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">或者，最好将整个数据输入训练步骤，并使用通过查看数据集中的所有示例而生成的误差来计算梯度。这被称为批量训练</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oz"><img src="../Images/a1c9348aaa40da3013b87cfc77d7376e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1376/format:webp/1*WftBJvr1FcGmzwxB2RPS5Q.png"/></div></figure><p id="ed49" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">目前常用的方法是设置一个<strong class="lb iu">小批量。</strong></p><p id="b8c8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">随机训练是指小批量=1，批量训练是指小批量=训练集中的样本数</p><blockquote class="oi"><p id="eac2" class="oj ok it bd ol om on oo op oq or lu dk translated">推荐的实验起始值</p><p id="57ab" class="oj ok it bd ol om on oo op oq or lu dk">1, 2, 4, 8, 16, 32, 64, 128, 256</p></blockquote><p id="d02e" class="pw-post-body-paragraph kz la it lb b lc os ju le lf ot jx lh li ou lk ll lm ov lo lp lq ow ls lt lu im bi translated">较大的迷你批次大小允许在训练计算中利用矩阵乘法来提高计算能力，但这是以训练过程需要更多存储器为代价的。</p><p id="84bb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">较小的小批量会在误差计算中引入更多噪声，并且通常更有助于防止训练过程停止在局部最小值。</p><p id="b1c0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">小型批量的良好价值= 32</p><p id="114e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因此，虽然计算能力的提升激励我们增加迷你批次的大小，但这种实际的算法优势激励我们实际上让它变得更小</p><h2 id="60e8" class="nw na it bd nb nx ny dn nf nz oa dp nj li ob oc nl lm od oe nn lq of og np oh bi translated"><strong class="ak"> 1.3 历元数:</strong></h2><p id="59e3" class="pw-post-body-paragraph kz la it lb b lc nr ju le lf ns jx lh li nt lk ll lm nu lo lp lq nv ls lt lu im bi translated">为了给我们的训练步骤选择正确的历元数，我们应该关注的度量是验证误差。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pa"><img src="../Images/a43c581fa211261020252b6a47a5926e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ddy-SMO8w7auj399ePYfSg.png"/></div></div></figure><p id="5e5f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">直观的手动方法是，只要验证误差不断减小，就让模型训练尽可能多的迭代次数。</p><p id="09ef" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">有一种技术叫做提前停止来决定什么时候停止训练模型。如果验证误差在过去 10 或 20 个时期内没有改善，则停止训练过程</p><h1 id="37e6" class="mz na it bd nb nc pb ne nf ng pc ni nj jz pd ka nl kc pe kd nn kf pf kg np nq bi translated">2.模型超参数</h1><p id="1a94" class="pw-post-body-paragraph kz la it lb b lc nr ju le lf ns jx lh li nt lk ll lm nu lo lp lq nv ls lt lu im bi translated">他们更多地参与到模型的结构中</p><h2 id="ef1e" class="nw na it bd nb nx ny dn nf nz oa dp nj li ob oc nl lm od oe nn lq of og np oh bi translated"><strong class="ak"> 2.1 隐藏单元数量:</strong></h2><p id="ea98" class="pw-post-body-paragraph kz la it lb b lc nr ju le lf ns jx lh li nt lk ll lm nu lo lp lq nv ls lt lu im bi translated">隐藏单元数是其中最神秘的超参数之一。</p><p id="c2f9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">神经网络是通用函数逼近器，对于学习逼近函数(或预测任务)的网络，它需要有足够的“能力”来学习函数</p><blockquote class="oi"><p id="3807" class="oj ok it bd ol om on oo op oq or lu dk translated">隐单元的数量是衡量模型学习能力的主要指标</p></blockquote><figure class="ph pi pj pk pl kn gh gi paragraph-image"><div class="gh gi pg"><img src="../Images/fcb0a77c2450d3dc33c0fed993373f04.png" data-original-src="https://miro.medium.com/v2/resize:fit:906/format:webp/1*QSym_FR9IfYRVW8wt9SfeQ.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">‘Learning Capacity’ for a Simple Function</figcaption></figure><p id="35c0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于一个简单的函数，它可能需要较少数量的隐藏单元。</p><p id="b620" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">函数越复杂，模型需要的学习能力就越强</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pm"><img src="../Images/45b7dc9a6a2bae992f79421c9828b317.png" data-original-src="https://miro.medium.com/v2/resize:fit:1062/format:webp/1*d5lfT2npId2RqP1jGpAKvg.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">‘Learning Capacity’ for a Complex Function</figcaption></figure><p id="6f90" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">单位数量略多于最佳数量不是问题，但数量大得多会导致模型过度拟合，即如果您提供的模型容量过大，它可能会过度拟合，并试图记住数据集。</p><h2 id="204e" class="nw na it bd nb nx ny dn nf nz oa dp nj li ob oc nl lm od oe nn lq of og np oh bi translated"><strong class="ak"> 2.2 第一个隐藏层:</strong></h2><p id="41fd" class="pw-post-body-paragraph kz la it lb b lc nr ju le lf ns jx lh li nt lk ll lm nu lo lp lq nv ls lt lu im bi translated">涉及第一隐藏层的另一个启发是，已经观察到，将隐藏单元的数量设置为大于输入的数量会在任务数量上给出更好的结果。</p><h2 id="f951" class="nw na it bd nb nx ny dn nf nz oa dp nj li ob oc nl lm od oe nn lq of og np oh bi translated"><strong class="ak"> 2.3 层数:</strong></h2><p id="5fac" class="pw-post-body-paragraph kz la it lb b lc nr ju le lf ns jx lh li nt lk ll lm nu lo lp lq nv ls lt lu im bi translated">Andrej Karpathy 在他的博客中告诉我们，在实践中，3 层神经网络往往会优于 2 层网络。但是更深入的研究很少会有更大的帮助。</p><p id="bb57" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">卷积神经网络是一个例外，它越深入，性能越好。</p><h1 id="8039" class="mz na it bd nb nc pb ne nf ng pc ni nj jz pd ka nl kc pe kd nn kf pf kg np nq bi translated">感谢阅读！</h1><ul class=""><li id="699e" class="me mf it lb b lc nr lf ns li pn lm po lq pp lu mj mk ml mm bi translated">如果你喜欢这个，<a class="ae ky" href="https://medium.com/@samarth.agrawal.86" rel="noopener">关注我的 medium </a>了解更多。</li><li id="ca1d" class="me mf it lb b lc mn lf mo li mp lm mq lq mr lu mj mk ml mm bi translated">你的掌声对你写更多、写得更好是一个巨大的鼓励和动力。</li><li id="c006" class="me mf it lb b lc mn lf mo li mp lm mq lq mr lu mj mk ml mm bi translated">有兴趣合作吗？我们在<a class="ae ky" href="https://www.linkedin.com/in/samarth-agrawal-2501/" rel="noopener ugc nofollow" target="_blank"> Linkedin </a>上连线吧。</li><li id="fda6" class="me mf it lb b lc mn lf mo li mp lm mq lq mr lu mj mk ml mm bi translated">请随意写下您的想法/建议/反馈。</li></ul><p id="faf7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">参考资料:<a class="ae ky" href="https://in.udacity.com/course/deep-learning-nanodegree--nd101" rel="noopener ugc nofollow" target="_blank"> Udacity_DeepLearning </a></p></div></div>    
</body>
</html>