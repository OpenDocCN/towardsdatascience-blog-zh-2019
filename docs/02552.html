<html>
<head>
<title>A State-Of-The-Art Image Classifier on Your Dataset in Less Than 10 Minutes</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在不到 10 分钟的时间内对数据集进行最先进的图像分类</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/https-medium-com-drchemlal-deep-learning-tutorial-1-f94156d79802?source=collection_archive---------2-----------------------#2019-04-26">https://towardsdatascience.com/https-medium-com-drchemlal-deep-learning-tutorial-1-f94156d79802?source=collection_archive---------2-----------------------#2019-04-26</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/dc7c35097c435a662cd457adf5059c99.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*0jJC5bhbMsB74uAP"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk">Photo by <a class="ae kf" href="https://unsplash.com/@andremouton?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Andre Mouton</a> on <a class="ae kf" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><blockquote class="kg kh ki"><p id="c5fa" class="kj kk kl km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh im bi translated">2019 年 7 月 3 日更新。</p></blockquote><p id="d529" class="pw-post-body-paragraph kj kk it km b kn ko kp kq kr ks kt ku li kw kx ky lj la lb lc lk le lf lg lh im bi translated">这个简短的教程是在您选择的任何<strong class="km iu">图像数据集上构建和训练图像识别器的分步指南。</strong></p><p id="5604" class="pw-post-body-paragraph kj kk it km b kn ko kp kq kr ks kt ku li kw kx ky lj la lb lc lk le lf lg lh im bi translated">在本教程中，您将学习如何:</p><ul class=""><li id="8394" class="ll lm it km b kn ko kr ks li ln lj lo lk lp lh lq lr ls lt bi translated">从谷歌图片中抓取图片，创建你自己的数据集</li><li id="c32d" class="ll lm it km b kn lu kr lv li lw lj lx lk ly lh lq lr ls lt bi translated">在数据集上构建和训练图像识别器</li><li id="7c01" class="ll lm it km b kn lu kr lv li lw lj lx lk ly lh lq lr ls lt bi translated">可视化并充分解释分类结果</li><li id="8cb2" class="ll lm it km b kn lu kr lv li lw lj lx lk ly lh lq lr ls lt bi translated">用新图像测试模型</li></ul><p id="da5c" class="pw-post-body-paragraph kj kk it km b kn ko kp kq kr ks kt ku li kw kx ky lj la lb lc lk le lf lg lh im bi translated"><strong class="km iu">要运行这个笔记本，只需在这里用 Google Colab</strong><a class="ae kf" href="https://colab.research.google.com/github/SalChem/Fastai-iNotes-iTutorials/blob/master/Image_Recognizer_Tutorial.ipynb" rel="noopener ugc nofollow" target="_blank"><strong class="km iu"/></a><strong class="km iu">打开即可。</strong></p><p id="3fc4" class="pw-post-body-paragraph kj kk it km b kn ko kp kq kr ks kt ku li kw kx ky lj la lb lc lk le lf lg lh im bi translated">该笔记本是完全独立的，没有错误，所以你可以运行它。</p><p id="3279" class="pw-post-body-paragraph kj kk it km b kn ko kp kq kr ks kt ku li kw kx ky lj la lb lc lk le lf lg lh im bi translated">一旦进入 Colab，<strong class="km iu"> <em class="kl">确保更改以下内容以启用 GPU 后端，</em> </strong></p><p id="ec4e" class="pw-post-body-paragraph kj kk it km b kn ko kp kq kr ks kt ku li kw kx ky lj la lb lc lk le lf lg lh im bi translated"><em class="kl">运行时- &gt;更改运行时类型- &gt;硬件加速器- &gt; GPU </em></p><h1 id="87b3" class="lz ma it bd mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw bi translated">1.图像数据集下载和设置</h1><p id="b4b2" class="pw-post-body-paragraph kj kk it km b kn mx kp kq kr my kt ku li mz kx ky lj na lb lc lk nb lf lg lh im bi translated"><strong class="km iu">选项 1: </strong>使用您自己的数据集</p><p id="a96a" class="pw-post-body-paragraph kj kk it km b kn ko kp kq kr ks kt ku li kw kx ky lj la lb lc lk le lf lg lh im bi translated">如果您想使用自己的图像数据集，请重新排列它，使同一类的图像位于同一文件夹下。然后，用相应的类别标签命名文件夹。</p><p id="03d7" class="pw-post-body-paragraph kj kk it km b kn ko kp kq kr ks kt ku li kw kx ky lj la lb lc lk le lf lg lh im bi translated"><strong class="km iu">选项 2: </strong>从谷歌图片中抓取图片</p><p id="6363" class="pw-post-body-paragraph kj kk it km b kn ko kp kq kr ks kt ku li kw kx ky lj la lb lc lk le lf lg lh im bi translated">如果你手头没有数据集，你可以从<a class="ae kf" href="https://www.google.com/imghp?hl=en" rel="noopener ugc nofollow" target="_blank">谷歌图片</a>中抓取图片，组成一个你选择的数据集。为此，只需在您的谷歌 chrome 浏览器上安装<a class="ae kf" href="https://chrome.google.com/webstore/detail/fatkun-batch-download-ima/nnjjahlikiabnchcpehcpkdeckfgnohf" rel="noopener ugc nofollow" target="_blank"> Fatkun 批量下载图片</a>扩展，并通过点击扩展选项卡下载任何一组谷歌图片。将同一类别的所有图像放在同一文件夹下，并相应地命名文件夹。</p><p id="5c25" class="pw-post-body-paragraph kj kk it km b kn ko kp kq kr ks kt ku li kw kx ky lj la lb lc lk le lf lg lh im bi translated"><strong class="km iu">选项 3: </strong>使用我的猴子数据集，这是我最初从谷歌图片上搜集的:)</p><p id="98e6" class="pw-post-body-paragraph kj kk it km b kn ko kp kq kr ks kt ku li kw kx ky lj la lb lc lk le lf lg lh im bi translated">可以使用以下几个 bash 命令下载和解压缩数据集。</p><figure class="nc nd ne nf gt ju"><div class="bz fp l di"><div class="ng nh l"/></div></figure><p id="56af" class="pw-post-body-paragraph kj kk it km b kn ko kp kq kr ks kt ku li kw kx ky lj la lb lc lk le lf lg lh im bi translated">在本教程中，我们将对<strong class="km iu">猴子</strong>进行分类，因此我们创建了 6 个文件夹，对应 6 种不同类型的猴子，如下所示。</p><figure class="nc nd ne nf gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi ni"><img src="../Images/21e6c75c75e9a5bde50eb213047aab71.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3Z1U4mDxv_SqF0ZqmKFuNg.png"/></div></div></figure><figure class="nc nd ne nf gt ju gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/3f788b37544eb2b20d1400f5a9b033b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:380/format:webp/1*rcubdNgR617nJTydf0fgfQ.png"/></div></figure><p id="cb87" class="pw-post-body-paragraph kj kk it km b kn ko kp kq kr ks kt ku li kw kx ky lj la lb lc lk le lf lg lh im bi translated">如果您使用您的数据集运行此笔记本，只需将上面单元格中的 url 和文件名替换为您的。存储。Dropbox 中的 tar 文件对我来说效果最好。</p><h1 id="8ed9" class="lz ma it bd mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw bi translated">2.图像识别</h1><blockquote class="nk"><p id="71fd" class="nl nm it bd nn no np nq nr ns nt lh dk translated">关于代码和函数的更详细的解释可以在我的另一个综合教程<strong class="ak"> </strong> ⬇中找到</p></blockquote><div class="nu nv nw nx ny nz"><a rel="noopener follow" target="_blank" href="/a-comprehensive-state-of-the-art-image-recognition-tutorial-c34c544d0b4"><div class="oa ab fo"><div class="ob ab oc cl cj od"><h2 class="bd iu gy z fp oe fr fs of fu fw is bi translated">一个全面的最先进的图像识别教程</h2><div class="og l"><h3 class="bd b gy z fp oe fr fs of fu fw dk translated">使用 fastai 和 PyTorch 解密 CNN、ResNets、迁移学习、微调和 1Cycle 策略</h3></div><div class="oh l"><p class="bd b dl z fp oe fr fs of fu fw dk translated">towardsdatascience.com</p></div></div><div class="oi l"><div class="oj l ok ol om oi on jz nz"/></div></div></a></div><h1 id="0ff6" class="lz ma it bd mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw bi translated">初始化</h1><figure class="nc nd ne nf gt ju"><div class="bz fp l di"><div class="ng nh l"/></div></figure><p id="2b9e" class="pw-post-body-paragraph kj kk it km b kn ko kp kq kr ks kt ku li kw kx ky lj la lb lc lk le lf lg lh im bi translated">PATH 是包含所有类文件夹的路径。如果使用自己的数据集，请相应地更改路径。</p><p id="3b7b" class="pw-post-body-paragraph kj kk it km b kn ko kp kq kr ks kt ku li kw kx ky lj la lb lc lk le lf lg lh im bi translated">让我们检索图像类，</p><figure class="nc nd ne nf gt ju"><div class="bz fp l di"><div class="ng nh l"/></div></figure><pre class="nc nd ne nf gt oo op oq or aw os bi"><span id="911b" class="ot ma it op b gy ou ov l ow ox">There are  6 classes:<br/> ['Macaque', 'Orungatun', 'Chimpanzee', 'Gorilla', 'Mandrill', 'Gibbon']</span></pre><p id="7021" class="pw-post-body-paragraph kj kk it km b kn ko kp kq kr ks kt ku li kw kx ky lj la lb lc lk le lf lg lh im bi translated">让我们验证没有任何无法读取的损坏图像。如果找到了，它们将被删除。</p><figure class="nc nd ne nf gt ju"><div class="bz fp l di"><div class="ng nh l"/></div></figure><h1 id="5641" class="lz ma it bd mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw bi translated">创建和训练分类器</h1><p id="f7ea" class="pw-post-body-paragraph kj kk it km b kn mx kp kq kr my kt ku li mz kx ky lj na lb lc lk nb lf lg lh im bi translated">让我们创建我们的训练和验证集，80%的数据集将用于训练，20%用于验证。</p><figure class="nc nd ne nf gt ju"><div class="bz fp l di"><div class="ng nh l"/></div></figure><pre class="nc nd ne nf gt oo op oq or aw os bi"><span id="0394" class="ot ma it op b gy ou ov l ow ox">There are 268 training images and 67 validation images.</span></pre><p id="78f7" class="pw-post-body-paragraph kj kk it km b kn ko kp kq kr ks kt ku li kw kx ky lj la lb lc lk le lf lg lh im bi translated">让我们想象一些不同班级的图片，</p><figure class="nc nd ne nf gt ju"><div class="bz fp l di"><div class="ng nh l"/></div></figure><figure class="nc nd ne nf gt ju gh gi paragraph-image"><div class="gh gi oy"><img src="../Images/0902713cb2185d79ba804730afe98f92.png" data-original-src="https://miro.medium.com/v2/resize:fit:992/format:webp/1*oVOqAaPXMhuKIrhpvaBMEQ.png"/></div></figure><p id="2f71" class="pw-post-body-paragraph kj kk it km b kn ko kp kq kr ks kt ku li kw kx ky lj la lb lc lk le lf lg lh im bi translated">让我们建立我们的深度卷积神经网络(CNN)，</p><figure class="nc nd ne nf gt ju"><div class="bz fp l di"><div class="ng nh l"/></div></figure><p id="6713" class="pw-post-body-paragraph kj kk it km b kn ko kp kq kr ks kt ku li kw kx ky lj la lb lc lk le lf lg lh im bi translated">我们使用<a class="ae kf" href="https://arxiv.org/pdf/1512.03385.pdf" rel="noopener ugc nofollow" target="_blank"> <strong class="km iu"> ResNet34 </strong> </a>作为我们的模型架构。ResNet architecture 在过去几年中取得了巨大的成功，并且仍然被认为是最先进的。</p><p id="73f8" class="pw-post-body-paragraph kj kk it km b kn ko kp kq kr ks kt ku li kw kx ky lj la lb lc lk le lf lg lh im bi translated">查看我的另一篇文章，了解更多关于 CNN、resnets、迁移学习、微调、1 周期策略调度器和更多⬇.的信息本教程全面而简洁，您将对底层架构和培训过程有一个很好的理解。</p><div class="oz pa gp gr pb nz"><a rel="noopener follow" target="_blank" href="/a-comprehensive-state-of-the-art-image-recognition-tutorial-c34c544d0b4"><div class="oa ab fo"><div class="ob ab oc cl cj od"><h2 class="bd iu gy z fp oe fr fs of fu fw is bi translated">一个全面的最先进的图像识别教程</h2><div class="og l"><h3 class="bd b gy z fp oe fr fs of fu fw dk translated">使用 fastai 和 PyTorch 解密 CNN、ResNets、迁移学习、微调和 1Cycle 策略</h3></div><div class="oh l"><p class="bd b dl z fp oe fr fs of fu fw dk translated">towardsdatascience.com</p></div></div><div class="oi l"><div class="oj l ok ol om oi on jz nz"/></div></div></a></div><p id="3c9f" class="pw-post-body-paragraph kj kk it km b kn ko kp kq kr ks kt ku li kw kx ky lj la lb lc lk le lf lg lh im bi translated">尽管我们在这里使用的是 ResNet34，你也可以尝试其他<a class="ae kf" href="https://pytorch.org/docs/stable/torchvision/models.html#id3" rel="noopener ugc nofollow" target="_blank"> ResNet 型号</a>。<em class="kl"> </em>但是，请记住，增加层数将需要更多的 GPU 内存。</p><p id="1d96" class="pw-post-body-paragraph kj kk it km b kn ko kp kq kr ks kt ku li kw kx ky lj la lb lc lk le lf lg lh im bi translated">让我们训练模型，</p><figure class="nc nd ne nf gt ju"><div class="bz fp l di"><div class="ng nh l"/></div></figure><figure class="nc nd ne nf gt ju gh gi paragraph-image"><div class="gh gi pc"><img src="../Images/597a0669ba11a010c437d1eb2de1cbab.png" data-original-src="https://miro.medium.com/v2/resize:fit:924/format:webp/1*PMrMy2j6H7WonX7uezmXCQ.png"/></div></figure><p id="ca72" class="pw-post-body-paragraph kj kk it km b kn ko kp kq kr ks kt ku li kw kx ky lj la lb lc lk le lf lg lh im bi translated">太好了，我们只用几行代码就达到了很高的分类精度。</p><p id="5139" class="pw-post-body-paragraph kj kk it km b kn ko kp kq kr ks kt ku li kw kx ky lj la lb lc lk le lf lg lh im bi translated">我们完成了，但是让我们进一步解释结果。</p><h1 id="bcbc" class="lz ma it bd mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw bi translated">3.结果解释和可视化</h1><figure class="nc nd ne nf gt ju"><div class="bz fp l di"><div class="ng nh l"/></div></figure><p id="b095" class="pw-post-body-paragraph kj kk it km b kn ko kp kq kr ks kt ku li kw kx ky lj la lb lc lk le lf lg lh im bi translated">我们可以从想象一个混乱矩阵开始。对角线元素表示预测标签等于真实标签的图像的数量，而非对角线元素是那些被分类器错误标记的图像。</p><figure class="nc nd ne nf gt ju"><div class="bz fp l di"><div class="ng nh l"/></div></figure><figure class="nc nd ne nf gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi pd"><img src="../Images/63991c49f617d20ab3bf4ab81b8754b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tkuoV_QeSJC65Pw5CeG7yA.png"/></div></div></figure><p id="6b84" class="pw-post-body-paragraph kj kk it km b kn ko kp kq kr ks kt ku li kw kx ky lj la lb lc lk le lf lg lh im bi translated">我们还可以绘制损失最大的图像，这些图像是模型最困惑的图像。高损失意味着对错误答案的高度信任。</p><figure class="nc nd ne nf gt ju"><div class="bz fp l di"><div class="ng nh l"/></div></figure><p id="d8c7" class="pw-post-body-paragraph kj kk it km b kn ko kp kq kr ks kt ku li kw kx ky lj la lb lc lk le lf lg lh im bi translated">图像与顶部损失一起显示:<br/>预测标签/实际标签/损失/实际图像类别的概率。</p><figure class="nc nd ne nf gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi pe"><img src="../Images/bc8b84408301feb0fb8d35714c93820f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6cSPKTFRVcyRc27FMzchbQ.png"/></div></div></figure><h2 id="0d8a" class="ot ma it bd mb pf pg dn mf ph pi dp mj li pj pk mn lj pl pm mr lk pn po mv pp bi translated">4.在新图像上测试模型</h2><p id="89b2" class="pw-post-body-paragraph kj kk it km b kn mx kp kq kr my kt ku li mz kx ky lj na lb lc lk nb lf lg lh im bi translated">现在让我们给这个模型一个它以前从未见过的新图像，看看它做得有多好。</p><p id="9728" class="pw-post-body-paragraph kj kk it km b kn ko kp kq kr ks kt ku li kw kx ky lj la lb lc lk le lf lg lh im bi translated">将图像上传到此笔记本的同一文件夹中。</p><figure class="nc nd ne nf gt ju"><div class="bz fp l di"><div class="ng nh l"/></div></figure><figure class="nc nd ne nf gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi pq"><img src="../Images/401b333817df932eddcb507842cc64c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0CBUFbrA077ZttCsX4NljQ.jpeg"/></div></div></figure><pre class="nc nd ne nf gt oo op oq or aw os bi"><span id="ac09" class="ot ma it op b gy ou ov l ow ox">It is a Mandrill</span></pre><h1 id="ebb1" class="lz ma it bd mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw bi translated">祝贺您完成、阅读或浏览本教程。</h1><p id="3381" class="pw-post-body-paragraph kj kk it km b kn mx kp kq kr my kt ku li mz kx ky lj na lb lc lk nb lf lg lh im bi translated"><strong class="km iu">鸣谢:</strong>本教程使用<a class="ae kf" href="https://docs.fast.ai/index.html" rel="noopener ugc nofollow" target="_blank"> fastai 库</a>，在此感谢<a class="ae kf" href="https://twitter.com/jeremyphoward" rel="noopener ugc nofollow" target="_blank">杰瑞米·霍华德</a>和<a class="ae kf" href="https://www.fast.ai/" rel="noopener ugc nofollow" target="_blank"> fast.ai </a>。我也感谢戴夫·史密斯的善意编辑。</p><p id="3558" class="pw-post-body-paragraph kj kk it km b kn ko kp kq kr ks kt ku li kw kx ky lj la lb lc lk le lf lg lh im bi translated">我希望这篇简短的教程对你有所帮助。请分享它，并给它一些掌声，这样它也可以到达其他人😀欢迎留下任何评论，在 Twitter @ <a class="ae kf" href="https://twitter.com/SalimChemlal" rel="noopener ugc nofollow" target="_blank"> SalimChemlal </a>上与我联系，并在<a class="ae kf" href="https://medium.com/@drchemlal" rel="noopener"> Medium </a>上关注我了解更多信息！</p></div></div>    
</body>
</html>