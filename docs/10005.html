<html>
<head>
<title>Detection of Surface Cracks in Concrete Structures using Deep Learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">基于深度学习的混凝土结构表面裂缝检测</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/detection-of-surface-cracks-in-concrete-structures-using-deep-learning-f8f85cd8ac8b?source=collection_archive---------6-----------------------#2019-12-31">https://towardsdatascience.com/detection-of-surface-cracks-in-concrete-structures-using-deep-learning-f8f85cd8ac8b?source=collection_archive---------6-----------------------#2019-12-31</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="29e8" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated"><em class="ki">用数据做酷事！</em></h2></div><figure class="kk kl km kn gt ko gh gi paragraph-image"><div class="gh gi kj"><img src="../Images/99abdea9e8de8e3b3cd27694dd16a539.png" data-original-src="https://miro.medium.com/v2/resize:fit:948/format:webp/1*fofodl_HDFwrvhvxF9Sh0g.jpeg"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Crack in Concrete Building</figcaption></figure><h1 id="36d6" class="kv kw it bd kx ky kz la lb lc ld le lf jz lg ka lh kc li kd lj kf lk kg ll lm bi translated">介绍</h1><p id="a025" class="pw-post-body-paragraph ln lo it lp b lq lr ju ls lt lu jx lv lw lx ly lz ma mb mc md me mf mg mh mi im bi translated">表面裂缝的检测是混凝土结构健康监测中的一项重要任务。如果裂缝发展并继续扩展，它们会减少有效的承载表面积，并且随着时间的推移会导致结构的失效。裂纹检测的手动过程费时费力，并且受到检查员主观判断的影响。在高层建筑和桥梁的情况下，人工检查也很难进行。在这篇博客中，我们使用深度学习来建立一个简单但非常准确的裂缝检测模型。此外，我们在真实世界数据上测试该模型，并且看到该模型在检测混凝土和非混凝土结构示例道路中的表面裂缝方面是准确的。代码在我的<a class="ae mj" href="https://github.com/priya-dwivedi/Deep-Learning/tree/master/crack_detection" rel="noopener ugc nofollow" target="_blank"> Github 的链接</a>上是开源的。</p><p id="4b0a" class="pw-post-body-paragraph ln lo it lp b lq mk ju ls lt ml jx lv lw mm ly lz ma mn mc md me mo mg mh mi im bi translated">原文全文刊登在<a class="ae mj" href="https://deeplearninganalytics.org" rel="noopener ugc nofollow" target="_blank">我的网站</a> <a class="ae mj" href="https://deeplearninganalytics.org/detection-of-surface-cracks-in-concrete-structures-using-deep-learning/" rel="noopener ugc nofollow" target="_blank">这里</a>。</p><h1 id="43ca" class="kv kw it bd kx ky kz la lb lc ld le lf jz lg ka lh kc li kd lj kf lk kg ll lm bi translated">数据集</h1><p id="aa79" class="pw-post-body-paragraph ln lo it lp b lq lr ju ls lt lu jx lv lw lx ly lz ma mb mc md me mf mg mh mi im bi translated">对于这个博客，我们使用公开可用的<a class="ae mj" href="https://data.mendeley.com/datasets/5y9wdsg2zt/2" rel="noopener ugc nofollow" target="_blank">混凝土裂缝图像数据集</a>。Ozgenel 和 Gonenc 在<a class="ae mj" href="https://www.researchgate.net/publication/326676263_Performance_Comparison_of_Pretrained_Convolutional_Neural_Networks_on_Crack_Detection_in_Buildings" rel="noopener ugc nofollow" target="_blank">论文</a>中公开了该数据集。</p><p id="407f" class="pw-post-body-paragraph ln lo it lp b lq mk ju ls lt ml jx lv lw mm ly lz ma mn mc md me mo mg mh mi im bi translated">数据集由 20，000 幅有裂缝的混凝土结构图像和 20，000 幅无裂缝的图像组成。该数据集由 458 幅高分辨率图像(4032x3024 像素)生成。数据集中的每个图像都是 227 x 227 像素的 RGB 图像。一些有裂缝和无裂缝的样本图像如下所示:</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="gh gi mp"><img src="../Images/346132342497fe32f63b4cd20a2d7bf7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*a-33MnJhDy3pIyALEraBKA.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Sample images with cracks</figcaption></figure><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="gh gi mu"><img src="../Images/12a3932b7a22dee1911cf1421607a93f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QJu-0nJ4J3nRXDO3-UAztw.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Sample images without cracks</figcaption></figure><p id="352f" class="pw-post-body-paragraph ln lo it lp b lq mk ju ls lt ml jx lv lw mm ly lz ma mn mc md me mo mg mh mi im bi translated">可以看到，数据集有各种各样的图像——不同颜色的石板，不同强度和形状的裂缝。</p><h1 id="8574" class="kv kw it bd kx ky kz la lb lc ld le lf jz lg ka lh kc li kd lj kf lk kg ll lm bi translated">模型构建</h1><p id="54a3" class="pw-post-body-paragraph ln lo it lp b lq lr ju ls lt lu jx lv lw lx ly lz ma mb mc md me mf mg mh mi im bi translated">针对这个问题，我们用 Pytorch 搭建一个卷积神经网络(CNN)。由于我们的图像数量有限，我们将使用预训练的网络作为起点，并使用图像增强来进一步提高准确性。图像增强允许我们进行变换，如垂直和水平翻转、旋转和亮度变化，从而显著增加样本并帮助模型泛化。</p><p id="752a" class="pw-post-body-paragraph ln lo it lp b lq mk ju ls lt ml jx lv lw mm ly lz ma mn mc md me mo mg mh mi im bi translated">对于以下步骤，请跟随我在 Github 上的<a class="ae mj" href="https://github.com/priya-dwivedi/Deep-Learning/blob/master/crack_detection/Crack%20Detection%20Model.ipynb" rel="noopener ugc nofollow" target="_blank">代码。</a></p><p id="05ef" class="pw-post-body-paragraph ln lo it lp b lq mk ju ls lt ml jx lv lw mm ly lz ma mn mc md me mo mg mh mi im bi translated"><strong class="lp iu">将输入数据混洗并分割成训练和赋值</strong></p><p id="9099" class="pw-post-body-paragraph ln lo it lp b lq mk ju ls lt ml jx lv lw mm ly lz ma mn mc md me mo mg mh mi im bi translated">下载的数据将有两个文件夹，一个用于正极，一个用于负极。我们需要把这个分成 train 和 val。下面的代码片段将为 train 和 val 创建新的文件夹，并将 85%的数据随机放入 train，将 rest 放入 val。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="gh gi mv"><img src="../Images/d3de9d6dda6ce11f56526edd47270678.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-AVnLQZTY3WHGlHis3x1Gg.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Split into train and val</figcaption></figure><p id="04f3" class="pw-post-body-paragraph ln lo it lp b lq mk ju ls lt ml jx lv lw mm ly lz ma mn mc md me mo mg mh mi im bi translated"><strong class="lp iu">应用变换</strong></p><p id="4f4e" class="pw-post-body-paragraph ln lo it lp b lq mk ju ls lt ml jx lv lw mm ly lz ma mn mc md me mo mg mh mi im bi translated">Pytorch 使应用数据转换变得容易，这可以增加训练数据并帮助模型一般化。我选择的变换是随机旋转、随机水平和垂直翻转以及随机颜色抖动。此外，每个通道除以 255，然后归一化。这有助于神经网络训练。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="gh gi mw"><img src="../Images/d5099e14442b3e693a286ae3d8171e47.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nTmad7OnWjiNnihZ78_Cnw.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Transforms</figcaption></figure><p id="1a3c" class="pw-post-body-paragraph ln lo it lp b lq mk ju ls lt ml jx lv lw mm ly lz ma mn mc md me mo mg mh mi im bi translated"><strong class="lp iu">预训练模型</strong></p><p id="693c" class="pw-post-body-paragraph ln lo it lp b lq mk ju ls lt ml jx lv lw mm ly lz ma mn mc md me mo mg mh mi im bi translated">我们使用在 ImageNet 上预先训练的 Resnet 50 模型来启动该模型。要了解更多关于 ResNet 模型的信息，请阅读我的博客。如下所示，ResNet50 模型由 5 个阶段组成，每个阶段都有一个卷积和单位块。每个卷积块有 3 个卷积层，每个单位块也有 3 个卷积层。ResNet-50 拥有超过 2300 万个可训练参数。我们将冻结所有这些权重和 2 个更完全连接的层，第一层在输出中有 128 个神经元，第二层在输出中有 2 个神经元，这是最终的预测。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="gh gi mx"><img src="../Images/4b0a17e6f3496845b9357d0ea2548ce0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-m6J4UZ08s3zLTB4sW40RQ.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">ResNet50 Model</figcaption></figure><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="gh gi my"><img src="../Images/4c9872d4b9bea10ec089c1f256865403.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xDH3ArOlHaUbPu7v4Y2_eA.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">ResNet model layers</figcaption></figure><p id="56c6" class="pw-post-body-paragraph ln lo it lp b lq mk ju ls lt ml jx lv lw mm ly lz ma mn mc md me mo mg mh mi im bi translated">如模型摘要所示，该模型具有 2300 万个不可训练参数和 262K 个可训练参数</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div class="gh gi mz"><img src="../Images/69396e52e041ed459c6aafb3396e15ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:998/format:webp/1*WgeOqv_VIiwo8QjFVtqebg.png"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Model Parameters</figcaption></figure><p id="5362" class="pw-post-body-paragraph ln lo it lp b lq mk ju ls lt ml jx lv lw mm ly lz ma mn mc md me mo mg mh mi im bi translated">我们使用 Adam 作为优化器，对模型进行 6 个时期的训练。</p><h1 id="4fdc" class="kv kw it bd kx ky kz la lb lc ld le lf jz lg ka lh kc li kd lj kf lk kg ll lm bi translated">真实图像上的模型训练和预测</h1><p id="5780" class="pw-post-body-paragraph ln lo it lp b lq lr ju ls lt lu jx lv lw lx ly lz ma mb mc md me mf mg mh mi im bi translated">我们使用迁移学习，然后在训练数据集上训练模型，同时在验证集上测量损失和准确性。正如下面的损失和准确性数字所示，模型训练非常快。在第一个历元之后，训练准确率为 87%，验证准确率为 97%！。这就是迁移学习的力量。我们的最终模型的验证准确率为 98.4%。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div class="gh gi na"><img src="../Images/665afaac0c5f9242225949085e4f0fac.png" data-original-src="https://miro.medium.com/v2/resize:fit:878/format:webp/1*uRau5toN7XBdQPr0FdKrew.png"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Model Training Stats</figcaption></figure><p id="68c9" class="pw-post-body-paragraph ln lo it lp b lq mk ju ls lt ml jx lv lw mm ly lz ma mn mc md me mo mg mh mi im bi translated"><strong class="lp iu">在真实世界图像上测试模型</strong></p><p id="c18b" class="pw-post-body-paragraph ln lo it lp b lq mk ju ls lt ml jx lv lw mm ly lz ma mn mc md me mo mg mh mi im bi translated">现在最有趣的部分来了。是的，该模型对验证数据起作用，但我们想确保它也对来自互联网的看不见的数据起作用。为了测试这一点，我们随机拍摄了开裂的混凝土结构和路面裂缝的图像。这些图像比我们的训练图像大得多。请记住，该模型是在 227，227 像素的作物上训练的。我们现在将输入图像分成小块，并对其进行预测。如果模型预测有裂缝，我们就把补丁涂成红色(有裂缝),否则就把补丁涂成绿色。下面的代码片段可以做到这一点。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="gh gi nb"><img src="../Images/b75e47bec7dae007b58a2729e926afb1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oi8HHAJmb7iBZLBWj6XdOA.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Prediction on crops</figcaption></figure><p id="0a36" class="pw-post-body-paragraph ln lo it lp b lq mk ju ls lt ml jx lv lw mm ly lz ma mn mc md me mo mg mh mi im bi translated">该模型在以前从未见过的图像上表现得非常好。如下图所示，该模型能够通过处理图像上的数百个补丁来检测混凝土中非常长的裂缝。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="gh gi nc"><img src="../Images/170985f5587d62b430d85bb8d4bf1da8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jw2QkPf6D2wzvCGd8nasCQ.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Crack Detection on Concrete. Left-Original Image. Right-Red regions are predictions with crack and green regions are predictions of no crack</figcaption></figure><p id="6418" class="pw-post-body-paragraph ln lo it lp b lq mk ju ls lt ml jx lv lw mm ly lz ma mn mc md me mo mg mh mi im bi translated">此外，我还在路面裂缝上测试了该模型。这个模型不是在路面上训练出来的，但它在挑选路面裂缝方面也做得很好！</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/cdca4d53f47c5b91ffd37d8a8b281025.png" data-original-src="https://miro.medium.com/v2/resize:fit:1366/format:webp/1*qgPpsb74WgvHYRDELgjihA.png"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Crack Detection on Roads. Left-Original Image. Right-Red regions are predictions with crack and green regions are predictions of no crack</figcaption></figure><p id="183a" class="pw-post-body-paragraph ln lo it lp b lq mk ju ls lt ml jx lv lw mm ly lz ma mn mc md me mo mg mh mi im bi translated">更多真实世界的图像和模型预测在这个项目的<a class="ae mj" href="https://github.com/priya-dwivedi/Deep-Learning/tree/master/crack_detection/real_images" rel="noopener ugc nofollow" target="_blank"> github link </a>上分享。</p><h1 id="cf19" class="kv kw it bd kx ky kz la lb lc ld le lf jz lg ka lh kc li kd lj kf lk kg ll lm bi translated">结论</h1><p id="22ed" class="pw-post-body-paragraph ln lo it lp b lq lr ju ls lt lu jx lv lw lx ly lz ma mb mc md me mf mg mh mi im bi translated">这篇博客展示了使用深度学习和开源数据来构建现实世界的应用程序是多么容易。整个工作花了半天时间，并输出了一个实用的解决方案。我希望您亲自尝试这些代码，并在更多真实世界的图像上进行测试。</p><p id="4982" class="pw-post-body-paragraph ln lo it lp b lq mk ju ls lt ml jx lv lw mm ly lz ma mn mc md me mo mg mh mi im bi translated">我对计算机视觉和深度学习充满热情。我有自己的深度学习咨询公司，喜欢研究有趣的问题。我已经帮助许多初创公司部署了基于人工智能的创新解决方案。请到 http://deeplearninganalytics.org/.<a class="ae mj" href="http://deeplearninganalytics.org/" rel="noopener ugc nofollow" target="_blank">的</a>来看看我们吧</p><p id="f6b3" class="pw-post-body-paragraph ln lo it lp b lq mk ju ls lt ml jx lv lw mm ly lz ma mn mc md me mo mg mh mi im bi translated">你也可以在 https://medium.com/@priya.dwivedi<a class="ae mj" href="https://medium.com/@priya.dwivedi" rel="noopener">的</a>看到我的其他作品</p><p id="fae9" class="pw-post-body-paragraph ln lo it lp b lq mk ju ls lt ml jx lv lw mm ly lz ma mn mc md me mo mg mh mi im bi translated">如果你有一个我们可以合作的项目，请通过我的网站或 info@deeplearninganalytics.org 联系我</p><h1 id="f7b6" class="kv kw it bd kx ky kz la lb lc ld le lf jz lg ka lh kc li kd lj kf lk kg ll lm bi translated">参考</h1><ul class=""><li id="94a3" class="ne nf it lp b lq lr lt lu lw ng ma nh me ni mi nj nk nl nm bi translated">2018—zgenel，f .，nenç Sorguç，a .“预训练卷积神经网络对建筑物裂缝检测的性能比较”，ISARC 2018，柏林。</li><li id="eb9e" class="ne nf it lp b lq nn lt no lw np ma nq me nr mi nj nk nl nm bi translated">关于裂纹检测重要性的好论文—<a class="ae mj" href="https://www.hindawi.com/journals/ace/2018/3924120/" rel="noopener ugc nofollow" target="_blank">https://www.hindawi.com/journals/ace/2018/3924120/</a></li><li id="a7ba" class="ne nf it lp b lq nn lt no lw np ma nq me nr mi nj nk nl nm bi translated">关于 Pytorch 中图像分类的好博客。博客中使用的几个代码片段来自这里。</li><li id="c6f5" class="ne nf it lp b lq nn lt no lw np ma nq me nr mi nj nk nl nm bi translated">另一个关于 Pytorch 中图像分类的好博客。博客中使用的几个代码片段来自这里。</li></ul></div></div>    
</body>
</html>