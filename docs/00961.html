<html>
<head>
<title>Deeper into DCGANs</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">深入到 DCGANs</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/deeper-into-dcgans-2556dbd0baac?source=collection_archive---------7-----------------------#2019-02-13">https://towardsdatascience.com/deeper-into-dcgans-2556dbd0baac?source=collection_archive---------7-----------------------#2019-02-13</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jn jo jp jq"><div class="bz fp l di"><div class="jr js l"/></div></figure><p id="4228" class="pw-post-body-paragraph jt ju iq jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq ij bi translated">我上一篇关于 DCGANs 的文章主要集中在用卷积替换全连接层和用 Keras 实现上采样卷积的想法上。本文将进一步解释 Raford 等人[1]提到的架构指南，以及论文中提到的其他主题，如使用 GAN 的无监督特征学习、GAN 过拟合和潜在空间插值。</p><figure class="kt ku kv kw gt jq gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ks"><img src="../Images/4c864e792dd788a22eeae900200e59c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5ALjnfAqwcWbOsledTBXsw.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk">DCGAN architecture used by Radford et al. [1] to generate 64x64 RGB bedroom images from the LSUN dataset</figcaption></figure><p id="52fe" class="pw-post-body-paragraph jt ju iq jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq ij bi translated">与 LAPGAN 或渐进增长 GAN 等多尺度架构相比，或者与最新的 BigGAN 相比，BigGAN 使用了许多辅助技术，如自我关注、频谱归一化和鉴别器投影等 DCGAN 是一个更容易完全理解的系统。</p><p id="aefb" class="pw-post-body-paragraph jt ju iq jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq ij bi translated">DCGAN 无法实现与 BigGAN 模型相当的图像质量，也不具备与 StyleGAN 几乎相同的潜在空间控制能力。然而，仍然值得考虑将 DCGAN 作为 GAN 研究的基础支柱。DCGAN 模型的基本组件是用这些上采样卷积层替换生成器中的全连接层。在设计这个架构时，作者引用了三个灵感来源。</p><ol class=""><li id="7bd3" class="lh li iq jv b jw jx ka kb ke lj ki lk km ll kq lm ln lo lp bi translated">全卷积网络→用空间下采样卷积代替汇集操作</li><li id="8112" class="lh li iq jv b jw lq ka lr ke ls ki lt km lu kq lm ln lo lp bi translated">消除卷积后的完全连接层</li><li id="8dd0" class="lh li iq jv b jw lq ka lr ke ls ki lt km lu kq lm ln lo lp bi translated">批量标准化→标准化激活以帮助梯度流动</li></ol><p id="0491" class="pw-post-body-paragraph jt ju iq jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq ij bi translated">考虑到这些进步，作者寻找了一种稳定的 DC-GAN 架构，并采用了以下架构准则:</p><ul class=""><li id="db35" class="lh li iq jv b jw jx ka kb ke lj ki lk km ll kq lv ln lo lp bi translated">用鉴别器中的步长卷积和生成器中的分数步长卷积替换任何池层</li><li id="91c4" class="lh li iq jv b jw lq ka lr ke ls ki lt km lu kq lv ln lo lp bi translated">在生成器和鉴别器中使用批处理规范化</li><li id="dfe5" class="lh li iq jv b jw lq ka lr ke ls ki lt km lu kq lv ln lo lp bi translated">为更深层次的架构移除完全连接的隐藏层</li><li id="9ad8" class="lh li iq jv b jw lq ka lr ke ls ki lt km lu kq lv ln lo lp bi translated">在发生器中对除 Tanh 外的所有层使用 ReLU 激活输出<em class="lw">(这些图像在[-1，1]而不是[0，1]之间标准化，因此 Tanh 在 sigmoid 上)</em></li><li id="b7b5" class="lh li iq jv b jw lq ka lr ke ls ki lt km lu kq lv ln lo lp bi translated">在所有层的鉴别器中使用 LeakyReLU 激活</li></ul><p id="8225" class="pw-post-body-paragraph jt ju iq jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq ij bi translated">这些建筑方针后来在现代甘文学中得到了扩展。例如，创成式模型中的批处理规范化有新出现的表亲，如虚拟批处理规范化、实例规范化和自适应实例规范化。Salimans 等人[2]提出了进一步的架构指导方针，并且<a class="ae kr" rel="noopener" target="_blank" href="/gan-ways-to-improve-gan-performance-acf37f9f59b">在这篇文章中做了很好的解释。</a></p><p id="89c2" class="pw-post-body-paragraph jt ju iq jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq ij bi translated">除了模型架构，本文还讨论了许多与 GAN 相关的有趣想法，如无监督学习、GAN 过拟合、GAN 特征可视化和潜在空间插值。</p><h1 id="da83" class="lx ly iq bd lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu bi translated">基于 GANs 的无监督学习</h1><p id="54d4" class="pw-post-body-paragraph jt ju iq jv b jw mv jy jz ka mw kc kd ke mx kg kh ki my kk kl km mz ko kp kq ij bi translated">已经探索了 GANs 的许多应用，并且大部分研究试图实现更高质量的图像合成。许多实现高质量图像合成的方法实际上是监督学习技术，因为它们需要类别标签进行调节。</p><p id="f14c" class="pw-post-body-paragraph jt ju iq jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq ij bi translated">这里的主要思想是使用由鉴别器学习的特征作为分类模型的特征提取器。具体来说，拉德福德等人探索了结合 L2 + SVM 分类模型的无监督 GAN 特征提取器的使用。SVM 模型使用损失函数和高维超平面，该损失函数旨在基于每个类中最近点之间的差值来最大化类间距离。SVM 模型是一个很好的分类器，然而，它不是一个特征提取器，将 SVM 应用于图像会导致大量的局部极小值，本质上使问题变得难以处理。因此，DC-甘充当特征提取器，其以语义保留的方式减少图像的维度，使得 SVM 可以学习辨别模型。</p><h1 id="f874" class="lx ly iq bd lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu bi translated"><strong class="ak">甘过拟合</strong></h1><p id="3410" class="pw-post-body-paragraph jt ju iq jv b jw mv jy jz ka mw kc kd ke mx kg kh ki my kk kl km mz ko kp kq ij bi translated">重读这篇论文，我觉得甘过度拟合的想法特别有趣。监督学习环境中的过拟合非常直观:</p><figure class="kt ku kv kw gt jq gh gi paragraph-image"><div class="gh gi na"><img src="../Images/9b51b53049e572f30c77c1c4a675d412.png" data-original-src="https://miro.medium.com/v2/resize:fit:1288/format:webp/1*FxG6_bQ8Lq_ZuOJdDU99uw.png"/></div><figcaption class="ld le gj gh gi lf lg bd b be z dk">Common picture showing overfitting on a supervised learning task</figcaption></figure><p id="9767" class="pw-post-body-paragraph jt ju iq jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq ij bi translated">上图是回归任务中过度拟合的常见图示。过度参数化模型会自我调整，使其与训练数据完全匹配，并且没有错误。抛开偏差-方差权衡的统计数据，我们可以直观地将过度拟合想象为模型的泛化能力，即与测试数据相比，它在训练数据上的表现如何。</p><p id="f3a8" class="pw-post-body-paragraph jt ju iq jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq ij bi translated">在 GANs 的背景下，这是一个非常有趣的想法。生成器的任务是产生鉴别器预测为“真实”的数据，这意味着它非常类似于训练数据集。看起来，如果生成器放弃任何向数据点添加随机变化的尝试，而只是精确模拟训练数据，那么它将是最成功的。拉德福德等人讨论了三种有趣的方法来证明他们的 DC-甘模型没有做到这一点。</p><ol class=""><li id="662e" class="lh li iq jv b jw jx ka kb ke lj ki lk km ll kq lm ln lo lp bi translated">启发式近似:快速学习的模型概括得很好</li><li id="0a57" class="lh li iq jv b jw lq ka lr ke ls ki lt km lu kq lm ln lo lp bi translated">自动编码器哈希冲突(训练 a 3072–128–3072 自动编码器对生成数据和原始数据进行编码，并查看生成数据和原始数据之间的低维(128)表示有多少相似之处。</li><li id="3ec7" class="lh li iq jv b jw lq ka lr ke ls ki lt km lu kq lm ln lo lp bi translated">潜在空间的平滑度(急剧过渡=过度拟合)</li></ol><p id="414b" class="pw-post-body-paragraph jt ju iq jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq ij bi translated">本文中没有使用的另一种探索 GANs 过度拟合的有趣技术是使用 L1 或 L2 距离(甚至可能是 VGG-19 特征距离)进行最近邻搜索，从训练数据集中抓取与给定生成图像最相似的图像。</p><h1 id="b507" class="lx ly iq bd lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu bi translated"><strong class="ak">甘特征可视化</strong></h1><p id="62c4" class="pw-post-body-paragraph jt ju iq jv b jw mv jy jz ka mw kc kd ke mx kg kh ki my kk kl km mz ko kp kq ij bi translated">CNN 中的特征可视化如下实现。通过梯度下降来训练生成器网络，以产生导致给定特征的最大激活的图像。拉德福德等人在 LSUN bedroom 数据集上使用他们的鉴别器模型对此进行了测试，并展示了下图:</p><figure class="kt ku kv kw gt jq gh gi paragraph-image"><div class="gh gi nb"><img src="../Images/4eaffc4850ad2b700f596cb02afb3dbe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1176/format:webp/1*CecQ5XoZJrvhHK7UUjAkzg.png"/></div></figure><p id="66dc" class="pw-post-body-paragraph jt ju iq jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq ij bi translated">有趣的是，这些是鉴别器用来辨别图像真假的特征。</p><h1 id="097d" class="lx ly iq bd lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu bi translated"><strong class="ak">潜在空间插值</strong></h1><p id="da9a" class="pw-post-body-paragraph jt ju iq jv b jw mv jy jz ka mw kc kd ke mx kg kh ki my kk kl km mz ko kp kq ij bi translated">潜在空间插值是 GAN 研究中最有趣的课题之一，因为它能够控制发生器。例如，GANs 最终可能被用于设计网站。您希望能够控制设计的特征或在设计之间进行插值。除了这个轶事，潜在空间插值在 Word2Vec 中有非常普遍的描述，其中向量“国王”-“男人”+“女人”=“女王”。拉德福德等人用他们生成的图像探索了这种插值方法。</p><figure class="kt ku kv kw gt jq gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nc"><img src="../Images/51b6814dcd6b9ed5694695563ab90eab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FxjAQ8y0U_X932yCiJXc6g.png"/></div></div></figure><figure class="kt ku kv kw gt jq gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nd"><img src="../Images/1b885a7e1c1f547a7bee7f5adf3c2f35.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uc9AYC2aNv0LTQjf7lURZw.png"/></div></div></figure><p id="c5ad" class="pw-post-body-paragraph jt ju iq jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq ij bi translated">本文中讨论的潜在空间插值的一个有趣的细节是，它们不使用单个点的 Z 向量，这是我最初没有注意到的。例如，他们不只是用一个微笑的女人的 Z 向量减去一个中性女人的 Z 向量，然后加上一个中性男人的 Z 向量来获得一个微笑的男人图像。相反，它们取一系列显示外部特征(如“微笑的女人”)的生成图像的平均 Z 向量。</p><p id="21ee" class="pw-post-body-paragraph jt ju iq jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq ij bi translated">感谢您阅读本文！我发现这篇论文对我研究 GANs 非常有用。每次我回到这篇论文，我都会对论文的细节有所欣赏。这篇文章是关于 GANs 的基础工作之一，我强烈推荐你去看看，特别是如果你对图像生成感兴趣的话。</p><h1 id="8775" class="lx ly iq bd lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu bi translated">参考</h1><p id="608d" class="pw-post-body-paragraph jt ju iq jv b jw mv jy jz ka mw kc kd ke mx kg kh ki my kk kl km mz ko kp kq ij bi translated">[1]亚历克·拉德福德，卢克·梅斯，苏密特·钦塔拉。深度卷积生成对抗网络的无监督表示学习。2015.</p><p id="9104" class="pw-post-body-paragraph jt ju iq jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq ij bi translated">[2]蒂姆·萨利曼斯、伊恩·古德菲勒、沃伊切赫·扎伦巴、张维基、亚历克·拉德福德、陈曦。训练 GANs 的改良技术。2016.</p></div></div>    
</body>
</html>