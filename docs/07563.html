<html>
<head>
<title>Getting more value from the Pandas’ value_counts()</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">从熊猫的价值计数中获取更多价值()</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/getting-more-value-from-the-pandas-value-counts-aa17230907a6?source=collection_archive---------1-----------------------#2019-10-22">https://towardsdatascience.com/getting-more-value-from-the-pandas-value-counts-aa17230907a6?source=collection_archive---------1-----------------------#2019-10-22</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="41f2" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">在 Python 中有效使用 value_counts()函数的五种方法</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/99215a684bda54aaa9288899aaacc8e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lOht9o73PICksasDplo0Pg.jpeg"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk"><a class="ae ky" href="https://unsplash.com/@plushdesignstudio?utm_source=beautifulai&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Plush Design Studio on Unsplash</a></figcaption></figure><p id="0e08" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">数据探索是机器学习管道的一个重要方面。在我们决定训练哪个模型和训练多少之前，我们必须对我们的数据包含什么有一个概念。熊猫库为此配备了许多有用的功能，<code class="fe lv lw lx ly b">value_counts</code>就是其中之一。此函数返回熊猫数据帧中唯一项目的计数。然而，大多数时候，我们最终使用带有默认参数的 value_counts。因此，在这篇短文中，我将向您展示如何通过改变默认参数来实现更多。</p></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/73d55b39803f35f358ab590b256a875b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*G9rXmpQde4skaKNhqvWiaQ.png"/></div></div></figure><h1 id="575a" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">值计数()</h1><p id="0c63" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">value_counts()方法返回一个包含唯一值计数的<code class="fe lv lw lx ly b">Series</code>。这意味着，对于 dataframe 中的任何列，此方法都返回该列中唯一条目的计数。</p><h2 id="d616" class="nd mh it bd mi ne nf dn mm ng nh dp mq li ni nj ms lm nk nl mu lq nm nn mw no bi translated"><a class="ae ky" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.value_counts.html" rel="noopener ugc nofollow" target="_blank">语法</a></h2><p id="d64a" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated"><code class="fe lv lw lx ly b">Series.<strong class="lb iu">value_counts</strong></code>()</p><h2 id="cd7b" class="nd mh it bd mi ne nf dn mm ng nh dp mq li ni nj ms lm nk nl mu lq nm nn mw no bi translated">因素</h2><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi np"><img src="../Images/707b1b8c2e6f6ebeb0605fa2b7726338.png" data-original-src="https://miro.medium.com/v2/resize:fit:1194/format:webp/1*j5Gi_-E-b4h6tqtbYsxTrA.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk"><a class="ae ky" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.value_counts.html" rel="noopener ugc nofollow" target="_blank">https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.value_counts.html</a></figcaption></figure><h2 id="685d" class="nd mh it bd mi ne nf dn mm ng nh dp mq li ni nj ms lm nk nl mu lq nm nn mw no bi translated">基本用法</h2><p id="9f59" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">让我们看看这个方法在数据集上的基本用法。我将使用<a class="ae ky" href="https://www.kaggle.com/c/titanic/data" rel="noopener ugc nofollow" target="_blank">泰坦尼克号数据集</a>进行演示。我还在 Kaggle 上发布了一个附带的<a class="ae ky" href="https://www.kaggle.com/parulpandey/five-ways-to-use-value-counts" rel="noopener ugc nofollow" target="_blank">笔记本，以防你想直接获得代码。</a></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><a href="https://www.kaggle.com/parulpandey/five-ways-to-use-value-counts"><div class="gh gi nq"><img src="../Images/10bbf7b55624d932a63aef373ada063d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*O7-SoJLE9XY_c6KBXqiTYw.png"/></div></a></figure><h2 id="2bf9" class="nd mh it bd mi ne nf dn mm ng nh dp mq li ni nj ms lm nk nl mu lq nm nn mw no bi translated">导入数据集</h2><p id="7c45" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">让我们从导入必要的库和数据集开始。这是每个数据分析过程中的基本步骤。</p><pre class="kj kk kl km gt nr ly ns nt aw nu bi"><span id="0cd8" class="nd mh it ly b gy nv nw l nx ny"><em class="nz"># Importing necessary libraries</em></span><span id="d3cb" class="nd mh it ly b gy oa nw l nx ny">import pandas as pd<br/>import numpy as np<br/>import matplotlib.pyplot as plt<br/>import seaborn as sns<br/>%matplotlib inline</span><span id="3128" class="nd mh it ly b gy oa nw l nx ny"><em class="nz"># Reading in the data</em><br/>train = pd.read_csv('../input/titanic/train.csv')</span></pre><h2 id="e638" class="nd mh it bd mi ne nf dn mm ng nh dp mq li ni nj ms lm nk nl mu lq nm nn mw no bi translated">浏览数据集的前几行</h2><pre class="kj kk kl km gt nr ly ns nt aw nu bi"><span id="1c20" class="nd mh it ly b gy nv nw l nx ny">train.head()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ob"><img src="../Images/1202cce5c056629d00bb7267e30926a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ODRW9CpQq8tLobotnzXwQQ.png"/></div></div></figure><h2 id="cb07" class="nd mh it bd mi ne nf dn mm ng nh dp mq li ni nj ms lm nk nl mu lq nm nn mw no bi translated">计算空值的数量</h2><pre class="kj kk kl km gt nr ly ns nt aw nu bi"><span id="0b50" class="nd mh it ly b gy nv nw l nx ny">train.isnull().sum()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ob"><img src="../Images/ec8355f0e0424b33f78ba71b32736966.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WCj5vi_uFF0d7nPlSAMmxQ.png"/></div></div></figure><p id="9de0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因此，<code class="fe lv lw lx ly b">Age</code>、<code class="fe lv lw lx ly b">Cabin</code>和<code class="fe lv lw lx ly b">Embarked</code>列具有空值。有了这些，我们对数据集有了一个大概的了解。现在让我们看看如何以五种不同的方式使用<code class="fe lv lw lx ly b">value_counts()</code>来进一步探索这些数据。</p></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h1 id="883c" class="mg mh it bd mi mj oc ml mm mn od mp mq jz oe ka ms kc of kd mu kf og kg mw mx bi translated">1.带有默认参数的 value_counts()</h1><p id="52b3" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">让我们调用数据集的<code class="fe lv lw lx ly b">Embarked</code>列上的<code class="fe lv lw lx ly b">value_counts()</code>。这将返回该列中唯一出现的次数。</p><pre class="kj kk kl km gt nr ly ns nt aw nu bi"><span id="8fbd" class="nd mh it ly b gy nv nw l nx ny">train['Embarked'].value_counts()<br/>-------------------------------------------------------------------</span><span id="64ec" class="nd mh it ly b gy oa nw l nx ny">S      644<br/>C      168<br/>Q       77</span></pre><p id="2691" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">该函数以降序返回给定索引中所有唯一值的计数，不包含任何空值。我们可以很快看到最多的人从<strong class="lb iu">南安普顿</strong>出发，其次是<strong class="lb iu">瑟堡</strong>然后是<strong class="lb iu">皇后镇</strong>。</p><h1 id="f6b9" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">2.value_counts()以及唯一值的相对频率。</h1><p id="5071" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">有时候，得到一个百分比是一个比计数更好的标准。通过设置<code class="fe lv lw lx ly b">normalize=True</code>，返回的对象将包含唯一值的相对频率。默认情况下，<code class="fe lv lw lx ly b">normalize</code>参数设置为<code class="fe lv lw lx ly b">False</code>。</p><pre class="kj kk kl km gt nr ly ns nt aw nu bi"><span id="186c" class="nd mh it ly b gy nv nw l nx ny">train['Embarked'].value_counts(normalize=True)<br/>-------------------------------------------------------------------</span><span id="b8e9" class="nd mh it ly b gy oa nw l nx ny">S    0.724409<br/>C    0.188976<br/>Q    0.086614</span></pre><p id="970b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">知道 72%的人从南安普顿出发比说 644 人从南安普顿出发更好。</p><h1 id="228f" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">3.value_counts()按升序排列</h1><p id="7172" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated"><code class="fe lv lw lx ly b">value_counts()</code>返回的序列默认为降序。我们可以通过将<code class="fe lv lw lx ly b">ascending</code>参数设置为<code class="fe lv lw lx ly b">True</code>来颠倒过来。</p><pre class="kj kk kl km gt nr ly ns nt aw nu bi"><span id="63b5" class="nd mh it ly b gy nv nw l nx ny">train['Embarked'].value_counts(ascending=True)<br/>-------------------------------------------------------------------</span><span id="c9dd" class="nd mh it ly b gy oa nw l nx ny">Q     77<br/>C    168<br/>S    644</span></pre><h1 id="83c9" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">4.value_counts()显示 NaN 值</h1><p id="1d31" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">默认情况下，结果中不包括空值的计数。但是，通过将<code class="fe lv lw lx ly b">dropna</code>参数设置为<code class="fe lv lw lx ly b">False</code>，同样可以轻松显示。</p><pre class="kj kk kl km gt nr ly ns nt aw nu bi"><span id="11f0" class="nd mh it ly b gy nv nw l nx ny">train['Embarked'].value_counts(dropna=False)<br/>-------------------------------------------------------------------</span><span id="6b0d" class="nd mh it ly b gy oa nw l nx ny">S      644<br/>C      168<br/>Q       77<br/>NaN      2</span></pre><p id="fb21" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们很容易看到该列中有两个空值。</p><h1 id="ad04" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">5.value_counts()将连续数据绑定到离散区间</h1><p id="acd7" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">这是 value_counts()函数的一个我最喜欢的用法，也是一个未被充分利用的用法。在<code class="fe lv lw lx ly b">bin</code>参数的帮助下，<code class="fe lv lw lx ly b"> value_counts()</code>可用于将连续数据归入离散区间。此选项仅适用于数字数据。它类似于<code class="fe lv lw lx ly b">pd.cut</code>功能。让我们使用<code class="fe lv lw lx ly b">Fare</code>列来看看它是如何工作的。</p><pre class="kj kk kl km gt nr ly ns nt aw nu bi"><span id="39e1" class="nd mh it ly b gy nv nw l nx ny"><em class="nz"># applying value_counts on a numerical column without the bin parameter</em></span><span id="1390" class="nd mh it ly b gy oa nw l nx ny">train['Fare'].value_counts()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oh"><img src="../Images/b5c3a4004dd9af755c43aaecbcde83b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1380/format:webp/1*Hn_coi8zztbwGeM6mg1tow.png"/></div></figure><p id="02b9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这并没有传达太多的信息，因为输出包含每个票价值的许多类别。相反，让我们把它们分成七个箱子。</p><pre class="kj kk kl km gt nr ly ns nt aw nu bi"><span id="986e" class="nd mh it ly b gy nv nw l nx ny">train['Fare'].value_counts(bins=7)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/8ec7b57d8faa70854082466837b08a55.png" data-original-src="https://miro.medium.com/v2/resize:fit:1370/format:webp/1*hrMj5y4As6ApEOtTSN3Xrg.png"/></div></figure><p id="19c9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">宁滨让人们很容易理解所传达的思想。我们可以很容易地看到，总人口中的大多数人支付的门票费用不到 73.19 英镑。此外，我们可以看到，有五个箱柜服务于我们的目的，因为没有乘客落入最后两个箱柜。</p></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><p id="e958" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因此，我们可以看到 value_counts()是一个方便的工具，我们可以用这一行代码进行一些有趣的分析。</p></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h1 id="3d9f" class="mg mh it bd mi mj oc ml mm mn od mp mq jz oe ka ms kc of kd mu kf og kg mw mx bi translated">参考</h1><ul class=""><li id="2aec" class="oj ok it lb b lc my lf mz li ol lm om lq on lu oo op oq or bi translated"><a class="ae ky" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.value_counts.html" rel="noopener ugc nofollow" target="_blank">熊猫。Series.value_counts 文档</a></li></ul></div></div>    
</body>
</html>