<html>
<head>
<title>Understanding Monte Carlo Simulation</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">了解蒙特卡罗模拟</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/understanding-monte-carlo-simulation-eceb4c9cad4?source=collection_archive---------5-----------------------#2019-12-16">https://towardsdatascience.com/understanding-monte-carlo-simulation-eceb4c9cad4?source=collection_archive---------5-----------------------#2019-12-16</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="a0f3" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">从头开始实施强大的统计工具</h2></div><p id="ead0" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">蒙特卡洛模拟是一种强有力的工具，可以在很难获得精确分布的情况下近似计算。当对随机变量(RV)应用复杂的变换时，可能会出现这种情况，因为我们知道它的分布。它有多种应用；从<a class="ae le" href="https://en.wikipedia.org/wiki/Monte_Carlo_methods_for_option_pricing" rel="noopener ugc nofollow" target="_blank">期权定价</a>到<a class="ae le" href="https://en.wikipedia.org/wiki/Search_and_Rescue_Optimal_Planning_System#Applications_outside_of_search_and_rescue" rel="noopener ugc nofollow" target="_blank">缩小海岸警卫队搜救工作的地理焦点</a>。但是它是如何工作的呢？</p><h2 id="5af3" class="lf lg it bd lh li lj dn lk ll lm dp ln kr lo lp lq kv lr ls lt kz lu lv lw lx bi translated">概率分布</h2><p id="141c" class="pw-post-body-paragraph ki kj it kk b kl ly ju kn ko lz jx kq kr ma kt ku kv mb kx ky kz mc lb lc ld im bi translated">每个 RV 都有其独特的分布特征。对于连续 RV，概率密度函数(PDF)显示了给定值下连续 RV 的密度。任何给定值出现的概率为零，因此必须对一系列值进行积分，以找到 RV 落在指定范围内的概率。对于离散 RVs，该函数称为概率质量函数(PMF ),它返回特定值出现的概率。它们描述了我们观察随机变量的模式和频率。</p><div class="md me mf mg gt ab cb"><figure class="mh mi mj mk ml mm mn paragraph-image"><div role="button" tabindex="0" class="mo mp di mq bf mr"><img src="../Images/1ec86142bdf3eb2cb2db67f695a389fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*-A-GBoHsmqf9M_4ujbkKXw.png"/></div></figure><figure class="mh mi mj mk ml mm mn paragraph-image"><div role="button" tabindex="0" class="mo mp di mq bf mr"><img src="../Images/d036405660d4a5f367756d1a014f9419.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*wJQjLJXqEnWEOYR6Tw-VVw.png"/></div></figure></div><p id="4fec" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">CDF 就是 PDF 或 PMF 的累积值。它是随机变量取值小于或等于曲线/阶跃函数正下方值的概率。概率必须介于 0 和 1 之间，因此 CDF 的范围介于 0 和 1 之间。用<strong class="kk iu">T5 FT7 表示。</strong></p><div class="md me mf mg gt ab cb"><figure class="mh mi mj mk ml mm mn paragraph-image"><div role="button" tabindex="0" class="mo mp di mq bf mr"><img src="../Images/17894b63908fa62b60382eba6a217ef2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1002/format:webp/1*VQOuOYUqDf-4skLdwuYYOg.png"/></div></figure><figure class="mh mi mj mk ml mm mn paragraph-image"><div role="button" tabindex="0" class="mo mp di mq bf mr"><img src="../Images/88ab493b632d027790deca07c1a1b3de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1002/format:webp/1*4Xibw-2HOt4KLfDiXKhTow.png"/></div></figure></div><h2 id="dc04" class="lf lg it bd lh li lj dn lk ll lm dp ln kr lo lp lq kv lr ls lt kz lu lv lw lx bi translated">逆变换采样</h2><p id="f2e7" class="pw-post-body-paragraph ki kj it kk b kl ly ju kn ko lz jx kq kr ma kt ku kv mb kx ky kz mc lb lc ld im bi translated">除了是概率论的基础知识之外，这些与蒙特卡罗模拟有什么关系？通过下面的命题(注意:大写字母表示 RVs，小写字母表示 RV 的实现)。</p><figure class="md me mf mg gt mi gh gi paragraph-image"><div class="gh gi mv"><img src="../Images/68b5f039a8f55d4bc51de2d2ea69506e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1138/format:webp/1*yK8sQkNOSZobVHAzMzlWJQ.png"/></div></figure><blockquote class="mw"><p id="cac4" class="mx my it bd mz na nb nc nd ne nf ld dk translated"><strong class="ak">这意味着我们可以将最小值为 0、最大值为 1 的均匀分布中的随机变量输入到 X 的逆 CDF 中，以生成 X 的随机值。</strong></p></blockquote><p id="569a" class="pw-post-body-paragraph ki kj it kk b kl ng ju kn ko nh jx kq kr ni kt ku kv nj kx ky kz nk lb lc ld im bi translated">让我们取一个指数分布的 CDF。它在下面。</p><figure class="md me mf mg gt mi gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/fda9b1e2e0c1be5e84a8c48119116b4b.png" data-original-src="https://miro.medium.com/v2/resize:fit:272/format:webp/1*VMtKv_ihCKolbkXTKJD3tQ.png"/></div><figcaption class="nm nn gj gh gi no np bd b be z dk">CDF of an Exponential(lambda) Distribution</figcaption></figure><p id="2a9a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">通过定义<em class="mu"> U </em>为<em class="mu"> F(X) </em>和<em class="mu"> s </em>求解<em class="mu"> X </em>，我们可以找到 CDF 的逆。</p><figure class="md me mf mg gt mi gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/376e4fa76378ac0b16d802ee04b790a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:362/format:webp/1*W1z7bXSLZDzXMcS7KBlvew.png"/></div><figcaption class="nm nn gj gh gi no np bd b be z dk">Inverse CDF of an Exponential(lambda) Distribution</figcaption></figure><p id="7fe5" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们现在可以将<em class="mu"> U~Uniform(0，1) </em> RVs 输入到这个逆 CDF 中，从指数分布中生成随机抽取。我选择 1 作为我的 lambda 参数。我使用的代码如下。(注意:这是低效的，可以通过矢量化来加速，或者使用<strong class="kk iu"> scipy.stats </strong>模块来加速。我这样做是为了清楚地演示逆变换采样是如何工作的)。</p><figure class="md me mf mg gt mi gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/7465d586e3920321977357dd732142b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1324/format:webp/1*1GISng5XMEc7-y-NI9qq7Q.png"/></div><figcaption class="nm nn gj gh gi no np bd b be z dk">The code used to generate Exponential(lambda) RVs</figcaption></figure><p id="daae" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在 10，000 个模拟随机变量时，模拟与理论分布非常接近。</p><figure class="md me mf mg gt mi gh gi paragraph-image"><div role="button" tabindex="0" class="mo mp di mq bf mr"><div class="gh gi ns"><img src="../Images/108e1ee07b436b08672f8c41ad409fac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2UR376znL06Ma_dgG6-4dw.png"/></div></div></figure><p id="7786" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在让我们尝试一个转换。</p><h2 id="fd07" class="lf lg it bd lh li lj dn lk ll lm dp ln kr lo lp lq kv lr ls lt kz lu lv lw lx bi translated">近似 RV 的变换</h2><p id="0a96" class="pw-post-body-paragraph ki kj it kk b kl ly ju kn ko lz jx kq kr ma kt ku kv mb kx ky kz mc lb lc ld im bi translated">现在让我们生成标准正态随机变量的平方。这实际上是一个<em class="mu">卡方(1) </em> RV，它允许我们通过检查精确分布来轻松检查我们的近似有多好。</p><figure class="md me mf mg gt mi gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/e4956b146383cfc71ee731cc4f7c2ac9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*K7uxHrXaUYkFlvzgtR91dw.png"/></div><figcaption class="nm nn gj gh gi no np bd b be z dk">The code used to generate Chi-Square(1) RVs by squaring standard normal RVs</figcaption></figure><p id="ec1f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如你所见，这个近似值相当不错。</p><figure class="md me mf mg gt mi gh gi paragraph-image"><div role="button" tabindex="0" class="mo mp di mq bf mr"><div class="gh gi nu"><img src="../Images/6b793f9671161d4086474c05dfe2054f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dEq1swPI0d8nwEu15Q1yKw.png"/></div></div></figure><p id="ea28" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在绘制了这些 RVs 之后，我计算了低于 1 的比例(近似概率)为 0.6857。然后，我通过使用评估为 1 的<em class="mu">卡方(1) </em> CDF，将这与确切的概率进行比较。准确的概率是 0.6826894921370859。这种近似在 10，000 次模拟中表现得非常好</p><p id="6220" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在让我们用这个来近似 RV 的分布，它的精确分布需要一点求解。</p><h2 id="f96e" class="lf lg it bd lh li lj dn lk ll lm dp ln kr lo lp lq kv lr ls lt kz lu lv lw lx bi translated">逼近我的任意 RV</h2><p id="da93" class="pw-post-body-paragraph ki kj it kk b kl ly ju kn ko lz jx kq kr ma kt ku kv mb kx ky kz mc lb lc ld im bi translated">我定义了一些任意的 RV。姑且称之为<em class="mu"> A </em>，定义如下。</p><figure class="md me mf mg gt mi gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/9bec3877aee58dcefadc91e810e97417.png" data-original-src="https://miro.medium.com/v2/resize:fit:1036/format:webp/1*xEySIQay3AbfLZvzmZoxLQ.png"/></div></figure><p id="d29f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">找到一个精确的分布需要一些工作，我不喜欢工作。幸运的是，我可以写一个函数来逼近<em class="mu"> A </em>的分布。</p><figure class="md me mf mg gt mi gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/a39b8da9445c7ee22b1f8c80bc745339.png" data-original-src="https://miro.medium.com/v2/resize:fit:1158/format:webp/1*ztVSlZvbNxXq7l2yZBBwFg.png"/></div></figure><p id="5cd4" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在我们有了一个<em class="mu"> A </em>分布的近似值，并且可以找到用于推断目的的近似概率。</p><figure class="md me mf mg gt mi gh gi paragraph-image"><div role="button" tabindex="0" class="mo mp di mq bf mr"><div class="gh gi nx"><img src="../Images/bb7284a889a6dd32efe5035848604182.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wteJmRF76TWBcisIpoms-A.png"/></div></div></figure><p id="3a1a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">既然我们已经完成了对我的任意 RV 的近似，让我们来看一个假设的用例。</p><h2 id="f2c2" class="lf lg it bd lh li lj dn lk ll lm dp ln kr lo lp lq kv lr ls lt kz lu lv lw lx bi translated">正回报的概率</h2><p id="c380" class="pw-post-body-paragraph ki kj it kk b kl ly ju kn ko lz jx kq kr ma kt ku kv mb kx ky kz mc lb lc ld im bi translated">假设我们知道一些证券的收益分布为𝐿𝑎𝑝𝑙𝑎𝑐𝑒 <em class="mu"> (0.05，0.07) </em>，下一期的收益不依赖于本期的收益(这是一个随机游走的例子)。我们在第 5 期的投资回报率为正的概率是多少？</p><figure class="md me mf mg gt mi gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/948707bcb4ded0a245a8ba637f78f6b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1322/format:webp/1*ESgM7jZThv3YBNwIFCpK4Q.png"/></div><figcaption class="nm nn gj gh gi no np bd b be z dk">The code I used to generate simulated returns and the spaghetti plot (make sure to load in stats from scipy)</figcaption></figure><div class="md me mf mg gt ab cb"><figure class="mh mi nz mk ml mm mn paragraph-image"><div role="button" tabindex="0" class="mo mp di mq bf mr"><img src="../Images/4478ff259bab8022dc49a27dfa271ca9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1016/format:webp/1*Sl21FiFi8fLM98Dmhvexjw.png"/></div></figure><figure class="mh mi oa mk ml mm mn paragraph-image"><div role="button" tabindex="0" class="mo mp di mq bf mr"><img src="../Images/3fb020bc412b5221d40949d355361935.png" data-original-src="https://miro.medium.com/v2/resize:fit:986/format:webp/1*nPc2AikAfpRG6hTBLPOXuQ.png"/></div><figcaption class="nm nn gj gh gi no np bd b be z dk ob di oc od">5000 Random Walks of our hypothetical security and the distribution of final returns</figcaption></figure></div><p id="4f6a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">通过计算最终收益大于 0 的比例并除以模拟次数，我们发现该证券在 5 期结束时增值的概率约为 0.85。在构建投资组合时，这是有用的信息(尽管我们在现实生活中从未遇到过这样干净的案例)。</p><h2 id="e0ad" class="lf lg it bd lh li lj dn lk ll lm dp ln kr lo lp lq kv lr ls lt kz lu lv lw lx bi translated">奖金申请:蒙特卡罗积分</h2><p id="92b4" class="pw-post-body-paragraph ki kj it kk b kl ly ju kn ko lz jx kq kr ma kt ku kv mb kx ky kz mc lb lc ld im bi translated">除了近似分布之外，蒙特卡罗模拟可以用于数值近似难以或不可能解析求解的定积分。这被称为蒙特卡罗积分。它是通过在从<em class="mu"> 𝑈𝑛𝑖𝑓𝑜𝑟𝑚 </em> ( <em class="mu"> 𝑎 </em>，<em class="mu"> 𝑏 </em>)产生的随机变量的实现上评估函数来执行的，其中 a 是定积分的下限，b 是上限。这些结果然后被平均并乘以<em class="mu">𝑏</em>—<em class="mu">𝑎</em>，以获得从<em class="mu"> 𝑎 </em>到<em class="mu"> 𝑏 </em>的积分近似值。</p><p id="c719" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">取下面的函数:</p><figure class="md me mf mg gt mi gh gi paragraph-image"><div class="gh gi oe"><img src="../Images/23628fbe57a41b4db86986e21f13abe0.png" data-original-src="https://miro.medium.com/v2/resize:fit:256/format:webp/1*2VfE1_iJcwuWAw0sjLpRxQ.png"/></div></figure><p id="5a33" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">它的积分不能解析地导出，所以让我们在 0 到 1 的区间上近似它。</p><figure class="md me mf mg gt mi gh gi paragraph-image"><div class="gh gi of"><img src="../Images/00c9fa083325ef6a38457c72ed2d573f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1286/format:webp/1*kmqCR3WBrPgzU9AkSvUbXg.png"/></div></figure><p id="3080" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">运行 10，000 次模拟后，我得到了大约 0.244 的近似值，这与 Wolfram 给出的大约 0.244 的近似值非常接近，因此该函数按预期工作。</p><h2 id="6e43" class="lf lg it bd lh li lj dn lk ll lm dp ln kr lo lp lq kv lr ls lt kz lu lv lw lx bi translated">结论</h2><p id="682f" class="pw-post-body-paragraph ki kj it kk b kl ly ju kn ko lz jx kq kr ma kt ku kv mb kx ky kz mc lb lc ld im bi translated">如果你逗留了这么久，感谢你的阅读。我希望你了解了一些蒙特卡洛模拟的工作原理。希望这些知识能帮助你继续学习蒙特卡罗模拟的应用，比如马尔可夫链蒙特卡罗。只是另一个提醒使用优化的<strong class="kk iu">。来自<strong class="kk iu"> scipy.stats </strong>的 rvs() </strong>方法，适用于您感兴趣的任何分布。这比重复追加到列表中要快一个数量级。</p></div></div>    
</body>
</html>