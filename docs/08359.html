<html>
<head>
<title>Exploratory Data Analysis — Part I</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">探索性数据分析——第一部分</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/exploratory-data-analysis-part-i-9825e658e668?source=collection_archive---------24-----------------------#2019-11-13">https://towardsdatascience.com/exploratory-data-analysis-part-i-9825e658e668?source=collection_archive---------24-----------------------#2019-11-13</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="77b4" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在本文中，我们将了解如何用<strong class="js iu">熊猫</strong>探索<strong class="js iu">数字数据</strong>。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/99111ae38f4bd305ae5a5377660c6bdf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*J0XGndywYd_uTwITsr7Dzg.jpeg"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk">Source : <a class="ae le" href="https://www.flickr.com/photos/61904084@N00/13917433335" rel="noopener ugc nofollow" target="_blank">“Panda”</a> by <a class="ae le" href="https://www.flickr.com/photos/61904084@N00" rel="noopener ugc nofollow" target="_blank">thedailyenglishshow</a> is licensed under <a class="ae le" href="https://creativecommons.org/licenses/by/2.0/?ref=ccsearch&amp;atype=rich" rel="noopener ugc nofollow" target="_blank">CC BY 2.0</a></figcaption></figure><p id="d4c3" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">什么是数据分析中使用的数据集？</strong></p><p id="03a4" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">数据分析中使用的数据集是某些数字或字符串或两者的组合，它们可能有也可能没有任何特定的顺序，我们需要从中预测未来可能发生的结果。</p><p id="f15e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">现在，当我们有了原始数据集，我们必须从中做出预测，几个问题将出现，以采取这样的决定。例如，如果我想在 5 年内投资获得最佳回报，我会首先研究公共和私营企业的几种投资方案并进行比较，联系企业的客户服务部门以消除我的疑虑，阅读其他客户的评论以更深入地了解他们，彻底检查他们的条款和条件以及更多此类调查。对于数据科学家来说，这些调查方法不过是“探索性数据分析”,同时处理这些原始数据并从中推断预测。</p><p id="eaa0" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在开始探索性数据分析过程之前，需要了解以下重要问题:</p><ul class=""><li id="62f2" class="lf lg it js b jt ju jx jy kb lh kf li kj lj kn lk ll lm ln bi translated">我在给定的数据集中寻找的问题是什么</li><li id="53d8" class="lf lg it js b jt lo jx lp kb lq kf lr kj ls kn lk ll lm ln bi translated">我的数据集包含哪种类型的数据</li><li id="35a8" class="lf lg it js b jt lo jx lp kb lq kf lr kj ls kn lk ll lm ln bi translated">为了预测我的目标变量，需要在数据集中添加或删除哪些特征</li><li id="8aeb" class="lf lg it js b jt lo jx lp kb lq kf lr kj ls kn lk ll lm ln bi translated">是否存在任何缺失值，如果是，如何处理</li><li id="720b" class="lf lg it js b jt lo jx lp kb lq kf lr kj ls kn lk ll lm ln bi translated">如果有异常值，我们如何消除它们</li></ul><p id="c43f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在本文中，我们将只在一个<strong class="js iu">数字</strong>数据集上探索 EDA 的过程。</p><ul class=""><li id="3f83" class="lf lg it js b jt ju jx jy kb lh kf li kj lj kn lk ll lm ln bi translated">让<strong class="js iu">读取</strong>给定的数据集(使用<code class="fe lt lu lv lw b">read_csv)</code>)，并考虑到要训练的给定数据集在，使用<code class="fe lt lu lv lw b">head</code>方法查看前 5 行。csv 格式。</li></ul><pre class="kp kq kr ks gt lx lw ly lz aw ma bi"><span id="dead" class="mb mc it lw b gy md me l mf mg">import pandas as pd<br/>import numpy as np<br/>df = pd.read_csv("train.csv")<br/>df.head(5)</span></pre><p id="4a67" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">注意:如果原始数据由分隔符“；”分隔那么我们的命令将是:</p><p id="5f9c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><code class="fe lt lu lv lw b">df = pd.readcsv(“train.csv”, sep = “;”)</code></p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi mh"><img src="../Images/1f363b504aaea3fc60d724342729419c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AJ9T2yYxgUZKPneLlmcMkw.png"/></div></div></figure><p id="e2a8" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这里我们需要预测“票价金额”</p><p id="3954" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们使用了一个数据集，该数据集将根据在纽约市内行驶的距离来预测出租车的费用。<code class="fe lt lu lv lw b">head()</code>和<code class="fe lt lu lv lw b">tail()</code>函数返回数据集的第一个和最后一个观察值。</p><ul class=""><li id="5510" class="lf lg it js b jt ju jx jy kb lh kf li kj lj kn lk ll lm ln bi translated"><code class="fe lt lu lv lw b">df.shape()</code>可以获取数据集中的行数和列数。</li><li id="0f0f" class="lf lg it js b jt lo jx lp kb lq kf lr kj ls kn lk ll lm ln bi translated"><code class="fe lt lu lv lw b">df.describe()</code>为我们提供每个变量数据集的平均值、标准偏差和其他特征。</li></ul><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi mi"><img src="../Images/8f55fb872fe3436a78cb930304bbed25.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UrhA0siOpBi7m0vYNix8DA.png"/></div></div></figure><ul class=""><li id="11de" class="lf lg it js b jt ju jx jy kb lh kf li kj lj kn lk ll lm ln bi translated">此处，我们的目标变量“票价 _ 金额”和其他变量(如“乘客 _ 数量”和“接送 _ 纬度”)的 75%和最大值之间存在显著的差异。这些值清楚地暗示了我们的数据集包含了异常值。</li><li id="e26f" class="lf lg it js b jt lo jx lp kb lq kf lr kj ls kn lk ll lm ln bi translated">我们在这里也可以注意到，均值远高于变量“fare_amount”的中值。</li><li id="1936" class="lf lg it js b jt lo jx lp kb lq kf lr kj ls kn lk ll lm ln bi translated"><code class="fe lt lu lv lw b">df.dtypes</code>给出了<code class="fe lt lu lv lw b">df</code>数据帧中每个变量的数据类型。</li></ul><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi mj"><img src="../Images/2931f8d306ef042b1fba605aeb689f4a.png" data-original-src="https://miro.medium.com/v2/resize:fit:650/format:webp/1*JloN1tkMBixMVf8yxXv3vg.png"/></div></figure><ul class=""><li id="903b" class="lf lg it js b jt ju jx jy kb lh kf li kj lj kn lk ll lm ln bi translated"><code class="fe lt lu lv lw b">df.info()</code>可以帮助我们查看是否有丢失的值</li></ul><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi mk"><img src="../Images/cdeaed56b82dcebb427703f8436bb9b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/format:webp/1*KV12bz2GdANXDQuLWY5jOQ.png"/></div></figure><ul class=""><li id="5911" class="lf lg it js b jt ju jx jy kb lh kf li kj lj kn lk ll lm ln bi translated">在我们的数据集中，可变列“fare_amount”和“passenger_count”包含缺失值。</li></ul><p id="4f13" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们的目标变量“票价金额”本质上是数字。</p><p id="8b0f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><code class="fe lt lu lv lw b">missing_value = pd.DataFrame(df.isnull().sum())</code></p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi ml"><img src="../Images/c6fb3fd544c75514915cadfcaa36a1a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:444/format:webp/1*BEi0sEySD0al2mRZoM8fkw.png"/></div></figure><p id="3db4" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们需要弥补我们缺失的价值观。但是在执行相同的操作之前，我们需要移除异常值。</p><p id="6506" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">为什么我们要在缺失值插补之前移除异常值？</strong></p><p id="9592" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">因为缺失值插补有不同的方法；其中之一是用特定列的平均值、中值或众数替换该列的缺失值。现在，如果在执行插补过程时数据集包含这些异常值，那么丢失的值将被错误地替换。因此，我们需要去除异常值。</p><p id="a6d6" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">异常值去除</strong></p><p id="9112" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们将继续为每个变量构建箱线图，以了解每个变量的异常值。</p><pre class="kp kq kr ks gt lx lw ly lz aw ma bi"><span id="639d" class="mb mc it lw b gy md me l mf mg">import seaborn as sns<br/>import matplotlib.pyplot as plt<br/>%matplotlib inline<br/>sns.boxplot(df['passenger_count'])</span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi mm"><img src="../Images/6ad027b6a50049427c7eef3c8f5de312.png" data-original-src="https://miro.medium.com/v2/resize:fit:964/format:webp/1*YxnEHpX5WjcgrPqjwRzXEw.png"/></div></figure><p id="fb69" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这里我们可以清楚地看到，有些数据点表明“乘客计数”超过 5000，我们将删除这些数据点。事实上，没有一辆出租车能够搭载超过 8 名乘客，因此，我们将删除那些值大于 8 的数据点，并对&lt;1.</p><pre class="kp kq kr ks gt lx lw ly lz aw ma bi"><span id="afdc" class="mb mc it lw b gy md me l mf mg">df=df.drop(((df[df['passenger_count']&gt;8])).index,axis=0<br/>df=df.drop(((df[df['passenger_count']&lt;1])).index,axis=0)<br/>df</span></pre><p id="f7e6" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">Once the rows with outliers are deleted, we can once again check our boxplot.</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi mn"><img src="../Images/9fc7845d680b843aa6d4213c55009790.png" data-original-src="https://miro.medium.com/v2/resize:fit:926/format:webp/1*JR5FJwlThvTtXQFraojaOg.png"/></div></figure><p id="4a80" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">We also checked if any latitude or longitude is out of the range. If so, we have dropped it along with the outliers present in every column.</p><p id="5b1c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">进行排序</strong>:</p><ul class=""><li id="6add" class="lf lg it js b jt ju jx jy kb lh kf li kj lj kn lk ll lm ln bi translated">在这里，我们可以根据特定变量对数据框进行升序或降序排序。</li></ul><pre class="kp kq kr ks gt lx lw ly lz aw ma bi"><span id="333e" class="mb mc it lw b gy md me l mf mg">df.sort_values(by='passenger_count', ascending =True).head(5)<br/>df</span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi mo"><img src="../Images/cee8407e4148157e53dca3f52e19291c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*k7tTIhQLTcJ3ifJWo4P9fg.png"/></div></div></figure><ul class=""><li id="495f" class="lf lg it js b jt ju jx jy kb lh kf li kj lj kn lk ll lm ln bi translated">现在，如果我们需要对多列进行排序:</li></ul><pre class="kp kq kr ks gt lx lw ly lz aw ma bi"><span id="7d76" class="mb mc it lw b gy md me l mf mg">df.sort_values(by=['passenger_count','fare_amount'], ascending =[True,True] ).head(5)</span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi mp"><img src="../Images/a00d72ff1c3f0d0cecdd9764245487af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_TmGvTX5ceqlVlmatAkiAQ.png"/></div></div></figure><p id="4f44" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">上面我们可以看到，我们的代码几乎相同，但输出是不同的。通过这种方式，我们可以获得所需的数据框架，以便对其进行更深入的分析。</p><ul class=""><li id="8f2e" class="lf lg it js b jt ju jx jy kb lh kf li kj lj kn lk ll lm ln bi translated">现在，如果我需要知道当我的 passenger_count 为 1 或 2 时所有其他变量的平均值，我可以得到相同的结果:</li></ul><pre class="kp kq kr ks gt lx lw ly lz aw ma bi"><span id="934a" class="mb mc it lw b gy md me l mf mg">df[df['passenger_count'] == 1].mean()</span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi mq"><img src="../Images/a86ba66e40d89323cff6aade414e22d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:692/format:webp/1*HL0XwDyzowlAMf5QuXMYEg.png"/></div></figure><p id="5323" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">缺失值分析</strong></p><ul class=""><li id="a348" class="lf lg it js b jt ju jx jy kb lh kf li kj lj kn lk ll lm ln bi translated">现在，我们需要检查所有变量中缺失值的数量。</li></ul><pre class="kp kq kr ks gt lx lw ly lz aw ma bi"><span id="55b5" class="mb mc it lw b gy md me l mf mg">missing_value = pd.DataFrame(df.isnull().sum())<br/>missing_value</span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi mr"><img src="../Images/f6a7c506836b60cc24794f0a82631296.png" data-original-src="https://miro.medium.com/v2/resize:fit:402/format:webp/1*XQkhhaLUn8f10GSuEauZjQ.png"/></div></figure><p id="d028" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我一直认为重要的是估算缺失的值，而不是删除它们。在这里，我对每一列使用了“最频繁出现的数据”的方法来替换各自缺失的值。</p><pre class="kp kq kr ks gt lx lw ly lz aw ma bi"><span id="b3e4" class="mb mc it lw b gy md me l mf mg">imp = SimpleImputer(missing_values=np.nan, strategy=’most_frequent’)<br/>train_data=pd.DataFrame(imp.fit_transform(df), columns=df.columns)<br/>print(f’Row count after imputing missing values — {train_data.shape[0]}’)</span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi ms"><img src="../Images/844a8ec01e4cf7316295751b11003e38.png" data-original-src="https://miro.medium.com/v2/resize:fit:816/format:webp/1*FKJRVImmQ4rsfEkG-vuq_g.png"/></div></figure><p id="427f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">通过图表检查变量之间的相关性</strong></p><p id="6306" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">检查任何变量之间是否高度相关是非常重要的。如果是这样，那么我们不应该考虑这些变量，而是在它们之间只选择一个变量，用于预测因变量所需的数据框。</p><p id="473d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><code class="fe lt lu lv lw b">df.corr(method=’pearson’).style.format(“{:.2}”).background_gradient(cmap=plt.get_cmap(‘coolwarm’), axis=1)</code></p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi mt"><img src="../Images/7377598d6932749d0cf538670744660e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*crKwblOQzs2U5_S51g6mEQ.png"/></div></div></figure><ul class=""><li id="964e" class="lf lg it js b jt ju jx jy kb lh kf li kj lj kn lk ll lm ln bi translated">我们使用了 corr()函数和所有变量的图形表示来观察它们是否与数据集中的任何其他变量高度相关。</li></ul><p id="bbf5" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在清理和删除某些数据点之后，我们获得了所需的数据框，可以在此基础上进行更深入的分析。</p><ul class=""><li id="0e72" class="lf lg it js b jt ju jx jy kb lh kf li kj lj kn lk ll lm ln bi translated">这里，我们通过列联表比较两个变量:</li></ul><pre class="kp kq kr ks gt lx lw ly lz aw ma bi"><span id="6e8c" class="mb mc it lw b gy md me l mf mg">pd.crosstab(df['passenger_count'], df['fare_amount'], normalize = True)</span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi mu"><img src="../Images/5b5472e041d0b7fba4c84c8f140fcf56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Tym02IgJHHXTRC0OCd0rKQ.png"/></div></div></figure><p id="c144" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">让我们来看看用纬度和经度衡量的特定地区的平均乘车人数:</p><pre class="kp kq kr ks gt lx lw ly lz aw ma bi"><span id="91f5" class="mb mc it lw b gy md me l mf mg">df.pivot_table(['pickup_latitude', 'dropoff_latitude', 'pickup_longitude','dropoff_longitude'], ['passenger_count'], aggfunc='mean')</span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi mv"><img src="../Images/074fd7ccde793dcc2e42348a984944f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*75Om-cRXRzXymbRhYEvsyA.png"/></div></div></figure><p id="535c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">现在我们的数据集可以进行机器学习了！</p></div><div class="ab cl mw mx hx my" role="separator"><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb"/></div><div class="im in io ip iq"><p id="c39c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">类似地，您可以添加几个其他高级功能来从数据中推断出更好的洞察力。这只是分析任何数值数据集的一个基本方法。在下一篇文章中，我们将讨论如何在分类数据集上执行 EDA。</p></div></div>    
</body>
</html>