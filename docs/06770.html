<html>
<head>
<title>Image Scraping with Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用 Python 进行图像抓取</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/image-scraping-with-python-a96feda8af2d?source=collection_archive---------0-----------------------#2019-09-27">https://towardsdatascience.com/image-scraping-with-python-a96feda8af2d?source=collection_archive---------0-----------------------#2019-09-27</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="f949" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph">使用 PYTHON 进行 WEB 抓取</h2><div class=""/><div class=""><h2 id="5b59" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">学习如何用 Python 从 Google 下载图片的代码指南！</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/b5eb468806f3c7dffc75357c553c355f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*xCQTLoW1DM12fbYA"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk">Photo by <a class="ae lh" href="https://unsplash.com/@iammrcup?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Mr Cup / Fabien Barral</a> on <a class="ae lh" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="c32c" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">为了训练一个模型，你需要图像。你当然可以手动下载，甚至可以批量下载，但我认为有一种更令人愉快的方式。让我们使用 Python 和一些 web 抓取技术来下载图像。</p><p id="836b" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><strong class="lk jd">更新 2(2020 年 2 月 25 日):</strong>抓取网页的一个问题是目标元素依赖于某种类型的 a <code class="fe me mf mg mh b">selector</code>。我们使用<code class="fe me mf mg mh b">css-selectors</code>从页面中获取相关元素。谷歌似乎在过去的某个时候改变了它的网站布局，这使得它有必要更新相关的选择器。提供的脚本应该可以再次工作。</p><p id="c8e7" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><strong class="lk jd">更新:</strong>自从写了这篇关于图像抓取的文章后，我已经发表了关于构建图像识别卷积神经网络的文章。如果你想好好利用这些图片，看看下面这篇文章吧！</p><div class="mi mj gp gr mk ml"><a rel="noopener follow" target="_blank" href="/cat-dog-or-elon-musk-145658489730"><div class="mm ab fo"><div class="mn ab mo cl cj mp"><h2 class="bd jd gy z fp mq fr fs mr fu fw jc bi translated">猫，狗，还是埃隆马斯克？</h2><div class="ms l"><h3 class="bd b gy z fp mq fr fs mr fu fw dk translated">了解如何使用 Python 和 Keras 在不到 15 分钟的时间内构建您的图像识别卷积神经网络！</h3></div><div class="mt l"><p class="bd b dl z fp mq fr fs mr fu fw dk translated">towardsdatascience.com</p></div></div><div class="mu l"><div class="mv l mw mx my mu mz lb ml"/></div></div></a></div><h1 id="20f7" class="na nb it bd nc nd ne nf ng nh ni nj nk ki nl kj nm kl nn km no ko np kp nq nr bi translated">在今天的文章中，我们将讨论以下主题:</h1><ol class=""><li id="588b" class="ns nt it lk b ll nu lo nv lr nw lv nx lz ny md nz oa ob oc bi translated">抓取静态页面</li><li id="8c22" class="ns nt it lk b ll od lo oe lr of lv og lz oh md nz oa ob oc bi translated">抓取交互式页面</li><li id="bf18" class="ns nt it lk b ll od lo oe lr of lv og lz oh md nz oa ob oc bi translated">从谷歌抓取图片</li><li id="f7f6" class="ns nt it lk b ll od lo oe lr of lv og lz oh md nz oa ob oc bi translated">合法性后记</li></ol></div><div class="ab cl oi oj hx ok" role="separator"><span class="ol bw bk om on oo"/><span class="ol bw bk om on oo"/><span class="ol bw bk om on"/></div><div class="im in io ip iq"><h1 id="45ec" class="na nb it bd nc nd op nf ng nh oq nj nk ki or kj nm kl os km no ko ot kp nq nr bi translated">先决条件</h1><p id="a62a" class="pw-post-body-paragraph li lj it lk b ll nu kd ln lo nv kg lq lr ou lt lu lv ov lx ly lz ow mb mc md im bi ox translated"><span class="l oy oz pa bm pb pc pd pe pf di">一个</span> Python 环境(我建议 Jupyter 笔记本)。如果你还没有设置这个，不要担心。这是毫不费力的，不到 10 分钟。</p><div class="mi mj gp gr mk ml"><a rel="noopener follow" target="_blank" href="/get-started-with-python-e50dc8c96589"><div class="mm ab fo"><div class="mn ab mo cl cj mp"><h2 class="bd jd gy z fp mq fr fs mr fu fw jc bi translated">所以你想成为一名数据科学家？</h2><div class="ms l"><h3 class="bd b gy z fp mq fr fs mr fu fw dk translated">到底是什么阻止了你？下面是如何开始！</h3></div><div class="mt l"><p class="bd b dl z fp mq fr fs mr fu fw dk translated">towardsdatascience.com</p></div></div><div class="mu l"><div class="pg l mw mx my mu mz lb ml"/></div></div></a></div></div><div class="ab cl oi oj hx ok" role="separator"><span class="ol bw bk om on oo"/><span class="ol bw bk om on oo"/><span class="ol bw bk om on"/></div><div class="im in io ip iq"><h1 id="5987" class="na nb it bd nc nd op nf ng nh oq nj nk ki or kj nm kl os km no ko ot kp nq nr bi translated">①抓取静态页面</h1><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ph"><img src="../Images/267b85ec0ee33a9d8c36f0ff6d60d414.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Yfdrqi7-H3nysog8"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk">Photo by <a class="ae lh" href="https://unsplash.com/@davidmarcu?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">David Marcu</a> on <a class="ae lh" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="2b62" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi ox translated">编写静态页面(即不使用 JavaScript 在页面上创建高度交互的页面)非常简单。静态网页就是一个用标记语言编写的大文件，它定义了内容应该如何呈现给用户。您可以非常快速地获得原始内容，而无需应用标记。假设我们想从这个<a class="ae lh" href="https://en.wikipedia.org/wiki/List_of_sovereign_states_and_dependent_territories_by_continent_(data_file)" rel="noopener ugc nofollow" target="_blank">维基百科页面</a>中获取下表:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi pi"><img src="../Images/e6fc9cf49bdb3838a2d1f8cf99010b63.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VExOKNHicyAxkzUQYIVhJQ.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk">Screenshot from <a class="ae lh" href="https://en.wikipedia.org/wiki/List_of_sovereign_states_and_dependent_territories_by_continent_(data_file)" rel="noopener ugc nofollow" target="_blank">Wikipedia page</a> shows country codes and corresponding names</figcaption></figure><p id="0585" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我们可以通过利用一个名为<a class="ae lh" href="https://pypi.org/project/requests/2.7.0/" rel="noopener ugc nofollow" target="_blank"> requests </a>的基本 Python 库来实现这一点，如下所示:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi pj"><img src="../Images/81d35c8fcdb0bc3cff98628b95bc3fd1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NFRUdlSMz9kNp1jPVJIWLA.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk">using requests library to download static page content</figcaption></figure><p id="435a" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">如你所见，这不是很有用。我们不想要所有的噪音，而是想只提取页面的特定元素(准确地说是表格)。这种情况下<a class="ae lh" href="https://www.crummy.com/software/BeautifulSoup/bs4/doc/" rel="noopener ugc nofollow" target="_blank">美汤</a>就派上了用场。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="pk pl l"/></div><figcaption class="ld le gj gh gi lf lg bd b be z dk">Static Extraction</figcaption></figure><p id="c294" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">漂亮的 Soup 允许我们轻松地导航、搜索或修改解析树。在通过适当的解析器运行原始内容之后，我们得到了一个可爱的干净的解析树。在这个树中，我们可以使用类“wikitable sortable”搜索“table”类型的元素。您可以通过右键单击表并单击 inspect 查看源代码来获得关于类和类型的信息。然后，我们遍历该表，逐行提取数据，最终得到以下结果:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi pm"><img src="../Images/46b283e5d9ee35f254bbc6d6f8f13e7f.png" data-original-src="https://miro.medium.com/v2/resize:fit:924/format:webp/1*JICCZQr_il0UziaIwxsvaQ.png"/></div><figcaption class="ld le gj gh gi lf lg bd b be z dk">parsed table from Wikipedia Page</figcaption></figure><p id="4f8f" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><strong class="lk jd">巧妙的技巧:<br/> </strong> Pandas 有一个内置的<code class="fe me mf mg mh b">read_html</code>方法，通过运行<code class="fe me mf mg mh b">pip install lxml</code>安装<a class="ae lh" href="https://lxml.de/" rel="noopener ugc nofollow" target="_blank"> lxml </a>(一个强大的 xml 和 HTML 解析器)后就可以使用了。<code class="fe me mf mg mh b">read_html</code>允许您执行以下操作:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi pn"><img src="../Images/5a1edb718eeeb6d282cbc5c72fc158e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:704/format:webp/1*XneMssyuP3vuBbqZda96pA.png"/></div><figcaption class="ld le gj gh gi lf lg bd b be z dk">the second result from read_html</figcaption></figure><p id="8871" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">正如你所看到的，我们调用<code class="fe me mf mg mh b">res[2]</code>是因为<code class="fe me mf mg mh b">pd.read_html()</code>会把它找到的所有东西转储到一个单独的数据帧中，即使是松散地类似于一个表。您必须检查哪个结果数据帧包含所需的数据。对于结构良好的数据，尝试一下<code class="fe me mf mg mh b">read_html</code>是值得的。</p></div><div class="ab cl oi oj hx ok" role="separator"><span class="ol bw bk om on oo"/><span class="ol bw bk om on oo"/><span class="ol bw bk om on"/></div><div class="im in io ip iq"><h1 id="3db5" class="na nb it bd nc nd op nf ng nh oq nj nk ki or kj nm kl os km no ko ot kp nq nr bi translated">②抓取互动页面</h1><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi po"><img src="../Images/4ad2e2b1c684ccac2e18a9b7659f52d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*86Q1RLN4fTqS3yls"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk">Photo by <a class="ae lh" href="https://unsplash.com/@rossf?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Ross Findon</a> on <a class="ae lh" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="b4e1" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi ox translated">然而，大多数现代网页都具有很强的互动性。“单页应用程序”的概念意味着网页本身会改变，而用户不必一直重新加载或从一个页面重定向到另一个页面。因为只有在特定的用户交互之后才会发生这种情况，所以在抓取数据时几乎没有什么选择(因为这些操作必须发生)。</p><p id="c8d7" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">有时，用户操作可能会触发对公开的后端 API 的调用。在这种情况下，可以直接访问 API 并获取结果数据，而不必经过中间不必要的步骤。然而，大多数时候，你将不得不经历点击按钮、滚动页面、等待加载和所有这些步骤……或者至少你必须让网页认为<strong class="lk jd">你</strong>正在做所有这些。硒来拯救！</p><h2 id="79ba" class="pp nb it bd nc pq pr dn ng ps pt dp nk lr pu pv nm lv pw px no lz py pz nq iz bi translated">硒</h2><p id="d2fd" class="pw-post-body-paragraph li lj it lk b ll nu kd ln lo nv kg lq lr ou lt lu lv ov lx ly lz ow mb mc md im bi translated"><a class="ae lh" href="https://www.seleniumhq.org/" rel="noopener ugc nofollow" target="_blank"> Selenium </a>可用于自动化 web 浏览器与 Python(以及其他语言)的交互。通俗地说，selenium 假装是一个真实的用户，它打开浏览器，“移动”光标，并点击按钮，如果你告诉它这样做的话。据我所知，Selenium 背后最初的想法是自动化测试。然而，在自动化基于 web 的重复性任务方面，Selenium 同样强大。</p><p id="ef2f" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">让我们看一个例子来说明硒的用法。不幸的是，需要事先做一点准备。我将用<strong class="lk jd">谷歌 Chrome 概述 Selenium 的安装和使用。</strong>如果您想使用另一个浏览器(如 Headless ),您必须下载相应的 web 驱动程序。你可以在这里找到更多信息<a class="ae lh" href="https://www.seleniumhq.org/download/" rel="noopener ugc nofollow" target="_blank"/>。</p><p id="d6af" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><strong class="lk jd">步骤:</strong></p><ol class=""><li id="fa27" class="ns nt it lk b ll lm lo lp lr qa lv qb lz qc md nz oa ob oc bi translated">安装谷歌浏览器(如果已经安装，跳过)</li><li id="5030" class="ns nt it lk b ll od lo oe lr of lv og lz oh md nz oa ob oc bi translated">识别你的 Chrome 版本。通常通过点击“关于谷歌浏览器”找到。我目前有版本<strong class="lk jd"> 77.0.3865.90 </strong>(我的主版本因此是<strong class="lk jd"> 77 </strong>，第一个点之前的数字)。</li><li id="f661" class="ns nt it lk b ll od lo oe lr of lv og lz oh md nz oa ob oc bi translated">从<a class="ae lh" href="https://chromedriver.chromium.org/downloads" rel="noopener ugc nofollow" target="_blank">这里</a>为你的主版本下载相应的 from 驱动程序，并将可执行文件放到一个可访问的位置(我使用<code class="fe me mf mg mh b">Desktop/Scraping</code></li><li id="eb91" class="ns nt it lk b ll od lo oe lr of lv og lz oh md nz oa ob oc bi translated">通过<code class="fe me mf mg mh b">pip install selenium</code>安装 Python Selenium 包</li></ol><p id="0619" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">启动网络驱动</p><p id="cb9f" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">运行下面的代码片段(为了便于演示，请在 Jupyter 笔记本上运行)并查看幽灵浏览器是如何打开的。</p><pre class="ks kt ku kv gt qd mh qe qf aw qg bi"><span id="e1d5" class="pp nb it mh b gy qh qi l qj qk">import selenium</span><span id="b5d5" class="pp nb it mh b gy ql qi l qj qk"># This is the path I use<br/># DRIVER_PATH = '.../Desktop/Scraping/chromedriver 2'</span><span id="e9dc" class="pp nb it mh b gy ql qi l qj qk"># Put the path for your ChromeDriver here<br/>DRIVER_PATH = &lt;YOUR PATH&gt;</span><span id="d5f4" class="pp nb it mh b gy ql qi l qj qk">wd = webdriver.Chrome(executable_path=DRIVER_PATH)</span></pre><p id="1870" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">如果一切按计划进行，您现在应该会看到这样的内容:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi qm"><img src="../Images/15363479fb3e420cb2c8044d3878538f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dbJbLgihX-OWeNTJhN-IQg.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk">Google Chrome browser controlled by Selenium</figcaption></figure><p id="551c" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">现在运行(在新单元格中):</p><pre class="ks kt ku kv gt qd mh qe qf aw qg bi"><span id="88e2" class="pp nb it mh b gy qh qi l qj qk">wd.get('<a class="ae lh" href="https://google.com'" rel="noopener ugc nofollow" target="_blank">https://google.com'</a>)</span></pre><p id="91f0" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">你的浏览器应该导航到——不出所料——google.com。现在运行:</p><pre class="ks kt ku kv gt qd mh qe qf aw qg bi"><span id="0a31" class="pp nb it mh b gy qh qi l qj qk">search_box = wd.find_element_by_css_selector('input.gLFyf')<br/>search_box.send_keys('Dogs')</span></pre><p id="91b7" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">当你的浏览器在搜索框中输入<code class="fe me mf mg mh b">Dogs</code>时，你就会看到结果。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi qn"><img src="../Images/832f8d3537f108de3267c9d4188d351e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*swAie_ado7BnDbavT-cApw.png"/></div></div></figure><p id="ca36" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">好吧，让我们关闭驱动程序:</p><pre class="ks kt ku kv gt qd mh qe qf aw qg bi"><span id="b2bf" class="pp nb it mh b gy qh qi l qj qk">wd.quit()</span></pre><p id="cf3b" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><strong class="lk jd">完美！你已经掌握了基本知识。Selenium 非常强大，几乎每个交互都可以模拟。有些动作甚至可以通过抽象方法来实现，比如点击按钮或者悬停在物体上。此外，如果出现最坏的情况，您可以通过将光标移动到您想要的位置，然后执行单击操作来模仿人类行为。</strong></p></div><div class="ab cl oi oj hx ok" role="separator"><span class="ol bw bk om on oo"/><span class="ol bw bk om on oo"/><span class="ol bw bk om on"/></div><div class="im in io ip iq"><h1 id="13de" class="na nb it bd nc nd op nf ng nh oq nj nk ki or kj nm kl os km no ko ot kp nq nr bi translated">③从谷歌上抓取图片</h1><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi qo"><img src="../Images/43be28707f35c838635f09d9edf6beef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*_o0m37kT0YuFQ107"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk">Photo by <a class="ae lh" href="https://unsplash.com/@bk010397?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Bharathi Kannan</a> on <a class="ae lh" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="47b8" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi ox translated">既然你现在明白了基本知识，我们就可以把所有的东西拼凑起来。让浏览器按照我们的要求行事:</p><ul class=""><li id="2950" class="ns nt it lk b ll lm lo lp lr qa lv qb lz qc md qp oa ob oc bi translated">搜索特定术语并获取图片链接</li><li id="557b" class="ns nt it lk b ll od lo oe lr of lv og lz oh md qp oa ob oc bi translated">下载图像</li></ul><p id="e515" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><strong class="lk jd">搜索特定短语&amp;获取图片链接</strong></p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="pk pl l"/></div><figcaption class="ld le gj gh gi lf lg bd b be z dk">get_image_links.py</figcaption></figure><p id="f911" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">函数<code class="fe me mf mg mh b">fetch_image_urls</code>需要三个输入参数:</p><ol class=""><li id="ff89" class="ns nt it lk b ll lm lo lp lr qa lv qb lz qc md nz oa ob oc bi translated"><code class="fe me mf mg mh b"><strong class="lk jd">query</strong></code>:搜索词，如<code class="fe me mf mg mh b"><strong class="lk jd">Dog</strong></code></li><li id="337d" class="ns nt it lk b ll od lo oe lr of lv og lz oh md nz oa ob oc bi translated"><code class="fe me mf mg mh b"><strong class="lk jd">max_links_to_fetch</strong></code>:刮刀应该收集的链环数</li><li id="1cc5" class="ns nt it lk b ll od lo oe lr of lv og lz oh md nz oa ob oc bi translated"><code class="fe me mf mg mh b"><strong class="lk jd">webdriver</strong></code>:实例化的 Webdriver</li></ol><p id="4a0b" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><strong class="lk jd">下载图像<br/> </strong>为了让下面的代码片段工作，我们首先必须通过运行<code class="fe me mf mg mh b">pip install Pillow</code>来安装<code class="fe me mf mg mh b">PIL</code>。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="pk pl l"/></div><figcaption class="ld le gj gh gi lf lg bd b be z dk">persist_image.py</figcaption></figure><p id="7f5c" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><code class="fe me mf mg mh b">persist_image</code>功能抓取一个图片 URL <code class="fe me mf mg mh b">url</code>并下载到<code class="fe me mf mg mh b">folder_path</code>中。该函数将为图像分配一个随机的 10 位 id。</p><p id="e82f" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><strong class="lk jd">综合起来<br/> </strong>下面的函数<code class="fe me mf mg mh b">search_and_download</code>结合了前面的两个函数，为我们使用 ChromeDriver 增加了一些弹性。更准确地说，我们在一个<code class="fe me mf mg mh b">with</code>上下文中使用 ChromeDriver，这保证了浏览器正常关闭，即使在<code class="fe me mf mg mh b">with</code>上下文中出现错误。<code class="fe me mf mg mh b">search_and_download</code>允许您指定<code class="fe me mf mg mh b"><strong class="lk jd">number_images</strong></code>，默认设置为 5，但可以设置为您想要下载的任意数量的图像。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="pk pl l"/></div><figcaption class="ld le gj gh gi lf lg bd b be z dk">search_and_donwload.py</figcaption></figure><p id="b1af" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">现在，我们可以执行以下操作:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi qq"><img src="../Images/ceb0941990a6c793fecf9b570ee32229.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6lp-yOUBw47NvPGyVUwfeQ.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk">Download some doggie images</figcaption></figure><p id="f65a" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">并将获得:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi qr"><img src="../Images/632fc6725af928c3c51ac8b902e6eea1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xTPXbbbVpbsHpRYoqX2loA.png"/></div></div></figure><p id="a112" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><strong class="lk jd">恭喜你！你已经建立了你自己的图像刮刀。考虑使用刮刀，享受你正在喝的咖啡，而不是手动下载 100 张图片。</strong></p><p id="98d1" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">如果您想了解如何自动执行抓取过程并持续运行，请查看以下文章:</p><div class="mi mj gp gr mk ml"><a rel="noopener follow" target="_blank" href="/practical-python-how-to-write-and-deploy-a-monitoring-notification-service-within-minutes-for-free-b682cffa66ef"><div class="mm ab fo"><div class="mn ab mo cl cj mp"><h2 class="bd jd gy z fp mq fr fs mr fu fw jc bi translated">实用 Python:如何在几分钟内编写和部署一个监控+通知服务？</h2><div class="ms l"><h3 class="bd b gy z fp mq fr fs mr fu fw dk translated">你曾经希望有一种服务，一旦它观察到一个特定的事件，就反复地检查和 pings 你吗？—了解如何…</h3></div><div class="mt l"><p class="bd b dl z fp mq fr fs mr fu fw dk translated">towardsdatascience.com</p></div></div><div class="mu l"><div class="qs l mw mx my mu mz lb ml"/></div></div></a></div><p id="02e8" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">哦，如果你喜欢阅读这样的故事，并想支持我成为一名作家，考虑注册成为一名灵媒成员。每月 5 美元，你可以无限制地阅读媒体上的故事。如果你用我的链接注册，我甚至会做一些🍩。</p><div class="mi mj gp gr mk ml"><a href="https://medium.com/@fabianbosler/membership" rel="noopener follow" target="_blank"><div class="mm ab fo"><div class="mn ab mo cl cj mp"><h2 class="bd jd gy z fp mq fr fs mr fu fw jc bi translated">通过我的推荐链接加入 Medium-Fabian Bosler</h2><div class="ms l"><h3 class="bd b gy z fp mq fr fs mr fu fw dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="mt l"><p class="bd b dl z fp mq fr fs mr fu fw dk translated">medium.com</p></div></div><div class="mu l"><div class="qt l mw mx my mu mz lb ml"/></div></div></a></div><h1 id="73a2" class="na nb it bd nc nd ne nf ng nh ni nj nk ki nl kj nm kl nn km no ko np kp nq nr bi translated">④关于网络抓取合法性的后记</h1><p id="a892" class="pw-post-body-paragraph li lj it lk b ll nu kd ln lo nv kg lq lr ou lt lu lv ov lx ly lz ow mb mc md im bi ox translated">我不是律师，所以我所说的一切都不应被视为法律意见。话虽如此，围绕网络抓取合法性的问题很可能要逐案评估。只要你不违反任何服务条款或对你抓取的网页产生负面影响，你就是清白的，这似乎是一个共识。网络抓取行为本身不可能违法。你可以抓取你的页面而不会有任何影响，毕竟谷歌机器人每天都在抓取整个网页。我的建议是:</p><blockquote class="qu"><p id="3d14" class="qv qw it bd qx qy qz ra rb rc rd md dk translated">确保您没有违反任何法律、服务条款或对您的目标产生负面影响。</p></blockquote></div></div>    
</body>
</html>