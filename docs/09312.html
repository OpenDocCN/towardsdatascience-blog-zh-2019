<html>
<head>
<title>Accuracy is NOT enough for Classification Tasks</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">对于分类任务来说，准确度是不够的</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/accuracy-is-not-enough-for-classification-task-47fca7d6a8ec?source=collection_archive---------23-----------------------#2019-12-09">https://towardsdatascience.com/accuracy-is-not-enough-for-classification-task-47fca7d6a8ec?source=collection_archive---------23-----------------------#2019-12-09</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="cf64" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">准确度、精确度和召回率之间的区别</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/fed2d406dd9df1cdfb9a89415799c3e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*zISyUAH_W9jAu7rB"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Photo by <a class="ae kv" href="https://unsplash.com/@matthewhenry?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Matthew Henry</a> on <a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="fe88" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这个机器学习时代，我们已经看到了很多关于使用人工智能来分类图像是否包含小狗、进行垃圾邮件检测或训练自动驾驶汽车识别交通标志的宣传。正如拥有正确的模型很重要一样，更重要的是能够判断您的模型执行得如何，以便您可以选择最适合您的任务的模型。</p><p id="cccb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这篇文章中，我们将介绍:</p><ul class=""><li id="bc37" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr lx ly lz ma bi translated">分类任务的一般定义</li><li id="bd3e" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">准确性指标</li><li id="c79d" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">精确度和召回率</li><li id="fa52" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">混淆度量</li><li id="630d" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">精确-召回权衡</li></ul><h1 id="31ce" class="mg mh iq bd mi mj mk ml mm mn mo mp mq jw mr jx ms jz mt ka mu kc mv kd mw mx bi translated">什么是分类？</h1><p id="99dd" class="pw-post-body-paragraph kw kx iq ky b kz my jr lb lc mz ju le lf na lh li lj nb ll lm ln nc lp lq lr ij bi translated">假设你面前有一张上面的图片，任务是判断图片中是否包含一只狗。如果你回答正确，你得到一分。如果没有，你将什么也得不到。这就是通常所说的分类任务，您试图给给定的数据分配一个特定的标签。</p><p id="6691" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这个分类任务在机器学习社区中非常流行，他们试图训练他们的模型，看看当前的算法是否可以完全区分对象。对于本文，我们不会关注使用哪种算法。相反，我们假设我们已经有了一个算法，我们想知道我们的算法执行得好不好？</p><h1 id="6d80" class="mg mh iq bd mi mj mk ml mm mn mo mp mq jw mr jx ms jz mt ka mu kc mv kd mw mx bi translated">准确(性)</h1><p id="c938" class="pw-post-body-paragraph kw kx iq ky b kz my jr lb lc mz ju le lf na lh li lj nb ll lm ln nc lp lq lr ij bi translated">一个简单的评估指标是准确性。假设你有 5 张图片，模型答对了 4 张，那么分数就是 0.8。因此，我们可以说准确度是全部图像中正确分类的图像的数量。这是简单而直观的，但这还不够。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nd"><img src="../Images/dbd0529fefafbc8d947508c504246dac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*O2pd8O6Gg2iXDANTQqzVjw.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Figure 1 — Images of dog and not-dog</figcaption></figure><p id="622a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">准确性本身也有一些下降。让我们考虑下面的例子。假设我们的数据集有 5 张图片:4 张不是狗，1 张是狗。我们还有一个如下的算法:</p><pre class="kg kh ki kj gt ne nf ng nh aw ni bi"><span id="7925" class="nj mh iq nf b gy nk nl l nm nn">def is_a_dog (x):<br/>    return False</span></pre><p id="0bed" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">上面的朴素算法假设所有东西都不是狗，而不对给定的数据做任何计算。需要注意的一点是，因为我们的数据集碰巧有 4 幅非狗的图像，所以这种简单算法的得分为 0.8。这不是我们想要的。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi no"><img src="../Images/33d35d24769f14947887ecbb791776d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ebV818artycNctONc2o2AQ.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Figure 2 — Naive algorithm returns all False</figcaption></figure><h1 id="3510" class="mg mh iq bd mi mj mk ml mm mn mo mp mq jw mr jx ms jz mt ka mu kc mv kd mw mx bi translated">精确度和召回率</h1><p id="1006" class="pw-post-body-paragraph kw kx iq ky b kz my jr lb lc mz ju le lf na lh li lj nb ll lm ln nc lp lq lr ij bi translated">应对这种情况的两个概念是精确和召回。下面我们来看看他们的简要说明。</p><ul class=""><li id="0246" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr lx ly lz ma bi translated"><strong class="ky ir">精度</strong>:在所有“狗”的预测中，有多少是正确分类的？</li></ul><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi np"><img src="../Images/79560b9cb348ecdcc2df3e615a7d8f79.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tZDuAZxMobRZgR_FawAz_g.png"/></div></div></figure><ul class=""><li id="f71b" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr lx ly lz ma bi translated"><strong class="ky ir">回忆</strong>:在所有“狗”的数据中，有多少是正确分类的？</li></ul><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nq"><img src="../Images/340dbf490cedd2bafa63e52556ab152d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BXvii9wAnBmmdzorxh8VkA.png"/></div></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nr"><img src="../Images/71886e43b80d7c475f6d443cad70364a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WuBEcAN2qgyX-KHpKw_now.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Figure 3 — Recall (looks only on data whose labels are dogs)</figcaption></figure><p id="811d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">先说回忆。在我们的数据集中，只有一只狗，我们的算法将其归类为非狗。所以，回忆=0/1=0。</p><p id="cb4a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然而为了精确，在这些预测中，没有一个预测是狗。因此，精度=0/0。注意，在某些情况下，由于分母为 0，所以不可能进行精度除法；因此，在这种情况下，我们可以简单地假设 precision=0。</p><h1 id="bbf2" class="mg mh iq bd mi mj mk ml mm mn mo mp mq jw mr jx ms jz mt ka mu kc mv kd mw mx bi translated">混淆矩阵</h1><p id="ba3a" class="pw-post-body-paragraph kw kx iq ky b kz my jr lb lc mz ju le lf na lh li lj nb ll lm ln nc lp lq lr ij bi translated">混淆矩阵将数据分为 4 类:真阳性、真阴性、假阳性和假阴性，如下图所示。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ns"><img src="../Images/b2e1e771081b99b0263279bf7eb2c700.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eZ6PaQ2dOp8Rkq6JzFAcWw.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Figure 4 — Confusion Matrix</figcaption></figure><ul class=""><li id="1701" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr lx ly lz ma bi translated">当数据具有标签“狗”并且预测具有相同的阳性标签时，为真阳性。</li><li id="1bfc" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">当数据的标签是“非狗”并且预测正确地具有相同的标签时，为真否定。</li><li id="176b" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">假阳性是当数据的标签是“非狗”但算法没有将其分类为“狗”时。</li><li id="0e6c" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">假阴性是当数据的标签是“狗”时，但算法说不是这样。</li></ul><p id="5a1a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">通常，当我们想要计算精确度和召回率时，使用混淆矩阵。计算方法与上一节描述的相同，但它使数字更容易阅读。对于这个例子，我们将看一个不同的例子，其中我们尝试对 10 幅图像进行分类。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nt"><img src="../Images/8c5387f354e5b8731749fa3f0a29f5b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3mzcmFwDILC6794OvHDluQ.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Figure 5 — Example of 10 images. Label underneath the images are the prediction</figcaption></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nu"><img src="../Images/e21a793eebd2b19b70d8359e4eac9430.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GdNotNrNYQcOIZqDdEm4pQ.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Figure 6 — Confusion Matrix on 10 images</figcaption></figure><p id="5819" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这种情况下，精度是 4/(4+3)=0.57，而召回率是 4/(4+2)=0.66。</p><h1 id="08de" class="mg mh iq bd mi mj mk ml mm mn mo mp mq jw mr jx ms jz mt ka mu kc mv kd mw mx bi translated">精确度或召回率</h1><p id="6283" class="pw-post-body-paragraph kw kx iq ky b kz my jr lb lc mz ju le lf na lh li lj nb ll lm ln nc lp lq lr ij bi translated">理想情况下，我们希望这两个值尽可能高。然而，这可能是不可能的。当我们提高召回率时，精确度会降低，反之亦然。因此，我们需要决定哪个对任务更重要。让我们仔细看看这种现象是如何发生的。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nv"><img src="../Images/69fd053f2de9b33d5666108b9b0e8880.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xxCAkYj1j6LqOSDX3O68yg.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Figure 7 — PrecisionRecall Tradeoff</figcaption></figure><p id="cc7c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">绿色框是正确分类的标签，黄色框是错误分类的标签。每个被错误分类的图像必须进入一个黄色的盒子:假阳性(精确)或假阴性(召回)。当然不可能两者兼而有之。</p><p id="45c8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">假设我们的模型肯定会有 5 个错误的标签，如果所有的错误分类都属于假阳性，那么我们将会有低精度和高召回率。然而，如果不正确的标签落入假阴性，我们反而会有高精度和低召回率。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nw"><img src="../Images/10dc5354c71fd09bc3e96070bda0e347.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jC6N5c55Wq0rSMk1oanUew.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Figure 8 — Examples of Precision-Recall Tradeoff</figcaption></figure><p id="f72e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">因此，当你训练你的机器学习模型时，你需要决定哪些指标更重要。例如，如果你被要求为金融机构建立一个模型，他们希望对借款人是否是一个好的候选人进行分类，你可能更喜欢你的模型不要鲁莽地提供贷款。因此，你宁愿把好人归类为坏人(假阴性)，而不是把坏人归类为好人(假阳性)。</p><p id="abda" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">换句话说，假阴性(召回)比假阳性(精确)更好。</p><h1 id="9148" class="mg mh iq bd mi mj mk ml mm mn mo mp mq jw mr jx ms jz mt ka mu kc mv kd mw mx bi translated">结论</h1><p id="226c" class="pw-post-body-paragraph kw kx iq ky b kz my jr lb lc mz ju le lf na lh li lj nb ll lm ln nc lp lq lr ij bi translated">所以，下一次当你面对一个分类任务时，确保不要只选择准确性作为度量，然后马上开始设计模型。当然，摆弄模型是令人兴奋的，但重要的是花一些时间来清楚地了解您正在处理什么样的问题，以及哪些指标最适合这项任务。一旦你解决了这个问题，你就可以确定你正在构建的模型是适合你的任务的。</p><h1 id="e7dc" class="mg mh iq bd mi mj mk ml mm mn mo mp mq jw mr jx ms jz mt ka mu kc mv kd mw mx bi translated">关键外卖</h1><p id="f9c8" class="pw-post-body-paragraph kw kx iq ky b kz my jr lb lc mz ju le lf na lh li lj nb ll lm ln nc lp lq lr ij bi translated">就是这样。我们已经到了这篇文章的结尾。回顾一下我们刚刚讨论的内容，以下是这篇文章的一些要点:</p><ol class=""><li id="ee83" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr nx ly lz ma bi translated">对于分类任务来说，准确度是不够。我们需要看看其他一些指标，以确保我们的模型是可靠的。</li><li id="87d1" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr nx ly lz ma bi translated">精度:在所有说狗的预测中，有多少是正确分类的？</li><li id="56d9" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr nx ly lz ma bi translated">回想一下:在所有关于狗的数据中，有多少是正确分类的？</li><li id="3972" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr nx ly lz ma bi translated">混淆矩阵有助于您更好地分析模型的性能。</li></ol><h1 id="2df4" class="mg mh iq bd mi mj mk ml mm mn mo mp mq jw mr jx ms jz mt ka mu kc mv kd mw mx bi translated">参考</h1><ul class=""><li id="4aae" class="ls lt iq ky b kz my lc mz lf ny lj nz ln oa lr lx ly lz ma bi translated"><a class="ae kv" href="https://en.wikipedia.org/wiki/Precision_and_recall" rel="noopener ugc nofollow" target="_blank">https://en.wikipedia.org/wiki/Precision_and_recall</a></li><li id="d514" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated"><a class="ae kv" href="https://machinelearningmastery.com/classification-accuracy-is-not-enough-more-performance-measures-you-can-use/" rel="noopener ugc nofollow" target="_blank">https://machine learning mastery . com/classification-accuracy-is-not-whole-not-whole-performance-measures-you-can-use/</a></li><li id="e75d" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated"><a class="ae kv" href="https://medium.com/techspace-usict/measuring-just-accuracy-is-not-enough-in-machine-learning-a-better-technique-is-required-e7199ac36856" rel="noopener">https://medium . com/tech space-usict/measuring-just-accuracy-is-what-not-what-difficult-have-better-technique-is-required-e 7199 AC 36856</a></li><li id="bfd0" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated"><a class="ae kv" rel="noopener" target="_blank" href="/beyond-accuracy-precision-and-recall-3da06bea9f6c">https://towards data science . com/beyond-accuracy-precision-and-recall-3da 06 bea 9 f6c</a></li></ul></div></div>    
</body>
</html>