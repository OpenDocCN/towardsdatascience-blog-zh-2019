<html>
<head>
<title>What is the technology behind DeepScale?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">DeepScale 背后的技术是什么？</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/what-is-the-technology-behind-deepscale-b40f05fe7423?source=collection_archive---------25-----------------------#2019-10-13">https://towardsdatascience.com/what-is-the-technology-behind-deepscale-b40f05fe7423?source=collection_archive---------25-----------------------#2019-10-13</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="ip iq gp gr ir is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/b95385fb45440c7c5af4075a09b44f73.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*51LsiOZyQD2nBZyFp17UfQ.jpeg"/></div></div></figure><div class=""/><div class=""><h2 id="f6a6" class="pw-subtitle-paragraph jy ja jb bd b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp dk translated">特斯拉最新收购的公司拥有设计 DNNs 的最佳技术</h2></div><h1 id="8d77" class="kq kr jb bd ks kt ku kv kw kx ky kz la kh lb ki lc kk ld kl le kn lf ko lg lh bi translated">问题是</h1><p id="c3e7" class="pw-post-body-paragraph li lj jb lk b ll lm kc ln lo lp kf lq lr ls lt lu lv lw lx ly lz ma mb mc md ij bi translated">深度学习正在接管世界，但最具性能的模型正在变得越来越大。这些大型网络需要大量的资源，不仅在电力和使用方面，而且它们需要大量的能量和时间来产生我们想要的结果。</p><p id="78fa" class="pw-post-body-paragraph li lj jb lk b ll me kc ln lo mf kf lq lr mg lt lu lv mh lx ly lz mi mb mc md ij bi translated">对于处于边缘并产生巨大结果的计算，需要更小的网络。网络越小，获得结果的速度越快，所需的资源也就越少(GPU 数量也就越少)。</p><p id="5488" class="pw-post-body-paragraph li lj jb lk b ll me kc ln lo mf kf lq lr mg lt lu lv mh lx ly lz mi mb mc md ij bi translated">为了产生更好的结果，已经开发了一些用较小的网络产生更好结果的技术。他们中的一些人在拥抱脸的博客文章中描述，在那里他们描述了他们如何提取最新版本的 Bert，这是 NLP 任务中表现最好的神经网络。</p><p id="1957" class="pw-post-body-paragraph li lj jb lk b ll me kc ln lo mf kf lq lr mg lt lu lv mh lx ly lz mi mb mc md ij bi translated"><strong class="lk jc"> DeepScale </strong>使用另一种技术来寻找小型但仍能产生良好结果的神经网络。DeepScale 执行神经架构搜索。神经架构搜索有望显著减少开发全新神经网络所需的工程时间和计算时间，该网络针对特定计算要求和错误率(或精度要求)进行了优化。</p><h1 id="dca3" class="kq kr jb bd ks kt ku kv kw kx ky kz la kh lb ki lc kk ld kl le kn lf ko lg lh bi translated">解决方法</h1><ul class=""><li id="ed7b" class="mk ml jb lk b ll lm lo lp lr mm lv mn lz mo md mp mq mr ms bi translated">该问题被定义为在某些搜索空间中找到计算和准确性的最佳折衷的网络</li><li id="152b" class="mk ml jb lk b ll mt lo mu lr mv lv mw lz mx md mp mq mr ms bi translated">您可以改变层数、通道数、内核大小、连接数等..</li></ul><p id="9107" class="pw-post-body-paragraph li lj jb lk b ll me kc ln lo mf kf lq lr mg lt lu lv mh lx ly lz mi mb mc md ij bi translated">如果你要搜索每一个神经网络，那么搜索空间变得难以训练在这个搜索空间中创建的每一个神经网络，如果每个神经网络都有几个选项的话。</p><p id="be81" class="pw-post-body-paragraph li lj jb lk b ll me kc ln lo mf kf lq lr mg lt lu lv mh lx ly lz mi mb mc md ij bi translated">为了找到正确的神经网络，研究人员尝试了一些不同的技巧来实现正确的神经网络架构。研究人员用一些不同的策略优化了搜索过程，这些策略有不同的选项:</p><ul class=""><li id="5f78" class="mk ml jb lk b ll me lo mf lr my lv mz lz na md mp mq mr ms bi translated">随机搜索</li><li id="5a10" class="mk ml jb lk b ll mt lo mu lr mv lv mw lz mx md mp mq mr ms bi translated">遗传搜索</li><li id="cae8" class="mk ml jb lk b ll mt lo mu lr mv lv mw lz mx md mp mq mr ms bi translated"><strong class="lk jc">强化学习</strong></li><li id="8b19" class="mk ml jb lk b ll mt lo mu lr mv lv mw lz mx md mp mq mr ms bi translated"><strong class="lk jc">差分搜索</strong>(基于梯度)</li></ul><p id="8a21" class="pw-post-body-paragraph li lj jb lk b ll me kc ln lo mf kf lq lr mg lt lu lv mh lx ly lz mi mb mc md ij bi translated">在这篇文章中，我们将回顾最后两种搜索方法，强化学习和差异搜索，因为它们目前是在有限的计算资源下提供最佳结果的方法。</p><h2 id="5952" class="nb kr jb bd ks nc nd dn kw ne nf dp la lr ng nh lc lv ni nj le lz nk nl lg nm bi translated">强化学习</h2><p id="04a3" class="pw-post-body-paragraph li lj jb lk b ll lm kc ln lo lp kf lq lr ls lt lu lv lw lx ly lz ma mb mc md ij bi translated">开创该领域的第一批工作之一是谷歌大脑的一篇论文，名为“具有强化学习的神经架构搜索”。这里可以找到<a class="ae mj" href="https://arxiv.org/pdf/1611.01578.pdf" rel="noopener ugc nofollow" target="_blank">。</a></p><div class="nn no np nq gt ab cb"><figure class="nr is ns nt nu nv nw paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><img src="../Images/f1f481b90188cf333e147aef6a4400ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:824/format:webp/1*6s0h4TDSuh3Zj7vjOjEBJQ.png"/></div></figure><figure class="nr is nx nt nu nv nw paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><img src="../Images/6ef5b0c483310bcf2329513b7321929a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1178/format:webp/1*m5abSUObBNkgG9cydl2ICQ.png"/></div><figcaption class="ny nz gj gh gi oa ob bd b be z dk oc di od oe">The left image shows the controller that will update the network parameters</figcaption></figure></div><p id="5523" class="pw-post-body-paragraph li lj jb lk b ll me kc ln lo mf kf lq lr mg lt lu lv mh lx ly lz mi mb mc md ij bi translated">其背后的思想是，通过使用强化学习循环来发现网络，以提升具有最佳准确性且使用最少计算量的网络。通过使用控制器找到网络，该控制器是基于 RNN 的网络。</p><p id="e160" class="pw-post-body-paragraph li lj jb lk b ll me kc ln lo mf kf lq lr mg lt lu lv mh lx ly lz mi mb mc md ij bi translated">通过改变过滤器的数量、高度、宽度、步幅等来生成网络。该过程通过生成神经网络、训练它、获得它的准确性并将其用作控制器的反馈来生成更好的候选。</p><p id="8e9b" class="pw-post-body-paragraph li lj jb lk b ll me kc ln lo mf kf lq lr mg lt lu lv mh lx ly lz mi mb mc md ij bi translated">使用这种技术，谷歌团队取得了比当时最先进的技术(SOTA)稍好的结果，但它使用的计算量非常大。它使用了 800 个 Nvidia K40 GPUs 天，或 50 万个 GPU 小时。该搜索是在一个小数据集上执行的，因此很难看出它在更大的数据集上会如何执行。</p><p id="a239" class="pw-post-body-paragraph li lj jb lk b ll me kc ln lo mf kf lq lr mg lt lu lv mh lx ly lz mi mb mc md ij bi translated"><strong class="lk jc">限制搜索</strong></p><p id="1d58" class="pw-post-body-paragraph li lj jb lk b ll me kc ln lo mf kf lq lr mg lt lu lv mh lx ly lz mi mb mc md ij bi translated">同一个小组没有在所有可能的网络中进行搜索，而是决定将搜索限制在每个小区上，即他们固定了网络拓扑并对每个小区进行搜索。结果要好得多。在 ImageNet1000 上，最终网络的准确性提高了 20%,速度提高了 28%。</p><p id="0c55" class="pw-post-body-paragraph li lj jb lk b ll me kc ln lo mf kf lq lr mg lt lu lv mh lx ly lz mi mb mc md ij bi translated">为了搜索神经网络，这个小组使用了更少的资源。他们使用了大约 5 万个 GPU 小时。在此设置中，所有单元格都是相同的。这仍然计算量太大，不切实际。</p><h2 id="e3e1" class="nb kr jb bd ks nc nd dn kw ne nf dp la lr ng nh lc lv ni nj le lz nk nl lg nm bi translated">差异搜索</h2><p id="4a70" class="pw-post-body-paragraph li lj jb lk b ll lm kc ln lo lp kf lq lr ls lt lu lv lw lx ly lz ma mb mc md ij bi translated">在准确性和计算资源方面的最佳结果是由脸书的一个小组发现的，该小组使用差分搜索来找到正确的架构。他们的把戏背后的想法是使用一个非常大的网络，其中包含许多更小的实验(内部)，而不是让一个控制器产生小实验来学习。</p><p id="8dab" class="pw-post-body-paragraph li lj jb lk b ll me kc ln lo mf kf lq lr mg lt lu lv mh lx ly lz mi mb mc md ij bi translated">该小组使用了基于梯度的随机超网，双重优化网络的卷积权重以及选择单个单元的参数。它使用<a class="ae mj" href="http://anotherdatum.com/gumbel-gan.html" rel="noopener ugc nofollow" target="_blank"> Gumbel-Softmax </a>从分类分布中采样，该分类分布由架构参数的学习参数加权。Gumbel-Softmax 技巧是一种寻找神经网络参数的方法，其中我们有一组离散的值，并且您想要执行反向传播。要了解它是如何工作的，我推荐阅读以下内容</p><div class="ip iq gp gr ir of"><a href="http://anotherdatum.com/gumbel-gan.html" rel="noopener  ugc nofollow" target="_blank"><div class="og ab fo"><div class="oh ab oi cl cj oj"><h2 class="bd jc gy z fp ok fr fs ol fu fw ja bi translated">疯狂的神经网络！他们现在可以从离散分布中取样了！</h2><div class="om l"><h3 class="bd b gy z fp ok fr fs ol fu fw dk translated">训练深度神经网络通常归结为定义你的模型的架构和损失函数，并且…</h3></div><div class="on l"><p class="bd b dl z fp ok fr fs ol fu fw dk translated">anotherdatum.com</p></div></div><div class="oo l"><div class="op l oq or os oo ot ix of"/></div></div></a></div><p id="88b6" class="pw-post-body-paragraph li lj jb lk b ll me kc ln lo mf kf lq lr mg lt lu lv mh lx ly lz mi mb mc md ij bi translated">脸书团队在一个超级网络上进行训练，以找到网络的权重，并在 ImageNet 或 ImageNet1000 的 10%子集上进行训练。</p><p id="d965" class="pw-post-body-paragraph li lj jb lk b ll me kc ln lo mf kf lq lr mg lt lu lv mh lx ly lz mi mb mc md ij bi translated">结果令人印象深刻。他们在 ImageNet 分类上实现了 MobileNetV2 的准确性，同时延迟降低了 1.5 倍。搜索成本仅为 216 GPU (P100)小时。</p><h1 id="b8ab" class="kq kr jb bd ks kt ku kv kw kx ky kz la kh lb ki lc kk ld kl le kn lf ko lg lh bi translated">深度扩展解决方案</h1><p id="7b7a" class="pw-post-body-paragraph li lj jb lk b ll lm kc ln lo lp kf lq lr ls lt lu lv lw lx ly lz ma mb mc md ij bi translated">DeepScale 采用了类似的方法来应用 NAS(神经架构搜索)来设计用于语义分割的 DNNs。语义细分被自动驾驶汽车公司广泛使用。</p><p id="8914" class="pw-post-body-paragraph li lj jb lk b ll me kc ln lo mf kf lq lr mg lt lu lv mh lx ly lz mi mb mc md ij bi translated">图像分割比图像分类难多了。它需要更多的竞争资源。对于图像分类，最先进的神经网络的计算资源范围约为 10 GFLOPs，而对于图像分割，SOTA 网络约为 1 TFLOPs。</p><p id="0008" class="pw-post-body-paragraph li lj jb lk b ll me kc ln lo mf kf lq lr mg lt lu lv mh lx ly lz mi mb mc md ij bi translated">DeepScale 使用与 FBNet 相同的技术创建了一个用于图像分割的神经网络，它达到了 SOTA 精度，并且性能更好。他们对网络的编码器进行了神经架构搜索。</p><figure class="nn no np nq gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ou"><img src="../Images/2ba5202cf06814716fba4cc767e9824e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*19F4VZNve6M-4zW_6ne4Kg.png"/></div></div></figure><p id="8b36" class="pw-post-body-paragraph li lj jb lk b ll me kc ln lo mf kf lq lr mg lt lu lv mh lx ly lz mi mb mc md ij bi translated">下面是 DeepScale 的实现细节</p><p id="f0f8" class="pw-post-body-paragraph li lj jb lk b ll me kc ln lo mf kf lq lr mg lt lu lv mh lx ly lz mi mb mc md ij bi translated"><strong class="lk jc"> SqueezeNAS 实施细则:</strong></p><figure class="nn no np nq gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ov"><img src="../Images/86c7ce39258674724b730ffedbdf6ed5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rZ84V5ETvfyLMRVq2KzQsQ.png"/></div></div></figure><ul class=""><li id="20ad" class="mk ml jb lk b ll me lo mf lr my lv mz lz na md mp mq mr ms bi translated">22 层每单元 13 个候选(10 个⁴可能网络)</li><li id="e935" class="mk ml jb lk b ll mt lo mu lr mv lv mw lz mx md mp mq mr ms bi translated">随机初始化超级网络，仅训练卷积权重，然后切换到交替模式。</li></ul><p id="bf8b" class="pw-post-body-paragraph li lj jb lk b ll me kc ln lo mf kf lq lr mg lt lu lv mh lx ly lz mi mb mc md ij bi translated">超级网络收敛后:</p><ul class=""><li id="480b" class="mk ml jb lk b ll me lo mf lr my lv mz lz na md mp mq mr ms bi translated">通过 Gumbel-Softmax 技巧对候选网络进行采样</li><li id="7129" class="mk ml jb lk b ll mt lo mu lr mv lv mw lz mx md mp mq mr ms bi translated">在城市景观验证集上运行每个采样候选网络</li><li id="149b" class="mk ml jb lk b ll mt lo mu lr mv lv mw lz mx md mp mq mr ms bi translated">让最优秀的候选人接受全面培训</li></ul><p id="11e7" class="pw-post-body-paragraph li lj jb lk b ll me kc ln lo mf kf lq lr mg lt lu lv mh lx ly lz mi mb mc md ij bi translated">在所有这些之后，DeepScale 选择了给定网络精度和计算资源的最佳网络。DeepScale 发现网络具有最佳性能，并且需要较少的计算资源来实现这些结果，例如，与 MobileNetV2[40]分段网络相比，他们的 SqueezeNAS-MAC-Large 网络实现了超过 2.5%的绝对 mIOU，而 mobilenetv 2[40]分段网络的 MAC 是其网络的两倍以上。</p><p id="b898" class="pw-post-body-paragraph li lj jb lk b ll me kc ln lo mf kf lq lr mg lt lu lv mh lx ly lz mi mb mc md ij bi translated">每个网络的 DeepScale 搜索在不到 15 GPU-day 的时间内被找到，这比一些强化学习和遗传搜索方法少 100 多倍。</p><h1 id="6b87" class="kq kr jb bd ks kt ku kv kw kx ky kz la kh lb ki lc kk ld kl le kn lf ko lg lh bi translated">结论</h1><p id="bd2d" class="pw-post-body-paragraph li lj jb lk b ll lm kc ln lo lp kf lq lr ls lt lu lv lw lx ly lz ma mb mc md ij bi translated">总而言之，对于希望实现 SOTA 结果并且同时需要很少计算资源的神经网络来说，神经架构搜索似乎导致了最好的结果。我们可能会在这个领域看到越来越多的创新，从而产生更好的网络。</p></div></div>    
</body>
</html>