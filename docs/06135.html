<html>
<head>
<title>Bootstrapping for Inferential Statistics</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">推断统计的自举</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/bootstrapping-for-inferential-statistics-9b613a7653b2?source=collection_archive---------21-----------------------#2019-09-05">https://towardsdatascience.com/bootstrapping-for-inferential-statistics-9b613a7653b2?source=collection_archive---------21-----------------------#2019-09-05</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="cbc0" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">数据科学家的工具包—引导、采样、置信区间、假设检验</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/1cf47ff27a1efa639dbada248aef4baf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*N7foJx_cogR2rzfP"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Photo by <a class="ae ky" href="https://unsplash.com/@nate_dumlao?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Nathan Dumlao</a> on <a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="b139" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Bootstrap 是一种强大的基于计算机的统计推断方法，它不依赖于太多的假设。仅仅从一个样本数据中形成一个抽样分布是很神奇的。我的统计推断不需要公式。不仅如此，事实上，它还广泛应用于其他统计推断如置信区间、回归模型，甚至机器学习领域。</p><p id="1c25" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这篇文章中，我们将主要讨论两件事</p><ol class=""><li id="30c5" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">建立置信区间</li><li id="8edb" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">假设检验</li></ol><p id="a575" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://github.com/samarth-agrawal-86/data_scientist_toolkit" rel="noopener ugc nofollow" target="_blank">链接到 github 获取代码和数据集。</a></p></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="e087" class="mq mr it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi translated">一.置信区间</h1><p id="a0e0" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">在现实世界中——我们并不真正了解我们的真实人口。因为这可能是地球上的全部人口，也可能是一家公司过去、现在和未来的交易。<strong class="lb iu"> <em class="nn">我们只是不知道参数的真实值。</em> </strong>所以我们依靠抽样分布来推断这些大群体的一些参数。</p><p id="0e68" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">假设检验和我们建立置信区间的方式有许多不同的名称:</p><ul class=""><li id="c7e0" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu no mb mc md bi translated">t 检验</li><li id="2b41" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu no mb mc md bi translated">双样本 t 检验</li><li id="c000" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu no mb mc md bi translated">z 检验</li><li id="67c3" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu no mb mc md bi translated">卡方检验</li></ul><p id="7ada" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">可以使用自举方法来代替这些</strong>。我们将通过一个示例来了解如何使用抽样分布为我们感兴趣的参数建立置信区间。</p><p id="6cce" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">目标:假设我们想知道喝咖啡的人的平均身高是多少</p><h2 id="1d35" class="np mr it bd ms nq nr dn mw ns nt dp na li nu nv nc lm nw nx ne lq ny nz ng oa bi translated">方法 1:使用自举方法</h2><p id="1c39" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">我们有所有喝咖啡者的数据集。` coffee_full.csv</p><pre class="kj kk kl km gt ob oc od oe aw of bi"><span id="84e4" class="np mr it oc b gy og oh l oi oj">coffee_full = pd.read_csv(‘coffee_dataset.csv’)</span></pre><p id="1e45" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">由此，我将创建一个包含 200 个数据点的样本数据集。让我们称它为红色咖啡。这是因为在现实中我们从来没有得到完整的人口</p><pre class="kj kk kl km gt ob oc od oe aw of bi"><span id="7f59" class="np mr it oc b gy og oh l oi oj">coffee_red = coffee_full.sample(n=200)</span></pre><p id="2da8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在我们的数据集中喝咖啡的人的比例</p><pre class="kj kk kl km gt ob oc od oe aw of bi"><span id="2910" class="np mr it oc b gy og oh l oi oj">[coffee_red[‘drinks_coffee’]==True].mean()</span><span id="b7c2" class="np mr it oc b gy ok oh l oi oj">---Output---<br/>0.595</span></pre><p id="7cb3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在我们的数据集中，喝咖啡的人的平均身高</p><pre class="kj kk kl km gt ob oc od oe aw of bi"><span id="577b" class="np mr it oc b gy og oh l oi oj">coffee_red[coffee_red[‘drinks_coffee’]==True]['height'].mean()</span><span id="92a7" class="np mr it oc b gy ok oh l oi oj">---Output---<br/>68.119 inches</span></pre><p id="d60f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们从样本中引导出一个置信区间</p><pre class="kj kk kl km gt ob oc od oe aw of bi"><span id="4004" class="np mr it oc b gy og oh l oi oj"># Let's first create an empty list for storing means of bootstrapped samples<br/>boot_means = []</span><span id="6719" class="np mr it oc b gy ok oh l oi oj"># Let's write a loop for creating 1000 bootstrapped samples<br/>for i in range(1000):<br/>    bootsample = coffee_red.sample(200, replace=True)<br/>    bootsample_mean = bootsample.[bootsample[‘drinks_coffee’]==True]['height'].mean()<br/>    boot_means.append(bootsample_mean)</span><span id="9b19" class="np mr it oc b gy ok oh l oi oj">boot_means = np.array(boot_means)</span></pre><p id="a790" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于 95%的置信区间，我们从每一侧截取 2.5%，然后从抽样分布中截取这些值，这将给出我们认为参数“具有 95%置信度”的范围</p><pre class="kj kk kl km gt ob oc od oe aw of bi"><span id="4681" class="np mr it oc b gy og oh l oi oj"># we build 95% in the middle portion</span><span id="e708" class="np mr it oc b gy ok oh l oi oj">np.percentile(boot_means, 2.5), np.percentile(boot_means, 97.5)</span><span id="40fe" class="np mr it oc b gy ok oh l oi oj">---Output---<br/>(66.00, 67.59)</span></pre><p id="ad43" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以将这些值解释为我们认为人群中所有喝咖啡者的平均身高有 95%置信度的界限</p><p id="1440" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了形象化这一点，让我们看下图</p><pre class="kj kk kl km gt ob oc od oe aw of bi"><span id="72d6" class="np mr it oc b gy og oh l oi oj">plt.hist(boot_means, alpha=0.7);<br/>plt.axvline(np.percentile(boot_means, 2.5), color='red', linewidth=2) ;<br/>plt.axvline(np.percentile(boot_means, 97.5), color='red', linewidth=2) ;</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ol"><img src="../Images/4ec0a9197e07cf7866623b3cc4a07ddc.png" data-original-src="https://miro.medium.com/v2/resize:fit:770/format:webp/1*46Q9s4C7mD7LfPQ3hE6ipQ.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Confidence Interval from our boot-sample mean</figcaption></figure><h2 id="9896" class="np mr it bd ms nq nr dn mw ns nt dp na li nu nv nc lm nw nx ne lq ny nz ng oa bi translated">置信区间解释</h2><p id="1250" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">我们有 95%的把握认为所有喝咖啡的人的平均身高在 66.0 到 67.59 英寸之间</p><p id="b9a1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们回过头来看看人口的实际意义是什么</p><pre class="kj kk kl km gt ob oc od oe aw of bi"><span id="1945" class="np mr it oc b gy og oh l oi oj">coffee_full[coffee_full[‘drinks_coffee’]==True][‘height’].mean()</span><span id="5fd0" class="np mr it oc b gy ok oh l oi oj">---Output---<br/>66.44 inch</span></pre><p id="750f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以看到我们最初的平均身高在 95%的置信区间内</p><h2 id="6e0e" class="np mr it bd ms nq nr dn mw ns nt dp na li nu nv nc lm nw nx ne lq ny nz ng oa bi translated">方法 2:传统的内置方法(T 检验)</h2><p id="2b9a" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">python 中已经内置了许多构建置信区间的传统方法。<a class="ae ky" href="https://stackoverflow.com/questions/31768464/confidence-interval-for-t-test-difference-between-means-in-python" rel="noopener ugc nofollow" target="_blank"> <em class="nn">这里有一个不错的 stackoverflow 链接</em> </a></p><pre class="kj kk kl km gt ob oc od oe aw of bi"><span id="36ec" class="np mr it oc b gy og oh l oi oj">import statsmodels.stats.api as sm</span><span id="27b6" class="np mr it oc b gy ok oh l oi oj">X1 = coffee_red[coffee_red['drinks_coffee']==True]['height'] <br/>X2 = coffee_red[coffee_red['drinks_coffee']==False]['height']</span><span id="6a4d" class="np mr it oc b gy ok oh l oi oj">cm = sm.CompareMeans(sm.DescrStatsW(X1), sm.DescrStatsW(X2))</span><span id="c1e0" class="np mr it oc b gy ok oh l oi oj">print (cm.tconfint_diff(usevar='unequal'))</span></pre><p id="2421" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">请注意，自举方法和使用传统方法内置的时间间隔几乎相同</p></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="64e5" class="mq mr it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi translated">二。假设检验</h1><p id="fdd6" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">作为一名数据科学家，你必须首先将问题转化为所谓的假设。然后你需要用数据来证明哪个假设可能是真的。</p><p id="3c8a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">假设我们想问一个问题，所有喝咖啡的人的平均身高是否大于 70 英寸。</p><p id="4a05" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这里我们将不得不定义什么叫做零假设和交替假设。零假设是在我们收集数据之前就被默认为真的东西。替代假设是我们试图用数据来证明的东西</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi om"><img src="../Images/7c366f22ce5f8a14a4292b870c41448c.png" data-original-src="https://miro.medium.com/v2/resize:fit:558/format:webp/1*9_59YzMbWWaiP_gdMysmjg.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Null and Alternate hypothesis for our use case</figcaption></figure><h2 id="75f9" class="np mr it bd ms nq nr dn mw ns nt dp na li nu nv nc lm nw nx ne lq ny nz ng oa bi translated">方法 1:检查是否可能为空(引导)</h2><p id="b2c6" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">我们可以引导一组样本数据，反复计算样本均值，建立样本分布和置信区间，以确定在一定置信水平下总体均值的合理值</p><pre class="kj kk kl km gt ob oc od oe aw of bi"><span id="12c9" class="np mr it oc b gy og oh l oi oj">means = []</span><span id="1dde" class="np mr it oc b gy ok oh l oi oj">for i in range(10000):<br/>   bootsample = sample_df.sample(n=150, replace = True)<br/>   bootsample_mean = bootsample[bootsample['drinks_coffee']==True]<br/>   means.append(bootsample_mean['height'].mean())</span><span id="92a0" class="np mr it oc b gy ok oh l oi oj">means = np.array(means)</span><span id="18c2" class="np mr it oc b gy ok oh l oi oj">np.percentile(means, 2.5), np.percentile(means, 97.5)</span><span id="b9be" class="np mr it oc b gy ok oh l oi oj">---Output---<br/>(66.00, 67.59)</span></pre><p id="9522" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以看到我们 95%的置信区间是(66.0，67.59)。值 70 超出了 95%的置信区间，因此可以肯定地说替代假设不成立。我们未能拒绝我们的无效假设</p><h2 id="0401" class="np mr it bd ms nq nr dn mw ns nt dp na li nu nv nc lm nw nx ne lq ny nz ng oa bi translated">方法 2:模拟零假设</h2><p id="e4e5" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">我们从假设零假设为真开始。如果我们要模拟最接近零假设的值，我们就会知道抽样分布是什么样的</p><p id="20f0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这种情况下，我们将从正态分布进行模拟</p><pre class="kj kk kl km gt ob oc od oe aw of bi"><span id="cf1d" class="np mr it oc b gy og oh l oi oj">null_vals = np.random.normal(loc = 70, scale = np.std(means), size =10000)</span></pre><p id="bd84" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">70 是我们假设的平均值</p><p id="915e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这里的每个模拟图都代表了零假设的一个可能的平均值。我们现在可以问这样一个问题，样本均值落在这个分布的什么位置</p><pre class="kj kk kl km gt ob oc od oe aw of bi"><span id="fcc1" class="np mr it oc b gy og oh l oi oj">plt.hist(null_vals, alpha=0.7);<br/>plt.axvline(sample_mean, color = 'red', linewidth=2);</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi on"><img src="../Images/98cecc399725a1ce3387628b1d37533f.png" data-original-src="https://miro.medium.com/v2/resize:fit:764/format:webp/1*JeSp7Q3lDWn9s8reyVv3aw.png"/></div></figure><p id="f258" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以看到，它远远低于这个分布，我们不认为它可能来自这个零假设值。因此我们可以说我们的零假设是正确的</p><pre class="kj kk kl km gt ob oc od oe aw of bi"><span id="f9ee" class="np mr it oc b gy og oh l oi oj">p_value = (null_vals &gt; sample_mean).mean()<br/>p_value</span><span id="c7e1" class="np mr it oc b gy ok oh l oi oj">--Output--<br/>1.0</span></pre><p id="3f01" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">大 p 值表明我们不能拒绝我们的零假设。这意味着我们的人口平均数确实小于或等于 70</p><ul class=""><li id="cc44" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu no mb mc md bi translated">我们将 p 值计算为大于样本均值的模拟抽奖的比例</li><li id="53af" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu no mb mc md bi translated">在此，p 值以图形方式表示大于突出显示红线的所有值的曲线下面积。基本上是所有的数据</li></ul><h2 id="2be5" class="np mr it bd ms nq nr dn mw ns nt dp na li nu nv nc lm nw nx ne lq ny nz ng oa bi translated">结束语:</h2><ul class=""><li id="3115" class="lv lw it lb b lc ni lf nj li oo lm op lq oq lu no mb mc md bi translated">请随意写下您的想法/建议/反馈</li><li id="79bb" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu no mb mc md bi translated">一篇关于自举基础的内容丰富的文章- <a class="ae ky" rel="noopener" target="_blank" href="/an-introduction-to-the-bootstrap-method-58bcb51b4d60">自举方法介绍</a></li><li id="4b9e" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu no mb mc md bi translated">T 检验的 Stackoverflow 链接-<a class="ae ky" href="https://stackoverflow.com/questions/31768464/confidence-interval-for-t-test-difference-between-means-in-python" rel="noopener ugc nofollow" target="_blank">T 检验的置信区间</a></li><li id="d6b4" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu no mb mc md bi translated"><a class="ae ky" href="https://github.com/samarth-agrawal-86/data_scientist_toolkit" rel="noopener ugc nofollow" target="_blank"> Github 链接</a></li></ul></div></div>    
</body>
</html>