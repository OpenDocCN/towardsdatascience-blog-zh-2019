# 地址和城镇:使用谷歌地图 API + PhilGIS 进行地理标记

> 原文：<https://towardsdatascience.com/addresses-and-barangays-geotagging-with-google-maps-api-philgis-73d575c0e8e1?source=collection_archive---------24----------------------->

## 将谷歌地图和 shapefiles 链接到他们的镇(菲律宾版的一个县)，以避免痛苦的手动分类的需要

登革热在菲律宾是一个真正的问题。[头痛、关节痛、全身皮疹和死亡——这种疾病今年在菲律宾已有 146，000 个病例，并夺走了 622 人的生命](https://www.cnn.com/2019/08/07/health/philippines-dengue-epidemic-intl-hnk/index.html)。在 17 个地区中，有 7 个地区已经宣布发生了流行病，围绕唯一获得许可的登革热疫苗的使用仍然存在很大争议。

作为防止登革热传播的努力的一部分，由 Wilson Chua 博士领导的蚊子实时普查项目旨在使用卫星数据来识别可能成为潜在登革热热点的死水区域。最终目标是在这些地区放置诱蚊产卵器和传感器，以检测蚊子的存在，并就可能的疫情向官员发出警报。

我的任务是将 6100 个地址映射到奎松市相应的镇。村是菲律宾最小的政府单位，包括从 10 个街区到 30 个街区(甚至更大)的范围。奎松市(大马尼拉地区最大的城市)由 142 个镇组成。

![](img/4b7df9e5a877805c202fdc3161b73482.png)

A bunch of barangays crammed like sardines in Manila

![](img/f4119fa028148a7c3625434d763bc255.png)

And Barangay Pasong Tamo casually sitting there just encompassing 3 villages, a park and a university

最初，这项任务需要手动完成。让事情变得更复杂的是，镇有旧名字和新名字，谷歌地图上出现的一些地区和区域的名字看起来是镇，但实际上不是。有多条街道有相同的名字，而镇镇通常不写在地址上。

![](img/97b2a0aa0a1a6c17d3296a7a0cdbb681.png)

幸运的是，Google Maps API 和 PhilGIS 的 barangay shapefiles(祝福你)有所有必要的信息来通过**简化这个过程。**

# 方法(快速和无统计)

使用 Python 模块**请求**，我提取了每个地址的谷歌地图信息，从中提取了纬度和经度。然后，对于每个地址，我检查它的纬度和经度是否在一个镇的区域内，该镇的坐标取自 PhilGIS 的 shapefiles。

对于用谷歌地图和[菲尔吉斯](http://philgis.org/country-barangay/country-barangays-file)找不到的镇，我不得不手动分类。找不到这些地址，因为它们太模糊或有冲突的信息。也许街道与地址中写的城市不匹配，或者建筑物的名称位于不同的街道上。在进行全面的强力搜索之前，我使用可以识别重要地点标识符的关键字标记了每个地址，即:

*   布兰盖:BGY，布里吉
*   村庄:村庄，SUBD，丘陵，家园，高地，HTS
*   项目:PROJ 项目
*   建筑:大楼，公寓，公寓，住宅，住宅
*   Road: RD，Road，ST，STR，STREET，DRIVE，EXT，EXTN，SCT，SCOUT
*   大道，大道，道路

对于 Barangay、Project 和 Scout(马尼拉的一组道路)，我在它们后面加上了一个单词，以给出这个地方的名称(例如， **Barangay** Tatalon， **Project** 4， **Scout** Chuatoco)。剩下的我就拿他们之前的话(达马尔**村**，巴纳韦**街**，草地**民居**，奎松**大道**)。

关键词是按照显示的顺序选择的:如果镇名写在地址中，就不需要进一步分类了——因为它已经在那里了！村庄非常具体，项目(住宅小区)和建筑也是如此，因为它们有特定的地址。道路和大道变得更加不具体，因为它们并不总是有特定的数字，而且镇的边界经常在道路/大道上相交，所以不会非常清楚哪个地址通向哪里。这些关键字有助于更快地阅读地址——而不是阅读整个地址，我只需查找村庄或建筑物的具体名称，或者直接复制 barangay，这使得任务更快。

# 结果

在任何自动化之前，我尝试手动操作。对于每个地址，我平均花了大约一分钟(花了很长时间，因为有些地址缩写怪异，在谷歌地图上匹配多个位置，有模糊的细节，等等。).因此，我需要 **102 个小时**才能完成。

另一方面，运行整个代码需要大约半个小时，并且它对所有地址的 97%进行了分类。我花了大约 3 个小时来分类剩下的 180 个地址。

该代码可供使用，并可以扩展到整个菲律宾几乎所有其他省份！细节在朱庇特笔记本上。

# 附录

点击查看代码