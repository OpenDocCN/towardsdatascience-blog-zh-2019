<html>
<head>
<title>How to Generate Word Clouds in R</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在 R 中生成单词云</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/create-a-word-cloud-with-r-bde3e7422e8a?source=collection_archive---------1-----------------------#2019-10-15">https://towardsdatascience.com/create-a-word-cloud-with-r-bde3e7422e8a?source=collection_archive---------1-----------------------#2019-10-15</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="368b" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">如何以及何时使用它们的简单步骤</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/d52d9558e099c4e5f02a2c2cadf51da0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6EOreOJ-SDAqvnnTaeEh0g.png"/></div></div></figure><h1 id="93c8" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">创建单词云的 4 个主要步骤</h1><p id="4fcd" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">在接下来的部分中，我将向你展示如果你想用 r 生成一个单词云，需要遵循的 4 个简单步骤。</p><h2 id="b2d9" class="mf ks iq bd kt mg mh dn kx mi mj dp lb ls mk ml ld lw mm mn lf ma mo mp lh mq bi translated">步骤 1:检索数据并上传包</h2><p id="19fc" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">要生成文字云，你需要下载 R 版本的<em class="mr">文字云</em> <strong class="ll ir"> </strong>包以及颜色的<em class="mr"> RcolorBrewer </em>包。注意还有一个<em class="mr"> wordcloud2 </em>包，设计略有不同，应用也很好玩。我将向您展示如何使用这两个包。</p><pre class="kg kh ki kj gt ms mt mu mv aw mw bi"><span id="bf4f" class="mf ks iq mt b gy mx my l mz na">install.packages("wordcloud")<br/>library(wordcloud)</span><span id="6e0b" class="mf ks iq mt b gy nb my l mz na">install.packages("RColorBrewer")<br/>library(RColorBrewer)</span><span id="bf66" class="mf ks iq mt b gy nb my l mz na">install.packages("wordcloud2)<br/>library(wordcloud2)</span></pre><p id="2254" class="pw-post-body-paragraph lj lk iq ll b lm nc jr lo lp nd ju lr ls ne lu lv lw nf ly lz ma ng mc md me ij bi translated">最常见的是，词云被用来分析 twitter 数据或文本语料库。如果你正在分析 twitter 数据，只需通过使用<em class="mr"> rtweet </em>包上传你的数据(参见这篇<a class="ae nh" rel="noopener" target="_blank" href="/a-guide-to-mining-and-analysing-tweets-with-r-2f56818fdd16">文章</a>了解更多信息)。如果你正在处理一篇演讲、一篇文章或任何其他类型的文本，确保将你的文本数据作为一个语料库加载。一个有用的方法是使用<em class="mr"> tm </em> <strong class="ll ir"> </strong>包。</p><pre class="kg kh ki kj gt ms mt mu mv aw mw bi"><span id="bca2" class="mf ks iq mt b gy mx my l mz na">install.packages("tm")<br/>library(tm)</span><span id="fe1e" class="mf ks iq mt b gy nb my l mz na">#Create a vector containing only the text<br/>text &lt;- data$text</span><span id="b435" class="mf ks iq mt b gy nb my l mz na"># Create a corpus  <br/>docs &lt;- Corpus(VectorSource(text))</span></pre><h2 id="e493" class="mf ks iq bd kt mg mh dn kx mi mj dp lb ls mk ml ld lw mm mn lf ma mo mp lh mq bi translated">步骤 2:清理文本数据</h2><p id="d490" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">在生成你的单词云之前，清理是必不可少的一步。事实上，为了让您的分析带来有用的见解，您可能需要从文本中删除特殊字符、数字或标点符号。此外，您应该删除常见的停用词，以产生有意义的结果，并避免最常见的频繁出现的词，如“I”或“the”出现在词云中。</p><p id="fdfb" class="pw-post-body-paragraph lj lk iq ll b lm nc jr lo lp nd ju lr ls ne lu lv lw nf ly lz ma ng mc md me ij bi translated">如果你正在使用<strong class="ll ir"> tweets </strong>，使用下面一行代码来清理你的文本。</p><pre class="kg kh ki kj gt ms mt mu mv aw mw bi"><span id="3909" class="mf ks iq mt b gy mx my l mz na">gsub("https\\S*", "", tweets$text) <br/>gsub("@\\S*", "", tweets$text) <br/>gsub("amp", "", tweets$text) <br/>gsub("[\r\n]", "", tweets$text)<br/>gsub("[[:punct:]]", "", data$text)</span></pre><p id="1bf2" class="pw-post-body-paragraph lj lk iq ll b lm nc jr lo lp nd ju lr ls ne lu lv lw nf ly lz ma ng mc md me ij bi translated">如果你正在处理一个<strong class="ll ir">文集</strong>，有几个软件包可以用来清理你的文本。下面几行代码向您展示了如何使用<em class="mr"> tm </em>包来做到这一点。</p><pre class="kg kh ki kj gt ms mt mu mv aw mw bi"><span id="8dcb" class="mf ks iq mt b gy mx my l mz na">docs &lt;- docs %&gt;%<br/>  tm_map(removeNumbers) %&gt;%<br/>  tm_map(removePunctuation) %&gt;%<br/>  tm_map(stripWhitespace)<br/>docs &lt;- tm_map(docs, content_transformer(tolower))<br/>docs &lt;- tm_map(docs, removeWords, stopwords("english"))</span></pre><h2 id="9738" class="mf ks iq bd kt mg mh dn kx mi mj dp lb ls mk ml ld lw mm mn lf ma mo mp lh mq bi translated">步骤 3:创建文档术语矩阵</h2><p id="4435" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">下一步你要做的是建立一个数据框架，在第一列中包含每个单词，在第二列中包含它们的频率。</p><p id="606a" class="pw-post-body-paragraph lj lk iq ll b lm nc jr lo lp nd ju lr ls ne lu lv lw nf ly lz ma ng mc md me ij bi translated">这可以通过使用来自<em class="mr"> tm </em>包的 TermDocumentMatrix 函数创建一个文档术语矩阵来完成。</p><pre class="kg kh ki kj gt ms mt mu mv aw mw bi"><span id="00ed" class="mf ks iq mt b gy mx my l mz na">dtm &lt;- TermDocumentMatrix(docs) <br/>matrix &lt;- as.matrix(dtm) <br/>words &lt;- sort(rowSums(matrix),decreasing=TRUE) <br/>df &lt;- data.frame(word = names(words),freq=words)</span></pre><p id="b8bf" class="pw-post-body-paragraph lj lk iq ll b lm nc jr lo lp nd ju lr ls ne lu lv lw nf ly lz ma ng mc md me ij bi translated">或者，特别是如果你使用 tweets，你可以使用 tidytext 包。</p><pre class="kg kh ki kj gt ms mt mu mv aw mw bi"><span id="d9f2" class="mf ks iq mt b gy mx my l mz na">tweets_words &lt;-  tweets %&gt;%<br/> select(text) %&gt;%<br/> unnest_tokens(word, text)</span><span id="a15c" class="mf ks iq mt b gy nb my l mz na">words &lt;- tweets_words %&gt;% count(word, sort=TRUE)</span></pre><h2 id="0a22" class="mf ks iq bd kt mg mh dn kx mi mj dp lb ls mk ml ld lw mm mn lf ma mo mp lh mq bi translated">第四步:生成单词云</h2><p id="e106" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated"><em class="mr">字云</em> <strong class="ll ir"> </strong>包是生成字云最经典的方式。下面一行代码向您展示了如何正确设置参数。例如，我选择研究美国总统在联合国大会上的演讲。</p><pre class="kg kh ki kj gt ms mt mu mv aw mw bi"><span id="6eeb" class="mf ks iq mt b gy mx my l mz na">set.seed(1234) # for reproducibility </span><span id="49b9" class="mf ks iq mt b gy nb my l mz na">wordcloud(words = df$word, freq = df$freq, min.freq = 1,           max.words=200, random.order=FALSE, rot.per=0.35,            colors=brewer.pal(8, "Dark2"))</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/3663e875a06e55486e18165ccf49b0bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1284/format:webp/1*x_oWNj934KrGaEDsN6J3jw.png"/></div></figure><p id="0a5c" class="pw-post-body-paragraph lj lk iq ll b lm nc jr lo lp nd ju lr ls ne lu lv lw nf ly lz ma ng mc md me ij bi translated">可能发生的情况是，您的<strong class="ll ir">单词云裁剪了某些单词，或者干脆不显示它们</strong>。如果发生这种情况，请确保添加参数<strong class="ll ir"> scale=c(3.5，0.25) </strong>并摆弄数字，使单词 cloud 合适。</p><p id="e053" class="pw-post-body-paragraph lj lk iq ll b lm nc jr lo lp nd ju lr ls ne lu lv lw nf ly lz ma ng mc md me ij bi translated">词云的另一个常见错误是<strong class="ll ir">显示了太多不常用的词</strong>。如果是这种情况，请确保调整最小频率参数<strong class="ll ir"> (min.freq=…) </strong>，以便使您的词云更有意义。</p><p id="450d" class="pw-post-body-paragraph lj lk iq ll b lm nc jr lo lp nd ju lr ls ne lu lv lw nf ly lz ma ng mc md me ij bi translated">这个<em class="mr"> wordcloud2 </em>包使用起来更有趣，允许我们做一些更高级的可视化。例如，你可以选择你的文字云以特定的形状甚至字母出现(参见这个<a class="ae nh" href="https://cran.r-project.org/web/packages/wordcloud2/vignettes/wordcloud.html#lettercloud-function" rel="noopener ugc nofollow" target="_blank">小插图</a>获取有用的教程)。作为一个例子，我使用了相同的联合国演讲语料库，并生成了如下所示的两个单词云。很酷，对吧？</p><pre class="kg kh ki kj gt ms mt mu mv aw mw bi"><span id="b42c" class="mf ks iq mt b gy mx my l mz na">wordcloud2(data=df, size=1.6, color='random-dark')</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/08296853757afb0153ffe7523583c920.png" data-original-src="https://miro.medium.com/v2/resize:fit:1288/format:webp/1*JkRpMBkTAJxlTaJ2xOtR3Q.png"/></div></figure><pre class="kg kh ki kj gt ms mt mu mv aw mw bi"><span id="0b7d" class="mf ks iq mt b gy mx my l mz na">wordcloud2(data=df, size = 0.7, shape = 'pentagon')</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/624b62d40eb738a2c2b11e50ade5f0c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1276/format:webp/1*ziuucsfGymaS7bC2UtcvEQ.png"/></div></figure></div><div class="ab cl nl nm hu nn" role="separator"><span class="no bw bk np nq nr"/><span class="no bw bk np nq nr"/><span class="no bw bk np nq"/></div><div class="ij ik il im in"><h1 id="b11d" class="kr ks iq bd kt ku ns kw kx ky nt la lb jw nu jx ld jz nv ka lf kc nw kd lh li bi translated">你应该使用单词云的 3 个理由</h1><ul class=""><li id="7861" class="nx ny iq ll b lm ln lp lq ls nz lw oa ma ob me oc od oe of bi translated">文字云是杀手<strong class="ll ir">可视化</strong>工具。它们以简单明了的格式呈现文本数据，就像云一样，其中单词的大小取决于它们各自的频率。因此，它们在视觉上看起来很好，也很容易理解。</li><li id="39bf" class="nx ny iq ll b lm og lp oh ls oi lw oj ma ok me oc od oe of bi translated">字云是很棒的<strong class="ll ir">沟通</strong>工具。对于任何希望交流基于文本数据的基本见解的人来说，无论是分析演讲、捕捉社交媒体上的对话还是报告客户评论，它们都非常方便。</li><li id="1b8b" class="nx ny iq ll b lm og lp oh ls oi lw oj ma ok me oc od oe of bi translated">字云<strong class="ll ir">见解深刻</strong>。视觉上引人入胜，单词云让我们能够快速得出一些见解，允许在解释它们时有一定的灵活性。它们的视觉形式刺激我们思考，并根据我们希望分析的内容得出最佳见解。</li></ul><h1 id="262c" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">那么，什么时候该用词云呢？</h1><p id="ceb9" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">是的，单词云是有洞察力的，伟大的交流和可视化工具。尽管如此，它们也有自己的限制，理解这一点是知道什么时候使用它们，什么时候不使用它们的关键。</p><p id="17a5" class="pw-post-body-paragraph lj lk iq ll b lm nc jr lo lp nd ju lr ls ne lu lv lw nf ly lz ma ng mc md me ij bi translated">单词云本质上是一种描述工具。因此，它们应仅用于捕捉<strong class="ll ir">基本定性洞察</strong>。视觉上吸引人，它们是开始对话、演示或分析的绝佳工具。然而，他们的分析仅限于洞察力，根本不具备更广泛的统计分析的能力。</p></div><div class="ab cl nl nm hu nn" role="separator"><span class="no bw bk np nq nr"/><span class="no bw bk np nq nr"/><span class="no bw bk np nq"/></div><div class="ij ik il im in"><p id="c939" class="pw-post-body-paragraph lj lk iq ll b lm nc jr lo lp nd ju lr ls ne lu lv lw nf ly lz ma ng mc md me ij bi translated">我经常写关于数据科学和自然语言处理的文章。关注我的<a class="ae nh" href="https://twitter.com/celine_vdr" rel="noopener ugc nofollow" target="_blank"><em class="mr">Twitter</em></a><em class="mr">或</em><a class="ae nh" href="https://medium.com/@celine.vdr" rel="noopener"><em class="mr">Medium</em></a><em class="mr">查看更多类似的文章或简单地更新下一篇文章。</em> <strong class="ll ir"> <em class="mr">感谢阅读！</em> </strong></p></div></div>    
</body>
</html>