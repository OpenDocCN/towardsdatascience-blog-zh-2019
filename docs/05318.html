<html>
<head>
<title>Visual Product Search for Smart Retail Checkout</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">智能零售收银台的视觉产品搜索</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/visual-product-search-for-smart-retail-checkout-eb7e1f34a351?source=collection_archive---------21-----------------------#2019-08-07">https://towardsdatascience.com/visual-product-search-for-smart-retail-checkout-eb7e1f34a351?source=collection_archive---------21-----------------------#2019-08-07</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="fa26" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated"><em class="kf">用数据做酷事！</em></h2></div><p id="2416" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated"><strong class="ki ir">简介</strong></p><p id="3420" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">人工智能正在改变几个经济领域，如汽车、营销和医疗保健。零售业可能是下一个。在商店购物的基本零售体验几十年来一直没有改变。人工智能可以从根本上改变这种体验，让它以高成本效益的方式为每个消费者提供大规模的完全个性化、沉浸式和优化的体验。</p><p id="5778" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">我们正在这里写一系列博客，详细介绍人工智能在零售业的应用。每个博客处理不同的用例，并分享演示可行性的实际代码。这是第一个。</p><p id="f73b" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated"><strong class="ki ir">视觉产品搜索</strong></p><p id="25e4" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">很多时候，我们发现很难回忆起一件产品的确切名称，或者无法清晰地描述它以便谷歌搜索，或者想要重新订购我们看到别人穿的衣服。在所有这些情况下，以及更多的情况下，“视觉产品搜索”是拯救。我们不需要描述，只需要给产品拍张照片，然后搜索它。</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="gh gi lc"><img src="../Images/6fed28202493b10f471c2255b693d70d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*LBZDyjojUjSkLnZT"/></div></div><figcaption class="lo lp gj gh gi lq lr bd b be z dk">Visual Product Search</figcaption></figure><p id="d558" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated"><strong class="ki ir">视觉产品搜索是如何工作的？</strong></p><p id="d63e" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">视觉产品搜索的概念也称为反向图像搜索，是将图像表示为特征向量。现代深度学习技术可以使用预训练的 CNN 将图像编码成特征向量。特征向量类似于图像描述符，并对深度学习已经学习到的相关图像信息进行编码。为了运行视觉产品搜索，我们有一个可以编码成特征向量的图像数据库。然后，我们获得一个<strong class="ki ir">查询</strong>图像，并将其向量与整个数据库进行比较，以获得最接近的匹配。</p><p id="27bf" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated"><strong class="ki ir">视觉产品搜索的应用</strong></p><p id="5990" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">视觉产品搜索在人工智能中可以有很多应用。两个这样的应用是:</p><ul class=""><li id="3431" class="ls lt iq ki b kj kk km kn kp lu kt lv kx lw lb lx ly lz ma bi translated">对于在线订购，我们可以使用摄像头进行搜索，并自动将商品添加到商店购物车中。许多大型零售商如亚马逊、Nordstrom 已经提供这种服务。只需拍摄一张照片即可添加到购物车中</li><li id="3804" class="ls lt iq ki b kj mb km mc kp md kt me kx mf lb lx ly lz ma bi translated">对于实体店，我们可以有一个智能结账系统，它可以使用一个摄像头来自动为产品向客户收费。零售商会喜欢它，因为它会削减成本，顾客会享受顺利结账的体验。干脆买了就走。没有队列。</li></ul><p id="7134" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">我们已经通过可视化产品搜索为智能结账做了一个演示。我们开始吧！</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="gh gi mg"><img src="../Images/c7389415049189b838c467833ec1efe0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*x063GUZAzfR8alz1rh-Iqg.jpeg"/></div></div><figcaption class="lo lp gj gh gi lq lr bd b be z dk">Who likes long checkout queues?</figcaption></figure><p id="9273" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated"><strong class="ki ir">智能结账系统</strong></p><p id="9fbf" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">我们使用<a class="ae mh" href="https://cloud.google.com/vision/" rel="noopener ugc nofollow" target="_blank"> Google Vision API </a> <strong class="ki ir"> </strong>来构建这个应用程序。他们有一个功能叫做视觉产品搜索。如果您是 API 的新手，请参考这个<a class="ae mh" href="https://cloud.google.com/vision/docs/quickstart" rel="noopener ugc nofollow" target="_blank">文档</a>了解如何开始。</p><h2 id="e24e" class="mi mj iq bd mk ml mm dn mn mo mp dp mq kp mr ms mt kt mu mv mw kx mx my mz na bi translated"><strong class="ak">创建一个物品数据库</strong></h2><p id="25f9" class="pw-post-body-paragraph kg kh iq ki b kj nb jr kl km nc ju ko kp nd kr ks kt ne kv kw kx nf kz la lb ij bi translated">有两种方法可以创建将被搜索的数据库:</p><ol class=""><li id="bf37" class="ls lt iq ki b kj kk km kn kp lu kt lv kx lw lb ng ly lz ma bi translated">创建一个空的产品集，并使用在线导入向其中逐个添加图像</li><li id="78cc" class="ls lt iq ki b kj mb km mc kp md kt me kx mf lb ng ly lz ma bi translated">使用批量导入同时创建产品集，创建多个产品及其参考映像。</li></ol><p id="932f" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">我们通过从互联网上抓取图片，创建了一个常见零售商品的数据库——冷饮、饼干、薯条、面条等。然后，我们使用批量导入将这些图像添加到 API 中。通过这样做，API 将每个图像转换成一个特征向量。</p><p id="c756" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">对于批量导入，主要步骤是:</p><ul class=""><li id="fcac" class="ls lt iq ki b kj kk km kn kp lu kt lv kx lw lb lx ly lz ma bi translated">将你的数据库上传到谷歌云存储</li><li id="3e2f" class="ls lt iq ki b kj mb km mc kp md kt me kx mf lb lx ly lz ma bi translated">创建描述数据库中图像的 CSV 文件。CSV 文件的细节在下一节给出。将这个 CSV 文件上传到 Google 云存储桶中。</li><li id="6259" class="ls lt iq ki b kj mb km mc kp md kt me kx mf lb lx ly lz ma bi translated">使用存储在 Google 云存储桶中的图像或 base64 编码的本地图像向 Vision API 产品搜索发出请求。</li></ul><p id="902e" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">CSV 包含各种列。列名及其说明如下:</p><ul class=""><li id="c0ff" class="ls lt iq ki b kj kk km kn kp lu kt lv kx lw lb lx ly lz ma bi translated"><strong class="ki ir"> image-uri </strong>:参考图片的 Google 云存储 uri。</li><li id="7d3e" class="ls lt iq ki b kj mb km mc kp md kt me kx mf lb lx ly lz ma bi translated"><strong class="ki ir"> image-id </strong>:您可以提供的唯一值。否则，系统将分配一个唯一的值。</li><li id="40da" class="ls lt iq ki b kj mb km mc kp md kt me kx mf lb lx ly lz ma bi translated"><strong class="ki ir"> product-set-id </strong>:导入图像的产品集的唯一标识符。</li><li id="ecfa" class="ls lt iq ki b kj mb km mc kp md kt me kx mf lb lx ly lz ma bi translated"><strong class="ki ir">产品类别</strong>:允许值为家居用品-v2、服装-v2、玩具-v2 和包装商品-v1。</li><li id="365c" class="ls lt iq ki b kj mb km mc kp md kt me kx mf lb lx ly lz ma bi translated"><strong class="ki ir">产品-显示-名称</strong> : <strong class="ki ir"> <em class="nh">可选</em> </strong>。如果不为产品<a class="ae mh" href="https://cloud.google.com/vision/product-search/docs/reference/rest/v1/projects.locations.products#Product.FIELDS.display_name" rel="noopener ugc nofollow" target="_blank">提供名称，显示名称</a>将被设置为" "。</li><li id="0e97" class="ls lt iq ki b kj mb km mc kp md kt me kx mf lb lx ly lz ma bi translated"><strong class="ki ir">标签</strong> : <strong class="ki ir"> <em class="nh">可选</em> </strong>。描述参考图像中产品的键值对字符串(带引号)。比如:“品类=鞋子”，“颜色=黑色，款式=正式”。</li><li id="caf1" class="ls lt iq ki b kj mb km mc kp md kt me kx mf lb lx ly lz ma bi translated"><strong class="ki ir">包围多边形</strong> : <strong class="ki ir"> <em class="nh">可选</em> </strong>。指定参考图像中的感兴趣区域。如果一个边界框没有被指定。如果 API 检测到多种产品，单个图像中的多个区域可能会被编入索引。</li></ul><p id="55b1" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">我们现在可以用我们的查询图像向 api 发出请求。这是使用 curl 完成的，如这里的所述<a class="ae mh" href="https://cloud.google.com/vision/docs/using-curl" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="dc56" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated"><strong class="ki ir">实验及结果:</strong></p><p id="8fb5" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">我们通过网络搜集创建了一个普通零售产品的图片数据库。对于实际用例，这将是零售商存档的产品图像。为了测试 API，我们传递了一个通过手机摄像头捕捉的查询图像。以下为面条的查询图片:</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/290b958b8a84ae4f0c6ba04b017b2e16.png" data-original-src="https://miro.medium.com/v2/resize:fit:482/format:webp/1*7fHMn_yfwVkUoPLZOjIEgw.png"/></div><figcaption class="lo lp gj gh gi lq lr bd b be z dk">Noodles Query Image</figcaption></figure><p id="e58e" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">对 api 的请求给出了以下匹配的产品</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/d49df0cfc4338dfd9c35c2d4ac1c3ce9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1034/format:webp/1*d8oD5INsJqclCLyb0dOoMg.png"/></div><figcaption class="lo lp gj gh gi lq lr bd b be z dk">API result on Noodles Image</figcaption></figure><p id="f64a" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">然后我们传递了一张可口可乐的查询图片如下:</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/31d478ad167b0fc792ac90c4dfafca44.png" data-original-src="https://miro.medium.com/v2/resize:fit:424/format:webp/1*gvZy-j2bP19Ns_lbqQhxkg.png"/></div><figcaption class="lo lp gj gh gi lq lr bd b be z dk">Coke Query Image</figcaption></figure><p id="7ee4" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">对 api 的请求为 coke image 提供了以下匹配产品。</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/054c82de34523100c1aa5d28e8d371ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:936/format:webp/1*TNfn3GGTFrxsX2hrM_SYCQ.png"/></div><figcaption class="lo lp gj gh gi lq lr bd b be z dk">API result for Coke Query image</figcaption></figure><p id="4e04" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">还不错！API 能够非常准确地导航到正确的产品类型。这是很有希望的，因为过程相对简单，API 成本也相当合理。</p><p id="9cf0" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">这个简单的演示表明，通过对商店销售的整个数据库进行编码，上述技术可以扩展到更智能的客户结账。在结账时，安装的摄像头可以检测每个对象的位置，裁剪它们的图像，并对 API 进行批量查询，以获得数据库中最匹配的产品，从而进行结算。</p><p id="d9e6" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated"><strong class="ki ir">结论</strong></p><p id="df6d" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">根据<a class="ae mh" href="https://www.gminsights.com/industry-analysis/artificial-intelligence-ai-retail-market" rel="noopener ugc nofollow" target="_blank">全球市场洞察</a>，到 2024 年，零售部门对人工智能的投资将超过 80 亿美元。人工智能在零售领域有很多应用，智能结账将是一个革命性的变化。</p><p id="cfbb" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">我有自己的深度学习咨询公司，喜欢研究有趣的问题。我已经帮助许多初创公司部署了基于人工智能的创新解决方案。请到 http://deeplearninganalytics.org/<a class="ae mh" href="http://deeplearninganalytics.org/" rel="noopener ugc nofollow" target="_blank">来看看我们。如果你有一个我们可以合作的项目，那么请通过我的网站或在<strong class="ki ir">info@deeplearninganalytics.org</strong>联系我</a></p><p id="7c36" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">你也可以在<a class="ae mh" href="https://medium.com/@priya.dwivedi" rel="noopener">https://medium.com/@priya.dwivedi</a>看到我的其他作品</p><p id="b7ff" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated"><strong class="ki ir">参考文献:</strong></p><ul class=""><li id="2a7b" class="ls lt iq ki b kj kk km kn kp lu kt lv kx lw lb lx ly lz ma bi translated"><a class="ae mh" href="https://cloud.google.com/vision/" rel="noopener ugc nofollow" target="_blank">云视觉 API </a></li><li id="a3db" class="ls lt iq ki b kj mb km mc kp md kt me kx mf lb lx ly lz ma bi translated"><a class="ae mh" href="https://www.retail-insight-network.com/digital-disruption/ai-trends-retail/" rel="noopener ugc nofollow" target="_blank">人工智能零售趋势</a></li></ul></div></div>    
</body>
</html>