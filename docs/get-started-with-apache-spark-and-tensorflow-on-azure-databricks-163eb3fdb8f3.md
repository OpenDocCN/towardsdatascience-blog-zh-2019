# åœ¨ Azure Databricks ä¸Šå¼€å§‹ä½¿ç”¨ Apache Spark å’Œ TensorFlow

> åŸæ–‡ï¼š<https://towardsdatascience.com/get-started-with-apache-spark-and-tensorflow-on-azure-databricks-163eb3fdb8f3?source=collection_archive---------15----------------------->

## ç°åœ¨åœ¨ Apache Spark framework ä¸Šå¯ä»¥ä½¿ç”¨ TensorFlowï¼Œä½†æ˜¯å¦‚ä½•å¼€å§‹å‘¢ï¼Ÿå®ƒå«åšå¼ é‡æ¡†æ¶

# TLï¼›é€Ÿåº¦ä¸‰è§’å½¢å®šä½æ³•(dead reckoning)

è¿™æ˜¯ä¸€ä¸ªå…³äºå¦‚ä½•åœ¨ Azure Databricks ä¸Šè¿è¡Œæ–°çš„ Spark TensorFrame åº“çš„åˆ†æ­¥æ•™ç¨‹ã€‚

![](img/6f5873f9f79b9c19e7ddb7e0bf878d0a.png)

å¤§æ•°æ®æ˜¯ä¸€ä¸ªåºå¤§çš„ä¸»é¢˜ï¼ŒåŒ…å«è®¸å¤šé¢†åŸŸå’Œä¸“ä¸šçŸ¥è¯†ã€‚ä¸€è·¯ä» DevOpsï¼Œæ•°æ®å·¥ç¨‹å¸ˆåˆ°æ•°æ®ç§‘å­¦å®¶ï¼ŒAIï¼Œæœºå™¨å­¦ä¹ ï¼Œç®—æ³•å¼€å‘è€…ç­‰ç­‰ã€‚æˆ‘ä»¬éƒ½åœ¨ä¸æµ·é‡æ•°æ®ä½œæ–—äº‰ã€‚å½“æˆ‘ä»¬å¤„ç†å¤§é‡æ•°æ®æ—¶ï¼Œæˆ‘ä»¬éœ€è¦æœ€å¥½çš„å¤´è„‘å’Œå·¥å…·ã€‚è¿™å°±æ˜¯**é˜¿å¸•å¥‡ç«èŠ±**å’Œ**å¼ é‡æµ**çš„ ***ç¥å¥‡*** ç»„åˆå‘ç”Ÿçš„åœ°æ–¹ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸º**å¼ é‡æ¡†æ¶**ã€‚

Apache Spark æ¥ç®¡äº†å¤§æ•°æ®ä¸–ç•Œï¼Œæä¾›ç­”æ¡ˆå¹¶æ”¯æŒæ•°æ®å·¥ç¨‹å¸ˆå˜å¾—æ›´åŠ æˆåŠŸï¼Œè€Œæ•°æ®ç§‘å­¦å®¶åˆ™ä¸å¾—ä¸è®¾æ³•ç»•è¿‡ Spark æä¾›çš„æœºå™¨å­¦ä¹ åº“ Spark MLlib çš„é™åˆ¶ã€‚

ä½†æ˜¯ç°åœ¨ï¼ŒApache Spark ç”¨æˆ·å¯ä»¥ä½¿ç”¨ TensorFlow äº†ã€‚è¿™äº›å·¥å…·çš„ç»“åˆä½¿æ•°æ®ç§‘å­¦å®¶çš„å·¥ä½œæ›´é«˜æ•ˆã€æ›´å‡†ç¡®ã€æ›´å¿«é€Ÿã€‚ä»ç ”ç©¶åˆ°å¼€å‘å†åˆ°ç”Ÿäº§ï¼Œæ¯”ä»¥å¾€ä»»ä½•æ—¶å€™éƒ½è¦å¿«ã€‚

åœ¨æˆ‘ä»¬å¼€å§‹ä¹‹å‰ï¼Œè®©æˆ‘ä»¬å…ˆæ•´ç†ä¸€ä¸‹æœ¯è¯­:

*   **Tensor Flow** æ˜¯ Google åˆ›å»ºçš„ç”¨äºé«˜æ€§èƒ½æ•°å€¼è®¡ç®—çš„å¼€æºæœºå™¨å­¦ä¹ æ¡†æ¶ã€‚å®ƒé™„å¸¦äº†å¯¹ AI çš„å¼ºå¤§æ”¯æŒ:æœºå™¨å­¦ä¹ å’Œæ·±åº¦å­¦ä¹ ã€‚
*   **Azure Databricks** æ˜¯ä¸€ä¸ªåŸºäº Apache Spark çš„åˆ†æå¹³å°ï¼Œé’ˆå¯¹**å¾®è½¯ Azure** äº‘æœåŠ¡å¹³å°è¿›è¡Œäº†ä¼˜åŒ–ã€‚Azure Databricks è¿˜å……å½“è½¯ä»¶å³æœåŠ¡(SaaS) /å¤§æ•°æ®å³æœåŠ¡(BDaaS)ã€‚
*   TensorFrames æ˜¯ä¸€ä¸ª Apache Spark ç»„ä»¶ï¼Œå®ƒä½¿æˆ‘ä»¬èƒ½å¤Ÿåœ¨ Spark é›†ç¾¤ä¸Šåˆ›å»ºè‡ªå·±çš„å¯æ‰©å±• TensorFlow å­¦ä¹ ç®—æ³•ã€‚

# -1-å·¥ä½œåŒº:

é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºå·¥ä½œç©ºé—´ï¼Œæˆ‘ä»¬æ­£åœ¨ä½¿ç”¨ Databricks å·¥ä½œç©ºé—´ï¼Œè¿™é‡Œæœ‰ä¸€ä¸ª[æ•™ç¨‹](https://docs.microsoft.com/azure/azure-databricks/quickstart-create-databricks-workspace-portal?WT.mc_id=online-medium-adpolak)ç”¨äºåˆ›å»ºå®ƒã€‚

# -2-é›†ç¾¤:

æœ‰äº†å·¥ä½œç©ºé—´ä¹‹åï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºé›†ç¾¤æœ¬èº«ã€‚è®©æˆ‘ä»¬ä½¿ç”¨[æœ¬](https://docs.microsoft.com/azure/azure-databricks/quickstart-create-databricks-workspace-portal?WT.mc_id=online-medium-adpolak)æ•™ç¨‹åˆ›å»ºæˆ‘ä»¬çš„ spark é›†ç¾¤ï¼Œç¡®ä¿æ‚¨çš„é›†ç¾¤ä¸­æœ‰ä»¥ä¸‹é…ç½®:

*   Apache Spark çš„å·¥ä½œç‰ˆæœ¬(2.4 æˆ–æ›´é«˜ç‰ˆæœ¬)
*   Java 8+
*   (å¯é€‰)python 2.7+/3.6+å¦‚æœè¦ä½¿ç”¨ python æ¥å£ã€‚
*   (å¯é€‰)python TensorFlow åŒ…(å¦‚æœè¦ä½¿ç”¨ python æ¥å£)ã€‚å…³äºå¦‚ä½•è·å¾— TensorFlow çš„æœ€æ–°ç‰ˆæœ¬ï¼Œè¯·å‚è§[å®˜æ–¹è¯´æ˜](https://www.tensorflow.org/install/)ã€‚
*   (å¯é€‰)å¦‚æœè¦ä½¿ç”¨ python æ¥å£ï¼Œpandas >= 0.19.1

é…ç½®:

![](img/e2fada2fefbe9c4fe67ffd56cdbbc2ed.png)

ä½¿ç”¨ Databricks è¿è¡Œæ—¶ç‰ˆæœ¬æˆ–æ›´é«˜ç‰ˆæœ¬:

![](img/c5189ca59a6473f491b90bc5b795723b.png)

æŒ‰ start å¯åŠ¨é›†ç¾¤

![](img/9326e9bbc29c9b624f32b4728a36933e.png)

# -3-å¯¼å…¥åº“:

åœ¨ **Azure Databricks** ä¸‹ï¼Œè¿›å…¥**å¸¸è§ä»»åŠ¡**ï¼Œç‚¹å‡»**å¯¼å…¥åº“**:

![](img/50a715c824f5766344d2965a152075fc.png)

TensorFrame å¯ä»¥åœ¨ [maven èµ„æºåº“](https://mvnrepository.com/artifact/databricks/tensorframes/0.2.9-s_2.11)ä¸Šæ‰¾åˆ°ï¼Œæ‰€ä»¥é€‰æ‹© maven æ ‡ç­¾ã€‚åœ¨åæ ‡ä¸‹ï¼Œæ’å…¥æ‚¨é€‰æ‹©çš„åº“ï¼Œç°åœ¨ï¼Œå®ƒå°†æ˜¯:

```
databricks:tensorframes:0.6.0-s_2.11
```

![](img/64e18c70055b006189b3b0ab8e018a6b.png)

ç‚¹å‡»**åˆ›å»º**æŒ‰é’®ã€‚

![](img/b87af81d5f7d806fe012178d8324c5e2.png)

ç‚¹å‡»**å®‰è£…**ã€‚

ä½ ä¼šçœ‹åˆ°è¿™ä¸ª:

![](img/7d28e69fc036ec0d2d8d807a3cb6fb51.png)

å˜£ã€‚æ‚¨çš„ Databricks é›†ç¾¤ä¸Šæœ‰ TensorFrameã€‚

# -4-ç¬”è®°æœ¬:

æˆ‘ä»¬ä½¿ç”¨ç¬”è®°æœ¬ä½œä¸ºæˆ‘ä»¬çš„ä»£ç ç¬”è®°æœ¬ï¼Œåœ¨é‚£é‡Œæˆ‘ä»¬å¯ä»¥ç¼–å†™ä»£ç å¹¶ç›´æ¥åœ¨æˆ‘ä»¬çš„ Spark é›†ç¾¤ä¸Šè¿è¡Œå®ƒã€‚

ç°åœ¨æˆ‘ä»¬æœ‰äº†ä¸€ä¸ªæ­£åœ¨è¿è¡Œçš„é›†ç¾¤ï¼Œè®©æˆ‘ä»¬è¿è¡Œä¸€ä¸ªç¬”è®°æœ¬:

ç‚¹å‡»**æ–°ç¬”è®°æœ¬**å¹¶é€‰æ‹©æ‚¨å–œæ¬¢çš„ç¼–ç¨‹è¯­è¨€(è¿™é‡Œæˆ‘ä»¬é€‰æ‹©äº† Scala)

![](img/f16dd119b309956348c035814b01dd12.png)

è¿™æ˜¯ scala ä»£ç åœ¨å¸¦æœ‰ TensorFrames çš„ç¬”è®°æœ¬é—¨æˆ·ä¸Šçš„å¤–è§‚:

![](img/820f2f59fa640407a42e2070accc3962.png)

ä»£ç ç¤ºä¾‹æ¥è‡ª D [atabricks git ä»“åº“](https://github.com/databricks/tensorframes/blob/master/README.md)ã€‚

æ‚¨ä¹Ÿå¯ä»¥åœ¨è¿™é‡ŒæŸ¥çœ‹:

# -ç»“å°¾-

ç°åœ¨ä¸€åˆ‡éƒ½å·²å¯åŠ¨å¹¶è¿è¡Œï¼Œåœ¨ Apache Spark é›†ç¾¤ä¸­åˆ›å»ºè‡ªå·±çš„ä½¿ç”¨ TensorFrame çš„è§¦å‘/è°ƒåº¦ä½œä¸šã€‚

è¿˜æœ‰â€¦

æ—¢ç„¶ä½ å·²ç»èµ°åˆ°è¿™ä¸€æ­¥äº†ï¼Œè¯·ç‚¹å‡»é¼“æŒæŒ‰é’®ğŸ‘å’Œ[åœ¨ Medium](https://medium.com/@adipolak) å’Œ [Twitter](https://twitter.com/adipolak) ä¸Šå…³æ³¨æˆ‘ï¼Œè·å–æ›´å¤šå…³äº Scalaã€Kotlinã€å¤§æ•°æ®ã€å¹²å‡€ä»£ç å’Œè½¯ä»¶å·¥ç¨‹å¸ˆæŒ‘æˆ˜çš„å¸–å­ã€‚å¹²æ¯ï¼