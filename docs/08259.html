<html>
<head>
<title>Machine Learning 101-ID3 Decision Tree and Entropy Calculation (1)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">机器学习 101-ID3 决策树与熵计算(1)</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/machine-learning-101-id3-decision-trees-and-entropy-calculation-1-a1d66ee9f728?source=collection_archive---------10-----------------------#2019-11-11">https://towardsdatascience.com/machine-learning-101-id3-decision-trees-and-entropy-calculation-1-a1d66ee9f728?source=collection_archive---------10-----------------------#2019-11-11</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="a7de" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">这一系列包括我在博士课程阶段收集的机器学习课程笔记</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ki"><img src="../Images/1238367a6ba95a9adf698a33ef2ba43e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*XY0AfgNc7bdRuw4PrU48UA.jpeg"/></div></figure><h1 id="f74c" class="kq kr it bd ks kt ku kv kw kx ky kz la jz lb ka lc kc ld kd le kf lf kg lg lh bi translated">培训方法</h1><p id="8ee1" class="pw-post-body-paragraph li lj it lk b ll lm ju ln lo lp jx lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">机器学习训练方法分为 3 种；</p><ol class=""><li id="df9b" class="me mf it lk b ll mg lo mh lr mi lv mj lz mk md ml mm mn mo bi translated">监督学习</li><li id="5114" class="me mf it lk b ll mp lo mq lr mr lv ms lz mt md ml mm mn mo bi translated">无监督学习</li><li id="4d58" class="me mf it lk b ll mp lo mq lr mr lv ms lz mt md ml mm mn mo bi translated">强化学习</li></ol></div><div class="ab cl mu mv hx mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="im in io ip iq"><h1 id="22b2" class="kq kr it bd ks kt nb kv kw kx nc kz la jz nd ka lc kc ne kd le kf nf kg lg lh bi translated">ID3 决策树</h1><ul class=""><li id="083a" class="me mf it lk b ll lm lo lp lr ng lv nh lz ni md nj mm mn mo bi translated">这种方法被称为监督和非参数决策树类型。</li><li id="0296" class="me mf it lk b ll mp lo mq lr mr lv ms lz mt md nj mm mn mo bi translated">大多数情况下，它用于分类和回归。</li><li id="9a45" class="me mf it lk b ll mp lo mq lr mr lv ms lz mt md nj mm mn mo bi translated">一棵树由一个中间决策节点和末端叶子组成。终端叶子有输出。输出显示分类中的类值，但显示回归的数值。</li><li id="0705" class="me mf it lk b ll mp lo mq lr mr lv ms lz mt md nj mm mn mo bi translated">将子集划分为决策树的目的是使每个子集尽可能的相似。决策树算法的缺点是它们是贪婪的方法。<strong class="lk iu">贪婪算法</strong>是任何遵循问题解决启发法的算法，在每个阶段做出局部最优选择，目的是找到全局最优。在许多问题中，贪婪策略通常不会产生最优解，但是贪婪启发式算法可以在合理的时间内产生近似全局最优解的局部最优解。</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/a6dc3696a200bc0e4e12954111ebeff0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*Llr6Qavwt33B5j-dhAEfdA.png"/></div></figure><h1 id="2ccd" class="kq kr it bd ks kt ku kv kw kx ky kz la jz lb ka lc kc ld kd le kf lf kg lg lh bi translated">熵</h1><p id="b1aa" class="pw-post-body-paragraph li lj it lk b ll lm ju ln lo lp jx lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">熵被称为决策树的控制器，用于决定在哪里拆分数据。ID3 算法使用熵来计算样本的同质性。如果样本是完全同质的，则熵为零，如果样本是等分的，则熵为 1[1]。</p><p id="109c" class="pw-post-body-paragraph li lj it lk b ll mg ju ln lo mh jx lq lr nl lt lu lv nm lx ly lz nn mb mc md im bi translated">n 类熵-&gt; E(S) = ∑ -(pᵢ*log₂pᵢ)</p><p id="3a3d" class="pw-post-body-paragraph li lj it lk b ll mg ju ln lo mh jx lq lr nl lt lu lv nm lx ly lz nn mb mc md im bi translated">二类熵:(S) =-(p₁ * log₂p₁ + p₂ * log₂p₂)</p><h1 id="9a37" class="kq kr it bd ks kt ku kv kw kx ky kz la jz lb ka lc kc ld kd le kf lf kg lg lh bi translated">例 1:</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi no"><img src="../Images/92d85240c164d96f28cdb0f0a6d59366.png" data-original-src="https://miro.medium.com/v2/resize:fit:430/format:webp/1*MvYNuVRpB6xPT0A_wSMaIQ.png"/></div><figcaption class="np nq gj gh gi nr ns bd b be z dk">9 samples in the Class 1 and 5 samples in the Class 2</figcaption></figure><p id="01fb" class="pw-post-body-paragraph li lj it lk b ll mg ju ln lo mh jx lq lr nl lt lu lv nm lx ly lz nn mb mc md im bi translated">p₁ = 9/(9+5) =9/14(样本与 1 类在同一训练类中的概率)</p><p id="8e66" class="pw-post-body-paragraph li lj it lk b ll mg ju ln lo mh jx lq lr nl lt lu lv nm lx ly lz nn mb mc md im bi translated">p₂ = 5/14(与 2 类在同一个培训类中的样本的概率)</p><p id="e0dd" class="pw-post-body-paragraph li lj it lk b ll mg ju ln lo mh jx lq lr nl lt lu lv nm lx ly lz nn mb mc md im bi translated">e =-(2014 年 9 月 14 日* log₂(9/14)+(2014 年 5 月* log₂(5/14))</p><p id="868e" class="pw-post-body-paragraph li lj it lk b ll mg ju ln lo mh jx lq lr nl lt lu lv nm lx ly lz nn mb mc md im bi translated">E = 0.94</p><h1 id="4fdb" class="kq kr it bd ks kt ku kv kw kx ky kz la jz lb ka lc kc ld kd le kf lf kg lg lh bi translated">信息增益</h1><p id="82a0" class="pw-post-body-paragraph li lj it lk b ll lm ju ln lo lp jx lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">根、节点和叶的边界由信息增益(IG)定义。</p><p id="dabe" class="pw-post-body-paragraph li lj it lk b ll mg ju ln lo mh jx lq lr nl lt lu lv nm lx ly lz nn mb mc md im bi translated"><strong class="lk iu">增益(S，A) = E(前)- G(后 _ 分裂)</strong></p><p id="d40f" class="pw-post-body-paragraph li lj it lk b ll mg ju ln lo mh jx lq lr nl lt lu lv nm lx ly lz nn mb mc md im bi translated"><strong class="lk iu">注意:</strong>你可以在 WEKA 工具里找到 ID3 作为 C4.5。</p><p id="075e" class="pw-post-body-paragraph li lj it lk b ll mg ju ln lo mh jx lq lr nl lt lu lv nm lx ly lz nn mb mc md im bi translated"><strong class="lk iu">例 2: </strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/6a295378da12af9e675f8d5389389916.png" data-original-src="https://miro.medium.com/v2/resize:fit:946/format:webp/1*kpuV0zntFxOF5bHQyKxxaQ.png"/></div></figure><p id="d7a6" class="pw-post-body-paragraph li lj it lk b ll mg ju ln lo mh jx lq lr nl lt lu lv nm lx ly lz nn mb mc md im bi translated">首先，选择以最精确的方式分割整个表的特征。为此，应确定增益最高的特性。【T10 个训练示例的值划分如下:<br/> * 6 电影院<br/> * 2 网球<br/> * 1 房子<br/> * 1 购物<br/>熵值必须从这些值开始计算，以定义根特征。</p><p id="1af0" class="pw-post-body-paragraph li lj it lk b ll mg ju ln lo mh jx lq lr nl lt lu lv nm lx ly lz nn mb mc md im bi translated">e(S)=-((6/10)* log2(6/10)+(2/10)* log2(2/10)+(1/10)* log2(1/10)+(1/10)* log2(1/10))</p><p id="477c" class="pw-post-body-paragraph li lj it lk b ll mg ju ln lo mh jx lq lr nl lt lu lv nm lx ly lz nn mb mc md im bi translated"><strong class="lk iu"> <em class="nu"> E(S) = 1.571 </em> </strong></p><p id="d931" class="pw-post-body-paragraph li lj it lk b ll mg ju ln lo mh jx lq lr nl lt lu lv nm lx ly lz nn mb mc md im bi translated">通过计算所有单个特征的增益值，具有最高增益值的特征被选为根节点:</p><p id="d5f5" class="pw-post-body-paragraph li lj it lk b ll mg ju ln lo mh jx lq lr nl lt lu lv nm lx ly lz nn mb mc md im bi translated"><strong class="lk iu"> <em class="nu">增益(S，天气)=？</em> </strong></p><p id="60c0" class="pw-post-body-paragraph li lj it lk b ll mg ju ln lo mh jx lq lr nl lt lu lv nm lx ly lz nn mb mc md im bi translated">Sunny = 3 (1 家电影院+ 2 网球)</p><p id="f452" class="pw-post-body-paragraph li lj it lk b ll mg ju ln lo mh jx lq lr nl lt lu lv nm lx ly lz nn mb mc md im bi translated">风= 4 (3 家电影院+ 1 购物)</p><p id="85ac" class="pw-post-body-paragraph li lj it lk b ll mg ju ln lo mh jx lq lr nl lt lu lv nm lx ly lz nn mb mc md im bi translated">雨天= 3 (2 家电影院+ 1 家)</p><p id="c6d5" class="pw-post-body-paragraph li lj it lk b ll mg ju ln lo mh jx lq lr nl lt lu lv nm lx ly lz nn mb mc md im bi translated">熵(S<em class="nu">sunny</em>)=—(1/3)* log2(1/3)—(2/3)* log2(2/3)= 0.918</p><p id="ea1e" class="pw-post-body-paragraph li lj it lk b ll mg ju ln lo mh jx lq lr nl lt lu lv nm lx ly lz nn mb mc md im bi translated">熵(S <em class="nu">风大</em>)=—(3/4)* log2(3/4)—(1/4)* log2(1/4)= 0.811</p><p id="42a5" class="pw-post-body-paragraph li lj it lk b ll mg ju ln lo mh jx lq lr nl lt lu lv nm lx ly lz nn mb mc md im bi translated">熵(S <em class="nu">多雨</em>)=—(2/3)* log2(2/3)—(1/3)* log2(1/3)= 0.918</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="nw nx di ny bf nz"><div class="gh gi nv"><img src="../Images/ea969759ce5392df23d486cfebd2dcd8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*at16wd7rhGxQoV6lir7wxA.png"/></div></div><figcaption class="np nq gj gh gi nr ns bd b be z dk">Information Gain Formula</figcaption></figure><p id="e0ef" class="pw-post-body-paragraph li lj it lk b ll mg ju ln lo mh jx lq lr nl lt lu lv nm lx ly lz nn mb mc md im bi translated">Gain(S，Weather)= 1.571—(((1+2)/10)* 0.918+((3+1)/10)* 0.811+((2+1)/10)* 0.918</p><p id="b11e" class="pw-post-body-paragraph li lj it lk b ll mg ju ln lo mh jx lq lr nl lt lu lv nm lx ly lz nn mb mc md im bi translated"><strong class="lk iu">增益(S，天气)= 0.70 </strong></p><p id="1ac1" class="pw-post-body-paragraph li lj it lk b ll mg ju ln lo mh jx lq lr nl lt lu lv nm lx ly lz nn mb mc md im bi translated">Gain(S，Parental_Availability) =？</p><p id="5ef5" class="pw-post-body-paragraph li lj it lk b ll mg ju ln lo mh jx lq lr nl lt lu lv nm lx ly lz nn mb mc md im bi translated">是= 5 (5 家电影院)</p><p id="bfaf" class="pw-post-body-paragraph li lj it lk b ll mg ju ln lo mh jx lq lr nl lt lu lv nm lx ly lz nn mb mc md im bi translated">否= 5 (2 个网球+ 1 个电影院+ 1 个购物+ 1 个家)</p><p id="b1fa" class="pw-post-body-paragraph li lj it lk b ll mg ju ln lo mh jx lq lr nl lt lu lv nm lx ly lz nn mb mc md im bi translated">熵(S <em class="nu">是</em> ) = - (5/5)*log2(5/5) = 0</p><p id="c243" class="pw-post-body-paragraph li lj it lk b ll mg ju ln lo mh jx lq lr nl lt lu lv nm lx ly lz nn mb mc md im bi translated">熵(S<em class="nu">no</em>)=-(2/5)* log2(2/5)-3 *(1/5)* log2(1/5)= 1.922</p><p id="ff3a" class="pw-post-body-paragraph li lj it lk b ll mg ju ln lo mh jx lq lr nl lt lu lv nm lx ly lz nn mb mc md im bi translated">增益(S，Parental_Availability) =熵(S) — (P(是)*熵(S <em class="nu">是</em> ) + P(否)*熵(S <em class="nu">否</em>))</p><p id="1d92" class="pw-post-body-paragraph li lj it lk b ll mg ju ln lo mh jx lq lr nl lt lu lv nm lx ly lz nn mb mc md im bi translated">Gain(S，Parental _ avail ability)= 1.571—((5/10)*熵(S <em class="nu">是</em>)+(5/10)*熵(S <em class="nu">否</em>))</p><p id="a514" class="pw-post-body-paragraph li lj it lk b ll mg ju ln lo mh jx lq lr nl lt lu lv nm lx ly lz nn mb mc md im bi translated"><strong class="lk iu"> Gain(S，Parental _ avail ability)= 0.61</strong></p><p id="3feb" class="pw-post-body-paragraph li lj it lk b ll mg ju ln lo mh jx lq lr nl lt lu lv nm lx ly lz nn mb mc md im bi translated">收益(S，财富)=？</p><p id="ca73" class="pw-post-body-paragraph li lj it lk b ll mg ju ln lo mh jx lq lr nl lt lu lv nm lx ly lz nn mb mc md im bi translated">有钱= 7 (3 家电影院+ 2 网球+ 1 购物+ 1 家居)</p><p id="fb98" class="pw-post-body-paragraph li lj it lk b ll mg ju ln lo mh jx lq lr nl lt lu lv nm lx ly lz nn mb mc md im bi translated">差= 3 (3 西内马)</p><p id="1ec8" class="pw-post-body-paragraph li lj it lk b ll mg ju ln lo mh jx lq lr nl lt lu lv nm lx ly lz nn mb mc md im bi translated">熵(S <em class="nu">富</em> ) = 1.842</p><p id="89d8" class="pw-post-body-paragraph li lj it lk b ll mg ju ln lo mh jx lq lr nl lt lu lv nm lx ly lz nn mb mc md im bi translated">熵(S <em class="nu">差</em> )=0</p><p id="e74e" class="pw-post-body-paragraph li lj it lk b ll mg ju ln lo mh jx lq lr nl lt lu lv nm lx ly lz nn mb mc md im bi translated">增益(S，财富)=熵(S)——(P(富)*熵(S <em class="nu">富</em> ) + P(穷)*熵(S <em class="nu">穷</em>))</p><p id="c71f" class="pw-post-body-paragraph li lj it lk b ll mg ju ln lo mh jx lq lr nl lt lu lv nm lx ly lz nn mb mc md im bi translated"><strong class="lk iu">增益(S，财富)= 0.2816 </strong></p><p id="6b6d" class="pw-post-body-paragraph li lj it lk b ll mg ju ln lo mh jx lq lr nl lt lu lv nm lx ly lz nn mb mc md im bi translated">最后，逐一列出所有增益值，并选择具有最高增益值的特征作为根节点。在这种情况下，天气有最高的增益值，所以它将是根。</p><p id="5716" class="pw-post-body-paragraph li lj it lk b ll mg ju ln lo mh jx lq lr nl lt lu lv nm lx ly lz nn mb mc md im bi translated"><strong class="lk iu">增益(S，天气)= 0.70 </strong></p><p id="e8fd" class="pw-post-body-paragraph li lj it lk b ll mg ju ln lo mh jx lq lr nl lt lu lv nm lx ly lz nn mb mc md im bi translated">增益(S，Parental_Availability) = 0.61</p><p id="4398" class="pw-post-body-paragraph li lj it lk b ll mg ju ln lo mh jx lq lr nl lt lu lv nm lx ly lz nn mb mc md im bi translated">增益(S，财富)= 0.2816</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/8db097b740062ecb758248281e5a6784.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*kGS7-Dk9dcqcoqr9M05-8w.png"/></div></figure><p id="dd62" class="pw-post-body-paragraph li lj it lk b ll mg ju ln lo mh jx lq lr nl lt lu lv nm lx ly lz nn mb mc md im bi translated">如上面的例子所示，在选择根之后，特征的每个单独的值被确定为叶，并且这一次用这些单独的值定制数据集。换句话说，上表已被转换为一个单独的数据集，显示天气晴朗时其他要素可以采用的值。因此，根据该表，当天气晴朗时，inter 节点的可能类别如下:</p><ul class=""><li id="b9de" class="me mf it lk b ll mg lo mh lr mi lv mj lz mk md nj mm mn mo bi translated">1 家电影院</li><li id="71cc" class="me mf it lk b ll mp lo mq lr mr lv ms lz mt md nj mm mn mo bi translated">2 网球</li></ul><p id="13af" class="pw-post-body-paragraph li lj it lk b ll mg ju ln lo mh jx lq lr nl lt lu lv nm lx ly lz nn mb mc md im bi translated">熵(S<em class="nu">sunny</em>)=-(1/3)* log2(1/3)-(2/3)* log2(2/3)= 0.918</p><p id="8fff" class="pw-post-body-paragraph li lj it lk b ll mg ju ln lo mh jx lq lr nl lt lu lv nm lx ly lz nn mb mc md im bi translated">Gain(S <em class="nu"> sunny </em>，Parental_Availability) =？</p><p id="7096" class="pw-post-body-paragraph li lj it lk b ll mg ju ln lo mh jx lq lr nl lt lu lv nm lx ly lz nn mb mc md im bi translated">增益(S <em class="nu"> sunny </em>，Parental_Availability) =熵(S<em class="nu">sunny</em>)——(P(是| S<em class="nu">sunny</em>)*熵(S <em class="nu">是</em> ) + P(否| S<em class="nu">sunny</em>)*熵(S <em class="nu">否</em>)</p><p id="6046" class="pw-post-body-paragraph li lj it lk b ll mg ju ln lo mh jx lq lr nl lt lu lv nm lx ly lz nn mb mc md im bi translated">熵(S <em class="nu">是</em> ) = -(1/3)*log2(0) — 0 = 0</p><p id="33c0" class="pw-post-body-paragraph li lj it lk b ll mg ju ln lo mh jx lq lr nl lt lu lv nm lx ly lz nn mb mc md im bi translated">熵(S<em class="nu">no</em>)=-(2/3)* log2(0)—0 = 0</p><p id="cc9c" class="pw-post-body-paragraph li lj it lk b ll mg ju ln lo mh jx lq lr nl lt lu lv nm lx ly lz nn mb mc md im bi translated"><strong class="lk iu">增益(S <em class="nu"> sunny </em>，Parental _ avail ability)</strong>= 0.928—((1/3)* 0+(2/3)* 0)=<strong class="lk iu">0.928</strong></p><p id="7163" class="pw-post-body-paragraph li lj it lk b ll mg ju ln lo mh jx lq lr nl lt lu lv nm lx ly lz nn mb mc md im bi translated"><strong class="lk iu">增益(S <em class="nu">晴</em>，财富)</strong>= 0.918—((3/3)* 0.918+(0/3)* 0)=<strong class="lk iu">0</strong></p><p id="d63a" class="pw-post-body-paragraph li lj it lk b ll mg ju ln lo mh jx lq lr nl lt lu lv nm lx ly lz nn mb mc md im bi translated">因为 Parental_Availability 特性的增益更大，所以晴天状态的叶子将是<strong class="lk iu"> Parental_Availability </strong>。根据为晴天条件设置的数据，如果是，将决定电影院，如果不是，则将决定网球:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/24463c74954cb3f05f92b62bc883cb42.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*lq1qpojt-1BmKWCCBg8-QQ.png"/></div></figure><p id="1097" class="pw-post-body-paragraph li lj it lk b ll mg ju ln lo mh jx lq lr nl lt lu lv nm lx ly lz nn mb mc md im bi translated">当对刮风和下雨的情况进行同样的计算时，最终的决策树就完成了。</p><h1 id="d280" class="kq kr it bd ks kt ku kv kw kx ky kz la jz lb ka lc kc ld kd le kf lf kg lg lh bi translated">过度拟合</h1><ul class=""><li id="3855" class="me mf it lk b ll lm lo lp lr ng lv nh lz ni md nj mm mn mo bi translated">这是学习到记忆的转变。</li><li id="d8b3" class="me mf it lk b ll mp lo mq lr mr lv ms lz mt md nj mm mn mo bi translated">性能图是在某个时刻之后，性能的增加停止并开始减少。</li><li id="02ef" class="me mf it lk b ll mp lo mq lr mr lv ms lz mt md nj mm mn mo bi translated">当你的培训成功率很高，而测试成功率却相反时，就是过度适应的例子。</li><li id="55aa" class="me mf it lk b ll mp lo mq lr mr lv ms lz mt md nj mm mn mo bi translated">此外，如果我们的数据中存在噪声样本，可能会导致过拟合。</li><li id="4098" class="me mf it lk b ll mp lo mq lr mr lv ms lz mt md nj mm mn mo bi translated">当树长得太大时，几乎每个可能的分支都会产生一个结果，这会导致过度拟合。</li></ul><p id="75f3" class="pw-post-body-paragraph li lj it lk b ll mg ju ln lo mh jx lq lr nl lt lu lv nm lx ly lz nn mb mc md im bi translated">为了<strong class="lk iu">避免过度修剪</strong>，有必要在树生长时或树形成后修剪。</p><p id="3015" class="pw-post-body-paragraph li lj it lk b ll mg ju ln lo mh jx lq lr nl lt lu lv nm lx ly lz nn mb mc md im bi translated"><strong class="lk iu">参考文献:</strong></p><p id="0a4d" class="pw-post-body-paragraph li lj it lk b ll mg ju ln lo mh jx lq lr nl lt lu lv nm lx ly lz nn mb mc md im bi translated">[1]决策树，<a class="ae oa" href="https://www.saedsayad.com/decision_tree.htm" rel="noopener ugc nofollow" target="_blank">https://www.saedsayad.com/decision_tree.htm</a></p></div></div>    
</body>
</html>