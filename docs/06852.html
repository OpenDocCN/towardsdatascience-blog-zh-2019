<html>
<head>
<title>How to Retrieve Data from A Complex Formatted File</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何从复杂格式的文件中检索数据</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-retrieve-data-from-a-complex-formatted-file-894098d66e74?source=collection_archive---------17-----------------------#2019-09-29">https://towardsdatascience.com/how-to-retrieve-data-from-a-complex-formatted-file-894098d66e74?source=collection_archive---------17-----------------------#2019-09-29</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="aaa7" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">我从 PDF 扫描图像中提取数据的方式</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/e61dcbc74be2cc59016705c2c3a1e140.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CvBPn3MEjnukrKTabdD1dA.jpeg"/></div></div></figure><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ku kv l"/></div></figure><p id="661b" class="pw-post-body-paragraph kw kx it ky b kz la ju lb lc ld jx le lf lg lh li lj lk ll lm ln lo lp lq lr im bi translated">当我提取数据对马来西亚汽车市场进行<a class="ae ls" rel="noopener" target="_blank" href="/a-deeper-look-into-malaysia-vehicles-industry-c114fda97d36">分析时，我遇到了如何检索干净数据的问题。</a></p><p id="63bc" class="pw-post-body-paragraph kw kx it ky b kz la ju lb lc ld jx le lf lg lh li lj lk ll lm ln lo lp lq lr im bi translated">我一直在谷歌上寻找可能有其他来源获得数据，但我没有找到答案。起初，我以为<a class="ae ls" href="https://euske.github.io/pdfminer/index.html" rel="noopener ugc nofollow" target="_blank"> <strong class="ky iu"> pdfMiner </strong> </a> <strong class="ky iu"> </strong>能够从 PDF 中提取一些文本，但都是 PDF 文件中的扫描图像。这是我唯一能得到的消息来源。</p><p id="dd10" class="pw-post-body-paragraph kw kx it ky b kz la ju lb lc ld jx le lf lg lh li lj lk ll lm ln lo lp lq lr im bi translated">我很震惊，并感到累了，只是得到数据，并开始我的分析。过了一会儿，我尽力让引擎再次启动，谷歌搜索我找到了一个答案——OCR(光学字符识别)。</p><p id="089e" class="pw-post-body-paragraph kw kx it ky b kz la ju lb lc ld jx le lf lg lh li lj lk ll lm ln lo lp lq lr im bi translated">OCR 是一种识别数字或手写字符的技术。我发现最常用的库是 Python 中的 Tesseract OCR，这是一个由惠普公司发起的开源项目。在 Google 接手开发后，Google 发布了最稳定的基于深度学习框架的版本 4 . 0 . 0——LSTM(long short memory)。</p><p id="3538" class="pw-post-body-paragraph kw kx it ky b kz la ju lb lc ld jx le lf lg lh li lj lk ll lm ln lo lp lq lr im bi translated">简单来说，OCR 会逐行读取，逐字符识别字符，有两种</p><ol class=""><li id="c275" class="lt lu it ky b kz la lc ld lf lv lj lw ln lx lr ly lz ma mb bi translated">模式识别</li><li id="9edd" class="lt lu it ky b kz mc lc md lf me lj mf ln mg lr ly lz ma mb bi translated">基于特征的识别</li></ol><h2 id="649f" class="mh mi it bd mj mk ml dn mm mn mo dp mp lf mq mr ms lj mt mu mv ln mw mx my mz bi translated">1.模式识别</h2><p id="da64" class="pw-post-body-paragraph kw kx it ky b kz na ju lb lc nb jx le lf nc lh li lj nd ll lm ln ne lp lq lr im bi translated">20 世纪 60 年代，一种叫做<strong class="ky iu"> OCR-A </strong>的特殊字体被开发出来，用于银行支票等。所以，在当时，字体、笔画和字体大小都是标准化的，这样它就可以很容易地被识别为一个字符。然而，这种方式不能够识别不同种类的笔迹。</p></div><div class="ab cl nf ng hx nh" role="separator"><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk"/></div><div class="im in io ip iq"><h2 id="fc3e" class="mh mi it bd mj mk ml dn mm mn mo dp mp lf mq mr ms lj mt mu mv ln mw mx my mz bi translated">2.基于特征的识别</h2><p id="8826" class="pw-post-body-paragraph kw kx it ky b kz na ju lb lc nb jx le lf nc lh li lj nd ll lm ln ne lp lq lr im bi translated">例如，一个字母“A ”,您可以将其视为 3 个笔画的组合:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/64dd211180593d4597395e23ebb04e72.png" data-original-src="https://miro.medium.com/v2/resize:fit:1228/format:webp/1*v03Kji0XD8zv0tjnjgryFg.png"/></div></figure><p id="8ddb" class="pw-post-body-paragraph kw kx it ky b kz la ju lb lc ld jx le lf lg lh li lj lk ll lm ln lo lp lq lr im bi translated">因此，基于特征的识别可以在学习特征(笔画)时识别不同类型的笔迹。</p><p id="79e0" class="pw-post-body-paragraph kw kx it ky b kz la ju lb lc ld jx le lf lg lh li lj lk ll lm ln lo lp lq lr im bi translated">换句话说，与简单的模式识别相比，像 LSTM 这样的基于特征的方法的当前技术能够识别字母“A”的特征。</p></div><div class="ab cl nf ng hx nh" role="separator"><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk"/></div><div class="im in io ip iq"><h1 id="7430" class="nn mi it bd mj no np nq mm nr ns nt mp jz nu ka ms kc nv kd mv kf nw kg my nx bi translated">我如何为马来西亚车辆分析检索数据</h1><p id="f5f6" class="pw-post-body-paragraph kw kx it ky b kz na ju lb lc nb jx le lf nc lh li lj nd ll lm ln ne lp lq lr im bi translated">例如，在 NLP 中，我们经常有很多关于如何执行建模的想法，或者短语挖掘的多种方法。然而，当涉及到如何获取数据时，却常常被忽视。</p><p id="a751" class="pw-post-body-paragraph kw kx it ky b kz la ju lb lc ld jx le lf lg lh li lj lk ll lm ln lo lp lq lr im bi translated">首先，我必须通过谷歌搜索一些关键字，例如，马来西亚汽车协会(MAA)，但结果不是我想要的。因此，我试图更加具体，包括像 pdf 这样的关键字，所以最终使用了这个关键字:data 2017 年车辆销售数据。pdf 格式，以搜索所需的年度报告。通过改变年份，你将能够得到所有的年度报告。</p><p id="88c5" class="pw-post-body-paragraph kw kx it ky b kz la ju lb lc ld jx le lf lg lh li lj lk ll lm ln lo lp lq lr im bi translated">然后，更有趣的部分来了:如何从包含快照图像的 pdf 中获取数据。我会把它分成两部分。</p></div><div class="ab cl nf ng hx nh" role="separator"><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk"/></div><div class="im in io ip iq"><h2 id="a1e6" class="mh mi it bd mj mk ml dn mm mn mo dp mp lf mq mr ms lj mt mu mv ln mw mx my mz bi translated">1.读入 pdf 文件，提取你需要的页面</h2><p id="3f59" class="pw-post-body-paragraph kw kx it ky b kz na ju lb lc nb jx le lf nc lh li lj nd ll lm ln ne lp lq lr im bi translated">我用的工具是<a class="ae ls" href="https://github.com/Belval/pdf2image" rel="noopener ugc nofollow" target="_blank"> pdf2image </a>。它会将 pdf 的所有页面转换成图像。下面是我想提取文本的倒数第二页的快照。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ny"><img src="../Images/f3e6a194af917ba129d6e955cb504580.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0cRrC92IZZV8bAR0BRu_ug.png"/></div></div></figure><p id="01da" class="pw-post-body-paragraph kw kx it ky b kz la ju lb lc ld jx le lf lg lh li lj lk ll lm ln lo lp lq lr im bi translated">所以我用 pdf2image 提取倒数第二页。然后，我只提取前 20 个品牌的汽车，并裁剪掉不相关的文本部分(如下图的紫色边界框所示)。使用这种方法，你将能够减少提取文本的噪音。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nz"><img src="../Images/0f45d37756d20be9b4c04cf9ed207843.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Q1VYUhRiKBP6S0_3Jm2qtQ.png"/></div></div></figure></div><div class="ab cl nf ng hx nh" role="separator"><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk"/></div><div class="im in io ip iq"><h2 id="51fa" class="mh mi it bd mj mk ml dn mm mn mo dp mp lf mq mr ms lj mt mu mv ln mw mx my mz bi translated">2.应用 OCR 将文本提取到 CSV</h2><p id="22a0" class="pw-post-body-paragraph kw kx it ky b kz na ju lb lc nb jx le lf nc lh li lj nd ll lm ln ne lp lq lr im bi translated">在裁剪掉所有不需要的部分后，我利用<a class="ae ls" href="https://pypi.org/project/tesserocr/" rel="noopener ugc nofollow" target="_blank"> tesserocr </a>包提取文本。以下是我在使用这个软件包时遇到的一些经验和问题。</p><p id="5098" class="pw-post-body-paragraph kw kx it ky b kz la ju lb lc ld jx le lf lg lh li lj lk ll lm ln lo lp lq lr im bi translated">如果你使用 tesserocr 的默认模型，你会发现这个模型犯了一些错误，例如<strong class="ky iu"> 6 </strong>被预测为<strong class="ky iu"> 8 </strong>和<strong class="ky iu">质子</strong>被预测为<strong class="ky iu">大虾，</strong>但总体来说<strong class="ky iu">还不错</strong>。<strong class="ky iu"> </strong>因此，如果您使用默认模型，请对所有文本进行手动检查，以确保解析正确。</p><p id="3080" class="pw-post-body-paragraph kw kx it ky b kz la ju lb lc ld jx le lf lg lh li lj lk ll lm ln lo lp lq lr im bi translated">根据我的经验，使用宇宙魔方 3 和宇宙魔方 4 的主要区别是:</p><ol class=""><li id="1960" class="lt lu it ky b kz la lc ld lf lv lj lw ln lx lr ly lz ma mb bi translated">宇宙魔方 4 文本识别比宇宙魔方 3 好。</li><li id="1ee5" class="lt lu it ky b kz mc lc md lf me lj mf ln mg lr ly lz ma mb bi translated">宇宙魔方 3 的数字识别比宇宙魔方 4 好。</li></ol><p id="6739" class="pw-post-body-paragraph kw kx it ky b kz la ju lb lc ld jx le lf lg lh li lj lk ll lm ln lo lp lq lr im bi translated">Tesseract 支持超过 130 种语言，所以当你发现在解析文本时存在很多错误时，也许你应该考虑改变语言。</p></div><div class="ab cl nf ng hx nh" role="separator"><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk"/></div><div class="im in io ip iq"><h1 id="4a43" class="nn mi it bd mj no np nq mm nr ns nt mp jz nu ka ms kc nv kd mv kf nw kg my nx bi translated">资源</h1><div class="oa ob gp gr oc od"><a href="https://www.explainthatstuff.com/how-ocr-works.html" rel="noopener  ugc nofollow" target="_blank"><div class="oe ab fo"><div class="of ab og cl cj oh"><h2 class="bd iu gy z fp oi fr fs oj fu fw is bi translated">OCR 文档扫描是如何工作的？</h2><div class="ok l"><h3 class="bd b gy z fp oi fr fs oj fu fw dk translated">作者克里斯·伍德福德。最后更新:2018 年 12 月 11 日。你曾经努力去阅读朋友的笔迹吗？算你自己吧…</h3></div><div class="ol l"><p class="bd b dl z fp oi fr fs oj fu fw dk translated">www.explainthatstuff.com</p></div></div><div class="om l"><div class="on l oo op oq om or ks od"/></div></div></a></div><div class="oa ob gp gr oc od"><a href="https://hub.packtpub.com/tesseract-version-4-0-releases-with-new-lstm-based-engine-and-an-updated-build-system/" rel="noopener  ugc nofollow" target="_blank"><div class="oe ab fo"><div class="of ab og cl cj oh"><h2 class="bd iu gy z fp oi fr fs oj fu fw is bi translated">Tesseract 版发布了基于 LSTM 的新引擎和更新的构建系统| Packt Hub</h2><div class="ok l"><h3 class="bd b gy z fp oi fr fs oj fu fw dk translated">谷歌昨天发布了其 OCR 引擎 Tesseract 的 4.0 版本。宇宙魔方 4.0 带有一个新的神经网络(LSTM)…</h3></div><div class="ol l"><p class="bd b dl z fp oi fr fs oj fu fw dk translated">hub.packtpub.com</p></div></div></div></a></div><h1 id="89cd" class="nn mi it bd mj no os nq mm nr ot nt mp jz ou ka ms kc ov kd mv kf ow kg my nx bi translated">最后的想法</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ox"><img src="../Images/1a0475ffc736613477a2b172f115fa05.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zJfSyf6oO87u4QKhSKiYtA.jpeg"/></div></div></figure><p id="3c24" class="pw-post-body-paragraph kw kx it ky b kz la ju lb lc ld jx le lf lg lh li lj lk ll lm ln lo lp lq lr im bi translated">其实还有更好的 OCR 服务，比如可以使用<a class="ae ls" href="https://cloud.google.com/vision/?utm_source=google&amp;utm_medium=cpc&amp;utm_campaign=japac-SG-all-en-dr-bkws-all-super-trial-e-dr-1003987&amp;utm_content=text-ad-none-none-DEV_c-CRE_256563271596-ADGP_Hybrid+%7C+AW+SEM+%7C+BKWS+~+T1+%7C+EXA+%7C+ML+%7C+1:1+%7C+SG+%7C+en+%7C+Vision+%7C+google+ocr-KWID_43700030974776171-kwd-12194465573&amp;userloc_9062515&amp;utm_term=KW_google%20ocr&amp;gclid=EAIaIQobChMI1pyKtLD15AIV2yMrCh39lw_EEAAYASAAEgJG1vD_BwE" rel="noopener ugc nofollow" target="_blank"> Google OCR 付费服务</a>进一步提高准确率。</p><p id="e37e" class="pw-post-body-paragraph kw kx it ky b kz la ju lb lc ld jx le lf lg lh li lj lk ll lm ln lo lp lq lr im bi translated">我希望你喜欢这个帖子，并在下面评论你感兴趣的话题，我会努力为你创造内容！</p></div><div class="ab cl nf ng hx nh" role="separator"><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk"/></div><div class="im in io ip iq"><h1 id="5df5" class="nn mi it bd mj no np nq mm nr ns nt mp jz nu ka ms kc nv kd mv kf nw kg my nx bi translated">关于作者</h1><p id="4622" class="pw-post-body-paragraph kw kx it ky b kz na ju lb lc nb jx le lf nc lh li lj nd ll lm ln ne lp lq lr im bi translated"><a class="ae ls" href="https://www.linkedin.com/in/lowweihong/?source=post_page---------------------------" rel="noopener ugc nofollow" target="_blank"> Low 魏宏</a>是 Shopee 的数据科学家。他的经验更多地涉及抓取网站，创建数据管道，以及实施机器学习模型来解决业务问题。</p><p id="fb52" class="pw-post-body-paragraph kw kx it ky b kz la ju lb lc ld jx le lf lg lh li lj lk ll lm ln lo lp lq lr im bi translated">他提供爬行服务，可以为你提供你需要的准确和干净的数据。你可以访问<a class="ae ls" href="https://www.thedataknight.com/" rel="noopener ugc nofollow" target="_blank"> <strong class="ky iu">这个网站</strong> </a>查看他的作品集，也可以联系他获取<strong class="ky iu">抓取服务</strong>。</p><p id="f81c" class="pw-post-body-paragraph kw kx it ky b kz la ju lb lc ld jx le lf lg lh li lj lk ll lm ln lo lp lq lr im bi translated">你可以在<a class="ae ls" href="https://www.linkedin.com/in/lowweihong/?source=post_page---------------------------" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>和<a class="ae ls" href="https://medium.com/@lowweihong?source=post_page---------------------------" rel="noopener"> Medium </a>上和他联系。</p></div></div>    
</body>
</html>