<html>
<head>
<title>On-demand last mile transportation</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">按需最后一英里运输</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/on-demand-last-mile-transportation-ea4a3b725b31?source=collection_archive---------26-----------------------#2019-12-03">https://towardsdatascience.com/on-demand-last-mile-transportation-ea4a3b725b31?source=collection_archive---------26-----------------------#2019-12-03</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="47e6" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">具有位置智能的实时路线优化</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/5b2d354fdfa44e0d8f8f68cdf99e2ce7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1DhbAokxFrJ-HEBcwoqETg.png"/></div></div></figure><p id="f5c8" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">近年来，我们看到了众多市场平台的出现，这些平台将客户与各种各样的产品和服务联系起来。这方面的明显例子有<a class="ae lq" href="https://www.uber.com/" rel="noopener ugc nofollow" target="_blank">优步</a>、<a class="ae lq" href="https://postmates.com/" rel="noopener ugc nofollow" target="_blank">邮局</a>和<a class="ae lq" href="https://stuart.com/" rel="noopener ugc nofollow" target="_blank">斯图亚特</a>，它们允许你订购基本上任何东西的取货和送货服务，从乘车、食物，甚至是小包裹，并在不到一两个小时内送到。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lr"><img src="../Images/1e9aa15a59766024269c9ce76b7f9636.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*OXtqvA3ceb6sVqza.jpeg"/></div></div></figure><p id="bc43" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">从物流的角度来看，有效运营这一服务是一项挑战，而且在该行业面临激烈竞争的情况下，这一点越来越重要。由于问题的性质与标准物流公司的问题非常不同，传统的物流解决方案不再适合规划这种服务。如果我们看看任何一家正规的第三方物流(3PL)公司，他们通常会在某个截止时间之前接受第二天的交付订单，以便他们有足够的时间规划第二天的路线。这与随需应变服务不同，在随需应变服务中，新订单必须(几乎)实时处理和分配，而没有未来可能到来的订单的信息。</p><p id="6a2e" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">众所周知，这两个问题都很难解决，尤其是如果我们想确保我们的运营处于最佳状态，或者至少比我们的竞争对手更好。这就是<a class="ae lq" href="https://carto.com/platform/data-enrichment/" rel="noopener ugc nofollow" target="_blank">空间数据科学</a>可以发挥作用的地方，因为它允许我们建立模拟现有条件的数据模型，为我们提供关于现有约束、低效分配等更多信息的见解。</p><h1 id="1be5" class="ls lt it bd lu lv lw lx ly lz ma mb mc jz md ka me kc mf kd mg kf mh kg mi mj bi translated">传统与按需最后一英里运输问题</h1><p id="1347" class="pw-post-body-paragraph ku kv it kw b kx mk ju kz la ml jx lc ld mm lf lg lh mn lj lk ll mo ln lo lp im bi translated">虽然这两个问题都很难解决，但每个问题的复杂性可以在非常不同的阶段发现。传统的最后一英里运输问题是一个<a class="ae lq" href="https://en.wikipedia.org/wiki/Vehicle_routing_problem" rel="noopener ugc nofollow" target="_blank">车辆路线问题(VRP) </a>，一个组合的<a class="ae lq" href="https://en.wikipedia.org/wiki/Mathematical_optimization" rel="noopener ugc nofollow" target="_blank">优化问题</a>，从算法设计的角度以及计算的角度来看，其复杂性是众所周知的。与实时按需运输问题相比，它们的明显优势在于，关于订单和司机可用性的所有信息都是预先知道的，通常不需要立即找到解决方案。这使得更容易找到接近最优的解决方案。有几个算法被设计来解决这个问题，有几个实现了这些算法的解决方案，包括商业的和开源的。</p><p id="d099" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">另一方面，实时按需运输问题是较小的问题，因为可用的信息较少，但需要立即做出响应。在这里，我们只知道在我们检查系统状态之前发生了什么，并且大部分都不能改变，因为它已经被交付了。由于缺乏未来信息和无法改变过去的决定，这可能导致非常低效的路由。克服这种对问题的狭隘看法成为主要挑战。</p><p id="2205" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">下面的地图很好地展示了这种狭隘的观点，在这里我们只能看到每 3 分钟时间窗口内的订单。一旦时间窗口过去，我们就不能改变我们所做的任务，我们也不知道会有什么样的订单。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mp mq l"/></div></figure><p id="7b5d" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在物流文献中，对于如何克服这种狭隘的视野问题有共识:增加决策的灵活性，并试图获得尽可能多的未来信息。第一点是尽可能推迟决定，做出容易撤销或改变的决定。第二个问题涉及使用其他数据科学技术，如预测，以拓宽我们的视野。</p><p id="f123" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这个问题很难归类为一个问题类别，因为它取决于所提供服务的复杂性，也取决于我们希望在优化路线方面走多远。它可以从一个“简单的”<a class="ae lq" href="https://en.wikipedia.org/wiki/Assignment_problem" rel="noopener ugc nofollow" target="_blank">分配问题</a>(如果我们只需要考虑与窄时间窗相关的信息)到一个 VRP(如果我们需要考虑在算法的当前迭代之前司机已经做了什么)。</p><p id="e27a" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">接下来的主要挑战是能够计算所有需要的成本，并设计一种算法，能够在几秒钟内找到接近最优的解决方案。还可能有其他挑战需要克服，例如计算在我们开始一天的工作之前我们需要多少司机，我们需要什么车队，或者计算接下来几分钟/几小时的天气预报。</p><p id="2ae2" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这两种情况下要解决的问题的巨大差异使得很难(如果不是不可能的话)将传统的物流解决方案用于按需运输问题。</p><h1 id="8b7c" class="ls lt it bd lu lv lw lx ly lz ma mb mc jz md ka me kc mf kd mg kf mh kg mi mj bi translated">设计和改进优化算法</h1><p id="a1a4" class="pw-post-body-paragraph ku kv it kw b kx mk ju kz la ml jx lc ld mm lf lg lh mn lj lk ll mo ln lo lp im bi translated">以下示例显示了如何应用优化来解决按需运输问题的第一步，以及这样做所获得的好处。这里有一个场景，我们将应用两种初始方法来解决这个问题。</p><p id="1bfd" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">以下假设是为了提高演示文稿的清晰度。但是，请记住，问题可能会变得更加复杂，这取决于我们希望在优化我们的功能方面走多远，以及稍后描述的所提供服务的需求。</p><ul class=""><li id="9fcc" class="mr ms it kw b kx ky la lb ld mt lh mu ll mv lp mw mx my mz bi translated">我们的目标是将距离最小化，我们的主要衡量标准将是行驶的总距离。这可以很容易地改变为其他标准，如最小化交付时间或所需的车队，仅举几例。</li><li id="1bf3" class="mr ms it kw b kx na la nb ld nc lh nd ll ne lp mw mx my mz bi translated">每个订单都是相互独立的，也就是说，它们不能合并，因此，除非骑手空闲，否则在完成当前交付的订单之前，他们无法开始订单。</li><li id="23d1" class="mr ms it kw b kx na la nb ld nc lh nd ll ne lp mw mx my mz bi translated">骑手在空闲之前不会被分配到新订单。</li><li id="a3f8" class="mr ms it kw b kx na la nb ld nc lh nd ll ne lp mw mx my mz bi translated">每个骑手的车队类型都是一样的。</li><li id="70af" class="mr ms it kw b kx na la nb ld nc lh nd ll ne lp mw mx my mz bi translated">在算法的每次迭代中，我们总是有足够多的空闲骑手来分配订单。当然，这在现实生活中不会发生，而且会增加问题的复杂性。</li></ul><p id="bcdf" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在下面的地图上，我们可以看到周四下午 7:00 到 7:05 收到的订单。我们可以看到取货和送货地点、为每个订单计算的最佳路线，以及空闲的或在时间窗口内的某个时间点可用的骑手/司机。我们将重点关注这 5 分钟的时间窗口，以便更容易显示和比较结果。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mp mq l"/></div></figure><h1 id="1f1c" class="ls lt it bd lu lv lw lx ly lz ma mb mc jz md ka me kc mf kd mg kf mh kg mi mj bi translated">步骤 1:起点-终点矩阵</h1><p id="8334" class="pw-post-body-paragraph ku kv it kw b kx mk ju kz la ml jx lc ld mm lf lg lh mn lj lk ll mo ln lo lp im bi translated">为了解决任何路径问题，我们需要构建一个成本矩阵，表示从地点 A 到地点 B 的成本，或者在此处显示的情况下，将位于 A 点的骑手分配给提货地点在 B 点的订单的成本。在我们的示例中，该 OD 矩阵将是从骑手地点到订单提货地点的距离。</p><p id="2356" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">如<a class="ae lq" href="https://carto.com/blog/logistics-optimization-network-model/" rel="noopener ugc nofollow" target="_blank">所述，构建 OD 矩阵对于按需运输问题来说是一个更大的挑战，因为需要实时计算这个矩阵。</a></p><h1 id="32ff" class="ls lt it bd lu lv lw lx ly lz ma mb mc jz md ka me kc mf kd mg kf mh kg mi mj bi translated">贪婪算法</h1><p id="0444" class="pw-post-body-paragraph ku kv it kw b kx mk ju kz la ml jx lc ld mm lf lg lh mn lj lk ll mo ln lo lp im bi translated">这通常是解决这个问题时遵循的第一种方法。该算法在每次收到订单时被激活，它搜索最近的空闲骑手并将订单分配给该骑手。在这种情况下，我们采用最接近的标准，但根据所提供的服务或业务目标，也可以是任何其他需要优化的标准。</p><p id="22b4" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这种算法被广泛使用，因为它很容易实现，并理解和分析其结果。此外，在推出新业务时，客户体验通常是主要指标之一，因此希望尽快处理每个订单是有意义的。然而，这并不一定意味着顾客总能得到更快的服务。</p><p id="fa9b" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">使用该算法解决问题后，我们得到了乘客从出发地点到上车地点的总距离<strong class="kw iu"> 181.67 </strong> km。</p><p id="2d7a" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在下图中，我们可以看到使用<a class="ae lq" href="https://carto.com/developers/cartoframes/" rel="noopener ugc nofollow" target="_blank">线框</a>绘制的算法执行的前六个步骤，其中黑点是空闲骑手的位置，绿点是订单的提货位置。这种可视化非常强大，因为它可以帮助快速识别我们算法中的低效之处。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nf"><img src="../Images/454c5456e6ba1593e77db072d285bdc7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*j72YU0e0FRcnsHe3"/></div></div><figcaption class="ng nh gj gh gi ni nj bd b be z dk"><strong class="bd nk">Figure 1</strong>. First six iterations of the greedy algorithm</figcaption></figure><h1 id="ecb3" class="ls lt it bd lu lv lw lx ly lz ma mb mc jz md ka me kc mf kd mg kf mh kg mi mj bi translated">批量分配算法</h1><p id="cf7f" class="pw-post-body-paragraph ku kv it kw b kx mk ju kz la ml jx lc ld mm lf lg lh mn lj lk ll mo ln lo lp im bi translated">如前所述，改进作业的一个关键因素是尽可能地增加信息和灵活性。扩大我们的视野并获得更多信息的一个选择是推迟订单分配，每 n 分钟运行一次算法。我们越推迟越好，因为我们会有更多的信息。</p><p id="d6da" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">下图显示了每分钟收到的订单数。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nl"><img src="../Images/5094bef74f25d67c21402a92961e5d4f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*zxKyczCcIDdLXMsS"/></div></div><figcaption class="ng nh gj gh gi ni nj bd b be z dk"><strong class="bd nk">Figure 2</strong>. Number of orders per minute</figcaption></figure><p id="fe55" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">每分钟运行一次算法意味着订单将不得不等待(最多)一分钟才能得到处理，这最初不会对客户体验产生重大影响。事实上，我们会看到一些订单甚至会提前交付。</p><p id="8828" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">算法每分钟都会被激活，它会考虑最后一分钟收到的所有订单并进行分配。这意味着它将有多个订单要分配。为了充分利用我们所有的信息，我们将把它作为一个<a class="ae lq" href="https://en.wikipedia.org/wiki/Assignment_problem" rel="noopener ugc nofollow" target="_blank">指派问题</a>来解决。</p><p id="fbb8" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">有专门为这个问题设计的算法，比如<a class="ae lq" href="https://en.wikipedia.org/wiki/Hungarian_algorithm" rel="noopener ugc nofollow" target="_blank">匈牙利算法</a>。通常，这些算法是为问题的非常具体的情况而设计的，当问题开始需要复杂的特征时，很难改进它们。这就是为什么我们将使用<a class="ae lq" href="https://en.wikipedia.org/wiki/Linear_programming" rel="noopener ugc nofollow" target="_blank">线性规划</a>，或者更具体地说<a class="ae lq" href="https://en.wikipedia.org/wiki/Integer_programming" rel="noopener ugc nofollow" target="_blank">整数线性规划</a>来解决它。这项技术将使我们能够适应未来的变化或增加问题的复杂性。</p></div><div class="ab cl nm nn hx no" role="separator"><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr"/></div><div class="im in io ip iq"><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/1f7979e1bd357655d935725c1261ce10.png" data-original-src="https://miro.medium.com/v2/resize:fit:1374/format:webp/0*jkJyfM8xR2RZTvkf.png"/></div></figure></div><div class="ab cl nm nn hx no" role="separator"><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr"/></div><div class="im in io ip iq"><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/96490975a92c0e5267a6e9806e3e6fc8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1354/format:webp/0*UthU7dCdmIEa35Jp.png"/></div></figure></div><div class="ab cl nm nn hx no" role="separator"><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr"/></div><div class="im in io ip iq"><p id="2881" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">使用这种批量分配算法解决问题后，我们得到的总行驶距离为<strong class="kw iu"> 159.10 km </strong>，也就是说，我们的目标指标提高了<strong class="kw iu">13%</strong>。</p><p id="3fea" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">如果我们用两种算法比较第一分钟(从晚上 7:00 到 7:01)收到的订单上完成的任务，我们可以看到一些很大的差异。例如，如果我们查看地图的东北部分，我们可以看到使用贪婪算法完成的效率非常低的分配，而使用批量分配算法完成的分配效率要高得多。这要归功于通过推迟任务完成的时间来获得更多的信息。</p><p id="aab0" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">同样，能够将两种算法做出的决策可视化是非常强大的:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nf"><img src="../Images/634fb216e77f66c924255927a2299e9b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*GFKHjofu_tgN_kO8"/></div></div><figcaption class="ng nh gj gh gi ni nj bd b be z dk"><strong class="bd nk">Figure 3</strong>. Comparison of assignments done by the greedy algorithm (left) and the batch-assignment algorithm (right) for the orders received within the first minute</figcaption></figure><h1 id="ca7c" class="ls lt it bd lu lv lw lx ly lz ma mb mc jz md ka me kc mf kd mg kf mh kg mi mj bi translated">后续步骤</h1><p id="f1c3" class="pw-post-body-paragraph ku kv it kw b kx mk ju kz la ml jx lc ld mm lf lg lh mn lj lk ll mo ln lo lp im bi translated">前面的两个算法只是面对这个问题时通常遵循的第一个自然步骤。然而，问题的复杂性通常要求更多的步骤。</p><p id="5f5f" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">如上所述，在问题的每一次迭代中拓宽可用信息是至关重要的。一个非常有用的步骤是考虑在接下来的 30 到 60 分钟(或者更多时间，取决于服务的长度)内可能发生的事情。这将是非常有益的，有一些需求的预测，以避免分配将远离高需求地区的车手。这可以通过识别哪些骑手不应该被分配给交货地点远离高需求区域的订单而容易地合并到批量分配模型中。此外，这些信息可以提供给骑手，这样他们就知道空闲时应该去哪里，以确保他们被分配更多的订单。</p><p id="d5a9" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">下面的地图显示了从现在起一个小时后需求预计发生的位置，以及闲置的骑手。根据他们离预期需求较高的地区有多远，他们将被赋予不同的优先权。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mp mq l"/></div></figure><p id="7d3c" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">除此之外，还有其他的改进可以提高作业的效率和质量。这些改进在很大程度上取决于所提供的服务类型。</p><ul class=""><li id="bebe" class="mr ms it kw b kx ky la lb ld mt lh mu ll mv lp mw mx my mz bi translated">优化标准。在我们的示例中，我们将距离作为要优化的度量。然而，我们可能会添加额外的标准，始终牢记在算法的每次迭代中必须计算成本。一些例子可能是时间、利用率(这对于购买和/或维护车队成本高昂的公司尤其重要)，以及客户和骑手体验。</li><li id="bc48" class="mr ms it kw b kx na la nb ld nc lh nd ll ne lp mw mx my mz bi translated">根据服务的使用频率匹配客户的质量，并根据客户的意见和交付效率匹配骑手的质量。</li><li id="35ad" class="mr ms it kw b kx na la nb ld nc lh nd ll ne lp mw mx my mz bi translated">合并订单(如优步池)</li><li id="064b" class="mr ms it kw b kx na la nb ld nc lh nd ll ne lp mw mx my mz bi translated">通过尽可能推迟分配来创建更大的批处理。例如，对于递送小包裹，5 分钟可能就够了。</li></ul><p id="d854" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">从算法的角度来看，将这些标准整合到我们的模型中是一项复杂的任务。能够可视化我们测试的不同算法所做出的步骤和决策，对于非常耗时的任务来说是一个非常强大的工具。在这里，可视化工具可以提供巨大的帮助。</p></div><div class="ab cl nm nn hx no" role="separator"><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr"/></div><div class="im in io ip iq"><p id="1b4f" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><em class="nv">本文原载于</em> <a class="ae lq" href="https://carto.com/blog/last-mile-transportation-route-optimization/" rel="noopener ugc nofollow" target="_blank"> <em class="nv"> CARTO 博客</em> </a>。</p></div></div>    
</body>
</html>