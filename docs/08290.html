<html>
<head>
<title>Using Python to Push Your Pandas DataFrame to Google Sheets</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用 Python 将您的熊猫数据框推送到 Google Sheets</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/using-python-to-push-your-pandas-dataframe-to-google-sheets-de69422508f?source=collection_archive---------4-----------------------#2019-11-12">https://towardsdatascience.com/using-python-to-push-your-pandas-dataframe-to-google-sheets-de69422508f?source=collection_archive---------4-----------------------#2019-11-12</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/3587f704e5f6e879868b4fc12cda2f32.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*WDH46rlGuJjj3zdV"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk">Photo by <a class="ae kf" href="https://unsplash.com/@chilis?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Christian Kielberg</a> on <a class="ae kf" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="c973" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这也可以作为像使用数据库一样使用 Google Sheets 的简单方法。</p><p id="7904" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">假设您已经安装了最新版本的 Python。为此需要的 Python 模块有:</p><ol class=""><li id="dfce" class="le lf it ki b kj kk kn ko kr lg kv lh kz li ld lj lk ll lm bi translated"><code class="fe ln lo lp lq b">pandas</code>(获取和读取数据)</li><li id="27bb" class="le lf it ki b kj lr kn ls kr lt kv lu kz lv ld lj lk ll lm bi translated"><code class="fe ln lo lp lq b">gspread</code>(连接到谷歌工作表)</li><li id="d9ad" class="le lf it ki b kj lr kn ls kr lt kv lu kz lv ld lj lk ll lm bi translated"><code class="fe ln lo lp lq b">df2gspread</code>(与谷歌工作表互动)</li></ol><p id="2acc" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">仔细安装这些模块后，我们现在可以创建一个 Python 文件，并开始导入。</p><pre class="lw lx ly lz gt ma lq mb mc aw md bi"><span id="12b1" class="me mf it lq b gy mg mh l mi mj">import pandas as pd<br/>import gspread<br/>import df2gspread as d2g</span></pre><p id="3d9f" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在我们需要任何类型的数据，我们可以从 CSV 或其他来源获取。利用熊猫，我们可以把它组织成一个数据框架。任何类型的数据框架都可以。如果你还没有，让我们用熊猫做一个。</p><pre class="lw lx ly lz gt ma lq mb mc aw md bi"><span id="1d73" class="me mf it lq b gy mg mh l mi mj">d = {'col1': [1, 2], 'col2': [3, 4]}<br/>df = pd.DataFrame(data=d)</span></pre><p id="7c26" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在棘手的部分，获得凭证访问。为了使用 Python，我们需要从 Google 获得某种形式的<strong class="ki iu"> <em class="mk">密钥</em> </strong>。这个<strong class="ki iu"> <em class="mk">键</em> </strong>主要是出于安全目的，将采用 JSON 文件的格式。</p><p id="fa76" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们登录我们希望使用的谷歌账户，并按照这里的说明<a class="ae kf" href="https://gspread.readthedocs.io/en/latest/oauth2.html" rel="noopener ugc nofollow" target="_blank">进行操作</a>。如果一切顺利，JSON 文件应该看起来像这样:</p><pre class="lw lx ly lz gt ma lq mb mc aw md bi"><span id="bc75" class="me mf it lq b gy mg mh l mi mj">{<br/>    "private_key_id": "2cd … ba4",<br/>    "private_key": "-----BEGIN PRIVATE KEY-----<strong class="lq iu">\n</strong>NrDyLw … jINQh/9<strong class="lq iu">\n</strong>-----END PRIVATE KEY-----<strong class="lq iu">\n</strong>",<br/>    "client_email": "473000000000-yoursisdifferent@developer.gserviceaccount.com",<br/>    "client_id": "473 … hd.apps.googleusercontent.com",<br/>    "type": "service_account"<br/>}</span></pre><p id="5041" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这个 JSON 文件需要与 Python 脚本在同一个文件夹中。对于这个例子，我将其命名为<code class="fe ln lo lp lq b">jsonFileFromGoogle.json</code>。我们可以在代码中调用 JSON 文件，并将其设置为连接的凭证。我们还可以设置<em class="mk">范围，</em>我们希望凭证被发送到哪里以便进行连接。</p><pre class="lw lx ly lz gt ma lq mb mc aw md bi"><span id="4900" class="me mf it lq b gy mg mh l mi mj">scope = ['<a class="ae kf" href="https://spreadsheets.google.com/feeds'" rel="noopener ugc nofollow" target="_blank">https://spreadsheets.google.com/feeds'</a>,<br/>         '<a class="ae kf" href="https://www.googleapis.com/auth/drive'" rel="noopener ugc nofollow" target="_blank">https://www.googleapis.com/auth/drive'</a>]</span><span id="8c12" class="me mf it lq b gy ml mh l mi mj">credentials = ServiceAccountCredentials.from_json_keyfile_name(<br/>    'jsonFileFromGoogle.json', scope)</span><span id="c723" class="me mf it lq b gy ml mh l mi mj">gc = gspread.authorize(credentials)</span></pre><p id="426f" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">您现在应该能够以这种方式连接到 Google。是时候把数据帧发送到谷歌电子表格了。对于我的目的，我发现创建一个新的工作表并获取电子表格键更容易。电子表格密钥可以在这里用红色标记的 URL 中找到。</p><figure class="lw lx ly lz gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mm"><img src="../Images/91cf23c3e1dc44ef7ea92b7523bac911.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Hu8a8Lg2Zxyy_6LKjod_1Q.png"/></div></div></figure><p id="de5c" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">复制它，并将其设置为一个名为<code class="fe ln lo lp lq b">spreadsheet_key</code>的变量。如果您的工作表有多个工作表，也要设置工作表名称。我在我的代码里设置为<code class="fe ln lo lp lq b">wks_name</code>，默认情况下会叫“Master”。</p><pre class="lw lx ly lz gt ma lq mb mc aw md bi"><span id="8e48" class="me mf it lq b gy mg mh l mi mj">spreadsheet_key = 'red_url_code_goes_here'<br/>wks_name = 'Master'<br/>d2g.upload(df, spreadsheet_key, wks_name, credentials=credentials, row_names=True)</span></pre><p id="d2bd" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在，当您最终运行这个脚本时，您设置的 DataFrame 将把它上传到 Google Sheets。这有许多其他的可能性，但是你可以用它作为一个更新的小数据库，你可以和你的同伴分享。</p></div><div class="ab cl mn mo hx mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="im in io ip iq"><p id="15b7" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我在这里也有家教和职业指导！</p><p id="6cbd" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果你喜欢这些内容，请随时在<a class="ae kf" href="https://www.patreon.com/join/melvfnz" rel="noopener ugc nofollow" target="_blank"> Patreon </a>上支持我！</p><p id="0b6b" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果你们有任何问题、意见或担忧，请不要忘记通过 LinkedIn 与我联系！</p></div></div>    
</body>
</html>