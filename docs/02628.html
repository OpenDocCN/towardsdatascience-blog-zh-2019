<html>
<head>
<title>R Squared Interpretation | R Squared Linear Regression</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">R 平方解释| R 平方线性回归</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/statistics-for-machine-learning-r-squared-explained-425ddfebf667?source=collection_archive---------3-----------------------#2019-04-30">https://towardsdatascience.com/statistics-for-machine-learning-r-squared-explained-425ddfebf667?source=collection_archive---------3-----------------------#2019-04-30</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/60113de2c39fedd422ba21c521006226.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*cxsSJ_aTN7SC24YH"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk">Photo by <a class="ae jg" href="https://unsplash.com/@roman_lazygeek?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Roman Mager</a> on <a class="ae jg" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><div class=""/><p id="88bb" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">机器学习涉及大量的统计数据。在前面的文章中，我们将看看 R 平方的概念，它在特性选择中很有用。</p><p id="2d13" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">相关性(也称为“R”)是一个介于 1 和-1 之间的数字，其中值+1 意味着 x 的增加会导致 y 的增加，-1 意味着 x 的增加会导致 y 的减少，0 意味着 x 和 y 之间没有任何关系。与相关性一样，R 会告诉您两个事物的相关程度。然而，我们倾向于使用 R，因为它更容易解释。r 是由两个变量之间的关系解释的变化百分比(即从 0 到 1 变化)。</p><p id="038a" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">后者听起来相当复杂，所以让我们看一个例子。假设我们决定绘制工资和工作经验之间的关系。在上图中，每个数据点代表一个个体。</p><figure class="lf lg lh li gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi le"><img src="../Images/ec8ebd37c4c67369bff8f84006ad1a82.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EtCxfhGLkhXRd9FSkLxlTA.png"/></div></div></figure><p id="4fc8" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们可以通过将样本中所有个体的总和除以样本中个体的总数来计算平均值。</p><figure class="lf lg lh li gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi lj"><img src="../Images/d287d83e7d47324347acfeb4791923ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*s_txRCuGcDyU1IZnDvan7g.png"/></div></div></figure><p id="9956" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">整个数据集的方差等于每个数据点之间的距离和均方值之和。差值的平方使得低于平均值的点不会被高于平均值的点抵消。</p><pre class="lf lg lh li gt lk ll lm ln aw lo bi"><span id="7ac0" class="lp lq jj ll b gy lr ls l lt lu">var(mean) = sum(pi - mean)²</span></pre><figure class="lf lg lh li gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi lv"><img src="../Images/a47faee75bd9b2174bce86845d53f5ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6y49wAdUXAmSwBNtRWsVng.png"/></div></div></figure><p id="bfb0" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在说，我们找了同样的人，但是这一次，我们决定画出他们的工资和身高之间的关系。</p><figure class="lf lg lh li gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi lw"><img src="../Images/a2c5945c74aa6d006611d241dc7c250c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SjW3zni9PfvbErZb1WjdfQ.png"/></div></div></figure><p id="ef16" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">注意，不管我们把什么作为自变量，平均工资都保持不变。换句话说，我们可以用人民生活的其他方面作为<strong class="ki jk"> <em class="lx"> x </em> </strong>但工资会保持不变。</p><figure class="lf lg lh li gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ly"><img src="../Images/54c37eee5e5b521a36085b80652faab0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lwJLN6RC66xN7oZfo6RONA.png"/></div></div></figure><p id="1a2c" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">假设我们使用线性回归找到了<em class="lx">最佳拟合</em>线。</p><figure class="lf lg lh li gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi lz"><img src="../Images/e0f39493f8f44f85fdabd6fbf6cf757c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Mbda-1jMTDcIpJm-eH1p3Q.png"/></div></div></figure><p id="42cd" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki jk"> R </strong>的值可以表示为:</p><pre class="lf lg lh li gt lk ll lm ln aw lo bi"><span id="ea62" class="lp lq jj ll b gy lr ls l lt lu"><strong class="ll jk">R² = (var(mean) - var(line)) / var(mean)</strong></span></pre><p id="6772" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">其中<em class="lx"> var(mean) </em>是<em class="lx"> </em>相对于平均值的方差，而<em class="lx"> var(line) </em>是相对于直线的方差。</p><p id="2691" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">就像我们之前提到的，方差可以通过计算个人工资和均方差之间的差来计算。</p><figure class="lf lg lh li gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ma"><img src="../Images/484eab152b2095269a4e948e30ad90bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ONLxfBNMhq0Cj2OhZ-fCaA.png"/></div></div></figure><p id="b4e1" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">使用相同的逻辑，我们可以确定橙色线周围的变化。</p><figure class="lf lg lh li gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi mb"><img src="../Images/61722deb752a787940ddf671323f670e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8bnJGMaMQKohYjLMxAO4Xw.png"/></div></div></figure><p id="5197" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">假设我们获得了线的方差和均值的下列值。</p><figure class="lf lg lh li gt iv gh gi paragraph-image"><div class="gh gi mc"><img src="../Images/8f18499d0c8225585dcdd68da58970e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1062/format:webp/1*jhxQAliDNfHtxkaGQSDCmw.png"/></div></figure><p id="37be" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们可以使用之前描述的公式计算<strong class="ki jk"> R </strong>。</p><figure class="lf lg lh li gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi md"><img src="../Images/3cff2c568a8e7c1968a97668b136f0d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4XngoD7YofOn5ivM9STYTA.png"/></div></div></figure><p id="9008" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">R 值意味着线周围的变化比平均值小 96%。换句话说，工资和工作年限的关系解释了 96%的变异。换句话说，工作年限是薪水的一个很好的预测指标，因为当工作年限增加时，薪水也会增加，反之亦然。</p><h1 id="d516" class="me lq jj bd mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na bi translated">密码</h1><p id="40f6" class="pw-post-body-paragraph kg kh jj ki b kj nb kl km kn nc kp kq kr nd kt ku kv ne kx ky kz nf lb lc ld im bi translated">让我们看看如何用 R 来评估一个线性回归模型。首先，导入以下库。</p><pre class="lf lg lh li gt lk ll lm ln aw lo bi"><span id="2d20" class="lp lq jj ll b gy lr ls l lt lu">import pandas as pd<br/>import numpy as np<br/>from matplotlib import pyplot as plt<br/>import seaborn as sns<br/>from sklearn.metrics import r2_score<br/>from sklearn.linear_model import LinearRegression<br/>sns.set()</span></pre><p id="7fbe" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们将使用以下数据集。如果您想跟进，请将其内容复制到 csv 文件中。</p><pre class="lf lg lh li gt lk ll lm ln aw lo bi"><span id="e9e6" class="lp lq jj ll b gy lr ls l lt lu">YearsExperience,Salary<br/>1.1,39343.00<br/>1.3,46205.00<br/>1.5,37731.00<br/>2.0,43525.00<br/>2.2,39891.00<br/>2.9,56642.00<br/>3.0,60150.00<br/>3.2,54445.00<br/>3.2,64445.00<br/>3.7,57189.00<br/>3.9,63218.00<br/>4.0,55794.00<br/>4.0,56957.00<br/>4.1,57081.00<br/>4.5,61111.00<br/>4.9,67938.00<br/>5.1,66029.00<br/>5.3,83088.00<br/>5.9,81363.00<br/>6.0,93940.00<br/>6.8,91738.00<br/>7.1,98273.00<br/>7.9,101302.00<br/>8.2,113812.00<br/>8.7,109431.00<br/>9.0,105582.00<br/>9.5,116969.00<br/>9.6,112635.00<br/>10.3,122391.00<br/>10.5,121872.00</span></pre><p id="e8a5" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们使用 pandas 将数据加载到我们的程序中，并使用 matplotlib 绘制它。</p><pre class="lf lg lh li gt lk ll lm ln aw lo bi"><span id="9029" class="lp lq jj ll b gy lr ls l lt lu">df = pd.read_csv('data.csv')</span><span id="9952" class="lp lq jj ll b gy ng ls l lt lu">plt.scatter(df['YearsExperience'], df['Salary'])</span></pre><figure class="lf lg lh li gt iv gh gi paragraph-image"><div class="gh gi nh"><img src="../Images/2e0fd34ea6f1f62ec7a038e1ae22021e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1074/format:webp/1*eHZ9pTrHeI3CFbYrtO_w-g.png"/></div></figure><p id="4b1d" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">接下来，我们对工资数据训练一个线性回归模型。</p><pre class="lf lg lh li gt lk ll lm ln aw lo bi"><span id="43e4" class="lp lq jj ll b gy lr ls l lt lu">X = np.array(df['YearsExperience']).reshape(-1, 1)</span><span id="5333" class="lp lq jj ll b gy ng ls l lt lu">y = df['Salary']</span><span id="6191" class="lp lq jj ll b gy ng ls l lt lu">rf = LinearRegression()</span><span id="e114" class="lp lq jj ll b gy ng ls l lt lu">rf.fit(X, y)</span><span id="fb23" class="lp lq jj ll b gy ng ls l lt lu">y_pred = rf.predict(X)</span></pre><p id="b13c" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们可以通过运行下面几行来查看模型生成的最佳拟合线。</p><pre class="lf lg lh li gt lk ll lm ln aw lo bi"><span id="fabf" class="lp lq jj ll b gy lr ls l lt lu">plt.scatter(df['YearsExperience'], df['Salary'])<br/>plt.plot(X, y_pred, color='red')</span></pre><figure class="lf lg lh li gt iv gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/91d55e8b51d00532c6a4125f7fbd12fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1070/format:webp/1*hZVNDVLVuDZAfkMTSe075A.png"/></div></figure><p id="e25e" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后，我们用上一节讨论的公式计算 R。</p><pre class="lf lg lh li gt lk ll lm ln aw lo bi"><span id="df7c" class="lp lq jj ll b gy lr ls l lt lu">def r2_score_from_scratch(ys_orig, ys_line):<br/>    y_mean_line = [ys_orig.mean() for y in ys_orig]<br/>    squared_error_regr = squared_error(ys_orig, ys_line)<br/>    squared_error_y_mean = squared_error(ys_orig, y_mean_line)<br/>    return 1 - (squared_error_regr / squared_error_y_mean)</span><span id="d340" class="lp lq jj ll b gy ng ls l lt lu">def squared_error(ys_orig, ys_line):<br/>    return sum((ys_line - ys_orig) * (ys_line - ys_orig))</span><span id="b4e9" class="lp lq jj ll b gy ng ls l lt lu">r_squared = r2_score_from_scratch(y, y_pred)</span><span id="af0c" class="lp lq jj ll b gy ng ls l lt lu">print(r_squared)</span></pre><figure class="lf lg lh li gt iv gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/1d945794823b4bb6810812176eb81ff6.png" data-original-src="https://miro.medium.com/v2/resize:fit:390/format:webp/1*c15N4WJIp9fEmKijdiYZwg.png"/></div></figure><p id="11ca" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们可以利用 sklearn <code class="fe nk nl nm ll b">r2_score</code>函数，而不是每次都从头开始实现。</p><pre class="lf lg lh li gt lk ll lm ln aw lo bi"><span id="fa81" class="lp lq jj ll b gy lr ls l lt lu">r2_score(y, y_pred)</span></pre><figure class="lf lg lh li gt iv gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/1d945794823b4bb6810812176eb81ff6.png" data-original-src="https://miro.medium.com/v2/resize:fit:390/format:webp/1*c15N4WJIp9fEmKijdiYZwg.png"/></div></figure></div></div>    
</body>
</html>