<html>
<head>
<title>Estimating Non-linear Correlation in R</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">估计 R 中的非线性相关性</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/estimating-non-linear-correlation-in-r-62c6571cb1db?source=collection_archive---------6-----------------------#2019-04-19">https://towardsdatascience.com/estimating-non-linear-correlation-in-r-62c6571cb1db?source=collection_archive---------6-----------------------#2019-04-19</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="f42b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在本帖中，我们将学习在 r 中使用非线性相关估计函数。我们还将看几个例子。</p><h1 id="f30f" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">背景</h1><p id="7b63" class="pw-post-body-paragraph jn jo iq jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ij bi translated">相关估计通常用于各种数据挖掘应用中。根据我的经验，非线性相关在各种过程中相当普遍。由于这个原因，非线性模型，例如 SVM，被用于回归、分类等。然而，估计两个变量之间非线性相关性的方法并不多。</p><p id="f1f8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">通常估计线性相关性。然而，数据可能具有非线性相关性，但几乎没有线性相关性。在这种情况下，非线性相关变量有时会在高维数据的数据探索或变量选择过程中被忽略。</p><p id="231e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们开发了一种新的非线性相关估计量<code class="fe lo lp lq lr b">nlcor</code>。该估计器在数据探索和非线性预测模型(如 SVM)的变量选择中非常有用。</p><h1 id="41a1" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">安装<code class="fe lo lp lq lr b">nlcor</code></h1><p id="856e" class="pw-post-body-paragraph jn jo iq jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ij bi translated">要在 R 中安装<code class="fe lo lp lq lr b">nlcor</code>,请遵循以下步骤:</p><ol class=""><li id="c710" class="ls lt iq jp b jq jr ju jv jy lu kc lv kg lw kk lx ly lz ma bi translated">安装<a class="ae mb" href="https://github.com/hadley/devtools" rel="noopener ugc nofollow" target="_blank">开发工具</a>包。你可以从<a class="ae mb" href="https://cran.r-project.org/" rel="noopener ugc nofollow" target="_blank">曲柄</a>开始操作。您可以直接在 R 控制台中输入:</li></ol><pre class="mc md me mf gt mg lr mh mi aw mj bi"><span id="4599" class="mk km iq lr b gy ml mm l mn mo">&gt; install.packages("devtools")</span></pre><p id="112d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">2.加载 devtools 包。</p><pre class="mc md me mf gt mg lr mh mi aw mj bi"><span id="d7e7" class="mk km iq lr b gy ml mm l mn mo">&gt; library(devtools)<!-- --> </span></pre><p id="4afa" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">3.通过在 R 控制台中键入以下命令，从 GitHub 库中安装<code class="fe lo lp lq lr b">nlcor</code>。</p><pre class="mc md me mf gt mg lr mh mi aw mj bi"><span id="920b" class="mk km iq lr b gy ml mm l mn mo">&gt; install_github("ProcessMiner/nlcor")</span></pre><h1 id="7343" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">非线性相关估计量</h1><p id="f07b" class="pw-post-body-paragraph jn jo iq jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ij bi translated">在这个包中，我们提供了一个在<code class="fe lo lp lq lr b">nlcor</code>中使用自适应局部线性相关计算的非线性相关估计方法的实现。函数<code class="fe lo lp lq lr b">nlcor</code>返回非线性相关估计值、相应的调整后 p 值以及可视化非线性关系的可选图。</p><p id="9ce8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">相关估计将在 0 和 1 之间。该值越高，非线性相关性越强。与线性相关不同，负值在这里是无效的。由于多个局部相关计算，相关估计的净 p 值被调整(以避免假阳性)。该图显示了局部线性相关性。</p><p id="3a3a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">下面，我们将通过几个例子来展示它的用法。在给出的例子中，<code class="fe lo lp lq lr b">x</code>和<code class="fe lo lp lq lr b">y</code>之间的线性相关性很小，然而，它们之间存在可见的非线性相关性。该包包含这些示例的数据，可用于测试该包。</p><p id="7c2b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe lo lp lq lr b">nlcor</code>包有几个样本<code class="fe lo lp lq lr b">x</code>和<code class="fe lo lp lq lr b">y</code>向量，在下面的例子中演示。</p><p id="42cf" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">首先，我们将加载包。</p><pre class="mc md me mf gt mg lr mh mi aw mj bi"><span id="e194" class="mk km iq lr b gy ml mm l mn mo">&gt; library(nlcor)</span></pre><h2 id="d98a" class="mk km iq bd kn mp mq dn kr mr ms dp kv jy mt mu kz kc mv mw ld kg mx my lh mz bi translated">例 1。具有循环非线性相关性的数据。</h2><pre class="mc md me mf gt mg lr mh mi aw mj bi"><span id="2883" class="mk km iq lr b gy ml mm l mn mo">&gt; plot(x1, y1)</span></pre><figure class="mc md me mf gt nb gh gi paragraph-image"><div class="gh gi na"><img src="../Images/80bf5633c974d09226a23cb2053f6f97.png" data-original-src="https://miro.medium.com/v2/resize:fit:1152/format:webp/1*RN1ra-6BTkQI5cDkCGkRqQ.png"/></div></figure><p id="85b9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">数据的线性相关性是，</p><pre class="mc md me mf gt mg lr mh mi aw mj bi"><span id="04d2" class="mk km iq lr b gy ml mm l mn mo">&gt; cor(x1, y1)<br/>[1] 0.008001837</span></pre><p id="c7f8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">正如所料，相关性接近于零。我们使用<code class="fe lo lp lq lr b">nlcor</code>来估计非线性<br/>相关性。</p><pre class="mc md me mf gt mg lr mh mi aw mj bi"><span id="3202" class="mk km iq lr b gy ml mm l mn mo">&gt; c &lt;- nlcor(x1, y1, plt = T)<br/>&gt; c$cor.estimate<br/>[1] 0.8688784<br/>&gt; c$adjusted.p.value<br/>[1] 0<br/>&gt; print(c$cor.plot)</span></pre><figure class="mc md me mf gt nb gh gi paragraph-image"><div class="gh gi na"><img src="../Images/e7dbe489c1a53d5a4af5ae1aff442bf7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1152/format:webp/1*c_jgekAkYq7NZ_j8xSM-jA.png"/></div></figure><p id="2b02" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">该图显示了数据中存在的分段线性相关性。</p><h2 id="cceb" class="mk km iq bd kn mp mq dn kr mr ms dp kv jy mt mu kz kc mv mw ld kg mx my lh mz bi translated">例 2。具有非均匀分段线性相关性的数据。</h2><pre class="mc md me mf gt mg lr mh mi aw mj bi"><span id="d3a4" class="mk km iq lr b gy ml mm l mn mo">&gt; plot(x2, y2)</span></pre><figure class="mc md me mf gt nb gh gi paragraph-image"><div class="gh gi na"><img src="../Images/393e8c157bc7999ef5374d0363def040.png" data-original-src="https://miro.medium.com/v2/resize:fit:1152/format:webp/1*lXuw7XtKUAk7jmwvSBnhUQ.png"/></div></figure><p id="0940" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">数据的线性相关性是，</p><pre class="mc md me mf gt mg lr mh mi aw mj bi"><span id="3660" class="mk km iq lr b gy ml mm l mn mo">&gt; cor(x2, y2)<br/>[1] 0.828596</span></pre><p id="128b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这一数据的线性相关性相当高。然而，数据中存在<br/>显著且更高的非线性相关性。该<br/>数据模拟了一个点之后相关性改变其方向<br/>的场景。<strong class="jp ir">有时，变化点位于中间，导致<br/>线性相关性接近于零。</strong>此处我们展示了一个<br/>变化点偏离中心的例子，以表明该实施在<br/>非均匀情况下有效。</p><p id="4a2f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们使用<code class="fe lo lp lq lr b">nlcor</code>来估计非线性相关性。</p><pre class="mc md me mf gt mg lr mh mi aw mj bi"><span id="981e" class="mk km iq lr b gy ml mm l mn mo">&gt; c &lt;- nlcor(x2, y2, plt = T)<br/>&gt; c$cor.estimate<br/>[1] 0.897205<br/>&gt; c$adjusted.p.value<br/>[1] 0<br/>&gt; print(c$cor.plot)</span></pre><figure class="mc md me mf gt nb gh gi paragraph-image"><div class="gh gi na"><img src="../Images/bbf13e0cbbff1536722059d0def38543.png" data-original-src="https://miro.medium.com/v2/resize:fit:1152/format:webp/1*quXk_aYh6BR76HW6t4NTZA.png"/></div></figure><p id="5cb3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">从图中可以看出，<code class="fe lo lp lq lr b">nlcor</code>可以估计非均匀场景中的分段相关性。此外，非线性相关性高于线性相关性。</p><h2 id="8313" class="mk km iq bd kn mp mq dn kr mr ms dp kv jy mt mu kz kc mv mw ld kg mx my lh mz bi translated">例 3。具有更高和多个频率变化的数据。</h2><pre class="mc md me mf gt mg lr mh mi aw mj bi"><span id="b623" class="mk km iq lr b gy ml mm l mn mo">&gt; plot(x3, y3)</span></pre><figure class="mc md me mf gt nb gh gi paragraph-image"><div class="gh gi na"><img src="../Images/4a4f7361c2d9ea1f8b77c91963aa557a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1152/format:webp/1*i_emftu0FTlQg6AyP1Zz7g.png"/></div></figure><p id="77ed" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">数据的线性相关性是，</p><pre class="mc md me mf gt mg lr mh mi aw mj bi"><span id="c548" class="mk km iq lr b gy ml mm l mn mo">&gt; cor(x3, y3)<br/>[1] -0.1337304</span></pre><p id="76b8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">线性相关性预期很小，尽管由于某种线性<br/>而不接近零。</p><p id="ceb0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这里我们展示了我们可以细化相关性<br/>计算的粒度。</p><p id="0e5f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">默认设置下，<code class="fe lo lp lq lr b">nlcor</code>的输出为:</p><pre class="mc md me mf gt mg lr mh mi aw mj bi"><span id="d037" class="mk km iq lr b gy ml mm l mn mo">&gt; c &lt;- nlcor(x3, y3, plt = T)<br/>&gt; c$cor.estimate<br/>[1] 0.7090148<br/>&gt; c$adjusted.p.value<br/>[1] 0<br/>&gt; print(c$cor.plot)</span></pre><figure class="mc md me mf gt nb gh gi paragraph-image"><div class="gh gi na"><img src="../Images/b742f553c558b22b9fc10ffe71d2b059.png" data-original-src="https://miro.medium.com/v2/resize:fit:1152/format:webp/1*6cGoPvYKO1pFDDlBm3ydlg.png"/></div></figure><p id="7d18" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">从图中可以看出，<code class="fe lo lp lq lr b">nlcor</code>忽略了一些地方关系。我们可以通过改变<code class="fe lo lp lq lr b">refine</code>参数来改进相关估计。<code class="fe lo lp lq lr b">refine</code>的默认值设置为 0.5。可以设置为<code class="fe lo lp lq lr b">0</code>和<code class="fe lo lp lq lr b">1</code>之间的任意值。值越大，细化程度越高。</p><p id="0a5f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">但是，更高的细化会对 p 值产生不利影响。也就是说，得到的相关性估计在统计上可能是不重要的(类似于过度拟合)。因此，建议避免过度细化。</p><p id="3df4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">对于该数据，我们使用<code class="fe lo lp lq lr b">refine = 0.9</code>重新运行相关性估计。</p><pre class="mc md me mf gt mg lr mh mi aw mj bi"><span id="fad8" class="mk km iq lr b gy ml mm l mn mo">&gt; c &lt;- nlcor(x3, y3, refine = 0.9, plt = T)<br/>&gt; c$cor.estimate<br/>[1] 0.8534956<br/>&gt; c$adjusted.p.value<br/>[1] 2.531456e-06<br/>&gt; print(c$cor.plot)<br/>Warning: Removed 148 rows containing missing values (geom_path).</span></pre><figure class="mc md me mf gt nb gh gi paragraph-image"><div class="gh gi na"><img src="../Images/4ef776c147fd4b273293e7c701aac989.png" data-original-src="https://miro.medium.com/v2/resize:fit:1152/format:webp/1*sC_z_F3T7OsJbV182C0Lvw.png"/></div></figure><p id="cf48" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如图所示，<code class="fe lo lp lq lr b">nlcor</code>可以识别粒度分段相关性。在该数据中，p 值仍然非常小——相关性<em class="ne">具有统计显著性</em>。</p><h1 id="aaa4" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">摘要</h1><p id="d9a8" class="pw-post-body-paragraph jn jo iq jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ij bi translated">这个包提供了一种有效的启发式算法来计算数值向量之间的非线性相关性。启发式算法通过自适应地识别多个线性相关的局部区域来估计整体非线性相关。这里用几个例子来说明它的用法。</p><h1 id="1fcb" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">引用</h1><ul class=""><li id="f85c" class="ls lt iq jp b jq lj ju lk jy nf kc ng kg nh kk ni ly lz ma bi translated"><strong class="jp ir">打包‘nlcor’:计算非线性相关性</strong></li></ul><p id="b020" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae mb" href="http://twitter.com/article" rel="noopener ugc nofollow" target="_blank">@文章</a> {ranjan2020packagenlcor，<br/>title = { Package ' nlcor ':Compute Nonlinear Correlations }，<br/>作者={Ranjan，Chitta and Najari，Vahab}，<br/>期刊={Research Gate}，<br/>年份={2020}，<br/>doi = { 10.13140/rg . 2 . 2 . 33716 . 68480 }<br/>}</p><p id="7cc1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Chitta Ranjan 和 Vahab Najari。“软件包‘nlcor’:计算非线性相关性”。在:研究门(2020)。doi:10.13140/rg . 2 . 2 . 33716.68480</p><ul class=""><li id="24f6" class="ls lt iq jp b jq jr ju jv jy lu kc lv kg lw kk ni ly lz ma bi translated"><strong class="jp ir"> nlcor:非线性相关</strong></li></ul><p id="ff05" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae mb" href="http://twitter.com/article" rel="noopener ugc nofollow" target="_blank">@ article</a>{ ran Jan 2019 nlcor，<br/> title={nlcor:非线性相关}，<br/> author={Ranjan，Chitta and Najari，Vahab}，<br/> journal={Research Gate}，<br/> year={2019}，<br/>doi = { 10.13140/rg . 2 . 2 . 10123 . 72488 }<br/>}</p><p id="ba4d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Chitta Ranjan 和 Vahab Najari。“nlcor:非线性相关”。In:研究门(2019)。doi:10.13140/RG</p></div></div>    
</body>
</html>