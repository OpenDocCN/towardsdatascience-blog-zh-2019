<html>
<head>
<title>Why NOT to select features before splitting your data</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">为什么不在分割数据之前选择要素</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/why-not-to-select-features-before-splitting-your-data-2d6aba2e9fb?source=collection_archive---------10-----------------------#2019-07-04">https://towardsdatascience.com/why-not-to-select-features-before-splitting-your-data-2d6aba2e9fb?source=collection_archive---------10-----------------------#2019-07-04</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="54cf" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用编码示例解释交叉验证的正确和错误方式</h2></div><p id="6e97" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">想象一下:一名斯坦福大学的博士生试图利用基因数据预测一种罕见心脏病的发生。该学生为 50 名患者收集了超过 10 万个基因表达数据(预测值)。然后，该学生从 10 万个预测者中挑选出最好的 100 个作为“初步筛选”的一部分，使用交叉验证将统计模型仅拟合到 100 个筛选的预测者，并报告准确率超过 65%(这对罕见的心脏病来说是一件大事)。听起来不错？</p><p id="2f8b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">不！</strong></p><p id="498b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这位学生对最近应用统计学中的一个危险趋势做出了贡献，即使用交叉验证来呈现他们的研究中高度偏颇的精选结果。重要的是不仅要了解学生错在哪里，还要了解他们为什么也会掉进这个陷阱。事实上，他们已经“窥视”了他们的验证集，甚至没有意识到这一点。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi le"><img src="../Images/0246a899e2304a3669a09e8b57faf828.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*LiU-yyx-AeDFrjt_.jpg"/></div></div><figcaption class="lq lr gj gh gi ls lt bd b be z dk">Don’t peek into your validation/test data</figcaption></figure><p id="89ae" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在本文中，您将学习-</p><ol class=""><li id="c4d2" class="lu lv it kk b kl km ko kp kr lw kv lx kz ly ld lz ma mb mc bi translated">快速识别可疑的统计研究，这些研究声称在初步筛选特征后进行了“独立验证”</li><li id="1ce0" class="lu lv it kk b kl md ko me kr mf kv mg kz mh ld lz ma mb mc bi translated">以正确的方式进行交叉验证</li><li id="817d" class="lu lv it kk b kl md ko me kr mf kv mg kz mh ld lz ma mb mc bi translated">在 R 笔记本上练习实现它</li></ol></div><div class="ab cl mi mj hx mk" role="separator"><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn"/></div><div class="im in io ip iq"><p id="c05a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi mp translated"><span class="l mq mr ms bm mt mu mv mw mx di">随着机器学习在收集数据的几乎每个领域的爆炸式增长，人们越来越多地找到了快速训练和部署现成模型的方法，而无需完全理解它们背后的算法。仅用一行代码就能让机器学习库“容易”实现的最新趋势只会增加问题。因为这些捷径，我们不时会遇到可能出错的例子，比如斯坦福学生的例子。</span></p><p id="be26" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">那个学生并不孤单——错误估计的交叉验证错误偶尔也会出现在一些高知名度的学术期刊上。事实上，一整篇文章都致力于在美国国家科学院学报上记录这种选择偏差的例子。所以，让我们来看看上面的例子中到底哪里出错了。</p><h2 id="6a1d" class="na nb it bd nc nd ne dn nf ng nh dp ni kr nj nk nl kv nm nn no kz np nq nr ns bi translated">交叉验证:错误的方式</h2><p id="6dcb" class="pw-post-body-paragraph ki kj it kk b kl nt ju kn ko nu jx kq kr nv kt ku kv nw kx ky kz nx lb lc ld im bi translated">在上面的例子中，学生<strong class="kk iu">使用所有的例子(患者)来筛选预测因子</strong>，而不是将他们自己仅仅限制在训练折叠中。由于他们正在处理一个广泛的数据集——特征数量(基因)&gt; &gt;样本数量(患者)——执行特征选择以缩小到基因子集是一个自然的选择。这实际上也是防止模型过度拟合的有价值的步骤。但是通常情况下，筛选是在项目的早期阶段进行的，导致人们在使用交叉验证建模时忘记了它。如果我们使用所有的例子来选择我们的预测器(图 1)，模型甚至在预测之前就已经“窥视”到验证集了。因此，交叉验证的准确性必然比真正的模型准确性高得多。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi ny"><img src="../Images/0f81e9c1d38ef0d14d9e0332e037d137.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZMh6BTGscEa_DXlGnzWvyQ.png"/></div></div><figcaption class="lq lr gj gh gi ls lt bd b be z dk">Fig. 1. | The wrong way to perform cross-validation. Notice how the folds are restricted only to the selected predictors.</figcaption></figure><p id="53ba" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">下面是一个交叉验证陷阱的工作示例，我们在预测像掷硬币这样真正随机的事情时获得了 99%的准确率！完整的 R 笔记本也可以在<a class="ae my" href="https://gist.github.com/kkraoj/94ec4653a96bad5127affedbf61658e4" rel="noopener ugc nofollow" target="_blank">这里</a>买到。</p><figure class="lf lg lh li gt lj"><div class="bz fp l di"><div class="nz oa l"/></div></figure><h2 id="8692" class="na nb it bd nc nd ne dn nf ng nh dp ni kr nj nk nl kv nm nn no kz np nq nr ns bi translated">交叉验证:正确的方法</h2><p id="25fb" class="pw-post-body-paragraph ki kj it kk b kl nt ju kn ko nu jx kq kr nv kt ku kv nw kx ky kz nx lb lc ld im bi translated">另一方面，如果我们运行与上面相同的模型，但是<strong class="kk iu">只使用训练折叠来筛选预测器，</strong>我们将有一个更好的模型真实误差的表示。分割数据的正确方式如图 2 所示。在这种情况下，同一个模型的交叉验证准确率为 46%，或者换句话说，该模型在预测抛硬币时的正确率不到一半。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi ob"><img src="../Images/d70835716e0a6209f89c4111b04d8fd8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WrA5WikcYtCFXEf8ijElqA.png"/></div></div><figcaption class="lq lr gj gh gi ls lt bd b be z dk">Fig. 2 | The right way to cross-validated. Notice how the validation fold is separated before selecting the features</figcaption></figure><figure class="lf lg lh li gt lj"><div class="bz fp l di"><div class="nz oa l"/></div></figure><h2 id="9425" class="na nb it bd nc nd ne dn nf ng nh dp ni kr nj nk nl kv nm nn no kz np nq nr ns bi translated">经验教训</h2><p id="0951" class="pw-post-body-paragraph ki kj it kk b kl nt ju kn ko nu jx kq kr nv kt ku kv nw kx ky kz nx lb lc ld im bi translated">在本文中，我们学会了以正确的方式进行特征筛选，而不是落入交叉验证陷阱。要复习，记得-</p><ol class=""><li id="f65f" class="lu lv it kk b kl km ko kp kr lw kv lx kz ly ld lz ma mb mc bi translated">仅将训练数据(或训练折叠)用于特征筛选或任何其他数据操作</li><li id="dc12" class="lu lv it kk b kl md ko me kr mf kv mg kz mh ld lz ma mb mc bi translated">在对同一验证集进行预测时，不要使用模型可以从中受益的验证集中的任何信息。验证应该总是独立的。</li></ol><p id="5d27" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">至于那个严重高估了他们模型预测心脏病准确性的斯坦福学生呢？幸运的是，在将他们的错误公之于众并误导医学协会之前，这位学生遇到了罗布·提布拉尼(我的教授)。如果你想听听 Rob 自己是怎么说的，这里有他的<a class="ae my" href="https://www.youtube.com/watch?v=S06JpVoNaA0" rel="noopener ugc nofollow" target="_blank">视频</a>。</p></div></div>    
</body>
</html>