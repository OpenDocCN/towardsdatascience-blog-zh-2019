<html>
<head>
<title>Fastest Way to Install &amp; Load Libraries in R</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在 R 中安装和加载库的最快方法</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/fastest-way-to-install-load-libraries-in-r-f6fd56e3e4c4?source=collection_archive---------15-----------------------#2019-08-29">https://towardsdatascience.com/fastest-way-to-install-load-libraries-in-r-f6fd56e3e4c4?source=collection_archive---------15-----------------------#2019-08-29</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="07d7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在与一位同学合作之后，很明显我需要一种新的方式来加载我在学校学到的库。不是每个人都安装了相同的库，这可能会出错。我希望代码能为每个人无缝运行。此外，不得不反复编写相同的函数来安装和加载不同的库是很痛苦的。我和我的同学努力寻找一种简单的方法来做到这一点。然后我使用了一个名为<a class="ae kl" href="https://cran.r-project.org/web/packages/tictoc/index.html" rel="noopener ugc nofollow" target="_blank"> tictoc </a>的包来测量不同方法的速度。</p><p id="7273" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">注意:测试是在干净的全球环境中进行的。所有的包都已经被安装和加载了，所以测试可以保持一致(包会被重新加载)。</p><p id="7912" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">首先，为了进行分析，需要安装和加载 tictoc 包。我还将为要加载的包列表定义一个变量。</p><pre class="km kn ko kp gt kq kr ks kt aw ku bi"><span id="1400" class="kv kw iq kr b gy kx ky l kz la">install.packages("tictoc")<br/>library(tictoc)</span><span id="1ae3" class="kv kw iq kr b gy lb ky l kz la">packages &lt;- c("tidyverse", "dplyr", "stringr", "zoo", "ROCR", "caret", "class", "gmodels", "randomForest")</span></pre><p id="c4c2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">方法 1 —分别加载和安装每个库:</strong></p><p id="6a53" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="lc">我注释掉了 install.packages，因为不管这个包是否存在，它都会重新安装。这不是最有效的方法，因为如果省略 install.packages 并且该软件包在当前安装中不存在，您将重新安装所有内容或得到一个错误。</em></p><p id="ed8c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">总时间:0.11 秒</p><pre class="km kn ko kp gt kq kr ks kt aw ku bi"><span id="822e" class="kv kw iq kr b gy kx ky l kz la">tic("basic")</span><span id="1043" class="kv kw iq kr b gy lb ky l kz la">#install.packages(packages)<br/>library(tidyverse)<br/>library(dplyr)<br/>library(stringr)<br/>library(zoo)<br/>library(ROCR)<br/>library(caret)<br/>library(class)<br/>library(gmodels)<br/>library(randomForest)</span><span id="ab98" class="kv kw iq kr b gy lb ky l kz la">toc(log = TRUE)<br/>log.txt &lt;- tic.log(format = TRUE)</span></pre><p id="f4a2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">方法 2——使用 for 循环</strong></p><p id="1452" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">总时间:0.13 秒</p><pre class="km kn ko kp gt kq kr ks kt aw ku bi"><span id="3ddd" class="kv kw iq kr b gy kx ky l kz la">tic("for loop")</span><span id="2c2b" class="kv kw iq kr b gy lb ky l kz la">libraries &lt;- function(packages){<br/>  for(package in packages){<br/>    #checks if package is installed<br/>    if(!require(package, character.only = TRUE)){<br/>      #If package does not exist, then it will install<br/>      install.packages(package, dependencies = TRUE)<br/>      #Loads package<br/>      library(package, character.only = TRUE)<br/>    }<br/>  }<br/>}</span><span id="6c5c" class="kv kw iq kr b gy lb ky l kz la">libraries(packages)</span><span id="ac18" class="kv kw iq kr b gy lb ky l kz la">toc(log = TRUE)<br/>log.txt &lt;- tic.log(format = TRUE)</span></pre><p id="ee60" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">方法 3 —使用应用方法</strong></p><p id="beb9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">总时间:0.07 秒</p><pre class="km kn ko kp gt kq kr ks kt aw ku bi"><span id="98cf" class="kv kw iq kr b gy kx ky l kz la">tic("apply")</span><span id="c5b3" class="kv kw iq kr b gy lb ky l kz la">ipak &lt;- function(pkg){<br/>  new.pkg &lt;- pkg[!(pkg %in% installed.packages()[, "Package"])]<br/>  if (length(new.pkg))<br/>    install.packages(new.pkg, dependencies = TRUE)<br/>  sapply(pkg, require, character.only = TRUE)<br/>}</span><span id="b147" class="kv kw iq kr b gy lb ky l kz la">ipak(packages)</span><span id="faaa" class="kv kw iq kr b gy lb ky l kz la">toc(log = TRUE)<br/>log.txt &lt;- tic.log(format = TRUE)</span></pre><p id="bf5e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">方法 4 —使用</strong><a class="ae kl" href="https://cran.r-project.org/web/packages/install.load/README.html" rel="noopener ugc nofollow" target="_blank"><strong class="jp ir">install . load</strong></a><strong class="jp ir">包</strong></p><p id="6c63" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="lc">在这篇文章中，我假设用户已经安装了 install.load 来计算时间，因为这只会发生一次。要安装的代码只是出于可复制性的目的。</em></p><p id="0e18" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">总时间:0.12 秒</p><pre class="km kn ko kp gt kq kr ks kt aw ku bi"><span id="410b" class="kv kw iq kr b gy kx ky l kz la">tic("install.load")</span><span id="85cc" class="kv kw iq kr b gy lb ky l kz la">if (!require("install.load")) install.packages("install.load")<br/>library(install.load)</span><span id="c23b" class="kv kw iq kr b gy lb ky l kz la">install_load(packages)</span><span id="fffe" class="kv kw iq kr b gy lb ky l kz la">toc(log = TRUE)<br/>log.txt &lt;- tic.log(format = TRUE)</span></pre><p id="9150" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">方法 5——使用</strong> <a class="ae kl" href="https://cran.r-project.org/web/packages/pacman/index.html" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir">吃豆人</strong> </a> <strong class="jp ir">包</strong></p><p id="c562" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="lc">这也是在假设用户已经安装了 pacman 的情况下计算的。</em></p><p id="f506" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">总时间:0.06 秒</p><pre class="km kn ko kp gt kq kr ks kt aw ku bi"><span id="67bb" class="kv kw iq kr b gy kx ky l kz la">tic("pacman")</span><span id="70db" class="kv kw iq kr b gy lb ky l kz la">if (!require("pacman")) install.packages("pacman")<br/>#pacman will not accept a character vector so the same packages are repeated<br/>pacman::p_load("tidyverse", "dplyr", "stringr", "zoo", "ROCR", "caret", "class", "gmodels", "randomForest")</span><span id="a551" class="kv kw iq kr b gy lb ky l kz la">toc(log = TRUE)<br/>log.txt &lt;- tic.log(format = TRUE)</span></pre><p id="fa04" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">最终判决</strong></p><p id="dc47" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">安装和/或加载许多软件包的最快方法是使用 pacman 软件包。但是，如果您不想安装额外的软件包，最好使用 apply 方法。它只是稍微慢了一点。</p><p id="fe6c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">值得一提的是，对于“基本”测试，如果用户不确定他们当前已经安装的软件包，由于上面提到的原因，这种方法会变得非常慢。</p><figure class="km kn ko kp gt le gh gi paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><div class="gh gi ld"><img src="../Images/3c92efb4c28a2a31dd0c5543e0d33352.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DNlLvQA2qi1K3MKvevcGGA.png"/></div></div></figure></div></div>    
</body>
</html>