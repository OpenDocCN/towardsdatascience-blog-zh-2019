<html>
<head>
<title>A demonstration of carrying data analysis (New York City Airbnb Open Data)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">携带数据分析演示(纽约市 Airbnb 开放数据)</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/a-demonstration-of-carrying-data-analysis-new-york-city-airbnb-open-data-a02d0ce8292d?source=collection_archive---------15-----------------------#2019-09-25">https://towardsdatascience.com/a-demonstration-of-carrying-data-analysis-new-york-city-airbnb-open-data-a02d0ce8292d?source=collection_archive---------15-----------------------#2019-09-25</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="0014" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在本文中，我将使用 Python 执行数据分析，并记录分析过程中的每个发现和想法。用真实数据练习不仅可以帮助我在分析不同数据时有更多的经验，还可以帮助我在与他人的作品进行比较时发现更多的技术和技能。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/bf3886bd874d5d30aa0f232e73c2d4b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ueHk-7z2dNo8zyRD"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk">Photo by <a class="ae le" href="https://unsplash.com/@ojnibl?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Oliver Niblett</a> on <a class="ae le" href="https://unsplash.com/s/photos/new-york?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="fad9" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">本文使用的数据集是来自 Kaggle 的“纽约市 Airbnb 开放数据”。下面是下载链接<a class="ae le" href="https://www.kaggle.com/dgomonov/new-york-city-airbnb-open-data" rel="noopener ugc nofollow" target="_blank">https://www . ka ggle . com/dgomonov/new-York-city-Airbnb-open-data</a></p><p id="1a26" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">导入模块和 csv 文件后，通常我的第一步是浏览数据集。这一步包括研究整个数据集的格式、所有变量的类型、检查和清理数据集。</p><pre class="kp kq kr ks gt lf lg lh li aw lj bi"><span id="a4ac" class="lk ll it lg b gy lm ln l lo lp">data = pd.read_csv('AB_NYC_2019.csv')<br/>data.info()</span><span id="03f8" class="lk ll it lg b gy lq ln l lo lp">class 'pandas.core.frame.DataFrame'&gt;<br/>RangeIndex: 48895 entries, 0 to 48894<br/>Data columns (total 16 columns):<br/>id                                48895 non-null int64<br/>name                              48879 non-null object<br/>host_id                           48895 non-null int64<br/>host_name                         48874 non-null object<br/>neighbourhood_group               48895 non-null object<br/>neighbourhood                     48895 non-null object<br/>latitude                          48895 non-null float64<br/>longitude                         48895 non-null float64<br/>room_type                         48895 non-null object<br/>price                             48895 non-null int64<br/>minimum_nights                    48895 non-null int64<br/>number_of_reviews                 48895 non-null int64<br/>last_review                       38843 non-null object<br/>reviews_per_month                 38843 non-null float64<br/>calculated_host_listings_count    48895 non-null int64<br/>availability_365                  48895 non-null int64<br/>dtypes: float64(3), int64(7), object(6)<br/>memory usage: 6.0+ MB</span></pre><p id="141c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">所以总共有 16 列，有些列有缺失值。</p><pre class="kp kq kr ks gt lf lg lh li aw lj bi"><span id="fe8b" class="lk ll it lg b gy lm ln l lo lp">data.isnull().sum()</span><span id="36fe" class="lk ll it lg b gy lq ln l lo lp">id                                    0<br/>name                                 16<br/>host_id                               0<br/>host_name                            21<br/>neighbourhood_group                   0<br/>neighbourhood                         0<br/>latitude                              0<br/>longitude                             0<br/>room_type                             0<br/>price                                 0<br/>minimum_nights                        0<br/>number_of_reviews                     0<br/>last_review                       10052<br/>reviews_per_month                 10052<br/>calculated_host_listings_count        0<br/>availability_365                      0<br/>dtype: int64</span></pre><p id="a65e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在数据集中，last_review 和 reviews_per_month 都有超过 10k 的缺失值。它们也有相同数量的缺失值。根据缺失值的名称和数量，我怀疑这两列是相关的，因此缺失值的数量相同。</p><pre class="kp kq kr ks gt lf lg lh li aw lj bi"><span id="5fbf" class="lk ll it lg b gy lm ln l lo lp">(data['last_review'].isnull()==data['reviews_per_month'].isnull()).all()</span><span id="ff27" class="lk ll it lg b gy lq ln l lo lp">True</span></pre><p id="65bf" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">所以应该一起处理。</p><p id="0024" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">此时，我不知道如何处理“last_review”列中缺少的值，因为这通常显示一个日期字符串，指示上次审查的日期。所以此时此刻，我会先把它放在一边。</p><p id="8455" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">但是，对于 reviews_per_month 中缺失的值，我会将它们赋为零。</p><pre class="kp kq kr ks gt lf lg lh li aw lj bi"><span id="6ed7" class="lk ll it lg b gy lm ln l lo lp">data.loc[data['reviews_per_month'].isnull(),'reviews_per_month']=0</span></pre><p id="a062" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">其余缺少值的列是 name 和 host_name。但是，我觉得无论从名字还是 host_name 都没有任何预测力。因此，我将直接从数据集中删除，而不是处理丢失的值。</p><p id="d2af" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">有两列，id 和 host_id，表示 Airbnb 的房子和主人。检查后，id 在数据集中是唯一的，但 host_id 不是。因此，可以删除 id，但不能删除 host_id。此外，如果房源数量和价格之间存在任何关系，这也是有意义的。因此将保留 host_id。</p><p id="ac5b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">下一步是使用</p><pre class="kp kq kr ks gt lf lg lh li aw lj bi"><span id="58a1" class="lk ll it lg b gy lm ln l lo lp">data.describe()</span></pre><p id="f059" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">使用 describe()可以帮助我理解每个变量的可能值的范围。我可以知道值的分布。此外，从数据集中发现任何不现实的记录也是可能的。</p><p id="6fc2" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">例如在这个数据集中，有一些异常。第一个是存在“价格”= 0 的记录，这是不现实的，因为这意味着不需要支付住宿费用。所以这些记录应该被删除。</p><p id="4227" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">第二个是“minimum_nights”最高 1250 我认为不现实(这还是 Airbnb 还是只是另一个租房合同？).我把阈值定为 365 天。“minimum_nights”大于 365 的任何记录也将被删除。</p><p id="8341" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">清理后的数据集:</p><pre class="kp kq kr ks gt lf lg lh li aw lj bi"><span id="0616" class="lk ll it lg b gy lm ln l lo lp">data.info()</span><span id="bc1b" class="lk ll it lg b gy lq ln l lo lp">&lt;class 'pandas.core.frame.DataFrame'&gt;<br/>RangeIndex: 48870 entries, 0 to 48869<br/>Data columns (total 12 columns):<br/>host_id                           48870 non-null int64<br/>neighbourhood_group               48870 non-null object<br/>neighbourhood                     48870 non-null object<br/>latitude                          48870 non-null float64<br/>longitude                         48870 non-null float64<br/>room_type                         48870 non-null object<br/>price                             48870 non-null int64<br/>minimum_nights                    48870 non-null int64<br/>number_of_reviews                 48870 non-null int64<br/>reviews_per_month                 48870 non-null float64<br/>calculated_host_listings_count    48870 non-null int64<br/>availability_365                  48870 non-null int64<br/>dtypes: float64(3), int64(6), object(3)<br/>memory usage: 4.5+ MB</span></pre><p id="d8fa" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">48870 行和 12 列</p><p id="5d56" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">现在我可以看看数据集了。一次一列</p><p id="8242" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">第一个是邻里群体</p><pre class="kp kq kr ks gt lf lg lh li aw lj bi"><span id="12b5" class="lk ll it lg b gy lm ln l lo lp">set(data['neighbourhood_group'])</span><span id="474a" class="lk ll it lg b gy lq ln l lo lp">{'Bronx', 'Brooklyn', 'Manhattan', 'Queens', 'Staten Island'}</span><span id="4836" class="lk ll it lg b gy lq ln l lo lp">data.groupby('neighbourhood_group')['price'].describe()</span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi lr"><img src="../Images/c308edc147b9eb91cb099efcdb1a00a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5qLjSOGOqIuRGxfDkguHiQ.png"/></div></div></figure><p id="fb91" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">该表很容易显示每个邻域组和所有邻域组的价格分布。Airbnb 的数量不是偶数。大多数 Airbnb 的房子要么在曼哈顿，要么在布鲁克林。不过这两个区域也是五个区域中价格最高的。一个可能的原因是，因为这些地区的需求很高，导致更多的主人出租他们的房间或公寓。</p><p id="b3fe" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">为了更准确地显示价格，考虑到房型，我们进行了进一步的细分。</p><pre class="kp kq kr ks gt lf lg lh li aw lj bi"><span id="b304" class="lk ll it lg b gy lm ln l lo lp">data.pivot_table(index='neighbourhood_group',columns='room_type',values='price',aggfunc='mean')</span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi ls"><img src="../Images/4fa7ffd1b02fa312aea04f48c91dc25f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1052/format:webp/1*XOOF4AYZ9xoFYEmoT02taw.png"/></div></figure><p id="9072" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">一般来说，你可以在布鲁克林租到一个单间，但在曼哈顿你甚至租不起一个合住的房间。</p><p id="107d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">接下来是 Airbnb 的位置。众所周知，曼哈顿和布鲁克林有更多的 Airbnb。这里我用一张热图来呈现。</p><pre class="kp kq kr ks gt lf lg lh li aw lj bi"><span id="237b" class="lk ll it lg b gy lm ln l lo lp">ny_map = folium.Map(location=[40.7, -74],zoom_start =10)<br/>data_loc= data[['latitude','longitude']].values<br/>data_loc =data_loc.tolist()<br/>hm = plugins.HeatMap(data_loc)<br/>hm.add_to(ny_map)<br/>ny_map</span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi lt"><img src="../Images/8089807c535eb4902b32e4316936f592.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2ZmMF1BcKu_rfMjAXg1I8g.png"/></div></div></figure><p id="6290" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">曼哈顿和布鲁克林有一大片红色区域。</p><p id="b185" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">是时候进一步细分各个小区了。</p><pre class="kp kq kr ks gt lf lg lh li aw lj bi"><span id="10c5" class="lk ll it lg b gy lm ln l lo lp">for gp in set(data['neighbourhood_group']):  </span><span id="dd76" class="lk ll it lg b gy lq ln l lo lp">print(data.loc[data['neighbourhood_group']==gp,].groupby(['neighbour   hood_group','neighbourhood']).agg({'price':['count','mean']}).sort_values(by=('price', 'mean'),ascending=False).head())<br/>print()</span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi lu"><img src="../Images/db088224eb83b016eace6f964ae9374a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1148/format:webp/1*nqgJz2p_stgbcQCIiIN6aw.png"/></div></figure><p id="f104" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">上表显示了每组中前 5 名最昂贵的社区。除了 Staten Island 在某些邻居中只有 1 条记录是 top 5 neighbors 之外，其他邻居都有足够的记录来正确表示每个地区的平均价格。布朗克斯的河谷镇和曼哈顿一样贵。</p><p id="7716" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">下一个要研究的变量是“最低夜数”。第一个变量是按“邻居组”细分的</p><pre class="kp kq kr ks gt lf lg lh li aw lj bi"><span id="7f5b" class="lk ll it lg b gy lm ln l lo lp">data.groupby('neighbourhood_group')['minimum_nights'].describe()</span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi lv"><img src="../Images/e6a115fe1443d615c7e7560e3fcab731.png" data-original-src="https://miro.medium.com/v2/resize:fit:1294/format:webp/1*4CJ4bMiqxUqEm1GnG1EEtQ.png"/></div></figure><p id="d0a7" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">由于所有“minimum_nights”大于 365 的记录都已被删除，因此最大值仅为 365。如图所示，超过 25%的 Airbnb place 只需要 1 晚，超过一半的 Airbnb place 只需要 2 或 3 晚，这符合 Airbnb 服务的最初原则，即短期住宿。</p><p id="457f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">现在我们可以转到下一个变量，视图。我会使用每月评论数而不是评论数，因为这样可以消除 Airbnb 上持续时间列表的影响。</p><pre class="kp kq kr ks gt lf lg lh li aw lj bi"><span id="efba" class="lk ll it lg b gy lm ln l lo lp">for gp in set(data['neighbourhood_group']):<br/>print(gp)<br/>print(data[data['neighbourhood_group']==gp]    ['price','reviews_per_month']].corr())<br/>print()</span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi lw"><img src="../Images/b00cff23f1ee20324f61ab536fa69672.png" data-original-src="https://miro.medium.com/v2/resize:fit:950/format:webp/1*w3l01jCFt4cX1st02_VlBQ.png"/></div></figure><p id="ba64" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">显然，价格和每月的评论数量之间没有关系。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi lx"><img src="../Images/154b3a852624facbf5bbe7b8977a55eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1046/format:webp/1*yFZDT-sVzhpjQSCkETFpxA.png"/></div></figure><p id="e61f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">相反，几乎所有的房子每个月都只有很少的评论。</p></div><div class="ab cl ly lz hx ma" role="separator"><span class="mb bw bk mc md me"/><span class="mb bw bk mc md me"/><span class="mb bw bk mc md"/></div><div class="im in io ip iq"><p id="4dd9" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">分析到此结束。希望您喜欢，并请与我分享您的评论，以便我可以不断改进，并在未来使用 Python 演示更多的数据分析。下次见。</p><p id="bae6" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">完整的代码可以在<a class="ae le" href="https://github.com/wyfok/New_York_City_Airbnb_Open_Data" rel="noopener ugc nofollow" target="_blank">https://github.com/wyfok/New_York_City_Airbnb_Open_Data</a>找到</p></div></div>    
</body>
</html>