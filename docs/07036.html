<html>
<head>
<title>Conditional Independence — The Backbone of Bayesian Networks</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">条件独立性——贝叶斯网络的支柱</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/conditional-independence-the-backbone-of-bayesian-networks-85710f1b35b?source=collection_archive---------3-----------------------#2019-10-05">https://towardsdatascience.com/conditional-independence-the-backbone-of-bayesian-networks-85710f1b35b?source=collection_archive---------3-----------------------#2019-10-05</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="4c15" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">条件独立性直觉、推导和例子</h2></div><p id="e9ec" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">有时候维基百科里的解释并不是最容易理解的。</p></div><div class="ab cl le lf hx lg" role="separator"><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj"/></div><div class="im in io ip iq"><figure class="lm ln lo lp gt lq gh gi paragraph-image"><div role="button" tabindex="0" class="lr ls di lt bf lu"><div class="gh gi ll"><img src="../Images/2101b0dd751ce27e35eda33887f20e78.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IBCqtMa3JylLmZZmEUI8WQ.png"/></div></div><figcaption class="lx ly gj gh gi lz ma bd b be z dk">From <a class="ae mb" href="https://en.wikipedia.org/wiki/Conditional_independence" rel="noopener ugc nofollow" target="_blank">https://en.wikipedia.org/wiki/Conditional_independence</a></figcaption></figure></div><div class="ab cl le lf hx lg" role="separator"><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj"/></div><div class="im in io ip iq"><h1 id="3020" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">1.条件独立性的直觉</h1><p id="5a9d" class="pw-post-body-paragraph ki kj it kk b kl mu ju kn ko mv jx kq kr mw kt ku kv mx kx ky kz my lb lc ld im bi translated">假设<strong class="kk iu"> A </strong>是<strong class="kk iu">孩子的身高</strong>而<strong class="kk iu"> B </strong>是<strong class="kk iu">孩子认识的单词数</strong>。似乎当<strong class="kk iu"> A </strong>为高时，<strong class="kk iu"> B </strong>也为高。</p><p id="cca0" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">有<strong class="kk iu">一条信息会让 A 和 B 完全独立。</strong>那会是什么？</p><blockquote class="mz"><p id="4ca9" class="na nb it bd nc nd ne nf ng nh ni ld dk translated">孩子的年龄。</p></blockquote><p id="a4d7" class="pw-post-body-paragraph ki kj it kk b kl nj ju kn ko nk jx kq kr nl kt ku kv nm kx ky kz nn lb lc ld im bi translated">孩子知道的身高和单词数<strong class="kk iu">不是独立的</strong>，但如果你提供孩子的年龄，它们是<strong class="kk iu">有条件独立的</strong>。</p><h1 id="8611" class="mc md it bd me mf no mh mi mj np ml mm jz nq ka mo kc nr kd mq kf ns kg ms mt bi translated">2.数学形式</h1><figure class="lm ln lo lp gt lq gh gi paragraph-image"><div role="button" tabindex="0" class="lr ls di lt bf lu"><div class="gh gi nt"><img src="../Images/678140f65f28db8f8c06a2218c4b7b54.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NDYd6zIqPyUbGPL4-_I4zQ.png"/></div></div></figure><pre class="lm ln lo lp gt nu nv nw nx aw ny bi"><span id="1885" class="nz md it nv b gy oa ob l oc od"><strong class="nv iu">A</strong>: The height of a child<br/><strong class="nv iu">B</strong>: The # of words that the child knows<br/><strong class="nv iu">C</strong>: The child's age</span></pre><p id="c272" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">记住这句话的更好方法是:</p><figure class="lm ln lo lp gt lq gh gi paragraph-image"><div role="button" tabindex="0" class="lr ls di lt bf lu"><div class="gh gi oe"><img src="../Images/aea65435c8eb718bab6f122c2ea65625.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EuHD5NO9vzIbG-KToFWc4g.png"/></div></div></figure><p id="315c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">条件独立性基本上就是独立性的概念<strong class="kk iu"> P(A ∩ B) = P(A) * P(B) </strong>应用于条件模型。</p></div><div class="ab cl le lf hx lg" role="separator"><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj"/></div><div class="im in io ip iq"><blockquote class="of og oh"><p id="4b60" class="ki kj oi kk b kl km ju kn ko kp jx kq oj ks kt ku ok kw kx ky ol la lb lc ld im bi translated">但是我见过<strong class="kk iu">的定义不仅有 P(A ∩ B|C)还有 P(A|B ∩ C)！</strong></p></blockquote><figure class="lm ln lo lp gt lq gh gi paragraph-image"><div role="button" tabindex="0" class="lr ls di lt bf lu"><div class="gh gi om"><img src="../Images/ccf80ce18932499e13268982eea166fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7iU08wOZta2FfLdsewznfA.png"/></div></div></figure><blockquote class="of og oh"><p id="04ca" class="ki kj oi kk b kl km ju kn ko kp jx kq oj ks kt ku ok kw kx ky ol la lb lc ld im bi translated"><strong class="kk iu">为什么当(Aㅛ B)|C 时，P(A|B ∩ C) = P(A|C)？</strong></p></blockquote><p id="8de0" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">证据来了。</p><figure class="lm ln lo lp gt lq gh gi paragraph-image"><div role="button" tabindex="0" class="lr ls di lt bf lu"><div class="gh gi on"><img src="../Images/a7a332374d59f87a524455fc82aed33b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tCVi_WawSNdVHovSGiT2rA.png"/></div></div></figure><p id="4771" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">条件独立的要旨:<strong class="kk iu">知道 C 使 A 和 B 独立。</strong></p><pre class="lm ln lo lp gt nu nv nw nx aw ny bi"><span id="39c9" class="nz md it nv b gy oa ob l oc od">P(A,B|<strong class="nv iu">C</strong>) = P(A|<strong class="nv iu">C</strong>) * P(B|<strong class="nv iu">C</strong>)</span></pre></div><div class="ab cl le lf hx lg" role="separator"><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj"/></div><div class="im in io ip iq"><h1 id="5c7a" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">3.应用程序🔥</h1><p id="7b30" class="pw-post-body-paragraph ki kj it kk b kl mu ju kn ko mv jx kq kr mw kt ku kv mx kx ky kz my lb lc ld im bi translated">为什么有条件的独立很重要？</p><p id="56e6" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">因为它是我们使用的许多统计模型的基础。(例如，潜在类别模型、因素分析、图形模型等。)</p><h2 id="47a5" class="nz md it bd me oo op dn mi oq or dp mm kr os ot mo kv ou ov mq kz ow ox ms oy bi translated">A.<a class="ae mb" href="https://en.wikipedia.org/wiki/Bayesian_network" rel="noopener ugc nofollow" target="_blank">贝叶斯网络</a>(又名图形模型)中的条件独立性</h2><p id="6b1d" class="pw-post-body-paragraph ki kj it kk b kl mu ju kn ko mv jx kq kr mw kt ku kv mx kx ky kz my lb lc ld im bi translated">贝叶斯网络使用图表示<strong class="kk iu">联合分布。具体来说，它是一个<a class="ae mb" href="https://en.wikipedia.org/wiki/Directed_acyclic_graph" rel="noopener ugc nofollow" target="_blank"> <strong class="kk iu">有向无环图</strong> </a>，其中<strong class="kk iu">每条边</strong>是一个<strong class="kk iu">条件依赖</strong>，而<strong class="kk iu">每一个节点</strong>是一个独特的<strong class="kk iu">随机变量</strong>。它还有很多其他的名字:<em class="oi">信念网络、决策网络、因果网络、贝叶斯(ian)模型或概率有向无环图模型等。</em></strong></p><p id="3191" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">看起来是这样的:</p><figure class="lm ln lo lp gt lq gh gi paragraph-image"><div role="button" tabindex="0" class="lr ls di lt bf lu"><div class="gh gi oz"><img src="../Images/4377f2996782a153dcac7fa73f7768d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KrHegdxXEe0Ls8bBPZmhdA.png"/></div></div><figcaption class="lx ly gj gh gi lz ma bd b be z dk">From <a class="ae mb" href="https://en.wikipedia.org/wiki/Bayesian_network" rel="noopener ugc nofollow" target="_blank">Wikipedia</a>: A simple Bayesian Network with <a class="ae mb" href="https://en.wikipedia.org/wiki/Conditional_probability_table" rel="noopener ugc nofollow" target="_blank">conditional probability tables</a></figcaption></figure><p id="3f53" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">为了让贝叶斯网络<strong class="kk iu">为概率分布建模，它依赖于一个重要的假设:给定其父变量，每个变量都有条件地独立于其非后代变量。</strong></p><p id="61e2" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">例如，我们可以将<strong class="kk iu"> P(草湿|洒水器，雨)</strong>简化为<strong class="kk iu"> P(草湿|洒水器)</strong>，因为<strong class="kk iu">草湿</strong>有条件地独立于其非后代<strong class="kk iu">雨</strong>，给定<strong class="kk iu">洒水器</strong>。</p><p id="0410" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">利用这个性质，我们可以将整个联合分布简化为下面的公式:</p><figure class="lm ln lo lp gt lq gh gi paragraph-image"><div role="button" tabindex="0" class="lr ls di lt bf lu"><div class="gh gi pa"><img src="../Images/ff427f93230d179aef996b0c1cfaadf3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1zWxkORcvNzdX5v--Yt5kg.png"/></div></div></figure><h2 id="e8c4" class="nz md it bd me oo op dn mi oq or dp mm kr os ot mo kv ou ov mq kz ow ox ms oy bi translated">这个近似(<strong class="ak">条件独立假设)</strong>有什么了不起的？</h2><blockquote class="mz"><p id="3a07" class="na nb it bd nc nd ne nf ng nh ni ld dk translated">变量之间的条件独立可以大大减少参数的数量。</p></blockquote><p id="b5b5" class="pw-post-body-paragraph ki kj it kk b kl nj ju kn ko nk jx kq kr nl kt ku kv nm kx ky kz nn lb lc ld im bi translated">这减少了大量的计算，因为我们现在只考虑它的父节点，而忽略其他所有的东西。</p><p id="6dc5" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们来看看数字。</p><p id="8011" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">假设您有<strong class="kk iu"> n </strong>个二进制变量(= <strong class="kk iu"> n </strong>个节点)。</p><p id="1eb1" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">无约束联合分布</strong>需要<strong class="kk iu"> O(2^n) </strong> <strong class="kk iu">概率</strong>。</p><p id="ac43" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">对于一个<strong class="kk iu">贝叶斯网络</strong>、<strong class="kk iu">任意节点最多有 k 个父节点，我们只需要 O(n * 2^k)个概率。</strong>(对于一定数量的类别，这可以在线性时间内进行。)</p><pre class="lm ln lo lp gt nu nv nw nx aw ny bi"><span id="a269" class="nz md it nv b gy oa ob l oc od"><strong class="nv iu">n = 30 binary variables, k = 4 maximum parents for nodes</strong></span><span id="7f1f" class="nz md it nv b gy pb ob l oc od">• <strong class="nv iu">Unconstrained Joint Distribution</strong>: needs 2^30 (about <strong class="nv iu">1 million</strong>) probabilities -&gt; Intractable!</span><span id="d87e" class="nz md it nv b gy pb ob l oc od">• <strong class="nv iu">Bayesian Network</strong>: needs only <strong class="nv iu">480 </strong>probabilities </span></pre><blockquote class="mz"><p id="f841" class="na nb it bd nc nd pc pd pe pf pg ld dk translated">我们可以使用条件独立性<strong class="ak">得到<strong class="ak">联合分布的有效分解表示。</strong></strong></p></blockquote></div><div class="ab cl le lf hx lg" role="separator"><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj"/></div><div class="im in io ip iq"><h2 id="b462" class="nz md it bd me oo op dn mi oq or dp mm kr os ot mo kv ou ov mq kz ow ox ms oy bi translated">B.贝叶斯推理中的条件独立性</h2><p id="2259" class="pw-post-body-paragraph ki kj it kk b kl mu ju kn ko mv jx kq kr mw kt ku kv mx kx ky kz my lb lc ld im bi translated">比方说，我想估计一下我的博客的参与度。设<strong class="kk iu"> p </strong>为读者会为我的文章拍手的比例。我们将从人群中随机选择 n 名读者。对于<strong class="kk iu"> i = 1，…，n，</strong>让<strong class="kk iu"> Xi = 1 </strong>如果读者鼓掌，或者<strong class="kk iu"> Xi = 0 </strong>如果她/他不鼓掌。</p><p id="2447" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在一种<a class="ae mb" href="https://en.wikipedia.org/wiki/Frequency_probability" rel="noopener ugc nofollow" target="_blank">频率主义者</a>的方法中，我们不把概率分布分配给<strong class="kk iu"> p </strong>。<br/> <strong class="kk iu"> p </strong>简单来说就是<strong class="kk iu">‘sum(Xi)/n’</strong>。<br/>我们将把<strong class="kk iu"> X1，…，Xn </strong>视为独立的随机变量。</p><p id="0ca6" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">另一方面，<strong class="kk iu">在贝叶斯推断中，我们假设 p 遵循一个分布，而不仅仅是一个常数。</strong>在这个模型中，随机变量<strong class="kk iu"> X1，…，Xn </strong>是<strong class="kk iu">不独立</strong>，但给定 p 的分布，它们是<strong class="kk iu">条件独立的。</strong></p></div><div class="ab cl le lf hx lg" role="separator"><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj"/></div><div class="im in io ip iq"><h2 id="8c80" class="nz md it bd me oo op dn mi oq or dp mm kr os ot mo kv ou ov mq kz ow ox ms oy bi translated">C.相关性≠因果关系</h2><p id="1f70" class="pw-post-body-paragraph ki kj it kk b kl mu ju kn ko mv jx kq kr mw kt ku kv mx kx ky kz my lb lc ld im bi translated">“相关性不是因果关系”意味着仅仅因为两件事相关并不一定意味着一个导致另一个。</p><p id="f1b2" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这里有一个令人捧腹的出租车事故的例子:</p><p id="da13" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">一项研究表明，事故数量与出租车司机穿外套之间有着显著的正相关关系。他们发现外套可能会妨碍司机的行动，造成事故。一项新的法律准备禁止出租车司机开车时穿外套。</p><p id="3609" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">直到另一项研究指出，下雨时人们会穿外套…😂</p><pre class="lm ln lo lp gt nu nv nw nx aw ny bi"><span id="6a6b" class="nz md it nv b gy oa ob l oc od">P(accidents, coats | rain) = P(accidents | rain) * P(coats | rain)</span></pre><p id="ea64" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">两件事之间的关联可能是由影响它们的第三个因素造成的。这第三个因素叫做<a class="ae mb" href="http://en.wikipedia.org/wiki/Confounding" rel="noopener ugc nofollow" target="_blank"><strong class="kk iu"/></a>。混杂因素是雨，它是事故和穿外套之间联系的原因。</p><pre class="lm ln lo lp gt nu nv nw nx aw ny bi"><span id="74b1" class="nz md it nv b gy oa ob l oc od">P(accidents | coats, rain) = P(accidents | coats)</span></pre><p id="2ed4" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">请注意，这并不意味着事故与降雨无关。它的意思是:给定穿着外套的司机，知道下雨并不能给出更多关于事故的信息。</p><h1 id="3907" class="mc md it bd me mf no mh mi mj np ml mm jz nq ka mo kc nr kd mq kf ns kg ms mt bi translated">4.条件独立与边际独立</h1><p id="33ab" class="pw-post-body-paragraph ki kj it kk b kl mu ju kn ko mv jx kq kr mw kt ku kv mx kx ky kz my lb lc ld im bi translated">边际独立和普通独立是一样的，</p><p id="f912" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">有时，两个随机变量可能不是边际独立的。然而，在我们观察到一些第三变量之后，它们可以变得独立。</p><h1 id="8e74" class="mc md it bd me mf no mh mi mj np ml mm jz nq ka mo kc nr kd mq kf ns kg ms mt bi translated">5.更多例子！</h1><ul class=""><li id="46c5" class="ph pi it kk b kl mu ko mv kr pj kv pk kz pl ld pm pn po pp bi translated">超速罚款金额<strong class="kk iu"> ㅛ </strong>车型<strong class="kk iu"> | </strong> <strong class="kk iu">速度</strong></li><li id="84ed" class="ph pi it kk b kl pq ko pr kr ps kv pt kz pu ld pm pn po pp bi translated">肺癌<strong class="kk iu"> ㅛ </strong>黄牙<strong class="kk iu"> | </strong>吸烟<strong class="kk iu"/></li><li id="1019" class="ph pi it kk b kl pq ko pr kr ps kv pt kz pu ld pm pn po pp bi translated">孩子的基因<strong class="kk iu"> ㅛ </strong>祖父母的基因<strong class="kk iu"> | </strong> <strong class="kk iu">父母的基因</strong></li><li id="1527" class="ph pi it kk b kl pq ko pr kr ps kv pt kz pu ld pm pn po pp bi translated">汽车的启动马达工作吗？ㅛ:车上的收音机能用吗？<strong class="kk iu"> | </strong> <strong class="kk iu">电池</strong></li><li id="3544" class="ph pi it kk b kl pq ko pr kr ps kv pt kz pu ld pm pn po pp bi translated">未来<strong class="kk iu"> ㅛ </strong>过去<strong class="kk iu"> | </strong>现在(这是<strong class="kk iu">马氏假设</strong>！)</li></ul><p id="77b6" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">他们都是和<strong class="kk iu"> A ㅛ B | C </strong>一样的形式。<br/> <strong class="kk iu"> A </strong>和<strong class="kk iu"> B </strong>如果不考虑<strong class="kk iu"> C </strong>的话，看起来是相关的。然而，一旦我们将<strong class="kk iu"> C </strong>包含在图片中，那么<strong class="kk iu"> A </strong>和<strong class="kk iu"> B </strong>之间的明显关系就消失了。如你所见，任何因果关系都是潜在的条件独立的。我们永远不会确切知道<strong class="kk iu"> A </strong> &amp; <strong class="kk iu"> B </strong>之间的关系，直到我们测试每一个可能的<strong class="kk iu"> C </strong>(混杂变量)！</p></div></div>    
</body>
</html>