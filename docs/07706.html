<html>
<head>
<title>Markov Chains: How to Train Text Generation to Write like George R. R. Martin</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">马尔可夫链:如何训练文本生成像乔治·马丁那样写作</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/markov-chains-how-to-train-text-generation-to-write-like-george-r-r-martin-cdc42786e4b6?source=collection_archive---------25-----------------------#2019-10-25">https://towardsdatascience.com/markov-chains-how-to-train-text-generation-to-write-like-george-r-r-martin-cdc42786e4b6?source=collection_archive---------25-----------------------#2019-10-25</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div class="gh gi jn"><img src="../Images/a68c85fcb639281dbcf522f775b535e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/0*SOgAK5tqbJ5UqTQ4.jpg"/></div></figure><p id="0ff0" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">马尔可夫链已经存在了一段时间，而且还会继续存在。从预测键盘到交易和生物学应用，它们已经被证明是多功能工具。</p><p id="d38f" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">下面是一些马尔可夫链的行业应用:</p><ul class=""><li id="c53f" class="ks kt iq jw b jx jy kb kc kf ku kj kv kn kw kr kx ky kz la bi translated">文本生成(你是为此而来的)。</li><li id="9301" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated">金融建模和预测(包括交易算法)。</li><li id="ed41" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated">物流:模拟未来的运输或行程。</li><li id="c319" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated">搜索引擎:PageRank 可以看作是用马尔可夫链模拟一个随机的互联网冲浪者。</li></ul><p id="1530" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">到目前为止，我们可以告诉这个算法是有用的，但到底什么是马尔可夫链？</p><h1 id="7ce6" class="lg lh iq bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">什么是马尔可夫链？</h1><p id="285b" class="pw-post-body-paragraph ju jv iq jw b jx me jz ka kb mf kd ke kf mg kh ki kj mh kl km kn mi kp kq kr ij bi translated">马尔可夫链是一个<strong class="jw ir">随机过程</strong>，它模拟一组有限的<strong class="jw ir">状态</strong>，具有从一个给定状态跳到另一个状态的固定的<strong class="jw ir">条件概率</strong>。</p><p id="ab62" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">这意味着，我们将有一个“代理”，它随机地在不同的状态之间跳跃，有一定的概率从一个状态跳到另一个状态。</p><p id="b8d7" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">为了展示马尔可夫链是什么样子，我们可以使用一个<strong class="jw ir">有向图</strong>，其中每个节点是一个状态(带有标签或相关数据)，从节点<em class="mj"> a </em>到节点<em class="mj"> b </em>的边的权重是从状态<em class="mj"> a </em>跳到状态<em class="mj">b</em>T17】的<strong class="jw ir">概率。</strong></p><p id="1a58" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">这里有一个例子，将天气建模为马尔可夫链。</p><figure class="ml mm mn mo gt jr gh gi paragraph-image"><div class="gh gi mk"><img src="../Images/db788fcaff6b692bcf05c353cb3b594f.png" data-original-src="https://miro.medium.com/v2/resize:fit:908/format:webp/0*Ie2j5RUwEGDuV5dB.png"/></div><figcaption class="mp mq gj gh gi mr ms bd b be z dk"><a class="ae mt" href="http://techeffigytutorials.blogspot.com/2015/01/markov-chains-explained.html" rel="noopener ugc nofollow" target="_blank">Source</a></figcaption></figure><p id="cc59" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我们可以将从状态<em class="mj"> a </em>到状态<em class="mj"> b </em>的概率表示为<strong class="jw ir">矩阵分量</strong>，其中整个<strong class="jw ir">矩阵表征了我们的马尔可夫链</strong>过程，对应于<strong class="jw ir">有向图的邻接矩阵</strong>。</p><figure class="ml mm mn mo gt jr gh gi paragraph-image"><div class="gh gi mu"><img src="../Images/bc820a2ebf425ee3248e01d919810e4e.png" data-original-src="https://miro.medium.com/v2/resize:fit:476/format:webp/0*Zq7gLHPxqYAKQsY6.png"/></div><figcaption class="mp mq gj gh gi mr ms bd b be z dk"><a class="ae mt" href="http://techeffigytutorials.blogspot.com/2015/01/markov-chains-explained.html" rel="noopener ugc nofollow" target="_blank">Source</a></figcaption></figure><p id="baa7" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">然后，如果我们将当前状态表示为一个独热编码，我们可以通过获取当前状态并查看其对应的行来获得下一个状态的值的条件概率。</p><p id="15d7" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">之后，如果我们重复采样由第<em class="mj"> n </em>个状态的行描述的离散分布，我们可以模拟一系列任意长度的状态。</p><h1 id="d616" class="lg lh iq bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">文本生成的马尔可夫链</h1><p id="1bee" class="pw-post-body-paragraph ju jv iq jw b jx me jz ka kb mf kd ke kf mg kh ki kj mh kl km kn mi kp kq kr ij bi translated">为了用马尔可夫链生成文本，我们需要定义一些东西:</p><ul class=""><li id="124c" class="ks kt iq jw b jx jy kb kc kf ku kj kv kn kw kr kx ky kz la bi translated">我们的国家会是什么样的？</li><li id="91f3" class="ks kt iq jw b jx lb kb lc kf ld kj le kn lf kr kx ky kz la bi translated">从一个状态跳到另一个状态的概率是多少？</li></ul><p id="4b65" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我们可以为文本生成做一个基于字符的模型，其中我们将我们的状态定义为我们看到的最后<em class="mj"> n </em>个字符，并尝试预测下一个字符。</p><p id="4e97" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我已经在我的用于文本生成的<a class="ae mt" href="http://www.datastuff.tech/machine-learning/lstm-how-to-train-neural-networks-to-write-like-lovecraft/" rel="noopener ugc nofollow" target="_blank">LSTM</a>文章中对此进行了深入研究，结果喜忧参半。</p><p id="6a56" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">在这个实验中，我将选择使用之前的<em class="mj"> k </em>单词作为我的当前状态，并对下一个令牌的概率进行建模。</p><p id="6320" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">为了做到这一点，我将简单地为每一个由<em class="mj"> k 个</em>单词组成的不同序列创建一个向量，它有 N 个组成部分，其中 N 是我的语料库中不同单词的总数。</p><p id="44e0" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">然后我会在第<em class="mj"> i </em>个向量的第<em class="mj"> j </em>个分量上加 1，其中 I 是第<em class="mj">I</em>k 个单词序列的索引，<em class="mj"> j </em>是下一个单词的索引。</p><p id="075f" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">如果我归一化每个单词向量，那么我将有下一个单词的概率分布，给定前面的<em class="mj"> k </em>记号。</p><p id="1adf" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">迷惑？让我们看一个小语料库的例子。</p><h1 id="f506" class="lg lh iq bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">训练我们的链条:玩具例子。</h1><p id="e0f0" class="pw-post-body-paragraph ju jv iq jw b jx me jz ka kb mf kd ke kf mg kh ki kj mh kl km kn mi kp kq kr ij bi translated">假设我的语料库是下面这句话。</p><p id="afb4" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><code class="fe mv mw mx my b">This sentence has five words</code></p><p id="ecf2" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我们将首先选择<em class="mj"> k </em>:在采样/ <strong class="jw ir">预测下一个</strong>单词之前，我们的链将考虑的<strong class="jw ir">单词量。对于这个例子，让我们使用 k=1。</strong></p><p id="3f5a" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">现在，我们的句子中有多少个不同的单词序列？它有 5 个，每个单词一个。如果它有重复的单词，他们不会添加到这个数字。</p><p id="4939" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我们将首先初始化一个 5×5 的零矩阵。</p><p id="dbd4" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">之后，我们将在“this”行的“sentence”对应的列中加 1。然后在“句子”的行上加上 1，在“has”的列上加上 1。我们将继续这个过程，直到我们看完整个句子。</p><p id="e0ca" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">这将是生成的矩阵:</p><figure class="ml mm mn mo gt jr gh gi paragraph-image"><div class="gh gi mz"><img src="../Images/78c9d3427df71638d77b2612931c77bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:244/format:webp/0*0OQO51wVaqCWI6Vx.png"/></div><figcaption class="mp mq gj gh gi mr ms bd b be z dk">The diagonal pattern comes from the ordering of the words.</figcaption></figure><p id="e67b" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">因为每个单词只出现一次，所以这个模型只是一遍又一遍地生成同一个句子，但是你可以看到添加更多的单词会使这个变得有趣。</p><p id="eca4" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我希望现在事情更清楚了。让我们跳到一些代码！</p><h1 id="7cf4" class="lg lh iq bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">用 Python 编写我们的马尔可夫链</h1><p id="92ed" class="pw-post-body-paragraph ju jv iq jw b jx me jz ka kb mf kd ke kf mg kh ki kj mh kl km kn mi kp kq kr ij bi translated">现在是有趣的部分！我们会在整个一首冰与火之歌文集上训练一个马尔可夫链(哈！你以为我会引用这部剧吗？太糟糕了，我是个爱看书的人！).</p><p id="3cb0" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">然后我们将为<em class="mj"> k </em>生成不同值的句子。</p><p id="c2e0" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">在这个实验中，我决定将两个空格之间的任何内容都视为一个单词或<em class="mj">标记</em>。</p><p id="3cec" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">按照惯例，在自然语言处理中，我们处理标点符号(如'，'或'.')作为令牌。为了解决这个问题，我将首先以两个空格的形式给每个标点符号添加填充。</p><p id="9bc8" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">下面是这个小预处理以及加载语料库的代码:</p><figure class="ml mm mn mo gt jr"><div class="bz fp l di"><div class="na nb l"/></div></figure><p id="f696" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我们将立即开始训练我们的马尔可夫链，但首先让我们看看我们的数据集:</p><figure class="ml mm mn mo gt jr"><div class="bz fp l di"><div class="na nb l"/></div></figure><p id="1102" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我们有超过 200 万个代币，代表超过 32000 个不同的单词！对于一个作家来说，这是一个相当大的语料库。</p><p id="6851" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><em class="mj">要是他能多加 80 万就好了……</em></p><h1 id="8ed7" class="lg lh iq bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">训练我们的链条</h1><p id="4b2a" class="pw-post-body-paragraph ju jv iq jw b jx me jz ka kb mf kd ke kf mg kh ki kj mh kl km kn mi kp kq kr ij bi translated">继续，下面是我们如何为任意的<em class="mj"> k </em>(在本例中为 2)初始化我们的“k 序列后的单词”计数矩阵。</p><p id="c659" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">语料库中有 2185918 个单词，429582 个不同的 2 个单词的序列，每个序列后面都有 32663 个单词中的一个。</p><p id="3a3a" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">这意味着矩阵中只有 0.015%多一点的成分是非零的。</p><p id="d09c" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">因此，我使用了 scipy 的<em class="mj"> dok_matrix </em> ( <em class="mj"> dok </em>代表键的字典)，一个稀疏矩阵实现，因为我们知道这个数据集将非常稀疏。</p><figure class="ml mm mn mo gt jr"><div class="bz fp l di"><div class="na nb l"/></div></figure><p id="01a4" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">在初始化我们的矩阵后，采样是非常直观的。</p><p id="add2" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">下面是代码:</p><figure class="ml mm mn mo gt jr"><div class="bz fp l di"><div class="na nb l"/></div></figure><p id="8dc1" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">这里有两件事可能引起了你的注意。第一个是<em class="mj"> alpha </em>超参数。</p><p id="bde1" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">这是我们的链的<em class="mj">创造力</em>:一个(通常很小，或零)的机会，它会选择一个完全随机的单词，而不是语料库建议的那些。</p><p id="e553" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">如果数字很高，那么下一个单词的分布将接近均匀。如果为零或更接近，那么分布将更接近语料库中看到的分布。</p><p id="966b" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">对于我将展示的所有示例，我使用了值为 0 的<em class="mj"> alpha </em>。</p><p id="61f2" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">第二件事是加权选择函数。我必须实现它，因为 Python 的随机包不支持超过 32 个元素的列表的加权选择，更不用说 32000 个元素了。</p><h1 id="4061" class="lg lh iq bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">结果:生成的句子</h1><p id="4de9" class="pw-post-body-paragraph ju jv iq jw b jx me jz ka kb mf kd ke kf mg kh ki kj mh kl km kn mi kp kq kr ij bi translated">首先，作为基线，我尝试了一种确定性的方法:如果我们选择一个单词，使用 k=1，并总是跳到当前单词之后最有可能的单词，会发生什么？</p><p id="1967" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">至少可以说，结果并不令人满意。</p><pre class="ml mm mn mo gt nc my nd ne aw nf bi"><span id="9f11" class="ng lh iq my b gy nh ni l nj nk"><strong class="my ir">I</strong> am not have been a man , and the Wall . " " " "<br/><strong class="my ir">he</strong> was a man , and the Wall . " " " " " " "<br/><strong class="my ir">she</strong> had been a man , and the Wall . " " " " " "</span></pre><p id="d12b" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">因为我们是确定性的，“a”后面总是跟着“man”，“the”后面总是跟着“Wall”(呵呵)等等。</p><p id="9337" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">这意味着我们的句子会很无聊，可预测，而且有点荒谬。</p><p id="3a88" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">现在对于一些实际的世代，我尝试使用一个词的随机马尔可夫链，α值为 0。</p><h1 id="8338" class="lg lh iq bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">一词马尔可夫链结果</h1><p id="c0bc" class="pw-post-body-paragraph ju jv iq jw b jx me jz ka kb mf kd ke kf mg kh ki kj mh kl km kn mi kp kq kr ij bi translated">以下是一些由 15 个单词组成的句子，种子单词用粗体表示。</p><pre class="ml mm mn mo gt nc my nd ne aw nf bi"><span id="7322" class="ng lh iq my b gy nh ni l nj nk">'<strong class="my ir">the</strong> Seven in front of whitefish in a huge blazes burning flesh . I had been' <br/>'<strong class="my ir">a </strong>squire , slain , they thought . " He bathed in his head . The' <br/>'<strong class="my ir">Bran</strong> said Melisandre had been in fear I've done . " It must needs you will' <br/>'<strong class="my ir">Melisandre</strong> would have feared he'd squired for something else I put his place of Ser Meryn' <br/>'<strong class="my ir">Daenerys</strong> is dead cat - TOOTH , AT THE GREAT , Asha , which fills our' <br/>'<strong class="my ir">Daenerys</strong> Targaryen after Melara had worn rich grey sheep to encircle Stannis . " The deep'</span></pre><p id="a9cb" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">正如你所看到的，产生的句子是非常荒谬的，尽管比前几个有趣得多。</p><p id="70b9" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">每一对单词都有一定的意义，但整个序列完全没有意义。</p><p id="fd04" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">这个模型确实学到了一些有趣的东西，比如丹妮莉丝后面通常跟着坦格利安，对于只知道前一个单词来说,“本该害怕”是一个很好的结构。</p><p id="405f" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">然而，总的来说，我认为这还远远没有达到它应有的水平。</p><p id="7ffe" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">当增加单词链的 alpha 值时，我得到的句子开始变得更加随机。</p><h1 id="fffa" class="lg lh iq bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">2 字马尔可夫链的结果</h1><p id="eee5" class="pw-post-body-paragraph ju jv iq jw b jx me jz ka kb mf kd ke kf mg kh ki kj mh kl km kn mi kp kq kr ij bi translated">两个单词的链产生了一些更有趣的句子。</p><p id="63ac" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">尽管它通常听起来完全随机，但它的大部分输出可能会在开始时愚弄你一会儿。</p><pre class="ml mm mn mo gt nc my nd ne aw nf bi"><span id="505a" class="ng lh iq my b gy nh ni l nj nk">'<strong class="my ir">the world</strong> . <em class="mj">And Ramsay loved the feel of grass</em> <em class="mj">welcomed them warmly</em> , the axehead flew' <br/>'<strong class="my ir">Jon Snow</strong> . <em class="mj">You are to strike at him</em> . <em class="mj">The bold ones have had no sense</em>' <br/>'<strong class="my ir">Eddard Stark</strong> had done his best to give her <em class="mj">the promise was broken</em> . By tradition the' <br/>'<strong class="my ir">The game</strong> of thrones , so you must tell her the next buyer who comes running ,' <br/>'<strong class="my ir">The game</strong> trail brought her messages , strange spices . <em class="mj">The Frey stronghold was not large enough</em>' <br/>'<strong class="my ir">heard the</strong> scream of fear . I want to undress properly . Shae was there , fettered'</span></pre><p id="576c" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">句子保持了局部的连贯性(<em class="mj">你要打击他</em>，或者<em class="mj">拉姆齐喜欢草的感觉</em>)，但随后将非常连贯的单词序列连接成一团乱麻。</p><p id="2421" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">任何句法、语法或语义的感觉都明显缺失。</p><p id="d9c0" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">顺便说一下，我根本没有挑选那些句子，这些是我采样的第一批输出。</p><p id="9123" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">随意<a class="ae mt" href="https://github.com/StrikingLoo/ASOIAF-Markov" rel="noopener ugc nofollow" target="_blank">自己玩代码</a>，你可以在评论里分享你得到的最古怪的句子！</p><p id="7bf1" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">作为最后一个实验，让我们看看用三个词的马尔可夫链能得到什么。</p><h1 id="f7cb" class="lg lh iq bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">三字链结果</h1><p id="771c" class="pw-post-body-paragraph ju jv iq jw b jx me jz ka kb mf kd ke kf mg kh ki kj mh kl km kn mi kp kq kr ij bi translated">以下是模型在用 3 个单词的序列进行训练时生成的一些句子。</p><pre class="ml mm mn mo gt nc my nd ne aw nf bi"><span id="4102" class="ng lh iq my b gy nh ni l nj nk">'<strong class="my ir">I am a</strong> master armorer , lords of Westeros , sawing out each bay and peninsula until the' <br/>'<strong class="my ir">Jon Snow is</strong> with the Night's Watch . I did not survive a broken hip , a leathern' <br/>'<strong class="my ir">Jon Snow is</strong> with the Hound in the woods . He won't do it . " Please don't' <br/>'<strong class="my ir">Where are the</strong> chains , and the Knight of Flowers to treat with you , Imp . "' <br/>'<strong class="my ir">Those were the</strong> same . Arianne demurred . " So the fishwives say , " It was Tyrion's' <br/>'<strong class="my ir">He thought that</strong> would be good or bad for their escape . If they can truly give us' <br/>'<strong class="my ir">I thought that</strong> she was like to remember a young crow he'd met briefly years before . "'</span></pre><p id="8bf4" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">好吧，我真的很喜欢其中的一些，尤其是最后一个。这听起来有点像你能在书中找到的真实句子。</p><h1 id="8af5" class="lg lh iq bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">结论</h1><p id="fd2c" class="pw-post-body-paragraph ju jv iq jw b jx me jz ka kb mf kd ke kf mg kh ki kj mh kl km kn mi kp kq kr ij bi translated">实现马尔可夫链比听起来容易得多，在真实语料库上训练它很有趣。</p><p id="55d1" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">坦白地说，结果比我预期的要好，尽管在 LSTM 的小失败后，我可能把标准定得太低了。</p><p id="06be" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">在未来，我可能会尝试用更长的链或完全不同的语料库来训练这个模型。</p><p id="d1fd" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">在这种情况下，尝试一个 5 个单词的链又有了基本确定的结果，因为每个 5 个单词的序列几乎总是唯一的，所以我不认为 5 个单词和以上的链是感兴趣的。</p><p id="fc3f" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">你认为哪个语料库会产生更有趣的结果，尤其是对于更长的链？请在评论中告诉我！</p><p id="c43d" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><em class="mj">如果你想了解更多关于马尔可夫链的知识，可以考虑查看一下</em> <a class="ae mt" href="https://amzn.to/31IDAHp" rel="noopener ugc nofollow" target="_blank"> <em class="mj">这本深入的书</em> </a> <em class="mj">。那是一个代销商链接，也就是说我从中获得一小笔佣金</em>。</p></div><div class="ab cl nl nm hu nn" role="separator"><span class="no bw bk np nq nr"/><span class="no bw bk np nq nr"/><span class="no bw bk np nq"/></div><div class="ij ik il im in"><p id="f12a" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><em class="mj">原载于 2019 年 10 月 25 日</em><a class="ae mt" href="http://www.datastuff.tech/machine-learning/markov-chains-teaching-ai-to-write-game-of-thrones/" rel="noopener ugc nofollow" target="_blank"><em class="mj">http://www . data stuff . tech</em></a><em class="mj">。</em></p></div></div>    
</body>
</html>