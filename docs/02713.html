<html>
<head>
<title>Comparing Column Values in Different Excel Files using Pandas</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用 Pandas 比较不同 Excel 文件中的列值</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/comparing-and-matching-column-values-in-different-excel-files-using-pandas-a25172f0ff4d?source=collection_archive---------4-----------------------#2019-05-03">https://towardsdatascience.com/comparing-and-matching-column-values-in-different-excel-files-using-pandas-a25172f0ff4d?source=collection_archive---------4-----------------------#2019-05-03</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div class="gh gi jq"><img src="../Images/e90da399286dbab988eec7ab62ab67a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1342/format:webp/1*0cL5rCOkI0ThroRyBFWlXA.png"/></div><figcaption class="jx jy gj gh gi jz ka bd b be z dk">Image Courtesy of Joshua Hoehne via <a class="ae kb" href="https://unsplash.com/photos/7XLsFy0p3Ao" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="08e9" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated"><strong class="ke iu">熊猫为列匹配</strong></p><p id="a680" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">通常，我们可能希望比较不同 Excel 文件中的列值，以搜索匹配和/或相似性。使用 Python 中的 Pandas 库，这是一个简单的任务。为了证明这是如何可能的，本教程将集中在一个简单的遗传例子。不需要遗传学知识！</p><p id="e165" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">考虑以下情况:我有一些未知的 DNA 序列样本(由字母 A、T、G 和 c 组成的简单字符串)。对于这些未知的 DNA 序列，我会分配一个唯一的标识符。为了简单起见，第一个未知序列将被标识为 1，第二个被标识为 2，依此类推，如下所示。</p><figure class="lb lc ld le gt ju gh gi paragraph-image"><div class="gh gi la"><img src="../Images/e67bbd9ab3004d8fec8d49f1717b2fd0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1140/format:webp/1*CNGjXQaemQRDaw30ep4b5A.png"/></div></figure><p id="65aa" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">在这个有些人为的例子中，我想比较我的未知序列和已知的参考序列。</p><p id="5122" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">简而言之，我的问题是,‘未知 _ 样本 _ 否’中的任何一个与我的‘引用 _ 序列 _ ID’匹配吗？如果有，它们与哪个(些)序列匹配。</p><figure class="lb lc ld le gt ju gh gi paragraph-image"><div class="gh gi lf"><img src="../Images/d3ac436c88a2e8b15eeaa355795bad85.png" data-original-src="https://miro.medium.com/v2/resize:fit:1356/format:webp/1*zHgy8GWRFiEEJtJb95M9Mw.png"/></div></figure><p id="9a50" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">为了开始回答这个问题，我首先导入 pandas 模块，并将相应的文件作为 csv 文件读取。注意:我将这些文件在 Excel 中保存为逗号分隔值文件(csv 文件)，并使用<strong class="ke iu"> read_csv() </strong>函数解析它们。严格来说，这不是<em class="lg">必须的，但这是我喜欢的一种工作习惯。您也可以将 Excel 文件保留在原生的<strong class="ke iu">中。xlsx </strong>扩展名，并使用<strong class="ke iu"> pandas.read_excel() </strong>函数在这里保存一个步骤。</em></p><p id="66df" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">查询序列 DataFrame 被赋予了变量 A，而序列引用 DataFrame 被赋予了变量 b。</p><figure class="lb lc ld le gt ju"><div class="bz fp l di"><div class="lh li l"/></div></figure><p id="1c8c" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">然后，我将两个数据帧中的两列都转换成 python 列表。为此，我使用了<strong class="ke iu">。tolist() </strong>对特定数据帧的指定列执行方法。举例来说，数据帧 A 中的列“未知 _ 样本 _ 否”被转换成列表。我对分布在两个 Excel 文件中的其他三列中的每一列执行这个步骤，如下面的代码片段所示。</p><figure class="lb lc ld le gt ju"><div class="bz fp l di"><div class="lh li l"/></div></figure><p id="7252" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">我想保留“未知 _ 样本 _ 编号”与其对应的“未知 _ 样本 _ 序列”之间的关联。此外，我还想保留‘Reference _ sequences _ ID’与其对应的‘Reference _ sequences’之间的关联。Python 提供了一种维护这种关联的简单方法。我把我的清单转换成两本字典。</p><p id="8ede" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">我使用<strong class="ke iu"> zip </strong>函数连接列表，然后使用<strong class="ke iu"> dict </strong>函数将它们转换到适当分配的字典中。</p><p id="2c3e" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">为了确认字典已经被正确创建，我在我的终端上运行这个脚本。一个简短的验证检查告诉我一切都在按计划进行。例如，在 Ref_dict 中,“Reference_sequences_ID”键与其对应的“Reference_sequences”值正确匹配:{ ' A ':' aaaaagcgcgaggggga '，' K': 'GGGAGAGAGGG '，' Y ':' cggacgttt '…..}</p><figure class="lb lc ld le gt ju"><div class="bz fp l di"><div class="lh li l"/></div></figure><p id="8927" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">我现在可以把我的两本词典互相比较了。为此，我使用一个 for 循环来遍历我的“Unknown_dict ”,并使用一个嵌套的 for 循环来遍历 Ref_dict。在每次迭代时，我想知道 Unknown_dict 中的序列是否与 Ref_dict 中的任何序列匹配(有些会<em class="lg">，我故意包括了 8 个</em> <em class="lg">匹配</em>)。为了检查匹配，我使用了来自<strong class="ke iu"> re </strong>模块(正则表达式模块)的<strong class="ke iu"> re.search() </strong>函数。</p><p id="504b" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">当有匹配时，我认为知道什么序列匹配，匹配出现在 DNA 序列中的什么位置，以及最重要的是什么‘未知 _ 样本 _ 编号’与哪个‘参考 _ 序列 _ ID’匹配将是有用的。</p><figure class="lb lc ld le gt ju"><div class="bz fp l di"><div class="lh li l"/></div></figure><p id="bb3c" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">为了使事情更清楚，如果所有的匹配都被写到一个可以在 Excel 中打开的 csv 文件中，那将是非常理想的。理想情况下，目标是让任何想要解释数据的人都清楚，哪些序列匹配，匹配序列是什么，在哪里匹配。</p><p id="a549" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">为了实现这个目标，我写了一个名为“seq_match_compare.csv”的文件，当我打开 csv 文件时，所有我想要的信息都以一种可解释的方式出现了！</p><p id="99d0" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">例如，我现在知道 Query_ID: 1 对应于 Ref_species A，这个匹配从序列中的位置 4 开始。</p><figure class="lb lc ld le gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi lj"><img src="../Images/ca2f551322f4376558adf83e631a6291.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Q_qOV9LxQhvqytG3vd1a1A.png"/></div></div></figure><p id="d5cf" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">有多种方法可以比较两个不同 excel 文件中的列值。这里的方法将第一个文件的未知序列列中的每个序列与第二个文件的 Reference_sequences 列中的每个序列进行检查。</p><p id="d45f" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">这种方式代表了一种简单的匹配和比较方式，如果我们想要分析任意数量的样品，这种方式提供了极大的可扩展性！</p><p id="d0c1" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">所有这些都是通过熊猫实现的！</p></div></div>    
</body>
</html>