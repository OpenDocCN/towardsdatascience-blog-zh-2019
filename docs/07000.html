<html>
<head>
<title>Chi-Square Test for Feature Selection in Machine learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">机器学习中特征选择的卡方检验</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/chi-square-test-for-feature-selection-in-machine-learning-206b1f0b8223?source=collection_archive---------0-----------------------#2019-10-04">https://towardsdatascience.com/chi-square-test-for-feature-selection-in-machine-learning-206b1f0b8223?source=collection_archive---------0-----------------------#2019-10-04</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="6ddb" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">特征选择在机器学习中一直起着关键作用</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/6074a57b4bdd688db89c619533ecd02e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VbdMkuxtA-YXE3IJudbAdQ.jpeg"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">image by <a class="ae kv" href="https://unsplash.com/@garri" rel="noopener ugc nofollow" target="_blank">Vladislav Babienko</a></figcaption></figure><p id="64ec" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们总是想知道卡方检验在机器学习中的什么地方有用，以及这个检验有什么不同。特征选择是机器学习中的一个重要问题，在机器学习中，我们将有几个特征，并且必须选择最佳特征来建立模型。卡方检验通过检验特征之间的关系来帮助您解决特征选择中的问题。在这篇文章中，我将引导通过</p><p id="8c29" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">a.卡方分布。</p><p id="eeb2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">b.特征选择的卡方检验</p><p id="8c16" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">c.使用 Python 进行卡方检验</p><h1 id="0709" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">卡方分布</h1><p id="e858" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">如果随机变量ꭓ可以写成标准正态变量的平方和，则它遵循卡方分布。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mp"><img src="../Images/792e2b422aceceee9b9e726121eb0d51.png" data-original-src="https://miro.medium.com/v2/resize:fit:252/format:webp/1*dk_0wN98IXn2iF3J5pQm-A.png"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Z1, Z2.. are standard normal variables</figcaption></figure><h2 id="5420" class="mq lt iq bd lu mr ms dn ly mt mu dp mc lf mv mw me lj mx my mg ln mz na mi nb bi translated">自由度:</h2><p id="c1b3" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">自由度是指逻辑上独立的值的最大数量，这些值可以自由变化。简而言之，它可以定义为观测值的总数减去施加在观测值上的独立约束的数量。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nc"><img src="../Images/c1ec0e98d66040ac16ba56abbc98e9b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:416/format:webp/1*r8L95urSYZ4V26lxH6nh_Q.png"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/c2395f491ae95e96cff8d197ceccf9ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/0*y_OWBu954mw4Zzmc.gif"/></div></figure><p id="dc72" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在上图中，我们可以看到不同自由度的卡方分布。我们还可以观察到，随着自由度的增加，卡方分布接近正态分布。</p><h1 id="c9aa" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">特征选择的卡方检验</h1><p id="83ff" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">卡方检验在统计学中用于检验两个事件的独立性。给定两个变量的数据，我们可以得到观察计数 O 和期望计数 E。卡方测量期望计数 E 和观察计数 O 如何相互偏离。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/1e6a63efe0e557ffe3c5b74a42d606fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:532/format:webp/1*S8rfFkmLhDbOz4RGNwuz6g.png"/></div></figure><p id="da44" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们考虑一个场景，其中我们需要确定独立类别特征(预测器)和从属类别特征(响应)之间的关系。在特征选择中，我们的目标是选择高度依赖于响应的特征。</p><p id="6a32" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">当两个特征独立时，观察计数接近预期计数，因此我们将具有较小的卡方值。所以高卡方值表明独立性假设是不正确的。简而言之，卡方值越高，特征越依赖于响应，并且可以被选择用于模型训练。</p><p id="15c7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">卡方检验的步骤及示例:</p><p id="a45d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">考虑一个数据集，我们必须确定客户离开银行的原因，让我们对两个变量进行卡方检验。客户的<strong class="ky ir"><em class="nf"/></strong>性别，值为男性/女性作为预测值，<strong class="ky ir"> <em class="nf">退出</em> </strong>描述客户是否离开银行，值为是/否作为响应。在这个测试中，我们将检查<em class="nf">性别和 Exited </em>之间是否有任何关系。</p><p id="03f4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">执行卡方检验的步骤:</p><ol class=""><li id="2be0" class="ng nh iq ky b kz la lc ld lf ni lj nj ln nk lr nl nm nn no bi translated">定义假设。</li><li id="c471" class="ng nh iq ky b kz np lc nq lf nr lj ns ln nt lr nl nm nn no bi translated">建立一个应急表。</li><li id="502f" class="ng nh iq ky b kz np lc nq lf nr lj ns ln nt lr nl nm nn no bi translated">求期望值。</li><li id="6cc7" class="ng nh iq ky b kz np lc nq lf nr lj ns ln nt lr nl nm nn no bi translated">计算卡方统计量。</li><li id="c8aa" class="ng nh iq ky b kz np lc nq lf nr lj ns ln nt lr nl nm nn no bi translated">接受或拒绝零假设。</li></ol><h2 id="5ef5" class="mq lt iq bd lu mr ms dn ly mt mu dp mc lf mv mw me lj mx my mg ln mz na mi nb bi translated">1.定义假设</h2><p id="2b9c" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">零假设(H0):两个变量是独立的。</p><p id="25b9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">替代假设(H1):两个变量不是独立的。</p><h2 id="5ca2" class="mq lt iq bd lu mr ms dn ly mt mu dp mc lf mv mw me lj mx my mg ln mz na mi nb bi translated">2.相依表</h2><p id="f3b9" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">显示一个变量在行中的分布和另一个变量在列中的分布的表格。它用于研究两个变量之间的关系。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/b71d0157de4ccde0ea063a6c86dd5c47.png" data-original-src="https://miro.medium.com/v2/resize:fit:834/format:webp/1*rmQj1uMkdvIISYaUa6rzgg.png"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Contingency table for observed values</figcaption></figure><p id="8ea0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">列联表的自由度给定为(r-1) * (c-1)，其中 r，c 是行和列。这里 df =(2–1)*(2–1)= 1。</p><p id="ce4b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在上表中，我们已经算出了所有的观察值，我们的下一步是找到期望值，获得卡方值并检查关系。</p><h2 id="1d51" class="mq lt iq bd lu mr ms dn ly mt mu dp mc lf mv mw me lj mx my mg ln mz na mi nb bi translated">3.求期望值</h2><p id="e7c6" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">基于两个变量独立的零假设。我们可以说如果 A，B 是两个独立的事件</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/837c70e5ac235666a56ad49a442b68f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:414/format:webp/1*sD5qNUh_lsiXjSF_dE6W_g.png"/></div></figure><p id="688b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们来计算第一个细胞的期望值，这是那些男性，并从银行退出。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/294373cb840b614c18fbb254698c747a.png" data-original-src="https://miro.medium.com/v2/resize:fit:552/format:webp/1*QpKU8h5I9jAwaVavmX0J5g.png"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">The calculation for the expected value</figcaption></figure><p id="31e2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">类似地，我们计算 E2，E3，E4，得到如下结果。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/67f78dc5070dc553292487e718758f62.png" data-original-src="https://miro.medium.com/v2/resize:fit:862/format:webp/1*yvWLhvZNS5_CvX5st6Bylg.png"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Expected values</figcaption></figure><h2 id="2384" class="mq lt iq bd lu mr ms dn ly mt mu dp mc lf mv mw me lj mx my mg ln mz na mi nb bi translated">4.计算卡方值</h2><p id="42b9" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">将观察值和计算出的期望值汇总成表格，并确定卡方值。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/d7905afbea3faf1c0991ae50c4ddc59a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1020/format:webp/1*pScat3UxYpoGeKCdm3-_pQ.png"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nz"><img src="../Images/c0be83aebd3c3a7cf7f685c2b1916ecf.png" data-original-src="https://miro.medium.com/v2/resize:fit:510/format:webp/1*FV8dmB9BgkFOLai2WlqTeA.png"/></div></figure><p id="7e77" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们可以看到，通过使用卡方统计公式，卡方被计算为 2.22。</p><h2 id="1468" class="mq lt iq bd lu mr ms dn ly mt mu dp mc lf mv mw me lj mx my mg ln mz na mi nb bi translated">5.接受或拒绝零假设</h2><p id="f366" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">在α= 0.05 的 95%置信度下，我们将检查计算的卡方值落在接受或拒绝区域。</p><p id="fdf4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">自由度=1(用列联表计算)且 alpha =0.05，卡方值为 3.84。</p><p id="a5ba" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">卡方值可通过<a class="ae kv" href="https://web.ma.utexas.edu/users/davis/375/popecol/tables/chisq.html" rel="noopener ugc nofollow" target="_blank">卡方表</a>确定。</p><p id="f4a9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="nf">卡方分布位于右侧，因为观察值和期望值之间的差异很大。</em></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oa"><img src="../Images/3fcff4da6e0b6e7499ad59ca418d8699.png" data-original-src="https://miro.medium.com/v2/resize:fit:1102/format:webp/1*_2OeeuGu4f0gRuyoxAdiVg.png"/></div></figure><p id="8774" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在上图中，我们可以看到卡方的范围从 0 到 inf，α的范围从 0 到 1，方向相反。如果卡方值落在误差区域(α从 0 到 0.05)，我们将拒绝零假设。</p><p id="64a3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这里我们接受零假设，因为卡方值小于临界卡方值。</p><p id="6fb0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="nf">为了得出这两个变量是独立的结论，性别变量不能被选择用于训练模型。</em></p><h1 id="569e" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">限制</h1><p id="440b" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">卡方对表格单元格中的小频率很敏感。通常，当表的某个单元格中的期望值小于 5 时，卡方检验会导致结论错误。</p><p id="b6c5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi ob translated">注意:这里我们考虑的是大小为 400 的样本，对于更大的样本，结果可能会有所不同。</p><h1 id="8ec7" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">使用 Python 进行卡方检验</h1><p id="edb8" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">下面是关于如何使用 python 执行卡方测试的代码。</p><p id="75f4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">你也可以在 GitHub 上找到同样的内容。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ok ol l"/></div></figure><blockquote class="om"><p id="bab8" class="on oo iq bd op oq or os ot ou ov lr dk translated">到目前为止，我们已经了解了分类反应和分类预测，但如果我们有连续反应和分类预测呢？？？我们将使用方差分析。请查看我的文章<a class="ae kv" rel="noopener" target="_blank" href="/anova-for-feature-selection-in-machine-learning-d9305e228476"> ANOVA，了解机器学习</a>中的特征选择。</p><p id="efc6" class="on oo iq bd op oq ow ox oy oz pa lr dk translated"><em class="pb">如果你好奇想了解特征选择方法。下面是文章的深度。</em></p><p id="0f5e" class="on oo iq bd op oq ow ox oy oz pa lr dk translated">【https://neptune.ai/blog/feature-selection-methods T4】</p></blockquote><div class="pc pd pe pf pg ph"><a rel="noopener follow" target="_blank" href="/anova-for-feature-selection-in-machine-learning-d9305e228476"><div class="pi ab fo"><div class="pj ab pk cl cj pl"><h2 class="bd ir gy z fp pm fr fs pn fu fw ip bi translated">机器学习中特征选择的方差分析</h2><div class="po l"><h3 class="bd b gy z fp pm fr fs pn fu fw dk translated">方差分析在特征选择中的应用</h3></div><div class="pp l"><p class="bd b dl z fp pm fr fs pn fu fw dk translated">towardsdatascience.com</p></div></div><div class="pq l"><div class="pr l ps pt pu pq pv kp ph"/></div></div></a></div><p id="0776" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">希望你喜欢！！！请对任何疑问或建议发表评论。</p></div></div>    
</body>
</html>