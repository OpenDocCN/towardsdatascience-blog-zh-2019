<html>
<head>
<title>Deep Learning for Detecting Pneumonia from X-ray Images</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">深度学习用于从 X 射线图像中检测肺炎</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/deep-learning-for-detecting-pneumonia-from-x-ray-images-fc9a3d9fdba8?source=collection_archive---------1-----------------------#2019-07-26">https://towardsdatascience.com/deep-learning-for-detecting-pneumonia-from-x-ray-images-fc9a3d9fdba8?source=collection_archive---------1-----------------------#2019-07-26</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="b6d2" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">用于从 X 射线图像检测肺炎的端到端管道</h2></div><figure class="kf kg kh ki gt kj gh gi paragraph-image"><div class="ab gu cl kk"><img src="../Images/dfa158f7b6c992851ca7f4323b484ee4.png" data-original-src="https://miro.medium.com/v2/format:webp/1*sE2lzbGqffqXZmHeooB0-g.jpeg"/></div></figure><p id="5a33" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">被困在付费墙后面？点击<a class="ae lj" href="https://medium.com/p/deep-learning-for-detecting-pneumonia-from-x-ray-images-fc9a3d9fdba8?source=email-c3f5233f3441--writer.postDistributed&amp;sk=fc89a046b5dcdda696aaeba7242b5e15" rel="noopener">这里</a>阅读完整故事与我的朋友链接！</p><p id="593d" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">对许多人来说，患肺炎的风险是巨大的，尤其是在发展中国家，那里有数十亿人面临能源匮乏，依赖污染型能源。世卫组织估计，每年有 400 多万人过早死于包括肺炎在内的家庭空气污染相关疾病。每年有超过 1 . 5 亿人感染肺炎，尤其是 5 岁以下的儿童。在这些地区，由于缺乏医疗资源和人员，这个问题可能会进一步恶化。例如，在非洲的 57 个国家中，存在着 230 万医生和护士的缺口。对于这些人群，准确快速的诊断意味着一切。它可以保证及时获得治疗，并为那些已经贫困的人节省急需的时间和金钱。</p><p id="1cb1" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">本项目是在 Kaggle 上举办的<a class="ae lj" href="https://www.kaggle.com/paultimothymooney/chest-xray-pneumonia" rel="noopener ugc nofollow" target="_blank">胸部 x 光影像(肺炎)</a>的一部分。</p><h1 id="03af" class="lk ll iq bd lm ln lo lp lq lr ls lt lu jw lv jx lw jz lx ka ly kc lz kd ma mb bi translated">挑战</h1><p id="53d3" class="pw-post-body-paragraph kn ko iq kp b kq mc jr ks kt md ju kv kw me ky kz la mf lc ld le mg lg lh li ij bi translated">建立一种算法，通过查看胸部 x 光图像来自动识别患者是否患有肺炎。算法必须非常精确，因为人命关天。</p><figure class="kf kg kh ki gt kj gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi mh"><img src="../Images/f09ee58444c3884eec7a31d4d671b7b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*J5wUMztRXZ_eHimMxULAnA.png"/></div></div></figure><h1 id="9471" class="lk ll iq bd lm ln lo lp lq lr ls lt lu jw lv jx lw jz lx ka ly kc lz kd ma mb bi translated">环境和工具</h1><ol class=""><li id="bbd0" class="mm mn iq kp b kq mc kt md kw mo la mp le mq li mr ms mt mu bi translated"><a class="ae lj" href="https://scikit-learn.org/stable/" rel="noopener ugc nofollow" target="_blank"> scikit-learn </a></li><li id="0590" class="mm mn iq kp b kq mv kt mw kw mx la my le mz li mr ms mt mu bi translated"><a class="ae lj" href="https://keras.io/" rel="noopener ugc nofollow" target="_blank"> keras </a></li><li id="f859" class="mm mn iq kp b kq mv kt mw kw mx la my le mz li mr ms mt mu bi translated"><a class="ae lj" href="https://www.numpy.org/" rel="noopener ugc nofollow" target="_blank"> numpy </a></li><li id="6b19" class="mm mn iq kp b kq mv kt mw kw mx la my le mz li mr ms mt mu bi translated"><a class="ae lj" href="https://pandas.pydata.org/" rel="noopener ugc nofollow" target="_blank">熊猫</a></li><li id="b444" class="mm mn iq kp b kq mv kt mw kw mx la my le mz li mr ms mt mu bi translated"><a class="ae lj" href="https://matplotlib.org/" rel="noopener ugc nofollow" target="_blank"> matplotlib </a></li></ol><h1 id="357e" class="lk ll iq bd lm ln lo lp lq lr ls lt lu jw lv jx lw jz lx ka ly kc lz kd ma mb bi translated">数据</h1><p id="a7e4" class="pw-post-body-paragraph kn ko iq kp b kq mc jr ks kt md ju kv kw me ky kz la mf lc ld le mg lg lh li ij bi translated">数据集可以从 kaggle 网站下载，该网站可以在<a class="ae lj" href="https://www.kaggle.com/paultimothymooney/chest-xray-pneumonia" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p><h1 id="0338" class="lk ll iq bd lm ln lo lp lq lr ls lt lu jw lv jx lw jz lx ka ly kc lz kd ma mb bi translated">代码在哪里？</h1><p id="0924" class="pw-post-body-paragraph kn ko iq kp b kq mc jr ks kt md ju kv kw me ky kz la mf lc ld le mg lg lh li ij bi translated">事不宜迟，让我们从代码开始吧。github 上的完整项目可以在这里找到<a class="ae lj" href="https://github.com/abhinavsagar/Kaggle-tutorial" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="58d1" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">让我们从加载所有的库和依赖项开始。</p><figure class="kf kg kh ki gt kj"><div class="bz fp l di"><div class="na nb l"/></div></figure><p id="8a55" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">接下来，我展示了一些正常和肺炎的图像，看看它们在肉眼看来有多大的不同。嗯不多！</p><figure class="kf kg kh ki gt kj"><div class="bz fp l di"><div class="na nb l"/></div></figure><figure class="kf kg kh ki gt kj gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi nc"><img src="../Images/0391212077a1d33efdd9acd1eb4b64c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kn4y_p8HHGYmsrCVy10mFQ.png"/></div></div><figcaption class="nd ne gj gh gi nf ng bd b be z dk">Sample Images</figcaption></figure><p id="e783" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">然后，我将数据集分成三组——训练集、验证集和测试集。</p><figure class="kf kg kh ki gt kj"><div class="bz fp l di"><div class="na nb l"/></div></figure><p id="bdc7" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">接下来，我编写了一个函数，在这个函数中，我做了一些数据扩充，将训练和测试集图像输入到网络中。我还为图像创建了标签。</p><p id="5d89" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">数据扩充<strong class="kp ir"> </strong>的做法是增加训练集规模的有效方法。增加训练示例允许网络在训练期间“看到”更多样化但仍有代表性的数据点。</p><p id="59a8" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">然后我定义了两个数据生成器:一个用于训练数据，另一个用于验证数据。数据发生器<strong class="kp ir"> </strong>能够直接从源文件夹加载所需数量的数据(一个小批量的图像)，将它们转换成<em class="nh">训练数据</em>(输入到模型)和<em class="nh">训练目标</em>(一个属性向量——监督信号)。</p><blockquote class="ni nj nk"><p id="e3f2" class="kn ko nh kp b kq kr jr ks kt ku ju kv nl kx ky kz nm lb lc ld nn lf lg lh li ij bi translated"><em class="iq">对于我的实验，我通常设置</em> <code class="fe no np nq nr b"><em class="iq">batch_size = 64</em></code> <em class="iq">。一般来说，介于 32 和 128 之间的值应该可以。通常，您应该根据计算资源和模型的性能来增加/减少批量大小。</em></p></blockquote><figure class="kf kg kh ki gt kj"><div class="bz fp l di"><div class="na nb l"/></div></figure><p id="6043" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">之后我定义了一些常量以备后用。</p><figure class="kf kg kh ki gt kj"><div class="bz fp l di"><div class="na nb l"/></div></figure><p id="22a4" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">下一步是构建模型。这可以用以下 5 个步骤来描述。</p><ol class=""><li id="25fb" class="mm mn iq kp b kq kr kt ku kw ns la nt le nu li mr ms mt mu bi translated">我使用了五个卷积模块，包括卷积层、最大池和批量标准化。</li><li id="c57e" class="mm mn iq kp b kq mv kt mw kw mx la my le mz li mr ms mt mu bi translated">在它的顶部，我使用了一个扁平化层，然后是四个完全连接的层。</li><li id="6f25" class="mm mn iq kp b kq mv kt mw kw mx la my le mz li mr ms mt mu bi translated">此外，在此期间，我用辍学来减少过度拟合。</li><li id="2275" class="mm mn iq kp b kq mv kt mw kw mx la my le mz li mr ms mt mu bi translated">激活函数除了最后一层是 Sigmoid，因为这是一个二元分类问题。</li><li id="27e1" class="mm mn iq kp b kq mv kt mw kw mx la my le mz li mr ms mt mu bi translated">我使用 Adam 作为优化器，交叉熵作为损失。</li></ol><p id="815f" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">在训练之前，模型对于定义一个或多个回调是有用的。挺好用的一个，有:<code class="fe no np nq nr b">ModelCheckpoint</code>和<code class="fe no np nq nr b">EarlyStopping</code>。</p><ul class=""><li id="bf81" class="mm mn iq kp b kq kr kt ku kw ns la nt le nu li nv ms mt mu bi translated"><strong class="kp ir"> ModelCheckpoint </strong>:当训练需要大量时间才能达到一个好的结果时，往往需要多次迭代。在这种情况下，最好仅在改善度量的时期结束时保存最佳执行模型的副本。</li><li id="eafd" class="mm mn iq kp b kq mv kt mw kw mx la my le mz li nv ms mt mu bi translated"><strong class="kp ir">提前停止</strong>:有时，在训练过程中，我们可以注意到泛化差距(即训练和验证误差之间的差异)开始增大，而不是减小。这是过度拟合的症状，可以通过多种方式解决(<em class="nh">减少模型容量</em>、<em class="nh">增加训练数据</em>、<em class="nh">数据扩充</em>、<em class="nh">正规化</em>、<em class="nh">退出</em>等)。通常一个实用有效的解决方法是当泛化差距越来越大时停止训练。</li></ul><figure class="kf kg kh ki gt kj gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi nw"><img src="../Images/87d174b0485e2af0981f476f48e19332.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2zD7wwIwhIrHdr8F4urF2w.png"/></div></div><figcaption class="nd ne gj gh gi nf ng bd b be z dk">Early stopping</figcaption></figure><figure class="kf kg kh ki gt kj"><div class="bz fp l di"><div class="na nb l"/></div></figure><p id="a314" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">接下来，我以 32 的批量为 10 个时期训练模型。请注意，通常较大的批量会产生较好的结果，但代价是较高的计算负担。一些研究还声称，通过在超参数调整上投入一些时间，可以找到获得最佳结果的最佳批量。</p><figure class="kf kg kh ki gt kj"><div class="bz fp l di"><div class="na nb l"/></div></figure><figure class="kf kg kh ki gt kj"><div class="bz fp l di"><div class="na nb l"/></div></figure><p id="8ba1" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">让我们来看一下损耗和精度图。</p><figure class="kf kg kh ki gt kj"><div class="bz fp l di"><div class="na nb l"/></div></figure><figure class="kf kg kh ki gt kj gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/bf54946a17be2056f5c9a25ab07e5d4a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1224/format:webp/1*aNhCiZ5wrjKjqUG_JD6DwQ.png"/></div><figcaption class="nd ne gj gh gi nf ng bd b be z dk"><strong class="bd ny">Accuracy vs Epoch | Loss vs Epoch</strong></figcaption></figure><p id="bb04" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">到目前为止一切顺利。该模型是收敛的，这可以从随着时期的损失和验证损失的减少中观察到。此外，它能够在短短 10 个时期内达到 90%的验证准确性。</p><p id="75a1" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">让我们绘制混淆矩阵，并获得一些其他结果，如精确度、召回率、F1 分数和准确度。</p><figure class="kf kg kh ki gt kj"><div class="bz fp l di"><div class="na nb l"/></div></figure><pre class="kf kg kh ki gt nz nr oa ob aw oc bi"><span id="e207" class="od ll iq nr b gy oe of l og oh">CONFUSION MATRIX ------------------<br/>[[191  43]<br/> [ 13 377]]<br/><br/>TEST METRICS ----------------------<br/>Accuracy: 91.02564102564102%<br/>Precision: 89.76190476190476%<br/>Recall: 96.66666666666667%<br/>F1-score: 93.08641975308642<br/><br/>TRAIN METRIC ----------------------<br/>Train acc: 94.23</span></pre><p id="42b9" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">该模型能够达到 91.02%的准确度，考虑到所使用的数据量，这是相当好的。</p><h1 id="3faa" class="lk ll iq bd lm ln lo lp lq lr ls lt lu jw lv jx lw jz lx ka ly kc lz kd ma mb bi translated">结论</h1><p id="6924" class="pw-post-body-paragraph kn ko iq kp b kq mc jr ks kt md ju kv kw me ky kz la mf lc ld le mg lg lh li ij bi translated">虽然这个项目还远未完成，但在如此多样的现实世界问题中看到深度学习的成功是令人瞩目的。我已经演示了如何从一组 X 射线图像中对阳性和阴性肺炎数据进行分类。该模型是从零开始的，这使它有别于其他严重依赖迁移学习方法的方法。将来，这项工作可以扩展到检测和分类由肺癌和肺炎组成的 X 射线图像。区分包含肺癌和肺炎的 X 射线图像一直是最近的一个大问题，我们的下一个方法应该是解决这个问题。</p><h1 id="a002" class="lk ll iq bd lm ln lo lp lq lr ls lt lu jw lv jx lw jz lx ka ly kc lz kd ma mb bi translated">参考资料/进一步阅读</h1><div class="oi oj gp gr ok ol"><a href="https://medium.com/datadriveninvestor/training-a-cnn-to-detect-pneumonia-c42a44101deb" rel="noopener follow" target="_blank"><div class="om ab fo"><div class="on ab oo cl cj op"><h2 class="bd ir gy z fp oq fr fs or fu fw ip bi translated">训练 CNN 检测肺炎</h2><div class="os l"><h3 class="bd b gy z fp oq fr fs or fu fw dk translated">我清楚地记得那一天。我的祖父开始胡乱咳嗽，并开始呼吸困难。他是…</h3></div><div class="ot l"><p class="bd b dl z fp oq fr fs or fu fw dk translated">medium.com</p></div></div><div class="ou l"><div class="ov l ow ox oy ou oz kl ol"/></div></div></a></div><div class="oi oj gp gr ok ol"><a href="https://becominghuman.ai/detecting-pneumonia-with-deep-learning-3cf49b640c14" rel="noopener  ugc nofollow" target="_blank"><div class="om ab fo"><div class="on ab oo cl cj op"><h2 class="bd ir gy z fp oq fr fs or fu fw ip bi translated">用深度学习检测肺炎</h2><div class="os l"><h3 class="bd b gy z fp oq fr fs or fu fw dk translated">肺炎是由病毒、细菌、真菌或其他病原体感染引起的肺部炎症。根据……</h3></div><div class="ot l"><p class="bd b dl z fp oq fr fs or fu fw dk translated">becominghuman.ai</p></div></div><div class="ou l"><div class="pa l ow ox oy ou oz kl ol"/></div></div></a></div><div class="oi oj gp gr ok ol"><a href="https://stanfordmlgroup.github.io/projects/chexnet/" rel="noopener  ugc nofollow" target="_blank"><div class="om ab fo"><div class="on ab oo cl cj op"><h2 class="bd ir gy z fp oq fr fs or fu fw ip bi translated">CheXNet:通过深度学习对胸部 X 射线进行放射科医生级别的肺炎检测</h2><div class="os l"><h3 class="bd b gy z fp oq fr fs or fu fw dk translated">该数据集由美国国家卫生研究院发布，包含 30805 名不同患者的 112120 张正面 x 光图像，并附有注释…</h3></div><div class="ot l"><p class="bd b dl z fp oq fr fs or fu fw dk translated">stanfordmlgroup.github.io</p></div></div><div class="ou l"><div class="pb l ow ox oy ou oz kl ol"/></div></div></a></div><h1 id="fa12" class="lk ll iq bd lm ln lo lp lq lr ls lt lu jw lv jx lw jz lx ka ly kc lz kd ma mb bi translated">在你走之前</h1><p id="5df9" class="pw-post-body-paragraph kn ko iq kp b kq mc jr ks kt md ju kv kw me ky kz la mf lc ld le mg lg lh li ij bi translated">相应的源代码可以在这里找到。</p><div class="oi oj gp gr ok ol"><a href="https://github.com/abhinavsagar/Kaggle-tutorial" rel="noopener  ugc nofollow" target="_blank"><div class="om ab fo"><div class="on ab oo cl cj op"><h2 class="bd ir gy z fp oq fr fs or fu fw ip bi translated">abhinavsagar/ka ggle-教程</h2><div class="os l"><h3 class="bd b gy z fp oq fr fs or fu fw dk translated">Kaggle 竞赛笔记本样本。显微图像的自动分割是医学图像处理中的一项重要任务</h3></div><div class="ot l"><p class="bd b dl z fp oq fr fs or fu fw dk translated">github.com</p></div></div><div class="ou l"><div class="pc l ow ox oy ou oz kl ol"/></div></div></a></div><p id="2843" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">快乐阅读，快乐学习，快乐编码！</p><h1 id="33c7" class="lk ll iq bd lm ln lo lp lq lr ls lt lu jw lv jx lw jz lx ka ly kc lz kd ma mb bi translated">联系人</h1><p id="924e" class="pw-post-body-paragraph kn ko iq kp b kq mc jr ks kt md ju kv kw me ky kz la mf lc ld le mg lg lh li ij bi translated">如果你想了解我最新的文章和项目<a class="ae lj" href="https://medium.com/@abhinav.sagar" rel="noopener">，请关注我的媒体</a>。以下是我的一些联系人详细信息:</p><ul class=""><li id="cb50" class="mm mn iq kp b kq kr kt ku kw ns la nt le nu li nv ms mt mu bi translated"><a class="ae lj" href="https://abhinavsagar.github.io" rel="noopener ugc nofollow" target="_blank">个人网站</a></li><li id="575a" class="mm mn iq kp b kq mv kt mw kw mx la my le mz li nv ms mt mu bi translated"><a class="ae lj" href="https://in.linkedin.com/in/abhinavsagar4" rel="noopener ugc nofollow" target="_blank">领英</a></li><li id="6139" class="mm mn iq kp b kq mv kt mw kw mx la my le mz li nv ms mt mu bi translated"><a class="ae lj" href="https://medium.com/@abhinav.sagar" rel="noopener">中等轮廓</a></li><li id="2e6d" class="mm mn iq kp b kq mv kt mw kw mx la my le mz li nv ms mt mu bi translated"><a class="ae lj" href="https://github.com/abhinavsagar" rel="noopener ugc nofollow" target="_blank"> GitHub </a></li><li id="de97" class="mm mn iq kp b kq mv kt mw kw mx la my le mz li nv ms mt mu bi translated"><a class="ae lj" href="https://www.kaggle.com/abhinavsagar" rel="noopener ugc nofollow" target="_blank">卡格尔</a></li></ul></div></div>    
</body>
</html>