# 分类惩罚回归

> 原文：<https://towardsdatascience.com/penalized-regression-with-classification-f60bc663e8dc?source=collection_archive---------23----------------------->

![](img/8e470377348a92808a2dabd324277a6c.png)

Image by [Jill Wellington](https://pixabay.com/users/JillWellington-334088/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=553467) from [Pixabay](https://pixabay.com/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=553467)

[在之前的](https://medium.com/@damon.ray.roberts/penalized-regressions-with-jmp-e10628799aef)中，我们研究了使用 JMP 的套索和弹性网正则化方法。这些模型是为了预测连续变量而构建的，所以这次我们将研究分类变量。更具体地说，这是一个二分法变量，它决定了葡萄酒的质量是“好”还是“坏”。我们将使用普通和惩罚逻辑回归构建几个模型，包括套索和弹性网技术的基本和自适应形式，最后我们将使用我们的“最佳”模型基于新数据进行预测。

我们将采用与之前研究略有不同的模型分析方法。在创建单个分类模型时研究它们的统计数据给我们的信息非常少，所以我们将保存每个新创建的模型的预测。这些预测将在以后进行比较，以确定每个模型的准确性和其他统计数据。

在这项研究中，我们将看看在 2009 年的一项研究中影响人类专家如何对葡萄酒质量进行排名的一些因素。参与者用 1-10 的等级给一些葡萄酒打分，并记录下每个样品的各个方面。出于本研究的目的，4 分或更低的评级被视为“差”，而 5 分或更高的评级被视为“好”这给了我们一个二元反应变量，每种酒要么是好的，要么是坏的。该数据集中总共包括 12 个预测值，如酸度、柠檬酸、残糖、酒精含量和颜色。

第一步是准备将这个数据集输入到我们的模型中。我们再次使用了 60/20/20 的培训/验证/测试划分。然而，因为这是横截面数据，JMP 的验证列工具将观察值分配给每个名称，以确保随机性。大约 3，900 个观察值用于训练每个模型，而 1，300 个观察值用于验证和测试每个模型。然后，我们创建了一个包含所有变量的基本逻辑回归模型。这有助于稍后提供一个基线，以查看使用所有预测变量的模型与其他更专业的模型相比表现如何。

# 基本和自适应套索方法

在最初的分析之后，我们开始寻找广义回归，以追求更准确的预测模型。广义回归在必要时对某些变量施加惩罚，以减少它们对模型的影响。我们从套索开始，用基本方法和自适应方法创建了预测模型。套索法使用了 12 个预测变量中的 8 个，减少了密度、pH 值、硫酸盐和总二氧化硫对模型的影响。自适应套索采取了不同的方法，仅使用 7 个预测变量。pH 值、硫酸盐和二氧化硫总量的影响再次减弱。

![](img/0baa1a5a299d72ccca53775bb9b3ecb1.png)

Adaptive Lasso Variable Estimates

# 基本和自适应弹性网格方法

下一组模型使用弹性网络方法，再次使用基础和适应性方法。弹性网模型确定 12 个变量中有 9 个对模型很重要。总二氧化硫、pH 值和硫酸盐水平再次降低。我们已经可以预计，最终的模型可能不会使用这 3 个变量，这表明它们对葡萄酒的质量等级影响很小。使用自适应弹性网显示了类似的结果，同时也排除了柠檬酸和氯化物。使用新的弹性网络模型，我们创建了两组新的预测，并保存每组预测，以便与 lasso 和普通逻辑回归模型进行比较。

![](img/32ceea31c42673cddc4fb2da7a58020a.png)

Parameter Estimates for Adaptive Elastic Net Model

# 模型比较

保存了 5 组预测后，我们现在可以比较模型的准确性，看看某个特定的方法是否更好。正如我们在下面看到的，每个模型似乎都有一个相对较低的 R 平方值。然而，这个问题不同于以往的研究，我们的反应变量是如何分类的。在这项研究中，我们的响应变量是分类变量，而不是与实际值有可测量距离的数值。换句话说，预测和真实值之间不可能有距离，因为每个预测不是好就是坏。因此，R 平方值提供的信息非常少，因此我们需要查看其他度量来比较模型。更具体地说，我们想要观察错误分类率和 ROC 曲线下的面积。

错误分类率给出了预测出错频率的估计值。我们希望将这一比率降至最低，以减少对葡萄酒质量进行错误分类的机会。另一个指标，ROC 曲线下面积(或 AUC)理想地尽可能高。

ROC 曲线绘制了模型对 1 减去其特异性的灵敏度。这有助于表明我们的模型的**真阳性**率(模型正确猜测好酒的能力)是如何受模型的**假阳性**率(劣质酒被归类为好酒的频率)影响的。计算该图下的面积，并将其用作模型准确性的另一种度量。一个完全准确的模型的 AUC 为 1.0，表明其预测 100%正确。我们希望找到一个具有最高可能 AUC 的模型，这与更高的模型准确性相关。

![](img/98d8f04157fe15375d22806cafcfa7f4.png)

Comparison of Classification Model Predictions

我们可以在上面的模型比较中看到 R 平方值有多低。由于我们的响应变量的性质，很难从这些值中提取任何有意义的数据，因此我们可以安全地忽略这些测量。相反，如上所述，我们将在测试数据集上比较每个模型的误分类率和 AUC。我们可以看到自适应套索和弹性网模型的错误分类率最低，相差很小，因此我们将这两个模型视为最佳模型。自适应套索的 AUC 为 0.7862，而自适应弹性网的 AUC 为 0.7861。因为这两个值非常接近，所以有理由认为这两个值中的任何一个都最适合我们的数据。为了这项研究，我们将使用适应性套索作为我们的最佳选择。

这里需要注意的一点是，每个型号的值非常相似。我们模型的错误分类率是 0.039 或 0.040，AUC 也在一个很小的范围内。这是因为在我们的数据集中只有几个变量和大量的观察值。在有限的变量池中，每个模型的构建方式几乎没有什么差异，因此预计模型会具有相似的精度。

![](img/3876a53fec409c81b41ad0bbba207cc1.png)

Variable Use in Adaptive Lasso Model

在上图中，我们可以看到在自适应套索模型中选择使用的变量。正如所料，pH 值、硫酸盐和总二氧化硫在模型中的权重为 0。柠檬酸和氯化物也被认为是多余的或不需要的，所以它们的值被缩小到 0。挥发性酸度、颜色和残糖似乎对葡萄酒等级有很大的影响。挥发性酸度的负系数约为-5.54，表明与葡萄酒等级呈负相关。换句话说，随着酸度的增加，被归类为“好”的概率会降低。残糖有相反的关系，糖含量的增加往往会增加一个好的评级的机会。酒色[红白]在自适应套索模型中也有正系数。这表明红葡萄酒比白葡萄酒更有可能被评为好酒。

![](img/f49f5b33de5525be24c88a649a9c22d6.png)

Variable Importance on Model

我们可以更进一步，研究每个变量在我们的预测模型中的重要性。在上图中，残糖似乎是葡萄酒质量分类的最大因素。约 47%的预测受残糖水平影响，41%受密度影响，34%的分类受挥发性酸度影响。基于我们的发现，有理由假设含糖量较高、密度较低的葡萄酒更有可能被归类为好酒。

# 对新数据的预测

我们还可以使用我们的模型来预测新酒的分类。假设新酒有以下数据，我们可以预测它会被归类为好还是坏:

固定酸度=8.9
挥发酸度= .90
柠檬酸=.35
pH=3.20
残糖=4.8
氯化物=.09
游离二氧化硫=4
总二氧化硫=40
密度=.99
硫酸盐=.65
酒精=9.0
颜色=红色

![](img/5c0ffdfca357ed34c1d8c1fbbc5bc7a4.png)

我们知道我们选择的自适应套索模型只使用了 7 个变量。将这些值输入到我们的模型中提供了 0.9516 的概率。因此，我们可以估计这种特殊的葡萄酒被归类为“好”的概率约为 95%。

这项研究的数据可以在我的[GitHub](https://github.com/drayroberts/Data-Resources/blob/master/WineQualityStudy.jmp)(wine quality study . jmp)上找到。