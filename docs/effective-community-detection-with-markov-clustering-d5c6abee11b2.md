# 基于马尔可夫聚类的有效社区发现

> 原文：<https://towardsdatascience.com/effective-community-detection-with-markov-clustering-d5c6abee11b2?source=collection_archive---------24----------------------->

这个帖子最早出现在[**amethix.com**](http://amethix.com)

![](img/d8baea98174befee73398c8125b8ed51.png)

> *“如果智能是一块蛋糕，蛋糕的大部分是无监督学习，蛋糕上的糖衣是监督学习，蛋糕上的樱桃是强化学习”。*

这句来自脸书人工智能首席执行官 [Yann LeCun](http://yann.lecun.com/) 的名言强调了人类是如何依赖*无监督学习的。*利用马尔可夫聚类进行有效的社区发现。他们用这种方法来理解他们周围的世界。事实上，孩子们在没有太多监督的情况下就学会了辨认物体和说话。相比之下，复杂的深度学习算法需要数百万仔细注释的数据。这对于在物体检测和语言生成等任务中达到类似人类的性能是必要的。

这篇文章为你提供了一个利用马尔可夫聚类进行有效社区发现的好方法。

在这个领域中，一个人可以将**聚类**视为以无监督方式从数据中学习有趣模式的最有用的工具之一。

# 聚类方法

无论是对电子邮件进行分类还是进行客户细分，*聚类*在大多数时候都是可行的方法。这种方法包括将数据集分成组(或聚类)，使得属于同一聚类的对象比属于不同聚类的项目更相似。可以根据特定的度量来计算这种相似性，该度量当然可以随着要解决的问题而改变。

数据科学家在表格数据的探索性数据分析中使用聚类算法，如 k-means、层次聚类或 DBSCAN。还有另一种类型的数据也很常见:网络。在网络分析行话中，研究人员将聚类网络数据称为*社区检测*。在这种情况下，集群代表*社区。*分别参考【1】和【2】获得关于聚类网络的社区检测和最新算法的更多细节。

这篇文章的目的是揭示一种被称为**马尔可夫聚类(MCL)的特定算法的一些最重要的特性。**研究人员设计这种算法主要是为了执行社区检测。但是，也可以使用 MCL 对表格数据进行聚类。在参考文献[3]中提供了 MCL 算法的更多技术解释，并且在[4]中详细描述了该方法在聚类生物序列中的应用。现在让我们刷新一些图论的概念，这将有助于理解 MCL 技术的工作机制。

# 图和随机漫步

在之前的[帖子](https://amethix.com/beyond-deep-learning-part-2/)中提到过，自然界中的许多系统都可以用**图**来表示。图只不过是由边连接起来的一组节点。社交网络可能是最熟悉的图表例子。节点代表用户，而连接任意两个节点的边代表两个用户相互交互的事实。

分析图表并从模拟中获得洞察力的一种常见方法是所谓的**随机漫步**。这里有一个例子来阐明随机漫步的含义。假设有一个游客，他从家乡出发，准备去几个城市旅游。人们可以把城市看作是图中的节点。只要有可能从一个城市直接到达另一个城市，这样的节点就通过边连接。让我们假设前面提到的游客被惊喜惊呆了。她没有提前计划她的旅行，她随机选择了下一个城市。

# 数学表示

从数学的角度来看，游客的旅行是一个被称为随机行走的随机过程。一个自然的问题可能会出现:从长远来看，我们的游客下一步会去哪些城市？这个问题的答案取决于这些城市之间的联系。例如，如果城市形成分离良好的集群(**连接组件**)，并且游客在这些集群中的一个内开始她的旅行，她可能永远无法到达其他集群中的任何城市。
模拟图上的随机行走准确地代表了 MCL 算法背后的思想。

# MCL 算法

MCL 算法的目的是找到一个聚类结构。这是通过模拟图上的随机游走直到达到平衡来实现的。
我们需要采取的第一步是获得上述图表。

*   在网络数据的情况下，要执行的唯一任务是计算邻接矩阵 a。这样的矩阵完美地描述了网络。这种矩阵的定义是:如果从顶点 *i* 到顶点 *j* 有一条边，Aij= 1，否则为 0
*   在表格数据的情况下，必须构建一个**相似矩阵**。这是通过计算所有现有记录(即表的行)之间的成对相似性来实现的。这种相似性矩阵表示一个加权图。这种图的节点表示观察值，边具有对应于它们之间的相似性得分的权重。

# 扩张和通货膨胀

通过适当缩放邻接矩阵或相似矩阵，可以获得**马尔可夫矩阵**。这是一个概率矩阵，表示一个节点到达它所连接的另一个节点的机会。
最后，一旦建立了马尔可夫矩阵，就可以通过交替使用两个叫做**展开**和**膨胀**的操作符来模拟图上的随机游走。

*扩展*允许随机漫步机走更长的路径。例如从一个节点到另一个节点需要大量的步骤。
*膨胀*通过支持可能性较大的遍历而不是可能性较小的遍历来改变转移概率。

扩张和膨胀的结合将提高每个集群内部的行走概率。此外，它将减少集群之间的行走。这是因为同一个集群内的路径比不同集群之间的路径更长。

这样的行为长期会出现。扩展和膨胀操作的迭代导致图形分离成不同的*连接部分*。因此，与许多需要用户预先指定预期聚类数的聚类算法(有时会出错)不同，MCL 算法提供了一种将数据划分为聚类的方法，这种方法是从图拓扑本身自然产生的。

# Python 中的一个实际例子

让我们看看如何在 Python 中使用 MCL 算法，以及如何通过马尔可夫聚类来执行有效的社区检测。
首先用`pip install markov_clustering[drawing]`和`networkx`包安装实现算法所需的包，进行图形分析和可视化。

然后执行下面的代码

```
# Import libraries
import markov_clustering as mc
import networkx as nx

# Load network data
G = nx.karate_club_graph()

# Build adjacency matrix
A = nx.to_numpy_matrix(G)

# Run MCL algorithm
result = mc.run_mcl(A)
clusters = mc.get_clusters(result)

# Draw clusters
mc.draw_graph(A, clusters, node_size=50, with_labels=True, edge_color="silver")
```

在上面的代码中，我们使用 MCL 算法来检测 Zachary 的空手道俱乐部中的集群，也称为社区，这是一个测试社区检测算法的流行基准。扎卡里空手道俱乐部是一个大学空手道俱乐部的社交网络。该网络捕获了一个空手道俱乐部的 34 名成员，记录了在俱乐部外互动的成对成员之间的联系。

在研究过程中，管理者(节点 0)和指导者(节点 33)之间产生了冲突，导致俱乐部分裂为两个子图。一半的成员围绕着教官组建了新的社团，另一部分的成员则找到了新的教官或者放弃了空手道。

如下图所示，MCL 算法很好地检测到了网络中两个不同社区的存在，这两个社区的成员大多与管理员或教师有交互:

在这篇文章中，我们看到了如何通过组合简单的概念，如随机漫步、图形、相似矩阵，来构建一个称为马尔可夫聚类的社区检测算法。此外，我们强调了如何构建一个相似性图，然后在这样的图上运行一个有效的社区检测算法(如马尔可夫聚类或其他最先进的方法)来发现*表格数据*中的聚类。

跟随播客[**【https://datascienceathome.com/】**](http://datascienceathome.com)
别忘了加入我们新的不和谐频道的对话[](https://discord.gg/4UNKGf3)**。那里见！**

# **参考**

**[1] S. Fortunato，“图形中的社区检测”，《物理报告》，第 486 卷，第 3-5 期，第 75-174 页，2010 年 2 月。**

**[2] Z. Yang 等，“人工网络上社区发现算法的比较分析”，《科学报告》第 6 卷，文章编号:30750 (2016)**

**[3] S. Dongen，“图的聚类算法”，技术报告，CWI(数学和计算机科学中心)，荷兰阿姆斯特丹，2000 年。**

**[4] A. J. Enright 等人，“大规模检测蛋白质家族的有效算法”，核酸研究，第 30 卷，第 7 期，第 1575-1584 页，2002 年。**

***原载于 2019 年 8 月 21 日*[*https://amethix.com*](https://amethix.com/effective-community-detection-with-markov-clustering/)*。***