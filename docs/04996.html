<html>
<head>
<title>Introducing Distython. New Python package implementing novel distance metrics</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">介绍 Distython。新的 Python 包实现了新的距离度量</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/distython-5de10f342c93?source=collection_archive---------13-----------------------#2019-07-27">https://towardsdatascience.com/distython-5de10f342c93?source=collection_archive---------13-----------------------#2019-07-27</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="18b7" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">您在为混合型数据集选择正确的距离度量时遇到过问题吗？在大多数情况下，您可以尝试执行要素预处理，然后使用一些流行的距离度量，如欧几里德距离或曼哈顿距离。事实上，这种方法可能是不准确的，并导致 ML 模型的性能下降。看看<a class="ae ko" href="https://github.com/KacperKubara/distython" rel="noopener ugc nofollow" target="_blank"> Distython </a> — Python 包，它实现了研究论文中新颖的混合型距离度量！</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi kp"><img src="../Images/c280db3fa311f768d7299d75df435c64.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*r7y6Ucm2c0-jaepK"/></div></div><figcaption class="lb lc gj gh gi ld le bd b be z dk">Photo by <a class="ae ko" href="https://unsplash.com/@charlesdeluvio?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Charles 🇵🇭</a> on <a class="ae ko" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="8b5e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">最近实习的时候遇到过这个问题。我不得不在混合类型的数据集中使用 K-NN 来度量实例之间的相似性，该数据集中也有缺失值！虽然我可能会尝试做一些“花哨”的特征预处理，使其与流行的距离度量一起工作，但我不认为这是获得可靠结果的好方法。这让我开始寻找既能处理混合型数据又能处理缺失值的距离度量。读了几篇论文后，我发现了几个有趣的指标，这促使我在这里<a class="ae ko" rel="noopener" target="_blank" href="/the-proper-way-of-handling-mixed-type-data-state-of-the-art-distance-metrics-505eda236400">发表了另一篇关于它们的文章</a>。与此同时，我也开始研究它们的实现，这让我创建了一个名为 Distython 的小型实用 Python 包！在接下来的文章中，我将解释它如何对您的 ML 模型有用，如何与 Scikit-Learn 集成，并简要解释代码的设计。</p></div><div class="ab cl lf lg hx lh" role="separator"><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk"/></div><div class="im in io ip iq"><p id="9382" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我喜欢数据科学的原因是，它吸引了许多对人工智能和数据科学充满热情的志同道合的人。这就是为什么我想在<a class="ae ko" href="http://www.linkedin.com/in/kacperkubara?source=post_page---------------------------" rel="noopener ugc nofollow" target="_blank"> Linkedin </a>上与你联系！您也可以通过我的<a class="ae ko" href="http://www.kacperkubara.com/?source=post_page---------------------------" rel="noopener ugc nofollow" target="_blank">个人网站</a>留下任何反馈和问题😎</p></div><div class="ab cl lf lg hx lh" role="separator"><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk"/></div><div class="im in io ip iq"><h2 id="ef74" class="lm ln it bd lo lp lq dn lr ls lt dp lu kb lv lw lx kf ly lz ma kj mb mc md me bi translated">Distython 概述</h2><p id="832d" class="pw-post-body-paragraph jq jr it js b jt mf jv jw jx mg jz ka kb mh kd ke kf mi kh ki kj mj kl km kn im bi translated">(链接到 GitHub repo <a class="ae ko" href="https://github.com/KacperKubara/distython" rel="noopener ugc nofollow" target="_blank">这里</a>)</p><p id="e0ab" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">Distython 是一个小型的、高效的实用程序包，它实现了混合型距离度量。最初，我把它作为个人使用，但是我想如果我把它公开的话可能会更有用。它实现了 3 种算法:异质欧几里德重叠度量(HEOM)，价值差异度量(VDM)和异质价值差异度量(HVDM)。所有这些都在我之前的<a class="ae ko" rel="noopener" target="_blank" href="/the-proper-way-of-handling-mixed-type-data-state-of-the-art-distance-metrics-505eda236400">文章</a>中解释过，也可以在<a class="ae ko" href="https://arxiv.org/pdf/cs/9701101.pdf" rel="noopener ugc nofollow" target="_blank">这篇研究论文</a>中找到。它们可以直接与一些 Scikit-Learn 算法一起使用(那些允许指定用户定义的度量的算法，例如最近邻或 Dbscan)。你也可以将它们与特定的插补算法一起使用，比如 MICE、K-NN 或 MissForest(我也写了一篇关于它们的文章<a class="ae ko" rel="noopener" target="_blank" href="/why-using-a-mean-for-missing-data-is-a-bad-idea-alternative-imputation-algorithms-837c731c1008"/></p><p id="dcb0" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><a class="ae ko" href="https://github.com/KacperKubara/distython" rel="noopener ugc nofollow" target="_blank"> Distython </a>完全基于 Numpy。这使得它更快，并减少了所需的包依赖的数量。这里唯一的缺点是它降低了代码的可读性，但是当你试图创建高效的代码时，这通常是一个问题😀</p><h2 id="4bde" class="lm ln it bd lo lp lq dn lr ls lt dp lu kb lv lw lx kf ly lz ma kj mb mc md me bi translated">为什么它有用</h2><p id="727e" class="pw-post-body-paragraph jq jr it js b jt mf jv jw jx mg jz ka kb mh kd ke kf mi kh ki kj mj kl km kn im bi translated">它解决了一个以前没有解决的问题，即创建一个公开可用的异构距离度量集合。老实说，当我发现 Scikit-Learn 没有任何异构度量时，我感到非常惊讶。假设数据集要么是连续的，要么是分类的，这似乎是非常错误的，是吧？</p><h2 id="9961" class="lm ln it bd lo lp lq dn lr ls lt dp lu kb lv lw lx kf ly lz ma kj mb mc md me bi translated">非异构方法与分布式</h2><p id="3285" class="pw-post-body-paragraph jq jr it js b jt mf jv jw jx mg jz ka kb mh kd ke kf mi kh ki kj mj kl km kn im bi translated">让我们来看一个非常简单的数据集，它包含分类和连续的特征以及一些缺失值。我们需要测量两个实例<strong class="js iu"> A </strong>和<strong class="js iu"> B </strong>之间的距离。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div class="gh gi mk"><img src="../Images/2cc3d4beb05771d449b0b34250c7aebd.png" data-original-src="https://miro.medium.com/v2/resize:fit:730/format:webp/1*BWug6jACnX6YdDj1_ybw_w.png"/></div><figcaption class="lb lc gj gh gi ld le bd b be z dk">Simple dataset for the purpose of the example</figcaption></figure><p id="2355" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">非异构方法:</strong>例如，如果您要使用 Scikit-Learn，则没有异构度量可供选择。克服这个问题的一个方法是一个变通的解决方案，它可能会给你不正确的结果:</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi ml"><img src="../Images/bbbabbd8180f4a64b0a58af87e1baa64.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZPV0kDcCVNZm-OQ0wffM3Q.png"/></div></div></figure><p id="8951" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">为了计算<strong class="js iu"> A </strong>和<strong class="js iu">B</strong>之间的距离，你需要对数字数据进行分类，这会导致信息的丢失。这里的另一个大问题是，在对特性进行编码之后，你将会得到很多列(维数灾难在这里适用)！</p><p id="2e2f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">你准备好了吗？这里只有一件事要做…将您选择的距离度量应用于这些实例。很简单，是吧？要将度量附加到 Sklearn 的 K-NN 实现中，您只需要一行代码！</p><figure class="kq kr ks kt gt ku"><div class="bz fp l di"><div class="mm mn l"/></div></figure></div><div class="ab cl lf lg hx lh" role="separator"><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk"/></div><div class="im in io ip iq"><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi mo"><img src="../Images/fdd941ce24eb2e20de1268af0fa1ca12.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bYjDmdm4rPNU6dX4V1cTbQ.jpeg"/></div></div></figure><h2 id="b20f" class="lm ln it bd lo lp lq dn lr ls lt dp lu kb lv lw lx kf ly lz ma kj mb mc md me bi translated">Distython with Scikit-Learn</h2><p id="07f0" class="pw-post-body-paragraph jq jr it js b jt mf jv jw jx mg jz ka kb mh kd ke kf mi kh ki kj mj kl km kn im bi translated">这些指标被设计为可以直接应用于 Scikit-Learn 中的最近邻或 Dbscan 类。您可以将它与 Scikit-Learn 类一起用于您的个人项目，只要它们提供一个调用定制度量函数的接口。请注意，如果我们将指标附加到 Scikit-Learn 类，它会生成函数的开销调用，算法会变慢。</p><figure class="kq kr ks kt gt ku"><div class="bz fp l di"><div class="mm mn l"/></div><figcaption class="lb lc gj gh gi ld le bd b be z dk">Importing necessary libraries</figcaption></figure><p id="8d42" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在上面的代码中，我们导入了必要的库和 HEOM 度量。我们还将使用波士顿房价数据集，因为它同时具有分类和数字特征。</p><figure class="kq kr ks kt gt ku"><div class="bz fp l di"><div class="mm mn l"/></div><figcaption class="lb lc gj gh gi ld le bd b be z dk">Define the indices for categorical variables and NaN equivalent</figcaption></figure><p id="97e6" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这里，我们导入数据并将其定义为 boston_data。这里重要的部分是我们必须告诉 HEOM 度量什么列是分类的。<em class="mp"> nan_eqv </em>在这里用来告诉 HEOM<em class="mp">NaN</em>是怎么表示的。需要注意的重要一点是:最近的邻居不能直接处理<em class="mp"> np.nan </em>，所以我们<em class="mp">需要</em>来声明某些 nan 等价。</p><figure class="kq kr ks kt gt ku"><div class="bz fp l di"><div class="mm mn l"/></div><figcaption class="lb lc gj gh gi ld le bd b be z dk">Introducing missingness to the dataset</figcaption></figure><p id="f66b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在上面的代码部分中，我们将缺失引入数据(出于示例的目的)并将其指定为<em class="mp"> nan_eqv。</em></p><figure class="kq kr ks kt gt ku"><div class="bz fp l di"><div class="mm mn l"/></div><figcaption class="lb lc gj gh gi ld le bd b be z dk">Defining heom_metric and neighbor</figcaption></figure><p id="86da" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">然后，我们定义我们的<em class="mp"> heom_metric </em>并提供必要的参数。它必须在<em class="mp"> NearestNeighbors </em>之前定义，因为我们必须提供一个从<em class="mp"> heom_metric </em>到<em class="mp"> neighbor </em>实例<em class="mp">的可调用度量函数。</em>这就是将 HEOM 与 Scikit-Learn 一起使用的全部内容。这很简单，不是吗？有关使用 Scikit-Learn 的自定义距离度量的更多信息，请点击<a class="ae ko" href="https://scikit-learn.org/stable/modules/generated/sklearn.neighbors.DistanceMetric.html" rel="noopener ugc nofollow" target="_blank">此处</a>。</p><figure class="kq kr ks kt gt ku"><div class="bz fp l di"><div class="mm mn l"/></div><figcaption class="lb lc gj gh gi ld le bd b be z dk">Fitting the data and printing the results</figcaption></figure><p id="e151" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在最后一步中，我们拟合模型，并使用 HEOM 作为距离度量函数返回 5 个最近邻。</p><h2 id="4b68" class="lm ln it bd lo lp lq dn lr ls lt dp lu kb lv lw lx kf ly lz ma kj mb mc md me bi translated">最后几句话要说</h2><p id="c4cd" class="pw-post-body-paragraph jq jr it js b jt mf jv jw jx mg jz ka kb mh kd ke kf mi kh ki kj mj kl km kn im bi translated">该软件包仍处于早期阶段，所以它可能包含一些错误。请看看 Github 库，并建议一些代码的改进或扩展。我将很高兴地欢迎任何建设性的反馈，并随时为 Distython 做贡献！😉</p><h2 id="8dc1" class="lm ln it bd lo lp lq dn lr ls lt dp lu kb lv lw lx kf ly lz ma kj mb mc md me bi translated">参考</h2><p id="2094" class="pw-post-body-paragraph jq jr it js b jt mf jv jw jx mg jz ka kb mh kd ke kf mi kh ki kj mj kl km kn im bi translated">来自<strong class="js iu">Distython with Scikit-Learn</strong>段落的大部分材料摘自我之前的文章<a class="ae ko" rel="noopener" target="_blank" href="/the-proper-way-of-handling-mixed-type-data-state-of-the-art-distance-metrics-505eda236400">这里的</a>。</p></div></div>    
</body>
</html>