# 一种不断更新的 k-means 算法

> 原文：<https://towardsdatascience.com/a-continuously-updating-k-means-algorithm-89584ca7ee63?source=collection_archive---------15----------------------->

## 一种改进的 k-means 模型，可以不断学习新的例子

![](img/f0b20b863a03997431b72b6879a09d7a.png)

Photo by [JESHOOTS.COM](https://unsplash.com/@jeshoots?utm_source=medium&utm_medium=referral) on [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral)

# **概述**

我们都听说过流行的 k-means 算法，该算法用于在我们的数据中查找聚类，它基本上是基于现有特征对相似的点进行分组。无论如何，我不会用算法的细节来烦你，你们大多数人可能已经很熟悉了。我有兴趣讨论的是 k-means 的扩展版:一个可以不时用新数据更新，变得更加信息丰富的 k-means 模型。比方说，今天我们有一个特定产品公司的用户行为的大约一百万个数据点。我们对我们的数据应用 k-means 算法，并使用肘图得出一些 k 聚类。一个月后，我们获得了额外的 10k 个数据点，其中包含我们希望包含在模型中的用户行为的最新信息。

我们应该对整个数据运行 k-means 吗？请记住，在大规模数据集上运行 k-means 可能需要大量计算。我们正在讨论定期更新模型，以包含定期出现的新数据。聪明的做法是用新信息更新现有模型，我们称之为 delta 模型。

新型号=旧型号+ Delta 型号

这是一种简单而强大的技术，用于在生产级别维护模型。我将详细讨论该算法，但让我们先看看经典的 k-means 算法。

# **经典 K 均值算法**

让我们试着从头开始编写 k-means 算法。以下是实现 k-means 算法的步骤:

1.  通过从数据中随机选择 k 个点来初始化被称为质心的 k 个聚类中心。还有一种用于初始化中心的技术叫做 k-means++我们在这里不讨论。
2.  计算每个数据点与这些中心的距离，并将它们分配给最近或距离最小的中心。
3.  通过取一个聚类中所有点的平均值来重新计算聚类中心。这些可能在数据集中，也可能不在数据集中。
4.  计算新中心到旧中心的距离总和，我们称之为误差。检查误差是否大于容许值，并重复步骤 2 和 3，直到误差低于容许值，这意味着算法已经收敛。这将是最终的聚类中心和各自的点。

python 中的实现看起来有点像这样:

# **改进的 k-means 算法**

k-means 类可用于训练模型和对新数据进行预测。现在，让我们看看如何整合新的数据和更新我们的 k 均值模型。

1.  计算一个新数据点到所有聚类中心的距离，并找出这些距离中的最小值。
2.  检查最小距离是否小于阈值。如果为真，我们将新的数据点分配给相应的集群。然后，更新该聚类的聚类中心。
3.  如果为 False，则创建一个新的聚类，并将该新数据点指定为其中心。此外，数据点成为集群的一部分。
4.  我们可以用一系列新数据点重复相同的步骤来更新我们的模型。我们的模型现在比以前更好，因为它看到了更多的数据。

我们改进的具有更新功能的 k-means 类的代码可以写成这样:

测试阵列中包含了一个示例。干杯！