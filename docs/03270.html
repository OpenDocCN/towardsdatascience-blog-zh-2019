<html>
<head>
<title>Churn Prediction</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">流失预测</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/churn-prediction-3a4a36c2129a?source=collection_archive---------2-----------------------#2019-05-25">https://towardsdatascience.com/churn-prediction-3a4a36c2129a?source=collection_archive---------2-----------------------#2019-05-25</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="ip iq gp gr ir is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/53074a26caaa9841717a666bb606b13f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mkPFjMXg9ufqb5_1MNASIA@2x.jpeg"/></div></div></figure><h2 id="b395" class="iz ja jb bd b dl jc jd je jf jg jh dk ji translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsdatascience.com/tagged/data-driven-growth" rel="noopener" target="_blank">使用 Python 实现数据驱动的增长</a></h2><div class=""/><div class=""><h2 id="eece" class="pw-subtitle-paragraph kh jk jb bd b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky dk translated">基于 XGBoost 二元分类的流失预测</h2></div><p id="5bf0" class="pw-post-body-paragraph kz la jb lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated">这一系列文章旨在解释如何以一种简单的方式使用 Python，通过将预测方法应用于您的所有行动来推动您公司的发展。它将是编程、数据分析和机器学习的结合。</p><p id="94b3" class="pw-post-body-paragraph kz la jb lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated">我将在以下九篇文章中讨论所有主题:</p><p id="a4df" class="pw-post-body-paragraph kz la jb lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated">1- <a class="ae lv" rel="noopener" target="_blank" href="/data-driven-growth-with-python-part-1-know-your-metrics-812781e66a5b?source=post_page---------------------------">了解你的衡量标准</a></p><p id="dfca" class="pw-post-body-paragraph kz la jb lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated">2- <a class="ae lv" rel="noopener" target="_blank" href="/data-driven-growth-with-python-part-2-customer-segmentation-5c019d150444?source=post_page---------------------------">客户细分</a></p><p id="4011" class="pw-post-body-paragraph kz la jb lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated">3- <a class="ae lv" rel="noopener" target="_blank" href="/data-driven-growth-with-python-part-3-customer-lifetime-value-prediction-6017802f2e0f?source=post_page---------------------------">客户终身价值预测</a></p><p id="38bb" class="pw-post-body-paragraph kz la jb lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated"><strong class="lb jl"> 4-流失预测</strong></p><p id="4437" class="pw-post-body-paragraph kz la jb lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated"><a class="ae lv" rel="noopener" target="_blank" href="/predicting-next-purchase-day-15fae5548027?source=post_page---------------------------"> 5-预测下一个购买日</a></p><p id="a37a" class="pw-post-body-paragraph kz la jb lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated"><a class="ae lv" rel="noopener" target="_blank" href="/predicting-sales-611cb5a252de?source=post_page---------------------------"> 6-预测销售额</a></p><p id="5b06" class="pw-post-body-paragraph kz la jb lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated"><a class="ae lv" rel="noopener" target="_blank" href="/market-response-models-baf9f9913298"> 7-市场反应模型</a></p><p id="f70b" class="pw-post-body-paragraph kz la jb lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated"><a class="ae lv" rel="noopener" target="_blank" href="/uplift-modeling-e38f96b1ef60"> 8-隆起建模</a></p><p id="ab65" class="pw-post-body-paragraph kz la jb lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated"><a class="ae lv" rel="noopener" target="_blank" href="/a-b-testing-design-execution-6cf9e27c6559"> 9- A/B 测试设计和执行</a></p><p id="af76" class="pw-post-body-paragraph kz la jb lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated">文章将有自己的代码片段，使您可以轻松地应用它们。如果你是编程的超级新手，你可以在这里很好地介绍一下<a class="ae lv" href="https://www.kaggle.com/learn/python?source=post_page---------------------------" rel="noopener ugc nofollow" target="_blank"> Python </a>和<a class="ae lv" href="https://www.kaggle.com/learn/pandas?source=post_page---------------------------" rel="noopener ugc nofollow" target="_blank"> Pandas </a>(一个我们将在任何事情上使用的著名库)。但是仍然没有编码介绍，您可以学习概念，如何使用您的数据并开始从中产生价值:</p><blockquote class="lw"><p id="eca5" class="lx ly jb bd lz ma mb mc md me mf lu dk translated">有时候你得先跑，然后才能走——托尼·斯塔克</p></blockquote><p id="188d" class="pw-post-body-paragraph kz la jb lb b lc mh kl le lf mi ko lh li mj lk ll lm mk lo lp lq ml ls lt lu ij bi translated">作为先决条件，确保你的电脑上安装了 J <a class="ae lv" href="https://jupyter.readthedocs.io/en/latest/install.html?source=post_page---------------------------" rel="noopener ugc nofollow" target="_blank"> upyter Notebook </a>和 P <a class="ae lv" href="https://www.python.org/downloads/?source=post_page---------------------------" rel="noopener ugc nofollow" target="_blank"> ython </a>。代码片段只能在 Jupyter 笔记本上运行。</p><p id="a414" class="pw-post-body-paragraph kz la jb lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated">好吧，我们开始吧。</p><h1 id="41c4" class="mm mn jb bd mo mp mq mr ms mt mu mv mw kq mx kr my kt mz ku na kw nb kx nc nd bi translated">第 4 部分:流失预测</h1><p id="d5bc" class="pw-post-body-paragraph kz la jb lb b lc ne kl le lf nf ko lh li ng lk ll lm nh lo lp lq ni ls lt lu ij bi translated">在数据驱动增长系列的最后三节中，我们发现了<a class="ae lv" rel="noopener" target="_blank" href="/data-driven-growth-with-python-part-1-know-your-metrics-812781e66a5b">跟踪基本指标</a>、<a class="ae lv" rel="noopener" target="_blank" href="/data-driven-growth-with-python-part-2-customer-segmentation-5c019d150444">客户细分</a>，以及<a class="ae lv" rel="noopener" target="_blank" href="/data-driven-growth-with-python-part-3-customer-lifetime-value-prediction-6017802f2e0f">以编程方式预测生命周期价值</a>。既然我们通过细分和终身价值预测了解我们的最佳客户，我们也应该努力留住他们。这使得留存率成为最重要的指标之一。</p><p id="de4c" class="pw-post-body-paragraph kz la jb lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated">保留率是你的产品市场适合度的一个指标(PMF)。如果你的 PMF 不令人满意，你应该看到你的客户很快就会流失。提高保留率(即 PMF)的有力工具之一是客户流失预测。通过使用这种技术，你可以很容易地找出谁有可能在特定时期流失。在本文中，我们将使用一个电信数据集，并按照以下步骤开发一个客户流失预测模型:</p><ul class=""><li id="bf16" class="nj nk jb lb b lc ld lf lg li nl lm nm lq nn lu no np nq nr bi translated">探索性数据分析</li><li id="f2cd" class="nj nk jb lb b lc ns lf nt li nu lm nv lq nw lu no np nq nr bi translated">特征工程</li><li id="bf24" class="nj nk jb lb b lc ns lf nt li nu lm nv lq nw lu no np nq nr bi translated">用逻辑回归研究特征如何影响记忆</li><li id="ab7d" class="nj nk jb lb b lc ns lf nt li nu lm nv lq nw lu no np nq nr bi translated">用 XGBoost 构建分类模型</li></ul><h2 id="90dc" class="nx mn jb bd mo ny nz dn ms oa ob dp mw li oc od my lm oe of na lq og oh nc jh bi translated">探索性数据分析</h2><p id="cb7f" class="pw-post-body-paragraph kz la jb lb b lc ne kl le lf nf ko lh li ng lk ll lm nh lo lp lq ni ls lt lu ij bi translated">我们首先检查我们的数据看起来如何，并想象它如何与我们的标签交互(搅动与否？).让我们从导入数据开始，打印前十行:</p><pre class="oi oj ok ol gt om on oo op aw oq bi"><span id="3bbe" class="nx mn jb on b gy or os l ot ou">df_data = pd.read_csv('churn_data.csv')<br/>df_data.head(10)</span></pre><p id="12cd" class="pw-post-body-paragraph kz la jb lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated">输出:</p><figure class="oi oj ok ol gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ov"><img src="../Images/28b069a02a217a9232155ad6a8bc8aa9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZYYOLfqcLyp_pkdjIEhLbg.png"/></div></div></figure><p id="7982" class="pw-post-body-paragraph kz la jb lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated">查看所有列及其数据类型的更好方法是使用<strong class="lb jl">。info() </strong>方法:</p><figure class="oi oj ok ol gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ow"><img src="../Images/921b1ad09dc0290aaee2a76dbf73c077.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OlOKi2mvh4aqJi5r12pLiA.png"/></div></div></figure><p id="bd74" class="pw-post-body-paragraph kz la jb lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated">我们的数据似乎分为两类:</p><ul class=""><li id="0391" class="nj nk jb lb b lc ld lf lg li nl lm nm lq nn lu no np nq nr bi translated">分类特征:性别、流媒体电视、支付方式等。</li><li id="5012" class="nj nk jb lb b lc ns lf nt li nu lm nv lq nw lu no np nq nr bi translated">数字特征:任期，每月收费，总费用</li></ul><p id="d378" class="pw-post-body-paragraph kz la jb lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated">现在，从分类开始，我们阐明所有特征，看看它们对识别客户是否会流失有多大帮助。</p><p id="da32" class="pw-post-body-paragraph kz la jb lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated">顺便提一下，在我们拥有的数据集中，流失列是带有<em class="ox">是/否</em>值的<em class="ox">字符串</em>。我们将它转换为整数，以便在我们的分析中更容易使用。</p><pre class="oi oj ok ol gt om on oo op aw oq bi"><span id="034e" class="nx mn jb on b gy or os l ot ou">df_data.loc[df_data.Churn=='No','Churn'] = 0 <br/>df_data.loc[df_data.Churn=='Yes','Churn'] = 1</span></pre><p id="88be" class="pw-post-body-paragraph kz la jb lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated"><strong class="lb jl">性别</strong></p><p id="876d" class="pw-post-body-paragraph kz la jb lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated">通过使用下面的代码块，我们可以很容易地看到每个值的流失率(1-保留率)<em class="ox"> </em>的样子:</p><pre class="oi oj ok ol gt om on oo op aw oq bi"><span id="2928" class="nx mn jb on b gy or os l ot ou">df_plot = df_data.groupby('gender').Churn.mean().reset_index()<br/>plot_data = [<br/>    go.Bar(<br/>        x=df_plot['gender'],<br/>        y=df_plot['Churn'],<br/>        width = [0.5, 0.5],<br/>        marker=dict(<br/>        color=['green', 'blue'])<br/>    )<br/>]</span><span id="f6d8" class="nx mn jb on b gy oy os l ot ou">plot_layout = go.Layout(<br/>        xaxis={"type": "category"},<br/>        yaxis={"title": "Churn Rate"},<br/>        title='Gender',<br/>        plot_bgcolor  = 'rgb(243,243,243)',<br/>        paper_bgcolor  = 'rgb(243,243,243)',<br/>    )<br/>fig = go.Figure(data=plot_data, layout=plot_layout)<br/>pyoff.iplot(fig)</span></pre><p id="7a77" class="pw-post-body-paragraph kz la jb lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated">输出:</p><figure class="oi oj ok ol gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi oz"><img src="../Images/7acfc327b231a9352eec6adb5956cfd5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TbEXpGNE5K1kz3cAvBp0KQ.png"/></div></div><figcaption class="pa pb gj gh gi pc pd bd b be z dk"><strong class="bd pe">Churn Rate by Gender</strong></figcaption></figure><p id="79b5" class="pw-post-body-paragraph kz la jb lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated">流失率的性别细分:</p><figure class="oi oj ok ol gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi pf"><img src="../Images/a58cd7a921279ed7e697c9a9ba28ffa8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mB4NhV1fhqc732Bq3wbS4g.png"/></div></div></figure><p id="16a8" class="pw-post-body-paragraph kz la jb lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated">女性客户比男性客户更容易流失，但这种差异很小(约 0.8%)。</p><p id="3713" class="pw-post-body-paragraph kz la jb lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated"><strong class="lb jl">让我们对所有分类列重复这个过程。为了不重复我们对性别所做的，你可以在下面找到所有需要的代码:</strong></p><p id="58cc" class="pw-post-body-paragraph kz la jb lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated">现在，我们来了解一下这些特性，这些特性显示了它们之间最显著的价值差异:</p><p id="a780" class="pw-post-body-paragraph kz la jb lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated"><strong class="lb jl">互联网服务</strong></p><figure class="oi oj ok ol gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi oz"><img src="../Images/236dd3f449bc0d49d32d3d59a25c998c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sTaaQd0uhG3egJbZBAnzCw.png"/></div></div><figcaption class="pa pb gj gh gi pc pd bd b be z dk"><strong class="bd pe">Churn Rate by Internet Service</strong></figcaption></figure><p id="b0bd" class="pw-post-body-paragraph kz la jb lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated">该图表显示，使用光纤作为互联网服务的客户更有可能流失。我通常预计光纤客户流失会更少，因为他们使用更优质的服务。但这可能是由于高价格、竞争、客户服务和许多其他原因造成的。</p><p id="cd5f" class="pw-post-body-paragraph kz la jb lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated"><strong class="lb jl">合同</strong></p><figure class="oi oj ok ol gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi oz"><img src="../Images/5fd8cab02b39a14fd073a7e563f222a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*y5VBbOXkkPMVbbgjXCICEQ.png"/></div></div><figcaption class="pa pb gj gh gi pc pd bd b be z dk"><strong class="bd pe">Churn Rate by Contract</strong></figcaption></figure><p id="dc8d" class="pw-post-body-paragraph kz la jb lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated">不出所料，合同越短意味着流失率越高。</p><p id="8a02" class="pw-post-body-paragraph kz la jb lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated"><strong class="lb jl">技术支持</strong></p><figure class="oi oj ok ol gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi oz"><img src="../Images/4e454332894360a313ab54e6a8064933.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dFWiLNNd-ZpZhi9JlG13YA.png"/></div></div><figcaption class="pa pb gj gh gi pc pd bd b be z dk"><strong class="bd pe">Churn Rate by Tech Support</strong></figcaption></figure><p id="b91e" class="pw-post-body-paragraph kz la jb lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated">不使用技术支持的客户更有可能流失(相差约 25%)。</p><p id="fae4" class="pw-post-body-paragraph kz la jb lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated"><strong class="lb jl">付款方式</strong></p><figure class="oi oj ok ol gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi pg"><img src="../Images/6f1b5701bd498c7dcf1ec201700f5b43.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pLLVFKHgLE0xqb6CoCBM9A.png"/></div></div></figure><p id="496e" class="pw-post-body-paragraph kz la jb lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated">自动支付使客户更有可能留在你的平台上(大约 30%的差异)。</p><p id="2942" class="pw-post-body-paragraph kz la jb lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated"><strong class="lb jl">其他</strong></p><p id="bdc9" class="pw-post-body-paragraph kz la jb lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated">让我们在这里展示一些其他特性的图表以供参考:</p><div class="oi oj ok ol gt ab cb"><figure class="ph is pi pj pk pl pm paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><img src="../Images/2ce685fa3e3a6cbc934edb3bbad27a54.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*q0IPXUe565X8HJq_xPz6IA.png"/></div></figure><figure class="ph is pi pj pk pl pm paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><img src="../Images/8e1e3c332099b106dcede03b20c2abcb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*kdGl_9N4iqztF91iReeZlA.png"/></div></figure></div><div class="ab cb"><figure class="ph is pi pj pk pl pm paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><img src="../Images/3fd1748b96f397ce1f7951c4e131aa65.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*d_YjeMKAFsGSLoAl1uWeBw.png"/></div></figure><figure class="ph is pi pj pk pl pm paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><img src="../Images/65dfa3af797344d4305235b24b3fe21c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*Khb7TdVNgo4X6gz_RVmKGg.png"/></div><figcaption class="pa pb gj gh gi pc pd bd b be z dk pn di po pp"><strong class="bd pe">Churn Rate by Paperless Billing, Streaming Movies, Device Protection &amp; Phone Service</strong></figcaption></figure></div><p id="ee74" class="pw-post-body-paragraph kz la jb lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated">我们完成了分类特征。让我们看看数字特征是什么样的:</p><p id="ae96" class="pw-post-body-paragraph kz la jb lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated"><strong class="lb jl">任期</strong></p><p id="2154" class="pw-post-body-paragraph kz la jb lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated">要了解任期和平均流失率之间的趋势，让我们构建一个散点图:</p><pre class="oi oj ok ol gt om on oo op aw oq bi"><span id="c80d" class="nx mn jb on b gy or os l ot ou">df_plot = df_data.groupby('tenure').Churn.mean().reset_index()</span><span id="476a" class="nx mn jb on b gy oy os l ot ou">plot_data = [<br/>    go.Scatter(<br/>        x=df_plot['tenure'],<br/>        y=df_plot['Churn'],<br/>        mode='markers',<br/>        name='Low',<br/>        marker= dict(size= 7,<br/>            line= dict(width=1),<br/>            color= 'blue',<br/>            opacity= 0.8<br/>           ),<br/>    )<br/>]</span><span id="150b" class="nx mn jb on b gy oy os l ot ou">plot_layout = go.Layout(<br/>        yaxis= {'title': "Churn Rate"},<br/>        xaxis= {'title': "Tenure"},<br/>        title='Tenure based Churn rate',<br/>        plot_bgcolor  = "rgb(243,243,243)",<br/>        paper_bgcolor  = "rgb(243,243,243)",<br/>    )<br/>fig = go.Figure(data=plot_data, layout=plot_layout)<br/>pyoff.iplot(fig)</span></pre><figure class="oi oj ok ol gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi oz"><img src="../Images/d903d7a16192847215ed397edf1d461f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cJD_fJqwrxJwq5e9ZyAceQ.png"/></div></div><figcaption class="pa pb gj gh gi pc pd bd b be z dk"><strong class="bd pe">Churn Rate by Tenure</strong></figcaption></figure><p id="296b" class="pw-post-body-paragraph kz la jb lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated">显而易见，任期越长意味着流失率越低。我们将对<em class="ox">月费用和总费用:</em>应用相同的方法</p><p id="d468" class="pw-post-body-paragraph kz la jb lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated">输出:</p><div class="oi oj ok ol gt ab cb"><figure class="ph is pi pj pk pl pm paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><img src="../Images/480ffc89d4102ef1488dcdd21ed22898.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*ByblGCRjwrh1VnsqRTm6-w.png"/></div></figure><figure class="ph is pi pj pk pl pm paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><img src="../Images/1acb04c2c85b9271a2b48bd34c3f5b7b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*qHxrtlxAGYvtg7Dtja_gtA.png"/></div><figcaption class="pa pb gj gh gi pc pd bd b be z dk pn di po pp"><strong class="bd pe">Churn Rate by Monthly &amp; Total Charges</strong></figcaption></figure></div><p id="61ff" class="pw-post-body-paragraph kz la jb lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated">不幸的是，流失率和每月及总费用之间没有趋势。</p></div><div class="ab cl pq pr hu ps" role="separator"><span class="pt bw bk pu pv pw"/><span class="pt bw bk pu pv pw"/><span class="pt bw bk pu pv"/></div><div class="ij ik il im in"><h2 id="06f0" class="nx mn jb bd mo ny nz dn ms oa ob dp mw li oc od my lm oe of na lq og oh nc jh bi translated">特征工程</h2><p id="a21d" class="pw-post-body-paragraph kz la jb lb b lc ne kl le lf nf ko lh li ng lk ll lm nh lo lp lq ni ls lt lu ij bi translated">在本节中，我们将转换我们的原始特征，以从中提取更多信息。我们的策略如下:</p><p id="a9ad" class="pw-post-body-paragraph kz la jb lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated">1-使用聚类技术对数字列进行分组</p><p id="dc8b" class="pw-post-body-paragraph kz la jb lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated">2-将<strong class="lb jl">标签编码器</strong>应用于二进制分类特征</p><p id="f2fb" class="pw-post-body-paragraph kz la jb lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated">3-将<strong class="lb jl"> get_dummies() </strong>应用于具有多个值的分类特征</p><p id="e8a0" class="pw-post-body-paragraph kz la jb lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated"><strong class="lb jl">数值列</strong></p><p id="a618" class="pw-post-body-paragraph kz la jb lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated">正如我们从 EDA 部分了解到的，我们有三个数字列:</p><ul class=""><li id="2833" class="nj nk jb lb b lc ld lf lg li nl lm nm lq nn lu no np nq nr bi translated">任期</li><li id="9b9e" class="nj nk jb lb b lc ns lf nt li nu lm nv lq nw lu no np nq nr bi translated">每月费用</li><li id="237d" class="nj nk jb lb b lc ns lf nt li nu lm nv lq nw lu no np nq nr bi translated">总费用</li></ul><p id="9c90" class="pw-post-body-paragraph kz la jb lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated">我们将应用以下步骤来创建组:</p><ol class=""><li id="e9a9" class="nj nk jb lb b lc ld lf lg li nl lm nm lq nn lu px np nq nr bi translated">用肘法确定适当的聚类数</li><li id="5c78" class="nj nk jb lb b lc ns lf nt li nu lm nv lq nw lu px np nq nr bi translated">将 K-means 逻辑应用于所选列并更改命名</li><li id="60d0" class="nj nk jb lb b lc ns lf nt li nu lm nv lq nw lu px np nq nr bi translated">观察集群的轮廓</li></ol><p id="d447" class="pw-post-body-paragraph kz la jb lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated">让我们看看这在实践中是如何适用于<em class="ox">任期</em>的:</p><p id="e1bb" class="pw-post-body-paragraph kz la jb lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated">群集配置文件:</p><figure class="oi oj ok ol gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi py"><img src="../Images/1b0cc0470130e6a0b7c8e263e359108d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*opEXcO-xxQzZhcsYSQf-ww.png"/></div></div></figure><p id="7ae4" class="pw-post-body-paragraph kz la jb lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated">我们有 3 个集群，平均任期分别为 7.5 年、33.9 年和 63 年。</p><p id="56d6" class="pw-post-body-paragraph kz la jb lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated">每个集群的流失率:</p><figure class="oi oj ok ol gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi pg"><img src="../Images/3543c6d0484195e238b74b79458a218c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pcx7VH0LYVd2xs4Ys9FYYw.png"/></div></div><figcaption class="pa pb gj gh gi pc pd bd b be z dk"><strong class="bd pe">Churn Rate by tenure clusters</strong></figcaption></figure><p id="2ed0" class="pw-post-body-paragraph kz la jb lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated">这是对每月费用和总费用进行同样处理后的效果:</p><p id="22da" class="pw-post-body-paragraph kz la jb lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated"><em class="ox">月费:</em></p><figure class="oi oj ok ol gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi pz"><img src="../Images/17be6568da37505dd37dbf933facb904.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aoPyMeuQ4MLkxY2Huk3H7g.png"/></div></div><figcaption class="pa pb gj gh gi pc pd bd b be z dk"><strong class="bd pe">Monthly Charge Clusters profile</strong></figcaption></figure><figure class="oi oj ok ol gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi qa"><img src="../Images/154af50e752edfe04fec0efa797c2c18.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*acYqQp7zyn-mhH37AcFSgg.png"/></div></div><figcaption class="pa pb gj gh gi pc pd bd b be z dk"><strong class="bd pe">Churn Rate by monthly charge clusters</strong></figcaption></figure><p id="574b" class="pw-post-body-paragraph kz la jb lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated"><em class="ox">总费用:</em></p><figure class="oi oj ok ol gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi qb"><img src="../Images/87d42952d4d0b446232605ee65e2ae30.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kKJkhYwBQsbmVxFembQTfA.png"/></div></div><figcaption class="pa pb gj gh gi pc pd bd b be z dk"><strong class="bd pe">Total Charge Clusters profile</strong></figcaption></figure><figure class="oi oj ok ol gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi qc"><img src="../Images/d172d854c68b98c6f661312296e3770a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RV9y4t9XdXkDHJKU7DZmZA.png"/></div></div><figcaption class="pa pb gj gh gi pc pd bd b be z dk"><strong class="bd pe">Churn Rate by total charge clusters</strong></figcaption></figure><p id="9872" class="pw-post-body-paragraph kz la jb lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated"><strong class="lb jl">分类列</strong></p><p id="ca4c" class="pw-post-body-paragraph kz la jb lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated"><strong class="lb jl">标签编码器</strong>通过简单地将整数分配给不同的值，将分类列转换为数字列。例如，<strong class="lb jl">性别</strong>列有两个值:<em class="ox">女性</em> &amp; <em class="ox">男性</em>。标签编码器会将其转换为 1 和 0。</p><p id="46a6" class="pw-post-body-paragraph kz la jb lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated"><strong class="lb jl"> get_dummies() </strong>方法通过分配 0&amp;1 来从分类列中创建新列(您可以在我们的<a class="ae lv" rel="noopener" target="_blank" href="/data-driven-growth-with-python-part-3-customer-lifetime-value-prediction-6017802f2e0f">上一篇文章</a>中找到准确的解释)</p><p id="666b" class="pw-post-body-paragraph kz la jb lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated">让我们在实践中看到这两者:</p><pre class="oi oj ok ol gt om on oo op aw oq bi"><span id="ebd0" class="nx mn jb on b gy or os l ot ou">#import Label Encoder<br/>from sklearn.preprocessing import LabelEncoder<br/>le = LabelEncoder()<br/>dummy_columns = [] #array for multiple value columns</span><span id="1d8a" class="nx mn jb on b gy oy os l ot ou">for column in df_data.columns:<br/>    if df_data[column].dtype == object and column != 'customerID':<br/>        if df_data[column].nunique() == 2:<br/>            #apply Label Encoder for binary ones<br/>            df_data[column] = le.fit_transform(df_data[column]) <br/>        else:<br/>            dummy_columns.append(column)</span><span id="7a34" class="nx mn jb on b gy oy os l ot ou">#apply get dummies for selected columns<br/>df_data = pd.get_dummies(data = df_data,columns = dummy_columns)</span></pre><p id="eedb" class="pw-post-body-paragraph kz la jb lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated">查看所选列的数据外观:</p><figure class="oi oj ok ol gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi qd"><img src="../Images/60be50bf88250ad5d04dcd57f6f69205.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LaYxxPqz4yLk_Up1s6v9UQ.png"/></div></div></figure><p id="92af" class="pw-post-body-paragraph kz la jb lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated">如您所见，<strong class="lb jl">性别</strong> &amp; <strong class="lb jl">合作伙伴</strong>列变成了数字列，并且我们为<strong class="lb jl"> TenureCluster </strong>增加了三个新列。</p><p id="b15d" class="pw-post-body-paragraph kz la jb lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated">是时候拟合一个逻辑回归模型并提取洞察力来做出更好的商业决策了。</p></div><div class="ab cl pq pr hu ps" role="separator"><span class="pt bw bk pu pv pw"/><span class="pt bw bk pu pv pw"/><span class="pt bw bk pu pv"/></div><div class="ij ik il im in"><h2 id="250c" class="nx mn jb bd mo ny nz dn ms oa ob dp mw li oc od my lm oe of na lq og oh nc jh bi translated">逻辑回归</h2><p id="bc6d" class="pw-post-body-paragraph kz la jb lb b lc ne kl le lf nf ko lh li ng lk ll lm nh lo lp lq ni ls lt lu ij bi translated">预测流失是一个二元分类问题。在一定时期内，客户要么流失，要么保留。作为一个稳健的模型，逻辑回归也提供了可解释的结果。正如我们之前所做的，让我们整理出构建逻辑回归模型的步骤:</p><ol class=""><li id="7d53" class="nj nk jb lb b lc ld lf lg li nl lm nm lq nn lu px np nq nr bi translated">准备数据(模型的输入)</li><li id="07b8" class="nj nk jb lb b lc ns lf nt li nu lm nv lq nw lu px np nq nr bi translated">拟合模型并查看模型摘要</li></ol><p id="0c97" class="pw-post-body-paragraph kz la jb lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated">摘要如下所示:</p><figure class="oi oj ok ol gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi qe"><img src="../Images/45702a26b252faf7755a1faf0b2314fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PjLjf7mg1pAOR11zImmztg.png"/></div></div></figure><p id="a7bd" class="pw-post-body-paragraph kz la jb lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated">我们从这份报告中得到了两个重要的结果。当您准备客户流失预测模型时，您将面临以下问题:</p><p id="8223" class="pw-post-body-paragraph kz la jb lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated">1-哪些特征会让客户流失或保留？</p><p id="9a79" class="pw-post-body-paragraph kz la jb lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated">2-最关键的是什么？我们应该关注什么？</p><p id="1972" class="pw-post-body-paragraph kz la jb lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated">对于第一个问题，您应该查看第 4 列(P&gt;|z|)。如果绝对<strong class="lb jl"> p 值</strong>小于 0.05，这意味着该特征以统计显著的方式影响客户流失。例如:</p><ul class=""><li id="4177" class="nj nk jb lb b lc ld lf lg li nl lm nm lq nn lu no np nq nr bi translated">老年人</li><li id="ebd8" class="nj nk jb lb b lc ns lf nt li nu lm nv lq nw lu no np nq nr bi translated">互联网服务 _DSL</li><li id="1c6a" class="nj nk jb lb b lc ns lf nt li nu lm nv lq nw lu no np nq nr bi translated">OnlineSecurity_NO</li></ul><p id="3966" class="pw-post-body-paragraph kz la jb lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated">然后第二个问题。我们想降低流失率，应该从哪里着手？这个问题的科学版是；</p><blockquote class="qf qg qh"><p id="6717" class="kz la ox lb b lc ld kl le lf lg ko lh qi lj lk ll qj ln lo lp qk lr ls lt lu ij bi translated">如果我增加/减少一个单位，哪个特性会带来最好的 ROI？</p></blockquote><p id="a730" class="pw-post-body-paragraph kz la jb lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated">这个问题可以通过查看 T21 专栏来回答。如果我们改变一个单位，指数系数会给出流失率的预期变化。如果我们应用下面的代码，我们将看到所有系数的转换版本:</p><pre class="oi oj ok ol gt om on oo op aw oq bi"><span id="c605" class="nx mn jb on b gy or os l ot ou">np.exp(res.params)</span></pre><figure class="oi oj ok ol gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ql"><img src="../Images/46e6d4f91560c470763400c13c46709c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2Gn-ezhx7EgUkL5FCoWGPA.png"/></div></div></figure><p id="985d" class="pw-post-body-paragraph kz la jb lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated">例如，如果我们保持其他一切不变，每月费用的一个单位变化意味着搅动的几率提高了约 3.4%。从上表中，我们可以快速确定哪些功能更重要。</p><p id="c7fb" class="pw-post-body-paragraph kz la jb lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated">现在，构建分类模型的一切都准备好了。</p></div><div class="ab cl pq pr hu ps" role="separator"><span class="pt bw bk pu pv pw"/><span class="pt bw bk pu pv pw"/><span class="pt bw bk pu pv"/></div><div class="ij ik il im in"><h2 id="c394" class="nx mn jb bd mo ny nz dn ms oa ob dp mw li oc od my lm oe of na lq og oh nc jh bi translated">基于 XGBoost 的二元分类模型</h2><p id="f068" class="pw-post-body-paragraph kz la jb lb b lc ne kl le lf nf ko lh li ng lk ll lm nh lo lp lq ni ls lt lu ij bi translated">为了使 XGBoost 适合我们的数据，我们应该准备特征(X)和标签(y)集，并进行训练和测试分割。</p><pre class="oi oj ok ol gt om on oo op aw oq bi"><span id="29a8" class="nx mn jb on b gy or os l ot ou">#create feature set and labels<br/>X = df_data.drop(['Churn','customerID'],axis=1)<br/>y = df_data.Churn</span><span id="9248" class="nx mn jb on b gy oy os l ot ou">#train and test split<br/>X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.05, random_state=56)</span><span id="64f6" class="nx mn jb on b gy oy os l ot ou">#building the model &amp; printing the score<br/>xgb_model = xgb.XGBClassifier(max_depth=5, learning_rate=0.08, objective= 'binary:logistic',n_jobs=-1).fit(X_train, y_train)</span><span id="4b22" class="nx mn jb on b gy oy os l ot ou">print('Accuracy of XGB classifier on training set: {:.2f}'<br/>       .format(xgb_model.score(X_train, y_train)))<br/>print('Accuracy of XGB classifier on test set: {:.2f}'<br/>       .format(xgb_model.score(X_test[X_train.columns], y_test)))</span></pre><p id="10f6" class="pw-post-body-paragraph kz la jb lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated">通过使用这个简单的模型，我们达到了 81%的准确率:</p><figure class="oi oj ok ol gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi qm"><img src="../Images/d3d6c3fc3e9d812ffa6df652fdd1cfba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GcXWNCklCXF5e7TbSDaNTw.png"/></div></div></figure><p id="7705" class="pw-post-body-paragraph kz la jb lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated">我们在数据集中的实际流失率是 26.5%(反映为模型性能的 73.5%)。这表明我们的模型是有用的。最好检查一下我们的分类模型，看看我们的模型到底在哪里失败了。</p><pre class="oi oj ok ol gt om on oo op aw oq bi"><span id="91d9" class="nx mn jb on b gy or os l ot ou">y_pred = xgb_model.predict(X_test)<br/>print(classification_report(y_test, y_pred))</span></pre><figure class="oi oj ok ol gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi qn"><img src="../Images/02b4cc9f3e47a5735cb285f9bf5cf4bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vpQBPtKW8O8opgk65VF91A.png"/></div></div></figure><p id="1a27" class="pw-post-body-paragraph kz la jb lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated">我们可以这样理解上面的报告，就好像我们的模型告诉我们，100 个客户会流失，其中 67 个会流失(精度 0.67)。实际上，大约有 220 名客户会流失(0.45 次召回)。特别是召回是这里的主要问题，我们可以通过以下方式提高模型的整体性能:</p><ul class=""><li id="4a94" class="nj nk jb lb b lc ld lf lg li nl lm nm lq nn lu no np nq nr bi translated">添加更多数据(对于这个例子，我们有大约 2k 行)</li><li id="0a6e" class="nj nk jb lb b lc ns lf nt li nu lm nv lq nw lu no np nq nr bi translated">添加更多功能</li><li id="6467" class="nj nk jb lb b lc ns lf nt li nu lm nv lq nw lu no np nq nr bi translated">更多功能工程</li><li id="7a85" class="nj nk jb lb b lc ns lf nt li nu lm nv lq nw lu no np nq nr bi translated">尝试其他模型</li><li id="7ce9" class="nj nk jb lb b lc ns lf nt li nu lm nv lq nw lu no np nq nr bi translated">超参数调谐</li></ul><p id="e011" class="pw-post-body-paragraph kz la jb lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated">接下来，让我们详细看看我们的模型是如何工作的。首先，我们想知道我们的模型确切地使用了数据集中的哪些特征。还有，哪些是最重要的？</p><p id="44e3" class="pw-post-body-paragraph kz la jb lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated">为了解决这个问题，我们可以使用下面的代码:</p><pre class="oi oj ok ol gt om on oo op aw oq bi"><span id="e792" class="nx mn jb on b gy or os l ot ou">from xgboost import plot_importance<br/>fig, ax = plt.subplots(figsize=(10,8))<br/>plot_importance(xgb_model, ax=ax)</span></pre><figure class="oi oj ok ol gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi qo"><img src="../Images/9c7d0c10caa7a6d9c1386930c01edb97.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ib4lw7jzDCiQO-flC55-8A.png"/></div></div><figcaption class="pa pb gj gh gi pc pd bd b be z dk"><strong class="bd pe">Features importance for XGBoost Model</strong></figcaption></figure><p id="6c36" class="pw-post-body-paragraph kz la jb lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated">我们可以看到，与其他模型相比，我们的模型更重视总费用和月费用。</p><p id="f7e8" class="pw-post-body-paragraph kz la jb lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated">最后，使用该模型的最佳方式是为每个客户分配流失概率，创建细分市场，并在此基础上制定策略。要从我们的模型中获得流失概率，请使用下面的代码块:</p><pre class="oi oj ok ol gt om on oo op aw oq bi"><span id="032b" class="nx mn jb on b gy or os l ot ou">df_data['proba'] = xgb_model.predict_proba(df_data[X_train.columns])[:,1]</span></pre><p id="0679" class="pw-post-body-paragraph kz la jb lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated">我们的数据集最后看起来如下:</p><figure class="oi oj ok ol gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi qp"><img src="../Images/e577b9fc804f67e1f5aeb8cd2de5207b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2QyQ2GNE1vRb90kqk7vhZg.png"/></div></div><figcaption class="pa pb gj gh gi pc pd bd b be z dk">Churn Probabilities of the customers</figcaption></figure><p id="f389" class="pw-post-body-paragraph kz la jb lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated">现在，我们知道在我们的最佳细分市场中是否有可能流失客户(回想一下<a class="ae lv" rel="noopener" target="_blank" href="/data-driven-growth-with-python-part-2-customer-segmentation-5c019d150444">第 2 部分</a>和<a class="ae lv" rel="noopener" target="_blank" href="/data-driven-growth-with-python-part-3-customer-lifetime-value-prediction-6017802f2e0f">第 3 部分</a>，我们可以据此制定行动。在下一篇文章中，我们将重点预测客户的<a class="ae lv" rel="noopener" target="_blank" href="/predicting-next-purchase-day-15fae5548027">下一个购买日。</a></p><p id="c4ac" class="pw-post-body-paragraph kz la jb lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated">你可以在这里找到这部分<a class="ae lv" href="https://gist.github.com/karamanbk/56522d30345b8672a52c6846e971cb3c" rel="noopener ugc nofollow" target="_blank">的 Jupyter 笔记本。</a></p></div><div class="ab cl pq pr hu ps" role="separator"><span class="pt bw bk pu pv pw"/><span class="pt bw bk pu pv pw"/><span class="pt bw bk pu pv"/></div><div class="ij ik il im in"><p id="d7a8" class="pw-post-body-paragraph kz la jb lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated">需要帮助来发展你的公司吗？点击此处与我预约免费课程<a class="ae lv" href="https://app.growthmentor.com/mentors/baris-karaman" rel="noopener ugc nofollow" target="_blank">。</a></p></div></div>    
</body>
</html>