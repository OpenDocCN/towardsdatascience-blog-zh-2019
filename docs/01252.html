<html>
<head>
<title>8 Tricks in Python to accelerate your Data Science development</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python 中加速数据科学发展的 8 个技巧</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/8-tricks-in-python-to-accelerate-your-data-science-development-cad3b634e140?source=collection_archive---------8-----------------------#2019-02-26">https://towardsdatascience.com/8-tricks-in-python-to-accelerate-your-data-science-development-cad3b634e140?source=collection_archive---------8-----------------------#2019-02-26</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="49e9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们简短，让我们有效。少字多码(<em class="kl">多模因图解</em>)。这就是你要找的，对吗？；)</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi km"><img src="../Images/8601e288258ece3f7b7b2c9f5eb5c6e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_OsB8ZIB-_t6nypaN5cekQ.png"/></div></div></figure><h1 id="2d76" class="ky kz iq bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">Python 语言技巧</h1><h2 id="9297" class="lw kz iq bd la lx ly dn le lz ma dp li jy mb mc lm kc md me lq kg mf mg lu mh bi translated">检查一行代码中的条件(断言)</h2><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi mi"><img src="../Images/7378f0ee5071230d7cc788e2ac9043d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:410/format:webp/1*OUa7ikkl2-IcwWWTN5ztHg.jpeg"/></div></div></figure><p id="1d90" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">例如，我们将检查训练和测试函数是否具有相同的列(当您预测测试数据集并且没有应用相同的功能工程时，这是一个常见的错误:)</p><p id="03d3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">常见 Python:</p><pre class="kn ko kp kq gt mj mk ml mm aw mn bi"><span id="94ea" class="lw kz iq mk b gy mo mp l mq mr">label = df_train['label_column']<br/>df_train = df_train.drop('label_column',axis=1)<br/>if df_train.column.tolist() != df_test.column.tolist():<br/>   print('Train and test column do not match')<br/>   print(sys.exit())</span></pre><p id="3bb2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Python 技巧:</p><pre class="kn ko kp kq gt mj mk ml mm aw mn bi"><span id="0d91" class="lw kz iq mk b gy mo mp l mq mr">assert df_train.column.tolist() == df_test.column.tolist(),'Train and test column do not match'</span></pre><h2 id="a5b5" class="lw kz iq bd la lx ly dn le lz ma dp li jy mb mc lm kc md me lq kg mf mg lu mh bi translated">在一行代码中循环(单行代码)</h2><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi ms"><img src="../Images/f4892c99b92d9c01677514f8a86c8fee.png" data-original-src="https://miro.medium.com/v2/resize:fit:786/format:webp/1*NMU94t_jpFAlx_LveD6v6g.jpeg"/></div></figure><p id="d23b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">例如，我们将填充一个从 0 到 100 的偶数列表，并为 ood 编号填充 0(即[0,0,2,0,4,0…])</p><p id="ccd2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">常见 Python:</p><pre class="kn ko kp kq gt mj mk ml mm aw mn bi"><span id="5037" class="lw kz iq mk b gy mo mp l mq mr">my_awesome_list = []<br/>for i in range [0,100]:<br/>    if i%2 = 0:<br/>        my_awesome_list.append(i)<br/>    else:<br/>        my_awesome_list.append(0)</span><span id="2f99" class="lw kz iq mk b gy mt mp l mq mr"><strong class="mk ir">my_awesome_list = [0,0,2,0,3,4]</strong></span></pre><p id="f61c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Python 技巧:</p><pre class="kn ko kp kq gt mj mk ml mm aw mn bi"><span id="1813" class="lw kz iq mk b gy mo mp l mq mr">my_awesome_list = [i if i%2==0 else 0 for i in range(0,100) ]</span><span id="c969" class="lw kz iq mk b gy mt mp l mq mr"><strong class="mk ir">my_awesome_list = [0,0,2,0,3,4]</strong></span></pre><h2 id="4577" class="lw kz iq bd la lx ly dn le lz ma dp li jy mb mc lm kc md me lq kg mf mg lu mh bi translated">创建函数而不创建函数(lambda)</h2><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi mu"><img src="../Images/b973b8db2178d97b2d7b7daac35f4734.png" data-original-src="https://miro.medium.com/v2/resize:fit:916/format:webp/1*yxN5WrpNjSxi-XTqm4SKsQ.png"/></div></figure><p id="c2d4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">计算列表中每个元素的双精度值:</p><p id="a0cc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">常见 Python:</p><pre class="kn ko kp kq gt mj mk ml mm aw mn bi"><span id="66cd" class="lw kz iq mk b gy mo mp l mq mr">a = [2,2,2]<br/>for i in range(0,len(a)):<br/>    a[i] = a[i]*2</span><span id="c153" class="lw kz iq mk b gy mt mp l mq mr"><strong class="mk ir">[4, 4, 4]</strong></span></pre><p id="e2c7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Python 技巧:</p><pre class="kn ko kp kq gt mj mk ml mm aw mn bi"><span id="6aa7" class="lw kz iq mk b gy mo mp l mq mr">a = [2,2,2]<br/>double = lambda x : x*2<br/>a = [double(a_) for a_ in a]</span><span id="afe5" class="lw kz iq mk b gy mt mp l mq mr"><strong class="mk ir">[4, 4, 4]</strong></span></pre><h2 id="e8f6" class="lw kz iq bd la lx ly dn le lz ma dp li jy mb mc lm kc md me lq kg mf mg lu mh bi translated">使用另一个列表转换一个列表，不使用循环(map)</h2><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi mv"><img src="../Images/5756d9f517ed699d8bb7b18b4c53ff20.png" data-original-src="https://miro.medium.com/v2/resize:fit:744/format:webp/1*_hVPDQE0RK4dc-QvAcurwQ.jpeg"/></div></figure><p id="7a16" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在一个完全否定列表中转换一个数字列表。</p><p id="4ab6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">常见 Python:</p><pre class="kn ko kp kq gt mj mk ml mm aw mn bi"><span id="39b1" class="lw kz iq mk b gy mo mp l mq mr">a = [1,1,1,1]<br/>for i in range(0,len(a)):<br/>    a[i] = -1 * a[i]</span><span id="57a7" class="lw kz iq mk b gy mt mp l mq mr"><strong class="mk ir">[-1, -1, -1, -1]</strong></span></pre><p id="2055" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Python 技巧:</p><pre class="kn ko kp kq gt mj mk ml mm aw mn bi"><span id="7eb0" class="lw kz iq mk b gy mo mp l mq mr">a = [1,1,1,1]<br/>a = list(map(lambda x: -1*x, a))</span><span id="ac7d" class="lw kz iq mk b gy mt mp l mq mr"><strong class="mk ir">[-1, -1, -1, -1]</strong></span></pre><h2 id="6a71" class="lw kz iq bd la lx ly dn le lz ma dp li jy mb mc lm kc md me lq kg mf mg lu mh bi translated">乍一看不要滥用简单语法(try: except 和 global)</h2><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi mw"><img src="../Images/15741160fe4c258a4488f591b5f39866.png" data-original-src="https://miro.medium.com/v2/resize:fit:568/format:webp/1*RomlxKsFS0m_DsHKWOQUiw.jpeg"/></div></div></figure><p id="3867" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我在初级 Python 开发人员的 lof 代码中注意到的一个常见错误是使用太多 try/except 和全局语法来开发代码，例如:</p><pre class="kn ko kp kq gt mj mk ml mm aw mn bi"><span id="442b" class="lw kz iq mk b gy mo mp l mq mr">def compare_two_list(list_a,list_b):<br/>    global len_of_all_list<br/>    try:<br/>        for i in range(0,len_of_all_list):<br/>            if list_a[i] != list_b[i]:<br/>                print('error')<br/>    except:<br/>        print('error')</span><span id="68d2" class="lw kz iq mk b gy mt mp l mq mr">global len_of_all_listlen_of_all_list = 100<br/>list_a = [1]*len_of_all_list<br/>len_of_all_list = len_of_all_list+1<br/>list_b = [1]*len_of_all_list</span><span id="1d01" class="lw kz iq mk b gy mt mp l mq mr">compare_two_list(list_a,list_b)</span><span id="2dc3" class="lw kz iq mk b gy mt mp l mq mr"><strong class="mk ir">'error'</strong></span></pre><p id="6ad6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">调试这样的代码真的很复杂。使用 try:除非您需要通过处理特定的异常来操作代码中的某些内容。例如，这里使用“try: except”语句来处理我们的问题的一种方法是忽略 list_a 的最大索引之后的所有索引:</p><pre class="kn ko kp kq gt mj mk ml mm aw mn bi"><span id="b1fa" class="lw kz iq mk b gy mo mp l mq mr">def compare_two_list(list_a,list_b):<br/>    global len_of_all_list<br/>    try:<br/>        for i in range(0,len_of_all_list):<br/>            if list_a[i] != list_b[i]:<br/>                print('error')<br/>    except IndexError:<br/>        print('It seems that the two lists are different sizes. They was similar until index {0}'.format(len_of_all_list-1))<br/>        return<br/>    <br/>global len_of_all_list<br/>len_of_all_list=100<br/>list_a = [1]*len_of_all_list<br/>len_of_all_list = len_of_all_list+1<br/>list_b = [1]*len_of_all_list<br/>compare_two_list(list_a,list_b)</span><span id="d454" class="lw kz iq mk b gy mt mp l mq mr"><strong class="mk ir">It seems that the two lists are different sizes. They was similar until index 101.</strong></span></pre><h1 id="47d2" class="ky kz iq bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">数据科学图书馆技巧</h1><h2 id="d3d1" class="lw kz iq bd la lx ly dn le lz ma dp li jy mb mc lm kc md me lq kg mf mg lu mh bi translated">基于条件(np.where())填充 DataFrame 列</h2><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi mx"><img src="../Images/d32df3044ab6e2a17fcb9ee8d0af5e8e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1014/format:webp/1*PX9yYQBGFxU4kOj4M8R6oQ.jpeg"/></div></figure><p id="c08f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">作为示例，我们将基于一个条件来填充一列，如果人数等于 1，则意味着该人是独自一人，否则该人不是独自一人(为了简化，我们假设 0 不存在于“人数”列中):</p><p id="ccb6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">常见 Python:</p><pre class="kn ko kp kq gt mj mk ml mm aw mn bi"><span id="79ec" class="lw kz iq mk b gy mo mp l mq mr">df['alone'] = ''<br/>df.loc[df['number_of_persons'] == 1]]['alone'] = 'Yes'<br/>df.loc[['number_of_persons'] != 1]]['alone'] = 'No'</span></pre><p id="121c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Python 技巧:</p><pre class="kn ko kp kq gt mj mk ml mm aw mn bi"><span id="ed1e" class="lw kz iq mk b gy mo mp l mq mr">df['alone'] = np.where(df['number_of_persons']==1,'Yes','No')</span></pre><h2 id="a0d8" class="lw kz iq bd la lx ly dn le lz ma dp li jy mb mc lm kc md me lq kg mf mg lu mh bi translated">获取所有数字列(pd。DF()。select_dtypes(include=[]))</h2><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi my"><img src="../Images/0f18173aedeb9b9b3e94ca274c4759ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:450/format:webp/1*cCFIZFgtm9U7nF_PYV_zvQ.jpeg"/></div></figure><p id="72be" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">对于大多数机器学习算法，我们需要给它们数值。Pandas DataFrame 提供了一种选择这些列的简单方法。您还可以使用 select_dtypes 选择任何类型的数据类型作为对象、分类...</p><p id="dae7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">常见 Python:</p><pre class="kn ko kp kq gt mj mk ml mm aw mn bi"><span id="a646" class="lw kz iq mk b gy mo mp l mq mr">df_train.info()</span><span id="8d4e" class="lw kz iq mk b gy mt mp l mq mr"><strong class="mk ir">&lt;class 'pandas.core.frame.DataFrame'&gt;<br/>Index: 819 entries, 0_0 to 2_29<br/>Data columns (total 4 columns):<br/>image_id                     812 non-null object<br/>age                          816 non-null int64<br/>gender                       819 non-null object<br/>number_of_persons            734 non-null float64<br/>dtypes: float64(10), object(3)<br/>memory usage: 89.6+ KB<br/></strong></span><span id="ac40" class="lw kz iq mk b gy mt mp l mq mr">numerical_column = ['age','number_of_persons']<br/>X_train = df_train[numerical_column]</span></pre><p id="1839" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Python 技巧:</p><pre class="kn ko kp kq gt mj mk ml mm aw mn bi"><span id="5d86" class="lw kz iq mk b gy mo mp l mq mr">X_train = df_train.select_dtypes(include=['int64','float64'])</span></pre><h2 id="68c1" class="lw kz iq bd la lx ly dn le lz ma dp li jy mb mc lm kc md me lq kg mf mg lu mh bi translated">获取 DataFrame 选择中条件的倒数(。[~条件])</h2><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi mz"><img src="../Images/90103fa570b1e08df6f596486b2e5107.png" data-original-src="https://miro.medium.com/v2/resize:fit:698/format:webp/1*7qSx5gy1jMY_ke34TkQPQA.png"/></div></figure><p id="6bd2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">例如，我们将为成年人和未成年人创建两个列。</p><p id="0799" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">常见 Python:</p><pre class="kn ko kp kq gt mj mk ml mm aw mn bi"><span id="9b95" class="lw kz iq mk b gy mo mp l mq mr">minor_check = df.age.isin(list(range(0,18)))<br/>df['minor'] = df[minor_check]</span><span id="79e3" class="lw kz iq mk b gy mt mp l mq mr">df['adult’] = df[not (minor_check)]</span><span id="edf7" class="lw kz iq mk b gy mt mp l mq mr"><strong class="mk ir">ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().</strong></span></pre><p id="09bb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Python 大师:</p><p id="c266" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们知道。isna()和 isin()可以检索 nan 值和 dataframe 列中的列表值。但是 isNOTna() ans isNOTin()不存在，符号来了~(也可以用 np.invert():)。</p><pre class="kn ko kp kq gt mj mk ml mm aw mn bi"><span id="a6f5" class="lw kz iq mk b gy mo mp l mq mr">minor_check = df.age.isin(list(range(0,18)))<br/>df['minor'] = df[minor_check]<br/>df['adult’] = df[~minor_check]</span></pre><p id="a817" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">希望这些技巧会有所帮助，请不要犹豫，分享你的！:)</p></div></div>    
</body>
</html>