<html>
<head>
<title>Making 3 Easy Maps With Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用 Python 制作 3 张简单的地图</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/making-3-easy-maps-with-python-fb7dfb1036?source=collection_archive---------6-----------------------#2019-04-22">https://towardsdatascience.com/making-3-easy-maps-with-python-fb7dfb1036?source=collection_archive---------6-----------------------#2019-04-22</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/0bb46d5ad1f5ccc71798823f02e1a9b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VSc2CM7b-ZIon95AFyFUAw.jpeg"/></div></div></figure><p id="4127" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在处理地理空间数据时，我经常需要以最自然的方式将这些数据可视化:<strong class="kd iu">一张地图。</strong>如果我们能够使用 Python 快速、轻松地创建您的数据的交互式地图，岂不是很好？在本教程中，我们将使用洛杉矶县所有星巴克咖啡店的数据集。在这篇介绍性文章结束时，您将能够创建:</p><ul class=""><li id="d4b6" class="kz la it kd b ke kf ki kj km lb kq lc ku ld ky le lf lg lh bi translated">洛杉矶县所有星巴克店的基本<strong class="kd iu">点地图</strong></li><li id="06e5" class="kz la it kd b ke li ki lj km lk kq ll ku lm ky le lf lg lh bi translated">一张<strong class="kd iu"> choropleth 地图</strong>根据每家星巴克包含多少家星巴克来区分洛杉矶县的邮政编码</li><li id="c6ca" class="kz la it kd b ke li ki lj km lk kq ll ku lm ky le lf lg lh bi translated">一张<strong class="kd iu">热图</strong>，突出了洛杉矶县星巴克的“热点”</li></ul><p id="5ff9" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我们开始吧！</p><h1 id="8cee" class="ln lo it bd lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk bi translated">你将需要…</h1><ul class=""><li id="4e9f" class="kz la it kd b ke ml ki mm km mn kq mo ku mp ky le lf lg lh bi translated">蟒蛇包<strong class="kd iu">熊猫。</strong>这是用来在 Python 中轻松操作数据的</li><li id="0173" class="kz la it kd b ke li ki lj km lk kq ll ku lm ky le lf lg lh bi translated">蟒蛇包<strong class="kd iu">叶子</strong>。这是用来非常容易地创建地图</li><li id="52e7" class="kz la it kd b ke li ki lj km lk kq ll ku lm ky le lf lg lh bi translated">洛杉矶县星巴克的经纬度电子表格(在我的 GitHub 上<a class="ae mq" href="https://github.com/ritvikmath/StarbucksStoreScraping/blob/master/starbucksInLACounty.csv" rel="noopener ugc nofollow" target="_blank"> <strong class="kd iu">这里</strong> </a>)</li><li id="d2ac" class="kz la it kd b ke li ki lj km lk kq ll ku lm ky le lf lg lh bi translated">一个洛杉矶县的 GeoJSON(基本上是描述复杂形状的 JSON)(此处为<a class="ae mq" href="https://github.com/ritvikmath/StarbucksStoreScraping/blob/master/laMap.geojson" rel="noopener ugc nofollow" target="_blank"><strong class="kd iu"/></a>)和一个洛杉矶县所有邮政编码的 geo JSON(<a class="ae mq" href="https://github.com/ritvikmath/StarbucksStoreScraping/blob/master/laZips.geojson" rel="noopener ugc nofollow" target="_blank"><strong class="kd iu">此处为</strong> </a>)</li></ul><p id="c49e" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">为了熟悉数据，下面是前几行的快照:</p><figure class="ms mt mu mv gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mr"><img src="../Images/f9a91db392ebd63c192919d02c6c96db.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nIf8h4Yy8IPl-rpxskmtOQ.png"/></div></div></figure><p id="1612" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">对于这个分析，我们只需要关心纬度、经度和邮政编码字段。</p><p id="30ef" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">以下是所需的 Python 导入、加载 Starbucks 数据和加载 LA County GeoJSON:</p><figure class="ms mt mu mv gt ju"><div class="bz fp l di"><div class="mw mx l"/></div></figure></div><div class="ab cl my mz hx na" role="separator"><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd"/></div><div class="im in io ip iq"><h1 id="12c6" class="ln lo it bd lp lq nf ls lt lu ng lw lx ly nh ma mb mc ni me mf mg nj mi mj mk bi translated">基点地图</h1><p id="8a69" class="pw-post-body-paragraph kb kc it kd b ke ml kg kh ki mm kk kl km nk ko kp kq nl ks kt ku nm kw kx ky im bi translated">从我们的数据框架中的纬度/经度对创建洛杉矶县所有星巴克的基本点地图非常简单。</p><figure class="ms mt mu mv gt ju"><div class="bz fp l di"><div class="mw mx l"/></div></figure><p id="f6b2" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">打开<strong class="kd iu">laPointMap.html</strong>，我们看到如下地图:</p><figure class="ms mt mu mv gt ju gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/423aa05baeacf23575bc7e7c0daa9c30.png" data-original-src="https://miro.medium.com/v2/resize:fit:1002/format:webp/1*VkWHg714ccBiBIFQJG_19w.png"/></div></figure><p id="43ea" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我们可以清楚地看到洛杉矶县所有的星巴克都是洛杉矶县区域内的小红点。当然，您可以自定义任何颜色和形状的点。</p></div><div class="ab cl my mz hx na" role="separator"><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd"/></div><div class="im in io ip iq"><h1 id="f637" class="ln lo it bd lp lq nf ls lt lu ng lw lx ly nh ma mb mc ni me mf mg nj mi mj mk bi translated">等值区域图</h1><p id="572a" class="pw-post-body-paragraph kb kc it kd b ke ml kg kh ki mm kk kl km nk ko kp kq nl ks kt ku nm kw kx ky im bi translated">在用 Python 玩地图之前，我实际上不知道什么是 choropleth 地图，但事实证明它们在可视化聚合地理空间数据方面非常有用。</p><p id="727d" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我们的 choropleth 地图将回答这个问题:<strong class="kd iu">“洛杉矶县哪个邮政编码有最多的星巴克？”</strong>。choropleth 地图根据其他变量的值(在我们的例子中是星巴克店的数量)对每个邮政编码进行着色。</p><p id="c8bf" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">让我们先来看看创建一个所需的基本代码:</p><figure class="ms mt mu mv gt ju"><div class="bz fp l di"><div class="mw mx l"/></div></figure><p id="3fe9" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">因为我个人发现要理解如何将 choropleth 的所有组件放置到位更加困难，所以让我们来看看一个单独的视觉效果，看看它是如何工作的。</p><figure class="ms mt mu mv gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi no"><img src="../Images/7cc1d7b19ce6bb3d22a60a5b504682bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ofS5k_QTzDQ5uir1lHJ01w.png"/></div></div></figure><p id="4428" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">choropleth 需要知道为邮政编码<strong class="kd iu"> 90001、</strong>填充什么颜色。它检查由<strong class="kd iu">数据</strong>字段引用的熊猫数据帧，搜索邮政编码的<strong class="kd iu"> key_on </strong>列，并找到在<strong class="kd iu">列</strong>中列出的另一列，即<em class="np"> numStores </em>。然后它知道它需要填充对应于邮政编码为<strong class="kd iu"> 90001 </strong>的<strong class="kd iu"> 3 商店</strong>的颜色。</p><p id="1977" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">然后，它在由<strong class="kd iu"> geo_path </strong>字段引用的 GeoJSON 中查找，并找到邮政编码<strong class="kd iu"> 90001 </strong>及其关联的<strong class="kd iu">形状信息</strong>，这告诉它在地图上为该邮政编码绘制哪个形状。通过这些链接，它拥有所有必要的信息。让我们看看 laChoropleth.html 由此产生的 choropleth！</p><figure class="ms mt mu mv gt ju gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/b50e70802e8f4d61c52fcca3f5f93924.png" data-original-src="https://miro.medium.com/v2/resize:fit:974/format:webp/1*USwgWMkyPx2uRudLjlF_LQ.png"/></div></figure><p id="a9a3" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我们看到它在顶部有一个漂亮的颜色条供参考。</p></div><div class="ab cl my mz hx na" role="separator"><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd"/></div><div class="im in io ip iq"><h1 id="e1a5" class="ln lo it bd lp lq nf ls lt lu ng lw lx ly nh ma mb mc ni me mf mg nj mi mj mk bi translated">热图</h1><p id="6814" class="pw-post-body-paragraph kb kc it kd b ke ml kg kh ki mm kk kl km nk ko kp kq nl ks kt ku nm kw kx ky im bi translated">在上面的 choropleth 地图中，我们看到洛杉矶南部地区似乎有更多的星巴克店，但我们能不能再具体一点？我们能不能找出附近哪里有很多星巴克店？基本上，让我们创建一个热图来突出显示洛杉矶县的星巴克“热点”。</p><figure class="ms mt mu mv gt ju"><div class="bz fp l di"><div class="mw mx l"/></div></figure><p id="20a7" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">热图中需要一些试错的主要参数是<strong class="kd iu">半径</strong>和<strong class="kd iu">模糊</strong>，前者控制每个星巴克店周围的圆圈有多大，后者控制圆圈“融合”在一起的程度。</p><p id="e24a" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">较高的半径意味着任何给定的星巴克影响较宽的区域，而较高的模糊度意味着彼此相距较远的两个星巴克仍然可以对热点有所贡献。参数由你决定！</p><p id="4c1a" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">让我们看看 laHeatmap.html 的天气图。</p><figure class="ms mt mu mv gt ju gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/9284f2d4c244a05f5ff686c66c8774f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:958/format:webp/1*SiPtN1cQdIcLA0MA3QQDBA.png"/></div></figure><p id="3975" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">嗯……很酷，但是看起来好像所有的东西都是红色的。如果放大，热图可能更有价值。让我们放大一点，看看我们是否能确定更具体的热点。</p><figure class="ms mt mu mv gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi ns"><img src="../Images/1afe29b6b8be4236626d84d54abfb7ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1352/format:webp/1*gu95eF4Yp9adiqZ_k4peMA.png"/></div></div></figure><p id="cb23" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">不错！从上面的地图可以很清楚地看出，我们有一些热点和一些非热点(notspots？)在地图里。一个突出的是在洛杉矶市中心的<strong class="kd iu"/>(可以理解)。</p></div><div class="ab cl my mz hx na" role="separator"><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd"/></div><div class="im in io ip iq"><p id="208b" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">也就这样了！我唯一的遗憾是，我还没有找到一种方法来嵌入这些地图的实际互动版本，所以我只能给你看截图。我<strong class="kd iu">强烈鼓励</strong>你通过这篇文章运行小代码来为自己玩交互式地图。这是一种完全不同的体验。</p><p id="ec72" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我希望这篇文章对你有所帮助，下一篇再见！</p><p id="2de2" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">包含本分析中使用的所有代码的完整笔记本可以在我的 GitHub <a class="ae mq" href="https://github.com/ritvikmath/StarbucksStoreScraping/blob/master/MakingLAMaps.ipynb" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p></div></div>    
</body>
</html>