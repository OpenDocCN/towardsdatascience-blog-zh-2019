<html>
<head>
<title>Getting Weather Data in 3 Easy Steps</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">通过 3 个简单的步骤获取天气数据</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/getting-weather-data-in-3-easy-steps-8dc10cc5c859?source=collection_archive---------5-----------------------#2019-06-10">https://towardsdatascience.com/getting-weather-data-in-3-easy-steps-8dc10cc5c859?source=collection_archive---------5-----------------------#2019-06-10</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/1a3a5f810a411758c5ccd6e6f775a9f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Bd8wfagi6-BBz9vb"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk">Photo by <a class="ae kf" href="https://unsplash.com/@maxlarochelle?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Max LaRochelle</a> on <a class="ae kf" href="https://unsplash.com/search/photos/weather?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="eb35" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">继续我们的数据收集之旅，这次我们将看看如何收集<strong class="ki iu">天气数据</strong>。天气数据的应用是无穷无尽的，从独立的天气预报应用到天气分析只是更大目标的一个组成部分的项目。</p><p id="e89c" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在我的团队帮助俄亥俄州辛辛那提市改善其紧急医疗响应系统的项目中，我个人发现需要访问天气数据。我的团队需要使用每日天气数据作为模型中的预测器，来预测整个城市的应急响应水平。</p><p id="18a5" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们将从最可靠的来源获得天气数据，<strong class="ki iu"> NOAA </strong>(美国国家海洋和大气管理局)。</p><p id="dcf7" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">既然我现在住在美丽的<strong class="ki iu">加州长滩</strong>，让我们通过尝试回答以下问题来引导我们的探索:</p><p id="0ed5" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">【2015 年以来，长滩的日平均气温变化如何？</p><p id="ee11" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们开始吧！</p></div><div class="ab cl le lf hx lg" role="separator"><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj"/></div><div class="im in io ip iq"><h1 id="7bd5" class="ll lm it bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">1.向 NOAA 请求访问令牌</h1><p id="aa3c" class="pw-post-body-paragraph kg kh it ki b kj mj kl km kn mk kp kq kr ml kt ku kv mm kx ky kz mn lb lc ld im bi translated">为了从 NOAA 请求数据，我们将需要请求一个<strong class="ki iu">访问令牌</strong>，它基本上确认我们是请求数据的可信来源。导航至<a class="ae kf" href="https://www.ncdc.noaa.gov/cdo-web/token" rel="noopener ugc nofollow" target="_blank">请求令牌网站</a>。</p><figure class="mp mq mr ms gt ju gh gi paragraph-image"><div class="gh gi mo"><img src="../Images/5b7f03ec6d66397bd0f141d397d3829f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1252/format:webp/1*vlVSQO7HqtDd9ZNnRnwSOQ.png"/></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk">Request an Access Token from NOAA</figcaption></figure><p id="b1e9" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">填写一个电子邮件地址，您很快就会收到一封包含您的访问令牌的电子邮件。把它存放在安全的地方，保持私密。否则，其他人可能会代表你向 NOAA 提出请求，而你不一定希望这样。</p></div><div class="ab cl le lf hx lg" role="separator"><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj"/></div><div class="im in io ip iq"><h1 id="4ec5" class="ll lm it bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">2.确定要访问哪个气象站</h1><p id="7ea9" class="pw-post-body-paragraph kg kh it ki b kj mj kl km kn mk kp kq kr ml kt ku kv mm kx ky kz mn lb lc ld im bi translated">下一件你可能想做的事情是找出从哪个气象站收集数据。找到该电台最简单的方法是导航到<a class="ae kf" href="https://www.ncdc.noaa.gov/cdo-web/datatools/findstation" rel="noopener ugc nofollow" target="_blank">查找电台网站</a></p><figure class="mp mq mr ms gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mu"><img src="../Images/0e0f43747357fbaa4f7ecff46233bb03.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ulXJzRHgi_MCrRGFsD6_PA.png"/></div></div></figure><p id="b677" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">根据您的<strong class="ki iu">首选位置</strong>、<strong class="ki iu">数据集首选项</strong>(选择<em class="mt">每日概要</em>获取每日数据)、<strong class="ki iu">时间范围</strong>(您选择的范围越长，越少的站将拥有完整的数据)和<strong class="ki iu">数据类别</strong>(我们只关心手头任务的气温)。</p><p id="7878" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">页面右侧的地图将自动更新可用的电台。</p><figure class="mp mq mr ms gt ju gh gi paragraph-image"><div class="gh gi mv"><img src="../Images/dec855807e0480d718e6727ca53bdba8.png" data-original-src="https://miro.medium.com/v2/resize:fit:654/format:webp/1*c-gmevqC-hzqzGHTbF4_mw.png"/></div></figure><p id="7574" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">对于这个应用程序，我们将选择长滩机场站。请务必记下电台 ID。对我们来说就是<strong class="ki iu"> GHCND:USW00023129。</strong></p></div><div class="ab cl le lf hx lg" role="separator"><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj"/></div><div class="im in io ip iq"><h1 id="4ffe" class="ll lm it bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">3.抢数据！</h1><p id="900a" class="pw-post-body-paragraph kg kh it ki b kj mj kl km kn mk kp kq kr ml kt ku kv mm kx ky kz mn lb lc ld im bi translated">现在我们有了访问令牌，并且知道了我们希望访问的站点的 ID，剩下要做的就是向 NOAA 请求数据。我们将使用 Python 的<strong class="ki iu"> <em class="mt">请求</em> </strong>库来完成这个任务。</p><p id="28e9" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">首先让我们用 Python 导入所需的库。</p><figure class="mp mq mr ms gt ju"><div class="bz fp l di"><div class="mw mx l"/></div></figure><p id="aaac" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">为了向 NOAA 请求数据，我们需要使用 NOAA 的<strong class="ki iu"> API </strong>(应用程序编程接口)，它基本上只是与 NOAA 通信以请求数据的特定语言。</p><p id="2ced" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们来看一下 NOAA API 请求的结构。</p><p id="a869" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">基本请求如下所示:</p><blockquote class="my mz na"><p id="9956" class="kg kh mt ki b kj kk kl km kn ko kp kq nb ks kt ku nc kw kx ky nd la lb lc ld im bi translated"><strong class="ki iu"><em class="it">https://www.ncdc.noaa.gov/cdo-web/api/v2/data?</em></strong></p></blockquote><p id="6a2d" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在问号后面，'？'，我们将需要把所有的选项指定确切的数据，我们正在寻找。这些将包括:</p><ul class=""><li id="5ca2" class="ne nf it ki b kj kk kn ko kr ng kv nh kz ni ld nj nk nl nm bi translated"><strong class="ki iu"> <em class="mt"> datasetid </em> </strong>，对我们来说就是<strong class="ki iu"> GHCND </strong>(全球历史气候网络日报)。</li><li id="6a13" class="ne nf it ki b kj nn kn no kr np kv nq kz nr ld nj nk nl nm bi translated"><strong class="ki iu"> <em class="mt"> datatypeid </em> </strong>，这是我们要寻找的变量列表。对我们来说，那将是平均气温</li><li id="3955" class="ne nf it ki b kj nn kn no kr np kv nq kz nr ld nj nk nl nm bi translated"><strong class="ki iu"> <em class="mt">限制</em> </strong>，指定响应中包含的最大项数。默认是 25，最大是<strong class="ki iu"> 1000 </strong>，这是我们要设置的。</li><li id="b79c" class="ne nf it ki b kj nn kn no kr np kv nq kz nr ld nj nk nl nm bi translated"><strong class="ki iu"> <em class="mt"> stationid </em> </strong>，指定我们想要哪个(些)站的数据。我们的站号是<strong class="ki iu"> GHCND:USW00023129 </strong></li><li id="3d76" class="ne nf it ki b kj nn kn no kr np kv nq kz nr ld nj nk nl nm bi translated"><strong class="ki iu"> <em class="mt">开始日期</em> </strong>和<strong class="ki iu"> <em class="mt">结束日期</em> </strong>，指定我们希望从中获取数据的日期范围。我们将每年调用一次 API，因为 1000 个项目对于我们从 2015 年到现在的整个 3.5 年的日期范围来说是不够的。</li></ul><p id="8978" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">总之，我们对 2015 年所有数据的第一个请求如下:</p><blockquote class="my mz na"><p id="e628" class="kg kh mt ki b kj kk kl km kn ko kp kq nb ks kt ku nc kw kx ky nd la lb lc ld im bi translated">【https://www.ncdc.noaa.gov/cdo-web/api/v2/data? T42】datasetid = GH CND&amp;data typeid = TAVG&amp;limit = 1000&amp;station id = GH CND:usw 00023129&amp;start date = 2015-01-01&amp;end date = 2015-12-31</p></blockquote><p id="a7a9" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们看看进行 API 调用的代码:</p><figure class="mp mq mr ms gt ju"><div class="bz fp l di"><div class="mw mx l"/></div></figure><p id="6020" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在是将收集的数据存储为数据帧的代码:</p><figure class="mp mq mr ms gt ju"><div class="bz fp l di"><div class="mw mx l"/></div></figure><p id="37ba" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">由生成的数据帧制成的图表如下所示:</p><figure class="mp mq mr ms gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi ns"><img src="../Images/44be9aa638c50dfa4f5d9308180a14cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OUcYvE1z5yjdwMkUmYRGew.png"/></div></div></figure><p id="05ba" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu">好看！</strong>因此，我们成功地请求、处理并报告了自 2015 年 1 月以来加州长滩的日平均气温。</p></div><div class="ab cl le lf hx lg" role="separator"><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj"/></div><div class="im in io ip iq"><p id="a720" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">事实上，NOAA API 内置了更多的选项。查看<a class="ae kf" href="https://www.ncdc.noaa.gov/cdo-web/webservices/v2#data" rel="noopener ugc nofollow" target="_blank">完整文档</a>。我认为浏览 NOAA API 的一个完整的具体用例是一个好的开始。</p><p id="dca1" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="mt"> ~数据采集快乐！:)</em></p></div></div>    
</body>
</html>