# 太多颠倒的照片？花 20 分钟，用 AI 来翻它们。

> 原文：<https://towardsdatascience.com/too-many-upside-down-photos-take-20-minutes-and-use-ai-to-flip-them-cba6525e2bf2?source=collection_archive---------10----------------------->

![](img/b6232a5a6b08308067f171e556b991bc.png)

当你花了两个小时扫描照片，却突然发现你已经把一些随机的照片上下颠倒了，这真是太棒了。与其痛苦地浏览每一个并翻动它们，你可能会觉得你宁愿跳到一辆卡车前面。嗯，当一个客户带着类似的问题来找我们时，我立即想知道机器学习是否能够有所帮助。你猜怎么着？确实如此。结束了。

如果你有兴趣知道我是如何在 20 分钟内做到的，那么请继续阅读。

有时候，机器学习可能更多地是一门艺术而不是科学，即使它在技术上是一门科学。也许科学就是艺术？一个稍后讨论的无聊话题，更有趣的是我在这里提出它的原因。

> 每当我被问到“我们可以用机器学习来解决这个问题吗？”我的回答永远是“不知道— **我们试试看**”。

实验对于成功使用机器学习至关重要。如果你花了 6 个月的时间为一个特定的用例建立一个模型，你可能会发现为时已晚，它并不真的工作得很好。相反，我喜欢寻找快速测试的方法，看看使用机器学习来解决问题是否有一些可行性。

所以，回到正面朝下的照片。这个特殊的用例是关于有时上下颠倒的人的照片。大多数面部识别工具在面部上下颠倒时都会有困难，所以我们至少需要在将其提交给面部识别功能之前将其翻转为正面朝上。

所以我想，让我们试着训练一个图像分类器，看看我们能否检测出一张照片是不是上下颠倒的。请注意，这是在研究了检查 EXIF 元数据以查看其中是否有关于旋转的信息的可能性之后；没有。

我做的第一件事是搜寻训练数据。我去谷歌图片搜索‘脸’。我下载了尽可能多的图片(大约 346 张),并创建了一组正面朝上的图片。然后，我尝试用谷歌图片搜索“颠倒的脸”——这是一个错误，原因有很多很多。最相关的原因是因为我想做的是训练分类器来检测两个可能相同的东西之间的差异，所以我选择翻转所有正面朝上的照片，这样我就有了一个颠倒的副本。我知道如何大规模实现这一点的唯一方法是使用苹果的 Automator。

设置您的工作流程，使“获取指定的 Finder 项目”指向“面孔”文件夹，链接到“获取文件夹内容”，链接到“拷贝 Finder 项目”并创建新文件夹，然后将“旋转图像”设置为 180 度。

我运行了这个工作流程，最终得到了相同数量的颠倒的面。然后，我去了我们的一个开源项目 [imgclass](https://github.com/machinebox/toys/tree/master/imgclass) ，下载了命令行工具，安装了[分类框](https://machinebox.io/docs/classificationbox?utm_source=Medium&utm_medium=Post&utm_campaign=upside%20down%20faces)，开始了培训工作。

“该死”当我看着 imgclass 输出的结果精度时，我喊道。只有 34%。不够好。我需要更多的训练数据。所以我想，哪里可以找到更多的面孔？没错，野外贴标签的脸！

野生环境中的标签人脸拥有 13234 张独特的人脸图片。我很快下载了它，运行 bash 命令将所有照片从它们的嵌套目录中移除，并将其展平到一个文件夹中，然后在这个文件夹上再次运行 automator 工作流以创建颠倒的类，并在新的数据集上启动 imgclass。

![](img/05ecbe2d2b415b67f60bf31a4152c625.png)

在我的 Mac 电脑上用这么多照片训练 Classificationbox 花了大约 1 小时 45 分钟，所以从技术上讲，整个过程花了 20 多分钟，但我自己只花了大约 20 分钟。

一旦完成，我对 imgclass 报告的新的准确数字感到自豪。99.97%

果酱！

现在，我有了一个有效的模型来检测面部照片何时颠倒，我可以在工作流程中使用它来校正无数的图像。如果你真的对使用这个感兴趣，我会为你节省 20 分钟+~ 2 小时的处理时间，并在这里给你一个模型[的链接。](https://drive.google.com/file/d/12TNDWkOk24Q-Nf0FbletcME_qTLI74R6/view?usp=sharing)

将该状态文件加载到 Classificationbox 中，就可以开始检测颠倒的人脸了。

不客气。