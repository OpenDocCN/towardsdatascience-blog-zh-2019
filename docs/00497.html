<html>
<head>
<title>Creating AI for GameBoy Part 1: Coding a Controller</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">为 GameBoy 创建 AI 第 1 部分:编写控制器代码</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/creating-ai-for-gameboy-part-1-coding-a-controller-5eb782f54ede?source=collection_archive---------17-----------------------#2019-01-22">https://towardsdatascience.com/creating-ai-for-gameboy-part-1-coding-a-controller-5eb782f54ede?source=collection_archive---------17-----------------------#2019-01-22</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/4a278b866c9f45292bf0b8baf37d67f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*aiFMwAWw4nf9a7RF.gif"/></div></div></figure><p id="4f47" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">2003 年发布的《火徽，炽剑》是一款非常成功的战略游戏，其角色出现在《超级粉碎兄弟》中，该系列的第 15 部将于 2019 年初上映。游戏的玩法是选择角色(又名单位)，决定将他们移动到哪里，然后从一组选项中决定攻击、使用物品等等。因为我在十几岁和十几岁时非常喜欢这个游戏，所以我想为这个 Gameboy Advance classic 制作一个 AI。这篇文章将是我在从头开始构建一个玩游戏的人工智能的过程中，将这一努力分成更多小块的第一篇。这里展示的代码可以在 github.com/aaronfrederick 找到，它的最新版本是为那些想要创建类似项目的人准备的。</p><p id="b336" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在这个项目开始的时候，我把任务分成了 4 大块:</p><ol class=""><li id="be24" class="la lb it kd b ke kf ki kj km lc kq ld ku le ky lf lg lh li bi translated">在 python 中创建控制器</li><li id="c926" class="la lb it kd b ke lj ki lk km ll kq lm ku ln ky lf lg lh li bi translated">从游戏中获取数据</li><li id="7773" class="la lb it kd b ke lj ki lk km ll kq lm ku ln ky lf lg lh li bi translated">自动化播放过程以连续生成数据</li><li id="0b7e" class="la lb it kd b ke lj ki lk km ll kq lm ku ln ky lf lg lh li bi translated">实现一种算法来优化游戏</li></ol><p id="3ead" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">为了玩火徽和创造一个 AI，我下载了<a class="ae kz" href="http://www.emulator-zone.com/doc.php/gba/vboyadvance.html" rel="noopener ugc nofollow" target="_blank"> VisualBoy Advance </a>模拟器和一个<a class="ae kz" href="https://emulator.games/roms/gameboy-advance/fire-emblem/" rel="noopener ugc nofollow" target="_blank">火徽 ROM </a>到我的电脑上。该模拟器与 ROM 一起，允许人们在一台计算机上从不同的控制台玩游戏。另一个例子是海豚模拟器，它允许在电脑上玩 Wii 和 Gamecube 游戏。</p><figure class="lp lq lr ls gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi lo"><img src="../Images/4c95046ee2c70ff0801d40cc86c2372a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QJnUrPB8l9x7pE1BFfU1Qw.png"/></div></div><figcaption class="lt lu gj gh gi lv lw bd b be z dk">Pyautogui will not work unless the box is checked!</figcaption></figure><p id="c4ce" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">现在我们已经有了模拟器设置，我们需要能够以编程方式访问它。在准备过程中，我打开了模拟器，并把它放在电脑屏幕的左上角，不受其他应用程序的干扰。有一个一致的位置是至关重要的，在这里我们将点击选择模拟器，但这个一致的位置更重要的是从屏幕上获取信息时，到了屏幕上的数据模拟器。pyautogui 库非常适合用 python 控制你的电脑，但是如果你像我一样在 Mac 上，你需要让终端访问你的电脑，如左图所示。</p><p id="a9a4" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我们需要做的第一件事是选择模拟器，让它运行，这可以通过将鼠标移动到应用程序上并单击来完成。</p><pre class="lp lq lr ls gt lx ly lz ma aw mb bi"><span id="2bb6" class="mc md it ly b gy me mf l mg mh">import pyautogui</span><span id="2a81" class="mc md it ly b gy mi mf l mg mh">pyautogui.moveTo(7,54,0.2)<br/>pyautogui.click()</span></pre><figure class="lp lq lr ls gt ju"><div class="bz fp l di"><div class="mj mk l"/></div><figcaption class="lt lu gj gh gi lv lw bd b be z dk">The code above with a 4 second time to reach destination for clarity</figcaption></figure><p id="de8c" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">传递给 moveTo 函数的参数是<em class="ml"> x 像素位置</em>、<em class="ml"> y 像素位置</em>和<em class="ml">到达该位置所用的时间</em>。因为左上角是(0，0)，所以我们将鼠标移动到靠近左上角，但不是一直移动，这样我们就可以将光标放在应用程序上。</p><p id="a58a" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">为了在我们选择模拟器后按下按钮，我们需要一个再次使用 pyautogui 的函数。下面的 press_key 函数为将来简化了这一点，这样我们只需键入 press_key(键，次数)就可以轻松控制游戏。</p><pre class="lp lq lr ls gt lx ly lz ma aw mb bi"><span id="6e92" class="mc md it ly b gy me mf l mg mh">def press_key(key, n_times = 1):<br/>    for _ in range(n_times):<br/>        pyautogui.keyDown(key)<br/>        pyautogui.keyUp(key)</span></pre><p id="be7c" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">现在我们可以按按钮了，我们需要把它应用到游戏中。我将在这个例子中展示的三个函数是 select_next_unit、move_unit 和 wait。这些函数将为这个人工智能做大部分的工作，所以把它们做好是很重要的。</p><p id="1874" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">如下所示，select_next_unit 只需按“q”键，然后按“'”键。这相当于在 Gameboy Advance 上按 L，然后按 A，这是将光标移动到下一个可用单位并按 A 的控件。这将弹出一个界面，允许我们选择将单位移动到哪里。</p><pre class="lp lq lr ls gt lx ly lz ma aw mb bi"><span id="9f52" class="mc md it ly b gy me mf l mg mh">def select_next_unit():<br/>    press_key('q')<br/>    press_key("'")</span></pre><p id="c94d" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在我的<a class="ae kz" href="https://github.com/aaronfrederick/Fire-Emblem-AI" rel="noopener ugc nofollow" target="_blank"> github </a>上实现的 move_unit 函数比这里显示的稍微复杂一些——它允许随机移动——但是功能基本相同。这个功能背后的基本思想是，我们要输入一组坐标来移动，然后按下按键来实现这些坐标。这些不等式是针对随机移动世代的，因此，例如，如果左的值大于右，我们只按左。</p><pre class="lp lq lr ls gt lx ly lz ma aw mb bi"><span id="3379" class="mc md it ly b gy me mf l mg mh">def move_unit(left=0,right=0,up=0,down=0):<br/>    ret_list = [left,right,up,down]<br/>    if left&gt;right:<br/>        press_key('a', left-right)<br/>    elif right&gt;left:<br/>        press_key('d', right-left)<br/>    if up&gt;down:<br/>        press_key('w', up-down)<br/>    elif down&gt;up:<br/>        press_key('s', down-up)<br/>    press_key("'")<br/>    time.sleep(0.2)<br/>    return ret_list</span></pre><p id="d27b" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">使用 W，A，S，D 分别作为上，左，下，上，我们可以按下按键的次数，对应于我们传入的坐标。一旦我们移动我们的单位，我们会看到一个菜单，允许我们使用一个项目或等待。使用等待功能，我们将保持我们的单位(Lyn)在我们移动她的地方，然后结束我们的回合。</p><pre class="lp lq lr ls gt lx ly lz ma aw mb bi"><span id="5c98" class="mc md it ly b gy me mf l mg mh">def wait():<br/>    time.sleep(0.2)<br/>    press_key('w')<br/>    time.sleep(0.2)<br/>    press_key("'")</span></pre><figure class="lp lq lr ls gt ju"><div class="bz fp l di"><div class="mj mk l"/></div><figcaption class="lt lu gj gh gi lv lw bd b be z dk">The code to the right playing Fire Emblem!</figcaption></figure><p id="2e85" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">把这三个功能放在一起，我们就可以在火徽第一关第一个回合了！左边的 GIF 显示了下面的代码在工作。</p><pre class="lp lq lr ls gt lx ly lz ma aw mb bi"><span id="dcd3" class="mc md it ly b gy me mf l mg mh">#Select the Emulator<br/>pyautogui.moveTo(7,54,0.2)<br/>pyautogui.click()<br/>time.sleep(0.3)</span><span id="6955" class="mc md it ly b gy mi mf l mg mh">#Play the Game<br/>select_next_unit()<br/>move_unit(left=2, up=2)<br/>wait()</span></pre><p id="54ee" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在第 2 部分，我将讨论如何从这个游戏中获取信息，以便我们可以为机器学习创建数据集和损失函数。这将涉及一些图像处理技术，并创建一个图像分类器来智能地从屏幕上提取数据。</p></div></div>    
</body>
</html>