<html>
<head>
<title>Deep Learning for Survival Analysis</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用于生存分析的深度学习</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/deep-learning-for-survival-analysis-fdd1505293c9?source=collection_archive---------6-----------------------#2019-07-13">https://towardsdatascience.com/deep-learning-for-survival-analysis-fdd1505293c9?source=collection_archive---------6-----------------------#2019-07-13</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/9d7ede397d9b1dce779384522019cd48.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mDbibVxvnt_Xdu0BbqqCwQ.png"/></div></div></figure><p id="e0cf" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">最近我得到了一个从事生存分析的机会。像任何其他项目一样，我很兴奋，并开始探索更多关于生存分析的内容。根据维基百科，</p><blockquote class="kz la lb"><p id="994c" class="kb kc lc kd b ke kf kg kh ki kj kk kl ld kn ko kp le kr ks kt lf kv kw kx ky im bi translated">生存分析是统计学的一个分支，用于分析一个或多个事件发生前的预期持续时间，如生物有机体的死亡和机械系统的故障</p></blockquote><p id="1343" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">简而言之，这是一个<strong class="kd iu">时间事件分析</strong>，它关注于感兴趣的事件发生的时间。事件可以是死亡、传感器故障或疾病的发生等。生存分析是一个热门领域，在医学、流行病学、工程学等领域有广泛的应用。</p><p id="6a79" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><strong class="kd iu">你想知道深度学习是如何改变如此重要的领域的吗？</strong>如果是的话，那么你来对地方了。</p><p id="305e" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">当我开始看一看深度学习如何被用于生存分析时，令我惊讶的是，我找不到任何好文章。我接触到的所有材料和教程都只使用了统计方法。但是当我稍微深入挖掘时，我发现涉及神经网络的生存分析的重要研究最初是由 Faraggi 和 Simon 在 1995 年发表的[5]。</p></div><div class="ab cl lg lh hx li" role="separator"><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll"/></div><div class="im in io ip iq"><h2 id="bef3" class="ln lo it bd lp lq lr dn ls lt lu dp lv km lw lx ly kq lz ma mb ku mc md me mf bi translated">生存分析简介</h2><p id="0730" class="pw-post-body-paragraph kb kc it kd b ke mg kg kh ki mh kk kl km mi ko kp kq mj ks kt ku mk kw kx ky im bi translated">将通过理解生存分析中的关键定义从基础开始。</p><p id="7652" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">设<strong class="kd iu"> <em class="lc"> T </em> </strong>为随机变量，表示事件发生前的等待时间。除了通常的概率函数，我们还可以定义一些与生存分析相关的基本函数，如<strong class="kd iu">生存函数</strong>、<strong class="kd iu">风险函数</strong>等。</p><p id="3142" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">生存函数<strong class="kd iu"> <em class="lc"> S(t) </em> </strong>是<strong class="kd iu"> <em class="lc"> </em> </strong>到时间<em class="lc"> t </em>感兴趣的事件没有发生的概率。属性包括<em class="lc"> S(0) = 1 </em>、<em class="lc"> S(∞) = 0 </em>、<em class="lc"> S(t) </em>为非递增<em class="lc">。</em></p><figure class="mm mn mo mp gt ju gh gi paragraph-image"><div class="gh gi ml"><img src="../Images/33e6ebd15529f1701866ab9fadb6deb5.png" data-original-src="https://miro.medium.com/v2/resize:fit:608/format:webp/1*uwXxkFFHg0IEb9iWIbL7Hg.png"/></div></figure><p id="9520" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">并且危险函数<strong class="kd iu"> <em class="lc"> λ(t) </em> </strong>可以被视为事件在时间<em class="lc"> t </em>瞬间发生的概率，假设事件在时间<em class="lc"> t </em>之前没有发生。</p><figure class="mm mn mo mp gt ju gh gi paragraph-image"><div class="gh gi mq"><img src="../Images/ededaee4d0035a623ff62f0639846c04.png" data-original-src="https://miro.medium.com/v2/resize:fit:1260/format:webp/1*YXefffFyT1bWuyyhng70Hg.png"/></div></figure></div><div class="ab cl lg lh hx li" role="separator"><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll"/></div><div class="im in io ip iq"><h2 id="0324" class="ln lo it bd lp lq lr dn ls lt lu dp lv km lw lx ly kq lz ma mb ku mc md me mf bi translated">生存分析数据集</h2><p id="be65" class="pw-post-body-paragraph kb kc it kd b ke mg kg kh ki mh kk kl km mi ko kp kq mj ks kt ku mk kw kx ky im bi translated">需要注意的一个关键点是，我们不是在处理一个通常带有标签的数据集。<strong class="kd iu">生存分析的数据不同于标准回归或分类问题</strong>。在生存分析中，我们处理的是删失数据。删失是一种缺失数据问题。</p><p id="9b10" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">每当我们进行生存分析时，都会得到一个学习周期内的训练数据。<strong class="kd iu">如果被研究对象在研究期内没有经历该事件会怎样？</strong>。则称之为右删失数据。类似地，我们的数据集中也可以有左删失和区间删失样本。通常，我们将处理具有右删失样本的数据集。</p><figure class="mm mn mo mp gt ju gh gi paragraph-image"><div class="gh gi mr"><img src="../Images/f559c785ade878bd9b69686dadfe641d.png" data-original-src="https://miro.medium.com/v2/resize:fit:538/format:webp/1*yExRAdbT-dHIrjP0eNiv_g.png"/></div><figcaption class="ms mt gj gh gi mu mv bd b be z dk">Example dataset — <code class="fe mw mx my mz b"><strong class="bd na">lifelines.datasets.load_static_test</strong></code></figcaption></figure><p id="a73d" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在上面的示例数据集中，列<em class="lc"> id </em>标识所研究的单个对象。列<em class="lc"> E </em>将<em class="lc">T7】告诉我们数据是否被审查。换句话说，如果列<em class="lc"> E </em>的值为<em class="lc"> 1，</em>则相应的对象在研究期间经历了感兴趣的事件。这里，除了 id 为 3 </em>的对象外，所有对象都经历了该事件。对象<em class="lc"> id 3 </em>被右删。列<em class="lc"> t </em>是事件发生所用的时间，在删失数据的情况下，是研究时间。列<em class="lc"> var1 </em>，<em class="lc"> var2 </em>这里是对象的特征或协变量。例如，协变量可以是性别、年龄等。同时预测患者器官衰竭或心脏病发作的概率。</p></div><div class="ab cl lg lh hx li" role="separator"><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll"/></div><div class="im in io ip iq"><h2 id="3089" class="ln lo it bd lp lq lr dn ls lt lu dp lv km lw lx ly kq lz ma mb ku mc md me mf bi translated">标准方法</h2><p id="cedc" class="pw-post-body-paragraph kb kc it kd b ke mg kg kh ki mh kk kl km mi ko kp kq mj ks kt ku mk kw kx ky im bi translated">在使用神经网络解决生存分析问题之前，我们现在将简要地研究传统的统计方法。我们可以把标准方法大致分为非参数方法、半参数方法和参数方法。</p><p id="4f01" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">用于估计生存函数的最流行的非参数方法是<strong class="kd iu">Kaplan–Meier 估计法</strong>。最大的限制是它不能估计考虑协变量的存活率。</p><p id="3ff6" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">考虑协变量的生存数据的基本模型是<strong class="kd iu">比例风险模型</strong>。该模型由 D. Cox 教授(1972 年)提出，也被称为<strong class="kd iu"> Cox 回归模型</strong>。</p><figure class="mm mn mo mp gt ju gh gi paragraph-image"><div class="gh gi nb"><img src="../Images/9f1867488e26f4d1bbda097cf53fd645.png" data-original-src="https://miro.medium.com/v2/resize:fit:860/format:webp/1*nBqy6rWUXRNyu8Oxw3MNUQ.png"/></div></figure><p id="a27f" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">Cox 比例风险模型(CoxPH)假设风险函数由两个非负函数组成:基线风险函数<em class="lc">【λ₀(t】</em>和风险比或风险得分<em class="lc"> r(x) = exp{h(x)} </em>。风险分值被定义为对象的观察协变量对基线危害的影响。Cox 模型<strong class="kd iu">使用线性函数</strong>和潜在基线风险函数来估计对数风险函数<em class="lc"> h(x) </em>，而不采用任何特定形式。这种半参数方法比参数方法更灵活，成为更受欢迎的选择。</p><p id="4bf5" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这种比例风险假设也可以用生存函数来表示，如下所示。这里的<em class="lc"> S₀(t) </em>是基线生存函数<em class="lc">。</em></p><figure class="mm mn mo mp gt ju gh gi paragraph-image"><div class="gh gi nc"><img src="../Images/7a6ce88e168a4bbfe56c465716416696.png" data-original-src="https://miro.medium.com/v2/resize:fit:770/format:webp/1*UyUyfGTVPC_ZNzRciL7RzA.png"/></div></figure></div><div class="ab cl lg lh hx li" role="separator"><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll"/></div><div class="im in io ip iq"><h2 id="e829" class="ln lo it bd lp lq lr dn ls lt lu dp lv km lw lx ly kq lz ma mb ku mc md me mf bi translated">CoxPH 适应神经网络</h2><p id="6dfe" class="pw-post-body-paragraph kb kc it kd b ke mg kg kh ki mh kk kl km mi ko kp kq mj ks kt ku mk kw kx ky im bi translated">许多人已经尝试使用神经网络进行生存分析。随着深度学习领域的进步，最近的结果很有希望。</p><p id="1c7b" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">当涉及到用于生存分析的深度学习时，我们有两种主要的综合方法。一种方法可以看作是对 Cox 比例风险假设的修改，另一种方法使用完全参数化的生存模型。<strong class="kd iu">deep surv</strong>【1】，<strong class="kd iu">Cox-Nnet</strong>【2】将属于 CoxPH 适应方法，而<strong class="kd iu">Nnet-survival</strong>【3】，<strong class="kd iu">RNN-SURV</strong>【4】将属于第二种方法。我们将更加关注 CoxPH 适应方法，因为 Cox 模型已被证明非常有用，并且为大多数医学研究人员所熟悉[3]。</p><p id="8ba5" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在 Cox 模型中，除了比例风险假设，我们在估计对数风险函数<em class="lc"> h(x) </em>时还有另一个假设。<em class="lc"> </em>我们用一个线性函数来估计<em class="lc"> h(x) </em>。在许多情况下，例如，建模非线性基因相互作用，我们不能假设数据满足线性比例风险条件[1]。我们需要一个更复杂的非线性模型来预测对数风险函数<em class="lc">h(x)</em>，而神经网络可以满足我们的要求。</p></div><div class="ab cl lg lh hx li" role="separator"><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll"/></div><div class="im in io ip iq"><h2 id="39a0" class="ln lo it bd lp lq lr dn ls lt lu dp lv km lw lx ly kq lz ma mb ku mc md me mf bi translated">DeepSurv</h2><p id="3735" class="pw-post-body-paragraph kb kc it kd b ke mg kg kh ki mh kk kl km mi ko kp kq mj ks kt ku mk kw kx ky im bi translated">在本节中，我们将详细讨论 DeepSurv，以了解深度学习如何准确地用于生存分析。DeepSurv 是一个深度前馈神经网络，它预测由网络权重<em class="lc"> θ </em>参数化的对数风险函数<em class="lc"> h(x) </em>。</p><figure class="mm mn mo mp gt ju gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/c8e406f382c7d1cc69ea3b4d8a803816.png" data-original-src="https://miro.medium.com/v2/resize:fit:1030/format:webp/1*GgfOeCRFNUzLbd3AeJTAng.png"/></div><figcaption class="ms mt gj gh gi mu mv bd b be z dk">DeepSurv Architecture</figcaption></figure><p id="5b47" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">对象的观测协变量或称为特征作为网络的输入给出。网络的隐藏层包括一个完全连接的节点层，后面是一个断开层。输出层有一个线性激活的节点，用于估计 Cox 模型中的对数风险函数。网络的损失函数如下所示。</p><figure class="mm mn mo mp gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi ne"><img src="../Images/3b2f1b7a9583ddbc809695f65e89665f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jUSoqbx4QAmi0izEjy5TEg.png"/></div></div></figure><p id="61f8" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这是损失函数背后的直觉。为了最小化损失函数，我们需要最大化每个具有可观测事件<em class="lc"> (E = 1) </em>的对象在红框内的部分。为了最大化该部分，我们需要增加具有可观察事件的对象<em class="lc"> i </em>的风险因子，并降低直到时间<em class="lc"> Ti </em>之前没有经历该事件的对象<em class="lc"> j </em>的风险因子，其中<em class="lc"> Ti </em>是对象<em class="lc"> i </em>经历该事件的时间。</p><p id="fa55" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">现代深度学习技术，如缩放指数单元、Adam 优化器等。用于 DeepSurv 以获得更好的性能。Cox-nnet 与 DeepSurv 非常相似，但 Cox-nnet 和 DeepSurv 都只输出风险系数。他们没有估计基线函数。我们可以使用 Breslow 估计器等方法来生成基线函数[3]。</p></div><div class="ab cl lg lh hx li" role="separator"><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll"/></div><div class="im in io ip iq"><p id="f645" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我前面说过，从 90 年代中期开始，人们就在尝试使用深度学习方法进行生存分析。鉴于深度学习的最新进展，在生存分析中使用深度学习的结果很有希望。当一个对象的协变量与其危险之间存在复杂关系时，深度学习技术的表现与其他最先进的生存模型一样好，甚至更好[1]。仍有很大的改进和研究空间。对于像我这样相信人工智能可以积极重塑许多重要领域的人来说，这个话题非常有趣。</p><p id="b339" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这是我的第一篇文章，我希望这将是有益的。谢谢:)</p><h2 id="b84a" class="ln lo it bd lp lq lr dn ls lt lu dp lv km lw lx ly kq lz ma mb ku mc md me mf bi translated"><strong class="ak">参考文献</strong></h2><p id="47f7" class="pw-post-body-paragraph kb kc it kd b ke mg kg kh ki mh kk kl km mi ko kp kq mj ks kt ku mk kw kx ky im bi translated">[1]卡兹曼·JL、沙哈姆·U、克洛宁格·A、贝茨·J、江·T 和克鲁格·Y、<a class="ae nf" href="https://bmcmedresmethodol.biomedcentral.com/articles/10.1186/s12874-018-0482-1" rel="noopener ugc nofollow" target="_blank"> DeepSurv </a>:使用 Cox 比例风险深度神经网络的个性化治疗推荐系统(2018)，BMC 医学研究方法学</p><p id="8ac4" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">[2]程婷，朱 X，加米尔 LX，<a class="ae nf" href="https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1006076" rel="noopener ugc nofollow" target="_blank"> Cox-nnet </a>:高通量组学数据预后预测的人工神经网络方法(2018)，计算生物学</p><p id="7199" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">[3] Michael F. Gensheimer 和 Balasubramanian Narasimhan，<a class="ae nf" href="https://arxiv.org/abs/1805.00917" rel="noopener ugc nofollow" target="_blank">神经网络的可扩展离散时间生存模型</a> (2019)，arXiv:1805.00917</p><p id="965a" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">[4]埃莉诺拉·久奇利亚、安东·涅姆琴科和米哈埃拉·范德沙尔，<a class="ae nf" href="http://medianetlab.ee.ucla.edu/papers/RNN_SURV.pdf" rel="noopener ugc nofollow" target="_blank"> RNN-SURV </a>:生存分析的深度循环模型(2018)，LNCS 11139–11141</p><p id="8239" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">[5] Faraggi D，和 Simon R，<a class="ae nf" href="https://onlinelibrary.wiley.com/doi/abs/10.1002/sim.4780140108" rel="noopener ugc nofollow" target="_blank">生存数据的神经网络模型</a> (1995)，医学统计学</p></div></div>    
</body>
</html>