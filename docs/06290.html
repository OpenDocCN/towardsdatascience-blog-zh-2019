<html>
<head>
<title>A Primer to Recommendation Engines</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">推荐引擎入门</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/a-primer-to-recommendation-engines-49bd12ed849f?source=collection_archive---------19-----------------------#2019-09-10">https://towardsdatascience.com/a-primer-to-recommendation-engines-49bd12ed849f?source=collection_archive---------19-----------------------#2019-09-10</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/6a45f8633956eb662650198b129d3c61.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nV7uXCb8XsVJSCOSyJr4Hg.png"/></div></div></figure><div class=""/><div class=""><h2 id="e1cc" class="pw-subtitle-paragraph kb jd je bd b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks dk translated">它们是什么，它们是如何工作的，以及它们为什么伟大。</h2></div><p id="f64b" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">推荐引擎现在无处不在。几乎你使用的任何应用都包含某种推荐系统，要么推送新内容，要么推动销售。推荐引擎是网飞告诉你接下来应该看什么，脸书上的广告推着你碰巧看过一次的产品，甚至是 Slack 建议你应该加入哪个组织渠道。大数据和机器学习的出现使推荐引擎成为数据科学最直接适用的方面之一。</p></div><div class="ab cl lp lq hx lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="im in io ip iq"><p id="2519" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">假设你的朋友向你寻求电影推荐。你如何着手做这件事？如果你不太喜欢电影，而且不是你太了解的朋友，也许你可以谷歌一下，给你的朋友你找到的任何电影的答案。也许你的朋友告诉你他们最喜欢的类型是恐怖片——然后你推荐你知道的最好的恐怖片。或者，也许你的朋友给了你他们喜欢的电影的例子。然后你在脑子里处理这些数字，根据你对这些电影的了解和你对朋友的了解，给他们一些建议。这些场景中的每一个都是不同类型的推荐引擎的例子。</p><h1 id="14d4" class="ma mb je bd mc md me mf mg mh mi mj mk kk ml kl mm kn mn ko mo kq mp kr mq mr bi translated">推荐引擎的类型</h1><h2 id="9f26" class="ms mb je bd mc mt mu dn mg mv mw dp mk lc mx my mm lg mz na mo lk nb nc mq nd bi translated">1.非个性化</h2><p id="52e3" class="pw-post-body-paragraph kt ku je kv b kw ne kf ky kz nf ki lb lc ng le lf lg nh li lj lk ni lm ln lo im bi translated">非个性化推荐引擎是最简单的。你对你的朋友一无所知，对电影也知之甚少。你几乎没有数据，所以你只推荐了<strong class="kv jf">最受欢迎的东西</strong>，因为你的朋友很有可能会喜欢它，因为大多数人已经喜欢它了。</p><p id="e39f" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">非个性化推荐引擎也非常容易实现，因为每个人都获得相同的推荐。你所要做的就是拿出<strong class="kv jf">一些指标来决定推荐什么</strong>，即最高评级、最高投资回报率(ROI)。还可以想想:YouTube 的新用户主页会推荐热门视频。</p><figure class="nk nl nm nn gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nj"><img src="../Images/b5faeca39cc61f2d4cbdef4c460d7f88.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3952UFCc5lCS7Vg3f0sy7A.png"/></div></div><figcaption class="no np gj gh gi nq nr bd b be z dk">What does YouTube recommend to a new user?</figcaption></figure><p id="98dd" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">看似琐碎，但非个性化的推荐可能非常有用。想象一下，你正在开展一项新的电子商务业务，你想在你的登录页面上发布产品推荐。也许这些产品已经在亚马逊上销售了，所以你可以看到这些产品的综合评分。如果你想提高销售额，你可能会决定推销评价最高的产品，因为你知道这些产品的客户满意度更高。你也可以决定推销给你最高投资回报率的产品，这样客户购买的每件产品都会给你带来更多利润。</p><h2 id="fb25" class="ms mb je bd mc mt mu dn mg mv mw dp mk lc mx my mm lg mz na mo lk nb nc mq nd bi translated">2.基于内容</h2><p id="0f2e" class="pw-post-body-paragraph kt ku je kv b kw ne kf ky kz nf ki lb lc ng le lf lg nh li lj lk ni lm ln lo im bi translated">对于基于内容的推荐引擎，我们<strong class="kv jf">只处理项目数据</strong>。更具体地，项目的<strong class="kv jf">特征空间</strong>中的数据。例如，电影的项目数据包括预算、票房收入、类型、发行年份、演员等。</p><p id="237c" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">基于内容的推荐引擎背后的一个主要想法是<strong class="kv jf">相似性</strong>。想想在亚马逊购物——在它的产品页面上，你总会在产品下面列出<em class="ns">类似的</em>商品。这里使用的最简单和最直观的算法是一个<strong class="kv jf">最近邻</strong>算法，它使用一些<strong class="kv jf">相似性度量</strong>(如余弦相似性、欧几里德距离、皮尔逊相关等。)来确定与您的输入项目最接近的项目<strong class="kv jf">作为推荐返回。</strong></p><figure class="nk nl nm nn gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nt"><img src="../Images/6e031d64727c673a2f6d14ff654f1b6a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*nDowUau1gUokr8-y"/></div></div><figcaption class="no np gj gh gi nq nr bd b be z dk">Plant recommendations on the product page of a plant!</figcaption></figure><p id="e979" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">使用项目数据提出建议的一些其他方法:</p><ul class=""><li id="e6e8" class="nu nv je kv b kw kx kz la lc nw lg nx lk ny lo nz oa ob oc bi translated">如果您想要一个用户的推荐，假设您有该用户的历史记录，<em class="ns">即喜欢、不喜欢、评分… </em>您可以创建一个<strong class="kv jf">分类器</strong>来预测评分或某个项目是否会被喜欢/不喜欢。这也可以在聚合评级数据上完成，例如:获取 Yelp 上餐馆的总体评级，并使用餐馆功能，预测餐馆的评级。</li><li id="0a19" class="nu nv je kv b kw od kz oe lc of lg og lk oh lo nz oa ob oc bi translated"><strong class="kv jf">聚类方法</strong>可用于将项目组合在一起。这可以使最近邻方法运行得更快，因为不需要跨所有项目计算距离。</li><li id="8bb8" class="nu nv je kv b kw od kz oe lc of lg og lk oh lo nz oa ob oc bi translated">当你有大量特征空间的数据时，比如图像，神经网络非常有用。我们可以通过(例如)卷积神经网络的倒数第二层来检索项目的嵌入，在这里更容易运行相似性度量来找到最相似的项目。</li></ul><p id="d684" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">基于内容的推荐器(尤其是基于相似性的推荐器)非常适合推荐<strong class="kv jf">利基</strong>商品。也许出于某种原因，你真的很喜欢五分钱乐队臭名昭著的讨厌音乐。使用五分钱乐队的歌曲作为输入，基于内容的推荐器可能会向您推荐与五分钱乐队相似的歌曲，甚至其他五分钱乐队的歌曲，这取决于您的项目池。一个基于内容的推荐者不会考虑五分钱乐队的歌曲经常是低收视率的事实，除非你决定使用收视率作为一个项目特征。</p><p id="fddc" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">这些超级具体的推荐是否是最好的取决于你的推荐者的背景。有时您确实想考虑用户特定的口味，有时又不想。如果你把恐怖电影输入推荐引擎，你只能得到其他恐怖电影的推荐。在不同的背景下，这可能是好事，也可能是坏事。</p><h2 id="79f0" class="ms mb je bd mc mt mu dn mg mv mw dp mk lc mx my mm lg mz na mo lk nb nc mq nd bi translated">3.协同过滤</h2><p id="a78e" class="pw-post-body-paragraph kt ku je kv b kw ne kf ky kz nf ki lb lc ng le lf lg nh li lj lk ni lm ln lo im bi translated">基于内容的推荐器仅使用项目数据，而协同过滤方法使用与项目相关的用户数据。更具体地说，<strong class="kv jf">检查来自特定用户的特定项目的数据</strong>。理想情况下，您的数据应该能够用一个<strong class="kv jf">效用矩阵</strong>来表示，一个轴是用户，一个轴是项目。</p><figure class="nk nl nm nn gt iv gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/9f461bea1708769126dc89d2417519a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:864/format:webp/1*gBSm6E1nmPOmIbBf96eb2A.png"/></div><figcaption class="no np gj gh gi nq nr bd b be z dk">Utility matrix for 4 users (U) and 4 items (I).</figcaption></figure><p id="59cd" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">效用矩阵通常是<strong class="kv jf">稀疏的</strong>，因为用户不会对所有项目进行评级。在上面的简单示例中，我们可以看到所有用户都对所有项目进行了评分，只有用户 1 对项目 3 进行了评分。协作过滤的工作原理是查看多个用户如何评价多个项目，或者多个用户如何评价多个项目，以<strong class="kv jf">尝试并猜测用户还会高度评价哪些项目</strong>。协同过滤的主要思想是<strong class="kv jf">填充效用矩阵的未知数</strong>，有几种方法可以做到这一点。</p><p id="5cfe" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">简而言之，计算空白值的一种方法是使用用户或项目之间的<strong class="kv jf">相似度，并对评分进行加权平均，以预测用户 1 对项目 3 的评分。该方法被称为<strong class="kv jf">用户-用户相似度</strong>或<strong class="kv jf">项目-项目相似度</strong>，这取决于计算相似度所跨越的轴。</strong></p><p id="9eff" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">另一种预测未知用户项目组合评分的方法是通过流行的<strong class="kv jf">奇异值分解</strong> (SVD)模型，这种方法因 2006 年 Netflix 奖竞赛期间的<a class="ae oj" href="http://thrillist.com/entertainment/nation/the-netflix-prize" rel="noopener ugc nofollow" target="_blank"> Simon Funk 而闻名。该算法使用传统 SVD 的修改版本，通过生成表示用户和项目的两个分量矩阵，作为效用矩阵的分解，并通过交替最小二乘法执行梯度下降以得出评级预测。查看我的另一篇探讨协同过滤背后的数学的文章。</a></p><p id="0131" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">协同过滤不仅为每个用户提供个性化的推荐，还为数据集中的任何项目提供模型计算的预测评级，这可以方便地为用户提供关于项目的更多个性化见解。</p><p id="1c81" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">尽管协同过滤(尤其是 SVD)已经被证明具有一些最有效和最准确的评级预测，但也有一些缺点。首先，有一个所谓的<strong class="kv jf">冷启动问题</strong>，你需要有大量的现有数据(关于他们如何评价多个项目的用户数据)才能开始计算评级。一个全新的用户将无法与任何人进行比较(因为没有关于新用户的数据)，因此无法做出有见地的推荐。在进行任何类型的用户-用户或项目-项目比较之前，用户必须首先在系统中有一些评级。</p><p id="2147" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">协同过滤的另一个缺点是它的计算量太大(T4)。用户-用户和项目-项目模型的时间复杂度随着用户数量和数据集中项目数量的增加而增加。最后，往往会有一个<strong class="kv jf">受欢迎程度偏差</strong>,在这种情况下，经常被评为高等级的项目可能会对大多数用户有高的预测等级。</p><h1 id="a9d4" class="ma mb je bd mc md me mf mg mh mi mj mk kk ml kl mm kn mn ko mo kq mp kr mq mr bi translated">评估推荐引擎</h1><p id="c96d" class="pw-post-body-paragraph kt ku je kv b kw ne kf ky kz nf ki lb lc ng le lf lg nh li lj lk ni lm ln lo im bi translated">在机器学习中，为了评估我们的模型，我们通常有一个成本函数来确定我们的模型表现如何。成本函数通常测量某种形式的误差，并给我们一种模型能够预测某种结果的感觉。对于推荐引擎，这仅在某些情况下有效。在协同过滤的情况下，可以进行典型的<code class="fe lw lx ly lz b">train-test-split</code>来测试预测评级值与实际评级值有多远。</p><p id="0b11" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">然而，对于基于内容的推荐引擎来说，这就不那么简单了。尤其是基于相似性的推荐，有一个潜在的假设，人们会喜欢与他们已经喜欢的东西相似的项目。并且这种相似性必须存在于数据中可用的特征/特性中。项目的复杂性和人们可以根据其喜欢程度的无限方面，使得很难评估基于内容的推荐系统实际工作得如何。有一个强力的解决方案——简单地向人们提供建议，然后看看这些建议效果如何。</p><h2 id="5216" class="ms mb je bd mc mt mu dn mg mv mw dp mk lc mx my mm lg mz na mo lk nb nc mq nd bi translated">接下来:</h2><div class="is it gp gr iu ok"><a href="https://medium.com/@yishuen/math-for-data-science-collaborative-filtering-on-utility-matrices-e62fa9badaab" rel="noopener follow" target="_blank"><div class="ol ab fo"><div class="om ab on cl cj oo"><h2 class="bd jf gy z fp op fr fs oq fu fw jd bi translated">数据科学的数学:效用矩阵上的协同过滤</h2><div class="or l"><h3 class="bd b gy z fp op fr fs oq fu fw dk translated">理解推荐引擎协同过滤模型背后的数学原理</h3></div><div class="os l"><p class="bd b dl z fp op fr fs oq fu fw dk translated">medium.com</p></div></div><div class="ot l"><div class="ou l ov ow ox ot oy ja ok"/></div></div></a></div><ul class=""><li id="b890" class="nu nv je kv b kw kx kz la lc nw lg nx lk ny lo nz oa ob oc bi translated">用 Python 实现推荐系统(即将推出)</li></ul><p id="2057" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated"><em class="ns">免责声明:我其实是五分钱乐队的粉丝。</em></p></div></div>    
</body>
</html>