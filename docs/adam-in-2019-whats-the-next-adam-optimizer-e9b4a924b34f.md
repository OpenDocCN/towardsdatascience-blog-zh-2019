# 2019 å¹´çš„ ADAMâ€”ä¸‹ä¸€ä¸ª ADAM ä¼˜åŒ–å™¨æ˜¯ä»€ä¹ˆ

> åŸæ–‡ï¼š<https://towardsdatascience.com/adam-in-2019-whats-the-next-adam-optimizer-e9b4a924b34f?source=collection_archive---------6----------------------->

> å¦‚æœ ADAM é€Ÿåº¦å¿«ï¼ŒSGD +åŠ¨é‡æ”¶æ•›æ›´å¥½ï¼Œä¸ºä»€ä¹ˆä¸èƒ½ä» ADAM å¼€å§‹ï¼Œåæ¥æ”¹ç”¨ SGDï¼Ÿ

![](img/f9ebed1641caefd2c05a6658b9091c2a.png)

Visualization of loss landscape from [https://www.cs.umd.edu/~tomg/projects/landscapes/](https://www.cs.umd.edu/~tomg/projects/landscapes/)

1.  [ç®€ä»‹](#a7c5)
2.  [äºšå½“åŠå…¶å®¶åº­å¿«é€Ÿå›é¡¾](#1ac5)
3.  [æ‹‰è¾¾å§†](#270c)
4.  [å‰ç»ä¼˜åŒ–å™¨](#fb03)
5.  [ç¾Šè‚‰](#3cb5)
6.  [å­¦ä¹ ç‡å’Œæ‰¹é‡çš„åŠ¨æ€](#db98)
7.  [æœ€ä½³çš„å­¦ä¹ è¿›åº¦æ˜¯ä»€ä¹ˆï¼Ÿ](#848d)

# ä»‹ç»

æ·±åº¦å­¦ä¹ å·²ç»å–å¾—äº†å¾ˆå¤šè¿›å±•ï¼Œæ¯éš”å‡ å‘¨å°±ä¼šæœ‰æ–°çš„æ¨¡å‹é—®ä¸–ï¼Œç„¶è€Œæˆ‘ä»¬åœ¨ 2019 å¹´ä»ç„¶åœç•™åœ¨äºšå½“èº«ä¸Šã€‚ä½ çŸ¥é“äºšå½“è®ºæ–‡æ˜¯ä»€ä¹ˆæ—¶å€™å‡ºç‰ˆçš„å—ï¼Ÿç°åœ¨æ˜¯ 2014 å¹´ï¼Œç›¸æ¯”ä¹‹ä¸‹ï¼ŒBatchNorm è®ºæ–‡æ˜¯ 2015 å¹´å‘è¡¨çš„ï¼ğŸˆ

![](img/d2c43090d3a6d7966a179911c39a9d73.png)

the original Adam paper

![](img/54a3021ee3fa383ffd892da6fc5da3b5.png)

Batch Norm paper was published in 2015

å¯¹äºæ·±åº¦å­¦ä¹ ç¤¾åŒºæ¥è¯´ï¼Œ5 å¹´å°±åƒæ˜¯ä¸€ä¸ªä¸–çºªï¼Œæˆ‘å¯¹æœ€è¿‘ optimizer çš„å‘å±•å¾ˆå¥½å¥‡ï¼Œæ‰€ä»¥æˆ‘å››å¤„æœç´¢å¹¶è¯•å›¾æ€»ç»“æˆ‘çš„å‘ç°ã€‚Sebastian å¯¹ä¼˜åŒ–ç®—æ³•æœ‰ä¸€ä¸ªå¾ˆå¥½çš„æ¦‚è¿°ï¼Œä½†æ˜¯å®ƒä¸æ˜¯æœ€æ–°çš„ï¼Œå¹¶ä¸”é”™è¿‡äº†æœ€è¿‘å‡ºç°çš„ä¸€äº›è¿›å±•ã€‚

# è§è§äºšå½“çš„å®¶äºº

ä½ å¯ä»¥ä» PyTorch [*æ–‡æ¡£*](https://pytorch.org/docs/stable/optim.html) *ä¸­è½»æ¾æ‰¾åˆ°å¾ˆå¤šä¼˜åŒ–å™¨ã€‚é˜¿è¾¾å¾·å°”å¡”ï¼Œé˜¿è¾¾æ ¼æ‹‰å¾·ï¼Œé˜¿è¾¾å§†ï¼Œé˜¿è¾¾é©¬å…‹æ–¯ï¼Œè¿™æ ·çš„ä¾‹å­ä¸èƒœæšä¸¾ã€‚çœ‹æ¥æˆ‘ä»¬çœŸçš„æ— æ³•æ‘†è„±äºšå½“ã€‚o è®©æˆ‘ä»¬å¿«é€Ÿå›é¡¾ä¸€ä¸‹äºšå½“ã€‚å¦‚æœä½ å·²ç»ç†Ÿæ‚‰äº†ï¼Œå¯ä»¥è·³è¿‡è¿™ä¸€éƒ¨åˆ†ã€‚*

![](img/af2a5ed426a01b71b04bc7cf1dc713b0.png)

Adam = Momentum + RMSProp

å¤§åæ˜¯åŠ¨é‡å’Œ RMSProp çš„ç»“åˆã€‚åŠ¨é‡(v)ä¸ºä¼˜åŒ–å™¨æä¾›çŸ­æœŸè®°å¿†ï¼Œè€Œä¸æ˜¯å®Œå…¨ä¿¡ä»»å½“å‰æ¢¯åº¦ï¼Œå®ƒå°†ä½¿ç”¨å…ˆå‰æ¢¯åº¦å’Œå½“å‰æ¢¯åº¦ï¼Œå¹¶ä»¥æ¯”ç‡Î²1 å°†å®ƒä»¬ç›¸åŠ ã€‚è™½ç„¶ RMSProp å°†æ¢¯åº¦çš„ 1/å¹³æ–¹æ ¹è€ƒè™‘åœ¨å†…ï¼Œä½†ç›´è§‰ä¸Šï¼Œè¿™æ„å‘³ç€å¦‚æœæ–¹å·®å¾ˆå°(æœ‰æŠŠæ¡)ï¼Œä¼˜åŒ–å™¨å°†é‡‡å–æ›´å¤§çš„æ­¥éª¤ï¼Œåä¹‹äº¦ç„¶ã€‚

![](img/4dd906b701dfcc9b5aeb411ac74a8749.png)

Adam updates rules

Adam å¾ˆæ£’ï¼Œå®ƒæ¯” SGD å¿«å¾—å¤šï¼Œé»˜è®¤çš„è¶…å‚æ•°é€šå¸¸å·¥ä½œè‰¯å¥½ï¼Œä½†å®ƒä¹Ÿæœ‰è‡ªå·±çš„ç¼ºé™·ã€‚è®¸å¤šäººæŒ‡è´£äºšå½“æœ‰æ”¶æ•›é—®é¢˜ï¼Œå¾€å¾€ SGD +åŠ¨é‡å¯ä»¥ç”¨æ›´é•¿çš„è®­ç»ƒæ—¶é—´æ”¶æ•›å¾—æ›´å¥½ã€‚æˆ‘ä»¬ç»å¸¸çœ‹åˆ°å¾ˆå¤š 2018 å¹´å’Œ 2019 å¹´çš„è®ºæ–‡è¿˜åœ¨ç”¨ SGDã€‚

![](img/a00e48bca8783ad83597670eece1c8f6.png)

# æœ€è¿‘çš„è¿›å±•

é‚£ä¹ˆï¼Œå…³äºè®­ç»ƒç¥ç»ç½‘ç»œï¼Œæˆ‘ä»¬å­¦åˆ°äº†ä»€ä¹ˆï¼Ÿæˆ‘ä¼šå°½é‡ä¿æŒç®€çŸ­ï¼Œå¹¶è¡¥å……æ–‡ç« çš„ç»†èŠ‚ã€‚

## åœ£ç»ã€‹å’Œã€Šå¤å…°ç»ã€‹ä¼ ç»Ÿä¸­ï¼‰äºšå½“ï¼ˆäººç±»ç¬¬ä¸€äººçš„åå­—

![](img/2348db0896465f71630975071dc0cb5c.png)

RAdam update

[*å…³äºè‡ªé€‚åº”å­¦ä¹ ç‡çš„æ–¹å·®å’Œè¶…è¶Š*](https://arxiv.org/abs/1908.03265) å¼•å…¥å®£å™è°ƒâ€”â€”äºšå½“ã€‚æœ¬æ–‡è®¤ä¸ºï¼ŒAdam çš„åˆå§‹è®­ç»ƒæ˜¯ä¸ç¨³å®šçš„ï¼Œè¿™æ˜¯ç”±äºåªæœ‰å¾ˆå°‘çš„æ•°æ®ç‚¹ç”¨äºè®¡ç®—äºŒé˜¶çŸ©(s_t)é¡¹çš„æŒ‡æ•°ç§»åŠ¨å¹³å‡ã€‚RAdam é€šè¿‡ä»…åœ¨å¯¹æ¢¯åº¦çš„æ–¹å·®æœ‰æŠŠæ¡æ—¶æ ¡æ­£è‡ªé€‚åº”å­¦ä¹ ç‡æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚å¦åˆ™ï¼Œå®ƒä¼šå…³é—­è‡ªé€‚åº”å­¦ä¹ ç‡ï¼Œå¹¶ä½¿å…¶å›è½ä¸º SGD +åŠ¨é‡ã€‚çƒ­èº«å­¦ä¹ ç‡å…·æœ‰ç±»ä¼¼çš„æ•ˆæœï¼Œå› ä¸ºå­¦ä¹ ç‡ä»è¾ƒä½å€¼(é«˜æ–¹å·®ï¼Œæ•°æ®ç‚¹å°‘)å¼€å§‹ï¼Œæ…¢æ…¢å¢åŠ åˆ°è¾ƒå¤§çš„å­¦ä¹ ç‡(ç¨³å®šæ–¹å·®ï¼Œæ•°æ®ç‚¹å¤š)ã€‚ä½¿ç”¨ RAdam çš„ä¸€ä¸ªå¥½å¤„æ˜¯ï¼Œå®ƒåœ¨å­¦ä¹ é€Ÿåº¦çš„é€‰æ‹©ä¸Šæ›´åŠ ç¨³å¥ï¼Œè€Œä¸”ä½ ä¸å¿…å†³å®šçƒ­èº«æœŸçš„é•¿åº¦ã€‚

![](img/30d03eafe23e6db1081ffde6e1262010.png)

Warm-up learning rate

å¦‚æœä½ æƒ³äº†è§£æ›´å¤šå…³äº RAdam çš„çŸ¥è¯†ï¼Œå¯ä»¥å‚è€ƒè¿™ç¯‡[å¥½çœ‹çš„æ–‡ç« ](https://medium.com/@lessw/new-state-of-the-art-ai-optimizer-rectified-adam-radam-5d854730807b)ã€‚

**å‰ç»ä¼˜åŒ–å™¨**

![](img/7407a74793eda7d699dc0728900def53.png)

Jimmy Ba was one of the authors of the Adam Optimizer, and we all know about Geoffrey Hinton already. :)

å‰ç»ä¼˜åŒ–å™¨ç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼Œæ…¢é€Ÿæƒé‡å’Œå¿«é€Ÿæƒé‡ã€‚å¿«é€Ÿæƒé‡æ˜¯å……æ»¡æ´»åŠ›çš„ï¼Œæ¯æ¬¡æ›´æ–°éœ€è¦å‡ ä¸ªæ­¥éª¤ï¼Œæ…¢é€Ÿæƒé‡æ˜¯è°¨æ…çš„ï¼Œå®ƒä¸æ˜¯è·Ÿéšå¿«é€Ÿæƒé‡ï¼Œè€Œæ˜¯åŸºäºæŒ‡æ•°å¹³æ»‘å¯¹å‚æ•°è¿›è¡Œæ’å€¼å¹¶é‡‡å–ä¸€äº›ä¸­é—´æ­¥éª¤ã€‚å‰ç»ä¼˜åŒ–å™¨æœ¬èº«å¹¶ä¸å·¥ä½œã€‚å¦‚æœä½ çœ‹ä¸€ä¸‹ç®—æ³•ï¼Œå†…å¾ªç¯åªæ˜¯æ™®é€šçš„å°æ‰¹é‡æ›´æ–°ï¼Œæ‰€ä»¥å®ƒéœ€è¦åƒ SGD æˆ– Adam è¿™æ ·çš„ä¼˜åŒ–å™¨ã€‚

è“çº¿æ˜¯å¿«é€Ÿæƒé‡çš„è½¨è¿¹ï¼Œæœ‰å¤šä¸ªæ•°æ®ç‚¹ï¼Œå› ä¸ºå¯¹äºå¿«é€Ÿæƒé‡(è“è‰²)çš„æ¯ k æ¬¡æ›´æ–°ï¼Œæˆ‘ä»¬å°†ä»…å¯¹æ…¢é€Ÿæƒé‡(ç´«è‰²)è¿›è¡Œ 1 æ¬¡æ›´æ–°ï¼Œç„¶åæˆ‘ä»¬å°†é‡ç½®å¿«é€Ÿæƒé‡ã€‚åŸºæœ¬ä¸Šï¼Œå¿«é€Ÿçš„é‡é‡æ˜¯å“¨å…µï¼Œå®ƒéœ€è¦å¤šèµ°å‡ æ­¥ï¼Œä»¥ç¡®ä¿å‘¨å›´æ˜¯å®‰å…¨çš„ï¼Œç„¶åæ…¢é€Ÿçš„é‡é‡é‡‡å–ä¸€äº›ä¸­é—´æ­¥éª¤ã€‚å¯¹äºä¸‹é¢çš„ä¾‹å­ï¼Œæ‚¨å¯ä»¥çœ‹åˆ°ï¼Œåªéœ€ä¸€æ¬¡æ›´æ–°ï¼Œæ…¢é€Ÿæƒé‡å°±æ›´æ¥è¿‘é»„è‰²åŒºåŸŸ(é«˜ç²¾åº¦)ã€‚

![](img/128cf496df8aa4b26096e0b0887bb427.png)

## æ‹‰å°”æ–¯/å…°å§†

![](img/4ec45d9c02aeaada6a3799edadc39b2e.png)

The highlighted part is the trust ratio calculation, the Ï† is a scaling function which the paper similar use identity function Ï†(z) = z

LARS åŠå…¶ç»§ä»»è€… **L** é€å±‚ **A** è‡ªé€‚åº” **M** ç½‘è†œä¼˜åŒ–å™¨ä¸º **B** atch training (LAMB)ä¼˜åŒ–å™¨å‘å‰è¿ˆè¿›äº†ä¸€æ­¥ã€‚LAMB (1)åƒ Adam ä¸€æ ·ä¿æŒæ¢¯åº¦çš„å¹³æ–¹æ ¹ä½œä¸ºè‡ªé€‚åº”å­¦ä¹ ç‡çš„ä¸€éƒ¨åˆ†ï¼Œä½†æ˜¯(2)å®ƒæœ‰ä¸€ä¸ªé¢å¤–çš„ç»„ä»¶ï¼Œç§°ä¸ºâ€œä¿¡ä»»æ¯”â€ã€‚è¿™ç¯‡[æ–‡ç« ](/an-intuitive-understanding-of-the-lamb-optimizer-46f8c0ae4866)æ›´è¯¦ç»†åœ°è§£é‡Šäº† LAMBï¼Œå¦‚æœä½ æ„Ÿå…´è¶£çš„è¯ã€‚å…¶è¦ç‚¹æ˜¯ï¼Œå®ƒä¸ä»…å°†æ¢¯åº¦çš„æ–¹å·®ä½œä¸ºç¼©æ”¾å› å­ï¼Œè€Œä¸”è¿˜å°†å±‚æƒé‡å’Œå±‚æ¢¯åº¦çš„èŒƒæ•°ä¹‹æ¯”ä½œä¸º**ã€‚**å¾ˆæœ‰é“ç†ï¼Œæ¯”è¾ƒå¤§çš„æƒé‡å’Œå°çš„æƒé‡ï¼Œä½ éœ€è¦æ ¹æ®å®ƒä»¬çš„æ¯”ä¾‹æ¥ç¼©æ”¾å­¦ä¹ ç‡æ‰èƒ½æœ‰ç±»ä¼¼çš„æ•ˆæœã€‚é€šè¿‡ç”¨ä¿¡ä»»æ¯”ç‡ç¼©æ”¾ï¼Œå®ƒç¡®ä¿æ¯å±‚çš„æ›´æ–°æ˜¯å•ä½ l2 èŒƒæ•°ï¼Œè¿™é€šè¿‡å‡è½»æ¢¯åº¦æ¶ˆå¤±é—®é¢˜æ¥å¸®åŠ©è®­ç»ƒæ·±åº¦ç½‘ç»œã€‚

# è®¨è®º

> å¦‚æœ ADAM é€Ÿåº¦å¿«ï¼ŒSGD +åŠ¨é‡æ”¶æ•›æ›´å¥½ï¼Œä¸ºä»€ä¹ˆä¸èƒ½ä» ADAM å¼€å§‹ï¼Œåæ¥æ”¹ç”¨ SGDï¼Ÿ

æˆ‘å¯¹æ­¤æ²¡æœ‰å¾ˆå¥½çš„ç­”æ¡ˆï¼Œæˆ‘æœ‰æ—¶åœ¨ Kaggle ä¸Šçœ‹åˆ°äººä»¬è¿™æ ·åšï¼Œè¿™ç¯‡æ–‡ç« æš—ç¤ºè¿™æ˜¯å¯è¡Œçš„ã€‚ä¸ºäº†è®­ç»ƒ**æ›´å¿«ã€æ›´å‡†ç¡®çš„**ç¥ç»ç½‘ç»œï¼Œæœ‰å¾ˆå¤šæ”¹è¿›å½“å‰ä¼˜åŒ–å™¨çš„å°è¯•ã€‚åœ¨æ·±åº¦å­¦ä¹ ä¸­ï¼Œè§£é‡Šå¾€å¾€å‡ºç°åœ¨ç»éªŒç»“æœä¹‹åã€‚é‚£ä¹ˆæˆ‘ä»¬åˆ°åº•å¯¹ä¼˜åŒ–å™¨æˆ–ç¥ç»ç½‘ç»œçš„ä¼˜åŒ–äº†è§£å¤šå°‘å‘¢ï¼Ÿ

ã€Šä¸ SGD ä¸€èµ·æ•£æ­¥ã€‹è¿™ç¯‡æ–‡ç« æœ‰ä¸€äº›æœ‰è¶£çš„è§£é‡Šï¼Œæˆ‘é¼“åŠ±ä½ å»è¯»ä¸€è¯»ã€‚æˆ‘è®¤ä¸ºè¿™è§£é‡Šäº†æœ€è¿‘å‘å±•çš„ä¸€äº›è”ç³»ã€‚

> ä¸ºä»€ä¹ˆçº¿æ€§æ¯”ä¾‹å­¦ä¹ ç‡å’Œæ‰¹é‡ä¸èƒ½è¾¾åˆ°ç‰¹å®šçš„æ‰¹é‡ï¼Ÿ

ä¸ SGD ä¸€èµ·æ•£æ­¥çš„è®ºæ–‡æ¯”è¾ƒäº†æ¢¯åº¦ä¸‹é™å’Œéšæœºæ¢¯åº¦ä¸‹é™(SGD ),å¹¶æå‡ºå­¦ä¹ é€Ÿç‡å’Œæ‰¹é‡å¤§å°åœ¨ SGD åŠ¨åŠ›å­¦ä¸­æ‰®æ¼”ä¸¤ä¸ªéå¸¸ä¸åŒçš„è§’è‰²

## å­¦ä¹ ç‡

![](img/2d0649c3e2339b57b296fe63b39ec032.png)

é€šè¿‡è§‚å¯Ÿæ¯æ¬¡æ›´æ–°å‰åæ’å€¼å‚æ•°çš„æŸå¤±ï¼Œå‘ç° SGD è°·å¤§è‡´æ˜¯å‡¸çš„ï¼Œè¿™å¤§è‡´ç¬¦åˆæˆ‘ä»¬çš„ç†è§£ã€‚ç„¶è€Œï¼Œè¯¥è®ºæ–‡ä¹ŸæŒ‡å‡º SGD è°·çš„åº•éƒ¨æ˜¯é«˜åº¦éçº¿æ€§çš„ï¼Œå¹¶ä¸”å……æ»¡äº†éšœç¢ã€‚å­¦ä¹ ç‡æ§åˆ¶ SGD çš„é«˜åº¦ï¼Œæ‰€ä»¥ä½¿ç”¨å¤§çš„å­¦ä¹ ç‡**ç®€å•åœ°è¶Šè¿‡éšœç¢ï¼Œè€Œä¸æ˜¯è·¨è¶Šå®ƒã€‚**è¿™ä¸æˆ‘ä»¬çš„ç†è§£ä¸åŒï¼Œæˆ‘ä»¬é€šå¸¸è®¤ä¸ºè¾ƒå¤§çš„å­¦ä¹ ç‡ä¼šå¯¼è‡´ SGD æ›´éš¾åå¼¹ï¼Œå¹¶æœ‰åŠ©äºé¿å…å±€éƒ¨æœ€å°å€¼ã€‚ä¸‹å›¾æ˜¾ç¤ºäº†å‡è®¾çš„æ‹“æ‰‘ç»“æ„ã€‚è¿™å¯èƒ½æ˜¯åç›´è§‰çš„ï¼Œå¦‚æœå­¦ä¹ ç‡ä¿æŒåœ¨åœ°æ¿ä»¥ä¸Šçš„é«˜åº¦ï¼Œå®ƒå¦‚ä½•å°†æŸå¤±æœ€å°åŒ–ï¼Ÿäº‹å®è¯æ˜ï¼Œæˆ‘ä»¬è¿‡äºç®€åŒ–çš„é”™è§‰ï¼Œå³ SGD åªæ˜¯ä»ä¸€åº§é™æ­¢çš„å°å±±ä¸Šèµ°ä¸‹æ¥ï¼Œæ˜¯é”™è¯¯çš„ã€‚äº‹å®ä¸Šï¼Œâ€œå±±â€æœ¬èº«ä¹Ÿåœ¨ä¸æ–­å˜åŒ–ï¼Œå› ä¸ºå®ƒåªæ˜¯æˆ‘ä»¬ä»é«˜ç»´ç©ºé—´åˆ°ä¸‰ç»´ç©ºé—´çš„æŠ•å½±ã€‚çœ‹çœ‹è¿™ä¸ªç”± https://losslandscape.com/gallery/[åˆ›é€ çš„ç¾ä¸½è€Œå¥‡å¼‚çš„å¤±è½æ™¯è§‚è§†é¢‘å§ï¼](https://losslandscape.com/gallery/)

## æ‰¹é‡

è€Œæ‰¹é‡å¤§å°æ§åˆ¶éšæœºæ€§ï¼Œè¿™æœ‰åŠ©äºæ¢ç´¢ã€‚æœ¬æ–‡é€šè¿‡è§‚å¯Ÿ SGD å¯¼è‡´æ¯”æ¢¯åº¦ä¸‹é™(GD)å¤§å¾—å¤šçš„å‚æ•°è·ç¦»æ¥æ”¯æŒè¿™ä¸€è®ºç‚¹ã€‚

![](img/40be16a7d6d568a396402c2237fdbf2b.png)

The upper graph represents the angle between each update, -1 means it is the opposite direction. The lower graph measures the ||parameter distance||Â² from initialization, a larger value means it is further from the initialization points.

ä»è¿™ä¸ªå›¾ä¸­å¯ä»¥å­¦åˆ°ä¸€äº›ä¸œè¥¿ã€‚(1)æ¯æ¬¡æ›´æ–°ä¹‹é—´çš„è§’åº¦å…·æœ‰éå¸¸ä¸åŒçš„æ¢¯åº¦ä¸‹é™å’Œ SGD *ç‰¹å¾ã€‚*(2)SGD åœ¨ 40 æ¬¡è¿­ä»£åå‚æ•°è·ç¦»å¤§å¾ˆå¤šã€‚è¿™ä¸ªè§’åº¦å‘Šè¯‰æˆ‘ä»¬ä¸€äº›æœ‰è¶£çš„æ•…äº‹ã€‚é¦–å…ˆï¼Œå¯¹äºæ¢¯åº¦ä¸‹é™ï¼Œå®ƒå¾ˆå¿«ç¨³å®šåœ¨-1ï¼Œè¿™æ„å‘³ç€ SGD å¾ˆå¯èƒ½åœ¨ç±»ä¼¼å±±è°·çš„åœ°å½¢ä¸­æŒ¯è¡ã€‚è€Œå¯¹äº SGDï¼Œè¯¥å€¼è¾ƒå¤§ï¼Œå¹¶ä¸Šä¸‹æ³¢åŠ¨ï¼Œè¡¨æ˜å®ƒæ²¿ç€è°·å£æŒ¯è¡ï¼Œä½†å…·æœ‰æ›´å¤šå‹˜æ¢ï¼Œè€Œä¸æ˜¯åœç•™åœ¨å±€éƒ¨è°·ä¸­ã€‚è¾ƒå¤§çš„å‚æ•°è·ç¦»ä¹Ÿæ”¯æŒäº† SGD æœ‰åŠ©äºå‹˜æ¢è¿™ä¸€è®ºç‚¹ã€‚

äº‹å®ä¸Šï¼Œæˆ‘è®¤ä¸ºè¿™ç§è§è§£å¯èƒ½ä¸è¿™æ ·ä¸€ä¸ªäº‹å®æœ‰å…³ï¼Œå³ä¸ºä»€ä¹ˆåœ¨æ‰¹é‡è¾¾åˆ°æŸä¸ªé˜ˆå€¼ä¹‹å‰ï¼Œçº¿æ€§æå‡å­¦ä¹ ç‡/æ‰¹é‡æ¯”ä¾‹ä¸èµ·ä½œç”¨ã€‚å¦‚æœæ‰¹é‡å¤§å°å…·æœ‰æ ¹æœ¬ä¸åŒçš„åŠ¨æ€ï¼Œè¿™æ˜¯æœ‰æ„ä¹‰çš„ã€‚LAMB ä¼˜åŒ–å™¨æˆåŠŸåœ°ç”¨éå¸¸å¤§çš„æ‰¹é‡(65536/131072)è®­ç»ƒäº† BERTã€‚ç ”ç©¶ LAMB å¦‚ä½•æ”¹å˜æ‰¹é‡å¤§å°çš„åŠ¨æ€å˜åŒ–ï¼Œå¹¶é€šè¿‡é€å±‚ç¼©æ”¾å­¦ä¹ é€Ÿç‡æ¥å¸®åŠ©ä¼˜åŒ–ï¼Œè¿™å¯èƒ½æ˜¯å¾ˆæœ‰è¶£çš„ã€‚

> æœ€å¥½çš„å­¦ä¹ ç‡æ—¶é—´è¡¨æ˜¯æ€æ ·çš„ï¼Ÿ

æ ¹æ® RAdam è®ºæ–‡ï¼Œæˆ‘ä»¬äº†è§£åˆ°çƒ­èº«è®¡åˆ’æœ‰åŠ©äºå‡å°‘æ¢¯åº¦çš„å˜åŒ–ã€‚è¿™æ˜¯å¦æ„å‘³ç€æˆ‘ä»¬ä¸å†éœ€è¦çƒ­èº«äº†ï¼Ÿå¯èƒ½ä¸ä¼šï¼Œå› ä¸ºæˆ‘ä»¬çŸ¥é“é«˜å­¦ä¹ ç‡ä¹Ÿæœ‰åŠ©äºä¼˜åŒ–ã€‚SGD æ–‡ä»¶è¿˜æå‡ºäº†ä¸€ä¸ªæ¢¯å½¢è¿›åº¦è¡¨ï¼Œæˆ‘ä»¬å¯ä»¥å°†è¿›åº¦è¡¨åˆ†ä¸º 3 ä¸ªé˜¶æ®µã€‚fast.ai ä¹Ÿä½¿ç”¨äº†ç±»ä¼¼çš„ç­–ç•¥ï¼Œä»–ä»¬ç§°ä¹‹ä¸ºå•å‘¨æœŸè®­ç»ƒçš„ä¿®æ”¹ç‰ˆ

(1)çƒ­èº«é˜¶æ®µï¼Œä»ä½å­¦ä¹ ç‡å¼€å§‹ï¼Œçº¿æ€§å¢åŠ åˆ°æœ€å¤§
(2)å…¬è·¯è®­ç»ƒé˜¶æ®µï¼Œåœç•™åœ¨æœ€å¤§å­¦ä¹ ç‡
(3)æ”¶æ•›é˜¶æ®µï¼Œå­¦ä¹ ç‡çº¿æ€§è¡°å‡åˆ°æœ€å°å€¼

![](img/8ebe417e76195004675f797c8aa464b9.png)

## è¯·ç»™æˆ‘ç•™ä¸‹è¯„è®ºï¼Œå¦‚æœä½ è®¤ä¸ºæœ‰ç”¨ï¼Œåˆ«å¿˜äº†**ç«–èµ·å¤§æ‹‡æŒ‡**ã€‚ğŸ‘ğŸ‘ğŸ‘ğŸ‘ğŸ‘

å…³é”®è¯:äºšå½“ï¼ŒSGDï¼ŒRAdamï¼Œå‰ç»ï¼Œç¾”ç¾Š

# å‚è€ƒ

ã€P1ã€‘[ã€](https://arxiv.org/search/cs?searchtype=author&query=Liu%2C+L)ã€[ã€](https://arxiv.org/search/cs?searchtype=author&query=Jiang%2C+H)ã€[å½­åŸä½•](https://arxiv.org/search/cs?searchtype=author&query=He%2C+P)ã€[é™ˆ](https://arxiv.org/search/cs?searchtype=author&query=Chen%2C+W)ã€[ã€](https://arxiv.org/search/cs?searchtype=author&query=Liu%2C+X)ã€[é«˜å‰‘é”‹](https://arxiv.org/search/cs?searchtype=author&query=Gao%2C+J)ã€[éŸ©å®¶ä¼Ÿ](https://arxiv.org/search/cs?searchtype=author&query=Han%2C+J)å¯¹è‡ªé€‚åº”å­¦ä¹ ç‡çš„æ–¹å·®åŠå…¶è¶…è¶Š

[p2] [è¿ˆå…‹å°”Â·rÂ·å¼ ](https://arxiv.org/search/cs?searchtype=author&query=Zhang%2C+M+R)ï¼Œ[è©¹å§†æ–¯Â·å¢å¡æ–¯](https://arxiv.org/search/cs?searchtype=author&query=Lucas%2C+J)ï¼Œ[æ°å¼—é‡ŒÂ·è¾›é¡¿](https://arxiv.org/search/cs?searchtype=author&query=Hinton%2C+G)ï¼Œ[å‰ç±³Â·å·´](https://arxiv.org/search/cs?searchtype=author&query=Ba%2C+J)å‰ç»ä¼˜åŒ–å™¨:å‘å‰ k æ­¥ï¼Œå‘å 1 æ­¥

ã€P3ã€‘[é™ˆæ˜Ÿ](https://arxiv.org/search/stat?searchtype=author&query=Xing%2C+C)ï¼Œ[å¾·ä¸‡ä»€Â·é˜¿çš®ç‰¹](https://arxiv.org/search/stat?searchtype=author&query=Arpit%2C+D)ï¼Œ[å…‹é‡Œæ–¯ç‰¹æ–¯Â·é½é‡Œæˆˆè’‚æ–¯](https://arxiv.org/search/stat?searchtype=author&query=Tsirigotis%2C+C)ï¼Œ[çº¦èˆ’é˜¿Â·æœ¬å‰å¥¥](https://arxiv.org/search/stat?searchtype=author&query=Bengio%2C+Y)ä¸ SGD ä¸€èµ·æ•£æ­¥

Leslie N. Smith ï¼Œ [Nicholay Topin](https://arxiv.org/search/cs?searchtype=author&query=Topin%2C+N) è¶…æ”¶æ•›:ä½¿ç”¨å¤§å­¦ä¹ ç‡éå¸¸å¿«é€Ÿåœ°è®­ç»ƒç¥ç»ç½‘ç»œ

ã€P4ã€‘[ã€å°¤æ¨ã€‘](https://arxiv.org/search/cs?searchtype=author&query=You%2C+Y)[ã€æäº¬ã€‘](https://arxiv.org/search/cs?searchtype=author&query=Li%2C+J)[è¨å°šå…‹Â·é›·è¿ª](https://arxiv.org/search/cs?searchtype=author&query=Reddi%2C+S)[ä¹”çº³æ£®Â·è°¢](https://arxiv.org/search/cs?searchtype=author&query=Hseu%2C+J)[æ¡‘åŸºå¤«Â·åº“é©¬å°”](https://arxiv.org/search/cs?searchtype=author&query=Kumar%2C+S)[æ–¯åˆ©é‚£è¾¾Â·åšè´¾çº³å¸•åˆ©](https://arxiv.org/search/cs?searchtype=author&query=Bhojanapalli%2C+S)[è‚–ä¸¹Â·å®‹](https://arxiv.org/search/cs?searchtype=author&query=Song%2C+X)[è©¹å§†æ–¯Â·å¾·æ¢…å°”](https://arxiv.org/search/cs?searchtype=author&query=Demmel%2C+J)[åº“å°”ç‰¹Â·åº“ç‰¹ç­–](https://arxiv.org/search/cs?searchtype=author&query=Keutzer%2C+K)[èµµç‘å¸Œ](https://arxiv.org/search/cs?searchtype=author&query=Hsieh%2C+C)

[p5] [å¸•ç»´å°”Â·ä¼Šå…¹è¿ˆæ´›å¤«](https://arxiv.org/search/cs?searchtype=author&query=Izmailov%2C+P)ï¼Œ[å¾·ç±³ç‰¹é‡ŒÂ·æ³¢å¤šæ™®é‡Œæ¬£](https://arxiv.org/search/cs?searchtype=author&query=Podoprikhin%2C+D)ï¼Œ[å¸–æœ¨å„¿Â·åŠ é‡Œæ³¢å¤«](https://arxiv.org/search/cs?searchtype=author&query=Garipov%2C+T)ï¼Œ[å¾·ç±³ç‰¹é‡ŒÂ·ç»´ç‰¹ç½—å¤«](https://arxiv.org/search/cs?searchtype=author&query=Vetrov%2C+D)ï¼Œ[å®‰å¾·é²Â·æˆˆç™»Â·å¨å°”é€Š](https://arxiv.org/search/cs?searchtype=author&query=Wilson%2C+A+G)å¹³å‡æƒé‡å¯¼è‡´æ›´å®½çš„æœ€ä¼˜å€¼å’Œæ›´å¥½çš„æ³›åŒ–èƒ½åŠ›

[p10]ä¼Šæ©Â·JÂ·å¤å¾·è²å‹’ã€å¥¥é‡Œå¥¥å°”Â·ç»´å°¼äºšå°”æ–¯å’Œå®‰å¾·é²Â·MÂ·è¨å…‹æ–¯ã€‚å®šæ€§è¡¨å¾ç¥ç»ç½‘ç»œä¼˜åŒ–é—®é¢˜ã€‚arXiv é¢„å°æœ¬ arXiv:1412.6544ï¼Œ2014ã€‚