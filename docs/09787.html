<html>
<head>
<title>Chrome V8 version 8.0 — V8, — What to expect?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Chrome V8 版本 8.0——V8——期待什么？</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/chrome-v8-version-8-0-v8-what-to-expect-11094d45411e?source=collection_archive---------11-----------------------#2019-12-23">https://towardsdatascience.com/chrome-v8-version-8-0-v8-what-to-expect-11094d45411e?source=collection_archive---------11-----------------------#2019-12-23</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="2655" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">最受期待的 chrome 版本 V8 发布了期待已久的 v8.0，并将于 2 月份与 chrome 80 一起发布。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/6e03b56d3a8b9db8ce141be711e40be0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xx50MC7KKwJVoaLWkUCtQw.png"/></div></div></figure><p id="ff23" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">8.0 版本增加了一些新功能，如<strong class="kw iu">可选链接、无效合并</strong>、<strong class="kw iu">更快的高阶内置功能</strong>和<strong class="kw iu">减少 40%的内存使用</strong>由于指针压缩，这些功能和变化将<strong class="kw iu">提高性能和代码生产率。</strong></p><p id="26e1" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">让我们一个一个来看——</p><h1 id="3641" class="lq lr it bd ls lt lu lv lw lx ly lz ma jz mb ka mc kc md kd me kf mf kg mg mh bi translated">可选链接(？。)</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mi"><img src="../Images/9e5bc6c632e841e2a88b45bf3d7ecd11.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ClL368c5LWT21Ly5"/></div></div><figcaption class="mj mk gj gh gi ml mm bd b be z dk">Photo by <a class="ae mn" href="https://unsplash.com/@wenzhu645?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Wen Zhu</a> on <a class="ae mn" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="65de" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">当访问嵌套的对象属性时，我们需要手动检查属性是否存在，即它们是否为空(<code class="fe mo mp mq mr b">null</code>或<code class="fe mo mp mq mr b">undefined</code>)。</p><pre class="kj kk kl km gt ms mr mt mu aw mv bi"><span id="0029" class="mw lr it mr b gy mx my l mz na">// Error prone-version, could throw.<br/>const nameLength = db.user.name.length;</span><span id="853d" class="mw lr it mr b gy nb my l mz na">TypeError: Cannot read property 'length' of undefined, if user is nullish</span></pre><p id="5ce8" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">如果它们是 nullish，我们试图访问它，JavaScript 将抛出一个错误:<code class="fe mo mp mq mr b">TypeError: Cannot read property 'property name' of undefined</code>。</p><p id="a0c3" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在许多情况下，当一个对象被大量嵌套时，<code class="fe mo mp mq mr b">if</code>条件或三元运算符检查会变得冗长，并且会产生所有真值而不仅仅是非空值的不良后果，如下所示</p><pre class="kj kk kl km gt ms mr mt mu aw mv bi"><span id="ae31" class="mw lr it mr b gy mx my l mz na">// Less error-prone, but harder to read.</span><span id="abe0" class="mw lr it mr b gy nb my l mz na">let nameLength;<br/>if (db &amp;&amp; db.user &amp;&amp; db.user.name)<br/>  nameLength = db.user.name.length;</span><span id="5f59" class="mw lr it mr b gy nb my l mz na">// OR</span><span id="7dfe" class="mw lr it mr b gy nb my l mz na">nameLength =<br/>  (db<br/>    ? (db.user<br/>      ? (db.user.name<br/>        ? db.user.name.length<br/>        : undefined)<br/>      : undefined)<br/>    : undefined);</span></pre><p id="a4bc" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">可选链接(<code class="fe mo mp mq mr b">?.</code>)帮助我们解决上述问题。</p><p id="8aaf" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">它帮助我们编写更少的代码，并获得一个健壮的属性访问链，易于阅读和检查中间值是否为空。如果是，那么整个表达式的计算结果为<code class="fe mo mp mq mr b">undefined</code>。</p><pre class="kj kk kl km gt ms mr mt mu aw mv bi"><span id="1030" class="mw lr it mr b gy mx my l mz na">const nameLength = db?.user?.name?.length;</span></pre><p id="8939" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们可以在以下三种形式中使用可选链接。</p><ol class=""><li id="b999" class="nc nd it kw b kx ky la lb ld ne lh nf ll ng lp nh ni nj nk bi translated"><code class="fe mo mp mq mr b">object?.property</code> —用于访问静态属性，如上所述。</li><li id="5bac" class="nc nd it kw b kx nl la nm ld nn lh no ll np lp nh ni nj nk bi translated"><code class="fe mo mp mq mr b">object?.[expression]</code> —用于访问动态属性或数组项</li></ol><pre class="kj kk kl km gt ms mr mt mu aw mv bi"><span id="14a8" class="mw lr it mr b gy mx my l mz na">const array = null;<br/>array?.[0]; // =&gt; undefined</span></pre><p id="0f88" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">3.<code class="fe mo mp mq mr b">object?.([arg1, [arg2, ...]])</code> —执行一个对象方法</p><pre class="kj kk kl km gt ms mr mt mu aw mv bi"><span id="b465" class="mw lr it mr b gy mx my l mz na">const object = null;<br/>object?.method('Some value'); // =&gt; undefined</span></pre><p id="a1c7" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">如果您需要，可以将这些形式组合起来创建一个长的可选链:</p><pre class="kj kk kl km gt ms mr mt mu aw mv bi"><span id="8443" class="mw lr it mr b gy mx my l mz na">const value = object.maybeUndefinedProp?.maybeNull()?.[propName];</span></pre><h1 id="2aa7" class="lq lr it bd ls lt lu lv lw lx ly lz ma jz mb ka mc kc md kd me kf mf kg mg mh bi translated">无效合并(？？)</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nq"><img src="../Images/26722de1c6331450a4fa245ddf546151.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ctiowigbk1dV8MBpJu9YZQ.png"/></div></div><figcaption class="mj mk gj gh gi ml mm bd b be z dk">Nullish coalescing (??)</figcaption></figure><p id="9c81" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这是一个新的短路操作符，用来处理默认值。</p><p id="f170" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">目前，默认值有时用逻辑<code class="fe mo mp mq mr b">||</code>处理 falsy 值，用<code class="fe mo mp mq mr b">&amp;&amp;</code>操作符处理 truthy 值，如下例所示。</p><pre class="kj kk kl km gt ms mr mt mu aw mv bi"><span id="a5d3" class="mw lr it mr b gy mx my l mz na">function test(props) {<br/>  const res = props.isTrue || true; <br/>  // return true if props.isTrue is set to false also, <br/>  // whereas the required result should be the value of props.isTrue<br/> }</span></pre><p id="354c" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">使用 nullish 合并运算符，当<code class="fe mo mp mq mr b">a</code>为 nullish ( <code class="fe mo mp mq mr b">null</code>或<code class="fe mo mp mq mr b">undefined</code>)时，<code class="fe mo mp mq mr b">a ?? b</code>计算为<code class="fe mo mp mq mr b">b</code>，否则计算为<code class="fe mo mp mq mr b">a</code>。</p><p id="86cd" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">所以在上面的例子中—</p><pre class="kj kk kl km gt ms mr mt mu aw mv bi"><span id="9728" class="mw lr it mr b gy mx my l mz na">function test(props) {<br/>  const res = props.isTrue ?? true;<br/>  // return true only when props.isTrue is nullish or true<br/>  // In case of false it evalutes to false<br/>}</span></pre><p id="d7df" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">nullish 合并操作符和可选的链接是相伴的特性，可以很好地协同工作。可以进一步修改该示例，以处理没有传入<code class="fe mo mp mq mr b">props</code>参数的情况。</p><pre class="kj kk kl km gt ms mr mt mu aw mv bi"><span id="7f8f" class="mw lr it mr b gy mx my l mz na">function test(props) {<br/>  const enable = props?.isTrue ?? true;<br/>  // …<br/>}</span></pre><h1 id="a855" class="lq lr it bd ls lt lu lv lw lx ly lz ma jz mb ka mc kc md kd me kf mf kg mg mh bi translated">更快的高阶内置</h1><p id="c550" class="pw-post-body-paragraph ku kv it kw b kx nr ju kz la ns jx lc ld nt lf lg lh nu lj lk ll nv ln lo lp im bi translated">要理解上面的性能优化，就要了解 V8 的涡扇。所以我们赶紧来看看是什么。</p><p id="3b3b" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">涡扇是一个 JIT 编译器架构师，作为 V8 中的多层翻译和优化管道，翻译和优化代码，以逐步降低形式，直到生成更高质量的机器代码。它用了一个概念叫做<a class="ae mn" href="https://darksi.de/d.sea-of-nodes/" rel="noopener ugc nofollow" target="_blank"> <strong class="kw iu"> <em class="nw">【节点之海】</em> </strong> </a> <strong class="kw iu"> <em class="nw">。</em>T11】</strong></p><pre class="kj kk kl km gt ms mr mt mu aw mv bi"><span id="256a" class="mw lr it mr b gy mx my l mz na">const charCodeAt = Function.prototype.<!-- -->apply<!-- -->.bind(String.prototype.charCodeAt);</span><span id="0671" class="mw lr it mr b gy nb my l mz na">// before<br/>charCodeAt(string, 8); // a lot slower<br/>string.charCodeAt(8); // a lot faster</span><span id="7ca6" class="mw lr it mr b gy nb my l mz na">// After optimization - same performance<br/>charCodeAt(string, 8);<br/>string.charCodeAt(8);</span></pre><p id="e3d7" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">到目前为止，对<code class="fe mo mp mq mr b">charCodeAt</code>的调用对于涡扇来说是完全不透明的，这导致了对用户定义函数的通用调用的生成。</p><p id="6889" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">有了这个新的变化，我们现在能够识别内置<code class="fe mo mp mq mr b">String.prototype.charCodeAt</code>函数的调用，并因此能够触发所有的进一步优化，以改善对内置的调用，这导致了与直接使用内置相同的性能。</p><h1 id="c2e6" class="lq lr it bd ls lt lu lv lw lx ly lz ma jz mb ka mc kc md kd me kf mf kg mg mh bi translated">指针压缩</h1><p id="c202" class="pw-post-body-paragraph ku kv it kw b kx nr ju kz la ns jx lc ld nt lf lg lh nu lj lk ll nv ln lo lp im bi translated">令人敬畏的 V8 团队在检查堆时发现，标记值(代表指针或小整数)占据了堆的大部分！</p><p id="e9e5" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">通过进一步检查，他们发现标记值与系统指针一样大:对于 32 位体系结构，它们是 32 位宽，而在 64 位体系结构中是 64 位。然后，当比较 32 位版本和 64 位版本时，我们为每个标记值使用了两倍的堆内存。</p><p id="540f" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">因此，为了解决上述问题，他们只将唯一的低位存储到堆中，然后使用它们来生成 64 位架构的高位，从而节省了宝贵的内存资源。</p><p id="f305" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">上述解决方案提高了 V8 和垃圾收集器在真实网站上的性能！</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nx"><img src="../Images/9f89a994a7a0e50ae410275a6fac2561.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LYy7t0dSxlg6Oi6BGrpGUA.jpeg"/></div></div><figcaption class="mj mk gj gh gi ml mm bd b be z dk">Some of the result shared by V8 Team</figcaption></figure><p id="7f7e" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">因此，我们可以期待 v8 版本的整体速度提升和一些很酷的 javascript 特性。</p><p id="c087" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">阅读更多关于 v8 的信息—<a class="ae mn" href="https://v8.dev/docs" rel="noopener ugc nofollow" target="_blank">https://v8.dev/docs</a></p></div><div class="ab cl ny nz hx oa" role="separator"><span class="ob bw bk oc od oe"/><span class="ob bw bk oc od oe"/><span class="ob bw bk oc od"/></div><div class="im in io ip iq"><h2 id="1c2b" class="mw lr it bd ls of og dn lw oh oi dp ma ld oj ok mc lh ol om me ll on oo mg op bi translated">如果你喜欢这篇文章，请随意分享并帮助他人找到它！</h2></div><div class="ab cl ny nz hx oa" role="separator"><span class="ob bw bk oc od oe"/><span class="ob bw bk oc od oe"/><span class="ob bw bk oc od"/></div><div class="im in io ip iq"><p id="63bf" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">如果您想加入我的电子邮件列表，请考虑在此输入您的电子邮件地址 和<strong class="kw iu">关注我的</strong> <a class="ae mn" href="https://medium.com/@ideepak.jsd" rel="noopener"> <strong class="kw iu">媒体</strong> </a> <strong class="kw iu">阅读更多关于 javascript 和</strong><a class="ae mn" href="https://github.com/dg92" rel="noopener ugc nofollow" target="_blank"><strong class="kw iu">github</strong></a><strong class="kw iu">的文章，查看我的疯狂代码</strong>。如果有什么不清楚或者你想指出什么，请在下面评论。</p><p id="cc34" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">你可能也会喜欢我的其他文章</p><ol class=""><li id="a141" class="nc nd it kw b kx ky la lb ld ne lh nf ll ng lp nh ni nj nk bi translated"><a class="ae mn" href="https://itnext.io/javascript-new-features-part-1-f1a4360466" rel="noopener ugc nofollow" target="_blank"> Javascript 新特性—第 1 部分</a></li><li id="8a63" class="nc nd it kw b kx nl la nm ld nn lh no ll np lp nh ni nj nk bi translated"><a class="ae mn" rel="noopener" target="_blank" href="/face-recognition-using-javascript-api-face-api-js-75af10bc3dee">使用 JavaScript API 的人脸检测— face-api.js </a></li><li id="9ec0" class="nc nd it kw b kx nl la nm ld nn lh no ll np lp nh ni nj nk bi translated"><a class="ae mn" href="https://levelup.gitconnected.com/8-console-api-functions-other-than-console-log-81cc6b7164b" rel="noopener ugc nofollow" target="_blank">除 Console.log()以外的 8 个控制台 API 函数</a></li></ol><p id="867c" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><strong class="kw iu">谢谢！</strong></p></div></div>    
</body>
</html>