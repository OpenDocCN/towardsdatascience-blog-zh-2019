<html>
<head>
<title/>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1/>
<blockquote>原文：<a href="https://towardsdatascience.com/custom-ner-model-crfsuite-automate-confidence-score-boosting-on-predicted-entities-52ff0b889b10?source=collection_archive---------16-----------------------#2019-06-29">https://towardsdatascience.com/custom-ner-model-crfsuite-automate-confidence-score-boosting-on-predicted-entities-52ff0b889b10?source=collection_archive---------16-----------------------#2019-06-29</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="ip iq gp gr ir is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/dd3ba7051eeea569bf8d905f00c90eb3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uGCyXbvqvjgb6eKzcwBMRg.jpeg"/></div></div></figure><p id="696f" class="pw-post-body-paragraph iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ij bi translated"><strong class="jc jy">自定义 NER 模型(CRFSUITE) —自动提升预测实体的可信度得分</strong></p><p id="c477" class="pw-post-body-paragraph iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ij bi translated"><em class="jz">一种无需人工干预提高 NER 模型置信度的自动化方法。</em></p><p id="6eb4" class="pw-post-body-paragraph iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ij bi translated"><strong class="jc jy">简介</strong> <br/>随着技术和 AI 的到来，世界正在从‘自动化’走向‘智能自动化’。各种垂直行业的公司，无论是银行/医疗保健/物流等，都会从各种渠道接收各种格式的信息。接收到的信息被读取并键入到各种业务流程的相应客户业务应用程序中，例如将从经纪人处接收到的保单报价文档信息输入到保单管理系统中，用于保单签发/客户注册。</p><p id="4bb1" class="pw-post-body-paragraph iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ij bi translated">以上面的例子为例，在当前的设置中，涉及到人工工作，其中代理以非结构化格式发送的信息将被流程执行人员读取，然后他们将手动地将数据输入到业务应用程序中。考虑到公司在人工劳动方面的投入，将人工智能应用于信息提取以及 RPA 应用于数据接收将大大降低运营成本，并且<br/>还有助于减少大量人工错误。智能自动化解决方案由三个这样的组件组成——OCR(将 word/image/pdf 文档转换为文本)、AI(信息提取)&amp; RPA(信息摄取)。每个组件都有自己的挑战，我们将专注于其中一个挑战——人工智能组件的主动学习。<br/>请注意，这里提到的文档是半结构化文档(例如，您从汽车销售商处收到的报价文档)。这里的一般论点是人工智能模型与解析代码解决方案。如果有不同的文档，解析代码解决方案会非常复杂。最好是有一个人工智能模型，它将在所有类型的此类文档上接受训练，即模型本身将找出规则。</p><p id="fc81" class="pw-post-body-paragraph iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ij bi translated"><strong class="jc jy">挑战:- </strong> <br/>人工智能在信息抽取中的应用是监督学习的一个案例。一组文本格式的文档将构成一个训练集，关于有多少个文档没有一个大概的数字，但是在 30 个文档之间——50 个文档是可以开始的。从文档中提取的内容被定义为实体，例如客户姓名、客户出生日期等，这些实体在文本中有注释。在注释过程之后，机器学习模型然后在注释文档集上被训练。对于预测，文本格式的文档然后由 AI 模型处理，该模型将识别和预测文本中的实体。<br/>在设计定制 NER 模型方面，有几种商业解决方案可供选择——Watson，LUIS。还有众所周知的开源 python 包——CRF suite、SPACY 等。商业解决方案的使用提供了用于注释的 UI 界面，这加速了注释过程，并且还有助于减少注释时的手动错误。人工智能模型还为预测的实体提供置信度得分。选择人工智能解决方案的人对置信度特别感兴趣。如果预测实体的置信度低于阈值水平(比如 75%)，则进行人工验证。这里的期望是，对于给定的值，模型应该以更高的置信度预测它遇到该值的净时间，这样就不会再次进行手动验证。<br/>例如“飓风”，如果模型已经以 70%的置信度将其预测为“损失原因”，那么下次模型应该以 90%的置信度对其进行预测。这种期望，我认为是一种公平的期望，如果你把它与人类的思维或者更确切地说是聊天机器人进行比较，那么这种行为是正确的。在人工智能世界中，在预测期间没有反馈机制，即，它不知道预测是对还是错，并且模型是无记忆的。达到这个要求的唯一方法是重新训练模型。重新训练模型并不是一件容易的事情，因为它涉及的工作量与训练时差不多。需要额外小心，因为人工智能模型输出是一种黑盒。可能有这样一种情况，即得到的再训练模型没有预测早期模型预测的一些其他实体。简而言之，没有适当的人工确认/验证，重新训练的模型不能直接发布到产品中。<br/>在一次用于信息提取的 POCs 过程中，我想到了实现自动置信度提升机制的想法。</p><p id="5335" class="pw-post-body-paragraph iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ij bi translated"><strong class="jc jy">方法:- </strong> <br/>该方法是根据模型给出的预测动态地重新训练模型。例如，我们有一个模型，它正在一组 30 个文档上进行训练。现在，在新文档中，在预测步骤本身中，创建了模型的一个实例。这个新模型是在一组 31 个文档上训练的。当调用模型进行预测时，此过程在后台进行。<br/>*半结构化类型的文档通常有键值对类型的表示。基于所产生的学习，该模型甚至能够预测未知值的实体，例如:“故障原因”:“短路”。虽然该模型在训练集中没有看到“短路”,但是它将能够预测“短路”作为失败的原因，因为它已经在训练集中了解到任何跟在关键字“失败原因”后面的东西都是失败的原因。只有在这种情况下，置信度得分才会更低。</p><p id="3fe7" class="pw-post-body-paragraph iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ij bi translated"><strong class="jc jy">上述方法的缺点</strong> <br/>考虑一个场景，其中有两种类型的文档(在真实的 word 中，您可能有 50 多种类型的文档，但为了简单起见，只考虑了 2 种)。有 10 个字段需要提取。类型 1 文档具有所有字段，而类型 2 文档没有 1 个字段。<br/>现在我们已经训练了一个模型(训练— 20 个文档—类型 1 + 20 个文档—类型 2)。该模型为这两种类型的文档提供了正确的输出。在预测过程中，模型根据它预测的文档进行训练。现在假设模型已经预测了 40 个文档，30 个类型 2 的文档，10 个类型 1 的文档。因此，我们有一个在 80 个文档、30 个文档(类型 1)和 50 个文档(类型 2)上训练的结果模型。现在，对于该模型，如果类型 1 文档被传递，则该模型将预测 9 个字段，但是将不能预测一个字段(该字段不出现在类型 2 中，但是存在于类型 1 中)。</p><p id="8ce4" class="pw-post-body-paragraph iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ij bi translated"><strong class="jc jy">对上述行为的解释。</strong> <br/>这里面有一个统计学的角度。基础模型在一组 40 个文档上训练，该字段存在于 20 个文档中。所以找到这个场的概率——20/40 = 0.5。对于新模型，该字段出现在 80 个文档中的 30 个文档中，因此找到该字段的概率-30/80 约为 0.333 <br/>因此，即使该字段出现在文档 1 中，新模型也无法预测该字段。</p><p id="6a2d" class="pw-post-body-paragraph iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ij bi translated">为了进一步阐述这种行为，考虑一个学生参加 3 天考试的情况。为了考试，他/她必须学习两章。考试中，题目只来自其中一章。在每一天考试结束时，学生记住提问的那一章，并预计第二天的考试也会包含同一章的问题。第一天，问题来自第一章，学生在第二天背诵第一章。在第二天，问题确实来自第一章，学生能够以更高的信心回答这些问题。但是在第三天，问题来自第二章。尽管学生已经学习了第二章，他/她还是不能正确地回忆起答案。<br/> <br/>学生(而不是新模型)的回忆能力下降了。</p><p id="c81d" class="pw-post-body-paragraph iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ij bi translated">因此，在运行中重新训练模型可能会提高某些实体的模型的置信度得分，但是由于训练集中的不平衡，其他实体的召回率可能会降低。<br/>所以基本上，重新训练模型，使用同一个模型进行预测，会导致输出不一致。</p><p id="cc3f" class="pw-post-body-paragraph iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ij bi translated"><strong class="jc jy">改进的方法:</strong> <br/>如果我们仔细检查上面的方法，重新训练的模型正在根据模型本身的预测进行训练。因此，对于给定的文档，如果基础模型本身不能预测一个实体，那么重新训练的模型就无法预测该实体。但是对于给定的文档，如果基础模型能够预测实体，则重新训练的模型可能会遭受低召回率并且不能预测该实体。<br/>在改进的方法中，为了弥补召回率的下降，将有两个模型——基础模型(在 40 个文档的初始集合上训练)+再训练模型(在 80 个文档的集合上训练)。对于第 81 个文档，两个模型都将用于预测。<br/>假设文件中有一行“失败原因”:“短路”。<br/>两个模型都将“短路”预测为故障原因，但重新训练模型的置信分数将高于基础模型的置信分数，因此重新训练模型的置信分数将被视为模型置信分数。<br/>假设第 81 个文档是类型 1 文档，由于召回能力低，重新训练的模型将不能预测 1 个实体(将预测 9 个字段)，将考虑该实体的基础模型输出。</p><p id="a457" class="pw-post-body-paragraph iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ij bi translated">因此，在这里，基础模型是其预测被引用的模型，重新训练的模型输出被引用用于置信度得分。</p><p id="585e" class="pw-post-body-paragraph iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ij bi translated">下面已经举例说明了这两种模式的概念。</p><figure class="kb kc kd ke gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ka"><img src="../Images/984db6cad2d9531ab6a468d7dfcf6f88.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NRQTRoHUxpH3CLto3HVDIA.png"/></div></div></figure><figure class="kb kc kd ke gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ka"><img src="../Images/26a82aabf692c6eb9bc8d8fdad090fa2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aTiwMg6gI7xNrATZERtIQA.png"/></div></div></figure><figure class="kb kc kd ke gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ka"><img src="../Images/1854b2da6ce8c676db201f5f89351354.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ALzPeBCiiDbXnuUlW-on9w.png"/></div></div></figure><figure class="kb kc kd ke gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ka"><img src="../Images/c81ef62957a396ecbe249c670f0fe9a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4LcjYcj27f9N3rUc78R0Ag.png"/></div></div></figure><figure class="kb kc kd ke gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ka"><img src="../Images/3815f13d51267d2cafb88ba3cd29101f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dO5iVDq2bMhpHGsMESMFOA.png"/></div></div></figure></div></div>    
</body>
</html>