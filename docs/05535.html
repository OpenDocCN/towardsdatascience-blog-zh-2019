<html>
<head>
<title>Formatting Capabilities in SQL Complete for MS SQL Server</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">MS SQL Server 的 SQL Complete 中的格式化功能</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/formatting-capabilities-in-sql-complete-for-ms-sql-server-57bcc3fdfb26?source=collection_archive---------33-----------------------#2019-08-14">https://towardsdatascience.com/formatting-capabilities-in-sql-complete-for-ms-sql-server-57bcc3fdfb26?source=collection_archive---------33-----------------------#2019-08-14</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="fa39" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">回到时间优化的问题。MS SQL Server 中快速脚本理解和定义对象的另一种方式</h2></div><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi kj"><img src="../Images/1f206dd88246619077281062bce8bda2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BWGllZOrl4-48HpMmca6Dw.jpeg"/></div></div></figure><p id="7b8b" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">MS SQL Server 开发人员和 DBMS 管理员都知道，在编码过程中，文本格式化需要花费大量时间。还有，格式化往往很肤浅，甚至完全没有。事情变得更加复杂，因为每个人都有不同的格式，没有统一的风格。所有这些都会导致这样的情况，一个专家会花很多时间去理解另一个专家写的代码。</p><p id="64d9" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">从我自己的经验来看，建立一套格式规则通常需要几年的时间。在整个公司范围内，甚至是公司的某个部分，开发和应用这种标准的主要问题在于，一个人很难学会用不同的方式编写代码。在代码审查过程中也会感觉到很多阻力，因为维护代码的专家并不总是同意格式规则。在实践中，如果没有特殊的工具，手工维护这些标准是非常困难的。</p><p id="bf40" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">当你有专门的<em class="lr">代码格式化软件</em>时，你可以通过它设置自己的格式化标准，或者直接使用默认的格式化标准。这样，从现在开始，所有代码都将被自动格式化。因此，您不需要在脚本格式化和格式审查上花费时间。</p><p id="3de0" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated"><strong class="kx iu">通常，标准化流程有以下生命周期:</strong></p><ol class=""><li id="a5f9" class="ls lt it kx b ky kz lb lc le lu li lv lm lw lq lx ly lz ma bi translated">公司中使用 SQL 的人数增长到 4 人以上(这个值不一定在所有情况下都相同，但通常 4 是一个很好的里程碑)</li><li id="2b74" class="ls lt it kx b ky mb lb mc le md li me lm mf lq lx ly lz ma bi translated">SQL 代码的数量增加了，专家们现在不得不交换知识，有时在他们的任务中互相替换。通常，在这一点上，已经有许多数据库和至少几个项目。来自不同项目和/或数据库的人们相互分享他们对这些项目和数据库的知识。</li><li id="814b" class="ls lt it kx b ky mb lb mc le md li me lm mf lq lx ly lz ma bi translated">有必要建立统一的格式样式。指定一个团队来开发格式规则，并在投票中展示它们，或者提出一个现成的解决方案。</li><li id="140d" class="ls lt it kx b ky mb lb mc le md li me lm mf lq lx ly lz ma bi translated">投票后，相应地更改标准，然后重复步骤 3-4，直到标准被必要数量的人接受(在大多数情况下，最好是几乎每个人都接受标准，而不只是大多数人，这将有助于尽可能地遵守标准)</li><li id="0561" class="ls lt it kx b ky mb lb mc le md li me lm mf lq lx ly lz ma bi translated">决定如何维护标准，包括在代码审查级别。</li></ol><p id="f87b" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">初始标准通常取自所选工具中的默认标准，这样，步骤 3-4 将不会循环，步骤 5 将同时求解。</p><p id="a3c0" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">在一些公司，第三步没有实现，所以专家们决定如何自己写代码。这使得开发过程、代码维护和引入变更变得非常复杂。</p><p id="0934" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">你可以把一个公司发展代码标准化的过程分为<strong class="kx iu"> <em class="lr">三个阶段</em> </strong>:</p><p id="b6b6" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated"><strong class="kx iu"> 1。</strong>没有标准，每个人都按照自己的想法写代码</p><p id="3c66" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated"><strong class="kx iu"> 2。</strong>有一个标准，但是是手工维护的</p><p id="e9d4" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated"><strong class="kx iu"> 3。有一个标准并自动维护</strong></p><p id="633b" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">根据我的观察，我们可以看到开发和维护速度在三个主要阶段之间的增长，如下所示:</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi mg"><img src="../Images/697fd8b2cbb9febc5deea4c15e50b8e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0bjPhTVkqE3-e_Z2vJ0ITg.png"/></div></div></figure><p id="9031" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">此表估计了开发、维护和案例转移所花费的平均时间。</p><p id="e38d" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">您可以使用特殊的工具来自动维护标准——这些工具可以是自定义编写的，也可以是从可用的第三方解决方案中选择的。</p><p id="bca6" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">数据库专家迟早会意识到，如果希望所有开发人员更好地理解代码，格式标准化是至关重要的。你可以找到付费和免费的解决方案。</p><p id="2d47" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">在本文中，我们将研究这些工具中的一个——用于 MS SQL Server 的<a class="ae mh" href="https://www.devart.com/dbforge/sql/sqlcomplete/?utm_source=towardsdatascience.com&amp;utm_medium=referral&amp;utm_campaign=articlesqlcomplete" rel="noopener ugc nofollow" target="_blank"> SQL Complete </a>。目前，这个工具集成了 SSMS 和 Visual Studio。它还内置于<a class="ae mh" href="https://www.devart.com/dbforge/sql/studio/?utm_source=towardsdatascience.com&amp;utm_medium=referral&amp;utm_campaign=articlesqlcomplete" rel="noopener ugc nofollow" target="_blank">db forge Studio for SQL Server</a>中。</p><h2 id="11a9" class="mi mj it bd mk ml mm dn mn mo mp dp mq le mr ms mt li mu mv mw lm mx my mz na bi translated">SSMS 的<em class="ki"> SQL Complete </em>菜单如下所示:</h2><figure class="kk kl km kn gt ko gh gi paragraph-image"><div class="gh gi nb"><img src="../Images/b9587175c3f198aebb5b6ee7698aa452.png" data-original-src="https://miro.medium.com/v2/resize:fit:670/format:webp/1*jwYUGHl309EJOJy1CgpWJQ.jpeg"/></div><figcaption class="nc nd gj gh gi ne nf bd b be z dk">Fig.1 SQL Complete in SSMS</figcaption></figure><p id="36df" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">该工具的主要功能是:</p><ol class=""><li id="e35b" class="ls lt it kx b ky kz lb lc le lu li lv lm lw lq lx ly lz ma bi translated"><strong class="kx iu">禁用/启用代码完成</strong> —关闭/打开工具</li><li id="69c2" class="ls lt it kx b ky mb lb mc le md li me lm mf lq lx ly lz ma bi translated"><strong class="kx iu">格式化文档</strong> —开始整个文档的格式化过程</li><li id="0c8d" class="ls lt it kx b ky mb lb mc le md li me lm mf lq lx ly lz ma bi translated"><strong class="kx iu">格式选择</strong> —开始代码选定区域的格式化过程</li><li id="ca94" class="ls lt it kx b ky mb lb mc le md li me lm mf lq lx ly lz ma bi translated"><strong class="kx iu">转到定义</strong> —转到对象浏览器中的指定对象(存储过程、视图、表、函数等)。)</li><li id="89b8" class="ls lt it kx b ky mb lb mc le md li me lm mf lq lx ly lz ma bi translated"><strong class="kx iu">执行历史</strong> —打开包含在 SSMS 执行的命令历史的日志</li><li id="ad1f" class="ls lt it kx b ky mb lb mc le md li me lm mf lq lx ly lz ma bi translated"><strong class="kx iu">恢复最后关闭的文档</strong> —打开先前关闭的 SQL 文档选项卡</li><li id="14a4" class="ls lt it kx b ky mb lb mc le md li me lm mf lq lx ly lz ma bi translated"><strong class="kx iu">最近关闭的文档</strong> —显示最近关闭的文档列表</li><li id="2082" class="ls lt it kx b ky mb lb mc le md li me lm mf lq lx ly lz ma bi translated"><strong class="kx iu">选项</strong> —工具设置，包括格式规则</li><li id="7545" class="ls lt it kx b ky mb lb mc le md li me lm mf lq lx ly lz ma bi translated"><strong class="kx iu">导入导出设置</strong> —导入导出刀具设置</li></ol><p id="3edb" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">类似的功能也被集成到 SSMS 下拉菜单中。除此之外，SQL 文档上下文菜单中还添加了以下选项:</p><ol class=""><li id="4bdc" class="ls lt it kx b ky kz lb lc le lu li lv lm lw lq lx ly lz ma bi translated"><strong class="kx iu">活动格式配置文件</strong> —允许您选择必要的格式配置文件</li><li id="cedc" class="ls lt it kx b ky mb lb mc le md li me lm mf lq lx ly lz ma bi translated"><strong class="kx iu">将对象脚本化为 CREATE/ALTER </strong> —允许您生成光标所在的 DDL 对象。</li><li id="a76a" class="ls lt it kx b ky mb lb mc le md li me lm mf lq lx ly lz ma bi translated"><strong class="kx iu">将表格脚本化为 CRUD </strong> —允许您基于脚本生成程序。</li><li id="a8ad" class="ls lt it kx b ky mb lb mc le md li me lm mf lq lx ly lz ma bi translated"><strong class="kx iu">重命名</strong> —允许您重命名文档中的名字对象、变量和脚本对象。</li><li id="304b" class="ls lt it kx b ky mb lb mc le md li me lm mf lq lx ly lz ma bi translated"><strong class="kx iu">将 EXEC 转换为脚本</strong> —允许您将程序代码转换为可执行脚本，主要用于调试等。</li></ol><h2 id="eb5d" class="mi mj it bd mk ml mm dn mn mo mp dp mq le mr ms mt li mu mv mw lm mx my mz na bi translated">Visual Studio 中的 SQL Complete 菜单如下所示:</h2><figure class="kk kl km kn gt ko gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/47f89ffc62881bf476249dd6852536d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:496/format:webp/1*UzjG0HX2UCtMr-wv5J9xhA.jpeg"/></div><figcaption class="nc nd gj gh gi ne nf bd b be z dk">Fig.2 SQL Complete in Visual Studio</figcaption></figure><p id="e51b" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">该工具的类似功能已经在前面讨论过了。</p><p id="136f" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">Visual Studio 的下拉菜单中集成了相同的功能。</p><p id="178e" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">现在，让我们看看<a class="ae mh" href="https://www.devart.com/dbforge/sql/sqlcomplete/sql-code-formatter.html" rel="noopener ugc nofollow" target="_blank">代码格式化</a>在这个例子中是如何工作的:</p><p id="f155" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated"><strong class="kx iu"> 1) </strong>打开脚本文件，点击“格式化文档”:</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi nh"><img src="../Images/4a812f7d8dace2ad53d36ff1e1bc6465.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DKXxL03YJOffWL_nA8JmAg.jpeg"/></div></div><figcaption class="nc nd gj gh gi ne nf bd b be z dk">Fig.3 Script before formatting</figcaption></figure><p id="de5f" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated"><strong class="kx iu"> 2) </strong>这是我们得到的格式化脚本结果:</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi ni"><img src="../Images/60b3fd13be7ae07e579e588892f9a9d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gafGIkk7BA3EqXyt_qurlw.jpeg"/></div></div><figcaption class="nc nd gj gh gi ne nf bd b be z dk">Fig.4 Script after formatting</figcaption></figure><p id="f3d4" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">现在，让我们看看“转到定义”命令:</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/1278c056542280549e35d8eca8e2c42d.png" data-original-src="https://miro.medium.com/v2/resize:fit:888/format:webp/1*3eE-2I_gDSEUnPsIs2Cg0A.jpeg"/></div><figcaption class="nc nd gj gh gi ne nf bd b be z dk">Fig.5 Calling the stored procedure</figcaption></figure><p id="d7ce" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">正如前面的屏幕截图所示，当我们指向这个过程时，我们获得了存储过程的签名及其扩展属性的描述。</p><p id="0333" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">当鼠标光标被设置在程序上时，我们需要按 F12 或从下拉菜单中选择“转到定义”:</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/caee9c564d1da8aefc0b70c43ea9de30.png" data-original-src="https://miro.medium.com/v2/resize:fit:1290/format:webp/1*0BlSh535NoSL8H06YWAxow.jpeg"/></div><figcaption class="nc nd gj gh gi ne nf bd b be z dk">Fig.6 Calling “Go To Definition”</figcaption></figure><p id="c08e" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">将在对象资源管理器中选择必要的存储过程:</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/08490765f2f64d958cd0ac6ad1a8440e.png" data-original-src="https://miro.medium.com/v2/resize:fit:748/format:webp/1*_xRd1YiehW--S-_EItt6mA.jpeg"/></div><figcaption class="nc nd gj gh gi ne nf bd b be z dk">Fig.7 Selection of the necessary stored procedure in the object explorer</figcaption></figure><p id="3f29" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">对于其他对象类型，如表、视图、函数等，F12 以同样的方式工作。</p><p id="61f2" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">此外，SQL Complete 工具还提供了一些有用的功能，如:</p><ol class=""><li id="4bff" class="ls lt it kx b ky kz lb lc le lu li lv lm lw lq lx ly lz ma bi translated">代码完成</li><li id="4380" class="ls lt it kx b ky mb lb mc le md li me lm mf lq lx ly lz ma bi translated">通过最佳搜索树实现的工具提示</li><li id="afa4" class="ls lt it kx b ky mb lb mc le md li me lm mf lq lx ly lz ma bi translated">搜索无效对象(即引用其他不存在对象的对象)等。</li></ol><h2 id="566f" class="mi mj it bd mk ml mm dn mn mo mp dp mq le mr ms mt li mu mv mw lm mx my mz na bi translated">然后</h2><p id="d872" class="pw-post-body-paragraph kv kw it kx b ky nm ju la lb nn jx ld le no lg lh li np lk ll lm nq lo lp lq im bi translated">这样，通过具备格式化代码、将代码转化为统一风格和对象导航的能力，您可以显著减少理解脚本和定义对象所花费的时间，这将极大地影响新功能、新软件的开发以及该功能和软件的维护的质量和时间。</p></div></div>    
</body>
</html>