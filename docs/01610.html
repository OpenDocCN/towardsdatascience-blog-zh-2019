<html>
<head>
<title>Data Science with no Math</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">没有数学的数据科学</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/data-science-with-no-math-fd502621728b?source=collection_archive---------14-----------------------#2019-03-15">https://towardsdatascience.com/data-science-with-no-math-fd502621728b?source=collection_archive---------14-----------------------#2019-03-15</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="9b7e" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用人工智能建立数学数据集</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/be2096a5506958525aee18cfd4b751f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nOmAs7GkrIwEVxbqVuupeg.jpeg"/></div></div></figure><p id="0b36" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这是我的上一篇文章的附录，在文章的最后我必须补充一点，我不是数学家，而且我是 Python 新手。我添加这个是因为我努力想出一个数学公式来生成患者数据，这些数据将遵循对我有意义的趋势。本文的目标是生成 10，000 份将年龄与成本相关联的患者记录。我希望这种关联遵循如下模式:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lr"><img src="../Images/8c349b8e9b35a5326e2196ee509c0a49.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0SbVvT0vz_deQbMjeiEyWQ.png"/></div></div><figcaption class="ls lt gj gh gi lu lv bd b be z dk">Artists rendition of correlation pattern (not exact)</figcaption></figure><p id="af7d" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">Y 轴是成本乘数；X 轴是年龄。这里的想法是，病人的费用开始时相对较高，随着他们接近某个年龄而降低，然后又开始增加。经过多次反复试验，我想出了一个公式，它可以生成一个类似这样的图形:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lw"><img src="../Images/857b932e4287f6fbc00f2462cb912f41.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EyH4UBKjN6G0jpolkA30Og.png"/></div></div></figure><p id="daf9" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">你可以明显看出这个公式有一些瑕疵。最明显的一点是，这意味着一旦病人到了 60 岁，费用就会稳定下来。在我想使用的相关性中，成本随着年龄的增长而不断增加。为了完成这篇文章，我觉得这已经足够了，我已经准备好开始编写实际的代码了。</p><p id="aa3a" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在我发表文章后的几天里，我继续试图想出一个遵循我的相关性模式的公式，但没有成功。然后有一天我恍然大悟:<strong class="kw iu">为什么不让计算机算出公式</strong>。如果我能成功实现这一点，我就可以集中精力提高我的 Python 知识(这是我的首要目标),而不是找出一个数学公式。让我们使用机器学习来生成一个公式的近似值，我希望使用一些值作为输入。一旦我们训练了一个模型，我们就可以生成一个完整的样本数据集，输入到机器学习模型中。</p><p id="f4f7" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">第一步是设置一些值来训练我们的模型:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi lx"><img src="../Images/2c16ac6309831bca9137d1c367e2e69d.png" data-original-src="https://miro.medium.com/v2/resize:fit:230/format:webp/1*zxgMVidojgK95JsfrooErA.png"/></div></figure><p id="c4cf" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">现在，如果我们绘制这个，你可以看到它大致遵循我在上面画的图:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ly"><img src="../Images/5b13416f9a648a073f20b9fc621351bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:806/format:webp/1*xtBqimcNhhazoVk3tEluVQ.png"/></div></figure><p id="c4fb" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们现在可以使用这些数据作为神经网络的输入来建立一个模型，我们可以训练这个模型来预测我们进入的任何年龄:</p><pre class="kj kk kl km gt lz ma mb mc aw md bi"><span id="8f5b" class="me mf it ma b gy mg mh l mi mj">from sklearn.neural_network import MLPRegressor<br/>regr=MLPRegressor(hidden_layer_sizes=(30),<br/>                   activation='tanh',<br/>                   solver='lbfgs',<br/>                   max_iter=20000)<br/>model=regr.fit(np.array(age_df['Age']).reshape(-1,1),Age_df['Cost'])</span></pre><p id="d1f0" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">MLPRegresser 中的 MLP 代表多层感知器，这是一种神经网络，是 sklearn Python 库的一部分。sklearn 库内置了许多回归器，使用它们来为您的应用程序找到最佳结果非常容易。所有回归变量都有一个拟合函数，用给定的输入来训练模型。</p><p id="410c" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">现在我们的模型已经训练好了，让我们生成一个测试数据集来看看我们的模型表现如何。</p><pre class="kj kk kl km gt lz ma mb mc aw md bi"><span id="688d" class="me mf it ma b gy mg mh l mi mj">df = pd.DataFrame( {'Age': np.arange(0,100), 'Cost': model.predict(np.arange(0,100).reshape(-1, 1))})</span></pre><p id="9385" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在这种情况下，我们生成一个数据帧，其中包含 0 到 100 岁之间的每个年龄的一行，以及我们的模型为该年龄预测的成本。绘制结果给我们提供了:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mk"><img src="../Images/a48365a876da4be9d688f57799b310c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:760/format:webp/1*Xca8n5eQZUN79WI3lT_kug.png"/></div></figure><p id="e0b3" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这看起来更像我在文章顶部画的图。然而，我们不希望我们的模型预测一个时代的确切成本乘数。相反，我们希望使用预测作为基线来预测随机值。在这种情况下，我们将调整数据，使成本在预测的 20%以内。下面是在 Python 中如何做到这一点:</p><pre class="kj kk kl km gt lz ma mb mc aw md bi"><span id="302d" class="me mf it ma b gy mg mh l mi mj">df['Cost']  = [i + i * random.uniform(-0.2, 0.2) for i in df['Cost']]</span></pre><p id="b011" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">现在，如果我们绘制数据集，它看起来像这样:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ml"><img src="../Images/c36324eee90b1cf1e95354eb4b9868c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:756/format:webp/1*DYXe_N0vFw1S5ns6X2BRMg.png"/></div></figure><p id="f8f0" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">现在，我们已经生成了 100 个值，大致符合文章顶部的图形。让我们使用这个模型生成一个 10，000 行的数据集。</p><pre class="kj kk kl km gt lz ma mb mc aw md bi"><span id="91db" class="me mf it ma b gy mg mh l mi mj">df2 = pd.DataFrame( {'Age': (np.random.random_sample((10000,))*100).astype(int)})<br/>df2['Cost'] = model.predict(np.array(df2['Age']).reshape(-1, 1))</span></pre><p id="0459" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这是这 10，000 个年龄/成本值的散点图，正如我们可以看到的，它仍然大致遵循文章顶部的绘图。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mm"><img src="../Images/520a35ee8cded79c925b8044f7a56c15.png" data-original-src="https://miro.medium.com/v2/resize:fit:850/format:webp/1*VJv_6PdmjfehuersP1F_kQ.png"/></div></figure><p id="cd94" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">现在，我们将向数据集添加一些随机性，看看它看起来像什么:</p><pre class="kj kk kl km gt lz ma mb mc aw md bi"><span id="d20b" class="me mf it ma b gy mg mh l mi mj">df2['Cost']  = [i + i * random.uniform(-0.2, 0.2) for i in df2['Cost']]</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mn"><img src="../Images/b2e1f6e53ffda182b5fd95a469a2e417.png" data-original-src="https://miro.medium.com/v2/resize:fit:816/format:webp/1*TRuanc_-U4jnbHkTO-GCmw.png"/></div></figure><p id="1b0b" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们现在可以将此作为数据集的一部分，使用年龄作为输入之一来预测医疗保健成本。这个概念可以有效地用来扩充 Kaggle 上的数据集,该数据集包含有价值的趋势，但只包含 1338 行。使用这种技术，我们可以生成我们想要输入到模型中的任意多的行。</p></div></div>    
</body>
</html>