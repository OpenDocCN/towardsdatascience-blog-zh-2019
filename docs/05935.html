<html>
<head>
<title>Unsupervised OMICs Integration</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">无监督组学整合</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/unsupervised-omics-integration-688bf8fa49bf?source=collection_archive---------17-----------------------#2019-08-29">https://towardsdatascience.com/unsupervised-omics-integration-688bf8fa49bf?source=collection_archive---------17-----------------------#2019-08-29</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="5c3d" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsdatascience.com/tagged/stats-ml-life-sciences" rel="noopener" target="_blank">生命科学的数理统计和机器学习</a></h2><div class=""/><div class=""><h2 id="56b0" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">将数据投射到跨组学的公共变化轴上</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/8159cecfaeacd9f675ff8c753bdffd71.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IwTTStLUxBI7Tc1vmF0myw.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk">The idea behind OMICs integration from Wang et al., Quantitative Biology <strong class="bd lh">4</strong>, p.58, 2016, <a class="ae li" href="https://link.springer.com/article/10.1007/s40484-016-0063-4" rel="noopener ugc nofollow" target="_blank">image source</a></figcaption></figure><p id="0894" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">这是专栏<a class="ae li" href="https://towardsdatascience.com/tagged/stats-ml-life-sciences?source=post_page---------------------------" rel="noopener" target="_blank"> <strong class="ll jd">生命科学的数理统计和机器学习</strong> </a>的第十篇文章，我试图在这里涵盖生物信息学、生物医学、遗传学、进化论等常用的分析技术。之前，我对组学集成做了一个<a class="ae li" rel="noopener" target="_blank" href="/select-features-for-omics-integration-511390b7e7fd">介绍</a>，并介绍了<a class="ae li" rel="noopener" target="_blank" href="/supervised-omics-integration-2158e1a6d23f">监督的 PLS-DA 模型</a>。今天，我们将考虑<strong class="ll jd">无监督组学整合</strong>，这在<strong class="ll jd">没有类别标签</strong>(没有明确的<strong class="ll jd">表型</strong>)可用时尤其方便，但我们仍然希望通过组合不同来源的生物信息来了解数据中样本之间的<strong class="ll jd">异质性。</strong></p><h1 id="c86f" class="mf mg it bd mh mi mj mk ml mm mn mo mp ki mq kj mr kl ms km mt ko mu kp mv mw bi translated">监督与非监督数据集成</h1><p id="986b" class="pw-post-body-paragraph lj lk it ll b lm mx kd lo lp my kg lr ls mz lu lv lw na ly lz ma nb mc md me im bi translated">比较有监督和无监督的数据分析就像比较披头士和天鹅绒地下音乐。两者都很优秀，但方式不同。虽然<strong class="ll jd">监督建模在现代研究中占主导地位</strong>，因为它提供了<strong class="ll jd">缓慢但有保证的进展</strong>，但无监督模型一直被认为是<strong class="ll jd">“高风险-高收益”的方法</strong>。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nc"><img src="../Images/c0eeeeb8e3629a601e2eb239a2e86dac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UQXRO6UcXF2XAQ4M0jjK0w.png"/></div></div></figure><p id="d800" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated"><a class="ae li" href="https://en.wikipedia.org/wiki/Lev_Landau" rel="noopener ugc nofollow" target="_blank"> <strong class="ll jd">列夫·朗道</strong> </a> <strong class="ll jd">(诺贝尔物理学奖获得者)</strong>他问正在努力解决数学问题的学生的问题:<strong class="ll jd">“你怎么能在不知道答案的情况下解决一个科学问题？”</strong>反映了有监督的假设驱动的主流研究的心态。例如，如果一个人胆敢对编辑的评论“我不太理解你的生物学假设”回复“我没有”，这将很可能导致同行评审科学期刊拒绝该论文。这是因为在研究中，我们倾向于用事物如何工作的最初想法来约束自己，而要做的研究只是为了证明我们的假设是正确的。相比之下，无监督方法是一种<a class="ae li" href="https://www.youtube.com/watch?v=oXv3SSijPFc" rel="noopener ugc nofollow" target="_blank"> <strong class="ll jd">解放你的思想</strong> </a>的方法，当你<strong class="ll jd">不知道你的数据</strong>中有什么，因此可以发现<strong class="ll jd">意想不到的现象</strong>。</p><h1 id="9396" class="mf mg it bd mh mi mj mk ml mm mn mo mp ki mq kj mr kl ms km mt ko mu kp mv mw bi translated">多组学因素分析(MOFA)</h1><p id="b3fd" class="pw-post-body-paragraph lj lk it ll b lm mx kd lo lp my kg lr ls mz lu lv lw na ly lz ma nb mc md me im bi translated"><a class="ae li" href="https://www.embopress.org/doi/10.15252/msb.20178124" rel="noopener ugc nofollow" target="_blank"><strong class="ll jd"/></a>是典型的<strong class="ll jd">无假设</strong>数据探索框架。它允许通过从<a class="ae li" rel="noopener" target="_blank" href="/select-features-for-omics-integration-511390b7e7fd">多组学</a>层中提取<strong class="ll jd">公共变化轴</strong>进行数据整合。给定来自<strong class="ll jd">相同或重叠样本</strong>的多个组学的数据矩阵，MOFA 根据<strong class="ll jd">潜在/隐藏因素</strong>推断出数据的<strong class="ll jd">低维</strong>表示，然后可以对其进行可视化和解释。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nd"><img src="../Images/7cf92725e3163884e33f62e5841befc0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UGfb_cMLYmBMkvSdSXhIvA.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk">Idea of unsupervised OMICs integration with <a class="ae li" href="https://www.embopress.org/doi/10.15252/msb.20178124" rel="noopener ugc nofollow" target="_blank">Multi-OMICs Factor Analysis (MOFA)</a></figcaption></figure><p id="4c0b" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">类似于其他整合组学方法，如<a class="ae li" href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4905617/" rel="noopener ugc nofollow" target="_blank"> <strong class="ll jd"> DISCO、JIVE 和 O2PLS </strong> </a>，MOFA 推断异质性的潜在轴是否为个体 OMIC 或<strong class="ll jd">所独有，表现在多个组学</strong>中。此外，MOFA 提供了几个有用的功能，包括:</p><ul class=""><li id="70de" class="ne nf it ll b lm ln lp lq ls ng lw nh ma ni me nj nk nl nm bi translated">低维潜在空间中样本的可视化</li><li id="7708" class="ne nf it ll b lm nn lp no ls np lw nq ma nr me nj nk nl nm bi translated">使用(基因集)富集分析的因子注释</li><li id="a2e1" class="ne nf it ll b lm nn lp no ls np lw nq ma nr me nj nk nl nm bi translated">缺失和稀疏数据的插补和支持</li><li id="8bd8" class="ne nf it ll b lm nn lp no ls np lw nq ma nr me nj nk nl nm bi translated">非高斯分布的组学支持</li></ul><p id="d2de" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">后两个优点源于 MOFA 是在<strong class="ll jd">贝叶斯</strong>T2 框架内实现的，不依赖于大量数据或高斯分布等频繁统计假设。重要的是，MOFA 是一个<strong class="ll jd">线性</strong> <strong class="ll jd">集成组学算法</strong>，一个更一般的非线性组学集成可以通过例如自动编码器来执行，我在<a class="ae li" rel="noopener" target="_blank" href="/deep-learning-for-data-integration-46d51601f781">我以前的帖子</a>中描述过。关于 MOFA 要提到的最后一点是，它是一种<a class="ae li" href="https://en.wikipedia.org/wiki/Factor_analysis" rel="noopener ugc nofollow" target="_blank"> <strong class="ll jd">因子分析(FA) </strong> </a>算法，尽管 FA 在视觉上<a class="ae li" rel="noopener" target="_blank" href="/reduce-dimensions-for-single-cell-4224778a2d67">可能看起来与 PCA </a>相同，但这两种线性降维技术不应混淆。PCA 是一种纯粹的<strong class="ll jd">矩阵分解</strong>技术(除非它是一种概率 PCA ),它将总方差分解成正交的主分量，FA 寻求构造<strong class="ll jd">隐藏的潜在变量</strong>，这些变量<strong class="ll jd">生成</strong>观察到的数据，因此因子分析是一种<strong class="ll jd">生成模型</strong>,类似于隐马尔可夫模型(HMM)、高斯混合模型(GMM)、变分自动编码器(ve)、生成对抗网络(GANs)等。</p><h1 id="d78a" class="mf mg it bd mh mi mj mk ml mm mn mo mp ki mq kj mr kl ms km mt ko mu kp mv mw bi translated">多组学数据集的整合</h1><p id="27c2" class="pw-post-body-paragraph lj lk it ll b lm mx kd lo lp my kg lr ls mz lu lv lw na ly lz ma nb mc md me im bi translated">在本节中，我们将 MOFA 应用于单细胞多组学<a class="ae li" href="https://www.nature.com/articles/s41467-018-03149-4" rel="noopener ugc nofollow" target="_blank"> <strong class="ll jd"> scNMT </strong> </a>数据集，该数据集描绘了来自<strong class="ll jd">相同生物细胞</strong>的<strong class="ll jd">染色质可及性(scATACseq)、DNA 甲基化(scBSseq)和基因表达(scRNAseq) </strong>，这些细胞属于两种类型:<strong class="ll jd">分化小鼠胚胎干细胞(ESCs)和胚胎体(EBs) </strong>。我们将从读取、过滤和对数转换 scNMT 的 scRNAseq 子集开始:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="ns nt l"/></div></figure><p id="bd5b" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">接下来，我们将读取 scNMT 的 scBSseq 和 scATACseq 子集，并显示它们的分布。因为<strong class="ll jd"> CpG 位点</strong>可以是<strong class="ll jd">甲基化或未甲基化</strong>，并且类似地，使用<a class="ae li" href="https://www.nature.com/articles/s41467-018-03149-4" rel="noopener ugc nofollow" target="_blank"> <strong class="ll jd"> GpC 甲基转移酶</strong> </a> <strong class="ll jd"> </strong>标记的位点可以来自<strong class="ll jd">开放或封闭染色质</strong>区域，所以 scBSseq 和 scATACseq 的分布看起来<strong class="ll jd">生物模态</strong>指示数据的<strong class="ll jd">二元性质</strong>就不足为奇了。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="ns nt l"/></div></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nu"><img src="../Images/66f6d07dda832b32b2ff3fe4790fb88e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Kq9mAN9_0ZdAp8rB9jB6GQ.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk">Histograms of scBSseq and scATACseq subsets of <a class="ae li" href="https://www.nature.com/articles/s41467-018-03149-4" rel="noopener ugc nofollow" target="_blank">scNMT</a></figcaption></figure><p id="6f92" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">因此，我们将 scBSseq 和 scATACseq 数据建模为来自<a class="ae li" href="https://en.wikipedia.org/wiki/Bernoulli_distribution" rel="noopener ugc nofollow" target="_blank"> <strong class="ll jd"> Benoulli 分布</strong> </a>。我们将通过<strong class="ll jd">将低于 50 的值编码为 0，高于 50 的值编码为 1 </strong>以及<strong class="ll jd">移除低方差特征</strong>以避免冗余，进一步使 scBSseq 和 scATACseq 数据集成为纯二进制数据集:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="ns nt l"/></div></figure><p id="3b6b" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">此外，我们将创建 MOFA 对象并设置模型参数，例如 scBSseq 和 scATACseq 的伯努利分布，以及 scRNAseq 组学的高斯分布(由于对数变换):</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="ns nt l"/></div></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nv"><img src="../Images/fafb6a90d0ddf10ecd67c122940b2a56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RqpR8fH75gyZHzIsVVBXCg.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk">MOFA provides a useful visualization of the dimensions of the data</figcaption></figure><p id="05ed" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">最后，我们将准备 MOFA 对象并运行 MOFA。事实证明，MOFA 只选择了 3 个隐藏的潜在因素(LFs ),解释了 scNMT 数据集超过 3%的变化。MOFa 的主要成果是下面的个体组学之间<strong class="ll jd">协方差的巨大可视化:</strong></p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="ns nt l"/></div></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nv"><img src="../Images/4ffa4ffa277231f0d1e32eb9160b4c26.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tuadBmBYIDeK4Q-l5QSsRw.png"/></div></div></figure><p id="9c41" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">我们可以看到，scRNAseq 对总的整合组学 scNMT 数据集贡献了最大的变异(<strong class="ll jd"> 13% </strong>)，scBSseq 和 scATACseq 贡献了约<strong class="ll jd"> 5% </strong>的变异。在 MOFA 选择的 3 个 LF 中，scRNAseq 对所有 LF 都有贡献，而第二个 LF 主要由 scBSseq 驱动，scATACseq 仅对第一个 LF 有贡献。有趣的是，<strong class="ll jd"> scRNAseq 在第一个 LF 中与 scATACseq 共变，而</strong> <strong class="ll jd"> scRNAseq 在第二个 LF 中与 scBSseq 共变</strong>。现在让我们通过显示它们的<strong class="ll jd">加载</strong>来解释 LF，即负责每个 LF 的特征，这里我们考虑 scRNAseq 和 LF1:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="ns nt l"/></div></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nw"><img src="../Images/2c8ab46f53c15968fdba628e07ca24ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Z_vK95GIKmHj3JQtEM4Pzg.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk">Visualization of MOFA loadings and heatmap demonstrating separation of ESC and EB cells</figcaption></figure><p id="684e" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">在右边的热图上，看起来加载基因在 ESC 和 EB 细胞之间提供了一个很好的分离。最后，我们将显示低维潜在空间中的<strong class="ll jd">细胞，这种嵌入是来自 scNMT 多组学数据集的 3 组学整合的结果。</strong></p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="ns nt l"/></div></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nv"><img src="../Images/9fa5bcc777db9ee46af28b5b84e68ff1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*39TO05Yt6fzBoZGLX-5skg.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk">Low-dimensional MOFA representation of scNMT cells</figcaption></figure><p id="da5d" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">我们的结论是，MOFA <strong class="ll jd">将来自 scNMT 数据集的 3 个组学</strong>投影到一个共同的潜在空间，其中技术差异被忽略，仅<strong class="ll jd">共同变异</strong>被考虑。整合方法能够成功地区分 3 种细胞类型:ESCs、EBs 和对照。</p><h1 id="2959" class="mf mg it bd mh mi mj mk ml mm mn mo mp ki mq kj mr kl ms km mt ko mu kp mv mw bi translated">摘要</h1><p id="803a" class="pw-post-body-paragraph lj lk it ll b lm mx kd lo lp my kg lr ls mz lu lv lw na ly lz ma nb mc md me im bi translated">在这篇文章中，我们了解到多组学因子分析(MOFA)是一种优雅的基于贝叶斯的组学整合算法，通过提取跨模态的共同变化轴。这对于数据探索和理解组学之间的<strong class="ll jd">相互作用特别有用。</strong>MOFA<strong class="ll jd">对缺失数据</strong>不敏感，并允许组合来自不同<strong class="ll jd">非高斯</strong>统计分布的组学。</p><p id="3ef5" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">在下面的评论中让我知道生命科学中的哪些分析对你来说似乎特别神秘，我会在这个专栏中尝试回答它们。在我的<a class="ae li" href="https://github.com/NikolayOskolkov/UnsupervisedOMICsIntegration" rel="noopener ugc nofollow" target="_blank"> github </a>上查看帖子中的代码。在 Medium <a class="nx ny ep" href="https://medium.com/u/8570b484f56c?source=post_page-----688bf8fa49bf--------------------------------" rel="noopener" target="_blank">关注我，在 Twitter @NikolayOskolkov 关注我，在 Linkedin </a>关注我。下一次我们将讨论<strong class="ll jd">如何批量更正单细胞数据</strong>，敬请关注。</p></div></div>    
</body>
</html>