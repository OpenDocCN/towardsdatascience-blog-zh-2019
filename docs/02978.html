<html>
<head>
<title>VLOOKUP and Array Formulas are Changing The Game</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">VLOOKUP 和数组公式正在改变游戏规则</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/vlookup-and-array-formulas-are-changing-the-game-789e1b233c0d?source=collection_archive---------9-----------------------#2019-05-14">https://towardsdatascience.com/vlookup-and-array-formulas-are-changing-the-game-789e1b233c0d?source=collection_archive---------9-----------------------#2019-05-14</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="2a3e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">Microsoft Excel 是现代工作场所中使用最广泛的工具之一，但也是使用最少的工具之一。我认为这应该改变，我认为应该从 VLOOKUP 开始。这就是为什么，我想花一点时间来谈谈使用 VLOOKUP 作为一个<strong class="js iu">数组公式</strong>。</p><h1 id="bf67" class="ko kp it bd kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll bi translated">什么是数组公式？</h1><p id="4a58" class="pw-post-body-paragraph jq jr it js b jt lm jv jw jx ln jz ka kb lo kd ke kf lp kh ki kj lq kl km kn im bi translated">数组公式是 Excel 的一项功能，允许您对多个值执行公式运算。这到底是什么意思？</p><p id="e0c2" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">好吧，假设我有两个数据集，我想连接在一起</p><ul class=""><li id="b1cb" class="lr ls it js b jt ju jx jy kb lt kf lu kj lv kn lw lx ly lz bi translated"><a class="ae ma" href="https://data.cityofchicago.org/Community-Economic-Development/Business-Licenses-Current-Active/uupf-x98q" rel="noopener ugc nofollow" target="_blank">芝加哥市的所有营业执照</a></li><li id="7560" class="lr ls it js b jt mb jx mc kb md kf me kj mf kn lw lx ly lz bi translated"><a class="ae ma" href="https://data.cityofchicago.org/Community-Economic-Development/Business-Owners/ezma-pppn/data" rel="noopener ugc nofollow" target="_blank">芝加哥市的所有企业主</a></li></ul><p id="96b0" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">营业执照</strong>文件有我需要的关于执照本身的所有数据，但是个人所有者的名字位于<strong class="js iu">企业所有者</strong>文件中。我不想一页一页地翻来翻去看业主的名字，所以我想把业主的名字和姓氏拉到<strong class="js iu">营业执照</strong>数据集中。为此，我将使用一个 VLOOKUP 数组公式来获取两个值，而不是一个值。</p><h1 id="e2f0" class="ko kp it bd kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll bi translated">使用 VLOOKUP</h1><p id="e0df" class="pw-post-body-paragraph jq jr it js b jt lm jv jw jx ln jz ka kb lo kd ke kf lp kh ki kj lq kl km kn im bi translated">为了将两个文件连接在一起，我需要在两个文件之间找到一个公共元素。幸运的是，我们可以在许可证和所有者文件中看到，我们有一个可以使用的帐号。</p><figure class="mh mi mj mk gt ml gh gi paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><div class="gh gi mg"><img src="../Images/1f798cd1180a37959111263b6b8497e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7NMCTanGxGDv2D7s0OwAyg.png"/></div></div><figcaption class="ms mt gj gh gi mu mv bd b be z dk">The account number is a common field between both files</figcaption></figure><h1 id="5be0" class="ko kp it bd kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll bi translated">设置</h1><p id="63bc" class="pw-post-body-paragraph jq jr it js b jt lm jv jw jx ln jz ka kb lo kd ke kf lp kh ki kj lq kl km kn im bi translated">在许可证文件中，我将在<strong class="js iu">帐号</strong>字段的右边创建两个新列。这些新列将保存我的名字和姓氏字段。</p><figure class="mh mi mj mk gt ml gh gi paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><div class="gh gi mw"><img src="../Images/c6fe0c29cbc808625d4e50e27df574d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*QyWoeklcI4cBvGM7t1wLbw.gif"/></div></div></figure><p id="2d74" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在 Excel 文件中，您可以通过右键单击并选择 insert 来创建一个新列，或者只需按 ALT+I，C</p><h1 id="e986" class="ko kp it bd kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll bi translated">连接数据</h1><p id="e95f" class="pw-post-body-paragraph jq jr it js b jt lm jv jw jx ln jz ka kb lo kd ke kf lp kh ki kj lq kl km kn im bi translated">现在我已经设置好了工作表，我将使用 VLOOKUP 作为数组公式从所有者文件中提取名字和姓氏数据。为了便于参考，我将两个文件并排打开。</p><p id="71fa" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">首先，我在许可文件中选择单元格 D2 和 E2，作为我的第一行数据将要存放的位置。</p><figure class="mh mi mj mk gt ml gh gi paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><div class="gh gi mx"><img src="../Images/d74e28c510b7ee564b1a3cd71467e495.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*u0wU9fQM9fNJMUc7qAEWYQ.gif"/></div></div><figcaption class="ms mt gj gh gi mu mv bd b be z dk">Select the cells that you will be populating</figcaption></figure><p id="a2db" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">接下来，我将开始输入我的 VLOOKUP 公式。</p><blockquote class="my mz na"><p id="9163" class="jq jr nb js b jt ju jv jw jx jy jz ka nc kc kd ke nd kg kh ki ne kk kl km kn im bi translated"><em class="it"> VLOOKUP 接受几个输入值</em></p><p id="9876" class="jq jr nb js b jt ju jv jw jx jy jz ka nc kc kd ke nd kg kh ki ne kk kl km kn im bi translated">1.查找值</p><p id="0f0a" class="jq jr nb js b jt ju jv jw jx jy jz ka nc kc kd ke nd kg kh ki ne kk kl km kn im bi translated">2.表格数组</p><p id="d1ac" class="jq jr nb js b jt ju jv jw jx jy jz ka nc kc kd ke nd kg kh ki ne kk kl km kn im bi translated">3.列索引号</p><p id="60e0" class="jq jr nb js b jt ju jv jw jx jy jz ka nc kc kd ke nd kg kh ki ne kk kl km kn im bi translated">4.范围查找</p></blockquote><p id="e8c0" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在这种情况下，我的查找值将是许可证文件中的账号或 C2。我的表数组将是所有者文件中的数据，从帐号列开始，一直到所有者姓氏列。我的列索引号将是名字和姓氏，或者是第 3 列和第 5 列。VLOOKUP 通常只接受一个值，但是因为我们使用的是数组公式，所以我们可以给它多个值，把它们放在括号中— {3，5}。只要我们有两个字段用于填充数据(D2 和 E2)，公式就会正确返回值。在这种情况下，它会将名字返回给 D2，将姓氏返回给 E2。</p><p id="eb59" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">因为这是一个数组公式，所以我需要按 CTRL+SHIFT+enter，而不是在公式末尾按 ENTER。这将把我的整个公式用括号括起来，让 Excel 知道这是一个数组公式。</p><figure class="mh mi mj mk gt ml gh gi paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><div class="gh gi nf"><img src="../Images/aab75e725d313cb24c49f3b195586f9c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*pJYPNce-ClpF1J3rIayCAw.gif"/></div></div></figure><h1 id="daab" class="ko kp it bd kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll bi translated">收尾工作</h1><p id="1151" class="pw-post-body-paragraph jq jr it js b jt lm jv jw jx ln jz ka kb lo kd ke kf lp kh ki kj lq kl km kn im bi translated">这样做之后，我可以将公式应用到电子表格的其余部分。最后，我复制所有内容并作为值粘贴，以便将数据完全复制到许可证文件中。</p><figure class="mh mi mj mk gt ml gh gi paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><div class="gh gi mw"><img src="../Images/d76ac95e88eb7316f9ef4091979ba0ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*rRG__FVKGHN2oHgyvEa7Lw.gif"/></div></div></figure><h1 id="628d" class="ko kp it bd kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll bi translated">结论</h1><p id="7343" class="pw-post-body-paragraph jq jr it js b jt lm jv jw jx ln jz ka kb lo kd ke kf lp kh ki kj lq kl km kn im bi translated">Microsoft Excel 是一个多功能工具，当您不太需要完整的关系数据库设置时，它可以帮助您进行快速数据操作。</p><p id="1c28" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">你在用 Excel 解决什么问题？Excel 的不足在哪里？我很乐意继续这个话题。如有任何反馈，请通过<a class="ae ma" href="https://twitter.com/onlymattjohnson" rel="noopener ugc nofollow" target="_blank">推特</a>联系我！</p></div></div>    
</body>
</html>