<html>
<head>
<title>Evaluating A Real-Life Recommender System, Error-Based and Ranking-Based</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">基于错误和基于排名的真实推荐系统评估</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/evaluating-a-real-life-recommender-system-error-based-and-ranking-based-84708e3285b?source=collection_archive---------6-----------------------#2019-01-16">https://towardsdatascience.com/evaluating-a-real-life-recommender-system-error-based-and-ranking-based-84708e3285b?source=collection_archive---------6-----------------------#2019-01-16</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="ip iq gp gr ir is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/769c96ec0247d7d2b0544f215bc9694e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lk2aUoJ_uT41H7h0sSnSZg.jpeg"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Photo credit: Pixabay</figcaption></figure><div class=""/><div class=""><h2 id="878c" class="pw-subtitle-paragraph kc je jf bd b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt dk translated">推荐系统旨在根据用户的偏好发现并推荐用户可能感兴趣的项目</h2></div><p id="eb20" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">推荐系统是当今机器学习中最有价值的应用之一。亚马逊将其 35%的收入归功于其推荐系统。</p><p id="afc8" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">评估是研究和开发任何推荐系统不可或缺的一部分。根据你的业务和可用的数据，有很多方法可以评估一个推荐系统。今天我们将尝试几个。</p><h1 id="c639" class="lr ls jf bd lt lu lv lw lx ly lz ma mb kl mc km md ko me kp mf kr mg ks mh mi bi translated">评级预测</h1><p id="b58e" class="pw-post-body-paragraph ku kv jf kw b kx mj kg kz la mk kj lc ld ml lf lg lh mm lj lk ll mn ln lo lp ij bi translated">在我的上一篇帖子 re: <a class="ae lq" rel="noopener" target="_blank" href="/building-and-testing-recommender-systems-with-surprise-step-by-step-d4ba702ef80b">构建和测试带惊喜的推荐系统</a>中，惊喜围绕着各种机器学习算法来预测用户对项目的评分(即评分预测)。它要求用户给予<strong class="kw jg"> <em class="mo">明确的</em> </strong>反馈，比如要求用户在购买后给一本书打 0 到 10 颗星的分数。然后我们用这些数据来建立用户的兴趣档案。这样做的问题是，不是每个人都愿意留下评级，所以数据往往是稀疏的，就像我们之前看到的这个<a class="ae lq" href="http://www2.informatik.uni-freiburg.de/~cziegler/BX/" rel="noopener ugc nofollow" target="_blank">图书穿越数据集</a>:</p><figure class="mq mr ms mt gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mp"><img src="../Images/fdc4ba4ded5c8169b7efb2c6add654cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*On-2-JAKmSzMZCX0FC8Aug.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Figure 1</figcaption></figure><p id="3fee" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">大多数推荐系统试图预测如果用户对相应的书籍进行评级，他们会在其中放入什么。如果有太多的“南”，推荐者就没有足够的数据来理解用户喜欢什么。</p><p id="b880" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">然而，<strong class="kw jg"> <em class="mo">显性</em> </strong>评级是伟大的，如果你能说服你的用户给你评级。所以，如果你有奢侈的数据和用户评分，那么评价指标应该是<strong class="kw jg"><em class="mo"/></strong>或者<strong class="kw jg"> <em class="mo"> MAE </em> </strong>。让我们展示一个带有惊奇库的 Movielens 数据集的例子。</p><figure class="mq mr ms mt gt is"><div class="bz fp l di"><div class="mu mv l"/></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">ratings_prediction.py</figcaption></figure><figure class="mq mr ms mt gt is gh gi paragraph-image"><div class="gh gi mw"><img src="../Images/02dd35c90b1e6d30cb7cb09594198329.png" data-original-src="https://miro.medium.com/v2/resize:fit:724/format:webp/1*ByDP9YkGSgVUCuAMTI_Q6g.png"/></div></figure><h1 id="be59" class="lr ls jf bd lt lu lv lw lx ly lz ma mb kl mc km md ko me kp mf kr mg ks mh mi bi translated">顶级的</h1><p id="e310" class="pw-post-body-paragraph ku kv jf kw b kx mj kg kz la mk kj lc ld ml lf lg lh mm lj lk ll mn ln lo lp ij bi translated">从在线购物网站到视频门户网站，前 N 名推荐系统无处不在。它们向用户提供他们可能感兴趣的 N 个项目的排序列表，以鼓励浏览和购买。</p><p id="90e5" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">亚马逊的推荐系统之一是“前 N 名”系统，它向个人提供一个顶级结果列表，如下所示:</p><figure class="mq mr ms mt gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mx"><img src="../Images/a6e6baec8a7c03ec0764b83e14764266.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MiIWUfaucIpIzq7X8LMd7Q.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Figure 2</figcaption></figure><p id="f630" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">亚马逊给我的“前 N 名”推荐包括 9 页，第一页有 6 个项目。一个好的推荐系统应该能够识别某个用户感兴趣的一组 N 个项目。因为我很少在亚马逊买书，我的“Top-N”差得很远。换句话说，我可能只会点击或阅读我的“前 N 名”列表中的一本书。</p><p id="1f90" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">以下脚本为测试集中的每个用户产生了前 10 个推荐。</p><figure class="mq mr ms mt gt is"><div class="bz fp l di"><div class="mu mv l"/></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">top-N.py</figcaption></figure><p id="98ba" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">下面是我们预测的用户 Id 2 和用户 Id 3 的前 10 名。</p><figure class="mq mr ms mt gt is gh gi paragraph-image"><div class="gh gi my"><img src="../Images/8fc83b48f75bbfa50837618869f98287.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/format:webp/1*WewlfoNEvBpPL2GlsTZmiw.png"/></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Figure 3</figcaption></figure><h2 id="18e6" class="mz ls jf bd lt na nb dn lx nc nd dp mb ld ne nf md lh ng nh mf ll ni nj mh nk bi translated">命中率</h2><p id="29b6" class="pw-post-body-paragraph ku kv jf kw b kx mj kg kz la mk kj lc ld ml lf lg lh mm lj lk ll mn ln lo lp ij bi translated">让我们看看我们的 10 大推荐有多好。为了评估 top-10，我们使用命中率，也就是说，如果用户对我们推荐的前 10 名中的一个进行了评级，我们就认为它是“命中”。</p><p id="cc82" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">计算单个用户命中率的过程:</p><ul class=""><li id="61bf" class="nl nm jf kw b kx ky la lb ld nn lh no ll np lp nq nr ns nt bi translated">在培训数据中查找该用户历史记录中的所有项目。</li><li id="dd65" class="nl nm jf kw b kx nu la nv ld nw lh nx ll ny lp nq nr ns nt bi translated">有意删除其中一项(留一项交叉验证)。</li><li id="1bb2" class="nl nm jf kw b kx nu la nv ld nw lh nx ll ny lp nq nr ns nt bi translated">使用所有其他项目来为推荐者提供信息，并要求提供前 10 项推荐。</li><li id="e210" class="nl nm jf kw b kx nu la nv ld nw lh nx ll ny lp nq nr ns nt bi translated">如果被删除的项目出现在前 10 个推荐中，那么它就是成功的。如果没有，那就不算成功。</li></ul><figure class="mq mr ms mt gt is"><div class="bz fp l di"><div class="mu mv l"/></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">HitRate.py</figcaption></figure><figure class="mq mr ms mt gt is gh gi paragraph-image"><div class="gh gi nz"><img src="../Images/644eda1d437ab4c53be234f79c5c3aee.png" data-original-src="https://miro.medium.com/v2/resize:fit:990/format:webp/1*Z0RnWL3z9pDcxIflyA9ZVg.png"/></div></figure><p id="aaac" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">系统的整体命中率是命中数除以测试用户数。它衡量我们能够推荐删除评级的频率，越高越好。</p><p id="e80f" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">非常低的命中率仅仅意味着我们没有足够的数据来处理。就像亚马逊的点击率对我来说会非常低，因为它没有足够的我的图书购买数据。</p><h2 id="a1da" class="mz ls jf bd lt na nb dn lx nc nd dp mb ld ne nf md lh ng nh mf ll ni nj mh nk bi translated">按评级值列出的命中率</h2><p id="4add" class="pw-post-body-paragraph ku kv jf kw b kx mj kg kz la mk kj lc ld ml lf lg lh mm lj lk ll mn ln lo lp ij bi translated">我们也可以通过预测的评分值来分解命中率。理想情况下，我们希望预测用户喜欢的电影，所以我们关心高评分值而不是低评分值。</p><figure class="mq mr ms mt gt is"><div class="bz fp l di"><div class="mu mv l"/></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">RatingHitRate.py</figcaption></figure><figure class="mq mr ms mt gt is gh gi paragraph-image"><div class="gh gi oa"><img src="../Images/6a325dca0c6280dbdd2c6fd77deb545a.png" data-original-src="https://miro.medium.com/v2/resize:fit:740/format:webp/1*UCLrgZe_5pmQl18eBpF1UA.png"/></div></figure><p id="c87e" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">我们的命中率细分正是我所希望的，评分 5 的命中率远远高于 4 或 3。越高越好。</p><h2 id="1ea0" class="mz ls jf bd lt na nb dn lx nc nd dp mb ld ne nf md lh ng nh mf ll ni nj mh nk bi translated">累积命中率</h2><p id="90bb" class="pw-post-body-paragraph ku kv jf kw b kx mj kg kz la mk kj lc ld ml lf lg lh mm lj lk ll mn ln lo lp ij bi translated">因为我们关心更高的评级，所以我们可以忽略低于 4 的预测评级，以计算&gt; = 4 的评级的命中率。</p><figure class="mq mr ms mt gt is"><div class="bz fp l di"><div class="mu mv l"/></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">CumulativeHitRate.py</figcaption></figure><figure class="mq mr ms mt gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ob"><img src="../Images/cd08efe801aae9e2cecbb31e0c2cbe43.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LsXoXR9noO6EXkboHMe4JQ.png"/></div></div></figure><p id="bbde" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">越高越好。</p><h2 id="e796" class="mz ls jf bd lt na nb dn lx nc nd dp mb ld ne nf md lh ng nh mf ll ni nj mh nk bi translated">平均交互点击排名</h2><p id="4af7" class="pw-post-body-paragraph ku kv jf kw b kx mj kg kz la mk kj lc ld ml lf lg lh mm lj lk ll mn ln lo lp ij bi translated">前 N 名推荐系统排名评估的常用指标，仅考虑第一个相关结果出现的位置。我们会因为推荐一个用户排名靠前而不是靠后的项目而得到更多的信任。越高越好。</p><figure class="mq mr ms mt gt is"><div class="bz fp l di"><div class="mu mv l"/></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">AverageReciprocalHitRank.py</figcaption></figure><figure class="mq mr ms mt gt is gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/c552f37882330c47ba13ab02b1cf9305.png" data-original-src="https://miro.medium.com/v2/resize:fit:1362/format:webp/1*QVSPTzGDre9ro5iX-0xQLA.png"/></div></figure><p id="6ecd" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">你的第一个现实生活中的推荐系统很可能是低质量的，你为新用户准备的成熟的推荐系统也是如此。但是，这仍然比没有推荐系统好得多。推荐系统的目标之一是我们在推荐系统中学习用户/新用户的偏好，以便他们可以开始从系统接收准确的个性化推荐。</p><p id="6243" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">然而，如果你刚刚起步，你的网站是全新的，推荐系统不能为任何人提供个性化的推荐，没有任何人的任何评价。然后，这就变成了一个<a class="ae lq" href="https://www.kdd.org/exploration_files/WebKDD08-Al-Rashid.pdf" rel="noopener ugc nofollow" target="_blank">系统性的自举问题</a>。</p><p id="f1f7" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">Jupyter 笔记本可以在<a class="ae lq" href="https://github.com/susanli2016/Machine-Learning-with-Python/blob/master/Movielens%20Recommender%20Metrics.ipynb" rel="noopener ugc nofollow" target="_blank"> Github </a>上找到。享受这周剩下的时光。</p><p id="7033" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">参考:<a class="ae lq" href="https://learning.oreilly.com/videos/building-recommender-systems/9781789803273" rel="noopener ugc nofollow" target="_blank">用机器学习和人工智能构建推荐系统</a></p></div></div>    
</body>
</html>