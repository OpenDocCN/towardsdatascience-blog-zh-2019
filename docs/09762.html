<html>
<head>
<title>Learn SQL By Using Excel As A Bridge</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">以 Excel 为桥梁学习 SQL</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/learn-sql-by-using-excel-as-a-bridge-30cea4d314e0?source=collection_archive---------14-----------------------#2019-12-22">https://towardsdatascience.com/learn-sql-by-using-excel-as-a-bridge-30cea4d314e0?source=collection_archive---------14-----------------------#2019-12-22</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="57d6" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">比你想象的要容易得多的转变</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/e2d9ab3610356da5a88c724337fcd61a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*9DBUi3CDwt89MQ-F"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Photo by <a class="ae ky" href="https://unsplash.com/@mbaumi?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Mika Baumeister</a> on <a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="0806" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">作为一名前会计师转行的分析师，微软 Excel 一直是，并且直到今天仍然是我最喜欢的工具之一。我曾经傻到以为在未来的某一天，Excel 会被认为是无关紧要的。事实是，相反的事情正在发生。总的来说，Excel 和电子表格比以往任何时候都更加重要。</p><p id="0b38" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我经常遇到需要一些基本分析和/或报告的人。他们完全在 Excel 中处理这个问题。</p><p id="b701" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">问题是，当数据存在于数据库中时，大多数情况下，必须使用数据进行分析或报告的人与知道如何提取数据的人是不同的。这给每个公司都带来了一个问题，因为公司的分析师数量有限，必须不断地切换环境。</p><p id="fcd9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这就产生了对非数据分析师职位的员工的需求，他们需要了解基本的查询和数据库的基础知识。</p><p id="c4b8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">主要的问题是很多人不知道从哪里以及如何开始。</p><p id="140d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">幸运的是，作为一个经历了从电子表格到数据库的旅程的人，我可以并且想要成为你的向导。现实地说，电子表格和数据库是一样的东西，但是我们只需要学习一种新的简单的语言来浏览它们。</p><h1 id="8170" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">Excel 和数据库基础</h1><h2 id="a50a" class="mn lw it bd lx mo mp dn mb mq mr dp mf li ms mt mh lm mu mv mj lq mw mx ml my bi translated">擅长</h2><p id="01ef" class="pw-post-body-paragraph kz la it lb b lc mz ju le lf na jx lh li nb lk ll lm nc lo lp lq nd ls lt lu im bi translated">我有一个 Excel 工作簿，我将用它作为我解释的基础。在本工作簿中，我有多个工作表，其外观和功能就像您的 web 浏览器中的选项卡。这些表中的每一个都存储不同的数据。</p><p id="0fc0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我将使用的工作簿包含我的水果店的运营数据。如您所见，有客户、项目和 purchase_log 的表。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/5cefe7c9f5bfddfee4577967124f577d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1108/format:webp/1*8RavJoejekUC3lyeFyDDaA.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">A preview of my fruit store’s data tables</figcaption></figure><p id="541c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这些选项卡都包含尚未格式化的原始数据。数据被组织成每个字段的列和每个记录的行。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/3ba9d26162ad7116bf244474c94b6809.png" data-original-src="https://miro.medium.com/v2/resize:fit:814/format:webp/1*qrevz5fM3-6RCLVFZt989w.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">customers table</figcaption></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/1347c5686d460a949e0dbd3bbd70390a.png" data-original-src="https://miro.medium.com/v2/resize:fit:596/format:webp/1*SMCM0kmx1_TYiOMBX8MX3A.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">fruits available for sale</figcaption></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nh"><img src="../Images/829e760ce556e9d0da86118527385c8e.png" data-original-src="https://miro.medium.com/v2/resize:fit:838/format:webp/1*x5SZ7jB6GVYvtQsavceDNA.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">a list of transactions that happened in my store</figcaption></figure><p id="8e6e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如您所见，该表由 id 组成，后面是其他详细信息。传统上，在 Excel 中，如果我想将更多的商品和客户信息附加到购买日志中，我会使用索引匹配或 vlookup 来实现，如下所示。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ni"><img src="../Images/ea6981725a55f87df3492fa77db7626b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1ttA65IyaGbWuF2TQWX9OA.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">using index match to combine data from different tables</figcaption></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nj"><img src="../Images/c0e09846a78973bf38cbd6a5e76441b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_3bvLVHHDlMViEWruVDTXQ.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">combining first and last name fields into a full name in the purchase log table</figcaption></figure><p id="1a79" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这就是我们要做的——在我们的电子表格数据库中组合来自不同表格的信息非常简单。我们现在的分析可能非常危险。</p><h2 id="e1c2" class="mn lw it bd lx mo mp dn mb mq mr dp mf li ms mt mh lm mu mv mj lq mw mx ml my bi translated">让我们在 SQL 中做同样的事情</h2><p id="1780" class="pw-post-body-paragraph kz la it lb b lc mz ju le lf na jx lh li nb lk ll lm nc lo lp lq nd ls lt lu im bi translated">在 Excel 中，我们有工作簿，其中有工作表。在数据库中，我们可以称工作簿为模式，称工作表为表格。他们以同样的方式工作。这些表还包含格式完全相同的信息——表格形式，字段作为列，行作为记录。</p><p id="5f90" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在的区别是，我们只需编写快速查询，而不是点击一下按钮就能获得数据。</p><p id="a7f9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们现在有一个包含 3 个表的模式:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/a06337aa2cfbfbd128cf48a6b8deb07f.png" data-original-src="https://miro.medium.com/v2/resize:fit:628/format:webp/1*2VyJ2LtX4A1irSi53pk-yw.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">using sqlfiddle.com</figcaption></figure><p id="bce7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果我们想查看每个表中的所有数据，我们只需编写以下代码:</p><pre class="kj kk kl km gt nl nm nn no aw np bi"><span id="db70" class="mn lw it nm b gy nq nr l ns nt">select * from customers</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/cd49e82d45756e812b8c7110b0091d60.png" data-original-src="https://miro.medium.com/v2/resize:fit:744/format:webp/1*qTXqMotwSEyJEP5ZPn9wKA.png"/></div></figure><p id="ca64" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">或者，如果我们想从项目表中选择:</p><pre class="kj kk kl km gt nl nm nn no aw np bi"><span id="690a" class="mn lw it nm b gy nq nr l ns nt">select * from items</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/5aca72d25b5c316f6a6e0a4aeb9ae793.png" data-original-src="https://miro.medium.com/v2/resize:fit:706/format:webp/1*jnvQLl66o7CiG0-v3j5YLg.png"/></div></figure><p id="b131" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">或购买日志:</p><pre class="kj kk kl km gt nl nm nn no aw np bi"><span id="02cb" class="mn lw it nm b gy nq nr l ns nt">select * from purchase_log</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/14961e959968d5ba296fd79a93517ce3.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*n1_mT3QUzi_XVi-keQ2p5Q.png"/></div></figure><p id="1579" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果我们想创建购买日志，记录客户的全名以及他们购买的水果的名称，比如</p><pre class="kj kk kl km gt nl nm nn no aw np bi"><span id="a8d4" class="mn lw it nm b gy nq nr l ns nt">select purchase_log.id, time, concat(firstname,' ' ,lastname) as 'customer full name', item as fruit<br/>from purchase_log<br/>inner join customers on purchase_log.customer_id = customers.id<br/>inner join items on purchase_log.item_id = items.id<br/>order by id asc</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/ed01a9b93839dd6ea0b09e1114ea905a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1126/format:webp/1*EIjAyf6AkjK4ATpIKwXgXQ.png"/></div></figure><h1 id="a3eb" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">SQL 语法的简单分解</h1><p id="0dd4" class="pw-post-body-paragraph kz la it lb b lc mz ju le lf na jx lh li nb lk ll lm nc lo lp lq nd ls lt lu im bi translated">SQL 非常深入，我们有很多方法可以调整查询，但是我上面给你展示的已经排除了大部分。</p><p id="0640" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">阅读我之前写的查询非常容易。<strong class="lb iu"> Select </strong>表示选择，<strong class="lb iu"> * </strong>表示所有字段，【T4 from】表示我要选择所有的表。</p><p id="c1f9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">例如，我想从 customers 表中选择所有字段/列，所以我要写:</p><pre class="kj kk kl km gt nl nm nn no aw np bi"><span id="beb6" class="mn lw it nm b gy nq nr l ns nt"><strong class="nm iu">select</strong> * <strong class="nm iu">from</strong> <strong class="nm iu">customers</strong></span></pre><p id="711e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在上面的最后一个表中，我将其他表中的数据拖到购买日志中，并重命名了这些字段。该查询比使用“全选”来查看表稍微复杂一些。不用担心，我会用一种容易理解的方式来分解它。</p><p id="3cff" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们的疑问:</p><pre class="kj kk kl km gt nl nm nn no aw np bi"><span id="aac2" class="mn lw it nm b gy nq nr l ns nt"><strong class="nm iu">select</strong> purchase_log.id, time, <strong class="nm iu">concat</strong>(firstname,' ' ,lastname) <strong class="nm iu">as</strong> 'customer full name', item <strong class="nm iu">as</strong> fruit<br/><strong class="nm iu">from</strong> purchase_log<br/><strong class="nm iu">inner join</strong> customers <strong class="nm iu">on</strong> purchase_log.customer_id = customers.id<br/><strong class="nm iu">inner join</strong> items <strong class="nm iu">on</strong> purchase_log.item_id = items.id<br/><strong class="nm iu">order by</strong> id <strong class="nm iu">asc</strong></span></pre><ul class=""><li id="58fb" class="ny nz it lb b lc ld lf lg li oa lm ob lq oc lu od oe of og bi translated">我们有一个<strong class="lb iu"> select </strong>子句，和以前一样，但是这次增加了一些晦涩难懂的内容。</li><li id="38e0" class="ny nz it lb b lc oh lf oi li oj lm ok lq ol lu od oe of og bi translated">有一个<strong class="lb iu"> from </strong>子句，保持不变。</li><li id="4f61" class="ny nz it lb b lc oh lf oi li oj lm ok lq ol lu od oe of og bi translated">两个<strong class="lb iu">内连接</strong>子句和一个<strong class="lb iu"> order by。</strong>嗯？</li></ul><h2 id="1386" class="mn lw it bd lx mo mp dn mb mq mr dp mf li ms mt mh lm mu mv mj lq mw mx ml my bi translated">[表格]。[字段]</h2><p id="26e3" class="pw-post-body-paragraph kz la it lb b lc mz ju le lf na jx lh li nb lk ll lm nc lo lp lq nd ls lt lu im bi translated">在我们之前的查询中，因为我们使用了*，所以我们只是选择了所有的字段。如果我们的查询被隔离到一个表中，我们可以通过写出并使用逗号分隔来选择我们想要的字段。</p><pre class="kj kk kl km gt nl nm nn no aw np bi"><span id="500f" class="mn lw it nm b gy nq nr l ns nt">select item, price from items</span></pre><p id="5c3d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这将只给我们一个包含商品及其价格的表，没有它们的 id。</p><p id="df84" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是，该查询从不同的表中提取数据，有时该表中的字段被命名为相同的名称，例如“id”。因此我们必须指定<em class="om">哪个</em> id 是我们想要的。</p><pre class="kj kk kl km gt nl nm nn no aw np bi"><span id="c6d8" class="mn lw it nm b gy nq nr l ns nt">purchase_log.id, customer.id, purchase_log.customer_id</span></pre><p id="6266" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">以上内容如下—</p><p id="bc2f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu"> id </strong>字段来自<strong class="lb iu"> purchase_log </strong>表，</p><p id="d439" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu"> id </strong>字段来自<strong class="lb iu">客户</strong>表，</p><p id="d46e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">客户 id </strong>字段来自<strong class="lb iu">购买日志</strong>表</p><h2 id="ab07" class="mn lw it bd lx mo mp dn mb mq mr dp mf li ms mt mh lm mu mv mj lq mw mx ml my bi translated">内部连接是索引匹配中的匹配</h2><p id="0177" class="pw-post-body-paragraph kz la it lb b lc mz ju le lf na jx lh li nb lk ll lm nc lo lp lq nd ls lt lu im bi translated">这允许我们使用具有匹配值的列将两个不同的表粘合在一起。</p><pre class="kj kk kl km gt nl nm nn no aw np bi"><span id="3e65" class="mn lw it nm b gy nq nr l ns nt"><strong class="nm iu">inner join</strong> customers <strong class="nm iu">on</strong> purchase_log.customer_id = customers.id</span></pre><p id="a1ce" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">用简单的英语解释:我想在我的当前表(<strong class="lb iu"> purchase_log </strong>)中使用来自<strong class="lb iu"> customers </strong>表的数据，我可以这样做，因为这个表中的<strong class="lb iu"> customer_id </strong>存在于 customers 表中的<strong class="lb iu"> id </strong>中。</p><p id="fa0e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您希望从连接表中使用的实际数据将被添加到 select 语句中。</p><p id="9526" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">有了它，您就可以从数据库中取出任何想要的东西，并保存到一个表中。</p><h2 id="ca99" class="mn lw it bd lx mo mp dn mb mq mr dp mf li ms mt mh lm mu mv mj lq mw mx ml my bi translated">在表格内进行调整</h2><p id="9928" class="pw-post-body-paragraph kz la it lb b lc mz ju le lf na jx lh li nb lk ll lm nc lo lp lq nd ls lt lu im bi translated">我的查询中包含的常用语句和函数，用于修改标记数据的方式:</p><ul class=""><li id="ad81" class="ny nz it lb b lc ld lf lg li oa lm ob lq oc lu od oe of og bi translated"><strong class="lb iu"> order by </strong>是它自己的语句，相当于 excel 中的排序。<br/> <strong class="lb iu"> order by </strong>【字段】<strong class="lb iu"/>=排序 Z 到 A <br/> <strong class="lb iu"> order by </strong>【字段】<strong class="lb iu"> asc </strong> =排序 A 到 Z</li><li id="7166" class="ny nz it lb b lc oh lf oi li oj lm ok lq ol lu od oe of og bi translated"><strong class="lb iu"> as </strong>是一种将列命名为其他名称的简单方法。<br/>选择【字段】<strong class="lb iu">作为</strong>【您想要给出的名称】</li><li id="8110" class="ny nz it lb b lc oh lf oi li oj lm ok lq ol lu od oe of og bi translated"><strong class="lb iu"> concat </strong>与 excel 中的 concat()功能相同。如果想在 select 语句中组合多个列，只需编写:<br/><strong class="lb iu">select concat</strong>([字段]，[i]，[want]，[组合]) <strong class="lb iu">作为</strong>[名称]</li></ul></div><div class="ab cl on oo hx op" role="separator"><span class="oq bw bk or os ot"/><span class="oq bw bk or os ot"/><span class="oq bw bk or os"/></div><div class="im in io ip iq"><p id="53ba" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们找到了。现在，您可以从数据库中随意提取数据，并对其标注方式进行修改！</p><p id="4ce8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">虽然我是 Excel 的忠实粉丝，因为它帮助我度过了早期的职业生涯，但从那以后，我的工具库中增加了很多东西。SQL 的“兔子洞”要深入得多，我希望这篇介绍能激发您去探索它。</p></div></div>    
</body>
</html>