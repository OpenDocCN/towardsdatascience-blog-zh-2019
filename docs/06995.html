<html>
<head>
<title>Avengers, resemble!</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">复仇者联盟，类似！</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/avengers-resemble-3549d60ae015?source=collection_archive---------22-----------------------#2019-10-03">https://towardsdatascience.com/avengers-resemble-3549d60ae015?source=collection_archive---------22-----------------------#2019-10-03</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="b041" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">通过面部识别找到理想的服装</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/18e243befa1fc2e29f494924b3da8ebb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ecGcKFDYgYs696oz3nYBew.jpeg"/></div></div></figure><p id="0e91" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">计算机视觉更有趣和更专业的用途之一是面部检测和识别。人类非常擅长识别人脸，但最近的趋势是，我们已经能够训练计算机做足够接近的工作，以保证在更多的应用中使用它。面部扭曲、老化，并向各个方向摆姿势，这给如何在多张图像中匹配它们带来了重大挑战。深度学习的进步，如<a class="ae lq" href="https://arxiv.org/pdf/1503.03832.pdf" rel="noopener ugc nofollow" target="_blank"> FaceNet </a>研究，真正改变了游戏，使这些过程更容易执行，结果令人难以置信地准确。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lr"><img src="../Images/a7dc522eab694388a2bc83f50cbf34ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*fl9iQ4bhoS_YAiP0zrqmGQ.gif"/></div></div><figcaption class="ls lt gj gh gi lu lv bd b be z dk">Don’t look away from the Nozzle!</figcaption></figure><p id="40fb" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">如果你害怕向计算机教授这样的技能意味着什么，我理解这种情绪。面部识别有许多积极的方面。举几个例子来说明它是如何非常有帮助的:在不断增长的数字世界中增加安全功能，<a class="ae lq" href="https://www.independent.co.uk/life-style/gadgets-and-tech/news/india-police-missing-children-facial-recognition-tech-trace-find-reunite-a8320406.html" rel="noopener ugc nofollow" target="_blank">帮助寻找失踪人员</a>，<a class="ae lq" href="https://www.fastcompany.com/3050622/a-new-facial-recognition-mobile-app-from-listerine-helps-blind-people-see-smiles" rel="noopener ugc nofollow" target="_blank">帮助盲人在世界中导航</a>，以及(潜在的)帮助建立更好的工具来打击犯罪。然而，隐私仍然是这项技术的主要关注点。作为一个社会，对于我们的形象被拍摄并用于某种分类目的，我们有什么样的舒适度？为了安全起见，在个人设备上可能感觉还可以，但是当你在外面的世界中得到有针对性的广告呢？这确实是一件棘手的事情，但是当我们继续研究它的时候，记住这一点很重要:</p><blockquote class="lw lx ly"><p id="d75b" class="ku kv lz kw b kx ky ju kz la lb jx lc ma le lf lg mb li lj lk mc lm ln lo lp im bi translated">“权力越大，责任越大”</p><p id="b469" class="ku kv lz kw b kx ky ju kz la lb jx lc ma le lf lg mb li lj lk mc lm ln lo lp im bi translated">u̶n̶c̶l̶e̶̶b̶e̶n̶̶f̶r̶o̶m̶̶s̶p̶i̶d̶e̶r̶-̶m̶a̶n̶.我，谈论面部识别</p></blockquote><h2 id="a62f" class="md me it bd mf mg mh dn mi mj mk dp ml ld mm mn mo lh mp mq mr ll ms mt mu mv bi translated">看起来像个英雄</h2><p id="cb1e" class="pw-post-body-paragraph ku kv it kw b kx mw ju kz la mx jx lc ld my lf lg lh mz lj lk ll na ln lo lp im bi translated">这让我想到了一个使用面部识别的快速项目，希望能展示这项技术的创造性应用。</p><p id="6a4e" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">问题:快到万圣节了！你在一家服装公司工作，他们想为顾客提供一种有趣的互动方式，让他们找到最适合自己的服装。如果你使用面部识别来找到他们最像哪个演员，并根据这种匹配推荐服装，会怎么样？听起来像个计划。今年是复仇者联盟电影的重要一年，所以让我们用这些演员和他们相关的角色来创造一个复仇者联盟！</p><p id="9f8c" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">有一些很好的工具可以用于人脸检测和识别(<a class="ae lq" href="https://opencv.org/" rel="noopener ugc nofollow" target="_blank">比如 OpenCV </a>)，但是我将使用 Python 库<a class="ae lq" href="https://github.com/ageitgey/face_recognition" rel="noopener ugc nofollow" target="_blank"> face_recognition </a>进行演示。这是一个真正快速准确的包，使用<a class="ae lq" href="http://dlib.net/" rel="noopener ugc nofollow" target="_blank"> dlib </a>的人脸识别构建，取得了一些令人印象深刻的结果(在“野生标签人脸”基准上的准确率为 99.38%)。检测图像中的人脸(查找并返回边界框位置)并获取人脸编码(人脸的矢量表示)就像三行代码一样简单:</p><pre class="kj kk kl km gt nb nc nd ne aw nf bi"><span id="413d" class="md me it nc b gy ng nh l ni nj">import face_recognition</span><span id="e851" class="md me it nc b gy nk nh l ni nj">loaded_image = face_recognition.load_image_file('young_rdj.jpg')<br/>face_location = face_recognition.face_locations(loaded_image)<br/>face_encoding = face_recognition.face_encodings(loaded_image)[0]</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nl"><img src="../Images/6da43ad1d979085809533738959e6c10.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jhKJCX8HQJr3Vgsop4hXzQ.png"/></div></div></figure><p id="d4f3" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">厉害！只用了几行代码，我们就找到了这张脸，并将其转换成一个数字向量表示，我们可以用它来与其他图像进行比较。虽然大多数面部识别都在寻找真正的匹配(例如照片应用程序标记一张脸，并在所有其他图像中找到那个人，你的手机匹配用户的脸以允许访问)，我正在做的是寻找最好的“足够近”。以下是我为让我的复仇者联盟更相似而创建的一般工作流程和功能:</p><ol class=""><li id="b9e3" class="nm nn it kw b kx ky la lb ld no lh np ll nq lp nr ns nt nu bi translated">下载复仇者联盟电影中每个演员的照片。我坚持以大家伙为主，甚至加入了几个 x 战警，因为漫画经典中有些也是复仇者。没有花哨的代码，只是大量的手动谷歌搜索和寻找良好的干净的图像。</li><li id="da55" class="nm nn it kw b kx nv la nw ld nx lh ny ll nz lp nr ns nt nu bi translated">为图像编码过程创建一个函数，这样我就可以一次加载所有图像，并使用 list comprehension 来执行任务:</li></ol><pre class="kj kk kl km gt nb nc nd ne aw nf bi"><span id="5af7" class="md me it nc b gy ng nh l ni nj">def image_to_encodings(file):<br/>    """Return the face encodings from an image"""<br/>    load_image = face_recognition.load_image_file(file)<br/>    return face_recognition.face_encodings(load_image)[0]</span></pre><p id="97a1" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">3.通过我的函数运行所有图像，并创建一个新的字典，该字典包含角色名称及其带有面部编码的数组:</p><pre class="kj kk kl km gt nb nc nd ne aw nf bi"><span id="04d7" class="md me it nc b gy ng nh l ni nj"># Glob makes it easy to capture all jpgs filenames into a list<br/>avengers_cast_files = glob.glob('avengers/*.jpg')</span><span id="35e5" class="md me it nc b gy nk nh l ni nj"># Getting character name from the file name<br/>avengers_cast_names = [re.sub('.jpg|avengers/', '', image)<br/>                           for image in avengers_cast_files]</span><span id="bd32" class="md me it nc b gy nk nh l ni nj"># Getting encodings<br/>avengers_cast_encodings = [image_to_encodings(image)<br/>                              for image in avengers_cast_files]</span><span id="e484" class="md me it nc b gy nk nh l ni nj"># Creating dictionary with these new details<br/>avengers_dictionary = {name: encoding for name, encoding <br/>                       in zip(avengers_cast_names, <br/>                              avengers_cast_encodings)}</span></pre><p id="6503" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">4.酸洗我的编码字典。这使得我以后可以轻松打开它，而不必对我的已知面孔重新运行 face_recognition:</p><pre class="kj kk kl km gt nb nc nd ne aw nf bi"><span id="61e8" class="md me it nc b gy ng nh l ni nj">outfile = open('avengers_features.pkl','wb')<br/>pickle.dump(avengers_dictionary,outfile)<br/>outfile.close()</span></pre><p id="f4aa" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">5.创建一个函数，根据已知的编码返回图像的最佳匹配:</p><pre class="kj kk kl km gt nb nc nd ne aw nf bi"><span id="6bc7" class="md me it nc b gy ng nh l ni nj">def top_match(known_encodings, known_names, new_image_embed):<br/>    """With list of known image names/encodings, <br/>        return closest match"""<br/>    distances = face_recognition.face_distance(known_encodings, <br/>                                               new_image_embed)<br/>    top = np.argmin(distances)<br/>    return known_names[top]</span></pre><p id="9e20" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">6.测试添加新图像并查看最接近的匹配:</p><pre class="kj kk kl km gt nb nc nd ne aw nf bi"><span id="ca5d" class="md me it nc b gy ng nh l ni nj">me = image_to_encodings('me.jpg')<br/>top_match(list(avengers_dictionary.values()),<br/>          list(avengers_dictionary.keys()),<br/>          me)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nl"><img src="../Images/8580df02b973e82c6dc27b7f40e196a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*K3Vzke2KcQRK7WO0e60Aew.png"/></div></div></figure><p id="fd96" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">鹰眼！我要了。</p><p id="a382" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">如果你想亲自尝试，你可以在 GitHub 上查看我的代码。它目前可以在终端上运行，带有一些有趣 ASCII 装饰:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oa"><img src="../Images/1cff35daa6c05eee9420fb2a5bd7a96d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0qCsSBO2q98ROwZEO3nBsw.png"/></div></div></figure><p id="be0d" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这可能是最好的 web 应用程序，我可能会尝试进一步构建，但有趣的是看到这是如何工作的原则。尽情享受吧！</p></div></div>    
</body>
</html>