<html>
<head>
<title>Simple example of 2D density plots in python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">python 中 2D 密度图的简单示例</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/simple-example-of-2d-density-plots-in-python-83b83b934f67?source=collection_archive---------0-----------------------#2019-03-10">https://towardsdatascience.com/simple-example-of-2d-density-plots-in-python-83b83b934f67?source=collection_archive---------0-----------------------#2019-03-10</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="a08e" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">如何可视化联合分布</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/b14c22753133431e2a2eb0f76468a84e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Sd_FJ4YSg0OiJBggsZoY3g.jpeg"/></div></div></figure><p id="4291" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这篇文章将向你展示如何:</p><ul class=""><li id="29bd" class="lq lr it kw b kx ky la lb ld ls lh lt ll lu lp lv lw lx ly bi translated">使用高斯核估计两个分布的概率密度函数</li><li id="80ed" class="lq lr it kw b kx lz la ma ld mb lh mc ll md lp lv lw lx ly bi translated">使用 Matplotlib 用密度图周围带标签的等高线来表示 PDF</li><li id="cd8e" class="lq lr it kw b kx lz la ma ld mb lh mc ll md lp lv lw lx ly bi translated">如何提取等高线</li><li id="359e" class="lq lr it kw b kx lz la ma ld mb lh mc ll md lp lv lw lx ly bi translated">如何在 3D 中绘制上面的高斯核</li><li id="e516" class="lq lr it kw b kx lz la ma ld mb lh mc ll md lp lv lw lx ly bi translated">如何使用 2D 直方图绘制相同的 PDF</li></ul><p id="76ff" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">让我们从生成包含 3 个斑点的输入数据集开始:</p><pre class="kj kk kl km gt me mf mg mh aw mi bi"><span id="f46c" class="mj mk it mf b gy ml mm l mn mo">import numpy as np<br/>import matplotlib.pyplot as plt<br/>import scipy.stats as st<br/>from sklearn.datasets.samples_generator import make_blobs</span><span id="6d32" class="mj mk it mf b gy mp mm l mn mo">n_components = 3<br/>X, truth = make_blobs(n_samples=300, centers=n_components, <br/>                      cluster_std = [2, 1.5, 1], <br/>                      random_state=42)</span><span id="c2d5" class="mj mk it mf b gy mp mm l mn mo">plt.scatter(X[:, 0], X[:, 1], s=50, c = truth)<br/>plt.title(f"Example of a mixture of {n_components} distributions")<br/>plt.xlabel("x")<br/>plt.ylabel("y");</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mq"><img src="../Images/823503e34941b3ad939e9d966632f208.png" data-original-src="https://miro.medium.com/v2/resize:fit:768/format:webp/1*4ddgIsTEIRdxom0Fw354wA.png"/></div></figure><p id="0788" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">为了拟合高斯核，我们指定一个网格，该网格将在每个轴上使用 100 点插值(例如，mgrid(xmin:xmax:100j)):</p><pre class="kj kk kl km gt me mf mg mh aw mi bi"><span id="d659" class="mj mk it mf b gy ml mm l mn mo"># Extract x and y<br/>x = X[:, 0]<br/>y = X[:, 1]</span><span id="6858" class="mj mk it mf b gy mp mm l mn mo"># Define the borders<br/>deltaX = (max(x) - min(x))/10<br/>deltaY = (max(y) - min(y))/10</span><span id="0bc3" class="mj mk it mf b gy mp mm l mn mo">xmin = min(x) - deltaX<br/>xmax = max(x) + deltaX</span><span id="67f1" class="mj mk it mf b gy mp mm l mn mo">ymin = min(y) - deltaY<br/>ymax = max(y) + deltaY</span><span id="a1bc" class="mj mk it mf b gy mp mm l mn mo">print(xmin, xmax, ymin, ymax)</span><span id="c65f" class="mj mk it mf b gy mp mm l mn mo"># Create meshgrid<br/>xx, yy = np.mgrid[xmin:xmax:100j, ymin:ymax:100j]</span></pre><p id="e378" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们将使用 scipy 的<em class="mr"> gaussian_kde </em>方法来拟合高斯内核:</p><pre class="kj kk kl km gt me mf mg mh aw mi bi"><span id="124d" class="mj mk it mf b gy ml mm l mn mo">positions = np.vstack([xx.ravel(), yy.ravel()])<br/>values = np.vstack([x, y])<br/>kernel = st.gaussian_kde(values)<br/>f = np.reshape(kernel(positions).T, xx.shape)</span></pre><h1 id="0588" class="ms mk it bd mt mu mv mw mx my mz na nb jz nc ka nd kc ne kd nf kf ng kg nh ni bi translated">用带注释的轮廓绘制内核</h1><pre class="kj kk kl km gt me mf mg mh aw mi bi"><span id="e596" class="mj mk it mf b gy ml mm l mn mo">fig = plt.figure(figsize=(8,8))<br/>ax = fig.gca()<br/>ax.set_xlim(xmin, xmax)<br/>ax.set_ylim(ymin, ymax)<br/>cfset = ax.contourf(xx, yy, f, cmap='coolwarm')<br/>ax.imshow(np.rot90(f), cmap='coolwarm', extent=[xmin, xmax, ymin, ymax])<br/>cset = ax.contour(xx, yy, f, colors='k')<br/>ax.clabel(cset, inline=1, fontsize=10)<br/>ax.set_xlabel('X')<br/>ax.set_ylabel('Y')<br/>plt.title('2D Gaussian Kernel density estimation')</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/304ff3dbb5acef8a76b5f78f5378dfae.png" data-original-src="https://miro.medium.com/v2/resize:fit:730/format:webp/1*pVmFBSktGXGHv3oUDX9qCA.png"/></div></figure><p id="9e20" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">完成整个魔术的 matplotlib 对象被称为 QuadContour set(代码中的<em class="mr"> cset </em>)。我们可以通过迭代<em class="mr"> allsegs </em>对象来编程访问轮廓线。计算标签可从<em class="mr">标签文本</em>访问。</p><pre class="kj kk kl km gt me mf mg mh aw mi bi"><span id="cddc" class="mj mk it mf b gy ml mm l mn mo">plt.figure(figsize=(8,8))</span><span id="7a4b" class="mj mk it mf b gy mp mm l mn mo">for j in range(len(cset.allsegs)):<br/>    for ii, seg in enumerate(cset.allsegs[j]):<br/>        plt.plot(seg[:,0], seg[:,1], '.-', label=f'Cluster{j}, level{ii}')</span><span id="cde0" class="mj mk it mf b gy mp mm l mn mo">plt.legend()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/7b60da98e861b1e5a4bdfe8764e4d649.png" data-original-src="https://miro.medium.com/v2/resize:fit:944/format:webp/1*Mv3M_8pqukvTofzsk_Q_Ug.png"/></div></figure><h1 id="4e9a" class="ms mk it bd mt mu mv mw mx my mz na nb jz nc ka nd kc ne kd nf kf ng kg nh ni bi translated">三维 KDE 图</h1><p id="61b1" class="pw-post-body-paragraph ku kv it kw b kx nl ju kz la nm jx lc ld nn lf lg lh no lj lk ll np ln lo lp im bi translated">我们将使用来自 mplot3d 的 matplotlib 的 axes3d。我们可以将密度绘制成一个表面:</p><pre class="kj kk kl km gt me mf mg mh aw mi bi"><span id="5d11" class="mj mk it mf b gy ml mm l mn mo">fig = plt.figure(figsize=(13, 7))<br/>ax = plt.axes(projection='3d')<br/>surf = ax.plot_surface(xx, yy, f, rstride=1, cstride=1, cmap='coolwarm', edgecolor='none')<br/>ax.set_xlabel('x')<br/>ax.set_ylabel('y')<br/>ax.set_zlabel('PDF')<br/>ax.set_title('Surface plot of Gaussian 2D KDE')<br/>fig.colorbar(surf, shrink=0.5, aspect=5) # add color bar indicating the PDF<br/>ax.view_init(60, 35)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nq"><img src="../Images/d5bc66649c339a371b9b6105986acf8f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*s1Uk0_3NY1DXrRWcb17QMQ.png"/></div></div></figure><p id="237b" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">或者作为线框:</p><pre class="kj kk kl km gt me mf mg mh aw mi bi"><span id="0ea4" class="mj mk it mf b gy ml mm l mn mo">fig = plt.figure(figsize=(13, 7))<br/>ax = plt.axes(projection='3d')<br/>w = ax.plot_wireframe(xx, yy, f)<br/>ax.set_xlabel('x')<br/>ax.set_ylabel('y')<br/>ax.set_zlabel('PDF')<br/>ax.set_title('Wireframe plot of Gaussian 2D KDE');</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/600a27e02209569a0f8e28870fe09764.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*829fq7tMJU1oxs_VLSkUZA.png"/></div></figure><p id="d063" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><strong class="kw iu">使用 2D 直方图的表示法</strong></p><p id="b0fc" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">呈现相同信息的另一种方式是使用 2D 直方图。将参数<em class="mr"> normed </em>设置为 False 将返回实际频率，而设置为 True 将返回 PDF。</p><pre class="kj kk kl km gt me mf mg mh aw mi bi"><span id="2c68" class="mj mk it mf b gy ml mm l mn mo">h =plt.hist2d(x, y)<br/>plt.colorbar(h[3])</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/ce3f92e969bc09eca950d34bfbc25e9f.png" data-original-src="https://miro.medium.com/v2/resize:fit:772/format:webp/1*Q0tat3g2O-EXFEBjpPzL5g.png"/></div></figure><p id="e426" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">完整的代码可以在<a class="ae nt" href="https://github.com/ciortanmadalina/modality_tests/blob/master/2Dkde.ipynb" rel="noopener ugc nofollow" target="_blank"> Github </a>上获得。</p></div></div>    
</body>
</html>