# Map-Reduce:æ¢¯åº¦ä¸‹é™

> åŸæ–‡ï¼š<https://towardsdatascience.com/map-reduce-gradient-descent-276e6ed0b002?source=collection_archive---------21----------------------->

## ä½¿ç”¨ PySpark å’Œ vanilla Python

ä¸€äº›ç»Ÿè®¡æ¨¡å‹ğ‘“(ğ‘¥é€šè¿‡ä¼˜åŒ–ä¾èµ–äºä¸€ç»„å‚æ•°Î¸çš„æŸå¤±å‡½æ•°ğ¿(Î¸æ¥å­¦ä¹ ã€‚æœ‰å‡ ç§æ–¹æ³•å¯ä»¥æ‰¾åˆ°æŸå¤±å‡½æ•°çš„æœ€ä½³Î¸ï¼Œå…¶ä¸­ä¸€ç§æ–¹æ³•æ˜¯æŒ‰ç…§æ¢¯åº¦è¿­ä»£æ›´æ–°:

![](img/8131ece928a94332761a1294a80e4459.png)

ç„¶åï¼Œè®¡ç®—æ›´æ–°:

![](img/3f85c1917d38da86442f4a8a9785dc6d.png)

å› ä¸ºæˆ‘ä»¬å‡è®¾æ•°æ®ç‚¹ä¹‹é—´æ˜¯ç‹¬ç«‹çš„ï¼Œæ‰€ä»¥æ¢¯åº¦å˜æˆäº†æ±‚å’Œ:

![](img/7a901ce13b934a13caf295918db796b9.png)

å…¶ä¸­ğ¿ğ‘–æ˜¯ğ‘–-th æ•°æ®ç‚¹çš„æŸå¤±å‡½æ•°ã€‚

![](img/6b4e7c2f1a845f90f9acf943c2061ad0.png)

Image by [Gerd Altmann](https://pixabay.com/users/geralt-9301/?utm_source=link-attribution&utm_medium=referral&utm_campaign=image&utm_content=70509) from [Pixabay](https://pixabay.com/?utm_source=link-attribution&utm_medium=referral&utm_campaign=image&utm_content=70509)

ä»¥ç»Ÿè®¡æ¨¡å‹ğ‘“(ğ‘¥)=ğ‘0+ğ‘1ğ‘¥å’ŒæŸå¤±å‡½æ•°ğ¿(Î¸)=(ğ‘“(ğ‘¥)âˆ’ğ‘¦ä¸ºä¾‹)ã€‚å¦‚æœæˆ‘ä»¬æœ‰ä¸€ç»„ä¸‰ä¸ªæ•°æ®ç‚¹ğ·={(ğ‘¥=1,ğ‘¦=2),(ğ‘¥=âˆ’2,ğ‘¦=âˆ’1),(ğ‘¥=4,ğ‘¦=3)}

é‚£ä¹ˆå®ƒä»¬ä¸­æ¯ä¸€ä¸ªçš„æŸå¤±å‡½æ•°æ˜¯

ğ¿1=(ğ‘0+ğ‘1âˆ’2)ã€ğ¿2=(ğ‘0âˆ’2ğ‘1+1)å’Œğ¿3=(ğ‘0+4ğ‘1âˆ’3)ä¸

![](img/37b6532385bf45f3d492fd5bdad32095.png)

å¦‚æœæˆ‘ä»¬ä»ğ‘1=1 ğ‘0=0 çš„è§£å†³æ–¹æ¡ˆå¼€å§‹ï¼Œé‚£ä¹ˆæ¢¯åº¦æ˜¯:

![](img/69725c081dac75e6ff38654f401ca005.png)

ç§¯ç´¯åä¼šäº§ç”Ÿ

![](img/2158a3365a631e6a417d409d230aa7bc.png)

ç°åœ¨ï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå‡½æ•°ï¼Œå®ƒå°†æ¥æ”¶å‚æ•° b å’Œä¸€ä¸ªæ•°æ®ç‚¹ x ä½œä¸ºåˆ—è¡¨ï¼Œå¹¶è¿”å›è¯¥æ•°æ®ç‚¹çš„é¢„æµ‹å€¼(y)ã€‚

**Ex: f_linear([0, 1], [1]) will give an output of 1**

æˆ‘ä»¬å®šä¹‰ä¸€ä¸ªæ¥æ”¶é¢„æµ‹ y å’Œå®é™… y å¹¶è¿”å›å®ƒä»¬ä¹‹é—´çš„å¹³æ–¹è¯¯å·®çš„å‡½æ•°ã€‚

**Ex: L(1, 1) will give an output of 0**

å‡½æ•° gf_linear(fï¼Œbï¼Œxï¼Œy)å°†è¿”å›å…·æœ‰å‚æ•° b çš„å‡½æ•° f ç›¸å¯¹äºå¹³æ–¹æŸå¤±å‡½æ•°çš„æ¢¯åº¦ï¼Œåœ¨ x å’Œå®é™…ç»“æœ y å¤„è¯„ä¼°ã€‚æ­¤å‡½æ•°åº”è¿”å›æ¯ä¸ªå…ƒç´ ğ‘—å¯¹åº”äºç›¸å¯¹äºğ‘ğ‘—å’Œğ‘—={0,1,â€¦,ğ‘}.çš„æ¢¯åº¦çš„å‘é‡

**Ex: x = [1], y = 2, b = [0, 1], gf_linear(f_linear, b, x, y) will give an output of [-2,-2]**

# **åœ°å›¾ç¼©å°:**

æˆ‘ä»¬å¼€å‘äº†ä¸€ä¸ªç”Ÿæˆå€¼çš„åœ°å›¾ç¼©å‡ä½œä¸šï¼Œå› æ­¤è¯¥å€¼çš„ç¬¬ä¸€ä¸ªå…ƒç´ æ˜¯æ‰€æœ‰æ•°æ®çš„å¹³å‡æŸå¤±å‡½æ•°ã€‚æˆ‘ä»¬å°†æ˜ å°„å‡½æ•°å®ç°ä¸º`map_mse(f, b, L, xy)`ï¼Œå…¶ä¸­`f`æ˜¯å‡½æ•°`b`æ˜¯å‡½æ•°çš„å‚æ•°`L`æ˜¯æŸå¤±å‡½æ•°`xy`æ˜¯æ•°æ®ã€‚å‡è®¾æ•°æ®å°†ä»¥ RDD çš„å½¢å¼å‡ºç°ï¼Œå…¶ä¸­æ¯ä¸ªå…ƒç´ çš„æ ¼å¼å¦‚ä¸‹:

`[x, y]`å…¶ä¸­`x`æ˜¯åˆ—è¡¨ï¼Œ`y`æ˜¯æ ‡é‡

**Ex:**rdd _ data . map(lambda x:map _ MSE(f _ linearï¼Œ[0ï¼Œ0ï¼Œ0]ï¼ŒLï¼Œx))ã€‚collect()ä¼šç»™å‡ºä¸€ä¸ª**è¾“å‡º**ä¸º:[[1ï¼Œ[9ï¼Œ1]]ï¼Œ[1ï¼Œ[16ï¼Œ1]]ï¼Œ[1ï¼Œ[0.0ï¼Œ1]]ï¼Œ[1ï¼Œ[0ï¼Œ1]]ã€‚è¿™é‡Œ key æ˜¯ 1ï¼Œb=[0ï¼Œ0ï¼Œ0]ï¼Œæˆ‘ä»¬ä» rdd_data å¾—åˆ° xã€‚map çš„è¾“å‡ºæ˜¯æ¯ä¸ªæ•°æ®ç‚¹çš„é”®å’Œå€¼ã€‚

ç°åœ¨ï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ª reduce ä½œä¸šï¼Œå®ƒæ¥æ”¶å‰ä¸€ä¸ª reduce(æˆ– map)çš„ä¸¤ä¸ªå€¼ï¼Œå¹¶é€‚å½“åœ°åˆå¹¶å®ƒä»¬ã€‚åœ¨ reduce ä½œä¸šç»“æŸæ—¶ï¼Œå€¼çš„ç¬¬ä¸€ä¸ªå…ƒç´ æ˜¯å‡æ–¹è¯¯å·®ã€‚

**ä¾‹å¦‚:** rdd_dataã€‚\
map(lambda x:map _ MSE(f _ linearï¼Œ[0ï¼Œ0ï¼Œ0]ï¼ŒLï¼Œx))ã€‚\
reduceByKey(reduce_mse)ã€‚first()[1][0]ä¼šç»™æˆ‘ä»¬ä¸€ä¸ª 6.25 çš„**å‡æ–¹è¯¯å·®**ã€‚(x å’Œ y å€¼è¯·éµå¾ª rdd_data)

å› æ­¤ï¼Œç°åœ¨æˆ‘ä»¬å°†è®¡ç®—æ•°æ®æ¨¡å‹çš„ç´¯ç§¯æ¢¯åº¦ã€‚æˆ‘ä»¬å°†å®šä¹‰ä¸€ä¸ªæ˜ å°„å‡½æ•°`map_gradient(f, gf, b, xy)`ï¼Œå®ƒå°†æ¥æ”¶ä¸€ä¸ªå‡½æ•°`f`ï¼Œå®ƒçš„æ¢¯åº¦`gf`ï¼Œå®ƒçš„å‚æ•°`b`ï¼Œä»¥åŠä¸€ä¸ªæ•°æ®ç‚¹`xy = [x, y]`ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬å°†å®šä¹‰ä¸€ä¸ªå‡½æ•°`reduce_gradient(v1, v2)`æ¥é€‚å½“åœ°ç»„åˆè¿™ä¸¤ä¸ªå€¼ã€‚

**Ex:**rdd _ data . map(lambda xy:map _ gradient(f _ linearï¼Œgf_linearï¼Œ[0ï¼Œ0ï¼Œ0]ï¼Œxy))ã€‚reduceByKey(reduce_gradient)ã€‚first()[1]å°†ç»™å‡º[-14.0ï¼Œ-30.0ï¼Œ-20.0]çš„**è¾“å‡º**

ç°åœ¨ï¼Œä¸ºäº†å¾—åˆ°ä¸€ä¸ªä¼˜åŒ–çš„å€¼ï¼Œæˆ‘ä»¬è¿è¡Œä¸‹é¢çš„ä»£ç ï¼Œä½¿ MSE æ¯æ¬¡éƒ½å‡å°‘ã€‚

æ„Ÿè°¢ä½ çš„é˜…è¯»ï¼Œæˆ‘å¸Œæœ›ä½ èƒ½å­¦ä¼šæˆ–è‡³å°‘ç†è§£æ¢¯åº¦ä¸‹é™æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œä»¥åŠå¦‚ä½•ä½¿ç”¨ Map-Reduce å®ç°å®ƒã€‚

Linkedin:

 [## Harsh Darji -ç‰¹çº¦æ’°ç¨¿äºº- Medium | LinkedIn

### æˆ‘æ˜¯ä¸€åæ•°æ®ç§‘å­¦çˆ±å¥½è€…ï¼Œè¿½æ±‚åº”ç”¨é«˜çº§åˆ†æï¼Œå»ºç«‹å¤§æ•°æ®åˆ†æå·¥å…·â€¦

www.linkedin.com](https://www.linkedin.com/in/harshdarji23/) 

GitHub:

[](https://github.com/harshdarji23) [## harshdarji23 -æ¦‚è¿°

### åœ¨ GitHub ä¸Šæ³¨å†Œæ‚¨è‡ªå·±çš„ä¸ªäººèµ„æ–™ï¼Œè¿™æ˜¯æ‰˜ç®¡ä»£ç ã€ç®¡ç†é¡¹ç›®å’Œä¸ 40â€¦

github.com](https://github.com/harshdarji23)