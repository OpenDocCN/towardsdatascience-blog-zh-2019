<html>
<head>
<title>Visualising Filters and Feature Maps for Deep Learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">为深度学习可视化过滤器和特征图</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/visualising-filters-and-feature-maps-for-deep-learning-d814e13bd671?source=collection_archive---------4-----------------------#2019-05-14">https://towardsdatascience.com/visualising-filters-and-feature-maps-for-deep-learning-d814e13bd671?source=collection_archive---------4-----------------------#2019-05-14</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><blockquote class="jq jr js"><p id="a0bf" class="jt ju jv jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr im bi translated">想获得灵感？快来加入我的<a class="ae ks" href="https://www.superquotes.co/?utm_source=mediumtech&amp;utm_medium=web&amp;utm_campaign=sharing" rel="noopener ugc nofollow" target="_blank"> <strong class="jw iu">超级行情快讯</strong> </a>。😎</p></blockquote><p id="5f34" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke kt kg kh ki ku kk kl km kv ko kp kq kr im bi translated">深度神经网络是最强大的机器学习模型之一。有了足够的数据，它们在计算机视觉和自然语言处理(NLP)等任务中的准确性是无与伦比的。</p><p id="e1c3" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke kt kg kh ki ku kk kl km kv ko kp kq kr im bi translated">许多科学家会评论的唯一缺点是，这些网络完全是黑箱作业。对于深度网络如何如此好地学习它们的目标模式，尤其是所有神经元如何一起工作以实现最终结果，我们仍然知之甚少。</p><p id="5bee" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke kt kg kh ki ku kk kl km kv ko kp kq kr im bi translated">对 ML 模型如何工作有某种内部了解会带来一些关键优势:</p><ul class=""><li id="5cd6" class="kw kx it jw b jx jy kb kc kt ky ku kz kv la kr lb lc ld le bi translated">它们更容易调整，因为当我们看到网络出错时，我们可以直接指出原因</li><li id="5934" class="kw kx it jw b jx lf kb lg kt lh ku li kv lj kr lb lc ld le bi translated">可以解释网络的功能和预期行为，特别是对非技术利益相关者</li><li id="0a14" class="kw kx it jw b jx lf kb lg kt lh ku li kv lj kr lb lc ld le bi translated">我们可以进一步扩展和改进模型的整体设计，因为我们已经了解了当前的设计，包括它的优点和缺点</li></ul><p id="68e3" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke kt kg kh ki ku kk kl km kv ko kp kq kr im bi translated">令人高兴的是，研究人员已经开始探索理解深层网络内部情况的技术。特别是，我们现在有能力可视化卷积神经网络(CNN)从其计算机视觉任务训练中学习的过滤器，以及 CNN 应用于图像时产生的特征图。</p><p id="e8ef" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke kt kg kh ki ku kk kl km kv ko kp kq kr im bi translated">本教程将教你如何做到这一点:可视化的过滤器和特征地图的 CNN 训练的图像分类。我们甚至可以在超级易用的 Keras 中完成！</p><h1 id="1bf0" class="lk ll it bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated">挑选我们的模型</h1><p id="36fe" class="pw-post-body-paragraph jt ju it jw b jx mi jz ka kb mj kd ke kt mk kh ki ku ml kl km kv mm kp kq kr im bi translated">首先，我们需要选择一个模型来可视化。</p><p id="84e2" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke kt kg kh ki ku kk kl km kv ko kp kq kr im bi translated">在 Keras 中，最简单的方法是选择一个预先训练好的图像分类模型。在它的<a class="ae ks" href="https://keras.io/applications/#resnet" rel="noopener ugc nofollow" target="_blank">应用</a>页面中有很多这些表现最好的模型。他们都在 ImageNet 数据集上进行了训练，该数据集包含超过 100 万张图片。</p><p id="623d" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke kt kg kh ki ku kk kl km kv ko kp kq kr im bi translated">对于本教程，我将挑选 VGG16 型号。它很简单，我们可以浏览我们的教程，并仍然保持其作为一个相当准确的模型。结构如下所示。</p><figure class="mo mp mq mr gt ms gh gi paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="gh gi mn"><img src="../Images/bbf05b889ec609a241f9d650fc3407b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*5a3PWbPKxAs4BDul.jpg"/></div></div></figure><p id="6d7f" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke kt kg kh ki ku kk kl km kv ko kp kq kr im bi translated">在 Keras 中加载模型的过程如下所示。当您从<code class="fe mz na nb nc b">keras.applications</code>导入模型时，Keras 会自动将权重下载到适当的目录中。然后，我们加载模型并打印出它的结构概要。</p><figure class="mo mp mq mr gt ms"><div class="bz fp l di"><div class="nd ne l"/></div></figure><h1 id="f9dd" class="lk ll it bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated">可视化过滤器</h1><p id="6e5b" class="pw-post-body-paragraph jt ju it jw b jx mi jz ka kb mj kd ke kt mk kh ki ku ml kl km kv mm kp kq kr im bi translated">我们将创建的第一个可视化是 CNN 过滤器。</p><p id="6c9c" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke kt kg kh ki ku kk kl km kv ko kp kq kr im bi translated">当深度学习的人们谈论“过滤器”时，他们指的是卷积的学习权重。例如，单个 3×3 卷积称为“滤波器”，该滤波器总共有 10 个权重(9 + 1 偏差)。</p><p id="7e30" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke kt kg kh ki ku kk kl km kv ko kp kq kr im bi translated">通过可视化学习的权重，我们可以了解我们的网络学习得有多好。例如，如果我们看到许多零，那么我们将知道我们有许多对我们的网络没什么用的死过滤器——这是为模型压缩做一些修剪的好机会。</p><p id="998c" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke kt kg kh ki ku kk kl km kv ko kp kq kr im bi translated">看看下面可视化过滤器的代码，然后向下滚动查看它如何工作的解释。</p><figure class="mo mp mq mr gt ms"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="8d51" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke kt kg kh ki ku kk kl km kv ko kp kq kr im bi translated">在导入了所有必需的库并加载了模型之后，我们在第 7 行构建了模型中各层的字典。这将允许我们通过层名称访问每个层的权重。如果你想查所有的名字，你可以打印出字典中的关键字。</p><p id="67b7" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke kt kg kh ki ku kk kl km kv ko kp kq kr im bi translated">接下来，我们将在第 9 行设置我们想要显示其滤镜的图层的名称。我选择了“block5_conv1 ”,但您可以选择任何您喜欢的卷积块。</p><p id="8cf7" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke kt kg kh ki ku kk kl km kv ko kp kq kr im bi translated">在第 13 行中，我们调用<code class="fe mz na nb nc b">get_weights()</code>函数从我们选择的层中获取过滤器和偏置权重。</p><p id="b407" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke kt kg kh ki ku kk kl km kv ko kp kq kr im bi translated">在第 16 行和第 17 行，我们对过滤器值进行了归一化处理，使它们介于 0 和 1 之间。当我们在屏幕上以颜色显示重量时，这将有助于创建清晰的视觉效果。</p><p id="c5e0" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke kt kg kh ki ku kk kl km kv ko kp kq kr im bi translated">最后，我们从第 21 行开始的循环显示了一些过滤器。对于我们选择的“绿色”色图，黄色代表值 1，深蓝色代表值 0。</p><p id="ccbe" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke kt kg kh ki ku kk kl km kv ko kp kq kr im bi translated">查看下面 VGG16 的 block5_conv1 层的输出！</p><figure class="mo mp mq mr gt ms gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/b033fa92e84797c13e02dfd42250fadb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*ePBi3SYEm8J8aqXGY4xeaQ.png"/></div></figure><h1 id="7a24" class="lk ll it bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated">可视化特征地图</h1><p id="3d8c" class="pw-post-body-paragraph jt ju it jw b jx mi jz ka kb mj kd ke kt mk kh ki ku ml kl km kv mm kp kq kr im bi translated">CNN 的特征图捕捉将过滤器应用于输入图像的结果。即在每一层，特征图是该层的输出。</p><p id="06d6" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke kt kg kh ki ku kk kl km kv ko kp kq kr im bi translated">将特定输入图像的特征映射可视化的原因是为了试图了解我们的 CNN 检测到了什么特征。也许它检测到了我们想要的物体的某些部分，而没有检测到其他部分，或者激活在某一层消失了。</p><p id="4d8d" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke kt kg kh ki ku kk kl km kv ko kp kq kr im bi translated">直接观察深度学习中的一个常见想法也很有趣，即网络的早期层检测低级特征(颜色、边缘等)，网络的后期层检测高级特征(形状和对象)。</p><p id="d495" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke kt kg kh ki ku kk kl km kv ko kp kq kr im bi translated">看一下下面的可视化特征地图的代码，然后向下滚动查看它是如何工作的解释。</p><figure class="mo mp mq mr gt ms"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="4556" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke kt kg kh ki ku kk kl km kv ko kp kq kr im bi translated">前两个步骤保持不变:加载模型并选择你想要可视化的层的名称。一个小的变化是我们修改了我们的模型，使得最终输出是 VGG16 的最后一个特征地图的输出，因为我们并不真正需要最后两个完全连接的层。</p><p id="8730" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke kt kg kh ki ku kk kl km kv ko kp kq kr im bi translated">接下来，我们将在第 16 到 19 行加载并准备我们的图像。你可以选择任何你喜欢的图像；我选择了一个老虎的形象，因为老虎是令人敬畏的。</p><p id="ea8e" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke kt kg kh ki ku kk kl km kv ko kp kq kr im bi translated">第 16 到 19 行的代码将读取图像并应用 VGG16 模型所需的必要预处理。如果您的图像像 4K 分辨率一样大，也不用担心，因为 VGG 总是希望图像的大小为 224x224，所以输入在处理之前总是会重新调整大小。</p><figure class="mo mp mq mr gt ms gh gi paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="gh gi ng"><img src="../Images/28e6b1d5c1971cbba27b9fabfd24823a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WC7OruzNF0GfjfwwCVRO7Q.jpeg"/></div></div></figure><p id="8f01" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke kt kg kh ki ku kk kl km kv ko kp kq kr im bi translated">在第 22 行，我们将 VGG16 模型应用于输入图像；输出将是我们想要的特征地图。我们将遍历地图的几个通道，并在 matplotlib 图形中可视化它们。</p><p id="242d" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke kt kg kh ki ku kk kl km kv ko kp kq kr im bi translated">查看下面的结果图。注意在图像的边缘和纹理上有很多激活，尤其是我们的老虎的轮廓！</p><figure class="mo mp mq mr gt ms gh gi paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="gh gi nh"><img src="../Images/72c61d3e9d07b7ad716cdb0719eb68ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IXp9hJVA3iWQtnHMVwiDDw.png"/></div></div></figure></div><div class="ab cl ni nj hx nk" role="separator"><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn"/></div><div class="im in io ip iq"><h1 id="5f41" class="lk ll it bd lm ln np lp lq lr nq lt lu lv nr lx ly lz ns mb mc md nt mf mg mh bi translated">喜欢学习？</h1><p id="5997" class="pw-post-body-paragraph jt ju it jw b jx mi jz ka kb mj kd ke kt mk kh ki ku ml kl km kv mm kp kq kr im bi translated">在 twitter 上关注我，我会在这里发布所有最新最棒的人工智能、技术和科学！也在<a class="ae ks" href="https://www.linkedin.com/in/georgeseif/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>上和我联系吧！</p></div></div>    
</body>
</html>