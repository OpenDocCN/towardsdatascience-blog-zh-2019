<html>
<head>
<title>Machine Learning: Polynomial Regression with Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">机器学习:用 Python 实现多项式回归</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/machine-learning-polynomial-regression-with-python-5328e4e8a386?source=collection_archive---------3-----------------------#2019-03-20">https://towardsdatascience.com/machine-learning-polynomial-regression-with-python-5328e4e8a386?source=collection_archive---------3-----------------------#2019-03-20</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="9394" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">在这篇文章中，我们将指导你使用多项式回归进行机器学习的中间步骤。</h2></div><p id="81b3" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="lb">本帖中使用的缩写:</em></p><ul class=""><li id="3be4" class="lc ld iq kh b ki kj kl km ko le ks lf kw lg la lh li lj lk bi translated"><em class="lb">叶:多年经验</em></li></ul><h1 id="e4fc" class="ll lm iq bd ln lo lp lq lr ls lt lu lv jw lw jx lx jz ly ka lz kc ma kd mb mc bi translated">先看看线性回归</h1><p id="36b4" class="pw-post-body-paragraph kf kg iq kh b ki md jr kk kl me ju kn ko mf kq kr ks mg ku kv kw mh ky kz la ij bi translated">在我之前的帖子中，我们讨论了关于<a class="ae mi" rel="noopener" target="_blank" href="/machine-learning-simple-linear-regression-with-python-f04ecfdadc13">线性回归</a>。让我们回顾一下。对其值为<strong class="kh ir">线性</strong>的数据集应用线性回归，如下例:</p><figure class="mk ml mm mn gt mo gh gi paragraph-image"><div class="gh gi mj"><img src="../Images/142c6ec0f88d4524d12c63002a5810df.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/format:webp/1*MMynEUkyHu_W5v72jr1lhA.png"/></div><figcaption class="mr ms gj gh gi mt mu bd b be z dk">Salary based on Years of Experience (<a class="ae mi" href="https://s3.us-west-2.amazonaws.com/public.gamelab.fun/dataset/salary_data.csv" rel="noopener ugc nofollow" target="_blank">salary_data.csv</a>)</figcaption></figure><p id="36eb" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">而现实生活并没有那么简单，尤其是当你从不同行业的很多不同公司去观察的时候。1 个叶老师和 1 个叶工程师工资不一样；甚至 1 叶土木工程师不同于机械工程师；如果你比较两个不同公司的机械工程师，他们的工资也大不相同。那么如何才能预测一个应聘者的薪资呢？</p><p id="c912" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">今天，我们将使用另一个数据集来表示多项式形状。</p><figure class="mk ml mm mn gt mo gh gi paragraph-image"><div class="gh gi mv"><img src="../Images/312a2bde44837f946656ab2d69dca080.png" data-original-src="https://miro.medium.com/v2/resize:fit:784/format:webp/1*I3ILZqbRWh_mcEEOckB4Gw.png"/></div><figcaption class="mr ms gj gh gi mt mu bd b be z dk">Salary based on Years of Experience (<a class="ae mi" href="https://s3.us-west-2.amazonaws.com/public.gamelab.fun/dataset/position_salaries.csv" rel="noopener ugc nofollow" target="_blank">position_salaries.csv</a>)</figcaption></figure><p id="7738" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了了解工资增长的总体情况，让我们将数据集可视化为一个图表:</p><figure class="mk ml mm mn gt mo gh gi paragraph-image"><div role="button" tabindex="0" class="mx my di mz bf na"><div class="gh gi mw"><img src="../Images/f82df42fc5a0e987e64567ba8f1c59c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sqEWoMd6QGw39sTLIRsISA.png"/></div></div><figcaption class="mr ms gj gh gi mt mu bd b be z dk">Salary based on Years of Experience — Plotting</figcaption></figure><p id="d959" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我们想想我们的候选人。他有 5 叶。如果我们在这个例子中使用<a class="ae mi" rel="noopener" target="_blank" href="/machine-learning-simple-linear-regression-with-python-f04ecfdadc13">线性回归</a>会怎么样？</p><figure class="mk ml mm mn gt mo gh gi paragraph-image"><div role="button" tabindex="0" class="mx my di mz bf na"><div class="gh gi mw"><img src="../Images/3438bd815233629fed642336b9e8f3a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*g9MpIW5EjKANKvRbpjGUaA.png"/></div></div><figcaption class="mr ms gj gh gi mt mu bd b be z dk">Linear visualization</figcaption></figure><p id="3b4c" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">根据上图，我们候选人的工资范围大概是从 <strong class="kh ir"> <em class="lb">减去</em></strong><em class="lb">【10，000 美元到 300，000 美元</em>。为什么？看，这种情况下的工资观察不是线性的。<strong class="kh ir">它们呈弧形！</strong>这就是为什么在这个场景中应用<a class="ae mi" rel="noopener" target="_blank" href="/machine-learning-simple-linear-regression-with-python-f04ecfdadc13">线性回归</a>不能给出正确的值。是时候进行<strong class="kh ir">多项式回归</strong>了。</p><h1 id="1a48" class="ll lm iq bd ln lo lp lq lr ls lt lu lv jw lw jx lx jz ly ka lz kc ma kd mb mc bi translated">为什么要多项式回归？</h1><p id="1bf8" class="pw-post-body-paragraph kf kg iq kh b ki md jr kk kl me ju kn ko mf kq kr ks mg ku kv kw mh ky kz la ij bi translated">因为要准确得多！</p><p id="5d40" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们已经知道 5 叶的工资是 11 万美元，6 叶是 15 万美元。意思是 5.5 叶的工资应该在他们之间！最佳价值应该是这样的:</p><figure class="mk ml mm mn gt mo gh gi paragraph-image"><div role="button" tabindex="0" class="mx my di mz bf na"><div class="gh gi nb"><img src="../Images/f53ca80b792651c09b805c87e00d0801.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sbJXYpyeRTzJxhc14jMJgw.png"/></div></div><figcaption class="mr ms gj gh gi mt mu bd b be z dk">Polynomial visualization</figcaption></figure><p id="b860" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我们比较一下使用线性和多项式之间的差距。注意红色圆圈:</p><figure class="mk ml mm mn gt mo gh gi paragraph-image"><div role="button" tabindex="0" class="mx my di mz bf na"><div class="gh gi mw"><img src="../Images/1b4a64838a6636c6fc16f7666d0488e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bJLLDBsdj7uhSvn8MFrW0A.png"/></div></div><figcaption class="mr ms gj gh gi mt mu bd b be z dk">Comparison between Linear and Polynomial</figcaption></figure><p id="318c" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">太小看不见？缩小它！</p><figure class="mk ml mm mn gt mo gh gi paragraph-image"><div role="button" tabindex="0" class="mx my di mz bf na"><div class="gh gi nc"><img src="../Images/9921d923d3f277e41c0dad4d28693217.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vmL_7GgJfwWcEcWjD36nyw.png"/></div></div><figcaption class="mr ms gj gh gi mt mu bd b be z dk">Gaps between Linear and Polynomial</figcaption></figure><p id="db18" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">比用<a class="ae mi" rel="noopener" target="_blank" href="/machine-learning-simple-linear-regression-with-python-f04ecfdadc13">线性回归</a>准确的多<strong class="kh ir"> 7.75 倍</strong>！</p><p id="abe6" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">那么我们 5.5 叶候选人的工资怎么算呢？我们可以用平均值来快速计算。因为 5.5 是 5 和 6 的平均值，所以工资可以计算为:</p><blockquote class="nd ne nf"><p id="70dc" class="kf kg lb kh b ki kj jr kk kl km ju kn ng kp kq kr nh kt ku kv ni kx ky kz la ij bi translated">(150，000 + 110，000)/2 =<strong class="kh ir"/>130，000 美元</p></blockquote><p id="31cc" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="lb">注:如果你不知道什么是均值，请阅读我之前关于</em> <a class="ae mi" href="https://medium.com/@nhan.tran/mean-median-an-mode-in-statistics-3359d3774b0b" rel="noopener"> <em class="lb">均值、中位数、众数</em> </a> <em class="lb">的帖子。谢了。</em></p><p id="35ac" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">但是不是最高准确率而且太手动！让我们应用机器学习来获得更精确和灵活的计算。是时候启动您的 Spyder IDE 了！</p><h1 id="9e87" class="ll lm iq bd ln lo lp lq lr ls lt lu lv jw lw jx lx jz ly ka lz kc ma kd mb mc bi translated">用 Python 实现多项式回归</h1><p id="32e6" class="pw-post-body-paragraph kf kg iq kh b ki md jr kk kl me ju kn ko mf kq kr ks mg ku kv kw mh ky kz la ij bi translated">在这个例子中，我们必须使用 4 个库作为<code class="fe nj nk nl nm b">numpy</code>、<code class="fe nj nk nl nm b">pandas</code>、<code class="fe nj nk nl nm b">matplotlib</code>和<code class="fe nj nk nl nm b">sklearn</code>。现在我们必须先导入库并获取数据集:</p><figure class="mk ml mm mn gt mo"><div class="bz fp l di"><div class="nn no l"/></div></figure><p id="a1b8" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">代码解释:</p><ul class=""><li id="959f" class="lc ld iq kh b ki kj kl km ko le ks lf kw lg la lh li lj lk bi translated"><code class="fe nj nk nl nm b">dataset</code>:该表包含了我们 csv 文件中的所有值</li><li id="76d1" class="lc ld iq kh b ki np kl nq ko nr ks ns kw nt la lh li lj lk bi translated"><code class="fe nj nk nl nm b">X</code>:第 2 列，包含年经验数组</li><li id="4fe5" class="lc ld iq kh b ki np kl nq ko nr ks ns kw nt la lh li lj lk bi translated"><code class="fe nj nk nl nm b">y</code>:包含薪资数组的最后一列</li></ul><p id="33d0" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我们分割我们的<code class="fe nj nk nl nm b">dataset</code>来得到训练集和测试集(每个集的<code class="fe nj nk nl nm b">X</code>和<code class="fe nj nk nl nm b">y</code>值)</p><figure class="mk ml mm mn gt mo"><div class="bz fp l di"><div class="nn no l"/></div></figure><p id="17a4" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">代码解释:</p><ul class=""><li id="a618" class="lc ld iq kh b ki kj kl km ko le ks lf kw lg la lh li lj lk bi translated"><code class="fe nj nk nl nm b">test_size=0.2</code>:我们将把<code class="fe nj nk nl nm b">dataset</code> (10 个观察值)分成两部分(训练集、测试集)，并且<strong class="kh ir">测试集</strong>与<code class="fe nj nk nl nm b">dataset</code>的比率为 0.2 (2 个观察值将被放入<strong class="kh ir">测试集</strong>)。你可以放 1/5 得到 20%或者 0.2，它们是一样的。我们不应该让测试集太大；如果它太大，我们将缺乏数据来训练。通常情况下，我们应该选择 5%到 30%左右。</li><li id="0bb8" class="lc ld iq kh b ki np kl nq ko nr ks ns kw nt la lh li lj lk bi translated"><code class="fe nj nk nl nm b">train_size</code>:如果我们已经使用了 test_size，剩余的数据将自动分配给 train_size。</li><li id="91cb" class="lc ld iq kh b ki np kl nq ko nr ks ns kw nt la lh li lj lk bi translated"><code class="fe nj nk nl nm b">random_state</code>:这是随机数发生器的种子。我们也可以放一个<code class="fe nj nk nl nm b">RandomState</code>类的实例。如果我们将其留空或为 0，将使用由<code class="fe nj nk nl nm b">np.random</code>使用的<code class="fe nj nk nl nm b">RandomState</code>实例。</li></ul><p id="a99a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们已经有了训练集和测试集，现在我们必须建立回归模型。首先，我们将建立一个线性回归模型并将其可视化(在您的练习中不需要包括这一步，我们这样做只是为了比较线性和多项式):</p><figure class="mk ml mm mn gt mo"><div class="bz fp l di"><div class="nn no l"/></div></figure><p id="34b3" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">调用<code class="fe nj nk nl nm b">viz_linear()</code>函数后，可以看到如下图:</p><figure class="mk ml mm mn gt mo gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/b507bdb2abaebdc42643fcb8f48ba89a.png" data-original-src="https://miro.medium.com/v2/resize:fit:916/format:webp/1*DjTVG--vpDatHO_rthBx6w.png"/></div><figcaption class="mr ms gj gh gi mt mu bd b be z dk">Linear Regression model visualization</figcaption></figure><p id="deff" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">另一方面，我们将构建多项式回归模型，并将其可视化以查看差异:</p><figure class="mk ml mm mn gt mo"><div class="bz fp l di"><div class="nn no l"/></div></figure><p id="ab0f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">调用<code class="fe nj nk nl nm b">viz_polynomial()</code>函数后，可以看到如下图:</p><figure class="mk ml mm mn gt mo gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/52bc12768a9216808a0e556fe321e9e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:930/format:webp/1*a7p7coMEhk25rOmgnP2PJg.png"/></div><figcaption class="mr ms gj gh gi mt mu bd b be z dk">Polynomial Regression model visualization</figcaption></figure><p id="5a6f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">最后一步，让我们使用线性回归模型和多项式回归模型来预测候选值(5.5 YE):</p><figure class="mk ml mm mn gt mo"><div class="bz fp l di"><div class="nn no l"/></div></figure><p id="d539" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">你可以看到，使用线性回归模型和多项式回归模型的预测值是完全不同的！</p><figure class="mk ml mm mn gt mo gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/bbb334f665bd2ad3901d44af59936d29.png" data-original-src="https://miro.medium.com/v2/resize:fit:1044/format:webp/1*9vL5COoBBgrf7kl4Vol8gA.png"/></div><figcaption class="mr ms gj gh gi mt mu bd b be z dk">Comparison between <code class="fe nj nk nl nm b">lin_reg</code> and <code class="fe nj nk nl nm b">pol_reg</code></figcaption></figure><p id="6d9c" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我们向上滚动，再次检查我们得到了什么？根据我们的数据集，我们的工资应该是:</p><blockquote class="nd ne nf"><p id="f0a3" class="kf kg lb kh b ki kj jr kk kl km ju kn ng kp kq kr nh kt ku kv ni kx ky kz la ij bi translated">11 万美元&lt; the salary &lt; $150,000</p></blockquote><p id="e32c" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">But the predicted salary using Linear Regression  【T0】  is <strong class="kh ir">24.95 万美元</strong>。无法接受<em class="lb">(但根据线性回归还是在-1 万到 30 万的范围内)</em>！用多项式回归怎么样？我们的<code class="fe nj nk nl nm b">pol_reg</code>值为<strong class="kh ir">132，148.43750 美元</strong>，非常接近我们的<strong class="kh ir">平均值 130，000 美元</strong>。</p><p id="a2a5" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">答对了。是时候让我们的候选人知道我们将为他提供 132，148 美元的最高工资了！</p></div><div class="ab cl nx ny hu nz" role="separator"><span class="oa bw bk ob oc od"/><span class="oa bw bk ob oc od"/><span class="oa bw bk ob oc"/></div><div class="ij ik il im in"><p id="8ac2" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在结束我的帖子之前，这里是我们完整的源代码和数据集，供你在操场上练习:</p><ul class=""><li id="176f" class="lc ld iq kh b ki kj kl km ko le ks lf kw lg la lh li lj lk bi translated"><a class="ae mi" href="https://s3.us-west-2.amazonaws.com/public.gamelab.fun/dataset/position_salaries.csv" rel="noopener ugc nofollow" target="_blank">position _ salary . CSV</a></li><li id="b084" class="lc ld iq kh b ki np kl nq ko nr ks ns kw nt la lh li lj lk bi translated"><a class="ae mi" href="https://gist.github.com/panicpotatoe/dcc956002ed879394e91d184c227a520" rel="noopener ugc nofollow" target="_blank">多项式 _ 回归. py </a></li></ul><p id="0831" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">天天快乐学习！</p></div></div>    
</body>
</html>