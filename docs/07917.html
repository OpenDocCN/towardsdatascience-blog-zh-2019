<html>
<head>
<title>Pandas from basic to advanced for Data Scientists</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">数据科学家从基础到高级的熊猫</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/pandas-from-basic-to-advanced-for-data-scientists-aee4eed19cfe?source=collection_archive---------17-----------------------#2019-11-01">https://towardsdatascience.com/pandas-from-basic-to-advanced-for-data-scientists-aee4eed19cfe?source=collection_archive---------17-----------------------#2019-11-01</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="43a9" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">熊猫让任何数据科学家的生活更轻松</h2></div><blockquote class="kf"><p id="db8b" class="kg kh iq bd ki kj kk kl km kn ko kp dk translated">数据科学家是能够获取、筛选、探索、建模和解释数据的人，融合了黑客技术、统计学和机器学习——希拉里·梅森</p></blockquote><figure class="kr ks kt ku kv kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kq"><img src="../Images/2a7c0c81065bb1c19cabb7594cc9b104.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qYfx1TodJIzhyWs2-gW_jQ.jpeg"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk">image by <a class="ae lh" href="https://unsplash.com/@julilona" rel="noopener ugc nofollow" target="_blank">Ilona Froehlich</a></figcaption></figure><blockquote class="li lj lk"><p id="eb1b" class="ll lm ln lo b lp lq jr lr ls lt ju lu lv lw lx ly lz ma mb mc md me mf mg kp ij bi translated">哪里有烟，哪里就有火。同样，如果你在处理数据，熊猫也不会休假。它帮助您尽可能快地探索和解释数据。</p></blockquote><blockquote class="kf"><p id="8fa9" class="kg kh iq bd ki kj kk kl km kn ko kp dk translated">Pandas 是最常用的 python 库，用于数据操作和数据分析。</p></blockquote><p id="3b6e" class="pw-post-body-paragraph ll lm iq lo b lp mh jr lr ls mi ju lu mj mk lx ly ml mm mb mc mn mo mf mg kp ij bi translated">在这篇文章中，我将尝试解决熊猫的概念或技巧，使我们的生活更容易。让我们从基础到高级。我将在天气数据的帮助下穿过熊猫。</p></div><div class="ab cl mp mq hu mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="ij ik il im in"><h1 id="7808" class="mw mx iq bd my mz na nb nc nd ne nf ng jw nh jx ni jz nj ka nk kc nl kd nm nn bi translated">导入熊猫并创建数据框</h1><p id="9aec" class="pw-post-body-paragraph ll lm iq lo b lp no jr lr ls np ju lu mj nq lx ly ml nr mb mc mn ns mf mg kp ij bi translated">使用文件、列表、字典等创建数据框的方法有很多种。这里，我通过从 CSV 文件中读取数据创建了一个数据框。</p><pre class="nt nu nv nw gt nx ny nz oa aw ob bi"><span id="8b84" class="oc mx iq ny b gy od oe l of og">import pandas as pd</span><span id="beb5" class="oc mx iq ny b gy oh oe l of og">df = pd.read_csv("weather.csv")<br/>df</span></pre><blockquote class="li lj lk"><p id="3f60" class="ll lm ln lo b lp lq jr lr ls lt ju lu lv lw lx ly lz ma mb mc md me mf mg kp ij bi translated">输出</p></blockquote><figure class="nt nu nv nw gt kw gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/beab3bf27b6584e3b35339125000eb7d.png" data-original-src="https://miro.medium.com/v2/resize:fit:872/format:webp/1*l4So6A2ID80606VZcaoarg.png"/></div><figcaption class="ld le gj gh gi lf lg bd b be z dk">Weather data</figcaption></figure><h1 id="fd74" class="mw mx iq bd my mz oj nb nc nd ok nf ng jw ol jx ni jz om ka nk kc on kd nm nn bi translated">选择特定的列</h1><p id="a7a8" class="pw-post-body-paragraph ll lm iq lo b lp no jr lr ls np ju lu mj nq lx ly ml nr mb mc mn ns mf mg kp ij bi translated">有时您只需要操作或操纵特定的列。让我们假设你想分析温度每天是如何变化的。在这种情况下，我们将选择温度和日期。</p><pre class="nt nu nv nw gt nx ny nz oa aw ob bi"><span id="9566" class="oc mx iq ny b gy od oe l of og">df[[‘temperature’,’day’]]</span></pre><h1 id="75fe" class="mw mx iq bd my mz oj nb nc nd ok nf ng jw ol jx ni jz om ka nk kc on kd nm nn bi translated">重命名该列</h1><p id="75bc" class="pw-post-body-paragraph ll lm iq lo b lp no jr lr ls np ju lu mj nq lx ly ml nr mb mc mn ns mf mg kp ij bi translated">Pandas 为您提供了一个简单的功能(重命名),可以更改一个或一组列的名称，从而简化工作。</p><pre class="nt nu nv nw gt nx ny nz oa aw ob bi"><span id="b843" class="oc mx iq ny b gy od oe l of og">df.rename(columns = {‘temperature’: ‘temp’, ‘event’:’eventtype’})</span></pre><h1 id="c2a6" class="mw mx iq bd my mz oj nb nc nd ok nf ng jw ol jx ni jz om ka nk kc on kd nm nn bi translated">过滤数据帧</h1><p id="c08d" class="pw-post-body-paragraph ll lm iq lo b lp no jr lr ls np ju lu mj nq lx ly ml nr mb mc mn ns mf mg kp ij bi translated">假设你想看看随着日期的推移越来越热的城市。</p><pre class="nt nu nv nw gt nx ny nz oa aw ob bi"><span id="2cc3" class="oc mx iq ny b gy od oe l of og">df[[‘day’,’city’]][df.event==’Sunny’]</span></pre><blockquote class="li lj lk"><p id="7bd1" class="ll lm ln lo b lp lq jr lr ls lt ju lu lv lw lx ly lz ma mb mc md me mf mg kp ij bi translated">输出</p></blockquote><figure class="nt nu nv nw gt kw gh gi paragraph-image"><div class="gh gi oo"><img src="../Images/4e5f307e437fa4218d0ebcf60efbba4c.png" data-original-src="https://miro.medium.com/v2/resize:fit:352/format:webp/1*y-cBoeQZ2PpDEzCaPbd1CQ.png"/></div><figcaption class="ld le gj gh gi lf lg bd b be z dk">Filtered data</figcaption></figure><blockquote class="li lj lk"><p id="522c" class="ll lm ln lo b lp lq jr lr ls lt ju lu lv lw lx ly lz ma mb mc md me mf mg kp ij bi translated">到目前为止，我们已经看到了一些基础知识，让我们深入了解，真正的熊猫从这里开始。正如我所说，熊猫永远不会休假，即使你想有复杂的问题。</p></blockquote></div><div class="ab cl mp mq hu mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="ij ik il im in"><h1 id="fc8f" class="mw mx iq bd my mz na nb nc nd ne nf ng jw nh jx ni jz nj ka nk kc nl kd nm nn bi translated">分组</h1><p id="d358" class="pw-post-body-paragraph ll lm iq lo b lp no jr lr ls np ju lu mj nq lx ly ml nr mb mc mn ns mf mg kp ij bi translated">假设你想操作一组特定的数据。在这种情况下，让我们只获取属于纽约的行。使用 group object，您可以同时获得所有组的总和、平均值和中值。</p><blockquote class="li lj lk"><p id="d002" class="ll lm ln lo b lp lq jr lr ls lt ju lu lv lw lx ly lz ma mb mc md me mf mg kp ij bi translated"><strong class="lo ir">按城市分组</strong></p></blockquote><pre class="nt nu nv nw gt nx ny nz oa aw ob bi"><span id="baf9" class="oc mx iq ny b gy od oe l of og">city_group = df.groupby(‘city’)</span></pre><p id="531e" class="pw-post-body-paragraph ll lm iq lo b lp lq jr lr ls lt ju lu mj lw lx ly ml ma mb mc mn me mf mg kp ij bi translated">一个组对象被创建，如果你想看到特定的组数据，只需要得到组。</p><pre class="nt nu nv nw gt nx ny nz oa aw ob bi"><span id="ec02" class="oc mx iq ny b gy od oe l of og">city_group.get_group(‘new york’)</span></pre><blockquote class="li lj lk"><p id="b375" class="ll lm ln lo b lp lq jr lr ls lt ju lu lv lw lx ly lz ma mb mc md me mf mg kp ij bi translated"><strong class="lo ir">输出</strong></p></blockquote><figure class="nt nu nv nw gt kw gh gi paragraph-image"><div class="gh gi op"><img src="../Images/decbfbff0fe3b6ab8863e4fb3329aa1c.png" data-original-src="https://miro.medium.com/v2/resize:fit:862/format:webp/1*Eht3RbhED0sjC656MJVLrA.png"/></div><figcaption class="ld le gj gh gi lf lg bd b be z dk">new york group</figcaption></figure><h1 id="7bfd" class="mw mx iq bd my mz oj nb nc nd ok nf ng jw ol jx ni jz om ka nk kc on kd nm nn bi translated">聚集</h1><p id="cbc1" class="pw-post-body-paragraph ll lm iq lo b lp no jr lr ls np ju lu mj nq lx ly ml nr mb mc mn ns mf mg kp ij bi translated">在上面的部分中，我们只是按城市对数据进行了分组，但是如果我想查看平均温度和平均风速呢？？？。我们将在这里使用聚合。</p><blockquote class="li lj lk"><p id="05af" class="ll lm ln lo b lp lq jr lr ls lt ju lu lv lw lx ly lz ma mb mc md me mf mg kp ij bi translated">分组依据和聚合</p></blockquote><pre class="nt nu nv nw gt nx ny nz oa aw ob bi"><span id="6faf" class="oc mx iq ny b gy od oe l of og">df.groupby(‘city’).agg({‘temperature’:’mean’, ‘windspeed’:’mean’})</span></pre><blockquote class="li lj lk"><p id="5569" class="ll lm ln lo b lp lq jr lr ls lt ju lu lv lw lx ly lz ma mb mc md me mf mg kp ij bi translated">输出</p></blockquote><figure class="nt nu nv nw gt kw gh gi paragraph-image"><div class="gh gi oq"><img src="../Images/0feb83e4829266a95d3a87160305c66f.png" data-original-src="https://miro.medium.com/v2/resize:fit:570/format:webp/1*KlDWoH9CYvoGqwpT77Cdaw.png"/></div><figcaption class="ld le gj gh gi lf lg bd b be z dk">Mean temperature and wind speed</figcaption></figure><h1 id="f480" class="mw mx iq bd my mz oj nb nc nd ok nf ng jw ol jx ni jz om ka nk kc on kd nm nn bi translated">合并</h1><p id="549b" class="pw-post-body-paragraph ll lm iq lo b lp no jr lr ls np ju lu mj nq lx ly ml nr mb mc mn ns mf mg kp ij bi translated">在以上各节中，我们讨论了拥有单个数据框的问题。如果有两个数据框，并且您想一起分析它们！！！。在这种情况下，合并起着关键作用，并简化了两个数据框的连接。</p><h2 id="7783" class="oc mx iq bd my or os dn nc ot ou dp ng mj ov ow ni ml ox oy nk mn oz pa nm pb bi translated">创建两个数据框</h2><pre class="nt nu nv nw gt nx ny nz oa aw ob bi"><span id="9b77" class="oc mx iq ny b gy od oe l of og">df1 = pd.DataFrame({<br/> “city”: [“new york”,”florida”,”mumbai”],<br/> “temperature”: [22,37,35],<br/>})<br/>df2 = pd.DataFrame({<br/> “city”: [“chicago”,”new york”,”florida”],<br/> “humidity”: [65,68,75],<br/>})</span></pre><p id="874e" class="pw-post-body-paragraph ll lm iq lo b lp lq jr lr ls lt ju lu mj lw lx ly ml ma mb mc mn me mf mg kp ij bi translated"><strong class="lo ir">简单合并:</strong>这给了你两个数据框中匹配的行</p><pre class="nt nu nv nw gt nx ny nz oa aw ob bi"><span id="a9ab" class="oc mx iq ny b gy od oe l of og">pd.merge(df1,df2,on=’city’)</span></pre><blockquote class="li lj lk"><p id="b9ed" class="ll lm ln lo b lp lq jr lr ls lt ju lu lv lw lx ly lz ma mb mc md me mf mg kp ij bi translated">输出</p></blockquote><figure class="nt nu nv nw gt kw gh gi paragraph-image"><div class="gh gi pc"><img src="../Images/fc7434242f422483156212475fae270d.png" data-original-src="https://miro.medium.com/v2/resize:fit:568/format:webp/1*jZ4sqOP4BPiM1dFx_XTV7A.png"/></div><figcaption class="ld le gj gh gi lf lg bd b be z dk">Matching rows of two data frames</figcaption></figure><p id="0bee" class="pw-post-body-paragraph ll lm iq lo b lp lq jr lr ls lt ju lu mj lw lx ly ml ma mb mc mn me mf mg kp ij bi translated"><strong class="lo ir"> Outer: </strong>从两个数据帧中获取所有行。添加新参数(如何)。</p><pre class="nt nu nv nw gt nx ny nz oa aw ob bi"><span id="8188" class="oc mx iq ny b gy od oe l of og">pd.merge(df1,df2,on=”city”,how=”outer”)</span></pre><blockquote class="li lj lk"><p id="3add" class="ll lm ln lo b lp lq jr lr ls lt ju lu lv lw lx ly lz ma mb mc md me mf mg kp ij bi translated">输出</p></blockquote><figure class="nt nu nv nw gt kw gh gi paragraph-image"><div class="gh gi pd"><img src="../Images/34d605070608cd7f3b5d11ceadc1fabb.png" data-original-src="https://miro.medium.com/v2/resize:fit:586/format:webp/1*c2_k0a3hRMRMivhQ1haP8g.png"/></div><figcaption class="ld le gj gh gi lf lg bd b be z dk">Outer join</figcaption></figure><p id="9336" class="pw-post-body-paragraph ll lm iq lo b lp lq jr lr ls lt ju lu mj lw lx ly ml ma mb mc mn me mf mg kp ij bi translated">类似地，我们可以获得所有匹配的行以及左数据框(左连接)和右数据框(右连接)。<em class="ln">通过指定参数 how 与值 left/right。</em></p><h1 id="cd82" class="mw mx iq bd my mz oj nb nc nd ok nf ng jw ol jx ni jz om ka nk kc on kd nm nn bi translated">交叉表</h1><p id="3d20" class="pw-post-body-paragraph ll lm iq lo b lp no jr lr ls np ju lu mj nq lx ly ml nr mb mc mn ns mf mg kp ij bi translated">假设您想要查看每个城市中事件类型(雨天/晴天)的频率计数。十字标签使这些事情变得更容易。</p><pre class="nt nu nv nw gt nx ny nz oa aw ob bi"><span id="d9ce" class="oc mx iq ny b gy od oe l of og">pd.crosstab(df.city,df.event)</span></pre><blockquote class="li lj lk"><p id="6e41" class="ll lm ln lo b lp lq jr lr ls lt ju lu lv lw lx ly lz ma mb mc md me mf mg kp ij bi translated">输出</p></blockquote><figure class="nt nu nv nw gt kw gh gi paragraph-image"><div class="gh gi pe"><img src="../Images/a648fcf63e2daa18c466cc9df696db0b.png" data-original-src="https://miro.medium.com/v2/resize:fit:716/format:webp/1*c-2cYDcU6NAlAyq9b9du7A.png"/></div><figcaption class="ld le gj gh gi lf lg bd b be z dk">Frequency count of the event by city</figcaption></figure><p id="8a92" class="pw-post-body-paragraph ll lm iq lo b lp lq jr lr ls lt ju lu mj lw lx ly ml ma mb mc mn me mf mg kp ij bi translated">注意:我们可以得到任何聚合平均值、中位数等。我们只需要给函数传递一个额外的参数。</p><h1 id="c77a" class="mw mx iq bd my mz oj nb nc nd ok nf ng jw ol jx ni jz om ka nk kc on kd nm nn bi translated">用熔体重塑</h1><p id="1ba7" class="pw-post-body-paragraph ll lm iq lo b lp no jr lr ls np ju lu mj nq lx ly ml nr mb mc mn ns mf mg kp ij bi translated">如果您希望将列作为值的行，假设对于每个城市，我希望将温度和风速放在单独的值列中。在这种情况下，温度、风速保存一列，它们的值保存另一列。</p><pre class="nt nu nv nw gt nx ny nz oa aw ob bi"><span id="0160" class="oc mx iq ny b gy od oe l of og">pd.melt(df,id_vars=[‘day’,’city’,’event’],var_name=’attribute’)</span></pre><blockquote class="li lj lk"><p id="a5d2" class="ll lm ln lo b lp lq jr lr ls lt ju lu lv lw lx ly lz ma mb mc md me mf mg kp ij bi translated">输出</p></blockquote><figure class="nt nu nv nw gt kw gh gi paragraph-image"><div class="gh gi pf"><img src="../Images/56ed42f55149e744273b4fa15059d2a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:780/format:webp/1*EQ-zVjt62YwgACBvjP-DMQ.png"/></div><figcaption class="ld le gj gh gi lf lg bd b be z dk">Reshaped data</figcaption></figure><h2 id="ede6" class="oc mx iq bd my or os dn nc ot ou dp ng mj ov ow ni ml ox oy nk mn oz pa nm pb bi translated">参考</h2><p id="8ddd" class="pw-post-body-paragraph ll lm iq lo b lp no jr lr ls np ju lu mj nq lx ly ml nr mb mc mn ns mf mg kp ij bi translated">代码基础知识，【https://www.youtube.com/channel/UCh9nVJoWXmFb7sLApWGcLPQ T2】</p><blockquote class="kf"><p id="754c" class="kg kh iq bd ki kj pg ph pi pj pk kp dk translated">希望你喜欢它！！！你也可以看看关于熊猫戏法的文章，这将会更有趣<a class="ae lh" rel="noopener" target="_blank" href="/pandas-tricks-for-data-scientists-465902163545">数据科学家的熊猫戏法</a>！！！敬请期待！！！！请对任何疑问或建议发表评论！！！！！</p></blockquote><div class="kr ks kt ku kv pl"><a rel="noopener follow" target="_blank" href="/pandas-tricks-for-data-scientists-465902163545"><div class="pm ab fo"><div class="pn ab po cl cj pp"><h2 class="bd ir gy z fp pq fr fs pr fu fw ip bi translated">数据科学家的熊猫把戏</h2><div class="ps l"><h3 class="bd b gy z fp pq fr fs pr fu fw dk translated">熊猫让任何数据科学家的生活更轻松</h3></div><div class="pt l"><p class="bd b dl z fp pq fr fs pr fu fw dk translated">towardsdatascience.com</p></div></div><div class="pu l"><div class="pv l pw px py pu pz lb pl"/></div></div></a></div></div></div>    
</body>
</html>