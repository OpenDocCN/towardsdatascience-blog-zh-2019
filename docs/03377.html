<html>
<head>
<title>How to Use ggplot2 in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在 Python 中使用 ggplot2</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-use-ggplot2-in-python-74ab8adec129?source=collection_archive---------3-----------------------#2019-05-30">https://towardsdatascience.com/how-to-use-ggplot2-in-python-74ab8adec129?source=collection_archive---------3-----------------------#2019-05-30</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="70ac" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">Python 的图形语法</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/dd65259a425a6911c989efb22767fc0c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8hEQcRXPyGH4tDHUI3VOoA.png"/></div></div></figure><h1 id="920a" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">介绍</h1><p id="bd11" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">由于严格实现了图形的语法，ggplot2 提供了一种非常直观和一致的方式来绘制数据。ggplot2 的绘图方法不仅确保每个图包含某些基本元素，而且还在很大程度上简化了代码的可读性。</p><p id="d137" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">但是，如果您经常使用 Python，那么实现图形的语法会非常具有挑战性，因为在流行的绘图库中缺乏标准化的语法，如 matplotlib 或 seaborn。如果你仍然想利用图形的语法，那么 Python 包<a class="ae mk" href="https://plotnine.readthedocs.io/en/stable/index.html" rel="noopener ugc nofollow" target="_blank"> <strong class="ll ir"> plotnine </strong> </a>为你提供了另一种选择。</p><h1 id="b35d" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">图形的语法</h1><p id="387a" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">如果您不熟悉图形的语法，这里有一个快速概述:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ml"><img src="../Images/b35bbb24641654051eddb8d6ecce751a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*l844RJyls1FraalChUtneQ.png"/></div></div><figcaption class="mm mn gj gh gi mo mp bd b be z dk">Main Components of the Grammar of Graphics</figcaption></figure><p id="9e28" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">正如您所看到的，从数据开始，有几个组件组成了图形的语法。在确定您想要可视化的数据之后，您必须指定您感兴趣的变量。例如，您可能希望在 x 轴上显示一个变量，在 y 轴上显示另一个变量。第三，你必须定义你想要使用什么类型的几何对象(简称 geom)。这可以是从条形图到散点图或任何其他现有的绘图类型。</p><p id="907a" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">前三个部分是强制性的。没有数据，就没什么好出图的。如果没有轴定义，也没有什么可绘制的。最后，如果没有定义一个几何对象，你只会看到一个空的坐标系。构成图形语法的其余组件是可选的，可以被实现来改善可视化。面是指子图的规格，也就是说，在单独的图中将数据中的几个变量一个接一个地绘制出来。统计转换主要指在图中包含汇总统计数据，如中位数或百分位数。坐标描述了可供您使用的不同坐标系。最常用和默认的坐标系是笛卡尔坐标系。根据您想要绘制的数据结构，较少使用的坐标系(如极坐标系统)可能会提供更好的数据可视化方式。最后，主题提供了各种选项来设计绘图的所有非数据元素，如图例、背景或注释。</p><p id="9558" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">虽然有许多可视化图形语法的方法，但我特别喜欢我在上面创建的一个，因为它暗示了这些层的可加性以及它们建立在彼此之上的事实。如果您曾经使用过 ggplot2，您会对其语法中的“+”很熟悉，它象征着与上述相同的思想。</p><h1 id="a6aa" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">普洛特宁</h1><p id="d516" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">plotnine 是一个 Python 包，允许您使用类似 ggplot2 的代码来实现图形语法。通过这样做，就像在 ggplot2 中一样，您能够专门将数据映射到组成可视化的可视对象。这使您能够提高代码的可读性和结构。虽然您可以将 matplotlib 的样式设置为 ggplot，但是您不能像在 ggplot2 中那样在 matplotlib 中实现图形语法。</p><h2 id="85f6" class="mq ks iq bd kt mr ms dn kx mt mu dp lb ls mv mw ld lw mx my lf ma mz na lh nb bi translated">装置</h2><p id="3ad9" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">在开始之前，你必须安装 plotnine。和往常一样，这样做有两个主要选项:pip 和 conda。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nc nd l"/></div></figure><h2 id="13d6" class="mq ks iq bd kt mr ms dn kx mt mu dp lb ls mv mw ld lw mx my lf ma mz na lh nb bi translated">测绘</h2><p id="274e" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">安装 plotnine 后，您可以使用图形语法开始绘图。让我们从构建一个非常简单的情节开始，只使用三个必要的组件:数据、美学和几何对象。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ne"><img src="../Images/a103e0bca9f924cdfe09a66bc27ecb35.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hd6-LkI_sy4b4nu720eV_A.png"/></div></div><figcaption class="mm mn gj gh gi mo mp bd b be z dk">Building a plot using the grammar of graphics</figcaption></figure><p id="1cf3" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">可以看到，语法非常类似于 ggplot2。首先，我们指定数据源。在我们的例子中，我们使用的数据是经典的 mpg 数据集。接下来，我们定义变量“class”将显示在 x 轴上。最后，我们说我们希望使用一个大小为 20 的条形图来可视化我们的数据。让我们看看完整的代码和结果图:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nc nd l"/></div></figure><p id="72af" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">上面的代码将产生以下输出:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/ede30aaa0ae154f7f3e36c782b95876f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1124/format:webp/1*-Uq3ZJX_beWW2yvLQ5XnPw.png"/></div></figure><p id="23eb" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">虽然这是一个好的开始，但看起来还不是很好。让我们用图形语法的其他成分来美化我们的情节。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nc nd l"/></div></figure><p id="7556" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">例如，我们可以使用<strong class="ll ir"> coord_flip() </strong>翻转轴，并使用<strong class="ll ir"> labs() </strong>定制绘图和轴标题，以改进我们的绘图。使用上面的代码块，我们的绘图将如下所示:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/c2d1575e2a176890f5768935a224e10e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1242/format:webp/1*xg3ZRFodxInobNRJ4-rBsw.png"/></div></figure><h2 id="69d7" class="mq ks iq bd kt mr ms dn kx mt mu dp lb ls mv mw ld lw mx my lf ma mz na lh nb bi translated">绘制多维数据</h2><p id="cdeb" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">除了基本的绘图之外，您还可以做几乎所有在 ggplot2 中可以做的事情，比如绘制多维数据。如果您希望可视化三个变量之间的关系，您可以为二维图增加美感:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nc nd l"/></div></figure><p id="60ea" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">将<strong class="ll ir">颜色</strong>添加到美学中将促使 plotnine 在其 x 轴上使用<strong class="ll ir"> displ </strong>(发动机排量，以升为单位)并在其 y 轴上使用<strong class="ll ir"> hwy </strong>(公路里程/加仑)显示二维图，并根据变量<strong class="ll ir"> class </strong>对数据进行着色。我们还将几何对象切换到<strong class="ll ir"> geom_point() </strong>，这将给我们一个散点图而不是条形图。让我们来看看那会是什么样子:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nh"><img src="../Images/df6d68fb31db4ad4ad9f2d1ad71560ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5eTTY3NHVxufJxWQ71TapQ.png"/></div></div></figure><h1 id="b1dc" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">结论</h1><p id="f5dc" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">如您所见，plotnine 为您提供了利用 Python 中图形语法的能力。这增加了代码的可读性，并允许您专门将部分数据映射到可视对象。如果你已经熟悉了 ggplot2，那么你就不需要学习任何新的东西来掌握 plotnine。如果没有，这里有一个到 ggplot2 网站的<a class="ae mk" href="https://ggplot2.tidyverse.org/" rel="noopener ugc nofollow" target="_blank">链接，在这里你可以找到更多关于图形语法和所有类型的几何对象的信息。</a></p></div></div>    
</body>
</html>