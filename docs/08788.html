<html>
<head>
<title>Semi-Supervised Face Tagging</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">半监督人脸标记</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/semi-supervised-face-tagging-2d9c314103e?source=collection_archive---------37-----------------------#2019-11-24">https://towardsdatascience.com/semi-supervised-face-tagging-2d9c314103e?source=collection_archive---------37-----------------------#2019-11-24</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="d519" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">使用人工智能构建您自己的自动人脸标记应用程序</h2></div><p id="a46b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">自动面部标记是指当你从手机中点击一张新图片并将其上传到社交媒体时，它能够识别图像中的人，并建议你标记他们。它广泛出现在各种应用程序和平台中，包括谷歌照片和脸书。</p><p id="cd70" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我的目标是构建一个应用程序，可以将所有相似的面孔组合在一起。该应用程序应该是健壮的，应该根据添加的图像进行调整，而不需要任何人工干预。</p><blockquote class="lb lc ld"><p id="5b31" class="kf kg le kh b ki kj jr kk kl km ju kn lf kp kq kr lg kt ku kv lh kx ky kz la ij bi translated">这可能是你的数据科学项目之一，可以为你的简历增加价值。</p></blockquote><p id="a398" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这是我期望系统做的-</p><ul class=""><li id="d4cb" class="li lj iq kh b ki kj kl km ko lk ks ll kw lm la ln lo lp lq bi translated">将相似的图像分组在一起；我只需要给它们贴上标签。</li><li id="df48" class="li lj iq kh b ki lr kl ls ko lt ks lu kw lv la ln lo lp lq bi translated">在任何新图像的情况下，它应该自动处理它们。它应该直接问我新面孔的标签。</li><li id="9116" class="li lj iq kh b ki lr kl ls ko lt ks lu kw lv la ln lo lp lq bi translated">只需点击一个按钮或脚本，即可改进(重新培训)系统。</li></ul><p id="f886" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这是我遵循的方法。</p><h2 id="a26a" class="lw lx iq bd ly lz ma dn mb mc md dp me ko mf mg mh ks mi mj mk kw ml mm mn mo bi translated">无人监督的</h2><p id="82b8" class="pw-post-body-paragraph kf kg iq kh b ki mp jr kk kl mq ju kn ko mr kq kr ks ms ku kv kw mt ky kz la ij bi translated">我想到的第一个方法是使用 K-Means 聚类算法。我想把相似的面孔聚集在一起，但有一个问题。您需要指定想要组成的组的数量。这给你如何决定一个最佳的 k 值制造了许多障碍。</p><p id="d04f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，如果你有 400 张照片想要添加标签，但令人惊讶的是，所有的照片都是同一个人。在这种情况下，确定 k 的最佳值几乎是不可能的。</p><p id="88de" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这种方法没有像我预期的那样奏效。</p><h2 id="7103" class="lw lx iq bd ly lz ma dn mb mc md dp me ko mf mg mh ks mi mj mk kw ml mm mn mo bi translated">监督</h2><p id="003b" class="pw-post-body-paragraph kf kg iq kh b ki mp jr kk kl mq ju kn ko mr kq kr ks ms ku kv kw mt ky kz la ij bi translated">我需要某种监督学习，因此我决定用 KNN 算法。我创建了一个文件夹，其中有以图像名称作为标签的唯一图像。它的工作，但这不是我最初想要的。</p><p id="a666" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果我试着在一些相似的新图像上使用它，那么它不会把它们聚集在一起。它只是要告诉他们是否属于被监督的组。</p><p id="b268" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">此外，随着不同的新面孔的加入，我需要在代表该群体的独特图像上重新训练模型。工作量太大了。</p><h2 id="ca26" class="lw lx iq bd ly lz ma dn mb mc md dp me ko mf mg mh ks mi mj mk kw ml mm mn mo bi translated">半监督的</h2><p id="2ee5" class="pw-post-body-paragraph kf kg iq kh b ki mp jr kk kl mq ju kn ko mr kq kr ks ms ku kv kw mt ky kz la ij bi translated">如果你的算法超级聪明，可以像聚类一样将相似的脸分组在一起，但没有指定 k 值，那会怎么样？这就是为什么我称这种方法为半监督。</p><p id="fbd5" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">所以，这就是我们要做的。</p><ol class=""><li id="f01f" class="li lj iq kh b ki kj kl km ko lk ks ll kw lm la mu lo lp lq bi translated">将所有需要标记的图像复制到一个文件夹中。</li><li id="08b9" class="li lj iq kh b ki lr kl ls ko lt ks lu kw lv la mu lo lp lq bi translated">迭代图像，找到所有图像的面部标志点，并将它们存储在字典中。</li><li id="6287" class="li lj iq kh b ki lr kl ls ko lt ks lu kw lv la mu lo lp lq bi translated">获取第一幅图像及其面部标志点，并在其上训练 KNN。</li><li id="dc31" class="li lj iq kh b ki lr kl ls ko lt ks lu kw lv la mu lo lp lq bi translated">迭代所有剩余的图像，并尝试用新的关键点预测结果。如果它们匹配，则认为它是相同的图像，否则在其上训练新的分类器。</li><li id="7056" class="li lj iq kh b ki lr kl ls ko lt ks lu kw lv la mu lo lp lq bi translated">最终，每个集群都有一个单独的 KNN 模型。</li></ol><p id="1112" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这种方法可能看起来有点奇怪，但是让我们了解一下在处理一些新图像时它的一些好处。</p><p id="4940" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们正在考虑一些新图像需要预处理的情况。</p><ol class=""><li id="e719" class="li lj iq kh b ki kj kl km ko lk ks ll kw lm la mu lo lp lq bi translated">我们将通过已经存在的每个分类器来预测新图像的结果。如果它与其中任何一个匹配，那么它将被添加到该组。</li><li id="eb8b" class="li lj iq kh b ki lr kl ls ko lt ks lu kw lv la mu lo lp lq bi translated">在不匹配的情况下，将执行类似于训练的步骤，并且将训练新的分类器，并且将在其上预测所有剩余的图像。</li></ol><p id="0a36" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这是开始自动面部标记的最基本的方法之一。</p><p id="5cb5" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">那么，我们如何给被创建的组贴标签呢？</p><p id="8f51" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我有一个想法，但不是最聪明的。您需要创建一个映射，将一个人的名字与该组进行映射。每当添加新图像时，它会告诉使用该映射的人的姓名。听起来很酷，对吧？</p><p id="88db" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这是 GitHub 回购协议的链接。</p><h2 id="740b" class="lw lx iq bd ly lz ma dn mb mc md dp me ko mf mg mh ks mi mj mk kw ml mm mn mo bi translated">装置</h2><p id="bdd5" class="pw-post-body-paragraph kf kg iq kh b ki mp jr kk kl mq ju kn ko mr kq kr ks ms ku kv kw mt ky kz la ij bi translated">我在普通的 python 环境下安装 dlib 有困难，这就是我选择 Docker 的原因。</p><p id="7ca3" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果你已经成功安装了工作 dlib，那么只需将<em class="le">face _ recognition _ API . py</em>文件复制到半监督或监督文件夹，你需要将方法从 docker 改为 direct type。</p><p id="2a4a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果你不想要这种混乱，那么就使用 docker。如果你想了解更多关于 Docker 的信息，这里有一个链接。</p><div class="mw mx gp gr my mz"><a rel="noopener follow" target="_blank" href="/docker-made-easy-for-data-scientists-b32efbc23165"><div class="na ab fo"><div class="nb ab nc cl cj nd"><h2 class="bd ir gy z fp ne fr fs nf fu fw ip bi translated">Docker 让数据科学家变得简单</h2><div class="ng l"><h3 class="bd b gy z fp ne fr fs nf fu fw dk translated">使用 Docker 的机器学习模型部署中的动手学习，并提供各种示例。</h3></div><div class="nh l"><p class="bd b dl z fp ne fr fs nf fu fw dk translated">towardsdatascience.com</p></div></div><div class="ni l"><div class="nj l nk nl nm ni nn no mz"/></div></div></a></div><p id="2fac" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">要使用 Docker way(假设您已经安装了 Docker ),请在面部标志 API 文件夹中键入以下命令。</p><pre class="np nq nr ns gt nt nu nv nw aw nx bi"><span id="964a" class="lw lx iq nu b gy ny nz l oa ob">$ docker build -t facial_landmark_api .<br/>$ docker run -d -p 5000:5000 facial_landmark_api</span></pre><p id="47b4" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">要检查 docker 容器是否正在运行，请键入</p><pre class="np nq nr ns gt nt nu nv nw aw nx bi"><span id="ef05" class="lw lx iq nu b gy ny nz l oa ob">$ docker ps -a</span></pre><p id="0d2b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">你会看到一个集装箱在运行。</p><p id="3743" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在此之后，将所有您想要分类的图像复制到图像文件夹中(在半监督文件夹中)。然后简单运行<em class="le"> classify.py </em>文件。</p><p id="da32" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这个项目从一开始就很好。</p></div><div class="ab cl oc od hu oe" role="separator"><span class="of bw bk og oh oi"/><span class="of bw bk og oh oi"/><span class="of bw bk og oh"/></div><div class="ij ik il im in"><p id="cd31" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这里有一些你可以贡献的东西。</p><ol class=""><li id="5868" class="li lj iq kh b ki kj kl km ko lk ks ll kw lm la mu lo lp lq bi translated">将重新训练模型的脚本。</li><li id="c033" class="li lj iq kh b ki lr kl ls ko lt ks lu kw lv la mu lo lp lq bi translated">考虑到我们希望面向百万用户进行扩展，这是一个更好的架构。</li><li id="555d" class="li lj iq kh b ki lr kl ls ko lt ks lu kw lv la mu lo lp lq bi translated">任何你想补充的东西。</li></ol><p id="2ce5" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">快乐学习！</p></div></div>    
</body>
</html>