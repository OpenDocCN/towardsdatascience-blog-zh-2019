<html>
<head>
<title>Demystifying the Confusion Matrix</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">揭开困惑矩阵的神秘面纱</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/demystifying-the-confusion-matrix-d8ee2497da4d?source=collection_archive---------23-----------------------#2019-12-18">https://towardsdatascience.com/demystifying-the-confusion-matrix-d8ee2497da4d?source=collection_archive---------23-----------------------#2019-12-18</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="f8d2" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">不像名字暗示的那样令人困惑！</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/f4a20d8700fa3f88a0dfa7eb425a1dff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*mH44qCUOBO56aXRi"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Photo by <a class="ae ky" href="https://unsplash.com/@armgd?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Nicolas Gras</a> on <a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="aab4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi lv translated">混淆矩阵广泛用于评估监督机器学习分类器。它为我们提供了一种方法来可视化模型在预测测试观察的类别方面的能力。它由实际标签与模型预测值的关联表组成。为了简单起见，假设我们正在评估的分类器是二元的，即只有两种可能的结果，阳性(+)或阴性(-)。</p><p id="718a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在二元分类器中，一个<strong class="lb iu"> <em class="me">的正确预测</em> </strong>可能以两种方式之一发生:</p><ol class=""><li id="3dca" class="mf mg it lb b lc ld lf lg li mh lm mi lq mj lu mk ml mm mn bi translated">正实例被模型预测为正(<strong class="lb iu"> <em class="me">真正</em> </strong>或<strong class="lb iu"> <em class="me"> TP </em> </strong>)</li><li id="8aeb" class="mf mg it lb b lc mo lf mp li mq lm mr lq ms lu mk ml mm mn bi translated">负实例被模型预测为负实例(<strong class="lb iu"> <em class="me">真负</em> </strong>或<strong class="lb iu"> <em class="me"> TN </em> </strong>)</li></ol><p id="31b7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这两种情况下，我们都对结果感到满意。毕竟，任何分类器的最终目标都是正确区分正例与反例，并相应地对它们进行标记。</p><p id="cb4c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">同样，一个<strong class="lb iu"> <em class="me">误分类</em> </strong>可能以两种方式之一发生:</p><ol class=""><li id="e61e" class="mf mg it lb b lc ld lf lg li mh lm mi lq mj lu mk ml mm mn bi translated">正实例被模型预测为负实例(<strong class="lb iu"> <em class="me">假阴性</em> </strong>或<strong class="lb iu"> <em class="me"> FN </em> </strong>)</li><li id="3768" class="mf mg it lb b lc mo lf mp li mq lm mr lq ms lu mk ml mm mn bi translated">一个阴性实例被模型预测为阳性(<strong class="lb iu"> <em class="me">假阳性</em> </strong>或<strong class="lb iu"> <em class="me"> FP </em> </strong>)</li></ol><p id="2f19" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一个错误分类是<strong class="lb iu"> <em class="me">永远不会</em> </strong>在机器学习算法中可取的。根据数据集和正在研究的现象，一个<strong class="lb iu"> <em class="me">假阴性</em> </strong>或一个<strong class="lb iu"> <em class="me">假阳性</em> </strong>可能比另一个有更严重的影响。</p><p id="3fbd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面的<strong class="lb iu">混淆矩阵</strong>总结了上述信息。在继续下面的解释之前，花点时间理解这个图表。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mt"><img src="../Images/4eb42f99b77c7422c20e430a1bb74962.png" data-original-src="https://miro.medium.com/v2/resize:fit:700/format:webp/1*Osri81WRzUEFYHf8Tyi_1Q.png"/></div></figure><p id="bd74" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们来看看可能从混淆矩阵中导出的一些<strong class="lb iu"> <em class="me">度量</em> </strong>。</p><ul class=""><li id="40e6" class="mf mg it lb b lc ld lf lg li mh lm mi lq mj lu mu ml mm mn bi translated">准确(性)</li><li id="ed8f" class="mf mg it lb b lc mo lf mp li mq lm mr lq ms lu mu ml mm mn bi translated">精确</li><li id="498e" class="mf mg it lb b lc mo lf mp li mq lm mr lq ms lu mu ml mm mn bi translated">回忆</li><li id="5f4c" class="mf mg it lb b lc mo lf mp li mq lm mr lq ms lu mu ml mm mn bi translated">特征</li><li id="c1a6" class="mf mg it lb b lc mo lf mp li mq lm mr lq ms lu mu ml mm mn bi translated">假阳性率</li><li id="14d1" class="mf mg it lb b lc mo lf mp li mq lm mr lq ms lu mu ml mm mn bi translated">F1 分数</li></ul><h2 id="2351" class="mv mw it bd mx my mz dn na nb nc dp nd li ne nf ng lm nh ni nj lq nk nl nm nn bi translated">准确(性)</h2><p id="36f6" class="pw-post-body-paragraph kz la it lb b lc no ju le lf np jx lh li nq lk ll lm nr lo lp lq ns ls lt lu im bi translated">自然倾向于将<strong class="lb iu"> <em class="me">准确度</em> </strong>作为运行分类模型后的性能衡量标准。</p><p id="3435" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu"> <em class="me">准确度=正确预测值/总观测值</em> </strong></p><p id="d520" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">由于英语语法中单词 accuracy 的含义，当考虑分类器的性能时，很容易假设这是最佳度量。准确性衡量分类器“<strong class="lb iu"><em class="me"/></strong>t”获得正确的频率，作为与<strong class="lb iu"> <em class="me">总观察值</em> </strong>的比率。当数据集<strong class="lb iu"><em class="me"/></strong>不平衡时，准确性问题更加普遍，因为许多机器学习分类器偏向于<strong class="lb iu"> <em class="me">多数类</em> </strong>。在这些情况下，存在成为<strong class="lb iu"> <em class="me">准确性悖论</em> </strong>的牺牲品的风险。</p><p id="3e5c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">想象一下，如果你愿意，一个试图识别欺诈案件的分类器。如果一个数据集有<strong class="lb iu"> <em class="me"> 10，000 个实例</em></strong><strong class="lb iu"><em class="me">欺诈发生率为 0.1% </em> </strong>，这些记录中只有 10 个会被肯定地标记为欺诈！根据定义，这被认为是一个高度不平衡的数据集。</p><p id="4e99" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果该算法将每个案例标记为<strong class="lb iu"> <em class="me">正常</em> </strong>(即没有欺诈)，我们得到以下准确度分数:</p><p id="cd32" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">正确预测/总观察值= 9990/10000 =<strong class="lb iu">99.9%</strong></p><p id="98ee" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">印象深刻！</strong>但是，等等……如果我们要捕获的<strong class="lb iu"> <em class="me"> TP </em> </strong>是:</p><ul class=""><li id="7e98" class="mf mg it lb b lc ld lf lg li mh lm mi lq mj lu mu ml mm mn bi translated">存在癌症/疾病状态</li><li id="60de" class="mf mg it lb b lc mo lf mp li mq lm mr lq ms lu mu ml mm mn bi translated">骗税</li><li id="a166" class="mf mg it lb b lc mo lf mp li mq lm mr lq ms lu mu ml mm mn bi translated">罕见的天体现象</li></ul><p id="ee77" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">并且我们甚至无法捕获一个实例，那么部署这种模型将会是一个巨大的失败，尽管它具有近乎完美的准确性！</p><h2 id="87f6" class="mv mw it bd mx my mz dn na nb nc dp nd li ne nf ng lm nh ni nj lq nk nl nm nn bi translated">精确</h2><p id="c34c" class="pw-post-body-paragraph kz la it lb b lc no ju le lf np jx lh li nq lk ll lm nr lo lp lq ns ls lt lu im bi translated">Precision 是对“<strong class="lb iu"><em class="me"/></strong>”准确性的度量，因为它查看正确预测的阳性与所有<strong class="lb iu"> <em class="me">预测的阳性</em> </strong>之间的比率。</p><p id="9d08" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu"> <em class="me">精度= TP / (TP + FP) </em> </strong></p><h2 id="f9a9" class="mv mw it bd mx my mz dn na nb nc dp nd li ne nf ng lm nh ni nj lq nk nl nm nn bi translated">回忆(又名敏感度，真阳性率)</h2><p id="e4bd" class="pw-post-body-paragraph kz la it lb b lc no ju le lf np jx lh li nq lk ll lm nr lo lp lq ns ls lt lu im bi translated">召回是对“<strong class="lb iu"> <em class="me">完整性</em> </strong>”的一种度量，因为它查看正确预测的阳性与所有<strong class="lb iu"> <em class="me">实际阳性</em> </strong>之间的比率。</p><p id="c892" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu"> <em class="me">回忆= TP / (TP + FN) </em> </strong></p><p id="b155" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">大多数分类问题都是在<strong class="lb iu"><em class="me"/></strong><strong class="lb iu"><em class="me">回忆</em> </strong>之间的一个<strong class="lb iu"> <em class="me">权衡。通常增加一个会导致另一个的妥协。考虑工作中的垃圾邮件过滤器。</em></strong></p><ul class=""><li id="18b0" class="mf mg it lb b lc ld lf lg li mh lm mi lq mj lu mu ml mm mn bi translated">FP =标记为垃圾邮件的有效电子邮件</li><li id="2216" class="mf mg it lb b lc mo lf mp li mq lm mr lq ms lu mu ml mm mn bi translated">FN =发送到收件箱的垃圾邮件</li></ul><p id="dc91" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu"> <em class="me">提高阈值</em> </strong>会降低电子邮件被标记为阳性(垃圾邮件)的概率。这也增加了精确度并降低了召回率，在这种情况下更可取，因为 FP 呈现出比 FN 更严重的<strong class="lb iu"> <em class="me">结果</em> </strong>。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mt"><img src="../Images/966d62758322683d6264bf4a90aa5815.png" data-original-src="https://miro.medium.com/v2/resize:fit:700/format:webp/1*A3iECGApmZzlRugQBY_hIA.png"/></div></figure><h2 id="b25b" class="mv mw it bd mx my mz dn na nb nc dp nd li ne nf ng lm nh ni nj lq nk nl nm nn bi translated">特异性(又名真阴性率)</h2><p id="59c8" class="pw-post-body-paragraph kz la it lb b lc no ju le lf np jx lh li nq lk ll lm nr lo lp lq ns ls lt lu im bi translated">同样，回忆是对正面结果的“<strong class="lb iu"><em class="me"/></strong>”完整性的度量，特异性对<strong class="lb iu"><em class="me"/></strong>值也是如此。我们看正确预测的否定和所有<strong class="lb iu"> <em class="me">实际否定</em> </strong>的比例。</p><p id="cc7b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu"> <em class="me">特异性= TN / (TN + FP) </em> </strong></p><p id="3717" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面，你可以看到改变阈值对<strong class="lb iu"> <em class="me">回忆</em> </strong>(记住这个和敏感度一样)和<strong class="lb iu"><em class="me"/></strong>的影响。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/aa7e27da9d4590b64ed864254bc660a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*lEEdIf5O4K4VovHX-5yi4w.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Graphic from <a class="ae ky" href="https://www.technologynetworks.com/" rel="noopener ugc nofollow" target="_blank">https://www.technologynetworks.com/</a></figcaption></figure><h2 id="8ffa" class="mv mw it bd mx my mz dn na nb nc dp nd li ne nf ng lm nh ni nj lq nk nl nm nn bi translated">假阳性率</h2><p id="24d6" class="pw-post-body-paragraph kz la it lb b lc no ju le lf np jx lh li nq lk ll lm nr lo lp lq ns ls lt lu im bi translated">这是特异性的补充。</p><p id="f45e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu"> <em class="me">假阳性率= FP / (FP + TN) = 1 -特异性</em> </strong></p><p id="2a66" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu"> <em class="me">假阳性率</em> </strong>和<strong class="lb iu"> <em class="me">假阴性率</em> </strong>形成受试者工作特性(<strong class="lb iu"><em class="me">【ROC】</em></strong>)曲线的坐标轴。这条曲线是另一个有用的工具，帮助我们找到两者之间的最佳平衡。ROC 曲线将在以后的文章中详细讨论。</p><h2 id="ce01" class="mv mw it bd mx my mz dn na nb nc dp nd li ne nf ng lm nh ni nj lq nk nl nm nn bi translated">F1 分数</h2><p id="6023" class="pw-post-body-paragraph kz la it lb b lc no ju le lf np jx lh li nq lk ll lm nr lo lp lq ns ls lt lu im bi translated">此外，<strong class="lb iu"> <em class="me"> F1 分数</em> </strong>是精确度和召回率的调和平均值，是两者之间平衡的最佳衡量标准:</p><p id="579d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu"> <em class="me"> F1 得分= 2 x(精度 x 召回)/(精度+召回)</em> </strong></p></div><div class="ab cl nu nv hx nw" role="separator"><span class="nx bw bk ny nz oa"/><span class="nx bw bk ny nz oa"/><span class="nx bw bk ny nz"/></div><div class="im in io ip iq"><p id="d712" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">混乱矩阵<strong class="lb iu"><em class="me"/></strong>不再混乱。我希望我已经澄清了你对这篇文章的一些误解。它是帮助我们评估分类器的一个非常好的工具。当我们理解了特定于所讨论的数据集的各个指标和含义时，我们就可以利用这个 2 x 2 信息矩阵的力量。最终，我们可以对我们的模型做出决策，并提高预测分析的价值。</p><p id="0e6e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们继续谈话。你可以在<a class="ae ky" href="http://www.linkedin.com/in/SiphuLangeni" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>上找到我。</p></div></div>    
</body>
</html>