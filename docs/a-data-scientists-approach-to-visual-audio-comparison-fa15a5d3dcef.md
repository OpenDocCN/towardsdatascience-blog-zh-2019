# 数据科学家的视觉音频比较方法

> 原文：<https://towardsdatascience.com/a-data-scientists-approach-to-visual-audio-comparison-fa15a5d3dcef?source=collection_archive---------5----------------------->

![](img/12a6fe6b0b5451d7463a52977c16b53e.png)

Beatles 1965 “*Help” album art*

在本文中，我演示了一些我创建的自定义方法，以直观地比较多个音频文件的频域。这些工具在许多情况下都很有用。对于这里的音乐爱好者来说，我们可以使用这些工具来检查同一首歌的不同版本之间的差异(我在本文中演示了这一点)。或者你可能在音频录制/编辑行业工作。这些可以用来查看您自己的主设备在过程的各个阶段是如何变化的，甚至可以可视化空间中麦克风放置的效果。

基本上，如果你有两个音频文件，这些工具可以让你*看到*它们之间的区别！

如果你有兴趣使用你在这里看到的一些代码，去看看这个项目的 [github repo](https://github.com/QED0711/audio_analyzer) 。

# 项目和演示

我正在为这个项目使用 python，我使用一个名为 *Librosa* 的包和一个名为 FFT ( *快速傅立叶变换* ) 的过程从我的音频文件中提取频率数据。如果你有兴趣学习更多关于 libroso 的知识，以及它如何帮助你在 python 中处理音频，这里有一些很棒的文档。

一切都是围绕我为这个项目设计的两个自定义类构建的。一个处理音频处理，另一个帮助产生比较可视化。

这些工具可以比较任何两个音频文件。但是我认为它们真正的亮点在于展示了相对相似的文件之间的差异。正因为如此，我在甲壳虫乐队的歌曲《昨天的 T12》的一个原始版本和两个重制版本中演示了它们的使用。你可以听下面每个版本的录音。

## 1965 年原版:

## 2009 年重制:

## 2015 年复赛:

在继续阅读之前，我鼓励你听几秒钟，看看你是否能听出一些不同之处。你能具体定义这些差异吗？如果没有，希望这个分析能帮助你看到和理解音频是如何从一个版本变化到另一个版本的。

我们开始吧！

# 加载数据

将音频数据放入 Librosa 实际上非常简单，但是分析和频率转换可能需要一点代码。为了获得最佳的分析结果，我们需要知道每个文件的采样率，如果文件之间的采样率匹配也是最好的。这里，它们都是 44.1 kHz(相当标准的采样速率)。

我的`AudioAnalyzer`类负责将音频转换成 librosa 并将其转换到频域。同样，如果您有兴趣查看所有这些的完整代码，请查看我的[项目库](https://github.com/QED0711/audio_analyzer)。

Initialize the AudioAnalyzer instances

*input_sr* 代表输入采样率，每个文件设置为 44100。我们还将 *fft_size* 设置为 44100。FFT 基本上是一种获取时域数据并创建特定数量的*仓*来放置频率信息的方法。为了使 FFT 大小与采样速率相匹配，我们使每个频段正好为 1 Hz。如果你有兴趣阅读更多关于 FFT 的内容，请查看本页。

在幕后，我们加载音频，通过 FFT 处理，然后平均每个频段的幅度，以获得每个文件的单一频谱。

AudioAnalyzer 类已经可以为我们生成一个简单的声谱图。

plotting individual spectrums

从代码中可以看出，我已经指定了最小和最大频率。这只是为了让我们能够聚焦于一个特定的范围，在这个范围内，我们将能够更清楚地看到一切。此外，请注意，在下图中，每个谱图的 y 轴(振幅)都被缩放到 0 到 1 之间。当比较这些光谱图时，把所有的东西放在同一个尺度上是有帮助的。

![](img/e2e9d1fc2756a396ea804bfd803c0b44.png)![](img/0b44eaadc98f016e6e0984c02cf324e8.png)![](img/b117103e2170093e022261fcc76aaff4.png)

从这些图表中，你可能会认为它们看起来很相似。那是因为他们有。像这样并排比较频域是相当困难的(这也是我写这篇文章的原因！).幸运的是，我有另一个类可以帮助我们更好地可视化和比较差异。

# 比较音频

我用另一个类`SpectrumCompare`处理两个音频文件之间的比较。这个类接受我们之前创建的两个`AudioAnalyzer`实例，并在后台运行一些计算来帮助我们比较它们。

让我们来看看。

Initializing SpectrumCompare class

就这么简单！我们现在可以在我们的`orig_to_09`实例上调用一些不同的绘图方法来比较原始的 1965 年版本和重新制作的 2009 年版本。

首先，让我们绘制这两个文件的光谱图。

Plot basic spectrum group

![](img/1aaf44d945b35c912444dd1d53ca4205.png)

有了这个视觉，比较这两个版本的频谱就容易多了。

快速浏览一下，似乎重新灌制的版本在所有频率上都有更高的振幅。但是振幅的差异在所有范围内都是一致的吗？如果不是，更大的差异在哪里？幸运的是，`SpectrumCompare`可以帮助我们回答这些问题！

Plot full spectrum group with threshold

![](img/7386ac98f0ccf9954279dbae55c640e2.png)

通过在`plot_spectrum_group`中传递一些其他的参数，我们可以看到振幅在不同的频率区间是如何变化的。这里的绿线显示缩放幅度的差异，红线是阈值。当绿线位于红线上方时，意味着重制版本在该频率仓中具有更高的振幅。当它在下面时(在这个特殊的例子中我们看不到)，这意味着原始信号在那个频率上有更高的振幅。

> 注意:将`AudioAnalyzer`实例添加到`SpectrumCompare`初始化的顺序将决定红线的哪一侧意味着哪个频谱的幅度更大。中的第一个得到下半部分，第二个得到上半部分。有关更多信息，请参见项目报告。

我们可以证实我们最后的观察结果，即重新灌制的版本在标绘的光谱范围内往往具有更大的振幅。我们甚至可以看到许多峰值形成的位置，以及它们在大约 700 Hz 后开始变平的位置。

虽然这张图肯定让我们更直观地了解了这种比较，但我认为它可以简化一点，仍然给出相同的一般信息。为此，我们可以使用`SpectrumCompare.plot_spectrum_heatmap`方法。

Alternative heatmap plot

![](img/6e5eed5bbaf0f4dfe2b928fa4665ff11.png)

太好了！现在，这看起来更令人愉快，并且提供了所有相同的信息。我们的红色和绿色线条已被热图背景所取代。通过这张热图，我们可以看到有几个特别的热点。如果我们想让我们的分析更精确一点，我们可以使用`frange`参数来放大特定的范围。在这里，看起来大多数热点出现在 100-500 赫兹之间(对于许多男性声乐和器乐来说，这是一个相当丰富的范围)。

Heatmap from 20–500 Hz

![](img/17c33bf3bd81a27c3fe6e3e2c25c2b82.png)

在这个更近的范围内，我们可以看到，在 180 Hz 左右的某个地方，有一个非常重要的热点，表明重新录制的版本在该频率下具有更高的幅度。该音域[对应于 F3](http://www.sengpielaudio.com/calculator-notenames.htm) 左右，这是一个舒适的男声音域，正好在吉他音域的中间。这也恰好是这首歌的关键(F 大调)。此外，随着频率越来越接近 500 Hz，我们可以看到这些热点开始消退。

因此，我们可以从这一视觉分析中得出一个结论，即重新灌制的版本似乎强调了从 180 Hz 到 500 Hz 的范围。这些热点是相对包含的，我们没有看到任何特别广泛的区域，其中振幅在重制中得到显著提升。因此，这些微妙的变化可能会反映出对主要声乐和器乐线条的更多强调。

简单介绍一下这个过程之后，让我们看看这些不同版本之间的其他一些比较。

接下来，我们来对比一下 1965 年的原版和 2015 年的复刻版。

Comparison of original to 2015 remaster

![](img/1524dca43036b579ee8f615a1f1c268b.png)![](img/bc484202eb3cebfed0b975bc32273793.png)

先说这个对比和上一个的相似之处。从频谱组图中，我们可以再次看到，在重新灌制版本中，所有标绘频率的振幅普遍增加。然而，如果我们观察 100–400Hz 范围，频率的增加似乎更广泛一些。也就是说，它不仅仅集中在几个峰值周围，而是在整个范围内更加分散。

为了证实这一点，我们可以看看我们的热图。果然，我们看到 180 Hz 范围以下有一些更宽的热点。此外，90 Hz 和 110 Hz 附近的热点在我看来似乎更亮一些。这似乎表明，除了强调中间音域，2015 年的这张专辑还增加了一些低音。

但要真正测试这一点，让我们比较两个重制版。

Comparison of 2009 and 2015 remasters

![](img/03a730249bb34d1151bc7686d75d90a0.png)![](img/bf51f4fe93252b026d3316a8e8d3bbfa.png)

这些结果并不明显，这本身就是一个有趣的观察。基本上，当谈到改变情商时，这两位大师做出了很多相同的美学选择。

在我们的光谱组图中，我们的绿线主要围绕红线。由于 2015 年版本是我们的`SpectrumCompare`类的第二个输入，红线上方的绿色意味着 2015 年的 remaster 在这些频率下具有更高的振幅。有一些地方，它下降到阈值以下，这意味着 2009 年的版本有更大的幅度，但只有少数这样的情况。

特别有趣的是，我们可以在 100–200Hz 之间的 2015 版本中看到一些更大的振幅。正如我所怀疑的那样，2015 年的 remaster 似乎有一些低音增强。

通过查看我们的热图可以确认这一点。这里，我将范围限制在 20–200Hz，这样我们就可以看到这个较低范围的细节。虽然热点不是非常明显，但我们肯定可以在 180 Hz 以下看到它们。因此，我们可以确信，2015 年版确实有一些 2009 年版没有的低音增强。

# TL；速度三角形定位法(dead reckoning)

如果你跳过了所有冗长的部分，只是浏览了一下图表，这就是结论。两个重新灌制的版本似乎都比 1965 年的原版声音更大，并且彼此相对相似。特别是，翻唱者强调了歌曲的主要声乐和乐器范围(180-500Hz 之间)，2015 年的版本也增加了一些低音增强。

考虑到这一点，你可能想回去再听一遍这三个版本，看看你是否能听到这些特征。此外，看看你是否喜欢其中一个。我个人认为，2009 年的重新灌制很好地平衡了旋律的重点和整体清晰度。

同样，请随意查看我的 github 库，并在其他音频上尝试代码。

我希望你喜欢这个视频音频比较的简短探索。感谢阅读！