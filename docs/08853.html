<html>
<head>
<title>Unravelling product matching in retail with AI</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用人工智能解开零售中的产品匹配</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/unravelling-product-matching-with-ai-1a6ef7bd8614?source=collection_archive---------10-----------------------#2019-11-26">https://towardsdatascience.com/unravelling-product-matching-with-ai-1a6ef7bd8614?source=collection_archive---------10-----------------------#2019-11-26</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/a729a9b457de0d0ba65778714ce32bb2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qzs_Uowaoi2L1upiNRqOzQ.png"/></div></div></figure><div class=""/><p id="d0bc" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><strong class="kd jf">TL；博士</strong> : <em class="kz">产品匹配，即对多家零售商出售的同一产品进行匹配的能力，是零售业发展不可或缺的一部分。我们探索一种机器学习方法，通过世界上最大的实时零售数据源提供高准确性和可扩展性。</em></p><p id="d65a" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">产品匹配是零售技术研究的一个重要领域。从 ASOS 和 Zalando 等零售商的角度来看，确保竞争对手之间一致的定价和折扣是一个优先事项，从单一产品层面到整个产品组合重叠。零售商必须在市场上保持竞争力。然而，对零售商不销售或不专门促销的产品的认识也会对利润产生重大影响。零售商独占性(即当没有匹配时)在零售业中可能有利可图。对于任何正在向不同市场扩张或通过多家零售商销售的知名品牌，如耐克和博柏利，很难跟踪产品的价格和所需的描述。品牌希望他们的产品得到统一的展示，零售商可能在这两方面都卖得不够好。</p><figure class="lb lc ld le gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi la"><img src="../Images/24d598776cd960ebffceaf9605c3b779.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*80B91U31cqDooQB-WZNEPQ.png"/></div></div><figcaption class="lf lg gj gh gi lh li bd b be z dk">Matching products can have different images, names and descriptions</figcaption></figure><p id="93c9" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在<a class="ae lj" href="https://edited.com/" rel="noopener ugc nofollow" target="_blank">编辑的</a>，我们拥有超过 5 亿个零售产品的数据。这些产品由众多零售商以多种语言和市场销售。它们可以在不同的时间，以不同的品牌(汤米·席尔菲格与汤米·席尔菲格内衣)出售，并带有零售商选择的图像和文字。他们的产品信息范围很广，从详尽的叙述到单个单词描述“服装”或数字标识符。看看上面的例子，基于真实数据，每个产品在名称、描述和图像上都有所不同。在 5 亿的数据集中，这些产品不够独特或相似，不足以使产品匹配成为一项简单的任务。如何才能准确匹配这些产品？更重要的是，如何才能对这些比赛有信心？让我们看看如何以可扩展的方式和高精度实现这一点。</p><h1 id="6f5c" class="lk ll je bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated">每个字节的数据都有帮助</h1><p id="c0ac" class="pw-post-body-paragraph kb kc je kd b ke mi kg kh ki mj kk kl km mk ko kp kq ml ks kt ku mm kw kx ky im bi translated">为了了解两种产品是否相同，我们需要尽可能多的产品数据重叠。编辑从零售商网页抓取多个文本字段、图像和元数据(例如抓取时间)。所有这些都被认为是我们模型中的“特征”。例如，一些常见的基于文本的特征包括产品名称、提供的产品描述和产品品牌。</p><p id="f9e0" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我们需要把这些数据转换成计算机能处理的东西。首先，让我们看看我们基于文本的功能。自然语言处理(NLP)是机器学习的一个子领域，旨在理解计算机如何分析人类语言。一个常见的 NLP 任务是单词嵌入，将单词映射到表示它们的向量，并且存在许多模型来执行该任务。最简单地说，这意味着对文本中的单词进行计数，其中向量的长度相当于词汇表的大小，每个元素代表一个单词。在最复杂的情况下，这可以是对数百万个单词或短语进行训练的模型，以基于训练期间学习的特征产生固定长度的向量，其中单词的表示分布在向量中的几个元素上(例如<a class="ae lj" href="https://arxiv.org/abs/1810.04805" rel="noopener ugc nofollow" target="_blank"> BERT </a>和<a class="ae lj" href="https://arxiv.org/abs/1906.08237" rel="noopener ugc nofollow" target="_blank"> XLNet </a>)。在设计模型基础设施时，必须考虑单词嵌入的复杂性和伸缩能力。</p><p id="79db" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">接下来，我们需要重新想象这个过程，这样我们的图像就可以用向量来表示了。这是机器学习研究的一个大领域，被称为计算机视觉。在最基本的情况下，我们可以通过散列函数简单地检查两幅图像是否相同。然而，如果有任何差异，即使在单个像素级别，我们也无法匹配图像。相反，我们使用卷积神经网络(CNN)，这是一种用于我们图像识别的深度学习算法。CNN 在图像上使用移动过滤器来寻找其特征，同时减少需要处理的数据量。在最底层，这些过滤器提取诸如边缘之类的特征。然后，该网络学习如何将这些特征组合起来形成复杂的结构，从而更深入地了解定义产品的组件。然后，它利用这一点来分类产品，例如，作为一个顶部或服装。这些被称为“特征向量”，其中向量的元素对应于从 CNN 学习的特征。</p><figure class="lb lc ld le gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi mn"><img src="../Images/8a822b985c5184224b7947111e8d99ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FD6AAQqGqeO9tr-DAohfhg.png"/></div></div><figcaption class="lf lg gj gh gi lh li bd b be z dk">Our model architecture using word embeddings derived from text and feature vectors learned from images</figcaption></figure><h1 id="4977" class="lk ll je bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated">绘制世界上最大的实时零售数据集</h1><p id="058e" class="pw-post-body-paragraph kb kc je kd b ke mi kg kh ki mj kk kl km mk ko kp kq ml ks kt ku mm kw kx ky im bi translated">利用从文本和图像中获得的每个产品的这两个向量，我们可以可视化 EDITED 的数据库中的关系。我们通过使用向量作为高维坐标系统来做到这一点，其中每个元素对应于一个单独轴上的一个坐标。例如，想象一个长度为 2 个元素的向量。这意味着一个元素在<em class="kz"> x </em>轴上，另一个元素在<em class="kz"> y- </em>轴上，就像一个简单的图表，如上图的散点图所示。扩展到 3 个元素，该图现在有一个<em class="kz"> z- </em>轴，并且可以通过 3D 绘图可视化。继续这个过程，直到我们在一个向量中有几百或几千个元素，那么多的维度很难概念化。</p><p id="54ce" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这是产品的高维映射，其中彼此靠近的产品将由于它们的特征向量和单词嵌入而共享相似的特征。这转化为我们希望查询的产品与其周围数据点或产品之间的距离，其中距离越短越匹配。折叠到 2D(使用降维技术，如<a class="ae lj" href="https://en.wikipedia.org/wiki/Singular_value_decomposition" rel="noopener ugc nofollow" target="_blank"> SVD </a>)，我们可以看到下面几个数据点的复杂性。</p><figure class="lb lc ld le gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi mo"><img src="../Images/ff8e05f41d64dcc89a7e7bbdd2351f3c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZKee6LGMWUnSyETz-DnbJg.png"/></div></div><figcaption class="lf lg gj gh gi lh li bd b be z dk">A 2D representation of mapping for a subset of EDITED data, color-coded by brand</figcaption></figure><p id="ad35" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在 EDITED，我们有 5 亿个产品的高维映射！我们称之为“指数”。从存储以及构建和查询索引所花费的时间来看，为一个查询产品检查索引中的每个产品是不现实的。如何才能意识到哪些产品彼此靠近，最关键的是，要快？</p><p id="f1df" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">进入数据科学的另一个蓬勃发展的领域，近似最近邻居(ANN)，涉及一些世界上最大的科技公司的贡献，包括 Spotify 的<a class="ae lj" href="https://github.com/spotify/annoy" rel="noopener ugc nofollow" target="_blank">aroy</a>和脸书的<a class="ae lj" href="https://github.com/facebookresearch/faiss/" rel="noopener ugc nofollow" target="_blank"> FAISS </a>。这些算法通过猜测产品的最近邻居来平衡准确性和速度。在其核心，人工神经网络随机分裂数据，并重复这一过程，直到一个二叉树结构被创建，其中每一个叶子是每次分裂后的数据子集，分支被用来回忆邻居。通过随机化分裂和创建重复的二叉树，我们获得了最近邻的良好估计。</p><p id="9da2" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">人工神经网络的最新发展使用了一种类似图形的数据结构，称为<a class="ae lj" href="https://arxiv.org/abs/1603.09320" rel="noopener ugc nofollow" target="_blank">分层可导航小世界图</a>，它在准确性和速度方面领先于<a class="ae lj" href="http://ann-benchmarks.com/" rel="noopener ugc nofollow" target="_blank">基准</a>。这里，查询开始遍历索引，其中在每个阶段，针对图的每个节点，记录查询数据点与其邻居之间的距离。基于最小化该距离来选择要遍历的下一个节点，并且再次记录最佳邻居。当满足用户定义的特定标准时，该过程结束，例如要执行的计算次数，返回最近邻居的更好估计。</p><h1 id="e3f6" class="lk ll je bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated">评估评估评估</h1><p id="1e61" class="pw-post-body-paragraph kb kc je kd b ke mi kg kh ki mj kk kl km mk ko kp kq ml ks kt ku mm kw kx ky im bi translated">最后，我们想了解我们的系统性能如何。当我们从高维索引中查询一个产品的邻居时，我们需要检查我们的邻居是否确实匹配，以及我们是否返回了所有可能的匹配。这与 precision(正确的相邻要素的比例)和 recall(返回的匹配要素的比例)相同。除此之外，我们需要匹配和更相关的邻居返回更高的排名，所以对索引有信心。</p><p id="2129" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">通过根据与查询产品的距离返回匹配，我们使用了“分级检索”系统。当我们返回大量的邻居(例如 100)时，我们应该能够实现完全召回。</p><figure class="lb lc ld le gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi mp"><img src="../Images/d4f7fe6e261d9a9e25ce90a1b27fe322.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*L3uOn5C7oRX-0AYu"/></div></div><figcaption class="lf lg gj gh gi lh li bd b be z dk">Paul Verhoeven’s Total Recall</figcaption></figure><p id="8af5" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">然而，我们还想评估无法实现完全召回的查询的准确性。为此，我们将我们的度量修改为“等级为<em class="kz"> k </em>的精度”、“正确的<em class="kz"> k </em>邻居的比例”和“等级为<em class="kz"> k </em>的召回”，在我们的<em class="kz"> k </em>邻居中匹配的比例，其中<em class="kz"> k </em>是返回的邻居的数量(例如 100)。当我们通过距离过滤我们的邻居时，<em class="kz"> k </em>将随着每个查询而变化。我们需要确保精度保持在<em class="kz"> k. </em>的变化</p><figure class="lb lc ld le gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi mq"><img src="../Images/d01ca4225c83a0248f6cb011db580637.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_aHKw8DMe9XYiclnJglltA.png"/></div></div><figcaption class="lf lg gj gh gi lh li bd b be z dk"><em class="mr">Calculating average precision in a ranked retrieval system for a query with four matches</em></figcaption></figure><p id="844d" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">为此，我们可以计算“平均精度”，这不需要固定的<em class="kz">k。</em>该方法是可行的——我们迭代通过距离过滤返回的<em class="kz"> k </em>个邻居，并且在每次迭代中，如果乘积是匹配的，我们计算该等级的精度。然后，我们使用这些精度值的平均值，如上图所示。这允许我们更严厉地处罚高等级的不匹配，同时也考虑低等级的不匹配。最后，我们计算多个查询的“平均精度”,这是为每个查询计算的平均精度的平均值。这已被证明是 EDITED 的一个宝贵指标，因为它展示了对精确度和召回率的理解，同时优先考虑以用户为中心的功能，如排名。</p><figure class="lb lc ld le gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ms"><img src="../Images/2d24f9f6c24dfbfe8e646d613d2734ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ohLLYJvQ2Od_ST-QkvPvCA.png"/></div></div><figcaption class="lf lg gj gh gi lh li bd b be z dk">Ensuring consistent pricing and discounting amongst competitors. These matched products have different names, brands, descriptions and images</figcaption></figure><figure class="lb lc ld le gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi mt"><img src="../Images/02438e9147e4c9dd32592518674565af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iLaTrZ1MHs-3Ct68jUXEaQ.png"/></div></div><figcaption class="lf lg gj gh gi lh li bd b be z dk">Tracking consistency in a brand’s pricing and descriptions across markets and retailers</figcaption></figure><h1 id="8ef7" class="lk ll je bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated">关键要点</h1><p id="c207" class="pw-post-body-paragraph kb kc je kd b ke mi kg kh ki mj kk kl km mk ko kp kq ml ks kt ku mm kw kx ky im bi translated">我们的模型使用基于文本和图像的特征来创建产品如何相关的高维映射，尽管有不同的描述和图像，也能提供产品匹配。通过使用最新的机器学习进展，我们能够精确、自信地在多个零售商、语言和市场中提取相同的产品，并达到零售业前所未有的规模。</p><p id="4780" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">产品匹配是零售业中一个难以应对的挑战，根本原因在于数据的差异和庞大规模。通过在 EDITED 上分享我们的方法，我们希望能够为如何完成这项艰巨的任务提供一些见解。</p></div></div>    
</body>
</html>