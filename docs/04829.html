<html>
<head>
<title>Decoding the Confusion Matrix</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">解码混淆矩阵</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/decoding-the-confusion-matrix-bb4801decbb?source=collection_archive---------4-----------------------#2019-07-22">https://towardsdatascience.com/decoding-the-confusion-matrix-bb4801decbb?source=collection_archive---------4-----------------------#2019-07-22</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="df58" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在分类问题的情况下，只有一个分类精度可能无法给出全貌。因此，混淆矩阵或误差矩阵用于总结分类算法的性能。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/8b7327f28f8ad54ab894721941e065ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*73f33DTb5XsNfE1R7CIY0g.jpeg"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk">Photo by <a class="ae lb" href="https://unsplash.com/@sortino?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Joshua Sortino</a> on <a class="ae lb" href="https://unsplash.com/search/photos/matrix?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="fa35" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">计算混淆矩阵可以让您了解分类模型在哪里是正确的，以及它会产生什么类型的错误。</p><p id="f430" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">混淆矩阵用于检查分类模型对一组真实值已知的测试数据的性能。大多数性能指标，如精确度、召回率，都是从混淆矩阵中计算出来的。</p><p id="15db" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">本文旨在:<br/> 1。什么是混淆矩阵，为什么需要它。<br/> 2。如何用一个猫狗的例子计算一个 2 类分类问题的混淆矩阵？<br/> 3。如何在 Python 中创建混淆矩阵&amp; R. <br/> 4？对不同指标的总结和直觉:准确度、召回率、精确度&amp;特异性</strong></p><h1 id="b40d" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">1.混淆矩阵:</h1><p id="a301" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">混淆矩阵提供了分类问题中预测结果的总结。表中总结了正确和不正确的预测及其值，并按类别进行了细分。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi mf"><img src="../Images/fba3da753dbdcb31fa09ea69905688c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1194/format:webp/0*wKaznIJzZF54b87B.jpg"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk">Confusion Matrix for the Binary Classification</figcaption></figure><p id="5afa" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当类别不平衡时，我们不能依赖单一的分类精度值。例如，我们有一个 100 名患者的数据集，其中 5 名患有糖尿病，95 名健康。然而，如果我们的模型仅预测大多数类别，即所有 100 个人都是健康的，即使我们具有 95%的分类准确度。因此，我们需要一个混淆矩阵。</p><h1 id="4818" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">2.计算混淆矩阵:</h1><p id="6fd7" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">让我们举个例子:</p><p id="5d71" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们总共有 10 只猫和狗，我们的模型预测它是否是一只猫。</p><p id="a5db" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">实际值= ['狗'、'猫'、'狗'、'猫'、'狗'、'猫'、'狗'] <br/>预测值= ['狗'、'狗'、'狗'、'猫'、'狗'、'狗'、'狗'、'猫'、'猫'、'猫']</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi mg"><img src="../Images/9f299fc802c7b5b4f53ccd794d46c58b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*aCfWH1N5UCSDOGhG.jpg"/></div></div></figure><blockquote class="mh mi mj"><p id="5a36" class="jn jo mk jp b jq jr js jt ju jv jw jx ml jz ka kb mm kd ke kf mn kh ki kj kk ij bi translated">请记住，我们将预测值描述为正/负，将实际值描述为真/假。</p></blockquote><p id="61e6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">术语定义:</strong> <br/>真阳性:你预测阳性，是真的。你预言一种动物是猫，它确实是。</p><p id="24d3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">真阴性:你预测为阴性，这是真的。你预测动物不是猫，它实际上也不是(它是一只狗)。</p><p id="3cad" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">假阳性(类型 1 错误):你预测阳性，但它是假的。你预测动物是猫，但它实际上不是(它是狗)。</p><p id="4c0d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">假阴性(第二类错误):你预测的是阴性，它是假的。你预测那种动物不是猫，但它实际上是。</p><p id="17e7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">分类精度:</strong> <br/>分类精度由下式给出:</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi mo"><img src="../Images/e813f485a1b7e3f399a8d387f4b06d9c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*qLxAWTs-gZjQvTi4.jpg"/></div></div></figure><p id="c3ac" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">召回(又名敏感度):</strong> <br/>召回定义为正确分类的正类总数除以正类总数的比值。或者说，在所有的积极类中，我们正确预测了多少。召回率应该很高。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi mp"><img src="../Images/2a9544dee6f9db4a50b730656271a7db.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*hwxRkPhL7reX4oiv.jpg"/></div></div></figure><p id="a5da" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">精度:</strong> <br/>精度定义为正确分类的正类总数除以预测的正类总数的比值。或者说，在所有的预测积极类中，我们预测正确的有多少。精度要高。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi mq"><img src="../Images/69e14b2ec3d05f007ae3073198a88df8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*UXsydWL1pmo7XVke.jpg"/></div></div></figure><blockquote class="mh mi mj"><p id="fceb" class="jn jo mk jp b jq jr js jt ju jv jw jx ml jz ka kb mm kd ke kf mn kh ki kj kk ij bi translated">需要记住的技巧:<strong class="jp ir"> Pre </strong> cision 在分母中有<strong class="jp ir"> Pre </strong> dictive 结果。</p></blockquote><p id="15a1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> F-score 或者 F1-score: </strong> <br/>两个精度和召回率不同的模型很难比较。所以为了使它们具有可比性，我们使用 F-Score。这是精确和回忆的调和平均值。与算术平均相比，调和平均对极值的惩罚更大。f 分应该很高。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi mr"><img src="../Images/22ccd49fceded15234ccf5acb45cd87f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*wOhYzkXk9FHvsKGw.jpg"/></div></div></figure><p id="68a7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">特异性:</strong> <br/>特异性决定了被正确识别的实际阴性的比例。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi ms"><img src="../Images/d9667491e42d0a6eb2e61e427e93433c.png" data-original-src="https://miro.medium.com/v2/resize:fit:850/format:webp/0*hU1uhnCQl3uIYh-K.jpg"/></div></div></figure><p id="0b8a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">解释混淆矩阵的例子:</strong> <br/>让我们用上面的猫和狗的例子来计算混淆矩阵:</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi mg"><img src="../Images/e907439feac7c2488f3bceacdb01a3f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*68_207Ghd9N_9vaj.jpg"/></div></div></figure><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi mt"><img src="../Images/e1706b661a2c5315db468bb54fc34574.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*6xDHY76Pf-Fshlih.jpg"/></div></div></figure><p id="1c94" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">分类精度:</strong> <br/>精度=(TP+TN)/(TP+TN+FP+FN)=(3+4)/(3+4+2+1)= 0.70</p><p id="2b33" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">回忆:回忆让我们知道什么时候它实际上是肯定的，它预测肯定的频率有多高。<br/>回忆= TP / (TP + FN) = 3/(3+1) = 0.75</p><p id="1ac8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">精度:精度告诉我们什么时候它预测是，它正确的频率是多少。<br/>精度= TP / (TP + FP) = 3/(3+2) = 0.60</p><p id="5633" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">F-score:</strong><br/>F-score =(2 *召回率*准确率)/(召回率+准确率)=(2 * 0.75 * 0.60)/(0.75+0.60)= 0.67</p><p id="3b02" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">特异性:</strong> <br/>特异性= TN / (TN + FP) = 4/(4+2) = 0.67</p><h1 id="bff1" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">3.在 Python &amp; R 中创建混淆矩阵</h1><p id="b94f" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">让我们用 python 和 R 代码来理解上面的狗和猫的例子，这会让你更好地理解到目前为止你对混淆矩阵的了解。</p><p id="558e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">混乱矩阵的 Python 代码:</strong></p><p id="893c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">首先让我们用 python 代码创建一个混淆矩阵。我们必须从 sklearn 库中导入混淆矩阵模块，这有助于我们生成混淆矩阵。</p><p id="d78d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">下面是上面解释的 Python 实现:</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="mu mv l"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk">Python Code</figcaption></figure><pre class="km kn ko kp gt mw mx my mz aw na bi"><span id="7d95" class="nb ld iq mx b gy nc nd l ne nf"><strong class="mx ir">OUTPUT -&gt;</strong></span><span id="8864" class="nb ld iq mx b gy ng nd l ne nf">Confusion Matrix :<br/>[[3 1]<br/> [2 4]]<br/>Accuracy Score : 0.7<br/>Classification Report : <br/>        precision    recall  f1-score   support</span><span id="b6e8" class="nb ld iq mx b gy ng nd l ne nf">cat       0.60      0.75      0.67         4<br/>dog       0.80      0.67      0.73         6</span><span id="877f" class="nb ld iq mx b gy ng nd l ne nf">micro avg          0.70      0.70      0.70        10<br/>macro avg          0.70      0.71      0.70        10<br/>weighted avg       0.72      0.70      0.70        10</span></pre><p id="264d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">混淆矩阵的 R 代码:</strong></p><p id="fee0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在让我们用 R 代码创建一个混淆矩阵。我们将使用 R 中的插入符号库来计算混淆矩阵。</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="mu mv l"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk">R Code</figcaption></figure><pre class="km kn ko kp gt mw mx my mz aw na bi"><span id="8997" class="nb ld iq mx b gy nc nd l ne nf"><strong class="mx ir">OUTPUT -&gt;</strong></span><span id="de75" class="nb ld iq mx b gy ng nd l ne nf">Confusion Matrix and Statistics</span><span id="aa58" class="nb ld iq mx b gy ng nd l ne nf">             Reference<br/>Prediction   0 1<br/>           0 4 1<br/>           1 2 3</span><span id="bec8" class="nb ld iq mx b gy ng nd l ne nf">Accuracy : 0.7 <br/>95% CI : (0.3475, 0.9333)<br/>No Information Rate : 0.6 <br/>P-Value [Acc &gt; NIR] : 0.3823</span><span id="33e5" class="nb ld iq mx b gy ng nd l ne nf">Kappa : 0.4</span><span id="5eca" class="nb ld iq mx b gy ng nd l ne nf">Mcnemar's Test P-Value : 1.0000</span><span id="b225" class="nb ld iq mx b gy ng nd l ne nf">Sensitivity : 0.6667 <br/>Specificity : 0.7500 <br/>Pos Pred Value : 0.8000 <br/>Neg Pred Value : 0.6000 <br/>Prevalence : 0.6000 <br/>Detection Rate : 0.4000 <br/>Detection Prevalence : 0.5000 <br/>Balanced Accuracy : 0.7083</span><span id="8633" class="nb ld iq mx b gy ng nd l ne nf">'Positive' Class : 0</span></pre><h1 id="0cde" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">4.总结:</h1><ul class=""><li id="7a06" class="nh ni iq jp b jq ma ju mb jy nj kc nk kg nl kk nm nn no np bi translated">精确是你对自己的真实想法有多确定。回忆是你有多确定你没有错过任何积极的东西。</li><li id="fdab" class="nh ni iq jp b jq nq ju nr jy ns kc nt kg nu kk nm nn no np bi translated">如果<strong class="jp ir">假阴性的出现不可接受/不可容忍，选择<strong class="jp ir">召回</strong>。</strong>例如，在糖尿病的情况下，你宁愿有一些额外的假阳性(假警报),而不是保存一些假阴性。</li><li id="c293" class="nh ni iq jp b jq nq ju nr jy ns kc nt kg nu kk nm nn no np bi translated">如果你想对你真正的阳性结果更加<strong class="jp ir">自信，选择<strong class="jp ir">精确</strong>。例如，在垃圾邮件的情况下，你宁愿在你的收件箱中有一些垃圾邮件，而不是在你的垃圾邮件箱中有一些普通邮件。在我们将电子邮件 X 放入垃圾邮件箱之前，您想要额外确定它是垃圾邮件。</strong></li><li id="b656" class="nh ni iq jp b jq nq ju nr jy ns kc nt kg nu kk nm nn no np bi translated">如果您想要<strong class="jp ir">覆盖所有真阴性，选择<strong class="jp ir">特异性</strong>，</strong>即意味着我们不想要任何假警报或假阳性。例如，在毒品测试中，所有测试呈阳性的人都会立即入狱，你不会希望任何没有吸毒的人入狱。</li></ul><p id="cbde" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们可以得出结论:</p><ul class=""><li id="982a" class="nh ni iq jp b jq jr ju jv jy nv kc nw kg nx kk nm nn no np bi translated">准确度值为 70%意味着每 10 只猫中有 3 只识别不正确，7 只识别正确。</li><li id="f8fb" class="nh ni iq jp b jq nq ju nr jy ns kc nt kg nu kk nm nn no np bi translated">精度值为 60%意味着每 10 只猫中有 4 只不是猫(即狗)，6 只是猫。</li><li id="9745" class="nh ni iq jp b jq nq ju nr jy ns kc nt kg nu kk nm nn no np bi translated">召回值为 70%意味着实际上每 10 只猫中有 3 只被我们的模型遗漏，7 只被正确识别为猫。</li><li id="8d1a" class="nh ni iq jp b jq nq ju nr jy ns kc nt kg nu kk nm nn no np bi translated">特异性值为 60%意味着现实中每 10 只狗(即非猫)中有 4 只被误标记为猫，6 只被正确标记为狗。</li></ul><p id="6d6e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果您有任何意见或问题，请在下面留下您的反馈。更多文章请访问<a class="ae lb" href="https://keytodatascience.com/" rel="noopener ugc nofollow" target="_blank"> KeytoDataScience </a>。你可以在 LinkedIn 上找到我。</p></div></div>    
</body>
</html>