<html>
<head>
<title>An â€œEquation-to-Codeâ€ Machine Learning Project Walk-Through â€” Part 2 Non-Linear Separable Problem</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">â€œç­‰å¼åˆ°ä»£ç â€æœºå™¨å­¦ä¹ é¡¹ç›®æ¼”ç»ƒâ€”ç¬¬ 2 éƒ¨åˆ†éçº¿æ€§å¯åˆ†é—®é¢˜</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://towardsdatascience.com/an-equation-to-code-machine-learning-project-walk-through-in-python-part-2-non-linear-d193c3c23bac?source=collection_archive---------15-----------------------#2019-06-13">https://towardsdatascience.com/an-equation-to-code-machine-learning-project-walk-through-in-python-part-2-non-linear-d193c3c23bac?source=collection_archive---------15-----------------------#2019-06-13</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="9372" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">æ•°å­¦æ–¹ç¨‹å¼èƒŒåçš„è¯¦ç»†è§£é‡Šï¼Œä¸ºæ‚¨çš„æœºå™¨å­¦ä¹ æˆ–æ·±åº¦å­¦ä¹ ä¹‹æ—…å¥ å®šå®ç”¨çš„æ•°å­¦åŸºç¡€</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/621c0dfd0f6f25886c72ee0e85ee57bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*qkQch4Kcr6hrK-52"/></div></div></figure><p id="727e" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">å¤§å®¶å¥½ï¼è¿™æ˜¯â€œç­‰å¼åˆ°ä»£ç â€æ¼”ç»ƒçš„ç¬¬ 3 éƒ¨åˆ†ã€‚è¿™æ¬¡</p><p id="c957" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">åœ¨<a class="ae lq" rel="noopener" target="_blank" href="/an-equation-to-code-machine-learning-project-walk-through-in-python-part-1-linear-separable-fd0e19ed2d7?source=your_stories_page---------------------------">ç¬¬ä¸€éƒ¨åˆ†</a>ä¸­ï¼Œæˆ‘ä»¬è°ˆåˆ°äº†å¦‚ä½•åˆ©ç”¨çº¿æ€§å›å½’è§£å†³<strong class="kw iu">çº¿æ€§å¯åˆ†é—®é¢˜</strong>ã€‚æˆ‘ä»¬å­¦ä¹ äº†å‘é‡è¡¨ç¤ºã€æ ‡å‡†åŒ–ã€æ·»åŠ åå·®ã€sigmoid å‡½æ•°ã€å¯¹æ•°ä¼¼ç„¶å‡½æ•°å’Œæ›´æ–°å‚æ•°ã€‚</p><p id="6a05" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">è¿™æ¬¡æˆ‘ä»¬è¦è§£å†³ä¸€ä¸ª<strong class="kw iu">éçº¿æ€§å¯åˆ†é—®é¢˜</strong>ã€‚å¦‚æœä½ æ²¡æœ‰çœ‹è¿‡ç¬¬ä¸€éƒ¨åˆ†ï¼Œè¿™å®Œå…¨æ²¡é—®é¢˜ã€‚ç¬¬ 2 éƒ¨åˆ†æ˜¯ç‹¬ç«‹çš„ã€‚ä½†æ˜¯å¦‚æœä½ æƒ³æ›´å¥½åœ°ç†è§£ç¬¬ 2 éƒ¨åˆ†ï¼Œæœ€å¥½å…ˆè¯»ç¬¬ 1 éƒ¨åˆ†ã€‚</p><div class="lr ls gp gr lt lu"><a rel="noopener follow" target="_blank" href="/an-equation-to-code-machine-learning-project-walk-through-in-python-part-1-linear-separable-fd0e19ed2d7"><div class="lv ab fo"><div class="lw ab lx cl cj ly"><h2 class="bd iu gy z fp lz fr fs ma fu fw is bi translated">Python ä¸­çš„â€œç­‰å¼åˆ°ä»£ç â€æœºå™¨å­¦ä¹ é¡¹ç›®æ¼”ç»ƒâ€”ç¬¬ 1 éƒ¨åˆ†çº¿æ€§å¯åˆ†â€¦</h2><div class="mb l"><h3 class="bd b gy z fp lz fr fs ma fu fw dk translated">æ•°å­¦æ–¹ç¨‹å¼èƒŒåçš„è¯¦ç»†è§£é‡Šï¼Œä¸ºä½ çš„æœºå™¨å­¦ä¹ æˆ–å­¦ä¹ å»ºç«‹å®ç”¨çš„æ•°å­¦åŸºç¡€</h3></div><div class="mc l"><p class="bd b dl z fp lz fr fs ma fu fw dk translated">towardsdatascience.com</p></div></div><div class="md l"><div class="me l mf mg mh md mi ks lu"/></div></div></a></div><p id="6b03" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">ä¸‹é¢æ˜¯<a class="ae lq" href="https://gist.github.com/BrambleXu/52b0aaf10987015a078d36c97729dace" rel="noopener ugc nofollow" target="_blank">æ•°æ®</a>å’Œ<a class="ae lq" href="https://gist.github.com/BrambleXu/2640af09b1f43b93c2d951ba91ca3d5c" rel="noopener ugc nofollow" target="_blank">ä»£ç </a>ã€‚</p><p id="ae6b" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">å†…å®¹ç»“æ„å¦‚ä¸‹ã€‚<code class="fe mj mk ml mm b">*</code>è¡¨ç¤ºå¦‚æœæ‚¨å·²ç»å®Œæˆç¬¬ 1 éƒ¨åˆ†ï¼Œå¯ä»¥è·³è¿‡è¿™ä¸€æ­¥ã€‚</p><ol class=""><li id="5549" class="mn mo it kw b kx ky la lb ld mp lh mq ll mr lp ms mt mu mv bi translated">çœ‹æ•°æ®</li><li id="7803" class="mn mo it kw b kx mw la mx ld my lh mz ll na lp ms mt mu mv bi translated"><strong class="kw iu">éçº¿æ€§å¯åˆ†é—®é¢˜</strong></li><li id="000d" class="mn mo it kw b kx mw la mx ld my lh mz ll na lp ms mt mu mv bi translated">æ ‡å‡†åŒ–*</li><li id="73b3" class="mn mo it kw b kx mw la mx ld my lh mz ll na lp ms mt mu mv bi translated"><strong class="kw iu">æ·»åŠ åå·®å’Œå¤šé¡¹å¼é¡¹</strong></li><li id="39e9" class="mn mo it kw b kx mw la mx ld my lh mz ll na lp ms mt mu mv bi translated">Sigmoid å‡½æ•°*</li><li id="fb0f" class="mn mo it kw b kx mw la mx ld my lh mz ll na lp ms mt mu mv bi translated">ä¼¼ç„¶å‡½æ•°*</li><li id="0b0e" class="mn mo it kw b kx mw la mx ld my lh mz ll na lp ms mt mu mv bi translated">æ›´æ–°å‚æ•°Î¸*</li><li id="7306" class="mn mo it kw b kx mw la mx ld my lh mz ll na lp ms mt mu mv bi translated">ç»˜åˆ¶ç›´çº¿</li><li id="3283" class="mn mo it kw b kx mw la mx ld my lh mz ll na lp ms mt mu mv bi translated"><strong class="kw iu">ç²¾åº¦</strong></li><li id="d52a" class="mn mo it kw b kx mw la mx ld my lh mz ll na lp ms mt mu mv bi translated">æ‘˜è¦</li></ol><h1 id="6dd1" class="nb nc it bd nd ne nf ng nh ni nj nk nl jz nm ka nn kc no kd np kf nq kg nr ns bi translated">1 çœ‹æ•°æ®</h1><p id="e791" class="pw-post-body-paragraph ku kv it kw b kx nt ju kz la nu jx lc ld nv lf lg lh nw lj lk ll nx ln lo lp im bi translated">ä¸‹é¢æ˜¯æ•°æ®ï¼Œ<a class="ae lq" href="https://gist.github.com/BrambleXu/a64df128d6c0c26143f82f7b6e889983" rel="noopener ugc nofollow" target="_blank"> non_linear_data.csv </a></p><pre class="kj kk kl km gt ny mm nz oa aw ob bi"><span id="5f7b" class="oc nc it mm b gy od oe l of og">x1,x2,y<br/>0.54508775,2.34541183,0<br/>0.32769134,13.43066561,0<br/>4.42748117,14.74150395,0<br/>2.98189041,-1.81818172,1<br/>4.02286274,8.90695686,1<br/>2.26722613,-6.61287392,1<br/>-2.66447221,5.05453871,1<br/>-1.03482441,-1.95643469,1<br/>4.06331548,1.70892541,1<br/>2.89053966,6.07174283,0<br/>2.26929206,10.59789814,0<br/>4.68096051,13.01153161,1<br/>1.27884366,-9.83826738,1<br/>-0.1485496,12.99605136,0<br/>-0.65113893,10.59417745,0<br/>3.69145079,3.25209182,1<br/>-0.63429623,11.6135625,0<br/>0.17589959,5.84139826,0<br/>0.98204409,-9.41271559,1<br/>-0.11094911,6.27900499,0</span></pre><p id="df2b" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦ç»˜åˆ¶è¿™äº›æ•°æ®ï¼Œçœ‹çœ‹å®ƒæ˜¯ä»€ä¹ˆæ ·å­çš„ã€‚æˆ‘ä»¬åˆ›å»ºä¸€ä¸ª Python æ–‡ä»¶ï¼Œå¹¶å°†å…¶å‘½åä¸º non_logistic_regression.pyã€‚</p><pre class="kj kk kl km gt ny mm nz oa aw ob bi"><span id="95a4" class="oc nc it mm b gy od oe l of og">import numpy as np<br/>import matplotlib.pyplot as plt</span><span id="9364" class="oc nc it mm b gy oh oe l of og"># read data<br/>data = np.loadtxt("non_linear_data.csv", delimiter=',', skiprows=1)<br/>train_x = data[:, 0:2]<br/>train_y = data[:, 2]</span><span id="0da8" class="oc nc it mm b gy oh oe l of og"># plot data points<br/>plt.plot(train_x[train_y == 1, 0], train_x[train_y == 1, 1], 'o')<br/>plt.plot(train_x[train_y == 0, 0], train_x[train_y == 0, 1], 'x')<br/>plt.show()</span></pre><p id="e63d" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">è¿è¡Œä¸Šé¢çš„è„šæœ¬åï¼Œæ‚¨åº”è¯¥ä¼šçœ‹åˆ°ä¸‹å›¾ã€‚</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/7ade453276139aebde2a779b35800e5f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1162/format:webp/1*pGNzrEkJtDTPhCkHDiZecQ.png"/></div></figure><p id="d59e" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">ä¼¼ä¹æˆ‘ä»¬ä¸èƒ½ç”¨ä¸€æ¡ç›´çº¿æ¥åˆ†ç¦» X å’Œ oã€‚æˆ‘ä»¬æŠŠè¿™æ ·çš„é—®é¢˜ç§°ä¸ºéçº¿æ€§å¯åˆ†é—®é¢˜ï¼Œå…¶ä¸­æ•°æ®ä¸æ˜¯çº¿æ€§å¯åˆ†çš„ã€‚</p><h1 id="906f" class="nb nc it bd nd ne nf ng nh ni nj nk nl jz nm ka nn kc no kd np kf nq kg nr ns bi translated">2 éçº¿æ€§å¯åˆ†é—®é¢˜</h1><p id="b844" class="pw-post-body-paragraph ku kv it kw b kx nt ju kz la nu jx lc ld nv lf lg lh nw lj lk ll nx ln lo lp im bi translated">åœ¨ç¬¬ 1 éƒ¨åˆ†ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨<a class="ae lq" href="https://en.wikipedia.org/wiki/Linear_function_(calculus)?oldformat=true#Properties" rel="noopener ugc nofollow" target="_blank">çº¿æ€§å‡½æ•°</a>æ¥è§£å†³çº¿æ€§å¯åˆ†é—®é¢˜ã€‚</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/8a7f6b94f05f89b47964230a43fb407f.png" data-original-src="https://miro.medium.com/v2/resize:fit:394/format:webp/1*vw5nuLbIaL11kdYkCRBHqQ.png"/></div><figcaption class="ok ol gj gh gi om on bd b be z dk">linear function</figcaption></figure><p id="2a7d" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">ä½†æ˜¯å¯¹äºéçº¿æ€§å¯åˆ†é—®é¢˜ï¼Œçº¿æ€§å‡½æ•°è¿‡äºç®€å•ï¼Œéš¾ä»¥å¤„ç†ã€‚æ‰€ä»¥æˆ‘ä»¬å¼•å…¥äº†å¤šé¡¹å¼é€»è¾‘å›å½’ï¼Œå®ƒåœ¨é€»è¾‘å›å½’ä¸­å¢åŠ äº†ä¸€ä¸ªå¤šé¡¹å¼é¡¹ã€‚</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oo"><img src="../Images/1fe7abc3aac2d5f70ec337406cae4fa1.png" data-original-src="https://miro.medium.com/v2/resize:fit:740/format:webp/1*j2qhn6jx1xoLRa0DaHK-dg.png"/></div><figcaption class="ok ol gj gh gi om on bd b be z dk">general form</figcaption></figure><p id="3881" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">æˆ‘ä»¬ç”¨Î¸æ¥è¡¨ç¤ºå‚æ•°ã€‚å·¦è¾¹çš„Î¸æ ‡è®°è¡¨ç¤ºå‡½æ•° f(x)æœ‰å‚æ•°Î¸ã€‚å³è¾¹çš„Î¸è¡¨ç¤ºæœ‰ä¸¤ä¸ªå‚æ•°ã€‚æœ€åä¸€é¡¹æ˜¯å¤šé¡¹å¼é¡¹ï¼Œå®ƒä½¿æ¨¡å‹æ¨å¹¿åˆ°éçº¿æ€§å¯åˆ†æ•°æ®ã€‚</p><p id="5607" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">æ³¨æ„æˆ‘ä»¬åœ¨<a class="ae lq" href="https://gist.github.com/BrambleXu/a64df128d6c0c26143f82f7b6e889983" rel="noopener ugc nofollow" target="_blank"> non_linear_data.csv </a>ä¸­æœ‰ x1 å’Œ x2 ä¸¤ä¸ªç‰¹å¾ã€‚æˆ‘ä»¬é€‰æ‹© x1 ä½œä¸ºå¤šé¡¹å¼é¡¹ã€‚æ‰€ä»¥åŠŸèƒ½åº”è¯¥å˜æˆä½äºå½¢å¼ã€‚</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi op"><img src="../Images/3f19fd852c6c8878549a3d6a524e359b.png" data-original-src="https://miro.medium.com/v2/resize:fit:948/format:webp/1*SEYB_TDpXr5UFEc8ubfyVQ.png"/></div><figcaption class="ok ol gj gh gi om on bd b be z dk">a specific form fit to our data</figcaption></figure><p id="a771" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">æˆ‘ä»¬åˆå§‹åŒ– 4 ä¸ªå‚æ•°</p><pre class="kj kk kl km gt ny mm nz oa aw ob bi"><span id="d931" class="oc nc it mm b gy od oe l of og">import numpy as np<br/>import matplotlib.pyplot as plt</span><span id="c601" class="oc nc it mm b gy oh oe l of og"># read data<br/>data = np.loadtxt("linear_data.csv", <em class="oq">delimiter</em>=',', <em class="oq">skiprows</em>=1)<br/>train_x = data[:, 0:2]<br/>train_y = data[:, 2]</span><span id="89da" class="oc nc it mm b gy oh oe l of og"># initialize parameter<br/><strong class="mm iu">theta = np.random.randn(4)</strong></span></pre><h1 id="1468" class="nb nc it bd nd ne nf ng nh ni nj nk nl jz nm ka nn kc no kd np kf nq kg nr ns bi translated">3 æ ‡å‡†åŒ–</h1><p id="c71b" class="pw-post-body-paragraph ku kv it kw b kx nt ju kz la nu jx lc ld nv lf lg lh nw lj lk ll nx ln lo lp im bi translated">ä¸ºäº†ä½¿è®­ç»ƒå¿«é€Ÿæ”¶æ•›ï¼Œæˆ‘ä»¬ä½¿ç”¨<a class="ae lq" href="https://stats.stackexchange.com/a/10298/116970" rel="noopener ugc nofollow" target="_blank">æ ‡å‡†åŒ–</a>ï¼Œä¹Ÿå«<strong class="kw iu"> z </strong> - <strong class="kw iu">è¯„åˆ†ã€‚</strong>æˆ‘ä»¬æ˜¯æŒ‰åˆ—æ¥åšçš„ã€‚</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi or"><img src="../Images/5c3f709c7b442c54fde9bf1fc63508c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:372/format:webp/1*kFMKX970oeEgG6cM7pRkLg.png"/></div></figure><ul class=""><li id="596e" class="mn mo it kw b kx ky la lb ld mp lh mq ll mr lp os mt mu mv bi translated">ğœ‡åœ¨æ¯ä¸€æ éƒ½å¾ˆåˆ»è–„</li><li id="d12e" class="mn mo it kw b kx mw la mx ld my lh mz ll na lp os mt mu mv bi translated">ğœæ˜¯æ¯åˆ—çš„æ ‡å‡†åå·®</li></ul><pre class="kj kk kl km gt ny mm nz oa aw ob bi"><span id="9a4b" class="oc nc it mm b gy od oe l of og">import numpy as np<br/>import matplotlib.pyplot as plt</span><span id="5318" class="oc nc it mm b gy oh oe l of og"># read data<br/>data = np.loadtxt("linear_data.csv", <em class="oq">delimiter</em>=',', <em class="oq">skiprows</em>=1)<br/>train_x = data[:, 0:2]<br/>train_y = data[:, 2]</span><span id="9351" class="oc nc it mm b gy oh oe l of og"># initialize parameter<br/>theta = np.random.randn(4)</span><span id="be84" class="oc nc it mm b gy oh oe l of og"><strong class="mm iu"># standardization<br/>mu = train_x.mean(axis=0)<br/>sigma = train_x.std(axis=0)</strong></span><span id="9d09" class="oc nc it mm b gy oh oe l of og"><strong class="mm iu">def standardizer(x):<br/>    return (x - mu) / sigma</strong></span><span id="d15b" class="oc nc it mm b gy oh oe l of og"><strong class="mm iu">std_x = standardizer(train_x)</strong></span></pre><h1 id="20fb" class="nb nc it bd nd ne nf ng nh ni nj nk nl jz nm ka nn kc no kd np kf nq kg nr ns bi translated">4 æ·»åŠ åå·®å’Œå¤šé¡¹å¼é¡¹</h1><p id="96ae" class="pw-post-body-paragraph ku kv it kw b kx nt ju kz la nu jx lc ld nv lf lg lh nw lj lk ll nx ln lo lp im bi translated">æˆ‘ä»¬éœ€è¦æ·»åŠ ä¸€ä¸ªåå·®å’Œå¤šé¡¹å¼é¡¹æ¥æ„å»ºæ•°æ®çŸ©é˜µã€‚æˆ‘ä»¬æ·»åŠ ä¸€ä¸ªå¸¸æ•° x0=1ï¼Œä»¥ä¾¿å¯¹é½çŸ¢é‡è¡¨ç¤ºã€‚</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi op"><img src="../Images/3f19fd852c6c8878549a3d6a524e359b.png" data-original-src="https://miro.medium.com/v2/resize:fit:948/format:webp/1*SEYB_TDpXr5UFEc8ubfyVQ.png"/></div><figcaption class="ok ol gj gh gi om on bd b be z dk">a specific form fit to our data</figcaption></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ot"><img src="../Images/1c7d99d806b8250ca87ea521d4b67c99.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wzwKswA_ZY7yDKxb_khmWQ.png"/></div></div><figcaption class="ok ol gj gh gi om on bd b be z dk">vector representation</figcaption></figure><p id="45e1" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">æ‚¨å¯ä»¥åœ¨ç¬¬ 1 éƒ¨åˆ†æ‰¾åˆ°æ›´å¤šçš„çŸ¢é‡è¡¨ç¤ºç»†èŠ‚:<a class="ae lq" rel="noopener" target="_blank" href="/an-equation-to-code-machine-learning-project-walk-through-in-python-part-1-linear-separable-fd0e19ed2d7"> 3 çŸ¢é‡è¡¨ç¤º</a>ã€‚</p><p id="3c58" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">ä¸ºäº†ä½¿è®¡ç®—æ›´ç®€å•ï¼Œæˆ‘ä»¬æŠŠ x è½¬æ¢æˆçŸ©é˜µã€‚</p><pre class="kj kk kl km gt ny mm nz oa aw ob bi"><span id="d4a1" class="oc nc it mm b gy od oe l of og">import numpy as np<br/>import matplotlib.pyplot as plt</span><span id="0057" class="oc nc it mm b gy oh oe l of og"># read data<br/>data = np.loadtxt("linear_data.csv", delimiter=',', skiprows=1)<br/>train_x = data[:, 0:2]<br/>train_y = data[:, 2]</span><span id="d672" class="oc nc it mm b gy oh oe l of og"># initialize parameter<br/>theta = np.random.randn(4)</span><span id="29c2" class="oc nc it mm b gy oh oe l of og"># standardization<br/>mu = train_x.mean(axis=0)<br/>sigma = train_x.std(axis=0)<br/>def standardizer(x):<br/>    return (x - mu) / sigma<br/>std_x = standardizer(train_x)</span><span id="3341" class="oc nc it mm b gy oh oe l of og"><strong class="mm iu"># add x0 and x1^2 to get matrix<br/>def to_matrix(x):<br/>    x0 = np.ones([x.shape[0], 1]) <br/>    x3 = x[:, 0, np.newaxis] ** 2<br/>    return np.hstack([x0, x, x3])</strong></span><span id="f766" class="oc nc it mm b gy oh oe l of og"><strong class="mm iu">mat_x = to_matrix(std_x) </strong></span><span id="9abe" class="oc nc it mm b gy oh oe l of og"><strong class="mm iu"># dot product<br/>def f(x):<br/>    return np.dot(x, theta)</strong></span></pre><p id="3b3f" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">æˆ‘ä»¬ç”¨ x3 æ¥è¡¨ç¤º<code class="fe mj mk ml mm b">x1*x1</code>ã€‚</p><p id="a030" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><code class="fe mj mk ml mm b">std_x</code>çš„å°ºå¯¸ä¸º<code class="fe mj mk ml mm b">(20, 2)</code>ã€‚åœ¨<code class="fe mj mk ml mm b">to_matrix(std_x)</code>ä¹‹åï¼Œ<code class="fe mj mk ml mm b">mat_x</code>çš„å°ºå¯¸ä¸º<code class="fe mj mk ml mm b">(20, 4)</code>ã€‚è‡³äºç‚¹ç§¯éƒ¨åˆ†ï¼Œç»“æœçš„ç»´åº¦æ˜¯<code class="fe mj mk ml mm b">(4,)</code>ã€‚æ‰€ä»¥ç‚¹ç”Ÿæˆçš„ç»“æœåº”è¯¥æ˜¯<code class="fe mj mk ml mm b">(20, 4) x (4,) -&gt; (20,)</code>ï¼Œè¿™æ˜¯ä¸€ä¸ªåŒ…å« 20 ä¸ªæ ·æœ¬é¢„æµ‹çš„ä¸€ç»´æ•°ç»„ã€‚</p><h1 id="8e13" class="nb nc it bd nd ne nf ng nh ni nj nk nl jz nm ka nn kc no kd np kf nq kg nr ns bi translated">5 Sigmoid å‡½æ•°</h1><p id="9977" class="pw-post-body-paragraph ku kv it kw b kx nt ju kz la nu jx lc ld nv lf lg lh nw lj lk ll nx ln lo lp im bi translated">ä¸‹é¢æ˜¯çŸ¢é‡è¡¨ç¤º</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ou"><img src="../Images/10ce40c08977faa5b95da2864ca87a26.png" data-original-src="https://miro.medium.com/v2/resize:fit:432/format:webp/1*IEr3mjvw_3--VCyHE-XWfA.png"/></div></figure><p id="d1a0" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">ç„¶åæˆ‘ä»¬å°†åŸºäºå®ƒå»ºç«‹ä¸€ä¸ªæ›´å¼ºå¤§çš„é¢„æµ‹å‡½æ•°ï¼Œsigmoid å‡½æ•°ã€‚</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ov"><img src="../Images/6b8e85b53ae5c43c8ad4dff2f1299236.png" data-original-src="https://miro.medium.com/v2/resize:fit:620/format:webp/1*zjFf9ZzshxTJlC7edROoAw.png"/></div></figure><p id="f380" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">æˆ‘ä»¬ç”¨ z æ¥è¡¨ç¤ºçº¿æ€§å‡½æ•°ï¼Œå¹¶å°†å…¶ä¼ é€’ç»™ sigmoid å‡½æ•°ã€‚sigmoid å‡½æ•°å°†ç»™å‡ºæ¯ä¸ªæ•°æ®æ ·æœ¬çš„æ¦‚ç‡ã€‚æˆ‘ä»¬çš„æ•°æ®ä¸­æœ‰ä¸¤ä¸ªç±»ï¼Œä¸€ä¸ªæ˜¯<code class="fe mj mk ml mm b">1</code>ï¼Œå¦ä¸€ä¸ªæ˜¯<code class="fe mj mk ml mm b">0</code>ã€‚</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ow"><img src="../Images/598ca2a33e63ef98b71a31237199f730.png" data-original-src="https://miro.medium.com/v2/resize:fit:936/format:webp/1*4h5rdzqS4bctbo7ixZpHfA.png"/></div></figure><p id="2f91" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ¨¡å‹åŸºäºçº¿æ€§å‡½æ•°éƒ¨åˆ†é¢„æµ‹æ ·æœ¬ã€‚</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ox"><img src="../Images/76e6302b06c1921c101316eb5574518b.png" data-original-src="https://miro.medium.com/v2/resize:fit:616/format:webp/1*uXvvRDXyzKCP7Oh0uRArMw.png"/></div></figure><p id="c092" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">æˆ‘ä»¬å¯ä»¥å†™ä¸‹é¢çš„ä»£ç </p><pre class="kj kk kl km gt ny mm nz oa aw ob bi"><span id="e14b" class="oc nc it mm b gy od oe l of og">import numpy as np<br/>import matplotlib.pyplot as plt</span><span id="994e" class="oc nc it mm b gy oh oe l of og"># read data<br/>data = np.loadtxt("linear_data.csv", delimiter=',', skiprows=1)<br/>train_x = data[:, 0:2]<br/>train_y = data[:, 2]</span><span id="0f3c" class="oc nc it mm b gy oh oe l of og"># initialize parameter<br/>theta = np.random.randn(4)</span><span id="1026" class="oc nc it mm b gy oh oe l of og"># standardization<br/>mu = train_x.mean(axis=0)<br/>sigma = train_x.std(axis=0)<br/>def standardizer(x):<br/>    return (x - mu) / sigma<br/>std_x = standardizer(train_x)</span><span id="bb72" class="oc nc it mm b gy oh oe l of og"># add x0 and x1^2 to get matrix<br/>def to_matrix(x):<br/>    x0 = np.ones([x.shape[0], 1]) <br/>    x3 = x[:, 0, np.newaxis] ** 2<br/>    return np.hstack([x0, x, x3])<br/>mat_x = to_matrix(std_x)</span><span id="9e6b" class="oc nc it mm b gy oh oe l of og"><strong class="mm iu"># change dot production to sigmoid function<br/>def f(x):<br/>    return 1 / (1 + np.exp(-np.dot(x, theta)))</strong></span></pre><h1 id="87e4" class="nb nc it bd nd ne nf ng nh ni nj nk nl jz nm ka nn kc no kd np kf nq kg nr ns bi translated">6 ä¼¼ç„¶å‡½æ•°</h1><blockquote class="oy oz pa"><p id="9328" class="ku kv oq kw b kx ky ju kz la lb jx lc pb le lf lg pc li lj lk pd lm ln lo lp im bi translated">å¦‚æœæ‚¨å¯¹æ–¹ç¨‹çš„è§£é‡Šä¸æ„Ÿå…´è¶£ï¼Œæˆ–è€…æ‚¨å·²ç»åœ¨ç¬¬ 1 éƒ¨åˆ†ä¸­é˜…è¯»è¿‡ï¼Œé‚£ä¹ˆæ‚¨å¯ä»¥è·³è¿‡è¿™ä¸€æ­¥</p></blockquote><p id="1358" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">å¥½äº†ï¼Œæˆ‘ä»¬å‡†å¤‡äº†æ•°æ®ã€æ¨¡å‹(sigmoid ),è¿˜éœ€è¦ä»€ä¹ˆï¼Ÿæ˜¯çš„ï¼Œä¸€ä¸ªç›®æ ‡å‡½æ•°ã€‚<strong class="kw iu">ç›®æ ‡å‡½æ•°å¯ä»¥æŒ‡å¯¼æˆ‘ä»¬å¦‚ä½•ä»¥æ­£ç¡®çš„æ–¹å¼æ›´æ–°å‚æ•°ã€‚å¯¹äº sigmoid(é€»è¾‘å›å½’),æˆ‘ä»¬é€šå¸¸ä½¿ç”¨<a class="ae lq" href="https://www.wikiwand.com/en/Likelihood_function#/Log-likelihood" rel="noopener ugc nofollow" target="_blank">å¯¹æ•°ä¼¼ç„¶</a>ä½œä¸ºç›®æ ‡å‡½æ•°</strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pe"><img src="../Images/3de81529a87d49a1798074dc8c709b82.png" data-original-src="https://miro.medium.com/v2/resize:fit:1300/format:webp/1*B4kyEas04xPWZVarH56faA.png"/></div></figure><p id="81e0" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">ç­‰ç­‰ï¼Œç­‰ç­‰â€¦è¿™äº›ä¸œè¥¿åˆ°åº•æ˜¯æ€ä¹ˆå›äº‹ï¼</p><p id="ae28" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><strong class="kw iu">ä¸è¦æ…Œã€‚å†·é™ç‚¹ã€‚</strong></p><p id="c1ae" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">è®©æˆ‘ä»¬æŠŠå®ƒæ‹†å¼€ã€‚</p><ul class=""><li id="f32d" class="mn mo it kw b kx ky la lb ld mp lh mq ll mr lp os mt mu mv bi translated">1-&gt;2(å¦‚ä½•ä»ç¬¬ 1 è¡Œåˆ°ç¬¬ 2 è¡Œ):<code class="fe mj mk ml mm b">log(ab) = log a + log b</code></li><li id="b683" class="mn mo it kw b kx mw la mx ld my lh mz ll na lp os mt mu mv bi translated">2-&gt;3: <code class="fe mj mk ml mm b">log(a)^b = b * log a</code></li><li id="40db" class="mn mo it kw b kx mw la mx ld my lh mz ll na lp os mt mu mv bi translated">3-&gt;4:ç”±äºæˆ‘ä»¬åªæœ‰ä¸¤ä¸ªç±»ï¼Œy=0 å’Œ y=1ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„ç­‰å¼:</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pf"><img src="../Images/7a8e5fda818e6cb17e20c614240fd8d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:664/format:webp/1*6I_D7MH3ArrhI4vkdLE_GA.png"/></div><figcaption class="ok ol gj gh gi om on bd b be z dk">3-&gt;4</figcaption></figure><ul class=""><li id="29b8" class="mn mo it kw b kx ky la lb ld mp lh mq ll mr lp os mt mu mv bi translated">4-&gt;5:æˆ‘ä»¬ä½¿ç”¨ä¸‹é¢çš„å˜æ¢ä½¿ç­‰å¼æ›´å…·å¯è¯»æ€§</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pg"><img src="../Images/d710cf2c40d17501bede7769043057d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:454/format:webp/1*bLJ9l-I2i2znZDigyve00w.png"/></div></figure><p id="5423" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">æ‰€ä»¥æˆ‘ä»¬å¾—åˆ°äº†æœ€åä¸€éƒ¨åˆ†ã€‚</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ph"><img src="../Images/203b7f77765d76082d62d215395437a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1066/format:webp/1*SLJUZ9eJ5tcKzNFdPQTiiA.png"/></div></figure><p id="9e09" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">åˆ«å¿˜äº†æˆ‘ä»¬ä¸ºä»€ä¹ˆå¼€å§‹è¿™ä¸ªã€‚<strong class="kw iu">ç›®æ ‡å‡½æ•°å¯ä»¥æŒ‡å¯¼æˆ‘ä»¬å¦‚ä½•ä»¥æ­£ç¡®çš„æ–¹å¼æ›´æ–°å‚æ•°ã€‚</strong></p><p id="2d80" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">æˆ‘ä»¬éœ€è¦ç”¨è¿™ä¸ªæ¥è®¡ç®—æŸè€—ï¼Œä»¥æ›´æ–°å‚æ•°ã€‚æ›´å…·ä½“åœ°è¯´ï¼Œæˆ‘ä»¬éœ€è¦è®¡ç®—å¯¹æ•°ä¼¼ç„¶å‡½æ•°çš„<strong class="kw iu">å¯¼æ•°</strong>ã€‚è¿™é‡Œæˆ‘ç›´æ¥ç»™å‡ºæœ€åçš„æ›´æ–°æ–¹ç¨‹å¼ã€‚(å¦‚æœä½ å¯¹å¦‚ä½•å¾—åˆ°è¿™ä¸ªæ–¹ç¨‹æ„Ÿå…´è¶£ï¼Œè¿™ä¸ª<a class="ae lq" href="https://www.youtube.com/watch?v=SB2vz57eKgc" rel="noopener ugc nofollow" target="_blank">è§†é¢‘</a>åº”è¯¥ä¼šæœ‰å¸®åŠ©)</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pi"><img src="../Images/92da534e72a3ead43346ba4017d5b243.png" data-original-src="https://miro.medium.com/v2/resize:fit:1062/format:webp/1*4SKBVfcX3OQ2uLqgnTgzTw.png"/></div></figure><p id="e778" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><strong class="kw iu">ç¬¬å…­æ­¥ï¼Œæœ€é‡è¦çš„æ–¹ç¨‹å°±æ˜¯è¿™ä¸ªã€‚å¦‚æœä½ ä¸æ˜ç™½å¦‚ä½•åšåˆ°è¿™ä¸€ç‚¹ï¼Œè¿™æ˜¯å®Œå…¨å¯ä»¥çš„ã€‚æˆ‘ä»¬éœ€è¦åšçš„å°±æ˜¯æŠŠå®ƒå†™æˆçœŸæ­£çš„ä»£ç ã€‚</strong></p><h1 id="7d02" class="nb nc it bd nd ne nf ng nh ni nj nk nl jz nm ka nn kc no kd np kf nq kg nr ns bi translated">7 æ›´æ–°å‚æ•°Î¸</h1><blockquote class="oy oz pa"><p id="cff5" class="ku kv oq kw b kx ky ju kz la lb jx lc pb le lf lg pc li lj lk pd lm ln lo lp im bi translated">å¦‚æœæ‚¨å·²ç»é˜…è¯»äº†ç¬¬ 1 éƒ¨åˆ†ï¼Œå¯ä»¥è·³è¿‡è¿™ä¸€æ­¥</p></blockquote><p id="ea91" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">è¿™ä¸€æ­¥éå¸¸é‡è¦ã€‚<strong class="kw iu">ä¸è¦æ…Œ</strong>ã€‚æˆ‘ä»¬ä¼šç ´è§£å®ƒã€‚</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pi"><img src="../Images/92da534e72a3ead43346ba4017d5b243.png" data-original-src="https://miro.medium.com/v2/resize:fit:1062/format:webp/1*4SKBVfcX3OQ2uLqgnTgzTw.png"/></div></figure><p id="cf39" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">Î¸j æ˜¯ç¬¬ j ä¸ªå‚æ•°ã€‚</p><ul class=""><li id="85a4" class="mn mo it kw b kx ky la lb ld mp lh mq ll mr lp os mt mu mv bi translated">Î·æ˜¯å­¦ä¹ ç‡ï¼Œæˆ‘ä»¬è®¾ä¸º 0.001 (1e-3)ã€‚</li><li id="9822" class="mn mo it kw b kx mw la mx ld my lh mz ll na lp os mt mu mv bi translated">n æ˜¯æ•°æ®æ ·æœ¬çš„æ•°é‡ï¼Œåœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬æœ‰ 20 ä¸ªã€‚</li><li id="9b50" class="mn mo it kw b kx mw la mx ld my lh mz ll na lp os mt mu mv bi translated">I æ˜¯ç¬¬ I ä¸ªæ•°æ®æ ·æœ¬</li></ul><p id="16ab" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">å› ä¸ºæˆ‘ä»¬æœ‰ä¸‰ä¸ªå‚æ•°ï¼Œæ‰€ä»¥å¯ä»¥å†™æˆä¸‰ä¸ªæ–¹ç¨‹ã€‚æˆ‘ä»¬ç”¨ x3 æ¥ä»£è¡¨<code class="fe mj mk ml mm b">x1*x1</code>ã€‚</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pj"><img src="../Images/3ff5eab945f0274f43a9ca12ea2cc1ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1150/format:webp/1*RcwwcaDapXVRJlDdqdW3bQ.png"/></div></figure><p id="e9bc" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><code class="fe mj mk ml mm b">:=</code>ç¬¦å·å°±åƒ<code class="fe mj mk ml mm b">=</code>ã€‚ä½ å¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°è§£é‡Š<a class="ae lq" href="https://math.stackexchange.com/questions/25214/what-does-mean" rel="noopener ugc nofollow" target="_blank"/>ã€‚</p><p id="ac73" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">æœ€éš¾çš„éƒ¨åˆ†æ˜¯Ïƒ(æ±‚å’Œç¬¦å·)ï¼Œæ‰€ä»¥ä¸ºäº†æ›´å¥½åœ°ç†è§£ï¼Œæˆ‘æ‰©å±•äº†Ïƒã€‚</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pk"><img src="../Images/dff28b0186a5db02adafa21f12189b0d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Gp23l1Y_A2Iuq0elke-Dnw.png"/></div></div></figure><p id="a0db" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">ä»”ç»†çœ‹ã€‚</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pl"><img src="../Images/a84dd60eb4bfff985c4de97f899c8ed8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7P4diqGPQXHNNfMzkd0UKg.png"/></div></div></figure><p id="62f3" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">æˆ‘ç»™ç­‰å¼ä¸­çš„ä¸‰ä¸ªéƒ¨åˆ†æ¶‚ä¸Šé¢œè‰²ï¼Œå› ä¸ºæˆ‘ä»¬å¯ä»¥ç”¨çŸ©é˜µæ¥è¡¨ç¤ºå®ƒä»¬ã€‚çœ‹ç¬¬ä¸€è¡Œçº¢è‰²å’Œè“è‰²çš„éƒ¨åˆ†ï¼Œæˆ‘ä»¬æ›´æ–°äº†Î¸0ã€‚</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pm"><img src="../Images/db5e3e16ff2281e3fa518c2470f6e0b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*447tLj7UZp5FrtdzajAQMQ.png"/></div></div></figure><p id="336a" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">æˆ‘ä»¬æŠŠçº¢è‰²éƒ¨åˆ†å’Œè“è‰²éƒ¨åˆ†å†™æˆåˆ—å‘é‡ã€‚</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pn"><img src="../Images/5eba89b5540ee2ca291c4f4d071858f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1138/format:webp/1*k6oWPBRvYCehNdWiuKUOGA.png"/></div></figure><p id="14d9" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">å› ä¸ºæˆ‘ä»¬æœ‰ 20 ä¸ªæ•°æ®æ ·æœ¬ï¼Œæ‰€ä»¥<code class="fe mj mk ml mm b">f</code>çš„ç»´æ•°æ˜¯<code class="fe mj mk ml mm b">(20,1)</code>ã€‚<code class="fe mj mk ml mm b">x0</code>çš„å°ºå¯¸ä¸º<code class="fe mj mk ml mm b">(20,1)</code>ã€‚æˆ‘ä»¬å¯ä»¥ç”¨è½¬ç½®å†™çŸ©é˜µä¹˜æ³•ã€‚</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi po"><img src="../Images/0cf3d8cd3910b07662571919f704f771.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CeoMiq-8V77id3NmvaTQiQ.png"/></div></div></figure><p id="0e83" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">æ‰€ä»¥ç»´åº¦åº”è¯¥æ˜¯<code class="fe mj mk ml mm b">(1, 20) x (20, 1) -&gt; (1,)</code>ã€‚æˆ‘ä»¬å¾—åˆ°ä¸€ä¸ªæ ‡åº¦æ¥æ›´æ–°Î¸0ã€‚</p><p id="8b46" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><code class="fe mj mk ml mm b">x1</code>å’Œ<code class="fe mj mk ml mm b">x2</code>ä¹Ÿæ˜¯åˆ—å‘é‡ã€‚æˆ‘ä»¬å¯ä»¥æŠŠå®ƒä»¬å†™æˆä¸€ä¸ª<strong class="kw iu"> X </strong>çŸ©é˜µã€‚</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pp"><img src="../Images/e695e2e56a9bf00c1577f7db717cedb5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1152/format:webp/1*4o5B_hL60FuSYASKMSTtfg.png"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pq"><img src="../Images/904ef77c5a1584b4b1981e5547f327b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:536/format:webp/1*pSaLb6se_HSrnIo2s7ixBw.png"/></div></figure><p id="f344" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">Î¸æ˜¯ä¸€ä¸ªè¡Œå‘é‡</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pr"><img src="../Images/2d7bc9e4e313e6fbedfa95c3719c02ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:524/format:webp/1*bhHuRyZEylhCtSjpDKM3nw.png"/></div></figure><p id="6dad" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">å›åˆ°ç­‰å¼ã€‚</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pl"><img src="../Images/a84dd60eb4bfff985c4de97f899c8ed8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7P4diqGPQXHNNfMzkd0UKg.png"/></div></div></figure><p id="b671" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">æˆ‘ä»¬å¯ä»¥å†™ä¸º</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ps"><img src="../Images/5544dd9d089a5276415b6f09de77c8d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:468/format:webp/1*2IkwPx9uJtUTfi1APcbZaw.png"/></div></figure><p id="3327" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">æŠŠå®ƒå†™æˆä¸€ä¸ªç­‰å¼ã€‚</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pt"><img src="../Images/cba3402100ab21cdce3de0cf1ab08c27.png" data-original-src="https://miro.medium.com/v2/resize:fit:276/format:webp/1*zppuuAQ87FhuDO5hR8hCKA.png"/></div></figure><p id="c4ef" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">ç±»ä¼¼ Numpy æ•°ç»„çš„ç‰ˆæœ¬å¯èƒ½å®¹æ˜“ç†è§£ã€‚</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pu"><img src="../Images/8548f80491498880aa47207a696be49e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JXq9DyKsVVusNtH_cd3TvQ.png"/></div></div></figure><p id="069b" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">è®©æˆ‘ä»¬åšä¸€ç‚¹è®¡ç®—ï¼Œä»¥ç¡®ä¿å°ºå¯¸æ˜¯æ­£ç¡®çš„ã€‚</p><pre class="kj kk kl km gt ny mm nz oa aw ob bi"><span id="c770" class="oc nc it mm b gy od oe l of og">Î¸: (1, 4) <br/>f^T: (1, 20) <br/>x: (20, 4)</span><span id="6d4c" class="oc nc it mm b gy oh oe l of og">dot production: (1, 20) x (20, 4) -&gt; (1, 4)</span></pre><p id="8736" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">ä¸€åˆ‡çœ‹èµ·æ¥éƒ½é‚£ä¹ˆæ­£ç¡®ã€‚è®©æˆ‘ä»¬å†™ä»£ç ã€‚å…¶å®å°±ä¸¤è¡Œã€‚</p><pre class="kj kk kl km gt ny mm nz oa aw ob bi"><span id="f101" class="oc nc it mm b gy od oe l of og">import numpy as np<br/>import matplotlib.pyplot as plt</span><span id="7092" class="oc nc it mm b gy oh oe l of og"># read data<br/>data = np.loadtxt("linear_data.csv", delimiter=',', skiprows=1)<br/>train_x = data[:, 0:2]<br/>train_y = data[:, 2]</span><span id="b20b" class="oc nc it mm b gy oh oe l of og"># initialize parameter<br/>theta = np.random.randn(4)</span><span id="4ce7" class="oc nc it mm b gy oh oe l of og"># standardization<br/>mu = train_x.mean(axis=0)<br/>sigma = train_x.std(axis=0)<br/>def standardizer(x):<br/>    return (x - mu) / sigma<br/>std_x = standardizer(train_x)</span><span id="5b76" class="oc nc it mm b gy oh oe l of og"># add x0 and x1^2 to get matrix<br/>def to_matrix(x):<br/>    x0 = np.ones([x.shape[0], 1]) <br/>    x3 = x[:, 0, np.newaxis] ** 2<br/>    return np.hstack([x0, x, x3])<br/>mat_x = to_matrix(std_x)</span><span id="9120" class="oc nc it mm b gy oh oe l of og"># sigmoid function<br/>def f(x):<br/>    return 1 / (1 + np.exp(-np.dot(x, theta)))</span><span id="49f7" class="oc nc it mm b gy oh oe l of og"># update times<br/>epoch = 2000</span><span id="79b6" class="oc nc it mm b gy oh oe l of og"># learning rate<br/>ETA = 1e-3</span><span id="2bf5" class="oc nc it mm b gy oh oe l of og"># update parameter<br/><strong class="mm iu">for _ in range(epoch):<br/></strong>    """<br/>    f(mat_x) - train_y: (20,)<br/>    mat_x: (20, 4)<br/>    theta: (4,)<br/>    <br/>    dot production: (20,) x (20, 4) -&gt; (4,)<br/>    """<br/><strong class="mm iu">    theta = theta - ETA * np.dot(f(mat_x) - train_y, mat_x)</strong></span></pre><p id="bc42" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">å¥‡æ€ªçš„äº‹ï¼Ÿè¿˜è®°å¾—æˆ‘ä»¬åœ¨ä»£ç å‰å†™äº†ä»€ä¹ˆå—ï¼Ÿ</p><pre class="kj kk kl km gt ny mm nz oa aw ob bi"><span id="4288" class="oc nc it mm b gy od oe l of og">dot production: (1, 20) x (20, 4) -&gt; (1, 4)</span><span id="a98b" class="oc nc it mm b gy oh oe l of og">The dimension changes make sense here.</span></pre><p id="fdb2" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">ä½†æ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬å†™ä»£ç çš„æ—¶å€™è¦ç”¨<code class="fe mj mk ml mm b">(20,) x (20, 4) -&gt; (4,)</code>ï¼Ÿ</p><p id="729f" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">å®é™…ä¸Šï¼Œè¿™ä¸æ˜¯çœŸæ­£çš„æ•°å­¦ç¬¦å·ï¼Œè¿™æ˜¯ Numpy ç¬¦å·ã€‚è€Œä¸”å¦‚æœä½ ç”¨çš„æ˜¯ TensorFlow æˆ–è€… PyTroch çš„è¯ï¼Œåº”è¯¥å¾ˆç†Ÿæ‚‰ã€‚</p><p id="fc92" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><code class="fe mj mk ml mm b">(20,)</code>è¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªåŒ…å« 20 ä¸ªæ•°å­—çš„ä¸€ç»´æ•°ç»„ã€‚å®ƒå¯ä»¥æ˜¯è¡Œå‘é‡ï¼Œä¹Ÿå¯ä»¥æ˜¯åˆ—å‘é‡ï¼Œå› ä¸ºå®ƒåªæœ‰ä¸€ç»´ã€‚å¦‚æœæˆ‘ä»¬å°†å…¶è®¾ç½®ä¸ºäºŒç»´æ•°ç»„ï¼Œåƒ<code class="fe mj mk ml mm b">(20, 1)</code>æˆ–<code class="fe mj mk ml mm b">(1, 20)</code>ï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆå®¹æ˜“åœ°ç¡®å®š<code class="fe mj mk ml mm b">(20, 1)</code>æ˜¯åˆ—å‘é‡è€Œ<code class="fe mj mk ml mm b">(1, 20)</code>æ˜¯è¡Œå‘é‡ã€‚</p><p id="5372" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><strong class="kw iu">ä½†æ˜¯ä¸ºä»€ä¹ˆä¸æ˜¾å¼è®¾ç½®ç»´åº¦æ¥æ¶ˆé™¤æ­§ä¹‰å‘¢ï¼Ÿ</strong></p><p id="3602" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">å¥½å§ã€‚ç›¸ä¿¡æˆ‘ï¼Œæˆ‘ç¬¬ä¸€æ¬¡çœ‹åˆ°è¿™ä¸ªçš„æ—¶å€™å°±æœ‰æ¥ç¼é—®é¢˜ã€‚ä½†æ˜¯ç»è¿‡ä¸€äº›ç¼–ç å®è·µï¼Œæˆ‘æƒ³æˆ‘çŸ¥é“åŸå› äº†ã€‚</p><p id="58ae" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><strong class="kw iu">å› ä¸ºè¿™æ ·å¯ä»¥èŠ‚çœæˆ‘ä»¬çš„æ—¶é—´ï¼</strong></p><p id="e937" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">æˆ‘ä»¬ä»¥<code class="fe mj mk ml mm b">(20,) x (20, 4) -&gt; (4,)</code>ä¸ºä¾‹ã€‚å¦‚æœæˆ‘ä»¬æƒ³å¾—åˆ°<code class="fe mj mk ml mm b">(1, 20) x (20, 4) -&gt; (1, 4)</code>ï¼Œæˆ‘ä»¬éœ€è¦å¯¹<code class="fe mj mk ml mm b">(20,) x (20, 4) -&gt; (4,)</code>åšä»€ä¹ˆï¼Ÿ</p><ul class=""><li id="3158" class="mn mo it kw b kx ky la lb ld mp lh mq ll mr lp os mt mu mv bi translated">å°†(20ï¼Œ)è½¬æ¢ä¸º(1ï¼Œ20)</li><li id="9023" class="mn mo it kw b kx mw la mx ld my lh mz ll na lp os mt mu mv bi translated">è®¡ç®—(1ï¼Œ20) x (20ï¼Œ4) -&gt; (1ï¼Œ4)</li><li id="acc9" class="mn mo it kw b kx mw la mx ld my lh mz ll na lp os mt mu mv bi translated">å› ä¸º(1ï¼Œ4)æ˜¯ä¸€ä¸ªäºŒç»´åˆ—å‘é‡ï¼Œæˆ‘ä»¬éœ€è¦å°†å…¶è½¬æ¢ä¸ºä¸€ç»´æ•°ç»„ã€‚(1,4) -&gt; (4,)</li></ul><p id="291c" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">è€å®è¯´ï¼Œè¿™å¾ˆä»¤äººæ²®ä¸§ã€‚ä¸ºä»€ä¹ˆæˆ‘ä»¬ä¸èƒ½ä¸€æ­¥åˆ°ä½ï¼Ÿ</p><p id="67be" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">å¯¹ï¼Œæ‰€ä»¥æˆ‘ä»¬æ‰èƒ½å†™<code class="fe mj mk ml mm b">(20,) x (20, 4) -&gt; (4,)</code>ã€‚</p><p id="d7df" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">å¥½äº†ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹<a class="ae lq" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.dot.html" rel="noopener ugc nofollow" target="_blank"> numpy.dot() </a> doc æ˜¯æ€ä¹ˆè¯´çš„ã€‚</p><blockquote class="oy oz pa"><p id="cc32" class="ku kv oq kw b kx ky ju kz la lb jx lc pb le lf lg pc li lj lk pd lm ln lo lp im bi translated"><a class="ae lq" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.dot.html" rel="noopener ugc nofollow" target="_blank"> numpy.dot() </a>:å¦‚æœ<em class="it"> a </em>æ˜¯ä¸€ä¸ª N ç»´æ•°ç»„ï¼Œ<em class="it"> b </em>æ˜¯ä¸€ä¸ª 1 ç»´æ•°ç»„ï¼Œé‚£ä¹ˆå®ƒå°±æ˜¯<em class="it"> a </em>å’Œ<em class="it"> b </em>æœ€åä¸€ä¸ªè½´ä¸Šçš„å’Œç§¯ã€‚</p></blockquote><p id="a467" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">å—¯ï¼Œäº‹å®ä¸Šæˆ‘ä¸æ˜ç™½ã€‚ä½†æ˜¯<a class="ae lq" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.matmul.html#numpy.matmul" rel="noopener ugc nofollow" target="_blank"> np.matmul() </a>æè¿°äº†ä¸(20ï¼Œ1)æˆ–(1ï¼Œ20)çš„æ•´å½¢ç±»ä¼¼çš„è®¡ç®—ï¼Œä»¥æ‰§è¡Œæ ‡å‡†çš„ 2d çŸ©é˜µä¹˜ç§¯ã€‚ä¹Ÿè®¸æˆ‘ä»¬èƒ½å¾—åˆ°ä¸€äº›çµæ„Ÿã€‚</p><blockquote class="oy oz pa"><p id="ff5f" class="ku kv oq kw b kx ky ju kz la lb jx lc pb le lf lg pc li lj lk pd lm ln lo lp im bi translated"><a class="ae lq" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.matmul.html#numpy.matmul" rel="noopener ugc nofollow" target="_blank"> np.matmul() </a>:å¦‚æœç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ä¸€ç»´çš„ï¼Œé‚£ä¹ˆé€šè¿‡åœ¨å®ƒçš„ç»´æ•°å‰åŠ ä¸Š 1ï¼Œå®ƒè¢«æå‡ä¸ºä¸€ä¸ªçŸ©é˜µã€‚åœ¨çŸ©é˜µä¹˜æ³•ä¹‹åï¼Œå‰ç½®çš„ 1 è¢«ç§»é™¤ã€‚</p></blockquote><p id="bfc7" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">å“ˆï¼Œè¿™å°±æ˜¯ç¼ºå¤±çš„éƒ¨åˆ†ï¼æ‰€ä»¥åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œ<code class="fe mj mk ml mm b">(20,)</code>å˜æˆäº†<code class="fe mj mk ml mm b">(1, 20)</code>ï¼Œå› ä¸º<code class="fe mj mk ml mm b">(20,4)</code>çš„ç¬¬ä¸€ç»´åº¦æ˜¯ 20ã€‚è¿˜æœ‰<code class="fe mj mk ml mm b">(1, 20) * (20, 4) -&gt; (1, 4)</code>ã€‚ç„¶åå‰ç½® 1 è¢«åˆ é™¤ï¼Œæ‰€ä»¥æˆ‘ä»¬å¾—åˆ°<code class="fe mj mk ml mm b">(4,)</code>ã€‚ä¸€æ­¥åˆ°ä½ã€‚</p><h1 id="05ae" class="nb nc it bd nd ne nf ng nh ni nj nk nl jz nm ka nn kc no kd np kf nq kg nr ns bi translated">8 ç”»è¿™æ¡çº¿</h1><p id="7a6e" class="pw-post-body-paragraph ku kv it kw b kx nt ju kz la nu jx lc ld nv lf lg lh nw lj lk ll nx ln lo lp im bi translated">åœ¨æ›´æ–°å‚æ•° 2000 æ¬¡åï¼Œæˆ‘ä»¬åº”è¯¥ç»˜åˆ¶ç»“æœæ¥æŸ¥çœ‹æˆ‘ä»¬çš„æ¨¡å‹çš„æ€§èƒ½ã€‚</p><p id="d94b" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">æˆ‘ä»¬å°†ä¸€äº›æ•°æ®ç‚¹åšä¸º x1ï¼Œæ ¹æ®æˆ‘ä»¬æ‰€å­¦çš„å‚æ•°è®¡ç®— x2ã€‚</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pv"><img src="../Images/e520e2e547555aba419cf39cfaa30146.png" data-original-src="https://miro.medium.com/v2/resize:fit:648/format:webp/1*-6sHwqo2sVVvDRSwUTLgaQ.png"/></div></figure><pre class="kj kk kl km gt ny mm nz oa aw ob bi"><span id="4771" class="oc nc it mm b gy od oe l of og"># plot line<br/>x1 = np.linspace(-2, 2, 100)<br/><strong class="mm iu">x2 = - (theta[0] + x1 * theta[1] + theta[3] * x1**2) / theta[2]</strong></span><span id="de5a" class="oc nc it mm b gy oh oe l of og">plt.plot(std_x[train_y == 1, 0], std_x[train_y == 1, 1], 'o') # train data of class 1<br/>plt.plot(std_x[train_y == 0, 0], std_x[train_y == 0, 1], 'x') # train data of class 0<br/><strong class="mm iu">plt.plot(x1, x2, linestyle='dashed') # plot the line we learned<br/></strong>plt.show()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pw"><img src="../Images/ad808ef85ce8daef4628a584fb6490a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1110/format:webp/1*79l7lRTc3HE59otGsds9sA.png"/></div></figure><h1 id="3ca9" class="nb nc it bd nd ne nf ng nh ni nj nk nl jz nm ka nn kc no kd np kf nq kg nr ns bi translated">9 å‡†ç¡®æ€§</h1><p id="8649" class="pw-post-body-paragraph ku kv it kw b kx nt ju kz la nu jx lc ld nv lf lg lh nw lj lk ll nx ln lo lp im bi translated">åœ¨ç¬¬ 2 éƒ¨åˆ†ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨å‡†ç¡®æ€§æ¥è¯„ä¼°æˆ‘ä»¬çš„æ¨¡å‹æ€§èƒ½å¦‚ä½•ã€‚</p><pre class="kj kk kl km gt ny mm nz oa aw ob bi"><span id="0c2c" class="oc nc it mm b gy od oe l of og">import numpy as np<br/>import matplotlib.pyplot as plt</span><span id="2ac3" class="oc nc it mm b gy oh oe l of og"># read data<br/>data = np.loadtxt("linear_data.csv", delimiter=',', skiprows=1)<br/>train_x = data[:, 0:2]<br/>train_y = data[:, 2]</span><span id="e506" class="oc nc it mm b gy oh oe l of og"># initialize parameter<br/>theta = np.random.randn(4)</span><span id="8a50" class="oc nc it mm b gy oh oe l of og"># standardization<br/>mu = train_x.mean(axis=0)<br/>sigma = train_x.std(axis=0)<br/>def standardizer(x):<br/>    return (x - mu) / sigma<br/>std_x = standardizer(train_x)</span><span id="c2b9" class="oc nc it mm b gy oh oe l of og"># add x0 and x1^2 to get matrix<br/>def to_matrix(x):<br/>    x0 = np.ones([x.shape[0], 1]) <br/>    x3 = x[:, 0, np.newaxis] ** 2<br/>    return np.hstack([x0, x, x3])<br/>mat_x = to_matrix(std_x)</span><span id="1287" class="oc nc it mm b gy oh oe l of og"># sigmoid function<br/>def f(x):<br/>    return 1 / (1 + np.exp(-np.dot(x, theta)))</span><span id="4724" class="oc nc it mm b gy oh oe l of og"><strong class="mm iu"># classify sample to 0 or 1<br/>def classify(x): <br/>    return (f(x) &gt;= 0.5).astype(np.int)</strong></span><span id="2eb1" class="oc nc it mm b gy oh oe l of og"># update times<br/>epoch = 2000</span><span id="a8b6" class="oc nc it mm b gy oh oe l of og"># learning rate<br/>ETA = 1e-3</span><span id="10d8" class="oc nc it mm b gy oh oe l of og"><strong class="mm iu"># accuracy log<br/>accuracies = []</strong></span><span id="35b0" class="oc nc it mm b gy oh oe l of og"># update parameter<br/>for _ in range(epoch):<strong class="mm iu"><br/></strong>    theta = theta - ETA * np.dot(f(mat_x) - train_y, mat_x)<strong class="mm iu"><br/></strong>    <strong class="mm iu">result = classify(mat_x) == train_y <br/>    accuracy = sum(result) / len(result) <br/>    accuracies.append(accuracy)</strong></span><span id="7453" class="oc nc it mm b gy oh oe l of og"><strong class="mm iu"># plot accuracy line<br/>x = np.arange(len(accuracies))<br/>plt.plot(x, accuracies)<br/>plt.show()</strong></span></pre><ul class=""><li id="a7eb" class="mn mo it kw b kx ky la lb ld mp lh mq ll mr lp os mt mu mv bi translated"><code class="fe mj mk ml mm b">classify(x)</code>:å¦‚æœæ¦‚ç‡å¤§äº 0.5ï¼Œæˆ‘ä»¬è®¤ä¸ºæ˜¯çœŸçš„</li><li id="ffb1" class="mn mo it kw b kx mw la mx ld my lh mz ll na lp os mt mu mv bi translated"><code class="fe mj mk ml mm b">result</code>:åŒ…å«åˆ—è¡¨å½¢å¼çš„é¢„æµ‹ï¼Œ[çœŸï¼Œå‡ï¼Œâ€¦]</li><li id="4dab" class="mn mo it kw b kx mw la mx ld my lh mz ll na lp os mt mu mv bi translated"><code class="fe mj mk ml mm b">accuracy = sum(result) / len(result)</code>:è®¡ç®—å½“å‰å†å…ƒä¸­é¢„æµ‹çš„æ­£ç¡®æ ·æœ¬æ•°ã€‚</li></ul><p id="e92a" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">æœ€åï¼Œæˆ‘ä»¬ç»˜åˆ¶äº†ç²¾åº¦çº¿ã€‚</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi px"><img src="../Images/30b99968cfabb804ac95fff22487d0b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1172/format:webp/1*hOeQ3N-MoSvMYwWJ24VPyw.png"/></div></figure><p id="4cd9" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">æˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¿™æ¡çº¿åœ¨ 1000 ä¸ªå‘¨æœŸåå˜å¾—ç¨³å®šã€‚</p><h1 id="d646" class="nb nc it bd nd ne nf ng nh ni nj nk nl jz nm ka nn kc no kd np kf nq kg nr ns bi translated">10 æ‘˜è¦</h1><p id="2346" class="pw-post-body-paragraph ku kv it kw b kx nt ju kz la nu jx lc ld nv lf lg lh nw lj lk ll nx ln lo lp im bi translated">å¦‚æœä½ å·²ç»çœ‹è¿‡ç¬¬ 1 éƒ¨åˆ†ï¼Œä½ ä¼šå‘ç°ç¬¬ 2 éƒ¨åˆ†å¾ˆå®¹æ˜“ç†è§£ã€‚ä½ å¯ä»¥åœ¨ä¸‹é¢æ‰¾åˆ°å®Œæ•´çš„ä»£ç ã€‚ç•™ä¸‹è¯„è®ºè®©æˆ‘çŸ¥é“æˆ‘çš„æ–‡ç« æ˜¯å¦æ˜“æ‡‚ã€‚è¯·ç»§ç»­å…³æ³¨æˆ‘çš„ä¸‹ä¸€ç¯‡å…³äºéšæœºæ¢¯åº¦ä¸‹é™çš„æ–‡ç« ã€‚</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="py pz l"/></div></figure><blockquote class="oy oz pa"><p id="1b3f" class="ku kv oq kw b kx ky ju kz la lb jx lc pb le lf lg pc li lj lk pd lm ln lo lp im bi translated"><strong class="kw iu"> <em class="it">æŸ¥çœ‹æˆ‘çš„å…¶ä»–å¸–å­</em> </strong> <a class="ae lq" href="https://medium.com/@bramblexu" rel="noopener"> <strong class="kw iu"> <em class="it">ä¸­</em> </strong> </a> <strong class="kw iu"> <em class="it">åŒ</em> </strong> <a class="ae lq" href="https://bramblexu.com/posts/eb7bd472/" rel="noopener ugc nofollow" target="_blank"> <strong class="kw iu"> <em class="it">ä¸€ä¸ªåˆ†ç±»æŸ¥çœ‹</em> </strong> </a> <strong class="kw iu"> <em class="it">ï¼<br/>GitHub:</em></strong><a class="ae lq" href="https://github.com/BrambleXu" rel="noopener ugc nofollow" target="_blank"><strong class="kw iu"><em class="it">bramble Xu</em></strong></a><strong class="kw iu"><em class="it"><br/>LinkedIn:</em></strong><a class="ae lq" href="https://www.linkedin.com/in/xu-liang-99356891/" rel="noopener ugc nofollow" target="_blank"><strong class="kw iu"><em class="it">å¾äº®</em> </strong> </a> <strong class="kw iu"> <em class="it"> <br/>åšå®¢:</em></strong><a class="ae lq" href="https://bramblexu.com" rel="noopener ugc nofollow" target="_blank"><strong class="kw iu"><em class="it">bramble Xu</em></strong></a></p></blockquote></div></div>    
</body>
</html>