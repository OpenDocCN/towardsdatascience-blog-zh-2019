<html>
<head>
<title>Predicting the Price of the Beyond Meat Stock Using Random Forest in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用 Python 中的随机森林预测肉类库存价格</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/predicting-the-price-of-the-beyond-meat-stock-using-random-forest-in-python-ebeae6aa9d49?source=collection_archive---------18-----------------------#2019-11-03">https://towardsdatascience.com/predicting-the-price-of-the-beyond-meat-stock-using-random-forest-in-python-ebeae6aa9d49?source=collection_archive---------18-----------------------#2019-11-03</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/3b1a74e52373ca0c8703ece0037b85f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oadNe9xDCXnkMheYvfNQBw.jpeg"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk">Photo by <a class="ae kf" href="https://www.pexels.com/@pixabay" rel="noopener ugc nofollow" target="_blank">Pixabay</a> on <a class="ae kf" href="https://www.pexels.com/photo/stock-exchange-board-210607/" rel="noopener ugc nofollow" target="_blank">Pexels</a></figcaption></figure><p id="9423" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在本帖中，我们将使用随机森林来预测 Beyond Meat 股票的价格。Beyond Meat 是一家植物性肉类替代品生产商，由伊森·布朗于 2009 年在洛杉矶创立。</p><p id="bfa3" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们可以做的第一件事是导入必要的库。我们将使用 yahoo finance API、seaborn、matplotlib、pandas、numpy 和 sklearn:</p><pre class="le lf lg lh gt li lj lk ll aw lm bi"><span id="6a33" class="ln lo it lj b gy lp lq l lr ls">import yfinance as yf<br/>import seaborn as sns<br/>import numpy as np<br/>import pandas as pd <br/>from sklearn.ensemble import RandomForestRegressor<br/>from sklearn.model_selection import train_test_split<br/>import matplotlib.pyplot as plt</span></pre><p id="b379" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果您没有安装用于 yahoo finance API 的 python 包装器，您可以在命令行中键入以下内容:</p><pre class="le lf lg lh gt li lj lk ll aw lm bi"><span id="a999" class="ln lo it lj b gy lp lq l lr ls">pip install yfinance</span></pre><p id="4e41" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们可以从 Yahoo finance 获取过去五个月的“BYND”股票数据，并打印前五行。我们将拉取 2019 年 5 月 5 日至 2019 年 11 月 2 日的数据:</p><pre class="le lf lg lh gt li lj lk ll aw lm bi"><span id="c170" class="ln lo it lj b gy lp lq l lr ls">data = yf.Ticker('BYND')<br/>df = data.history(period="max",  start="2019-05-01", end="2019-11-02")<br/>print(df.head())</span></pre><figure class="le lf lg lh gt ju gh gi paragraph-image"><div class="gh gi lt"><img src="../Images/bf30c44a38b6e198b7d0545f31c34157.png" data-original-src="https://miro.medium.com/v2/resize:fit:1070/format:webp/1*jczbpCoJvQNL9mIRRiI1jA.png"/></div></figure><p id="8f86" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们可以使用 seaborn 来绘制开盘价。我们还使用 matpltlib 来修改 seaborn 图。为了绘制时间序列，我们需要将日期字符串转换为日期时间对象:</p><pre class="le lf lg lh gt li lj lk ll aw lm bi"><span id="63c4" class="ln lo it lj b gy lp lq l lr ls">sns.set()<br/>df[‘timestamp’] = df.index<br/>df[‘timestamp’] = pd.to_datetime(df[‘timestamp’])<br/>sns.lineplot(df[‘timestamp’], df['Open'])<br/>plt.ylabel("Open Price")</span></pre><figure class="le lf lg lh gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi lu"><img src="../Images/e4cbb106b40ef8bcc0d93603aa46f13b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lsTxOLkNKgIm25r772W-Pg.png"/></div></div></figure><p id="f19b" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">接下来，我们可以使用每日开盘价和收盘价计算每日回报率，并绘制结果图:</p><pre class="le lf lg lh gt li lj lk ll aw lm bi"><span id="3225" class="ln lo it lj b gy lp lq l lr ls">df[‘returns’] = (df[‘Close’]-df[‘Open’])/df[‘Open’]<br/>sns.lineplot(df[‘timestamp’], df['returns'])<br/>plt.ylabel("Returns")</span></pre><figure class="le lf lg lh gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi lv"><img src="../Images/06911ebb800485f573e193b6117508ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Zq4uhn7KfMPHvgPZxOjmfw.png"/></div></div></figure><p id="e86c" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">接下来，我们定义一个变量来指定我们想要预测多远。让我们预测 3 天以后。我们还创建了一个新的预测列，它是向上移动了 3 天的目标变量。这里我们的目标变量是收盘价:</p><pre class="le lf lg lh gt li lj lk ll aw lm bi"><span id="cb55" class="ln lo it lj b gy lp lq l lr ls">forecast_out = 3<br/>df[‘prediction’] = df[[‘Close’]].shift(-forecast_out)<br/>X = np.array(df['Close']).reshape(-1,1)<br/>X = X[:-forecast_out]<br/>y = np.array(df['prediction'])<br/>y = y[:-forecast_out]</span></pre><p id="5392" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">接下来，我们拆分用于训练和测试的数据，定义一个随机森林对象并训练我们的模型:</p><pre class="le lf lg lh gt li lj lk ll aw lm bi"><span id="68e9" class="ln lo it lj b gy lp lq l lr ls">reg = RandomForestRegressor(n_estimators = 300, max_depth =300, random_state = 42)<br/>X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state = 7)<br/>reg.fit(X_train, y_train)<br/>print("Performance (R^2): ", reg.score(X_test, y_test))</span></pre><figure class="le lf lg lh gt ju gh gi paragraph-image"><div class="gh gi lw"><img src="../Images/f01be7c8d0348c072e2c958eb22c1ea0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1108/format:webp/1*vNgQrl83yJUV-e4W0XJo0A.png"/></div></figure><p id="6c74" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们的模型 R = 0.84，还不算太差。感谢阅读，机器学习快乐！这篇文章的代码可以在 GitHub 上找到。</p></div></div>    
</body>
</html>