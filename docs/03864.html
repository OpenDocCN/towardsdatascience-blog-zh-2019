<html>
<head>
<title>A random session at the Roulette table — with Pandas and Altair</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">轮盘赌桌上的随机会议——有熊猫和牛郎星</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/a-random-session-at-the-roulette-table-with-pandas-and-altair-9a147471dac3?source=collection_archive---------13-----------------------#2019-06-18">https://towardsdatascience.com/a-random-session-at-the-roulette-table-with-pandas-and-altair-9a147471dac3?source=collection_archive---------13-----------------------#2019-06-18</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="9830" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">最近我去了一家赌场玩，我很好奇，想知道我赢的几率有多大，在给定预算、标准下注金额和下注策略的情况下，我会在赌场呆多久。</p><p id="5581" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以我决定快速编写一些代码来可视化轮盘赌桌上的随机会话。我在这里编写代码的方式与我在轮盘赌桌上进行游戏的方式完全一样:遵循一个下注策略，在固定的旋转次数下相同的赌注(或者直到我的预算资金用完)。</p><p id="1f12" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">首先，我们从导入所有必需的库开始:</p><pre class="kl km kn ko gt kp kq kr ks aw kt bi"><span id="cde8" class="ku kv iq kq b gy kw kx l ky kz"><strong class="kq ir"># Import libraries</strong></span><span id="4869" class="ku kv iq kq b gy la kx l ky kz">import random<br/>import pandas as pd<br/>import altair as alt<br/>from vega_datasets import data</span></pre><p id="8201" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这里我们导入了随机包，我们需要它来模拟轮盘赌桌上的随机旋转，pandas 包将我们的结果输出到可读的数据帧中，Altair 包用于快速可视化我们的结果。</p><p id="2638" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">接下来，我们初始化我们的全局变量:我为这个环节预算的资金数量，每次旋转的赌注数量，以及轮盘赌的旋转次数。</p><p id="f221" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我为这些变量分别设置了 1000、200 和 24。在这里指定这些变量的好处是，你可以很容易地在这里修改它们(而不是在我们后面要写的函数中)。</p><pre class="kl km kn ko gt kp kq kr ks aw kt bi"><span id="285a" class="ku kv iq kq b gy kw kx l ky kz"><strong class="kq ir"># Initialise all the global variables</strong></span><span id="7eb7" class="ku kv iq kq b gy la kx l ky kz">funds = 1000<br/>bet_amount = 200<br/>num_spins = 24</span></pre><p id="2ca9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">接下来，我们将轮盘游戏会话定义为一个函数。这个函数写得有些复杂，包括下注策略支出。不可否认，这不是编写轮盘游戏函数的最佳方式(更好的方式是遵循面向对象的编程，将不同的下注策略作为轮盘游戏<em class="lb">类</em>的独立<em class="lb">对象</em>)，但是让我们将就一下。</p><pre class="kl km kn ko gt kp kq kr ks aw kt bi"><span id="76de" class="ku kv iq kq b gy kw kx l ky kz"><strong class="kq ir"># Function for a random session at the Roulette table</strong></span><span id="445b" class="ku kv iq kq b gy la kx l ky kz">def roulette_game(funds, bet, num_spin):<br/>    print("Starting fund is RM" + str(funds), "Bet for each spin is RM" + str(bet))<br/>    count = 0<br/>    wins = 0<br/>    rolls = []<br/>    balance = []<br/>    <br/>    <strong class="kq ir"># Loop for each Roulette spin</strong><br/>    <br/>    for each in range(num_spin):<br/>        if funds &gt;= bet:<br/>            spin = random.randint(0,36)<br/>            rolls.append(spin)<br/>            <br/><strong class="kq ir">            # Bond Roulette strategy payout<br/>            <br/></strong>            if spin &gt;= 19:<br/>                funds += (0.4 * bet)<br/>                wins +=1<br/>            elif spin &gt;= 13 and spin &lt;= 18:<br/>                funds += (0.5 * bet)<br/>                wins += 1<br/>            elif spin == 0:<br/>                funds += (0.8 * bet)<br/>                wins += 1<br/>            else:<br/>                funds -= bet<br/>                <br/>            balance.append(funds)<br/>            count += 1<br/>        <br/>        else:<br/>            break <strong class="kq ir"># To stop playing when you've run out of funds</strong><br/>    <br/>    win_percentage = wins/count<br/>    print("Rolled " + str(count) + " times, won " + str(wins) + " times! Win percentage is " + str("{:.2%}".format(win_percentage)) + ". Funds remaining = RM" + str(funds))<br/>    return rolls, balance</span></pre><p id="e354" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">简单介绍一下我使用的下注策略:债券轮盘策略是一种涵盖轮盘上 37 个号码中的 25 个号码(胜率为 67.5%)的策略，如下所示:</p><figure class="kl km kn ko gt ld gh gi paragraph-image"><div class="gh gi lc"><img src="../Images/568662e01a3460f028de3b7a37217b73.png" data-original-src="https://miro.medium.com/v2/resize:fit:1234/format:webp/0*ShLh4SsBi_an3SOO.png"/></div><figcaption class="lg lh gj gh gi li lj bd b be z dk">Credit for image to <a class="ae lk" href="https://www.casinoreviews.co.uk/roulette/strategy/" rel="noopener ugc nofollow" target="_blank">https://www.casinoreviews.co.uk/roulette/strategy/</a>.</figcaption></figure><p id="17f9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果球落在数字 13 到 18 上，利润是下注金额的 50%，在这种情况下是 100 令吉。如果落在数字 19 到 36，利润是 40%或 80 令吉。如果落在数字 0 上，利润是 80%或 160 令吉。如果它落在数字 1 到 12 上，我们就输掉全部赌注，在这种情况下是 200 令吉。</p><p id="11b9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然而，像所有轮盘赌策略一样，债券轮盘赌策略无法克服众议院优势，在这种情况下是 2.70%。其他带有附加 00 数字的轮盘赌台的牌局优势甚至更高，为 5.26%。</p><p id="20cd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">因此，预计随着房子的边缘，任何球员将最终耗尽他或她的资金后，一个漫长的游戏。但是大多数玩家不会在赌场停留太长时间。</p><p id="e075" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这里，我们将进行一次测试，总共包括 24 次轮盘旋转(假设每次旋转花费 5 分钟，则相当于 2 小时)。</p><pre class="kl km kn ko gt kp kq kr ks aw kt bi"><span id="66cb" class="ku kv iq kq b gy kw kx l ky kz"><strong class="kq ir"># Conduct a test session</strong></span><span id="a9e4" class="ku kv iq kq b gy la kx l ky kz">test1_rolls, test1_balance = roulette_game(funds, bet_amount, num_spins)<br/>df_test1 = pd.DataFrame({‘Roll’:np.arange(1,len(test1_rolls)+1), ‘Result’:test1_rolls, ‘Fund Balance’:test1_balance})</span><span id="73d1" class="ku kv iq kq b gy la kx l ky kz">print(df_test1)</span></pre><p id="ef2f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">从下面的代码输出来看，这个测试会话似乎并不好:</p><figure class="kl km kn ko gt ld gh gi paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="gh gi ll"><img src="../Images/77375d90e2180fccb2a0723115e2f6da.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_vuecQEtvWuBJiYqbT4mzQ.png"/></div></div><figcaption class="lg lh gj gh gi li lj bd b be z dk">Not so lucky this time, lasted only 12 rolls before I ran out of funds!</figcaption></figure><p id="10b9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这在图表上看起来怎么样？这里我使用了 Altair，这是我最近发现并喜欢的 Python 可视化工具，因为它易于使用。我只需要几行代码就可以生成如下两个不同的图表:</p><pre class="kl km kn ko gt kp kq kr ks aw kt bi"><span id="aefd" class="ku kv iq kq b gy kw kx l ky kz"><strong class="kq ir"># Visualise one random session at the Roulette table</strong></span><span id="7396" class="ku kv iq kq b gy la kx l ky kz">alt.Chart(df_test1).mark_line().encode(<br/> y=’Fund Balance’,<br/> x=’Roll'<br/>)</span></pre><figure class="kl km kn ko gt ld gh gi paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="gh gi lq"><img src="../Images/45d2c09e50b78e727c94cf4d846a20c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zz7JLlN9nVyEVHRl1d-yMA.png"/></div></div><figcaption class="lg lh gj gh gi li lj bd b be z dk">This chart shows that I got into a losing streak. Like a stock market crash.</figcaption></figure><pre class="kl km kn ko gt kp kq kr ks aw kt bi"><span id="9894" class="ku kv iq kq b gy kw kx l ky kz"><strong class="kq ir"># Count frequency of numbers during the Roulette session</strong></span><span id="a92e" class="ku kv iq kq b gy la kx l ky kz">alt.Chart(df_test1).mark_bar().encode(<br/> x=’Result:O’,<br/> y=’count()’<br/>)</span></pre><figure class="kl km kn ko gt ld gh gi paragraph-image"><div class="gh gi lr"><img src="../Images/a204db471e5301d0b95b3e08c4e52137.png" data-original-src="https://miro.medium.com/v2/resize:fit:1040/format:webp/1*ZhDBCTWc1kb8GDp_OaZnSA.png"/></div><figcaption class="lg lh gj gh gi li lj bd b be z dk">It looks like I hit number 1 three times unlucky.</figcaption></figure><p id="ca34" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">总之，这是一个在轮盘赌桌上可视化随机游戏过程的快速尝试。我最初很想报道游戏的蒙特卡洛模拟，但我认为在牌桌上想象一个单独的随机游戏会更有趣！</p></div></div>    
</body>
</html>