<html>
<head>
<title>Model Tuning &amp; Feature Engineering using XGBoost</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用 XGBoost 进行模型调整和特征工程</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/model-tuning-feature-engineering-using-xgboost-ef819bccc82e?source=collection_archive---------18-----------------------#2019-07-30">https://towardsdatascience.com/model-tuning-feature-engineering-using-xgboost-ef819bccc82e?source=collection_archive---------18-----------------------#2019-07-30</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/2052f7e5bc6fcbcdcd804de562a4737b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7iP6iO8OyQ0zC-5S6hqezw.jpeg"/></div></div></figure><p id="2e0d" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在这篇文章中，我将讨论数据预处理技术，这是我之前为初学者发布的系列文章<a class="ae kz" href="https://medium.com/themlblog" rel="noopener"> Tensorflow </a>的延伸。</p><p id="a71e" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">构建人工智能或机器学习模型的第一步是预处理数据，以确保模型的正确表示。这个阶段是最关键的部分，最终决定了模型的健壮性和生产力。一个机器学习模型作为一个行业级应用的产品发布时，必须灌输一些核心功能:</p><ol class=""><li id="1c88" class="la lb it kd b ke kf ki kj km lc kq ld ku le ky lf lg lh li bi translated">概括:模型应该能够跨应用程序对有噪声的数据执行优化和准确的操作，即输入数据的变化仍然应该产生有效的输出。</li><li id="8b9a" class="la lb it kd b ke lj ki lk km ll kq lm ku ln ky lf lg lh li bi translated">正则化:在给定有偏数据的情况下，模型应该产生准确的输出，即行业级应用中的数据仓库在简单训练的基础上产生不稳定的模型，因为数据分布混乱，要么欠拟合，要么过拟合。</li><li id="1cb4" class="la lb it kd b ke lj ki lk km ll kq lm ku ln ky lf lg lh li bi translated">可再现性:模型在两个不同的时间阶段或应用中对相同的输入产生相同的输出。</li></ol><p id="be6d" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在本文中，我们将介绍两个预处理任务，即超参数优化和特征工程，这是两个最重要的模型调整方法，可以提高模型的性能，使其符合行业标准。</p><p id="8054" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">本文中使用的 python 库称为 XGBoost，是一个跨 Kaggle、Topcoder 和 Tunedit 等平台的常用渐变增强库。使用 XGBoost 的优势来自于这样一个事实，即该库通过创建弱分类器树来实现调整模型的正则化方法。(它与 scikit-learn 和 Tensorflow 兼容，这是目前使用最广泛的两个机器学习库。)</p><p id="ad3b" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">本文中使用的数据集是由 10 个参数组成的<a class="ae kz" href="https://www.kaggle.com/uciml/pima-indians-diabetes-database" rel="noopener ugc nofollow" target="_blank"> pima-indian-diabetes </a>数据集。我们从导入必要的库开始</p><figure class="lo lp lq lr gt ju"><div class="bz fp l di"><div class="ls lt l"/></div></figure><p id="cc09" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">下一步是导入数据集并准备我们的训练和测试样本。此外，我们还创建了两个新变量，称为<em class="lu">变量 _ 参数和静态 _ 参数，</em>，它们将分别存储要调整的参数和保持不变的参数。</p><figure class="lo lp lq lr gt ju"><div class="bz fp l di"><div class="ls lt l"/></div></figure><p id="4af8" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">下一步是将这两个变量传递到我们的网格搜索函数中，并使模型符合我们的数据。</p><figure class="lo lp lq lr gt ju"><div class="bz fp l di"><div class="ls lt l"/></div></figure><p id="83b9" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这种简单的实现可以扩展到更大的应用程序。fit()方法。</p><p id="b7a9" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我们将使用的下一种方法叫做特征工程或分析。本文不包括自动化特征工程工具，如 FeatureTools 等。而是简单地使用 XGBoost 深入分析数据集特性的意义和重要性。</p><p id="468d" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我们使用相同的数据集，但这次我们创建了一个名为<em class="lu"> dtrain </em>的变量，它的类型为“xgboost.core.DMatrix ”,这是 xgboost 培训中使用的多维矩阵表示。</p><figure class="lo lp lq lr gt ju"><div class="bz fp l di"><div class="ls lt l"/></div></figure><p id="8650" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">XGBoost 有一个非常好的属性叫做。get_dump()，它提供了关于创建的每棵树的详细信息，以及树在某个参数上的划分方式。我们使用这个属性来标出所有参数的重要性，并对它们进行比较。记得在你的工作目录<em class="lu">中创建一个名为<em class="lu"> featmap.txt </em>的空文本文件。</em></p><figure class="lo lp lq lr gt ju"><div class="bz fp l di"><div class="ls lt l"/></div></figure><figure class="lo lp lq lr gt ju gh gi paragraph-image"><div class="gh gi lv"><img src="../Images/efc7cfd2cc2d01a803d88111660a8795.png" data-original-src="https://miro.medium.com/v2/resize:fit:1186/format:webp/1*Up5Z4EzuJhEHXue69cFpfA.png"/></div></figure><p id="b8a0" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我们获得的图显示了参数-葡萄糖浓度的显著高值，这使其成为最重要的特征，因此可以进一步研究。</p><p id="d310" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">本文末尾提供了完整的代码。点击横幅！</p><p id="18bc" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">要更深入地了解超参数调优是如何工作的，以及如何利用 sklearn 之外的库，请查看 neptune.ai 博客提供的这篇文章<a class="ae kz" href="https://neptune.ai/blog/hyperparameter-tuning-in-python-a-complete-guide-2020" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="13b3" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">本文到此为止。在下一篇文章中，我将讨论数据可视化以及如何创建专业报告。干杯！</p><figure class="lo lp lq lr gt ju gh gi paragraph-image"><a href="https://github.com/Tathagatd96"><div class="gh gi lw"><img src="../Images/2a304781babce34229af80ecfaa27a9c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Q4FJCWGUWXZ0diuAWQs0nw.jpeg"/></div></a></figure><figure class="lo lp lq lr gt ju gh gi paragraph-image"><a href="https://github.com/Tathagatd96/Model-Tuning-Feature-Engineering-using-XGBoost"><div class="gh gi lw"><img src="../Images/d6b3d0b84035d4c58da80e8afc84e248.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Mgy9sCJ2df9ol_YIaBksQw.jpeg"/></div></a></figure></div></div>    
</body>
</html>