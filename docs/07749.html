<html>
<head>
<title>How I used Python and R to analyze and predict Medical Appointment show ups!</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我是如何使用 Python 和 R 来分析和预测医疗预约的！</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-i-used-python-and-r-to-analyze-and-predict-medical-appointment-show-ups-cd290cd3fad0?source=collection_archive---------12-----------------------#2019-10-27">https://towardsdatascience.com/how-i-used-python-and-r-to-analyze-and-predict-medical-appointment-show-ups-cd290cd3fad0?source=collection_archive---------12-----------------------#2019-10-27</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="e13a" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">一个 R 和 Python 共存的世界</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/6f5b2ba084639a7b5e2bed91095df4e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*sb9Yzy3YsjaTkkEB"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Photo by <a class="ae ky" href="https://unsplash.com/@new_data_services?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">NEW DATA SERVICES</a> on <a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="1945" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在过去的几年里，我已经熟悉了 Python，我真的很欣赏我可以用它来做的数据科学过程的广度。我发现 Python 使用起来非常简单，而且有了今天可用的许多库，我几乎可以做任何事情，从 web 抓取到开发深度学习模型。我从 Python 开始，因为我认识的每个人都在使用它，他们说这是正确的选择。</p><p id="48b2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然而，我最近开始使用 R，因为我的一个项目需要使用<code class="fe lv lw lx ly b">ggplot</code>和<code class="fe lv lw lx ly b">leaflet</code>来开发交互式可视化。我的方法很简单——实用而非理论。所以，我开始学习一门关于 R 的课程，我真的很想理解 R 是什么，并且开始摆弄那个项目已经存在的代码。我喜欢它！我们也可以用 R 做很多事情，它对于统计来说非常有用，因为它非常简单，而且它有各种各样的内置函数。</p><p id="2329" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">所以，我开始思考，如果我能同时使用 Python 和 R 来创建可行的解决方案会怎么样。在本文中，我将首先讨论 R 和 Python，以及这些天的趋势如何，然后我如何使用这两种语言来预测人们是否会去赴约，准确率为 88%。在完成自己的代码后，我还参考了一些在线 Kaggle 内核，发现了一些非常有用的见解。</p><p id="6715" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面提供了该存储库:</p><div class="lz ma gp gr mb mc"><a href="https://github.com/kb22/Medical-Appointment-No-Show-Prediction" rel="noopener  ugc nofollow" target="_blank"><div class="md ab fo"><div class="me ab mf cl cj mg"><h2 class="bd iu gy z fp mh fr fs mi fu fw is bi translated">kb22/医疗预约失约预测</h2><div class="mj l"><h3 class="bd b gy z fp mh fr fs mi fu fw dk translated">此时您不能执行该操作。您已使用另一个标签页或窗口登录。您已在另一个选项卡中注销，或者…</h3></div><div class="mk l"><p class="bd b dl z fp mh fr fs mi fu fw dk translated">github.com</p></div></div></div></a></div><p id="9626" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你想在 R 上一门课，这是我正在上的一门课。您可以使用以下链接获得特别折扣:</p><div class="lz ma gp gr mb mc"><a href="http://bit.ly/2mqwHMe" rel="noopener  ugc nofollow" target="_blank"><div class="md ab fo"><div class="me ab mf cl cj mg"><h2 class="bd iu gy z fp mh fr fs mi fu fw is bi translated">用 R 编程教程学习 R 的基础知识</h2><div class="mj l"><h3 class="bd b gy z fp mh fr fs mi fu fw dk translated">通过我们的 R 编程教程学习 R 语言基础。r 编程语言允许开发人员使用…</h3></div><div class="mk l"><p class="bd b dl z fp mh fr fs mi fu fw dk translated">bit.ly</p></div></div><div class="ml l"><div class="mm l mn mo mp ml mq ks mc"/></div></div></a></div><p id="345a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当我开始学习 Python 时，我开始学习 Python 的以下课程(Udemy 通常也会对该课程打折):</p><div class="lz ma gp gr mb mc"><a href="https://www.udemy.com/course/complete-python-bootcamp/" rel="noopener  ugc nofollow" target="_blank"><div class="md ab fo"><div class="me ab mf cl cj mg"><h2 class="bd iu gy z fp mh fr fs mi fu fw is bi translated">完整的 Python 训练营:学习 Python 编程和代码</h2><div class="mj l"><h3 class="bd b gy z fp mh fr fs mi fu fw dk translated">这是 Udemy 上最全面、最直接的 Python 编程语言课程！你是否…</h3></div><div class="mk l"><p class="bd b dl z fp mh fr fs mi fu fw dk translated">www.udemy.com</p></div></div><div class="ml l"><div class="mr l mn mo mp ml mq ks mc"/></div></div></a></div><h1 id="bddd" class="ms mt it bd mu mv mw mx my mz na nb nc jz nd ka ne kc nf kd ng kf nh kg ni nj bi translated">R vs Python</h1><p id="a491" class="pw-post-body-paragraph kz la it lb b lc nk ju le lf nl jx lh li nm lk ll lm nn lo lp lq no ls lt lu im bi translated">古老的争论仍在继续，有些人可能更喜欢 R，而有些人可能更喜欢 Python，这完全是你自己的选择。然而，由于我现在同时使用两种语言，我可以更好地告诉大家这两种语言都很棒。</p><p id="d258" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">r 带来了内置的统计函数，在绘制图形方面，它比不上令人惊叹的<code class="fe lv lw lx ly b">ggplot</code>库。Python 有很好的机器和深度学习库，更容易使用。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi np"><img src="../Images/2d22478bf9de65c2f1c0e494fba30a55.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9qfhNruU4eoqHv6RvpPnCg.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Source: <a class="ae ky" href="https://trends.google.com/trends/explore?q=python,R" rel="noopener ugc nofollow" target="_blank">Google Trends</a></figcaption></figure><p id="4e21" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">看看 Google Trends 在过去 12 个月里追踪的搜索次数，R 和 Python 在全球范围内都得到了广泛的搜索。根据 TIOBE Index，虽然趋势显示 R 语言的搜索越来越多，但 Python 远远领先于 R 语言，如下图所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nq"><img src="../Images/861f59f7adbdc534e643a530fb561c38.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XMjyBB0UxY6ZheYta166rw.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Source: <a class="ae ky" href="https://www.tiobe.com/tiobe-index/" rel="noopener ugc nofollow" target="_blank">TIOBE Index</a></figcaption></figure><p id="21ae" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这些数字表明，虽然 Python 在今天更受欢迎，但来自 Google 的搜索结果表明，很多搜索结果往往更偏向于 R 而不是 Python。因此，两种语言技能的良好结合不仅能让你为今天的挑战做好准备，还能让你为未来做好准备。</p><p id="d77c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，让我们看看如何使用这两种语言！</p><h1 id="b0e2" class="ms mt it bd mu mv mw mx my mz na nb nc jz nd ka ne kc nf kd ng kf nh kg ni nj bi translated">使用 R 的探索性数据分析</h1><h2 id="b50f" class="nr mt it bd mu ns nt dn my nu nv dp nc li nw nx ne lm ny nz ng lq oa ob ni oc bi translated">导入包</h2><p id="5cfa" class="pw-post-body-paragraph kz la it lb b lc nk ju le lf nl jx lh li nm lk ll lm nn lo lp lq no ls lt lu im bi translated">你可以使用<code class="fe lv lw lx ly b">install.packages()</code>下载 R 中的包，然后使用<code class="fe lv lw lx ly b">library()</code>将它们导入笔记本<code class="fe lv lw lx ly b">.Rmd</code>文件。我使用<code class="fe lv lw lx ly b">ggplot2</code>来处理图形，<code class="fe lv lw lx ly b">gridExtra</code>来处理图形的网格，<code class="fe lv lw lx ly b">lubridate</code>来处理日期。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="od oe l"/></div></figure><h2 id="22fc" class="nr mt it bd mu ns nt dn my nu nv dp nc li nw nx ne lm ny nz ng lq oa ob ni oc bi translated">导入数据集</h2><p id="abfb" class="pw-post-body-paragraph kz la it lb b lc nk ju le lf nl jx lh li nm lk ll lm nn lo lp lq no ls lt lu im bi translated">我从<a class="ae ky" href="https://www.kaggle.com/joniarroba/noshowappointments" rel="noopener ugc nofollow" target="_blank"> Kaggle </a>获取了关于各种医疗预约以及病人是否出现的数据集。它有 13 个特征和 1 个目标变量。功能<code class="fe lv lw lx ly b">read.csv()</code>允许导入数据集。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="od oe l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi of"><img src="../Images/04e6dff74f370a5bc851f407388e9af4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UjyFL1YpA_i6u9gjSR6kYQ.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Dataset (First half)</figcaption></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi of"><img src="../Images/3818fe739f4e6e8525f46f1a8761ba48.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nEoJOXsq689RgNNgyyp7hQ.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Dataset (Second half)</figcaption></figure><h2 id="e02b" class="nr mt it bd mu ns nt dn my nu nv dp nc li nw nx ne lm ny nz ng lq oa ob ni oc bi translated">数据集探索</h2><p id="3a91" class="pw-post-body-paragraph kz la it lb b lc nk ju le lf nl jx lh li nm lk ll lm nn lo lp lq no ls lt lu im bi translated">让我们首先来看看行数和列数以及这些列的名称。函数<code class="fe lv lw lx ly b">nrow()</code>返回行数，<code class="fe lv lw lx ly b">ncol()</code>返回列数，<code class="fe lv lw lx ly b">names()</code>返回列名列表。<code class="fe lv lw lx ly b">paste()</code>方法将不同的字符串组合成一个字符串。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="od oe l"/></div></figure><p id="448b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">数据集有 110527 行和 14 列。目标变量是<code class="fe lv lw lx ly b">No.show</code>并且是否定形式，所以我想把它改成可读性更好的形式。当我将<code class="fe lv lw lx ly b">No.show</code>更改为<code class="fe lv lw lx ly b">Showed_up</code>时，我还必须将列值从<code class="fe lv lw lx ly b">No</code>反转为<code class="fe lv lw lx ly b">TRUE</code>并将<code class="fe lv lw lx ly b">Yes</code>反转为<code class="fe lv lw lx ly b">FALSE</code>。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="od oe l"/></div></figure><p id="f635" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们有 13 个特性，让我们进一步探索它们:</p><ol class=""><li id="6102" class="og oh it lb b lc ld lf lg li oi lm oj lq ok lu ol om on oo bi translated">“PatientId”:它是每个患者的唯一标识符，但对任何预测都没有用。</li><li id="db45" class="og oh it lb b lc op lf oq li or lm os lq ot lu ol om on oo bi translated">" AppointmentId:它是每个约会的唯一标识符。</li><li id="f2bc" class="og oh it lb b lc op lf oq li or lm os lq ot lu ol om on oo bi translated">“性别”:这个人是用 F 表示的女性还是用 m 表示的男性。</li><li id="79a5" class="og oh it lb b lc op lf oq li or lm os lq ot lu ol om on oo bi translated">“预定日期”:安排约会的日期。</li><li id="319f" class="og oh it lb b lc op lf oq li or lm os lq ot lu ol om on oo bi translated">“约会日”:约会的当天。</li><li id="3b55" class="og oh it lb b lc op lf oq li or lm os lq ot lu ol om on oo bi translated">“年龄”:人的年龄。</li><li id="0383" class="og oh it lb b lc op lf oq li or lm os lq ot lu ol om on oo bi translated">“邻居”:该人所属的邻居。</li><li id="b41e" class="og oh it lb b lc op lf oq li or lm os lq ot lu ol om on oo bi translated">“奖学金”:这个人是否有奖学金(定义<a class="ae ky" href="https://en.wikipedia.org/wiki/Bolsa_Fam%C3%ADlia" rel="noopener ugc nofollow" target="_blank">维基百科</a>)。</li><li id="8e39" class="og oh it lb b lc op lf oq li or lm os lq ot lu ol om on oo bi translated">“高血压”:人是否有高血压。</li><li id="c86f" class="og oh it lb b lc op lf oq li or lm os lq ot lu ol om on oo bi translated">“糖尿病”:人是否有糖尿病。</li><li id="b406" class="og oh it lb b lc op lf oq li or lm os lq ot lu ol om on oo bi translated">“酒精中毒”:此人是否酗酒。</li><li id="d630" class="og oh it lb b lc op lf oq li or lm os lq ot lu ol om on oo bi translated">“Handcap”:该人是否有身体残疾。</li><li id="bd73" class="og oh it lb b lc op lf oq li or lm os lq ot lu ol om on oo bi translated">“SMS_received”:此人是否收到了关于约会的短信。</li></ol><p id="cd76" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">目标变量是:</p><ol class=""><li id="dca9" class="og oh it lb b lc ld lf lg li oi lm oj lq ok lu ol om on oo bi translated">“Showed_up”:描述此人是否赴约。</li></ol><p id="3a1b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来，让我们看看数据集的摘要。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="od oe l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ou"><img src="../Images/cc638298b238e81c69467d45ce9fac35.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*twYOth6JZGBHS8Q_TXnjjQ.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Dataset summary</figcaption></figure><p id="dd5a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">仔细观察数据集可以发现，像<code class="fe lv lw lx ly b">Alcoholism</code>、<code class="fe lv lw lx ly b">Handcap</code>等特征。它们被认为是连续值，而不是分类变量。这些日期不被认为是日期，<code class="fe lv lw lx ly b">Age</code>的最小值是<code class="fe lv lw lx ly b">-1</code>，这是错误数据，所以我将删除这些行。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="od oe l"/></div></figure><h2 id="f57c" class="nr mt it bd mu ns nt dn my nu nv dp nc li nw nx ne lm ny nz ng lq oa ob ni oc bi translated">形象化</h2><p id="b061" class="pw-post-body-paragraph kz la it lb b lc nk ju le lf nl jx lh li nm lk ll lm nn lo lp lq no ls lt lu im bi translated"><strong class="lb iu">目标阶层</strong> <br/>让我们看看有多少人来赴约，有多少人没来。我将使用<code class="fe lv lw lx ly b">ggplot</code>，它将参数作为数据集，然后是<code class="fe lv lw lx ly b">aes()</code>中的 x 值。<code class="fe lv lw lx ly b">geom_bar()</code>定义我们想要一个条形图，每个条形图的填充颜色为白色，橙色定义为<code class="fe lv lw lx ly b">color</code>橙色，每个条形图的<code class="fe lv lw lx ly b">width</code>定义为<code class="fe lv lw lx ly b">0.4</code>。标题是用<code class="fe lv lw lx ly b">ggtitle()</code>定义的，我用<code class="fe lv lw lx ly b">labs()</code>定义了 x 和 y 轴标签。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="od oe l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ov"><img src="../Images/3eafc114f29c64c9d9816d9c5752a8fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LmXe-r1ajQyetMLVSPJiAg.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Target class distribution</figcaption></figure><p id="5ef4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">与没来的人相比，来赴约的人更多。我们肯定需要努力确保模型不会出现偏差。</p><p id="8fc8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">性别分布<br/> </strong>让我们看看数据集中是否存在男性和女性之间的分布。我将创建一个条形图，并将列值重命名为<code class="fe lv lw lx ly b">F</code>的<code class="fe lv lw lx ly b">Female</code>和<code class="fe lv lw lx ly b">M</code>的<code class="fe lv lw lx ly b">Male</code>。就像上面的条形图一样，我使用了所有的函数，并用<code class="fe lv lw lx ly b">scale_x_discrete</code>重命名了 x 标签。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="od oe l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ow"><img src="../Images/faaaa0b1ce44a5774b0d75825c5db4b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eCLibTe11znj5mTzIBPegw.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Gender distribution</figcaption></figure><p id="8a89" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">与男性相比，有更多的女性安排了约会。</p><p id="1ccb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">二进制类分布</strong> <br/>由于有许多使用<code class="fe lv lw lx ly b">TRUE</code>和<code class="fe lv lw lx ly b">FALSE</code>定义的二进制类，我将根据目标类文件颜色来绘制它们。<code class="fe lv lw lx ly b">aes()</code>函数接受参数<code class="fe lv lw lx ly b">fill</code>，这基本上让我们基于另一个类绘制给定的数据，在我们的例子中，是目标变量。函数<code class="fe lv lw lx ly b">grid.arrange()</code>帮助我们绘制一系列的行列图形。参数<code class="fe lv lw lx ly b">ncol = 2</code>声明基于我想要的绘图数量，我想要 2 列和 2 行。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="od oe l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ox"><img src="../Images/422e7272173b68d337bad79e92c2a94a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*h73aD0YjN615e7wu8a-52g.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Binary class distribution</figcaption></figure><p id="2e27" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">所有图显示，对于任一布尔值，目标类之间的分布几乎是恒定的。数据分布相当均匀。</p><p id="891e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">预约和预约日期的区别<br/> </strong>我注意到，某人预约的时间和实际预约的日期之间的区别可能也很有用。因此，我决定在数据集中创建一个新列<code class="fe lv lw lx ly b">Date.diff</code>,它基本上是两天之间的差异。由于区别在于天数，所以我用<code class="fe lv lw lx ly b">as.numeric(unlist(date.diff))</code>将其解列后转换成数值。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="od oe l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oy"><img src="../Images/f361eb2de948c94e27a41fcc2637f427.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WSbrUgvCxzY9ZybpboAZ1w.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Date diff between schedule and appointment day</figcaption></figure><p id="4b39" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">该图显示，有许多约会与预定日期同一天。让我们移开那个巨大的钉子，看看我们是否能找到除它之外的任何东西。所以，在上面的剧情中，我会加<code class="fe lv lw lx ly b">xlim(1,200)</code>从 1 开始。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="od oe l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oz"><img src="../Images/3373855e8e725c2be6214070b5b0dc4e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KDe9OF6smlXSdYWaXqlLjg.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Date diff between schedule and appointment day (≥ 1 day)</figcaption></figure><p id="ca04" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">请注意，随着天数差异的增加，约会的数量会减少。相差 50 天以上的预约真的少了。似乎没有相关性，因为 50 天之前的计数上升和下降没有任何模式。</p><p id="8973" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">约会时间设置<br/> </strong>约会的时间或月份也可能影响某人是否出现在约会中。所以，让我们创建数据，看看是否有这样的影响。虽然小时数据很有用，但我注意到每个约会的小时信息都是相同的，所以我们不能使用它。让我们只处理月数据。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="od oe l"/></div></figure><p id="3c39" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用<code class="fe lv lw lx ly b">month</code>函数，我能够从<code class="fe lv lw lx ly b">AppointmentDay</code>中检索月份。然后，我用它画了一个柱状图。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pa"><img src="../Images/6f7defaa79ad1eb7986768d6b4312e63.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*J71CUChZIxs0ecPEZJYtIw.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Monthly distribution of appointments</figcaption></figure><p id="eb9a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">四月的约会很少，而五月的约会最多。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="od oe l"/></div></figure><p id="465b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe lv lw lx ly b">prop.table()</code>导致基于边距的对称分布。正如我们从数据中看到的，月份对演出几乎没有影响，因为虚假和真实的比例几乎相同。因此，我们可以删除列本身。</p><p id="067e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以使用<code class="fe lv lw lx ly b">subset()</code>方法检索数据集的子集，然后通过将参数<code class="fe lv lw lx ly b">select</code>定义为<code class="fe lv lw lx ly b">-Month</code>，我们选择除了月份之外的所有内容。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="od oe l"/></div></figure><p id="cc51" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">街区<br/> </strong>当我们放眼望去，也有许多不同的街区。让我们用条形图来研究一下它们。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="od oe l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pb"><img src="../Images/33ed2da9c414452679ba355229a0224e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Nx9_yy2Wq_M9CHRtRRb_sg.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Neighborhoods in the dataset</figcaption></figure><p id="c20f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">邻里数据变化很大。<code class="fe lv lw lx ly b">Jabour</code>有非常多的预约，但有些社区的预约少于 10 次。我们应该保留数据，但我们将在模型训练期间创建虚拟变量来容纳该列中的每个值。</p><p id="08df" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">年龄</strong> <br/>最后，让我们看看年龄变化是如何在数据集中发生的。我们已经移除了数据集中的异常值。我现在将为目标变量中的两个类使用两个相互重叠的散点图。</p><p id="3cf3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我首先选择带有<code class="fe lv lw lx ly b">Showed_up</code>的记录作为<code class="fe lv lw lx ly b">TRUE</code>，然后使用<code class="fe lv lw lx ly b">table</code>和<code class="fe lv lw lx ly b">as.data.frame</code>创建一个名为<code class="fe lv lw lx ly b">age.show</code>的频率表。我同样为<code class="fe lv lw lx ly b">Showed_up</code>创建数据帧<code class="fe lv lw lx ly b">age.no_show</code>为<code class="fe lv lw lx ly b">FALSE</code>。使用两次<code class="fe lv lw lx ly b">geom_point</code>，我创建了两个重叠的散点图。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="od oe l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pc"><img src="../Images/16b59d5eb94d364e488f09d36e39707f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5JBe2PNKB4pW0w_tlyVzZQ.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Age count and showed up status</figcaption></figure><p id="923f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">该图显示，约会的次数随年龄变化很大。最大预约是给婴儿的。在 50 岁左右有一个下降然后一个峰值。最后，随着年龄的增长，预约的人越来越少。因此，年龄也可能对目标变量有影响。</p><p id="1015" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在我们对数据集有了一个相当好的想法，让我们以修改后的形式保存它，然后使用 Python 库进行预测。我将使用<code class="fe lv lw lx ly b">write.csv()</code>将数据集保存到文件<code class="fe lv lw lx ly b">dataset_modified.csv</code>。<code class="fe lv lw lx ly b">row.names</code> as <code class="fe lv lw lx ly b">FALSE</code>确保不保存行索引。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="od oe l"/></div></figure><h1 id="c195" class="ms mt it bd mu mv mw mx my mz na nb nc jz nd ka ne kc nf kd ng kf nh kg ni nj bi translated">使用 Python 进行分类</h1><p id="5010" class="pw-post-body-paragraph kz la it lb b lc nk ju le lf nl jx lh li nm lk ll lm nn lo lp lq no ls lt lu im bi translated">在进行适当的数据工程以进行分类之后，我将开发一个人工神经网络来对给定的数据进行训练。</p><h2 id="e63f" class="nr mt it bd mu ns nt dn my nu nv dp nc li nw nx ne lm ny nz ng lq oa ob ni oc bi translated">导入库</h2><p id="e37e" class="pw-post-body-paragraph kz la it lb b lc nk ju le lf nl jx lh li nm lk ll lm nn lo lp lq no ls lt lu im bi translated">我将导入必要的库，包括用于 csv 的<code class="fe lv lw lx ly b">pandas</code>、用于数据处理的<code class="fe lv lw lx ly b">sklearn</code>和用于创建人工神经网络的<code class="fe lv lw lx ly b">keras</code> &amp; <code class="fe lv lw lx ly b">tensorflow</code>。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="od oe l"/></div></figure><h2 id="b43a" class="nr mt it bd mu ns nt dn my nu nv dp nc li nw nx ne lm ny nz ng lq oa ob ni oc bi translated">导入数据集</h2><p id="b2b9" class="pw-post-body-paragraph kz la it lb b lc nk ju le lf nl jx lh li nm lk ll lm nn lo lp lq no ls lt lu im bi translated">我将使用函数<code class="fe lv lw lx ly b">read_csv()</code>来导入数据集文件<code class="fe lv lw lx ly b">dataset_modified.csv</code>。然后我将使用<code class="fe lv lw lx ly b">head()</code>方法来查看前 5 行。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="od oe l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pd"><img src="../Images/a8b2fc7cf72f5dfe5675e7033c9d364b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tTHakid3Ix3ZdFJZBD2Ngg.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Dataset (Modified) — Part 2</figcaption></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pe"><img src="../Images/d3a999ddf44898b6b8d7e8d037d66c0b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xeJoEPyO4Em2B5uMzYZ_QQ.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Dataset (Modified) — Part 2</figcaption></figure><h1 id="4eca" class="ms mt it bd mu mv mw mx my mz na nb nc jz nd ka ne kc nf kd ng kf nh kg ni nj bi translated">数据工程</h1><p id="d20c" class="pw-post-body-paragraph kz la it lb b lc nk ju le lf nl jx lh li nm lk ll lm nn lo lp lq no ls lt lu im bi translated">在数据集可以实际使用之前，我将执行许多数据工程步骤。</p><p id="69e3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">失约<br/> </strong> Kaggle 总是教会我很多东西。即使在我决定做了这么多步骤之后，我还是发现了另一个非常有用的步骤。受到这个<a class="ae ky" href="https://www.kaggle.com/belagoesr/predicting-no-show-downsampling-approach-with-rf" rel="noopener ugc nofollow" target="_blank"> Kaggle 内核</a>的极大启发，我决定看看如果有人之前在目标上错过了一次约会的效果。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="od oe l"/></div></figure><p id="fec5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">正如我们所见，相关值非常高(~0.61)，因此它将是目标变量分类的一个重要因素。</p><p id="d8a3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">删除多余的列<br/> </strong>，因为列<code class="fe lv lw lx ly b">PatientId</code>、<code class="fe lv lw lx ly b">AppointmentID</code>、<code class="fe lv lw lx ly b">ScheduleDay</code>和<code class="fe lv lw lx ly b">AppointmentDay</code>不会直接影响目标变量，所以我用<code class="fe lv lw lx ly b">drop()</code>删除它们。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="od oe l"/></div></figure><p id="521b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">虚拟列<br/> </strong>我将把列<code class="fe lv lw lx ly b">Neighbourhood</code>转换成一组虚拟列。我将使用<code class="fe lv lw lx ly b">drop()</code>删除原始列，然后使用<code class="fe lv lw lx ly b">get_dummies()</code>创建使用<code class="fe lv lw lx ly b">concat()</code>添加到原始数据集中的列。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="od oe l"/></div></figure><p id="31c0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">映射列<br/> </strong>我们知道<code class="fe lv lw lx ly b">Gender</code>列被分类为<code class="fe lv lw lx ly b">F</code>或<code class="fe lv lw lx ly b">M</code>，我将使用映射函数将它们转换为 ANN 可以理解的数值。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="od oe l"/></div></figure><p id="a434" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">分割测试训练数据<br/> </strong>下一步是分割特征和列，然后使用<code class="fe lv lw lx ly b">train_test_split()</code>创建 33%的测试数据和 67%的训练数据。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="od oe l"/></div></figure><p id="7068" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最终训练数据总共有 91 列。</p><p id="d6ed" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">缩放数据<br/> </strong>神经网络最适合缩放数据，因此，我将使用<code class="fe lv lw lx ly b">StandardScaler()</code>来缩放数据，并将其用于训练神经网络。当使用<code class="fe lv lw lx ly b">X_train</code>时，我们使用<code class="fe lv lw lx ly b">fit_transform</code>,因为它确保它符合那些值并且也转换它。对于<code class="fe lv lw lx ly b">X_test</code>，我们只使用<code class="fe lv lw lx ly b">transform</code>，因为它确保了定标器函数使用来自 X_train 的知识来转换测试数据。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="od oe l"/></div></figure><h2 id="f79e" class="nr mt it bd mu ns nt dn my nu nv dp nc li nw nx ne lm ny nz ng lq oa ob ni oc bi translated">模型生成</h2><p id="de0a" class="pw-post-body-paragraph kz la it lb b lc nk ju le lf nl jx lh li nm lk ll lm nn lo lp lq no ls lt lu im bi translated">数据集已经可以使用了，所以我现在将使用<code class="fe lv lw lx ly b">Sequence()</code>方法创建人工神经网络。我添加四个密集层，分别有 512、1024、2048 和 1 个神经元。我还确保在每一层之后包含<code class="fe lv lw lx ly b">Dropout()</code>,这样神经网络就不会过度适应数据。对于第一个密集层，我们还需要指定<code class="fe lv lw lx ly b">input_dim</code>，它等于我们数据中的列数(91)。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="od oe l"/></div></figure><p id="0bd6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们的网络有 2，673，665 个不同的参数需要训练。</p><p id="95b8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我现在将使用 0.1 的验证分割来训练模型，这意味着从训练数据中的所有数据来看，模型将对 90%的数据进行训练，并对 10%的数据进行学习测试。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="od oe l"/></div></figure><h2 id="f8d4" class="nr mt it bd mu ns nt dn my nu nv dp nc li nw nx ne lm ny nz ng lq oa ob ni oc bi translated">模型预测法</h2><p id="7040" class="pw-post-body-paragraph kz la it lb b lc nk ju le lf nl jx lh li nm lk ll lm nn lo lp lq no ls lt lu im bi translated">我现在将在测试数据上测试模型，并输出混淆矩阵和准确性。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="od oe l"/></div></figure><p id="2d75" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">虽然该模型达到了大约 88%的准确率，但是混淆矩阵表明该模型能够正确地预测某人何时会出现在约会中，但是大约有 50%的人不会出现。</p><p id="696b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以通过探索更多的数据特征和进行数据工程以确定其他因素来进一步改进该模型。但是现在，88%对于这个模型来说已经足够准确了。</p><h1 id="bfbd" class="ms mt it bd mu mv mw mx my mz na nb nc jz nd ka ne kc nf kd ng kf nh kg ni nj bi translated">结论</h1><p id="9d60" class="pw-post-body-paragraph kz la it lb b lc nk ju le lf nl jx lh li nm lk ll lm nn lo lp lq no ls lt lu im bi translated">在本文中，我们使用人工神经网络和使用 R 和 Python 的数据探索来开发涉及两种语言的数据工作流。</p></div><div class="ab cl pf pg hx ph" role="separator"><span class="pi bw bk pj pk pl"/><span class="pi bw bk pj pk pl"/><span class="pi bw bk pj pk"/></div><div class="im in io ip iq"><p id="c50d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你有任何想法或主意，请分享。还有，你可以在<a class="ae ky" href="https://www.linkedin.com/in/bhanotkaran22/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>上和我联系。如果您喜欢这篇文章，您可能也会喜欢:</p><div class="lz ma gp gr mb mc"><a rel="noopener follow" target="_blank" href="/google-colab-your-python-workspace-on-cloud-c3aed424de0d"><div class="md ab fo"><div class="me ab mf cl cj mg"><h2 class="bd iu gy z fp mh fr fs mi fu fw is bi translated">Google Colab——您在云上的 Python 工作空间</h2><div class="mj l"><h3 class="bd b gy z fp mh fr fs mi fu fw dk translated">了解 Google Colab</h3></div><div class="mk l"><p class="bd b dl z fp mh fr fs mi fu fw dk translated">towardsdatascience.com</p></div></div><div class="ml l"><div class="pm l mn mo mp ml mq ks mc"/></div></div></a></div><div class="lz ma gp gr mb mc"><a rel="noopener follow" target="_blank" href="/seaborn-lets-make-plotting-fun-4951b89a0c07"><div class="md ab fo"><div class="me ab mf cl cj mg"><h2 class="bd iu gy z fp mh fr fs mi fu fw is bi translated">seaborn——让绘图变得有趣</h2><div class="mj l"><h3 class="bd b gy z fp mh fr fs mi fu fw dk translated">Python 中的 Seaborn 库简介</h3></div><div class="mk l"><p class="bd b dl z fp mh fr fs mi fu fw dk translated">towardsdatascience.com</p></div></div><div class="ml l"><div class="pn l mn mo mp ml mq ks mc"/></div></div></a></div><div class="lz ma gp gr mb mc"><a rel="noopener follow" target="_blank" href="/learning-artificial-neural-networks-by-predicting-visitor-purchase-intention-724ba2be7c29"><div class="md ab fo"><div class="me ab mf cl cj mg"><h2 class="bd iu gy z fp mh fr fs mi fu fw is bi translated">通过预测游客购买意向学习人工神经网络</h2><div class="mj l"><h3 class="bd b gy z fp mh fr fs mi fu fw dk translated">使用 Keras 和 Tensorflow 构建人工神经网络</h3></div><div class="mk l"><p class="bd b dl z fp mh fr fs mi fu fw dk translated">towardsdatascience.com</p></div></div><div class="ml l"><div class="po l mn mo mp ml mq ks mc"/></div></div></a></div><div class="lz ma gp gr mb mc"><a rel="noopener follow" target="_blank" href="/deep-learning-to-identify-malaria-cells-using-cnn-on-kaggle-b9a987f55ea5"><div class="md ab fo"><div class="me ab mf cl cj mg"><h2 class="bd iu gy z fp mh fr fs mi fu fw is bi translated">在 Kaggle 上使用 CNN 进行深度学习以识别疟疾细胞</h2><div class="mj l"><h3 class="bd b gy z fp mh fr fs mi fu fw dk translated">医学领域的深度学习</h3></div><div class="mk l"><p class="bd b dl z fp mh fr fs mi fu fw dk translated">towardsdatascience.com</p></div></div><div class="ml l"><div class="pp l mn mo mp ml mq ks mc"/></div></div></a></div></div></div>    
</body>
</html>