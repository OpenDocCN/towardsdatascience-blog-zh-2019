<html>
<head>
<title>Analyzing Tweets with NLP in minutes with Spark, Optimus and Twint</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用 Spark、Optimus 和 Twint 在几分钟内使用 NLP 分析推文</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/analyzing-tweets-with-nlp-in-minutes-with-spark-optimus-and-twint-a0c96084995f?source=collection_archive---------4-----------------------#2019-05-05">https://towardsdatascience.com/analyzing-tweets-with-nlp-in-minutes-with-spark-optimus-and-twint-a0c96084995f?source=collection_archive---------4-----------------------#2019-05-05</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="fa4e" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">社交媒体一直是研究人们沟通和行为方式的黄金，在本文中，我将向您展示在没有 Twitter API 的情况下分析推文的最简单方法，并可扩展用于大数据。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/49a8d8cb7dbdc2e7c0e621bf5c8f675b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CvQjrMtgQhRe_MMmT2ITSA.png"/></div></div></figure><h1 id="df34" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">介绍</h1><p id="2295" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">如果你在这里，很可能你对分析推文(或类似的东西)感兴趣，你有很多推文，或者可以得到它们。最烦人的事情之一就是获得一个 Twitter 应用程序，获得认证和所有这些。如果你用的是熊猫，那就没办法衡量了。</p><p id="eb2d" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">那么，一个不需要 Twitter API 认证的系统怎么样，它可以获得无限量(几乎是无限量)的推文和分析它们的能力，以及 NLP 等等。好吧，你一定会喜欢的，因为这正是我现在要给你看的。</p><h1 id="e537" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">获得项目和回购</h1><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mk"><img src="../Images/93a0126514ff835f28ce042d8b84e215.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*-AnYBOBhV8f_KP1S.png"/></div></div><figcaption class="ml mm gj gh gi mn mo bd b be z dk"><a class="ae mp" href="https://matrixds.com/" rel="noopener ugc nofollow" target="_blank">https://matrixds.com/</a></figcaption></figure><p id="b34a" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">你可以很容易地理解我将要向你展示的一切。只是铲车这个 MatrixDS 项目:</p><div class="mq mr gp gr ms mt"><a href="https://community.platform.matrixds.com/community/project/5ccc9c4b3175e0603c394444/files" rel="noopener  ugc nofollow" target="_blank"><div class="mu ab fo"><div class="mv ab mw cl cj mx"><h2 class="bd ir gy z fp my fr fs mz fu fw ip bi translated">MatrixDS |数据项目工作台</h2><div class="na l"><h3 class="bd b gy z fp my fr fs mz fu fw dk translated">MatrixDS 是一个构建、共享和管理任何规模的数据项目的地方。</h3></div><div class="nb l"><p class="bd b dl z fp my fr fs mz fu fw dk translated">community.platform.matrixds.com</p></div></div></div></a></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nc"><img src="../Images/5ff58ee885c08f31aaf68af3028b1a64.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sHngX3dt1b6T_DcEcPhcEw.png"/></div></div></figure><p id="b872" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">还有一个 GitHub repo，里面什么都有:</p><div class="mq mr gp gr ms mt"><a href="https://github.com/FavioVazquez/twitter_optimus_twint" rel="noopener  ugc nofollow" target="_blank"><div class="mu ab fo"><div class="mv ab mw cl cj mx"><h2 class="bd ir gy z fp my fr fs mz fu fw ip bi translated">FavioVazquez/Twitter _ Optimus _ twint</h2><div class="na l"><h3 class="bd b gy z fp my fr fs mz fu fw dk translated">用 Twint，Optimus 和 Apache Spark 分析推文。-FavioVazquez/Twitter _ Optimus _ twint</h3></div><div class="nb l"><p class="bd b dl z fp my fr fs mz fu fw dk translated">github.com</p></div></div><div class="nd l"><div class="ne l nf ng nh nd ni kp mt"/></div></div></a></div><p id="3ea2" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">使用 MatrixDS，您可以免费运行笔记本、获取数据和运行分析，因此如果您想了解更多信息，请这么做。</p><h1 id="0706" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">得到 Twint 和擎天柱</h1><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nj"><img src="../Images/4c0aea6b70379f46d08334b19619175f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*5RGL_vV0FbWVt-S6"/></div></div></figure><p id="8031" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">Twint 利用 Twitter 的搜索运营商让你抓取特定用户的推文，抓取与某些主题、标签和趋势相关的推文，或者从推文中挑选出<em class="nk">敏感的</em>信息，如电子邮件和电话号码。</p><p id="831d" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">通过我共同创建的库 Optimus，你可以清理数据，准备数据，分析数据，创建剖面图和图表，执行机器学习和深度学习，所有这些都以分布式的方式进行，因为在后端我们有 Spark，TensorFlow，Sparkling Water 和 Keras。</p><p id="c4db" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">因此，让我们首先安装您需要的所有东西，因为当您在 Matrix 项目中时，请转到分析 Tweets 笔记本并运行(您也可以从 JupyterLab 终端执行此操作):</p><pre class="kg kh ki kj gt nl nm nn no aw np bi"><span id="3401" class="nq ks iq nm b gy nr ns l nt nu">!pip install --user -r requirements.txt</span></pre><p id="9b0c" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">之后，我们需要安装 Twint，运行:</p><pre class="kg kh ki kj gt nl nm nn no aw np bi"><span id="03cf" class="nq ks iq nm b gy nr ns l nt nu">!pip install --upgrade --user -e git+<a class="ae mp" href="https://github.com/twintproject/twint.git@origin/master#egg=twint" rel="noopener ugc nofollow" target="_blank">https://github.com/twintproject/twint.git@origin/master#egg=twint</a></span></pre><p id="9d4d" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">这将下载一个 scr/文件夹，因此我们需要做一些配置:</p><pre class="kg kh ki kj gt nl nm nn no aw np bi"><span id="3567" class="nq ks iq nm b gy nr ns l nt nu">!mv src/twint .<br/>!rm -r src</span></pre><p id="7909" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">然后导入我们需要运行的 Twint:</p><pre class="kg kh ki kj gt nl nm nn no aw np bi"><span id="4adf" class="nq ks iq nm b gy nr ns l nt nu">%load_ext autoreload<br/>%autoreload 2</span><span id="6685" class="nq ks iq nm b gy nv ns l nt nu">import sys<br/>sys.path.append("twint/")</span></pre><p id="2535" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">最后:</p><pre class="kg kh ki kj gt nl nm nn no aw np bi"><span id="c0bc" class="nq ks iq nm b gy nr ns l nt nu">import twint</span></pre><p id="476e" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">Optimus 是在第一步安装的，所以我们就开始吧(这会为你启动一个 Spark 集群):</p><pre class="kg kh ki kj gt nl nm nn no aw np bi"><span id="8534" class="nq ks iq nm b gy nr ns l nt nu">from optimus import Optimus<br/>op = Optimus()</span></pre><h1 id="ef1c" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">设置 Twint 以删除推文</h1><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nw"><img src="../Images/1c837f0929bd787a32d896268c2ae444.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*9LTS3GDTtgWTjgxa.png"/></div></div><figcaption class="ml mm gj gh gi mn mo bd b be z dk"><a class="ae mp" href="https://www.theverge.com/2015/11/3/9661180/twitter-vine-favorite-fav-likes-hearts" rel="noopener ugc nofollow" target="_blank">https://www.theverge.com/2015/11/3/9661180/twitter-vine-favorite-fav-likes-hearts</a></figcaption></figure><pre class="kg kh ki kj gt nl nm nn no aw np bi"><span id="e488" class="nq ks iq nm b gy nr ns l nt nu"># Set up TWINT config<br/>c = twint.Config()</span></pre><p id="1ab1" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">如果您在笔记本电脑上运行，您还需要运行:</p><pre class="kg kh ki kj gt nl nm nn no aw np bi"><span id="fae4" class="nq ks iq nm b gy nr ns l nt nu"># Solve compatibility issues with notebooks and RunTime errors.<br/>import nest_asyncio<br/>nest_asyncio.apply()</span></pre><h1 id="557c" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">搜索数据科学推文</h1><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nw"><img src="../Images/8a47eb56a9967e79afd22d79a52acdc3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*BrbXH47ev9oVuKcr.jpg"/></div></div></figure><p id="d006" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">我将开始我们的分析，废弃关于数据科学的推文，你可以把它改成你想要的任何东西。</p><p id="87f2" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">为此，我们只需运行以下命令:</p><pre class="kg kh ki kj gt nl nm nn no aw np bi"><span id="cfa0" class="nq ks iq nm b gy nr ns l nt nu">c.Search = "data science"<br/># Custom output format<br/>c.Format = "Username: {username} |  Tweet: {tweet}"<br/>c.Limit = 1<br/>c.Pandas = True</span><span id="7ebd" class="nq ks iq nm b gy nv ns l nt nu">twint.run.Search(c)</span></pre><p id="4ade" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">让我给你解释一下这段代码。在我们运行代码的最后一部分:</p><pre class="kg kh ki kj gt nl nm nn no aw np bi"><span id="e160" class="nq ks iq nm b gy nr ns l nt nu">c = twint.Config()</span></pre><p id="888e" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">我们开始了新的 Twint 配置。之后，我们需要通过不同的选项，我们想刮推文。以下是配置选项的完整列表:</p><pre class="kg kh ki kj gt nl nm nn no aw np bi"><span id="a242" class="nq ks iq nm b gy nr ns l nt nu">Variable             Type       Description<br/>--------------------------------------------<br/>Username             (string) - Twitter user's username<br/>User_id              (string) - Twitter user's user_id<br/>Search               (string) - Search terms<br/>Geo                  (string) - Geo coordinates (lat,lon,km/mi.)<br/>Location             (bool)   - Set to True to attempt to grab a Twitter user's location (slow).<br/>Near                 (string) - Near a certain City (Example: london)<br/>Lang                 (string) - Compatible language codes: https://github.com/twintproject/twint/wiki/Langauge-codes<br/>Output               (string) - Name of the output file.<br/>Elasticsearch        (string) - Elasticsearch instance<br/>Timedelta            (int)    - Time interval for every request (days)<br/>Year                 (string) - Filter Tweets before the specified year.<br/>Since                (string) - Filter Tweets sent since date (Example: 2017-12-27).<br/>Until                (string) - Filter Tweets sent until date (Example: 2017-12-27).<br/>Email                (bool)   - Set to True to show Tweets that _might_ contain emails.<br/>Phone                (bool)   - Set to True to show Tweets that _might_ contain phone numbers.<br/>Verified             (bool)   - Set to True to only show Tweets by _verified_ users<br/>Store_csv            (bool)   - Set to True to write as a csv file.<br/>Store_json           (bool)   - Set to True to write as a json file.<br/>Custom               (dict)   - Custom csv/json formatting (see below).<br/>Show_hashtags        (bool)   - Set to True to show hashtags in the terminal output.<br/>Limit                (int)    - Number of Tweets to pull (Increments of 20).<br/>Count                (bool)   - Count the total number of Tweets fetched.<br/>Stats                (bool)   - Set to True to show Tweet stats in the terminal output.<br/>Database             (string) - Store Tweets in a sqlite3 database. Set this to the DB. (Example: twitter.db)<br/>To                   (string) - Display Tweets tweeted _to_ the specified user.<br/>All                  (string) - Display all Tweets associated with the mentioned user.<br/>Debug                (bool)   - Store information in debug logs.<br/>Format               (string) - Custom terminal output formatting.<br/>Essid                (string) - Elasticsearch session ID.<br/>User_full            (bool)   - Set to True to display full user information. By default, only usernames are shown.<br/>Profile_full         (bool)   - Set to True to use a slow, but effective method to enumerate a user's Timeline.<br/>Store_object         (bool)   - Store tweets/user infos/usernames in JSON objects.<br/>Store_pandas         (bool)   - Save Tweets in a DataFrame (Pandas) file.<br/>Pandas_type          (string) - Specify HDF5 or Pickle (HDF5 as default).<br/>Pandas               (bool)   - Enable Pandas integration.<br/>Index_tweets         (string) - Custom Elasticsearch Index name for Tweets (default: twinttweets).<br/>Index_follow         (string) - Custom Elasticsearch Index name for Follows (default: twintgraph).<br/>Index_users          (string) - Custom Elasticsearch Index name for Users (default: twintuser).<br/>Index_type           (string) - Custom Elasticsearch Document type (default: items).<br/>Retries_count        (int)    - Number of retries of requests (default: 10).<br/>Resume               (int)    - Resume from a specific tweet id (**currently broken, January 11, 2019**).<br/>Images               (bool)   - Display only Tweets with images.<br/>Videos               (bool)   - Display only Tweets with videos.<br/>Media                (bool)   - Display Tweets with only images or videos.<br/>Replies              (bool)   - Display replies to a subject.<br/>Pandas_clean         (bool)   - Automatically clean Pandas dataframe at every scrape.<br/>Lowercase            (bool)   - Automatically convert uppercases in lowercases.<br/>Pandas_au            (bool)   - Automatically update the Pandas dataframe at every scrape.<br/>Proxy_host           (string) - Proxy hostname or IP.<br/>Proxy_port           (int)    - Proxy port.<br/>Proxy_type           (string) - Proxy type.<br/>Tor_control_port     (int) - Tor control port.<br/>Tor_control_password (string) - Tor control password (not hashed).<br/>Retweets             (bool)   - Display replies to a subject.<br/>Hide_output          (bool)   - Hide output.<br/>Get_replies          (bool)   - All replies to the tweet.</span></pre><p id="94af" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">所以在这段代码中:</p><pre class="kg kh ki kj gt nl nm nn no aw np bi"><span id="4d0d" class="nq ks iq nm b gy nr ns l nt nu">c.Search = "data science"<br/># Custom output format<br/>c.Format = "Username: {username} |  Tweet: {tweet}"<br/>c.Limit = 1<br/>c.Pandas = True</span></pre><p id="1879" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">我们设置搜索词，然后格式化响应(只是为了检查)，只获得 20 条 tweets，限制=1(它们以 20 为增量)，最后使结果与 Pandas 兼容。</p><p id="7ef3" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">然后当我们跑的时候:</p><pre class="kg kh ki kj gt nl nm nn no aw np bi"><span id="f570" class="nq ks iq nm b gy nr ns l nt nu">twint.run.Search(c)</span></pre><p id="f5ee" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">我们正在展开搜索。结果是:</p><pre class="kg kh ki kj gt nl nm nn no aw np bi"><span id="0adf" class="nq ks iq nm b gy nr ns l nt nu">Username: tmj_phl_pharm |  Tweet: If you're looking for work in Spring House, PA, check out this Biotech/Clinical/R&amp;D/Science job via the link in our bio: KellyOCG Exclusive: Data Access Analyst in Spring House, PA- Direct Hire at Kelly Services #KellyJobs #KellyServices<br/>Username: DataSci_Plow |  Tweet: Bring your Jupyter Notebook to life with interactive widgets  https://www.plow.io/post/bring-your-jupyter-notebook-to-life-with-interactive-widgets?utm_source=Twitter&amp;utm_campaign=Data_science … +1 Hal2000Bot #data #science<br/>Username: ottofwagner |  Tweet: Top 7 R Packages for Data Science and AI   https://noeliagorod.com/2019/03/07/top-7-r-packages-for-data-science-and-ai/ … #DataScience #rstats #MachineLearning<br/>Username: semigoose1 |  Tweet: ëäSujy #crypto #bitcoin #java #competition #influencer #datascience #fintech #science #EU  https://vk.com/id15800296  https://semigreeth.wordpress.com/2019/05/03/easujy-crypto-bitcoin-java-competition-influencer-datascience-fintech-science-eu- https-vk-com-id15800296/ …<br/>Username: Datascience__ |  Tweet: Introduction to Data Analytics for Business  http://zpy.io/c736cf9f  #datascience #ad<br/>Username: Datascience__ |  Tweet: How Entrepreneurs in Emerging Markets can master the Blockchain Technology  http://zpy.io/f5fad501  #datascience #ad<br/>Username: viktor_spas |  Tweet: [Перевод] Почему Data Science командам нужны универсалы, а не специалисты  https://habr.com/ru/post/450420/?utm_source=dlvr.it&amp;utm_medium=twitter&amp;utm_campaign=450420 … pic.twitter.com/i98frTwPSE<br/>Username: gp_pulipaka |  Tweet: Orchestra is a #RPA for Orchestrating Project Teams. #BigData #Analytics #DataScience #AI #MachineLearning #Robotics #IoT #IIoT #PyTorch #Python #RStats #TensorFlow #JavaScript #ReactJS #GoLang #CloudComputing #Serverless #DataScientist #Linux @lruettimann  http://bit.ly/2Hn6qYd  pic.twitter.com/kXizChP59U<br/>Username: amruthasuri |  Tweet: "Here's a typical example of a day in the life of a RagingFX trader. Yesterday I received these two signals at 10am EST. Here's what I did... My other activities have kept me so busy that ...  http://bit.ly/2Jm9WT1  #Learning #DataScience #bigdata #Fintech pic.twitter.com/Jbes6ro1lY<br/>Username: PapersTrending |  Tweet: [1/10] Real numbers, data science and chaos: How to fit any dataset with a single parameter - 192 stars - pdf:  https://arxiv.org/pdf/1904.12320v1.pdf … - github: https://github.com/Ranlot/single-parameter-fit …<br/>Username: webAnalyste |  Tweet: Building Data Science Capabilities Means Playing the Long Game  http://dlvr.it/R41k3t  pic.twitter.com/Et5CskR2h4<br/>Username: DataSci_Plow |  Tweet: Building Data Science Capabilities Means Playing the Long Game  https://www.plow.io/post/building-data-science-capabilities-means-playing-the-long-game?utm_source=Twitter&amp;utm_campaign=Data_science … +1 Hal2000Bot #data #science<br/>Username: webAnalyste |  Tweet: Towards Well Being, with Data Science (part 2)  http://dlvr.it/R41k1K  pic.twitter.com/4VbljUcsLh<br/>Username: DataSci_Plow |  Tweet: Understanding when Simple and Multiple Linear Regression give Different Results  https://www.plow.io/post/understanding-when-simple-and-multiple-linear-regression-give-different-results?utm_source=Twitter&amp;utm_campaign=Data_science … +1 Hal2000Bot #data #science<br/>Username: DataSci_Plow |  Tweet: Artificial Curiosity  https://www.plow.io/post/artificial-curiosity?utm_source=Twitter&amp;utm_campaign=Data_science … +1 Hal2000Bot #data #science<br/>Username: gp_pulipaka |  Tweet: Synchronizing the Digital #SCM using AI for Supply Chain Planning. #BigData #Analytics #DataScience #AI #RPA #MachineLearning #IoT #IIoT #Python #RStats #TensorFlow #JavaScript #ReactJS #GoLang #CloudComputing #Serverless #DataScientist #Linux @lruettimann  http://bit.ly/2KX8vrt  pic.twitter.com/tftxwilkQf<br/>Username: DataSci_Plow |  Tweet: Extreme Rare Event Classification using Autoencoders in Keras  https://www.plow.io/post/extreme-rare-event-classification-using-autoencoders-in-keras?utm_source=Twitter&amp;utm_campaign=Data_science … +1 Hal2000Bot #data #science<br/>Username: DataSci_Plow |  Tweet: Five Methods to Debug your Neural Network  https://www.plow.io/post/five-methods-to-debug-your-neural-network?utm_source=Twitter&amp;utm_campaign=Data_science … +1 Hal2000Bot #data #science<br/>Username: iamjony94 |  Tweet: 26 Mobile and Desktop Tools for Marketers  http://bit.ly/2LkL3cN  #socialmedia #digitalmarketing #contentmarketing #growthhacking #startup #SEO #ecommerce #marketing #influencermarketing #blogging #infographic #deeplearning #ai #machinelearning #bigdata #datascience #fintech pic.twitter.com/mxHiY4eNXR<br/>Username: TDWI |  Tweet: #ATL #DataPros: Our #analyst, @prussom is headed your way to speak @ the #FDSRoadTour on Wed, 5/8! Register to attend for free, learn about Modern #DataManagement in the Age of #Cloud &amp; #DataScience: Trends, Challenges &amp; Opportunities.  https://bit.ly/2WlYOJb  #Atlanta #freeevent</span></pre><p id="b13c" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">看起来不太好，但我们得到了我们想要的。推文！</p><h1 id="5f34" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">将结果保存到熊猫中</h1><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nx"><img src="../Images/d3b47d8a8a403ad718b8956485053acc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*pVRFaTCIPMLjYZTy.jpg"/></div></div></figure><p id="cdac" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">遗憾的是 Twint 和 Spark 之间没有直接联系，但是我们可以用熊猫来做，然后将结果传递给 Optimus。</p><p id="c60f" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">我创建了一些简单的函数，你可以在实际项目中看到，这些函数帮助你处理熊猫和这个部分的奇怪的 Twint API。所以当我们运行这个时:</p><pre class="kg kh ki kj gt nl nm nn no aw np bi"><span id="fb0b" class="nq ks iq nm b gy nr ns l nt nu">available_columns()</span></pre><p id="35a2" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">你会看到:</p><pre class="kg kh ki kj gt nl nm nn no aw np bi"><span id="51da" class="nq ks iq nm b gy nr ns l nt nu">Index(['conversation_id', 'created_at', 'date', 'day', 'hashtags', 'hour','id', 'link', 'location', 'name', 'near', 'nlikes', 'nreplies','nretweets', 'place', 'profile_image_url', 'quote_url', 'retweet','search', 'timezone', 'tweet', 'user_id', 'user_id_str', 'username'],dtype='object')</span></pre><p id="d328" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">这些是我们刚刚查询得到的列。有很多不同的东西可以用来处理这些数据，但是对于本文，我将只使用其中的一部分。因此，为了将 Twint 的结果转换为 Pandas，我们运行:</p><pre class="kg kh ki kj gt nl nm nn no aw np bi"><span id="0648" class="nq ks iq nm b gy nr ns l nt nu">df_pd = twint_to_pandas(["date", "username", "tweet", "hashtags", "nlikes"])</span></pre><p id="4e58" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">你会看到这只熊猫:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ny"><img src="../Images/4304f2e11cbe21b224bdfb50c34ba189.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bNfyvkKq_CQExCW7O-nFsQ.png"/></div></div></figure><p id="ec0d" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">好多了不是吗？</p><h1 id="d43c" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">情感分析(简单的方法)</h1><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nx"><img src="../Images/e7aedd079f308b7d12509397e9d24d05.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*sPyjl7rBPNXPxeo3.jpg"/></div></div></figure><p id="640c" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">我们将使用 Optimus 和 TextBlob 对一些推文进行情感分析。我们需要做的第一件事是清理这些推文，因为擎天柱是最好的选择。</p><p id="2694" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">为了将数据保存为 Optimus (Spark) DF，我们需要运行:</p><pre class="kg kh ki kj gt nl nm nn no aw np bi"><span id="4045" class="nq ks iq nm b gy nr ns l nt nu">df = op.create.data_frame(pdf= df_pd)</span></pre><p id="b329" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">我们将使用 Optimus 删除重音符号和特殊字符(对于真实的工作场景，您需要做的远不止这些，如删除链接、图像和停用词)，为此:</p><pre class="kg kh ki kj gt nl nm nn no aw np bi"><span id="7b74" class="nq ks iq nm b gy nr ns l nt nu">clean_tweets = df.cols.remove_accents("tweet") \<br/>                 .cols.remove_special_chars("tweet")</span></pre><p id="4fe8" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">然后，我们需要从 Spark 收集这些推文，将它们放在 Python 列表中，为此:</p><pre class="kg kh ki kj gt nl nm nn no aw np bi"><span id="6aeb" class="nq ks iq nm b gy nr ns l nt nu">tweets = clean_tweets.select("tweet").rdd.flatMap(lambda x: x).collect()</span></pre><p id="e65f" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">然后，为了分析这些推文的情绪，我们将使用 TextBlob <em class="nk">情绪</em>函数:</p><pre class="kg kh ki kj gt nl nm nn no aw np bi"><span id="bbae" class="nq ks iq nm b gy nr ns l nt nu">from textblob import TextBlob<br/>from IPython.display import Markdown, display</span><span id="a380" class="nq ks iq nm b gy nv ns l nt nu"># Pretty printing the result<br/>def printmd(string, color=None):<br/>    colorstr = "&lt;span style='color:{}'&gt;{}&lt;/span&gt;".format(color, string)<br/>    display(Markdown(colorstr))</span><span id="ccfd" class="nq ks iq nm b gy nv ns l nt nu">for tweet in tweets:<br/>    print(tweet)<br/>    analysis = TextBlob(tweet)<br/>    print(analysis.sentiment)<br/>    if analysis.sentiment[0]&gt;0:<br/>        printmd('Positive', color="green")<br/>    elif analysis.sentiment[0]&lt;0:<br/>        printmd('Negative', color="red")<br/>    else:<br/>        printmd("No result", color="grey")<br/>        print("")</span></pre><p id="c348" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">这将给我们:</p><pre class="kg kh ki kj gt nl nm nn no aw np bi"><span id="9e36" class="nq ks iq nm b gy nr ns l nt nu">IAM Platform Curated Retweet  Via  httpstwittercomarmaninspace  ArtificialIntelligence AI What About The User Experience  httpswwwforbescomsitestomtaulli20190427artificialintelligenceaiwhatabouttheuserexperience  AI DataScience MachineLearning BigData DeepLearning Robots IoT ML DL IAMPlatform TopInfluence ArtificialIntelligence<br/>Sentiment(polarity=0.0, subjectivity=0.0)</span></pre><p id="facc" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">中立的</p><pre class="kg kh ki kj gt nl nm nn no aw np bi"><span id="d222" class="nq ks iq nm b gy nr ns l nt nu">Seattle Data Science Career Advice Landing a Job in The Emerald City Tips from Metis Seattle Career Advisor Marybeth Redmond –  httpsbitly2IYjzaj  pictwittercom98hMYZVxsu<br/>Sentiment(polarity=0.0, subjectivity=0.0)</span></pre><p id="43b8" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">中立的</p><pre class="kg kh ki kj gt nl nm nn no aw np bi"><span id="5d09" class="nq ks iq nm b gy nr ns l nt nu">This webinarworkshop is designed for business leaders data science managers and decision makers who want to build effective AI and data science capabilities for their organization Register here  httpsbitly2GDQeQT  pictwittercomxENQ0Dtv1X<br/>Sentiment(polarity=0.6, subjectivity=0.8)</span></pre><p id="29bc" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">积极的</p><pre class="kg kh ki kj gt nl nm nn no aw np bi"><span id="f831" class="nq ks iq nm b gy nr ns l nt nu">Contoh yang menarik dari sport science kali ini dari sisi statistik dan pemetaan lapangan Dengan makin gencarnya scientific method masuk di sport maka pengolahan data seperti ini akan semakin menjadi hal biasa  httpslnkdinfQHqgjh <br/>Sentiment(polarity=0.0, subjectivity=0.0)</span></pre><p id="f495" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">中立的</p><pre class="kg kh ki kj gt nl nm nn no aw np bi"><span id="2b0f" class="nq ks iq nm b gy nr ns l nt nu">Complete handson machine learning tutorial with data science Tensorflow artificial intelligence and neural networks  Machine Learning Data Science and Deep Learning with Python   httpsmedia4yousocialcareerdevelopmenthtmlmachinelearning  python machine learning online data science udemy elearning pictwittercomqgGVzRUFAM<br/>Sentiment(polarity=-0.16666666666666666, subjectivity=0.6)</span></pre><p id="c000" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">否定的；消极的；负面的；负的</p><pre class="kg kh ki kj gt nl nm nn no aw np bi"><span id="df56" class="nq ks iq nm b gy nr ns l nt nu">We share criminal data bases have science and medical collaoarations Freedom of movement means we can live and work in EU countries with no hassle at all much easier if youre from a poorer background We have Erasmus loads more good things<br/>Sentiment(polarity=0.18939393939393936, subjectivity=0.39166666666666666)</span></pre><p id="97b3" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">积极的</p><pre class="kg kh ki kj gt nl nm nn no aw np bi"><span id="1f65" class="nq ks iq nm b gy nr ns l nt nu">Value of Manufacturers Shipments for Durable Goods BigData DataScience housing rstats ggplot pictwittercomXy0UIQtNHy<br/>Sentiment(polarity=0.0, subjectivity=0.0)</span></pre><p id="055b" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">中立的</p><pre class="kg kh ki kj gt nl nm nn no aw np bi"><span id="4d6f" class="nq ks iq nm b gy nr ns l nt nu">Top DataScience and MachineLearning Methods Used in 2018 2019 AI MoRebaie TMounaged AINow6 JulezNorton  httpswwwkdnuggetscom201904topdatasciencemachinelearningmethods20182019html <br/>Sentiment(polarity=0.5, subjectivity=0.5)</span></pre><p id="bd97" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">积极的</p><pre class="kg kh ki kj gt nl nm nn no aw np bi"><span id="dc19" class="nq ks iq nm b gy nr ns l nt nu">Come check out the Santa Monica Data Science  Artificial Intelligence meetup to learn about In PersonComplete Handson Machine Learning Tutorial with Data Science  httpbitly2IRh0GU <br/>Sentiment(polarity=-0.6, subjectivity=1.0)</span></pre><p id="966f" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">否定的；消极的；负面的；负的</p><pre class="kg kh ki kj gt nl nm nn no aw np bi"><span id="827b" class="nq ks iq nm b gy nr ns l nt nu">Great talks about the future of multimodality clinical translation and data science Very inspiring 1stPETMRIsymposium unitue PETMRI molecularimaging AI pictwittercomO542P9PKXF<br/>Sentiment(polarity=0.4833333333333334, subjectivity=0.625)</span></pre><p id="482e" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">积极的</p><pre class="kg kh ki kj gt nl nm nn no aw np bi"><span id="beaf" class="nq ks iq nm b gy nr ns l nt nu">Did engineering now into data science last 5 years and doing MSC in data science this year<br/>Sentiment(polarity=0.0, subjectivity=0.06666666666666667)</span></pre><p id="d4de" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">中立的</p><pre class="kg kh ki kj gt nl nm nn no aw np bi"><span id="4dc5" class="nq ks iq nm b gy nr ns l nt nu">Program Officer – Data Science  httpbitly2PV3ROF <br/>Sentiment(polarity=0.0, subjectivity=0.0)</span></pre><p id="7cfe" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">中立。</p><p id="c2eb" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">诸如此类。</p><p id="1909" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">这非常容易，但它不会扩展，因为最终我们从 Spark 收集数据，所以驱动程序的 RAM 是极限。让我们做得更好一点。</p><h1 id="e5ac" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">将情感直接添加到 Spark 数据框架中</h1><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nz"><img src="../Images/4987a4b9694e6879f0153e3774553dc3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1090/format:webp/0*ZNzMrhc01bcfotT6.png"/></div></figure><p id="dc1c" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">将这些代码转换成 Spark 代码很简单。这段代码也可以帮助您转换其他代码。因此，让我们开始从 Spark 导入用户定义的功能模块:</p><pre class="kg kh ki kj gt nl nm nn no aw np bi"><span id="8053" class="nq ks iq nm b gy nr ns l nt nu">from pyspark.sql.functions import udf</span></pre><p id="b7d4" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">然后我们将把上面的代码转换成一个函数:</p><pre class="kg kh ki kj gt nl nm nn no aw np bi"><span id="bf87" class="nq ks iq nm b gy nr ns l nt nu">def apply_blob(sentence):<br/>    temp = TextBlob(sentence).sentiment[0]<br/>    if temp == 0.0:<br/>        return 0.0 # Neutral<br/>    elif temp &gt;= 0.0:<br/>        return 1.0 # Positive<br/>    else:<br/>        return 2.0 # Negative</span></pre><p id="c47f" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">此后，我们将把该函数注册为火花 UDF:</p><pre class="kg kh ki kj gt nl nm nn no aw np bi"><span id="3e16" class="nq ks iq nm b gy nr ns l nt nu">sentiment = udf(apply_blob)</span></pre><p id="72ab" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">然后，为了将该函数应用于整个数据帧，我们需要编写:</p><pre class="kg kh ki kj gt nl nm nn no aw np bi"><span id="d363" class="nq ks iq nm b gy nr ns l nt nu">clean_tweets.withColumn("sentiment", sentiment(clean_tweets['tweet'])).show()</span></pre><p id="c6b5" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">我们会看到:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oa"><img src="../Images/7782fb23e6e727015019bff3e545404a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Te_-NMzfAfdwx0xOrlKxJw.png"/></div></div></figure><h1 id="0947" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">情感分析，程序员的好方法(使代码模块化)</h1><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nx"><img src="../Images/f607916fad6f0b2b328537063f48ab5a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*ahuj0_o7F4lktAMH.jpg"/></div></div></figure><p id="552d" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">这实际上不是质量代码。让我们把它转换成函数来反复使用。</p><p id="fc75" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">第一部分是设置一切:</p><pre class="kg kh ki kj gt nl nm nn no aw np bi"><span id="b869" class="nq ks iq nm b gy nr ns l nt nu">%load_ext autoreload<br/>%autoreload 2</span><span id="abbc" class="nq ks iq nm b gy nv ns l nt nu"># Import twint<br/>import sys<br/>sys.path.append("twint/")</span><span id="5319" class="nq ks iq nm b gy nv ns l nt nu"># Set up TWINT config<br/>import twint<br/>c = twint.Config()</span><span id="0c70" class="nq ks iq nm b gy nv ns l nt nu"># Other imports<br/>import seaborn as sns<br/>import os<br/>from optimus import Optimus<br/>op = Optimus()</span><span id="541c" class="nq ks iq nm b gy nv ns l nt nu"># Solve compatibility issues with notebooks and RunTime errors.<br/>import nest_asyncio<br/>nest_asyncio.apply()</span><span id="4669" class="nq ks iq nm b gy nv ns l nt nu"># Disable annoying printing</span><span id="d8c2" class="nq ks iq nm b gy nv ns l nt nu">class HiddenPrints:<br/>    def __enter__(self):<br/>        self._original_stdout = sys.stdout<br/>        sys.stdout = open(os.devnull, 'w')</span><span id="2d93" class="nq ks iq nm b gy nv ns l nt nu">    def __exit__(self, exc_type, exc_val, exc_tb):<br/>        sys.stdout.close()<br/>        sys.stdout = self._original_stdout</span></pre><p id="e7f7" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">最后一部分是一个类，它将删除 Twint 的自动打印，所以我们只看到数据帧。</p><p id="b0f6" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">以上所有的东西都可以用这些函数来概括:</p><pre class="kg kh ki kj gt nl nm nn no aw np bi"><span id="0845" class="nq ks iq nm b gy nr ns l nt nu">from textblob import TextBlob<br/>from pyspark.sql.functions import udf<br/>from pyspark.sql.types import DoubleType</span><span id="a99b" class="nq ks iq nm b gy nv ns l nt nu"># Function to get sentiment <br/>def apply_blob(sentence):<br/>    temp = TextBlob(sentence).sentiment[0]<br/>    if temp == 0.0:<br/>        return 0.0 # Neutral<br/>    elif temp &gt;= 0.0:<br/>        return 1.0 # Positive<br/>    else:<br/>        return 2.0 # Negative</span><span id="316c" class="nq ks iq nm b gy nv ns l nt nu"># UDF to write sentiment on DF<br/>sentiment = udf(apply_blob, DoubleType())</span><span id="5f4e" class="nq ks iq nm b gy nv ns l nt nu"># Transform result to pandas<br/>def twint_to_pandas(columns):<br/>    return twint.output.panda.Tweets_df[columns]</span><span id="5035" class="nq ks iq nm b gy nv ns l nt nu">def tweets_sentiment(search, limit=1):<br/>    c.Search = search<br/>    # Custom output format<br/>    c.Format = "Username: {username} |  Tweet: {tweet}"<br/>    c.Limit = limit<br/>    c.Pandas = True<br/>    with HiddenPrints():<br/>        print(twint.run.Search(c))<br/>    <br/>    # Transform tweets to pandas DF<br/>    df_pd = twint_to_pandas(["date", "username", "tweet", "hashtags", "nlikes"])<br/>    <br/>    # Transform Pandas DF to Optimus/Spark DF<br/>    df = op.create.data_frame(pdf= df_pd)<br/>    <br/>    # Clean tweets<br/>    clean_tweets = df.cols.remove_accents("tweet") \<br/>                 .cols.remove_special_chars("tweet")<br/>    <br/>    # Add sentiment to final DF<br/>    return clean_tweets.withColumn("sentiment",    sentiment(clean_tweets['tweet']))</span></pre><p id="ac49" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">因此，为了获取推文并添加情感，我们使用:</p><pre class="kg kh ki kj gt nl nm nn no aw np bi"><span id="fa62" class="nq ks iq nm b gy nr ns l nt nu">df_result = tweets_sentiment("data science", limit=1)</span><span id="013a" class="nq ks iq nm b gy nv ns l nt nu">df_result.show()</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ob"><img src="../Images/b4684aecd19816a0b875820852e3aa44.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hXq9aW-Ay4fj4NP8Etrctw.png"/></div></div></figure><p id="65c9" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">就这样:)</p><p id="5452" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">让我们看看情绪的分布:</p><pre class="kg kh ki kj gt nl nm nn no aw np bi"><span id="2211" class="nq ks iq nm b gy nr ns l nt nu">df_res_pandas = df_result.toPandas()<br/>sns.distplot(df_res_pandas['sentiment'])<br/>sns.set(rc={'figure.figsize':(11.7,8.27)})</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi gj"><img src="../Images/99820ed799a176bd45fdfeae63eb9d77.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MbpnVS-G0ThT_luT6BCxoQ.png"/></div></div></figure><h1 id="9fec" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">利用 Twint 做更多事情</h1><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nx"><img src="../Images/8abb138e316fbc628095a0a1811eb0a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*7icUy-vl2wDX9eAJ.png"/></div></div><figcaption class="ml mm gj gh gi mn mo bd b be z dk">To see how to do this check: <a class="ae mp" href="https://amueller.github.io/word_cloud/auto_examples/masked.html" rel="noopener ugc nofollow" target="_blank">https://amueller.github.io/word_cloud/auto_examples/masked.html</a></figcaption></figure><p id="e170" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">我们可以做更多的事情，这里我将向你展示如何创建一个简单的函数来获取 tweets，以及如何从它们构建一个单词云。</p><p id="419d" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">所以通过简单的搜索就能得到推文:</p><pre class="kg kh ki kj gt nl nm nn no aw np bi"><span id="f0e8" class="nq ks iq nm b gy nr ns l nt nu">def get_tweets(search, limit=100):<br/>    c = twint.Config()<br/>    c.Search = search<br/>    c.Limit = limit<br/>    c.Pandas = True<br/>    c.Pandas_clean = True</span><span id="338f" class="nq ks iq nm b gy nv ns l nt nu">with HiddenPrints():<br/>        print(twint.run.Search(c))<br/>    return twint.output.panda.Tweets_df[["username","tweet"]]</span></pre><p id="2ee9" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">有了这个，我们可以很容易地获得成千上万条推文:</p><pre class="kg kh ki kj gt nl nm nn no aw np bi"><span id="4c2e" class="nq ks iq nm b gy nr ns l nt nu">tweets = get_tweets("data science", limit=10000)</span><span id="393f" class="nq ks iq nm b gy nv ns l nt nu">tweets.count() # 10003</span></pre><p id="1c2b" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">要生成单词云，我们需要做的就是:</p><pre class="kg kh ki kj gt nl nm nn no aw np bi"><span id="99f0" class="nq ks iq nm b gy nr ns l nt nu">from wordcloud import WordCloud, STOPWORDS, ImageColorGenerator<br/>import matplotlib.pyplot as plt<br/>%matplotlib inline</span><span id="f4cc" class="nq ks iq nm b gy nv ns l nt nu">text = tweets.tweet.values</span><span id="2c5f" class="nq ks iq nm b gy nv ns l nt nu"># adding movie script specific stopwords<br/>stopwords = set(STOPWORDS)<br/>stopwords.add("https")<br/>stopwords.add("xa0")<br/>stopwords.add("xa0'")<br/>stopwords.add("bitly")<br/>stopwords.add("bit")<br/>stopwords.add("ly")<br/>stopwords.add("twitter")<br/>stopwords.add("pic")</span><span id="f4af" class="nq ks iq nm b gy nv ns l nt nu">wordcloud = WordCloud(<br/>    background_color = 'black',<br/>    width = 1000,<br/>    height = 500,<br/>    stopwords = stopwords).generate(str(text))</span></pre><p id="a6db" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">我添加了一些与分析无关的常用词。为了说明这一点，我们使用:</p><pre class="kg kh ki kj gt nl nm nn no aw np bi"><span id="eaa3" class="nq ks iq nm b gy nr ns l nt nu">plt.imshow(wordcloud, interpolation=’bilinear’)<br/>plt.axis(“off”)<br/>plt.rcParams[‘figure.figsize’] = [10, 10]</span></pre><p id="a9b1" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">您将获得:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/fdb2e23a2a39d7906c2124f309463343.png" data-original-src="https://miro.medium.com/v2/resize:fit:1166/format:webp/1*ZVhq1eXwpQRVXoXsJ0Ip9Q.png"/></div></figure><p id="e639" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">很漂亮，但没那么漂亮。如果我们想要好的代码，我们需要模块，那么让我们把它转换成一个函数:</p><pre class="kg kh ki kj gt nl nm nn no aw np bi"><span id="653f" class="nq ks iq nm b gy nr ns l nt nu">def generate_word_cloud(tweets):<br/>    <br/>    # Getting the text out of the tweets<br/>    text = tweets.tweet.values<br/>    <br/>    # adding movie script specific stopwords<br/>    stopwords = set(STOPWORDS)<br/>    stopwords.add("https")<br/>    stopwords.add("xa0")<br/>    stopwords.add("xa0'")<br/>    stopwords.add("bitly")<br/>    stopwords.add("bit")<br/>    stopwords.add("ly")<br/>    stopwords.add("twitter")<br/>    stopwords.add("pic")</span><span id="60d4" class="nq ks iq nm b gy nv ns l nt nu">wordcloud = WordCloud(<br/>        background_color = 'black',<br/>        width = 1000,<br/>        height = 500,<br/>        stopwords = stopwords).generate(str(text))<br/>    <br/>    plt.imshow(wordcloud, interpolation='bilinear')<br/>    plt.axis("off")<br/>    plt.rcParams['figure.figsize'] = [10, 10]</span></pre><p id="37aa" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">然后我们就跑:</p><pre class="kg kh ki kj gt nl nm nn no aw np bi"><span id="d8e3" class="nq ks iq nm b gy nr ns l nt nu">tweets = get_tweets("artificial intelligence", limit=1000)<br/>generate_word_cloud(tweets)</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi od"><img src="../Images/fae3d346dfa0796363472b247c1098c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1160/format:webp/1*1EBGVGd2Kt5OhtZMcwsSdw.png"/></div></figure><h1 id="ab91" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">你自己试试</h1><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oe of l"/></div></figure><p id="09fd" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">你可以利用图书馆做更多的事情。其他一些功能:</p><ul class=""><li id="55cc" class="og oh iq ll b lm mf lp mg ls oi lw oj ma ok me ol om on oo bi translated"><code class="fe op oq or nm b">twint.run.Search()</code> -使用搜索过滤器获取推文(正常)；</li><li id="6004" class="og oh iq ll b lm os lp ot ls ou lw ov ma ow me ol om on oo bi translated"><code class="fe op oq or nm b">twint.run.Followers()</code>——获取一个 Twitter 用户的关注者；</li><li id="df5e" class="og oh iq ll b lm os lp ot ls ou lw ov ma ow me ol om on oo bi translated"><code class="fe op oq or nm b">twint.run.Following()</code> -获取关注推特用户的人；</li><li id="3940" class="og oh iq ll b lm os lp ot ls ou lw ov ma ow me ol om on oo bi translated"><code class="fe op oq or nm b">twint.run.Favorites()</code> -获取 Twitter 用户喜欢的推文；</li><li id="63ef" class="og oh iq ll b lm os lp ot ls ou lw ov ma ow me ol om on oo bi translated"><code class="fe op oq or nm b">twint.run.Profile()</code> -从用户的个人资料中获取推文(包括转发)；</li><li id="66d6" class="og oh iq ll b lm os lp ot ls ou lw ov ma ow me ol om on oo bi translated"><code class="fe op oq or nm b">twint.run.Lookup()</code> -从用户档案中获取信息(简历、位置等)。).</li></ul><p id="dc0f" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">实际上，您可以从终端使用它。对于刚才运行:</p><pre class="kg kh ki kj gt nl nm nn no aw np bi"><span id="7dbd" class="nq ks iq nm b gy nr ns l nt nu">pip3 install --upgrade -e git+https://github.com/twintproject/twint.git@origin/master#egg=twint</span></pre><p id="2893" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">然后只需运行转到 twint 文件夹:</p><pre class="kg kh ki kj gt nl nm nn no aw np bi"><span id="f00d" class="nq ks iq nm b gy nr ns l nt nu">cd src/twint</span></pre><p id="1c8b" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">最后你可以运行例如:</p><pre class="kg kh ki kj gt nl nm nn no aw np bi"><span id="5c32" class="nq ks iq nm b gy nr ns l nt nu">twint -u TDataScience --since 2019-01-01 --o TDS.csv --csv</span></pre><p id="749c" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">在这里，我得到了本年度<a class="ox oy ep" href="https://medium.com/u/7e12c71dfa81?source=post_page-----a0c96084995f--------------------------------" rel="noopener" target="_blank"> TDS 团队</a>的所有推文(迄今为止有 845 条)。如果你想要的话，下面是 CSV 文件:</p><div class="mq mr gp gr ms mt"><a href="https://github.com/FavioVazquez/twitter_optimus_twint/blob/master/TDS.csv" rel="noopener  ugc nofollow" target="_blank"><div class="mu ab fo"><div class="mv ab mw cl cj mx"><h2 class="bd ir gy z fp my fr fs mz fu fw ip bi translated">FavioVazquez/Twitter _ Optimus _ twint</h2><div class="na l"><h3 class="bd b gy z fp my fr fs mz fu fw dk translated">用 Twint，Optimus 和 Apache Spark 分析推文。-FavioVazquez/Twitter _ Optimus _ twint</h3></div><div class="nb l"><p class="bd b dl z fp my fr fs mz fu fw dk translated">github.com</p></div></div><div class="nd l"><div class="oz l nf ng nh nd ni kp mt"/></div></div></a></div><h1 id="f515" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">奖金(缩放结果)</h1><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="pa of l"/></div></figure><p id="2950" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">让我们获得 10k 条推文，并获得他们的情绪，因为为什么不。为此:</p><pre class="kg kh ki kj gt nl nm nn no aw np bi"><span id="450e" class="nq ks iq nm b gy nr ns l nt nu">df_result = tweets_sentiment("data science", limit=100000)</span><span id="2d28" class="nq ks iq nm b gy nv ns l nt nu">df_result.show()</span></pre><p id="7421" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">这实际上花了将近 10 分钟，所以要做好预防措施。从 CLI 获取 tweets，然后应用该函数可能会更快。让我们看看有多少条推文:</p><pre class="kg kh ki kj gt nl nm nn no aw np bi"><span id="5679" class="nq ks iq nm b gy nr ns l nt nu">df_results.count()</span></pre><p id="75da" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">我们有 10.031 条带有情绪的推文！你也可以用它们来训练其他模型。</p></div><div class="ab cl pb pc hu pd" role="separator"><span class="pe bw bk pf pg ph"/><span class="pe bw bk pf pg ph"/><span class="pe bw bk pf pg"/></div><div class="ij ik il im in"><p id="d962" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">感谢您阅读本文，希望它能对您目前的工作和对数据科学的理解有所帮助。如果你想了解我更多，请在 twitter 上关注我:</p><div class="mq mr gp gr ms mt"><a href="https://twitter.com/faviovaz" rel="noopener  ugc nofollow" target="_blank"><div class="mu ab fo"><div class="mv ab mw cl cj mx"><h2 class="bd ir gy z fp my fr fs mz fu fw ip bi translated">法维奥·巴斯克斯(@法维奥·巴斯克斯)|推特</h2><div class="na l"><h3 class="bd b gy z fp my fr fs mz fu fw dk translated">Favio Vázquez 的最新推文(@FavioVaz)。数据科学家。物理学家和计算工程师。我有一个…</h3></div><div class="nb l"><p class="bd b dl z fp my fr fs mz fu fw dk translated">推特通讯</p></div></div><div class="nd l"><div class="pi l nf ng nh nd ni kp mt"/></div></div></a></div></div></div>    
</body>
</html>