<html>
<head>
<title>Location-Based Recommendations</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">基于位置的推荐</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/location-based-recommendations-bb70af7b1538?source=collection_archive---------7-----------------------#2019-08-04">https://towardsdatascience.com/location-based-recommendations-bb70af7b1538?source=collection_archive---------7-----------------------#2019-08-04</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="51dd" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用机器学习创建基于位置的推荐器。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ki"><img src="../Images/93a9a1c0bcb78400a620521d677764db.png" data-original-src="https://miro.medium.com/v2/resize:fit:1340/format:webp/1*Z7lvJRV7lZjtpEDGQDX9mQ.jpeg"/></div><figcaption class="kq kr gj gh gi ks kt bd b be z dk">Location-based recommendation — Source <a class="ae ku" href="https://www.microsoft.com/en-us/research/publication/location-based-and-preference-aware-recommendation-using-sparse-geo-social-networking-data/" rel="noopener ugc nofollow" target="_blank">Microsoft</a>.</figcaption></figure><p id="0765" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">推荐系统在不同的应用中被广泛用于预测用户对产品或服务的偏好或评级。在过去的几分钟或几个小时里，你很可能在网上遇到过某种类型的推荐系统或与之互动过。甚至这篇文章可能已经被媒体或其他渠道通过推荐系统推荐给你了。</p><p id="9dfd" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">这些推荐系统可以有不同的类型，其中最突出的包括基于内容的过滤和协同过滤。在本文中，我们将研究基于位置的推荐，其中我们特别关注地理位置，以便利用用户的位置提供更相关的推荐。</p><p id="df2f" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">为了说明基于位置的推荐器的关键方面，我们将使用 K-Means 算法和来自 Kaggle 的<a class="ae ku" href="https://www.kaggle.com/yelp-dataset/yelp-dataset" rel="noopener ugc nofollow" target="_blank"> Yelp 数据集</a>来执行一个简单的基于位置的推荐。这些数据来自 JSON 文件，可以很容易地用 pandas 读取。</p><p id="28b5" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">下表显示了数据集的前 5 行。在该表中，业务坐标可用于每个业务的评级星和评论数。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="gh gi lr"><img src="../Images/886d52185ce52ea7186c6fa0767eb481.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HCv7F6sbWo99mF2W9oCbDw.png"/></div></div><figcaption class="kq kr gj gh gi ks kt bd b be z dk">Yelp Dataset</figcaption></figure><h2 id="1df8" class="lw lx it bd ly lz ma dn mb mc md dp me le mf mg mh li mi mj mk lm ml mm mn mo bi translated">探索性数据分析(EDA)和预处理</h2><p id="a193" class="pw-post-body-paragraph kv kw it kx b ky mp ju la lb mq jx ld le mr lg lh li ms lk ll lm mt lo lp lq im bi translated">在本节中，我们将探索和预处理数据集。该数据集包含 yelp 用户的评论，并包括许多类别。为了简化我们对推荐模型的分析和解释，我们将把重点放在餐馆上，您可以随意选择您感兴趣的任何其他类别。</p><p id="6435" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">我们首先通过过滤包含单词“餐馆”的所有企业来创建餐馆数据框架。然后，我们绘制餐厅的星级分布图，从 1 到 5。该图清楚地显示，大多数餐厅都有 4.0 或 3.5 星，而只有一小部分餐厅有 5.0 星。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="gh gi mu"><img src="../Images/313536c5a7f02acccba005b3afd8f28a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kouNoWqhuE9hgjbFSLST6g.png"/></div></div><figcaption class="kq kr gj gh gi ks kt bd b be z dk">Stars — Countplot</figcaption></figure><p id="23fa" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">让我们还基于<code class="fe mv mw mx my b">review_count</code>和<code class="fe mv mw mx my b">stars</code>的组合创建一个排序的数据框架，并可视化数据集中的前 20 家餐馆。</p><p id="9704" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">这里的选择是不仅根据<code class="fe mv mw mx my b"><strong class="kx iu">stars</strong></code>对餐馆进行排序，还根据餐馆有多少评论进行排序。这是数据集中排名前 20 的餐厅的图表。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="gh gi mu"><img src="../Images/5127c340a22b9e6810730d7145b03736.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GCRY6f_hFfEmPWULypmBpQ.png"/></div></div><figcaption class="kq kr gj gh gi ks kt bd b be z dk">Top 20 restaurants — Fix the plot</figcaption></figure><p id="fee9" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">最后，在我们进入 K-Means 聚类和基于位置的推荐之前，让我们也探索一下这些餐馆的位置，并想象成一张地图。我们将使用 Plotly Express 库，它提供了一种灵活而简单的方法来绘制带有漂亮底图的地理数据。</p><p id="47f2" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">正如您在下面的地图中所看到的，该数据集并不完整，仅包含美国和加拿大的几个城市。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="gh gi mz"><img src="../Images/2e66e717dc94f26fde8f9e111f10371d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jogEOYx3k2-LwS4JXq79aw.png"/></div></div><figcaption class="kq kr gj gh gi ks kt bd b be z dk">Map of the Restaurants in the dataset</figcaption></figure><p id="1a6f" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">为了定制我们的推荐系统，我们将只关注内华达州的拉斯维加斯，它在这个数据集中拥有最多的餐馆。</p><p id="9935" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">我们为拉斯维加斯的所有餐馆创建了一个缩放地图。下面你可以看到拉斯维加斯所有餐馆的地图。地图的颜色基于餐厅的星级数，而大小则表示该特定餐厅的评论数。正如你所看到的，高等级的餐馆聚集在市中心。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="gh gi mz"><img src="../Images/9a05261c2b9bf99e7a4fda0630b9c4e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aCrkGQtxjgbMF1mSe3VucQ.png"/></div></div></figure><h2 id="1a05" class="lw lx it bd ly lz ma dn mb mc md dp me le mf mg mh li mi mj mk lm ml mm mn mo bi translated">k 均值聚类</h2><p id="7b53" class="pw-post-body-paragraph kv kw it kx b ky mp ju la lb mq jx ld le mr lg lh li ms lk ll lm mt lo lp lq im bi translated">在执行 K-Means 聚类算法之前，让我们首先确定数据集中的最佳聚类数。这里我们使用一种叫做肘法的技术。</p><p id="8548" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">肘方法有助于我们确定合适的聚类数。这并不能给出准确的聚类数，但可能有助于选择聚类数。从下图可以看出，它有多个弯头。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="gh gi mu"><img src="../Images/f3a52adde718e9b2732d5ea7ad8fedd8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9dYb_atIKYOFWyIoO-UE7w.png"/></div></div><figcaption class="kq kr gj gh gi ks kt bd b be z dk">Elbow method K-Means Clustering</figcaption></figure><p id="93ef" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">借助于肘方法，我们选择 5 个聚类，并在坐标上执行 K-Means 聚类算法。我们还在<code class="fe mv mw mx my b">lasVegas</code>数据帧中填充了一个新列。</p><p id="9608" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">最后，我们根据 K-Means 算法创建了一个聚类散点图。该图清楚地显示了具有 5 个聚类的算法的输出。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="gh gi mz"><img src="../Images/01c47ebe4faefa442c5961f622e09fdb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eGkPc-QzBvCAiK_54DmXMQ.png"/></div></div><figcaption class="kq kr gj gh gi ks kt bd b be z dk">K-Means clustered points</figcaption></figure><h2 id="726d" class="lw lx it bd ly lz ma dn mb mc md dp me le mf mg mh li mi mj mk lm ml mm mn mo bi translated">基于位置的推荐</h2><p id="84b2" class="pw-post-body-paragraph kv kw it kx b ky mp ju la lb mq jx ld le mr lg lh li ms lk ll lm mt lo lp lq im bi translated">在这一节中，我们将把 K-means 聚类和餐馆评级结合在一起，根据用户的位置推荐餐馆。让我们首先创建一个基于评论数和星级数的 LasVegas 餐馆分类数据框架。我们称之为数据帧<code class="fe mv mw mx my b">top_restaurants_lasVegas.</code></p><p id="26b8" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">我们准备创建一个基于用户位置推荐餐馆的功能。我们创建了一个基于用户位置推荐餐馆的功能。</p><p id="bfbe" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">这里，我们的函数将获取纬度和经度以及数据帧。该函数首先预测坐标属于哪个聚类，并将数据帧进一步限制到该聚类，并返回该聚类中的前 5 家餐馆。</p><p id="7e07" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">这个函数很简单，只需要坐标，但我们可以进一步发展，接受其他输入，如地址或邮政编码。这需要一些地理编码应用程序，所以现在这足以说明基于位置的推荐的威力。在使用我们的推荐函数之前，让我们创建一个测试数据框架。</p><p id="fd68" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">现在，我们可以使用我们的推荐功能，将数据框架中的任何用户作为输入，来测试我们简单的基于位置的推荐的功能。记住这个测试数据只是为了方便，推荐函数直接接受任何给定的坐标。</p><p id="cb5b" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">对于第一个用户，K-Means 算法预测该聚类，并提取该聚类的前 5 家餐馆并推荐它们。红点是用户位置，蓝点是推荐餐厅。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="gh gi mz"><img src="../Images/9a5161719f3362af6682328e56f4e96e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wzDOYt3k-SjRYbb7CHHbfw.png"/></div></div><figcaption class="kq kr gj gh gi ks kt bd b be z dk">User 1 Red and Recommended Restaurants Blue</figcaption></figure><p id="c238" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">让我们再举一个例子，在这个例子中是用户 3。同样，我们的“推荐餐馆”功能预测该用户所属的聚类，并找出该聚类中的前 5 家餐馆。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="gh gi mz"><img src="../Images/cb3da4cdda2c6b75b36fafa33b946ccf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Nsv3yB7G8UKgH1lQdSmKfA.png"/></div></div></figure><h2 id="a092" class="lw lx it bd ly lz ma dn mb mc md dp me le mf mg mh li mi mj mk lm ml mm mn mo bi translated">结论</h2><p id="7100" class="pw-post-body-paragraph kv kw it kx b ky mp ju la lb mq jx ld le mr lg lh li ms lk ll lm mt lo lp lq im bi translated">在本教程中，我们使用 Yelp 数据集演示了 python 基于位置的推荐。我们用餐馆展示了一个基于位置的推荐应用程序。我们的推荐系统使用基于餐馆坐标的 K-Means 聚类，并且只考虑餐馆的评级(评级数量和星级)来推荐餐馆。我们也可以考虑餐馆的类型来定制推荐。这也可以进一步发展，以纳入其他输入方法，如地址或邮政编码。最后，我们的推荐没有明确考虑用户和推荐餐馆之间的距离，尽管 K-means 聚类限制了推荐餐馆的范围。</p><p id="7362" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">本教程的笔记本可以在这个 Github 资源库中找到。</p><div class="na nb gp gr nc nd"><a href="https://github.com/shakasom/location-based-recommendations/blob/master/README.md" rel="noopener  ugc nofollow" target="_blank"><div class="ne ab fo"><div class="nf ab ng cl cj nh"><h2 class="bd iu gy z fp ni fr fs nj fu fw is bi translated">shaka som/基于位置的建议</h2><div class="nk l"><h3 class="bd b gy z fp ni fr fs nj fu fw dk translated">推荐系统在不同的应用中被广泛用于预测用户的偏好或评级…</h3></div><div class="nl l"><p class="bd b dl z fp ni fr fs nj fu fw dk translated">github.com</p></div></div></div></a></div></div></div>    
</body>
</html>