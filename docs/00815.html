<html>
<head>
<title>Deep Learning, Computer Vision, and Automated Optical Inspection</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">深度学习、计算机视觉和自动光学检测</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/deep-learning-computer-vision-and-automated-optical-inspection-774e8ca529d3?source=collection_archive---------10-----------------------#2019-02-07">https://towardsdatascience.com/deep-learning-computer-vision-and-automated-optical-inspection-774e8ca529d3?source=collection_archive---------10-----------------------#2019-02-07</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="1082" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">热轧带钢表面缺陷分类实例研究</h2></div><p id="3f1d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">自动光学检测</strong>常用于电子工业和制造业，在生产过程中检测产品或部件的缺陷。从概念上讲，图像分类、对象检测和语义分割的深度学习中的常见实践都可以应用于<strong class="kh ir">自动光学检查</strong>。图 1 显示了图像识别中的一些常见任务，图 2 显示了钢零件表面缺陷的一些示例，以供交叉参考。</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi lb"><img src="../Images/1f8e36871b1fd28705a6b1895059a754.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Tb3CvTONAA4IVL-HciJscw.jpeg"/></div></div><figcaption class="ln lo gj gh gi lp lq bd b be z dk"><strong class="bd lr">Figure 1. Different tasks in image recognition. [</strong><a class="ae ls" href="https://medium.com/@nikasa1889/the-modern-history-of-object-recognition-infographic-aea18517c318" rel="noopener"><strong class="bd lr">source</strong></a><strong class="bd lr">]</strong></figcaption></figure><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi lt"><img src="../Images/46e47e0abe635979771c90356bb55ba6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*q3SSf3-0Jw6LWSMUgx5F0g.jpeg"/></div></div><figcaption class="ln lo gj gh gi lp lq bd b be z dk"><strong class="bd lr">Figure 2. NEU Surface Defect Dataset: Image Classification (left) and Object Detection (right). [</strong><a class="ae ls" href="http://faculty.neu.edu.cn/songkechen/zh_CN/zhym/263269/list/index.htm" rel="noopener ugc nofollow" target="_blank"><strong class="bd lr">source</strong></a><strong class="bd lr">]</strong></figcaption></figure><p id="efda" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">本文介绍了深度学习在热轧带钢表面缺陷图像分类中的应用研究。这篇文章的其余部分组织如下。首先，我们将讨论数据和任务。其次，我们将讨论三种用于评估的深度学习模型:基线模型、InceptionV3 和 MobileNet。最后，我们将介绍实验，然后评估结果。</p><h1 id="8494" class="lu lv iq bd lw lx ly lz ma mb mc md me jw mf jx mg jz mh ka mi kc mj kd mk ml bi translated">NEU 表面缺陷数据库</h1><p id="708e" class="pw-post-body-paragraph kf kg iq kh b ki mm jr kk kl mn ju kn ko mo kq kr ks mp ku kv kw mq ky kz la ij bi translated"><a class="ae ls" href="http://faculty.neu.edu.cn/songkechen/zh_CN/zhym/263269/list/index.htm" rel="noopener ugc nofollow" target="_blank"><strong class="kh ir">NEU 表面缺陷数据库</strong> </a> <strong class="kh ir"> </strong>收集了六种典型的热轧带钢表面缺陷。该数据集由 1800 张 200x200 的灰度图像组成，均匀标记在 6 个类别上，即<em class="mr">滚入比例</em>、<em class="mr">补丁</em>、<em class="mr">龟裂</em>、<em class="mr">麻面</em>、<em class="mr">内含物</em>和<em class="mr">划痕</em>。图 3 显示了数据库中的示例图像。</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi ms"><img src="../Images/9c6bb37834414662ddfa380b692165da.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hEDQZGvc52tVIYPiCqUMRA.jpeg"/></div></div><figcaption class="ln lo gj gh gi lp lq bd b be z dk"><strong class="bd lr">Figure 3. Sample images in NEU Surface Defect Database. [</strong><a class="ae ls" href="http://faculty.neu.edu.cn/songkechen/zh_CN/zhym/263269/list/index.htm" rel="noopener ugc nofollow" target="_blank"><strong class="bd lr">source</strong></a><strong class="bd lr">]</strong></figcaption></figure><p id="acc6" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们在这里的任务是探索这种多类分类问题的深度学习模型。注意，根据数据库的来源，该数据集对图像分类提出了两个困难的挑战，即<strong class="kh ir">类内变异</strong>和<strong class="kh ir">类间相似度</strong>:</p><ul class=""><li id="629e" class="mt mu iq kh b ki kj kl km ko mv ks mw kw mx la my mz na nb bi translated"><strong class="kh ir">类内变异</strong>，即同一类中可能出现不同的模式。例如<em class="mr">划痕</em>(图 3 最后一栏)的类别包括水平划痕、垂直划痕、倾斜划痕等。此外，由于照明和材料变化的影响，类内缺陷图像的灰度是变化的。</li><li id="47d6" class="mt mu iq kh b ki nc kl nd ko ne ks nf kw ng la my mz na nb bi translated"><strong class="kh ir">类间相似度</strong>，即相似的方面可能出现在不同的类下。例如，<em class="mr">滚入比例</em>、<em class="mr">龟裂</em>和<em class="mr">麻面</em>中的一些图像可能看起来很像。</li></ul><p id="ec93" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">虽然类内变异和类间相似性已经在不同的应用中得到解决，但在这种情况下，这些问题肯定会成为一个问题。</p><h1 id="a650" class="lu lv iq bd lw lx ly lz ma mb mc md me jw mf jx mg jz mh ka mi kc mj kd mk ml bi translated">模型选择和微调</h1><p id="4b5b" class="pw-post-body-paragraph kf kg iq kh b ki mm jr kk kl mn ju kn ko mo kq kr ks mp ku kv kw mq ky kz la ij bi translated">Keras 2.2.2(以 Tensorflow 1.10.0 为后端)实现了三个深度学习模型进行评估:</p><ul class=""><li id="6b38" class="mt mu iq kh b ki kj kl km ko mv ks mw kw mx la my mz na nb bi translated"><strong class="kh ir">一个简单的卷积神经网络作为基线模型</strong> : 3 个<em class="mr">Conv2D</em>/<em class="mr">MaxPooling2D</em>对作为特征提取器，3 个<em class="mr">密集</em>层作为分类器；(图 4)</li><li id="2801" class="mt mu iq kh b ki nc kl nd ko ne ks nf kw ng la my mz na nb bi translated"><strong class="kh ir"> InceptionV3 </strong> : <a class="ae ls" href="https://keras.io/applications/#inceptionv3" rel="noopener ugc nofollow" target="_blank"> Keras 应用 InceptionV3 </a>使用 1 个<em class="mr">globalaveragepool2d</em>层和 2 个<em class="mr"> Dense </em>层对分类器进行微调；(图 5)</li><li id="77fd" class="mt mu iq kh b ki nc kl nd ko ne ks nf kw ng la my mz na nb bi translated"><strong class="kh ir"> MobileNet </strong> : <a class="ae ls" href="https://keras.io/applications/#mobilenet" rel="noopener ugc nofollow" target="_blank"> Keras 应用 MobileNet </a>使用 1 个<em class="mr">globalaveragepooli2d</em>层和 2 个<em class="mr"> Dense </em>层对分类器进行微调；(图 6)</li></ul><p id="c58f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">更多关于数据处理和模型训练的共同工程决策:</p><ul class=""><li id="9084" class="mt mu iq kh b ki kj kl km ko mv ks mw kw mx la my mz na nb bi translated">没有数据增强；</li><li id="eabd" class="mt mu iq kh b ki nc kl nd ko ne ks nf kw ng la my mz na nb bi translated">培训/验证分成 90/10；</li><li id="071d" class="mt mu iq kh b ki nc kl nd ko ne ks nf kw ng la my mz na nb bi translated">没有预先训练的重量；</li><li id="0922" class="mt mu iq kh b ki nc kl nd ko ne ks nf kw ng la my mz na nb bi translated">20 个时期没有提前停止；</li></ul><figure class="lc ld le lf gt lg"><div class="bz fp l di"><div class="nh ni l"/></div><figcaption class="ln lo gj gh gi lp lq bd b be z dk"><strong class="ak">Figure 4. simple convolutional neural network.</strong></figcaption></figure><figure class="lc ld le lf gt lg"><div class="bz fp l di"><div class="nh ni l"/></div><figcaption class="ln lo gj gh gi lp lq bd b be z dk"><strong class="ak">Figure 5. InceptionV3 Fine-Tuning.</strong></figcaption></figure><figure class="lc ld le lf gt lg"><div class="bz fp l di"><div class="nh ni l"/></div><figcaption class="ln lo gj gh gi lp lq bd b be z dk"><strong class="ak">Figure 6. MobileNet Fine-Tuning.</strong></figcaption></figure><h1 id="9afc" class="lu lv iq bd lw lx ly lz ma mb mc md me jw mf jx mg jz mh ka mi kc mj kd mk ml bi translated">实验和评估</h1><ul class=""><li id="50bf" class="mt mu iq kh b ki mm kl mn ko nj ks nk kw nl la my mz na nb bi translated"><strong class="kh ir">图 7 </strong>简单卷积神经网络(基线):验证准确率高达 52.78%；</li><li id="028f" class="mt mu iq kh b ki nc kl nd ko ne ks nf kw ng la my mz na nb bi translated"><strong class="kh ir">图 8 </strong> <strong class="kh ir"> InceptionV3 微调</strong>:验证准确率高达 98.89%。这个模型似乎在 14 个时代后过度拟合；</li><li id="7bde" class="mt mu iq kh b ki nc kl nd ko ne ks nf kw ng la my mz na nb bi translated"><strong class="kh ir">图 9 </strong> <strong class="kh ir"> MobileNet 微调</strong>:验证准确率高达 100.00%。该模型在时期 4 达到 99.44%，然后在时期 10 和时期 14 达到 100.00%。(好得不像真的？！<a class="ae ls" href="https://gist.github.com/f-rumblefish/d7edc4370645894c0692cfb60f54398c" rel="noopener ugc nofollow" target="_blank">查看这里的完整日志</a></li></ul><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi nm"><img src="../Images/d8508125755eaeacd190099be4854843.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*47yD0Hdg3AWIMwGBtwmF4w.png"/></div></div><figcaption class="ln lo gj gh gi lp lq bd b be z dk"><strong class="bd lr">Figure 7. training/validation history of the simple convolutional neural network.</strong></figcaption></figure><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi nm"><img src="../Images/ee9fee11b80d069e4d20c0a5b15b3f53.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YvSnURpLm4s7nocVxOU7mQ.png"/></div></div><figcaption class="ln lo gj gh gi lp lq bd b be z dk"><strong class="bd lr">Figure 8. training/validation history of InceptionV3 Fine-Tuning.</strong></figcaption></figure><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi nm"><img src="../Images/199b9e60b753a8d1a5cdc98244d46e9d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uUygY4dOLidmMPWMLNocpA.png"/></div></div><figcaption class="ln lo gj gh gi lp lq bd b be z dk"><strong class="bd lr">Figure 9. training/validation history of MobileNet Fine-Tuning.</strong></figcaption></figure><h1 id="a29a" class="lu lv iq bd lw lx ly lz ma mb mc md me jw mf jx mg jz mh ka mi kc mj kd mk ml bi translated">结论</h1><p id="61b8" class="pw-post-body-paragraph kf kg iq kh b ki mm jr kk kl mn ju kn ko mo kq kr ks mp ku kv kw mq ky kz la ij bi translated">本文对热轧带钢表面缺陷的分类进行了研究。为<strong class="kh ir">自动光学检测</strong>实施缺陷分类解决方案实际上类似于在图像分类的深度学习中进行常见实践。显然，知道如何对 MNIST 数据集进行分类并从 Keras 应用程序中导入/调整模型的人应该能够完成这项工作。然而，我仍然想写下这个帖子，原因有几个。</p><ol class=""><li id="4384" class="mt mu iq kh b ki kj kl km ko mv ks mw kw mx la nn mz na nb bi translated">虽然自动光学检测在工业中非常重要，但是自动光学检测的公共数据集相对较少，因为大多数拥有这些数据的公司可能不想公开这些数据。因此，研究人员和从业人员可能缺乏数据集和调查基准。<strong class="kh ir">NEU 表面缺陷数据集</strong>为图像分类和目标检测提供数据，这无疑是一个很好的实践设置。</li><li id="1343" class="mt mu iq kh b ki nc kl nd ko ne ks nf kw ng la nn mz na nb bi translated">一般来说，<strong class="kh ir">自动光学检测</strong>数据集的大小小于教科书数据集(如 MNIST 或 CIFAR)和流行数据集(如 ImageNet 或 COCO)。)在<strong class="kh ir">NEU 表面缺陷数据集</strong>的情况下，每类只有 300 幅图像用于训练和验证。此外，由于要考虑类内差异、类间相似性和受检产品/组件/材料的性质，正确应用数据扩充可能是一个挑战。</li><li id="a96e" class="mt mu iq kh b ki nc kl nd ko ne ks nf kw ng la nn mz na nb bi translated">一些深度学习模型适用于<strong class="kh ir">自动光学检查</strong>的任务，但一些模型可能不是好的选择。然而，模型选择和微调没有金科玉律。使用从 ImageNet 学习的权重进行迁移学习(或者应该使用多少预先训练的权重)是否可以帮助我们执行<strong class="kh ir">自动光学检测</strong>的任务，这是事先未知的。</li></ol><p id="c796" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">最后评论:如果读者想知道深度学习方法和机器学习方法在这项任务中的区别，请查看英特尔人工智能学院下的<a class="ae ls" href="https://software.intel.com/en-us/articles/use-machine-learning-to-detect-defects-on-the-steel-surface" rel="noopener ugc nofollow" target="_blank">这篇博客</a>。</p><p id="737b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">感谢阅读。如果您有任何意见或问题，请随时留言。</p></div></div>    
</body>
</html>