<html>
<head>
<title>Make your pictures beautiful with a touch of deep learning magic</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用深度学习魔法让您的图片变得美丽</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/make-your-pictures-beautiful-with-a-touch-of-machine-learning-magic-31672daa3032?source=collection_archive---------3-----------------------#2019-01-01">https://towardsdatascience.com/make-your-pictures-beautiful-with-a-touch-of-machine-learning-magic-31672daa3032?source=collection_archive---------3-----------------------#2019-01-01</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/ddd1d15aee3e6d89040e4fd04d7991c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*13KWtUfykoazUtIkrUKvrg.png"/></div></div></figure><blockquote class="kb kc kd"><p id="9ff6" class="ke kf kg kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">想获得灵感？快来加入我的<a class="ae ld" href="https://www.superquotes.co/?utm_source=mediumtech&amp;utm_medium=web&amp;utm_campaign=sharing" rel="noopener ugc nofollow" target="_blank"> <strong class="kh iu">超级行情快讯</strong> </a>。😎</p></blockquote><p id="c08d" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp le kr ks kt lf kv kw kx lg kz la lb lc im bi translated">摄像技术很美。它给了我们所有人一个保存记忆的机会，当我们在照片中再次看到它们时，我们可以重温它们。</p><p id="3c23" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp le kr ks kt lf kv kw kx lg kz la lb lc im bi translated">在过去的几年里，这项技术取得了长足的进步。有了各种各样的新功能，如 4K、HDR 和色彩增强，人们可以捕捉到令人惊叹的照片。</p><p id="ddc2" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp le kr ks kt lf kv kw kx lg kz la lb lc im bi translated">但这是有代价的。不是每个人都能买得起最好的相机。消费级 DSLR 相机的价格从几百美元到几千美元不等。不仅如此，并不是每个人都能充分利用这些相机；毕竟我们并不都是专业摄影师！</p><p id="9cb7" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp le kr ks kt lf kv kw kx lg kz la lb lc im bi translated">我们大多数人只是用手机。但与高端数码单反相机相比，智能手机拍摄的照片往往非常平淡。</p><p id="f34a" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp le kr ks kt lf kv kw kx lg kz la lb lc im bi translated">深度学习改变了这一切。</p><h1 id="10dd" class="lh li it bd lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me bi translated">美化您的照片</h1><p id="50c0" class="pw-post-body-paragraph ke kf it kh b ki mf kk kl km mg ko kp le mh ks kt lf mi kw kx lg mj la lb lc im bi translated">来自<a class="ae ld" href="http://www.vision.ee.ethz.ch/en/" rel="noopener ugc nofollow" target="_blank">苏黎世联邦理工学院计算机视觉实验室</a>的研究展示了如何自动增强低质量相机拍摄的照片，使它们看起来像是专业摄影师用 DSLR 拍摄的。</p><p id="235b" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp le kr ks kt lf kv kw kx lg kz la lb lc im bi translated">他们是这样做的。</p><p id="9cea" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp le kr ks kt lf kv kw kx lg kz la lb lc im bi translated">该团队首先收集了一组低质量(来自手机)和高质量(来自 DSLR)的照片，你可以从项目页面<a class="ae ld" href="http://people.ee.ethz.ch/~ihnatova/" rel="noopener ugc nofollow" target="_blank">下载。这正是我们在这样一个增强任务中想要的数据:输入一个低质量的图像(来自手机)，并让深度网络尝试预测高质量的版本(来自 DSLR)会是什么样子。</a></p><p id="f694" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp le kr ks kt lf kv kw kx lg kz la lb lc im bi translated">一幅图像有几个我们可能想要增强的属性:光照、颜色、纹理、对比度和清晰度。深度网络被训练成用四种不同的损失函数来命中所有这些属性:</p><ul class=""><li id="7d9f" class="mk ml it kh b ki kj km kn le mm lf mn lg mo lc mp mq mr ms bi translated"><strong class="kh iu">颜色损失:</strong>预测图像和目标图像的模糊版本之间的欧几里德距离。</li><li id="87ce" class="mk ml it kh b ki mt km mu le mv lf mw lg mx lc mp mq mr ms bi translated"><strong class="kh iu">纹理损失:</strong>基于生成对抗网络(GAN)的分类损失。训练 GAN 来预测<em class="kg">灰度</em>照片的质量是高还是低。由于使用了灰度，网络将很好地聚焦于图像的纹理而不是颜色。</li><li id="c5fa" class="mk ml it kh b ki mt km mu le mv lf mw lg mx lc mp mq mr ms bi translated"><strong class="kh iu">内容损失:</strong>预测图像的 VGG 特征与地面真实之间的差异。这种损失确保了图像中的整体结构和对象(即图像语义)保持不变。</li><li id="384a" class="mk ml it kh b ki mt km mu le mv lf mw lg mx lc mp mq mr ms bi translated"><strong class="kh iu">总变化损失:</strong>图像中的总垂直和水平梯度。这会增强图像的平滑度，这样最终的结果就不会太粗糙或太嘈杂。</li></ul><p id="cba2" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp le kr ks kt lf kv kw kx lg kz la lb lc im bi translated">最后，将这些损失加起来，训练一个端到端网络来进行预测！整体 GAN 架构如下所示。如果你也想了解更多，你可以查看<a class="ae ld" href="https://arxiv.org/pdf/1704.02470.pdf" rel="noopener ugc nofollow" target="_blank">的论文</a>了解更多细节。</p><figure class="mz na nb nc gt ju gh gi paragraph-image"><div class="gh gi my"><img src="../Images/3b52e025bfef290e4f635aea85b6e880.png" data-original-src="https://miro.medium.com/v2/resize:fit:1052/format:webp/1*S-UIjOkBZ1AH8KFEiYzZGw.png"/></div><figcaption class="nd ne gj gh gi nf ng bd b be z dk">Architecture from the paper</figcaption></figure><h1 id="eb0d" class="lh li it bd lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me bi translated">代码</h1><p id="62a3" class="pw-post-body-paragraph ke kf it kh b ki mf kk kl km mg ko kp le mh ks kt lf mi kw kx lg mj la lb lc im bi translated">感谢 AI 社区开源思维的美丽，这里有一个公开可用的照片增强器<a class="ae ld" href="https://github.com/aiff22/DPED" rel="noopener ugc nofollow" target="_blank">的实现</a>！这是你如何使用它。</p><p id="a8fc" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp le kr ks kt lf kv kw kx lg kz la lb lc im bi translated">首先克隆存储库</p><pre class="mz na nb nc gt nh ni nj nk aw nl bi"><span id="3674" class="nm li it ni b gy nn no l np nq">git clone <a class="ae ld" href="https://github.com/aiff22/DPED" rel="noopener ugc nofollow" target="_blank">https://github.com/aiff22/DPED</a></span></pre><p id="8df8" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp le kr ks kt lf kv kw kx lg kz la lb lc im bi translated">安装所需的库</p><pre class="mz na nb nc gt nh ni nj nk aw nl bi"><span id="2566" class="nm li it ni b gy nn no l np nq">pip install tensorflow-gpu<br/>pip install numpy<br/>pip install scipy</span></pre><p id="6a49" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp le kr ks kt lf kv kw kx lg kz la lb lc im bi translated">所有预先训练的模型都已经在<em class="kg"> models_orig </em>文件夹中的存储库中，所以没有必要下载它们！</p><p id="1585" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp le kr ks kt lf kv kw kx lg kz la lb lc im bi translated">将您要增强的照片放在以下目录中:</p><pre class="mz na nb nc gt nh ni nj nk aw nl bi"><span id="115f" class="nm li it ni b gy nn no l np nq">dped/iphone/test_data/full_size_test_images/</span></pre><p id="909b" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp le kr ks kt lf kv kw kx lg kz la lb lc im bi translated">这是“iphone”的默认目录，但是如果你想改变它，你可以在<code class="fe nr ns nt ni b">test_model.py</code>脚本中改变代码。它之所以说“iphone”是因为作者最初使用 3 部智能手机的照片训练了 3 个不同的模型:iphone、索尼和黑莓，所以这是你的三个选项。但是这个模型在大多数带有这些选项的照片上都能很好地工作，所以我们可以只选择一个并运行它！</p><p id="45e6" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp le kr ks kt lf kv kw kx lg kz la lb lc im bi translated">最后，为了增强照片，我们只需运行一个简单的脚本:</p><pre class="mz na nb nc gt nh ni nj nk aw nl bi"><span id="cbff" class="nm li it ni b gy nn no l np nq">python test_model.py model=iphone_orig \<br/>                     test_subset=full \</span></pre><p id="1c0a" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp le kr ks kt lf kv kw kx lg kz la lb lc im bi translated">瞧啊。您增强的专业照片将保存在<code class="fe nr ns nt ni b">visual_results</code>文件夹中！</p><p id="a3ec" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp le kr ks kt lf kv kw kx lg kz la lb lc im bi translated">自己试试代码吧，很好玩的！查看照片增强后的效果。欢迎在下面发布链接，与社区分享您的照片。同时，这里有一些我自己测试的结果。</p><div class="mz na nb nc gt ab cb"><figure class="nu ju nv nw nx ny nz paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><img src="../Images/ba6564740f36078dbc64aa7fbe88b3ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*2DMg8ioOEm-ZJHSDORHuNQ.png"/></div></figure><figure class="nu ju nv nw nx ny nz paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><img src="../Images/278ec01a1a83e2abc6bed3a0f1984d02.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*AeWbWNu-6FRb5738YaqQMA.png"/></div></figure></div><div class="ab cb"><figure class="nu ju nv nw nx ny nz paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><img src="../Images/30dec2779d0fa7a1c4ddc09bfd8ebf8f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*pljKtePOIeV4rCaj_Gwstg.png"/></div></figure><figure class="nu ju nv nw nx ny nz paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><img src="../Images/42b30be175b444038da78d8d22b4c74a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*4N2bJsVE4B0S5EfWPogPxQ.png"/></div></figure></div><div class="ab cb"><figure class="nu ju nv nw nx ny nz paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><img src="../Images/8e0578f80e097aad8d5dd4ce95c7c329.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*X6PcmHVhah8jmhlViwuoRQ.png"/></div></figure><figure class="nu ju nv nw nx ny nz paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><img src="../Images/4db857201867a28c461648306f0bcad1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*GtQEtOZw5cmpu7Ha3JZwJQ.png"/></div></figure></div><div class="ab cb"><figure class="nu ju nv nw nx ny nz paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><img src="../Images/e423dcc7aa0c831ce7f43b63ddeeb624.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*13KWtUfykoazUtIkrUKvrg.png"/></div></figure><figure class="nu ju nv nw nx ny nz paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><img src="../Images/1a4b26e3f25de25d5e701f383ef1bff8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*XYggZZegUA5jy0Xf5JmZ5Q.png"/></div></figure></div></div><div class="ab cl oa ob hx oc" role="separator"><span class="od bw bk oe of og"/><span class="od bw bk oe of og"/><span class="od bw bk oe of"/></div><div class="im in io ip iq"><h1 id="3ecd" class="lh li it bd lj lk oh lm ln lo oi lq lr ls oj lu lv lw ok ly lz ma ol mc md me bi translated">喜欢学习？</h1><p id="cabc" class="pw-post-body-paragraph ke kf it kh b ki mf kk kl km mg ko kp le mh ks kt lf mi kw kx lg mj la lb lc im bi translated">在 twitter 上关注我，我会在这里发布所有最新最棒的人工智能、技术和科学！</p></div></div>    
</body>
</html>