<html>
<head>
<title>Your First Kafka Application</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">你的第一个 Kafka 应用</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/your-first-kafka-application-9b1358ccb870?source=collection_archive---------17-----------------------#2019-10-08">https://towardsdatascience.com/your-first-kafka-application-9b1358ccb870?source=collection_archive---------17-----------------------#2019-10-08</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="9884" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用 Twitter API 生成和消费消息</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/e9c66df1ad22751be6118b90fdf9c086.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XdvVo4QKoIAHaA0Qq_dCJA.jpeg"/></div></div></figure><h2 id="cbcf" class="ku kv it bd kw kx ky dn kz la lb dp lc ld le lf lg lh li lj lk ll lm ln lo lp bi translated">概观</h2><p id="b59a" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly ld lz ma mb lh mc md me ll mf mg mh mi im bi translated">在上一篇 Kafka <a class="ae mj" rel="noopener" target="_blank" href="/install-a-kafka-cluster-on-ubuntu-in-aws-17c951287284">帖子</a>中，我们已经在 Linux Ubuntu 上安装了一个 Kafka 集群。在本文中，我将使用这个集群来创建一个生成和消费消息的 Kafka 应用程序。该应用程序将使用 Java (8+)编写。您还需要安装 maven 来运行它。</p><p id="5ea1" class="pw-post-body-paragraph lq lr it ls b lt mk ju lv lw ml jx ly ld mm ma mb lh mn md me ll mo mg mh mi im bi translated">为了生成消息，我将使用 twitter API，使客户能够近乎实时地接收推文。每个 Twitter 帐户都可以访问流媒体 API，任何开发者都可以使用它来构建应用程序。</p><h1 id="4bb2" class="mp kv it bd kw mq mr ms kz mt mu mv lc jz mw ka lg kc mx kd lk kf my kg lo mz bi translated">生成 Twitter API 密钥</h1><p id="e534" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly ld lz ma mb lh mc md me ll mf mg mh mi im bi translated">去推特开发者:【https://developer.twitter.com/en/apps T2】</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi na"><img src="../Images/035ecd3df86127aaf153fcc08d693b70.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*h7kVR_L68-PyVvLy.png"/></div></div></figure><p id="9902" class="pw-post-body-paragraph lq lr it ls b lt mk ju lv lw ml jx ly ld mm ma mb lh mn md me ll mo mg mh mi im bi translated">创建一个新的应用程序，并填写所有最低要求的信息。转到“密钥和令牌”选项卡，将消费者密钥和机密对复制到一个文件中供以后使用。<br/>点击“创建”生成访问令牌和密码。将它们复制到一个文件中。现在，您已经拥有了开发生成器所需的所有东西。</p><h1 id="bc68" class="mp kv it bd kw mq mr ms kz mt mu mv lc jz mw ka lg kc mx kd lk kf my kg lo mz bi translated">配置到 Kafka 代理的远程连接</h1><p id="e6d1" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly ld lz ma mb lh mc md me ll mf mg mh mi im bi translated">要远程访问您的 Kafka 代理，请确保在 AWS 中打开端口 9092。<br/>登录您的 AWS。转到您的实例<strong class="ls iu">描述</strong>选项卡，并单击安全组创建。包括端口 9092 的新入站规则。你可以限制你的 IP 地址，或者允许所有人访问。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nb"><img src="../Images/c272c929aaec759d9f2f98fef99e94da.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FqFBjmyAcD30qvp5yh6KVw.png"/></div></div></figure><p id="94f5" class="pw-post-body-paragraph lq lr it ls b lt mk ju lv lw ml jx ly ld mm ma mb lh mn md me ll mo mg mh mi im bi translated">使用上一篇文章中描述的 ssh 连接到你的 Ubuntu 服务器。</p><pre class="kj kk kl km gt nc nd ne nf aw ng bi"><span id="3ecd" class="ku kv it nd b gy nh ni l nj nk">sudo nano /etc/kafka/server.properties</span></pre><p id="c0f2" class="pw-post-body-paragraph lq lr it ls b lt mk ju lv lw ml jx ly ld mm ma mb lh mn md me ll mo mg mh mi im bi translated">取消对以下行的注释，并插入 Kafka 服务器的公共 IPv4 公共 IP</p><pre class="kj kk kl km gt nc nd ne nf aw ng bi"><span id="fe2d" class="ku kv it nd b gy nh ni l nj nk">advertised.listeners=PLAINTEXT://&lt;IPv4 Public IP&gt;:9092</span></pre><p id="35a0" class="pw-post-body-paragraph lq lr it ls b lt mk ju lv lw ml jx ly ld mm ma mb lh mn md me ll mo mg mh mi im bi translated">重新启动 Kafka 代理:</p><pre class="kj kk kl km gt nc nd ne nf aw ng bi"><span id="f17a" class="ku kv it nd b gy nh ni l nj nk">sudo systemctl stop confluent-kafka <br/>sudo systemctl start confluent-kafka</span></pre><h1 id="3e07" class="mp kv it bd kw mq mr ms kz mt mu mv lc jz mw ka lg kc mx kd lk kf my kg lo mz bi translated">创建主题</h1><p id="486e" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly ld lz ma mb lh mc md me ll mf mg mh mi im bi translated">运行以下命令，为演示创建 Kafka 主题:</p><pre class="kj kk kl km gt nc nd ne nf aw ng bi"><span id="0100" class="ku kv it nd b gy nh ni l nj nk">kafka-topics --create --zookeeper localhost:2181 --replication-factor 1 --partitions 1 --topic bigdata-tweets</span></pre><h1 id="5762" class="mp kv it bd kw mq mr ms kz mt mu mv lc jz mw ka lg kc mx kd lk kf my kg lo mz bi translated">克隆存储库</h1><p id="defb" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly ld lz ma mb lh mc md me ll mf mg mh mi im bi translated">现在，让我们在本地机器上构建我们的应用程序。</p><p id="27db" class="pw-post-body-paragraph lq lr it ls b lt mk ju lv lw ml jx ly ld mm ma mb lh mn md me ll mo mg mh mi im bi translated">完整的代码可以在<a class="ae mj" href="https://github.com/mlomboglia/kafka-twitter" rel="noopener ugc nofollow" target="_blank">我的 GitHub 这里</a>找到。请克隆并安装此存储库。</p><pre class="kj kk kl km gt nc nd ne nf aw ng bi"><span id="03eb" class="ku kv it nd b gy nh ni l nj nk">git clone <a class="ae mj" href="mailto:git@github.com" rel="noopener ugc nofollow" target="_blank">git@github.com</a>:mlomboglia/kafka-twitter.git<br/>cd kafka-twitter<br/>mvn clean install</span></pre><p id="d3a4" class="pw-post-body-paragraph lq lr it ls b lt mk ju lv lw ml jx ly ld mm ma mb lh mn md me ll mo mg mh mi im bi translated">运行 maven 后，您应该会看到:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nl"><img src="../Images/7413070ad0d444428597fedca730a3b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GupZ24RlX0Q_R9QmmTj5BQ.png"/></div></div></figure><p id="0f37" class="pw-post-body-paragraph lq lr it ls b lt mk ju lv lw ml jx ly ld mm ma mb lh mn md me ll mo mg mh mi im bi translated">Producer API 帮助您向 Apache Kafka 生成数据。我将连接到一个远程 Kafka 代理，使用 API 获取 Tweets 并将其发送到 Kafka 主题。</p><p id="7ab8" class="pw-post-body-paragraph lq lr it ls b lt mk ju lv lw ml jx ly ld mm ma mb lh mn md me ll mo mg mh mi im bi translated">打开您选择的 IDE 并作为 maven 项目导入。</p><p id="7422" class="pw-post-body-paragraph lq lr it ls b lt mk ju lv lw ml jx ly ld mm ma mb lh mn md me ll mo mg mh mi im bi translated">我会把我的命名为卡夫卡-推特</p><p id="99e4" class="pw-post-body-paragraph lq lr it ls b lt mk ju lv lw ml jx ly ld mm ma mb lh mn md me ll mo mg mh mi im bi translated">在<strong class="ls iu">TwitterConfiguration.java</strong>文件<br/>中替换你的 Twiter 键，执行<strong class="ls iu">App.java</strong>，控制台将显示 tweets 被获取并发送给 Kafka 制作人。</p><pre class="kj kk kl km gt nc nd ne nf aw ng bi"><span id="3bf4" class="ku kv it nd b gy nh ni l nj nk">mvn exec:java -Dexec.mainClass="com.mlombog.kafka.App"</span></pre><p id="5981" class="pw-post-body-paragraph lq lr it ls b lt mk ju lv lw ml jx ly ld mm ma mb lh mn md me ll mo mg mh mi im bi translated">这将通过一个简单的确认响应来触发回调。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nm"><img src="../Images/5586f1e1ca527bc408675b4de41fcd16.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9Qu1FLBxVDdDLTLj3xKazA.png"/></div></div></figure><p id="4a03" class="pw-post-body-paragraph lq lr it ls b lt mk ju lv lw ml jx ly ld mm ma mb lh mn md me ll mo mg mh mi im bi translated">按照上一篇文章中的解释，进入控制中心，你会在你的<strong class="ls iu"> bigdata-tweets </strong>主题中看到消息</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nn"><img src="../Images/606beb4fdc08c7e08209397890e120bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*RVKivKg87_1M16k7.png"/></div></div></figure><p id="3a2a" class="pw-post-body-paragraph lq lr it ls b lt mk ju lv lw ml jx ly ld mm ma mb lh mn md me ll mo mg mh mi im bi translated">登录您的 Kafka 服务器并使用您的邮件:</p><pre class="kj kk kl km gt nc nd ne nf aw ng bi"><span id="f715" class="ku kv it nd b gy nh ni l nj nk">kafka-console-consumer --bootstrap-server localhost:9092 --topic bigdata-tweets --from-beginning</span></pre><p id="3be0" class="pw-post-body-paragraph lq lr it ls b lt mk ju lv lw ml jx ly ld mm ma mb lh mn md me ll mo mg mh mi im bi translated">恭喜你！！</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi no"><img src="../Images/d436903b0441be7c66d8b088091caa5b.png" data-original-src="https://miro.medium.com/v2/resize:fit:128/format:webp/0*FWkE9zzfRQG4LZG7.png"/></div></figure></div><div class="ab cl np nq hx nr" role="separator"><span class="ns bw bk nt nu nv"/><span class="ns bw bk nt nu nv"/><span class="ns bw bk nt nu"/></div><div class="im in io ip iq"><p id="0902" class="pw-post-body-paragraph lq lr it ls b lt mk ju lv lw ml jx ly ld mm ma mb lh mn md me ll mo mg mh mi im bi translated"><em class="nw">最初发表于</em><a class="ae mj" href="https://marcoslombog.com/2019/07/17/kafka-first-app.html" rel="noopener ugc nofollow" target="_blank"><em class="nw">【https://marcoslombog.com】</em></a><em class="nw">。</em></p></div></div>    
</body>
</html>