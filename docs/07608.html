<html>
<head>
<title>Letâ€™s Build a Fashion-MNIST CNN, PyTorch Style</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">è®©æˆ‘ä»¬å»ºç«‹ä¸€ä¸ªæ—¶å°š-MNIST æœ‰çº¿ç”µè§†æ–°é—»ç½‘ï¼ŒPyTorch é£æ ¼</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://towardsdatascience.com/build-a-fashion-mnist-cnn-pytorch-style-efb297e22582?source=collection_archive---------2-----------------------#2019-10-23">https://towardsdatascience.com/build-a-fashion-mnist-cnn-pytorch-style-efb297e22582?source=collection_archive---------2-----------------------#2019-10-23</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="8b32" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">å¦‚ä½•ä½¿ç”¨ Google Colab å’Œ TensorBoard ä»å¤´å¼€å§‹æ„å»º PyTorch ML é¡¹ç›®çš„é€è¡ŒæŒ‡å—</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/f2ea5451cfa450d03fee3c36ffde0d5e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cz0q6YuI0H8dSd5N9Km5_A.png"/></div></div></figure><p id="4c07" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi lq translated">å½“è°ˆåˆ°æŠ€æœ¯ä¸­çš„æ¡†æ¶æ—¶ï¼Œä¸€ä»¶æœ‰è¶£çš„äº‹æƒ…æ˜¯ï¼Œä»ä¸€å¼€å§‹ï¼Œä¼¼ä¹æ€»æ˜¯æœ‰å„ç§å„æ ·çš„é€‰æ‹©ã€‚ä½†éšç€æ—¶é—´çš„æ¨ç§»ï¼Œç«äº‰å°†æ¼”å˜ä¸ºåªå‰©ä¸‹ä¸¤ä¸ªå¼ºæœ‰åŠ›çš„ç«äº‰è€…ã€‚å…¸å‹çš„ä¾‹å­æœ‰â€œPC vs Macâ€ã€â€œiOS vs Androidâ€ã€â€œReact.js vs Vue.jsâ€ç­‰ã€‚è€Œç°åœ¨ï¼Œæˆ‘ä»¬åœ¨æœºå™¨å­¦ä¹ æ–¹é¢æœ‰äº†â€˜py torch vs tensor flowâ€™ã€‚</p><p id="0182" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">ç”±è°·æ­Œæ”¯æŒçš„<a class="ae lz" href="https://github.com/tensorflow/tensorflow" rel="noopener ugc nofollow" target="_blank"> TensorFlow </a>æ— ç–‘æ˜¯è¿™æ–¹é¢çš„é¢†è·‘è€…ã€‚å®ƒäº 2015 å¹´ä½œä¸ºå¼€æºæœºå™¨å­¦ä¹ æ¡†æ¶å‘å¸ƒï¼Œè¿…é€Ÿè·å¾—äº†å¤§é‡å…³æ³¨å’Œæ¥å—ï¼Œç‰¹åˆ«æ˜¯åœ¨ç”Ÿäº§å‡†å¤‡å’Œéƒ¨ç½²éå¸¸å…³é”®çš„è¡Œä¸šã€‚<a class="ae lz" href="https://github.com/pytorch/pytorch" rel="noopener ugc nofollow" target="_blank"> PyTorch </a>ç”±è„¸ä¹¦åœ¨ 2017 å¹´æ¨å‡ºï¼Œä½†ç”±äºå…¶åŠ¨æ€è®¡ç®—å›¾å’Œ'<a class="ae lz" href="https://legacy.python.org/dev/peps/pep-0020/" rel="noopener ugc nofollow" target="_blank">python å¼</a>'é£æ ¼ï¼Œå¾ˆå¿«è·å¾—äº†ä»ä¸šè€…å’Œç ”ç©¶äººå‘˜çš„å–œçˆ±ã€‚</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ma"><img src="../Images/8f467add53fb4ec27a654b070f6d119b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FfvNjEbtpC33GS_sqcW1Kg.png"/></div></div><figcaption class="mb mc gj gh gi md me bd b be z dk">Image from <a class="ae lz" href="https://thegradient.pub/state-of-ml-frameworks-2019-pytorch-dominates-research-tensorflow-dominates-industry/" rel="noopener ugc nofollow" target="_blank">The Gradient</a></figcaption></figure><p id="c526" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><a class="ae lz" href="https://thegradient.pub/state-of-ml-frameworks-2019-pytorch-dominates-research-tensorflow-dominates-industry/" rel="noopener ugc nofollow" target="_blank"> The Gradient </a>æœ€è¿‘çš„ç ”ç©¶è¡¨æ˜ï¼ŒPyTorch åœ¨ç ”ç©¶äººå‘˜ä¸­è¡¨ç°å‡ºè‰²ï¼ŒTensorFlow åœ¨ä¸šç•Œå æ®ä¸»å¯¼åœ°ä½:</p><blockquote class="mf"><p id="fcc6" class="mg mh it bd mi mj mk ml mm mn mo lp dk translated">2019 å¹´ï¼ŒML æ¡†æ¶çš„æˆ˜äº‰è¿˜æœ‰ä¸¤ä¸ªä¸»è¦ç«äº‰è€…:PyTorch å’Œ TensorFlowã€‚æˆ‘çš„åˆ†æè¡¨æ˜ï¼Œç ”ç©¶äººå‘˜æ­£åœ¨æ”¾å¼ƒ TensorFlowï¼Œæˆç¾¤ç»“é˜Ÿåœ°æ¶Œå‘ PyTorchã€‚ä¸æ­¤åŒæ—¶ï¼Œåœ¨è¡Œä¸šä¸­ï¼ŒTensorflow æ˜¯ç›®å‰çš„é¦–é€‰å¹³å°ï¼Œä½†è¿™ç§æƒ…å†µå¯èƒ½ä¸ä¼šæŒç»­å¤ªä¹…ã€‚â€” <a class="ae lz" href="https://thegradient.pub/state-of-ml-frameworks-2019-pytorch-dominates-research-tensorflow-dominates-industry/" rel="noopener ugc nofollow" target="_blank">å¡åº¦</a></p></blockquote><p id="3eaf" class="pw-post-body-paragraph ku kv it kw b kx mp ju kz la mq jx lc ld mr lf lg lh ms lj lk ll mt ln lo lp im bi translated">æœ€è¿‘å‘å¸ƒçš„ PyTorch 1.3 å¼•å…¥äº† PyTorch Mobileã€quantization å’Œå…¶ä»–å¥½ä¸œè¥¿ï¼Œå®ƒä»¬éƒ½æœç€ç¼©å°å·®è·çš„æ­£ç¡®æ–¹å‘å‰è¿›ã€‚å¦‚æœä½ å¯¹ç¥ç»ç½‘ç»œåŸºç¡€æœ‰ç‚¹ç†Ÿæ‚‰ï¼Œä½†æƒ³å°è¯• PyTorch ä½œä¸ºä¸€ç§ä¸åŒçš„é£æ ¼ï¼Œé‚£ä¹ˆè¯·ç»§ç»­é˜…è¯»ã€‚æˆ‘å°†å°è¯•è§£é‡Šå¦‚ä½•ä½¿ç”¨ PyTorch ä¸ºæ—¶å°š-MNIST æ•°æ®é›†ä»å¤´æ„å»ºä¸€ä¸ªå·ç§¯ç¥ç»ç½‘ç»œåˆ†ç±»å™¨ã€‚å¦‚æœä½ æ²¡æœ‰å¼ºå¤§çš„æœ¬åœ°ç¯å¢ƒï¼Œè¿™é‡Œçš„ä»£ç å¯ä»¥åœ¨ Google Colab å’Œ Tensor Board ä¸Šä½¿ç”¨ã€‚äº‹ä¸å®œè¿Ÿï¼Œæˆ‘ä»¬å¼€å§‹å§ã€‚æ‚¨å¯ä»¥åœ¨ä¸‹é¢æ‰¾åˆ° Google Colab ç¬”è®°æœ¬å’Œ GitHub é“¾æ¥:</p><p id="9a75" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><a class="ae lz" href="https://colab.research.google.com/drive/1YWzAjpAnLI23irBQtLvDTYT1A94uCloM" rel="noopener ugc nofollow" target="_blank">ğŸ“™<strong class="kw iu">è°·æ­Œ Colab ç¬”è®°æœ¬</strong> </a></p><p id="5f71" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">ğŸ‘½<a class="ae lz" href="https://github.com/wayofnumbers/SideProjects/blob/master/PyTorch_Tutorial_Basic_v1.ipynb" rel="noopener ugc nofollow" target="_blank"> <strong class="kw iu"> GitHub </strong> </a></p></div><div class="ab cl mu mv hx mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="im in io ip iq"><h1 id="0c4b" class="nb nc it bd nd ne nf ng nh ni nj nk nl jz nm ka nn kc no kd np kf nq kg nr ns bi translated">å¯¼å…¥</h1><p id="d397" class="pw-post-body-paragraph ku kv it kw b kx nt ju kz la nu jx lc ld nv lf lg lh nw lj lk ll nx ln lo lp im bi translated">é¦–å…ˆï¼Œè®©æˆ‘ä»¬å¯¼å…¥å¿…è¦çš„æ¨¡å—ã€‚</p><pre class="kj kk kl km gt ny nz oa ob aw oc bi"><span id="bbac" class="od nc it nz b gy oe of l og oh"># import standard PyTorch modules<br/>import torch<br/>import torch.nn as nn<br/>import torch.nn.functional as F<br/>import torch.optim as optim<br/>from torch.utils.tensorboard import SummaryWriter # TensorBoard support<br/><br/># import torchvision module to handle image manipulation<br/>import torchvision<br/>import torchvision.transforms as transforms<br/><br/># calculate train time, writing train data to files etc.<br/>import time<br/>import pandas as pd<br/>import json<br/>from IPython.display import clear_output<br/><br/>torch.set_printoptions(linewidth=120)<br/>torch.set_grad_enabled(True)     # On by default, leave it here for clarity</span></pre><p id="c477" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">PyTorch æ¨¡å—éå¸¸ç®€å•ã€‚</p><h2 id="48a4" class="od nc it bd nd oi oj dn nh ok ol dp nl ld om on nn lh oo op np ll oq or nr os bi translated">ç«ç‚¬</h2><p id="deea" class="pw-post-body-paragraph ku kv it kw b kx nt ju kz la nu jx lc ld nv lf lg lh nw lj lk ll nx ln lo lp im bi translated"><code class="fe ot ou ov nz b">torch</code>æ˜¯ä¸»æ¨¡å—ï¼ŒåŒ…å«äº†<strong class="kw iu">å¼ é‡</strong>è®¡ç®—æ‰€éœ€çš„æ‰€æœ‰ä¸œè¥¿ã€‚æ‚¨å¯ä»¥å•ç‹¬ä½¿ç”¨å¼ é‡è®¡ç®—æ¥æ„å»ºä¸€ä¸ªå…¨åŠŸèƒ½çš„ç¥ç»ç½‘ç»œï¼Œä½†è¿™ä¸æ˜¯æœ¬æ–‡è¦è®¨è®ºçš„å†…å®¹ã€‚æˆ‘ä»¬å°†åˆ©ç”¨æ›´å¼ºå¤§ã€æ›´æ–¹ä¾¿çš„<code class="fe ot ou ov nz b">torch.nn</code>ã€<code class="fe ot ou ov nz b">torch.optim</code>å’Œ<code class="fe ot ou ov nz b">torchvision</code>ç±»æ¥å¿«é€Ÿæ„å»ºæˆ‘ä»¬çš„ CNNã€‚å¯¹äºé‚£äº›æœ‰å…´è¶£çŸ¥é“å¦‚ä½•ä»â€œä»<em class="ow">æŠ“åˆ°</em>å¼€å§‹åšè¿™ä»¶äº‹çš„äººï¼Œè¯·è®¿é—®è¿™ä¸ª<a class="ae lz" href="https://pytorch.org/tutorials/beginner/nn_tutorial.html" rel="noopener ugc nofollow" target="_blank">å¥‡å¦™çš„ PyTorch å®˜æ–¹ tutoria </a> l ä½œè€…<a class="ox oy ep" href="https://medium.com/u/34ab754f8c5e?source=post_page-----efb297e22582--------------------------------" rel="noopener" target="_blank">æ°ç‘ç±³Â·éœåå¾·</a>ã€‚</p><h2 id="5771" class="od nc it bd nd oi oj dn nh ok ol dp nl ld om on nn lh oo op np ll oq or nr os bi translated">torch.nn å’Œ torch.nn åŠŸèƒ½</h2><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oz"><img src="../Images/af347b724f99ed5f02a39918018680be.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*zmhp4AMV_HCUa5rH"/></div></div><figcaption class="mb mc gj gh gi md me bd b be z dk">Photo by <a class="ae lz" href="https://unsplash.com/@duck58cth?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Alphacolor</a> on <a class="ae lz" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="538f" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><code class="fe ot ou ov nz b">torch.nn</code>æ¨¡å—æä¾›äº†è®¸å¤šæ„å»ºç¥ç»ç½‘ç»œçš„ç±»å’Œå‡½æ•°ã€‚ä½ å¯ä»¥æŠŠå®ƒæƒ³è±¡æˆç¥ç»ç½‘ç»œçš„åŸºæœ¬æ„ä»¶:æ¨¡å‹ã€å„ç§å±‚ã€æ¿€æ´»å‡½æ•°ã€å‚æ•°ç±»ç­‰ç­‰ã€‚å®ƒå…è®¸æˆ‘ä»¬åƒç»„è£…ä¹é«˜ç©å…·ä¸€æ ·æ¥å»ºé€ æ¨¡å‹ã€‚</p><h2 id="c890" class="od nc it bd nd oi oj dn nh ok ol dp nl ld om on nn lh oo op np ll oq or nr os bi translated">ç«ç‚¬. optim</h2><p id="dc1a" class="pw-post-body-paragraph ku kv it kw b kx nt ju kz la nu jx lc ld nv lf lg lh nw lj lk ll nx ln lo lp im bi translated"><code class="fe ot ou ov nz b">torch.optim</code>æä¾›æ‰€æœ‰ä¼˜åŒ–å™¨ï¼Œå¦‚ SGDã€ADAM ç­‰ã€‚ï¼Œè¿™æ ·å°±ä¸ç”¨ä»å¤´å¼€å§‹å†™äº†ã€‚</p><h2 id="ffd9" class="od nc it bd nd oi oj dn nh ok ol dp nl ld om on nn lh oo op np ll oq or nr os bi translated">ç«ç‚¬è§†è§‰</h2><p id="4925" class="pw-post-body-paragraph ku kv it kw b kx nt ju kz la nu jx lc ld nv lf lg lh nw lj lk ll nx ln lo lp im bi translated"><code class="fe ot ou ov nz b">torchvision</code>åŒ…å«å¤§é‡æµè¡Œçš„æ•°æ®é›†ã€æ¨¡å‹æ¶æ„å’Œè®¡ç®—æœºè§†è§‰çš„å¸¸è§å›¾åƒè½¬æ¢ã€‚æˆ‘ä»¬ä»ä¸­è·å–æ—¶å°š MNIST æ•°æ®é›†ï¼Œå¹¶ä½¿ç”¨å…¶å˜æ¢ã€‚</p><h2 id="0743" class="od nc it bd nd oi oj dn nh ok ol dp nl ld om on nn lh oo op np ll oq or nr os bi translated">æ‘˜è¦è®°å½•å™¨(å¼ é‡æ¿)</h2><p id="280b" class="pw-post-body-paragraph ku kv it kw b kx nt ju kz la nu jx lc ld nv lf lg lh nw lj lk ll nx ln lo lp im bi translated"><code class="fe ot ou ov nz b">SummaryWriter</code>ä½¿ PyTorch èƒ½å¤Ÿä¸ºå¼ é‡æ¿ç”ŸæˆæŠ¥å‘Šã€‚æˆ‘ä»¬å°†ä½¿ç”¨ Tensor Board æŸ¥çœ‹æˆ‘ä»¬çš„è®­ç»ƒæ•°æ®ï¼Œæ¯”è¾ƒç»“æœå¹¶è·å¾—ç›´è§‰ã€‚å¼ é‡æ¿æ›¾ç»æ˜¯ TensorFlow ç›¸å¯¹äº PyTorch çš„æœ€å¤§ä¼˜åŠ¿ï¼Œä½†æ˜¯ç°åœ¨ä» v1.2 å¼€å§‹ PyTorch æ­£å¼æ”¯æŒå¼ é‡æ¿ã€‚</p><p id="2e94" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">æˆ‘ä»¬è¿˜å¼•å…¥äº†å…¶ä»–ä¸€äº›å®ç”¨æ¨¡å—ï¼Œå¦‚<code class="fe ot ou ov nz b">time</code>ã€<code class="fe ot ou ov nz b">json</code>ã€<code class="fe ot ou ov nz b">pandas</code>ç­‰ã€‚</p></div><div class="ab cl mu mv hx mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="im in io ip iq"><h1 id="1703" class="nb nc it bd nd ne nf ng nh ni nj nk nl jz nm ka nn kc no kd np kf nq kg nr ns bi translated">èµ„æ–™ç»„</h1><p id="1aae" class="pw-post-body-paragraph ku kv it kw b kx nt ju kz la nu jx lc ld nv lf lg lh nw lj lk ll nx ln lo lp im bi translated"><code class="fe ot ou ov nz b">torchvision</code>å·²ç»æœ‰äº†æ—¶å°š MNIST æ•°æ®é›†ã€‚å¦‚æœä½ ä¸ç†Ÿæ‚‰æ—¶å°š MNIST æ•°æ®é›†:</p><blockquote class="pa pb pc"><p id="d5e5" class="ku kv ow kw b kx ky ju kz la lb jx lc pd le lf lg pe li lj lk pf lm ln lo lp im bi translated"><code class="fe ot ou ov nz b">Fashion-MNIST</code>æ˜¯ä¸€ä¸ªç”±<a class="ae lz" href="https://jobs.zalando.com/tech/" rel="noopener ugc nofollow" target="_blank"> Zalando </a>çš„æ–‡ç« å›¾åƒç»„æˆçš„æ•°æ®é›†ï¼Œç”± 60ï¼Œ000 ä¸ªç¤ºä¾‹çš„è®­ç»ƒé›†å’Œ 10ï¼Œ000 ä¸ªç¤ºä¾‹çš„æµ‹è¯•é›†ç»„æˆã€‚æ¯ä¸ªç¤ºä¾‹éƒ½æ˜¯ 28x28 ç°åº¦å›¾åƒï¼Œä¸ 10 ä¸ªç±»åˆ«çš„æ ‡ç­¾ç›¸å…³è”ã€‚æˆ‘ä»¬æ‰“ç®—å°†<code class="fe ot ou ov nz b">Fashion-MNIST</code>ä½œä¸ºåŸå§‹<a class="ae lz" href="http://yann.lecun.com/exdb/mnist/" rel="noopener ugc nofollow" target="_blank"> MNIST æ•°æ®é›†</a>çš„ç›´æ¥æ›¿ä»£ï¼Œç”¨äºæœºå™¨å­¦ä¹ ç®—æ³•çš„åŸºå‡†æµ‹è¯•ã€‚å®ƒå…±äº«è®­ç»ƒå’Œæµ‹è¯•åˆ†å‰²çš„ç›¸åŒå›¾åƒå¤§å°å’Œç»“æ„ã€‚â€” <a class="ae lz" href="https://github.com/zalandoresearch/fashion-mnist" rel="noopener ugc nofollow" target="_blank">æ¥è‡ª Github </a></p></blockquote><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pg"><img src="../Images/5b2eb440c08f4773c113766533f98674.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RCXpLibVCgoRYckEd2kU8Q.png"/></div></div><figcaption class="mb mc gj gh gi md me bd b be z dk">Fashion MNIST Dataset â€” <a class="ae lz" href="https://github.com/zalandoresearch/fashion-mnist" rel="noopener ugc nofollow" target="_blank">From GitHub</a></figcaption></figure><pre class="kj kk kl km gt ny nz oa ob aw oc bi"><span id="b418" class="od nc it nz b gy oe of l og oh"># Use standard FashionMNIST dataset<br/>train_set = torchvision.datasets.FashionMNIST(<br/>    root = './data/FashionMNIST',<br/>    train = True,<br/>    download = True,<br/>    transform = transforms.Compose([<br/>        transforms.ToTensor()                                 <br/>    ])<br/>)</span></pre><p id="2cc1" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">è¿™ä¸ªä¸éœ€è¦è¿‡å¤šè§£é‡Šã€‚æˆ‘ä»¬æŒ‡å®šæ ¹ç›®å½•æ¥å­˜å‚¨æ•°æ®é›†ï¼ŒæŠ“å–è®­ç»ƒæ•°æ®ï¼Œå¦‚æœæœ¬åœ°æœºå™¨ä¸Šæ²¡æœ‰ï¼Œå…è®¸ä¸‹è½½å®ƒï¼Œç„¶ååº”ç”¨<code class="fe ot ou ov nz b">transforms.ToTensor</code>å°†å›¾åƒè½¬æ¢æˆ<strong class="kw iu">å¼ é‡</strong>ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥åœ¨æˆ‘ä»¬çš„ç½‘ç»œä¸­ç›´æ¥ä½¿ç”¨å®ƒã€‚æ•°æ®é›†å­˜å‚¨åœ¨åä¸º<code class="fe ot ou ov nz b">train_set.</code>çš„<code class="fe ot ou ov nz b">dataset</code>ç±»ä¸­</p></div><div class="ab cl mu mv hx mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="im in io ip iq"><h1 id="3a1f" class="nb nc it bd nd ne nf ng nh ni nj nk nl jz nm ka nn kc no kd np kf nq kg nr ns bi translated">ç½‘ç»œ</h1><p id="f784" class="pw-post-body-paragraph ku kv it kw b kx nt ju kz la nu jx lc ld nv lf lg lh nw lj lk ll nx ln lo lp im bi lq translated">åœ¨ PyTorch ä¸­æ„å»ºå®é™…çš„ç¥ç»ç½‘ç»œæ—¢æœ‰è¶£åˆç®€å•ã€‚æˆ‘å‡è®¾ä½ å¯¹å·ç§¯ç¥ç»ç½‘ç»œçš„å·¥ä½œåŸç†æœ‰ä¸€äº›åŸºæœ¬çš„æ¦‚å¿µã€‚å¦‚æœæ²¡æœ‰ï¼Œå¯ä»¥å‚è€ƒ deeplizard çš„è¿™ä¸ªè§†é¢‘:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ph pi l"/></div></figure><p id="eff8" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">æ—¶å°š MNIST åªæœ‰ 28x28 px å¤§å°ï¼Œæ‰€ä»¥æˆ‘ä»¬å®é™…ä¸Šä¸éœ€è¦éå¸¸å¤æ‚çš„ç½‘ç»œã€‚æˆ‘ä»¬å¯ä»¥åƒè¿™æ ·å»ºç«‹ä¸€ä¸ªç®€å•çš„ CNN:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pj"><img src="../Images/948c7a17db8d399075d43517bbeefcbc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PceBlGfN_G7xyIkAfI7BuA.png"/></div></div></figure><p id="2526" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">æˆ‘ä»¬æœ‰ä¸¤ä¸ªå·ç§¯å±‚ï¼Œæ¯ä¸ªå·ç§¯å±‚æœ‰ 5x5 ä¸ªå†…æ ¸ã€‚åœ¨æ¯ä¸ªå·ç§¯å±‚ä¹‹åï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªè·¨åº¦ä¸º 2 çš„æœ€å¤§æ± å±‚ã€‚è¿™å…è®¸æˆ‘ä»¬ä»å›¾åƒä¸­æå–å¿…è¦çš„ç‰¹å¾ã€‚ç„¶åæˆ‘ä»¬å±•å¹³å¼ é‡ï¼Œå°†å®ƒä»¬æ”¾å…¥å¯†é›†å±‚ï¼Œé€šè¿‡å¤šå±‚æ„ŸçŸ¥å™¨(MLP)æ¥æ‰§è¡Œæˆ‘ä»¬çš„ 10 ä¸ªç±»åˆ«çš„åˆ†ç±»ä»»åŠ¡ã€‚</p><p id="8d87" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">ç°åœ¨æˆ‘ä»¬å·²ç»æ¸…æ¥šäº†ç½‘ç»œçš„ç»“æ„ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•ä½¿ç”¨ PyTorch æ¥æ„å»ºå®ƒ:</p><pre class="kj kk kl km gt ny nz oa ob aw oc bi"><span id="552d" class="od nc it nz b gy oe of l og oh"># Build the neural network, expand on top of nn.Module<br/>class Network(nn.Module):<br/>  def __init__(self):<br/>    super().__init__()<br/><br/>    # define layers<br/>    self.conv1 = nn.Conv2d(in_channels=1, out_channels=6, kernel_size=5)<br/>    self.conv2 = nn.Conv2d(in_channels=6, out_channels=12, kernel_size=5)<br/><br/>    self.fc1 = nn.Linear(in_features=12*4*4, out_features=120)<br/>    self.fc2 = nn.Linear(in_features=120, out_features=60)<br/>    self.out = nn.Linear(in_features=60, out_features=10)<br/><br/>  # define forward function<br/>  def forward(self, t):<br/>    # conv 1<br/>    t = self.conv1(t)<br/>    t = F.relu(t)<br/>    t = F.max_pool2d(t, kernel_size=2, stride=2)<br/><br/>    # conv 2<br/>    t = self.conv2(t)<br/>    t = F.relu(t)<br/>    t = F.max_pool2d(t, kernel_size=2, stride=2)<br/><br/>    # fc1<br/>    t = t.reshape(-1, 12*4*4)<br/>    t = self.fc1(t)<br/>    t = F.relu(t)<br/><br/>    # fc2<br/>    t = self.fc2(t)<br/>    t = F.relu(t)<br/><br/>    # output<br/>    t = self.out(t)<br/>    # don't need softmax here since we'll use cross-entropy as activation.<br/><br/>    return t</span></pre><p id="f85c" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">é¦–å…ˆ PyTorch ä¸­æ‰€æœ‰çš„ç½‘ç»œç±»éƒ½æ˜¯åœ¨åŸºç±»ä¸Šæ‰©å±•çš„:<code class="fe ot ou ov nz b">nn.Module</code>ã€‚å®ƒåŒ…å«äº†æ‰€æœ‰çš„åŸºç¡€çŸ¥è¯†:<strong class="kw iu">æƒé‡ã€åå·®ã€æ­£å‘æ–¹æ³•</strong>ä»¥åŠä¸€äº›å®ç”¨å±æ€§å’Œæ–¹æ³•ï¼Œå¦‚<code class="fe ot ou ov nz b">.parameters()</code>å’Œ<code class="fe ot ou ov nz b">.zero_grad()</code>ï¼Œæˆ‘ä»¬ä¹Ÿå°†ä½¿ç”¨å®ƒä»¬ã€‚</p><p id="70f1" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">æˆ‘ä»¬çš„ç½‘ç»œç»“æ„åœ¨<code class="fe ot ou ov nz b">__init__</code> dunder å‡½æ•°ä¸­å®šä¹‰ã€‚</p><pre class="kj kk kl km gt ny nz oa ob aw oc bi"><span id="a889" class="od nc it nz b gy oe of l og oh">def __init__(self): <br/>  super().__init__() </span><span id="86c3" class="od nc it nz b gy pk of l og oh">  # define layers <br/>  self.conv1 = nn.Conv2d(in_channels=1, out_channels=6, kernel_size=5)<br/>  self.conv2 = nn.Conv2d(in_channels=6, out_channels=12, kernel_size=5)<br/>  self.fc1 = nn.Linear(in_features=12*4*4, out_features=120)<br/>  self.fc2 = nn.Linear(in_features=120, out_features=60)<br/>  self.out = nn.Linear(in_features=60, out_features=10)</span></pre><p id="2100" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><code class="fe ot ou ov nz b">nn.Conv2d</code>å’Œ<code class="fe ot ou ov nz b">nn.Linear</code>æ˜¯åœ¨<code class="fe ot ou ov nz b">torch.nn</code>æ¨¡å—ä¸­å®šä¹‰çš„ä¸¤ä¸ªæ ‡å‡† PyTorch å±‚ã€‚è¿™äº›éƒ½æ˜¯ä¸è¨€è‡ªæ˜çš„ã€‚éœ€è¦æ³¨æ„çš„ä¸€ç‚¹æ˜¯ï¼Œæˆ‘ä»¬åœ¨è¿™é‡Œåªå®šä¹‰äº†å®é™…çš„å±‚ã€‚æ¿€æ´»å’Œæœ€å¤§æ± åŒ–<strong class="kw iu">æ“ä½œ</strong>åŒ…å«åœ¨ä¸‹é¢è§£é‡Šçš„è½¬å‘åŠŸèƒ½ä¸­ã€‚</p><pre class="kj kk kl km gt ny nz oa ob aw oc bi"><span id="3d0d" class="od nc it nz b gy oe of l og oh"># define forward function  <br/>def forward(self, t):  <br/>  # conv 1  <br/>  t = self.conv1(t)  <br/>  t = F.relu(t)  <br/>  t = F.max_pool2d(t, kernel_size=2, stride=2)   </span><span id="fdcc" class="od nc it nz b gy pk of l og oh">  # conv 2  <br/>  t = self.conv2(t)   <br/>  t = F.relu(t)  <br/>  t = F.max_pool2d(t, kernel_size=2, stride=2)   </span><span id="f7ea" class="od nc it nz b gy pk of l og oh">  # fc1   <br/>  t = t.reshape(-1, 12*4*4)  <br/>  t = self.fc1(t)  <br/>  t = F.relu(t)   </span><span id="81a2" class="od nc it nz b gy pk of l og oh">  # fc2  <br/>  t = self.fc2(t)  <br/>  t = F.relu(t)  </span><span id="c46e" class="od nc it nz b gy pk of l og oh">  # output  <br/>  t = self.out(t)  </span><span id="e193" class="od nc it nz b gy pk of l og oh">  # don't need softmax here since we'll use cross-entropy as activation.   <br/>  return t</span></pre><p id="1dd0" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">ä¸€æ—¦å®šä¹‰äº†å±‚ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨å±‚æœ¬èº«æ¥è®¡ç®—æ¯ä¸€å±‚çš„è½¬å‘ç»“æœï¼ŒåŠ ä¸Šæ¿€æ´»å‡½æ•°(ReLu)å’Œæœ€å¤§æ± æ“ä½œï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆå®¹æ˜“åœ°ç¼–å†™æˆ‘ä»¬çš„ç½‘ç»œçš„è½¬å‘å‡½æ•°ï¼Œå¦‚ä¸Šæ‰€è¿°ã€‚æ³¨æ„ï¼Œåœ¨<code class="fe ot ou ov nz b">fc1</code>(å®Œå…¨è¿æ¥ç¬¬ 1 å±‚)ä¸Šï¼Œæˆ‘ä»¬ä½¿ç”¨ PyTorch çš„å¼ é‡è¿ç®—<code class="fe ot ou ov nz b">t.reshape</code>æ¥å±•å¹³å¼ é‡ï¼Œè¿™æ ·å®ƒå°±å¯ä»¥ä¼ é€’ç»™åé¢çš„è‡´å¯†å±‚ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬æ²¡æœ‰åœ¨è¾“å‡ºå±‚æ·»åŠ  softmax æ¿€æ´»å‡½æ•°ï¼Œå› ä¸º PyTorch çš„<strong class="kw iu"> CrossEntropy </strong>å‡½æ•°ä¼šä¸ºæˆ‘ä»¬å¤„ç†è¿™ä¸ªé—®é¢˜ã€‚</p></div><div class="ab cl mu mv hx mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="im in io ip iq"><h1 id="f212" class="nb nc it bd nd ne nf ng nh ni nj nk nl jz nm ka nn kc no kd np kf nq kg nr ns bi translated">è¶…å‚æ•°</h1><p id="62d0" class="pw-post-body-paragraph ku kv it kw b kx nt ju kz la nu jx lc ld nv lf lg lh nw lj lk ll nx ln lo lp im bi lq translated">é€šå¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥åªæ‰‹åŠ¨é€‰æ‹©ä¸€ç»„è¶…å‚æ•°ï¼Œå¹¶ç”¨å®ƒä»¬åšä¸€äº›å®éªŒã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬æƒ³é€šè¿‡å¼•å…¥ä¸€äº›ç»“æ„åŒ–æ¥åšæ›´å¤šçš„äº‹æƒ…ã€‚æˆ‘ä»¬å°†æ„å»ºä¸€ä¸ªç³»ç»Ÿæ¥ç”Ÿæˆä¸åŒçš„è¶…å‚æ•°ç»„åˆï¼Œå¹¶ä½¿ç”¨å®ƒä»¬æ¥æ‰§è¡Œè®­ç»ƒâ€œè¿è¡Œâ€ã€‚æ¯æ¬¡â€œè¿è¡Œâ€ä½¿ç”¨ä¸€ç»„è¶…å‚æ•°ç»„åˆã€‚å°†æ¯æ¬¡è·‘æ­¥çš„è®­ç»ƒæ•°æ®/ç»“æœå¯¼å‡ºåˆ° Tensor Boardï¼Œä»¥ä¾¿æˆ‘ä»¬å¯ä»¥ç›´æ¥æ¯”è¾ƒå¹¶æŸ¥çœ‹å“ªä¸ªè¶…å‚æ•°é›†è¡¨ç°æœ€ä½³ã€‚</p><p id="53a1" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">æˆ‘ä»¬å°†æ‰€æœ‰çš„è¶…å‚æ•°å­˜å‚¨åœ¨ä¸€ä¸ª<a class="ae lz" href="https://www.geeksforgeeks.org/ordereddict-in-python/" rel="noopener ugc nofollow" target="_blank"> <strong class="kw iu">æœ‰åºæŒ‡ä»¤</strong> </a>ä¸­:</p><pre class="kj kk kl km gt ny nz oa ob aw oc bi"><span id="2427" class="od nc it nz b gy oe of l og oh"># put all hyper params into a OrderedDict, easily expandable<br/>params = OrderedDict(<br/>    lr = [.01, .001],<br/>    batch_size = [100, 1000],<br/>    shuffle = [True, False]<br/>)<br/>epochs = 3</span></pre><p id="99f4" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><code class="fe ot ou ov nz b">lr</code>:å­¦ä¹ ç‡ã€‚æˆ‘ä»¬æƒ³ä¸ºæˆ‘ä»¬çš„æ¨¡å‹å°è¯• 0.01 å’Œ 0.001ã€‚</p><p id="04d5" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><code class="fe ot ou ov nz b">batch_size</code>:æ‰¹é‡ï¼ŒåŠ é€Ÿè®­ç»ƒè¿‡ç¨‹ã€‚æˆ‘ä»¬ä¼šç”¨ 100 å’Œ 1000ã€‚</p><p id="c7f6" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><code class="fe ot ou ov nz b">shuffle</code> : Shuffle toggleï¼Œæˆ‘ä»¬æ˜¯å¦åœ¨è®­ç»ƒå‰æ´—ç‰Œã€‚</p><p id="21c3" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">ä¸€æ—¦å‚æ•°ä¸‹é™ã€‚æˆ‘ä»¬ä½¿ç”¨ä¸¤ä¸ªåŠ©æ‰‹ç±»:<code class="fe ot ou ov nz b">RunBuilder</code>å’Œ<code class="fe ot ou ov nz b">RunManager</code>æ¥ç®¡ç†æˆ‘ä»¬çš„è¶…å‚æ•°å’Œè®­ç»ƒè¿‡ç¨‹ã€‚</p><h2 id="ed79" class="od nc it bd nd oi oj dn nh ok ol dp nl ld om on nn lh oo op np ll oq or nr os bi translated">è¿è¡Œç”Ÿæˆå™¨</h2><p id="b810" class="pw-post-body-paragraph ku kv it kw b kx nt ju kz la nu jx lc ld nv lf lg lh nw lj lk ll nx ln lo lp im bi translated">ç±»<code class="fe ot ou ov nz b">RunBuilder</code>çš„ä¸»è¦ç›®çš„æ˜¯æä¾›ä¸€ä¸ªé™æ€æ–¹æ³•<code class="fe ot ou ov nz b">get_runs</code>ã€‚å®ƒå°† OrderedDict(å…¶ä¸­å­˜å‚¨äº†æ‰€æœ‰è¶…å‚æ•°)ä½œä¸ºä¸€ä¸ªå‚æ•°ï¼Œå¹¶ç”Ÿæˆä¸€ä¸ªåä¸ºå…ƒç»„ <code class="fe ot ou ov nz b">Run</code>çš„<a class="ae lz" href="https://www.youtube.com/watch?v=GfxJYp9_nJA" rel="noopener ugc nofollow" target="_blank">ï¼Œæ¯ä¸ª<code class="fe ot ou ov nz b">run</code>å…ƒç´ ä»£è¡¨è¶…å‚æ•°çš„ä¸€ç§å¯èƒ½ç»„åˆã€‚è¿™ä¸ªå‘½åå…ƒç»„ç¨åç”±è®­ç»ƒå¾ªç¯ä½¿ç”¨ã€‚ä»£ç å¾ˆå®¹æ˜“ç†è§£ã€‚</a></p><pre class="kj kk kl km gt ny nz oa ob aw oc bi"><span id="6d7d" class="od nc it nz b gy oe of l og oh"># import modules to build RunBuilder and RunManager helper classes<br/>from collections  import OrderedDict<br/>from collections import namedtuple<br/>from itertools import product<br/><br/># Read in the hyper-parameters and return a Run namedtuple containing all the <br/># combinations of hyper-parameters<br/>class RunBuilder():<br/>  @staticmethod<br/>  def get_runs(params):<br/><br/>    Run = namedtuple('Run', params.keys())<br/><br/>    runs = []<br/>    for v in product(*params.values()):<br/>      runs.append(Run(*v))<br/>    <br/>    return runs</span></pre><h2 id="06a3" class="od nc it bd nd oi oj dn nh ok ol dp nl ld om on nn lh oo op np ll oq or nr os bi translated">è¿è¡Œç®¡ç†å™¨</h2><p id="d472" class="pw-post-body-paragraph ku kv it kw b kx nt ju kz la nu jx lc ld nv lf lg lh nw lj lk ll nx ln lo lp im bi translated"><code class="fe ot ou ov nz b">RunManager </code>ç±»æœ‰å››ä¸ªä¸»è¦ç›®çš„ã€‚</p><ol class=""><li id="8249" class="pl pm it kw b kx ky la lb ld pn lh po ll pp lp pq pr ps pt bi translated">è®¡ç®—å¹¶è®°å½•æ¯ä¸ªæ—¶æœŸå’Œè¿è¡Œçš„æŒç»­æ—¶é—´ã€‚</li><li id="07e3" class="pl pm it kw b kx pu la pv ld pw lh px ll py lp pq pr ps pt bi translated">è®¡ç®—æ¯ä¸ªå†å…ƒå’Œè¿è¡Œçš„è®­ç»ƒæŸå¤±å’Œå‡†ç¡®åº¦ã€‚</li><li id="94f1" class="pl pm it kw b kx pu la pv ld pw lh px ll py lp pq pr ps pt bi translated">è®°å½•è®­ç»ƒæ•°æ®(å¦‚æŸè€—ã€å‡†ç¡®åº¦ã€é‡é‡ã€æ¢¯åº¦ã€è®¡ç®—å›¾ç­‰)ã€‚)å¹¶è¿è¡Œï¼Œç„¶åå°†å®ƒä»¬å¯¼å‡ºåˆ°å¼ é‡æ¿ä»¥ä¾›è¿›ä¸€æ­¥åˆ†æã€‚</li><li id="d7f4" class="pl pm it kw b kx pu la pv ld pw lh px ll py lp pq pr ps pt bi translated">å°†æ‰€æœ‰è®­ç»ƒç»“æœä¿å­˜åœ¨<code class="fe ot ou ov nz b">csv</code>å’Œ<code class="fe ot ou ov nz b">json</code>ä¸­ï¼Œä»¥å¤‡å°†æ¥å‚è€ƒæˆ–æå– APIã€‚</li></ol><p id="2fd0" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">å¦‚ä½ æ‰€è§ï¼Œå®ƒå¸®åŠ©æˆ‘ä»¬å¤„ç†åå‹¤å·¥ä½œï¼Œè¿™å¯¹æˆ‘ä»¬æˆåŠŸè®­ç»ƒæ¨¡å‹ä¹Ÿå¾ˆé‡è¦ã€‚è®©æˆ‘ä»¬çœ‹çœ‹ä»£ç ã€‚è¿™æœ‰ç‚¹é•¿ï¼Œè¯·åŸè°…:</p><pre class="kj kk kl km gt ny nz oa ob aw oc bi"><span id="c773" class="od nc it nz b gy oe of l og oh"># Helper class, help track loss, accuracy, epoch time, run time, <br/># hyper-parameters etc. Also record to TensorBoard and write into csv, json<br/>class RunManager():<br/>  def __init__(self):<br/><br/>    # tracking every epoch count, loss, accuracy, time<br/>    self.epoch_count = 0<br/>    self.epoch_loss = 0<br/>    self.epoch_num_correct = 0<br/>    self.epoch_start_time = None<br/><br/>    # tracking every run count, run data, hyper-params used, time<br/>    self.run_params = None<br/>    self.run_count = 0<br/>    self.run_data = []<br/>    self.run_start_time = None<br/><br/>    # record model, loader and TensorBoard <br/>    self.network = None<br/>    self.loader = None<br/>    self.tb = None<br/><br/>  # record the count, hyper-param, model, loader of each run<br/>  # record sample images and network graph to TensorBoard  <br/>  def begin_run(self, run, network, loader):<br/><br/>    self.run_start_time = time.time()<br/><br/>    self.run_params = run<br/>    self.run_count += 1<br/><br/>    self.network = network<br/>    self.loader = loader<br/>    self.tb = SummaryWriter(comment=f'-{run}')<br/><br/>    images, labels = next(iter(self.loader))<br/>    grid = torchvision.utils.make_grid(images)<br/><br/>    self.tb.add_image('images', grid)<br/>    self.tb.add_graph(self.network, images)<br/><br/>  # when run ends, close TensorBoard, zero epoch count<br/>  def end_run(self):<br/>    self.tb.close()<br/>    self.epoch_count = 0<br/><br/>  # zero epoch count, loss, accuracy, <br/>  def begin_epoch(self):<br/>    self.epoch_start_time = time.time()<br/><br/>    self.epoch_count += 1<br/>    self.epoch_loss = 0<br/>    self.epoch_num_correct = 0<br/><br/>  # <br/>  def end_epoch(self):<br/>    # calculate epoch duration and run duration(accumulate)<br/>    epoch_duration = time.time() - self.epoch_start_time<br/>    run_duration = time.time() - self.run_start_time<br/><br/>    # record epoch loss and accuracy<br/>    loss = self.epoch_loss / len(self.loader.dataset)<br/>    accuracy = self.epoch_num_correct / len(self.loader.dataset)<br/><br/>    # Record epoch loss and accuracy to TensorBoard <br/>    self.tb.add_scalar('Loss', loss, self.epoch_count)<br/>    self.tb.add_scalar('Accuracy', accuracy, self.epoch_count)<br/><br/>    # Record params to TensorBoard<br/>    for name, param in self.network.named_parameters():<br/>      self.tb.add_histogram(name, param, self.epoch_count)<br/>      self.tb.add_histogram(f'{name}.grad', param.grad, self.epoch_count)<br/>    <br/>    # Write into 'results' (OrderedDict) for all run related data<br/>    results = OrderedDict()<br/>    results["run"] = self.run_count<br/>    results["epoch"] = self.epoch_count<br/>    results["loss"] = loss<br/>    results["accuracy"] = accuracy<br/>    results["epoch duration"] = epoch_duration<br/>    results["run duration"] = run_duration<br/><br/>    # Record hyper-params into 'results'<br/>    for k,v in self.run_params._asdict().items(): results[k] = v<br/>    self.run_data.append(results)<br/>    df = pd.DataFrame.from_dict(self.run_data, orient = 'columns')<br/><br/>    # display epoch information and show progress<br/>    clear_output(wait=True)<br/>    display(df)<br/><br/>  # accumulate loss of batch into entire epoch loss<br/>  def track_loss(self, loss):<br/>    # multiply batch size so variety of batch sizes can be compared<br/>    self.epoch_loss += loss.item() * self.loader.batch_size<br/><br/>  # accumulate number of corrects of batch into entire epoch num_correct<br/>  def track_num_correct(self, preds, labels):<br/>    self.epoch_num_correct += self._get_num_correct(preds, labels)<br/><br/>  @torch.no_grad()<br/>  def _get_num_correct(self, preds, labels):<br/>    return preds.argmax(dim=1).eq(labels).sum().item()<br/>  <br/>  # save end results of all runs into csv, json for further analysis<br/>  def save(self, fileName):<br/><br/>    pd.DataFrame.from_dict(<br/>        self.run_data, <br/>        orient = 'columns',<br/>    ).to_csv(f'{fileName}.csv')<br/><br/>    with open(f'{fileName}.json', 'w', encoding='utf-8') as f:<br/>      json.dump(self.run_data, f, ensure_ascii=False, indent=4)</span></pre><p id="24ad" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><code class="fe ot ou ov nz b"><strong class="kw iu">__init__</strong></code>:åˆå§‹åŒ–å¿…è¦çš„å±æ€§ï¼Œå¦‚è®¡æ•°ã€ä¸¢å¤±ã€æ­£ç¡®é¢„æµ‹æ•°ã€å¼€å§‹æ—¶é—´ç­‰ã€‚</p><p id="c2fb" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><code class="fe ot ou ov nz b"><strong class="kw iu">begin_run</strong></code>:è®°å½•è¿è¡Œå¼€å§‹æ—¶é—´ï¼Œä»¥ä¾¿å½“è¿è¡Œç»“æŸæ—¶ï¼Œå¯ä»¥è®¡ç®—è¿è¡Œçš„æŒç»­æ—¶é—´ã€‚åˆ›å»ºä¸€ä¸ª<code class="fe ot ou ov nz b">SummaryWriter</code>å¯¹è±¡æ¥å­˜å‚¨æˆ‘ä»¬åœ¨è¿è¡Œè¿‡ç¨‹ä¸­æƒ³è¦å¯¼å‡ºåˆ°å¼ é‡æ¿çš„æ‰€æœ‰å†…å®¹ã€‚å°†ç½‘ç»œå›¾å’Œæ ·æœ¬å›¾åƒå†™å…¥<code class="fe ot ou ov nz b">SummaryWriter</code>å¯¹è±¡ã€‚</p><p id="b04c" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><code class="fe ot ou ov nz b"><strong class="kw iu">end_run</strong></code>:è¿è¡Œå®Œæˆåï¼Œå…³é—­ SummaryWriter å¯¹è±¡ï¼Œå¹¶å°†å†å…ƒè®¡æ•°é‡ç½®ä¸º 0(å‡†å¤‡ä¸‹ä¸€æ¬¡è¿è¡Œ)ã€‚</p><p id="94a1" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><code class="fe ot ou ov nz b"><strong class="kw iu">begin_epoch</strong></code>:è®°å½•å†å…ƒå¼€å§‹æ—¶é—´ï¼Œä»¥ä¾¿åœ¨å†å…ƒç»“æŸæ—¶è®¡ç®—å†å…ƒæŒç»­æ—¶é—´ã€‚å¤ä½<code class="fe ot ou ov nz b">epoch_loss</code>å’Œ<code class="fe ot ou ov nz b">epoch_num_correct</code>ã€‚</p><p id="7375" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">è¿™ä¸ªå‡½æ•°æ˜¯å¤§å¤šæ•°äº‹æƒ…å‘ç”Ÿçš„åœ°æ–¹ã€‚å½“ä¸€ä¸ªæ—¶æœŸç»“æŸæ—¶ï¼Œæˆ‘ä»¬å°†è®¡ç®—æ—¶æœŸæŒç»­æ—¶é—´å’Œè¿è¡ŒæŒç»­æ—¶é—´(ç›´åˆ°è¿™ä¸ªæ—¶æœŸï¼Œè€Œä¸æ˜¯æœ€åçš„è¿è¡ŒæŒç»­æ—¶é—´ï¼Œé™¤éæ˜¯è¿è¡Œçš„æœ€åä¸€ä¸ªæ—¶æœŸ)ã€‚æˆ‘ä»¬å°†è®¡ç®—è¿™ä¸ªæ—¶æœŸçš„æ€»æŸè€—å’Œç²¾ç¡®åº¦ï¼Œç„¶åå°†æŸè€—ã€ç²¾ç¡®åº¦ã€æƒé‡/åå·®ã€æ¢¯åº¦å¯¼å‡ºåˆ°å¼ é‡æ¿ä¸­ã€‚ä¸ºäº†ä¾¿äºåœ¨ Jupyter ç¬”è®°æœ¬ä¸­è·Ÿè¸ªï¼Œæˆ‘ä»¬è¿˜åˆ›å»ºäº†ä¸€ä¸ª<strong class="kw iu"> OrderedDict </strong>å¯¹è±¡<code class="fe ot ou ov nz b">results</code>ï¼Œå¹¶å°†æˆ‘ä»¬æ‰€æœ‰çš„è¿è¡Œæ•°æ®(æŸå¤±ã€å‡†ç¡®åº¦ã€è¿è¡Œè®¡æ•°ã€å†å…ƒè®¡æ•°ã€è¿è¡ŒæŒç»­æ—¶é—´ã€å†å…ƒæŒç»­æ—¶é—´ã€æ‰€æœ‰è¶…å‚æ•°)æ”¾å…¥å…¶ä¸­ã€‚ç„¶åæˆ‘ä»¬å°†ä½¿ç”¨<strong class="kw iu">ç†ŠçŒ«</strong>æ¥è¯»å–å®ƒï¼Œå¹¶ä»¥æ•´æ´çš„è¡¨æ ¼æ ¼å¼æ˜¾ç¤ºå‡ºæ¥ã€‚</p><p id="5496" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><code class="fe ot ou ov nz b"><strong class="kw iu">track_loss</strong></code> <strong class="kw iu">ã€</strong> <code class="fe ot ou ov nz b"><strong class="kw iu">track_num_correct</strong></code> <strong class="kw iu">ã€</strong> <code class="fe ot ou ov nz b"><strong class="kw iu">_get_num_correct</strong></code>:è¿™äº›æ˜¯ç´¯è®¡æŸå¤±çš„æ•ˆç”¨å‡½æ•°ï¼Œæ¯æ‰¹çš„æ­£ç¡®é¢„æµ‹æ•°ï¼Œä»¥ä¾¿ä»¥åè®¡ç®—å†å…ƒæŸå¤±å’Œç²¾åº¦ã€‚</p><p id="6952" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><code class="fe ot ou ov nz b"><strong class="kw iu">save</strong></code>:å°†æ‰€æœ‰è¿è¡Œæ•°æ®(æ‰€æœ‰è¿è¡Œçš„<code class="fe ot ou ov nz b">results</code> <strong class="kw iu"> OrderedDict </strong>å¯¹è±¡åˆ—è¡¨)ä¿å­˜ä¸º<code class="fe ot ou ov nz b">csv</code>å’Œ<code class="fe ot ou ov nz b">json</code>æ ¼å¼ï¼Œä»¥ä¾¿è¿›ä¸€æ­¥åˆ†ææˆ– API è®¿é—®ã€‚</p><p id="ec0e" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">è¿™é—¨è¯¾æœ‰å¾ˆå¤šä¸œè¥¿è¦å­¦ã€‚æ­å–œä½ èµ°åˆ°è¿™ä¸€æ­¥ï¼æœ€å›°éš¾çš„éƒ¨åˆ†å·²ç»è¿‡å»äº†ã€‚ä»ç°åœ¨å¼€å§‹ï¼Œä¸€åˆ‡éƒ½ä¼šå˜å¾—æœ‰æ„ä¹‰ã€‚</p></div><div class="ab cl mu mv hx mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="im in io ip iq"><h1 id="fe58" class="nb nc it bd nd ne nf ng nh ni nj nk nl jz nm ka nn kc no kd np kf nq kg nr ns bi translated">åŸ¹å…»</h1><p id="6093" class="pw-post-body-paragraph ku kv it kw b kx nt ju kz la nu jx lc ld nv lf lg lh nw lj lk ll nx ln lo lp im bi lq translated">ç»ˆäºï¼Œæˆ‘ä»¬å‡†å¤‡å¥½è¿›è¡Œä¸€äº›è®­ç»ƒäº†ï¼åœ¨æˆ‘ä»¬çš„<code class="fe ot ou ov nz b">RunBuilder </code>å’Œ<code class="fe ot ou ov nz b">RunManager</code>è¯¾ç¨‹çš„å¸®åŠ©ä¸‹ï¼ŒåŸ¹è®­è¿‡ç¨‹å˜å¾—è½»è€Œæ˜“ä¸¾:</p><pre class="kj kk kl km gt ny nz oa ob aw oc bi"><span id="42d3" class="od nc it nz b gy oe of l og oh">m = RunManager()<br/><br/># get all runs from params using RunBuilder class<br/>for run in RunBuilder.get_runs(params):<br/><br/>    # if params changes, following line of code should reflect the changes too<br/>    network = Network()<br/>    loader = torch.utils.data.DataLoader(train_set, batch_size = run.batch_size)<br/>    optimizer = optim.Adam(network.parameters(), lr=run.lr)<br/><br/>    m.begin_run(run, network, loader)<br/>    for epoch in range(epochs):<br/>      <br/>      m.begin_epoch()<br/>      for batch in loader:<br/>        <br/>        images = batch[0]<br/>        labels = batch[1]<br/>        preds = network(images)<br/>        loss = F.cross_entropy(preds, labels)<br/><br/>        optimizer.zero_grad()<br/>        loss.backward()<br/>        optimizer.step()<br/><br/>        m.track_loss(loss)<br/>        m.track_num_correct(preds, labels)<br/><br/>      m.end_epoch()<br/>    m.end_run()<br/><br/># when all runs are done, save results to files<br/>m.save('results')</span></pre><p id="6743" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">é¦–å…ˆï¼Œæˆ‘ä»¬ä½¿ç”¨<code class="fe ot ou ov nz b">RunBuilder</code>åˆ›å»ºè¶…å‚æ•°çš„è¿­ä»£å™¨ï¼Œç„¶åéå†æ¯ä¸ªè¶…å‚æ•°ç»„åˆæ¥æ‰§è¡Œæˆ‘ä»¬çš„è®­ç»ƒ:</p><pre class="kj kk kl km gt ny nz oa ob aw oc bi"><span id="bbb0" class="od nc it nz b gy oe of l og oh">for run in RunBuilder.get_runs(params):</span></pre><p id="3677" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">ç„¶åï¼Œæˆ‘ä»¬ä»ä¸Šé¢å®šä¹‰çš„<code class="fe ot ou ov nz b">Network</code>ç±»åˆ›å»ºæˆ‘ä»¬çš„<code class="fe ot ou ov nz b">network</code>å¯¹è±¡ã€‚<code class="fe ot ou ov nz b">network = Network()</code>ã€‚è¿™ä¸ª<code class="fe ot ou ov nz b">network</code>ç‰©ä½“æ‰¿è½½äº†æˆ‘ä»¬éœ€è¦è®­ç»ƒçš„æ‰€æœ‰é‡é‡/åå·®ã€‚</p><p id="412d" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">æˆ‘ä»¬è¿˜éœ€è¦åˆ›å»ºä¸€ä¸ª<code class="fe ot ou ov nz b">DataLoader </code>å¯¹è±¡ã€‚å®ƒæ˜¯ä¸€ä¸ª PyTorch ç±»ï¼Œä¿å­˜æˆ‘ä»¬çš„è®­ç»ƒ/éªŒè¯/æµ‹è¯•æ•°æ®é›†ï¼Œå®ƒå°†éå†æ•°æ®é›†ï¼Œå¹¶æŒ‰æŒ‡å®šçš„<code class="fe ot ou ov nz b">batch_size</code>æ‰¹é‡ç»™æˆ‘ä»¬è®­ç»ƒæ•°æ®ã€‚</p><pre class="kj kk kl km gt ny nz oa ob aw oc bi"><span id="d28b" class="od nc it nz b gy oe of l og oh">loader = torch.utils.data.DataLoader(train_set, batch_size = run.batch_size)</span></pre><p id="e236" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">ä¹‹åï¼Œæˆ‘ä»¬å°†ä½¿ç”¨<code class="fe ot ou ov nz b">torch.optim</code>ç±»åˆ›å»ºä¸€ä¸ªä¼˜åŒ–å™¨ã€‚<code class="fe ot ou ov nz b">optim</code>ç±»è·å–ç½‘ç»œå‚æ•°å’Œå­¦ä¹ ç‡ä½œä¸ºè¾“å…¥ï¼Œå°†å¸®åŠ©æˆ‘ä»¬é€æ­¥å®Œæˆè®­ç»ƒè¿‡ç¨‹å¹¶æ›´æ–°æ¢¯åº¦ç­‰ã€‚æˆ‘ä»¬å°†ä½¿ç”¨ Adam ä½œä¸ºä¼˜åŒ–ç®—æ³•ã€‚</p><pre class="kj kk kl km gt ny nz oa ob aw oc bi"><span id="31f2" class="od nc it nz b gy oe of l og oh">optimizer = optim.Adam(network.parameters(), lr=run.lr)</span></pre><p id="f156" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">å¥½çš„ã€‚ç°åœ¨æˆ‘ä»¬å·²ç»åˆ›å»ºäº†ç½‘ç»œï¼Œå‡†å¤‡å¥½äº†æ•°æ®åŠ è½½å™¨ï¼Œé€‰æ‹©äº†ä¼˜åŒ–å™¨ã€‚è®©æˆ‘ä»¬å¼€å§‹è®­ç»ƒå§ï¼</p><p id="0989" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">æˆ‘ä»¬å°†éå†æ‰€æœ‰æˆ‘ä»¬æƒ³è¦è®­ç»ƒçš„çºªå…ƒ(è¿™é‡Œæ˜¯ 3 ä¸ª),æ‰€ä»¥æˆ‘ä»¬å°†æ‰€æœ‰ä¸œè¥¿éƒ½æ”¾åœ¨ä¸€ä¸ªâ€œçºªå…ƒâ€å¾ªç¯ä¸­ã€‚æˆ‘ä»¬è¿˜ä½¿ç”¨æˆ‘ä»¬çš„<code class="fe ot ou ov nz b">RunManager</code>ç±»çš„<code class="fe ot ou ov nz b">begin_run</code>æ–¹æ³•æ¥å¼€å§‹è·Ÿè¸ªè·‘æ­¥è®­ç»ƒæ•°æ®ã€‚</p><pre class="kj kk kl km gt ny nz oa ob aw oc bi"><span id="396d" class="od nc it nz b gy oe of l og oh">m.begin_run(run, network, loader)    <br/>for epoch in range(epochs):</span></pre><p id="9220" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">å¯¹äºæ¯ä¸ªæ—¶æœŸï¼Œæˆ‘ä»¬å°†éå†æ¯æ‰¹å›¾åƒæ¥è¿›è¡Œè®­ç»ƒã€‚</p><pre class="kj kk kl km gt ny nz oa ob aw oc bi"><span id="f239" class="od nc it nz b gy oe of l og oh">m.begin_epoch()    <br/>for batch in loader:              <br/>  images = batch[0]      <br/>  labels = batch[1]      <br/>  preds = network(images)      <br/>  loss = F.cross_entropy(preds, labels)<br/>         <br/>  optimizer.zero_grad()  <br/>  loss.backward()      <br/>  optimizer.step()<br/>      <br/>  m.track_loss(loss)      <br/>  m.track_num_correct(preds, labels)</span></pre><p id="5e33" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">ä¸Šé¢çš„ä»£ç æ˜¯çœŸæ­£çš„è®­ç»ƒå‘ç”Ÿçš„åœ°æ–¹ã€‚æˆ‘ä»¬ä»æ‰¹å¤„ç†ä¸­è¯»å…¥å›¾åƒå’Œæ ‡ç­¾ï¼Œä½¿ç”¨<code class="fe ot ou ov nz b">network</code>ç±»è¿›è¡Œå‰å‘ä¼ æ’­(è¿˜è®°å¾—ä¸Šé¢çš„<code class="fe ot ou ov nz b">forward</code>æ–¹æ³•å—ï¼Ÿ)å¹¶å¾—åˆ°é¢„æµ‹ã€‚é€šè¿‡é¢„æµ‹ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code class="fe ot ou ov nz b">cross_entropy</code>å‡½æ•°è®¡ç®—è¯¥æ‰¹æ¬¡çš„æŸå¤±ã€‚ä¸€æ—¦è®¡ç®—å‡ºæŸå¤±ï¼Œæˆ‘ä»¬ç”¨<code class="fe ot ou ov nz b">.zero_grad()</code>é‡ç½®æ¢¯åº¦(å¦åˆ™ PyTorch ä¼šç´¯ç§¯æ¢¯åº¦ï¼Œè¿™ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„)ï¼Œä½¿ç”¨<code class="fe ot ou ov nz b">loss.backward()</code>æ–¹æ³•è¿›è¡Œä¸€æ¬¡åå‘ä¼ æ’­ï¼Œä»¥è®¡ç®—æƒé‡/åå·®çš„æ‰€æœ‰æ¢¯åº¦ã€‚ç„¶åï¼Œæˆ‘ä»¬ä½¿ç”¨ä¸Šé¢å®šä¹‰çš„ä¼˜åŒ–å™¨æ¥æ›´æ–°æƒé‡/åå·®ã€‚ç°åœ¨ç½‘ç»œå·²ç»ä¸ºå½“å‰æ‰¹æ¬¡æ›´æ–°ï¼Œæˆ‘ä»¬å°†è®¡ç®—æ­£ç¡®é¢„æµ‹çš„æŸå¤±å’Œæ•°é‡ï¼Œå¹¶ä½¿ç”¨æˆ‘ä»¬çš„<code class="fe ot ou ov nz b">RunManager</code>ç±»çš„<code class="fe ot ou ov nz b">track_loss</code>å’Œ<code class="fe ot ou ov nz b">track_num_correct</code>æ–¹æ³•ç´¯ç§¯/è·Ÿè¸ªå®ƒä»¬ã€‚</p><p id="7f50" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">ä¸€æ—¦å…¨éƒ¨å®Œæˆï¼Œæˆ‘ä»¬å°†ä½¿ç”¨<code class="fe ot ou ov nz b">m.save('results')</code>å°†ç»“æœä¿å­˜åœ¨æ–‡ä»¶ä¸­ã€‚</p><p id="d848" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">ç¬”è®°æœ¬ä¸­è¿è¡Œçš„è¾“å‡ºå¦‚ä¸‹æ‰€ç¤º:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pz"><img src="../Images/20a7dba510027e44f8a02993d059b2be.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qgEb42V3ubSA9P8BKryv2w.png"/></div></div></figure></div><div class="ab cl mu mv hx mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="im in io ip iq"><h1 id="4779" class="nb nc it bd nd ne nf ng nh ni nj nk nl jz nm ka nn kc no kd np kf nq kg nr ns bi translated">å¼ é‡æ¿</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi qa"><img src="../Images/b670ba8b9acdf3c9b98659c116f6f755.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*dOWdO9wmi8tNgjKF.gif"/></div></div><figcaption class="mb mc gj gh gi md me bd b be z dk">Image from Tensorboard.org</figcaption></figure><p id="3030" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi lq translated">ä¼ æ„Ÿå™¨æ¿æ˜¯ä¸€ä¸ª TensorFlow å¯è§†åŒ–å·¥å…·ï¼Œç°åœ¨ PyTorch ä¹Ÿæ”¯æŒå®ƒã€‚æˆ‘ä»¬å·²ç»åŠªåŠ›å°†æ‰€æœ‰å†…å®¹è¾“å‡ºåˆ°ã€‚/runs 'æ–‡ä»¶å¤¹ï¼ŒTensor Board å°†åœ¨å…¶ä¸­æŸ¥æ‰¾è¦ä½¿ç”¨çš„è®°å½•ã€‚æˆ‘ä»¬ç°åœ¨éœ€è¦åšçš„åªæ˜¯å¯åŠ¨å¼ é‡æ¿å¹¶è¿›è¡Œæ£€æŸ¥ã€‚ç”±äºæˆ‘åœ¨ Google Colab ä¸Šè¿è¡Œè¿™ä¸ªæ¨¡å‹ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ä¸€ä¸ªåä¸º<code class="fe ot ou ov nz b">ngrok</code>çš„æœåŠ¡æ¥ä»£ç†å’Œè®¿é—®æˆ‘ä»¬åœ¨ Colab è™šæ‹Ÿæœºä¸Šè¿è¡Œçš„å¼ é‡æ¿ã€‚å…ˆå®‰è£…<code class="fe ot ou ov nz b">ngrok </code>:</p><pre class="kj kk kl km gt ny nz oa ob aw oc bi"><span id="2d96" class="od nc it nz b gy oe of l og oh">!wget https://bin.equinox.io/c/4VmDzA7iaHb/ngrok-stable-linux-amd64.zip</span><span id="9519" class="od nc it nz b gy pk of l og oh">!unzip ngrok-stable-linux-amd64.zip</span></pre><p id="ab19" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">ç„¶åï¼ŒæŒ‡å®šæˆ‘ä»¬è¦ä»ä¸­è¿è¡Œå¼ é‡æ¿çš„æ–‡ä»¶å¤¹ï¼Œå¹¶å¯åŠ¨å¼ é‡æ¿ web ç•Œé¢ã€‚/runs æ˜¯é»˜è®¤å€¼):</p><pre class="kj kk kl km gt ny nz oa ob aw oc bi"><span id="181a" class="od nc it nz b gy oe of l og oh">LOG_DIR = './runs'</span><span id="2dfa" class="od nc it nz b gy pk of l og oh">get_ipython().system_raw(</span><span id="f7e6" class="od nc it nz b gy pk of l og oh">'tensorboard --logdir {} --host 0.0.0.0 --port 6006 &amp;'</span><span id="c228" class="od nc it nz b gy pk of l og oh">.format(LOG_DIR)</span><span id="a756" class="od nc it nz b gy pk of l og oh">)</span></pre><p id="c5bd" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">å¯åŠ¨<code class="fe ot ou ov nz b">ngrok</code>ä»£ç†:</p><pre class="kj kk kl km gt ny nz oa ob aw oc bi"><span id="8468" class="od nc it nz b gy oe of l og oh">get_ipython().system_raw('./ngrok http 6006 &amp;')</span></pre><p id="5215" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">ç”Ÿæˆä¸€ä¸ª URLï¼Œä»¥ä¾¿æˆ‘ä»¬å¯ä»¥ä» Jupyter ç¬”è®°æœ¬ä¸­è®¿é—®æˆ‘ä»¬çš„å¼ é‡æ¿:</p><pre class="kj kk kl km gt ny nz oa ob aw oc bi"><span id="b09c" class="od nc it nz b gy oe of l og oh">! curl -s http://localhost:4040/api/tunnels | python3 -c \</span><span id="527f" class="od nc it nz b gy pk of l og oh">"import sys, json; print(json.load(sys.stdin)['tunnels'][0]['public_url'])"</span></pre><p id="6a3b" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">æ­£å¦‚æˆ‘ä»¬åœ¨ä¸‹é¢çœ‹åˆ°çš„ï¼ŒTensorBoard æ˜¯ä¸€ä¸ªéå¸¸æ–¹ä¾¿çš„å¯è§†åŒ–å·¥å…·ï¼Œè®©æˆ‘ä»¬å¯ä»¥æ·±å…¥äº†è§£æˆ‘ä»¬çš„è®­ç»ƒï¼Œå¹¶å¯ä»¥æå¤§åœ°å¸®åŠ©è¶…å‚æ•°è°ƒæ•´è¿‡ç¨‹ã€‚æˆ‘ä»¬å¯ä»¥å¾ˆå®¹æ˜“åœ°æ‰¾å‡ºå“ªä¸ªè¶…å‚æ•°ç»„ä»¶è¡¨ç°æœ€å¥½ï¼Œç„¶åç”¨å®ƒæ¥åšæˆ‘ä»¬çœŸæ­£çš„è®­ç»ƒã€‚</p><div class="kj kk kl km gt ab cb"><figure class="qb kn qc qd qe qf qg paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><img src="../Images/23a6b096511ceb3324d05ca28106aa54.png" data-original-src="https://miro.medium.com/v2/resize:fit:938/format:webp/1*L5xNeZ1A4cENWc0tmvbwWg.png"/></div></figure><figure class="qb kn qh qd qe qf qg paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><img src="../Images/082aca40dbaad8ee63b4f96d7565ff73.png" data-original-src="https://miro.medium.com/v2/resize:fit:1064/format:webp/1*jjAFS756-DntXAgu_ryMdA.png"/></div></figure></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi qi"><img src="../Images/9ed4dc0229aadf0d21ca6a0fcc235c59.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*m_ap-x42L9h53Phfa47ZtA.png"/></div></div></figure></div><div class="ab cl mu mv hx mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="im in io ip iq"><h1 id="a41c" class="nb nc it bd nd ne nf ng nh ni nj nk nl jz nm ka nn kc no kd np kf nq kg nr ns bi translated">ç»“è®º</h1><p id="1162" class="pw-post-body-paragraph ku kv it kw b kx nt ju kz la nu jx lc ld nv lf lg lh nw lj lk ll nx ln lo lp im bi translated">æ­£å¦‚ä½ æ‰€çœ‹åˆ°çš„ï¼ŒPyTorch ä½œä¸ºä¸€ä¸ªæœºå™¨å­¦ä¹ æ¡†æ¶æ˜¯çµæ´»çš„ã€å¼ºå¤§çš„å’Œå¯Œæœ‰è¡¨ç°åŠ›çš„ã€‚ä½ åªéœ€è¦å†™ Python ä»£ç ã€‚ç”±äºæœ¬æ–‡çš„ä¸»è¦é‡ç‚¹æ˜¯å±•ç¤ºå¦‚ä½•ä½¿ç”¨ PyTorch æ„å»ºä¸€ä¸ªå·ç§¯ç¥ç»ç½‘ç»œï¼Œå¹¶ä»¥ç»“æ„åŒ–çš„æ–¹å¼å¯¹å…¶è¿›è¡Œè®­ç»ƒï¼Œå› æ­¤æˆ‘æ²¡æœ‰å®Œæˆæ•´ä¸ªè®­ç»ƒæ—¶æœŸï¼Œç²¾åº¦ä¹Ÿä¸æ˜¯æœ€ä½³çš„ã€‚ä½ å¯ä»¥è‡ªå·±è¯•è¯•ï¼Œçœ‹çœ‹æ¨¡å‹è¡¨ç°å¦‚ä½•ã€‚</p><p id="b4ef" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">è¿™ç¯‡æ–‡ç« å¾ˆå¤§ç¨‹åº¦ä¸Šå—åˆ°äº† deeplizard åœ¨ YouTube ä¸Šçš„ PyTorch è§†é¢‘ç³»åˆ—çš„å¯å‘ã€‚ç”šè‡³å¤§éƒ¨åˆ†ä»£ç ç‰‡æ®µéƒ½æ˜¯ç›´æ¥æŠ„è¢­è¿‡æ¥çš„ã€‚æˆ‘æƒ³æ„Ÿè°¢ä»–ä»¬çš„ä¼Ÿå¤§å†…å®¹ï¼Œå¦‚æœä½ è§‰å¾—æœ‰å¿…è¦æ·±å…¥ç ”ç©¶ï¼Œéšæ—¶å»çœ‹çœ‹ï¼Œå¹¶è®¢é˜…ä»–ä»¬çš„é¢‘é“ã€‚</p></div><div class="ab cl mu mv hx mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="im in io ip iq"><p id="eaf3" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">è§‰å¾—è¿™ç¯‡æ–‡ç« æœ‰ç”¨ï¼Ÿåœ¨ Medium ä¸Šå…³æ³¨æˆ‘(<a class="ox oy ep" href="https://medium.com/u/72c98619a048?source=post_page-----efb297e22582--------------------------------" rel="noopener" target="_blank">æç«‹ä¼Ÿ</a>)æˆ–è€…ä½ å¯ä»¥åœ¨ Twitter <a class="ae lz" href="https://twitter.com/lymenlee" rel="noopener ugc nofollow" target="_blank"> @lymenlee </a>æˆ–è€…æˆ‘çš„åšå®¢ç½‘ç«™<a class="ae lz" href="https://wayofnumbers.com" rel="noopener ugc nofollow" target="_blank">wayofnumbers.com</a>ä¸Šæ‰¾åˆ°æˆ‘ã€‚ä½ ä¹Ÿå¯ä»¥çœ‹çœ‹æˆ‘ä¸‹é¢æœ€å—æ¬¢è¿çš„æ–‡ç« ï¼</p><div class="qj qk gp gr ql qm"><a rel="noopener follow" target="_blank" href="/this-is-cs50-a-pleasant-way-to-kick-off-your-data-science-education-d6075a6e761a"><div class="qn ab fo"><div class="qo ab qp cl cj qq"><h2 class="bd iu gy z fp qr fr fs qs fu fw is bi translated">â€œè¿™æ˜¯ CS50â€:å¼€å§‹æ•°æ®ç§‘å­¦æ•™è‚²çš„æ„‰å¿«æ–¹å¼</h2><div class="qt l"><h3 class="bd b gy z fp qr fr fs qs fu fw dk translated">ä¸ºä»€ä¹ˆ CS50 ç‰¹åˆ«é€‚åˆå·©å›ºä½ çš„è½¯ä»¶å·¥ç¨‹åŸºç¡€</h3></div><div class="qu l"><p class="bd b dl z fp qr fr fs qs fu fw dk translated">towardsdatascience.com</p></div></div><div class="qv l"><div class="qw l qx qy qz qv ra ks qm"/></div></div></a></div><div class="qj qk gp gr ql qm"><a rel="noopener follow" target="_blank" href="/two-sides-of-the-same-coin-fast-ai-vs-deeplearning-ai-b67e9ec32133"><div class="qn ab fo"><div class="qo ab qp cl cj qq"><h2 class="bd iu gy z fp qr fr fs qs fu fw is bi translated">ä¸€æšç¡¬å¸çš„ä¸¤é¢:æ°ç‘ç±³Â·éœåå¾·çš„ fast.ai vs å´æ©è¾¾çš„ deeplearning.ai</h2><div class="qt l"><h3 class="bd b gy z fp qr fr fs qs fu fw dk translated">å¦‚ä½•ä¸é€šè¿‡åŒæ—¶å‚åŠ  fast.ai å’Œ deeplearning.ai è¯¾ç¨‹æ¥â€œè¿‡åº¦é€‚åº”â€ä½ çš„äººå·¥æ™ºèƒ½å­¦ä¹ </h3></div><div class="qu l"><p class="bd b dl z fp qr fr fs qs fu fw dk translated">towardsdatascience.com</p></div></div><div class="qv l"><div class="rb l qx qy qz qv ra ks qm"/></div></div></a></div><div class="qj qk gp gr ql qm"><a href="https://medium.com/datadriveninvestor/thoughts-on-andrew-ngs-machine-learning-course-7724df76320f" rel="noopener follow" target="_blank"><div class="qn ab fo"><div class="qo ab qp cl cj qq"><h2 class="bd iu gy z fp qr fr fs qs fu fw is bi translated">æˆ‘å®Œæˆäº†å´æ©è¾¾çš„æœºå™¨å­¦ä¹ è¯¾ç¨‹ï¼Œæ„Ÿè§‰æ£’æäº†ï¼</h2><div class="qt l"><h3 class="bd b gy z fp qr fr fs qs fu fw dk translated">å¥½çš„ï¼Œåçš„ï¼Œç¾ä¸½çš„</h3></div><div class="qu l"><p class="bd b dl z fp qr fr fs qs fu fw dk translated">medium.com</p></div></div><div class="qv l"><div class="rc l qx qy qz qv ra ks qm"/></div></div></a></div></div></div>    
</body>
</html>