<html>
<head>
<title>Capsule Neural Networks — The future for autonomous vehicles</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">胶囊神经网络——自动驾驶汽车的未来</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/capsule-neural-networks-the-future-for-autonomous-vehicles-f97bc3f7918?source=collection_archive---------10-----------------------#2019-11-07">https://towardsdatascience.com/capsule-neural-networks-the-future-for-autonomous-vehicles-f97bc3f7918?source=collection_archive---------10-----------------------#2019-11-07</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="dc77" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">让我们面对现实吧。我们都不擅长拼写(也许你是个例外)🤷).希尔？他们的？确定吗？肯定吗？</p><p id="8f80" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">无论哪种情况，我们的大脑仍然明白这是单词<em class="ko">他们的</em>和<em class="ko">肯定是</em>。</p><p id="5697" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">让我们试着以人脸为例。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div class="gh gi kp"><img src="../Images/8b4c2d94aad6d68ba48d3aa55c5c725a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1114/0*qeqyXK8RRgm_LXG8"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk">A normal face</figcaption></figure><p id="6ab5" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果我开始把嘴移到前额，眼睛移到下巴，会怎么样？这可能更难分辨，但它仍然是一张<strong class="js iu">脸</strong>。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="gh gi lb"><img src="../Images/14a5139f7944dcdd4daa2f6c4fa1f4ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MzQrDuHhMpTUNCxkYqEjdQ.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk">A deformed face</figcaption></figure><p id="6a0d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">卷积神经网络(CNN)通过理解面部的不同特征，在分类图像(如上图)方面做得很好。他们通过检查成千上万的样本图像并从错误中学习来做到这一点。靠近起点的卷积层有助于检测基本特征(即边缘),网络中较深的层有助于检测更详细的特征(即眼睛、嘴等)。)</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="gh gi lg"><img src="../Images/3a6e4d0857ea4850b5b49b54a9ec9d14.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*9r_ABRGVBnh1bQj9"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk">CNN architecture layout</figcaption></figure><p id="883c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">然而，您可能想知道，<em class="ko">网络如何有效地处理所有这些数据？</em></p><h2 id="20c5" class="lh li it bd lj lk ll dn lm ln lo dp lp kb lq lr ls kf lt lu lv kj lw lx ly lz bi translated">最大池层数</h2><p id="ea5b" class="pw-post-body-paragraph jq jr it js b jt ma jv jw jx mb jz ka kb mc kd ke kf md kh ki kj me kl km kn im bi translated">每个卷积层之间存在一个<strong class="js iu"> max-pooling 层。</strong>这些层从每个卷积层中取出最活跃的神经元，并将它们传递给下一个卷积层。这意味着<strong class="js iu">不太活跃的神经元被丢弃。</strong>丢弃这些神经元是数据在网络中传输时空间信息丢失的原因。</p><p id="70e1" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">具有讽刺意味的是，max-pooling 层运行得如此之好。通过去除神经元，你可能会认为准确性会下降，但这种做法非常有效，杰弗里·辛顿甚至说，</p><blockquote class="mf mg mh"><p id="77d6" class="jq jr ko js b jt ju jv jw jx jy jz ka mi kc kd ke mj kg kh ki mk kk kl km kn im bi translated"><em class="it">“卷积神经网络中使用的池化操作是一个大错误，它如此有效的事实是一场灾难”</em>杰弗里·辛顿</p></blockquote><p id="3065" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这也提出了 CNN 的另一个问题。每个隐藏层中发生了什么，这些层如何相互通信？</p><p id="5149" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们需要另一种方法，可以帮助我们执行 CNN 的功能，同时改进架构以实现更强大的分类。这就是胶囊神经网络发挥作用的地方。</p><h1 id="4656" class="ml li it bd lj mm mn mo lm mp mq mr lp ms mt mu ls mv mw mx lv my mz na ly nb bi translated">它们是如何工作的？</h1><p id="0df9" class="pw-post-body-paragraph jq jr it js b jt ma jv jw jx mb jz ka kb mc kd ke kf md kh ki kj me kl km kn im bi translated">与标准神经网络中的神经元相比，胶囊网络使用胶囊。胶囊封装了输出向量的图像的所有重要信息。与输出标量的神经元相比，胶囊具有跟踪特征方向的能力。因此，如果我们开始改变特征的位置，向量的值将保持不变，但是方向将指向位置的变化。</p><h2 id="ed09" class="lh li it bd lj lk ll dn lm ln lo dp lp kb lq lr ls kf lt lu lv kj lw lx ly lz bi translated">赞成的意见</h2><blockquote class="mf mg mh"><p id="325a" class="jq jr ko js b jt ju jv jw jx jy jz ka mi kc kd ke mj kg kh ki mk kk kl km kn im bi translated">1.在较小的数据集(如 MNIST)上表现非常好</p><p id="95c1" class="jq jr ko js b jt ju jv jw jx jy jz ka mi kc kd ke mj kg kh ki mk kk kl km kn im bi translated">2.更容易解读更强健的图像</p><p id="5e24" class="jq jr ko js b jt ju jv jw jx jy jz ka mi kc kd ke mj kg kh ki mk kk kl km kn im bi translated">3.保存<strong class="js iu">所有</strong>信息(姿势、纹理、位置等。)</p></blockquote><h2 id="94cc" class="lh li it bd lj lk ll dn lm ln lo dp lp kb lq lr ls kf lt lu lv kj lw lx ly lz bi translated">骗局</h2><blockquote class="mf mg mh"><p id="f9bb" class="jq jr ko js b jt ju jv jw jx jy jz ka mi kc kd ke mj kg kh ki mk kk kl km kn im bi translated">1.不优于大型数据集(即 CIFAR10)</p><p id="4867" class="jq jr ko js b jt ju jv jw jx jy jz ka mi kc kd ke mj kg kh ki mk kk kl km kn im bi translated">2.协议路由算法需要更多的计算时间</p></blockquote><h1 id="c67d" class="ml li it bd lj mm mn mo lm mp mq mr lp ms mt mu ls mv mw mx lv my mz na ly nb bi translated">建筑:</h1><p id="8299" class="pw-post-body-paragraph jq jr it js b jt ma jv jw jx mb jz ka kb mc kd ke kf md kh ki kj me kl km kn im bi translated">胶囊网络(CapsNet)包含一个<strong class="js iu">编码器</strong>和一个<strong class="js iu">解码器</strong>。编码器和解码器总共包含 6 层。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="gh gi nc"><img src="../Images/75631b88118c96d7ff6f976940174b6c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*c0iOzVk6XkYdKg_1mvsOBg.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk">Encoder Architecture</figcaption></figure><p id="9d2a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">前三层是编码器，负责获取输入图像并将其转换为 16 维向量。创建顶点网编码器的三个层如下:</p><blockquote class="mf mg mh"><p id="1121" class="jq jr ko js b jt ju jv jw jx jy jz ka mi kc kd ke mj kg kh ki mk kk kl km kn im bi translated">1.卷积神经网络</p><p id="5474" class="jq jr ko js b jt ju jv jw jx jy jz ka mi kc kd ke mj kg kh ki mk kk kl km kn im bi translated">2.初级资本网络</p><p id="9422" class="jq jr ko js b jt ju jv jw jx jy jz ka mi kc kd ke mj kg kh ki mk kk kl km kn im bi translated">3.DigitCaps 网络</p></blockquote><p id="c2fe" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">第一层负责<strong class="js iu">提取图像的基本特征</strong>(即找出组成数字 4 的笔画)。</p><p id="1c16" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">第二层(PrimaryCaps)负责获取这些基本特征和<strong class="js iu">寻找它们之间更详细的模式</strong>(即每个笔画之间的空间关系)。该图层中胶囊的数量因数据集而异，但对于 MNIST 数据集，有 32 个胶囊来维护最相关的信息。</p><p id="ddac" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">就像第二层一样，第三层(DigitCaps 层)中的胶囊数量也不同。特别是，对于 MNIST 数据集，我们有 10 个胶囊；每个手指一个胶囊。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="gh gi nd"><img src="../Images/264f962dcbb2f68d873f922436c6f2eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*QYcn3g8FFHzluTmK"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk">MNIST handwritten digits</figcaption></figure><p id="cc60" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">为了确定初级胶囊中的哪个胶囊进入数字胶囊，较低级胶囊(初级胶囊)的重量必须与较高级胶囊(数字胶囊)的重量一致。(<em class="ko">我们稍后将对此进行更多讨论</em>。)</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="gh gi ne"><img src="../Images/c4ae2324a859cd41364fa1672f02fd6e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HhPWrQa4MSGZHVgsQjayrw.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk">Decoder Architecture</figcaption></figure><p id="d892" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在编码器的末端，我们得到的是一个 16 维向量。这被传递给解码器。<strong class="js iu">解码器</strong>有三个<strong class="js iu">全连接层</strong>。解码器的主要工作是获取 16 维向量，<strong class="js iu">尝试使用<strong class="js iu"> <em class="ko">数据</em> </strong>从头开始重建图像</strong>。这是令人惊讶的，因为它通过基于其<strong class="js iu"> <em class="ko">自己的</em> </strong>知识生成预测，使网络更加健壮。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/b1ec723e458a1ed573b56056cb1f583a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1110/0*Yxo_8EVIBsIcpE6n"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk">Decoder architecture breakdown</figcaption></figure><h1 id="be35" class="ml li it bd lj mm mn mo lm mp mq mr lp ms mt mu ls mv mw mx lv my mz na ly nb bi translated">组件:</h1><p id="e93d" class="pw-post-body-paragraph jq jr it js b jt ma jv jw jx mb jz ka kb mc kd ke kf md kh ki kj me kl km kn im bi translated">考虑到这一点，胶囊神经网络中有四个主要计算。</p><blockquote class="mf mg mh"><p id="b62e" class="jq jr ko js b jt ju jv jw jx jy jz ka mi kc kd ke mj kg kh ki mk kk kl km kn im bi translated">1.矩阵乘法</p><p id="50f4" class="jq jr ko js b jt ju jv jw jx jy jz ka mi kc kd ke mj kg kh ki mk kk kl km kn im bi translated">2.标量加权</p><p id="5de6" class="jq jr ko js b jt ju jv jw jx jy jz ka mi kc kd ke mj kg kh ki mk kk kl km kn im bi translated">3.动态路由算法</p><p id="2a33" class="jq jr ko js b jt ju jv jw jx jy jz ka mi kc kd ke mj kg kh ki mk kk kl km kn im bi translated">4.矢量至矢量非线性</p></blockquote><h2 id="ae28" class="lh li it bd lj lk ll dn lm ln lo dp lp kb lq lr ls kf lt lu lv kj lw lx ly lz bi translated">矩阵乘法。</h2><p id="46c8" class="pw-post-body-paragraph jq jr it js b jt ma jv jw jx mb jz ka kb mc kd ke kf md kh ki kj me kl km kn im bi translated">我们在从第一层传递到第二层的信息之间执行权重矩阵乘法，以编码理解空间关系的信息。该编码信息代表分类正确标签的概率。</p><h2 id="c750" class="lh li it bd lj lk ll dn lm ln lo dp lp kb lq lr ls kf lt lu lv kj lw lx ly lz bi translated">标量加权。</h2><p id="58d0" class="pw-post-body-paragraph jq jr it js b jt ma jv jw jx mb jz ka kb mc kd ke kf md kh ki kj me kl km kn im bi translated">还记得我说过，低等级胶囊的重量必须与高等级一致吗？在这一阶段，较低层的胶囊调整其重量，以便与较高层的重量相匹配。</p><p id="8fa4" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">你可能想知道:较高级别的胶囊正在接收一堆输入，<em class="ko">它们如何选择正确的较低级别的胶囊</em>？</p><p id="c0f2" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">嗯，更高级别的胶囊绘制出权重的分布，并接受最大的分布/集群来传递。</p><p id="2169" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">他们是如何交流的？</p><h2 id="b72e" class="lh li it bd lj lk ll dn lm ln lo dp lp kb lq lr ls kf lt lu lv kj lw lx ly lz bi translated">动态路由算法。</h2><p id="68e7" class="pw-post-body-paragraph jq jr it js b jt ma jv jw jx mb jz ka kb mc kd ke kf md kh ki kj me kl km kn im bi translated">使用动态路由算法，我们可以让各层相互通信。该算法集中于“<strong class="js iu">通过协议</strong>路由”的思想，这就是我们前面谈到的使胶囊的重量/内容一致。动态路由算法允许我们更好地在网络的各层之间传递数据，这在理论上会增加时间和空间的复杂性。在实践中，我们使用三次路由迭代，因为过度迭代会导致过拟合和较差的性能。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="gh gi ng"><img src="../Images/cac25e762acd7120b62bde03fbc846d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Pa1W69RY65hotN7z"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk">Contents of lower capsules agreeing with higher-level capsules</figcaption></figure><h2 id="7179" class="lh li it bd lj lk ll dn lm ln lo dp lp kb lq lr ls kf lt lu lv kj lw lx ly lz bi translated">矢量至矢量非线性。</h2><p id="ee17" class="pw-post-body-paragraph jq jr it js b jt ma jv jw jx mb jz ka kb mc kd ke kf md kh ki kj me kl km kn im bi translated">在执行动态路由算法并将胶囊传递到正确的位置并重建图像后，最后一步需要的是<strong class="js iu">压缩信息</strong>。我们需要某种方法将所有这些信息浓缩成我们可以重复使用的东西。</p><p id="6026" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们如何做到这一点是使用一个<strong class="js iu">挤压功能</strong>。</p><p id="d16b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">挤压函数采用最终的向量大小，并将长度压缩到小于 1 的大小，同时仍然保持向量的方向。以下是挤压函数的数学表示:</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div class="gh gi nh"><img src="../Images/6c4fb6d23dc2b74ba9c424fd5b4df045.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/0*nQz_vt-nNV9qroij"/></div></figure><p id="e115" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">公式的左侧(红框)执行我们之前讨论的缩放。并且，右侧(绿色框)为挤压向量指定一个单位长度。</p><p id="3bb4" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">快速回顾:</strong>这个矢量输出(v_j)表示胶囊识别给定特征的概率。</p><h1 id="8629" class="ml li it bd lj mm mn mo lm mp mq mr lp ms mt mu ls mv mw mx lv my mz na ly nb bi translated">损失函数:</h1><p id="c3a2" class="pw-post-body-paragraph jq jr it js b jt ma jv jw jx mb jz ka kb mc kd ke kf md kh ki kj me kl km kn im bi translated">就像传统的网络一样，网络从错误中学习。我们可以通过如下所示的损失函数来表示这种错误:</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="gh gi ni"><img src="../Images/e918c12bf296651b74de38b63d315841.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*0ZqM5ZofKA1gCgZ4"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk">Breakdown of CapsNet loss function [<a class="ae nj" href="https://pechyonkin.me/capsules-4/" rel="noopener ugc nofollow" target="_blank">Source</a>]</figcaption></figure><p id="760b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果网络以 0.9 或更高的概率预测正确的类别，则此损失函数将返回 0。否则，如果置信度小于 0.9，损失函数将返回 0 到 1 之间的数字。</p><h1 id="dd24" class="ml li it bd lj mm mn mo lm mp mq mr lp ms mt mu ls mv mw mx lv my mz na ly nb bi translated">外卖食品</h1><ul class=""><li id="aa9c" class="nk nl it js b jt ma jx mb kb nm kf nn kj no kn np nq nr ns bi translated">与最大池层相比，胶囊网络<strong class="js iu">保留了图像中的大部分信息</strong></li><li id="fc23" class="nk nl it js b jt nt jx nu kb nv kf nw kj nx kn np nq nr ns bi translated"><strong class="js iu">动态路由算法</strong>允许网络中的各层通过<strong class="js iu">协议路由相互通信。</strong></li><li id="9251" class="nk nl it js b jt nt jx nu kb nv kf nw kj nx kn np nq nr ns bi translated">胶囊网络仍处于开发的早期阶段</li><li id="435b" class="nk nl it js b jt nt jx nu kb nv kf nw kj nx kn np nq nr ns bi translated">胶囊网络<strong class="js iu">在处理大型数据集时性能不足</strong></li></ul><h1 id="1807" class="ml li it bd lj mm mn mo lm mp mq mr lp ms mt mu ls mv mw mx lv my mz na ly nb bi translated">如果您喜欢我的文章或学到了新东西，请确保:</h1><ul class=""><li id="7f18" class="nk nl it js b jt ma jx mb kb nm kf nn kj no kn np nq nr ns bi translated">查看我的<a class="ae nj" href="https://wlawt.com/" rel="noopener ugc nofollow" target="_blank"> <strong class="js iu">网站</strong> </a>！</li><li id="a73f" class="nk nl it js b jt nt jx nu kb nv kf nw kj nx kn np nq nr ns bi translated">通过<a class="ae nj" href="https://www.linkedin.com/in/william-t-law/" rel="noopener ugc nofollow" target="_blank"> <strong class="js iu"> LinkedIn </strong> </a>与我联系</li><li id="93d3" class="nk nl it js b jt nt jx nu kb nv kf nw kj nx kn np nq nr ns bi translated">发送一些反馈(我总是乐于接受建议！)</li></ul></div></div>    
</body>
</html>