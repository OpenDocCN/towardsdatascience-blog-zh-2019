<html>
<head>
<title>Meta-learners for Estimating Treatment Effect in Causal Inference</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">因果推理中估计治疗效果的元学习器</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/meta-learners-for-estimating-treatment-effect-in-causal-inference-4f7071503401?source=collection_archive---------8-----------------------#2019-12-29">https://towardsdatascience.com/meta-learners-for-estimating-treatment-effect-in-causal-inference-4f7071503401?source=collection_archive---------8-----------------------#2019-12-29</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="32c7" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">揭开因果 ML 中 T-学习者、S-学习者和 X-学习者的神秘面纱</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/b6e4d4f9759ec8e2693f59a7578ffc30.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9JT9iMqgIjSHXFgdshKlzg.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk"><a class="ae ky" href="https://eng.uber.com/causal-inference-at-uber/" rel="noopener ugc nofollow" target="_blank">https://eng.uber.com/causal-inference-at-uber/</a></figcaption></figure><p id="ce1b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最近我看到优步在 github 上发布了<a class="ae ky" href="https://github.com/uber/causalml" rel="noopener ugc nofollow" target="_blank">caus AML</a>python 库。它包括基于树的算法和在因果推理中估计治疗效果的元算法。我对这一努力感到非常兴奋——将最先进的机器学习技术与因果分析相结合。</p><p id="0e35" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">知识库中有一个关于如何使用所有这些算法的很好的例子，在<a class="ae ky" href="https://github.com/uber/causalml/blob/master/examples/meta_learners_with_synthetic_data.ipynb" rel="noopener ugc nofollow" target="_blank"> Jupyter 笔记本</a>上。对于没有听说过元学习者的人来说，这可能有点令人困惑。这篇文章我会试着解释代码中提到的一些元学习者，所有这些 T-学习者，S-学习者，X-学习者等等…</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><p id="b14c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，我假设你已经知道什么是因果分析，以及它试图推断什么。如果不是，简要总结——因果关系试图回答‘如果’的问题。统计推断和机器学习技术关注 X 的变化如何与 Y 的变化相关联；然而，因果推理的重点是了解 X 对 Y 是否有因果影响，即 X 的变化是否会引起 Y 的变化——如果 X 不变，Y 还会变吗？</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><p id="453f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">传统上，人们用<strong class="lb iu">平均治疗效果(ATE= E(Y=1)-E(Y=0)) </strong>来衡量随机治疗组和对照组的差异。例如，兴趣的因果效应是使用优步的人们乘坐价格变化(降低价格)的影响:平均来说，如果我们降低价格，我们会获得多少次以上的乘坐。<strong class="lb iu"> <em class="mc">吃了</em> </strong>，在这种情况下，就是治疗组和对照组乘坐次数的期望值之差。</p><p id="f212" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这个例子中，一个正的<strong class="lb iu"> <em class="mc">吃了</em> </strong>，表明降低价格会增加使用优步的人数。负的<strong class="lb iu"> <em class="mc">表示</em> </strong>表示价格变化降低了需求。一个等于零的<strong class="lb iu"><em class="mc"/></strong>估计值表明在乘坐次数方面提供治疗没有优势或劣势。确定一个<strong class="lb iu"> <em class="mc"> ATE </em> </strong>估计值是否可与零区分开(正的或负的)需要使用 p 值进行统计推断。</p><p id="ea8a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因为<strong class="lb iu"><em class="mc"/></strong>是对治疗的平均效果的估计，正的或负的<strong class="lb iu"><em class="mc"/></strong>并不表示任何特定的个体将受益于或受到治疗的伤害。</p><p id="bfae" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">随着包含个性化治疗的大型数据集的增加，我们希望超越平均治疗效果，了解治疗效果如何因人而异。一个替代是<strong class="lb iu">条件平均治疗效果(CATE，τ(X)= E[D | X = X]= E[Y(1)-Y(0)| X = X])</strong>它是以观察到的协变量为条件的治疗效果。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><p id="ddf7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">元算法用于计算<strong class="lb iu"> <em class="mc">、美食</em> </strong>。最常见的元算法采取两个步骤:</p><ol class=""><li id="0c9d" class="md me it lb b lc ld lf lg li mf lm mg lq mh lu mi mj mk ml bi translated">它使用基础学习者分别为控制组和治疗组估计结果的条件期望。</li><li id="3012" class="md me it lb b lc mm lf mn li mo lm mp lq mq lu mi mj mk ml bi translated">它取这些估计值之间的差值。</li></ol><p id="ddfe" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">更具体地说，这里是回购中使用的几个元学习者。</p><ol class=""><li id="02d8" class="md me it lb b lc ld lf lg li mf lm mg lq mh lu mi mj mk ml bi translated">网络学习者:</li></ol><p id="aa8e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当基础学习器是基于树的方法时，我们称之为“T-学习器”,因为我们使用“二叉树”基础学习器来估计治疗组和对照组的两个响应。</p><p id="3b13" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">步骤 1:我们使用任何监督学习来估计μ0(x) = E[Y(0)|X=x]和μ1(x) = E[Y(1)|X=x]，我们将两个分类器表示为\hat{μ0}。和\hat{μ1(x)}。</p><p id="7850" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">步骤 2: T-learner 是{τ_ T(x)} = \ hat {μ1(x)}—\ hat {μ0(x)}</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mr"><img src="../Images/05d376549a2879645859e33d448659fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LdLcEtbyK-m_Rn59XZ_diw.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk"><a class="ae ky" href="https://arxiv.org/pdf/1706.03461.pdf" rel="noopener ugc nofollow" target="_blank">https://arxiv.org/pdf/1706.03461.pdf</a></figcaption></figure><p id="3a89" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">2.s-学习者</p><p id="a960" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">“S-学习者”类似于“T-学习者”，只是当我们估计结果时，我们使用所有的预测值，而不赋予治疗变量特殊的作用，因此我们只需要一个“单一”估计值作为基础学习者。</p><p id="010d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">治疗指示符作为类似于所有其他特征的特征被包括在内，而该指示符没有被赋予任何特殊的作用。</p><p id="b472" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们使用整个数据集上的任何基础学习器来测量预期结果μ(x，w) = E[Y_{obs}|X=x，W=w]，将估计量表示为\hat{μ}</p><p id="09e0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">CATE 由下式给出:\hat{τ_s(x)}=\hat{μ(x，1)}-\hat{μ(x，0)}</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ms"><img src="../Images/7469d6559cc3f056ae7e953ea2069981.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iXs_MdxgcsSksCaoi1pjZQ.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk"><a class="ae ky" href="https://arxiv.org/pdf/1706.03461.pdf" rel="noopener ugc nofollow" target="_blank">https://arxiv.org/pdf/1706.03461.pdf</a></figcaption></figure><p id="91d1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">3.X-Learner</p><p id="8f6d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">实际上，我们在对照组的数据往往比治疗组多。在我们在治疗组中只有非常少的数据点的情况下，使用 T-learner 会有问题，我们希望确保在数据非常小的情况下，我们不会对治疗组进行过度拟合。为了避免这个问题，一个需要思考的问题是——我们能利用来自对照组的信息来评估治疗组吗？这就是 X-learner 试图做的事情:使用来自控制组的信息为治疗组导出更好的估计值，反之亦然。它建立在 T-learner 的基础上，以类似“X”的形状使用训练集中的每个观察。这就是<strong class="lb iu">反事实</strong>发挥作用的地方。</p><p id="040e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">第一步，我们使用任何基本学习器估计响应函数μ0(x)=E[Y(0)|X=x]和μ1(x)=E[Y(1)|X=x],将估计量表示为{μ0}和{μ1}</p><p id="dcd8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在第二步中，我们估算反事实，即基于控制结果估计值的治疗组中个体的治疗效果，以及基于治疗结果估计值的对照组中个体的治疗效果。方法是 Di1=Yi-\hat{\mu0(Xi)}和 Di0=\hat{\mu1(Xi)}-Yi0</p><p id="addf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">第三步，我们使用估算信息估计τ1 和τ0。</p><p id="7e56" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，我们使用两个估计量{τ0}和{τ1}的加权平均值</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mt"><img src="../Images/92d3f7f920401f9c6be47518b8cc6808.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kaq4wKMblFjD04ugguMETA.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk"><a class="ae ky" href="https://arxiv.org/pdf/1706.03461.pdf" rel="noopener ugc nofollow" target="_blank">https://arxiv.org/pdf/1706.03461.pdf</a></figcaption></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><p id="6089" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是一个非常简短的 T 学习者、S 学习者和 X 学习者介绍。当我们进行在线实验或个性化推荐，想要衡量政策对个人的影响时，我们需要看到对个人层面的影响，而不是平均影响，或者当我们进行预测时，我们需要看到为什么会出现某种结果——无论是由于对该个人的政策变化。</p><p id="f1f5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用元学习者可以帮助我们将机器学习算法与因果分析联系起来，并帮助我们理解结果发生变化的原因。他们可以将监督学习算法转化为 CATE 估计，帮助我们更好地理解预测结果。</p><h1 id="85bb" class="mu mv it bd mw mx my mz na nb nc nd ne jz nf ka ng kc nh kd ni kf nj kg nk nl bi translated">参考:</h1><p id="f272" class="pw-post-body-paragraph kz la it lb b lc nm ju le lf nn jx lh li no lk ll lm np lo lp lq nq ls lt lu im bi translated">Künzel，Sö ren R .等，“使用机器学习估计异质性治疗效果的金属载体。”美国国家科学院院刊 116.10(2019):4156-4165。交叉引用。网络。</p><div class="nr ns gp gr nt nu"><a href="https://github.com/uber/causalml" rel="noopener  ugc nofollow" target="_blank"><div class="nv ab fo"><div class="nw ab nx cl cj ny"><h2 class="bd iu gy z fp nz fr fs oa fu fw is bi translated">Uber/cau sall</h2><div class="ob l"><h3 class="bd b gy z fp nz fr fs oa fu fw dk translated">该项目是稳定的，正在酝酿长期支持。它可能包含新的实验代码，对于这些代码，APIs</h3></div><div class="oc l"><p class="bd b dl z fp nz fr fs oa fu fw dk translated">github.com</p></div></div><div class="od l"><div class="oe l of og oh od oi ks nu"/></div></div></a></div><p id="b944" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://eng.uber.com/causal-inference-at-uber/" rel="noopener ugc nofollow" target="_blank">https://eng.uber.com/causal-inference-at-uber/</a></p></div></div>    
</body>
</html>