<html>
<head>
<title>Building a Financial Trading Toolbox in Python: Simple Moving Average</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用 Python 构建金融交易工具箱:简单移动平均线</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/trading-toolbox-01-sma-7b8e16bd9388?source=collection_archive---------6-----------------------#2019-09-16">https://towardsdatascience.com/trading-toolbox-01-sma-7b8e16bd9388?source=collection_archive---------6-----------------------#2019-09-16</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="52c8" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph"><a class="ae ep" href="https://medium.com/tag/trading-toolbox" rel="noopener">交易工具箱</a></h2><div class=""/><figure class="gl gn ka kb kc kd gh gi paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="gh gi jz"><img src="../Images/0da0fb8c3d958065458b6a80134fcd86.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*6CQUink2qwp2xf9W"/></div></div><figcaption class="kk kl gj gh gi km kn bd b be z dk">Photo by <a class="ae ko" href="https://unsplash.com/@markusspiske?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Markus Spiske</a> on <a class="ae ko" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="3a10" class="pw-post-body-paragraph kp kq it kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">Python 凭借其强大的数据分析包<em class="ln">熊猫</em>，席卷了金融市场分析领域。它使研究人员能够进行复杂的分析，而这曾经需要专用的昂贵的软件包。</p><p id="b4a4" class="pw-post-body-paragraph kp kq it kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">在这篇文章中，我们将使用 Python 和熊猫涉水金融市场分析。我们将绘制一个市场价格序列，并添加一个基本指标。在接下来的文章中，我们将通过构建一个完整的工具箱来学习如何游泳，这个工具箱可以用来创建交易股票或其他金融资产的系统。</p><p id="db24" class="pw-post-body-paragraph kp kq it kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">我们将要实现的大多数概念属于一个被称为<a class="ae ko" href="https://www.investopedia.com/terms/t/technicalanalysis.asp" rel="noopener ugc nofollow" target="_blank">技术分析</a>的领域，这是一个旨在通过分析交易活动产生的数据(如价格和交易量)来评估投资和识别机会的学科。</p><h2 id="6bb8" class="lo lp it bd lq lr ls dn lt lu lv dp lw la lx ly lz le ma mb mc li md me mf iz bi translated">介绍移动平均线</h2><p id="591b" class="pw-post-body-paragraph kp kq it kr b ks mg ku kv kw mh ky kz la mi lc ld le mj lg lh li mk lk ll lm im bi translated"><strong class="kr jd">移动平均线</strong>是最简单的技术指标之一，但它可以以许多不同的方式使用和组合，为交易系统和投资决策框架提供支柱。</p><p id="1450" class="pw-post-body-paragraph kp kq it kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">移动平均线，作为所有的技术指标，是基于金融工具的价格序列。在我们的例子中，我们考虑在纽约证券交易所交易的<a class="ae ko" href="https://www.investopedia.com/terms/e/etf.asp" rel="noopener ugc nofollow" target="_blank">交易所交易基金</a> (ETF)的<a class="ae ko" href="https://en.wikipedia.org/wiki/SPDR_S%26P_500_Trust_ETF" rel="noopener ugc nofollow" target="_blank"> SPDR 的&amp; P 500 ETF 信托</a>(代码:SPY)的每日价格序列。这只 ETF 模仿了标准普尔 500 指数的表现。我们希望使用移动平均线来做出投资决策——决定何时买入或卖出 SPY 的股票。</p><p id="308c" class="pw-post-body-paragraph kp kq it kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">有不同种类的移动平均线。最常用的三种是:</p><ul class=""><li id="20be" class="ml mm it kr b ks kt kw kx la mn le mo li mp lm mq mr ms mt bi translated">简单移动平均线</li><li id="65a3" class="ml mm it kr b ks mu kw mv la mw le mx li my lm mq mr ms mt bi translated">线性加权移动平均</li><li id="59b7" class="ml mm it kr b ks mu kw mv la mw le mx li my lm mq mr ms mt bi translated">指数平滑移动平均</li></ul><p id="4c43" class="pw-post-body-paragraph kp kq it kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">本帖中的例子将集中在<strong class="kr jd">简单移动平均线(SMA) </strong>。它的构造非常简单:我们首先定义一个长度为<em class="ln"> n </em>的滚动窗口(在我们的例子中是几天——让我们使用<em class="ln"> n=5 </em>)。然后，我们从第 5 天开始，考虑从第 1 天到第 5 天(包括在内)的所有价格。我们计算这些价格的算术平均值(将它们相加并除以 5):这就是第 5 天的 SMA 值。然后，我们继续到第 6 天，我们取出第 1 天的价格，包括第 6 天的价格，并计算下一个 SMA。我们不断重复这个过程，直到我们达到系列中的最后一个价格。参见表格:</p><figure class="na nb nc nd gt kd gh gi paragraph-image"><div class="gh gi mz"><img src="../Images/dd8b68ba0b7a3208fbcda7d4db524274.png" data-original-src="https://miro.medium.com/v2/resize:fit:550/format:webp/1*yzh33pcmOsorkqEo33NirQ.png"/></div></figure><p id="3b4d" class="pw-post-body-paragraph kp kq it kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">您已经注意到我们的移动平均线的前 4 个值没有被计算:直到第 5 天才有足够的天数来填充 5 天的窗口。</p><h2 id="570c" class="lo lp it bd lq lr ls dn lt lu lv dp lw la lx ly lz le ma mb mc li md me mf iz bi translated">直观的例子</h2><p id="dcc7" class="pw-post-body-paragraph kp kq it kr b ks mg ku kv kw mh ky kz la mi lc ld le mj lg lh li mk lk ll lm im bi translated">让我们将这个概念付诸实践，并使用 Python、<a class="ae ko" href="https://pandas.pydata.org/" rel="noopener ugc nofollow" target="_blank"> pandas </a>和<a class="ae ko" href="https://matplotlib.org/" rel="noopener ugc nofollow" target="_blank"> Matplotlib </a>创建一些实际的例子。我假设您至少有一些基本的 Python 知识，并且知道什么是数据帧和序列对象。如果不是这样，你可以在这里找到温柔的介绍<a class="ae ko" href="https://www.dataquest.io/course/python-for-data-science-fundamentals/" rel="noopener ugc nofollow" target="_blank">。我还建议你用一个笔记本来跟随下面的代码。在这里你可以找到一个方便的</a><a class="ae ko" href="https://www.dataquest.io/blog/jupyter-notebook-tutorial/" rel="noopener ugc nofollow" target="_blank"> Jupyter 教程</a>。但是，您总是以自己喜欢的方式执行代码，通过 IDE 或交互式提示符。我们首先加载所需的库并检查它们的版本:</p><pre class="na nb nc nd gt ne nf ng nh aw ni bi"><span id="0f74" class="lo lp it nf b gy nj nk l nl nm">import pandas as pd<br/>import matplotlib.pyplot as plt</span></pre><p id="9dd8" class="pw-post-body-paragraph kp kq it kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">如果您正在使用<strong class="kr jd"> Jupyter </strong>，最好在笔记本中显示图表:</p><pre class="na nb nc nd gt ne nf ng nh aw ni bi"><span id="e187" class="lo lp it nf b gy nj nk l nl nm">%matplotlib inline</span></pre><p id="44b7" class="pw-post-body-paragraph kp kq it kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">在这种情况下，你可以省略本文所有代码中的所有<code class="fe nn no np nf b">plt.show()</code>语句。</p><p id="6461" class="pw-post-body-paragraph kp kq it kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">接下来，我们将数据加载到数据帧中。我已经从雅虎获得了一个每日间谍数据的 CSV 文件。财务。你可以在这里下载<a class="ae ko" href="https://raw.githubusercontent.com/stebas101/TradingToolbox/master/data/SPY.csv" rel="noopener ugc nofollow" target="_blank">我的 CSV 文件</a>。</p><pre class="na nb nc nd gt ne nf ng nh aw ni bi"><span id="c65b" class="lo lp it nf b gy nj nk l nl nm">datafile = 'data/SPY.csv'</span><span id="f657" class="lo lp it nf b gy nq nk l nl nm">#This creates a dataframe from the CSV file:<br/>data = pd.read_csv(datafile, index_col = 'Date')</span><span id="a8db" class="lo lp it nf b gy nq nk l nl nm">data</span></pre><p id="86da" class="pw-post-body-paragraph kp kq it kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">Jupyter 中的输出显示了我们的数据:</p><figure class="na nb nc nd gt kd gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/486ba4459919b663c720b4989179a041.png" data-original-src="https://miro.medium.com/v2/resize:fit:1116/format:webp/1*59CMx7t197lkY6Tymk2bWw.png"/></div></figure><p id="c0b8" class="pw-post-body-paragraph kp kq it kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">我们的数据框架总共有六列，分别代表开盘价、最高价、最低价、收盘价、调整后收盘价和成交量。为了简单起见，在我们的例子中，我们将只使用调整后的收盘价。这是反映股息、股票分割和其他影响股票回报的公司事件的价格系列。</p><pre class="na nb nc nd gt ne nf ng nh aw ni bi"><span id="51dc" class="lo lp it nf b gy nj nk l nl nm">#This selects the 'Adj Close' column<br/>close = data['Adj Close']</span><span id="9524" class="lo lp it nf b gy nq nk l nl nm">#This converts the date strings in the index into pandas datetime format:<br/>close.index = pd.to_datetime(close.index)</span><span id="8a98" class="lo lp it nf b gy nq nk l nl nm">close</span></pre><p id="cd61" class="pw-post-body-paragraph kp kq it kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">输出:</p><pre class="na nb nc nd gt ne nf ng nh aw ni bi"><span id="d205" class="lo lp it nf b gy nj nk l nl nm">Date<br/>2014-08-20    180.141846<br/>2014-08-21    180.667160<br/>2014-08-22    180.386368<br/>2014-08-25    181.301010<br/>2014-08-26    181.418716<br/>                 ...    <br/>2019-08-13    292.549988<br/>2019-08-14    283.899994<br/>2019-08-15    284.649994<br/>2019-08-16    288.850006<br/>2019-08-19    292.329987<br/>Name: Adj Close, Length: 1258, dtype: float64</span></pre><p id="042a" class="pw-post-body-paragraph kp kq it kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">我们可以很容易地绘制价格系列，以便直观地观察:</p><pre class="na nb nc nd gt ne nf ng nh aw ni bi"><span id="90d0" class="lo lp it nf b gy nj nk l nl nm">close.plot()</span><span id="3e9f" class="lo lp it nf b gy nq nk l nl nm">plt.show()</span></pre><p id="c8cc" class="pw-post-body-paragraph kp kq it kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">如果你正在使用 Jupyter ，记住你可以在这里和下一行代码中删除<code class="fe nn no np nf b">plt.show()</code>行。我们得到:</p><figure class="na nb nc nd gt kd gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/b02468dadf67cd631414127bc652a16f.png" data-original-src="https://miro.medium.com/v2/resize:fit:944/format:webp/1*1JiqOe4irao7t82g3SjBtw.png"/></div><figcaption class="kk kl gj gh gi km kn bd b be z dk">close.plot() output in Jupyter</figcaption></figure><p id="1c75" class="pw-post-body-paragraph kp kq it kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">熊猫让计算 50 天移动平均线变得容易。使用<strong class="kr jd">滚动()</strong>方法，我们设置了一个 50 天的窗口，在此窗口上，我们使用<strong class="kr jd">均值()</strong>方法计算算术平均值:</p><pre class="na nb nc nd gt ne nf ng nh aw ni bi"><span id="56f8" class="lo lp it nf b gy nj nk l nl nm">sma50 = close.rolling(window=50).mean()</span><span id="6a89" class="lo lp it nf b gy nq nk l nl nm">sma50</span></pre><p id="1e54" class="pw-post-body-paragraph kp kq it kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">我们得到:</p><pre class="na nb nc nd gt ne nf ng nh aw ni bi"><span id="f38a" class="lo lp it nf b gy nj nk l nl nm">Date<br/>2014-08-20           NaN<br/>2014-08-21           NaN<br/>2014-08-22           NaN<br/>2014-08-25           NaN<br/>2014-08-26           NaN<br/>                 ...    <br/>2019-08-13    293.540820<br/>2019-08-14    293.635375<br/>2019-08-15    293.696567<br/>2019-08-16    293.805137<br/>2019-08-19    293.926582<br/>Name: Adj Close, Length: 1258, dtype: float64</span></pre><p id="f716" class="pw-post-body-paragraph kp kq it kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">正如我们所料，序列的前 49 个值为空:</p><pre class="na nb nc nd gt ne nf ng nh aw ni bi"><span id="448b" class="lo lp it nf b gy nj nk l nl nm">sma50.iloc[45:52]</span></pre><p id="d409" class="pw-post-body-paragraph kp kq it kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">显示:</p><pre class="na nb nc nd gt ne nf ng nh aw ni bi"><span id="bc79" class="lo lp it nf b gy nj nk l nl nm">Date<br/>2014-10-23           NaN<br/>2014-10-24           NaN<br/>2014-10-27           NaN<br/>2014-10-28           NaN<br/>2014-10-29    178.725250<br/>2014-10-30    178.750461<br/>2014-10-31    178.806655<br/>Name: Adj Close, dtype: float64</span></pre><p id="1d0e" class="pw-post-body-paragraph kp kq it kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">我们现在可以在图表上画出我们的第一条均线。为了改善外观，我们可以使用预定义的样式:</p><pre class="na nb nc nd gt ne nf ng nh aw ni bi"><span id="02b5" class="lo lp it nf b gy nj nk l nl nm">plt.style.use('fivethirtyeight')</span></pre><p id="a303" class="pw-post-body-paragraph kp kq it kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">你可以尝试不同的风格，看看这里有什么<a class="ae ko" href="https://tonysyu.github.io/raw_content/matplotlib-style-gallery/gallery.html" rel="noopener ugc nofollow" target="_blank"/>。我们现在可以绘制图表了:</p><pre class="na nb nc nd gt ne nf ng nh aw ni bi"><span id="44b9" class="lo lp it nf b gy nj nk l nl nm">#The size for our chart:<br/>plt.figure(figsize = (12,6))</span><span id="37a9" class="lo lp it nf b gy nq nk l nl nm">#Plotting price and SMA lines:<br/>plt.plot(close, label='SPY Adj Close', linewidth = 2)<br/>plt.plot(sma50, label='50 day rolling SMA', linewidth = 1.5)</span><span id="9a76" class="lo lp it nf b gy nq nk l nl nm">#Adding title and labeles on the axes, making legend visible:<br/>plt.xlabel('Date')<br/>plt.ylabel('Adjusted closing price ($)')<br/>plt.title('Price with a single Simple Moving Average')<br/>plt.legend()</span><span id="7920" class="lo lp it nf b gy nq nk l nl nm">plt.show()</span></pre><p id="f169" class="pw-post-body-paragraph kp kq it kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">这是我们的移动平均线与价格的关系图:</p><figure class="na nb nc nd gt kd gh gi paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="gh gi nt"><img src="../Images/b9d482507318ede193b4e12a0db6d74d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dU3uwYReEUTx2Tp3FAaI5Q.png"/></div></div></figure><h2 id="fec2" class="lo lp it bd lq lr ls dn lt lu lv dp lw la lx ly lz le ma mb mc li md me mf iz bi translated">使用一个移动平均线</h2><p id="5497" class="pw-post-body-paragraph kp kq it kr b ks mg ku kv kw mh ky kz la mi lc ld le mj lg lh li mk lk ll lm im bi translated">我们的简单移动平均线做得很好，它平滑了价格运动，帮助我们直观地识别趋势:当平均线向上攀升时，我们有上升趋势。当均线向下时，我们处于下跌趋势。</p><p id="ffc6" class="pw-post-body-paragraph kp kq it kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">我们能做的不止这些:用一条均线就能产生交易信号。当收盘价从下方移动到均线上方时，我们有买入信号:</p><figure class="na nb nc nd gt kd gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/a4d92ff0d3e14e6bc7c3b9e75f02af42.png" data-original-src="https://miro.medium.com/v2/resize:fit:1120/format:webp/1*_RbynZ9o8yVLqAGNq2Yvxg.png"/></div></figure><p id="f79d" class="pw-post-body-paragraph kp kq it kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">同样，当价格从上方穿过移动平均线时，就会产生卖出信号:</p><figure class="na nb nc nd gt kd gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/763fbbc94fef43336f744ed5f6ed9dd3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1120/format:webp/1*xkQnGoaiO2q4bdDJEoy3jg.png"/></div></figure><h2 id="03a4" class="lo lp it bd lq lr ls dn lt lu lv dp lw la lx ly lz le ma mb mc li md me mf iz bi translated">绘制两个平均值并选择日期范围</h2><p id="79ac" class="pw-post-body-paragraph kp kq it kr b ks mg ku kv kw mh ky kz la mi lc ld le mj lg lh li mk lk ll lm im bi translated">让我们比较两个不同长度的移动平均线，分别是 20 天和 50 天:</p><pre class="na nb nc nd gt ne nf ng nh aw ni bi"><span id="bdfc" class="lo lp it nf b gy nj nk l nl nm">sma20 = close.rolling(window=20).mean()</span><span id="82d4" class="lo lp it nf b gy nq nk l nl nm">plt.figure(figsize = (12,6))</span><span id="d51f" class="lo lp it nf b gy nq nk l nl nm">#Plotting price with two SMAs:<br/>plt.plot(close, label='SPY Adj Close', linewidth = 2)<br/>plt.plot(sma20, label='20 day rolling SMA', linewidth = 1.5)<br/>plt.plot(sma50, label='50 day rolling SMA', linewidth = 1.5)</span><span id="0d36" class="lo lp it nf b gy nq nk l nl nm">plt.xlabel('Date')<br/>plt.ylabel('Adjusted closing price ($)')<br/>plt.title('Price with Two Simple Moving Averages')<br/>plt.legend()</span><span id="dea5" class="lo lp it nf b gy nq nk l nl nm">plt.show()</span></pre><figure class="na nb nc nd gt kd gh gi paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="gh gi nt"><img src="../Images/49fb4c1da060cea92f36f389950a5675.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vVU245iZ86K97NVWumPG0Q.png"/></div></div></figure><p id="986f" class="pw-post-body-paragraph kp kq it kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">我们的图表现在变得有点拥挤:如果能够放大我们选择的日期范围就好了。我们可以使用一个<strong class="kr jd"> plt.xlim() </strong>指令(例如<code class="fe nn no np nf b">plt.xlim('2017-01-01','2018-12-31')</code>:试着把它添加到上面的代码中)。然而，我想探索一条不同的路线:建立一个新的数据框架，包括价格和移动平均线:</p><pre class="na nb nc nd gt ne nf ng nh aw ni bi"><span id="5995" class="lo lp it nf b gy nj nk l nl nm">priceSma_df = pd.DataFrame({<br/>      'Adj Close' : close,<br/>      'SMA 20' : sma20,<br/>      'SMA 50' : sma50<br/>     })</span><span id="3ff5" class="lo lp it nf b gy nq nk l nl nm">priceSma_df</span></pre><figure class="na nb nc nd gt kd gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/74a53b3db80e412c591ad523c4d7b3e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:654/format:webp/1*Nn-n6vJ6CpgmOjQSqQyzUw.png"/></div></figure><p id="c3b4" class="pw-post-body-paragraph kp kq it kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">将我们的所有系列放在一个数据框架中，可以轻松创建快照图:</p><pre class="na nb nc nd gt ne nf ng nh aw ni bi"><span id="45ea" class="lo lp it nf b gy nj nk l nl nm">priceSma_df.plot()</span><span id="d3db" class="lo lp it nf b gy nq nk l nl nm">plt.show()</span></pre><figure class="na nb nc nd gt kd gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/da7e5ed5dbff445a2ae99f4d41b11ffb.png" data-original-src="https://miro.medium.com/v2/resize:fit:840/format:webp/1*zsoZs8Om1VIq47htziMgog.png"/></div></figure><p id="29c0" class="pw-post-body-paragraph kp kq it kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">虽然使用 dataframe own <strong class="kr jd"> plot() </strong>方法创建一个 snap plot 很方便，但是我更喜欢使用单独的函数调用来定制我的图表。将我们的所有系列放在一个数据框架中的另一个好处是，我们可以轻松选择一个<strong class="kr jd">日期范围</strong>(例如，包括 2017 年和 2018 年的日期)并仅绘制该范围内的数据:</p><pre class="na nb nc nd gt ne nf ng nh aw ni bi"><span id="297c" class="lo lp it nf b gy nj nk l nl nm">plt.figure(figsize = (12,6))</span><span id="cf75" class="lo lp it nf b gy nq nk l nl nm">#Plotting price and two SMAs with a specified date range:<br/>plt.plot(priceSma_df['2017':'2018']['Adj Close'], label='SPY Adj Close', linewidth = 2)<br/>plt.plot(priceSma_df['2017':'2018']['SMA 20'], label='20 days rolling SMA', linewidth = 1.5)<br/>plt.plot(priceSma_df['2017':'2018']['SMA 50'], label='50 days rolling SMA', linewidth = 1.5)</span><span id="5dcf" class="lo lp it nf b gy nq nk l nl nm">plt.xlabel('Date')<br/>plt.ylabel('Adjusted closing price ($)')<br/>plt.title('Price with Two Simple Moving Averages - Selected Date Range')<br/>plt.legend()</span><span id="4101" class="lo lp it nf b gy nq nk l nl nm">plt.show()</span></pre><figure class="na nb nc nd gt kd gh gi paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="gh gi nt"><img src="../Images/a7836e73a377813bf6d0f7b49c861571.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zWWnG8fJ32U9yDD2TjJiHw.png"/></div></div><figcaption class="kk kl gj gh gi km kn bd b be z dk">Dates between 2017 and 2018 included</figcaption></figure><p id="7439" class="pw-post-body-paragraph kp kq it kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">按日期范围对数据进行切片是 pandas 的一大特色。以下所有语句都有效:</p><ul class=""><li id="778d" class="ml mm it kr b ks kt kw kx la mn le mo li mp lm mq mr ms mt bi translated"><code class="fe nn no np nf b">priceSma_df['2017-04-01':'2017-06-15']</code>:由两个特定日期定义的范围</li><li id="9708" class="ml mm it kr b ks mu kw mv la mw le mx li my lm mq mr ms mt bi translated"><code class="fe nn no np nf b">priceSma_df['2017-01]</code>:某月价格</li><li id="4b2b" class="ml mm it kr b ks mu kw mv la mw le mx li my lm mq mr ms mt bi translated"><code class="fe nn no np nf b">priceSma_df['2017]</code>:某一年的价格</li></ul><h2 id="0b80" class="lo lp it bd lq lr ls dn lt lu lv dp lw la lx ly lz le ma mb mc li md me mf iz bi translated">使用两个移动平均线</h2><p id="047a" class="pw-post-body-paragraph kp kq it kr b ks mg ku kv kw mh ky kz la mi lc ld le mj lg lh li mk lk ll lm im bi translated">通过合并两条均线，我们可以使用一种叫做<em class="ln">双交叉法</em>的技术。在这种情况下，只要短均线从下方穿过长均线，就会产生买入信号。类似地，当短均线从上方穿过长均线时，就会产生卖出信号:</p><figure class="na nb nc nd gt kd gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/a757efe1bff85485201996d0505fa003.png" data-original-src="https://miro.medium.com/v2/resize:fit:1120/format:webp/1*DeydSxxPcnDzQiXEYlrk7Q.png"/></div><figcaption class="kk kl gj gh gi km kn bd b be z dk">Trading signals with two SMAs</figcaption></figure><p id="57fc" class="pw-post-body-paragraph kp kq it kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">与只使用一条均线和价格的技术相比，双交叉方法产生的拉锯更少。另一方面，它可以产生具有一定延迟的信号。</p><h2 id="5df0" class="lo lp it bd lq lr ls dn lt lu lv dp lw la lx ly lz le ma mb mc li md me mf iz bi translated">使用三条移动平均线</h2><p id="d881" class="pw-post-body-paragraph kp kq it kr b ks mg ku kv kw mh ky kz la mi lc ld le mj lg lh li mk lk ll lm im bi translated">如果我们可以一起使用两条均线，为什么不可以用三条呢？</p><pre class="na nb nc nd gt ne nf ng nh aw ni bi"><span id="40ba" class="lo lp it nf b gy nj nk l nl nm">sma200 = close.rolling(window=200).mean()</span><span id="362c" class="lo lp it nf b gy nq nk l nl nm">priceSma_df['SMA 200'] = sma200</span><span id="f320" class="lo lp it nf b gy nq nk l nl nm">priceSma_df</span></pre><figure class="na nb nc nd gt kd gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/6cdc0509b886299d13d57f83a8669fc3.png" data-original-src="https://miro.medium.com/v2/resize:fit:830/format:webp/1*xgjIj5w3zBhTxxbqJBgQcg.png"/></div></figure><pre class="na nb nc nd gt ne nf ng nh aw ni bi"><span id="aa29" class="lo lp it nf b gy nj nk l nl nm">#Our start and end dates:<br/>start = '2016'<br/>end = '2019'</span><span id="a3e4" class="lo lp it nf b gy nq nk l nl nm">plt.figure(figsize = (12,6))</span><span id="cb22" class="lo lp it nf b gy nq nk l nl nm">#Plotting price and three SMAs with start and end dates:<br/>plt.plot(priceSma_df[start:end]['Adj Close'], label='SPY Adj Close', linewidth = 2)<br/>plt.plot(priceSma_df[start:end]['SMA 20'], label='20 day rolling SMA', linewidth = 1.5)<br/>plt.plot(priceSma_df[start:end]['SMA 50'], label='50 day rolling SMA', linewidth = 1.5)<br/>plt.plot(priceSma_df[start:end]['SMA 200'], label='200 day rolling SMA', linewidth = 1.5)</span><span id="01c1" class="lo lp it nf b gy nq nk l nl nm">plt.xlabel('Date')<br/>plt.ylabel('Adjusted closing price ($)')<br/>plt.title('Price with Three Simple Moving Averages')<br/>plt.legend()</span><span id="2dd9" class="lo lp it nf b gy nq nk l nl nm">plt.show()</span></pre><figure class="na nb nc nd gt kd gh gi paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="gh gi nt"><img src="../Images/328619d765fb49c1a2c37d8742681343.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PrIt6Fd1uUUbMTXO_uqHkw.png"/></div></div><figcaption class="kk kl gj gh gi km kn bd b be z dk">Three SMAs — dates from 2016 to 2018 included</figcaption></figure><p id="94b5" class="pw-post-body-paragraph kp kq it kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">你可以看到长期 200 SMA 如何帮助我们以一种非常平稳的方式识别趋势。</p><p id="d288" class="pw-post-body-paragraph kp kq it kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">这就给我们带来了<em class="ln">三重交叉法</em>。我们使用的移动平均线的长度分别为 20、50 和 200 天，在分析师中广泛使用。当 20 日均线从下方穿过 50 日均线时，我们可以选择考虑买入信号，但只有当两条均线都在 200 日均线上方时。所有出现在 200 均线以下的买入交叉都将被忽略。</p><figure class="na nb nc nd gt kd gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/ca0029cceb599639e5a0999b5179204b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*NJHCthFMQywYWOcK3gsC1w.png"/></div><figcaption class="kk kl gj gh gi km kn bd b be z dk">Crosses above the 200 SMAs</figcaption></figure><figure class="na nb nc nd gt kd gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/38359b0bb88a02f0e76fbae1026bf42e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*3DXKR3hHV8lsPOKF3nMosA.png"/></div><figcaption class="kk kl gj gh gi km kn bd b be z dk">A cross below the 200 SMAs</figcaption></figure><p id="ee02" class="pw-post-body-paragraph kp kq it kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">本文中的例子只是结合不同长度的价格和移动平均线产生的许多可能性中的一部分。此外，价格和移动平均线可以与其他可用的<a class="ae ko" href="https://school.stockcharts.com/doku.php?id=technical_indicators" rel="noopener ugc nofollow" target="_blank">技术指标</a>或我们可以自己创建的指标相结合。Python 和 pandas 提供了研究和构建盈利交易系统所需的所有能力和灵活性。</p><p id="5840" class="pw-post-body-paragraph kp kq it kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated"><strong class="kr jd"> <em class="ln">来自《走向数据科学》编辑的提示:</em> </strong> <em class="ln">虽然我们允许独立作者根据我们的</em> <a class="ae ko" rel="noopener" target="_blank" href="/questions-96667b06af5"> <em class="ln">规则和指导方针</em> </a> <em class="ln">发表文章，但我们并不认可每个作者的贡献。你不应该在没有寻求专业建议的情况下依赖一个作者的作品。详见我们的</em> <a class="ae ko" rel="noopener" target="_blank" href="/readers-terms-b5d780a700a4"> <em class="ln">读者术语</em> </a> <em class="ln">。</em></p></div></div>    
</body>
</html>