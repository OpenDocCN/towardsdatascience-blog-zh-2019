<html>
<head>
<title>Download Course Materials with A Simple Python Crawler</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用简单的 Python 爬虫程序下载课程材料</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/download-course-materials-with-a-simple-python-crawler-94e06d5f84b5?source=collection_archive---------18-----------------------#2019-11-01">https://towardsdatascience.com/download-course-materials-with-a-simple-python-crawler-94e06d5f84b5?source=collection_archive---------18-----------------------#2019-11-01</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="efbd" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">一个自动下载课程资料的爬虫示例</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/b8dc8d6b8d3c359400798809c9cf7313.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*l03FkfkNxJQnflQygo4h0g.jpeg"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Photo by <a class="ae ky" href="https://unsplash.com/@darwiiiin?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Darwin Vegher</a> on <a class="ae ky" href="https://unsplash.com/s/photos/many-book?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="9d3b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最近我在修加州大学伯克利分校著名的<a class="ae ky" href="http://inst.eecs.berkeley.edu/~cs61a/fa18/" rel="noopener ugc nofollow" target="_blank"> CS 61A </a>。我想下载幻灯片并全部打印出来。但是总共有 36 张幻灯片。作为一个<strong class="lb iu">懒</strong>的程序员，我不会浪费宝贵的时间去点击 36 次下载按钮。所以我写了一个简单的脚本来自动下载所有的幻灯片。</p><p id="2e43" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这篇文章中，我将简单介绍你需要知道什么来构建一个简单的下载器。</p><h1 id="4299" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">找到下载按钮的模式</h1><p id="3838" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">首先，打开<a class="ae ky" href="http://inst.eecs.berkeley.edu/~cs61a/fa18/" rel="noopener ugc nofollow" target="_blank">下载页面</a>。下载按钮显示为“8pp”(见下图)，这意味着一页包含 8 张幻灯片。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ms"><img src="../Images/de1d4e1cc7148a9400a31186f252313a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uiwgszeDVYp_RNMjeYuXpQ.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">8pp is the download button</figcaption></figure><p id="7c59" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">好了，接下来我们在 Chrome 中打开<a class="ae ky" href="https://developers.google.com/web/tools/chrome-devtools/open" rel="noopener ugc nofollow" target="_blank"> DevTools </a>。您也可以在其他浏览器中找到 DevTools。单击 DevTools 左上角的箭头图标，然后将光标移动到“8pp”按钮，这将突出显示 DevTools 中的 HTML 元素。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mt"><img src="../Images/0b318834cb71a7e9dc7ada82344621c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*3YSIjwg2oHpMEJR4X8u8tA.gif"/></div></div></figure><p id="55ba" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以得到下面的 HTML 行。下载链接为“assets/slides/01-Functions _ 8pp . pdf”和“assets/slides/02-Names_8pp.pdf”。这些链接在<code class="fe mu mv mw mx b">a</code>标签的<code class="fe mu mv mw mx b">href</code>属性中。</p><pre class="kj kk kl km gt my mx mz na aw nb bi"><span id="bcf7" class="nc lw it mx b gy nd ne l nf ng">&lt;li&gt;&lt;a href="assets/slides/01-Functions_full.pdf" class="label label-outline"&gt;full&lt;/a&gt;&lt;/li&gt;<br/>&lt;li&gt;&lt;a href="assets/slides/01-Functions_1pp.pdf" class="label label-outline"&gt;1pp&lt;/a&gt;&lt;/li&gt;<br/>&lt;li&gt;&lt;a href="assets/slides/01-Functions_8pp.pdf" class="label label-outline"&gt;<strong class="mx iu">8pp</strong>&lt;/a&gt;&lt;/li&gt;<br/>&lt;li&gt;&lt;a href="assets/slides/01.py" class="label label-outline"&gt;01.py&lt;/a&gt;&lt;/li&gt;<br/>...<br/>&lt;li&gt;&lt;a href="assets/slides/02-Names_full.pdf" class="label label-outline"&gt;full&lt;/a&gt;&lt;/li&gt;<br/>&lt;li&gt;&lt;a href="assets/slides/02-Names_1pp.pdf" class="label label-outline"&gt;1pp&lt;/a&gt;&lt;/li&gt;<br/>&lt;li&gt;&lt;a href="assets/slides/02-Names_8pp.pdf" class="label label-outline"&gt;<strong class="mx iu">8pp</strong>&lt;/a&gt;&lt;/li&gt;<br/>&lt;li&gt;&lt;a href="assets/slides/02.py" class="label label-outline"&gt;02.py&lt;/a&gt;&lt;/li&gt;</span></pre><p id="f62d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们希望自动提取所有链接。所以我们必须找到这些<code class="fe mu mv mw mx b">a</code>标签行的一些模式。一个非常明确的模式是，它们都包含 8pp 文本(上面代码中的粗体部分)。我们可以先找到包含 8pp 文本的<code class="fe mu mv mw mx b">a</code>标签行，然后通过<code class="fe mu mv mw mx b">href</code>属性提取链接。</p><h1 id="c777" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">找到包含“8pp”的<code class="fe mu mv mw mx b">a</code>标签行</h1><p id="df1e" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">我们使用<a class="ae ky" href="https://www.w3schools.com/xml/xpath_intro.asp" rel="noopener ugc nofollow" target="_blank"> XPath </a>来定位<code class="fe mu mv mw mx b">a</code>标记行。</p><pre class="kj kk kl km gt my mx mz na aw nb bi"><span id="1a22" class="nc lw it mx b gy nd ne l nf ng">slide_links = html.xpath('//li/a[text()="8pp"]/@href')</span></pre><p id="7411" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以认为<code class="fe mu mv mw mx b">html</code>是下载页面的全部 HTML 源代码。然后我们用 XPath 提取链接。<code class="fe mu mv mw mx b">//</code>是整页的开始。<code class="fe mu mv mw mx b">li/a</code>表示我们在<code class="fe mu mv mw mx b">li</code>标签下找到所有<code class="fe mu mv mw mx b">a</code>标签行。<code class="fe mu mv mw mx b">[text()="8pp"]</code>是一个过滤器，用于获取那些只包含“8pp”文本的<code class="fe mu mv mw mx b">a</code>标签行。</p><h1 id="f5fa" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated"><strong class="ak">完成下载链接</strong></h1><p id="5cbc" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">我们得到的<code class="fe mu mv mw mx b">slide_links</code>如下图所示</p><pre class="kj kk kl km gt my mx mz na aw nb bi"><span id="c1c2" class="nc lw it mx b gy nd ne l nf ng">['assets/slides/36-Natural_Language_8pp.pdf', <br/> 'assets/slides/37-Final_Examples_8pp.pdf', <br/> 'assets/slides/36-Natural_Language_8pp.pdf', <br/> ...]</span></pre><p id="d4b9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们必须添加一个前缀来完成下载链接。前缀是下面的<code class="fe mu mv mw mx b">url</code>。</p><pre class="kj kk kl km gt my mx mz na aw nb bi"><span id="a199" class="nc lw it mx b gy nd ne l nf ng">url = 'http://inst.eecs.berkeley.edu/~cs61a/fa18/'</span></pre><h1 id="9f89" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">总结一下</h1><p id="0071" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">在运行脚本之前，您需要安装一些 Python 包。</p><pre class="kj kk kl km gt my mx mz na aw nb bi"><span id="6ff9" class="nc lw it mx b gy nd ne l nf ng">pip install requests<br/>pip install lxml<br/>pip install wget</span></pre><p id="abea" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe mu mv mw mx b">requests</code>是一个进行 HTTP 请求的工具。<code class="fe mu mv mw mx b">lxml</code>是一个使用 XPath 的工具。而<code class="fe mu mv mw mx b">wget</code>是给定网址下载素材文件的工具。</p><p id="8059" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">别忘了创建一个“幻灯片”文件夹来存放下载的文件。</p><p id="f237" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在你做好准备之后，你可以运行下面的脚本来下载所有的材料。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nh ni l"/></div></figure><blockquote class="nj nk nl"><p id="405b" class="kz la nm lb b lc ld ju le lf lg jx lh nn lj lk ll no ln lo lp np lr ls lt lu im bi translated"><strong class="lb iu"> <em class="it">查看我的其他帖子</em> </strong> <a class="ae ky" href="https://medium.com/@bramblexu" rel="noopener"> <strong class="lb iu"> <em class="it">中等</em> </strong> </a> <strong class="lb iu"> <em class="it">同</em> </strong> <a class="ae ky" href="https://bramblexu.com/posts/eb7bd472/" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu"> <em class="it">一分类查看</em> </strong> </a> <strong class="lb iu"> <em class="it">！<br/>GitHub:</em></strong><a class="ae ky" href="https://github.com/BrambleXu" rel="noopener ugc nofollow" target="_blank"><strong class="lb iu"><em class="it">bramble Xu</em></strong></a><strong class="lb iu"><em class="it"><br/>LinkedIn:</em></strong><a class="ae ky" href="https://www.linkedin.com/in/xu-liang-99356891/" rel="noopener ugc nofollow" target="_blank"><strong class="lb iu"><em class="it">徐亮</em> </strong> </a> <strong class="lb iu"> <em class="it"> <br/>博客:</em></strong><a class="ae ky" href="https://bramblexu.com" rel="noopener ugc nofollow" target="_blank"><strong class="lb iu"><em class="it">bramble Xu</em></strong></a></p></blockquote></div></div>    
</body>
</html>