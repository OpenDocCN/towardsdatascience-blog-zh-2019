<html>
<head>
<title>Tableau+Python: TabPy and geographical clustering</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">tableau+Python:tabby 和地理聚类</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/tableau-python-tabpy-and-geographical-clustering-219b0583ded3?source=collection_archive---------14-----------------------#2019-05-03">https://towardsdatascience.com/tableau-python-tabpy-and-geographical-clustering-219b0583ded3?source=collection_archive---------14-----------------------#2019-05-03</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="5bf5" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用 K-means 聚类分析探索数据的简单方法。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/4afda7cce8d558b0fe7308353dfbf53c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*B-pU3vJU0NHFCSNMpO43OA.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Dashboard for clustering AirBNB</figcaption></figure><p id="6d87" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这是一个关于如何使用 Tableau 扩展在地图上进行 K-Means 聚类的简短教程。</p><p id="cf64" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">TabPy 可以在这里下载<a class="ae lu" href="https://github.com/tableau/TabPy" rel="noopener ugc nofollow" target="_blank">或者，如果你使用 conda:</a></p><p id="ca55" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu">conda install-c anaconda tabby-server</strong></p><p id="c53d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">关于如何安装和运行 tabpy server 的文章有很多，但是我个人遇到了两个问题:</p><ol class=""><li id="4580" class="lv lw it la b lb lc le lf lh lx ll ly lp lz lt ma mb mc md bi translated"><em class="me">权限错误:[WinError 5]访问被拒绝</em>。在这里<a class="ae lu" href="https://github.com/tableau/TabPy/issues/101" rel="noopener ugc nofollow" target="_blank">解决</a></li><li id="bbaa" class="lv lw it la b lb mf le mg lh mh ll mi lp mj lt ma mb mc md bi translated"><em class="me">无法使用 windows 批处理文件 startup.bat 运行 tabby server</em><a class="ae lu" href="https://github.com/tornadoweb/tornado/issues/2616#issuecomment-470365272" rel="noopener ugc nofollow" target="_blank">解决方法是安装 tornado-5.1。</a></li></ol><p id="b044" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">正如我提到的，我的目标是测试 tabpy 功能，我选择了集群问题作为最常见的问题之一。K-Means 算法是一个很好的工具，可以在不做任何假设的情况下探索你的约会。关于 K-Means 有很多教程:有些是<a class="ae lu" rel="noopener" target="_blank" href="/clustering-using-k-means-algorithm-81da00f156f6">这里</a>和<a class="ae lu" rel="noopener" target="_blank" href="/k-means-clustering-8e1e64c1561c">这里</a>。数据来源— <a class="ae lu" href="https://public.tableau.com/en-us/s/resources" rel="noopener ugc nofollow" target="_blank"> <strong class="la iu">纽约市 Airbnb 房源</strong> </a>公布于 Tableau 公共资源。</p><p id="9679" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">该表由几个维度组成:</p><ul class=""><li id="6e62" class="lv lw it la b lb lc le lf lh lx ll ly lp lz lt mk mb mc md bi translated">邮政编码</li><li id="65d3" class="lv lw it la b lb mf le mg lh mh ll mi lp mj lt mk mb mc md bi translated">属性类型</li><li id="8ae5" class="lv lw it la b lb mf le mg lh mh ll mi lp mj lt mk mb mc md bi translated">邻近</li><li id="a60e" class="lv lw it la b lb mf le mg lh mh ll mi lp mj lt mk mb mc md bi translated">房型等。</li></ul><p id="30ee" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我用邮政编码来绘制地图。主要维度，大家可能会感兴趣:物业类型，主机自(时间维度)。</p><p id="2c1c" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">首先，我创建了两个控制参数来管理集群:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ml"><img src="../Images/a5eadd5c73920cf0203bba44948a195c.png" data-original-src="https://miro.medium.com/v2/resize:fit:608/format:webp/1*lePhdYoAIc59uaBGA6QUiw.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Tableau Control Parameters</figcaption></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mm"><img src="../Images/af8c035a8a7cbc76468c70e1e8335661.png" data-original-src="https://miro.medium.com/v2/resize:fit:1134/format:webp/1*FgMWCojgWF-s_iUPuoPPgA.png"/></div></figure><p id="2f27" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">聚类方法，顾名思义，就是负责一个聚类算法。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mn"><img src="../Images/53473cb8843e574c758974f96b96c62c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1146/format:webp/1*z6TJNqyCUwJml7ZzXA7zbQ.png"/></div></figure><p id="4485" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">使用<strong class="la iu"> SCRIPT_REAL </strong>函数将脚本嵌入到计算字段中:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mo mp l"/></div></figure><p id="c4df" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">使用 tapby 的一个特点是，它将数据作为列表发送到服务器，因此需要将数据转换为 np.array 并在一列中整形。另一个技巧是删除所有具有 NAN 值的行，这在<strong class="la iu">第 16 行完成。</strong></p><p id="ea34" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu"> _arg5 </strong>和<strong class="la iu"> _arg6 </strong>对应管理参数。尽管它们是单个值，但它们也被打包到列表中，因此为了对 python 解包它们，应该使用<strong class="la iu"> _arg5[0] </strong>和<strong class="la iu"> _arg6[0] </strong>。</p><p id="8279" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">此外，有时算法不起作用，因为表格计算使用了错误的维度。在我的例子中，我使用了沿着<strong class="la iu">邮政编码</strong>的计算。默认的表计算很少工作，所以每次在代码中查找错误之前检查这个选项。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mq"><img src="../Images/3116296303ced50f85b3414d916460b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qqEDkMjT8PV6sbDnk_AkTQ.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Default Table Calculations</figcaption></figure><p id="bf8a" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">为了看看我们的聚类是否有意义，我添加了几个散点图来可视化潜在变量的联合分布:</p><ol class=""><li id="9818" class="lv lw it la b lb lc le lf lh lx ll ly lp lz lt ma mb mc md bi translated">平均值。价格与评论数量</li><li id="a84c" class="lv lw it la b lb mf le mg lh mh ll mi lp mj lt ma mb mc md bi translated">平均值。价格与中值评审分数评级</li><li id="9867" class="lv lw it la b lb mf le mg lh mh ll mi lp mj lt ma mb mc md bi translated">审查数量与总数(床位)</li></ol><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mr"><img src="../Images/de23a361f6ceeeb7c2c9da8d617637e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jPn1u2W6o5AthIxN8pXhUw.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Scatterplots of joint distribution</figcaption></figure><p id="6dbb" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">可以看出，聚类没有很好地定义，所以我们的简单模型和随机选取一样好，但至少它没有错误👌。</p><p id="9be2" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">为了增加图形和地图之间的交互性，可以创建仪表板动作。我在<em class="me">仪表盘&gt;动作</em>中添加了悬停动作。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ms"><img src="../Images/c63502e1876c8d3cef845dc8124a5758.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GayFMowxM6o5H8Bsze3nMA.png"/></div></div></figure><p id="e1fb" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这是我第一次使用 TabPy，到目前为止，它的用处有限，但我希望 Tasbleau 将进一步发展它。</p><p id="6fec" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu">附言</strong></p><p id="f155" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">此外，有时我会给<a class="ae lu" href="https://t.me/seeking_for_alpha" rel="noopener ugc nofollow" target="_blank">电报</a>(大部分是俄语)写一些关于资产管理的内容。</p></div></div>    
</body>
</html>