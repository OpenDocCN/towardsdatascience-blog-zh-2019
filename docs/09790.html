<html>
<head>
<title>Deep Learning to Predict US Inflation</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">深度学习预测美国通胀</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/deep-learning-to-predict-us-inflation-70f26405bf76?source=collection_archive---------14-----------------------#2019-12-23">https://towardsdatascience.com/deep-learning-to-predict-us-inflation-70f26405bf76?source=collection_archive---------14-----------------------#2019-12-23</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="ed10" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">卷积神经网络分析</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/27e292dd8bd6defe587d1dfbe614ef5d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*NTymzW-A3zbEODCd"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Photo by <a class="ae ky" href="https://unsplash.com/@jpvalery?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Jp Valery</a> on <a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="b880" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">我们为什么关心通货膨胀？</h1><p id="9657" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">理解和预测未来的通胀率对政策制定者和投资者来说都是极其重要的。根据定义，通货膨胀是一个经济体内部价格随时间的变化。虽然价格上涨似乎是一件坏事，但当价格上涨放缓时，这表明经济强劲增长。</p><p id="85b4" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">通胀预期是货币政策影响经济活动的最重要渠道之一。它们在生产者和零售商层面的消费品价格形成过程中发挥着显著的作用。经济代理人发现经常调整价格的成本相对较高，因为他们必须承担推广和宣传新价格的相关成本。短期内将产品定价过高的个人可能会看到较低的销售额，而在投入成本上升时将产品定价过低的个人可能会被迫承担损失，减少利润，甚至被迫退出市场。</p><p id="4723" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">这进一步影响了金融市场，因为投资者必须预测通货膨胀将如何影响实际收益回报，以及公司是否能够在经济停滞期间保持利润增长。从长远来看，通货膨胀要么会推高工资，要么会导致个人购买力下降。这两种情况都会增加投入成本，包括劳动力和资本成本，或者降低消费者需求，因为在相同的收入水平下，个人可以购买更少的产品，从而损害企业利润。</p><p id="7cb3" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">所有这些影响都会影响政策制定者，尤其是那些维持货币政策的央行官员。央行行长致力于控制经济中的通货膨胀和货币供应，以保持经济结构健康和可持续增长。如果通货膨胀率过低，经济就会停滞不前。如果它变得太高，那么资金开始迅速贬值，个人和企业失去购买力，市场对投资者来说风险更大。央行行长和政策制定者密切跟踪通胀，部分原因是为了设定基准利率。对这些利率的预期最终决定了企业和个人支付的利率，从家庭和企业贷款到信用卡利率。</p><p id="4dcd" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">对于企业、金融机构、政策制定者甚至个人来说，制定一个稳健的通胀预期预测对于更好地在市场中做出决策至关重要。无论是设定产品价格、确定贷款还款计划，还是决定为退休存多少钱，对未来价格和消费的敏锐理解都至关重要。</p><h1 id="1160" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">数据</h1><p id="6fd9" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">对于数据，我使用来自 FRED-MD 数据库的 CPIAUSL 系列。FRED-MD 是一个由圣路易斯美联储委员会维护的数据库，旨在对大数据进行“实证分析”。“数据通过 FRED 数据库实时更新。</p><p id="d3e0" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">CPIAUSL 变量代表所有城市消费者的所有项目消费价格指数。它是衡量城市消费者支付的商品和服务价格平均每月变化的指标。该指数由美国劳工统计局根据每月的产品调查计算得出。指数值是计算与上一年同月相比价格或通货膨胀百分比变化的基础。虽然这一变量不是美联储设定利率时最密切关注的，但它是最常见的通货膨胀预测变量之一。</p><p id="fa60" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">对于这一分析，我预测了每个时期价格指数的变化，并将这一变化转换为年度百分比变化(与一年前同一个月相比的百分比变化)。从数据库文档中，我们知道数据已经去季节性，所以我们不需要解构序列来获得其趋势。首先对该序列进行差分以产生平稳性，然后用具有单一特征的滚动 18 个月周期的张量来构造。滚动平均输入的结构类似。在对序列进行差分后，计算移动平均值，然后将其构建为 18 个月滚动期的张量，其中三个移动平均值中的每一个都作为一个特征。</p><h1 id="cd94" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">时间序列数据的卷积建模</h1><p id="61bb" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">为了这个分析，我开发了一个卷积神经网络(CNN)来预测未来 12 个月的通货膨胀。</p><p id="6d32" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">卷积神经网络是一系列深度学习算法，最初是为图像分类而设计的。该网络获取一幅图像，将该图像通过一组对该图像的不同方面应用权重的过滤器，并最终提供预测。这就像一个特征工程系统，随着时间的推移，网络“学习”什么样的特征过滤器在图像分类中最重要。</p><p id="de3e" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">类似的方法可以应用于时间序列。虽然时间序列不像图像那样具有“物理”特征，但时间序列数据确实包含时间维度特征。如果我们将时间序列数据想象成一幅图像，我们可以将卷积网络想象成一盏聚光灯或一扇窗户，它扫描整个时间段，照亮该时间段内序列的形状，然后对其进行过滤，以找到它最能代表的特征形状。这种模式的简单说明如下:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ms"><img src="../Images/48464d31aaa647c21e67b89eb9cbbd36.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Cz-mvHeMVloPZSSRkn_gtQ.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Illustrative example of a Convolutional Network for time series (weights are stylized)</figcaption></figure><h1 id="fd35" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">模型架构</h1><p id="5a20" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">我用来分析的 CNN 网络如下图所示。首先，我们从两个输入开始，原始通货膨胀时间序列和三个移动平均平滑序列。每个平滑系列代表任何给定观测值的前三个月、六个月和一年的移动平均值。</p><p id="6c62" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">这些输入然后被馈送到单独的卷积层，以提取每个输入序列的相对重要的特征权重。这些结果然后被汇集并馈入完全连接的层，然后被合并在一起并传递给一系列完全连接的块。全连接块堆栈中的每个后续块包含的节点比前一堆栈中的少。在每个块之间，使用剩余或跳过连接，允许模型使用在早期层中学习的信息来继续训练后面的层。这防止了从卷积层输出的信息太快丢失或被模型的后续层模糊。这也有助于防止渐变消失的问题，并允许原始序列中的一些较小的细节在模型结构中进一步保留。最后，在输出最终预测之前，将对最终图层应用一个丢弃。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mt"><img src="../Images/b6a5d6a4a731e3e90a7adbbe2b711eb0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IvIjhh7tg_jwbADLa5zALg.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Diagram of model architecture</figcaption></figure><h1 id="b598" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">结果</h1><p id="9e22" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">在对数据进行差分后，我将数据集分成训练集和测试集(70/30 分割)。数据在截至 2001 年 6 月的所有月份中进行训练，然后对 2001 年 7 月到 2019 年 9 月进行预测。我使用一步滚动预测。对于测试组中的每个月，预测接下来 12 个月中每个月的通货膨胀率，然后使用观察到的通货膨胀值来预测接下来 12 个月的组。然而，在此过程中，模型在培训期间每五个月才重新培训一次。预测以多元方式进行，同时预测随后 12 个月中的每个月，并在系列中每 10 次观察时进行验证。</p><p id="40d3" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">这是一个相当现实的方法，因为在预测下一个通货膨胀期时，分析师会观察到所有前期的通货膨胀率。通过使用一步预测，我们保持这种不断增长的建模信息。然而，在实际情况下，分析师将每月重新训练模型，这可能导致预测的改进，因为模型适合更多、更近的信息。这将允许该模型挑选出随时间推移可能发生的系列中的任何结构变化。</p><p id="cd97" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">模型的误差率以指数值的形式表示。因此，如果指数在时间 T 为 150，在时间 T+1 增加到 154，模型将试图预测 4 个点的增加。如果模型预测有 3 个点的增长，那么该时间段的误差将为 1。</p><p id="d73d" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">作为模型的基准，我给出了专业预测者调查(SPF)和费城美联储 DAR 模型(SPF 的最高表现基准)测试期间的误差率。SPF 是美国持续时间最长的宏观经济指标预测调查。这些基准的错误率是根据 SPF 官方错误率文档计算的。</p><p id="3cea" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">下面是模型结果的总结:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mu"><img src="../Images/353a218a8aba1510d4a180698e9821b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ICAm2PFzPA9ASBH-hOXMeg.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Model and benchmark error results</figcaption></figure><p id="d329" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我们可以看到，多元卷积模型远远优于动态自回归回归模型和调查汇总预测。虽然在这些预测如何运行以及误差如何表现方面存在一些差异，但我们可以看到卷积模型在每个时间段都优于这些更传统的方法。SPF 预测按季度在每个季度的中期进行，然后在当前季度末和随后的季度进行预测，而不是按月进行。仍然可以通过将每个季度预测视为三个月的预测，将当前季度预测视为大约一个月的预测来进行比较。</p><p id="5884" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">下面，我们可以看到模型在整个时间序列中的表现。总的来说，我们可以看到模型与数据拟合得很好，只是在方差较大的时期或趋势变化很快的时候，误差会稍微大一些。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mv"><img src="../Images/e456c60da609091226e850f4a5a09b3b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3kEUjwPbkR8ROBDzVhm67Q.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Forecasts performance 1960–2019</figcaption></figure><p id="d17b" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">如果我们更仔细地观察测试期，我们会发现该模型在 2008 年金融危机前和危机后的几年表现良好。在危机期间，该模型表现稍差。这并不奇怪，因为 2008 年金融危机是自大萧条以来最严重的金融衰退。因此，该模型没有经过任何类似数据的训练，因此无法准确地运行。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mw"><img src="../Images/bca43a3a092aeeea867ed1fcf2aa6e05.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Gb6kC9CyHmbSkDhoOdlGQw.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Forecast performance 2001–2019</figcaption></figure><h1 id="cab1" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">结论</h1><p id="9d1c" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">根据这一分析，有强有力的证据支持使用卷积神经网络来预测和预报美国的通货膨胀。这项分析只使用了一个单一的预测变量，通货膨胀的历史，以预测未来的通货膨胀率。有可能通过增加额外的预测因子来提高模型的性能。也有可能通过在滚动预测的每个月重新训练模型来提高性能。这将是最现实的情况，因为随着新数据的出现，分析师通常会每月重新建模他们的预测。</p><p id="403d" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">利用其他机器学习方法，例如长短期记忆网络，也可以通过允许对数据的时间分量进行额外建模来提高模型性能。但这将是未来分析的主题</p><p id="eaf7" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">下面是相关数据源的链接，以及我的 GitHub，其中包括用于此分析的 jupyter 笔记本。我将继续更新代码和完善模型，因此结果可能会略有变化。</p><h1 id="82c2" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">附录</h1><div class="mx my gp gr mz na"><a href="https://www.philadelphiafed.org/research-and-data/real-time-center/survey-of-professional-forecasters/data-files/error-statistics" rel="noopener  ugc nofollow" target="_blank"><div class="nb ab fo"><div class="nc ab nd cl cj ne"><h2 class="bd iu gy z fp nf fr fs ng fu fw is bi translated">专业预报员调查的预报误差统计</h2><div class="nh l"><h3 class="bd b gy z fp nf fr fs ng fu fw dk translated">下面的 PDF 和文本文件包含了对大多数变量预测准确性的最新统计数据…</h3></div><div class="ni l"><p class="bd b dl z fp nf fr fs ng fu fw dk translated">www.philadelphiafed.org</p></div></div></div></a></div><div class="mx my gp gr mz na"><a href="https://research.stlouisfed.org/econ/mccracken/fred-databases/" rel="noopener  ugc nofollow" target="_blank"><div class="nb ab fo"><div class="nc ab nd cl cj ne"><h2 class="bd iu gy z fp nf fr fs ng fu fw is bi translated">迈克尔·麦克拉肯</h2><div class="nh l"><h3 class="bd b gy z fp nf fr fs ng fu fw dk translated">圣路易斯美联储银行助理副总裁 Michael W. McCracken 的主页</h3></div><div class="ni l"><p class="bd b dl z fp nf fr fs ng fu fw dk translated">research.stlouisfed.org</p></div></div><div class="nj l"><div class="nk l nl nm nn nj no ks na"/></div></div></a></div><div class="mx my gp gr mz na"><a href="https://github.com/acertainKnight/FRED_Forecasting_Final" rel="noopener  ugc nofollow" target="_blank"><div class="nb ab fo"><div class="nc ab nd cl cj ne"><h2 class="bd iu gy z fp nf fr fs ng fu fw is bi translated">acertainKnight/FRED _ 预测 _ 最终</h2><div class="nh l"><h3 class="bd b gy z fp nf fr fs ng fu fw dk translated">此时您不能执行该操作。您已使用另一个标签页或窗口登录。您已在另一个选项卡中注销，或者…</h3></div><div class="ni l"><p class="bd b dl z fp nf fr fs ng fu fw dk translated">github.com</p></div></div><div class="nj l"><div class="np l nl nm nn nj no ks na"/></div></div></a></div></div></div>    
</body>
</html>