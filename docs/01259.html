<html>
<head>
<title>Learning Theory: Empirical Risk Minimization</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">学习理论:经验风险最小化</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/learning-theory-empirical-risk-minimization-d3573f90ff77?source=collection_archive---------2-----------------------#2019-02-27">https://towardsdatascience.com/learning-theory-empirical-risk-minimization-d3573f90ff77?source=collection_archive---------2-----------------------#2019-02-27</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/06d6562d4f49a3dde58b3d144103a0dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Wae_Av7jW6VcwBzk.jpg"/></div></div></figure><p id="64e3" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">经验风险最小化是机器学习中的一个基本概念，然而令人惊讶的是许多从业者并不熟悉它。理解 ERM 对于理解机器学习算法的限制以及形成实用的问题解决技能的良好基础是至关重要的。企业风险管理背后的理论是解释风险资本维度、大概正确(PAC)学习和其他基本概念的理论。在我看来，任何认真对待机器学习的人都应该乐于谈论 ERM。我将尽可能简单、简短和有理论依据地解释基本概念。这篇文章在很大程度上基于 Schwartz 和 Ben-David 的书<a class="ae kz" href="http://www.cs.huji.ac.il/~shais/UnderstandingMachineLearning" rel="noopener ugc nofollow" target="_blank">理解机器学习</a>，我强烈推荐给任何对学习理论基础感兴趣的人。</p><p id="ec49" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">先说一个简单的监督学习分类问题。假设我们要对垃圾邮件进行分类，这可能是机器学习中最常用的例子(注意，这不是关于朴素贝叶斯的帖子)。每封邮件都有一个标签 0 或 1，要么是垃圾邮件，要么不是垃圾邮件。我们用<strong class="kd iu"> <em class="la"> X </em> </strong>表示领域空间，用<strong class="kd iu"> <em class="la"> Y </em> </strong>表示标签空间，我们还需要一个将领域集合空间映射到标签集合空间的函数，<em class="la"/><strong class="kd iu"><em class="la">f:X-&gt;Y</em></strong>，这只是一个学习任务的形式化定义。</p><p id="f3ea" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">现在我们有了正式的问题定义，我们需要一个模型来做出我们的预测:垃圾邮件或不是垃圾邮件。巧合的是，<strong class="kd iu">模型</strong>的同义词是假设<strong class="kd iu"> <em class="la"> h </em> </strong>，可能有点混乱。在这种情况下，假设只不过是一个从我们的域<strong class="kd iu"> <em class="la"> X </em> </strong>获取输入并产生标签 0 或 1 的函数，即函数<strong class="kd iu"><em class="la">h:X-&gt;Y</em></strong><em class="la">。</em></p><p id="948f" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">最后，我们实际上想找到最小化我们误差的假设，对吗？由此，我们得出了经验风险最小化这一术语。术语“经验的”意味着我们基于来自领域集合<strong class="kd iu"> X </strong>的样本集合<strong class="kd iu"> <em class="la"> S </em> </strong>来最小化我们的误差。从概率的角度来看，我们说我们从域集合<strong class="kd iu"> X </strong>中采样<strong class="kd iu"> <em class="la"> S </em> </strong>，其中<strong class="kd iu"> <em class="la"> D </em> </strong>是在<strong class="kd iu"> X </strong>上的分布。因此，当我们从域中采样时，我们表示从域<strong class="kd iu"> X </strong>中通过<strong class="kd iu"><em class="la">D</em></strong>(<strong class="kd iu">S</strong>)采样的域子集的可能性有多大。</p><p id="1be1" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在下面的等式中，我们可以定义<strong class="kd iu">真误差</strong>，它基于整个域<strong class="kd iu"> X </strong>:</p><figure class="lc ld le lf gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi lb"><img src="../Images/6be695c5ca70021052c9bfcca352d8be.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yNYkfc4WczgNvYYoLxCm0Q.png"/></div></div><figcaption class="lg lh gj gh gi li lj bd b be z dk">The error for hypothesis h. Starting from left to right, we calculate the error L based on a domain distribution D and a label mapping f. The error is equal to the probability of sampling x from d such that the label produced by the hypothesis is different from the actual label mapping.</figcaption></figure><p id="f799" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">由于我们只能访问输入域的子集<strong class="kd iu"> <em class="la"> S </em> </strong>，因此我们是基于训练示例的样本进行学习的。我们无法访问<strong class="kd iu">真实误差</strong>，但可以访问<strong class="kd iu">经验误差</strong>:</p><figure class="lc ld le lf gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi lk"><img src="../Images/88a338344194a3d6f53a876c496c3095.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3gv-eAjhBxHB4ZGJi5EbjA.png"/></div></div><figcaption class="lg lh gj gh gi li lj bd b be z dk">m denotes the number of training examples. You can see from the equation that we effectively define the empirical error as the fraction of misclassified examples in the set S.</figcaption></figure><p id="c051" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">经验误差有时也被称为概括误差。原因是，实际上，在大多数问题中，我们无法访问输入的整个域<strong class="kd iu"><em class="la"/></strong>，而只能访问我们的训练子集<strong class="kd iu"><em class="la"/></strong><em class="la">。W </em> e 想在<strong class="kd iu"> <em class="la"> S </em> </strong>的基础上进行归纳学习，也叫归纳学习。这个误差也被称为<strong class="kd iu">风险，</strong>因此在经验风险最小化中称为风险。如果这让你想起了小批量梯度下降，那你就对了。这个概念在现代机器学习中基本是无处不在的。</p><p id="d82d" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">现在可以谈谈<strong class="kd iu">过拟合</strong>的问题了。也就是说，由于我们只有数据的子样本，可能会发生这样的情况:我们最小化了<strong class="kd iu">经验误差</strong>，但实际上增加了<strong class="kd iu">真实误差。</strong>这个结果可以在简单的曲线拟合问题中观察到。让我们想象一下，我们有一些想要控制的机器人，我们想要将一些传感器数据<strong class="kd iu"> X </strong>映射到扭矩。传感器数据有某种噪声，因为传感器从来都不是完美的，在这种情况下，我们将对传感器数据使用简单的高斯噪声。我们拟合了一个神经网络来做这件事，并且我们获得了以下结果:</p><figure class="lc ld le lf gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi ll"><img src="../Images/427d4ac6028c38aa20cb95feb30225d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eLwypdV5kPr8LK6KRCnqZg.png"/></div></div><figcaption class="lg lh gj gh gi li lj bd b be z dk">The green points are the points that were used in fitting the model, our sample S. The model is actually quite good considering the small number of training points, but deviations from the optimal curve can be seen.</figcaption></figure><p id="ce17" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我们可以从另一个图中看到这种泛化误差，请注意，在某个点上，真实误差开始增加，而经验误差进一步减少。这是模型过度拟合训练数据的结果。</p><figure class="lc ld le lf gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi lm"><img src="../Images/64a6383aa9f48867a8ef04b0391f28fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9nQH7za04mVwrTPT4t5RCw.png"/></div></div></figure></div><div class="ab cl ln lo hx lp" role="separator"><span class="lq bw bk lr ls lt"/><span class="lq bw bk lr ls lt"/><span class="lq bw bk lr ls"/></div><div class="im in io ip iq"><p id="8a74" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">既然我们已经定义了我们的<strong class="kd iu">经验风险</strong>和<strong class="kd iu">实际风险</strong>，那么问题就来了，我们是否真的能用这些做些有用的事情？事实证明，我们可以有把握地保证 ERM 将会发挥作用。换句话说，我们希望以一定的信心得出模型误差的上界。上界的意思很简单，我们可以保证误差不会超过这个界限，因此有了界这个词。</p><figure class="lc ld le lf gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi lu"><img src="../Images/e03d52aa958b1af24b34427392f45ba3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UhO0U-qmSIExjNvlKZOXPA.png"/></div></div><figcaption class="lg lh gj gh gi li lj bd b be z dk">This gives us the probability that a sampled set S (or training data in other words) is going to overfit the data, i.e. that the true error(L) is going to be larger than a certain number epsilon.</figcaption></figure><p id="ed76" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在当前情况下，我们将在<strong class="kd iu">可实现性假设</strong>下操作。我不打算写正式的定义，但简而言之，假设表明在所有可能的假设<strong class="kd iu"><em class="la"/></strong>的空间中存在一个假设<strong class="kd iu"> <em class="la"> h </em> </strong>，该假设在真实风险为 0 的意义上是最优的，这也意味着在子集<strong class="kd iu"> <em class="la"> S </em> </strong>上找到的假设实现了 0 经验误差。当然，这在现实世界的用例中大多是不正确的，有一些学习范例放松了这种假设，但这一点我可能会在另一篇文章中讨论。</p><p id="fc5d" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">让我们定义真实误差高于ε的一组假设:</p><figure class="lc ld le lf gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi lv"><img src="../Images/d69289813af92f0597d9fc4d0ccd7342.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OqWfuKwb_ucC6Pcsuaa-dw.png"/></div></div></figure><p id="0f26" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">对于这组假设，很明显，要么他们接受了一组非代表性的学习，这导致了低的经验误差(风险)和高的真实误差(风险)，要么他们没有好到足以学到任何东西。</p><p id="90e6" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我们想要分离导致假设的误导性训练集，这些假设导致低经验误差和高真实误差(过拟合的情况)，这将在稍后推导上限时有用:</p><figure class="lc ld le lf gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi lw"><img src="../Images/e87d9deb067bd446d754872a02b2b954.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cz_LsoSsyShfA8qwR_jKSA.png"/></div></div></figure><p id="6fcc" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">抽样一个非代表性样本的特定子集<strong class="kd iu"> <em class="la"> S </em> </strong>的概率在逻辑上等于或低于抽样<strong class="kd iu"> <em class="la"> M </em> </strong>的概率，因为<strong class="kd iu"> <em class="la"> S </em> </strong>是<strong class="kd iu"><em class="la"/></strong>M 的子集，因此我们可以写成:</p><figure class="lc ld le lf gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi lx"><img src="../Images/76235bcc0faae966de1a540a6bd41ef3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uh1SN_p0-8ieg_TG8yQkDQ.png"/></div></div></figure><p id="250c" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我们将并集界引理应用于等式的右侧，该引理表示对两个集合的并集进行采样的概率低于对它们分别进行采样的概率。这就是为什么我们可以把总数写在右边:</p><figure class="lc ld le lf gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi ly"><img src="../Images/bff57c1c25c8ed9a369c1ac99f8107d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*I6ccV7DIRj0OliwrsDRgNg.png"/></div></div></figure><p id="0d28" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">此外，我们假设这些例子是独立同分布的(iid ),因此我们可以将经验误差为零的概率写成各个预测正确的概率的乘积:</p><figure class="lc ld le lf gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi lz"><img src="../Images/414eff38d00c06223b6b1860a46e4275.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4-dtuVLvQu97nE4FUrURgg.png"/></div></div><figcaption class="lg lh gj gh gi li lj bd b be z dk">The constant m denotes the number of training examples in the set S.</figcaption></figure><p id="18b1" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">假设在某一数据点正确的概率可以写成 1 减去<strong class="kd iu">真实风险</strong>。这是因为我们将风险定义为错误分类样本的分数。这个不等式来自于我们假设误差低于或等于上界的事实。</p><figure class="lc ld le lf gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi ma"><img src="../Images/fb1d9d86e8f65a93ea99e52d84e75961.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZZxr0mW6LNJ-4-QwyNCihg.png"/></div></div></figure><p id="6219" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">如果我们把前面的两个等式结合起来，我们会得到下面的结果:</p><figure class="lc ld le lf gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mb"><img src="../Images/6ca6d8a5649d32a6f0c80e0945bb0e57.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1-SOOEHlBgJH0ej7FxnVeg.png"/></div></div><figcaption class="lg lh gj gh gi li lj bd b be z dk">The exponential on the right comes from a simply provable inequality.</figcaption></figure><p id="54ae" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">如果我们将上面的等式与应用联合边界的前一个等式结合起来，我们会得到以下有见地的结果:</p><figure class="lc ld le lf gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mc"><img src="../Images/001960c161ab5957c16b50f3721ee1d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Jsn2kWdexuIsTvtzR85c6A.png"/></div></div><figcaption class="lg lh gj gh gi li lj bd b be z dk">Here |H| is the cardinality of the hypothesis space, obviously, this formulation doesn’t make sense in the case when we have an infinite number of hypotheses.</figcaption></figure><p id="78eb" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我们可以用某个常数 1δ来代替左侧，其中δ是我们希望误差不高于ε的置信度。我们可以简单地重新排列等式，以便表述如下:</p><figure class="lc ld le lf gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi md"><img src="../Images/cebc85b885e0285a4e24413ad9ddbcb6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*W006RicDVuqiKtjUx7skhA.png"/></div></div></figure><p id="c55c" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">最终结果告诉我们，我们需要多少个示例(m ),以便 ERM 不会导致高于ε且具有某个置信度δ的误差，即，当我们为 ERM 选择足够多的示例时，它可能不会具有高于ε的误差。我在这里使用可能这个词，因为它取决于我们的置信常数δ，它在 0 和 1 之间。这是一件很直观的事情，但我认为有时候看看方程，发现它在数学上是有意义的，这很好。</p><p id="c46c" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在企业风险管理中，做出了许多假设。我提到了可实现性假设，即在我们的假设池中有一个最优假设。此外，假设空间可能不是有限的，因为它是在这里。在未来，我计划通过范例来放松这些假设。然而，ERM 是学习理论中的一个基本概念，对于任何认真的机器学习实践者都是必不可少的。</p></div></div>    
</body>
</html>