<html>
<head>
<title>Plotting text and image vectors using t-SNE</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用 t-SNE 绘制文本和图像向量</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/plotting-text-and-image-vectors-using-t-sne-d0e43e55d89?source=collection_archive---------11-----------------------#2019-03-11">https://towardsdatascience.com/plotting-text-and-image-vectors-using-t-sne-d0e43e55d89?source=collection_archive---------11-----------------------#2019-03-11</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="b33f" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated"><em class="ki">如何在二维空间中绘制使用 Infersent 和 Resnet 创建的多维向量。</em></h2></div><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi kj"><img src="../Images/f6638ed4a17599f412331cb1d0c3adf8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ba8uvFOXvmp0rrIsF8149Q.png"/></div></div><figcaption class="kv kw gj gh gi kx ky bd b be z dk">Power to your eye - Happy Visualizing</figcaption></figure><h1 id="6ba4" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">用可视化创造奇迹</h1><p id="3ac8" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">约翰·米特尔南正确地指出，“展示才是真正的娱乐”，如果你能以另一个人希望的方式展示你的数据，他将处于一种幸福的状态。想象一个所有数据的交流都可以可视化的世界，我的大脑和我的老板都会感谢我的这个姿态。<a class="mn mo ep" href="https://medium.com/u/47a096395dd5?source=post_page-----d0e43e55d89--------------------------------" rel="noopener" target="_blank">维克拉姆·瓦什尼</a> <a class="mn mo ep" href="https://medium.com/u/f3499cb43377?source=post_page-----d0e43e55d89--------------------------------" rel="noopener" target="_blank">阿尤什·古普塔</a>。考虑到人脑对于图像内容的舒适性，并且考虑到通过人脑传输的 90%的信息是视觉的，我们已经尝试在 2-D 空间中绘制句子和图像向量，其中每个空间点代表一个句子，并且相似的句子向量将被放置在空间邻近处。</p><p id="9354" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma mr mc md me ms mg mh mi mt mk ml mm im bi translated"><strong class="lt iu">问题陈述:</strong></p><p id="2d02" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma mr mc md me ms mg mh mi mt mk ml mm im bi translated">绘制句子和图像向量，其中句子向量是使用 Infersent 或 Google 的通用句子编码器得出的，图像向量是在 Resnet 50 模型中提取的特征。</p><p id="9465" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma mr mc md me ms mg mh mi mt mk ml mm im bi translated">我们的句子只不过是产品名称、描述和规格的组合，而图像基本上就是产品图像。要了解产品在 Indiamart 中的含义，请<a class="ae mu" rel="noopener" target="_blank" href="/classifying-products-as-banned-or-approved-using-text-mining-5b48d2eb1544">阅读此处。</a></p><h1 id="d705" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated"><strong class="ak">理解文本和图像向量</strong></h1><p id="7050" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">文本向量(单词向量或句子向量)是通过使用嵌入技术(如 word2vec、fasttext、Infersent、Google universal sent encoder 等)将文本数据转换为数字形式来创建的。你的向量的维度可能取决于你准备它的技术。例如，Infesent 为每个句子创建 4096 维的向量，而 GUSE(Google 通用句子编码器)为每个句子创建 512 维的向量。</p><p id="110f" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma mr mc md me ms mg mh mi mt mk ml mm im bi translated">图像向量是使用一些图像特征提取技术创建的图像的特征向量。在我们的例子中，对于每个图像，我们有 512 维的 Resnet 图像向量。</p><p id="c4d8" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma mr mc md me ms mg mh mi mt mk ml mm im bi translated"><em class="mv">注意:在这篇文章中，我们不会详细讨论一个句子或单词的嵌入(它们将在另一篇博客中单独讨论)，而是关注我们如何在散点图上描绘它们。</em></p><h1 id="0f69" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated"><strong class="ak">去多维化再回来</strong></h1><p id="9a8f" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">可视化文本和图像特征向量的分布式表示的困难在于它们是多维的(例如，一些向量是 512 维的，而一些是 4096 维的)，这比人类可以看到和解释的通常的 2 维或 3 维矢量图高得多。</p><p id="4cb7" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma mr mc md me ms mg mh mi mt mk ml mm im bi translated">由于没有直接的方法将这些数据点投影到易于人类理解的图上，我们需要一些强大的方法将这些高维数据映射到 2 或 3 维空间。在这里，SNE 霸王龙为我们开了一个玩笑。</p><p id="436a" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma mr mc md me ms mg mh mi mt mk ml mm im bi translated">下图显示了如何将每个矢量转换为二维数组，以便于绘图。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div class="gh gi mw"><img src="../Images/71b245bb5eae71280843e2822f91515b.png" data-original-src="https://miro.medium.com/v2/resize:fit:816/format:webp/1*-I7E6BdHBl6GshEgmk4WOw.png"/></div><figcaption class="kv kw gj gh gi kx ky bd b be z dk">Multidimensional Vectors converted to a two-dimensional vector using t-SNE.</figcaption></figure><h1 id="4218" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">什么是 SNE 霸王龙？</h1><p id="c7c3" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated"><a class="ae mu" href="http://www.jmlr.org/papers/volume9/vandermaaten08a/vandermaaten08a.pdf" rel="noopener ugc nofollow" target="_blank"> t-SNE </a>代表 t 分布随机邻居嵌入。这是一种降维技术，最适合于高维数据集的可视化。t-SNE 是一种随机化算法，I；e .每次我们运行该算法时，它都会在相同的数据集上返回稍微不同的结果。为了控制这一点，我们用任意值设置一个随机状态。这里使用随机状态来播种算法的成本函数。</p></div><div class="ab cl mx my hx mz" role="separator"><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc"/></div><div class="im in io ip iq"><h1 id="f0fe" class="kz la it bd lb lc ne le lf lg nf li lj jz ng ka ll kc nh kd ln kf ni kg lp lq bi translated"><strong class="ak">给思想上色——散点图</strong></h1><p id="c9e3" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">以下步骤将指导您在散点图上描绘您的矢量。</p><p id="e546" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma mr mc md me ms mg mh mi mt mk ml mm im bi translated"><strong class="lt iu">步骤 1: </strong>导入必要的库:</p><figure class="kk kl km kn gt ko"><div class="bz fp l di"><div class="nj nk l"/></div></figure><p id="cfa4" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma mr mc md me ms mg mh mi mt mk ml mm im bi translated"><strong class="lt iu">第二步:加载使用不同嵌入技术创建的向量:</strong>在这一步中，我们已经加载了使用 GUSE、Infersent 或 Resnet(在图像向量的情况下)创建的大维向量，并使用 t-SNE 算法拟合到 2 d 空间中。</p><figure class="kk kl km kn gt ko"><div class="bz fp l di"><div class="nj nk l"/></div></figure><p id="f788" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma mr mc md me ms mg mh mi mt mk ml mm im bi translated"><strong class="lt iu">步骤 3:创建一个用户定义的函数，在二维空间中绘制上述向量:</strong>我们已经使用了 t-SNE、matplotlib 和 seaborn 的组合来创建散点图。</p><figure class="kk kl km kn gt ko"><div class="bz fp l di"><div class="nj nk l"/></div></figure><p id="bf14" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma mr mc md me ms mg mh mi mt mk ml mm im bi translated"><strong class="lt iu">步骤 4:可视化并保存图形</strong></p><figure class="kk kl km kn gt ko"><div class="bz fp l di"><div class="nj nk l"/></div></figure><p id="1a77" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma mr mc md me ms mg mh mi mt mk ml mm im bi translated"><strong class="lt iu"> <em class="mv">基于上述句子向量的 K-Means 聚类的可视化</em> </strong></p><p id="dcb2" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma mr mc md me ms mg mh mi mt mk ml mm im bi translated">我们使用<a class="ae mu" href="https://en.wikipedia.org/wiki/K-means_clustering" rel="noopener ugc nofollow" target="_blank"> K-Means </a>聚类对相似的句子向量进行分组。形成了 18 个这样的集群。下面的散点图显示了产品在每个集群中的分布。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi nl"><img src="../Images/724d57c5c228ef09e2f01191c0396914.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Vp4MZDhbaB3g_HO1bmsZmA.png"/></div></div></figure><p id="dc59" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma mr mc md me ms mg mh mi mt mk ml mm im bi translated"><strong class="lt iu"> <em class="mv">可视化基于已有的句子向量的聚类。</em> </strong></p><p id="ebd4" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma mr mc md me ms mg mh mi mt mk ml mm im bi translated">在这里，句子向量是基于其现有的簇绘制的。每个产品(句子向量)属于某个聚类或类别，并且每个类别都有唯一的颜色。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi nm"><img src="../Images/2493abb9916b60ab175d52c35b3f604d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mQ-St6tKVmm_uDV0N9mk0Q.png"/></div></div><figcaption class="kv kw gj gh gi kx ky bd b be z dk">We can see how the products(sentences) from Earthmoving Bucket are spread across the plot suggesting their nearness to other related clusters.</figcaption></figure><p id="d972" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma mr mc md me ms mg mh mi mt mk ml mm im bi translated"><strong class="lt iu">添加一个轴到你的二维空间:</strong>我们可以简单地在轴上设置 x-limit(在我们的例子中从-60 到+ 60)和 y-limit(从-60 到+60)</p><h2 id="9afd" class="nn la it bd lb no np dn lf nq nr dp lj ma ns nt ll me nu nv ln mi nw nx lp ny bi translated">解码情节</h2><p id="7eee" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">散点图中的每个点代表单个产品中的文本。文本语义相似的产品放在一起。每个点的颜色代表它所属的类别，即类别 0 中的所有句子用红色表示，类别 1 中的所有句子用橙色表示，依此类推。</p><p id="757f" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma mr mc md me ms mg mh mi mt mk ml mm im bi translated"><strong class="lt iu"> <em class="mv">图像向量的可视化</em> </strong></p><p id="d39a" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma mr mc md me ms mg mh mi mt mk ml mm im bi translated">图中的每个点代表单个图像的特征。相似的图像落在紧密结合的空间中。使用 Resnet 将每个图像转换为特征向量。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi kj"><img src="../Images/e6643dcf7a3bff93441dd8eb8fc0697a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OAqNIrK86wYQHB65hY0_4A.jpeg"/></div></div><figcaption class="kv kw gj gh gi kx ky bd b be z dk">Image Vectors plotted in a 2-D Space. On close observation, it is seen that similar images are occupying close spaces while different image vectors are scattered in the plot.</figcaption></figure><h1 id="e541" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">将东西投入使用</h1><p id="d28f" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">散点图对我们有多种应用——它告诉我们现有的图像或句子有多相似，以及当前的分类对于其中映射的产品是否合适。它还帮助我们对一组新的产品或图片进行分类。</p><p id="ee58" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma mr mc md me ms mg mh mi mt mk ml mm im bi translated">在我的 Github 库上查看<a class="ae mu" href="https://github.com/ashutoshsingh25/Plotting-multidimensional-vectors-using-t-SNE/blob/master/TSNE%20Code%20for%20clusring%20image%20and%20text%20vectors%20with%20labels.ipynb" rel="noopener ugc nofollow" target="_blank">的完整 python 代码。</a></p></div></div>    
</body>
</html>