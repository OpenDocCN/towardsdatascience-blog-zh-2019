<html>
<head>
<title>Use ColumnTransformer in SciKit instead of LabelEncoding and OneHotEncoding for data preprocessing in Machine Learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在机器学习中使用 SciKit 中的 ColumnTransformer 代替 LabelEncoding 和 OneHotEncoding 进行数据预处理</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/columntransformer-in-scikit-for-labelencoding-and-onehotencoding-in-machine-learning-c6255952731b?source=collection_archive---------1-----------------------#2019-11-17">https://towardsdatascience.com/columntransformer-in-scikit-for-labelencoding-and-onehotencoding-in-machine-learning-c6255952731b?source=collection_archive---------1-----------------------#2019-11-17</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="5e8b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在一篇非常老的帖子中，我展示了如何使用标签编码和一个热编码将分类文本数据分成数字和不同的列。但是自从我写了那篇文章之后，SciKit 库已经有了很大的进步，它让生活变得更加容易。</p><p id="82a7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">库的开发者可能已经意识到人们非常频繁地使用标签编码和一个酒店编码。所以他们决定开发一个名为 ColumnTransformer 的新库，它将 LabelEncoding 和 OneHotEncoding 合并成一行代码。结果是完全一样的。在这篇文章中，我们将快速地看一下我们如何用一些代码片段做到这一点。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi km"><img src="../Images/6da8c509a71c931fce076cd92a4731de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Xx7E38hzti3-7dbQZoD-4Q.jpeg"/></div></div></figure><h1 id="2bd8" class="ky kz iq bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">代码</h1><p id="4ecc" class="pw-post-body-paragraph jn jo iq jp b jq lw js jt ju lx jw jx jy ly ka kb kc lz ke kf kg ma ki kj kk ij bi translated">首先，像往常一样，我们需要导入所需的库。我们将按照惯例处理混叠:</p><pre class="kn ko kp kq gt mb mc md me aw mf bi"><span id="b4cd" class="mg kz iq mc b gy mh mi l mj mk">import numpy as np<br/>import pandas as pd</span></pre><p id="cc9a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">接下来，让我们将一些数据放入一个变量，看看我们在处理什么:</p><pre class="kn ko kp kq gt mb mc md me aw mf bi"><span id="ba65" class="mg kz iq mc b gy mh mi l mj mk">dataset = pd.read_csv("/home/sunny/code/machine_learning/samples/sample.csv")</span></pre><p id="0b2e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">您可以使用 Spyder 中的“变量浏览器”视图来查看数据。在我的例子中，大概是这样的:</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi ml"><img src="../Images/c0faf063d6b8e4daa2dba9578500207b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1022/format:webp/1*vVeod9fAwIcZx45E4_CFQg.png"/></div></figure><p id="9068" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">正如你可以清楚地看出，这些数据毫无意义，显然只是为了这个演示。无论如何，这里的第一列是一个文本字段，在某种意义上是分类的。因此，我们将不得不标记编码，这也是一个热编码，以确保我们不会与任何层次结构。为此，我们仍然需要在代码中导入 OneHotEncoder 库。但是我们将使用新的<strong class="jp ir"> ColumnTransformer </strong>，而不是 LabelEncoder 库。所以我们先导入这两个:</p><pre class="kn ko kp kq gt mb mc md me aw mf bi"><span id="2f8f" class="mg kz iq mc b gy mh mi l mj mk">from sklearn.preprocessing import OneHotEncoder<br/>from sklearn.compose import ColumnTransformer</span></pre><p id="1ae1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">接下来，我们必须创建一个 ColumnTransformer 类的对象。但是在我们这样做之前，我们需要理解类的构造函数签名。ColumnTransformer 构造函数接受相当多的参数，但是我们只对两个感兴趣。第一个参数是一个名为<strong class="jp ir"> transformers </strong>的数组，它是一个元组列表。该数组以相同的顺序包含以下元素:</p><ul class=""><li id="6c04" class="mm mn iq jp b jq jr ju jv jy mo kc mp kg mq kk mr ms mt mu bi translated"><strong class="jp ir">名称</strong>:柱形变压器的名称，便于设置参数和查找变压器。</li><li id="9eef" class="mm mn iq jp b jq mv ju mw jy mx kc my kg mz kk mr ms mt mu bi translated"><strong class="jp ir"> transformer </strong>:这里我们应该提供一个估计器。如果我们愿意，我们也可以只“通过”或“丢弃”。但是由于我们在这个例子中对数据进行编码，我们将在这里使用 OneHotEncoder。请记住，您在这里使用的估计器需要支持拟合和变换。</li><li id="1bcc" class="mm mn iq jp b jq mv ju mw jy mx kc my kg mz kk mr ms mt mu bi translated"><strong class="jp ir">列</strong>:要转换的列的列表。在这种情况下，我们将只转换第一列。</li></ul><p id="da92" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们感兴趣的第二个参数是余数。这将告诉转换器如何处理数据集中的其他列。默认情况下，转换器将只返回被转换的列。所有其他列都将被删除。但是我们可以选择告诉转换器如何处理其他列。我们可以丢弃它们，不加修改地传递它们，或者指定另一个估计器，如果我们想做更多的处理。</p><p id="f7cb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在我们(多少)理解了构造函数的签名，让我们继续创建一个对象:</p><pre class="kn ko kp kq gt mb mc md me aw mf bi"><span id="b524" class="mg kz iq mc b gy mh mi l mj mk">columnTransformer = ColumnTransformer([('encoder', OneHotEncoder(), [0])], remainder='passthrough')</span></pre><p id="fb51" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">正如您在上面的片段中看到的，我们将把转换器简单地命名为“编码器”我们使用 OneHotEncoder()构造函数来提供一个新的实例作为估计器。然后我们指定只有第一列需要转换。我们还确保剩余的列没有任何变化地通过。</p><p id="5d70" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">一旦我们构建了这个 columnTransformer 对象，我们就必须将数据集调整并转换为标签编码和热编码列。为此，我们将使用以下简单的命令:</p><pre class="kn ko kp kq gt mb mc md me aw mf bi"><span id="063b" class="mg kz iq mc b gy mh mi l mj mk">dataset = np.array(columnTransformer.fit_transform(dataset), dtype = np.str)</span></pre><p id="6be4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果您现在在变量资源管理器视图中检查您的数据集，您应该会看到类似如下的内容:</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi na"><img src="../Images/70017d6113b918fe6dde430db8a6f5b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1240/format:webp/1*vFrC4HZl7HNXzc2lv9G_UA.png"/></div></figure><p id="5611" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如您所见，我们仅使用 ColumnTransformer 类就轻松地对数据集中的一列进行了标签编码和热编码。这比同时使用 LabelEncoder 和 OneHotEncoder 类要简单和干净得多。</p></div><div class="ab cl nb nc hu nd" role="separator"><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng"/></div><div class="ij ik il im in"><blockquote class="ni nj nk"><p id="795f" class="jn jo nl jp b jq jr js jt ju jv jw jx nm jz ka kb nn kd ke kf no kh ki kj kk ij bi translated">在<a class="ae kl" href="https://twitter.com/contactsunny" rel="noopener ugc nofollow" target="_blank">推特</a>上关注我，了解更多<a class="ae kl" href="https://blog.contactsunny.com/tag/data-science" rel="noopener ugc nofollow" target="_blank">数据科学</a>、<a class="ae kl" href="https://blog.contactsunny.com/tag/machine-learning" rel="noopener ugc nofollow" target="_blank">机器学习</a>，以及通用<a class="ae kl" href="https://blog.contactsunny.com/category/tech" rel="noopener ugc nofollow" target="_blank">技术更新</a>。此外，你可以<a class="ae kl" href="https://blog.contactsunny.com/" rel="noopener ugc nofollow" target="_blank">关注我的个人博客</a>,因为我在 Medium 之前发布了许多我的教程、操作方法帖子和机器学习的优点。</p></blockquote><p id="a0c3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果你喜欢我在 Medium 或我的个人博客上的帖子，并希望我继续做这项工作，请考虑在 Patreon 上支持我。</p></div></div>    
</body>
</html>