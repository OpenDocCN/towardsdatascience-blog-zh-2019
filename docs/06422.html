<html>
<head>
<title>Introduction to Machine Learning in C# with ML.NET</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用 ML 介绍 C#中的机器学习。网</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/introduction-to-machine-learning-in-c-with-ml-net-bf45502d8110?source=collection_archive---------4-----------------------#2019-09-15">https://towardsdatascience.com/introduction-to-machine-learning-in-c-with-ml-net-bf45502d8110?source=collection_archive---------4-----------------------#2019-09-15</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/e0f46efac79cb38b2424f37882f44021.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IqLeS9-9f7ojZq7cBS0SFQ.png"/></div></div></figure><p id="d06a" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">当想到数据科学和机器学习时，两种编程语言 Python 和 R 立即浮现在脑海中。这两种语言支持所有常见的机器学习算法、预处理技术等等，因此可以用于几乎所有的机器学习问题。</p><p id="5709" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">然而，有时个人或公司不能或不想使用 Python 或 r。这可能是因为许多原因之一，包括已经有了另一种语言的代码库或没有 Python 或 r 的经验。当今最流行的语言之一是 C#，它用于许多应用程序。为了在 C#中使用机器学习的力量，微软创建了一个名为 ML.NET 的包，它提供了所有基本的机器学习功能。</p><p id="be62" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在本文中，我将向您展示如何使用 ML.NET 创建一个二进制分类模型，讨论其 AutoML 功能，并向您展示如何使用张量流模型与 ML.NET。二进制分类模型的完整代码可以在<a class="ae kz" href="https://github.com/TannerGilbert/Tutorials/tree/master/Introduction%20to%20Machine%20Learning%20in%20C%23%20with%20ML.NET/CreditCardFraudDetection" rel="noopener ugc nofollow" target="_blank"> my Github </a>上找到。</p></div><div class="ab cl la lb hx lc" role="separator"><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf"/></div><div class="im in io ip iq"><h1 id="129b" class="lh li it bd lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me bi translated">将 ML.NET 添加到 C#项目中</h1><p id="9f64" class="pw-post-body-paragraph kb kc it kd b ke mf kg kh ki mg kk kl km mh ko kp kq mi ks kt ku mj kw kx ky im bi translated">将 ML.NET 添加到你的 C#或 F#项目中实际上是相当容易的。唯一需要的就是安装微软的<strong class="kd iu">T3。ML  </strong>包。根据你的使用情况，你可能还需要安装一些额外的包，比如微软的<strong class="kd iu"> <em class="mk">。微软图像分析公司。ML.TensorFlow </em> </strong>或<strong class="kd iu"> <em class="mk">微软。ML 变压器</em> </strong>。</p><figure class="mm mn mo mp gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi ml"><img src="../Images/7a5fbc00b3b73fded350042ed643ac08.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*J8qtQ-QRyU_jAozf.png"/></div></div></figure></div><div class="ab cl la lb hx lc" role="separator"><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf"/></div><div class="im in io ip iq"><h1 id="9119" class="lh li it bd lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me bi translated">加载数据集并创建数据管道</h1><p id="e944" class="pw-post-body-paragraph kb kc it kd b ke mf kg kh ki mg kk kl km mh ko kp kq mi ks kt ku mj kw kx ky im bi translated">在 ML.NET 加载和预处理数据集与使用其他机器学习包/框架非常不同，因为它要求我们显式地陈述我们的数据结构。为此，我们在名为<strong class="kd iu"> <em class="mk"> DataModels </em> </strong>的文件夹内创建一个名为<strong class="kd iu"><em class="mk">model input . cs</em></strong>的文件。在这个文件中，我们将陈述数据集的所有列。</p><p id="6841" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">对于本文，我们将使用可以在 Kaggle 上免费下载的<a class="ae kz" href="https://www.kaggle.com/mlg-ulb/creditcardfraud" rel="noopener ugc nofollow" target="_blank">信用卡欺诈检测数据集</a>。这个数据集包含 31 列。交易的类别(0 或 1)、交易的金额、交易发生的时间以及 28 个匿名特征。</p><figure class="mm mn mo mp gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mq"><img src="../Images/652ae6ccabe75cca2d44a27311ec8a26.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*sk2A0NY8kcIezlDO.png"/></div></div></figure><figure class="mm mn mo mp gt ju"><div class="bz fp l di"><div class="mr ms l"/></div></figure><p id="f1de" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这里，我们为数据集中的每一列创建一个字段。重要的是指定正确的数据类型和列索引。</p><p id="8dc8" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">既然我们已经对数据进行了建模，我们还需要对我们的输出进行建模。这可以通过与上述脚本类似的方式来完成。</p><figure class="mm mn mo mp gt ju"><div class="bz fp l di"><div class="mr ms l"/></div></figure><p id="3ae3" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这里我们有两个字段。分数字段以百分比表示输出，而预测字段是布尔值。</p><p id="8139" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">既然我们已经建模了输入和输出数据，我们可以使用<strong class="kd iu"> <em class="mk"> LoadFromTextFile </em> </strong>方法加载实际数据。</p><figure class="mm mn mo mp gt ju"><div class="bz fp l di"><div class="mr ms l"/></div></figure></div><div class="ab cl la lb hx lc" role="separator"><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf"/></div><div class="im in io ip iq"><h1 id="12df" class="lh li it bd lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me bi translated">创建和训练模型</h1><p id="4f44" class="pw-post-body-paragraph kb kc it kd b ke mf kg kh ki mg kk kl km mh ko kp kq mi ks kt ku mj kw kx ky im bi translated">要使用 model 创建和训练模型，我们需要创建一个管道，其中包含所需的数据预处理和训练算法。对于这个特殊的数据集，很难做任何预处理，因为它有 28 个匿名特征，因此我选择保持简单，只连接所有特征(这必须总是在 ML 中完成。网)。</p><figure class="mm mn mo mp gt ju"><div class="bz fp l di"><div class="mr ms l"/></div></figure><p id="fa02" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">对于模型，我选择了<a class="ae kz" href="https://medium.com/@pushkarmandot/https-medium-com-pushkarmandot-what-is-lightgbm-how-to-implement-it-how-to-fine-tune-the-parameters-60347819b7fc" rel="noopener"> LightGBM </a>算法。这个算法实际上并没有包含在微软的<strong class="kd iu"> <em class="mk">中。ML </em> </strong>因此你需要安装<strong class="kd iu"> <em class="mk">微软。ML . light GBM</em>T13】来使用。</strong></p><figure class="mm mn mo mp gt ju"><div class="bz fp l di"><div class="mr ms l"/></div></figure><p id="d745" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">现在我们可以使用<strong class="kd iu"> <em class="mk"> Fit </em> </strong>方法训练模型，并使用<strong class="kd iu"><em class="mk">ml context . model . save</em></strong>保存它。</p><figure class="mm mn mo mp gt ju"><div class="bz fp l di"><div class="mr ms l"/></div></figure></div><div class="ab cl la lb hx lc" role="separator"><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf"/></div><div class="im in io ip iq"><h1 id="f498" class="lh li it bd lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me bi translated">评估模型</h1><p id="50bf" class="pw-post-body-paragraph kb kc it kd b ke mf kg kh ki mg kk kl km mh ko kp kq mi ks kt ku mj kw kx ky im bi translated">现在我们的模型已经训练好了，我们需要检查它的性能。最简单的方法是使用<a class="ae kz" rel="noopener" target="_blank" href="/why-and-how-to-cross-validate-a-model-d6424b45261f">交叉验证</a>。ML.Net 为我们提供了各种不同数据集的交叉验证方法。因为我们的数据集是一个二元分类数据集，我们将使用<strong class="kd iu"> <em class="mk"> mlContext。binary classification . CrossValidateNonCalibrated</em></strong>方法对我们的模型进行评分。</p><figure class="mm mn mo mp gt ju"><div class="bz fp l di"><div class="mr ms l"/></div></figure></div><div class="ab cl la lb hx lc" role="separator"><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf"/></div><div class="im in io ip iq"><h1 id="70b3" class="lh li it bd lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me bi translated">做预测</h1><p id="8cb4" class="pw-post-body-paragraph kb kc it kd b ke mf kg kh ki mg kk kl km mh ko kp kq mi ks kt ku mj kw kx ky im bi translated">使用 ML.NET 对新数据进行预测非常简单。我们只需要创建一个<strong class="kd iu"><em class="mk">prediction engine</em></strong>，专门为我们的模型做的另一个表示，并调用它的<strong class="kd iu"> <em class="mk"> Predict </em> </strong>方法，传递它一个<strong class="kd iu"> <em class="mk"> ModelInput </em> </strong>对象。</p><figure class="mm mn mo mp gt ju"><div class="bz fp l di"><div class="mr ms l"/></div></figure></div><div class="ab cl la lb hx lc" role="separator"><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf"/></div><div class="im in io ip iq"><h1 id="5e9a" class="lh li it bd lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me bi translated">自动毫升</h1><p id="e7a1" class="pw-post-body-paragraph kb kc it kd b ke mf kg kh ki mg kk kl km mh ko kp kq mi ks kt ku mj kw kx ky im bi translated">ML.NET 的另一个伟大之处是它出色地实现了<a class="ae kz" rel="noopener" target="_blank" href="/whats-auto-ml-b457d2710f9d">自动 ML </a>。使用 Auto-ML，我们可以通过指定我们正在处理的问题并提供我们的数据来构建基本的机器学习解决方案。</p><p id="acd1" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">要在 ML.NET 开始使用 Auto-ML，您需要下载“<a class="ae kz" href="https://marketplace.visualstudio.com/items?itemName=MLNET.07" rel="noopener ugc nofollow" target="_blank">ML.NET 模型构建器(预览)</a>”Visual Studio 扩展。这可以通过扩展选项卡来完成。</p><p id="c301" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">成功安装扩展后，可以通过在<strong class="kd iu">解决方案浏览器</strong>中右键单击您的项目并选择<strong class="kd iu">添加- &gt;机器学习</strong>来使用 Auto-ML。</p><figure class="mm mn mo mp gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mt"><img src="../Images/ee7ffcf98eb11aa6fb807c502f649e9b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Gjt0mnzmOjycTHBO.gif"/></div></div></figure><p id="ebdd" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这将打开“模型构建器”窗口。模型构建器将指导您完成构建机器学习模型的过程。</p><figure class="mm mn mo mp gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mu"><img src="../Images/6ce5039693e8a0e5ec13c8575fc0e281.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*N0QwGQzk9VQ61mmo.png"/></div></div></figure><p id="9bda" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">有关如何完成所有步骤的信息，请务必查看<a class="ae kz" href="https://dotnet.microsoft.com/learn/ml-dotnet/get-started-tutorial/intro" rel="noopener ugc nofollow" target="_blank">官方入门教程</a>。完成所有步骤后，模型构建器将自动生成代码。</p></div><div class="ab cl la lb hx lc" role="separator"><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf"/></div><div class="im in io ip iq"><h1 id="031f" class="lh li it bd lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me bi translated">使用预先训练的张量流模型</h1><p id="1ffe" class="pw-post-body-paragraph kb kc it kd b ke mf kg kh ki mg kk kl km mh ko kp kq mi ks kt ku mj kw kx ky im bi translated">ML.NET 的另一个伟大之处是它允许我们使用 Tensorflow 和 ONNX 模型进行推理。要使用 Tensorflow 模型，您需要安装微软的<strong class="kd iu"> <em class="mk">。ML.TensorFlow </em> </strong>使用 NuGet。安装必要的包后，您可以使用<strong class="kd iu"> <em class="mk">模型加载 Tensorflow 模型。LoadTensorFlowModel </em> </strong>方法。之后需要调用<strong class="kd iu"><em class="mk">ScoreTensorFlowModel</em></strong>方法，并传递给它输入输出层名称。</p><figure class="mm mn mo mp gt ju"><div class="bz fp l di"><div class="mr ms l"/></div></figure><p id="eea2" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">有关如何在 ML.NET 使用 Tensorflow 模型的更多信息，请查看<a class="ae kz" href="https://devblogs.microsoft.com/cesardelatorre/run-with-ml-net-c-code-a-tensorflow-model-exported-from-azure-cognitive-services-custom-vision/" rel="noopener ugc nofollow" target="_blank">“使用 ML.NET c#代码运行从 Azure Cognitive Services Custom Vision 导出的 TensorFlow 模型”</a>。</p></div><div class="ab cl la lb hx lc" role="separator"><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf"/></div><div class="im in io ip iq"><h1 id="bbbe" class="lh li it bd lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me bi translated">结论</h1><p id="d101" class="pw-post-body-paragraph kb kc it kd b ke mf kg kh ki mg kk kl km mh ko kp kq mi ks kt ku mj kw kx ky im bi translated">ML。NET 是一个. NET 包，允许您在. NET 中创建和使用机器学习模型。在本文中，您学习了如何使用 ML.NET 创建一个信用卡欺诈检测模型。</p><p id="6b26" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这就是这篇文章的全部内容。如果你有任何问题或者只是想和我聊天，请在下面留下评论或者在社交媒体上联系我。如果你想获得我博客的持续更新，请确保在 Medium 上关注我，并加入我的时事通讯。</p></div></div>    
</body>
</html>