<html>
<head>
<title>5 Minute Guide to Plotting with Pandas</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">熊猫绘图 5 分钟指南</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/5-minute-guide-to-plotting-with-pandas-e8c0f40a1df4?source=collection_archive---------4-----------------------#2019-08-29">https://towardsdatascience.com/5-minute-guide-to-plotting-with-pandas-e8c0f40a1df4?source=collection_archive---------4-----------------------#2019-08-29</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><div class=""/><div class=""><h2 id="4672" class="pw-subtitle-paragraph jr it iu bd b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki dk translated">了解如何使用这个流行的 python 工具快速可视化数据</h2></div><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj kj"><img src="../Images/e129c06cdf0b20858f0cb8a62020fe4b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*V4Klqb3RU07XjmTMqlywtA.png"/></div></div></figure><p id="1316" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">Pandas 是数据科学领域最流行的 python 库之一。它提供了一系列用于 python 数据处理和分析的工具。Pandas 还有一个可视化功能，它利用了 matplotlib 库及其核心数据结构，即数据框。</p><p id="f63c" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">虽然观想是相当基本的，并没有产生最美丽的情节。绘图功能，特别是当与其他 pandas 方法(如 groupby 和 pivot tables)结合使用时，允许您轻松地创建可视化以快速分析数据集。我几乎每天都在使用它来快速获得一些关于我正在处理的数据的信息，所以我想创建这个简单的指南来介绍一些我最常用的功能。</p><h2 id="dea8" class="ls lt iu bd lu lv lw dn lx ly lz dp ma le mb mc md li me mf mg lm mh mi mj mk bi translated">数据</h2><p id="550d" class="pw-post-body-paragraph kv kw iu kx b ky ml jv la lb mm jy ld le mn lg lh li mo lk ll lm mp lo lp lq in bi translated">在本文中，我将使用波士顿房价数据集，它是 scikit-learn 库的一部分。这也可以从互联网上的各种其他来源下载，包括<a class="ae lr" href="https://www.kaggle.com/c/boston-housing" rel="noopener ugc nofollow" target="_blank"> Kaggle </a>。在下面的代码中，我正在导入数据集并创建一个数据框，以便它可以用于熊猫的数据分析。</p><pre class="kk kl km kn gu mq mr ms mt aw mu bi"><span id="fcc8" class="ls lt iu mr b gz mv mw l mx my">from sklearn.datasets import load_boston<br/>import pandas as pd</span><span id="2375" class="ls lt iu mr b gz mz mw l mx my">boston = load_boston()<br/>boston_df = pd.DataFrame(boston.data, columns=boston.feature_names)<br/>boston_df['TARGET'] = pd.Series(boston.target)<br/>boston_df.head()</span></pre><p id="d1db" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">我们可以运行<code class="fe na nb nc mr b">boston.DESCR</code>来查看每个特性的解释。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj nd"><img src="../Images/27ec3320b2a4d97a2bd779433fbff6d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*h5nuSIG6KHZNNUmIMJyiRw.png"/></div></div></figure><h2 id="b2f1" class="ls lt iu bd lu lv lw dn lx ly lz dp ma le mb mc md li me mf mg lm mh mi mj mk bi translated">入门指南</h2><p id="e7a5" class="pw-post-body-paragraph kv kw iu kx b ky ml jv la lb mm jy ld le mn lg lh li mo lk ll lm mp lo lp lq in bi translated">pandas 中的绘图利用了 matplotlib API，因此为了创建可视化，您还需要将这个库与 pandas 一起导入。如果你在 Jupyter 笔记本中工作，那么你还必须添加<code class="fe na nb nc mr b">%matplotlib inline</code>命令，以便在笔记本中可视化图形。</p><pre class="kk kl km kn gu mq mr ms mt aw mu bi"><span id="884a" class="ls lt iu mr b gz mv mw l mx my">import matplotlib.pyplot as plt<br/>%matplotlib inline</span></pre><p id="7ae4" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated"><code class="fe na nb nc mr b">plot</code>方法从一个数据帧或数据系列创建一个基本折线图。在下面的代码中，我使用了这个方法来可视化<code class="fe na nb nc mr b">AGE</code>列。</p><pre class="kk kl km kn gu mq mr ms mt aw mu bi"><span id="3df8" class="ls lt iu mr b gz mv mw l mx my">boston_df['AGE'].plot()</span></pre><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj ne"><img src="../Images/1bfd837d4eea661e5b494bea8acbb750.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ztYWm3nrp75El7YBeK-tUg.png"/></div></div></figure><p id="3bd2" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">这个数据的一个更有用的表示是直方图。简单地将<code class="fe na nb nc mr b">.hist</code>添加到这个命令中就会产生这种类型的图形。</p><pre class="kk kl km kn gu mq mr ms mt aw mu bi"><span id="40e3" class="ls lt iu mr b gz mv mw l mx my">boston_df['AGE'].plot.hist()</span></pre><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj nf"><img src="../Images/de733b12917a249174cbff2852efef61.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DsvmaCa5RLPkpC5XIS1DQg.png"/></div></div></figure><p id="7f9c" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">您可以通过添加<code class="fe na nb nc mr b">title</code>参数为情节添加标题。</p><pre class="kk kl km kn gu mq mr ms mt aw mu bi"><span id="6632" class="ls lt iu mr b gz mv mw l mx my">boston_df['AGE'].plot.hist(title='Proportion of owner-occupied units built prior to 1940')</span></pre><p id="3e70" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">由于 pandas 使用 matplotlib API，您可以使用该库的所有功能来进一步定制可视化。在下面，我定制了<code class="fe na nb nc mr b">colormap</code>，并在 x 和 y 轴上添加了定制标签。</p><pre class="kk kl km kn gu mq mr ms mt aw mu bi"><span id="0e79" class="ls lt iu mr b gz mv mw l mx my">boston_df['AGE'].plot.hist(title='Proportion of owner-occupied units built prior to 1940', colormap='jet')<br/>plt.xlabel('AGE')<br/>plt.ylabel('FREQUENCY')</span></pre><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj ng"><img src="../Images/951a790934304626000e3aacf099dfc7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nRlJes3dX-EZPrS5jQJMdw.png"/></div></div></figure><p id="7d53" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">有关可用图表类型和可选参数的完整列表，请参见此处的<code class="fe na nb nc mr b">DataFrame.plot()</code> <a class="ae lr" href="https://pandas.pydata.org/pandas-docs/version/0.22/generated/pandas.DataFrame.plot.html" rel="noopener ugc nofollow" target="_blank">文档。</a></p><h2 id="d6d9" class="ls lt iu bd lu lv lw dn lx ly lz dp ma le mb mc md li me mf mg lm mh mi mj mk bi translated">相关</h2><p id="9304" class="pw-post-body-paragraph kv kw iu kx b ky ml jv la lb mm jy ld le mn lg lh li mo lk ll lm mp lo lp lq in bi translated">熊猫<code class="fe na nb nc mr b">DataFrame.corr</code> <a class="ae lr" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.corr.html" rel="noopener ugc nofollow" target="_blank">方法</a>可用于非常快速地可视化数据帧中变量之间的相关性。默认情况下，pandas 使用<a class="ae lr" href="https://en.wikipedia.org/wiki/Pearson_correlation_coefficient" rel="noopener ugc nofollow" target="_blank"> pearson </a>方法，并输出包含变量相关系数的数据帧。</p><p id="77e9" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">在下面的代码中，我使用这个方法来确定每个特性如何与目标变量相关联。输出显示在代码下方。</p><pre class="kk kl km kn gu mq mr ms mt aw mu bi"><span id="c67f" class="ls lt iu mr b gz mv mw l mx my">correlations = boston_df.corr()<br/>correlations = correlations['TARGET']<br/>print(correlations)</span></pre><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj nh"><img src="../Images/d3a54b6b9b13ffce0784b555f8b833fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:648/format:webp/1*PYaa-uh6Kbd6OXtJTjMLVw.png"/></div></figure><p id="c95a" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">我们可以看到特征 RM(房间的平均数量)与目标有很强的相关性。让我们用熊猫来进一步形象化这种关联。</p><pre class="kk kl km kn gu mq mr ms mt aw mu bi"><span id="cf53" class="ls lt iu mr b gz mv mw l mx my">boston_df.plot.scatter(x='RM', y='TARGET')</span></pre><p id="5171" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">上面的代码产生了下面的可视化效果。我们可以看到，一般来说，房子的中值价格随着房间数量的增加而增加。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj ni"><img src="../Images/517a59ac17f48401c54414779f1c02f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*N6G0BwzPvhWRiaXmHS7cLw.png"/></div></div></figure><h2 id="28e5" class="ls lt iu bd lu lv lw dn lx ly lz dp ma le mb mc md li me mf mg lm mh mi mj mk bi translated">分组依据</h2><p id="e135" class="pw-post-body-paragraph kv kw iu kx b ky ml jv la lb mm jy ld le mn lg lh li mo lk ll lm mp lo lp lq in bi translated">当您使用<a class="ae lr" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.groupby.html" rel="noopener ugc nofollow" target="_blank"> groupby </a>函数组合图表时，pandas 可视化可以变得非常强大，可以用几行代码快速分析多个数据点。</p><p id="4c1c" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">让我们使用此功能来查看按 CHAS 变量分组的箱线图中所有特征的分布。此要素包含两个值，如果地产区域与河流接壤，则值为 1，否则值为 0。使用下面的代码，我们可以很快看到房子靠近河流时变量之间的任何差异。</p><p id="0046" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">以下代码按该列对数据框进行分组，并为每个要素创建一个方框图。我们现在可以很快想象出两组之间的差异。</p><pre class="kk kl km kn gu mq mr ms mt aw mu bi"><span id="c0fc" class="ls lt iu mr b gz mv mw l mx my">boston_df.groupby('CHAS').boxplot(fontsize=20,rot=90,figsize=(20,10),patch_artist=True)</span></pre><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj kj"><img src="../Images/e129c06cdf0b20858f0cb8a62020fe4b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*V4Klqb3RU07XjmTMqlywtA.png"/></div></div></figure><h2 id="44d9" class="ls lt iu bd lu lv lw dn lx ly lz dp ma le mb mc md li me mf mg lm mh mi mj mk bi translated">数据透视表</h2><p id="18eb" class="pw-post-body-paragraph kv kw iu kx b ky ml jv la lb mm jy ld le mn lg lh li mo lk ll lm mp lo lp lq in bi translated">熊猫<a class="ae lr" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.pivot_table.html" rel="noopener ugc nofollow" target="_blank">数据透视表</a>，非常类似于 excel 等电子表格工具中的数据透视表，对于快速汇总数据非常有用。您可以将数据透视表与 pandas 中的可视化功能结合起来，为这些聚合创建图表。</p><p id="c799" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">从上面的方框图中我们可以看出，靠近河边的人和不靠近河边的人在房价上存在差异。在下面的代码中，我们创建了一个数据透视表来计算两组的平均房价。</p><pre class="kk kl km kn gu mq mr ms mt aw mu bi"><span id="0486" class="ls lt iu mr b gz mv mw l mx my">import numpy as np</span><span id="d706" class="ls lt iu mr b gz mz mw l mx my">pivot = pd.pivot_table(boston_df, values='TARGET', index=['CHAS'], aggfunc=np.mean)<br/>pivot</span></pre><p id="0477" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">这将创建以下输出。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj nj"><img src="../Images/4e3956f55445a99bc0d19c90ebd1c112.png" data-original-src="https://miro.medium.com/v2/resize:fit:528/format:webp/1*-tyk6a9BWtZNhlWdLtdypQ.png"/></div></figure><p id="a2fc" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">为了将它可视化为一个柱状图，我们可以简单地运行<code class="fe na nb nc mr b">pivot.plot(kind=’bar’)</code>,产生如下所示的可视化。我们可以很快看到，靠近河边的房子价格普遍较高。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj ne"><img src="../Images/e6cdfc5dea1d92c29b3666cba98d3dfc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*V3wZXzhssxNzHK9WrQ685w.png"/></div></div></figure><p id="c31a" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">这篇文章旨在快速介绍如何用熊猫绘图。使用可视化以及将它们与数据透视表和 groupby 方法结合起来，有更多的选择。熊猫<a class="ae lr" href="https://pandas.pydata.org/pandas-docs/stable/user_guide/visualization.html" rel="noopener ugc nofollow" target="_blank">用户指南</a>包含了更广泛的可能性列表。</p><p id="2102" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">感谢阅读！</p></div></div>    
</body>
</html>