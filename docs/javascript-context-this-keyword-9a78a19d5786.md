# ç†è§£ Javascriptâ€œthisâ€å…³é”®å­—(ä¸Šä¸‹æ–‡)

> åŸæ–‡ï¼š<https://towardsdatascience.com/javascript-context-this-keyword-9a78a19d5786?source=collection_archive---------9----------------------->

![](img/76bdae6ae786a26c6589d65716034838.png)

Photo by [sydney Rae](https://unsplash.com/@srz?utm_source=medium&utm_medium=referral) on [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral)

å½“ä¸€ä¸ªäººå¼€å§‹å­¦ä¹  javascript æ—¶ï¼Œä¸Šä¸‹æ–‡æ˜¯æ€»ä¼šé€ æˆå¾ˆå¤šå›°æƒ‘çš„è¯é¢˜ä¹‹ä¸€ï¼Œä¹Ÿæ˜¯é¢è¯•å®˜ç»å¸¸é—®çš„è¯é¢˜ã€‚

> è®©æˆ‘ä»¬å¼€å§‹â€¦

## ä»€ä¹ˆæ˜¯è¯­å¢ƒï¼Ÿ

Context æ€»æ˜¯å…³é”®å­—`this`çš„å€¼ï¼Œå®ƒæ˜¯å¯¹â€œæ‹¥æœ‰â€å½“å‰æ­£åœ¨æ‰§è¡Œçš„ä»£ç æˆ–å‡½æ•°çš„å¯¹è±¡çš„å¼•ç”¨ã€‚

![](img/70d47f9d6a84bc695aaa8dee9251c946.png)

æˆ‘ä»¬çŸ¥é“`window`åœ¨æµè§ˆå™¨ä¸­æ˜¯ä¸€ä¸ªå…¨å±€å¯¹è±¡ï¼Œæ‰€ä»¥å¦‚æœæˆ‘ä»¬åœ¨æ§åˆ¶å°ä¸­é”®å…¥`this`ï¼Œå®ƒåº”è¯¥è¿”å›çª—å£å¯¹è±¡ï¼Œå®ƒç¡®å®è¿”å›äº†ã€‚

åœ¨ node.js CLI ä¸­ï¼Œå¦‚æœä½ å°è¯•åšä¸Šé¢çš„äº‹æƒ…ï¼Œä½ ä¼šå¾—åˆ°ä¸€ä¸ªæ‹¥æœ‰æ‰€æœ‰å…¨å±€ä½¿ç”¨çš„å‡½æ•°çš„å¯¹è±¡ï¼Œæ¯”å¦‚`console`ã€`process`ç­‰ç­‰ã€‚(è¯•ä¸€æ¬¡)ã€‚

> æ³¨æ„:`*this*`å…³é”®å­—çš„å€¼å–å†³äºå‡½æ•°è¿è¡Œ/è°ƒç”¨/ä½¿ç”¨çš„å¯¹è±¡ã€‚å› æ­¤`this`å…³é”®å­—æœ‰ä¸åŒçš„å€¼ï¼Œè¿™å–å†³äºå®ƒçš„ä½¿ç”¨åœºåˆã€‚
> 
> æ³¨æ„:ä»ç°åœ¨å¼€å§‹ï¼Œè¿™ä¸ªå’Œä¸Šä¸‹æ–‡å¯ä»¥äº’æ¢ä½¿ç”¨ã€‚

## ä¸Šä¸‹æ–‡â€”å…¨å±€å’Œå‡½æ•°å†…éƒ¨ã€‚

![](img/623ab1ad4793d4d378a6a9f3084c02d5.png)

this at the global level called on the global object

`foo`æ˜¯åœ¨å…¨å±€çº§å®šä¹‰çš„å‡½æ•°ï¼Œåœ¨å…¨å±€çº§å¯¹è±¡ä¸Šè°ƒç”¨ï¼Œå³`window`ï¼Œæ‰€ä»¥è°ƒç”¨`foo`å’Œ`window.foo`æ˜¯ä¸€æ ·çš„ã€‚å› æ­¤ä¸Šä¸‹æ–‡æ˜¯ä¸€ä¸ª`window`å¯¹è±¡ã€‚

![](img/de7c23c32d7fa7d5051b4baa229b4ec2.png)

this inside function called on function object at global level

ç„¶è€Œï¼Œå¦‚æœæˆ‘ä»¬åœ¨å…¨å±€å±‚æ¬¡ä¸Šåš`new foo()`ï¼Œé‚£ä¹ˆå°†å¾—åˆ°`this`ä½œä¸º`foo`å¯¹è±¡ã€‚

> æ³¨æ„:`new`æ“ä½œç¬¦åˆ›å»ºä¸€ä¸ªå¯¹è±¡çš„å®ä¾‹ã€‚å‡½æ•°çš„ä¸Šä¸‹æ–‡å°†è¢«è®¾ç½®ä¸ºåˆ›å»ºçš„å¯¹è±¡å®ä¾‹ã€‚

## **ä¸Šä¸‹æ–‡â€”åœ¨äºŒçº§åŠŸèƒ½ä¸‹**

![](img/22c0c4cf1ab47df43a622d72261224dc.png)

## **ä¸Šä¸‹æ–‡â€”â€”å½“å‡½æ•°è¢«å…¨å±€å®šä¹‰å¹¶åœ¨å¯¹è±¡ä¸‹ä½¿ç”¨æ—¶(**éšå¼ç»‘å®š**)ã€‚**

![](img/81d7a10177333c39b88dcbf50bd8fbb4.png)

> æ³¨æ„:ä»ä¸Šé¢æˆ‘ä»¬å¯ä»¥çœ‹å‡º`this`å…³é”®å­—çš„å€¼å–å†³äºè¢«è°ƒç”¨çš„å‡½æ•°ï¼Œè€Œä¸æ˜¯å®šä¹‰å‡½æ•°çš„åœ°æ–¹ã€‚

## ä¸Šä¸‹æ–‡åœ¨â€œä½¿ç”¨ä¸¥æ ¼â€ä¸­å¦‚ä½•è¡¨ç°ï¼Ÿ

å½“åœ¨ä¸€ä¸ªå‡½æ•°ä¸­ä½¿ç”¨`use strict`æ—¶ï¼Œä¸Šä¸‹æ–‡å³è¯¥å…³é”®å­—çš„è¡Œä¸ºä¸åŒã€‚ä¸Šä¸‹æ–‡ä¿æŒå®ƒè¢«è°ƒç”¨æ—¶çš„æ ·å­ã€‚

![](img/e3f5495b97edc74ea674bf989998cd99.png)

> æ³¨æ„:æˆ‘ä»¬çš„æ•´ä¸ªç¨‹åºå¯èƒ½åº”è¯¥æ˜¯`strict`æˆ–`non-strict`ã€‚ç„¶è€Œï¼Œæœ‰æ—¶ä½ åŒ…å«ä¸€ä¸ªç¬¬ä¸‰æ–¹åº“ï¼Œå®ƒæ¯”ä½ è‡ªå·±çš„ä»£ç æœ‰ä¸åŒçš„ä¸¥æ ¼æ€§ï¼Œæ‰€ä»¥å¿…é¡»æ³¨æ„è¿™äº›å¾®å¦™çš„å…¼å®¹æ€§ç»†èŠ‚ã€‚

## ä¸Šä¸‹æ–‡åœ¨ç®­å¤´å‡½æ•°ä¸­å¦‚ä½•è¡¨ç°ï¼Ÿ

å°±ä¸Šä¸‹æ–‡è€Œè¨€ï¼Œç®­å¤´å‡½æ•°çš„å·¥ä½œæ–¹å¼ä¸åŒäºå¸¸è§„å‡½æ•°ã€‚`this`å°†æ€»æ˜¯å¼•ç”¨è¯æ³•èŒƒå›´([åœ¨è¿™é‡Œæ˜¯å…³äºèŒƒå›´](https://codeburst.io/still-confused-in-js-scopes-f7dae62c16ee))ï¼Œå³`this`ä¿ç•™å°é—­è¯æ³•ä¸Šä¸‹æ–‡çš„å€¼ã€‚

![](img/ebe9152d7c6ff104a4169d91f1900c38.png)

åœ¨å…¨å±€ä»£ç ä¸­ï¼Œå®ƒå°†è¢«è®¾ç½®ä¸ºå…¨å±€å¯¹è±¡ï¼Œå› æ­¤æˆ‘ä»¬å¾—åˆ°ä¸Šé¢çš„ trueã€‚

## ä¸Šä¸‹æ–‡åœ¨å¯¹è±¡çš„åŸå‹é“¾ä¸Šå¦‚ä½•è¡¨ç°ï¼Ÿ

ä¸Šä¸‹æ–‡éµå¾ªåŒæ ·çš„è§„åˆ™ï¼Œå³å¦‚æœå‡½æ•°åœ¨å¯¹è±¡çš„åŸå‹é“¾ä¸Šï¼Œ`this`æŒ‡çš„æ˜¯æ–¹æ³•è¢«è°ƒç”¨çš„å¯¹è±¡ã€‚

![](img/fa5129549ccd6a13d53d8c0701dd2edb.png)

å¦‚æœæˆ‘ä»¬è°ƒç”¨`obj.func()`å°†ä¼šå¾—åˆ°`undefined`ï¼Œå¦‚æœ`func`è¢«è°ƒç”¨äºä»å®šä¹‰äº†`x`çš„`obj`åˆ›å»ºçš„`newObj`ï¼Œé‚£ä¹ˆå®ƒå°†ä¼šè¿”å›å€¼ 10ã€‚

## ä¸Šä¸‹æ–‡åœ¨äº‹ä»¶å¤„ç†ç¨‹åºä¸­å¦‚ä½•è¡¨ç°ï¼Ÿ

æ¡ˆä¾‹äº‹ä»¶å¤„ç†ç¨‹åºä¸­çš„ä¸Šä¸‹æ–‡æŒ‡çš„æ˜¯æ¥æ”¶äº‹ä»¶çš„**å…ƒç´ **ã€‚

![](img/1eb82fc0aec3db7201dd290578cf5581.png)

è¿™é‡Œæˆ‘ä»¬åœ¨ DOM çš„ body æ ‡ç­¾ä¸Šæ·»åŠ äº†ä¸€ä¸ª jquery click äº‹ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¸Šä¸‹æ–‡è¿”å›äº† body å…ƒç´ ã€‚

## ä¸Šä¸‹æ–‡åœ¨æ‰§è¡Œä¸Šä¸‹æ–‡ä¸­æ˜¯å¦‚ä½•è¡¨ç°çš„ï¼Ÿ

å¦‚æœä½ ä¸çŸ¥é“ä»€ä¹ˆæ˜¯æ‰§è¡Œä¸Šä¸‹æ–‡([è¿™é‡Œè¯»](http://davidshariff.com/blog/what-is-the-execution-context-in-javascript/#first-article))ã€‚ç®€è€Œè¨€ä¹‹ï¼Œæ‰§è¡Œä¸Šä¸‹æ–‡æ˜¯å‡½æ•°æ‰§è¡Œçš„â€œç¯å¢ƒâ€æˆ–[èŒƒå›´](https://codeburst.io/still-confused-in-js-scopes-f7dae62c16ee)ã€‚æ¯æ¬¡è°ƒç”¨ä¸€ä¸ªå‡½æ•°ï¼Œéƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„`execution context`ã€‚å¯¹ä¸€ä¸ª`execution context`çš„æ¯ä¸ªè°ƒç”¨æœ‰ä¸¤ä¸ªé˜¶æ®µ

1.  åˆ›å»ºâ€”è°ƒç”¨å‡½æ•°æ—¶
2.  æ¿€æ´»â€”æ‰§è¡ŒåŠŸèƒ½æ—¶

`this`çš„å€¼åœ¨åˆ›å»ºé˜¶æ®µç¡®å®šï¼Œè€Œä¸æ˜¯åœ¨æ‰§è¡Œæ—¶ç¡®å®šã€‚ç„¶è€Œï¼Œ`this`åˆ¤å®šè§„åˆ™ä¿æŒä¸å˜ã€‚

## ä¸Šä¸‹æ–‡å’ŒèŒƒå›´æœ‰ä»€ä¹ˆä¸åŒï¼Ÿ

èŒƒå›´å’Œä¸Šä¸‹æ–‡æ˜¯å®Œå…¨ä¸åŒçš„æ¦‚å¿µï¼Œä½†é€šå¸¸è¢«æ–°å¼€å‘äººå‘˜äº’æ¢ä½¿ç”¨ã€‚

èŒƒå›´æ˜¯è¿è¡Œæ—¶ä»£ç ä¸­æŸä¸ªç‰¹å®šéƒ¨åˆ†çš„å˜é‡ã€å‡½æ•°æˆ–å¯¹è±¡çš„å¯è®¿é—®æ€§ã€‚[ç‚¹å‡»æ­¤å¤„äº†è§£æ›´å¤šå…³äºç¤ºæ³¢å™¨çš„ä¿¡æ¯ã€‚](https://codeburst.io/still-confused-in-js-scopes-f7dae62c16ee)

æ¯ä¸ªå‡½æ•°è°ƒç”¨éƒ½æœ‰ä¸€ä¸ªå…³è”çš„èŒƒå›´å’Œä¸Šä¸‹æ–‡ã€‚

## å¦‚ä½•æ˜¾å¼æ”¹å˜ä¸Šä¸‹æ–‡ï¼Ÿ

æˆ‘ä»¬å¯ä»¥é€šè¿‡ä½¿ç”¨`call()`ã€`apply()`å’Œ`bind()`æ–¹æ³•æ¥åŠ¨æ€åœ°æ”¹å˜ä»»ä½•æ–¹æ³•çš„ä¸Šä¸‹æ–‡ã€‚

**è°ƒç”¨â€”** ç¬¬ä¸€ä¸ªå‚æ•°`call`æ˜¯æ‚¨æƒ³è¦ä½¿ç”¨çš„**ä¸Šä¸‹æ–‡**ã€‚ä¹‹åï¼Œæ‚¨å¯ä»¥åœ¨**ä¸­ä¼ é€’ä»»æ„æ•°é‡çš„é€—å·åˆ†éš”å€¼ã€‚**

```
foo.call(context, param1, param2, param3 );
```

**åº”ç”¨â€”** è¿™ä¸`call`ç›¸åŒï¼Œä½†åœ¨è‡ªå˜é‡æ•°é‡çš„æ„ä¹‰ä¸Šæœ‰æ‰€ä¸åŒã€‚ä»…åº”ç”¨æ”¯æŒçš„ 2 ä¸ªå‚æ•°ï¼Œ**ä¸Šä¸‹æ–‡å’Œå€¼æ•°ç»„**ã€‚

```
foo.apply( context,[param1, param2, param3]);
```

**Bind â€”** å®ƒè¿”å›ä¸€ä¸ªæ–°å‡½æ•°ï¼Œè¯¥å‡½æ•°æ°¸ä¹…ç»‘å®šåˆ°`bind`çš„ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œä¸ç®¡è¯¥å‡½æ•°æ˜¯å¦‚ä½•ä½¿ç”¨çš„ã€‚`bind`ä¸ç«‹å³è°ƒç”¨ç»‘å®šçš„å‡½æ•°ï¼Œè€Œæ˜¯è¿”å›ä¸€ä¸ªæˆ‘ä»¬ç¨åå¯ä»¥è¿è¡Œçš„æ–°å‡½æ•°ã€‚

![](img/dcec5af01082834553a384d9dc406f21.png)

ä¸ºä»€ä¹ˆæˆ‘ä»¬éœ€è¦æ˜¾å¼åœ°æ”¹å˜ä¸Šä¸‹æ–‡ï¼Ÿ

1.  å½“æˆ‘ä»¬éœ€è¦è°ƒç”¨å®šä¹‰åœ¨ä¸€ä¸ªå¯¹è±¡å†…éƒ¨çš„å‡½æ•°æ—¶ï¼Œæ¯”å¦‚è¯´`x`ï¼Œä½†æ˜¯åœ¨å…¶ä»–å¯¹è±¡ä¸Šï¼Œæ¯”å¦‚è¯´`y`ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ˜¾å¼æ–¹æ³•æ¥è¿™æ ·åšï¼Œä»¥**å¢åŠ ** **çš„å¯é‡ç”¨æ€§**ã€‚

2.[**Currying and partial application**](https://codeburst.io/javascript-currying-vs-partial-application-4db5b2442be8)æ˜¯å¦ä¸€ä¸ªä½¿ç”¨ä¸Šä¸‹æ–‡æ˜¾å¼å˜åŒ–çš„éƒ¨åˆ†ã€‚

3.ä½¿**æ•ˆç”¨å‡½æ•°**åƒ

![](img/a3dc07776f2e655c3956b65cbb295703.png)![](img/96fd903fc865ff045c6776b70fe657cc.png)

4.**ç»§æ‰¿**æ˜¯å¦ä¸€ä¸ªå¯ä»¥ä½¿ç”¨ä¸Šä¸‹æ–‡æ˜¾å¼æ›´æ”¹çš„åœ°æ–¹ã€‚

> å¦‚æœä½ çŸ¥é“æ›´å¤šåŸå› ï¼Œè¯·åœ¨ä¸‹é¢è¯„è®º:)

## æˆ‘ä»¬éœ€è¦è€ƒè™‘ä¸Šä¸‹æ–‡çš„æƒ…å†µæœ‰å“ªäº›ï¼Ÿ

æˆ‘ä»¬å¯èƒ½ä¼šä¸¢å¤±ä¸Šä¸‹æ–‡ï¼Œå³åœ¨ä¸­è·å–`this`çš„`undefined`å€¼

## 1.åµŒå¥—å‡½æ•°

![](img/9b974922f9ab3917dcc965a2b28cd0ca.png)

æˆ‘ä»¬éœ€è¦ä¿ç•™è°ƒç”¨å›è°ƒå‡½æ•°æ—¶å¼•ç”¨çš„`obj`å¯¹è±¡çš„ä¸Šä¸‹æ–‡ï¼Œåœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œè¿™ç§æƒ…å†µä¸ä¼šå‘ç”Ÿï¼Œæˆ‘ä»¬ä¼šå¾—åˆ°é”™è¯¯ã€‚

æˆ‘ä»¬å¯ä»¥é€šè¿‡ç”¨ä¸‹é¢çš„ä»£ç æ›¿æ¢`exec`æ¥æ¶ˆé™¤ä¸Šé¢çš„é”™è¯¯

```
// use of bind
exec: function () {
    this.f2(function () {
        this.f1();
    }.bind(this));
}// use of arrow function
exec: function () {
    this.f2(() => {
        this.f1();
    });
}// another way not recommended though
exec: function () {
   var that = this;
    this.f2(() => {
        that.f1();
    });
}
```

## 2.æ–¹æ³•ä½œä¸ºå›è°ƒ

```
let obj = {
  name: "test",
  waveHi() {
    return ('Hi',this.name);
  }
};

setTimeout(obj.waveHi, 1000)
```

ä¸Šé¢ä¼šè¿”å›`Hi undefined`ï¼Œæƒ³ä¸€ç§’ä¸ºä»€ä¹ˆï¼Ÿè¿™æ˜¯å› ä¸ºæœ€åä¸€è¡Œå°†ä¼šå˜æˆ

```
let f = obj.waveHi;
setTimeout(f, 1000);
```

å¹¶ä¸”ï¼Œ`setTimeout`å¾—åˆ°äº†ä¸å¯¹è±¡`obj`åˆ†å¼€çš„å‡½æ•°`obj.waveHi`

è§£å†³æ–¹æ¡ˆæ˜¯

```
// Wrapping function
setTimeout(function() {
  obj.waveHi(); // Hi Test
}, 1000);// Arrow function
setTimeout(() => obj.waveHi(), 1000); // Hi Test// use of bind
let waveHi = obj.waveHi.bind(obj);
waveHi() // Hi Test
```

> æ³¨æ„:
> 
> 1.åˆ›å»ºâ€œç»‘å®šæ–¹æ³•å¼•ç”¨â€éœ€è¦åŒ¿ååŒ…è£…å‡½æ•°å’Œè°ƒç”¨æˆæœ¬ã€‚åœ¨ç‰¹å®šæƒ…å†µä¸‹ï¼Œåˆ©ç”¨é—­åŒ…å¯èƒ½æ˜¯æ›´å¥½çš„é€‰æ‹©ã€‚
> 
> 2.ä»»ä½•ç±»å‹çš„å‡½æ•°å¼•ç”¨(ä½œä¸ºå€¼èµ‹å€¼ï¼Œä½œä¸ºå‚æ•°ä¼ é€’)éƒ½ä¼šå¤±å»å‡½æ•°çš„åŸå§‹ç»‘å®šã€‚

å¦‚æœæ‚¨æƒ³è¢«æ·»åŠ åˆ°æˆ‘çš„ç”µå­é‚®ä»¶åˆ—è¡¨ä¸­ï¼Œè¯·è€ƒè™‘åœ¨è¿™é‡Œè¾“å…¥æ‚¨çš„ç”µå­é‚®ä»¶åœ°å€ å’Œ**å…³æ³¨æˆ‘çš„** [**medium**](https://medium.com/@ideepak.jsd) **é˜…è¯»æ›´å¤šå…³äº javascript çš„æ–‡ç« ï¼Œå¹¶å…³æ³¨**[**github**](https://github.com/dg92)**æŸ¥çœ‹æˆ‘çš„ç–¯ç‹‚ä»£ç **ã€‚å¦‚æœæœ‰ä»€ä¹ˆä¸æ¸…æ¥šæˆ–è€…ä½ æƒ³æŒ‡å‡ºä»€ä¹ˆï¼Œè¯·åœ¨ä¸‹é¢è¯„è®ºã€‚

ä½ å¯èƒ½ä¹Ÿä¼šå–œæ¬¢æˆ‘çš„å…¶ä»–æ–‡ç« 

1.  [Javascript æ‰§è¡Œä¸Šä¸‹æ–‡å’Œæå‡](https://levelup.gitconnected.com/javascript-execution-context-and-hoisting-c2cc4993e37d)
2.  [Javascript â€”ç”Ÿæˆå™¨-äº§å‡º/ä¸‹ä¸€ä¸ª&å¼‚æ­¥-ç­‰å¾…ğŸ¤”](https://medium.com/datadriveninvestor/javascript-generator-yield-next-async-await-8442d2c77185)
3.  [Javascript æ•°æ®ç»“æ„ä¸æ˜ å°„ã€å½’çº¦ã€è¿‡æ»¤](https://levelup.gitconnected.com/write-beautiful-javascript-with-%CE%BB-fp-es6-350cd64ab5bf)
4.  [Javascript- Currying VS éƒ¨åˆ†åº”ç”¨](https://medium.com/datadriveninvestor/javascript-currying-vs-partial-application-4db5b2442be8)
5.  [Javascript ES6 â€”å¯è¿­ä»£ç¨‹åºå’Œè¿­ä»£å™¨](https://medium.com/datadriveninvestor/javascript-es6-iterables-and-iterators-de18b54f4d4)
6.  [Javascript â€”ä»£ç†](https://medium.com/datadriveninvestor/why-to-use-javascript-proxy-5cdc69d943e3)ï¼Œ [Javascript â€”ä½œç”¨åŸŸ](https://medium.com/datadriveninvestor/still-confused-in-js-scopes-f7dae62c16ee)

## å¦‚æœä½ å–œæ¬¢è¿™ç¯‡æ–‡ç« ï¼Œè¯·éšæ—¶åˆ†äº«ï¼Œå¹¶å¸®åŠ©ä»–äººæ‰¾åˆ°å®ƒï¼

**è°¢è°¢ï¼**