<html>
<head>
<title>OCR for Scanned Numbers using Google’s AutoML Vision</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用 Google 的 AutoML Vision 对扫描的数字进行 OCR</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/ocr-for-scanned-numbers-using-googles-automl-vision-29d193070c64?source=collection_archive---------14-----------------------#2019-05-19">https://towardsdatascience.com/ocr-for-scanned-numbers-using-googles-automl-vision-29d193070c64?source=collection_archive---------14-----------------------#2019-05-19</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="5c0d" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">AutoML —易用性展示</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ki"><img src="../Images/f7353bc38e5d57987a4bf016cb805f14.png" data-original-src="https://miro.medium.com/v2/resize:fit:1300/format:webp/1*ip29F0lAOLyU-5kavLwKTA.png"/></div></figure><h1 id="f3cb" class="kq kr it bd ks kt ku kv kw kx ky kz la jz lb ka lc kc ld kd le kf lf kg lg lh bi translated">介绍</h1><p id="7c57" class="pw-post-body-paragraph li lj it lk b ll lm ju ln lo lp jx lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在之前的一篇博客文章<a class="ae me" href="http://tiny.cc/rcit6y" rel="noopener ugc nofollow" target="_blank"><strong class="lk iu"/></a>，<strong class="lk iu"> </strong>中，我详细介绍了我用来为扫描的数字创建 OCR 的步骤，如下图所示，通过使用<strong class="lk iu">梯度方向直方图(HOG)对从图像(数字)中提取的一组特征训练<strong class="lk iu">k-近邻(k-NN) </strong>机器学习模型。</strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mf"><img src="../Images/51b5590ac10164db3a17874c72badfe7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DjE-7fWEI-zkkBPBQMhpig.jpeg"/></div><figcaption class="mg mh gj gh gi mi mj bd b be z dk">Figure 1. Scanned numbers to OCR</figcaption></figure><p id="9401" class="pw-post-body-paragraph li lj it lk b ll mk ju ln lo ml jx lq lr mm lt lu lv mn lx ly lz mo mb mc md im bi translated">概括来说，实现 OCR 的步骤以及每个任务或阶段中涉及的相应工作可以概括为:</p><ol class=""><li id="a0b5" class="mp mq it lk b ll mk lo ml lr mr lv ms lz mt md mu mv mw mx bi translated"><strong class="lk iu">图像处理寻找数字周围的边界框(25%) </strong></li><li id="f653" class="mp mq it lk b ll my lo mz lr na lv nb lz nc md mu mv mw mx bi translated"><strong class="lk iu">从数字中提取数字，并创建一个训练/测试集(10%) </strong></li><li id="22e6" class="mp mq it lk b ll my lo mz lr na lv nb lz nc md mu mv mw mx bi translated"><strong class="lk iu">识别并应用合适的特征提取(梯度方向直方图)(35%) </strong></li><li id="720a" class="mp mq it lk b ll my lo mz lr na lv nb lz nc md mu mv mw mx bi translated"><strong class="lk iu">实验并应用不同的机器学习算法(KNN vs SVM) (20%) </strong></li><li id="cd04" class="mp mq it lk b ll my lo mz lr na lv nb lz nc md mu mv mw mx bi translated"><strong class="lk iu">以有意义的方式展示数据(10%) </strong></li></ol><h1 id="731f" class="kq kr it bd ks kt ku kv kw kx ky kz la jz lb ka lc kc ld kd le kf lf kg lg lh bi translated">自动视觉</h1><p id="0b53" class="pw-post-body-paragraph li lj it lk b ll lm ju ln lo lp jx lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在这篇博客中，我将详细介绍使用<strong class="lk iu"> AutoML </strong>为同一问题创建 OCR 的步骤。如下图所示，<strong class="lk iu"> AutoML </strong>消除了我工作中的一项繁琐任务，即寻找并应用合适的特征提取和机器学习技术。该模型达到了 98%的准确率，略好于之前博客中的解决方案。</p><p id="e6f8" class="pw-post-body-paragraph li lj it lk b ll mk ju ln lo ml jx lq lr mm lt lu lv mn lx ly lz mo mb mc md im bi translated">本项目使用的数据集可下载:<a class="ae me" href="https://drive.google.com/file/d/1IRPQo_Rv8ygvz-hQuQ0HLpaY4ed7wXfZ/view?usp=sharing" rel="noopener ugc nofollow" target="_blank">https://drive . Google . com/file/d/1 irpqo _ r V8 ygvz-hquq 0 hlpay 4 ed 7 wxfz/view？usp =分享</a></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ne nf di ng bf nh"><div class="gh gi nd"><img src="../Images/ef11271a66c9e22215a302ccdc95bd1b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3635dbsY0qPwPLBZT1PtoQ.png"/></div></div><figcaption class="mg mh gj gh gi mi mj bd b be z dk">Figure 2. Stages replaced by AutoML</figcaption></figure><h2 id="7807" class="ni kr it bd ks nj nk dn kw nl nm dp la lr nn no lc lv np nq le lz nr ns lg nt bi translated">1 —图像处理:训练/测试数据集准备</h2><p id="41a8" class="pw-post-body-paragraph li lj it lk b ll lm ju ln lo lp jx lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">概括一下我以前的博客，我的训练/测试集包括如下所示的数字(0、2、5、6 和 8 数据集的例子)。这些数字是从图 1 所示的扫描数字中提取的。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/36e5ad724b53266c1113b350b59be508.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/format:webp/1*uWCd6ypBajMw13VvUI50Zw.jpeg"/></div><figcaption class="mg mh gj gh gi mi mj bd b be z dk">Figure 3. Splitting numbers into single digits</figcaption></figure><p id="214f" class="pw-post-body-paragraph li lj it lk b ll mk ju ln lo ml jx lq lr mm lt lu lv mn lx ly lz mo mb mc md im bi translated">然后，训练/测试数据集被组织在文件夹中，其中每个文件夹的名称代表存储在该文件夹中的数字的标签。</p><div class="kj kk kl km gt ab cb"><figure class="nv kn nw nx ny nz oa paragraph-image"><div role="button" tabindex="0" class="ne nf di ng bf nh"><img src="../Images/4aaf9b3c9ac666ddf798a311eb8fd5ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1104/format:webp/1*Fo_9Vne8iXNLULzul5GO-Q.png"/></div></figure><figure class="nv kn ob nx ny nz oa paragraph-image"><div role="button" tabindex="0" class="ne nf di ng bf nh"><img src="../Images/089ca618688b120d71d02ff0b479e606.png" data-original-src="https://miro.medium.com/v2/resize:fit:898/format:webp/1*y7a1oFFyWERBA5vtfAwgZw.png"/></div><figcaption class="mg mh gj gh gi mi mj bd b be z dk oc di od oe">Figure 4. Train / Test dataset sorted in folders</figcaption></figure></div><h2 id="775a" class="ni kr it bd ks nj nk dn kw nl nm dp la lr nn no lc lv np nq le lz nr ns lg nt bi translated">2-训练/测试数据集上传</h2><p id="b6ae" class="pw-post-body-paragraph li lj it lk b ll lm ju ln lo lp jx lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">Google AutoML 提供了两个上传训练/测试数据集的选项。</p><p id="9b40" class="pw-post-body-paragraph li lj it lk b ll mk ju ln lo ml jx lq lr mm lt lu lv mn lx ly lz mo mb mc md im bi translated"><strong class="lk iu">选项 1 </strong>:上传数字并存储在 Google cloud 上，并提供一个 CSV 文件，列出每个数字的 URL 及其对应的标签。</p><p id="7e69" class="pw-post-body-paragraph li lj it lk b ll mk ju ln lo ml jx lq lr mm lt lu lv mn lx ly lz mo mb mc md im bi translated"><strong class="lk iu">选项 2 </strong>(我博客里用的):压缩包含数据集的文件夹，上传压缩文件。Google ML 假设每个文件夹的名称是存储在其中的数字的标签。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ne nf di ng bf nh"><div class="gh gi of"><img src="../Images/c9b4d4d0bccd8c2f8e0ee0e4f4137584.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DEnCyY2q3weULhIZb6A39A.png"/></div></div><figcaption class="mg mh gj gh gi mi mj bd b be z dk">Figure 5. Uploading train/test dataset to Google ML</figcaption></figure><p id="6350" class="pw-post-body-paragraph li lj it lk b ll mk ju ln lo ml jx lq lr mm lt lu lv mn lx ly lz mo mb mc md im bi translated">AutoML 正确地识别了每个数字的标签(图 6)并提供了基本的数据集分析(图 7)，并准备好创建 ML 模型(或模型？)点击“开始训练”。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ne nf di ng bf nh"><div class="gh gi og"><img src="../Images/3c3d9b11e85cbdc644aa4b40f1529be0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tBBxW567aV-csCLQdsW0Tg.png"/></div></div><figcaption class="mg mh gj gh gi mi mj bd b be z dk">Figure 6. Dataset uploaded and label identified</figcaption></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ne nf di ng bf nh"><div class="gh gi oh"><img src="../Images/2df57b9f0d6479a1353bc93a43abf7c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aUN4lxCi_Ez6DS5uWHi4GA.png"/></div></div><figcaption class="mg mh gj gh gi mi mj bd b be z dk">Figure 7. Basic dataset analysis</figcaption></figure><h2 id="af21" class="ni kr it bd ks nj nk dn kw nl nm dp la lr nn no lc lv np nq le lz nr ns lg nt bi translated">4 —模型精度</h2><p id="01ae" class="pw-post-body-paragraph li lj it lk b ll lm ju ln lo lp jx lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">训练模型花了 15 分钟。ML 模型准确度/精度和混淆矩阵如下所示。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ne nf di ng bf nh"><div class="gh gi oi"><img src="../Images/7198b92d285f85b00b94b81f1d5ce77d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XDNz60EJTuVrYDyrYH0LKg.png"/></div></div><figcaption class="mg mh gj gh gi mi mj bd b be z dk">Figure 7. Model accuracy</figcaption></figure><h2 id="8795" class="ni kr it bd ks nj nk dn kw nl nm dp la lr nn no lc lv np nq le lz nr ns lg nt bi translated">5-混淆矩阵</h2><p id="93c4" class="pw-post-body-paragraph li lj it lk b ll lm ju ln lo lp jx lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">混淆矩阵如下:</p><ul class=""><li id="89a9" class="mp mq it lk b ll mk lo ml lr mr lv ms lz mt md oj mv mw mx bi translated">该模型能够以 100%的准确度(基于训练/测试数据集)预测数字(4、9、0、1、2 和 7)。</li><li id="3bed" class="mp mq it lk b ll my lo mz lr na lv nb lz nc md oj mv mw mx bi translated">有 8.7%的几率会把 8 混淆为 6。</li><li id="c78a" class="mp mq it lk b ll my lo mz lr na lv nb lz nc md oj mv mw mx bi translated">1.8%的几率会把 5 误认为 3。</li><li id="50df" class="mp mq it lk b ll my lo mz lr na lv nb lz nc md oj mv mw mx bi translated">有 2.9%的几率将 3 混淆为 5。</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ne nf di ng bf nh"><div class="gh gi ok"><img src="../Images/da0d88ddb1b83503ca600d44457212c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gUw7vAqdwIZoaqYARq5PyQ.png"/></div></div><figcaption class="mg mh gj gh gi mi mj bd b be z dk">Figure 8. Confusion matrix</figcaption></figure><h2 id="fdf0" class="ni kr it bd ks nj nk dn kw nl nm dp la lr nn no lc lv np nq le lz nr ns lg nt bi translated">6 —预测</h2><p id="f69d" class="pw-post-body-paragraph li lj it lk b ll lm ju ln lo lp jx lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">要测试模型，只需上传数字来运行预测，或者使用 Google 提供的 API(图 8)。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ne nf di ng bf nh"><div class="gh gi ol"><img src="../Images/164246c60f4f92f3a6659ad2256d5797.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ebRcM34whvFEe3Bnd4pvdA.png"/></div></div><figcaption class="mg mh gj gh gi mi mj bd b be z dk">Figure 8. ML model is exposed as an API and hosted on Google Cloud</figcaption></figure><p id="64d4" class="pw-post-body-paragraph li lj it lk b ll mk ju ln lo ml jx lq lr mm lt lu lv mn lx ly lz mo mb mc md im bi translated"><strong class="lk iu">正确预测:例 1 </strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ne nf di ng bf nh"><div class="gh gi om"><img src="../Images/5b9ee99a19037ea6341ce5e783d94ac1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GufkjEXl3eXZ5ay96Mbqdw.png"/></div></div><figcaption class="mg mh gj gh gi mi mj bd b be z dk">Figure 9. Accurate prediction</figcaption></figure><p id="c9e8" class="pw-post-body-paragraph li lj it lk b ll mk ju ln lo ml jx lq lr mm lt lu lv mn lx ly lz mo mb mc md im bi translated"><strong class="lk iu">正确预测:例二</strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ne nf di ng bf nh"><div class="gh gi on"><img src="../Images/a1d1cb03ca5226fcda2a17d568a6887d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AGtF-JJ1TGDxC2fSI2MJ9Q.png"/></div></div><figcaption class="mg mh gj gh gi mi mj bd b be z dk">Figure 10. Accurate prediction</figcaption></figure><p id="f6fa" class="pw-post-body-paragraph li lj it lk b ll mk ju ln lo ml jx lq lr mm lt lu lv mn lx ly lz mo mb mc md im bi translated"><strong class="lk iu">错误预测:例 3 </strong></p><p id="5979" class="pw-post-body-paragraph li lj it lk b ll mk ju ln lo ml jx lq lr mm lt lu lv mn lx ly lz mo mb mc md im bi translated">这是出乎意料的，该模型将 a 6 混淆为 A8，尽管混淆矩阵显示它可以 100%准确地预测 a 6。</p><p id="a40f" class="pw-post-body-paragraph li lj it lk b ll mk ju ln lo ml jx lq lr mm lt lu lv mn lx ly lz mo mb mc md im bi translated">作为未来的工作，我可能会训练第二个或更多的机器学习模型，每个模型都是为一对与第一个模型混淆的数字(即 6 和 8)量身定制的。我可能还会提供部分图像来训练模型，例如，只提供 6 位和 8 位数字的上半部分，因为这些数字在上象限大部分是不同的。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ne nf di ng bf nh"><div class="gh gi oo"><img src="../Images/77b799ccbad6f6e92858f9966b2c78fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*svYnKt03e8pqi31shKEcqw.png"/></div></div><figcaption class="mg mh gj gh gi mi mj bd b be z dk">Figure 11. Wrong prediction</figcaption></figure><h1 id="5952" class="kq kr it bd ks kt ku kv kw kx ky kz la jz lb ka lc kc ld kd le kf lf kg lg lh bi translated">结束语</h1><p id="695f" class="pw-post-body-paragraph li lj it lk b ll lm ju ln lo lp jx lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">有趣的是看到 Google ML 如何自动化数据科学家的乏味工作，即寻找合适的特征提取技术和调整机器学习模型。然而，我认为数据科学家工作的困难部分实际上是确定可以使用机器学习解决的问题，最重要的是能够提取适合使用机器学习解决的数据集。后者需要扎实的编程技能和对不同机器学习技术如何工作的深刻理解。</p></div></div>    
</body>
</html>