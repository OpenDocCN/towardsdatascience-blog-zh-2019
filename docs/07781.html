<html>
<head>
<title>Machine Learning Model Comparison for Breast Cancer Classification and Bio-Marker Identification</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用于乳腺癌分类和生物标记识别的机器学习模型比较</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/machine-learning-for-breast-cancer-classification-and-bio-marker-identification-d92bdc1e0d1e?source=collection_archive---------12-----------------------#2019-10-28">https://towardsdatascience.com/machine-learning-for-breast-cancer-classification-and-bio-marker-identification-d92bdc1e0d1e?source=collection_archive---------12-----------------------#2019-10-28</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="bf7e" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">以 Python 中的配对图和相关矩阵构造为特色。</h2></div></div><div class="ab cl kf kg hu kh" role="separator"><span class="ki bw bk kj kk kl"/><span class="ki bw bk kj kk kl"/><span class="ki bw bk kj kk"/></div><div class="ij ik il im in"><p id="3b84" class="pw-post-body-paragraph km kn iq ko b kp kq jr kr ks kt ju ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">这个数据集可供公众研究。鸣谢:帕特里西奥，m .，佩雷拉，j .，克里斯索斯托莫，j .，马塔福梅，p .，戈梅斯，m .，塞萨，r .，&amp;卡拉梅洛，F. (2018)。使用抵抗素、葡萄糖、年龄和身体质量指数预测乳腺癌的存在。BMC 癌症，18(1)。</p><p id="1083" class="pw-post-body-paragraph km kn iq ko b kp kq jr kr ks kt ju ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">2019 年，美国估计有 268，600 名女性被诊断患有乳腺癌。尽管女性乳腺癌发病率(在 50 岁及以上的女性中)逐渐下降，存活率也有所上升，但仍需要进行研究以解决乳腺癌问题(https://www . national breast cancer . org/breast-cancer-facts)。存活率增加的主要原因之一是更好的筛查和早期检测做法；这可以包括评估生物标记。生物标记是生物体中可测量的物质，如个体的血糖水平，可以作为疾病或感染存在的指标。</p><p id="6365" class="pw-post-body-paragraph km kn iq ko b kp kq jr kr ks kt ju ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">这个项目和这篇文章的目标是尝试使用相对少量的数据开发一个强大的预测模型。我的目的是展示机器学习应用中存在的小样本问题，同时探索预测分析在医疗决策中的实际应用。通过利用探索性分析和机器学习模型，我的目标是识别可以指示患者乳腺癌的具有统计意义的生物标记。这个数据集包含 116 行，每行有 9 个属性，一列表示分类。在分类方面，有 64 名乳腺癌患者和 52 名健康对照。116 行对于执行机器学习技术来说相对较低，但尝试各种预测模型是值得的。小样本量在机器学习任务中提出了相当大的挑战，因为过拟合可能导致对一个类别的高偏差。通过合并交叉验证程序，我将尝试最小化隐含的分类偏差。基于给定的变量(或者甚至是所提供的生物标记的小子集)的强预测模型可以用于测试容易收集的生物标记并指示乳腺癌。以下生物标记是该数据集中的属性:</p><p id="2788" class="pw-post-body-paragraph km kn iq ko b kp kq jr kr ks kt ju ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated"><strong class="ko ir">年龄</strong>，<strong class="ko ir">身体质量指数</strong>，<strong class="ko ir">葡萄糖</strong>，<strong class="ko ir">胰岛素</strong>，<strong class="ko ir">稳态模型评估</strong>(量化胰岛素抵抗和β细胞功能)<strong class="ko ir">瘦素</strong>(小肠中脂肪细胞产生的一种激素，有助于调节能量平衡)<strong class="ko ir">脂联素</strong>(参与调节葡萄糖水平和脂肪酸分解的蛋白质激素)<strong class="ko ir">抵抗素</strong>(脂肪储存细胞、免疫细胞和上皮细胞分泌的肽</p><p id="c0f6" class="pw-post-body-paragraph km kn iq ko b kp kq jr kr ks kt ju ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">我采取的第一步是查看特征的描述性统计数据，然后生成一个相关矩阵。在取平均值和查看分布之前，我将数据集除以目标值，以分别查看健康对照组和乳腺癌患者的描述性统计数据。</p><p id="4deb" class="pw-post-body-paragraph km kn iq ko b kp kq jr kr ks kt ju ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">健康对照组的描述性统计数据:</p><figure class="lj lk ll lm gt ln gh gi paragraph-image"><div role="button" tabindex="0" class="lo lp di lq bf lr"><div class="gh gi li"><img src="../Images/a069bcedc8996d0f93577feb782a91d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wXR8WaxK42hUbtInUaRI2Q.png"/></div></div><figcaption class="lu lv gj gh gi lw lx bd b be z dk">Those in the healthy control group show what would be considered ‘normal’ levels for these 8 bio-markers.</figcaption></figure><p id="e96e" class="pw-post-body-paragraph km kn iq ko b kp kq jr kr ks kt ju ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">乳腺癌患者的描述性统计:</p><figure class="lj lk ll lm gt ln gh gi paragraph-image"><div role="button" tabindex="0" class="lo lp di lq bf lr"><div class="gh gi ly"><img src="../Images/87d007dacf1c5eb3452b1cbd3412209b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BBxGEuydJPDRVUfIAG6Ywg.png"/></div></div><figcaption class="lu lv gj gh gi lw lx bd b be z dk">Glucose, Insulin, HOMA, Resistin, and MCP-1 levels in breast cancer patients tend to be higher, based on averages, than those in the control group.</figcaption></figure><p id="0cda" class="pw-post-body-paragraph km kn iq ko b kp kq jr kr ks kt ju ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">这两个阶层的平均年龄相对接近，身体质量指数、瘦素和脂联素值也是如此。值得注意的是，健康对照人群中的最低年龄是 24 岁，而最年轻的乳腺癌患者是 34 岁，尽管他们的平均年龄相似。在健康对照样品(平均 88.23 mg/dL)和乳腺癌患者(平均 105.56 mg/dL)之间的血糖水平有相当大的差异。在基于决策树的模型中，葡萄糖可以作为良好的预测因子或分裂点来对乳腺癌患者进行分类。胰岛素、抵抗素和 MCP-1 遵循相似的趋势，平均而言，乳腺癌患者显示出比健康对照组更高的值。这些生物标志物可能被证明是比身体质量指数、瘦素和脂联素更好的预测因子，但现在下这样的结论还为时过早。</p><p id="99fe" class="pw-post-body-paragraph km kn iq ko b kp kq jr kr ks kt ju ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">下面，我使用“seaborn”可视化软件包来制作一个配对图。配对图显示了数据集中所有特征之间的关系，包括每个特征的分布。我对数据进行了过滤，橙色的点是乳腺癌数据，蓝色的点是健康的对照患者。因此，我们不仅可以看到所有的变量关系，还可以在类中寻找模式。</p><figure class="lj lk ll lm gt ln gh gi paragraph-image"><div role="button" tabindex="0" class="lo lp di lq bf lr"><div class="gh gi lz"><img src="../Images/826d688072087f129d5db28c96cf5000.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TBTI0BMYxMxcD6Z5QlesIQ.png"/></div></div></figure><p id="1028" class="pw-post-body-paragraph km kn iq ko b kp kq jr kr ks kt ju ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">年龄、身体质量指数、MCP-1 似乎呈正态分布。葡萄糖、胰岛素、HOMA、瘦素、脂联素和抵抗素具有右偏分布。如果你观察 HOMA 和胰岛素，你会发现散点图中有很强的正线性关系。也就是说，这两个变量之间的关系可以使用直线回归模型精确建模。胰岛素和 HOMA 也是如此。身体质量指数和葡萄糖似乎有一个坚实的集群分离，我们可以看到这两个类存在于各自的领域。如果用在 KNN 模型中，这两个变量以后会成为强有力的特征。</p><p id="867e" class="pw-post-body-paragraph km kn iq ko b kp kq jr kr ks kt ju ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">让我们看看这些生物标记中是否有任何一个与另一个高度相关。如果我们试图使用没有相关性或相关性很小的变量来训练机器学习模型，我们的模型将返回不准确的结果。为了制作相关矩阵热图，我引入了 Python 包“seaborn”它将计算两个变量之间关系的正或负线性强度的相关系数可视化。</p><figure class="lj lk ll lm gt ln"><div class="bz fp l di"><div class="ma mb l"/></div></figure><figure class="lj lk ll lm gt ln gh gi paragraph-image"><div class="gh gi mc"><img src="../Images/7ff0c6dc71c03a40b3025ba7912d16ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1314/format:webp/1*QKI7YoH2Bb2h__aCPDqYOQ.png"/></div><figcaption class="lu lv gj gh gi lw lx bd b be z dk">Values close to 1.0, like 0.93 and 0.7, show a strong positive linear relationship between the two variables while values close to -1.0 show the inverse, strong but negatively correlated.</figcaption></figure><ul class=""><li id="57b2" class="md me iq ko b kp kq ks kt kv mf kz mg ld mh lh mi mj mk ml bi translated">身体质量指数和瘦素的正相关值为 0.57</li><li id="0080" class="md me iq ko b kp mm ks mn kv mo kz mp ld mq lh mi mj mk ml bi translated">葡萄糖和 HOMA 具有中等强度的正相关值 0.7</li><li id="8496" class="md me iq ko b kp mm ks mn kv mo kz mp ld mq lh mi mj mk ml bi translated">葡萄糖和胰岛素具有 0.5 的正相关值</li><li id="18fa" class="md me iq ko b kp mm ks mn kv mo kz mp ld mq lh mi mj mk ml bi translated">胰岛素和 HOMA 具有非常强的正相关值 0.93</li><li id="ce38" class="md me iq ko b kp mm ks mn kv mo kz mp ld mq lh mi mj mk ml bi translated">葡萄糖、胰岛素、HOMA 和抵抗素都在高于 0.2 的水平上与分类变量正相关</li><li id="84a9" class="md me iq ko b kp mm ks mn kv mo kz mp ld mq lh mi mj mk ml bi translated">在某种程度上，所有的变量都是相互关联的</li></ul><p id="1fb2" class="pw-post-body-paragraph km kn iq ko b kp kq jr kr ks kt ju ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">接下来，我将测试 sklearn 包提供的各种分类模型，在确定最佳模型后，我将研究它的架构。我使用 sklearn 包中的 train_test_split 函数来创建训练和测试数据集，并应用缩放。需要注意的是，数值的标度并不完全相同，有些数值以 mg/dL、pg/dL 和 kg/m 为单位，因此在将数据输入 ML 模型之前，应用标度函数是一个关键的预处理步骤。</p><p id="9b2e" class="pw-post-body-paragraph km kn iq ko b kp kq jr kr ks kt ju ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">我根据数据训练的第一个模型是逻辑回归，一种简单的分类方法。最初，它在测试数据上返回 62%的准确率，有 8 个假阴性(错过了 8 个癌症样本)和 3 个假阳性(3 个健康样本被分类为癌症)。该模型为预测健康类返回了 57%的精度值和 33%的召回值。由于样本量小，结果初步偏低。对于分类问题中的低样本量，一个很好的补救方法是<strong class="ko ir">改变损失函数</strong>。分类问题使用交叉熵损失来训练和优化模型，在样本量较低的情况下，模型在尝试优化其损失值时会偏向一个类别。为了补救，我将权重值添加到与不同类别相对应的损失中，以消除偏差。这很容易通过添加参数 class_weight = 'balanced '来实现，该参数查找类权重并平衡数据比率以消除偏差。我使用平衡类权重参数运行另一个逻辑回归模型。</p><figure class="lj lk ll lm gt ln"><div class="bz fp l di"><div class="ma mb l"/></div></figure><p id="3bfb" class="pw-post-body-paragraph km kn iq ko b kp kq jr kr ks kt ju ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">这在测试集上返回了 69%的准确率，提高了 7%，并且我们还消除了 3 个假阴性。</p><p id="723b" class="pw-post-body-paragraph km kn iq ko b kp kq jr kr ks kt ju ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">接下来，我使用平衡和非平衡类权重参数训练了一个线性判别分析模型、一个决策树模型和一个 k-最近邻模型。最好的模型是 KNN，准确率为 79%，只有 3 个假阴性和 3 个假阳性。</p><figure class="lj lk ll lm gt ln gh gi paragraph-image"><div role="button" tabindex="0" class="lo lp di lq bf lr"><div class="gh gi mr"><img src="../Images/5a0005126e126096f950c2d56ae747fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KO7MLe2gw7jijEayKuN0Fg.png"/></div></div></figure><p id="ea3f" class="pw-post-body-paragraph km kn iq ko b kp kq jr kr ks kt ju ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">我试图通过找到 k 的最佳值来调整 k-nn。虽然我能达到的最大精度是 79%，但没有任何改进。</p><figure class="lj lk ll lm gt ln"><div class="bz fp l di"><div class="ma mb l"/></div></figure><figure class="lj lk ll lm gt ln gh gi paragraph-image"><div class="gh gi ms"><img src="../Images/038179dcc385bd33a64770ea226bf664.png" data-original-src="https://miro.medium.com/v2/resize:fit:790/format:webp/1*SaaYP8gQZZwU9WgCsrY-hg.png"/></div><figcaption class="lu lv gj gh gi lw lx bd b be z dk">This visualizes the attempt to find the best value for k based on accuracy. We see that 1, 5, 7 are the best values for k when optimizing for accuracy.</figcaption></figure><p id="d2ab" class="pw-post-body-paragraph km kn iq ko b kp kq jr kr ks kt ju ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">对我来说，这个项目的一个重要部分是识别生物标记。我选择训练一个随机森林分类器，这样我们就可以接收一个可变的重要性输出，并查看哪些生物标记被认为是“最重要的”，从统计角度来说，在确定样本是否患有癌症方面。</p><figure class="lj lk ll lm gt ln gh gi paragraph-image"><div class="gh gi mt"><img src="../Images/a9767fb0c4bc6ba1faba04a726e4973e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*nreLvf8wPCalrigU9RjZSA.png"/></div></figure><p id="59aa" class="pw-post-body-paragraph km kn iq ko b kp kq jr kr ks kt ju ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">一个<strong class="ko ir">随机森林</strong>是许多单个决策树的集合。它将决策树的多数结果作为最终值。最初的随机森林模型表现糟糕，准确率为 58.6%。我使用交叉验证实现了一个随机搜索，以确定随机森林模型的最佳超参数，希望实现更好的准确性和更透明的机器模型。</p><figure class="lj lk ll lm gt ln"><div class="bz fp l di"><div class="ma mb l"/></div></figure><p id="1070" class="pw-post-body-paragraph km kn iq ko b kp kq jr kr ks kt ju ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">这段代码构建了一个随机搜索来<strong class="ko ir">识别随机森林进行分类的最佳参数</strong>。以下代码使用上面定义的随机网格搜索，运行 100 种不同的模型组合，并确定最佳组合。</p><figure class="lj lk ll lm gt ln"><div class="bz fp l di"><div class="ma mb l"/></div></figure><p id="f635" class="pw-post-body-paragraph km kn iq ko b kp kq jr kr ks kt ju ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">这些是最佳参数:</p><p id="f5a7" class="pw-post-body-paragraph km kn iq ko b kp kq jr kr ks kt ju ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">{'n_estimators': 266，' min_samples_split': 5，' min_samples_leaf': 1，' max_features': 'sqrt '，' max_depth': 30，' bootstrap': True}</p><p id="ea74" class="pw-post-body-paragraph km kn iq ko b kp kq jr kr ks kt ju ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">使用可能的最佳随机森林模型，我们实现了 68.97% 的<strong class="ko ir">准确度。这个分数与逻辑回归的结果相当，但比 KNN 差。在我看来，随机森林最有用的输出是<strong class="ko ir">特征重要性</strong>。它显示了哪些变量，从统计学上来说，在进行分类时最重要。这个输出使得随机森林模型不那么像一个抽象的“黑盒”,并且允许我们看一看它是如何做出某些决定的。</strong></p><figure class="lj lk ll lm gt ln gh gi paragraph-image"><div class="gh gi mu"><img src="../Images/0aeafc8fa02ae0c6ea645064d99d64a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:866/format:webp/1*qu7CTPdAfNKvN8dLQ1Jjgg.png"/></div></figure><p id="c69a" class="pw-post-body-paragraph km kn iq ko b kp kq jr kr ks kt ju ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">基于上面的可变重要性结果，我选择了两个最重要的特征，并将它们可视化，然后应用目前为止表现最好的模型，KNN。</p><figure class="lj lk ll lm gt ln"><div class="bz fp l di"><div class="ma mb l"/></div></figure><p id="99f3" class="pw-post-body-paragraph km kn iq ko b kp kq jr kr ks kt ju ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">在上面的代码块中，我将 K 的值设置为我之前确定的获得最佳精度的值之一，在本例中是 K = 5。然后，我将 k-最近邻模型仅适用于两个特征:葡萄糖和身体质量指数。</p><figure class="lj lk ll lm gt ln gh gi paragraph-image"><div class="gh gi mv"><img src="../Images/abd4854a13f57d4da155324923b108ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:766/format:webp/1*4fuVPM8aoHUh1CwGRomQXg.png"/></div><figcaption class="lu lv gj gh gi lw lx bd b be z dk">Red = Healthy Controls. Green = Breast Cancer Patients</figcaption></figure><p id="4112" class="pw-post-body-paragraph km kn iq ko b kp kq jr kr ks kt ju ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">这种可视化有助于对我们的预测模型进行推断。在大约 90 (mg/dL)葡萄糖水平处，存在垂直截止，其中来自任一类别的一些样品混合。在 120 (mg/dL)之后，所有样品都是乳腺癌患者。</p><p id="e247" class="pw-post-body-paragraph km kn iq ko b kp kq jr kr ks kt ju ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated"><strong class="ko ir">结论</strong></p><p id="f367" class="pw-post-body-paragraph km kn iq ko b kp kq jr kr ks kt ju ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">葡萄糖和身体质量指数一起可能是检测乳腺癌的两个强有力的生物标记。对这两个生物标记进行建模，并添加 HOMA 和抵抗素水平(接下来的两个重要特征)，我用 k 最近邻法对乳腺癌样本进行分类时达到了几乎 80%的准确率。因此，这个项目表明，结合这四个重要的生物标志物，乳腺癌可以很容易地分类。如果数据集可以扩展，其他方法可能会更准确，比如随机森林。再增加一百个左右的样本有可能返回比 KNN 分类器 80%的准确率更好的结果。这些模型的运行速度也非常快，因此，如果我们能够否定假阳性/假阴性预测(最有可能是由于低样本量导致的偏差)，这些模型对于医疗应用来说是实用的。本文旨在展示小样本量对强大的机器学习方法的影响，以及如何轻松地将这些方法用于医疗诊断。</p></div></div>    
</body>
</html>