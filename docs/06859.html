<html>
<head>
<title>Predicting Pharmacokinetics with Deterministic Models</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用确定性模型预测药代动力学</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/predicting-pharmacokinetics-with-deterministic-models-and-bayesian-statistics-e3822a28977b?source=collection_archive---------24-----------------------#2019-09-29">https://towardsdatascience.com/predicting-pharmacokinetics-with-deterministic-models-and-bayesian-statistics-e3822a28977b?source=collection_archive---------24-----------------------#2019-09-29</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="c762" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsdatascience.com/tagged/clinical-data-science" rel="noopener" target="_blank">临床数据科学</a></h2><div class=""/><div class=""><h2 id="fe11" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">精准医疗之路。</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/6d52595419b4291e06036e43aeeeca54.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*xheBIzoPTFyAc0Dj"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk">Photo by <a class="ae lh" href="https://unsplash.com/@myriamzilles?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Myriam Zilles</a> on <a class="ae lh" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="2e46" class="li lj it bd lk ll lm ln lo lp lq lr ls ki lt kj lu kl lv km lw ko lx kp ly lz bi translated">介绍</h1><h2 id="45d1" class="ma lj it bd lk mb mc dn lo md me dp ls mf mg mh lu mi mj mk lw ml mm mn ly iz bi translated">药物动力学</h2><p id="9cb8" class="pw-post-body-paragraph mo mp it mq b mr ms kd mt mu mv kg mw mf mx my mz mi na nb nc ml nd ne nf ng im bi translated"><a class="ae lh" href="https://en.wikipedia.org/wiki/Pharmacokinetics" rel="noopener ugc nofollow" target="_blank"> <strong class="mq jd">【药代动力学】</strong> </a>处理<a class="ae lh" href="https://en.wikipedia.org/wiki/Xenobiotic" rel="noopener ugc nofollow" target="_blank"> <strong class="mq jd">异生素</strong> </a> <strong class="mq jd"> </strong>在生物体内的分布和代谢。在药物开发和临床研究中，人们会遇到<a class="ae lh" href="https://en.wikipedia.org/wiki/Pharmacology" rel="noopener ugc nofollow" target="_blank"> <strong class="mq jd">药理学家</strong> </a>，他们的工作是建议医生给病人提供药物的剂量。为此，他们经常运行所谓的药代动力学模型的模拟，这些模型是<a class="ae lh" href="https://en.wikipedia.org/wiki/Deterministic_system" rel="noopener ugc nofollow" target="_blank"><strong class="mq jd"/></a>确定性的，即它们由关于时间变量的<a class="ae lh" href="https://en.wikipedia.org/wiki/Ordinary_differential_equation" rel="noopener ugc nofollow" target="_blank"> <strong class="mq jd">常微分方程</strong> </a> <strong class="mq jd"> </strong>组成，并描述以下过程(称为 LADME):</p><ul class=""><li id="852b" class="nh ni it mq b mr nj mu nk mf nl mi nm ml nn ng no np nq nr bi translated"><a class="ae lh" href="https://en.wikipedia.org/wiki/Liberation_(pharmacology)" rel="noopener ugc nofollow" target="_blank"><strong class="mq jd"/></a><strong class="mq jd">:</strong>药物从<a class="ae lh" href="https://en.wikipedia.org/wiki/Pharmaceutical_formulation" rel="noopener ugc nofollow" target="_blank">药物配方中释放出来的过程</a></li><li id="fb16" class="nh ni it mq b mr ns mu nt mf nu mi nv ml nw ng no np nq nr bi translated"><a class="ae lh" href="https://en.wikipedia.org/wiki/Absorption_(pharmacology)" rel="noopener ugc nofollow" target="_blank"> <strong class="mq jd">吸收</strong> </a> <strong class="mq jd"> : </strong>物质进入血液循环的过程</li><li id="bdca" class="nh ni it mq b mr ns mu nt mf nu mi nv ml nw ng no np nq nr bi translated"><a class="ae lh" href="https://en.wikipedia.org/wiki/Distribution_(pharmacology)" rel="noopener ugc nofollow" target="_blank"> <strong class="mq jd">分布</strong> </a> <strong class="mq jd"> : </strong>物质在身体的体液和组织中的扩散或散布</li><li id="48c0" class="nh ni it mq b mr ns mu nt mf nu mi nv ml nw ng no np nq nr bi translated"><a class="ae lh" href="https://en.wikipedia.org/wiki/Metabolism" rel="noopener ugc nofollow" target="_blank"> <strong class="mq jd">代谢</strong> </a> <strong class="mq jd"> : </strong>生物体对存在外来物质的识别以及母体化合物向子代谢物的不可逆转化</li><li id="4bdf" class="nh ni it mq b mr ns mu nt mf nu mi nv ml nw ng no np nq nr bi translated"><a class="ae lh" href="https://en.wikipedia.org/wiki/Elimination_(pharmacology)" rel="noopener ugc nofollow" target="_blank"> <strong class="mq jd">清除</strong> </a>:从体内清除物质</li></ul><p id="7d69" class="pw-post-body-paragraph mo mp it mq b mr nj kd mt mu nk kg mw mf nx my mz mi ny nb nc ml nz ne nf ng im bi translated">这种模型有助于确定药物的最佳<strong class="mq jd">剂量</strong>，作为患者属性的函数，如<strong class="mq jd">体重</strong>、<strong class="mq jd">身高</strong>、<strong class="mq jd">年龄</strong>或<strong class="mq jd">性别</strong>。此外，可以预测药物在血浆中随时间的浓度分布。此外，可以监测<a class="ae lh" href="https://en.wikipedia.org/wiki/Drug_interaction" rel="noopener ugc nofollow" target="_blank"> <strong class="mq jd">药物相互作用</strong> </a>。这样，可以为单个患者定义给药间隔，为<a class="ae lh" href="https://en.wikipedia.org/wiki/Personalized_medicine" rel="noopener ugc nofollow" target="_blank"> <strong class="mq jd">个性化治疗</strong> </a> <strong class="mq jd"> </strong>铺平道路(更多信息请访问<a class="ae lh" href="https://openpk.herokuapp.com/home" rel="noopener ugc nofollow" target="_blank"> <strong class="mq jd"> openPK </strong> </a>)。</p><h2 id="163a" class="ma lj it bd lk mb mc dn lo md me dp ls mf mg mh lu mi mj mk lw ml mm mn ly iz bi translated">确定性建模</h2><p id="9e81" class="pw-post-body-paragraph mo mp it mq b mr ms kd mt mu mv kg mw mf mx my mz mi na nb nc ml nd ne nf ng im bi translated">通常，作为确定性模型一部分的这些方程组具有未知的参数，并且必须根据实验数据进行估计。身体本身被描述为一个<a class="ae lh" href="https://en.wikipedia.org/wiki/Compartment_(pharmacokinetics)" rel="noopener ugc nofollow" target="_blank"> <strong class="mq jd">多隔室</strong> </a> <strong class="mq jd">系统</strong>(器官是隔室)，在其中发生所述过程的子集，并且药物/代谢物分子<em class="oa">从一个隔室(器官)流向另一个隔室</em>。通常假设所述隔室是理想混合的，即进来的分子立即混合。请注意，依赖于时间的实验数据通常并不适用于所有的房室，尤其是人类。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ob"><img src="../Images/de69867cdb054a3981b7aa5da3737205.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*n6hhBSRM3KKL1LQPVbSiLw.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk">Plasma concentration of paracetamol for a 50-kg patient and a dose of 1 g as it can be encountered on <a class="ae lh" href="https://openpk.herokuapp.com/home" rel="noopener ugc nofollow" target="_blank"><strong class="bd oc">openPK</strong></a>. (image by author)</figcaption></figure><h1 id="817f" class="li lj it bd lk ll lm ln lo lp lq lr ls ki lt kj lu kl lv km lw ko lx kp ly lz bi translated">模型开发</h1><h2 id="f659" class="ma lj it bd lk mb mc dn lo md me dp ls mf mg mh lu mi mj mk lw ml mm mn ly iz bi translated">模型组成</h2><p id="9786" class="pw-post-body-paragraph mo mp it mq b mr ms kd mt mu mv kg mw mf mx my mz mi na nb nc ml nd ne nf ng im bi translated">开发这样一个模型的方法是制定一组微分方程(在我的<a class="ae lh" href="https://github.com/gtancev/Pharmacokinetic-Modeling-of-Ethanol-Degradation" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上可以找到一个在<a class="ae lh" href="https://de.wikipedia.org/wiki/Matlab" rel="noopener ugc nofollow" target="_blank"> <strong class="mq jd"> MATLAB </strong> </a>中编程的处理<a class="ae lh" href="https://en.wikipedia.org/wiki/Ethanol" rel="noopener ugc nofollow" target="_blank"> <strong class="mq jd">乙醇</strong> </a>代谢的例子)。下面的等式是对隔室<em class="oa"> k </em>中的化合物<em class="oa"> i </em>具有流量<em class="oa"> Q </em>和体积<em class="oa"> V </em>的<strong class="mq jd">质量平衡</strong>的一般公式。<em class="oa"> P </em>是一个分配系数，表示某一组织中保留了多少化合物。<em class="oa"> Q </em>和<em class="oa"> V </em>取决于患者的体重、身高、年龄和性别(用<a class="ae lh" href="https://en.wikipedia.org/wiki/Allometry" rel="noopener ugc nofollow" target="_blank"> <strong class="mq jd">异速生长标度</strong> </a>建模)。</p><pre class="ks kt ku kv gt od oe of og aw oh bi"><span id="5520" class="ma lj it oe b gy oi oj l ok ol">dc_dt_i_k = (Q_k/V_k)*(c_in_i_(k-1)-c_i_k/P_i_k)</span></pre><p id="2402" class="pw-post-body-paragraph mo mp it mq b mr nj kd mt mu nk kg mw mf nx my mz mi ny nb nc ml nz ne nf ng im bi translated">每个隔间的<em class="oa"> Q </em>、<em class="oa"> V </em>、<em class="oa">T37】和<em class="oa"> P </em>的值可在文献中找到。此外，药物在肝脏部分代谢，在肾脏部分排泄。在这种情况下，肝脏和肾脏的方程被修改。</em></p><pre class="ks kt ku kv gt od oe of og aw oh bi"><span id="da87" class="ma lj it oe b gy oi oj l ok ol">dc_dt_i_liver = (1/V_liver)*(Q_liver*(c_in_i-c_i_liver/P_i_liver)-<strong class="oe jd">v_max_i*c_i_liver/(K_m_i+c_i_liver)</strong>)</span><span id="eeca" class="ma lj it oe b gy om oj l ok ol">dc_dt_i_kidney = (1/V_kidney)*(Q_kidney*(c_in_i-c_i_kidney/P_i_kidney)-<strong class="oe jd">k_r_i*c_i_kidney</strong></span></pre><p id="f39c" class="pw-post-body-paragraph mo mp it mq b mr nj kd mt mu nk kg mw mf nx my mz mi ny nb nc ml nz ne nf ng im bi translated">肝方程式中的粗体术语代表由酶催化的反应的所谓的<a class="ae lh" href="https://en.wikipedia.org/wiki/Michaelis%E2%80%93Menten_kinetics" rel="noopener ugc nofollow" target="_blank"> <strong class="mq jd">米氏-门滕</strong> </a>表达式。它将反应限制到最大反应速度<em class="oa"> vmax </em>，因为用于反应的活性位点的数量是有限的。但是<em class="oa"> vmax </em>和<em class="oa"> Km </em>在文献中并不容易得到，必须从实验数据中估算(间隙项<em class="oa"> kr </em>也是如此)。此外，可能发生与其他分子竞争活性位点的情况，并且反应项可能需要通过包括抑制表达来修改。先验地不清楚哪些过程包括在哪些区间中。例如，药物在胃肠道内被吸收到血液中，但它也可能在那里分解。要走的路是制定一个初始模型，估计其参数，并在测试集上评估其性能。如果模型性能不足，则通过添加或删除一些项来改进模型，并重复该过程直到收敛。</p><h2 id="2ee4" class="ma lj it bd lk mb mc dn lo md me dp ls mf mg mh lu mi mj mk lw ml mm mn ly iz bi translated">参数估计</h2><p id="9185" class="pw-post-body-paragraph mo mp it mq b mr ms kd mt mu mv kg mw mf mx my mz mi na nb nc ml nd ne nf ng im bi translated">有不同的目标函数用于参数估计。首先，常规的<a class="ae lh" href="https://en.wikipedia.org/wiki/Least_squares" rel="noopener ugc nofollow" target="_blank"> <strong class="mq jd">最小二乘问题</strong> </a> <strong class="mq jd"> </strong>可以被最小化(浓度是参数<em class="oa"> p </em>的函数，目标函数<em class="oa"> J </em>也是如此)。为此，所有隔室<em class="oa"> k </em>中的所有化合物<em class="oa"> i </em>的浓度堆叠在一列中(使用<em class="oa">整形</em>功能以避免 for 循环)。变量<em class="oa"> c_m </em>是指测量的浓度，而 c_ <em class="oa"> p </em>是预测的浓度。</p><pre class="ks kt ku kv gt od oe of og aw oh bi"><span id="99f8" class="ma lj it oe b gy oi oj l ok ol">J = (1/N)*(c_m-c_p)'*(c_m-c_p)</span></pre><p id="9b85" class="pw-post-body-paragraph mo mp it mq b mr nj kd mt mu nk kg mw mf nx my mz mi ny nb nc ml nz ne nf ng im bi translated">这个函数的缺点是，它比低浓度的分子更适合高浓度的分子，因为它们对目标的贡献小得多。另一种可能性是用一个<strong class="mq jd">协方差矩阵</strong>的逆来缩放点积，并将其重新表述为一个<a class="ae lh" href="https://de.wikipedia.org/wiki/Maximum-Likelihood-Methode" rel="noopener ugc nofollow" target="_blank"> <strong class="mq jd">最大似然</strong> </a>问题。当然，方差矩阵<em class="oa"> E </em>也得知道。</p><pre class="ks kt ku kv gt od oe of og aw oh bi"><span id="b12d" class="ma lj it oe b gy oi oj l ok ol">J = (1/N)*(c_m-c_p)'<strong class="oe jd">*inv(E)</strong>*(c_m-c_p)</span></pre><p id="1c13" class="pw-post-body-paragraph mo mp it mq b mr nj kd mt mu nk kg mw mf nx my mz mi ny nb nc ml nz ne nf ng im bi translated"><em class="oa"> E </em>可以例如从每个隔室中每种化合物的<a class="ae lh" href="https://en.wikipedia.org/wiki/Coefficient_of_variation" rel="noopener ugc nofollow" target="_blank"> <strong class="mq jd">变异系数</strong> </a> <em class="oa"> cv </em>中估算。</p><pre class="ks kt ku kv gt od oe of og aw oh bi"><span id="d2a2" class="ma lj it oe b gy oi oj l ok ol">E = cv'*c_m</span></pre><p id="d4f9" class="pw-post-body-paragraph mo mp it mq b mr nj kd mt mu nk kg mw mf nx my mz mi ny nb nc ml nz ne nf ng im bi translated">最后，模型必须包含在目标函数中。利用这些参数，使用微分方程求解器(例如，<em class="oa"> ode15s </em>处理<a class="ae lh" href="https://en.wikipedia.org/wiki/Stiff_equation" rel="noopener ugc nofollow" target="_blank"> <strong class="mq jd">刚度</strong> </a>)评估模型并计算预测浓度，即通过<a class="ae lh" href="https://en.wikipedia.org/wiki/Runge%E2%80%93Kutta_methods" rel="noopener ugc nofollow" target="_blank"> <strong class="mq jd">龙格-库塔法</strong> </a>。使用基于<a class="ae lh" href="https://en.wikipedia.org/wiki/Quasi-Newton_method" rel="noopener ugc nofollow" target="_blank"><strong class="mq jd"/></a><strong class="mq jd"/>实现的<a class="ae lh" href="https://ch.mathworks.com/help/optim/ug/fminunc.html" rel="noopener ugc nofollow" target="_blank"> <em class="oa"> fminunc </em> </a>之类的解算器来最小化目标函数(类似于<a class="ae lh" href="https://en.wikipedia.org/wiki/Gradient_descent" rel="noopener ugc nofollow" target="_blank"> <strong class="mq jd">梯度下降</strong> </a>，但是梯度是围绕当前参数点近似的，并且与目标函数的二阶导数的幅度成比例缩放，这通过允许平坦区域中的更大的步长来增强性能)。<a class="ae lh" href="https://en.wikipedia.org/wiki/Convex_optimization" rel="noopener ugc nofollow" target="_blank">执行<strong class="mq jd">多起点</strong>(参数<em class="oa"> p </em>的不同起点)很重要，以便找到<strong class="mq jd">全局最优</strong>，而不是以局部最优结束。</a>(注意，最小二乘法可以作为更复杂方法的起点。)</p><h2 id="e6a0" class="ma lj it bd lk mb mc dn lo md me dp ls mf mg mh lu mi mj mk lw ml mm mn ly iz bi translated">模型验证</h2><p id="350e" class="pw-post-body-paragraph mo mp it mq b mr ms kd mt mu mv kg mw mf mx my mz mi na nb nc ml nd ne nf ng im bi translated">该模型最好使用测试集来验证，即该模型没有被训练的数据。平均相对/绝对(平方)误差可以用作度量。另外，重要的是执行一次<a class="ae lh" href="https://en.wikipedia.org/wiki/Sensitivity_analysis" rel="noopener ugc nofollow" target="_blank"> <strong class="mq jd">灵敏度分析</strong> </a>。为此，计算所有浓度(每个隔室中的每种化合物)相对于所有参数的偏导数。注意，它们是时间相关的，因为浓度是时间相关的。因此，一个参数对输出变量的影响会随时间而变化。必须进一步研究非常敏感的参数和它们所描述的过程。</p><p id="05fb" class="pw-post-body-paragraph mo mp it mq b mr nj kd mt mu nk kg mw mf nx my mz mi ny nb nc ml nz ne nf ng im bi translated">灵敏度矩阵的<a class="ae lh" href="https://en.wikipedia.org/wiki/Rank_(linear_algebra)" rel="noopener ugc nofollow" target="_blank"> <strong class="mq jd">秩</strong> </a>揭示了所有参数是否相互独立(<a class="ae lh" href="https://en.wikipedia.org/wiki/Identifiability_analysis" rel="noopener ugc nofollow" target="_blank"> <strong class="mq jd">结构可辨识性</strong></a>)；如果秩低于参数的数量，则必须通过移除或重新调整从属参数来重新定义模型。</p><pre class="ks kt ku kv gt od oe of og aw oh bi"><span id="e5a8" class="ma lj it oe b gy oi oj l ok ol">R = rank(S)</span></pre><p id="c4cd" class="pw-post-body-paragraph mo mp it mq b mr nj kd mt mu nk kg mw mf nx my mz mi ny nb nc ml nz ne nf ng im bi translated">此外，应计算参数的<a class="ae lh" href="https://de.wikipedia.org/wiki/Konfidenzintervall" rel="noopener ugc nofollow" target="_blank"><strong class="mq jd"/></a>置信区间，以检验<a class="ae lh" href="https://en.wikipedia.org/wiki/Identifiability_analysis" rel="noopener ugc nofollow" target="_blank"><strong class="mq jd"/></a>的实际可识别性。可以使用<a class="ae lh" href="https://en.wikipedia.org/wiki/Fisher_information" rel="noopener ugc nofollow" target="_blank"> <strong class="mq jd">费希尔信息</strong> </a> <strong class="mq jd"> </strong>和<a class="ae lh" href="https://en.wikipedia.org/wiki/Cram%C3%A9r%E2%80%93Rao_bound" rel="noopener ugc nofollow" target="_blank"> <strong class="mq jd">克拉美罗界限</strong> </a>来计算参数的方差。</p><pre class="ks kt ku kv gt od oe of og aw oh bi"><span id="b37a" class="ma lj it oe b gy oi oj l ok ol">E_p = inv(S'*inv(E)*S)</span></pre><p id="3265" class="pw-post-body-paragraph mo mp it mq b mr nj kd mt mu nk kg mw mf nx my mz mi ny nb nc ml nz ne nf ng im bi translated">置信区间通过单变量方法计算，仅使用参数协方差矩阵的对角元素和<a class="ae lh" href="https://en.wikipedia.org/wiki/Student%27s_t-distribution" rel="noopener ugc nofollow" target="_blank"> <strong class="mq jd">学生 t 分布</strong> </a>的分位数。</p><pre class="ks kt ku kv gt od oe of og aw oh bi"><span id="c122" class="ma lj it oe b gy oi oj l ok ol">sigma = sqrt(diag(E_p))</span><span id="0b53" class="ma lj it oe b gy om oj l ok ol">CI_lb = p_fit-sigma*tinv(0.95, number_points-number_parameters)</span><span id="2e59" class="ma lj it oe b gy om oj l ok ol">CI_ub = p_fit+sigma*tinv(0.95, number_points-number_parameters)</span></pre><p id="cc6c" class="pw-post-body-paragraph mo mp it mq b mr nj kd mt mu nk kg mw mf nx my mz mi ny nb nc ml nz ne nf ng im bi translated">如果置信区间包括零，那么参数也可以是零，即不参与方程，因此模型应该被改进。请注意，所有参数都应该是正数。</p><p id="2f62" class="pw-post-body-paragraph mo mp it mq b mr nj kd mt mu nk kg mw mf nx my mz mi ny nb nc ml nz ne nf ng im bi translated">经过几次迭代的拟合和精化，构建过程当然就完成了，得到了合理的测试集性能，模型就可以用于预测了。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi on"><img src="../Images/f30a097ddd6d6098ad3e9ee9fbd43303.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*IM7Y4iZY7llc6_Dd"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk">Photo by <a class="ae lh" href="https://unsplash.com/@marceloleal80?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Marcelo Leal</a> on <a class="ae lh" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure></div></div>    
</body>
</html>