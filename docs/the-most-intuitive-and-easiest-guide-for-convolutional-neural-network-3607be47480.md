# 卷积神经网络最直观和最简单的指南

> 原文：<https://towardsdatascience.com/the-most-intuitive-and-easiest-guide-for-convolutional-neural-network-3607be47480?source=collection_archive---------2----------------------->

揭开 CNN 的神秘面纱

![](img/3728ef0944762d6870846b629b3f77d5.png)

计算机视觉是人工智能行业最热门的话题之一。它的力量是如此具有革命性，以至于现在我们几乎每天都在见证图像和视频处理服务的技术进步。此外，卷积神经网络不仅在视觉行业，而且在包括语音识别在内的自然语言处理方面也显示出巨大的潜力。

这是神经网络“最直观和最简单的指南”的第二个系列。本帖的全套如下:

1.  [人工神经网络最简单的指南](/the-most-intuitive-and-easiest-guide-for-artificial-neural-network-6a3f2bc0eecb)
2.  卷积神经网络最简单的指南(本帖)
3.  [递归神经网络最简单的指南](/the-most-intuitive-and-easiest-guide-for-recurrent-neural-network-873c29da73c7)

这篇文章假设你有神经网络的基础知识。如果你是第一次接触 ANN，看看之前的帖子会很有帮助。今天的关键词是卷积、滤镜、填充、池化和扁平化。CNN 的核心在于理解这些步骤的功能用法，以及数据的维度是如何变化的。你准备好成为图像的一个像素，开始一次神经网络之旅了吗？让我们完成它。

# 我们如何识别图像？

在进入卷积网络之前，让我们先谈谈我们自己。关于我们如何感知图像。这将有助于更容易理解 CNN。看看这张照片。你能看到什么？

![](img/667e92dabfb3c91efb03e7b383edc0a8.png)

是右脸的男人吗？还是一个正直视你的男人？如果你的注意力在鼻子或右边的轮廓，你可能会说是前者。如果你看到耳朵或左轮廓，你会说后者。你怎么想呢?让我们用另一个再试一次。

![](img/287dbb780d44b976e8f294fe1c204b78.png)

你看到了什么？只是一位在树后行走的女士？如果是这样的话，从你的窗户往后靠一点。或者在电脑后面走一步。你能看到吗？你注意到有一个前额发亮的男人了吗？

这两张图片向我们展示了我们是如何识别图像的。图像的轮廓和边缘会影响我们的感知。你可能没有注意到，但是我们的大脑捕捉图形中的模式来对物体进行分类。而 CNN 的看点就在于此。我们的机器将被训练通过像我们一样检测一些模式来对图像进行分类。例如，在“猫和狗”问题的情况下，图案将像耳朵、眼睛、颜色和毛发等的形状。

![](img/3350c6056d26948e81230b6809680b0a.png)

# 那么什么是卷积呢？

在卷积神经网络的术语中，我们将这些模式称为'*'、 ***滤波器*** 或' ***特征检测器。***‘在我看来，最后一条是最直观的。因此，CNN 所做的就是使用相应的过滤器从图像数据中检测出想要的特征，并提取出重要的特征进行预测。*

*让我们先用一个简单的一维例子来理解卷积的概念。假设我们的火车图像是一个 1D 数组，数字如下。我们想要检测值从 0 变到 1 的点。可能有其他可能的过滤器，但我将使用一个简单的 **[-1，1]** 。*

*![](img/0a91fc810f6cca9ac07691200379915f.png)*

*从左到右通过检测器，我们得到每次的卷积值。如你所见，我们可以用结果来捕捉想要的模式。那我们来试试二维的情况。*

*![](img/7bf90411a7bcf739e67391f0648ee7a9.png)*

*我想你现在知道卷积是什么了。根据定义，[卷积](https://en.wikipedia.org/wiki/Convolution)是对两个对象进行的数学运算，产生的结果表示一个对象的形状如何被另一个对象修改。通过这种计算，我们可以从输入图像中检测出特定的特征，并得到包含该特征信息的结果。这叫做' ***特征图*** . '如果我们用真实图像例子来看，结果如下所示。*

*![](img/a03e6df2363731628ada6bef67e30b91.png)*

*现在我们可以考虑三维情况下的相同过程。但这很简单，因为你可以把它看成是二维数据的叠加。*

*![](img/fda6d88bcf4793acbd69fc198d996363.png)*

*你知道我们的图像数据由三种基本颜色组成:红色、绿色和蓝色。假设我们的图像有 7×7 像素的 RGB 数据。这意味着数据有 7x7x3 的容量。如果我们要用 4 个滤波器检测某些特征，则卷积计算针对每个滤波器进行。请注意结果的音量。高度、宽度和深度是如何变化的。如果我们使用更大尺寸的过滤器，高度和宽度会更大。过滤器的数量将决定结果的深度。*

# *带填充和步幅的卷积*

*我们还可以对卷积应用其他技巧，其中之一就是填充。你可能已经注意到图像的像素不是用相同的数字处理的。角落的像素比中间的像素少。这意味着像素不会获得相同的权重。此外，如果我们只是继续应用卷积，我们可能会很快丢失数据。 ***填充*** 是我们可以用来解决这个问题的窍门。顾名思义，填充意味着在数据的边界给出额外的像素。*

*![](img/0827ca811549bab7dc2dde35ae93be64.png)*

*上图中的第一个例子展示了我们在上一节中所做的事情。输入图像具有 4x4 像素，过滤器具有 3x3 像素。没有填充，称为' ***有效。*** '结果变成 2x2 像素数据(**4–3+1 = 2**)。我们可以看到输出数据缩小了。*

*这次来看第三个例子。有一层空白像素填充。输入图像有 5x5 像素，滤镜有 3x3 像素。所以结果得到 5x5 像素(**5+1 * 2–3+1 = 5**)，与输入图像大小相同。我们称之为' ***同*** . '我们甚至可以使结果大于输入数据，但这两种情况用得最多。*

*顺便问一下，滤镜是不是每次都要移动一个像素？当然不是。我们还可以让它在水平和垂直方向上一次移动两步或三步。这叫做' ***大步*** . '*

*那么我们可以在这里问一个问题。假设有一个 **N** x **N** 输入图像和 **Nc`** 数量的 **f** x **f** 滤镜。我们将使 **p** 的填充层数和移动的步幅值 **S** 的过滤器。请花点时间思考一下，总结一下我们到目前为止讨论的所有内容。结果的大小会是多少？*

*![](img/714dfbbbd5ee31a06b5fc0bc9f9eeb7d.png)*

# *合并和扁平化*

*我们一直在走的是卷积层。而且实际上还有不同于卷积层的附加层: ***汇集层*** 和 ***展平层*** 。先说第一个。[合并](https://www.quora.com/What-is-max-pooling-in-convolutional-neural-networks)就是合并的过程。所以基本上是为了减少数据量。*

*![](img/360164fc461399f87b216a3066fa70ef.png)*

*滑动一个窗口，我们只取左边盒子里的最大值。这是' ***最大汇集*** . '我们也可以像右图一样取平均值。这是' ***平均池*** . '我们还可以像在卷积层那样调整步幅。*

*但这不是在丢失有价值的数据吗？为什么我们要缩小尺寸？这可能会被视为在第一眼就丢失信息，但这比丢失更“有意义”的数据。通过去除数据中的一些噪声并仅提取重要的噪声，我们可以减少过拟合并加速计算。*

*扁平化和完全连接的层是我们在 CNN 的最后阶段所拥有的，这意味着你就快到了！太好了。对了，你没忘记我们为什么要做这些吧？我们在做什么？图像处理。为了什么？🙄🙄对“猫和狗”进行分类我们正在制作一个分类模型，这意味着这些经过处理的数据应该是模型的良好输入。它必须是一维线性向量的形式。矩形或立方体形状不能直接输入。这就是为什么我们需要[扁平化和全连接层](https://www.quora.com/What-is-the-meaning-of-flattening-step-in-a-convolutional-neural-network)。*

*![](img/43e1f30883881fffc292c717d937a3dd.png)*

****展平*** 是将数据转换成一维数组，输入到下一层。我们展平卷积层的输出，以创建单个长特征向量。并且它连接到最终的分类模型，该分类模型被称为 ***全连接*** 层。换句话说，我们将所有像素数据放在一行中，并与最后一层建立连接。再一次。最后一层是做什么用的？《猫和狗》的分类*

# *一次*

*现在让我们看看我们在一个镜头中走过了什么。*

*![](img/a0e86c1ca4ae652ae0546f0caf1315fb.png)*

*添加多个卷积层和池层，将对图像进行特征提取处理。并且对于 softmax(对于多类情况)或 sigmoid(对于二进制情况)函数，将有完全连接的层指向该层。我没有提到 ReLu 激活步骤，但它与 ANN 中的激活步骤没有区别。*

*随着层次越来越深，模型处理的功能也变得越来越复杂。例如，在 ConvNet 的早期阶段，它查找定向线条模式，然后找到一些简单的图形。在深层阶段，它可以捕捉对象的特定形式，并最终能够检测输入图像的对象。*

*理解 CNN 就是理解图像数据是如何处理的。如何将图像转换成数据并提取特征进行预测。从这个基本结构出发，还有很多修改和融合的版本。ResNet、AlexNet、VGG-16 或 Inception Networks 就是其中的一些。想了解这些车型的更多信息？查看下面的附加资源！*

*   *[**从零开始学习卷积神经网络的综合教程**](https://www.analyticsvidhya.com/blog/2018/12/guide-convolutional-neural-network-cnn/) 作者[普尔基特·夏尔马](https://medium.com/u/50dc5f8ee633?source=post_page-----3607be47480--------------------------------):本帖为 Coursera 上深度学习专业化第 4 期课程的总结版。它不仅包括 CNN 的概念，还包括我提到的其他类型的基本 CNN。*
*   *[图像分类器——猫🐱vs 狗🐶格雷格·苏尔马](/image-classifier-cats-vs-dogs-with-convolutional-neural-networks-cnns-and-google-colabs-4e9af21ae7a8):关于卷积的精彩解释和使用 Colab 构建第一个 CNN 的温和指南。*
*   *[**用于图像处理的卷积神经网络**](https://www.datacamp.com/courses/convolutional-neural-networks-for-image-processing) 上 data camp:CNN 的精品课程。本课程涵盖了从卷积的概念到以非常直观的方式在 Keras 中构建模型。*

*你可能也会觉得这些系列很有趣！😍👍*

*   *OpenCV 图像处理教程*

*[](/computer-vision-for-beginners-part-1-7cca775f58ef) [## 初学者的计算机视觉:第 1 部分

### OpenCV 和 Python 中的图像处理简介

towardsdatascience.com](/computer-vision-for-beginners-part-1-7cca775f58ef) 

*   卷积神经网络的高级网络

[](/deep-dive-into-the-computer-vision-world-f35cd7349e16) [## 深入了解计算机视觉世界:第 1 部分

### 从 VGG 开始，ResNet 和盗梦空间网络

towardsdatascience.com](/deep-dive-into-the-computer-vision-world-f35cd7349e16) 

感谢您的阅读，希望您对这篇文章感兴趣。我总是乐于交谈，所以请在下面留下评论，分享你的想法。我还每周在 [LinkedIn](https://www.linkedin.com/in/jiwon-jeong36/) 上发布其他有价值的 DS 资源，请关注并联系我。我会回来讲另一个激动人心的故事。直到那时，快乐的深度学习！*