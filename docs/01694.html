<html>
<head>
<title>Can Artificial Intelligence Help Medical Decision Making?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">人工智能能帮助医疗决策吗？</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/can-artificial-intelligence-help-medical-decision-making-77b63f5b981c?source=collection_archive---------13-----------------------#2019-03-19">https://towardsdatascience.com/can-artificial-intelligence-help-medical-decision-making-77b63f5b981c?source=collection_archive---------13-----------------------#2019-03-19</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="e1c3" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">基于强化学习的化疗智能医生</h2></div><p id="4afe" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">将机器学习应用于医学领域的研究越来越受到关注。例如，计算机视觉已经被证明是为医生和医学研究人员提供分析信息的有价值的工具。</p><p id="3345" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我想探索智能机器是否可以直接扮演医生的角色——自主做出医疗决策。在这个项目中，我创造了一个基于强化学习的智能医生，它可以根据患者的癌症进展情况制定最佳的化疗方案。</p><blockquote class="lb lc ld"><p id="01b5" class="kf kg le kh b ki kj jr kk kl km ju kn lf kp kq kr lg kt ku kv lh kx ky kz la ij bi translated">注:这是我提交给 2019 年纽约市科学与工程博览会的科学博览会项目。</p></blockquote><h1 id="ab50" class="li lj iq bd lk ll lm ln lo lp lq lr ls jw lt jx lu jz lv ka lw kc lx kd ly lz bi translated">什么是强化学习？</h1><p id="41b3" class="pw-post-body-paragraph kf kg iq kh b ki ma jr kk kl mb ju kn ko mc kq kr ks md ku kv kw me ky kz la ij bi translated">听说过<em class="le"> AlphaGo 吗？</em> <em class="le">阿尔法星？</em></p><div class="mf mg mh mi gt ab cb"><figure class="mj mk ml mm mn mo mp paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><img src="../Images/2f05416755758e965433130f1363c453.png" data-original-src="https://miro.medium.com/v2/resize:fit:1118/0*Y1ljMxK1B0YgrMId"/></div></figure><figure class="mj mk mw mm mn mo mp paragraph-image"><img src="../Images/92957a47574282b167246e17ac8894fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:884/0*6C6LEJ8hLMAAwr01"/><figcaption class="mx my gj gh gi mz na bd b be z dk nb di nc nd">Left: Taken From <a class="ae ne" href="https://www.theguardian.com/technology/2017/may/23/alphago-google-ai-beats-ke-jie-china-go" rel="noopener ugc nofollow" target="_blank">The Guardian’s article: “World’s best Go player flummoxed by Google’s ‘godlike’ AlphaGo”</a>, Right: Taken from The Register’s article:<a class="ae ne" href="https://www.theregister.co.uk/2019/01/25/ai_in_starcraft/" rel="noopener ugc nofollow" target="_blank"> “Human StarCraft II e-athletes crushed by neural net ace — DeepMind’s AlphaStar”</a></figcaption></figure></div><p id="a803" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在媒体上，强化学习通常出现在游戏环境中；AI 机器人在<em class="le">围棋</em> (Deepmind 的 alpha Go)<em class="le">星际争霸</em> (Deepmind 的 alpha star)<em class="le">Dota</em>(open AI 的 OpenAI Five)等游戏中击败人类职业选手。</p><p id="24df" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">本质上，强化学习是一个与最佳决策相关的机器学习领域:训练一个“代理”根据当前状态的观察做出最佳动作，以达到定义的理想状态。</p><p id="d58e" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在强化学习中，最优策略(将状态映射到最优动作的函数)是通过“试错”错误方法来学习的。代理基于对当前状态的观察来概率性地选择动作，观察结果状态，并根据定义的性能度量来接收“奖励”。也就是说，用于训练强化学习模型的数据是{ <em class="le">状态、动作、奖励、下一状态}的元组。</em>利用这些数据，代理评估所选动作的值，并更新其参数，以便具有更好值的动作——“最优动作”——将具有更高的被选择概率。</p><blockquote class="lb lc ld"><p id="9b2e" class="kf kg le kh b ki kj jr kk kl km ju kn lf kp kq kr lg kt ku kv lh kx ky kz la ij bi translated">这是对强化学习的一个非常肤浅的解释——看看我的其他博文<a class="ae ne" href="http://medium.com/@thechrisyoon" rel="noopener">和</a>,我在那里详细解释了核心概念和算法！</p></blockquote></div><div class="ab cl nf ng hu nh" role="separator"><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk"/></div><div class="ij ik il im in"><h1 id="9ded" class="li lj iq bd lk ll nm ln lo lp nn lr ls jw no jx lu jz np ka lw kc nq kd ly lz bi translated">数据收集</h1><p id="945a" class="pw-post-body-paragraph kf kg iq kh b ki ma jr kk kl mb ju kn ko mc kq kr ks md ku kv kw me ky kz la ij bi translated">作为一名独立的高中研究者，我不具备获取真实医学数据的法律和专业资格。为了克服这一点，我基于一个数学模型创建了一个化疗治疗模拟，该模型表示给定当前生理状态和应用的化疗剂量时患者癌症进展的变化。</p><p id="860e" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">该模型由(赵，2009)中构建的常微分方程组表示:</p><figure class="mf mg mh mi gt mk gh gi paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="gh gi nr"><img src="../Images/07d5ea9e143d423660f006d0cd341830.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DqmIxSA0EL_IMtYJ08lKIw.png"/></div></div></figure><p id="2ddd" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">其中<em class="le"> W </em>、<em class="le"> M </em>、<em class="le"> D </em>分别代表毒性指数、肿瘤大小指数和归一化剂量，<em class="le"> a、b、d </em>为(赵，2009)中确定的模型常数。{ <em class="le"> M &gt; 0 </em> }术语表示一个至关重要的假设，即一旦肿瘤大小指数减少到 0，患者就被认为是永远治愈了，并且不会有癌症复发。<em class="le"> N </em>项表示高斯噪声，该噪声用于扰乱动态，试图模拟患者间的变异性和随机生理事件。</p><p id="188a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">利用这个模型，我创建了一个化疗模拟环境，灵感来自于<em class="le"> OpenAI Gym。</em>也就是说，环境包含成员函数:</p><ol class=""><li id="8f81" class="ns nt iq kh b ki kj kl km ko nu ks nv kw nw la nx ny nz oa bi translated"><code class="fe ob oc od oe b">reset()</code>:创建一个随机的初始患者实例。</li><li id="0e94" class="ns nt iq kh b ki of kl og ko oh ks oi kw oj la nx ny nz oa bi translated"><code class="fe ob oc od oe b">reward(state, action)</code>:根据当前和最终的患者生理状态评估应用剂量。返回一个数字“奖励”</li><li id="6837" class="ns nt iq kh b ki of kl og ko oh ks oi kw oj la nx ny nz oa bi translated"><code class="fe ob oc od oe b">step(state, action)</code>:返回后续病人状态，并奖励给定当前状态的一个当前动作。</li></ol><p id="bcf6" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">使用这种模拟，我们可以创建<strong class="kh ir">合成但似是而非的治疗数据</strong>及其相应的化疗治疗方案。然后我们用它来训练我们聪明的医生。</p></div><div class="ab cl nf ng hu nh" role="separator"><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk"/></div><div class="ij ik il im in"><h1 id="a84d" class="li lj iq bd lk ll nm ln lo lp nn lr ls jw no jx lu jz np ka lw kc nq kd ly lz bi translated">奖励函数</h1><p id="592f" class="pw-post-body-paragraph kf kg iq kh b ki ma jr kk kl mb ju kn ko mc kq kr ks md ku kv kw me ky kz la ij bi translated">奖励函数非常重要，因为它塑造了代理人试图实现的最优行为。如果你看看强化学习的一般目标函数:</p><figure class="mf mg mh mi gt mk gh gi paragraph-image"><div class="gh gi ok"><img src="../Images/25e2209f489e9cc6f6434179b6442669.png" data-original-src="https://miro.medium.com/v2/resize:fit:1216/format:webp/1*yDYkER2G3MyAHQmtgo1H4w.png"/></div></figure><p id="22f4" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">即最大化预期的情景累积回报，代理人行为的优化在很大程度上取决于回报函数(在各种强化学习算法中——如在培训我的医生时所使用的——目标函数中可以添加其他项)。</p><h2 id="3661" class="ol lj iq bd lk om on dn lo oo op dp ls ko oq or lu ks os ot lw kw ou ov ly ow bi translated">我们如何评价智能医师的治疗方案？</h2><p id="254a" class="pw-post-body-paragraph kf kg iq kh b ki ma jr kk kl mb ju kn ko mc kq kr ks md ku kv kw me ky kz la ij bi translated">那么，我们如何<strong class="kh ir">构建一个奖励函数</strong>来恰当地解决医生的目标<strong class="kh ir">减少肿瘤大小，同时控制累积毒性？</strong></p><p id="f6ff" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">以下是我们如何评估聪明的医生的决定的分析:</p><ul class=""><li id="53ac" class="ns nt iq kh b ki kj kl km ko nu ks nv kw nw la ox ny nz oa bi translated">如果治疗导致肿瘤尺寸减小，则奖励为正；如果治疗导致肿瘤尺寸增大，则奖励为负。</li><li id="14f2" class="ns nt iq kh b ki of kl og ko oh ks oi kw oj la ox ny nz oa bi translated">如果治疗导致毒性降低，则奖励为正；如果治疗导致毒性增加，则奖励为负。</li><li id="4a79" class="ns nt iq kh b ki of kl og ko oh ks oi kw oj la ox ny nz oa bi translated">如果患者“治愈”(即肿瘤大小缩小至 0)，则为高阳性奖励。</li><li id="0145" class="ns nt iq kh b ki of kl og ko oh ks oi kw oj la ox ny nz oa bi translated">如果患者“死亡”(即肿瘤大小和毒性指数的加权和超过规定的阈值)，则为高负回报。</li></ul><p id="b6ae" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">及其奖励函数公式:</p><figure class="mf mg mh mi gt mk gh gi paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="gh gi oy"><img src="../Images/2ecfd037f2572b92b9060655e4507e37.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vRhKwlbyTu_Vq-x54eSAMw.png"/></div></div></figure></div><div class="ab cl nf ng hu nh" role="separator"><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk"/></div><div class="ij ik il im in"><h1 id="9e2c" class="li lj iq bd lk ll nm ln lo lp nn lr ls jw no jx lu jz np ka lw kc nq kd ly lz bi translated">培养聪明的医生</h1><p id="6f4a" class="pw-post-body-paragraph kf kg iq kh b ki ma jr kk kl mb ju kn ko mc kq kr ks md ku kv kw me ky kz la ij bi translated">智能医师基于软演员评论家算法(Haarnoja，2018)。<em class="le">我打算跳过关于算法的细节(因为帖子会太长)，但如果有兴趣，你可以看看</em> <a class="ae ne" href="https://arxiv.org/abs/1801.01290" rel="noopener ugc nofollow" target="_blank"> <em class="le">图马斯·哈尔诺贾的论文</em> </a> <em class="le">，或者</em> <a class="ae ne" rel="noopener" target="_blank" href="/soft-actor-critic-demystified-b8427df61665"> <em class="le">瓦伊沙克诉库马尔的博文</em> </a>。</p><p id="3422" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">本质上，软演员评论家可以:</p><ol class=""><li id="ad5d" class="ns nt iq kh b ki kj kl km ko nu ks nv kw nw la nx ny nz oa bi translated">学习连续行动空间中的最优策略。这适合于化疗任务，因为我们想要产生我们想要应用于患者的精确的最佳剂量。相反，在离散行动空间中学习，在这种情况下，意味着从有限的、少量的预定义剂量中进行选择，永远不会是真正的最优决策(只是给定选择中的最优选择)。</li><li id="2376" class="ns nt iq kh b ki of kl og ko oh ks oi kw oj la nx ny nz oa bi translated">通过最大化状态空间探索非常高效和有效地学习最优策略。软行动者批评家通过将熵项结合到其目标函数中，抑制贪婪的行动选择，并鼓励代理在学习时尽可能随机地行动。</li></ol><p id="f016" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">所以，这里有一个培训聪明医生的概述:</p><figure class="mf mg mh mi gt mk gh gi paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="gh gi oz"><img src="../Images/969b5b594ae797f38fff5723c276f4a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*erYNztvIYnLAmSqtpBzMqQ.png"/></div></div></figure><p id="e1c4" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">那就是:</p><ol class=""><li id="faab" class="ns nt iq kh b ki kj kl km ko nu ks nv kw nw la nx ny nz oa bi translated">我们生成一个随机的病人实例</li><li id="04bb" class="ns nt iq kh b ki of kl og ko oh ks oi kw oj la nx ny nz oa bi translated">我们用现有的模型进行化疗</li><li id="71de" class="ns nt iq kh b ki of kl og ko oh ks oi kw oj la nx ny nz oa bi translated">将癌症进展和治疗方案存储在智能医生的存储器中</li><li id="ec28" class="ns nt iq kh b ki of kl og ko oh ks oi kw oj la nx ny nz oa bi translated">用智能医生记忆中随机批次的癌症进展和治疗方案更新神经网络参数</li><li id="0a58" class="ns nt iq kh b ki of kl og ko oh ks oi kw oj la nx ny nz oa bi translated">对 1000 个生成的患者重复步骤 1~4。</li></ol></div><div class="ab cl nf ng hu nh" role="separator"><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk"/></div><div class="ij ik il im in"><h1 id="4aec" class="li lj iq bd lk ll nm ln lo lp nn lr ls jw no jx lu jz np ka lw kc nq kd ly lz bi translated">测试训练有素的医生</h1><p id="cfca" class="pw-post-body-paragraph kf kg iq kh b ki ma jr kk kl mb ju kn ko mc kq kr ks md ku kv kw me ky kz la ij bi translated">在智能医生对 1000 名患者进行训练后，它在另一组 1000 名假设的患者身上进行了测试。</p><p id="f320" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">对于这 1000 名患者，医生展示了以下统计数据:</p><figure class="mf mg mh mi gt mk gh gi paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="gh gi pa"><img src="../Images/7623542455123b0c3f808ad9e31e4aa8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pv53caQ0B2rEVpHh6k_5gA.png"/></div></div></figure><p id="f075" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">一般来说，在治疗结束时，医生能够完全减少患者的肿瘤块，而毒性仍然存在，但没有达到致命水平。当“治愈”被定义为最终肿瘤块时&lt; 0.01 and final toxicity index &lt; 0.8, <strong class="kh ir">，医生治愈了 1000 名模拟患者中的 947 名。</strong></p><p id="3e2a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">下面是从医生那里摘录的一个成功治疗进展的例子:</p><div class="mf mg mh mi gt ab cb"><figure class="mj mk pb mm mn mo mp paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><img src="../Images/3008fd11d14971ef675d2d4e7f37bf75.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*NS4EST1CwOeqxqeojI5TFg.png"/></div></figure><figure class="mj mk pb mm mn mo mp paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><img src="../Images/7842acee3b0a3534b0c94061995322ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*ZNMzVnTdbIR0wEVaan81LQ.png"/></div><figcaption class="mx my gj gh gi mz na bd b be z dk pc di pd nd">Left: Cancer Progression (Blue: Tumor Mass, Orange: Toxicity), Right: optimal dosage regimen produced by intelligent physician</figcaption></figure></div><p id="c397" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在这种情况下，医生似乎在初始阶段使用了大剂量治疗来快速缩小肿瘤大小，然后使用小剂量至零剂量来逐渐减少累积的毒性。</p></div><div class="ab cl nf ng hu nh" role="separator"><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk"/></div><div class="ij ik il im in"><h1 id="1147" class="li lj iq bd lk ll nm ln lo lp nn lr ls jw no jx lu jz np ka lw kc nq kd ly lz bi translated">讨论</h1><p id="267b" class="pw-post-body-paragraph kf kg iq kh b ki ma jr kk kl mb ju kn ko mc kq kr ks md ku kv kw me ky kz la ij bi translated">在训练聪明的医生制定最佳化疗方案方面取得了成功。医生可以有效地减小肿瘤大小，同时将毒性保持在非致命水平，并最终达到完全安全的水平。</p><p id="ff26" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然而，更重要的问题在于人工智能的伦理。</p><p id="23e3" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">医疗领域的决策具有极高的风险。在癌症治疗的背景下，患者没有机会尝试多种治疗方案。因此，我必须承认我所采用的方法中的问题，以及机器学习方法的固有弱点:</p><ol class=""><li id="e3d0" class="ns nt iq kh b ki kj kl km ko nu ks nv kw nw la nx ny nz oa bi translated">这个模型只能和它得到的数据一样好。数学模型很难复制病人之间的变异性和决定真实世界动态的随机事件。因此，我的方法对于现实世界的应用来说永远不够健壮。</li><li id="0d9b" class="ns nt iq kh b ki of kl og ko oh ks oi kw oj la nx ny nz oa bi translated">强化学习在现实世界的应用中变得很成问题，因为我们无法在元层面上预测或解释它的行为。我们所知道的是，行为是由定义的奖励函数塑造的，是通过数百万个数据点的训练获得的。</li><li id="aca1" class="ns nt iq kh b ki of kl og ko oh ks oi kw oj la nx ny nz oa bi translated">尤其是在复杂、高维的状态和动作空间中，强化学习在面对未知条件时往往泛化能力很差。因此，我们永远无法保证在现实生活中部署时不会发生灾难性的行为。</li></ol><p id="0254" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然而，现代强化学习是一个相对年轻的领域，并且正在以非常快的速度增长——我们永远无法衡量它在几十年后会有什么能力。无论如何，人工智能在现实世界中的应用应该以极大的责任感和谨慎来对待。</p></div><div class="ab cl nf ng hu nh" role="separator"><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk"/></div><div class="ij ik il im in"><h1 id="d6ed" class="li lj iq bd lk ll nm ln lo lp nn lr ls jw no jx lu jz np ka lw kc nq kd ly lz bi translated">参考文献(在这篇博文中)</h1><ul class=""><li id="02f7" class="ns nt iq kh b ki ma kl mb ko pe ks pf kw pg la ox ny nz oa bi translated">赵，，<em class="le">癌症临床试验的强化学习设计，</em>北卡罗来纳大学教堂山分校，2009。</li><li id="2ed8" class="ns nt iq kh b ki of kl og ko oh ks oi kw oj la ox ny nz oa bi translated">Tuomas Haarnoja，Aurick Zhou，Pieter Abbeel，和 Sergey Levine，<em class="le">软行动者-批评家:具有随机行动者的非策略最大熵深度强化学习</em>，第 35 届机器学习国际会议论文集，2018 年，ICML，瑞典斯德哥尔摩，stockholmsssan，2018 年 7 月 10 日至 15 日，2018 年，第 1856-1865 页。</li></ul></div></div>    
</body>
</html>