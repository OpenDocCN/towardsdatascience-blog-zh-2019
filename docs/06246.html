<html>
<head>
<title>Analyzing Video Games Data in R</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">分析 R 中的视频游戏数据</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/analyzing-video-games-data-in-r-1afad7122aab?source=collection_archive---------13-----------------------#2019-09-09">https://towardsdatascience.com/analyzing-video-games-data-in-r-1afad7122aab?source=collection_archive---------13-----------------------#2019-09-09</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="a9ea" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">作为一名游戏玩家，我从分析这个数据集中获得了很多乐趣。实际上，这个数据集是由两个不同的数据集合并而成的:<a class="ae kl" href="https://github.com/rfordatascience/tidytuesday/blob/master/data/2019/2019-07-30/video_games.csv" rel="noopener ugc nofollow" target="_blank"> Tidytuesday </a>和<a class="ae kl" href="https://www.kaggle.com/destring/metacritic-reviewed-games-since-2000" rel="noopener ugc nofollow" target="_blank"> Kaggle </a>。使用两个数据集的原因是因为 Tidytuesday 数据集没有足够的信息来进行有趣的分析。这就是为什么我合并了这两者，以便从中获得更多有趣的数据和见解。这也是我第一篇使用 Tidymodels 元包应用一些机器学习的文章。</p><pre class="km kn ko kp gt kq kr ks kt aw ku bi"><span id="e5f3" class="kv kw iq kr b gy kx ky l kz la"><strong class="kr ir"><em class="lb">Loading Libraries</em></strong></span><span id="2b1d" class="kv kw iq kr b gy lc ky l kz la">library(tidyverse) ## For data wrangling and visualization<br/>library(lubridate) ## To work with dates<br/>library(ggpubr)    ## Extra visualizations and themes<br/>library(patchwork) ## Patch visualizations together<br/>library(hrbrthemes)## Extra themes and formatting<br/>library(ggalt)     ## Extra visualizations<br/>library(vapoRwave) ## Retro themes<br/>library(extrafont) ## Exta fonts</span><span id="16c6" class="kv kw iq kr b gy lc ky l kz la"><strong class="kr ir"><em class="lb">Loading Data</em></strong></span><span id="96ba" class="kv kw iq kr b gy lc ky l kz la"><strong class="kr ir">video_games</strong> &lt;- read_csv("<a class="ae kl" href="https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2019/2019-07-30/video_games.csv" rel="noopener ugc nofollow" target="_blank">https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2019/2019-07-30/video_games.csv</a>") %&gt;%<br/>  mutate(release_date = as.Date(release_date, "%b %d, %Y")) %&gt;%<br/>  distinct(game, developer, publisher, .keep_all = TRUE)</span><span id="067f" class="kv kw iq kr b gy lc ky l kz la"><strong class="kr ir">metacritic_games</strong> &lt;- read_csv("C:\\Users\\ACER\\Downloads\\metacritic-games-stats-20112019\\metacritic_games.csv",trim_ws = TRUE)</span><span id="467b" class="kv kw iq kr b gy lc ky l kz la"><br/><strong class="kr ir">Cleaning and mergin the datasets together</strong></span><span id="34e9" class="kv kw iq kr b gy lc ky l kz la">games_final &lt;- metacritic_games %&gt;%<br/>  filter(platform=="PS4") %&gt;% <br/>  inner_join(video_games,by = "game") %&gt;%<br/>  mutate(owners=parse_number(owners,trim_ws = TRUE)) %&gt;%<br/>  mutate(publisher = case_when(str_detect(publisher,pattern = "Warner Bros|WB")~"Warner Brothers",TRUE~publisher)) %&gt;% <br/>  select(-c(release_date.x,developer.y,number_players,number,metascore.y))</span></pre><ul class=""><li id="209e" class="ld le iq jp b jq jr ju jv jy lf kc lg kg lh kk li lj lk ll bi translated">在读入<strong class="jp ir"> video_games </strong>数据后，我使用<strong class="jp ir"> mutate </strong>函数将<strong class="jp ir"> release_date </strong>列转换为日期类型</li><li id="c935" class="ld le iq jp b jq lm ju ln jy lo kc lp kg lq kk li lj lk ll bi translated">由于一些游戏有多个开发者和流派，我使用了<strong class="jp ir"> distinct </strong>函数来获得每行的唯一游戏</li><li id="3fd5" class="ld le iq jp b jq lm ju ln jy lo kc lp kg lq kk li lj lk ll bi translated">对于这个分析，我只对 PS4 游戏感兴趣。这就是为什么我在对<strong class="jp ir"> video_games </strong>数据集进行<strong class="jp ir"> inner_join </strong>之前，将<strong class="jp ir"> metacritic_games </strong>数据集过滤为仅 PS4 游戏</li><li id="5388" class="ld le iq jp b jq lm ju ln jy lo kc lp kg lq kk li lj lk ll bi translated">使用<strong class="jp ir"> parse </strong>函数从<strong class="jp ir"> owners </strong>列中获取每个游戏的数值上限</li><li id="7c48" class="ld le iq jp b jq lm ju ln jy lo kc lp kg lq kk li lj lk ll bi translated">由于有多家华纳兄弟出版社，我使用了<strong class="jp ir"> case_when </strong>函数将它们合二为一</li><li id="7f1b" class="ld le iq jp b jq lm ju ln jy lo kc lp kg lq kk li lj lk ll bi translated">最后，我取消选择了重复的列</li></ul><h2 id="7fb3" class="kv kw iq bd lr ls lt dn lu lv lw dp lx jy ly lz ma kc mb mc md kg me mf mg mh bi translated">进一步修整</h2><p id="5129" class="pw-post-body-paragraph jn jo iq jp b jq mi js jt ju mj jw jx jy mk ka kb kc ml ke kf kg mm ki kj kk ij bi translated">经过一些调查，我意识到数据中有太多的垃圾，为了在游戏层面上做一个有见地的分析，我决定只根据拥有他们游戏的总人数来看前 50 名发行商</p><pre class="km kn ko kp gt kq kr ks kt aw ku bi"><span id="3f45" class="kv kw iq kr b gy kx ky l kz la"><strong class="kr ir">Calculating top 50 publishers</strong></span><span id="55ae" class="kv kw iq kr b gy lc ky l kz la">top_50_publishers &lt;- games_final %&gt;% <br/>  group_by(publisher) %&gt;% <br/>  summarise(Owners=sum(owners)) %&gt;% <br/>  top_n(50)</span><span id="9d7d" class="kv kw iq kr b gy lc ky l kz la">Filtering <strong class="kr ir">games_final </strong>based on top 50 publishers</span><span id="a77a" class="kv kw iq kr b gy lc ky l kz la">top_50_filtered &lt;- games_final %&gt;% <br/>  semi_join(top_50_publishers)</span></pre><ul class=""><li id="12a2" class="ld le iq jp b jq jr ju jv jy lf kc lg kg lh kk li lj lk ll bi translated">首先，我在<strong class="jp ir"> games_final </strong>数据集中按发行商分组，以获得每个发行商的所有者总数，然后使用<strong class="jp ir"> top_n </strong>函数获得基于所有者的前 50 名发行商</li><li id="7268" class="ld le iq jp b jq lm ju ln jy lo kc lp kg lq kk li lj lk ll bi translated">然后我在<strong class="jp ir"> games_final </strong>和<strong class="jp ir"> top_50_publishers </strong>数据集之间使用<strong class="jp ir"> semi_join </strong>函数<strong class="jp ir"> </strong>。它的作用是根据<strong class="jp ir">前 50 名发行商</strong>中的前 50 名发行商过滤出<strong class="jp ir">游戏 _ 决赛</strong>数据</li><li id="4722" class="ld le iq jp b jq lm ju ln jy lo kc lp kg lq kk li lj lk ll bi translated">这个数据集比原来的小很多，但它允许我只看主流游戏</li><li id="63ba" class="ld le iq jp b jq lm ju ln jy lo kc lp kg lq kk li lj lk ll bi translated">请注意，这个过滤后的数据只到 2018 年，以防你想知道为什么你最喜欢的游戏没有在 2019 年上市，如<strong class="jp ir">战神</strong>、<strong class="jp ir">蜘蛛侠</strong>或<strong class="jp ir">红色死亡救赎 2 </strong></li></ul><figure class="km kn ko kp gt mo gh gi paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="gh gi mn"><img src="../Images/4b4c4326656d7c478020b0aaea25a307.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SwpS5XijvKdETlGmOCyYhg.png"/></div></div><figcaption class="mv mw gj gh gi mx my bd b be z dk">This is what the final dataset looks like</figcaption></figure><h2 id="2c2a" class="kv kw iq bd lr ls lt dn lu lv lw dp lx jy ly lz ma kc mb mc md kg me mf mg mh bi translated">前 50 名出版商是谁？</h2><pre class="km kn ko kp gt kq kr ks kt aw ku bi"><span id="254f" class="kv kw iq kr b gy kx ky l kz la">top_50_filtered %&gt;%<br/>  filter(!is.na(publisher)) %&gt;% <br/>  group_by(publisher) %&gt;% <br/>  summarise(owners=sum(owners)) %&gt;% <br/>  ggplot(aes(reorder(publisher,owners),owners))+<br/>  geom_bar(fill="#8B2E8B",stat = "identity",color="black")+<br/>  coord_flip()+<br/>  geom_text(aes(label=paste0(round(owners/1000000,digits = 1)," ","M")),color="white",fontface="bold",hjust=1)+<br/>  new_retro()+<br/>  scale_color_hotlineBling()+<br/>  labs(x=" ")+<br/>  scale_y_comma()+<br/>  theme(legend.position = "none",axis.text.y = element_text(colour = "white",family = "SF Alien Encounters"))<br/></span></pre><ul class=""><li id="fde9" class="ld le iq jp b jq jr ju jv jy lf kc lg kg lh kk li lj lk ll bi translated">从删除 NA 发布者开始</li><li id="9bc3" class="ld le iq jp b jq lm ju ln jy lo kc lp kg lq kk li lj lk ll bi translated">执行相同的 group by 函数来获得每个发布者的所有者总数</li><li id="9aa8" class="ld le iq jp b jq lm ju ln jy lo kc lp kg lq kk li lj lk ll bi translated">使用<strong class="jp ir"> ggplot </strong>和<strong class="jp ir"> geom_bar </strong>制作标准条形图，并使用<strong class="jp ir"> coord_flip </strong>功能翻转轴。注意:ggplot 中的<strong class="jp ir">重新排序</strong>功能允许绘制从最大值到最小值的排序柱状图</li><li id="7a5d" class="ld le iq jp b jq lm ju ln jy lo kc lp kg lq kk li lj lk ll bi translated">由于<strong class="jp ir"> owners </strong>变量是以百万为单位的，所以我将它除以一百万，并在末尾连接一个“M ”,使用<strong class="jp ir"> paste0 </strong>来标记每个发布者的所有者总数，而不会影响美观</li></ul><figure class="km kn ko kp gt mo gh gi paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="gh gi mz"><img src="../Images/22bfef4590089cc5c210de2a459e48d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3wz8kvkKiiDgDkkUDntPKw.png"/></div></div></figure><ul class=""><li id="2bda" class="ld le iq jp b jq jr ju jv jy lf kc lg kg lh kk li lj lk ll bi translated">那里有很多熟悉的面孔，比如育碧、摇滚明星游戏等等，但是老实说，我不知道数字极端公司 T21——坐在最上面</li><li id="578b" class="ld le iq jp b jq lm ju ln jy lo kc lp kg lq kk li lj lk ll bi translated">他们实际上是一款非常受欢迎的在线免费角色扮演射击游戏的负责人，这款游戏名为<strong class="jp ir"> Warframe </strong>，于 2013 年问世</li></ul><h2 id="8f42" class="kv kw iq bd lr ls lt dn lu lv lw dp lx jy ly lz ma kc mb mc md kg me mf mg mh bi translated">用户评分和 Metascore 有什么关系？</h2><pre class="km kn ko kp gt kq kr ks kt aw ku bi"><span id="0c3a" class="kv kw iq kr b gy kx ky l kz la">top_50_filtered %&gt;% <br/>  ggplot(aes(user_score,metascore.x))+<br/>  geom_point(color="green")+<br/>  geom_text(aes(label=game),check_overlap = TRUE,color="turquoise",size=3)+<br/>  vapoRwave::new_retro()+<br/>  scale_color_newRetro()+<br/>  labs(title = "Relationship between Userscore and Metascore",x="USERSCORE",y="METASCORE")</span></pre><figure class="km kn ko kp gt mo gh gi paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="gh gi mz"><img src="../Images/b3947fce7202e0314ca5ad600d8ae657.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oY5MMluQc3uOqUbezQ-BGQ.png"/></div></div></figure><ul class=""><li id="bb8e" class="ld le iq jp b jq jr ju jv jy lf kc lg kg lh kk li lj lk ll bi translated"><strong class="jp ir">用户评分</strong>和<strong class="jp ir"> Metascore 之间有大致趋势。像《巫师 3》、《GTA V》、《雷曼传奇》、《火箭联盟》(《T30》、《T31 》)这样的游戏在这两方面都获得了高分，这是理所应当的</strong></li><li id="2c14" class="ld le iq jp b jq lm ju ln jy lo kc lp kg lq kk li lj lk ll bi translated">圈出的游戏是那些被大肆宣传但未能达到预期的游戏。虽然我很惊讶<strong class="jp ir">战争阴影</strong>的用户评分这么低，但是那个游戏有病啊！</li><li id="a4bb" class="ld le iq jp b jq lm ju ln jy lo kc lp kg lq kk li lj lk ll bi translated">一个引起我注意的游戏是<strong class="jp ir">疯狂的麦克斯。评论家对它的评价不冷不热，但用户喜欢它。因为前者，我实际上从来没有玩过，但这可能会改变我的想法</strong></li></ul><h2 id="632e" class="kv kw iq bd lr ls lt dn lu lv lw dp lx jy ly lz ma kc mb mc md kg me mf mg mh bi translated">用户得分排名前 30 的游戏</h2><pre class="km kn ko kp gt kq kr ks kt aw ku bi"><span id="cd1c" class="kv kw iq kr b gy kx ky l kz la">top_50_filtered %&gt;%<br/>  top_n(30,user_score) %&gt;% <br/>  ggplot(aes(reorder(game,user_score),user_score))+<br/>    geom_lollipop(color="white")+<br/>  coord_flip()+<br/>  geom_text(aes(label=user_score),color="white",hjust=-1)+<br/>  new_retro()+<br/>  scale_y_continuous(limits = c(0,100))+<br/>  labs(x=" ",title = "Top 30 Games by User Score")</span></pre><ul class=""><li id="50a2" class="ld le iq jp b jq jr ju jv jy lf kc lg kg lh kk li lj lk ll bi translated">使用<strong class="jp ir"> top_n </strong>函数根据<strong class="jp ir"> user_score </strong>筛选出前 30 个游戏</li><li id="c891" class="ld le iq jp b jq lm ju ln jy lo kc lp kg lq kk li lj lk ll bi translated"><strong class="jp ir">重新排序 ggplot 中的</strong>功能，从最大值到最小值对图形进行排序</li><li id="6f4b" class="ld le iq jp b jq lm ju ln jy lo kc lp kg lq kk li lj lk ll bi translated"><strong class="jp ir"> geom_lollipop </strong>制作棒棒糖图</li></ul><figure class="km kn ko kp gt mo gh gi paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="gh gi mz"><img src="../Images/404421a7eb406925b4dee71ba6079fca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*L0jlJ10rmQqZ3HPEG_kX9g.png"/></div></div></figure><ul class=""><li id="5e54" class="ld le iq jp b jq jr ju jv jy lf kc lg kg lh kk li lj lk ll bi translated">毫不奇怪看到<strong class="jp ir">巫师 3 </strong>在顶端。这场比赛是一个杰作</li><li id="632b" class="ld le iq jp b jq lm ju ln jy lo kc lp kg lq kk li lj lk ll bi translated">虽然我很惊讶地看到<strong class="jp ir">内邪 2 </strong>排在第二位<strong class="jp ir">。这是一个非常好的游戏，但我没有意识到它会获得如此高的分数，超过了像《GTA V》这样的游戏</strong></li><li id="2815" class="ld le iq jp b jq lm ju ln jy lo kc lp kg lq kk li lj lk ll bi translated">因此,<strong class="jp ir">的续集《战争阴影，中土世界:魔多阴影》</strong>在用户中获得了更好的分数。我个人更喜欢前传，但两者都是不错的游戏</li><li id="e28b" class="ld le iq jp b jq lm ju ln jy lo kc lp kg lq kk li lj lk ll bi translated">我很惊讶地看到<strong class="jp ir">蝙蝠侠:阿卡姆骑士</strong>低于预期。这是我在 PS4 上最喜欢的游戏之一，也是我认为蝙蝠侠阿卡姆三部曲中最好的。我认为低分可能是因为人们被蝙蝠战车的机制和乏味的老板战斗所激怒</li></ul><h2 id="4d82" class="kv kw iq bd lr ls lt dn lu lv lw dp lx jy ly lz ma kc mb mc md kg me mf mg mh bi translated">Metascore 的 op 30 游戏</h2><pre class="km kn ko kp gt kq kr ks kt aw ku bi"><span id="fb6d" class="kv kw iq kr b gy kx ky l kz la">top_50_filtered %&gt;%<br/>  top_n(30,metascore.x) %&gt;% <br/>  ggplot(aes(reorder(game,metascore.x),metascore.x))+<br/>    geom_lollipop(color="light blue")+<br/>  coord_flip()+<br/>   geom_text(aes(label=metascore.x),color="light blue",hjust=-1)+<br/>  new_retro()+<br/>  scale_y_continuous(limits = c(0,100))+<br/>  labs(x=" ",y=" ",title = "Top 30 Games by Meta Score")</span></pre><ul class=""><li id="00cc" class="ld le iq jp b jq jr ju jv jy lf kc lg kg lh kk li lj lk ll bi translated">和以前一样的代码。刚刚用 metascore 替换了<strong class="jp ir">用户分数</strong></li></ul><figure class="km kn ko kp gt mo gh gi paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="gh gi mz"><img src="../Images/63cb5268ebf888680356b16ee9db997b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hZI8tcPjBJZj3OmyUBaO1g.png"/></div></div></figure><ul class=""><li id="7d77" class="ld le iq jp b jq jr ju jv jy lf kc lg kg lh kk li lj lk ll bi translated">你可以清楚地看到，当我们从用户分数转移到 Metascore 时，许多游戏都发生了变化。使用<strong class="jp ir"> anti_join </strong>函数，我们可以看到哪些游戏出现在用户分数排名前 30 的游戏中，而没有出现在元分数排名前 30 的游戏中</li></ul><pre class="km kn ko kp gt kq kr ks kt aw ku bi"><span id="ca96" class="kv kw iq kr b gy kx ky l kz la">top_50_filtered %&gt;%<br/>  top_n(30,user_score) %&gt;%<br/>  anti_join(top_50_filtered %&gt;% <br/>              top_n(30,metascore.x))</span></pre><ul class=""><li id="a5b7" class="ld le iq jp b jq jr ju jv jy lf kc lg kg lh kk li lj lk ll bi translated">这里的 anti_join 函数自动检测两个数据框之间的公共列— <strong class="jp ir">游戏</strong>，并显示 metascore 排名前 30 的游戏中没有的前 30 个用户游戏</li></ul><figure class="km kn ko kp gt mo gh gi paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="gh gi ni"><img src="../Images/99b8c90f6ad1185a6e11ffcc8932e14d.png" data-original-src="https://miro.medium.com/v2/resize:fit:830/format:webp/1*Q-Y1YeRGcE0F6eC65JLadA.png"/></div></div></figure><ul class=""><li id="aab5" class="ld le iq jp b jq jr ju jv jy lf kc lg kg lh kk li lj lk ll bi translated">除了<strong class="jp ir">邪恶 2 </strong>和<strong class="jp ir">疯狂的麦克斯</strong>之外，这些游戏中的大多数在用户评分和 Metascore 之间没有太大的区别</li></ul><h2 id="3437" class="kv kw iq bd lr ls lt dn lu lv lw dp lx jy ly lz ma kc mb mc md kg me mf mg mh bi translated">按发布者的用户分数分布</h2><pre class="km kn ko kp gt kq kr ks kt aw ku bi"><span id="a599" class="kv kw iq kr b gy kx ky l kz la">top_50_filtered %&gt;%<br/>  filter(!is.na(publisher)) %&gt;% <br/>  ggplot(aes(reorder(publisher,user_score,FUN = mean),user_score))+<br/>  geom_boxplot(color="purple")+<br/>  geom_hline(yintercept = 80,color="white")+<br/>  coord_flip()+<br/>  new_retro()+<br/>  labs(x=" ")</span></pre><ul class=""><li id="cfb2" class="ld le iq jp b jq jr ju jv jy lf kc lg kg lh kk li lj lk ll bi translated">绘制箱线图以可视化前 50 名出版商的用户分数分布</li><li id="95ec" class="ld le iq jp b jq lm ju ln jy lo kc lp kg lq kk li lj lk ll bi translated">使用<strong class="jp ir">重新排序</strong>功能根据平均用户分数对箱线图进行排序</li><li id="4647" class="ld le iq jp b jq lm ju ln jy lo kc lp kg lq kk li lj lk ll bi translated">在 80 处增加了一条垂直线，作为一个伟大游戏的门槛</li></ul><figure class="km kn ko kp gt mo gh gi paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="gh gi mz"><img src="../Images/d7259acdb957b64e94b919e8846b8f1a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HSfgJ_X6_QbIZpGg2O5aOA.png"/></div></div></figure><ul class=""><li id="d949" class="ld le iq jp b jq jr ju jv jy lf kc lg kg lh kk li lj lk ll bi translated">我明白为什么育碧在这里得分这么低了。他们最近在《孤岛惊魂》和《刺客信条》系列中的游戏表现平平</li><li id="fdf1" class="ld le iq jp b jq lm ju ln jy lo kc lp kg lq kk li lj lk ll bi translated">摇滚明星从不让人失望。他们制作的每一款游戏都是杰作</li><li id="1fe9" class="ld le iq jp b jq lm ju ln jy lo kc lp kg lq kk li lj lk ll bi translated">动视<strong class="jp ir">遍地都是。也许人们终于厌倦了<strong class="jp ir">使命召唤</strong>系列</strong></li><li id="1b1c" class="ld le iq jp b jq lm ju ln jy lo kc lp kg lq kk li lj lk ll bi translated"><strong class="jp ir"> Capcom </strong>真的很低。这很可能是由于发布了一款不完整的<strong class="jp ir">街霸 V </strong>游戏<strong class="jp ir"> </strong>并对其收取全价。但是 2019 年对卡普空来说是令人惊讶的一年，像怪物猎人、生化危机 2:翻拍和鬼泣 5 这样的游戏对他们来说都是巨大的成功</li></ul><h2 id="a55a" class="kv kw iq bd lr ls lt dn lu lv lw dp lx jy ly lz ma kc mb mc md kg me mf mg mh bi translated">发布者的 Metascore 分发</h2><pre class="km kn ko kp gt kq kr ks kt aw ku bi"><span id="f7f6" class="kv kw iq kr b gy kx ky l kz la">top_50_filtered %&gt;%<br/>  filter(!is.na(publisher)) %&gt;% <br/>  ggplot(aes(reorder(publisher,metascore.x,FUN = mean),metascore.x))+<br/>  geom_boxplot(color="green")+<br/>  geom_hline(yintercept = 80,color="white")+<br/>  coord_flip()+<br/>  new_retro()+<br/>  labs(x=" ",y="Metascore")</span></pre><figure class="km kn ko kp gt mo gh gi paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="gh gi mz"><img src="../Images/c685685280685f1cb2f44a61abc97b49.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FjkJVnsbq4UJ2EaIH-NubA.png"/></div></div></figure><p id="ce39" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">似乎出版商在 Metascore 方面比他们的用户得分做得更好</p><h2 id="da83" class="kv kw iq bd lr ls lt dn lu lv lw dp lx jy ly lz ma kc mb mc md kg me mf mg mh bi translated"><strong class="ak">平均游戏时间最长的游戏</strong></h2><pre class="km kn ko kp gt kq kr ks kt aw ku bi"><span id="60f4" class="kv kw iq kr b gy kx ky l kz la">top_50_filtered %&gt;%<br/>  top_n(30,average_playtime) %&gt;% ggplot(aes(reorder(game,average_playtime/60),average_playtime/60))+<br/>  geom_lollipop(color="purple")+<br/>  coord_flip()+<br/>  geom_text(aes(label= round(average_playtime/60)),color="white",hjust=-1)+<br/>  vapoRwave::new_retro()+<br/>  scale_y_continuous(limits = c(0,40))+<br/>  labs(x=" ",y="Average playtime in 2 weeks -  (hrs)")</span></pre><ul class=""><li id="67a1" class="ld le iq jp b jq jr ju jv jy lf kc lg kg lh kk li lj lk ll bi translated">每款游戏的平均游戏时间(T47)以分钟为单位来衡量用户两周平均玩游戏的时间</li><li id="31fa" class="ld le iq jp b jq lm ju ln jy lo kc lp kg lq kk li lj lk ll bi translated">使用<strong class="jp ir"> top_n </strong>函数只查看前 30 个最长的游戏</li><li id="cb92" class="ld le iq jp b jq lm ju ln jy lo kc lp kg lq kk li lj lk ll bi translated">绘图时，将<strong class="jp ir"> average_playtime </strong>除以 60，换算成小时</li><li id="07f8" class="ld le iq jp b jq lm ju ln jy lo kc lp kg lq kk li lj lk ll bi translated"><strong class="jp ir"> geom_text </strong>以小时为单位标注<strong class="jp ir">平均播放时间</strong></li></ul><figure class="km kn ko kp gt mo gh gi paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="gh gi mz"><img src="../Images/4602e332430308dab0263d31faf04920.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rkHz3wWl0C4ajzBeSumZhg.png"/></div></div></figure><ul class=""><li id="6507" class="ld le iq jp b jq jr ju jv jy lf kc lg kg lh kk li lj lk ll bi translated">排名靠前的最长游戏大多是开放世界的比如<strong class="jp ir">正义事业 4、孤岛惊魂 5、疯狂的麦克斯、刺客信条、GTA V、</strong>和<strong class="jp ir">巫师 3 </strong></li><li id="4acd" class="ld le iq jp b jq lm ju ln jy lo kc lp kg lq kk li lj lk ll bi translated">惊讶地看着<strong class="jp ir">号猎物</strong>号。我没有玩，但我不认为这是开放世界</li></ul><h2 id="1bf7" class="kv kw iq bd lr ls lt dn lu lv lw dp lx jy ly lz ma kc mb mc md kg me mf mg mh bi translated">用户正面评价的百分比</h2><pre class="km kn ko kp gt kq kr ks kt aw ku bi"><span id="c324" class="kv kw iq kr b gy kx ky l kz la">top_50_filtered <strong class="kr ir">%&gt;%</strong>  <strong class="kr ir">mutate</strong>(percentage_positive_users=positive_users/(positive_users+negative_users+neutral_users),<br/>         percentage_positive_critics =positive_critics/(positive_critics+negative_critics+neutral_critics)) <strong class="kr ir">%&gt;%</strong><br/>  <strong class="kr ir">filter</strong>(positive_users&gt;=10,percentage_positive_users&gt;=0.5) <strong class="kr ir">%&gt;%</strong><br/>  <strong class="kr ir">top_n</strong>(30,percentage_positive_users) <strong class="kr ir">%&gt;% </strong> <strong class="kr ir">ggplot</strong>(aes(<strong class="kr ir">reorder</strong>(game,percentage_positive_users),percentage_positive_users))+<br/>  <strong class="kr ir">geom_lollipop</strong>(color="white")+<br/>  <strong class="kr ir">coord_flip</strong>()+<br/>  <strong class="kr ir">labs</strong>(x=" ")+<br/> <strong class="kr ir"> new_retro</strong>()</span></pre><ul class=""><li id="bba6" class="ld le iq jp b jq jr ju jv jy lf kc lg kg lh kk li lj lk ll bi translated">使用<strong class="jp ir"> mutate </strong>函数创建两个新列:<strong class="jp ir">percentage _ positive _ users</strong>和<strong class="jp ir">percentage _ positive _ critics</strong></li><li id="f788" class="ld le iq jp b jq lm ju ln jy lo kc lp kg lq kk li lj lk ll bi translated">由于有些游戏获得的总分很少，我使用了<strong class="jp ir">过滤器</strong>功能，只显示那些至少有 10 个正面用户分数，并且正面用户总百分比≥ 50%的游戏</li><li id="ee76" class="ld le iq jp b jq lm ju ln jy lo kc lp kg lq kk li lj lk ll bi translated">Rest 与我们在之前的棒棒糖图表中使用的代码相同</li></ul><figure class="km kn ko kp gt mo gh gi paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="gh gi mz"><img src="../Images/29c1780bd8f2acfa667d8298bf9be82a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GdwjU7rqUHnFWR4DeaBBoQ.png"/></div></div></figure><ul class=""><li id="60b8" class="ld le iq jp b jq jr ju jv jy lf kc lg kg lh kk li lj lk ll bi translated">哇！看到 GTA V 这么低很惊讶吧</li><li id="7d73" class="ld le iq jp b jq lm ju ln jy lo kc lp kg lq kk li lj lk ll bi translated">《疯狂的麦克斯》和《死亡之光》是其中一款非常好但却不为人知的游戏</li><li id="02e2" class="ld le iq jp b jq lm ju ln jy lo kc lp kg lq kk li lj lk ll bi translated">《剑术在线》收到了来自评论家的可怕评论，但是看起来用户们喜欢它</li></ul><h2 id="f6ec" class="kv kw iq bd lr ls lt dn lu lv lw dp lx jy ly lz ma kc mb mc md kg me mf mg mh bi translated">评论家的正面评论百分比</h2><pre class="km kn ko kp gt kq kr ks kt aw ku bi"><span id="49d4" class="kv kw iq kr b gy kx ky l kz la">top_50_filtered <strong class="kr ir">%&gt;%</strong>  <strong class="kr ir">mutate</strong>(percentage_positive_users=positive_users/(positive_users+negative_users+neutral_users),<br/>         percentage_positive_critics =positive_critics/(positive_critics+negative_critics+neutral_critics)) <strong class="kr ir">%&gt;%</strong><br/>  <strong class="kr ir">filter</strong>(positive_critics&gt;=10,percentage_positive_critics&gt;=0.5) <strong class="kr ir">%&gt;%</strong><br/>  <strong class="kr ir">top_n</strong>(30,percentage_positive_critics) <strong class="kr ir">%&gt;% </strong> <strong class="kr ir">ggplot</strong>(aes(<strong class="kr ir">reorder</strong>(game,percentage_positive_critics),percentage_positive_critics))+<br/>  <strong class="kr ir">geom_lollipop</strong>(color="white")+<br/>  <strong class="kr ir">coord_flip</strong>()+<br/>  <strong class="kr ir">labs</strong>(x=" ")+<br/> <strong class="kr ir"> new_retro</strong>()</span></pre><figure class="km kn ko kp gt mo gh gi paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="gh gi mz"><img src="../Images/23fa522c19d9c76ee4f2da45e8f2e178.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*a6DrPDjcrBZDn2prO4J5KA.png"/></div></div></figure><ul class=""><li id="27f1" class="ld le iq jp b jq jr ju jv jy lf kc lg kg lh kk li lj lk ll bi translated">NBA 2k16 和<strong class="jp ir"> NBA 2k17 </strong>得到了评论家的好评，但用户的评分很低</li></ul><p id="2656" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">老实说，我没有听说过排名前四的游戏，但由于它们的规模小，所以不被认为是 AAA 级游戏</p><h1 id="a40a" class="nj kw iq bd lr nk nl nm lu nn no np lx nq nr ns ma nt nu nv md nw nx ny mg nz bi translated">预测分析</h1><p id="4618" class="pw-post-body-paragraph jn jo iq jp b jq mi js jt ju mj jw jx jy mk ka kb kc ml ke kf kg mm ki kj kk ij bi translated">预测<strong class="jp ir">元得分</strong>是不实际的，因为它是基于数据集中提供的所有数值变量的公式计算的。预测<strong class="jp ir">用户评分</strong>更有意思。为此，我将使用<a class="ae kl" href="https://github.com/tidymodels" rel="noopener ugc nofollow" target="_blank"> Tidymodels </a>元包。它是一个软件包的集合，允许您创建一个无缝的数据管道，从预处理您的数据、调整您的模型、建模您的数据、做出预测和测量您的模型性能，同时遵守 Tidyverse 的<a class="ae kl" href="https://cran.r-project.org/web/packages/tidyr/vignettes/tidy-data.html" rel="noopener ugc nofollow" target="_blank">“整洁”原则</a></p><h2 id="c944" class="kv kw iq bd lr ls lt dn lu lv lw dp lx jy ly lz ma kc mb mc md kg me mf mg mh bi translated">数据准备</h2><pre class="km kn ko kp gt kq kr ks kt aw ku bi"><span id="aee5" class="kv kw iq kr b gy kx ky l kz la"><strong class="kr ir">library(tidymodels)</strong></span><span id="2381" class="kv kw iq kr b gy lc ky l kz la">ratings_data &lt;- top_50_filtered %&gt;% <br/>  <strong class="kr ir">mutate</strong>(percentage_positive_users=positive_users/(positive_users+negative_users+neutral_users),<br/>         percentage_negative_users =negative_users/(positive_users+negative_users+neutral_users),<br/>         percentage_positive_critics =positive_critics/(positive_critics+negative_critics+neutral_critics),<br/>         percentage_negative_critics =negative_critics/(positive_critics+negative_critics+neutral_critics)) %&gt;% <br/>  <strong class="kr ir">drop_na()</strong></span><span id="88fe" class="kv kw iq kr b gy lc ky l kz la"><strong class="kr ir">Splitting the data</strong></span><span id="7b84" class="kv kw iq kr b gy lc ky l kz la">split &lt;- initial_split(ratings_data,prop = 0.6,)</span><span id="6ba8" class="kv kw iq kr b gy lc ky l kz la">train_games &lt;- split %&gt;% training() %&gt;%<br/>test_games &lt;- split %&gt;% testing()</span></pre><ul class=""><li id="6e75" class="ld le iq jp b jq jr ju jv jy lf kc lg kg lh kk li lj lk ll bi translated">使用<strong class="jp ir"> mutate </strong>函数创建新变量，这些变量将用作<strong class="jp ir"> user_score </strong>的预测值</li><li id="9669" class="ld le iq jp b jq lm ju ln jy lo kc lp kg lq kk li lj lk ll bi translated">删除任何缺少的值</li><li id="a892" class="ld le iq jp b jq lm ju ln jy lo kc lp kg lq kk li lj lk ll bi translated">使用<strong class="jp ir"> rsample </strong>库中的<strong class="jp ir"> intial_split </strong>函数为我们的训练和测试分割创建一个分割参数</li><li id="1f7f" class="ld le iq jp b jq lm ju ln jy lo kc lp kg lq kk li lj lk ll bi translated">将它与来自<strong class="jp ir"> rsample </strong>的<strong class="jp ir">训练</strong>和<strong class="jp ir">测试</strong>函数链接起来，创建我们的训练和测试数据集</li></ul><h2 id="c9dd" class="kv kw iq bd lr ls lt dn lu lv lw dp lx jy ly lz ma kc mb mc md kg me mf mg mh bi translated">创建预处理管道</h2><pre class="km kn ko kp gt kq kr ks kt aw ku bi"><span id="864a" class="kv kw iq kr b gy kx ky l kz la"><strong class="kr ir">Creating Recipe</strong></span><span id="1018" class="kv kw iq kr b gy lc ky l kz la">norm_recipe &lt;-<br/>  <strong class="kr ir">recipe</strong>(user_score~percentage_positive_critics+percentage_negative_critics+percentage_positive_users+<br/>           percentage_negative_users+price+genre+rating+publisher,data = train_games) %&gt;%<br/>  <strong class="kr ir">step_naomit</strong>(all_numeric(),all_nominal()) %&gt;%<br/>  <strong class="kr ir">step_dummy</strong>(all_nominal(),,one_hot = TRUE) %&gt;% <br/>  <strong class="kr ir">step_normalize</strong>(all_predictors(),na_rm = TRUE) %&gt;%<br/> <strong class="kr ir"> step_corr</strong>(all_predictors()) %&gt;%<br/>  <strong class="kr ir">prep</strong>()</span><span id="6ba6" class="kv kw iq kr b gy lc ky l kz la"><strong class="kr ir">Applying Recipe on Train and Test sets</strong></span><span id="2de6" class="kv kw iq kr b gy lc ky l kz la">train_prepped &lt;- juice(norm_recipe)<br/>test_prepped &lt;- norm_recipe %&gt;% bake(test_game)</span></pre><ul class=""><li id="c6eb" class="ld le iq jp b jq jr ju jv jy lf kc lg kg lh kk li lj lk ll bi translated">使用<strong class="jp ir">配方</strong>包，我正在创建一个“配方”,它基本上是我想要如何处理我的数据中的变量的管道</li><li id="5ad4" class="ld le iq jp b jq lm ju ln jy lo kc lp kg lq kk li lj lk ll bi translated">我们从定义因变量和自变量之间的关系开始</li><li id="4ac9" class="ld le iq jp b jq lm ju ln jy lo kc lp kg lq kk li lj lk ll bi translated">“步进”功能是数据转换功能</li><li id="3cc2" class="ld le iq jp b jq lm ju ln jy lo kc lp kg lq kk li lj lk ll bi translated"><strong class="jp ir"> step_naomit </strong>删除名义变量和数值变量中的缺失值</li><li id="7971" class="ld le iq jp b jq lm ju ln jy lo kc lp kg lq kk li lj lk ll bi translated"><strong class="jp ir"> step_dummy </strong>对所有分类变量进行一次性编码</li><li id="25e3" class="ld le iq jp b jq lm ju ln jy lo kc lp kg lq kk li lj lk ll bi translated"><strong class="jp ir"> step_normalize </strong>归一化所有数值预测值</li><li id="52c3" class="ld le iq jp b jq lm ju ln jy lo kc lp kg lq kk li lj lk ll bi translated"><strong class="jp ir"> step_corr </strong>删除任何彼此高度相关的独立变量</li><li id="80ab" class="ld le iq jp b jq lm ju ln jy lo kc lp kg lq kk li lj lk ll bi translated"><strong class="jp ir">准备</strong>功能基本完成并准备配方</li><li id="fa08" class="ld le iq jp b jq lm ju ln jy lo kc lp kg lq kk li lj lk ll bi translated"><strong class="jp ir"> juice </strong>函数，应用于 norm_recipe，<strong class="jp ir"> </strong>给出了训练集的转换版本</li><li id="41af" class="ld le iq jp b jq lm ju ln jy lo kc lp kg lq kk li lj lk ll bi translated"><strong class="jp ir">烘焙</strong>函数与<strong class="jp ir">定额 _ 配方</strong>链接在一起，应用于测试数据，给出了转换后的版本</li></ul><h2 id="9a2b" class="kv kw iq bd lr ls lt dn lu lv lw dp lx jy ly lz ma kc mb mc md kg me mf mg mh bi translated">建模</h2><pre class="km kn ko kp gt kq kr ks kt aw ku bi"><span id="9a9e" class="kv kw iq kr b gy kx ky l kz la">ranger &lt;- rand_forest(trees = 100,mode = "regression") %&gt;% <br/>  set_engine("ranger") %&gt;% <br/>  fit(user_score~.,data=train_prepped)</span></pre><ul class=""><li id="e9c3" class="ld le iq jp b jq jr ju jv jy lf kc lg kg lh kk li lj lk ll bi translated">为了定义我们的模型，我们使用了 Parsnip 包来定义一个 randomforest 回归模型</li><li id="085f" class="ld le iq jp b jq lm ju ln jy lo kc lp kg lq kk li lj lk ll bi translated">将发动机设置到<strong class="jp ir">档位</strong></li><li id="8af4" class="ld le iq jp b jq lm ju ln jy lo kc lp kg lq kk li lj lk ll bi translated">使用<strong class="jp ir">拟合</strong>函数来定义我们的公式，并提供转换后的训练数据</li></ul><h2 id="6ad1" class="kv kw iq bd lr ls lt dn lu lv lw dp lx jy ly lz ma kc mb mc md kg me mf mg mh bi translated"><strong class="ak">预测</strong></h2><pre class="km kn ko kp gt kq kr ks kt aw ku bi"><span id="6156" class="kv kw iq kr b gy kx ky l kz la"><strong class="kr ir">Converting NAs to 0</strong></span><span id="7413" class="kv kw iq kr b gy lc ky l kz la">test_prepped &lt;- test_prepped %&gt;% <br/>  mutate_all(~replace(.,is.na(.),0))</span><span id="c5c4" class="kv kw iq kr b gy lc ky l kz la"><br/><strong class="kr ir">Making predictions</strong></span><span id="368e" class="kv kw iq kr b gy lc ky l kz la">ranger %&gt;% <br/>  predict(test_prepped) %&gt;% <br/>   bind_cols(test_games) %&gt;% <br/>   select(game,.pred,user_score)</span><span id="4b12" class="kv kw iq kr b gy lc ky l kz la"><strong class="kr ir">Measuring Model Accuracy</strong></span><span id="8367" class="kv kw iq kr b gy lc ky l kz la">ranger %&gt;% <br/>  predict(test_prepped) %&gt;%<br/>  bind_cols(test_games) %&gt;% <br/>  metrics(truth=user_score,estimate=.pred)</span></pre><ul class=""><li id="2adc" class="ld le iq jp b jq jr ju jv jy lf kc lg kg lh kk li lj lk ll bi translated">在对准备好的测试集应用预测之前，我必须将一些 NAs 转换为 0，否则 randomforest 模型将抛出错误</li><li id="37c9" class="ld le iq jp b jq lm ju ln jy lo kc lp kg lq kk li lj lk ll bi translated">最后，我们使用 ranger 模型对我们准备好的测试集进行预测，并将预测与原始测试数据结合起来，以查看每个游戏的预测和实际用户分数</li></ul><figure class="km kn ko kp gt mo gh gi paragraph-image"><div class="gh gi oa"><img src="../Images/a0eb732cf92cfb6ed66c445c20d38121.png" data-original-src="https://miro.medium.com/v2/resize:fit:862/format:webp/1*fO9w3UW9QliN59_0BCg3fQ.png"/></div><figcaption class="mv mw gj gh gi mx my bd b be z dk">Sample of predicted vs actual user scores</figcaption></figure><ul class=""><li id="452b" class="ld le iq jp b jq jr ju jv jy lf kc lg kg lh kk li lj lk ll bi translated">一旦我们做出了预测，我使用<strong class="jp ir">标尺</strong>包中的<strong class="jp ir">度量</strong>函数，通过提供实际和预测的用户分数来计算模型的准确性</li></ul><figure class="km kn ko kp gt mo gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/63a27d12247f113ae90ebb961ca04373.png" data-original-src="https://miro.medium.com/v2/resize:fit:1324/format:webp/1*1xRXd1oyL15MNTLc8keB2w.png"/></div></figure><ul class=""><li id="cf53" class="ld le iq jp b jq jr ju jv jy lf kc lg kg lh kk li lj lk ll bi translated"><strong class="jp ir"> rsq </strong>衡量因变量<strong class="jp ir"> user_score </strong>的变化在多大程度上可以由数据集中的自变量来解释。在我们的案例中，考虑到我们拥有的数据类型，这还不算太糟糕，而且它是一个非常小的数据集</li><li id="77dc" class="ld le iq jp b jq lm ju ln jy lo kc lp kg lq kk li lj lk ll bi translated">它可以通过超参数调优和交叉验证来改进，但这超出了本文的范围。此外，这些功能目前仍在<strong class="jp ir"> Tidymodels </strong>中开发，在我们的分析中还没有无缝集成它们</li></ul><h1 id="1d46" class="nj kw iq bd lr nk nl nm lu nn no np lx nq nr ns ma nt nu nv md nw nx ny mg nz bi translated">结论</h1><p id="bb89" class="pw-post-body-paragraph jn jo iq jp b jq mi js jt ju mj jw jx jy mk ka kb kc ml ke kf kg mm ki kj kk ij bi translated">我在对这些数据进行端到端分析时获得了很多乐趣，并且能够使用<strong class="jp ir"> Tidymodels </strong>包应用一些基本的机器学习是很好的实践。尽管如此，重要的是要注意不要从这些数据中得出任何重要的结论，因为我们只查看了原始数据源的一个非常小的子集。我认为，如果我们收集更多关于所有不同视频游戏的数据，这种分析会变得更加有趣。</p></div></div>    
</body>
</html>