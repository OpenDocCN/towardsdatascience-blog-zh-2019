<html>
<head>
<title>Siamese Dream</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">暹罗梦</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/siamese-dream-bf1953c01e17?source=collection_archive---------26-----------------------#2019-04-23">https://towardsdatascience.com/siamese-dream-bf1953c01e17?source=collection_archive---------26-----------------------#2019-04-23</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="7d54" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">用连体神经网络跟踪的初学者指南</h2></div><p id="7f99" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">你坐在你的沙发上，狗在你的脚边，一只手完全沉浸在一袋白切达奶酪智能食品中。网飞在电视上，你刚刚通过 IMDB 评分 6.4/10 的第 48 分钟，惊悚监视。你看着主角试图躲避警察的监视。他们仔细研究了无休止的闭路电视监控录像，跟踪了对手的每一个动作，却没有触动任何一个按钮。你不禁会想。他们不会真的这么做吧？这个问题的答案是肯定的，他们可以。这个例子描述了在计算机视觉的流行科学学科的研究中的许多可能的应用之一。这是一个不断发展的研究领域，已经出现了大量的用例以及有前途的算法。这种算法包括暹罗神经网络，可以实现这些在电视上看到的结果。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi le"><img src="../Images/11a4d2e13371e2b13fbbf7ef4ca544b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:850/0*PYQ-Rdntu6F1U0Wq"/></div></figure><p id="589f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在，让这成为一个警告，这篇文章不会让你一夜成名，你可能不会像这个网站上的其他文章一样，拿出一个功能齐全的原型。你将会了解这些网络是什么，以及它们如何达到这样的结果。</p><p id="64f0" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">假定是卷积神经网络及其背后的数学的基本知识。如果您没有，我建议您保存此选项卡，观看此视频，然后再回来。</p><p id="5daa" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><a class="ae lm" href="https://www.youtube.com/watch?v=YRhxdVk_sIs" rel="noopener ugc nofollow" target="_blank">了解卷积网络</a></p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi ln"><img src="../Images/0ecef76dc3c9c66f20d39765061c3deb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1100/0*mH4oXxCRRnXROFdz"/></div></figure><h1 id="f944" class="lo lp it bd lq lr ls lt lu lv lw lx ly jz lz ka ma kc mb kd mc kf md kg me mf bi translated">暹罗概述</h1><p id="4581" class="pw-post-body-paragraph ki kj it kk b kl mg ju kn ko mh jx kq kr mi kt ku kv mj kx ky kz mk lb lc ld im bi translated">让我们考虑我们的最终目标是拍摄一段视频，选择一个目标，并在整个过程中跟踪它。现在让我们从兔子洞往下看，把它抽象出来。首先让我们想一想视频到底是什么。从根本上说，它只是一系列快速连续显示的照片或图像。因此，我们所要做的就是在视频的每一帧中找到一个目标，并在它周围画一个方框。这听起来和每个人最喜欢的儿童读物<em class="ml">“沃尔多在哪里”</em>出奇的相似。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi mm"><img src="../Images/c20910976df745a9d2867c10a9596819.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/0*f2Qo2TNHfOdrE_YU"/></div></figure><p id="7a64" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">用我们的眼睛，也许用我们的手指，从左到右扫描页面，看每一张脸，每一件衬衫或每一个特征，看看它是否与我们的老朋友沃尔多相匹配。甚至可能在他周围画一个圈，只是为了破坏其他可能想尝试的人的游戏。我们想训练一种算法来做到这一点。找到我们的目标，并在它周围画一个方框。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi mn"><img src="../Images/00a45b95fc2a54231bc6aec62f3e0c95.png" data-original-src="https://miro.medium.com/v2/resize:fit:926/0*37Lvu0-6vy0AldUL"/></div></figure><p id="01f3" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">不幸的是，我们知道我们的网络记性不好。我们必须不断提醒它目标图像(瓦尔多)是什么样子的。为此，我们需要两个网络。一个处理我们的沃尔多图像，另一个处理我们要找的他的整个图像。这就是暹罗的用武之地。就像连体双胞胎一样。我们构建两个相同的全卷积网络<em class="ml">(我们稍后将讨论全卷积网络</em>)。twins 的工作是处理我们的两个图像(目标和搜索图像)并在两个独立的特征地图中表示不同的特征。它们是相互关联的，因为它们在完全相同的时间执行相同的工作，但是它们的输入是不同的。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi mm"><img src="../Images/40f757928fabd3fdf059e7c17dc55a93.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/0*rdBATF53WevJ4JIM"/></div></figure><p id="521a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">它们需要相同的原因是为了以完全相同的方式表示两幅图像共有的特征。这对于比较我们是否拥有真正的瓦尔多至关重要。如果我们比较像他的衬衫这样的特征。我们必须确保我们有共同的属性(大小，颜色，图案)。保持这种状态的唯一方法是通过一个相同的网络来移动它们。</p><p id="8d2f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">基本的想法是，如果我们可以将目标图像(Waldo)的表示放在搜索图像(场景)的上面。我们可以找到共享最多的特征在哪里，这将是我们的目标图像(Waldo)在图像中的位置。我们在它周围画一个方框，并对所有图像重复，直到视频结束！拍拍自己的背，你刚刚学会了这是如何工作的绝对基础。如果你为了考试或者为了给你的朋友留下深刻印象而学习这个，这可能是一个停止阅读的好地方。如果你正在寻找本质的细节，请继续关注。</p><p id="504e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">为什么这是一种实时跟踪视频的有效方法的关键是我们需要理解的三个概念。这些是迁移学习、完全卷积网络和相关滤波器。我们已经知道什么是卷积神经网络，所以让我们看看什么使一个完全卷积。</p><h1 id="38a3" class="lo lp it bd lq lr ls lt lu lv lw lx ly jz lz ka ma kc mb kd mc kf md kg me mf bi translated">全卷积网络</h1><p id="d1d2" class="pw-post-body-paragraph ki kj it kk b kl mg ju kn ko mh jx kq kr mi kt ku kv mj kx ky kz mk lb lc ld im bi translated">全卷积表示神经网络由卷积层组成，在网络末端没有任何全连接层。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="gh gi mo"><img src="../Images/f5eeaa40412d3402a3169fb5a3a86b8d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*v5jfM5-7Q0TCCWQM"/></div></div></figure><p id="3785" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在完全卷积实现中，网络在任何地方都在学习过滤器(特征图)。包括最终决策层。在全连接层中，每个神经元都连接到前一层中的每个神经元。每个连接都有它自己的重量。在卷积层中，每个神经元仅连接到前一层中的几个附近的局部神经元，并且对每个神经元使用相同的一组权重。</p><h2 id="55d9" class="mt lp it bd lq mu mv dn lu mw mx dp ly kr my mz ma kv na nb mc kz nc nd me ne bi translated">我们为什么要这么做？</h2><p id="ef37" class="pw-post-body-paragraph ki kj it kk b kl mg ju kn ko mh jx kq kr mi kt ku kv mj kx ky kz mk lb lc ld im bi translated"><strong class="kk iu"> <em class="ml">输入图像大小:</em> </strong>如果你的网络中没有任何完全连通的层，你可以将网络应用于几乎任何大小的图像。因为只有完全连接的层需要特定大小的输入。这就是为什么在像<a class="ae lm" href="https://medium.com/@smallfishbigsea/a-walk-through-of-alexnet-6cbd137a5637" rel="noopener"> AlexNet </a>这样的架构中，你必须提供一定大小的输入图像。由于大多数视频和图像都有不同的大小，这使得我们可以轻松地进行调整，以满足弹性处理所需的规范。在这种情况下，使用全卷积网络会使我们的实现更加鲁棒。</p><p id="9057" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu"> <em class="ml">计算成本和速度</em> </strong>:卷积层和全连接层在计算和存储方面也有区别。由于完全连接的性质，它会消耗更多的计算。另一方面，如上所述，全卷积网络具有较少的集中在“本地”的连接。这对于查看图像来说是完美的，其中根据需要，特征是局部的(例如，“Waldo 的红白衬衫”由一组附近的像素组成，而不是遍布整个图像)。连接数越少，全卷积网络的速度越快，由于我们是实时操作，这对于效率至关重要。</p><h1 id="44f9" class="lo lp it bd lq lr ls lt lu lv lw lx ly jz lz ka ma kc mb kd mc kf md kg me mf bi translated">迁移学习</h1><p id="be99" class="pw-post-body-paragraph ki kj it kk b kl mg ju kn ko mh jx kq kr mi kt ku kv mj kx ky kz mk lb lc ld im bi translated">当网络不是从零开始学习(调整权重和连接)时，通常使用迁移学习。相反，它使用预先训练的知识，并建立在此基础上。我能想到的一个例子是一名机械师，他可能在大众汽车经销店修理汽车工作了多年。也许他找到了一份修理校车的新工作。他已经知道如何修理汽车，也知道修理汽车的复杂性。虽然他需要专门化他的技能并学习更多的知识来将这些知识转移到一种新型的车辆上。迁移学习在同样的前提下起作用。在我们的例子中，第一对层是经过预训练的，并且承载着一个非常成功的大型网络的重量。这将给出如上所述的图像的一般表示。剩余的层在大型数据集上进行训练，例如具有预定义边界框和目标的<a class="ae lm" href="http://got-10k.aitestunion.com/" rel="noopener ugc nofollow" target="_blank">戈特-10K </a>。由网络误差表示的功能损失(预测位置与地面真实值的比较)</p><pre class="lf lg lh li gt nf ng nh ni aw nj bi"><span id="2de4" class="mt lp it ng b gy nk nl l nm nn">Why do we want to do this? -It speeds up network and training!</span></pre><h1 id="3559" class="lo lp it bd lq lr ls lt lu lv lw lx ly jz lz ka ma kc mb kd mc kf md kg me mf bi translated">相关过滤器</h1><p id="6951" class="pw-post-body-paragraph ki kj it kk b kl mg ju kn ko mh jx kq kr mi kt ku kv mj kx ky kz mk lb lc ld im bi translated">好了，我们现在真的开始把这些碎片拼在一起了。让我们回想一下沃尔多在哪里的类比。我们目前有一个我们在 Waldo 寻找的产品展示(眼镜、衬衫、帽子等。).我们所要做的就是将它与我们的搜索图像特征进行比较，看看我们是否能够将它们匹配起来！如果你做了功课，你应该记得卷积神经网络创建特征图的操作。它如何接受滤波器并执行矩阵数学运算，像滑动窗口一样在整个图像上移动。这产生了具有突出特征的新图像。在寻找我们的目标时，我们几乎要做同样的事情。我们将使用搜索图像的特征图，而不是使用一般的学习过滤器。将它逐块传递到图像上，我们对图像进行卷积。我们接收到的输出代表了逐块的相似性，匹配程度越高的区域得分越高。我们搜索图像中相似度最高的区域就是瓦尔多所在的地方。我们现在要做的就是在他周围画一个方框，然后重复。我知道你在想什么，这听起来像是实时发生的许多事情。谢天谢地，数学拯救了我们。我们能够实时进行这些操作的原因是因为它发生在更广阔的领域。我们真的不需要现在就弄清楚为什么会这样。只要知道它允许你的机器同时计算所有这些滑动窗口的操作，通过你的 GPU 的多个核心并行。这使得我们几乎可以在瞬间观察到结果。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi mm"><img src="../Images/a5865c9ebbe38a65c9b67dc89ff3e083.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/0*WLS33omSsWnsE1QV"/></div></figure><h1 id="09af" class="lo lp it bd lq lr ls lt lu lv lw lx ly jz lz ka ma kc mb kd mc kf md kg me mf bi translated">未来</h1><p id="f1a0" class="pw-post-body-paragraph ki kj it kk b kl mg ju kn ko mh jx kq kr mi kt ku kv mj kx ky kz mk lb lc ld im bi translated">类似于我们的 Waldo 在哪里的例子，我们当前实现的问题是我们背景的相似性和遮挡导致了一个问题。我认为在这个领域继续研究是值得的。应用程序是丰富和非常重要的。自动驾驶汽车、机器人、智能跟踪，甚至基于视频跟踪的习得行为，都是特定研究的潜在领域。我强烈推荐 Luca Bertinetto 等人的论文 siamFC:提供了对该领域的一个很好的监督以及一个预训练演示。它是在 Tensorflow 中实现的，允许你在自己的视频上尝试。Github 回购的链接就在这里<a class="ae lm" href="https://github.com/torrvision/siamfc-tf" rel="noopener ugc nofollow" target="_blank"/>！如需进一步阅读和更复杂的方法，请查看<a class="ae lm" href="https://github.com/foolwood/DaSiamRPN" rel="noopener ugc nofollow" target="_blank"> siamRPN </a>和<a class="ae lm" href="https://github.com/foolwood/SiamMask" rel="noopener ugc nofollow" target="_blank"> siamMask </a>。</p></div><div class="ab cl no np hx nq" role="separator"><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt"/></div><div class="im in io ip iq"><p id="9b28" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="ml">最初发表于</em><a class="ae lm" href="https://gist.github.com/b940d22e903d0f5daaa7908357d23d7b" rel="noopener ugc nofollow" target="_blank"><em class="ml">【http://github.com】</em></a><em class="ml">。</em></p></div></div>    
</body>
</html>