<html>
<head>
<title>How I got 1% better accuracy by data augmentation</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我如何通过数据扩充提高 1%的准确率</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-i-got-1-better-accuracy-by-data-augmentation-2475c509349a?source=collection_archive---------14-----------------------#2019-01-26">https://towardsdatascience.com/how-i-got-1-better-accuracy-by-data-augmentation-2475c509349a?source=collection_archive---------14-----------------------#2019-01-26</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="05f4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">放下你所爱的东西是很难的。是的，在本系列的第 5 篇文章之后，我真的以为我已经完成了，但是……来自<a class="ae kl" rel="noopener" target="_blank" href="/part-5-training-the-network-to-read-handwritten-digits-c2288f1a2de3">和 MNIST 例子</a>的准确性/误差指标开始困扰我，我非常确定我可以通过实现另一个简单的技巧来改进它们:<em class="km">数据增强</em>。事实证明这很容易实现，而且效果非常好。</p><p id="c18f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当你读完这篇文章，你可以试试我在这个<a class="ae kl" href="https://machinelearning.tobiashill.se/extra-2-a-mnist-playground/" rel="noopener ugc nofollow" target="_blank">互动 MNIST 游乐场</a>上训练的一个小型神经网络！</p><p id="50f1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">此外，请查看该系列的所有零件:</p><ul class=""><li id="4cda" class="kn ko iq jp b jq jr ju jv jy kp kc kq kg kr kk ks kt ku kv bi translated"><a class="ae kl" href="https://medium.com/@tobias_hill/part-1-a-neural-network-from-scratch-foundation-e2d119df0f40" rel="noopener">第一部分:基础</a>。</li><li id="b666" class="kn ko iq jp b jq kw ju kx jy ky kc kz kg la kk ks kt ku kv bi translated"><a class="ae kl" href="https://medium.com/@tobias_hill/part-2-gradient-descent-and-backpropagation-bf90932c066a" rel="noopener">第二部分:梯度下降和反向传播</a>。</li><li id="efe3" class="kn ko iq jp b jq kw ju kx jy ky kc kz kg la kk ks kt ku kv bi translated"><a class="ae kl" href="https://medium.com/@tobias_hill/part-3-implementation-in-java-7bd305faad0" rel="noopener">第 3 部分:用 Java 实现</a>。</li><li id="9799" class="kn ko iq jp b jq kw ju kx jy ky kc kz kg la kk ks kt ku kv bi translated"><a class="ae kl" href="https://medium.com/@tobias_hill/part-4-better-faster-stronger-dd6ded07b74f" rel="noopener">第四部分:更好更快更强</a>。</li><li id="8dfa" class="kn ko iq jp b jq kw ju kx jy ky kc kz kg la kk ks kt ku kv bi translated"><a class="ae kl" href="https://medium.com/@tobias_hill/part-5-training-the-network-to-read-handwritten-digits-c2288f1a2de3" rel="noopener">第 5 部分:训练网络读取手写数字</a>。</li><li id="50b2" class="kn ko iq jp b jq kw ju kx jy ky kc kz kg la kk ks kt ku kv bi translated"><a class="ae kl" href="https://medium.com/@tobias_hill/extra-1-how-i-got-1-better-accuracy-by-data-augmentation-2475c509349a" rel="noopener"> Extra 1:我如何通过数据扩充提高 1%的准确率</a>。</li><li id="73cb" class="kn ko iq jp b jq kw ju kx jy ky kc kz kg la kk ks kt ku kv bi translated">MNIST 游乐场。</li></ul><h1 id="e097" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">数据扩充</h1><p id="ce06" class="pw-post-body-paragraph jn jo iq jp b jq lz js jt ju ma jw jx jy mb ka kb kc mc ke kf kg md ki kj kk ij bi translated">数据扩充就是从你实际得到的数据中制造更多的数据——在不丢失数据携带的信息的情况下增加方差。这样做降低了过度拟合的风险，并且通常可以提高看不见的数据的准确性。</p><p id="6f87" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在图像作为输入数据的特定情况下(如 MNIST 数据集中的情况)，增强可以是例如:</p><ul class=""><li id="fa0c" class="kn ko iq jp b jq jr ju jv jy kp kc kq kg kr kk ks kt ku kv bi translated">仿射变换(旋转、缩放、平移等。)</li><li id="a4b8" class="kn ko iq jp b jq kw ju kx jy ky kc kz kg la kk ks kt ku kv bi translated">弹性变形</li><li id="646d" class="kn ko iq jp b jq kw ju kx jy ky kc kz kg la kk ks kt ku kv bi translated">卷积滤波器(例如，在 MNIST 的例子中，通过使用最大或最小内核使数字变得更粗或更细)</li><li id="2f07" class="kn ko iq jp b jq kw ju kx jy ky kc kz kg la kk ks kt ku kv bi translated">添加噪声</li></ul><p id="520f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我决定进行仿射变换。我以前在 CG 中使用过很多次，知道它们非常简单明了。</p><h1 id="b1c8" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">仿射变换</h1><p id="ebe9" class="pw-post-body-paragraph jn jo iq jp b jq lz js jt ju ma jw jx jy mb ka kb kc mc ke kf kg md ki kj kk ij bi translated">仿射变换将一个仿射空间映射到另一个仿射空间。更具体地说，我们可以说仿射变换可以通过旋转、缩放和平移等操作来变换特定的坐标，并告诉我们这些变化后的坐标是什么。仿射变换可以被表示为矩阵，并且可以被组合，使得一系列变换仍然可以被表示为单个矩阵。</p><p id="eebe" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">例如(这里是二维描述的),我们可以这样构成变换 M:</p><figure class="mf mg mh mi gt mj gh gi paragraph-image"><div role="button" tabindex="0" class="mk ml di mm bf mn"><div class="gh gi me"><img src="../Images/1ca787d0691334e95459c9dfe12fa445.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bTYUpWVdLKgg8qV8B7lWdQ.png"/></div></div></figure><p id="586d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当我们得到这个 M 时，只需将它与输入坐标相乘，就可以得到它们在目标空间中的新位置，如 M 所定义的。相反，我们可以将目标空间的坐标与 M 的倒数相乘，以返回到原始空间。</p><p id="7404" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在 Java 中，创建这些仿射变换矩阵就像这样简单:</p><figure class="mf mg mh mi gt mj"><div class="bz fp l di"><div class="mq mr l"/></div></figure><p id="3558" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这就是我们将原始 MNIST 数字中的坐标转换为新的虚构数字中的坐标所需要的全部内容，这些数字是原始数字稍加修改的版本，用于训练网络。</p><p id="822b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">该方法作为一个整体，是 DigitData-entity 上的一个 mutator(参见<a class="ae kl" rel="noopener" target="_blank" href="/part-5-training-the-network-to-read-handwritten-digits-c2288f1a2de3">第 5 部分</a>)，看起来像这样:</p><figure class="mf mg mh mi gt mj"><div class="bz fp l di"><div class="mq mr l"/></div></figure><p id="f6c9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">正如您在第 29–41 行中看到的，上面的代码还具有插值功能，这使得转换后的结果更加平滑。</p><p id="00a3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">此外，还会进行一项检查，以查看生成的数字是否可能以某种方式进行了转换，使其部分溢出到目标 28×28 数组之外。当情况似乎是这样的时候，我们放弃那个改变并且再试一次。如果我们不能在 5 次重试内达到一个好的转换数字，我们跳过这一轮的转换，退回到原始数字。这很少发生。下一轮我们可能会更幸运，得到一个有效的转换。</p><p id="6714" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">说到巡房。我们多久改变一次输入数据？在每个训练时期之后，我像这样变换整个数据集:</p><figure class="mf mg mh mi gt mj"><div class="bz fp l di"><div class="mq mr l"/></div></figure><p id="7eeb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这样，神经网络就不会两次看到同一个数字(如上所述，除了少数运气不好的变换尝试之外)。换句话说:<em class="km">通过数据扩充，我们已经创建了一个无限的数据集。</em>当然，从严格的数学意义上来说，这是不正确的……但对于我们所有的训练目的来说，我们为随机仿射变换选择的分布方差绝对足以创建一个独特的数据流。</p><figure class="mf mg mh mi gt mj gh gi paragraph-image"><div role="button" tabindex="0" class="mk ml di mm bf mn"><div class="gh gi ms"><img src="../Images/b6b38b40863cc96063c58a15a8e1f1d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8r6X3A6K_dDMTXxkKSniDw.png"/></div></div></figure><h1 id="f1f5" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结果呢</h1><p id="adff" class="pw-post-body-paragraph jn jo iq jp b jq lz js jt ju ma jw jx jy mb ka kb kc mc ke kf kg md ki kj kk ij bi translated">我选定的那个小型神经网络(只有 50 个隐藏神经元，<a class="ae kl" rel="noopener" target="_blank" href="/part-5-training-the-network-to-read-handwritten-digits-c2288f1a2de3">见前一篇文章</a>)的错误率平均下降了 1%，现在可以稳定地训练到 1.7%-2%的错误率。</p><p id="de43" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">零钱。影响很大！</p><p id="3c90" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">请在我创建的一个小型<a class="ae kl" href="https://machinelearning.tobiashill.se/extra-2-a-mnist-playground/" rel="noopener ugc nofollow" target="_blank"> MNIST 游乐场</a>上测试一下这些训练有素的网络表现如何。</p><p id="f653" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">此外，如果你想仔细看看代码在这里:<a class="ae kl" href="https://bitbucket.org/tobias_hill/mnist-example/src/Augmentation/" rel="noopener ugc nofollow" target="_blank">https://bit bucket . org/Tobias _ hill/mnist-example/src/Augmentation/</a></p></div><div class="ab cl mt mu hu mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="ij ik il im in"><p id="3fbb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="km">原载于 2019 年 1 月 26 日</em><a class="ae kl" href="https://machinelearning.tobiashill.se/extra-1-data-augmentation/" rel="noopener ugc nofollow" target="_blank"><em class="km">machine learning . tobiashill . se</em></a><em class="km">。</em></p></div></div>    
</body>
</html>