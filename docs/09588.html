<html>
<head>
<title>Advanced Python Visualizations in PowerBI</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">PowerBI 中的高级 Python 可视化</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/advanced-python-visualizations-in-powerbi-b64fe8602a8a?source=collection_archive---------4-----------------------#2019-12-17">https://towardsdatascience.com/advanced-python-visualizations-in-powerbi-b64fe8602a8a?source=collection_archive---------4-----------------------#2019-12-17</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/0dbc70284e0d12122284efdf10317f6d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oL1m5KhnPhUnvKiQT-fN4A.jpeg"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk">Image by author</figcaption></figure><blockquote class="kf kg kh"><p id="1941" class="ki kj kk kl b km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg im bi translated">如何利用最新的 Python-PowerBI 集成，将 Python 的高级视觉效果与原生数据钻取和 DAX 功能相结合</p></blockquote></div><div class="ab cl lh li hx lj" role="separator"><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm"/></div><div class="im in io ip iq"><p id="0e62" class="pw-post-body-paragraph ki kj it kl b km kn ko kp kq kr ks kt lo kv kw kx lp kz la lb lq ld le lf lg im bi translated">最新的 Python 可视化支持完善了 Power BI 中对 Python 的支持，使您能够使用 Python 脚本来准备数据集，在 Power BI 桌面中应用复杂的分析或机器学习，然后使用数百个开源 Python 可视化包中的任何一个在 Power BI 报告中绘制结果。</p><p id="a536" class="pw-post-body-paragraph ki kj it kl b km kn ko kp kq kr ks kt lo kv kw kx lp kz la lb lq ld le lf lg im bi translated">这种视觉效果随着报告中的交叉筛选而更新，并且可以与 DAX 功能相结合。这是一个强大的组合，它允许我们通过增加交互性来充分利用数据。</p><h1 id="6ddf" class="lr ls it bd lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo bi translated"><strong class="ak">在 PowerBI 报告中创建 Python 视觉效果</strong></h1><p id="7a88" class="pw-post-body-paragraph ki kj it kl b km mp ko kp kq mq ks kt lo mr kw kx lp ms la lb lq mt le lf lg im bi translated">可以通过从 Power BI Desktop 的 Visualizations 窗格中选择 Python 可视化图标来添加 Python 可视化，这会将占位符 Python 脚本添加到报表中。</p><figure class="mv mw mx my gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mu"><img src="../Images/13a0a4645d22feb07699a120d02abb6c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Hvr9CUvSfaBix74cpqN4mw.jpeg"/></div></div></figure><p id="e2e3" class="pw-post-body-paragraph ki kj it kl b km kn ko kp kq kr ks kt lo kv kw kx lp kz la lb lq ld le lf lg im bi translated">必填字段可以从我们正在处理的数据集中添加到值窗格中，这在内部创建了一个 Pandas 数据框架。然后，我们可以使用 Matplotlib 和 Seaborn 等库编写自定义脚本来创建视觉效果。</p><p id="3a03" class="pw-post-body-paragraph ki kj it kl b km kn ko kp kq kr ks kt lo kv kw kx lp kz la lb lq ld le lf lg im bi translated">本机 PowerBI 功能(如切片器、过滤器)可以在 python 可视化工具之上使用，以根据需要进行选择。视觉效果会动态更新。</p><h1 id="e93e" class="lr ls it bd lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo bi translated"><strong class="ak">创建径向条形图以可视化 IMdB 2016 电影数据集</strong></h1><p id="b131" class="pw-post-body-paragraph ki kj it kl b km mp ko kp kq mq ks kt lo mr kw kx lp ms la lb lq mt le lf lg im bi translated">这里有一个小教程，教你如何用 python 创建一个自定义的视觉效果，并添加切片器，让你对数据背后的故事有一个交互式的视觉体验。</p><figure class="mv mw mx my gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mz"><img src="../Images/e2ce2ea54955852b9a19fc96d2b6f2c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BFX_M5mthXfu9WYFdloRVQ.jpeg"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk">IMdB 2016 movie database</figcaption></figure><p id="80c1" class="pw-post-body-paragraph ki kj it kl b km kn ko kp kq kr ks kt lo kv kw kx lp kz la lb lq ld le lf lg im bi translated">该数据集由 2016 年 IMdB 评分为 6 分或更高的电影列表以及属性-预算、总收入、类型和分数组成。<br/>这个数据集在 IMdB 和 kaggle 等其他地方公开。</p><p id="a1bb" class="pw-post-body-paragraph ki kj it kl b km kn ko kp kq kr ks kt lo kv kw kx lp kz la lb lq ld le lf lg im bi translated">使用 Matplotlib 在脚本中添加了一个自定义的径向条形图。它根据所应用的选择/过滤器动态地从数据帧中获取值。</p><figure class="mv mw mx my gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi na"><img src="../Images/e21141d473a2d6e9215c444b2b52f6d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*_mUDw4Zc5qjFA5J9GMKuXg.gif"/></div></div></figure><p id="8318" class="pw-post-body-paragraph ki kj it kl b km kn ko kp kq kr ks kt lo kv kw kx lp kz la lb lq ld le lf lg im bi translated">用于选择流派、国家和分数范围的切片器直接添加到 PowerBI 中，并显示所选集的平均分数和总收藏数等指标。这使我们能够全面地探索数据，并根据需要做出推论。</p></div><div class="ab cl lh li hx lj" role="separator"><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm"/></div><div class="im in io ip iq"><p id="4e6c" class="pw-post-body-paragraph ki kj it kl b km kn ko kp kq kr ks kt lo kv kw kx lp kz la lb lq ld le lf lg im bi translated">代码片段:</p><pre class="mv mw mx my gt nb nc nd ne aw nf bi"><span id="2c27" class="ng ls it nc b gy nh ni l nj nk"># Import the libraries<br/>from matplotlib import pyplot as plt<br/>import numpy as np</span><span id="d689" class="ng ls it nc b gy nl ni l nj nk">dataset.sort_values('genre', inplace=True) </span><span id="97b5" class="ng ls it nc b gy nl ni l nj nk"># Creating values (budget amount) for the bars<br/>iN = len(dataset)<br/>arrCnts = dataset['budget']/10000000</span><span id="d9d5" class="ng ls it nc b gy nl ni l nj nk">theta=np.arange(0,2*np.pi,2*np.pi/iN)<br/>width = (2*np.pi)/iN *0.9 </span><span id="0df2" class="ng ls it nc b gy nl ni l nj nk"># Plot size and proportions<br/>fig = plt.figure(figsize=(20,18),frameon=False,dpi=200)<br/><br/># Adding radial axes<br/>ax = fig.add_axes([0.05, 0.05, 0.9, 0.9], polar=True)<br/>bars = ax.bar(theta, arrCnts, width=width, bottom=15,color=dataset['Col'],alpha=0.65,edgecolor='yellow')<br/>ax.set_xticks(theta)<br/>plt.axis('off')<br/>plt.subplots_adjust(left=0.1, right=0.9, top=0.9, bottom=0.1)<br/><br/>bottom = 15<br/>rotations = np.rad2deg(theta)<br/>y0,y1 = ax.get_ylim()<br/><br/># Adding radial tags<br/>for x, bar, rotation, label in zip(theta, bars, rotations, dataset['name']):<br/>    offset = (bottom+bar.get_height())/(y1-y0)<br/>    lab = ax.text(0, 0, label, transform=None, <br/>             ha='center', va='center',alpha=0.5)<br/>    renderer = ax.figure.canvas.get_renderer()<br/>    bbox = lab.get_window_extent(renderer=renderer)<br/>    invb = ax.transData.inverted().transform([[0,0],[bbox.width,0] ])<br/>    lab.set_position((x,offset+(invb[1][0]-invb[0][0])/2.*2.7 ) )<br/>    lab.set_transform(ax.get_xaxis_transform())<br/>    lab.set_rotation(rotation) <br/><br/>fig.tight_layout()<br/>plt.show()</span><span id="a95c" class="ng ls it nc b gy nl ni l nj nk">---<br/>This code should be pasted in the script and the visual must be updated.</span></pre><p id="de15" class="pw-post-body-paragraph ki kj it kl b km kn ko kp kq kr ks kt lo kv kw kx lp kz la lb lq ld le lf lg im bi translated">python 支持的这一扩展作为一个强大的分析框架带来了许多可能性，无论是使用高级 python 库制作高级视觉效果还是复杂的机器学习算法，从而使 PowerBI 成为数据科学领域的必备工具。</p><p id="05c2" class="pw-post-body-paragraph ki kj it kl b km kn ko kp kq kr ks kt lo kv kw kx lp kz la lb lq ld le lf lg im bi translated">看看我下一篇关于如何在 PowerBI 中制作直方图的博客吧！</p><p id="df36" class="pw-post-body-paragraph ki kj it kl b km kn ko kp kq kr ks kt lo kv kw kx lp kz la lb lq ld le lf lg im bi translated"><a class="ae nm" href="https://sriharipramod.medium.com/advanced-python-visualizations-in-powerbi-histograms-and-frequency-plots-66f238684011" rel="noopener">https://sriharipramod . medium . com/advanced-python-visualizations-in-power bi-histograms-and-frequency-plots-66f 238684011</a></p></div><div class="ab cl lh li hx lj" role="separator"><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm"/></div><div class="im in io ip iq"><blockquote class="kf kg kh"><p id="00aa" class="ki kj kk kl b km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg im bi translated">关于作者<br/>斯里哈里·普拉莫德</p></blockquote><p id="be00" class="pw-post-body-paragraph ki kj it kl b km kn ko kp kq kr ks kt lo kv kw kx lp kz la lb lq ld le lf lg im bi translated">从事人工智能产品和建筑技术的数据分析和决策科学专家。印度海得拉巴。</p><p id="8e49" class="pw-post-body-paragraph ki kj it kl b km kn ko kp kq kr ks kt lo kv kw kx lp kz la lb lq ld le lf lg im bi translated"><a class="ae nm" href="https://www.linkedin.com/in/sriharipramod/" rel="noopener ugc nofollow" target="_blank">https://www.linkedin.com/in/sriharipramod/</a></p></div></div>    
</body>
</html>