<html>
<head>
<title>Guide on AWS Textract set-up</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">AWS Textract 设置指南</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/guide-on-aws-textract-set-up-8cddb8a3b3a3?source=collection_archive---------9-----------------------#2019-11-02">https://towardsdatascience.com/guide-on-aws-textract-set-up-8cddb8a3b3a3?source=collection_archive---------9-----------------------#2019-11-02</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="0705" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如何使用 AWS 的 OCR 即服务准确处理 PDF 文件</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/372c173a341b527350aa227ee6c29734.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*DKV_DfjOnb5rwSMI"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk">Photo by <a class="ae le" href="https://unsplash.com/@raphaelphotoch?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Raphael Schaller</a> on <a class="ae le" href="https://unsplash.com/?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h2 id="1b40" class="lf lg it bd lh li lj dn lk ll lm dp ln kb lo lp lq kf lr ls lt kj lu lv lw lx bi translated">异步 API 响应</h2><p id="8307" class="pw-post-body-paragraph jq jr it js b jt ly jv jw jx lz jz ka kb ma kd ke kf mb kh ki kj mc kl km kn im bi translated">最近，异步 API 响应的新范例变得非常突出。它通过返回 Job-ID 而不是 API 响应来工作。然后，为了检查状态，用户需要使用作业 ID 向 API 提交第二次调用。这里有一个很好的指南。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi md"><img src="../Images/3c856da536ac391eb716518b931159ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*T7xk-bz9GblFT6aQNkwiYQ.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk"><a class="ae le" href="https://smirnov-am.github.io/background-jobs-with-flask/" rel="noopener ugc nofollow" target="_blank">Sync vs. Async API responses in Flask</a></figcaption></figure><p id="ea11" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">异步 API 响应通常用于重量级机器学习应用程序或移动大量数据的应用程序，即任何需要花费很长时间才能将结果同步返回给用户的应用程序。</p><p id="f0f4" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">AWS Textract 可以检测和分析 PDF 格式的多页文档中的文本。Textract 对其 API 使用异步响应。在后台，每个 PDF 被分成单页格式并发送到处理引擎，以便每个页面可以独立于 PDF 文档进行处理，并且系统可以水平扩展。此外，异步操作允许用户提交超过 1，000 页的 PDF 文件进行处理，并在稍后返回以检查结果，而不是等待请求。</p><h2 id="e0db" class="lf lg it bd lh li lj dn lk ll lm dp ln kb lo lp lq kf lr ls lt kj lu lv lw lx bi translated">在 EC2 上使用 Python 设置 Textract 的分步说明</h2><p id="232b" class="pw-post-body-paragraph jq jr it js b jt ly jv jw jx lz jz ka kb ma kd ke kf mb kh ki kj mc kl km kn im bi translated">让我们来看一下设置 EC2 机器来用 Python 调用 Textract 所需的步骤:</p><p id="0245" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu"> 1 — </strong>设置一个 AWS 角色从 EC2 实例访问 Amazon Textract。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi me"><img src="../Images/96fdcda70366718062d2a45db2cf8f70.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gAF8CquTf0RXDaRApashnQ.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk">Create a role for an EC2 in IAM</figcaption></figure><p id="92da" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu"> a) </strong>在<strong class="js iu">创建角色</strong>页面上，将使用该角色的服务—选择<strong class="js iu"> EC2 </strong>并转到下一步:权限</p><p id="4f7b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu"> b) </strong>我们将需要授予以下 4 个权限来设置 text ract—AmazonTextractFullAccess<br/>amazonsreadonlyaccess<br/>amazonsfnfullaccess<br/>AmazonSQSFullAccess</p><p id="495e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">(一旦设置了 SNS、SQS 和 Textract 配置，您可能需要降低访问权限)</p><p id="0fcb" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu"> c) </strong>跳过<strong class="js iu">标签</strong>，进入<strong class="js iu">审核</strong>。称之为爽快的东西。</p><p id="a7f1" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu"> d) </strong>转到<strong class="js iu"> EC2 </strong>页面，在<strong class="js iu">实例</strong>下选择将调用 Textract 的机器，并附加您从<strong class="js iu"> a) </strong>创建的角色，如下图所示</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi mf"><img src="../Images/f82378d474b737d87a9d6d62c46eed45.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RH6pvoi_rONOjQVVb-ezNg.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk">Associate newly created role with an EC2 Instance</figcaption></figure><p id="d11a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu"> 2 — </strong>登录到您添加了角色的 EC2 机器，安装 Python-boto 3 所需的 AWS SDK</p><pre class="kp kq kr ks gt mg mh mi mj aw mk bi"><span id="fd2c" class="lf lg it mh b gy ml mm l mn mo">&gt; pip install boto3</span></pre><p id="f57c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu"> 3 — </strong>创建一个 IAM 服务角色，授予 Amazon Textract 访问您的 Amazon SNS 主题的权限。这将允许 Textract 在文件分析完成时通知您。<br/>参见<a class="ae le" href="https://docs.aws.amazon.com/textract/latest/dg/api-async-roles.html#api-async-roles-all-topics" rel="noopener ugc nofollow" target="_blank"> <strong class="js iu">授予亚马逊 Textract 访问您的亚马逊社交网络主题</strong> </a>的详细访问权限。<strong class="js iu">保存服务角色的亚马逊资源名称(ARN) </strong>，因为您需要将它提供给 Textract。</p><p id="316e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">根据上述参考，您创建的角色将在策略声明中指出以下内容—</p><pre class="kp kq kr ks gt mg mh mi mj aw mk bi"><span id="ea4f" class="lf lg it mh b gy ml mm l mn mo">{<br/>  "Version": "2012-10-17",<br/>  "Statement": [<br/>    {<br/>      "Effect": "Allow",<br/>      "Principal": {<br/>        "Service": "ec2.amazonaws.com"<br/>      },<br/>      "Action": "sts:AssumeRole"<br/>    }<br/>  ]<br/>}</span></pre><p id="e009" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">你需要把它替换成—</p><pre class="kp kq kr ks gt mg mh mi mj aw mk bi"><span id="fdc5" class="lf lg it mh b gy ml mm l mn mo">{<br/>  "Version": "2012-10-17",<br/>  "Statement": [<br/>    {<br/>      "Effect": "Allow",<br/>      "Principal": {<br/>        "Service": "textract.amazonaws.com"<br/>      },<br/>      "Action": "sts:AssumeRole"<br/>    }<br/>  ]<br/>}</span></pre><p id="fd0d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu"> 4 — </strong>在 EC2 实例中运行以下代码，使用 Textract 分析 pdf。pdf 必须位于您的 S3 存储桶中。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="mp mq l"/></div></figure><h2 id="59d2" class="lf lg it bd lh li lj dn lk ll lm dp ln kb lo lp lq kf lr ls lt kj lu lv lw lx bi translated">结论</h2><p id="97de" class="pw-post-body-paragraph jq jr it js b jt ly jv jw jx lz jz ka kb ma kd ke kf mb kh ki kj mc kl km kn im bi translated">我们已经通过上面提供的代码介绍了如何在您的 S3 中的图像和 pdf 上使用 AWS Textract。</p><p id="c195" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">设置 Textract 有点复杂，但是如果您查看一下代码，就会明白为什么会这样。该代码创建了一个新的 SQS 队列和一个新的 SNS 主题，并为该队列订阅了我们创建的主题。</p><p id="2a5d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">接下来，在代码中，我们指示要处理的所需 PDF 的 Textract 位置，以及进行通信的 SNS 通道。</p></div></div>    
</body>
</html>