<html>
<head>
<title>An Easy Introduction to Generative Adversarial Networks in Deep Learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">深度学习中生成对抗网络的简单介绍</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/an-easy-introduction-to-generative-adversarial-networks-6f8498dc4bcd?source=collection_archive---------10-----------------------#2019-09-14">https://towardsdatascience.com/an-easy-introduction-to-generative-adversarial-networks-6f8498dc4bcd?source=collection_archive---------10-----------------------#2019-09-14</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="8f16" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">了解深度学习最强大的网络！</h2></div><blockquote class="ki kj kk"><p id="a8a5" class="kl km kn ko b kp kq ju kr ks kt jx ku kv kw kx ky kz la lb lc ld le lf lg lh im bi translated">想获得灵感？快来加入我的<a class="ae li" href="https://www.superquotes.co/?utm_source=mediumtech&amp;utm_medium=web&amp;utm_campaign=sharing" rel="noopener ugc nofollow" target="_blank"> <strong class="ko iu">超级行情快讯</strong> </a>。😎</p></blockquote><p id="7546" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku lj kw kx ky lk la lb lc ll le lf lg lh im bi translated"><a class="ae li" href="https://en.wikipedia.org/wiki/Generative_adversarial_network" rel="noopener ugc nofollow" target="_blank">生成对抗网络</a> (GANs)是一种神经网络架构，能够自行生成新数据。对这些 gan 的研究是深度学习中的热门话题，因为它们的力量。短短几年间，他们已经从生成模糊的数字发展到创造照片般逼真的人脸图像。</p><div class="lm ln lo lp gt ab cb"><figure class="lq lr ls lt lu lv lw paragraph-image"><div role="button" tabindex="0" class="lx ly di lz bf ma"><img src="../Images/4e3cc52a8e5cc42fe7f1aedcc191c557.png" data-original-src="https://miro.medium.com/v2/resize:fit:1046/format:webp/1*Ft2rLuO82eItlvJn5HOi9A.png"/></div></figure><figure class="lq lr md lt lu lv lw paragraph-image"><div role="button" tabindex="0" class="lx ly di lz bf ma"><img src="../Images/3e9f32ed5dfbf913117c62993471cee2.png" data-original-src="https://miro.medium.com/v2/resize:fit:956/format:webp/1*Y6HV-aLIcsGIzBsmvyix0A.jpeg"/></div></figure></div><h1 id="2d0e" class="me mf it bd mg mh mi mj mk ml mm mn mo jz mp ka mq kc mr kd ms kf mt kg mu mv bi translated">GANs 如何工作</h1><p id="9c5b" class="pw-post-body-paragraph kl km it ko b kp mw ju kr ks mx jx ku lj my kx ky lk mz lb lc ll na lf lg lh im bi translated">生成对抗网络(gan)被分类在<a class="ae li" href="https://en.wikipedia.org/wiki/Generative_model" rel="noopener ugc nofollow" target="_blank">生成模型</a>组中。这意味着它们能够生成全新的“有效”数据。所谓有效数据，我们的意思是网络的输出应该是我们认为目标可以接受的。</p><p id="a11a" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku lj kw kx ky lk la lb lc ll le lf lg lh im bi translated">为了说明，考虑一个例子，其中我们希望生成一些新图像来训练一个<a class="ae li" href="http://cs231n.github.io/classification/" rel="noopener ugc nofollow" target="_blank">图像分类</a>网络。当然，对于这样的应用程序，我们希望我们的训练数据尽可能真实，也许在风格上与其他图像分类训练数据集非常相似。</p><p id="6261" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku lj kw kx ky lk la lb lc ll le lf lg lh im bi translated">下图显示了 GAN 生成的一组图像的示例。它们看起来很真实！如果我们没有被告知它们是计算机生成的，我们可能真的会相信这些是人类收集的！</p><figure class="lm ln lo lp gt lr gh gi paragraph-image"><div role="button" tabindex="0" class="lx ly di lz bf ma"><div class="gh gi nb"><img src="../Images/ea6d50c27877f6fd4f352e2d481d9ffa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*F-c9sW_CVqYCgnea.png"/></div></div><figcaption class="nc nd gj gh gi ne nf bd b be z dk">An example output of Progressive GANs. <a class="ae li" href="https://arxiv.org/pdf/1710.10196.pdf" rel="noopener ugc nofollow" target="_blank">Source</a></figcaption></figure><p id="9691" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku lj kw kx ky lk la lb lc ll le lf lg lh im bi translated">为此，gan 由两个独立的<em class="kn">反向</em>网络组成:发生器<em class="kn">和鉴别器</em>。当仅给定噪声图像阵列作为输入时，生成器被训练来创建看起来逼真的图像。鉴别器被训练来分类图像是否是真实的。</p><p id="de07" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku lj kw kx ky lk la lb lc ll le lf lg lh im bi translated">GANs 的真正力量来自他们所遵循的对抗训练风格。基于鉴别器的损耗学习发电机网络的权重。因此，生成器被推动以这样一种方式训练，即对于它生成的图像，很难辨别它们是否真实。在这些图像看起来越来越真实的同时，鉴别器也越来越好地分辨出哪些图像是真实的，不管肉眼看起来有多相似。</p><p id="a82e" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku lj kw kx ky lk la lb lc ll le lf lg lh im bi translated">从技术角度来说，鉴别器的损失将是对哪些图像是假的，哪些是真的进行分类的误差；我们正在测量它辨别真假图像的能力。发生器损耗将基于其利用假图像“愚弄”鉴别器的能力——即鉴别器对假图像的分类误差仅在假图像上出现，因为发生器希望该误差尽可能高。</p><p id="d6e8" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku lj kw kx ky lk la lb lc ll le lf lg lh im bi translated">因此，GANs 建立了一种反馈回路，发电机帮助训练鉴别器，鉴别器帮助训练发电机。他们一起变得更好。下图有助于说明这一点。</p><figure class="lm ln lo lp gt lr gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/59823a759d5782b1e370a281e9e69af3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1312/format:webp/0*lqFgGDXdnusZwd9v.png"/></div><figcaption class="nc nd gj gh gi ne nf bd b be z dk">An illustration of the structure of a Generative Adversarial Network</figcaption></figure><h1 id="67e4" class="me mf it bd mg mh mi mj mk ml mm mn mo jz mp ka mq kc mr kd ms kf mt kg mu mv bi translated">训练 GAN 在 Pytorch 中生成数字</h1><p id="c19d" class="pw-post-body-paragraph kl km it ko b kp mw ju kr ks mx jx ku lj my kx ky lk mz lb lc ll na lf lg lh im bi translated">现在我们将通过一个例子来说明如何在 Pytorch 中构建和训练我们自己的 GAN！<a class="ae li" href="https://en.wikipedia.org/wiki/MNIST_database" rel="noopener ugc nofollow" target="_blank"> MNIST 数据集</a>包含 60，000 张黑白数字的训练图像，范围从 1 到 9，其中每张图像的大小为 28x28。它非常适合我们的用例，因为它仍然非常常用于机器学习概念验证，并且是一个成熟的集合。</p><figure class="lm ln lo lp gt lr gh gi paragraph-image"><div role="button" tabindex="0" class="lx ly di lz bf ma"><div class="gh gi nh"><img src="../Images/df281a2c61fdc0248bcac0108e311714.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*O35lwO5O4sK0_9GuE5aG0A.png"/></div></div><figcaption class="nc nd gj gh gi ne nf bd b be z dk">Part of the MNIST dataset. <a class="ae li" href="https://www.researchgate.net/figure/A-subset-of-the-MNIST-database-of-handwritten-digits_fig4_232650721" rel="noopener ugc nofollow" target="_blank">Source</a></figcaption></figure><p id="c9ff" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku lj kw kx ky lk la lb lc ll le lf lg lh im bi translated">我们将从我们的进口开始。我们只需要 Pytorch 的东西！</p><figure class="lm ln lo lp gt lr"><div class="bz fp l di"><div class="ni nj l"/></div></figure><p id="7c61" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku lj kw kx ky lk la lb lc ll le lf lg lh im bi translated">接下来，我们将为训练数据准备我们的<em class="kn">数据加载器</em>。记住，我们要为 MNIST 生成随机数，即从 0 到 9。因此，我们需要为这 10 位数字设置标签。</p><figure class="lm ln lo lp gt lr"><div class="bz fp l di"><div class="ni nj l"/></div></figure><p id="01bc" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku lj kw kx ky lk la lb lc ll le lf lg lh im bi translated">现在我们可以建立我们的网络。我们从下面的鉴频器网络开始。回想一下，鉴别器网络对图像是否真实进行分类，这是一个图像分类网络。因此，我们的输入是一个标准 MNIST 大小的图像:28x28 像素。我们将该图像展平成长度为 784 的单个向量。输出是一个单一值，表示图像是否是一个真正的 MNIST 数字。</p><figure class="lm ln lo lp gt lr"><div class="bz fp l di"><div class="ni nj l"/></div></figure><p id="ee90" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku lj kw kx ky lk la lb lc ll le lf lg lh im bi translated">现在来看看下面的发电机。发生器网络负责创建实际的图像——它可以从纯噪声输入中做到这一点！对于本例，我们将让发生器从一个长度为 100 的向量开始，这也是一个纯粹的随机噪声。从这个向量，我们的生成器将输出一个长度为 784 的向量，稍后我们可以将它整形为标准的 MNIST 28x28 像素。</p><figure class="lm ln lo lp gt lr"><div class="bz fp l di"><div class="ni nj l"/></div></figure><p id="3237" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku lj kw kx ky lk la lb lc ll le lf lg lh im bi translated">要设置我们的培训，我们需要一些东西:</p><ul class=""><li id="70dd" class="nk nl it ko b kp kq ks kt lj nm lk nn ll no lh np nq nr ns bi translated">损失函数</li><li id="6f41" class="nk nl it ko b kp nt ks nu lj nv lk nw ll nx lh np nq nr ns bi translated">每个网络的优化器</li><li id="a656" class="nk nl it ko b kp nt ks nu lj nv lk nw ll nx lh np nq nr ns bi translated">时代数</li><li id="51ef" class="nk nl it ko b kp nt ks nu lj nv lk nw ll nx lh np nq nr ns bi translated">批次数量</li></ul><p id="2fb1" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku lj kw kx ky lk la lb lc ll le lf lg lh im bi translated">Pytorch 还要求，如果我们希望我们的网络在 GPU 上运行，我们必须显式地将模型移到它上面。所有代码如下所示。</p><figure class="lm ln lo lp gt lr"><div class="bz fp l di"><div class="ni nj l"/></div></figure><p id="9404" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku lj kw kx ky lk la lb lc ll le lf lg lh im bi translated">现在是我们的训练循环。Pytorch 中的训练循环通常由遍历历元的外循环和遍历批数据的内循环组成。训练 gan 的关键部分是我们需要在一个循环中更新生成器和鉴别器。查看下面的代码来训练 GAN 和 Pytorch。这些步骤在代码下面有更详细的描述。</p><figure class="lm ln lo lp gt lr"><div class="bz fp l di"><div class="ni nj l"/></div></figure><p id="855c" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku lj kw kx ky lk la lb lc ll le lf lg lh im bi translated">(1)我们开始为鉴别器准备我们的*真实*图像数据。输入是一批真实的 MNIST 图像。输出是全 1 的向量，因为 1 表示图像是真实的。</p><p id="2ec4" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku lj kw kx ky lk la lb lc ll le lf lg lh im bi translated">(2)接下来，我们将为生成器准备输入向量，这样我们就可以生成假图像。回想一下，我们的生成器网络采用长度为 100 的输入向量，所以这就是我们在这里创建的。images.size(0)表示批量大小</p><p id="3f53" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku lj kw kx ky lk la lb lc ll le lf lg lh im bi translated">(3)根据我们在步骤(2)中创建的随机噪声数据向量，我们可以绕过向量到生成器来生成我们的伪图像数据。这将与我们在步骤 1 中获得的真实数据结合使用，以训练鉴别器。还要注意，这一次我们的标签向量全是零，因为 0 代表假图像的类别标签。</p><p id="f5e7" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku lj kw kx ky lk la lb lc ll le lf lg lh im bi translated">(4)给定伪图像和真实图像以及它们的标签，我们可以训练我们的鉴别器进行分类。总损失将是伪图像的损失+真实图像的损失</p><p id="2a82" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku lj kw kx ky lk la lb lc ll le lf lg lh im bi translated">(5)现在我们的鉴别器已经更新，我们可以使用它来进行预测。这些预测的损失将通过发生器反向传播，使得发生器的权重根据它欺骗鉴别器的程度而被特别更新。<br/> (5a)生成一些伪图像在<br/> (5b)使用鉴别器对该批伪图像进行预测并保存输出。</p><p id="f045" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku lj kw kx ky lk la lb lc ll le lf lg lh im bi translated">(6)使用来自鉴别器的预测，我们训练我们的生成器。请注意，我们使用全 1 的 _real_labels_ 作为目标，因为我们的生成器的目标是创建看起来真实并且预测为 1 的图像！因此，发生器丢失 0 将对应于鉴别器预测全 1。</p><p id="e1aa" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku lj kw kx ky lk la lb lc ll le lf lg lh im bi translated">瞧啊。这就是我们训练 GAN 生成 MNIST 图像的全部代码！你需要做的就是安装 Pytorch 来运行它。查看下面的 gif，查看 40 多个时期生成的图像的输出！</p><figure class="lm ln lo lp gt lr gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/ea9f647a7ed904ce5996aa6794653b6a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/1*spG1L-v4ZCOOw3fFTM14lg.gif"/></div></figure></div><div class="ab cl nz oa hx ob" role="separator"><span class="oc bw bk od oe of"/><span class="oc bw bk od oe of"/><span class="oc bw bk od oe"/></div><div class="im in io ip iq"><h1 id="f1d9" class="me mf it bd mg mh og mj mk ml oh mn mo jz oi ka mq kc oj kd ms kf ok kg mu mv bi translated">喜欢学习？</h1><p id="5d01" class="pw-post-body-paragraph kl km it ko b kp mw ju kr ks mx jx ku lj my kx ky lk mz lb lc ll na lf lg lh im bi translated">在<a class="ae li" href="https://twitter.com/GeorgeSeif94" rel="noopener ugc nofollow" target="_blank">推特</a>上关注我，我会在那里发布所有最新最棒的人工智能、技术和科学！也在<a class="ae li" href="https://www.linkedin.com/in/georgeseif/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>上和我联系吧！</p></div></div>    
</body>
</html>