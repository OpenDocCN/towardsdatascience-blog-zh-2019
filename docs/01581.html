<html>
<head>
<title>Black-box vs. white-box models</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">黑盒与白盒模型</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/machine-learning-interpretability-techniques-662c723454f3?source=collection_archive---------4-----------------------#2019-03-14">https://towardsdatascience.com/machine-learning-interpretability-techniques-662c723454f3?source=collection_archive---------4-----------------------#2019-03-14</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="2ea7" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">大多数机器学习系统需要能够<em class="ko">向利益相关者解释</em>为什么做出某些预测。在选择合适的机器学习模型时，我们通常会在准确性和可解释性之间进行权衡:</p><ul class=""><li id="0660" class="kp kq it js b jt ju jx jy kb kr kf ks kj kt kn ku kv kw kx bi translated"><strong class="js iu">精确和“黑箱”:</strong> <br/>神经网络、梯度推进模型或复杂集成等黑箱模型通常可以提供很高的精确度。这些模型的内部工作更难理解，它们不能提供对模型预测中每个特征的重要性的估计，也不容易理解不同特征如何相互作用。</li><li id="0c66" class="kp kq it js b jt ky jx kz kb la kf lb kj lc kn ku kv kw kx bi translated"><strong class="js iu">较弱的“白盒”:</strong> <br/>另一方面，线性回归和决策树等较简单的模型提供的预测能力较低，并且不总是能够模拟数据集的内在复杂性(即特征相互作用)。然而，它们更容易解释和诠释。</li></ul><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi ld"><img src="../Images/7e0a0014798987e5373658ffa1cfb0d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*FfwEUfmFFFmbnAfo.png"/></div></div><figcaption class="lp lq gj gh gi lr ls bd b be z dk">Image from <a class="ae lt" href="https://blog.applied.ai/bayesian-inference-with-pymc3-part-1/" rel="noopener ugc nofollow" target="_blank">Applied.AI</a></figcaption></figure><p id="b503" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">准确性与可解释性的权衡基于一个重要的假设，即<em class="ko"/><a class="ae lt" href="https://www.inference.vc/accuracy-vs-explainability-in-machine-learning-models-nips-workshop-poster-review/" rel="noopener ugc nofollow" target="_blank"><em class="ko">‘可解释性是模型的固有属性’</em></a><em class="ko">。然而，我坚信，通过正确的“可解释性技术”，任何机器学习模型都可以变得更具可解释性，尽管有些模型的复杂性和成本要高于其他模型。</em></p><p id="6ce1" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在这篇博文中，我将讨论一些可用于解释机器学习模型的不同技术。这篇博文的结构和内容高度基于<a class="ae lt" href="http://docs.h2o.ai/driverless-ai/latest-stable/docs/booklets/MLIBooklet.pdf" rel="noopener ugc nofollow" target="_blank"> H20.ai 关于机器学习可解释性的小册子</a>。如果你想了解更多，我强烈推荐大家阅读帕特里克·霍尔的 H20.ai 小册子或其他材料！</p><h1 id="cc50" class="lu lv it bd lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr bi translated">模型属性</h1><p id="79d0" class="pw-post-body-paragraph jq jr it js b jt ms jv jw jx mt jz ka kb mu kd ke kf mv kh ki kj mw kl km kn im bi translated">模型的可解释程度通常与响应函数的两个属性有关。模型的响应函数<em class="ko"> f(x) </em>定义了模型的输入(特征<em class="ko"> x </em>)和输出(目标<em class="ko"> f(x) </em>)之间的输入输出关系。根据机器学习模型，该函数具有以下特征:</p><ul class=""><li id="292a" class="kp kq it js b jt ju jx jy kb kr kf ks kj kt kn ku kv kw kx bi translated">线性:在线性响应函数中，特征和目标之间的关联表现为线性。如果一个特性线性变化，我们也期望目标以相似的速率线性变化。</li><li id="9d13" class="kp kq it js b jt ky jx kz kb la kf lb kj lc kn ku kv kw kx bi translated">单调性:在单调响应函数中，特征和目标之间的关系在特征上总是在一个方向上(增加或减少)。更重要的是，这种关系适用于整个特征域，并且独立于其他特征变量。</li></ul><figure class="le lf lg lh gt li gh gi paragraph-image"><div class="gh gi mx"><img src="../Images/555806bd2f87174da1c4af13d6873166.png" data-original-src="https://miro.medium.com/v2/resize:fit:964/format:webp/0*fI7pb6VEQH9OzUfD.png"/></div><figcaption class="lp lq gj gh gi lr ls bd b be z dk">An example of a simple linear and monotic response function (1 input variable x, 1 response variable y)</figcaption></figure><p id="cdc9" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">线性和单调函数的例子是例如线性回归模型，而例如随机森林和神经网络是展示高度非线性和非单调响应函数的模型的例子。</p><p id="426d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">由 Patrick Hall 制作的下一张幻灯片说明了为什么在需要清晰简单的模型解释时，白盒模型(具有线性和单调函数)通常是首选。顶部的图显示，随着年龄的增长，购买次数也在增加。响应函数在全局水平上具有线性和单调的关系，容易被所有利益相关者解释。</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi my"><img src="../Images/aa6b8b8f12c6f2f63e8cebe2643376b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mQrflDpiwvcx7kYDX15feg.png"/></div></div></figure><p id="3b46" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">然而，由于白盒模型的线性和单调约束，错过了趋势的很大一部分。通过探索更复杂的机器学习模型，有可能更好地拟合观察到的数据，尽管响应函数在局部水平上只是线性和单调的。为了解释模型的行为，有必要在本地级别研究模型。</p><p id="fc39" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">模型可解释性的范围，即在全球或地方一级，与模型的复杂性有内在联系。线性模型在整个特征空间表现出相同的行为(如顶部图所示)，因此它们是全局可解释的。输入和输出之间的关系通常受限于复杂性和局部解释(即，为什么一个模型在某个数据点做出某个预测？)默认为全局解释。</p><p id="ead4" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">对于更复杂的模型，模型的全局行为更难定义，需要对响应函数的小区域进行局部解释。这些小区域更有可能表现为线性和单调的，从而实现更准确的解释。</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi mz"><img src="../Images/e8e774dcda6cd2133fbca96b2b4aa40b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*IxgLE9lxTXzPVmmP.png"/></div></div><figcaption class="lp lq gj gh gi lr ls bd b be z dk">ML libraries (e.g. sk-learn) allow quick comparisons between different classifiers. When the dataset is limited in size and dimensionality, it is possible to interpret the results. In most real-life problems this is not the case anymore.</figcaption></figure><p id="010c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在这篇博文的剩余部分，我将关注两个模型无关的技术，它们提供了全局和局部的解释。这些技术可以应用于任何机器学习算法，并且它们通过分析机器学习模型的响应函数来实现可解释性。</p><h1 id="4e6f" class="lu lv it bd lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr bi translated">可解释性技术</h1><h2 id="eee2" class="na lv it bd lw nb nc dn ma nd ne dp me kb nf ng mi kf nh ni mm kj nj nk mq nl bi translated">代理模型</h2><p id="433e" class="pw-post-body-paragraph jq jr it js b jt ms jv jw jx mt jz ka kb mu kd ke kf mv kh ki kj mw kl km kn im bi translated">代理模型是(通常更简单的)模型，用于解释更复杂的模型。线性模型和决策树模型由于其简单的解释而经常被使用。创建代理模型是为了表示复杂模型(响应函数)的决策过程，并且是基于输入和模型预测而不是输入和目标训练的模型。代理模型在非线性和非单调模型之上提供了一层全局可解释性，但不应完全依赖它们。代理模型不能完美地表示潜在的响应函数，也不能捕捉复杂的特征关系。它们主要作为一个模型的“全局总结”。以下步骤说明了如何为任何黑盒模型构建代理模型。</p><ol class=""><li id="a56d" class="kp kq it js b jt ju jx jy kb kr kf ks kj kt kn nm kv kw kx bi translated">训练一个黑盒模型。</li><li id="2226" class="kp kq it js b jt ky jx kz kb la kf lb kj lc kn nm kv kw kx bi translated">评估数据集上的黑盒模型。</li><li id="20ec" class="kp kq it js b jt ky jx kz kb la kf lb kj lc kn nm kv kw kx bi translated">选择一个可解释的代理模型(通常是线性模型或决策树)。</li><li id="a6d6" class="kp kq it js b jt ky jx kz kb la kf lb kj lc kn nm kv kw kx bi translated">对数据集及其预测训练可解释的模型。</li><li id="6565" class="kp kq it js b jt ky jx kz kb la kf lb kj lc kn nm kv kw kx bi translated">确定代理模型误差度量并解释代理模型。</li></ol><h2 id="9530" class="na lv it bd lw nb nc dn ma nd ne dp me kb nf ng mi kf nh ni mm kj nj nk mq nl bi translated">石灰</h2><p id="d6ba" class="pw-post-body-paragraph jq jr it js b jt ms jv jw jx mt jz ka kb mu kd ke kf mv kh ki kj mw kl km kn im bi translated">LIME 背后的一般思想与代理模型相同。然而，LIME 并不构建代表整个数据集的全局代理模型，而仅构建解释局部区域预测的局部代理模型(线性模型)。关于 LIME 更深入的解释可以在这篇关于 LIME 的<a class="ae lt" rel="noopener" target="_blank" href="/understanding-model-predictions-with-lime-a582fdff3a3b">博文中找到。</a> <br/> LIME 提供了一种直观的方式来解释给定数据点的模型预测。</p><p id="9b96" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">以下步骤说明了如何为任何黑盒模型构建 LIME 模型。</p><ol class=""><li id="0a4c" class="kp kq it js b jt ju jx jy kb kr kf ks kj kt kn nm kv kw kx bi translated">训练一个黑盒模型。</li><li id="c813" class="kp kq it js b jt ky jx kz kb la kf lb kj lc kn nm kv kw kx bi translated">感兴趣的局部区域的样本点。可以从数据集中检索点，也可以生成人工点。</li><li id="7ee5" class="kp kq it js b jt ky jx kz kb la kf lb kj lc kn nm kv kw kx bi translated">根据新样本与感兴趣区域的接近程度对其进行加权。将加权的、可解释的(替代)模型拟合到有变化的数据集上。</li><li id="cb95" class="kp kq it js b jt ky jx kz kb la kf lb kj lc kn nm kv kw kx bi translated">解释本地代理模型。</li></ol><h2 id="8b7e" class="na lv it bd lw nb nc dn ma nd ne dp me kb nf ng mi kf nh ni mm kj nj nk mq nl bi translated">结论</h2><p id="89ce" class="pw-post-body-paragraph jq jr it js b jt ms jv jw jx mt jz ka kb mu kd ke kf mv kh ki kj mw kl km kn im bi translated">有几种不同的技术可以用来提高机器学习模型的可解释性。尽管随着该领域的发展，这些技术变得越来越强大，但始终比较不同的技术是很重要的。我没有讨论的一个技巧是 Shapley 值。看看<a class="ae lt" href="https://christophm.github.io/interpretable-ml-book/" rel="noopener ugc nofollow" target="_blank"> Christoph Molnar 关于“可解释机器学习”的书</a>，了解更多关于这方面(以及其他)的技术！</p><p id="fe4c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果你对机器学习的可解释性有任何问题，我很乐意在评论中阅读。如果你想收到我博客上的更新，请在<a class="ae lt" href="https://medium.com/@lars.hulstaert" rel="noopener"> Medium </a>或<a class="ae lt" href="https://twitter.com/LarsHulstaert" rel="noopener ugc nofollow" target="_blank"> Twitter </a>上关注我！</p></div></div>    
</body>
</html>