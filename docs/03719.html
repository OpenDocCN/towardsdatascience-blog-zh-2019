<html>
<head>
<title>ML Study Jam — Vision API</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">ML Study Jam — Vision API</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/ml-study-jam-detect-labels-faces-and-landmarks-in-images-with-the-cloud-vision-api-a80e89feb66f?source=collection_archive---------21-----------------------#2019-06-12">https://towardsdatascience.com/ml-study-jam-detect-labels-faces-and-landmarks-in-images-with-the-cloud-vision-api-a80e89feb66f?source=collection_archive---------21-----------------------#2019-06-12</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="9d83" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用云视觉 API 检测图像中的标签、人脸和地标</h2></div><figure class="ki kj kk kl gt km"><div class="bz fp l di"><div class="kn ko l"/></div><figcaption class="kp kq gj gh gi kr ks bd b be z dk">AES, a Fortune 500 global power company, is using drones and AutoML Vision to accelerate a safer, greener energy future. Video from <a class="ae kt" href="https://cloud.google.com/vision/" rel="noopener ugc nofollow" target="_blank">Vision AI</a></figcaption></figure><p id="44ff" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">基本上，谷歌视觉人工智能可以分为两类，<code class="fe lq lr ls lt b">AutoML Vision</code>和<code class="fe lq lr ls lt b">Vision API</code>。AutoML Vision 是指通过上传图片来训练你自己定制的机器学习模型，用<a class="ae kt" href="https://cloud.google.com/automl/" rel="noopener ugc nofollow" target="_blank"> AutoML Vision </a>来训练模型。至于 Vision API，是 Google 提供的一个 API，带有预先训练好的模型，可以很容易地用在你正在构建的产品上。今天我们要介绍的是<code class="fe lq lr ls lt b">Vision API</code>。</p><p id="d0fd" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在我们开始之前，我想给你一个关于<strong class="kw iu">什么是云视觉 API 的基本概念？它能做什么？</strong></p><blockquote class="lu lv lw"><p id="7cee" class="ku kv lx kw b kx ky ju kz la lb jx lc ly le lf lg lz li lj lk ma lm ln lo lp im bi translated">Google Cloud 的 Vision API 通过 REST 和 RPC APIs 提供了强大的预训练机器学习模型。为图像分配标签，并快速将它们分类到数百万个预定义的类别中。检测物体和人脸，阅读印刷和手写文本，并将有价值的元数据构建到您的图像目录中。</p></blockquote><h2 id="7787" class="mb mc it bd md me mf dn mg mh mi dp mj ld mk ml mm lh mn mo mp ll mq mr ms mt bi translated"><a class="ae kt" href="https://cloud.google.com/vision/docs/drag-and-drop" rel="noopener ugc nofollow" target="_blank">谷歌云视觉——拖放</a></h2><p id="9f61" class="pw-post-body-paragraph ku kv it kw b kx mu ju kz la mv jx lc ld mw lf lg lh mx lj lk ll my ln lo lp im bi translated">点击上面的链接，亲自尝试一下 cloud Vision API。您可以看到它可以检测到什么，以及它将通过该网站返回什么样的 JSON 响应。</p><p id="9812" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们将把一些图像放入谷歌云视觉网站，看看会发生什么。</p><h2 id="640d" class="mb mc it bd md me mf dn mg mh mi dp mj ld mk ml mm lh mn mo mp ll mq mr ms mt bi translated">表面</h2><blockquote class="lu lv lw"><p id="3e8d" class="ku kv lx kw b kx ky ju kz la lb jx lc ly le lf lg lz li lj lk ma lm ln lo lp im bi translated"><strong class="kw iu">面部检测</strong>检测图像中的多张面部以及相关的关键面部属性，如情绪状态或<code class="fe lq lr ls lt b"><em class="it">wearing headwear</em></code>。<strong class="kw iu">不支持面部识别。</strong></p></blockquote><figure class="ki kj kk kl gt km gh gi paragraph-image"><div role="button" tabindex="0" class="na nb di nc bf nd"><div class="gh gi mz"><img src="../Images/30ca0ccdb7441b766f55e52b1c30ae7e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-BopbX_Cx1Ioh1Maw4QJZg.png"/></div></div><figcaption class="kp kq gj gh gi kr ks bd b be z dk">The movie poster is from <a class="ae kt" href="https://www.facebook.com/marvelstudios/" rel="noopener ugc nofollow" target="_blank">Marvel Studio</a></figcaption></figure><p id="e5eb" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">API 将为您提供面部的标志(演员面部的绿色圆点和区域)，每个圆点对应于 JSON 响应:</p><pre class="ki kj kk kl gt ng lt nh ni aw nj bi"><span id="46e9" class="mb mc it lt b gy nk nl l nm nn">"landmarkingConfidence": 0.5006456,<br/>      "landmarks": [<br/>        {<br/>          "position": {<br/>            "x": 402.5942,<br/>            "y": 91.294495,<br/>            "z": -0.00084796624<br/>          },<br/>          "type": "LEFT_EYE"<br/>        },<br/>        ...<br/>       ]</span></pre><p id="cd19" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">此外，它还会分析他们的情绪状态，如喜悦、悲伤、愤怒等。</p><pre class="ki kj kk kl gt ng lt nh ni aw nj bi"><span id="72a2" class="mb mc it lt b gy nk nl l nm nn">"faceAnnotations": [<br/>    {<br/>      "angerLikelihood": "VERY_UNLIKELY",<br/>      "blurredLikelihood": "VERY_UNLIKELY",<br/>      "boundingPoly": {<br/>        "vertices": [<br/>          {<br/>            "x": 354,<br/>            "y": 85<br/>          },<br/>          {<br/>            "x": 469,<br/>            "y": 85<br/>          },<br/>          {<br/>            "x": 469,<br/>            "y": 219<br/>          },<br/>          {<br/>            "x": 354,<br/>            "y": 219<br/>          }<br/>        ]<br/>      },<br/>      "detectionConfidence": 0.83385795,<br/>      "fdBoundingPoly": {<br/>        "vertices": [<br/>          {<br/>            "x": 380,<br/>            "y": 116<br/>          },<br/>          {<br/>            "x": 466,<br/>            "y": 116<br/>          },<br/>          {<br/>            "x": 466,<br/>            "y": 202<br/>          },<br/>          {<br/>            "x": 380,<br/>            "y": 202<br/>          }<br/>        ]<br/>      },<br/>      "headwearLikelihood": "VERY_UNLIKELY",<br/>      "joyLikelihood": "VERY_UNLIKELY",<br/>      ...<br/>]</span></pre><h2 id="c833" class="mb mc it bd md me mf dn mg mh mi dp mj ld mk ml mm lh mn mo mp ll mq mr ms mt bi translated">目标</h2><blockquote class="lu lv lw"><p id="148c" class="ku kv lx kw b kx ky ju kz la lb jx lc ly le lf lg lz li lj lk ma lm ln lo lp im bi translated"><strong class="kw iu">物体定位</strong>可以检测并提取一幅图像中的多个物体。</p><p id="36e9" class="ku kv lx kw b kx ky ju kz la lb jx lc ly le lf lg lz li lj lk ma lm ln lo lp im bi translated">对象定位识别图像中的多个对象，并为图像中的每个对象提供一个<a class="ae kt" href="https://cloud.google.com/vision/docs/reference/rest/v1/images/annotate#LocalizedObjectAnnotation" rel="noopener ugc nofollow" target="_blank">LocalizedObjectAnnotation</a>。</p></blockquote><figure class="ki kj kk kl gt km gh gi paragraph-image"><div role="button" tabindex="0" class="na nb di nc bf nd"><div class="gh gi no"><img src="../Images/a65e41bec01284e70ffcb30e27d11346.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*znwkMayoXNhA1Oz7ltKm_Q.png"/></div></div></figure><h2 id="ed13" class="mb mc it bd md me mf dn mg mh mi dp mj ld mk ml mm lh mn mo mp ll mq mr ms mt bi translated">标签</h2><blockquote class="lu lv lw"><p id="47a6" class="ku kv lx kw b kx ky ju kz la lb jx lc ly le lf lg lz li lj lk ma lm ln lo lp im bi translated"><strong class="kw iu">标签检测</strong>检测图像中广泛的类别，从运输方式到动物。</p></blockquote><figure class="ki kj kk kl gt km gh gi paragraph-image"><div role="button" tabindex="0" class="na nb di nc bf nd"><div class="gh gi np"><img src="../Images/ef7f30d7c1be7d7c0607deee0c2d122c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*l-_6ZUYHAG4nfISFwLeqOQ.png"/></div></div></figure><h2 id="5954" class="mb mc it bd md me mf dn mg mh mi dp mj ld mk ml mm lh mn mo mp ll mq mr ms mt bi translated">网</h2><blockquote class="lu lv lw"><p id="c83a" class="ku kv lx kw b kx ky ju kz la lb jx lc ly le lf lg lz li lj lk ma lm ln lo lp im bi translated"><strong class="kw iu">网页检测</strong>检测网页对图片的引用。</p></blockquote><figure class="ki kj kk kl gt km gh gi paragraph-image"><div role="button" tabindex="0" class="na nb di nc bf nd"><div class="gh gi nq"><img src="../Images/1d707a07798f671f36e38f86fc1317e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7aiU7GicHtgeQ6Fsb-oz9g.png"/></div></div></figure><h2 id="792f" class="mb mc it bd md me mf dn mg mh mi dp mj ld mk ml mm lh mn mo mp ll mq mr ms mt bi translated">文本</h2><blockquote class="lu lv lw"><p id="27bd" class="ku kv lx kw b kx ky ju kz la lb jx lc ly le lf lg lz li lj lk ma lm ln lo lp im bi translated"><strong class="kw iu">文本检测</strong>执行光学字符识别。它检测并提取图像中的文本，支持多种语言。它还具有自动语言识别功能。</p></blockquote><figure class="ki kj kk kl gt km gh gi paragraph-image"><div role="button" tabindex="0" class="na nb di nc bf nd"><div class="gh gi nr"><img src="../Images/36d553c5f210ab86b0ba4fbbd04a1d86.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_LFNZorji0S9FIx0wW4EhQ.png"/></div></div></figure><p id="36f4" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我试图把多种语言放在一个图像中。似乎还有改进的余地。</p><figure class="ki kj kk kl gt km gh gi paragraph-image"><div role="button" tabindex="0" class="na nb di nc bf nd"><div class="gh gi ns"><img src="../Images/9b2d769437c11edf2efe4843c1b1cd14.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*94p8JDJ9eYSj5zk28EoIOQ.png"/></div></div></figure><h2 id="a70f" class="mb mc it bd md me mf dn mg mh mi dp mj ld mk ml mm lh mn mo mp ll mq mr ms mt bi translated">性能</h2><blockquote class="lu lv lw"><p id="970d" class="ku kv lx kw b kx ky ju kz la lb jx lc ly le lf lg lz li lj lk ma lm ln lo lp im bi translated"><strong class="kw iu">图像属性</strong>功能检测图像的一般属性，例如主色。</p></blockquote><figure class="ki kj kk kl gt km gh gi paragraph-image"><div role="button" tabindex="0" class="na nb di nc bf nd"><div class="gh gi nt"><img src="../Images/c0560dced662bff9174e97c89bb4553b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Bog_pQZy1HkffgXRnZP_sw.png"/></div></div></figure><h2 id="f0c3" class="mb mc it bd md me mf dn mg mh mi dp mj ld mk ml mm lh mn mo mp ll mq mr ms mt bi translated">裁剪提示</h2><blockquote class="lu lv lw"><p id="0623" class="ku kv lx kw b kx ky ju kz la lb jx lc ly le lf lg lz li lj lk ma lm ln lo lp im bi translated"><strong class="kw iu">裁剪提示</strong>为图像上的裁剪区域建议顶点。</p></blockquote><figure class="ki kj kk kl gt km gh gi paragraph-image"><div role="button" tabindex="0" class="na nb di nc bf nd"><div class="gh gi nu"><img src="../Images/3ab8df385eced5e809f7c27c814b4259.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XuJF5oNrHAvw3j5-S3apIA.png"/></div></div></figure><figure class="ki kj kk kl gt km gh gi paragraph-image"><div role="button" tabindex="0" class="na nb di nc bf nd"><div class="gh gi nv"><img src="../Images/bb7f4e0beb4d3ac0d7714eb0ba5d9025.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yckRZIvXRP9Wl67FQZFYvA.png"/></div></div></figure><p id="9dbf" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">JSON 的响应如下所示。</p><pre class="ki kj kk kl gt ng lt nh ni aw nj bi"><span id="7f02" class="mb mc it lt b gy nk nl l nm nn">"cropHintsAnnotation": {<br/>    "cropHints": [<br/>      {<br/>        "boundingPoly": {<br/>          "vertices": [<br/>            {<br/>              "x": 63<br/>            },<br/>            {<br/>              "x": 498<br/>            },<br/>            {<br/>              "x": 498,<br/>              "y": 535<br/>            },<br/>            {<br/>              "x": 63,<br/>              "y": 535<br/>            }<br/>          ]<br/>        },<br/>        "confidence": 1,<br/>        "importanceFraction": 0.41<br/>      },<br/>      ...<br/>   ],      <br/>}</span></pre><p id="e6ae" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">另一个例子，我们可以看到原始图像是一个猫的形象。</p><figure class="ki kj kk kl gt km gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/88aeacb6f88937e5b7e21d9286ae24ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:552/format:webp/1*E3vhOeo7PnkOsgvpXCj7ZA.png"/></div></figure><p id="f763" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这是裁剪后的图像。</p><figure class="ki kj kk kl gt km gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/345a40e468983c87f605ed6aede59287.png" data-original-src="https://miro.medium.com/v2/resize:fit:554/format:webp/1*yqMOZiCZPD-VbqKlkh0RqA.png"/></div></figure><p id="8cbe" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">个人认为，这将是一个很好的工具来裁剪图像，而不削减最重要的东西，如脸。但是，如果图像包含许多像复仇者联盟样本一样的脸，它就不能在裁剪后的图像中包含所有的脸。</p><h2 id="41fc" class="mb mc it bd md me mf dn mg mh mi dp mj ld mk ml mm lh mn mo mp ll mq mr ms mt bi translated">安全搜索</h2><blockquote class="lu lv lw"><p id="1eae" class="ku kv lx kw b kx ky ju kz la lb jx lc ly le lf lg lz li lj lk ma lm ln lo lp im bi translated"><strong class="kw iu">安全搜索检测</strong>检测图像中的色情内容或暴力内容。此功能使用五个类别(“成人”、“欺骗”、“医疗”、“暴力”和“色情”)，并返回每个类别出现在给定图像中的可能性。有关这些字段的详细信息，请参见<a class="ae kt" href="https://cloud.google.com/vision/docs/reference/rpc/google.cloud.vision.v1#google.cloud.vision.v1.SafeSearchAnnotation" rel="noopener ugc nofollow" target="_blank">安全搜索注释</a>页面。</p></blockquote><figure class="ki kj kk kl gt km gh gi paragraph-image"><div role="button" tabindex="0" class="na nb di nc bf nd"><div class="gh gi ny"><img src="../Images/eca5d6fb0d9ae7112de81c4a272667f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iTAPsZ0KGTODR-Il4K_4KQ.png"/></div></div></figure><p id="e555" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这可能是一个过滤互联网或 UGC(用户生成内容)上任何不适当内容的好办法。最好的例子就是<code class="fe lq lr ls lt b">Google search</code>，它会在你谷歌的时候自动过滤不良内容。</p><h2 id="97ca" class="mb mc it bd md me mf dn mg mh mi dp mj ld mk ml mm lh mn mo mp ll mq mr ms mt bi translated">陆标</h2><blockquote class="lu lv lw"><p id="51ff" class="ku kv lx kw b kx ky ju kz la lb jx lc ly le lf lg lz li lj lk ma lm ln lo lp im bi translated"><strong class="kw iu">地标检测</strong>检测图像中常见的自然和人造结构。</p></blockquote><figure class="ki kj kk kl gt km gh gi paragraph-image"><div role="button" tabindex="0" class="na nb di nc bf nd"><div class="gh gi nz"><img src="../Images/1c0ba9ad818dace2212613edf669aa6a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QKIhBkOUa0AjrzTzfRiS7w.png"/></div></div><figcaption class="kp kq gj gh gi kr ks bd b be z dk">Picture from <a class="ae kt" href="https://radissontravels.com/paris-travel-guide/cathedrale-notre-dame-de-paris/" rel="noopener ugc nofollow" target="_blank">Travel Explore Discovery</a></figcaption></figure><p id="94ce" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">API 不仅响应景点名称，还响应位置的纬度和液化天然气。</p><pre class="ki kj kk kl gt ng lt nh ni aw nj bi"><span id="357a" class="mb mc it lt b gy nk nl l nm nn">"landmarkAnnotations": [<br/>    {<br/>      "boundingPoly": {<br/>        "vertices": [<br/>          {<br/>            "x": 418,<br/>            "y": 32<br/>          },<br/>          {<br/>            "x": 816,<br/>            "y": 32<br/>          },<br/>          {<br/>            "x": 816,<br/>            "y": 559<br/>          },<br/>          {<br/>            "x": 418,<br/>            "y": 559<br/>          }<br/>        ]<br/>      },<br/>      "description": "Notre Dame de Paris",<br/>      "locations": [<br/>        {<br/>          "latLng": {<br/>            "latitude": 48.853096,<br/>            "longitude": 2.349113<br/>          }<br/>        }<br/>      ],<br/>      "mid": "/m/0gtxh",<br/>      "score": 0.85791147<br/>    }<br/>  ]</span></pre><p id="e00f" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><strong class="kw iu">标志</strong></p><blockquote class="lu lv lw"><p id="b32e" class="ku kv lx kw b kx ky ju kz la lb jx lc ly le lf lg lz li lj lk ma lm ln lo lp im bi translated"><strong class="kw iu">标识检测</strong>检测图像中流行的产品标识。</p></blockquote><figure class="ki kj kk kl gt km gh gi paragraph-image"><div role="button" tabindex="0" class="na nb di nc bf nd"><div class="gh gi nq"><img src="../Images/43308af3cb75f1dd4401814b36f463bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KbjHs1b3IpfbbJ9Zz6pdWw.png"/></div></div><figcaption class="kp kq gj gh gi kr ks bd b be z dk">Picture from <a class="ae kt" href="https://linecorp.com/" rel="noopener ugc nofollow" target="_blank">Line Corporation</a></figcaption></figure></div><div class="ab cl oa ob hx oc" role="separator"><span class="od bw bk oe of og"/><span class="od bw bk oe of og"/><span class="od bw bk oe of"/></div><div class="im in io ip iq"><p id="b8dc" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">好了，现在我们都知道 Vision API 可以实现什么了。接下来，我们将通过 ML Study Jam 了解如何创建一个 Vision API 请求并使用<code class="fe lq lr ls lt b">curl</code>调用 API。</p><h1 id="3129" class="oh mc it bd md oi oj ok mg ol om on mj jz oo ka mm kc op kd mp kf oq kg ms or bi translated">激活谷歌云外壳</h1><ol class=""><li id="2ca8" class="os ot it kw b kx mu la mv ld ou lh ov ll ow lp ox oy oz pa bi translated">在 GCP 控制台的右上角工具栏上，单击“打开云壳”按钮。</li></ol><figure class="ki kj kk kl gt km gh gi paragraph-image"><div class="gh gi pb"><img src="../Images/f0c2fba5b99309665c6cd8ad550e7c24.png" data-original-src="https://miro.medium.com/v2/resize:fit:1278/format:webp/1*1Y0iQTI0fMy15f-eOPAxXg.png"/></div></figure><p id="f7ed" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">2.在打开的对话框中，点击<strong class="kw iu">启动云壳</strong>:</p><figure class="ki kj kk kl gt km gh gi paragraph-image"><div class="gh gi pc"><img src="../Images/ac24973b0d379c6895bb554177de9964.png" data-original-src="https://miro.medium.com/v2/resize:fit:1236/format:webp/1*6AjFGJd14yxMGbXFIpYyMA.png"/></div></figure><p id="74a2" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">3.稍等片刻，以进行资源调配并连接到环境。然后你会看到这个项目被设置为你的<em class="lx">项目 ID。</em></p><figure class="ki kj kk kl gt km gh gi paragraph-image"><div class="gh gi pd"><img src="../Images/309f0ec5653219c78cf524b333bb6953.png" data-original-src="https://miro.medium.com/v2/resize:fit:1282/format:webp/1*RhN8P8OAFf3hhOE1iIld4A.png"/></div></figure><h1 id="ed3c" class="oh mc it bd md oi oj ok mg ol om on mj jz oo ka mm kc op kd mp kf oq kg ms or bi translated">创建 API 密钥</h1><p id="0679" class="pw-post-body-paragraph ku kv it kw b kx mu ju kz la mv jx lc ld mw lf lg lh mx lj lk ll my ln lo lp im bi translated">因为我们将使用<code class="fe lq lr ls lt b">curl</code>向 Vision API 发送一个带有 API 键的请求，所以我们需要创建一个 API 键，并将其作为环境变量导出。</p><div class="ki kj kk kl gt ab cb"><figure class="pe km pf pg ph pi pj paragraph-image"><img src="../Images/f4b2b8ef4ed2bb406243a58f02fe115b.png" data-original-src="https://miro.medium.com/v2/resize:fit:538/format:webp/1*CBgYBUUvYwfWTAGsU4cjUQ.png"/></figure><figure class="pe km pk pg ph pi pj paragraph-image"><div role="button" tabindex="0" class="na nb di nc bf nd"><img src="../Images/d28286352cdf0ff4af0b0bd961940a78.png" data-original-src="https://miro.medium.com/v2/resize:fit:908/format:webp/1*s_LrYKxu9OEhnzXjBQ8slg.png"/></div></figure></div><h2 id="5420" class="mb mc it bd md me mf dn mg mh mi dp mj ld mk ml mm lh mn mo mp ll mq mr ms mt bi translated">将密钥导出为环境变量</h2><p id="69c0" class="pw-post-body-paragraph ku kv it kw b kx mu ju kz la mv jx lc ld mw lf lg lh mx lj lk ll my ln lo lp im bi translated">复制您的 API 密钥，并在 shell 中执行以下命令。</p><figure class="ki kj kk kl gt km gh gi paragraph-image"><div class="gh gi pl"><img src="../Images/5d14627fa6bf983dffc1133c6163033b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1266/format:webp/1*Dkaz8SJQfO9apWAfLtDUwg.png"/></div></figure><pre class="ki kj kk kl gt ng lt nh ni aw nj bi"><span id="e92b" class="mb mc it lt b gy nk nl l nm nn">export API_KEY=&lt;YOUR_API_KEY&gt;</span></pre><h1 id="44e3" class="oh mc it bd md oi oj ok mg ol om on mj jz oo ka mm kc op kd mp kf oq kg ms or bi translated">将图像上传到云存储桶</h1><blockquote class="lu lv lw"><p id="f2c5" class="ku kv lx kw b kx ky ju kz la lb jx lc ly le lf lg lz li lj lk ma lm ln lo lp im bi translated">有两种方式将图像发送到视觉 API 进行图像检测:通过向 API 发送 base64 编码的图像字符串，或者<strong class="kw iu">向其传递存储在 Google 云存储</strong>中的文件的 URL。我们将使用云存储 URL。</p></blockquote><p id="76a3" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">要在 Google 云存储上保存图像，我们需要先创建一个 bucket。</p><div class="ki kj kk kl gt ab cb"><figure class="pe km pm pg ph pi pj paragraph-image"><img src="../Images/12504bb656073c4ef5b75b0f7c617681.png" data-original-src="https://miro.medium.com/v2/resize:fit:544/format:webp/1*StY75YfzlU8gXdr_5QlccQ.png"/></figure><figure class="pe km pn pg ph pi pj paragraph-image"><img src="../Images/d0918ac035322bfb990ee03f2038ce61.png" data-original-src="https://miro.medium.com/v2/resize:fit:1068/format:webp/1*KGmjDAll_2x3AVf9CCPwcA.png"/></figure></div><h1 id="0a48" class="oh mc it bd md oi oj ok mg ol om on mj jz oo ka mm kc op kd mp kf oq kg ms or bi translated">上传一张图片到你的桶里</h1><p id="20af" class="pw-post-body-paragraph ku kv it kw b kx mu ju kz la mv jx lc ld mw lf lg lh mx lj lk ll my ln lo lp im bi translated">创建 bucket 后，向它上传一个图像。然后将图像的权限修改为<code class="fe lq lr ls lt b">allUsers</code>，以便 Vision API 可以访问它。</p><div class="ki kj kk kl gt ab cb"><figure class="pe km po pg ph pi pj paragraph-image"><div role="button" tabindex="0" class="na nb di nc bf nd"><img src="../Images/231af1e082112cc48581d19f25cc9813.png" data-original-src="https://miro.medium.com/v2/resize:fit:610/format:webp/1*JSPow7mPtbYnT1plSCcAlw.png"/></div></figure><figure class="pe km pp pg ph pi pj paragraph-image"><div role="button" tabindex="0" class="na nb di nc bf nd"><img src="../Images/eacf8a18739e70716ed6d1d214dc70af.png" data-original-src="https://miro.medium.com/v2/resize:fit:974/format:webp/1*y54R5sRSq0xsu3DeYTS0yQ.png"/></div></figure><figure class="pe km pq pg ph pi pj paragraph-image"><div role="button" tabindex="0" class="na nb di nc bf nd"><img src="../Images/2f17cbd8abebd2775a936e68b17a3e2b.png" data-original-src="https://miro.medium.com/v2/resize:fit:420/format:webp/1*glriUPXXiiZYP3PUjUUlIQ.png"/></div></figure></div><h1 id="d839" class="oh mc it bd md oi oj ok mg ol om on mj jz oo ka mm kc op kd mp kf oq kg ms or bi translated">创建您的 Vision API 请求</h1><p id="8fb8" class="pw-post-body-paragraph ku kv it kw b kx mu ju kz la mv jx lc ld mw lf lg lh mx lj lk ll my ln lo lp im bi translated">创建一个<code class="fe lq lr ls lt b">request.json</code>文件，作为发送给 Vision API 的请求。<code class="fe lq lr ls lt b">gcsImageUri</code>应该被替换为我们在上一步中刚刚创建的图片 URL。并且我们可以将我们想要检测的所有类型添加到<code class="fe lq lr ls lt b">features</code>中，包括<code class="fe lq lr ls lt b">FACE_DETECTION</code>、<code class="fe lq lr ls lt b">LANDMARK_DETECTION</code>、<code class="fe lq lr ls lt b">OBJECT_LOCALIZATION</code>、<code class="fe lq lr ls lt b">WEB_DETECTION</code>、<code class="fe lq lr ls lt b">DOCUMENT_TEXT_DETECTION</code>、<code class="fe lq lr ls lt b">IMAGE_PROPERTIES</code>、<code class="fe lq lr ls lt b">SAFE_SEARCH_DETECTION</code>、<code class="fe lq lr ls lt b">CROP_HINTS</code>。</p><div class="ki kj kk kl gt ab cb"><figure class="pe km pr pg ph pi pj paragraph-image"><img src="../Images/d7cf419f7f663f67e717fca1a35fbf16.png" data-original-src="https://miro.medium.com/v2/resize:fit:502/format:webp/1*lT98es1HiWFuRtSooLBzbQ.png"/></figure><figure class="pe km ps pg ph pi pj paragraph-image"><div role="button" tabindex="0" class="na nb di nc bf nd"><img src="../Images/148953ff289c95dee3d997129abec121.png" data-original-src="https://miro.medium.com/v2/resize:fit:956/format:webp/1*8NPIGYWc-R-29oP7t_Tjfg.png"/></div></figure></div><h1 id="61db" class="oh mc it bd md oi oj ok mg ol om on mj jz oo ka mm kc op kd mp kf oq kg ms or bi translated">将请求发送到 Vision API</h1><p id="2070" class="pw-post-body-paragraph ku kv it kw b kx mu ju kz la mv jx lc ld mw lf lg lh mx lj lk ll my ln lo lp im bi translated">最后，用<code class="fe lq lr ls lt b">curl</code>调用 Vision API:</p><pre class="ki kj kk kl gt ng lt nh ni aw nj bi"><span id="a160" class="mb mc it lt b gy nk nl l nm nn">curl -s -X POST -H “Content-Type: application/json” --data-binary @request.json <a class="ae kt" href="https://vision.googleapis.com/v1/images:annotate?key=${API_KEY}" rel="noopener ugc nofollow" target="_blank">https://vision.googleapis.com/v1/images:annotate?key=${API_KEY}</a></span></pre><p id="50ff" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">回应应该是这样的:</p><pre class="ki kj kk kl gt ng lt nh ni aw nj bi"><span id="d162" class="mb mc it lt b gy nk nl l nm nn">{<br/>  "labelAnnotations": [<br/>    {<br/>      "mid": "/m/02wbm",<br/>      "description": "Food",<br/>      "score": 94<br/>    },<br/>    {<br/>      "mid": "/m/0ggjl84",<br/>      "description": "Baked Goods",<br/>      "score": 90<br/>    },<br/>    {<br/>      "mid": "/m/02q08p0",<br/>      "description": "Dish",<br/>      "score": 85<br/>    },<br/>    {<br/>      "mid": "/m/0270h",<br/>      "description": "Dessert",<br/>      "score": 83<br/>    },<br/>    {<br/>      "mid": "/m/0bp3f6m",<br/>      "description": "Fried Food",<br/>      "score": 75<br/>    },<br/>    {<br/>      "mid": "/m/01wydv",<br/>      "description": "Beignet",<br/>      "score": 67<br/>    },<br/>    {<br/>      "mid": "/m/0pqdc",<br/>      "description": "Hors D Oeuvre",<br/>      "score": 54<br/>    }<br/>  ]<br/>}</span></pre><blockquote class="lu lv lw"><p id="8c57" class="ku kv lx kw b kx ky ju kz la lb jx lc ly le lf lg lz li lj lk ma lm ln lo lp im bi translated"><code class="fe lq lr ls lt b">description</code>带有物品的名称。</p><p id="1bb4" class="ku kv lx kw b kx ky ju kz la lb jx lc ly le lf lg lz li lj lk ma lm ln lo lp im bi translated"><code class="fe lq lr ls lt b">score</code>，一个 0 - 100 的数字，表示描述与图像中的内容匹配的可信度。</p><p id="a6d8" class="ku kv lx kw b kx ky ju kz la lb jx lc ly le lf lg lz li lj lk ma lm ln lo lp im bi translated"><code class="fe lq lr ls lt b">mid</code>映射到谷歌<a class="ae kt" href="https://www.google.com/intl/bn/insidesearch/features/search/knowledge.html" rel="noopener ugc nofollow" target="_blank">知识图</a>中项目的<code class="fe lq lr ls lt b">mid</code>的值。当调用<a class="ae kt" href="https://developers.google.com/knowledge-graph/" rel="noopener ugc nofollow" target="_blank">知识图 API </a>时，您可以使用<code class="fe lq lr ls lt b">mid</code>来获取关于该项目的更多信息。</p></blockquote></div><div class="ab cl oa ob hx oc" role="separator"><span class="od bw bk oe of og"/><span class="od bw bk oe of og"/><span class="od bw bk oe of"/></div><div class="im in io ip iq"><h1 id="a0a7" class="oh mc it bd md oi pt ok mg ol pu on mj jz pv ka mm kc pw kd mp kf px kg ms or bi translated">参考</h1><p id="d0e4" class="pw-post-body-paragraph ku kv it kw b kx mu ju kz la mv jx lc ld mw lf lg lh mx lj lk ll my ln lo lp im bi translated"><a class="ae kt" href="https://cloud.google.com/vision/#vision-api-demo" rel="noopener ugc nofollow" target="_blank">官网视觉 AI </a> <br/> <a class="ae kt" href="https://cloud.google.com/vision/docs/all-samples" rel="noopener ugc nofollow" target="_blank">官网所有样品</a></p><h1 id="33f4" class="oh mc it bd md oi oj ok mg ol om on mj jz oo ka mm kc op kd mp kf oq kg ms or bi translated">定价</h1><p id="87d4" class="pw-post-body-paragraph ku kv it kw b kx mu ju kz la mv jx lc ld mw lf lg lh mx lj lk ll my ln lo lp im bi translated">这是公司或开发商可能考虑的另一个主要问题。我把定价图贴在这里供参考。</p><figure class="ki kj kk kl gt km gh gi paragraph-image"><div role="button" tabindex="0" class="na nb di nc bf nd"><div class="gh gi py"><img src="../Images/bd5c0701eaa8aa2710a6ecf84c2045a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OE9VTgSaTrFrr0dmeIVzVA.png"/></div></div></figure><h2 id="fdac" class="mb mc it bd md me mf dn mg mh mi dp mj ld mk ml mm lh mn mo mp ll mq mr ms mt bi">柴犬、秋田，傻傻分不清楚</h2><p id="28c7" class="pw-post-body-paragraph ku kv it kw b kx mu ju kz la mv jx lc ld mw lf lg lh mx lj lk ll my ln lo lp im bi translated">这是一个鉴别柴犬和秋田犬的网站。这是一个如何用 AutoML 模型训练你的模型并在产品上实现的例子。这只是为了好玩，享受它。</p><div class="pz qa gp gr qb qc"><a href="https://gcp.expert/automl/" rel="noopener  ugc nofollow" target="_blank"><div class="qd ab fo"><div class="qe ab qf cl cj qg"><h2 class="bd iu gy z fp qh fr fs qi fu fw is bi">柴犬、秋田傻傻分不清楚？一起來 AutoML 訓練機器學習辨識 | GCP 專門家</h2><div class="qj l"><h3 class="bd b gy z fp qh fr fs qi fu fw dk">用 GCP 只要三步驟，您也可以輕鬆訓練 AutoML model，快找 GCP 專門家。</h3></div><div class="qk l"><p class="bd b dl z fp qh fr fs qi fu fw dk translated">gcp .专家</p></div></div><div class="ql l"><div class="qm l qn qo qp ql qq ne qc"/></div></div></a></div></div><div class="ab cl oa ob hx oc" role="separator"><span class="od bw bk oe of og"/><span class="od bw bk oe of og"/><span class="od bw bk oe of"/></div><div class="im in io ip iq"><p id="8f22" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">总之，Vision API 确实是一个很好的工具，可以帮助我们简单地处理图像分析。对于许多开发者来说，它提供了一个进入专业领域的入口。图像分析不再是一件非常困难的事情。Vision API 可能有很多实现，包括娱乐、教育、医学等等。真的很期待以后的创意产品！</p><figure class="ki kj kk kl gt km gh gi paragraph-image"><div role="button" tabindex="0" class="na nb di nc bf nd"><div class="gh gi qr"><img src="../Images/85c6afade08fcd74ebe9089f1d6b0fcd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*c_lnqYS1083NUKo_iA3YLw.png"/></div></div><figcaption class="kp kq gj gh gi kr ks bd b be z dk">Picture from <a class="ae kt" href="https://returnjet.com/whats-the-future-for-the-charter-broker/" rel="noopener ugc nofollow" target="_blank">Returnjet.com</a></figcaption></figure></div></div>    
</body>
</html>