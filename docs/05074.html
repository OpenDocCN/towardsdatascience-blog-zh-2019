<html>
<head>
<title>SQL JOINs</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">SQL 连接</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/sql-join-8212e3eb9fde?source=collection_archive---------9-----------------------#2019-07-30">https://towardsdatascience.com/sql-join-8212e3eb9fde?source=collection_archive---------9-----------------------#2019-07-30</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="c946" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">一次一个联接地将数据汇集在一起</h2></div><blockquote class="ki kj kk"><p id="4e60" class="kl km kn ko b kp kq ju kr ks kt jx ku kv kw kx ky kz la lb lc ld le lf lg lh im bi translated">感谢<a class="ae li" href="https://medium.com/@jeremyrchow" rel="noopener">周润发</a>巧妙的字幕！</p></blockquote><figure class="lk ll lm ln gt lo gh gi paragraph-image"><div role="button" tabindex="0" class="lp lq di lr bf ls"><div class="gh gi lj"><img src="../Images/4265084afce6098369d7a0628ebebfe3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rxK02eiijj9jp_1PA1OUmw.jpeg"/></div></div><figcaption class="lv lw gj gh gi lx ly bd b be z dk">Photo by <a class="ae li" href="https://unsplash.com/@marcsm?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Marc Sendra Martorell</a> on <a class="ae li" href="https://unsplash.com/search/photos/bubble?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><blockquote class="ki kj kk"><p id="100e" class="kl km kn ko b kp kq ju kr ks kt jx ku kv kw kx ky kz la lb lc ld le lf lg lh im bi translated">我在这个博客中使用的代码可以在我的 GitHub 上找到。</p></blockquote><p id="13c7" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku lz kw kx ky ma la lb lc mb le lf lg lh im bi translated">SQL 有很多东西要学，尤其是对我来说。我花了最长时间理解的事情之一是<code class="fe mc md me mf b">JOIN</code>陈述。一开始这很吓人，但是经过阅读和大量的练习，我掌握了窍门，我希望在这篇博客结束时，你也会有同样的感觉！</p><p id="9ab0" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku lz kw kx ky ma la lb lc mb le lf lg lh im bi translated">在这篇博客中，我们将讨论四种不同类型的连接:</p><ul class=""><li id="fe9d" class="mg mh it ko b kp kq ks kt lz mi ma mj mb mk lh ml mm mn mo bi translated">内部联接(或联接)</li><li id="90be" class="mg mh it ko b kp mp ks mq lz mr ma ms mb mt lh ml mm mn mo bi translated">左连接(或左外连接)</li><li id="3af2" class="mg mh it ko b kp mp ks mq lz mr ma ms mb mt lh ml mm mn mo bi translated">右连接(或右外连接)</li><li id="8062" class="mg mh it ko b kp mp ks mq lz mr ma ms mb mt lh ml mm mn mo bi translated">完全连接</li></ul><p id="2a6d" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku lz kw kx ky ma la lb lc mb le lf lg lh im bi translated"><strong class="ko iu"/></p></div><div class="ab cl mu mv hx mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="im in io ip iq"><h1 id="d493" class="nb nc it bd nd ne nf ng nh ni nj nk nl jz nm ka nn kc no kd np kf nq kg nr ns bi translated">安装</h1><p id="d644" class="pw-post-body-paragraph kl km it ko b kp nt ju kr ks nu jx ku lz nv kx ky ma nw lb lc mb nx lf lg lh im bi translated">对于这些例子，我们将使用好的 ol' Chinook 数据库，它也用于 SQL 基础博客和我的大多数其他 SQL 相关博客。</p><p id="b121" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku lz kw kx ky ma la lb lc mb le lf lg lh im bi translated">让我们设置数据库文件、库和函数:</p><figure class="lk ll lm ln gt lo"><div class="bz fp l di"><div class="ny nz l"/></div></figure><figure class="lk ll lm ln gt lo gh gi paragraph-image"><div role="button" tabindex="0" class="lp lq di lr bf ls"><div class="gh gi oa"><img src="../Images/7a076dacffb160056453969a4aa1217e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*NLdZkpJJl-dczeWB.png"/></div></div><figcaption class="lv lw gj gh gi lx ly bd b be z dk">The chinook database for visualization purposes</figcaption></figure><p id="bbb6" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku lz kw kx ky ma la lb lc mb le lf lg lh im bi translated">数据库已经加载，现在我们准备好处理连接了！</p></div><div class="ab cl mu mv hx mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="im in io ip iq"><h1 id="39f6" class="nb nc it bd nd ne nf ng nh ni nj nk nl jz nm ka nn kc no kd np kf nq kg nr ns bi translated">内部联接/联接</h1><figure class="lk ll lm ln gt lo gh gi paragraph-image"><div role="button" tabindex="0" class="lp lq di lr bf ls"><div class="gh gi ob"><img src="../Images/1557d6566ffb9b08b12648237af27b96.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wdXDl7EdP0ALUTVOh-gdNA.png"/></div></div><figcaption class="lv lw gj gh gi lx ly bd b be z dk">The INNER JOIN keyword</figcaption></figure><p id="c51f" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku lz kw kx ky ma la lb lc mb le lf lg lh im bi translated"><strong class="ko iu"/><code class="fe mc md me mf b">INNER JOIN</code><strong class="ko iu">关键字选择两个表中满足条件的所有行。</strong>该关键字创建一个新的集合，该集合组合了两个表中公共字段值相同的所有行。</p><p id="e52f" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku lz kw kx ky ma la lb lc mb le lf lg lh im bi translated">让我们用一个例子来看看这是如何工作的:</p><pre class="lk ll lm ln gt oc mf od oe aw of bi"><span id="bae8" class="og nc it mf b gy oh oi l oj ok">SELECT a.name, a.composer, b.name<br/>FROM tracks AS a<br/>INNER JOIN genres AS b<br/>ON a.genreid = b.genreid<br/>WHERE b.name LIKE 'b%'<br/>LIMIT 10;</span></pre><p id="a44e" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku lz kw kx ky ma la lb lc mb le lf lg lh im bi translated">在将<code class="fe mc md me mf b">tracks</code>表设置为变量名<code class="fe mc md me mf b">a</code>并将<code class="fe mc md me mf b">genres</code>表设置为变量名<code class="fe mc md me mf b">b</code>、<strong class="ko iu">后，这两个表通过一个公共键</strong>链接起来，这个公共键就是两个表中都存在的<code class="fe mc md me mf b">genreid</code>键。然后，它从<code class="fe mc md me mf b">tracks</code>表中找到歌曲名称和作曲家，然后从<code class="fe mc md me mf b">genres</code>表中找到相应的流派名称。</p><p id="ad07" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku lz kw kx ky ma la lb lc mb le lf lg lh im bi translated">然后，它将结果限制为歌曲名称以字母“b”开头的歌曲，并进一步将结果限制为前 10 个。最终输出将返回 10 首蓝调风格的歌曲，包括歌曲名和作曲家名。</p><p id="a672" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku lz kw kx ky ma la lb lc mb le lf lg lh im bi translated">现在我们可以更好地解释<code class="fe mc md me mf b">INNER JOIN</code>关键字中发生的事情，让我们继续讨论<code class="fe mc md me mf b">LEFT JOIN</code>关键字！</p></div><div class="ab cl mu mv hx mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="im in io ip iq"><h1 id="7022" class="nb nc it bd nd ne nf ng nh ni nj nk nl jz nm ka nn kc no kd np kf nq kg nr ns bi translated">左连接/左外连接</h1><figure class="lk ll lm ln gt lo gh gi paragraph-image"><div role="button" tabindex="0" class="lp lq di lr bf ls"><div class="gh gi ob"><img src="../Images/6bd1df63b05b3ec63ab8dd4d6c06c81e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9bXAzaBdjOFtYWIFi_omJw.png"/></div></div><figcaption class="lv lw gj gh gi lx ly bd b be z dk">The LEFT JOIN keyword</figcaption></figure><p id="1087" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku lz kw kx ky ma la lb lc mb le lf lg lh im bi translated"><strong class="ko iu"/><code class="fe mc md me mf b">LEFT JOIN</code><strong class="ko iu">关键字</strong> <strong class="ko iu">返回连接左侧表的所有行和连接右侧表的匹配行。</strong>如果左侧的行与右侧的行不匹配，空值<em class="kn">将填充右侧的空间。</em></p><pre class="lk ll lm ln gt oc mf od oe aw of bi"><span id="a5bd" class="og nc it mf b gy oh oi l oj ok">SELECT a.trackid, a.name, a.composer, b.invoicelineid, b.invoiceid<br/>FROM tracks AS a<br/>LEFT JOIN invoice_items AS b<br/>ON a.trackid = b.trackid;</span></pre><p id="5e75" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku lz kw kx ky ma la lb lc mb le lf lg lh im bi translated">在上面的例子中，查询将<code class="fe mc md me mf b">tracks</code>表设置为变量名<code class="fe mc md me mf b">a</code>，将<code class="fe mc md me mf b">invoice_items</code>表设置为变量名<code class="fe mc md me mf b">b</code>。它通过公共键<code class="fe mc md me mf b">trackid</code>将它们链接起来，并返回 tracks 表中的 trackid、name 和 composer，以及 invoice_items 表中的 invoice line ID 和 invoice ID。</p><p id="40bf" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku lz kw kx ky ma la lb lc mb le lf lg lh im bi translated">在查看数据时，您可能会想:“空值去了哪里？”。如果你没有，我们将向你展示如何找到其中的一些！</p><pre class="lk ll lm ln gt oc mf od oe aw of bi"><span id="f8f9" class="og nc it mf b gy oh oi l oj ok">SELECT a.trackid, a.name, a.composer, b.invoicelineid, b.invoiceid<br/>FROM tracks AS a<br/>LEFT JOIN invoice_items AS b<br/>ON a.trackid = b.trackid<br/><strong class="mf iu">WHERE b.invoiceid IS NULL;</strong></span></pre><p id="636e" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku lz kw kx ky ma la lb lc mb le lf lg lh im bi translated"><code class="fe mc md me mf b">IS NULL</code>子句对于查找列中的任何空值非常有用。将这一行添加到原始示例中，我们发现许多行在原始的<code class="fe mc md me mf b">invoice_items</code>表中没有值，而是被替换为空值。</p></div><div class="ab cl mu mv hx mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="im in io ip iq"><h1 id="e88a" class="nb nc it bd nd ne nf ng nh ni nj nk nl jz nm ka nn kc no kd np kf nq kg nr ns bi translated">右连接/右外部连接</h1><figure class="lk ll lm ln gt lo gh gi paragraph-image"><div role="button" tabindex="0" class="lp lq di lr bf ls"><div class="gh gi ob"><img src="../Images/d56d721037a5b3c6f2983589a86e7554.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SqW7rFGd7aSTa7M7Q_abcg.png"/></div></div><figcaption class="lv lw gj gh gi lx ly bd b be z dk">The RIGHT JOIN keyword</figcaption></figure><p id="be1f" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku lz kw kx ky ma la lb lc mb le lf lg lh im bi translated">正如你所料，<code class="fe mc md me mf b">RIGHT JOIN</code>与<code class="fe mc md me mf b">LEFT JOIN</code>相似。<strong class="ko iu">该连接返回连接右侧的表的所有行以及连接左侧的表的匹配行。</strong>并且，对于左侧现在有匹配行的任何行，这些值被替换为空值<em class="kn"/>。</p><p id="5e97" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku lz kw kx ky ma la lb lc mb le lf lg lh im bi translated">在大多数查询中，<code class="fe mc md me mf b">RIGHT JOIN</code>看起来像这样:</p><pre class="lk ll lm ln gt oc mf od oe aw of bi"><span id="5b31" class="og nc it mf b gy oh oi l oj ok">SELECT a.trackid, a.name, a.composer, b.invoicelineid, b.invoiceid<br/>FROM tracks AS a<br/><strong class="mf iu">RIGHT JOIN</strong> invoice_items AS b<br/>ON a.trackid = b.trackid;</span></pre><p id="987f" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku lz kw kx ky ma la lb lc mb le lf lg lh im bi translated">请注意，该设置看起来几乎与<code class="fe mc md me mf b">LEFT JOIN</code>示例中的示例一模一样，只是现在显示为<code class="fe mc md me mf b">RIGHT JOIN</code>。</p><p id="9786" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku lz kw kx ky ma la lb lc mb le lf lg lh im bi translated"><strong class="ko iu">现在，对于那些使用不支持</strong> <code class="fe mc md me mf b">RIGHT JOIN</code> <strong class="ko iu">的 SQL 程序的人来说，</strong> <code class="fe mc md me mf b">RIGHT JOIN</code> <strong class="ko iu">关键字本质上是一个翻转的</strong> <code class="fe mc md me mf b">LEFT JOIN</code>。以下是该变通办法的效果:</p><pre class="lk ll lm ln gt oc mf od oe aw of bi"><span id="469d" class="og nc it mf b gy oh oi l oj ok">SELECT b.trackid, b.name, b.composer, a.invoicelineid, a.invoiceid<br/>FROM invoice_items AS a<br/><strong class="mf iu">LEFT JOIN</strong> tracks AS b<br/>ON a.trackid = b.trackid;</span></pre><p id="72ae" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku lz kw kx ky ma la lb lc mb le lf lg lh im bi translated">它对<code class="fe mc md me mf b">RIGHT JOIN</code>关键字进行了细微的调整，但是它将输出与<code class="fe mc md me mf b">RIGHT JOIN</code>示例相同的内容。</p><p id="f4ec" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku lz kw kx ky ma la lb lc mb le lf lg lh im bi translated">该查询的输出将显示实际订购歌曲的发票。任何发票中未订购的任何歌曲都不会显示在该查询中。</p><p id="ed38" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku lz kw kx ky ma la lb lc mb le lf lg lh im bi translated">现在我们已经有了这些例子，让我们继续进行<code class="fe mc md me mf b">FULL JOIN</code>！</p></div><div class="ab cl mu mv hx mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="im in io ip iq"><h1 id="6e13" class="nb nc it bd nd ne nf ng nh ni nj nk nl jz nm ka nn kc no kd np kf nq kg nr ns bi translated">完全连接/完全外部连接</h1><figure class="lk ll lm ln gt lo gh gi paragraph-image"><div role="button" tabindex="0" class="lp lq di lr bf ls"><div class="gh gi ob"><img src="../Images/723df1a0c04ac7cf4e8138bee5a88034.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bWJSG52rD5__g60ZNkK0ug.png"/></div></div><figcaption class="lv lw gj gh gi lx ly bd b be z dk">The FULL JOIN keyword</figcaption></figure><p id="ca6f" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku lz kw kx ky ma la lb lc mb le lf lg lh im bi translated"><strong class="ko iu"/><code class="fe mc md me mf b">FULL JOIN</code><strong class="ko iu">关键字通过组合</strong> <code class="fe mc md me mf b">LEFT JOIN</code> <strong class="ko iu">和</strong> <code class="fe mc md me mf b">RIGHT JOIN</code>的结果来创建结果。对于任何不匹配的行，结果将包含空值。</p><p id="3fea" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku lz kw kx ky ma la lb lc mb le lf lg lh im bi translated">该关键字很少使用，但可用于查找两个表之间的重复行、缺失行或相似行。</p><p id="228d" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku lz kw kx ky ma la lb lc mb le lf lg lh im bi translated">如果您的 SQL 程序支持，您的查询看起来会非常简单:</p><pre class="lk ll lm ln gt oc mf od oe aw of bi"><span id="cc6a" class="og nc it mf b gy oh oi l oj ok">SELECT table1.column1,table1.column2,table2.column1,....<br/>FROM table1 <br/><strong class="mf iu">FULL JOIN</strong> table2<br/>ON table1.matching_column = table2.matching_column;</span></pre><p id="eb46" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku lz kw kx ky ma la lb lc mb le lf lg lh im bi translated">知道<code class="fe mc md me mf b">FULL JOIN</code>本质上是一个<code class="fe mc md me mf b">LEFT JOIN</code>和一个<code class="fe mc md me mf b">RIGHT JOIN</code>的组合是很有用的。假设我们的 SQL 程序既不支持<code class="fe mc md me mf b">FULL JOIN</code>也不支持<code class="fe mc md me mf b">RIGHT JOIN</code>，我们的查询应该是这样的:</p><pre class="lk ll lm ln gt oc mf od oe aw of bi"><span id="49d2" class="og nc it mf b gy oh oi l oj ok">SELECT * <br/>FROM invoice_items AS a<br/><strong class="mf iu">LEFT JOIN</strong> tracks AS b<br/>ON a.trackid = b.trackid<br/><strong class="mf iu">UNION</strong><br/>SELECT *<br/>FROM tracks AS a<br/><strong class="mf iu">LEFT JOIN</strong> invoice_items AS b<br/>ON a.trackid =b.trackid<br/><strong class="mf iu">WHERE a.trackid IS NULL;</strong></span></pre><p id="0484" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku lz kw kx ky ma la lb lc mb le lf lg lh im bi translated">在这个例子中，有三件主要的事情在进行:</p><ol class=""><li id="9a59" class="mg mh it ko b kp kq ks kt lz mi ma mj mb mk lh ol mm mn mo bi translated">第一部<code class="fe mc md me mf b">LEFT JOIN</code></li><li id="804f" class="mg mh it ko b kp mp ks mq lz mr ma ms mb mt lh ol mm mn mo bi translated">第二个<code class="fe mc md me mf b">LEFT JOIN</code>(伪<code class="fe mc md me mf b">RIGHT JOIN</code>)</li><li id="ea76" class="mg mh it ko b kp mp ks mq lz mr ma ms mb mt lh ol mm mn mo bi translated">将两者合并在一起的<code class="fe mc md me mf b">UNION</code></li></ol><p id="4a3a" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku lz kw kx ky ma la lb lc mb le lf lg lh im bi translated"><code class="fe mc md me mf b">IS NULL</code>行确保重复的行不会被输入到结果集中，这对获得可读的结果非常有用。</p><p id="f7e8" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku lz kw kx ky ma la lb lc mb le lf lg lh im bi translated">结果将输出 2240 行数据，包括发票数据和单首歌曲数据。</p></div><div class="ab cl mu mv hx mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="im in io ip iq"><h1 id="b303" class="nb nc it bd nd ne nf ng nh ni nj nk nl jz nm ka nn kc no kd np kf nq kg nr ns bi translated">结论</h1><p id="2c98" class="pw-post-body-paragraph kl km it ko b kp nt ju kr ks nu jx ku lz nv kx ky ma nw lb lc mb nx lf lg lh im bi translated">唷！有很多问题，我很感谢你在这里逗留了这么久！</p><p id="e2a2" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku lz kw kx ky ma la lb lc mb le lf lg lh im bi translated">总的来说，下面是每个 JOIN 关键字的作用:</p><ul class=""><li id="1b40" class="mg mh it ko b kp kq ks kt lz mi ma mj mb mk lh ml mm mn mo bi translated"><strong class="ko iu">内部连接</strong>:从两个表中选择具有匹配公共键的所有行。</li><li id="5534" class="mg mh it ko b kp mp ks mq lz mr ma ms mb mt lh ml mm mn mo bi translated"><strong class="ko iu">左连接</strong>:使用左侧表格中的所有行，并从右侧表格中寻找匹配的行。</li><li id="aeff" class="mg mh it ko b kp mp ks mq lz mr ma ms mb mt lh ml mm mn mo bi translated"><strong class="ko iu">右连接</strong>:使用右侧表格中的所有行，并从左侧表格中找到匹配的行。</li><li id="6d09" class="mg mh it ko b kp mp ks mq lz mr ma ms mb mt lh ml mm mn mo bi translated"><strong class="ko iu">完全连接</strong>:合并两个表中的所有行。</li></ul><p id="646a" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku lz kw kx ky ma la lb lc mb le lf lg lh im bi translated">希望这有助于了解如何用你的数据库创建连接查询，我希望你会在下一篇文章中<strong class="ko iu"> <em class="kn">加入</em> </strong>我！</p></div></div>    
</body>
</html>