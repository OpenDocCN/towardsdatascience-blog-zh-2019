<html>
<head>
<title>Feature selection techniques for classification and Python tips for their application</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">åˆ†ç±»çš„è¦ç´ é€‰æ‹©æŠ€æœ¯åŠå…¶åº”ç”¨çš„ Python æŠ€å·§</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://towardsdatascience.com/feature-selection-techniques-for-classification-and-python-tips-for-their-application-10c0ddd7918b?source=collection_archive---------1-----------------------#2019-08-02">https://towardsdatascience.com/feature-selection-techniques-for-classification-and-python-tips-for-their-application-10c0ddd7918b?source=collection_archive---------1-----------------------#2019-08-02</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="870e" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">å…³äºå¦‚ä½•ä½¿ç”¨æœ€å¸¸è§çš„ç‰¹å¾é€‰æ‹©æŠ€æœ¯è§£å†³åˆ†ç±»é—®é¢˜çš„æ•™ç¨‹</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/b3d1e7fa4cdd17fed9cf5b7c00ea9278.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*k-o_cOg6ABwHfq33-xSrxg.jpeg"/></div></div></figure><p id="a0e0" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">é€‰æ‹©ä½¿ç”¨å“ªäº›åŠŸèƒ½æ˜¯ä»»ä½•æœºå™¨å­¦ä¹ é¡¹ç›®ä¸­çš„å…³é”®ä¸€æ­¥ï¼Œä¹Ÿæ˜¯æ•°æ®ç§‘å­¦å®¶æ—¥å¸¸å·¥ä½œä¸­çš„ä¸€é¡¹ç»å¸¸æ€§ä»»åŠ¡ã€‚åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘å›é¡¾äº†åˆ†ç±»é—®é¢˜ä¸­æœ€å¸¸è§çš„ç‰¹å¾é€‰æ‹©æŠ€æœ¯ï¼Œå°†å®ƒä»¬åˆ†ä¸º 6 å¤§ç±»ã€‚æˆ‘æä¾›äº†å¦‚ä½•åœ¨æœºå™¨å­¦ä¹ é¡¹ç›®ä¸­ä½¿ç”¨å®ƒä»¬çš„æŠ€å·§ï¼Œå¹¶å°½å¯èƒ½ç”¨ Python ä»£ç ç»™å‡ºä¾‹å­ã€‚ä½ å‡†å¤‡å¥½äº†å—ï¼Ÿ</p><h1 id="5601" class="lq lr it bd ls lt lu lv lw lx ly lz ma jz mb ka mc kc md kd me kf mf kg mg mh bi translated">TLï¼›ç¾éš¾æ¢å¤-æ±‡æ€»è¡¨</h1><p id="d5c4" class="pw-post-body-paragraph ku kv it kw b kx mi ju kz la mj jx lc ld mk lf lg lh ml lj lk ll mm ln lo lp im bi translated">ä¸‹è¡¨æ€»ç»“äº†ä¸»è¦æ–¹æ³•ï¼Œå¹¶åœ¨ä»¥ä¸‹éƒ¨åˆ†è¿›è¡Œäº†è®¨è®ºã€‚</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mn"><img src="../Images/d99f89869ed4ffd35b7fc4ec8417d390.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LJ0slb7apPb1fQWVTAX2CA.jpeg"/></div></div></figure></div><div class="ab cl mo mp hx mq" role="separator"><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt"/></div><div class="im in io ip iq"><h1 id="dc7b" class="lq lr it bd ls lt mv lv lw lx mw lz ma jz mx ka mc kc my kd me kf mz kg mg mh bi translated">ä»€ä¹ˆæ˜¯ç‰¹å¾é€‰æ‹©ï¼Œä¸ºä»€ä¹ˆæœ‰ç”¨ï¼Ÿ</h1><p id="9c14" class="pw-post-body-paragraph ku kv it kw b kx mi ju kz la mj jx lc ld mk lf lg lh ml lj lk ll mm ln lo lp im bi translated">æœºå™¨å­¦ä¹ ä¸­æœ€å¤§çš„ä¸¤ä¸ªé—®é¢˜æ˜¯<strong class="kw iu">è¿‡æ‹Ÿåˆ</strong>(æ‹Ÿåˆåœ¨æ•°æ®é›†ä¹‹å¤–ä¸å¯æ¦‚æ‹¬çš„æ•°æ®æ–¹é¢)å’Œ<strong class="kw iu">ç»´æ•°ç¾éš¾</strong>(é«˜ç»´æ•°æ®çš„éç›´è§‚å’Œç¨€ç–ç‰¹æ€§)ã€‚</p><p id="2b80" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">é€šè¿‡å‡å°‘æ¨¡å‹ä¸­çš„ç‰¹å¾æ•°é‡ï¼Œå°è¯•ä¼˜åŒ–æ¨¡å‹æ€§èƒ½ï¼Œç‰¹å¾é€‰æ‹©æœ‰åŠ©äºé¿å…è¿™ä¸¤ä¸ªé—®é¢˜ã€‚è¿™æ ·åšï¼Œç‰¹æ€§é€‰æ‹©è¿˜æä¾›äº†ä¸€ä¸ªé¢å¤–çš„å¥½å¤„:<strong class="kw iu">æ¨¡å‹</strong>è§£é‡Šã€‚éšç€ç‰¹å¾çš„å‡å°‘ï¼Œè¾“å‡ºæ¨¡å‹å˜å¾—æ›´ç®€å•å’Œæ›´å®¹æ˜“è§£é‡Šï¼Œå¹¶ä¸”äººç±»æ›´æœ‰å¯èƒ½ç›¸ä¿¡æ¨¡å‹åšå‡ºçš„æœªæ¥é¢„æµ‹ã€‚</p></div><div class="ab cl mo mp hx mq" role="separator"><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt"/></div><div class="im in io ip iq"><h1 id="fabb" class="lq lr it bd ls lt mv lv lw lx mw lz ma jz mx ka mc kc my kd me kf mz kg mg mh bi translated">æ— ç›‘ç£æ–¹æ³•</h1><p id="2141" class="pw-post-body-paragraph ku kv it kw b kx mi ju kz la mj jx lc ld mk lf lg lh ml lj lk ll mm ln lo lp im bi translated">å‡å°‘ç‰¹å¾æ•°é‡çš„ä¸€ä¸ªç®€å•æ–¹æ³•æ˜¯å¯¹æ•°æ®åº”ç”¨<strong class="kw iu">é™ç»´æŠ€æœ¯</strong>ã€‚è¿™é€šå¸¸ä»¥æ— äººç›‘ç£çš„æ–¹å¼å®Œæˆï¼Œå³ä¸ä½¿ç”¨æ ‡ç­¾æœ¬èº«ã€‚</p><p id="73d9" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">é™ç»´å®é™…ä¸Šå¹¶ä¸é€‰æ‹©ç‰¹å¾çš„å­é›†ï¼Œè€Œæ˜¯åœ¨ä½ç»´ç©ºé—´ä¸­äº§ç”Ÿä¸€ç»„æ–°çš„ç‰¹å¾ã€‚è¿™ä¸ªæ–°çš„é›†åˆå¯ä»¥ç”¨äºåˆ†ç±»è¿‡ç¨‹æœ¬èº«ã€‚</p><p id="93c4" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">ä»¥ä¸‹ç¤ºä¾‹ä½¿ç”¨é™ç»´åçš„ç‰¹å¾è¿›è¡Œåˆ†ç±»ã€‚æ›´å‡†ç¡®åœ°è¯´ï¼Œå®ƒä½¿ç”¨ä¸»æˆåˆ†åˆ†æ<strong class="kw iu"/>(PCA)çš„å‰ 2 ä¸ªæˆåˆ†ä½œä¸ºæ–°çš„ç‰¹å¾é›†ã€‚</p><pre class="kj kk kl km gt na nb nc nd aw ne bi"><span id="e306" class="nf lr it nb b gy ng nh l ni nj">from sklearn.datasets import load_iris<br/>from sklearn.decomposition import PCA<br/>from sklearn.svm import SVC<br/>import matplotlib.pyplot as plt<br/>from matplotlib.colors import ListedColormap</span><span id="7134" class="nf lr it nb b gy nk nh l ni nj">import numpy as np<br/>h = .01<br/>x_min, x_max = -4,4<br/>y_min, y_max = -1.5,1.5</span><span id="0f37" class="nf lr it nb b gy nk nh l ni nj"># loading dataset<br/>data = load_iris()<br/>X, y = data.data, data.target</span><span id="caca" class="nf lr it nb b gy nk nh l ni nj"># selecting first 2 components of PCA<br/>X_pca = PCA().fit_transform(X)<br/>X_selected = X_pca[:,:2]</span><span id="e283" class="nf lr it nb b gy nk nh l ni nj"># training classifier and evaluating on the whole plane<br/>clf = SVC(kernel='linear')<br/>clf.fit(X_selected,y)<br/>xx, yy = np.meshgrid(np.arange(x_min, x_max, h),<br/>                     np.arange(y_min, y_max, h))</span><span id="c10f" class="nf lr it nb b gy nk nh l ni nj">Z = clf.predict(np.c_[xx.ravel(), yy.ravel()])<br/>Z = Z.reshape(xx.shape)</span><span id="5428" class="nf lr it nb b gy nk nh l ni nj"># Plotting<br/>cmap_light = ListedColormap(['#FFAAAA', '#AAFFAA', '#AAAAFF'])<br/>cmap_bold = ListedColormap(['#FF0000', '#00FF00', '#0000FF'])<br/>plt.figure(figsize=(10,5))<br/>plt.pcolormesh(xx, yy, Z, alpha=.6,cmap=cmap_light)<br/>plt.title('PCA - Iris dataset')<br/>plt.xlabel('Dimension 1')<br/>plt.ylabel('Dimension 2')<br/>plt.scatter(X_pca[:,0],X_pca[:,1],c=data.target,cmap=cmap_bold)<br/>plt.show()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nl"><img src="../Images/ce95fa2c69d5b8f99108db91828c6903.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gpKflAvXk7nzVyv7e938_A.png"/></div></div></figure><p id="562e" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">åœ¨è¯„ä¼°ç‰¹å¾çš„ä¸Šä¸‹æ–‡ä¸­ï¼Œé™ç»´çš„å¦ä¸€ä¸ªç”¨é€”æ˜¯ç”¨äºå¯è§†åŒ–:åœ¨è¾ƒä½ç»´åº¦çš„ç©ºé—´ä¸­ï¼Œæ›´å®¹æ˜“ä»è§†è§‰ä¸ŠéªŒè¯æ•°æ®æ˜¯å¦æ˜¯æ½œåœ¨å¯åˆ†çš„ï¼Œè¿™æœ‰åŠ©äºè®¾ç½®å¯¹åˆ†ç±»å‡†ç¡®æ€§çš„æœŸæœ›ã€‚åœ¨å®è·µä¸­ï¼Œæˆ‘ä»¬å¯¹ç‰¹å¾çš„å­é›†æ‰§è¡Œç»´åº¦ç¼©å‡(ä¾‹å¦‚ PCA ),å¹¶æ£€æŸ¥æ ‡ç­¾å¦‚ä½•åˆ†å¸ƒåœ¨ç¼©å‡çš„ç©ºé—´ä¸­ã€‚å¦‚æœå®ƒä»¬çœ‹èµ·æ¥æ˜¯åˆ†å¼€çš„ï¼Œè¿™æ˜¯ä¸€ä¸ªæ˜æ˜¾çš„è¿¹è±¡ï¼Œè¡¨æ˜ä½¿ç”¨è¿™ç»„ç‰¹å¾æ—¶ï¼Œé¢„æœŸä¼šæœ‰é«˜çš„åˆ†ç±»æ€§èƒ½ã€‚</p><p id="1a76" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">åœ¨ä¸‹é¢çš„ä¾‹å­ä¸­ï¼Œåœ¨ä¸€ä¸ª 2 ç»´çš„ç¼©å‡ç©ºé—´ä¸­ï¼Œä¸åŒçš„æ ‡ç­¾è¢«æ˜¾ç¤ºä¸ºæ˜¯ç›¸å½“å¯åˆ†çš„ã€‚è¿™è¡¨æ˜ï¼Œåœ¨è®­ç»ƒå’Œæµ‹è¯•åˆ†ç±»å™¨æ—¶ï¼Œäººä»¬å¯ä»¥æœŸå¾…é«˜æ€§èƒ½ã€‚</p><pre class="kj kk kl km gt na nb nc nd aw ne bi"><span id="d646" class="nf lr it nb b gy ng nh l ni nj">from sklearn.datasets import load_iris<br/>from sklearn.decomposition import PCA<br/>import matplotlib.pyplot as plt</span><span id="a2aa" class="nf lr it nb b gy nk nh l ni nj">from mlxtend.plotting import plot_pca_correlation_graph</span><span id="124e" class="nf lr it nb b gy nk nh l ni nj">data = load_iris()<br/>X, y = data.data, data.target</span><span id="32f4" class="nf lr it nb b gy nk nh l ni nj">plt.figure(figsize=(10,5))<br/>X_pca = PCA().fit_transform(X)<br/>plt.title('PCA - Iris dataset')<br/>plt.xlabel('Dimension 1')<br/>plt.ylabel('Dimension 2')<br/>plt.scatter(X_pca[:,0],X_pca[:,1],c=data.target)<br/>_ = plot_pca_correlation_graph(X,data.feature_names)</span></pre><div class="kj kk kl km gt ab cb"><figure class="nm kn nn no np nq nr paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><img src="../Images/ac5ae7ac9ea5304b194196e4e45c95e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1334/format:webp/1*VKxn9Ptu9U8MuxVZnWjhjQ.png"/></div></figure><figure class="nm kn ns no np nq nr paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><img src="../Images/afbc355101d608c32e6c4618cd66e03e.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*Vy1-UQWdKUIDvGlspg8KdA.png"/></div></figure></div><p id="d3ca" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">é™¤æ­¤ä¹‹å¤–ï¼Œæˆ‘è¿˜ç»˜åˆ¶äº†<strong class="kw iu">ç›¸å…³åœ†</strong>ï¼Œå®ƒæ˜¾ç¤ºäº†æ¯ä¸ªåŸå§‹ç»´åº¦å’Œæ–° PCA ç»´åº¦ä¹‹é—´çš„ç›¸å…³æ€§ã€‚ç›´è§‚åœ°è¯´ï¼Œè¯¥å›¾æ˜¾ç¤ºäº†æ¯ä¸ªåŸå§‹ç‰¹å¾å¯¹æ–°åˆ›å»ºçš„ PCA æˆåˆ†çš„è´¡çŒ®ã€‚åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼ŒèŠ±ç“£é•¿åº¦å’Œå®½åº¦ä¸ç¬¬ä¸€ä¸ªä¸»æˆåˆ†åˆ†æç»´åº¦é«˜åº¦ç›¸å…³ï¼Œè¼ç‰‡å®½åº¦å¯¹ç¬¬äºŒä¸ªç»´åº¦è´¡çŒ®å¾ˆå¤§ã€‚</p></div><div class="ab cl mo mp hx mq" role="separator"><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt"/></div><div class="im in io ip iq"><h1 id="38b6" class="lq lr it bd ls lt mv lv lw lx mw lz ma jz mx ka mc kc my kd me kf mz kg mg mh bi translated">å•å˜é‡æ»¤æ³¢æ–¹æ³•</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nt"><img src="../Images/7e5e41f7fa200eb5108f5f35d08af28d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jIDE_b7WsVO8JXaoHBiw6Q.jpeg"/></div></div></figure><p id="6099" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">è¿‡æ»¤æ–¹æ³•æ—¨åœ¨å¯¹ç‰¹å¾çš„é‡è¦æ€§è¿›è¡Œæ’åºï¼Œè€Œä¸ä½¿ç”¨ä»»ä½•ç±»å‹çš„åˆ†ç±»ç®—æ³•ã€‚</p><p id="14d3" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">å•å˜é‡è¿‡æ»¤æ–¹æ³•å•ç‹¬è¯„ä¼°æ¯ä¸ªç‰¹å¾ï¼Œå¹¶ä¸”ä¸è€ƒè™‘ç‰¹å¾çš„ç›¸äº’ä½œç”¨ã€‚è¿™äº›æ–¹æ³•åŒ…æ‹¬ä¸ºæ¯ä¸ªç‰¹å¾æä¾›ä¸€ä¸ªåˆ†æ•°ï¼Œé€šå¸¸åŸºäºç»Ÿè®¡æµ‹è¯•ã€‚</p><p id="023b" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">åˆ†æ•°é€šå¸¸æˆ–è€…æµ‹é‡å› å˜é‡å’Œç‰¹å¾ä¹‹é—´çš„ç›¸å…³æ€§(ä¾‹å¦‚ Chi2 å’Œç”¨äºå›å½’çš„ Pearls ç›¸å…³ç³»æ•°)ï¼Œæˆ–è€…æµ‹é‡ç»™å®šç±»åˆ«æ ‡ç­¾çš„ç‰¹å¾åˆ†å¸ƒä¹‹é—´çš„å·®å¼‚(f æ£€éªŒå’Œ T æ£€éªŒ)ã€‚</p><p id="88e3" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">åˆ†æ•°é€šå¸¸å¯¹åŸºç¡€æ•°æ®çš„ç»Ÿè®¡å±æ€§åšå‡ºå‡è®¾ã€‚ç†è§£è¿™äº›å‡è®¾å¯¹äºå†³å®šä½¿ç”¨å“ªç§æµ‹è¯•æ˜¯å¾ˆé‡è¦çš„ï¼Œå³ä½¿å…¶ä¸­ä¸€äº›å‡è®¾å¯¹äºè¿åå‡è®¾æ˜¯ç¨³å¥çš„ã€‚</p><p id="91d9" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">åŸºäºç»Ÿè®¡æµ‹è¯•çš„åˆ†æ•°æä¾›äº†ä¸€ä¸ª<strong class="kw iu"> p å€¼</strong>ï¼Œå¯ä»¥ç”¨æ¥æ’é™¤ä¸€äº›ç‰¹å¾ã€‚å¦‚æœ p å€¼é«˜äºæŸä¸ªé˜ˆå€¼(é€šå¸¸ä¸º 0.01 æˆ– 0.05)ï¼Œåˆ™ä¼šå‡ºç°è¿™ç§æƒ…å†µã€‚</p><p id="5b5d" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">å¸¸è§æµ‹è¯•åŒ…æ‹¬:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nu"><img src="../Images/7a2a3f018499cb9e3584353072ca51e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9yzAkKWbl4fcHfira31RPg.png"/></div></div></figure><p id="768c" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">åŒ…<code class="fe nv nw nx nb b">sklearn</code>å®ç°äº†ä¸€äº›è¿‡æ»¤æ–¹æ³•ã€‚ç„¶è€Œï¼Œç”±äºå¤§å¤šæ•°éƒ½æ˜¯åŸºäºç»Ÿè®¡æµ‹è¯•çš„ï¼Œæ‰€ä»¥ä¹Ÿå¯ä»¥ä½¿ç”¨ç»Ÿè®¡åŒ…(æ¯”å¦‚<code class="fe nv nw nx nb b">statsmodels</code>)ã€‚</p><p id="83bd" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­:</p><pre class="kj kk kl km gt na nb nc nd aw ne bi"><span id="defd" class="nf lr it nb b gy ng nh l ni nj">from sklearn.feature_selection import f_classif, chi2, mutual_info_classif<br/>from statsmodels.stats.multicomp import pairwise_tukeyhsd</span><span id="2b09" class="nf lr it nb b gy nk nh l ni nj">from sklearn.datasets import load_iris</span><span id="3940" class="nf lr it nb b gy nk nh l ni nj">data = load_iris()<br/>X,y = data.data, data.target</span><span id="a5a9" class="nf lr it nb b gy nk nh l ni nj">chi2_score, chi_2_p_value = chi2(X,y)<br/>f_score, f_p_value = f_classif(X,y)<br/>mut_info_score = mutual_info_classif(X,y)</span><span id="06f2" class="nf lr it nb b gy nk nh l ni nj">pairwise_tukeyhsd = [list(pairwise_tukeyhsd(X[:,i],y).reject) for i in range(4)]</span><span id="1409" class="nf lr it nb b gy nk nh l ni nj">print('chi2 score        ', chi2_score)<br/>print('chi2 p-value      ', chi_2_p_value)<br/>print('F - score score   ', f_score)<br/>print('F - score p-value ', f_p_value)<br/>print('mutual info       ', mut_info_score)<br/>print('pairwise_tukeyhsd',pairwise_tukeyhsd)</span><span id="03b3" class="nf lr it nb b gy nk nh l ni nj">Out:</span><span id="4ebe" class="nf lr it nb b gy nk nh l ni nj">chi2 score         [ 10.82   3.71 116.31  67.05]<br/>chi2 p-value       [0.   0.16 0.   0.  ]<br/>F - score score    [ 119.26   49.16 1180.16  960.01]<br/>F - score p-value  [0. 0. 0. 0.]<br/>mutual info        [0.51 0.27 0.98 0.98]<br/>pairwise_tukeyhsd [[True, True, True], [True, True, True], [True, True, True], [True, True, True]]</span></pre><h2 id="0177" class="nf lr it bd ls ny nz dn lw oa ob dp ma ld oc od mc lh oe of me ll og oh mg oi bi translated">å¯¹ç‰¹å¾è¿›è¡Œåˆ†çº§çš„å¯è§†åŒ–æ–¹æ³•</h2><h2 id="409a" class="nf lr it bd ls ny nz dn lw oa ob dp ma ld oc od mc lh oe of me ll og oh mg oi bi translated">ç®±çº¿å›¾å’Œå°æç´å›¾</h2><p id="aa5f" class="pw-post-body-paragraph ku kv it kw b kx mi ju kz la mj jx lc ld mk lf lg lh ml lj lk ll mm ln lo lp im bi translated">ç®±çº¿å›¾/å°æç´å›¾å¯èƒ½æœ‰åŠ©äºå¯è§†åŒ–ç»™å®šç±»åˆ«çš„ç‰¹å¾åˆ†å¸ƒã€‚å¯¹äº Iris æ•°æ®é›†ï¼Œä¸‹é¢æ˜¾ç¤ºäº†ä¸€ä¸ªç¤ºä¾‹ã€‚</p><p id="b158" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">è¿™æ˜¯æœ‰ç”¨çš„ï¼Œå› ä¸ºç»Ÿè®¡æµ‹è¯•é€šå¸¸åªè¯„ä¼°è¿™ç§åˆ†å¸ƒçš„å¹³å‡å€¼ä¹‹é—´çš„å·®å¼‚ã€‚å› æ­¤ï¼Œè¿™äº›å›¾æä¾›äº†å…³äºç‰¹å¾è´¨é‡çš„æ›´å¤šä¿¡æ¯</p><pre class="kj kk kl km gt na nb nc nd aw ne bi"><span id="5232" class="nf lr it nb b gy ng nh l ni nj">import pandas as pd<br/>import seaborn as sns<br/>sns.set()<br/>df = pd.DataFrame(data.data,columns=data.feature_names)<br/>df['target'] = data.target</span><span id="ef2c" class="nf lr it nb b gy nk nh l ni nj">df_temp = pd.melt(df,id_vars='target',value_vars=list(df.columns)[:-1], <br/>                  var_name="Feature", value_name="Value")<br/>g = sns.FacetGrid(data = df_temp, col="Feature", col_wrap=4, size=4.5,sharey = False)<br/>g.map(sns.boxplot,"target", "Value");<br/>g = sns.FacetGrid(data = df_temp, col="Feature", col_wrap=4, size=4.5,sharey = False)<br/>g.map(sns.violinplot,"target", "Value");</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oj"><img src="../Images/139b23735e4b1d14003bbc69ccbbe16e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sUEZlf2dWElWkaGEdYwpKQ.png"/></div></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oj"><img src="../Images/f728131dcfcc10716c9e271d6970e0b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9vKO5ytVs1UdZDwPsWk6jg.png"/></div></div></figure><h2 id="9ce2" class="nf lr it bd ls ny nz dn lw oa ob dp ma ld oc od mc lh oe of me ll og oh mg oi bi translated">ç”¨ ROC æ›²çº¿è¿›è¡Œç‰¹å¾æ’åº</h2><p id="9070" class="pw-post-body-paragraph ku kv it kw b kx mi ju kz la mj jx lc ld mk lf lg lh ml lj lk ll mm ln lo lp im bi translated">ROC æ›²çº¿å¯ç”¨äºæŒ‰é‡è¦æ€§é¡ºåºæ’åˆ—ç‰¹å¾ï¼Œè¿™ç»™å‡ºäº†æ’åˆ—ç‰¹å¾æ€§èƒ½çš„ç›´è§‚æ–¹å¼ã€‚</p><p id="a771" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">è¿™ç§æŠ€æœ¯æœ€é€‚åˆäºŒè¿›åˆ¶åˆ†ç±»ä»»åŠ¡ã€‚ä¸ºäº†åº”ç”¨äºå¤šç±»é—®é¢˜ï¼Œå¯ä»¥ä½¿ç”¨<strong class="kw iu">å¾®è§‚æˆ–å®è§‚</strong>å¹³å‡å€¼æˆ–åŸºäºå¤šé‡æ¯”è¾ƒçš„æ ‡å‡†(ç±»ä¼¼äºæˆå¯¹ Tukey çš„èŒƒå›´æµ‹è¯•)ã€‚</p><p id="6e84" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">ä»¥ä¸‹ç¤ºä¾‹ç»˜åˆ¶äº†å„ç§ç‰¹å¾çš„ ROC æ›²çº¿ã€‚</p><pre class="kj kk kl km gt na nb nc nd aw ne bi"><span id="1d7a" class="nf lr it nb b gy ng nh l ni nj">from sklearn.datasets import load_iris<br/>import matplotlib.pyplot as plt<br/>from sklearn.metrics import auc<br/>import numpy as np</span><span id="7551" class="nf lr it nb b gy nk nh l ni nj"># loading dataset<br/>data = load_iris()<br/>X, y = data.data, data.target</span><span id="881b" class="nf lr it nb b gy nk nh l ni nj">y_ = y == 2</span><span id="cbfb" class="nf lr it nb b gy nk nh l ni nj">plt.figure(figsize=(13,7))<br/>for col in range(X.shape[1]):<br/>    tpr,fpr = [],[]<br/>    for threshold in np.linspace(min(X[:,col]),max(X[:,col]),100):<br/>        detP = X[:,col] &lt; threshold<br/>        tpr.append(sum(detP &amp; y_)/sum(y_))# TP/P, aka recall<br/>        fpr.append(sum(detP &amp; (~y_))/sum((~y_)))# FP/N<br/>        <br/>    if auc(fpr,tpr) &lt; .5:<br/>        aux = tpr<br/>        tpr = fpr<br/>        fpr = aux<br/>    plt.plot(fpr,tpr,label=data.feature_names[col] + ', auc = '\<br/>                           + str(np.round(auc(fpr,tpr),decimals=3)))</span><span id="4534" class="nf lr it nb b gy nk nh l ni nj">plt.title('ROC curve - Iris features')<br/>plt.xlabel('False Positive Rate')<br/>plt.ylabel('True Positive Rate')<br/>plt.legend()<br/>plt.show()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ok"><img src="../Images/50b9e1db56b6eca835a735205ca0f145.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HBynkzQShYDrenQ6SafB1A.png"/></div></div></figure></div><div class="ab cl mo mp hx mq" role="separator"><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt"/></div><div class="im in io ip iq"><h1 id="76f4" class="lq lr it bd ls lt mv lv lw lx mw lz ma jz mx ka mc kc my kd me kf mz kg mg mh bi translated">å¤šå…ƒæ»¤æ³¢æ–¹æ³•</h1><p id="4b50" class="pw-post-body-paragraph ku kv it kw b kx mi ju kz la mj jx lc ld mk lf lg lh ml lj lk ll mm ln lo lp im bi translated">è¿™äº›æ–¹æ³•è€ƒè™‘äº†å˜é‡ä¹‹é—´çš„ç›¸å…³æ€§ï¼Œè€Œæ²¡æœ‰è€ƒè™‘ä»»ä½•ç±»å‹çš„åˆ†ç±»ç®—æ³•ã€‚</p><h2 id="fb24" class="nf lr it bd ls ny nz dn lw oa ob dp ma ld oc od mc lh oe of me ll og oh mg oi bi translated">mRMR</h2><p id="7a9e" class="pw-post-body-paragraph ku kv it kw b kx mi ju kz la mj jx lc ld mk lf lg lh ml lj lk ll mm ln lo lp im bi translated"><strong class="kw iu"> mRMR(æœ€å°å†—ä½™æœ€å¤§ç›¸å…³æ€§)</strong>æ˜¯ä¸€ç§å¯å‘å¼ç®—æ³•ï¼Œé€šè¿‡è€ƒè™‘ç‰¹å¾çš„é‡è¦æ€§å’Œå®ƒä»¬ä¹‹é—´çš„ç›¸å…³æ€§æ¥å¯»æ‰¾æ¥è¿‘æœ€ä¼˜çš„ç‰¹å¾å­é›†ã€‚</p><p id="54cb" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">å…¶æ€æƒ³æ˜¯ï¼Œå³ä½¿ä¸¤ä¸ªç‰¹å¾é«˜åº¦ç›¸å…³ï¼Œå¦‚æœå®ƒä»¬é«˜åº¦ç›¸å…³ï¼Œå°†å®ƒä»¬éƒ½æ·»åŠ åˆ°ç‰¹å¾é›†ä¸­å¯èƒ½ä¸æ˜¯ä¸€ä¸ªå¥½ä¸»æ„ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ·»åŠ ä¸¤ä¸ªç‰¹å¾ä¼šå¢åŠ æ¨¡å‹çš„å¤æ‚æ€§(å¢åŠ è¿‡åº¦æ‹Ÿåˆçš„å¯èƒ½æ€§)ï¼Œä½†ç”±äºç‰¹å¾ä¹‹é—´çš„ç›¸å…³æ€§ï¼Œä¸ä¼šæ·»åŠ é‡è¦çš„ä¿¡æ¯ã€‚</p><p id="a9a0" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">åœ¨ä¸€ç»„<em class="ol"> N </em>ç‰¹å¾çš„<em class="ol"> S </em>ä¸­ï¼Œç‰¹å¾çš„ç›¸å…³æ€§(<em class="ol"> D </em>)è®¡ç®—å¦‚ä¸‹:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi om"><img src="../Images/c72ee438e7f2c782f06ea33ee612cc01.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yen7gH_IF_rexfVd3oed1g.png"/></div></div></figure><p id="57b8" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">å…¶ä¸­<em class="ol"> I </em>ä¸ºäº’ä¿¡æ¯ç®—å­ã€‚</p><p id="f232" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">ç‰¹å¾çš„å†—ä½™è¡¨ç¤ºå¦‚ä¸‹:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi on"><img src="../Images/6f6bb753f5b3f35a1df3bd428489e603.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pyHFTZB4YU8khRqa3xCN-A.png"/></div></div></figure><p id="9ff4" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">é›†åˆ<em class="ol"> S </em>çš„ mRMR åˆ†æ•°å®šä¹‰ä¸º(<em class="ol"> D - R) </em>ã€‚ç›®æ ‡æ˜¯æ‰¾åˆ°å…·æœ‰æœ€å¤§å€¼(<em class="ol"> D-R) </em>çš„ç‰¹å¾å­é›†ã€‚ç„¶è€Œï¼Œåœ¨å®è·µä¸­ï¼Œæˆ‘ä»¬æ‰§è¡Œå¢é‡æœç´¢(ä¹Ÿç§°ä¸ºå‰å‘é€‰æ‹©)ï¼Œåœ¨æ¯ä¸€æ­¥ï¼Œæˆ‘ä»¬æ·»åŠ äº§ç”Ÿæœ€å¤§ mRMR çš„ç‰¹å¾ã€‚</p><p id="b399" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">è¯¥ç®—æ³•ç”±ç®—æ³•ä½œè€…è‡ªå·±ç”¨ C å®ç°ã€‚ä½ å¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°è¿™ä¸ªåŒ…çš„æºä»£ç ï¼Œä»¥åŠåŸå§‹è®ºæ–‡<a class="ae oo" href="http://home.penglab.com/proj/mRMR/" rel="noopener ugc nofollow" target="_blank">ã€‚</a></p><p id="e564" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">åœ¨åç§°<code class="fe nv nw nx nb b">pymrmr</code>ä¸Šåˆ›å»ºäº†ä¸€ä¸ª(æœªç»´æŠ¤çš„)python åŒ…è£…å™¨ã€‚å¦‚æœ<code class="fe nv nw nx nb b">pymrmr</code>æœ‰é—®é¢˜ï¼Œæˆ‘å»ºè®®ç›´æ¥è°ƒç”¨ C çº§å‡½æ•°ã€‚</p><p id="4345" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">ä¸‹é¢çš„ä»£ç ä¸¾ä¾‹è¯´æ˜äº†<code class="fe nv nw nx nb b">pymrmr</code>çš„ç”¨æ³•ã€‚æ³¨æ„ï¼Œ<code class="fe nv nw nx nb b">pandas</code>æ•°æ®å¸§çš„åˆ—åº”æŒ‰ç…§ C çº§åŒ…ä¸­çš„æè¿°è¿›è¡Œæ ¼å¼åŒ–(æ­¤å¤„<a class="ae oo" href="http://home.penglab.com/proj/mRMR/" rel="noopener ugc nofollow" target="_blank">ä¸º</a>)ã€‚</p><pre class="kj kk kl km gt na nb nc nd aw ne bi"><span id="05d7" class="nf lr it nb b gy ng nh l ni nj">import pandas as pd<br/>import pymrmr</span><span id="6788" class="nf lr it nb b gy nk nh l ni nj">df = pd.read_csv('some_df.csv')<br/># Pass a dataframe with a predetermined configuration. <br/># Check http://home.penglab.com/proj/mRMR/ for the dataset requirements<br/>pymrmr.mRMR(df, 'MIQ', 10)</span></pre><p id="48ba" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">è¾“å‡º:</p><pre class="kj kk kl km gt na nb nc nd aw ne bi"><span id="cb1c" class="nf lr it nb b gy ng nh l ni nj">*** This program and the respective minimum Redundancy Maximum Relevance (mRMR)<br/>     algorithm were developed by Hanchuan Peng &lt;hanchuan.peng@gmail.com&gt;for<br/>     the paper<br/>     "Feature selection based on mutual information: criteria of<br/>      max-dependency, max-relevance, and min-redundancy,"<br/>      Hanchuan Peng, Fuhui Long, and Chris Ding,<br/>      IEEE Transactions on Pattern Analysis and Machine Intelligence,<br/>      Vol. 27, No. 8, pp.1226-1238, 2005.</span><span id="6bba" class="nf lr it nb b gy nk nh l ni nj">*** MaxRel features ***<br/> Order    Fea     Name    Score<br/> 1        765     v765    0.375<br/> 2        1423    v1423   0.337<br/> 3        513     v513    0.321<br/> 4        249     v249    0.309<br/> 5        267     v267    0.304<br/> 6        245     v245    0.304<br/> 7        1582    v1582   0.280<br/> 8        897     v897    0.269<br/> 9        1771    v1771   0.269<br/> 10       1772    v1772   0.269</span><span id="5974" class="nf lr it nb b gy nk nh l ni nj">*** mRMR features ***<br/> Order    Fea     Name    Score<br/> 1        765     v765    0.375<br/> 2        1123    v1123   24.913<br/> 3        1772    v1772   3.984<br/> 4        286     v286    2.280<br/> 5        467     v467    1.979<br/> 6        377     v377    1.768<br/> 7        513     v513    1.803<br/> 8        1325    v1325   1.634<br/> 9        1972    v1972   1.741<br/> 10       1412    v1412   1.689<br/>Out[1]:<br/> ['v765',<br/>  'v1123',<br/>  'v1772',<br/>  'v286',<br/>  'v467',<br/>  'v377',<br/>  'v513',<br/>  'v1325',<br/>  'v1972',<br/>  'v1412']</span></pre></div><div class="ab cl mo mp hx mq" role="separator"><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt"/></div><div class="im in io ip iq"><h1 id="1c0b" class="lq lr it bd ls lt mv lv lw lx mw lz ma jz mx ka mc kc my kd me kf mz kg mg mh bi translated">åŒ…è£…æ–¹æ³•</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nt"><img src="../Images/3c32fccd789e2dc4e40fd41775af2147.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WnQSTzwrPVkCWxb3MRV4SA.jpeg"/></div></div></figure><p id="c595" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">åŒ…è£…å™¨æ–¹æ³•èƒŒåçš„ä¸»è¦æ€æƒ³æ˜¯æœç´¢å“ªç»„ç‰¹æ€§æœ€é€‚åˆç‰¹å®šçš„åˆ†ç±»å™¨ã€‚è¿™äº›æ–¹æ³•å¯ä»¥æ€»ç»“å¦‚ä¸‹ï¼Œå¹¶ä¸”åœ¨æ‰€ä½¿ç”¨çš„æœç´¢ç®—æ³•æ–¹é¢æœ‰æ‰€ä¸åŒã€‚</p><ol class=""><li id="75f7" class="op oq it kw b kx ky la lb ld or lh os ll ot lp ou ov ow ox bi translated">é€‰æ‹©ä¸€ä¸ªæ€§èƒ½æŒ‡æ ‡(å¯èƒ½æ€§ã€AICã€BICã€F1 åˆ†æ•°ã€å‡†ç¡®åº¦ã€MSEã€MAEâ€¦)ï¼Œè®°ä¸º<strong class="kw iu"> M. </strong></li><li id="fc29" class="op oq it kw b kx oy la oz ld pa lh pb ll pc lp ou ov ow ox bi translated">é€‰æ‹©ä¸€ä¸ªåˆ†ç±»å™¨/å›å½’å™¨/ â€¦ï¼Œåœ¨è¿™é‡Œè®°ä¸º<strong class="kw iu"> C </strong>ã€‚</li><li id="7412" class="op oq it kw b kx oy la oz ld pa lh pb ll pc lp ou ov ow ox bi translated"><strong class="kw iu">ç”¨ç»™å®šçš„æœç´¢æ–¹æ³•æœç´¢</strong>ä¸åŒçš„ç‰¹å¾å­é›†ã€‚å¯¹äºæ¯ä¸ªå­é›†<strong class="kw iu"> Sï¼Œ</strong>æ‰§è¡Œä»¥ä¸‹æ“ä½œ:</li></ol><ul class=""><li id="416a" class="op oq it kw b kx ky la lb ld or lh os ll ot lp pd ov ow ox bi translated">ä½¿ç”¨<strong class="kw iu"> S </strong>ä½œä¸ºåˆ†ç±»å™¨çš„ç‰¹å¾ï¼Œä»¥äº¤å‰éªŒè¯çš„æ–¹å¼è®­ç»ƒå’Œæµ‹è¯•<strong class="kw iu">C</strong>ï¼›</li><li id="34b9" class="op oq it kw b kx oy la oz ld pa lh pb ll pc lp pd ov ow ox bi translated">ä»äº¤å‰éªŒè¯ç¨‹åºä¸­è·å¾—å¹³å‡åˆ†æ•°(å¯¹äºæŒ‡æ ‡<strong class="kw iu"> M </strong>)ï¼Œå¹¶å°†è¯¥åˆ†æ•°åˆ†é…ç»™å­é›†<strong class="kw iu">S</strong>ï¼›</li><li id="4dc5" class="op oq it kw b kx oy la oz ld pa lh pb ll pc lp pd ov ow ox bi translated">é€‰æ‹©ä¸€ä¸ªæ–°çš„å­é›†å¹¶é‡åšæ­¥éª¤<em class="ol">ä¸€ä¸ª</em>ã€‚</li></ul><h2 id="ba15" class="nf lr it bd ls ny nz dn lw oa ob dp ma ld oc od mc lh oe of me ll og oh mg oi bi translated">è¯¦è¿°æ­¥éª¤ 3</h2><p id="4a3c" class="pw-post-body-paragraph ku kv it kw b kx mi ju kz la mj jx lc ld mk lf lg lh ml lj lk ll mm ln lo lp im bi translated">ç¬¬ä¸‰æ­¥æœªæŒ‡å®šå°†ä½¿ç”¨å“ªç§ç±»å‹çš„æœç´¢æ–¹æ³•ã€‚å‡ ä¹åœ¨ä»»ä½•æƒ…å†µä¸‹ï¼Œæµ‹è¯•æ‰€æœ‰å¯èƒ½çš„ç‰¹å¾å­é›†éƒ½æ˜¯ç¦æ­¢çš„(<strong class="kw iu">å¼ºåŠ›é€‰æ‹©</strong>)ï¼Œå› ä¸ºè¿™å°†éœ€è¦æ‰§è¡Œæ­¥éª¤ 3 æŒ‡æ•°æ¬¡(ç‰¹å¾æ•°é‡çš„ 2 æ¬¡æ–¹)ã€‚é™¤äº†æ—¶é—´å¤æ‚æ€§ä¹‹å¤–ï¼Œç”±äºæœ‰å¦‚æ­¤å¤§é‡çš„å¯èƒ½æ€§ï¼Œå¾ˆå¯èƒ½æŸä¸ªç‰¹å¾ç»„åˆä»…ä»…æ˜¯éšæœºåœ°è¡¨ç°å¾—æœ€å¥½ï¼Œè¿™ä½¿å¾—å¼ºåŠ›è§£å†³æ–¹æ¡ˆæ›´å®¹æ˜“è¿‡åº¦æ‹Ÿåˆã€‚</p><p id="e3c6" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">æœç´¢ç®—æ³•åœ¨å®è·µä¸­å¾€å¾€èƒ½å¾ˆå¥½åœ°è§£å†³è¿™ä¸ªé—®é¢˜ã€‚å®ƒä»¬å€¾å‘äºå®ç°æ¥è¿‘è›®åŠ›è§£å†³æ–¹æ¡ˆçš„æ€§èƒ½ï¼Œå…·æœ‰æ›´å°‘çš„æ—¶é—´å¤æ‚åº¦å’Œæ›´å°‘çš„è¿‡æ‹Ÿåˆæœºä¼šã€‚</p><p id="592f" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><strong class="kw iu">æ­£å‘é€‰æ‹©</strong>å’Œ<strong class="kw iu">åå‘é€‰æ‹©</strong>(åˆå<strong class="kw iu">ä¿®å‰ª</strong>)åœ¨å®è·µä¸­è¢«å¤§é‡ä½¿ç”¨ï¼Œä»¥åŠå®ƒä»¬çš„æœç´¢è¿‡ç¨‹çš„ä¸€äº›å°å˜åŒ–ã€‚</p><p id="b2d3" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">åå‘é€‰æ‹©åŒ…æ‹¬ä»å…·æœ‰å…¨éƒ¨ç‰¹å¾çš„æ¨¡å‹å¼€å§‹ï¼Œå¹¶ä¸”åœ¨æ¯ä¸€æ­¥ä¸­ï¼Œç§»é™¤æ²¡æœ‰ç‰¹å¾çš„æ¨¡å‹å…·æœ‰æœ€é«˜åˆ†æ•°ã€‚æ­£å‘é€‰æ‹©ä»¥ç›¸åçš„æ–¹å¼è¿›è¡Œ:å®ƒä»ä¸€ç»„ç©ºçš„ç‰¹å¾å¼€å§‹ï¼Œå¹¶æ·»åŠ æœ€èƒ½æé«˜å½“å‰åˆ†æ•°çš„ç‰¹å¾ã€‚</p><p id="8f7c" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">å‘å‰/å‘åé€‰æ‹©ä»ç„¶å€¾å‘äºè¿‡åº¦æ‹Ÿåˆï¼Œå› ä¸ºé€šå¸¸ï¼Œåˆ†æ•°å€¾å‘äºé€šè¿‡æ·»åŠ æ›´å¤šç‰¹å¾æ¥æé«˜ã€‚é¿å…è¿™ç§æƒ…å†µçš„ä¸€ç§æ–¹æ³•æ˜¯ä½¿ç”¨æƒ©ç½šæ¨¡å‹å¤æ‚æ€§çš„åˆ†æ•°ï¼Œå¦‚ AIC æˆ– BICã€‚</p><p id="e1db" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">åŒ…è£…æ–¹æ³•ç»“æ„çš„å›¾ç¤ºå¦‚ä¸‹ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œç‰¹å¾é›†æ˜¯(1)é€šè¿‡<strong class="kw iu">æœç´¢æ–¹æ³•</strong>æ‰¾åˆ°çš„ï¼Œä»¥åŠ(2)åœ¨æ‰“ç®—ä½¿ç”¨çš„åŒä¸€åˆ†ç±»å™¨ä¸Šäº¤å‰éªŒè¯çš„<strong class="kw iu">ã€‚</strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pe"><img src="../Images/802383a82247dda57e760559b05928e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AD2W_y3UP7pqOW197uiVXQ.png"/></div></div></figure><p id="9432" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">ç¬¬ä¸‰æ­¥è¿˜å¼€æ”¾äº†äº¤å‰éªŒè¯å‚æ•°ã€‚é€šå¸¸ï¼Œä½¿ç”¨ k-fold ç¨‹åºã€‚ç„¶è€Œï¼Œä½¿ç”¨å¤§ k ä¼šç»™æ•´ä¸ªåŒ…è£…å™¨æ–¹æ³•å¸¦æ¥é¢å¤–çš„å¤æ‚æ€§ã€‚</p><h2 id="8dfb" class="nf lr it bd ls ny nz dn lw oa ob dp ma ld oc od mc lh oe of me ll og oh mg oi bi translated">åŒ…è£…æ–¹æ³•çš„ Python åŒ…</h2><p id="8b65" class="pw-post-body-paragraph ku kv it kw b kx mi ju kz la mj jx lc ld mk lf lg lh ml lj lk ll mm ln lo lp im bi translated">(<a class="ae oo" href="http://rasbt.github.io/mlxtend/" rel="noopener ugc nofollow" target="_blank">http://rasbt.github.io/mlxtend/</a>)æ˜¯ä¸€ä¸ªç”¨äºå„ç§æ•°æ®ç§‘å­¦ç›¸å…³ä»»åŠ¡çš„æœ‰ç”¨åŒ…ã€‚è¿™ä¸ªåŒ…çš„åŒ…è£…æ–¹æ³•å¯ä»¥åœ¨ SequentialFeatureSelector ä¸Šæ‰¾åˆ°ã€‚å®ƒæä¾›å‘å‰å’Œå‘åçš„åŠŸèƒ½é€‰æ‹©ï¼Œæœ‰äº›å˜åŒ–ã€‚</p><p id="912e" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">è¯¥åŒ…è¿˜æä¾›äº†ä¸€ç§é€šè¿‡å‡½æ•° plot _ sequential _ feature _ selection å°†åˆ†æ•°å¯è§†åŒ–ä¸ºè¦ç´ æ•°é‡çš„å‡½æ•°çš„æ–¹æ³•ã€‚</p><p id="e451" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">ä¸‹é¢çš„ä¾‹å­æ‘˜è‡ªåŒ…çš„ä¸»é¡µã€‚</p><pre class="kj kk kl km gt na nb nc nd aw ne bi"><span id="2f2e" class="nf lr it nb b gy ng nh l ni nj">from mlxtend.feature_selection import SequentialFeatureSelector as SFS<br/>from mlxtend.plotting import plot_sequential_feature_selection as plot_sfs</span><span id="9080" class="nf lr it nb b gy nk nh l ni nj">from sklearn.linear_model import LinearRegression<br/>from sklearn.datasets import load_boston</span><span id="82e9" class="nf lr it nb b gy nk nh l ni nj">boston = load_boston()<br/>X, y = boston.data, boston.target</span><span id="388c" class="nf lr it nb b gy nk nh l ni nj">lr = LinearRegression()</span><span id="8ae3" class="nf lr it nb b gy nk nh l ni nj">sfs = SFS(lr, <br/>          k_features=13, <br/>          forward=True, <br/>          floating=False, <br/>          scoring='neg_mean_squared_error',<br/>          cv=10)</span><span id="4452" class="nf lr it nb b gy nk nh l ni nj">sfs = sfs.fit(X, y)<br/>fig = plot_sfs(sfs.get_metric_dict(), kind='std_err')</span><span id="11a2" class="nf lr it nb b gy nk nh l ni nj">plt.title('Sequential Forward Selection (w. StdErr)')<br/>plt.grid()<br/>plt.show()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pf"><img src="../Images/e3c001c9151ac4fa0b510c5a02a8f137.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LPL7lJUoc5bulhek4eSqHg.png"/></div></div></figure></div><div class="ab cl mo mp hx mq" role="separator"><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt"/></div><div class="im in io ip iq"><h1 id="31e0" class="lq lr it bd ls lt mv lv lw lx mw lz ma jz mx ka mc kc my kd me kf mz kg mg mh bi translated">åµŒå…¥å¼æ–¹æ³•</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nt"><img src="../Images/1036bc5f088c2e39c2d3dd3ed07587af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fcDzWPA_fj5TLJcKvfvFNA.jpeg"/></div></div></figure><p id="8c60" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">è®­ç»ƒä¸€ä¸ªåˆ†ç±»å™¨å½’ç»“ä¸ºä¸€ä¸ªä¼˜åŒ–é—®é¢˜ï¼Œå…¶ä¸­æˆ‘ä»¬è¯•å›¾æœ€å°åŒ–å…¶å‚æ•°çš„å‡½æ•°(è¿™é‡Œè®°ä¸ºğœƒ).è¿™ä¸ªå‡½æ•°è¢«ç§°ä¸º<strong class="kw iu">æŸå¤±å‡½æ•°</strong>(è®°ä¸ºğ¿(ğœƒ)).</p><p id="6212" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">åœ¨ä¸€ä¸ªæ›´ä¸€èˆ¬çš„æ¡†æ¶ä¸­ï¼Œæˆ‘ä»¬é€šå¸¸å¸Œæœ›æœ€å°åŒ–ä¸€ä¸ª<strong class="kw iu">ç›®æ ‡</strong> <strong class="kw iu">å‡½æ•°</strong>ï¼Œå®ƒè€ƒè™‘äº†æŸå¤±å‡½æ•°å’Œå¯¹æ¨¡å‹å¤æ‚æ€§çš„<strong class="kw iu">æƒ©ç½š</strong>(æˆ–<strong class="kw iu">æ­£åˆ™åŒ–</strong>)(Ï‰(ğœƒ):</p><p id="e6b2" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><strong class="kw iu">obj(ğœƒ)=ğ¿(ğœƒ)+Ï‰(ğœƒ)</strong></p><h2 id="aac7" class="nf lr it bd ls ny nz dn lw oa ob dp ma ld oc od mc lh oe of me ll og oh mg oi bi translated">çº¿æ€§åˆ†ç±»å™¨çš„åµŒå…¥å¼æ–¹æ³•</h2><p id="de36" class="pw-post-body-paragraph ku kv it kw b kx mi ju kz la mj jx lc ld mk lf lg lh ml lj lk ll mm ln lo lp im bi translated">å¯¹äºçº¿æ€§åˆ†ç±»å™¨(ä¾‹å¦‚çº¿æ€§ SVMã€é€»è¾‘å›å½’)ï¼ŒæŸå¤±å‡½æ•°è¡¨ç¤ºä¸º:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pg"><img src="../Images/4ed5c415735e80b4ff00a69af9bba0ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WMNgbzXySRWOdeF1UpXMgA.png"/></div></div></figure><p id="8c94" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">å…¶ä¸­æ¯ä¸ª<strong class="kw iu"> xÊ² </strong>å¯¹åº”ä¸€ä¸ªæ•°æ®æ ·æœ¬ï¼Œè€Œ<strong class="kw iu"> Wáµ€xÊ² </strong>è¡¨ç¤ºç³»æ•°å‘é‡<strong class="kw iu"> (wâ‚,wâ‚‚,â€¦w_n) </strong>ä¸æ¯ä¸ªæ ·æœ¬ä¸­çš„ç‰¹å¾çš„å†…ç§¯ã€‚</p><p id="af00" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">å¯¹äºçº¿æ€§ SVM å’Œé€»è¾‘å›å½’ï¼Œé“°é“¾å’Œé€»è¾‘æŸå¤±åˆ†åˆ«ä¸º:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ph"><img src="../Images/374ed9d883368ffef81534d5ec71c1ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*U5ondXRt899RK0Es_leR1Q.png"/></div></div></figure><p id="2de0" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">çº¿æ€§åˆ†ç±»å™¨çš„ä¸¤ä¸ªæœ€å¸¸è§çš„æƒ©ç½šæ˜¯ L-1 å’Œ L-2 æƒ©ç½š:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pi"><img src="../Images/6345941828d0741f0287178b18657b41.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eRoW4R-M9jEY4E0pXy3IYA.png"/></div></div></figure><p id="bf8a" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><strong class="kw iu"> Î» </strong>çš„å€¼è¶Šé«˜ï¼Œæƒ©ç½šè¶Šå¼ºï¼Œæœ€ä¼˜ç›®æ ‡å‡½æ•°å°†è¶‹å‘äºä»¥<strong class="kw iu">æ”¶ç¼©</strong>è¶Šæ¥è¶Šå¤šçš„ç³»æ•°<strong class="kw iu"> w_i </strong>è€Œç»“æŸã€‚</p><p id="3d35" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">ä¼—æ‰€å‘¨çŸ¥ï¼Œâ€œL1â€æƒ©ç½šä¼šåˆ›å»ºç¨€ç–æ¨¡å‹ï¼Œè¿™ç®€å•åœ°æ„å‘³ç€ï¼Œåœ¨ä¼˜åŒ–è¿‡ç¨‹ä¸­ï¼Œé€šè¿‡ä½¿ä¸€äº›ç³»æ•°ç­‰äºé›¶ï¼Œå®ƒå€¾å‘äº<strong class="kw iu">ä»æ¨¡å‹ä¸­é€‰æ‹©ä¸€äº›ç‰¹å¾ã€‚</strong></p><p id="98c1" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">å¦ä¸€ä¸ªå¸¸è§çš„å¤„ç½šæ˜¯ L-2ã€‚è™½ç„¶ L-2 ç¼©å°äº†ç³»æ•°ï¼Œå› æ­¤æœ‰åŠ©äºé¿å…è¿‡æ‹Ÿåˆï¼Œä½†å®ƒä¸ä¼šåˆ›å»ºç¨€ç–æ¨¡å‹ï¼Œå› æ­¤å®ƒä¸é€‚åˆä½œä¸ºç‰¹å¾é€‰æ‹©æŠ€æœ¯ã€‚</p><p id="a05a" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">å¯¹äºä¸€äº›çº¿æ€§åˆ†ç±»å™¨(çº¿æ€§ SVMï¼Œé€»è¾‘å›å½’)ï¼Œå¯ä»¥æœ‰æ•ˆåœ°ä½¿ç”¨ L-1 ç½šåˆ†ï¼Œè¿™æ„å‘³ç€æœ‰æœ‰æ•ˆçš„æ•°å€¼æ–¹æ³•æ¥ä¼˜åŒ–æœ€ç»ˆçš„ç›®æ ‡å‡½æ•°ã€‚å¯¹äºå…¶ä»–å‡ ä¸ªåˆ†ç±»å™¨(å„ç§æ ¸ SVM æ–¹æ³•ã€å†³ç­–æ ‘ç­‰ç­‰)ï¼Œæƒ…å†µå°±ä¸ä¸€æ ·äº†ã€‚å› æ­¤ï¼Œ<strong class="kw iu">ä¸åŒçš„åˆ†ç±»å™¨åº”è¯¥ä½¿ç”¨ä¸åŒçš„æ­£åˆ™åŒ–æ–¹æ³•</strong>ã€‚</p><p id="874e" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">å¸¦æœ‰æ­£åˆ™åŒ–çš„é€»è¾‘å›å½’ç¤ºä¾‹å¦‚ä¸‹æ‰€ç¤ºï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œéšç€ C çš„å‡å°‘ï¼Œç®—æ³•æ’é™¤äº†ä¸€äº›ç‰¹å¾(æƒ³æƒ³å¦‚æœ<strong class="kw iu"> C </strong>ä¸º<strong class="kw iu"> 1/Î» </strong>)ã€‚</p><pre class="kj kk kl km gt na nb nc nd aw ne bi"><span id="b8b6" class="nf lr it nb b gy ng nh l ni nj">import numpy as np<br/>import matplotlib.pyplot as plt</span><span id="f23d" class="nf lr it nb b gy nk nh l ni nj">from sklearn.svm import LinearSVC<br/>from sklearn.model_selection import ShuffleSplit<br/>from sklearn.model_selection import GridSearchCV<br/>from sklearn.utils import check_random_state<br/>from sklearn import datasets<br/>from sklearn.linear_model import LogisticRegression</span><span id="bdd1" class="nf lr it nb b gy nk nh l ni nj">rnd = check_random_state(1)</span><span id="8a07" class="nf lr it nb b gy nk nh l ni nj"># set up dataset<br/>n_samples = 3000<br/>n_features = 15</span><span id="ec98" class="nf lr it nb b gy nk nh l ni nj"># l1 data (only 5 informative features)<br/>X, y = datasets.make_classification(n_samples=n_samples,<br/>                                        n_features=n_features, n_informative=5,<br/>                                        random_state=1)</span><span id="a1af" class="nf lr it nb b gy nk nh l ni nj">cs = np.logspace(-2.3, 0, 50)</span><span id="1b9f" class="nf lr it nb b gy nk nh l ni nj">coefs = []<br/>for c in cs:<br/>    clf = LogisticRegression(solver='liblinear',C=c,penalty='l1')<br/>    # clf = LinearSVC(C=c,penalty='l1', loss='squared_hinge', dual=False, tol=1e-3)<br/>    <br/>    clf.fit(X,y)<br/>    coefs.append(list(clf.coef_[0]))<br/>    <br/>coefs = np.array(coefs)<br/>plt.figure(figsize=(10,5))<br/>for i,col in enumerate(range(n_features)):<br/>    plt.plot(cs,coefs[:,col])<br/>plt.xscale('log')<br/>plt.title('L1 penalty - Logistic regression')<br/>plt.xlabel('C')<br/>plt.ylabel('Coefficient value')<br/>plt.show()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nl"><img src="../Images/a9a2db699c66748d1be9c91648960cc1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2YvvI1_ytooJX0ZszEYPIQ.png"/></div></div></figure></div><div class="ab cl mo mp hx mq" role="separator"><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt"/></div><div class="im in io ip iq"><h1 id="62f8" class="lq lr it bd ls lt mv lv lw lx mw lz ma jz mx ka mc kc my kd me kf mz kg mg mh bi translated">åŸºäºæ ‘çš„æ¨¡å‹çš„ç‰¹å¾é‡è¦æ€§</h1><p id="8efc" class="pw-post-body-paragraph ku kv it kw b kx mi ju kz la mj jx lc ld mk lf lg lh ml lj lk ll mm ln lo lp im bi translated">å¦ä¸€ç§å¸¸è§çš„ç‰¹å¾é€‰æ‹©æŠ€æœ¯åŒ…æ‹¬ä»åŸºäºæ ‘çš„æ¨¡å‹ä¸­æå–ç‰¹å¾é‡è¦æ€§ç­‰çº§ã€‚</p><p id="f31c" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">ç‰¹å¾é‡è¦æ€§æœ¬è´¨ä¸Šæ˜¯ç”±æ¯ä¸ªå˜é‡äº§ç”Ÿçš„åˆ†è£‚æ ‡å‡†ä¸­çš„å•ä¸ªæ ‘çš„æ”¹è¿›çš„å¹³å‡å€¼ã€‚æ¢å¥è¯è¯´ï¼Œå®ƒæ˜¯åœ¨ä½¿ç”¨ç‰¹å®šå˜é‡åˆ†å‰²æ ‘æ—¶åˆ†æ•°(å†³ç­–æ ‘ç¬¦å·ä¸Šæ‰€è°“çš„â€œæ‚è´¨â€)æé«˜äº†å¤šå°‘ã€‚</p><p id="34f0" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">å®ƒä»¬å¯ç”¨äºå¯¹è¦ç´ è¿›è¡Œåˆ†çº§ï¼Œç„¶åé€‰æ‹©è¦ç´ çš„å­é›†ã€‚ç„¶è€Œï¼Œ<strong class="kw iu">åº”å°å¿ƒä½¿ç”¨ç‰¹æ€§é‡è¦æ€§ï¼Œå› ä¸ºå®ƒä»¬ä¼šå—åˆ°åå·®å’Œçš„å½±å“ï¼Œå¹¶å‘ˆç°å‡ºä¸é«˜åº¦ç›¸å…³ç‰¹æ€§</strong>ç›¸å…³çš„æ„å¤–è¡Œä¸ºï¼Œä¸ç®¡å®ƒä»¬æœ‰å¤šå¼ºã€‚</p><p id="7dd3" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">å¦‚æœ¬æ–‡ä¸­çš„<a class="ae oo" href="https://link.springer.com/content/pdf/10.1186%2F1471-2105-8-25.pdf" rel="noopener ugc nofollow" target="_blank">æ‰€ç¤ºï¼Œéšæœºæ£®æ—ç‰¹å¾é‡è¦æ€§åå‘äºå…·æœ‰æ›´å¤šç±»åˆ«çš„ç‰¹å¾ã€‚æ­¤å¤–ï¼Œå¦‚æœä¸¤ä¸ªç‰¹å¾é«˜åº¦ç›¸å…³ï¼Œæ— è®ºç‰¹å¾çš„è´¨é‡å¦‚ä½•ï¼Œå®ƒä»¬çš„åˆ†æ•°éƒ½ä¼šå¤§å¤§é™ä½ã€‚</a></p><p id="a9f5" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">ä»¥ä¸‹æ˜¯å¦‚ä½•ä»éšæœºæ£®æ—ä¸­æå–è¦ç´ é‡è¦æ€§çš„ç¤ºä¾‹ã€‚è™½ç„¶æ˜¯å›å½’å˜é‡ï¼Œä½†å¯¹äºåˆ†ç±»å™¨æ¥è¯´ï¼Œè¿‡ç¨‹æ˜¯ç›¸åŒçš„ã€‚</p><pre class="kj kk kl km gt na nb nc nd aw ne bi"><span id="bfa3" class="nf lr it nb b gy ng nh l ni nj">from sklearn.datasets import load_boston<br/>from sklearn.ensemble import RandomForestRegressor</span><span id="84ae" class="nf lr it nb b gy nk nh l ni nj">import numpy as np</span><span id="7004" class="nf lr it nb b gy nk nh l ni nj">boston = load_boston()<br/>X = boston.data<br/>Y = boston.target<br/>feat_names = boston.feature_names <br/>rf = RandomForestRegressor()<br/>rf.fit(X, Y)<br/>print("Features sorted by their score:")<br/>print(sorted(zip(map(lambda x: round(x, 4), rf.feature_importances_), feat_names), <br/>             reverse=True))<br/>Out:<br/>Features sorted by their score:<br/>[(0.4334, 'LSTAT'), (0.3709, 'RM'), (0.0805, 'DIS'), (0.0314, 'CRIM'), (0.0225, 'NOX'), (0.0154, 'TAX'), (0.0133, 'PTRATIO'), (0.0115, 'AGE'), (0.011, 'B'), (0.0043, 'INDUS'), (0.0032, 'RAD'), (0.0016, 'CHAS'), (0.0009, 'ZN')]</span></pre><h2 id="83aa" class="nf lr it bd ls ny nz dn lw oa ob dp ma ld oc od mc lh oe of me ll og oh mg oi bi translated">é¢å¤–:æ ‘æ¨¡å‹çš„ä¸»è¦æ‚è´¨åˆ†æ•°</h2><p id="6cd3" class="pw-post-body-paragraph ku kv it kw b kx mi ju kz la mj jx lc ld mk lf lg lh ml lj lk ll mm ln lo lp im bi translated">å¦‚ä¸Šæ‰€è¿°ï¼Œâ€œæ‚è´¨â€æ˜¯å†³ç­–æ ‘ç®—æ³•åœ¨å†³å®šåˆ†å‰²èŠ‚ç‚¹æ—¶ä½¿ç”¨çš„åˆ†æ•°ã€‚æœ‰è®¸å¤šå†³ç­–æ ‘ç®—æ³•(IDR3ã€C4.5ã€CART ç­‰)ï¼Œä½†ä¸€èˆ¬è§„åˆ™æ˜¯ï¼Œæˆ‘ä»¬ç”¨æ¥åˆ†å‰²æ ‘ä¸­èŠ‚ç‚¹çš„å˜é‡æ˜¯å¯¹æ‚è´¨äº§ç”Ÿæœ€é«˜æ”¹å–„çš„å˜é‡ã€‚</p><p id="ae57" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">æœ€å¸¸è§çš„æ‚è´¨æ˜¯åŸºå°¼æ‚è´¨å’Œç†µã€‚åŸºå°¼ç³»æ•°æ‚è´¨çš„æ”¹è¿›è¢«ç§°ä¸ºâ€œ<strong class="kw iu">åŸºå°¼ç³»æ•°é‡è¦æ€§</strong>ï¼Œè€Œç†µçš„æ”¹è¿›æ˜¯<strong class="kw iu">ä¿¡æ¯å¢ç›Šã€‚</strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pj"><img src="../Images/bbf6e0c55f708886ac0c2cd66d5ce8db.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jsCo6SlYTUI2AIVovfc3cg.png"/></div></div></figure><h2 id="3cc0" class="nf lr it bd ls ny nz dn lw oa ob dp ma ld oc od mc lh oe of me ll og oh mg oi bi translated">SHAP:æ¥è‡ªæ ‘æ¨¡å‹çš„å¯é ç‰¹å¾é‡è¦æ€§</h2><p id="ac64" class="pw-post-body-paragraph ku kv it kw b kx mi ju kz la mj jx lc ld mk lf lg lh ml lj lk ll mm ln lo lp im bi translated">(æ„Ÿè°¢<a class="pk pl ep" href="https://medium.com/u/7ba65e2cae1e?source=post_page-----10c0ddd7918b--------------------------------" rel="noopener" target="_blank">æ©é‡Œå…‹Â·åŠ æ–¯å¸•é‡Œå°¼Â·è²ä¹Œè¨Â·å¤šçº³è¥¿é—¨æ‰˜</a>çš„å»ºè®®ï¼)</p><p id="b969" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">SHAP å®é™…ä¸Šè¿œä¸æ­¢äºæ­¤ã€‚å®ƒæ˜¯ä¸€ç§ç®—æ³•ï¼Œæä¾›ä»»ä½•é¢„æµ‹æ¨¡å‹ä¹‹å¤–çš„æ¨¡å‹è§£é‡Šã€‚ç„¶è€Œï¼Œå¯¹äºåŸºäºæ ‘çš„æ¨¡å‹ï¼Œå®ƒç‰¹åˆ«æœ‰ç”¨:ä½œè€…ä¸ºè¿™ç§æ¨¡å‹å¼€å‘äº†é«˜é€Ÿå’Œç²¾ç¡®(ä¸ä»…ä»…æ˜¯å±€éƒ¨)çš„è§£é‡Šï¼Œä¸ X <em class="ol"> GBoost </em>ã€<em class="ol"> LightGBM </em>ã€<em class="ol"> CatBoost </em>å’Œ<em class="ol"> scikit-learn </em>æ ‘æ¨¡å‹å…¼å®¹ã€‚</p><p id="e776" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">æˆ‘é¼“åŠ±æ£€æŸ¥ä¸€ä¸‹ SHAP æä¾›çš„è§£é‡Šèƒ½åŠ›(æ¯”å¦‚<strong class="kw iu">ç‰¹å¾ä¾èµ–ã€äº¤äº’æ•ˆæœã€æ¨¡å‹ç›‘æ§â€¦â€¦</strong>)ã€‚ä¸‹é¢ï¼Œæˆ‘(ä»…)ç»˜åˆ¶äº† SHAP è¾“å‡ºçš„ç‰¹å¾é‡è¦æ€§ï¼Œå½“å¯¹å®ƒä»¬è¿›è¡Œæ’åºä»¥è¿›è¡Œç‰¹å¾é€‰æ‹©æ—¶ï¼Œè¿™äº›ç‰¹å¾é‡è¦æ€§æ¯”åŸå§‹æ ‘æ¨¡å‹è¾“å‡ºçš„ç‰¹å¾é‡è¦æ€§æ›´å¯é ã€‚è¿™ä¸ªä¾‹å­æ‘˜è‡ªä»–ä»¬çš„<a class="ae oo" href="https://medium.com/p/10c0ddd7918b/edit" rel="noopener"> <em class="ol"> github </em> </a>é¡µé¢ã€‚</p><pre class="kj kk kl km gt na nb nc nd aw ne bi"><span id="e9a7" class="nf lr it nb b gy ng nh l ni nj">import xgboost<br/>import shap</span><span id="20f3" class="nf lr it nb b gy nk nh l ni nj"># load JS visualization code to notebook<br/>shap.initjs()</span><span id="0956" class="nf lr it nb b gy nk nh l ni nj"># train XGBoost model<br/>X,y = shap.datasets.boston()<br/>model = xgboost.train({"learning_rate": 0.01}, xgboost.DMatrix(X, label=y), 100)</span><span id="b29c" class="nf lr it nb b gy nk nh l ni nj"># explain the model's predictions using SHAP values<br/># (same syntax works for LightGBM, CatBoost, and scikit-learn models)<br/>explainer = shap.TreeExplainer(model)<br/>shap_values = explainer.shap_values(X)</span><span id="f495" class="nf lr it nb b gy nk nh l ni nj">shap.summary_plot(shap_values, X, plot_type="bar")</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pm"><img src="../Images/aee5d31bc5910f0c69129eb4f767aaf3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7733HHmJQY1JpIKzDX6z6A.png"/></div></div></figure></div><div class="ab cl mo mp hx mq" role="separator"><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt"/></div><div class="im in io ip iq"><h1 id="c4af" class="lq lr it bd ls lt mv lv lw lx mw lz ma jz mx ka mc kc my kd me kf mz kg mg mh bi translated">ç»“è®ºâ€”â€”ä½•æ—¶ä½¿ç”¨æ¯ç§æ–¹æ³•ï¼Ÿ</h1><p id="31fc" class="pw-post-body-paragraph ku kv it kw b kx mi ju kz la mj jx lc ld mk lf lg lh ml lj lk ll mm ln lo lp im bi translated">åµŒå…¥å¼æ–¹æ³•å¯¹äºé¿å…è¿‡åº¦æ‹Ÿåˆå’Œé€‰æ‹©æœ‰ç”¨çš„å˜é‡é€šå¸¸éå¸¸æœ‰æ•ˆã€‚å®ƒä»¬ä¹Ÿæ˜¯æ—¶é—´æœ‰æ•ˆçš„ï¼Œå› ä¸ºå®ƒä»¬åµŒå…¥åœ¨ç›®æ ‡å‡½æ•°ä¸­ã€‚å®ƒä»¬çš„ä¸»è¦ç¼ºç‚¹æ˜¯å®ƒä»¬å¯èƒ½æ— æ³•ç”¨äºæ‰€éœ€çš„åˆ†ç±»å™¨ã€‚</p><p id="3e51" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">åŒ…è£…æ–¹æ³•åœ¨å®è·µä¸­å¾€å¾€å·¥ä½œå¾—å¾ˆå¥½ã€‚ç„¶è€Œï¼Œå®ƒä»¬åœ¨è®¡ç®—ä¸Šæ˜¯æ˜‚è´µçš„ï¼Œç‰¹åˆ«æ˜¯å½“å¤„ç†æ•°ç™¾ä¸ªç‰¹å¾æ—¶ã€‚ä½†æ˜¯å¦‚æœä½ æœ‰è®¡ç®—èµ„æºï¼Œè¿™æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„æ–¹æ³•ã€‚</p><p id="2a5c" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">å¦‚æœç‰¹å¾é›†éå¸¸å¤§(å¤§çº¦æ•°ç™¾æˆ–æ•°åƒ)ï¼Œå› ä¸ºè¿‡æ»¤æ–¹æ³•å¾ˆå¿«ï¼Œå®ƒä»¬å¯ä»¥å¾ˆå¥½åœ°ä½œä¸ºé€‰æ‹©çš„ç¬¬ä¸€é˜¶æ®µï¼Œä»¥æ’é™¤ä¸€äº›å˜é‡ã€‚éšåï¼Œå¯ä»¥å°†å¦ä¸€ç§æ–¹æ³•åº”ç”¨äºå·²ç»ç¼©å‡çš„ç‰¹å¾é›†ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæ‚¨æƒ³è¦åˆ›å»ºè¦ç´ çš„ç»„åˆï¼Œå°†å®ƒä»¬ç›¸ä¹˜æˆ–ç›¸é™¤ï¼Œè¿™å°†éå¸¸æœ‰ç”¨ã€‚</p><h1 id="b213" class="lq lr it bd ls lt lu lv lw lx ly lz ma jz mb ka mc kc md kd me kf mf kg mg mh bi translated">å‚è€ƒ</h1><p id="9330" class="pw-post-body-paragraph ku kv it kw b kx mi ju kz la mj jx lc ld mk lf lg lh ml lj lk ll mm ln lo lp im bi translated"><a class="ae oo" href="http://www.jmlr.org/papers/volume3/guyon03a/guyon03a.pdf" rel="noopener ugc nofollow" target="_blank">å˜é‡å’Œç‰¹å¾é€‰æ‹©ä»‹ç»</a></p><p id="b9cd" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><a class="ae oo" href="https://link.springer.com/content/pdf/10.1186%2F1471-2105-8-25.pdf" rel="noopener ugc nofollow" target="_blank">éšæœºæ£®æ—å˜é‡é‡è¦æ€§æµ‹é‡ä¸­çš„åå·®:ä¾‹è¯ã€æ¥æºå’Œè§£å†³æ–¹æ¡ˆ</a></p><p id="5be6" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><a class="ae oo" href="https://pdfs.semanticscholar.org/310e/a531640728702fce6c743c1dd680a23d2ef4.pdf" rel="noopener ugc nofollow" target="_blank">ç”¨äºåˆ†ç±»çš„ç‰¹å¾é€‰æ‹©:ç»¼è¿°</a></p></div></div>    
</body>
</html>