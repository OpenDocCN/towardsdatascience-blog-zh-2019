# 利用深度学习和卫星图像预测融雪模式

> 原文：<https://towardsdatascience.com/predicting-snowmelt-patterns-with-deep-learning-and-satellite-imagery-86b7059a3914?source=collection_archive---------26----------------------->

## 听完整的播客插曲:[苹果](https://podcasts.apple.com/ca/podcast/towards-data-science/id1470952338?mt=2) | [谷歌](https://www.google.com/podcasts?feed=aHR0cHM6Ly9hbmNob3IuZm0vcy8zNmI0ODQ0L3BvZGNhc3QvcnNz) | [SPOTIFY](https://open.spotify.com/show/63diy2DtpHzQfeNVxAPZgU) | [其他](https://anchor.fm/towardsdatascience)

## 与 Kaggle 数据科学家 Jessica Li 的对话

![](img/0fcd45ef9515794dad5f4f520fb2d0b7.png)

大家好！

前几天，我在[走向数据科学播客](https://towardsdatascience.com/podcast/home)中采访了 Kaggle 的数据科学家 Jessica Li。在这篇文章中，我想呈现一些采访中的亮点。

下面，我将分享一些我问她的问题，以及她回答的摘要。

注:您可以在[Twitter @ Jessica Li 9530](https://twitter.com/jessicali9530)上关注 Jessica，了解她未来的更新。

## 问:你是如何从学习地理变成一名数据科学家的？

地理过去更多的是制作地图，但现在不是了。

随着越来越多的卫星/空间图像变得可用，并且随着计算大量数据变得更加高效，对地理空间数据运行机器学习模型变得可能。这也是我在学校学到的。

当我开始申请数据科学工作时，我注意到肯定有一些重叠。这些技能包括 Python、R，显然还有数据科学和机器学习。

## 问:所以你在学校学到了这些技能？

是的，但是大学对我来说是一段有趣的时光，因为我有 4 年没有单一的专业。我经常跳来跳去，从医学预科到会计学，再到我喜欢的地理。我大学只学了两年地理。

这也是为什么我说我还在学习。大学毕业才 1.5 年，和很多人一样，我非常自学数据科学。所以，我的学习之旅还在继续。

## 问:你是如何在 Kaggle 获得数据科学工作的？

就像他们说的，人脉是关键。我搬到了纽约，在完成学位后的 2-3 个月里，我没有找到工作。所以，不知道我的工作将会是什么会有一些不确定性。

在我第三个月的时候，我去了一个在 meetup.com 上找到的聚会。如果你在找工作，我强烈推荐你去看看这个网站。

我去的聚会叫做 Geo NYC。在那里，人们分享他们在工作或闲暇时所做的大量地理空间分析。我在那里遇到了一个人，他把我介绍给了车队，剩下的就是历史了。

## 问:所以你搬到了纽约，却没有得到那里的工作机会？

是的，我会说这是我做过的最冒险的举动之一。我以前搬过几次家。我是澳大利亚人，但我在中国住过一段时间，为了上学我搬到了洛杉矶。所以，搬家本身并不可怕，但是搬到一个我不认识很多人的城市绝对是一个冒险的举动。

然而，当我想到让我走到今天的重要时刻时，所有这些都是冒险的决定。所以，我觉得如果我谨慎行事，我就不会有今天。

## 问:我今天想采访你的原因之一是因为你与美国宇航局合作的项目。你能给我们讲讲吗？

当然可以！这是一个与美国宇航局合作的为期 10 周的独立研究项目。这是 2018 年的夏天。我和另外两个队友一起工作。

该项目的范围是预测犹他州弗里蒙特河流域的水资源可利用性。那里的国家公园管理局想要一种工具来评估每年融雪季节后他们从流域获得的水量。河流流量评估很糟糕，他们也没有得到关于他们每年将得到多少水的准确预测。

这对他们来说是一个重要的项目，因为弗里蒙特河流域提供了大约 16，000 英亩的农业灌溉面积。因此，对于核电厂来说，知道他们将得到多少水，以便他们能够做出正确的水资源管理决策，这是非常重要的。然而，情况并不乐观。这就是为什么美国宇航局希望我们的团队建立一个模型，可以更好地预测这一点。

NASA’s explainer video on the project

## 问:为了预测这些水资源，你是预测降雪还是仅仅预测融雪？

好问题。花了一些时间来思考目标变量是什么。在这种情况下，我们感兴趣的是降雪后会发生什么。换句话说，我们决定将 streamflow 作为我们的目标变量。Streamflow 就是在给定的点流入河流的水量。

## 问:所以，基本上，你知道给定年份有多少雪，你想预测你会得到多少流量？

没错。现在，在一个典型的机器学习项目中，您开始探索您的数据，以确定哪种信息与您的项目相关。然后，您将想要识别您的目标变量——在本例中是 streamflow。下一部分将是数据收集和特征工程。在这一部分，你需要收集所有你认为会影响或有助于预测目标变量的预测变量。

我认为让这个项目更合适的是我们有卫星图像作为预测变量。

所以，美国宇航局有一套地球观测和卫星图像。最后，我们需要进行大量的计算，因为这些数据由许多像素组成。这是很多数据，但它们被证明是预测河流流量的很好的预测变量。

## 问:有多少数据？

我们有 MODIS，它给了我们两种不同的信息——这是两个变量。PERSIANN-CDR——这些都是卫星名称——是指降水量，所以是三个。再加上一些数据源，我们总共有 8 或 9 个变量。这些都是日常信息，我们有超过 2-3 年的时间。所以，你可以想象这是一个很大的数据。我们最终的数据集是 13-14 列数据，包含大约 3 年的观察值。

## 问:那可能是几百兆字节或几千兆字节？

绝对成千兆字节。卫星将信息记录为地球某一部分的图像。例如，卫星可以每天一次测量美国的地表温度。所以，这将是一幅图像，每一个像素代表地球上一个特定位置的温度。

由于这是大量的数据，我们决定对其中一些进行平均。我们想得到不同地区的粗略地表温度，最后，我们将流域地区分成三个不同的区域，并计算每个区域的日平均温度。

我们也为被雪覆盖的地区做了同样的事情。对于这一个，我们想计算总面积，而不是取平均值。就像我们对温度所做的一样，我们将所有对应于雪的像素相加，并找到总面积。

## 问:你的数据中有哪些像素是雪，哪些不是雪的信息？

是的，我要研究一下卫星图像是如何工作的。这真的是地理吸引我去学这个专业的部分。

现在，当我们给任何东西拍照时，我们实际上是在记录某种信息。

这对卫星图像和数码摄影来说意味着每个像素都有某种电磁波谱信息。

因此，地球上的每样东西都以某种方式反射电磁波谱中的光。一种你可以数字化识别雪的方法是通过它独特的反射光谱。雪是白色的，它的化学成分使它具有独特的特征。

记住这一点，你遍历每个像素，寻找一条特定形状的曲线。通过这种类型的计算，您将能够识别哪些像素是雪，哪些不是。

在这里，重要的是要记住，这不是一个二元的事情。你会得到一个连续的光谱，显示每个像素与电磁信号的相似程度。例如，一个给定的区域可能有 80%与之匹配。因此，您最终会得到一个置信度，例如，“这更有可能是雪”，以及“这不太可能是雪。”在此基础上对每个像素进行重新分类后，你将能够更清楚地了解给定图片中的实际降雪量。

## 问:好，回到这个分析。我记得你提到过你有 7 或 8 个预测变量？

我们有 10-11 个预测变量，其中 4 个是卫星图像。

## 问:有像图像一样的数据，也有非像图像一样的数据？

没错。非图像类数据基本上是表格。一个例子是每天的雪水当量，我认为这与雪中所含的水量有关——本质上是雪能制造多少水。那是以表格形式给出的信息。

目标变量也是表格形式——日流量。

所以，本质上，我们有一堆图像式的数据和表格数据。

然后，我们将它分成训练数据和测试数据。

如果我们有，比如说，2-3 年的数据，只有最近 6 个月的数据才算测试数据。其余的被当作训练数据。

## 问:你最后用的是什么型号？

我们最终使用了 LSTM 模型，它代表长短期记忆模型。

## 问:我听说过它，但我对它不太熟悉——你能解释一下它是如何工作的吗？

神经网络有许多变量，LSTM 是其中之一。这是一种循环神经网络。我可能不是解释这件事的最佳人选，但我会尽力而为！

从很高的层面来看，递归网络就像神经网络一样，但问题是它们有循环。它们适用于时间预测问题，在这种情况下，您会发现之前发生的一些事情会影响以后的分析。

例如，在我们的项目中，融雪肯定有时间滞后因素。仅仅因为我们的卫星图像显示我们那天有这么多雪，这并不意味着我们在同一天会有一些水流。所以，我们需要考虑一些时间因素。递归神经网络有很好的记忆成分来捕捉这些信息。它使我们能够将昨天的变量与明天的流量联系起来。

有一篇很好的 TDS 文章解释了 LSTM 神经网络的数学原理。我认为文章中使用的比喻是一个人在阅读一篇文章。当你读一个句子时，你是基于你在句子中读到的更早的单词来理解它的。这里有一些连续性，你必须着眼于大局来理解正在发生的一切。传统的神经网络无法捕捉这种类型的信息。另一方面，RNN 氏症可以。

## 问:在你的分析中，你尝试过使用其他模型吗？

对于任何类型的问题，我喜欢做的是首先尝试所有的标准模型。因此，你也许能够考虑你的问题的范围，并开始对你的问题进行分类。比如是不是二元分类问题？是多分类问题吗？就是这个时间序列，表格，情绪分析等。？对于这个问题，它显然看起来像一个时间预测问题。

基于此，我上了 scikit-learn 并尝试了一些行业标准模型。尝试简单回归总是好的，我们尝试了。然后，我们把它喂给了 SVM。当然，我们尝试了 XGBoost。

## 问:我明白了。所以你尝试了回归、SVM、XGBoost 和 LSTM。

在我们尝试 LSTM 之前，我们先尝试了一个 ARIMA 模型。在 LSTM 变得流行之前，ARIMA 曾经更主流。众所周知，它能够考虑到我前面提到一些时间关系。然而，它没有产生非常准确的结果。

帮助我选择 LSTM 作为我们预测模型的是和一个解决过类似问题的人交谈。我在网上找到了一篇类似的论文，也是关于使用卫星图像数据进行预测的。

我联系了这个人，他能够倾听我的问题，并建议我使用 LSTM。结果成功了，这给他带来了很大的荣誉。

## 问:和 ARIMA 相比怎么样？LSTM 超过它了吗？

是的，LSTM 的表现远远超过了其他任何一个国家。我们要么经历了不准确的预测，要么经历了太多的 ARIMA。当我们对测试数据进行测试时，预测是错误的——感觉预测非常静态。

融雪有潮起潮落的现象，虽然所有的模型都能够理解它，但它们不一定能捕捉到多年来融雪速度的差异。在过去的 17 年里，该地区的融雪时间越来越早，径流量也在减少。许多模型无法捕捉这种长期趋势，即使它们可以捕捉基本的上下波动。

## 问:LSTM 模型能够捕捉到这一点吗？

是的，那很棒。我记得，去年的数据里，streamflow 肯定是有减少的，但是很微妙。LSTM 是唯一能够抓住它的人。

## 问:当你着手解决这个问题时，有没有遇到什么特别的挑战？

这里有许多挑战，功能工程是其中之一。在这方面，让这个问题变得特别困难的一点是，人们需要了解像温度趋势这样的事情。一个特别具有挑战性的方面是理解雪是如何工作的。

在学校，我的专业是研究水资源，在这个项目中，水和雪的不同表现令人惊讶。我不得不学习许多关于雪的随机知识。例如，有人可能会说，我们应该考虑一个捕捉融雪下山速度的参数。也就是说，雪可能在某些天融化得更快，而在另一些天融化得更慢。我们试图找到一个参数来捕捉这一点，这涉及到学习大量的水科学。

## 问:还有其他挑战吗？

是的。本来这个项目的推荐范围并没有建议在任何地方使用机器学习。我们进来了，问题是简单地预测水流。有一些推荐的论文可以阅读，NASA 也有一些他们认为我们可以在其上工作的框架。

作为项目领导，这是一个挑战，因为看起来建议的方法可行，但这并不是我们真正想要做的。我认为这说明了从传统编程到数据科学的范式，以及尝试将其应用于我们周围更多事物的努力。

这个模型是以传统方式构建的，这意味着许多值和算法都是硬编码的，专门用于构建它的目的。

我记得这个模型是为智利的一个水资源项目建造的，所以我们必须重新创建这个模型。所有的权重和算法都适合那个特定的项目。

总而言之，这是这个项目中的一个压力点。我们已经进行了 10 周的 3 周。我很快学会了 MATLAB 来查看模型，感觉这不是我的团队想要采取的方法。在那种情况下，我不得不上报给我的经理和其他人，告诉他们我们想尝试其他方式。

很自然，如果你想改变项目的范围，你必须提出一个建议。当我们与这些人交谈时，我们已经想到用机器学习来代替。因此，我们提出了一个新的范围，指定了我们想要尝试的数据和模型的类型。

这需要一些说服力，因为机器学习仍然是一个相对较新的领域。即使这是每个人都在谈论的技术，当你推断到政府和 NPS 之类的东西时，许多人仍然不熟悉它。这将是一个过程，可能需要几年或几代人才能让他们理解它是如何工作的。

机器学习的倡导对我来说非常重要，在这个项目中，我们能够倡导这一点。最后，他们让我们做了，对此我也很高兴。