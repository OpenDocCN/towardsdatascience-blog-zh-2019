<html>
<head>
<title>Towards Well-Being, with Data Science (part 1)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">走向幸福，数据科学(第 1 部分)</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/towards-well-being-with-data-science-part-1-7f8035f73aa?source=collection_archive---------10-----------------------#2019-04-03">https://towardsdatascience.com/towards-well-being-with-data-science-part-1-7f8035f73aa?source=collection_archive---------10-----------------------#2019-04-03</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div class="gh gi ir"><img src="../Images/11f64abcdb52a3f15e728c3cec3bbd78.png" data-original-src="https://miro.medium.com/v2/resize:fit:1288/format:webp/1*7njlOO_JBWu5YR_NH11-nA.jpeg"/></div><figcaption class="iy iz gj gh gi ja jb bd b be z dk">Credit: EUFIC</figcaption></figure><div class=""/><p id="3320" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我用我的苹果健康数据来衡量我目前的状态，并设定未来的健身目标。</p><p id="f834" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi kz translated">在过去的几周里，我一直好奇如何在自己的生活中使用数据。在我的日常工作中，我使用数据来帮助在企业环境中做出更好的决策，所以我想，为什么不使用我当前可用的数据来设定更健康生活的指标和目标呢？</p><p id="3cee" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在这些系列中，我将经历<strong class="kd jf"> A .介绍，b .探索数据 c .分析&amp;绘图，d .测试，e .结论。</strong></p><h1 id="fa58" class="li lj je bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">A.介绍</h1><h2 id="1595" class="mg lj je bd lk mh mi dn lo mj mk dp ls km ml mm lw kq mn mo ma ku mp mq me mr bi translated">苹果健康</h2><p id="1a18" class="pw-post-body-paragraph kb kc je kd b ke ms kg kh ki mt kk kl km mu ko kp kq mv ks kt ku mw kw kx ky im bi translated">这是什么？这是苹果提供的描述:</p><blockquote class="mx my mz"><p id="0712" class="kb kc na kd b ke kf kg kh ki kj kk kl nb kn ko kp nc kr ks kt nd kv kw kx ky im bi translated">健康应用程序可以轻松了解您的健康状况，并开始实现您的目标。它整合了来自 iPhone、Apple Watch 和您已经使用的第三方应用程序的健康数据，因此您可以在一个方便的地方查看您的所有进展。它还推荐了其他有用的应用程序来完善你的收集——让你的健康变得前所未有的简单。</p></blockquote><div class="is it gp gr iu ne"><a href="https://www.apple.com/ios/health/" rel="noopener  ugc nofollow" target="_blank"><div class="nf ab fo"><div class="ng ab nh cl cj ni"><h2 class="bd jf gy z fp nj fr fs nk fu fw jd bi translated">iOS -健康</h2><div class="nl l"><h3 class="bd b gy z fp nj fr fs nk fu fw dk translated">健康应用程序可以更容易地跟踪你的健康和健康数据，集中在四个方面:活动，睡眠…</h3></div><div class="nm l"><p class="bd b dl z fp nj fr fs nk fu fw dk translated">www.apple.com</p></div></div><div class="nn l"><div class="no l np nq nr nn ns iw ne"/></div></div></a></div><h2 id="d570" class="mg lj je bd lk mh mi dn lo mj mk dp ls km ml mm lw kq mn mo ma ku mp mq me mr bi translated">动机</h2><p id="2bc7" class="pw-post-body-paragraph kb kc je kd b ke ms kg kh ki mt kk kl km mu ko kp kq mv ks kt ku mw kw kx ky im bi kz translated"><span class="l la lb lc bm ld le lf lg lh di">我</span>目前有一部 iPhone X，附带苹果健康应用。它还有健康记录 API，您可以连接到它并从中提取更多有趣的数据，但是出于各种目的，我们将在本文中使用一个更简单的方法。</p><p id="574f" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">据我所知，苹果健康也包含在以前的 iPhone 型号中，所以如果你有一个旧版本的手机，你不会被排除在外。此外，如果你有一个苹果手表，你就有了额外的指标，如:心率监测、心电图、跌倒检测、生命体征、血压等。</p><p id="10e4" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">苹果健康应用程序有交互式可视化功能，可以查看你的数据，所以我这么做主要是为了自娱自乐。我必须说，它缺乏工具来拥有一个聚合视图，所以我想我可以使用一些 python 库来可视化我当前的表单。</p><h2 id="28cf" class="mg lj je bd lk mh mi dn lo mj mk dp ls km ml mm lw kq mn mo ma ku mp mq me mr bi translated">下载数据</h2><p id="fd54" class="pw-post-body-paragraph kb kc je kd b ke ms kg kh ki mt kk kl km mu ko kp kq mv ks kt ku mw kw kx ky im bi translated">在转换数据之前，您需要从 Apple Health 文件中导出数据文件。虽然有几种方法可以做到这一点，但我用电子邮件给自己发送了数据导出。为此，只需在手机中导航:<strong class="kd jf">苹果健康&gt;健康数据&gt;个人资料图标&gt;导出健康数据</strong></p><p id="ad1e" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">为了转换数据，我使用了<strong class="kd jf"> markwk </strong>的“苹果健康提取器和数据分析”工具。更多信息见链接:</p><p id="e04f" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><a class="ae nt" href="https://github.com/markwk/qs_ledger/tree/master/apple_health" rel="noopener ugc nofollow" target="_blank">https://github . com/markwk/QS _ ledger/tree/master/apple _ health</a></p><p id="ffde" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><strong class="kd jf"> markwk </strong>代码的第一个脚本允许您将 XML 文件转换为 CSV，我将它加载到 Jupyter Notebook 中:</p><pre class="nu nv nw nx gt ny nz oa ob aw oc bi"><span id="25b9" class="mg lj je nz b gy od oe l of og"># %run -i ‘apple-health-data-parser’ ‘export.xml’ <br/>%run -i ‘/Users/stephenhyungilkim/qs_ledger-master/apple_health/apple-health-data-parser.py’ ‘/Users/stephenhyungilkim/apple_health_export/export.xml’</span></pre><figure class="nu nv nw nx gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="oi oj di ok bf ol"><div class="gh gi oh"><img src="../Images/22fb566c2455dd859c6f2cf286953f5e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jfPtfpGWrHsj627byIiTfw.png"/></div></div></figure><p id="a3ad" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">该脚本将代码分成几个部分，包括:</p><p id="f13b" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><strong class="kd jf">身高、体重、步数、步行距离、跑步、燃烧的积极能量、飞行攀爬、锻炼数据。</strong></p><h1 id="32b2" class="li lj je bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">B.探索数据</h1><p id="1783" class="pw-post-body-paragraph kb kc je kd b ke ms kg kh ki mt kk kl km mu ko kp kq mv ks kt ku mw kw kx ky im bi translated">任何数据分析项目的第一步，我们必须寻求理解数据的不同维度以及文件包含的内容！先说其中一个特点，<strong class="kd jf">步骤</strong>:</p><pre class="nu nv nw nx gt ny nz oa ob aw oc bi"><span id="0b3e" class="mg lj je nz b gy od oe l of og">steps = pd.read_csv("/Users/stephenhyungilkim/apple_health_export/StepCount.csv", parse_dates=["startDate"], index_col="startDate")</span></pre></div><div class="ab cl om on hx oo" role="separator"><span class="op bw bk oq or os"/><span class="op bw bk oq or os"/><span class="op bw bk oq or"/></div><div class="im in io ip iq"><pre class="ny nz oa ob aw oc bi"><span id="ba89" class="mg lj je nz b gy ot ou ov ow ox oe l of og">steps.describe()</span></pre><figure class="nu nv nw nx gt iv gh gi paragraph-image"><div class="gh gi oy"><img src="../Images/fac9c4157ea39b27f286374b6c773a52.png" data-original-src="https://miro.medium.com/v2/resize:fit:526/format:webp/1*ne_tF34S_Vo6Ma16SxrH5w.png"/></div><figcaption class="iy iz gj gh gi ja jb bd b be z dk">figure 1</figcaption></figure><p id="2c20" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这给了我们一些关于数据的一般统计。例如，我们可以看到有 6833 个“步”的实例，平均值是 374 步…但是推荐的平均值不是每天 10，000 步吗？:O</p><pre class="nu nv nw nx gt ny nz oa ob aw oc bi"><span id="1093" class="mg lj je nz b gy od oe l of og">steps.tail()</span></pre><figure class="nu nv nw nx gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="oi oj di ok bf ol"><div class="gh gi oz"><img src="../Images/810370e8a370eed7674733495d512669.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QCU-nKPKtBpniiz3Uaa0iA.png"/></div></div><figcaption class="iy iz gj gh gi ja jb bd b be z dk">figure 2</figcaption></figure><p id="966a" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在图 2 中，我们可以看到我在导出之前的最新数据。我们可以得出的一些信息是，数据源来自我的 iPhone 设备’，我们也有值。不过，我开始为自己辩护，因为数据似乎表明我非常懒惰。一天只走 34 步可能吗？</p><p id="3b5a" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">然后，我意识到 34 步并不是一天的总数，因为“开始日期”在同一天内有多次。我回到我的手机上查看我那天的总步数，令我欣慰的是，它超过了 34 步。</p><pre class="nu nv nw nx gt ny nz oa ob aw oc bi"><span id="1b85" class="mg lj je nz b gy od oe l of og">len(steps)</span></pre><p id="2023" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这再次证实我们有 6833 项记录。</p><pre class="nu nv nw nx gt ny nz oa ob aw oc bi"><span id="f0c1" class="mg lj je nz b gy od oe l of og">steps.columns</span></pre><figure class="nu nv nw nx gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="oi oj di ok bf ol"><div class="gh gi pa"><img src="../Images/3d42dacd5fe25f8c884b87b6b4c6a1e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yLHJGg2yZF_PfFlT-acpCQ.png"/></div></div><figcaption class="iy iz gj gh gi ja jb bd b be z dk">figure 3</figcaption></figure><p id="bb74" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在图 3 中，我们可以看出有 8 个特性，但是对于我们的时间序列用例，我们可以保留'<strong class="kd jf">值</strong>和'<strong class="kd jf">开始日期</strong>,并删除所有其他的特性(我将在更深入的研究后马上这么做)。</p><pre class="nu nv nw nx gt ny nz oa ob aw oc bi"><span id="c083" class="mg lj je nz b gy od oe l of og">steps.value.sum()</span></pre><figure class="nu nv nw nx gt iv gh gi paragraph-image"><div class="gh gi pb"><img src="../Images/4c3cf5f74c46e4ee94a62fe55fc272d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:494/format:webp/1*Z1W5-ihhPLeXV5tB7VudFQ.png"/></div><figcaption class="iy iz gj gh gi ja jb bd b be z dk">figure 4</figcaption></figure><p id="81e2" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">图 4 显示了我们在给定范围内采取的所有步骤的总和。10，000 步大约相当于 5 英里，所以你们可以算一下。这可能看起来很多，但是请记住，对于健康来说，每天的数字比总和更重要。每天都要踩这些台阶，对吧？</p><pre class="nu nv nw nx gt ny nz oa ob aw oc bi"><span id="332f" class="mg lj je nz b gy od oe l of og">steps.value</span></pre><figure class="nu nv nw nx gt iv gh gi paragraph-image"><div class="gh gi pc"><img src="../Images/5c88fe7e93c4b4732c98f86b2f84a695.png" data-original-src="https://miro.medium.com/v2/resize:fit:504/format:webp/1*Nf4WxbMLM5aIcotIGUeJuA.png"/></div><figcaption class="iy iz gj gh gi ja jb bd b be z dk">figure 5</figcaption></figure><p id="0aa0" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">图 5 开始看起来有点像时间序列，其中我们有一个数据和值。这是有希望的，似乎是可以策划的。我确实意识到，如果我想要一个每日视图，我将需要每天进行聚合，而不是使用 startDate 特性。正如我们之前提到的，我们仍然需要去掉其他特性。</p><pre class="nu nv nw nx gt ny nz oa ob aw oc bi"><span id="d10d" class="mg lj je nz b gy od oe l of og">steps_new = steps.drop(['sourceName','sourceVersion','device','type','unit','creationDate','endDate'], axis=1)</span></pre><p id="12cd" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">上面的代码从数据帧中删除了不必要的特性。</p><pre class="nu nv nw nx gt ny nz oa ob aw oc bi"><span id="3a1e" class="mg lj je nz b gy od oe l of og">type(steps_new)</span></pre><figure class="nu nv nw nx gt iv gh gi paragraph-image"><div class="gh gi pd"><img src="../Images/bb5ee7dfb760febc268a05890f33ee11.png" data-original-src="https://miro.medium.com/v2/resize:fit:726/format:webp/1*69ANyJpfruqDo7HPZRzNWw.png"/></div><figcaption class="iy iz gj gh gi ja jb bd b be z dk">figure 5</figcaption></figure><p id="cb5b" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">为了让我们处理时间序列，我们需要相应地修改数据。上面的代码向我们展示了我们正在处理什么类型的数据。请注意，当我使用' read_csv '时，我确保' startDate '是日期时间(不是字符串或任何其他值)，并且' startDate '是索引列。</p><h2 id="79a9" class="mg lj je bd lk mh mi dn lo mj mk dp ls km ml mm lw kq mn mo ma ku mp mq me mr bi translated">其他维度</h2><p id="a9da" class="pw-post-body-paragraph kb kc je kd b ke ms kg kh ki mt kk kl km mu ko kp kq mv ks kt ku mw kw kx ky im bi translated">因为还有 6 个维度，所以我迭代相同的代码来理解数据。考虑到我的身高保持不变，像“身高”这样的一些特征看起来并不令人兴奋。为了保持连续性，我将继续探索这个步骤的维度。</p></div><div class="ab cl om on hx oo" role="separator"><span class="op bw bk oq or os"/><span class="op bw bk oq or os"/><span class="op bw bk oq or"/></div><div class="im in io ip iq"><h1 id="bf92" class="li lj je bd lk ll pe ln lo lp pf lr ls lt pg lv lw lx ph lz ma mb pi md me mf bi translated">C.分析和绘图</h1><p id="35a3" class="pw-post-body-paragraph kb kc je kd b ke ms kg kh ki mt kk kl km mu ko kp kq mv ks kt ku mw kw kx ky im bi translated">虽然有几个有趣的列，但我们应该主要关注“值”和“开始日期”。这些将是我们的线图的轴，所以请查看我的“健康”的时间序列表示。</p><pre class="nu nv nw nx gt ny nz oa ob aw oc bi"><span id="30aa" class="mg lj je nz b gy od oe l of og">steps_new.plot()<br/>plt.title('How Many Steps Has Stephen Taken?')<br/>plt.ylabel('Steps')<br/>plt.xlabel('Date')</span></pre><figure class="nu nv nw nx gt iv gh gi paragraph-image"><div class="gh gi pj"><img src="../Images/8cf7fe0fb90a0062442c1e6274303c20.png" data-original-src="https://miro.medium.com/v2/resize:fit:924/format:webp/1*vKsLqFXaqWpgo_MGPNjkGQ.png"/></div><figcaption class="iy iz gj gh gi ja jb bd b be z dk">figure 6</figcaption></figure><p id="96dc" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这是一个有趣的第一个图…我们可以看到从 10 月到 11 月中旬的巨大活动。我立刻有了一些初步的想法。那段时间比较暖和，当我导出数据时，我确实注意到它正在从三四个来源检索数据。我的 iPhone，我的高尔夫 GPS 应用程序，我的 nike run 应用程序，我的 Fitbit，直到它坏掉。我最初的想法是，在那几个月里，我更多地使用了所有这些设备，因此我看到了峰值。</p><h2 id="400c" class="mg lj je bd lk mh mi dn lo mj mk dp ls km ml mm lw kq mn mo ma ku mp mq me mr bi translated">我的第一部分结论是:</h2><p id="fb6c" class="pw-post-body-paragraph kb kc je kd b ke ms kg kh ki mt kk kl km mu ko kp kq mv ks kt ku mw kw kx ky im bi translated">第 1 部分到此结束。在第 2 部分中，我将更深入地研究这个情节，讨论时间序列的考虑因素，并在我们的数据中使用一个叫做 ARIMA/博克斯詹金斯方法的模型。我还会谈到时间序列因素，如趋势、季节性、均值和方差。</p><p id="d0d9" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">对我的朋友 WH 大声喊出来，是他启发了我去做这件事！虽然我确实想公开他的名字以保护他的隐私，但他之前的数据探索，包括使用 python 绘制他在纽约最常去的地方的地图，以及使用苹果公司的“屏幕时间”应用程序监控他的数字福祉，都激励我将数据很好地用于我自己的个人生活。</p></div><div class="ab cl om on hx oo" role="separator"><span class="op bw bk oq or os"/><span class="op bw bk oq or os"/><span class="op bw bk oq or"/></div><div class="im in io ip iq"><p id="07f9" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><strong class="kd jf"> <em class="na">来自《走向数据科学》编辑的提示:</em> </strong> <em class="na">虽然我们允许独立作者根据我们的</em> <a class="ae nt" rel="noopener" target="_blank" href="/questions-96667b06af5"> <em class="na">规则和指导方针</em> </a> <em class="na">发表文章，但我们不认可每个作者的贡献。你不应该在没有寻求专业建议的情况下依赖一个作者的作品。详见我们的</em> <a class="ae nt" rel="noopener" target="_blank" href="/readers-terms-b5d780a700a4"> <em class="na">读者术语</em> </a> <em class="na">。</em></p></div></div>    
</body>
</html>