<html>
<head>
<title>Custom Named Entity Recognition Using spaCy</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">ä½¿ç”¨ç©ºé—´çš„è‡ªå®šä¹‰å‘½åå®ä½“è¯†åˆ«</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://towardsdatascience.com/custom-named-entity-recognition-using-spacy-7140ebbb3718?source=collection_archive---------0-----------------------#2019-04-18">https://towardsdatascience.com/custom-named-entity-recognition-using-spacy-7140ebbb3718?source=collection_archive---------0-----------------------#2019-04-18</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/a3ee50418fc6cd06fea40cfd88b930b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HTtQseukwrBiREJf8MSVcA.jpeg"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Figure 1: <a class="ae kc" href="https://www.google.com/url?sa=i&amp;source=images&amp;cd=&amp;cad=rja&amp;uact=8&amp;ved=2ahUKEwiKo-uSzffgAhXJknAKHXH4CwYQjRx6BAgBEAU&amp;url=%2Furl%3Fsa%3Di%26source%3Dimages%26cd%3D%26ved%3D%26url%3Dhttps%253A%252F%252Fspacy.io%252Fusage%252Flinguistic-features%26psig%3DAOvVaw3H52fKKxtUkhEj4jVFkQxO%26ust%3D1552308120763958&amp;psig=AOvVaw3H52fKKxtUkhEj4jVFkQxO&amp;ust=1552308120763958" rel="noopener ugc nofollow" target="_blank">Source</a></figcaption></figure><h1 id="f6e6" class="kd ke iq bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">ä»€ä¹ˆæ˜¯å‘½åå®ä½“è¯†åˆ«(NER)ï¼Ÿ</h1><p id="1af1" class="pw-post-body-paragraph lb lc iq ld b le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">å‘½åå®ä½“è¯†åˆ«(NER)æ˜¯ä¿¡æ¯æå–(IE)çš„ä¸€ä¸ªå­ä»»åŠ¡ï¼Œåœ¨ä¸€ä¸ªæˆ–å¤šä¸ªæ–‡æœ¬ä¸»ä½“ä¸­æ‰¾å‡ºæŒ‡å®šçš„<a class="ae kc" href="https://en.wikipedia.org/wiki/Named_entity" rel="noopener ugc nofollow" target="_blank">å®ä½“</a>å¹¶å¯¹å…¶è¿›è¡Œåˆ†ç±»ã€‚NER ä¹Ÿç®€ç§°ä¸ºå®ä½“è¯†åˆ«ã€å®ä½“åˆ†å—å’Œå®ä½“æå–ã€‚NER è¢«ç”¨äºäººå·¥æ™ºèƒ½çš„è®¸å¤šé¢†åŸŸ(<a class="ae kc" href="https://en.wikipedia.org/wiki/Artificial_intelligence" rel="noopener ugc nofollow" target="_blank"> AI </a>)ï¼ŒåŒ…æ‹¬è‡ªç„¶è¯­è¨€å¤„ç†(<a class="ae kc" href="https://en.wikipedia.org/wiki/Natural_language_processing" rel="noopener ugc nofollow" target="_blank"> NLP </a>)å’Œ<a class="ae kc" href="https://en.wikipedia.org/wiki/Machine_learning" rel="noopener ugc nofollow" target="_blank">æœºå™¨å­¦ä¹ </a>ã€‚</p><h1 id="5ebc" class="kd ke iq bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">NER çš„ç©ºé—´</h1><p id="31eb" class="pw-post-body-paragraph lb lc iq ld b le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">SpaCy æ˜¯ Python ä¸­é«˜çº§è‡ªç„¶è¯­è¨€å¤„ç†çš„å¼€æºåº“ã€‚å®ƒæ˜¯ä¸“é—¨ä¸ºç”Ÿäº§ä½¿ç”¨è€Œè®¾è®¡çš„ï¼Œæœ‰åŠ©äºæ„å»ºå¤„ç†å’Œâ€œç†è§£â€å¤§é‡æ–‡æœ¬çš„åº”ç”¨ç¨‹åºã€‚å®ƒå¯ä»¥ç”¨äºæ„å»ºä¿¡æ¯æå–æˆ–è‡ªç„¶è¯­è¨€ç†è§£ç³»ç»Ÿï¼Œæˆ–è€…ç”¨äºæ·±åº¦å­¦ä¹ çš„æ–‡æœ¬é¢„å¤„ç†ã€‚spaCy æä¾›çš„ä¸€äº›åŠŸèƒ½åŒ…æ‹¬æ ‡è®°åŒ–ã€è¯æ€§(PoS)æ ‡è®°ã€æ–‡æœ¬åˆ†ç±»å’Œå‘½åå®ä½“è¯†åˆ«ã€‚</p><p id="6c92" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">SpaCy ä¸º python ä¸­çš„ NER æä¾›äº†ä¸€ä¸ªéå¸¸æœ‰æ•ˆçš„ç»Ÿè®¡ç³»ç»Ÿï¼Œå®ƒå¯ä»¥å°†æ ‡ç­¾åˆ†é…ç»™è¿ç»­çš„æ ‡è®°ç»„ã€‚å®ƒæä¾›äº†ä¸€ä¸ªé»˜è®¤æ¨¡å‹ï¼Œå¯ä»¥è¯†åˆ«å¹¿æ³›çš„å‘½åæˆ–æ•°å­—å®ä½“ï¼ŒåŒ…æ‹¬<em class="me">ä¸ªäººã€ç»„ç»‡ã€è¯­è¨€ã€äº‹ä»¶ç­‰ã€‚</em>é™¤äº†è¿™äº›é»˜è®¤å®ä½“ä¹‹å¤–ï¼ŒspaCy è¿˜å…è®¸æˆ‘ä»¬è‡ªç”±åœ°å‘ NER æ¨¡å‹æ·»åŠ ä»»æ„ç±»åˆ«ï¼Œæ–¹æ³•æ˜¯è®­ç»ƒè¯¥æ¨¡å‹ï¼Œä»¥ä¾¿ç”¨æ›´æ–°çš„è®­ç»ƒæ ·æœ¬å¯¹å…¶è¿›è¡Œæ›´æ–°ã€‚</p><h1 id="c7e1" class="kd ke iq bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">å…¥é—¨æŒ‡å—</h1><h2 id="6cc2" class="mf ke iq bd kf mg mh dn kj mi mj dp kn lm mk ml kr lq mm mn kv lu mo mp kz mq bi translated">è£…ç½®</h2><p id="6d96" class="pw-post-body-paragraph lb lc iq ld b le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">SpaCy å¯ä»¥é€šè¿‡ç®€å•çš„<code class="fe mr ms mt mu b">pip</code>å®‰è£…æ¥å®‰è£…ã€‚æ‚¨è¿˜éœ€è¦ä¸‹è½½æ‚¨å¸Œæœ›ä½¿ç”¨ spaCy çš„è¯­è¨€çš„è¯­è¨€æ¨¡å‹ã€‚</p><pre class="mv mw mx my gt mz mu na nb aw nc bi"><span id="c221" class="mf ke iq mu b gy nd ne l nf ng">pip install -U spacy <br/>python -m spacy download en</span></pre><h1 id="537e" class="kd ke iq bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">æˆ‘ä»¬å¼€å§‹å§ï¼</h1><h2 id="c770" class="mf ke iq bd kf mg mh dn kj mi mj dp kn lm mk ml kr lq mm mn kv lu mo mp kz mq bi translated"><em class="nh">æ•°æ®é›†</em></h2><p id="d870" class="pw-post-body-paragraph lb lc iq ld b le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">æˆ‘ä»¬å°†è¦å¤„ç†çš„æ•°æ®é›†å¯ä»¥ä»<a class="ae kc" href="https://www.kaggle.com/abhinavwalia95/entity-annotated-corpus" rel="noopener ugc nofollow" target="_blank">è¿™é‡Œ</a>ä¸‹è½½ã€‚æˆ‘ä»¬å°†ä½¿ç”¨<code class="fe mr ms mt mu b">ner_dataset.csv</code>æ–‡ä»¶ï¼Œåªè®­ç»ƒ 260 ä¸ªå¥å­ã€‚</p><figure class="mv mw mx my gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ni"><img src="../Images/a9c9f9babecb958f32d4085818c44369.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QXIMTMpUCUmS4CIjHQoM-Q.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Figure 2: NER Dataset</figcaption></figure><p id="d049" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">æ•°æ®é›†ç”±ä»¥ä¸‹æ ‡ç­¾ç»„æˆ-</p><ul class=""><li id="0efd" class="nj nk iq ld b le lz li ma lm nl lq nm lu nn ly no np nq nr bi translated">åœ°ç†=åœ°ç†å®ä½“</li><li id="c886" class="nj nk iq ld b le ns li nt lm nu lq nv lu nw ly no np nq nr bi translated">org =ç»„ç»‡</li><li id="1acf" class="nj nk iq ld b le ns li nt lm nu lq nv lu nw ly no np nq nr bi translated">per =äºº</li><li id="cf43" class="nj nk iq ld b le ns li nt lm nu lq nv lu nw ly no np nq nr bi translated">åœ°ç¼˜æ”¿æ²»å®ä½“</li><li id="e43a" class="nj nk iq ld b le ns li nt lm nu lq nv lu nw ly no np nq nr bi translated">tim =æ—¶é—´æŒ‡ç¤ºå™¨</li><li id="01c8" class="nj nk iq ld b le ns li nt lm nu lq nv lu nw ly no np nq nr bi translated">è‰ºæœ¯=è‰ºæœ¯å“</li><li id="d10e" class="nj nk iq ld b le ns li nt lm nu lq nv lu nw ly no np nq nr bi translated">eve =äº‹ä»¶</li><li id="30b3" class="nj nk iq ld b le ns li nt lm nu lq nv lu nw ly no np nq nr bi translated">è‡ªç„¶ç°è±¡</li></ul><p id="f6e2" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">æ•°æ®é›†éµå¾ª<a class="ae kc" href="https://natural-language-understanding.fandom.com/wiki/Named_entity_recognition" rel="noopener ugc nofollow" target="_blank">ç”Ÿç‰©</a>ç±»å‹æ ‡è®°ã€‚</p><h2 id="0294" class="mf ke iq bd kf mg mh dn kj mi mj dp kn lm mk ml kr lq mm mn kv lu mo mp kz mq bi translated">æ•°æ®é¢„å¤„ç†</h2><p id="725a" class="pw-post-body-paragraph lb lc iq ld b le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">SpaCy è¦æ±‚è®­ç»ƒæ•°æ®é‡‡ç”¨ä»¥ä¸‹æ ¼å¼-</p><figure class="mv mw mx my gt jr gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/ed11bbe8750b526beb24811c43c37fdd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1216/format:webp/1*TZWuuZjHDMWArQUCohXWGg.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Figure 3: spaCy Format Training Data (<a class="ae kc" href="https://spacy.io/usage/training#ner" rel="noopener ugc nofollow" target="_blank">Source</a>)</figcaption></figure><p id="c7a4" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">æ‰€ä»¥æˆ‘ä»¬å¿…é¡»æŠŠæˆ‘ä»¬çš„æ•°æ®ä»<code class="fe mr ms mt mu b">.csv</code>æ ¼å¼è½¬æ¢æˆä¸Šé¢çš„æ ¼å¼ã€‚<em class="me">(spaCy ä¹Ÿæ¥å—å…¶ä»–å½¢å¼çš„è®­ç»ƒæ•°æ®ã€‚æ›´å¤šç»†èŠ‚è¯·å‚è€ƒ</em> <a class="ae kc" href="https://spacy.io/api/annotation#named-entities" rel="noopener ugc nofollow" target="_blank"> <em class="me">æ–‡æ¡£</em> </a> <em class="me">ã€‚)</em>æˆ‘ä»¬é¦–å…ˆåˆ é™¤åˆ—<code class="fe mr ms mt mu b">Sentence #</code>å’Œ<code class="fe mr ms mt mu b">POS</code>ï¼Œå› ä¸ºæˆ‘ä»¬ä¸éœ€è¦å®ƒä»¬ï¼Œç„¶åå°†<code class="fe mr ms mt mu b">.csv</code>æ–‡ä»¶è½¬æ¢ä¸º<code class="fe mr ms mt mu b">.tsv</code>æ–‡ä»¶ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å¿…é¡»è¿è¡Œä¸‹é¢çš„è„šæœ¬æ¥è·å–<code class="fe mr ms mt mu b">.json</code>æ ¼å¼çš„è®­ç»ƒæ•°æ®ã€‚</p><figure class="mv mw mx my gt jr"><div class="bz fp l di"><div class="ny nz l"/></div></figure><p id="929e" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">ç°åœ¨æ•°æ®åº”è¯¥æ˜¯è¿™æ ·çš„ï¼Œ</p><figure class="mv mw mx my gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi oa"><img src="../Images/c95f605e41368b74ea2b2c2a54cf43c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SyROr8n7L3Z45UiiRqGUPQ.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Figure 4: Training Data in Json Format</figcaption></figure><p id="bff0" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">ä¸‹ä¸€æ­¥æ˜¯å°†ä¸Šè¿°æ•°æ®è½¬æ¢æˆ spaCy éœ€è¦çš„æ ¼å¼ã€‚å¯ä»¥ä½¿ç”¨ä»¥ä¸‹è„šæœ¬æ¥å®Œæˆ-</p><figure class="mv mw mx my gt jr"><div class="bz fp l di"><div class="ny nz l"/></div></figure><p id="4f5e" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">ç°åœ¨æˆ‘ä»¬å·²ç»ä¸ºè®­ç»ƒå‡†å¤‡å¥½äº†æ•°æ®ï¼è®©æˆ‘ä»¬é€šè¿‡æ·»åŠ è‡ªå®šä¹‰å®ä½“æ¥è®­ç»ƒä¸€ä¸ª NER æ¨¡å‹ã€‚</p><h2 id="e2b7" class="mf ke iq bd kf mg mh dn kj mi mj dp kn lm mk ml kr lq mm mn kv lu mo mp kz mq bi translated">ä½¿ç”¨è‡ªå®šä¹‰å®ä½“åŸ¹è®­ç©ºé—´ NER</h2><p id="a2ca" class="pw-post-body-paragraph lb lc iq ld b le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">SpaCy NER å·²ç»æ”¯æŒåƒ- <code class="fe mr ms mt mu b">PERSON</code>äººè¿™æ ·çš„å®ä½“ç±»å‹ï¼ŒåŒ…æ‹¬è™šæ„çš„ã€‚æ°‘æ—ã€å®—æ•™æˆ–æ”¿æ²»å›¢ä½“ã€‚<code class="fe mr ms mt mu b">FAC</code>å»ºç­‘ã€æœºåœºã€å…¬è·¯ã€æ¡¥æ¢ç­‰ã€‚<code class="fe mr ms mt mu b">ORG</code>å…¬å¸ã€æœºå…³ã€æœºæ„ç­‰ã€‚<code class="fe mr ms mt mu b">GPE</code>å›½å®¶ã€åŸå¸‚ã€å·ç­‰ã€‚</p><p id="0aa5" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">æˆ‘ä»¬çš„ç›®æ ‡æ˜¯è¿›ä¸€æ­¥è®­ç»ƒè¿™ä¸ªæ¨¡å‹ï¼Œä½¿å…¶åŒ…å«æˆ‘ä»¬æ•°æ®é›†ä¸­çš„è‡ªå®šä¹‰å®ä½“ã€‚è¦åšåˆ°è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬å¿…é¡»ç»å†ä»¥ä¸‹æ­¥éª¤-</p><ol class=""><li id="bbce" class="nj nk iq ld b le lz li ma lm nl lq nm lu nn ly ob np nq nr bi translated"><strong class="ld ir">åŠ è½½æ¨¡å‹</strong>ï¼Œæˆ–ä½¿ç”¨å¸¦æœ‰æ‰€éœ€è¯­è¨€ ID çš„<code class="fe mr ms mt mu b"><a class="ae kc" href="https://spacy.io/api/top-level#spacy.blank" rel="noopener ugc nofollow" target="_blank">spacy.blank</a></code>åˆ›å»ºä¸€ä¸ª<strong class="ld ir">ç©ºæ¨¡å‹</strong>ã€‚å¦‚æœæ­£åœ¨ä½¿ç”¨ç©ºç™½æ¨¡å‹ï¼Œæˆ‘ä»¬å¿…é¡»å°†å®ä½“è¯†åˆ«å™¨æ·»åŠ åˆ°<a class="ae kc" href="https://spacy.io/usage/processing-pipelines" rel="noopener ugc nofollow" target="_blank">ç®¡é“</a>ä¸­ã€‚å¦‚æœä½¿ç”¨ç°æœ‰æ¨¡å‹ï¼Œæˆ‘ä»¬å¿…é¡»åœ¨è®­ç»ƒæœŸé—´ä½¿ç”¨<code class="fe mr ms mt mu b"><a class="ae kc" href="https://spacy.io/api/language#disable_pipes" rel="noopener ugc nofollow" target="_blank">nlp.disable_pipes</a></code>ç¦ç”¨æ‰€æœ‰å…¶ä»–ç®¡é“ç»„ä»¶ã€‚è¿™æ ·ï¼Œåªæœ‰å®ä½“è¯†åˆ«å™¨å¾—åˆ°è®­ç»ƒã€‚</li></ol><pre class="mv mw mx my gt mz mu na nb aw nc bi"><span id="04a4" class="mf ke iq mu b gy nd ne l nf ng"># Setting up the pipeline and entity recognizer.</span><span id="757f" class="mf ke iq mu b gy oc ne l nf ng">if model is not None:<br/>    nlp = spacy.load(model)  # load existing spacy model<br/>    print("Loaded model '%s'" % model)<br/>else:<br/>    nlp = spacy.blank('en')  # create blank Language class<br/>    print("Created blank 'en' model")</span><span id="5104" class="mf ke iq mu b gy oc ne l nf ng">if 'ner' not in nlp.pipe_names:<br/>    ner = nlp.create_pipe('ner')<br/>    nlp.add_pipe(ner)<br/>else:<br/>    ner = nlp.get_pipe('ner')</span></pre><p id="f5c0" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">2.<strong class="ld ir">ä½¿ç”¨<code class="fe mr ms mt mu b"><a class="ae kc" href="https://spacy.io/api/entityrecognizer#add_label" rel="noopener ugc nofollow" target="_blank">add_label</a></code>æ–¹æ³•å°†æ–°çš„å®ä½“æ ‡ç­¾</strong>æ·»åŠ åˆ°å®ä½“è¯†åˆ«å™¨ä¸­ã€‚</p><pre class="mv mw mx my gt mz mu na nb aw nc bi"><span id="a362" class="mf ke iq mu b gy nd ne l nf ng"># Add new entity labels to entity recognizer</span><span id="ccfe" class="mf ke iq mu b gy oc ne l nf ng">for i in LABEL:<br/>    ner.add_label(i)</span><span id="aef0" class="mf ke iq mu b gy oc ne l nf ng"># Inititalizing optimizer</span><span id="4531" class="mf ke iq mu b gy oc ne l nf ng">if model is None:<br/>    optimizer = nlp.begin_training()<br/>else:<br/>    optimizer = nlp.entity.create_optimizer()</span></pre><p id="bce5" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">3.<strong class="ld ir">å¾ªç¯éå†</strong>ç¤ºä¾‹ï¼Œå¹¶è°ƒç”¨<code class="fe mr ms mt mu b"><a class="ae kc" href="https://spacy.io/api/language#update" rel="noopener ugc nofollow" target="_blank">nlp.update</a></code>ï¼Œé€æ­¥éå†è¾“å…¥çš„å•è¯ã€‚åœ¨æ¯ä¸€ä¸ªå•è¯ä¸Šï¼Œå®ƒéƒ½ä¼šåšå‡ºä¸€ä¸ª<strong class="ld ir">é¢„æµ‹</strong>ã€‚ç„¶åï¼Œå®ƒæŸ¥é˜…æ³¨é‡Šï¼Œçœ‹çœ‹å®ƒæ˜¯å¦æ­£ç¡®ã€‚å¦‚æœå®ƒé”™äº†ï¼Œå®ƒä¼šè°ƒæ•´å®ƒçš„æƒé‡ï¼Œè¿™æ ·ä¸‹æ¬¡æ­£ç¡®çš„åŠ¨ä½œä¼šå¾—åˆ°æ›´é«˜çš„åˆ†æ•°ã€‚</p><pre class="mv mw mx my gt mz mu na nb aw nc bi"><span id="4573" class="mf ke iq mu b gy nd ne l nf ng"># Get names of other pipes to disable them during training to train # only NER and update the weights</span><span id="f844" class="mf ke iq mu b gy oc ne l nf ng">other_pipes = [pipe for pipe in nlp.pipe_names if pipe != 'ner']<br/>with nlp.disable_pipes(*other_pipes):  # only train NER<br/>    for itn in range(n_iter):<br/>        random.shuffle(TRAIN_DATA)<br/>        losses = {}<br/>        batches = minibatch(TRAIN_DATA, <br/>                            size=compounding(4., 32., 1.001))<br/>        for batch in batches:<br/>            texts, annotations = zip(*batch) <br/>            # Updating the weights<br/>            nlp.update(texts, annotations, sgd=optimizer, <br/>                       drop=0.35, losses=losses)<br/>        print('Losses', losses)</span><span id="4e32" class="mf ke iq mu b gy oc ne l nf ng">            nlp.update(texts, annotations, sgd=optimizer, <br/>                       drop=0.35, losses=losses)<br/>        print('Losses', losses)</span></pre><p id="0622" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">4.<strong class="ld ir">ä½¿ç”¨<code class="fe mr ms mt mu b"><a class="ae kc" href="https://spacy.io/api/language#to_disk" rel="noopener ugc nofollow" target="_blank">nlp.to_disk</a></code>ä¿å­˜</strong>è®­ç»ƒå¥½çš„æ¨¡å‹ã€‚</p><pre class="mv mw mx my gt mz mu na nb aw nc bi"><span id="e10d" class="mf ke iq mu b gy nd ne l nf ng"># Save model <br/>if output_dir is not None:<br/>    output_dir = Path(output_dir)<br/>    if not output_dir.exists():<br/>        output_dir.mkdir()<br/>    nlp.meta['name'] = new_model_name  # rename model<br/>    nlp.to_disk(output_dir)<br/>    print("Saved model to", output_dir)</span></pre><p id="f5c7" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">5.<strong class="ld ir">æµ‹è¯•</strong>æ¨¡å‹ï¼Œç¡®ä¿æ–°å®ä½“è¢«æ­£ç¡®è¯†åˆ«ã€‚</p><pre class="mv mw mx my gt mz mu na nb aw nc bi"><span id="c771" class="mf ke iq mu b gy nd ne l nf ng"># Test the saved model<br/>print("Loading from", output_dir)<br/>nlp2 = spacy.load(output_dir)<br/>doc2 = nlp2(test_text)<br/>for ent in doc2.ents:<br/>    print(ent.label_, ent.text)</span></pre><p id="2717" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">ä½¿ç”¨æ­¤è„šæœ¬æ¥è®­ç»ƒå’Œæµ‹è¯•æ¨¡å‹-</p><figure class="mv mw mx my gt jr"><div class="bz fp l di"><div class="ny nz l"/></div></figure><p id="db82" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">æ‰§è¡ŒæŒ‡ä»¤-</p><pre class="mv mw mx my gt mz mu na nb aw nc bi"><span id="561c" class="mf ke iq mu b gy nd ne l nf ng">python spacy_ner_custom_entities.py \<br/>-m=en \ <br/>-o=path/to/output/directory \<br/>-n=1000</span></pre><h2 id="f5fc" class="mf ke iq bd kf mg mh dn kj mi mj dp kn lm mk ml kr lq mm mn kv lu mo mp kz mq bi translated">ç»“æœ</h2><p id="c262" class="pw-post-body-paragraph lb lc iq ld b le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">å½“å¯¹æŸ¥è¯¢- <code class="fe mr ms mt mu b">['John Lee is the chief of CBSE', 'Americans suffered from H5N1']</code>è¿›è¡Œæµ‹è¯•æ—¶ï¼Œæ¨¡å‹è¯†åˆ«å‡ºä»¥ä¸‹å®ä½“-</p><pre class="mv mw mx my gt mz mu na nb aw nc bi"><span id="2c92" class="mf ke iq mu b gy nd ne l nf ng">John Lee is the chief of CBSE.</span><span id="0588" class="mf ke iq mu b gy oc ne l nf ng">B-per John</span><span id="83de" class="mf ke iq mu b gy oc ne l nf ng">I-per Lee</span><span id="31c5" class="mf ke iq mu b gy oc ne l nf ng">B-org CBSE</span><span id="de17" class="mf ke iq mu b gy oc ne l nf ng"><br/>Americans suffered from H5N1 virus in 2002.</span><span id="49e0" class="mf ke iq mu b gy oc ne l nf ng">B-gpe Americans</span><span id="2c69" class="mf ke iq mu b gy oc ne l nf ng">B-nat H5N1</span><span id="44af" class="mf ke iq mu b gy oc ne l nf ng">B-tim 2002</span></pre><h1 id="4fd6" class="kd ke iq bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">ç»“è®º</h1><p id="6d3e" class="pw-post-body-paragraph lb lc iq ld b le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">æˆ‘å¸Œæœ›ä½ ç°åœ¨å·²ç»æ˜ç™½äº†å¦‚ä½•åœ¨æ–¯å¸•è¥¿ NER æ¨¡å‹çš„åŸºç¡€ä¸Šè®­ç»ƒä½ è‡ªå·±çš„ NER æ¨¡å‹ã€‚æ„Ÿè°¢é˜…è¯»ï¼ğŸ˜Š</p></div></div>    
</body>
</html>