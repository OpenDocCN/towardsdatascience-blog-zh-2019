<html>
<head>
<title>What I Learned from (Two-time) Kaggle Grandmaster Abhishek Thakur</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我从(两届)卡格大师阿布舍克·塔库尔那里学到了什么</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/what-i-learned-from-abhishek-thakur-4b905ac0fd55?source=collection_archive---------13-----------------------#2019-05-30">https://towardsdatascience.com/what-i-learned-from-abhishek-thakur-4b905ac0fd55?source=collection_archive---------13-----------------------#2019-05-30</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="41b7" class="pw-subtitle-paragraph jr is it bd b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki dk translated">从 Abhishek Thakur 的 NLP 内核中汲取灵感</h2></div><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi kj"><img src="../Images/4fd1ef8d62670db6e9098924ef619122.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*8aBkyFnpHhxCu6eZ"/></div></div><figcaption class="kv kw gj gh gi kx ky bd b be z dk">Photo by <a class="ae kz" href="https://unsplash.com/@georgie_cobbs?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Georgie Cobbs</a> on <a class="ae kz" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h2 id="c80a" class="la lb it bd lc ld le dn lf lg lh dp li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated"><strong class="ak">快速简历</strong></h2><p id="4934" class="pw-post-body-paragraph lw lx it ly b lz ma jv mb mc md jy me lj mf mg mh ln mi mj mk lr ml mm mn mo im bi translated">Abhishek Thakur 曾在遍布德国的多家公司担任数据科学家，他在 NIT Surat 获得了电子工程学士学位，在波恩大学获得了计算机科学硕士学位。目前，他拥有挪威 boost.ai 首席数据科学家的头衔，这是一家“专门从事对话式人工智能(ai)的软件公司”。但我印象最深的是阿布舍克的影响力。</p><p id="e394" class="pw-post-body-paragraph lw lx it ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo im bi translated">你可以点击这里访问他的简介<a class="ae kz" href="https://www.kaggle.com/abhishek" rel="noopener ugc nofollow" target="_blank">。以下是他所获荣誉的快照:</a></p><ul class=""><li id="0403" class="mu mv it ly b lz mp mc mq lj mw ln mx lr my mo mz na nb nc bi translated">比赛特级大师(17 枚金牌和空前的世界排名第三)</li><li id="773d" class="mu mv it ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated">内核专家(他属于 Kagglers 的前 1%之列)</li><li id="aac3" class="mu mv it ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated">讨论特级大师(65 枚金牌和空前的世界排名第二)</li></ul><p id="5f83" class="pw-post-body-paragraph lw lx it ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo im bi translated">我想看看 Abhishek 的教程，<a class="ae kz" href="https://www.kaggle.com/abhishek/approaching-almost-any-nlp-problem-on-kaggle" rel="noopener ugc nofollow" target="_blank">在 Kaggle </a>上接近(几乎)任何 NLP 问题。我选择 Abhishek 的这个内核是因为我自己一直在试图学习更多关于自然语言处理的知识，我怎么能拒绝学习 Kaggle 的万圣节主题<a class="ae kz" href="https://www.kaggle.com/c/spooky-author-identification/data" rel="noopener ugc nofollow" target="_blank">幽灵作者</a>数据集呢？</p><h2 id="b138" class="la lb it bd lc ld le dn lf lg lh dp li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated"><strong class="ak"> Abhishek 的自然语言处理方法</strong></h2><p id="1b94" class="pw-post-body-paragraph lw lx it ly b lz ma jv mb mc md jy me lj mf mg mh ln mi mj mk lr ml mm mn mo im bi translated">我强烈建议您阅读这篇关于内核的文章。如果你真的想更牢固地掌握 NLP 或一般的数据科学，确保你理解 Abhishek 的每一行代码，在你浏览他的内核时自己写。</p><p id="4533" class="pw-post-body-paragraph lw lx it ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo im bi translated">只是我们不要忘记——我们的任务是确定<strong class="ly iu">作者</strong>(EAP——埃德加·爱伦·坡；HPL—h . p . love craft；MWS——玛莉·渥斯顿克雷福特·雪莱)。</p><p id="404d" class="pw-post-body-paragraph lw lx it ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo im bi translated"><strong class="ly iu"> 1。探索数据和理解问题</strong></p><p id="3ec8" class="pw-post-body-paragraph lw lx it ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo im bi translated">在导入必要的 Python 模块和数据之后，Abhishek 对数据调用 head()方法来查看前五行是什么样子的。由于 Abhishek 是专家，这是一个 NLP 问题，与涉及数字数据的问题相比，<strong class="ly iu">探索性数据分析</strong>(你最常看到的是 EDA)是肤浅的。数据科学新手可能会从更彻底的 EDA 中受益。对数据的深入研究可以发现任何缺失的值，让您知道需要清理多少数据，并帮助您在问题的后期做出建模决策。</p><p id="7254" class="pw-post-body-paragraph lw lx it ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo im bi translated">Abhishek 还提醒我们，我们正在处理一个多类文本分类问题。不要忘记我们正在努力实现的目标，这总是一个好主意！他注意到 Kaggle 将使用什么评估标准来对提交的内容进行评分。对于这场比赛，Kaggle 使用<strong class="ly iu">多类对数损失</strong>来衡量提交模型的性能。理想情况下，我们的多类分类模型的对数损失为 0。如果你感兴趣，这里有更多关于<a class="ae kz" href="http://wiki.fast.ai/index.php/Log_Loss" rel="noopener ugc nofollow" target="_blank">原木损耗</a>的内容。</p><p id="1787" class="pw-post-body-paragraph lw lx it ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo im bi translated"><strong class="ly iu"> 2。预处理</strong></p><p id="d64d" class="pw-post-body-paragraph lw lx it ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo im bi translated">接下来，Abhishek 使用 scikit-learn 中的 LabelEncoder()方法为每个作者分配一个整数值。通过用<strong class="ly iu"> </strong>整数值(0，1，2)对<strong class="ly iu"> author </strong>列中的值的文本标签进行编码，Abhishek 使数据更易于他的分类模型理解。</p><p id="bc87" class="pw-post-body-paragraph lw lx it ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo im bi translated">对<strong class="ly iu">作者</strong>标签进行编码后，Abhishek 使用 scikit-learn 中的 train_test_split 将数据分成训练集和验证集。他选择 90:10 的训练/验证分割(Python 数据科学中最常用的分割通常在 70:30 到 80:20 之间)。所以他打算用数据集中 90%的句子来训练模型，然后他会用剩下的 10%的数据来评估他的模型的准确性。</p><p id="6ce2" class="pw-post-body-paragraph lw lx it ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo im bi translated"><strong class="ly iu"> 3。建立模型</strong></p><p id="63b6" class="pw-post-body-paragraph lw lx it ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo im bi translated">在创建他的第一个模型之前，Abhishek 对数据使用了 TF-IDF(术语频率——逆文档频率)。TF-IDF 将对出现在<strong class="ly iu">文本</strong>列的句子中的单词进行加权。因此，TF-IDF 将帮助我们理解当我们试图确定哪个作者写了一个特定的句子时，哪些词是重要的——诸如“the”之类的词对于分类任何作者来说都不重要，因为“the”出现频率很高，不会透露太多信息，但是，例如，“Cthulhu”之类的词在分类 H.P. Lovecraft 所写的句子时将非常重要。更多关于 TF-IDF 的信息可以在<a class="ae kz" href="https://en.m.wikipedia.org/wiki/Tf%E2%80%93idf" rel="noopener ugc nofollow" target="_blank">这里</a>和<a class="ae kz" href="https://www.quora.com/How-does-TfidfVectorizer-work-in-laymans-terms" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p><p id="64a2" class="pw-post-body-paragraph lw lx it ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo im bi translated">对数据运行这个 TF-IDF 是<strong class="ly iu">特征提取</strong>的一种形式。在这里，我们需要推导出某种重要的预测因子或数据特征，来帮助我们找出哪个作者写了一个特定的句子。使用 TF-IDF，我们有了一个单词重要性的统计度量，可以帮助我们预测句子的作者。</p><p id="0925" class="pw-post-body-paragraph lw lx it ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo im bi translated">在对训练集和验证集拟合 TF-IDF 后，Abhishek 准备了一个逻辑回归模型。如果这种类型的分类模型对您来说是新的，请在继续之前阅读<a class="ae kz" rel="noopener" target="_blank" href="/building-a-logistic-regression-in-python-step-by-step-becd4d56c9c8">此</a>。在拟合了逻辑回归模型之后，Abhishek 计算了他的逻辑回归模型的对数损失(回想一下，他在内核的开头附近编写了多类对数损失函数)。多类对数损失函数返回逻辑回归模型的对数损失值<em class="ni"> 0.626 </em>。虽然拟合 TF-IDF 和逻辑回归模型给了我们一个良好的开端，但我们可以改善这一对数损失评分。</p><p id="e086" class="pw-post-body-paragraph lw lx it ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo im bi translated"><strong class="ly iu"> 4。模型调整</strong></p><p id="2a21" class="pw-post-body-paragraph lw lx it ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo im bi translated">因此，我们对 0.626<em class="ni">的对数损失分数不满意，希望优化这一评估指标。从这里，我们可以采取多条路线，这正是 Abhishek 所做的。在我们探索和预处理了我们的数据之后，我们剩下了许多不同的特征提取和模型拟合的组合。例如，Abhishek 使用字数来进行特征提取，而不是 TF-IDF。使用这种特征提取技术，他的逻辑回归模型的对数损失分数从<em class="ni"> 0.626 </em>提高到<em class="ni">0.528</em>——这是一个巨大的<em class="ni"> 0.098 </em>的提高！</em></p><h1 id="3ae4" class="nj lb it bd lc nk nl nm lf nn no np li ka nq kb lm kd nr ke lq kg ns kh lu nt bi translated"><strong class="ak">总结</strong></h1><p id="bfe9" class="pw-post-body-paragraph lw lx it ly b lz ma jv mb mc md jy me lj mf mg mh ln mi mj mk lr ml mm mn mo im bi translated">由于 Abhishek 的内核从这一点开始变得越来越详细，我将让他来解释其他分类模型。</p><p id="a067" class="pw-post-body-paragraph lw lx it ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo im bi translated">我们讨论的内容如下:</p><ul class=""><li id="264b" class="mu mv it ly b lz mp mc mq lj mw ln mx lr my mo mz na nb nc bi translated"><strong class="ly iu"> EDA </strong>:如果我们想要理解数据集，探索性数据分析是至关重要的，当我们开始构建模型时，EDA 可以节省我们的时间</li><li id="e217" class="mu mv it ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated"><strong class="ly iu">多类分类问题</strong>:这类问题要求我们预测哪些观察值属于哪个类，其中每个观察值可能属于三个或更多类中的任何一类</li><li id="99a7" class="mu mv it ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated">预处理:在建立任何模型之前，我们必须对数据进行预处理。在这个例子中，为了我们的模型，我们需要使用 LabelEndcoder()将文本标签转换成整数值</li><li id="f35e" class="mu mv it ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated"><strong class="ly iu">特征提取</strong>:每当我们有一个原始数据的数据集(在我们的例子中是句子摘录)时，我们将需要导出一些预测器，帮助我们确定如何对我们的观察进行分类。Abhishek 向我们展示了如何使用 TF-IDF 和字数统计</li></ul><p id="d052" class="pw-post-body-paragraph lw lx it ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo im bi translated">从这里开始，由我们来提取具有高预测能力的特征，选择与问题匹配的模型，并优化我们关心的指标。不要害怕弄脏自己的手，尝试几种模型——你很可能会找到一种模型，通过更多的实验来优化你的评估指标。我希望读完这篇文章后，你能更好地理解如何处理 NLP 问题，并且你也能欣赏 Abhishek 的工作。</p><h2 id="2752" class="la lb it bd lc ld le dn lf lg lh dp li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated"><strong class="ak">附录</strong></h2><p id="ce95" class="pw-post-body-paragraph lw lx it ly b lz ma jv mb mc md jy me lj mf mg mh ln mi mj mk lr ml mm mn mo im bi translated"><a class="ae kz" href="https://www.kaggle.com/abhishek" rel="noopener ugc nofollow" target="_blank">阿布舍克的卡格尔简介</a></p><p id="9c6d" class="pw-post-body-paragraph lw lx it ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo im bi translated"><a class="ae kz" href="https://www.kaggle.com/abhishek/approaching-almost-any-nlp-problem-on-kaggle" rel="noopener ugc nofollow" target="_blank"> Abhishek 的 NLP 内核</a></p><p id="4885" class="pw-post-body-paragraph lw lx it ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo im bi translated"><a class="ae kz" href="https://www.kaggle.com/c/spooky-author-identification/data" rel="noopener ugc nofollow" target="_blank">怪异作者数据集</a></p><p id="1656" class="pw-post-body-paragraph lw lx it ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo im bi translated"><a class="ae kz" href="http://wiki.fast.ai/index.php/Log_Loss" rel="noopener ugc nofollow" target="_blank">什么是原木损耗？</a></p><p id="00d4" class="pw-post-body-paragraph lw lx it ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo im bi translated"><a class="ae kz" href="https://en.m.wikipedia.org/wiki/Tf%E2%80%93idf" rel="noopener ugc nofollow" target="_blank">什么是 TF-IDF？</a></p><p id="8b92" class="pw-post-body-paragraph lw lx it ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo im bi translated"><a class="ae kz" href="https://www.quora.com/How-does-TfidfVectorizer-work-in-laymans-terms" rel="noopener ugc nofollow" target="_blank"> TF-IDF 通俗地说</a></p><p id="3040" class="pw-post-body-paragraph lw lx it ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo im bi translated"><a class="ae kz" rel="noopener" target="_blank" href="/building-a-logistic-regression-in-python-step-by-step-becd4d56c9c8">什么是逻辑回归？</a></p><p id="6cb3" class="pw-post-body-paragraph lw lx it ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo im bi translated">这里是本文中提到的 Abhishek 的所有代码。我想重申一下，这是我自己的工作——这个要点旨在帮助初学者跟随 Abhishek 的 NLP 教程。</p><figure class="kk kl km kn gt ko"><div class="bz fp l di"><div class="nu nv l"/></div><figcaption class="kv kw gj gh gi kx ky bd b be z dk">Credit to Abhishek Thakur for this NLP tutorial</figcaption></figure></div></div>    
</body>
</html>