<html>
<head>
<title>How I made Skinly for Melanoma Detection in Android</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我如何在 Android 中为黑色素瘤检测制作 Skinly</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-i-made-skinly-for-melanoma-detection-in-android-6ad00f0bd26d?source=collection_archive---------20-----------------------#2019-05-06">https://towardsdatascience.com/how-i-made-skinly-for-melanoma-detection-in-android-6ad00f0bd26d?source=collection_archive---------20-----------------------#2019-05-06</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="b6ee" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">将计算机视觉和 Android 与 TensorFlow Lite 和 Keras 以及所有定制数据相集成。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/1d510501c5241a00e159141c3cf406ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5ttFrs0YzL8_rORpoygBug.jpeg"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Medical Science and Computer Science have a great match!</figcaption></figure><p id="6d92" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><a class="ae lr" href="https://www.expertsystem.com/machine-learning-definition/" rel="noopener ugc nofollow" target="_blank">机器学习(ML ) </a>在医学科学和健康行业创造了奇迹。经验丰富的医生获得的专业知识现在可以通过 ML 算法来学习，这些算法是用几行代码创建的。我将分享我关于<em class="ls"> Skinly </em>的故事，这是一个可以检测<a class="ae lr" href="https://www.skincancer.org/skin-cancer-information/melanoma" rel="noopener ugc nofollow" target="_blank">黑色素瘤</a>(一种常见的皮肤癌)的安卓应用程序。</p><div class="lt lu gp gr lv lw"><a href="https://play.google.com/store/apps/details?id=com.health.inceptionapps.skinly&amp;hl=en" rel="noopener  ugc nofollow" target="_blank"><div class="lx ab fo"><div class="ly ab lz cl cj ma"><h2 class="bd ir gy z fp mb fr fs mc fu fw ip bi translated">skinly—Google Play 上的应用程序</h2><div class="md l"><h3 class="bd b gy z fp mb fr fs mc fu fw dk translated">Skinly 是一个研究项目，旨在通过您的 Android 设备检测黑色素瘤等疾病。它使用…</h3></div><div class="me l"><p class="bd b dl z fp mb fr fs mc fu fw dk translated">play.google.com</p></div></div><div class="mf l"><div class="mg l mh mi mj mf mk kp lw"/></div></div></a></div><p id="7950" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx ir">此外，我将参考各种提示，引导您找到包含相关代码的 Python 和 Java ( Android)文件。</strong></p><p id="bd7c" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">GitHub Python 项目-&gt;<a class="ae lr" href="https://github.com/shubham0204/Melanoma_Classification_with_TF" rel="noopener ugc nofollow" target="_blank">https://GitHub . com/Shu bham 0204/Melanoma _ Classification _ with _ TF</a></p><p id="dc64" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">GitHub Android 项目-&gt;<a class="ae lr" href="https://github.com/shubham0204/Skinly_for_Melanoma" rel="noopener ugc nofollow" target="_blank">https://github.com/shubham0204/Skinly_for_Melanoma</a></p><p id="18ce" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">互动 Google Colab 笔记本-&gt;<a class="ae lr" href="https://colab.research.google.com/drive/1T1SYfzT_Oe974YtI0xqp5tET5dhVo77f" rel="noopener ugc nofollow" target="_blank">https://Colab . research . Google . com/drive/1t 1 syfzt _ OE 974 yti0 xqp 5 Tet 5 dhvo 77 f</a></p><h1 id="6681" class="ml mm iq bd mn mo mp mq mr ms mt mu mv jw mw jx mx jz my ka mz kc na kd nb nc bi translated">当然是从 Python 和 TensorFlow 开始！</h1><p id="166f" class="pw-post-body-paragraph kv kw iq kx b ky nd jr la lb ne ju ld le nf lg lh li ng lk ll lm nh lo lp lq ij bi translated">我想到的第一个问题是图像数据。一个人如何能够获取成千上万的黑色素瘤图像？</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ni nj l"/></div></figure><h2 id="4d7d" class="nk mm iq bd mn nl nm dn mr nn no dp mv le np nq mx li nr ns mz lm nt nu nb nv bi translated">收集图像数据</h2><p id="e226" class="pw-post-body-paragraph kv kw iq kx b ky nd jr la lb ne ju ld le nf lg lh li ng lk ll lm nh lo lp lq ij bi translated">我使用我一直最喜欢的<a class="ae lr" href="https://chrome.google.com/webstore/detail/fatkun-batch-download-ima/nnjjahlikiabnchcpehcpkdeckfgnohf?hl=en" rel="noopener ugc nofollow" target="_blank"> Fatkun 批量下载图片</a>扩展，设法从互联网上提取了数百张图片。这个 Chrome 扩展允许我将谷歌搜索结果中的图片提取到我的电脑中。</p><ol class=""><li id="2d87" class="nw nx iq kx b ky kz lb lc le ny li nz lm oa lq ob oc od oe bi translated">为了训练，图像被调整到 32 * 32 的尺寸。</li><li id="a735" class="nw nx iq kx b ky of lb og le oh li oi lm oj lq ob oc od oe bi translated">由于图像数量较少，对图像进行了<a class="ae lr" href="https://keras.io/preprocessing/image/" rel="noopener ugc nofollow" target="_blank">增强</a>，以便模型能够更好地概括。</li><li id="a1f5" class="nw nx iq kx b ky of lb og le oh li oi lm oj lq ob oc od oe bi translated">在彩色图像(3 通道)上训练该模型。</li></ol><p id="2685" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><em class="ls">提示:查看存储在 NumPy 文件(。npy)</em><a class="ae lr" href="https://github.com/shubham0204/Dataset_Archives/blob/master/dis_recog_imgs_processed.zip" rel="noopener ugc nofollow" target="_blank">T3】此处 </a> <em class="ls">。同样，对于查看图像预处理这个</em> <a class="ae lr" href="https://github.com/shubham0204/Melanoma_Classification_with_TF/blob/master/DataProcessor.py" rel="noopener ugc nofollow" target="_blank"> <em class="ls">文件</em> </a> <em class="ls">。</em></p><h2 id="b0b8" class="nk mm iq bd mn nl nm dn mr nn no dp mv le np nq mx li nr ns mz lm nt nu nb nv bi translated">训练模型(使用 Keras)</h2><p id="7c4c" class="pw-post-body-paragraph kv kw iq kx b ky nd jr la lb ne ju ld le nf lg lh li ng lk ll lm nh lo lp lq ij bi translated">该模型需要足够聪明，能够区分健康皮肤和有黑色素瘤斑点的皮肤。为此，我选择了暹罗卷积神经网络。</p><div class="lt lu gp gr lv lw"><a href="https://medium.com/predict/face-recognition-from-scratch-using-siamese-networks-and-tensorflow-df03e32f8cd0" rel="noopener follow" target="_blank"><div class="lx ab fo"><div class="ly ab lz cl cj ma"><h2 class="bd ir gy z fp mb fr fs mc fu fw ip bi translated">使用暹罗网络和张量流从零开始进行人脸识别</h2><div class="md l"><h3 class="bd b gy z fp mb fr fs mc fu fw dk translated">人脸识别已经成为移动应用程序和许多其他机器中的常见功能之一…</h3></div><div class="me l"><p class="bd b dl z fp mb fr fs mc fu fw dk translated">medium.com</p></div></div><div class="mf l"><div class="ok l mh mi mj mf mk kp lw"/></div></div></a></div><p id="7948" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这些网络也用于人脸识别和许多其他应用。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ol nj l"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Code for building the Siamese model in Python</figcaption></figure><p id="a42c" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><em class="ls">提示:参考这个</em> <a class="ae lr" href="https://github.com/shubham0204/Melanoma_Classification_with_TF/blob/master/Model.py" rel="noopener ugc nofollow" target="_blank"> <em class="ls">文件</em> </a> <em class="ls">。</em></p><h2 id="fbaf" class="nk mm iq bd mn nl nm dn mr nn no dp mv le np nq mx li nr ns mz lm nt nu nb nv bi translated">将模型转换为 TensorFlow Lite 模型</h2><p id="2d95" class="pw-post-body-paragraph kv kw iq kx b ky nd jr la lb ne ju ld le nf lg lh li ng lk ll lm nh lo lp lq ij bi translated">为了让这样的模型在 Android 上工作，我们需要将<a class="ae lr" href="https://www.tensorflow.org/guide/keras" rel="noopener ugc nofollow" target="_blank"> Keras </a>模型(. h5)转换为<a class="ae lr" href="https://www.tensorflow.org/lite" rel="noopener ugc nofollow" target="_blank"> TensorFlow Lite </a>模型(。tflite)文件。然后，这个文件被加载到我们的 Android 应用程序中，我们在其上执行推理。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ol nj l"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Conversion of Keras model to TensorFlow Lite model</figcaption></figure><p id="6538" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><em class="ls">提示:使用</em> <a class="ae lr" href="https://www.tensorflow.org/lite/performance/post_training_quantization" rel="noopener ugc nofollow" target="_blank"> <em class="ls">岗位培训量化</em> </a> <em class="ls">帮助我大幅减少了模型大小。还有，参照这个</em> <a class="ae lr" href="https://github.com/shubham0204/Melanoma_Classification_with_TF/blob/master/TFLiteBufferConverter.py" rel="noopener ugc nofollow" target="_blank"> <em class="ls">文件</em> </a> <em class="ls">进行换算。</em></p><h1 id="0e2c" class="ml mm iq bd mn mo mp mq mr ms mt mu mv jw mw jx mx jz my ka mz kc na kd nb nc bi translated">开发 Android 应用程序(使用 Java)</h1><p id="f41e" class="pw-post-body-paragraph kv kw iq kx b ky nd jr la lb ne ju ld le nf lg lh li ng lk ll lm nh lo lp lq ij bi translated">Android 应用程序被赋予了美丽的颜色和设计，因此看起来很友好。Android Jetpack 的 <a class="ae lr" href="https://developer.android.com/topic/libraries/architecture/navigation.html" rel="noopener ugc nofollow" target="_blank">导航</a>和<a class="ae lr" href="https://developer.android.com/topic/libraries/architecture/viewmodel" rel="noopener ugc nofollow" target="_blank"> ViewModel </a>组件让工作变得更加简单快捷。</p><h2 id="aae3" class="nk mm iq bd mn nl nm dn mr nn no dp mv le np nq mx li nr ns mz lm nt nu nb nv bi translated">下载图像进行比较</h2><p id="5865" class="pw-post-body-paragraph kv kw iq kx b ky nd jr la lb ne ju ld le nf lg lh li ng lk ll lm nh lo lp lq ij bi translated">如果你以前使用过暹罗网，你会知道它需要一些数据来进行比较以产生一个分类。</p><blockquote class="om on oo"><p id="a885" class="kv kw ls kx b ky kz jr la lb lc ju ld op lf lg lh oq lj lk ll or ln lo lp lq ij bi translated">假设，我们建立了一个暹罗神经网络，用于狗和猫之间的分类。神经网络将输入图像与狗和猫的图像进行比较，并输出显示最大相似性的类别。两张猫的照片会显示出更多的相似性。</p></blockquote><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi os"><img src="../Images/18d12f41848d131fa633f0b21532bc36.png" data-original-src="https://miro.medium.com/v2/resize:fit:480/format:webp/1*xxLOfahwxoEct7-LlK5a1Q.png"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Firebase Cloud Storage</figcaption></figure><p id="bba3" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">对于 Android 来说，Firebase 云存储是存储图像然后下载它们的合适地方。</p><p id="a3d3" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><em class="ls">提示:参见</em> <a class="ae lr" href="https://firebase.google.com/docs/storage/android/start" rel="noopener ugc nofollow" target="_blank"> <em class="ls"> Firebase 云存储文档 Android </em> </a> <em class="ls">。还有，请看这个</em> <a class="ae lr" href="https://github.com/shubham0204/Skinly_for_Melanoma/blob/master/app/src/main/java/com/health/inceptionapps/skinly/MainActivity.java" rel="noopener ugc nofollow" target="_blank"> <em class="ls">文件</em> </a> <em class="ls">中的代码。</em></p><h2 id="29e4" class="nk mm iq bd mn nl nm dn mr nn no dp mv le np nq mx li nr ns mz lm nt nu nb nv bi translated">运行模型</h2><p id="e6c7" class="pw-post-body-paragraph kv kw iq kx b ky nd jr la lb ne ju ld le nf lg lh li ng lk ll lm nh lo lp lq ij bi translated">TensorFlow Lite(版本=1.13.1)依赖项帮助我们加载。Android 中的 tflite 模型。您可以将其添加到您的<code class="fe ot ou ov ow b">build.gradle</code>文件中。</p><pre class="kg kh ki kj gt ox ow oy oz aw pa bi"><span id="1a11" class="nk mm iq ow b gy pb pc l pd pe">dependencies {<br/>    // Other app dependencies<strong class="ow ir"><br/>    </strong>implementation <strong class="ow ir">'org.tensorflow:tensorflow-lite:1.13.1'<br/></strong>}</span></pre><p id="87ab" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">然后，下面的代码获得范围为[0，1]的相似性得分。该方法逐步将输入图像与所有下载的图像进行比较，然后遵循以下步骤:</p><ol class=""><li id="522d" class="nw nx iq kx b ky kz lb lc le ny li nz lm oa lq ob oc od oe bi translated">获取每个图像与输入图像的相似性得分。</li><li id="b5c9" class="nw nx iq kx b ky of lb og le oh li oi lm oj lq ob oc od oe bi translated">分离具有最高相似性得分的前 K 个(值=5 或任何其他奇数)图像。</li><li id="fd73" class="nw nx iq kx b ky of lb og le oh li oi lm oj lq ob oc od oe bi translated">解析这五幅图像的类别。</li><li id="8526" class="nw nx iq kx b ky of lb og le oh li oi lm oj lq ob oc od oe bi translated">输出五个图像类别中具有最高多数的类别。</li></ol><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ol nj l"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Code for fetching similarity scores by running the model.</figcaption></figure><p id="c9fc" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><em class="ls">提示:加载时，TFLite 模型参见</em> <a class="ae lr" href="https://github.com/shubham0204/Skinly_for_Melanoma/blob/master/app/src/main/java/com/health/inceptionapps/skinly/TFRecognizerClasses/SkinDiseaseRecognizer.java" rel="noopener ugc nofollow" target="_blank"> <em class="ls">此处</em> </a> <em class="ls">，投票/分类参见此</em> <a class="ae lr" href="https://github.com/shubham0204/Skinly_for_Melanoma/blob/master/app/src/main/java/com/health/inceptionapps/skinly/ResultActivity.java" rel="noopener ugc nofollow" target="_blank"> <em class="ls">文件</em> </a> <em class="ls">。</em></p><h2 id="d908" class="nk mm iq bd mn nl nm dn mr nn no dp mv le np nq mx li nr ns mz lm nt nu nb nv bi translated">最终应用</h2><p id="b169" class="pw-post-body-paragraph kv kw iq kx b ky nd jr la lb ne ju ld le nf lg lh li ng lk ll lm nh lo lp lq ij bi translated">最终的 Android 应用程序如下所示:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pf"><img src="../Images/622c39cdeca98096418252d224ec1d97.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dv6Y_GapXCgs-_J22ZCPGA.jpeg"/></div></div></figure><blockquote class="pg"><p id="1f5f" class="ph pi iq bd pj pk pl pm pn po pp lq dk translated">该模型可以根据较少的数据进行训练，但这种技术和想法可以扩展并进入主流生产。欢迎您的任何建议！</p></blockquote><h1 id="2cd5" class="ml mm iq bd mn mo mp mq mr ms mt mu mv jw pq jx mx jz pr ka mz kc ps kd nb nc bi translated">还有呢！</h1><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ol nj l"/></div></figure><h1 id="3d8a" class="ml mm iq bd mn mo mp mq mr ms mt mu mv jw mw jx mx jz my ka mz kc na kd nb nc bi translated">仅此而已！</h1><p id="f9d6" class="pw-post-body-paragraph kv kw iq kx b ky nd jr la lb ne ju ld le nf lg lh li ng lk ll lm nh lo lp lq ij bi translated">使用 Android 和机器学习的医学可以达到很高的高度。谢谢大家，机器学习快乐！</p></div></div>    
</body>
</html>