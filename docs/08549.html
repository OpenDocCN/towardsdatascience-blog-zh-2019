<html>
<head>
<title>Python Interactive Network Visualization Using NetworkX, Plotly, and Dash</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用 NetworkX、Plotly 和 Dash 的 Python 交互式网络可视化</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/python-interactive-network-visualization-using-networkx-plotly-and-dash-e44749161ed7?source=collection_archive---------0-----------------------#2019-11-19">https://towardsdatascience.com/python-interactive-network-visualization-using-networkx-plotly-and-dash-e44749161ed7?source=collection_archive---------0-----------------------#2019-11-19</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/be2f021d9bbf402ba097f9d2250e2a64.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rmq7bd3GFjcwfXtkrBQaPQ.png"/></div></div></figure><p id="a38c" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">他们说一张图胜过一千个单词。我完全同意。为了理解复杂的网络模式，我更喜欢看网络图，而不是通读冗长的文档。</p><p id="7fd3" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这篇文章是关于 Python 交互式网络可视化应用的。在前半部分，它涵盖了网络可视化应用程序的特性，并介绍了我用来开发这个应用程序的工具。在第二部分，将讨论如何使用 NetworkX、Plotly 和 Dash 的技术细节。</p><h1 id="487e" class="kz la it bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">1.网络可视化应用功能</h1><p id="ecf5" class="pw-post-body-paragraph kb kc it kd b ke lx kg kh ki ly kk kl km lz ko kp kq ma ks kt ku mb kw kx ky im bi translated">网络图揭示了模式，有助于发现异常。金融领域的网络可视化应用潜力巨大，例如欺诈监控和洗钱监控。对于这个项目，我将创建一个虚拟的事务数据集，并构建一个网络可视化应用程序来交互式地绘制显示这些事务的图形。</p><p id="d3b4" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">首先，该应用程序将读入虚拟交易数据集，并生成交易网络的图形表示。在这里，我想自定义图形表示，例如根据交易时间对边进行颜色编码，根据交易金额改变边的宽度。这样，很容易快速理解交易网络图。</p><p id="4d18" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">其次，它将是一个交互式应用程序。当用户悬停在一个节点或边上时，将显示丰富的信息。此外，用户应该能够输入要搜索的帐户和要显示的时间范围。然后，响应用户的输入，应用程序将相应地显示交易网络图。</p><h1 id="8a1a" class="kz la it bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">2.图书馆简介</h1><p id="1e53" class="pw-post-body-paragraph kb kc it kd b ke lx kg kh ki ly kk kl km lz ko kp kq ma ks kt ku mb kw kx ky im bi translated">我找到了几个有用的 python 包来支持这个应用程序的开发，包括<a class="ae mc" href="https://networkx.github.io/documentation/stable/" rel="noopener ugc nofollow" target="_blank"> NetworkX </a>、<a class="ae mc" href="https://plot.ly/python/" rel="noopener ugc nofollow" target="_blank"> Plotly </a>和<a class="ae mc" href="https://plot.ly/dash/" rel="noopener ugc nofollow" target="_blank"> Dash </a>。本节将简要介绍这些库，并讨论它们如何对该应用程序的开发有用。</p><p id="f081" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><strong class="kd iu"> 2.1 图论和网络 X </strong></p><p id="5f75" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">为了表示交易网络，图由节点和边组成。这里，节点表示帐户，相关属性包括客户名称和帐户类型。边是具有交易日期和交易金额的相关属性的交易。交易网络是一个有向图，每条边都从源账户指向目标账户。</p><p id="3ebf" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">NetworkX 是一个 Python 包，用于创建、操作和研究复杂网络的结构、动态和功能。它只需要几行代码就可以快速构建和可视化图形:</p><pre class="md me mf mg gt mh mi mj mk aw ml bi"><span id="593e" class="mm la it mi b gy mn mo l mp mq">import networkx as nx<br/>import matplotlib.pyplot as plt<br/>G = nx.Graph()<br/>G.add_edge(1,2)<br/>G.add_edge(1,3)<br/>nx.draw(G, with_labels=True)<br/>plt.show()</span></pre><p id="a704" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">除了使用内嵌数据构建简单的图形之外，NetworkX 还支持使用从 csv 或数据库导入的数据集构建更复杂的图形。在这里，我导入了包含交易记录的虚拟 csv 文件，并使用 NetworkX 构建了交易网络。</p><p id="66fc" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><strong class="kd iu"> 2.2 互动图和情节图</strong></p><p id="d1cb" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">Python 附带了几个有用的绘图库。与静态的 Matplotlib 和 Seaborn 库不同，Plotly 制作交互式图形。它支持许多常见的图表类型，包括折线图、散点图、条形图、直方图和热图。与 ipywidgets 一起，它允许在 Jupyter 笔记本中进行交互式数据分析。</p><p id="2661" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><strong class="kd iu"> 2.3 反应式网络应用和破折号</strong></p><p id="e0ad" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">Jupyter 笔记本在数据科学家中很受欢迎。但是我想更进一步，让其他 stackholders 也能使用这个应用程序，他们可能不需要有数据分析的背景。Web 应用程序成为一个很好的选择，因为每个人都可以使用浏览器轻松访问 web 应用程序。</p><p id="7f2d" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">然后，我找到了 Dash，这是一个用于创建反应式 web 应用程序的开源 Python 库。Dash 允许 Python 数据分析代码与前端 HTML、CSS 和 Javascript 无缝集成。利用 Dash 提供的 Python 接口和反应式装饰器，Python 数据分析代码被绑定到交互式的基于 web 的组件上。由于 Dash 是基于 Flask framework 和 React.js 构建的前端渲染，所以我可以很容易地从开源社区获得大量支持。最后但同样重要的是，Dash 与 Plotly 完全兼容，这意味着我可以将使用 Plotly 创建的网络图集成为 Dash 应用程序中的一个组件，并进一步添加其他基于 web 的组件来与我的数据分析代码进行交互。</p><h1 id="db20" class="kz la it bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">3.编码</h1><p id="bdc0" class="pw-post-body-paragraph kb kc it kd b ke lx kg kh ki ly kk kl km lz ko kp kq ma ks kt ku mb kw kx ky im bi translated">现在，让我们继续真正的编码！</p><p id="52e9" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><strong class="kd iu"> 3.1 初始化 Dash App </strong></p><p id="4659" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">因为 Dash 是建立在 Flask 框架上的，所以看到启动 Dash 应用程序和启动 Flask 应用程序几乎相同的语法就不足为奇了。</p><figure class="md me mf mg gt ju"><div class="bz fp l di"><div class="mr ms l"/></div></figure><p id="b833" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><strong class="kd iu"> 3.2 定义布局</strong></p><p id="cec5" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">借助 Python 接口 dash_html_components 和 dash_core_components，html 和基于 web 的交互式组件可轻松集成到 Python 分析代码中。这里，布局设计遵循自举网格系统。这个交易网络可视化应用程序包括 RangeSlider(定义时间范围)、输入框(键入要搜索的帐户)、Plotly graph(根据用户输入显示交易网络)、悬停框(当用户悬停在图形上时显示详细信息)和单击框(当用户单击图形时显示详细信息)等组件。</p><figure class="md me mf mg gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mt"><img src="../Images/a34e18c23129672d26097289a51b4de3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6qZb82IuL9MmGuCOU_0CQA.png"/></div></div></figure><figure class="md me mf mg gt ju"><div class="bz fp l di"><div class="mr ms l"/></div></figure><p id="75f9" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><strong class="kd iu"> 3.3 绑定到分析代码</strong></p><p id="30f0" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">当用户对 RangeSlider 或输入框进行更改时，绘图数字会相应地改变。当用户悬停或单击绘图图中的节点或边时，悬停框和单击框会显示与该节点或边相关联的详细信息。</p><figure class="md me mf mg gt ju"><div class="bz fp l di"><div class="mr ms l"/></div></figure><p id="847a" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><strong class="kd iu"> 3.4 定义 Plotly 图形</strong></p><p id="d068" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这里，代码定义了如何构建交易网络、启动 Plotly 图，以及如何响应用户的输入来更改 Plotly 图。基本上，这里的代码定义了网络图的逻辑。</p><p id="4cdc" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">首先，导入数据集并将日期字符串转换为 Python 能够理解的 Datetime 对象。</p><figure class="md me mf mg gt ju"><div class="bz fp l di"><div class="mr ms l"/></div></figure><p id="88ed" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">然后，使用 NetworkX 构建网络。</p><figure class="md me mf mg gt ju"><div class="bz fp l di"><div class="mr ms l"/></div></figure><p id="9e45" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">用 Plotly 定义节点。</p><figure class="md me mf mg gt ju"><div class="bz fp l di"><div class="mr ms l"/></div></figure><p id="74b6" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">用 Plotly 定义边。这里，定义定制的边不像定义节点那样简单。边的定制有两种方式:边的颜色代表交易的时间，交易越早，边的颜色越浅；此外，边的宽度代表交易金额，边越宽，交易金额越大。</p><figure class="md me mf mg gt ju"><div class="bz fp l di"><div class="mr ms l"/></div></figure><p id="2840" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">定义边缘上不可见的中间点，以允许边缘上的悬停效果。由于 Dash 只允许数据点上的悬停效果，所以我在边上添加了一个不可见的中间点，以在边上创建一个额外的数据点。</p><figure class="md me mf mg gt ju"><div class="bz fp l di"><div class="mr ms l"/></div></figure><p id="8d5b" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">最后，定义 Plotly 图形的布局。</p><figure class="md me mf mg gt ju"><div class="bz fp l di"><div class="mr ms l"/></div></figure><p id="eef9" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">最终交易网络可视化应用程序的工作方式如下:</p><figure class="md me mf mg gt ju"><div class="bz fp l di"><div class="mu ms l"/></div></figure><p id="20a8" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">如果你对代码感兴趣，请在<a class="ae mc" href="https://github.com/jhwang1992/network-visualization" rel="noopener ugc nofollow" target="_blank"> Github </a>上查看。</p></div></div>    
</body>
</html>