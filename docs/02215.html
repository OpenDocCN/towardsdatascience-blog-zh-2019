<html>
<head>
<title>Google BigQuery SQL Dates and Times Cheat Sheet</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Google BigQuery SQL 日期和时间备忘单</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/google-bigquery-sql-dates-and-times-cheat-sheet-805b5502c7f0?source=collection_archive---------4-----------------------#2019-04-12">https://towardsdatascience.com/google-bigquery-sql-dates-and-times-cheat-sheet-805b5502c7f0?source=collection_archive---------4-----------------------#2019-04-12</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><div class=""/><div class=""><h2 id="4e45" class="pw-subtitle-paragraph jr it iu bd b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki dk translated">常见 BigQuery 日期和时间表达式的备忘单</h2></div><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj kj"><img src="../Images/11d421a458e09229d009090022ca0c21.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PtS1SAfaNE4v_r8dj7lB_A.jpeg"/></div></div><figcaption class="kv kw gk gi gj kx ky bd b be z dk">Photo by <a class="ae kz" href="https://unsplash.com/photos/eIkbSc3SDtI?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Sonja Langford</a> on <a class="ae kz" href="https://unsplash.com/search/photos/clock?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="0626" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi lw translated">我今天早上刚刚开始做一个时间序列预测项目。与大多数数据科学任务一样，这个项目的第一步是首先收集数据。这意味着 Google BigQuery 中的 SQL 查询相对简单。我又一次发现自己在谷歌上搜索如何从时间戳中提取年份，并在文档中滚动以找到正确的函数，然后意识到我需要在某个地方写下来。我把它写在博客上，这样我就有东西可以参考，希望这也能帮助其他人。请注意，所有表达式都基于标准 SQL。</p><h1 id="c24b" class="mf mg iu bd mh mi mj mk ml mm mn mo mp ka mq kb mr kd ms ke mt kg mu kh mv mw bi translated">日期</h1><h2 id="c7cb" class="mx mg iu bd mh my mz dn ml na nb dp mp lj nc nd mr ln ne nf mt lr ng nh mv ni bi translated">日期部分</h2><p id="a42b" class="pw-post-body-paragraph la lb iu lc b ld nj jv lf lg nk jy li lj nl ll lm ln nm lp lq lr nn lt lu lv in bi translated">下列表达式中可以使用的所有日期部分的列表:</p><pre class="kk kl km kn gu no np nq nr aw ns bi"><span id="a5d7" class="mx mg iu np b gz nt nu l nv nw">DAYOFWEEK (returns 1-7 Sunday is 1)<br/>DAY<br/>DAYOFYEAR (0-365)<br/>WEEK (week of year 0-53, week begins on Sunday)<br/>WEEK(&lt;chosen weekday&gt;) (week of year begins on your chosen day e.g. SUNDAY)<br/>ISOWEEK (ISO 8601 week number, week begins on Monday)<br/>MONTH<br/>QUARTER (1-4)<br/>YEAR (ISO 8601 year number) </span></pre><h2 id="01cb" class="mx mg iu bd mh my mz dn ml na nb dp mp lj nc nd mr ln ne nf mt lr ng nh mv ni bi translated">提取日期部分</h2><pre class="kk kl km kn gu no np nq nr aw ns bi"><span id="2637" class="mx mg iu np b gz nt nu l nv nw">EXTRACT(part FROM date_expression)</span><span id="58aa" class="mx mg iu np b gz nx nu l nv nw">Example: EXTRACT(YEAR FROM 2019-04-01)</span><span id="189f" class="mx mg iu np b gz nx nu l nv nw">Output: 2019</span></pre><h2 id="f659" class="mx mg iu bd mh my mz dn ml na nb dp mp lj nc nd mr ln ne nf mt lr ng nh mv ni bi translated">从整数构造一个日期</h2><pre class="kk kl km kn gu no np nq nr aw ns bi"><span id="709e" class="mx mg iu np b gz nt nu l nv nw">DATE(year, month, day)</span><span id="0dd2" class="mx mg iu np b gz nx nu l nv nw">Example: DATE(2019, 04, 01)</span><span id="5c9c" class="mx mg iu np b gz nx nu l nv nw">Output: 2019-04-01</span></pre><h2 id="5fdf" class="mx mg iu bd mh my mz dn ml na nb dp mp lj nc nd mr ln ne nf mt lr ng nh mv ni bi translated">从日期中加减</h2><pre class="kk kl km kn gu no np nq nr aw ns bi"><span id="92ac" class="mx mg iu np b gz nt nu l nv nw">DATE_ADD(date_expression, INTERVAL INT64_expr date_part)</span><span id="5ea4" class="mx mg iu np b gz nx nu l nv nw">Example: DATE_ADD('2019-04-01', INTERVAL 1 DAY)</span><span id="1e46" class="mx mg iu np b gz nx nu l nv nw">Output: 2019-04-02</span><span id="80da" class="mx mg iu np b gz nx nu l nv nw">DATE_SUB(date_expression, INTERVAL INT64_expr date_part)</span><span id="9d53" class="mx mg iu np b gz nx nu l nv nw">Example: DATE_SUB('2019-04-01', INTERVAL 1 DAY)</span><span id="7f1f" class="mx mg iu np b gz nx nu l nv nw">Output: 2019-03-31</span><span id="d679" class="mx mg iu np b gz nx nu l nv nw">Example use case - dynamic dates:</span><span id="e75f" class="mx mg iu np b gz nx nu l nv nw">where my_date between DATE_SUB(current_date, INTERVAL 7 DAY) and DATE_SUB(current_date, INTERVAL 1 DAY)</span></pre><h2 id="bf02" class="mx mg iu bd mh my mz dn ml na nb dp mp lj nc nd mr ln ne nf mt lr ng nh mv ni bi translated">两个日期之间的差异</h2><pre class="kk kl km kn gu no np nq nr aw ns bi"><span id="704a" class="mx mg iu np b gz nt nu l nv nw">DATE_DIFF(date_expression, date_expression, date_part)</span><span id="3061" class="mx mg iu np b gz nx nu l nv nw">Example: DATE_DIFF(2019-02-02, 2019-02-01, DAY)</span><span id="538d" class="mx mg iu np b gz nx nu l nv nw">Output: 1</span></pre><h2 id="9509" class="mx mg iu bd mh my mz dn ml na nb dp mp lj nc nd mr ln ne nf mt lr ng nh mv ni bi translated">指定日期的粒度</h2><pre class="kk kl km kn gu no np nq nr aw ns bi"><span id="ebb6" class="mx mg iu np b gz nt nu l nv nw">DATE_TRUNC(date_expression, date_part)</span><span id="0f90" class="mx mg iu np b gz nx nu l nv nw">Example: DATE_TRUNC(2019-04-12, WEEK)</span><span id="c9ec" class="mx mg iu np b gz nx nu l nv nw">Output: 2019-04-07</span></pre><h1 id="394c" class="mf mg iu bd mh mi mj mk ml mm mn mo mp ka mq kb mr kd ms ke mt kg mu kh mv mw bi translated">英国泰晤士报(1785 年创刊)</h1><h2 id="fb32" class="mx mg iu bd mh my mz dn ml na nb dp mp lj nc nd mr ln ne nf mt lr ng nh mv ni bi translated">时间部分</h2><pre class="kk kl km kn gu no np nq nr aw ns bi"><span id="6436" class="mx mg iu np b gz nt nu l nv nw">MICROSECOND<br/>MILLISECOND<br/>SECOND<br/>MINUTE<br/>HOUR</span></pre><h2 id="7c8f" class="mx mg iu bd mh my mz dn ml na nb dp mp lj nc nd mr ln ne nf mt lr ng nh mv ni bi translated">从整数构造一个日期时间对象</h2><pre class="kk kl km kn gu no np nq nr aw ns bi"><span id="06c7" class="mx mg iu np b gz nt nu l nv nw">DATETIME(year, month, day, hour, minute, second)<br/>DATETIME(date_expression, time_expression)<br/>DATETIME(timestamp_expression [, timezone])</span><span id="4694" class="mx mg iu np b gz nx nu l nv nw">Example: DATETIME(2019, 04, 01, 11, 55, 00)</span><span id="07f6" class="mx mg iu np b gz nx nu l nv nw">Output: 2019-04-01 11:55:00</span></pre><h2 id="c13b" class="mx mg iu bd mh my mz dn ml na nb dp mp lj nc nd mr ln ne nf mt lr ng nh mv ni bi translated">加减时间</h2><pre class="kk kl km kn gu no np nq nr aw ns bi"><span id="0d49" class="mx mg iu np b gz nt nu l nv nw">DATETIME_ADD(datetime_expression, INTERVAL INT64_expr part)</span><span id="eafc" class="mx mg iu np b gz nx nu l nv nw">Example: DATETIME_ADD('2019-04-01 11:55:00', INTERVAL 1 MINUTE)</span><span id="69d7" class="mx mg iu np b gz nx nu l nv nw">Output: 2019-04-01 11:56:00</span><span id="c9e2" class="mx mg iu np b gz nx nu l nv nw">DATETIME_SUB(datetime_expression, INTERVAL INT64_expr part)</span><span id="8751" class="mx mg iu np b gz nx nu l nv nw">Example: DATETIME_SUB('2019-04-01 11:55:00', INTERVAL 1 MINUTE)</span><span id="1c92" class="mx mg iu np b gz nx nu l nv nw">Output: 2019-04-01 11:54:00</span></pre><h2 id="f47f" class="mx mg iu bd mh my mz dn ml na nb dp mp lj nc nd mr ln ne nf mt lr ng nh mv ni bi translated">两次之间的差异</h2><pre class="kk kl km kn gu no np nq nr aw ns bi"><span id="7ef2" class="mx mg iu np b gz nt nu l nv nw">DATETIME_DIFF(datetime_expression, datetime_expression, part)</span><span id="3671" class="mx mg iu np b gz nx nu l nv nw">Example: DATETIME_DIFF('2019-04-01 11:56:00', '2019-04-01 11:55:00', MINUTE)</span><span id="5f00" class="mx mg iu np b gz nx nu l nv nw">Output: 1</span></pre><h2 id="30fa" class="mx mg iu bd mh my mz dn ml na nb dp mp lj nc nd mr ln ne nf mt lr ng nh mv ni bi translated">指定时间的粒度</h2><pre class="kk kl km kn gu no np nq nr aw ns bi"><span id="9cac" class="mx mg iu np b gz nt nu l nv nw">DATETIME_TRUNC(datetime_expression, part)</span><span id="28c8" class="mx mg iu np b gz nx nu l nv nw">Example: DATETIME_TRUNC('2019-04-01 11:55:00', HOUR)</span><span id="a8e1" class="mx mg iu np b gz nx nu l nv nw">Output: 2019-04-01 11:00:00</span></pre><p id="2b5b" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">这绝不是 BigQuery 中日期和时间表达式的详尽指南。它只是作为我最常用的快速参考。如需更全面的指南，请参阅谷歌大查询<a class="ae kz" href="https://cloud.google.com/bigquery/docs/reference/standard-sql/datetime_functions#parse_datetime" rel="noopener ugc nofollow" target="_blank">文档</a>。</p></div></div>    
</body>
</html>