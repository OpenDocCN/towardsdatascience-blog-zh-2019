<html>
<head>
<title>The 5 Classification Evaluation metrics every Data Scientist must know</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">每个数据科学家都必须知道的 5 个分类评估指标</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/the-5-classification-evaluation-metrics-you-must-know-aa97784ff226?source=collection_archive---------0-----------------------#2019-09-17">https://towardsdatascience.com/the-5-classification-evaluation-metrics-you-must-know-aa97784ff226?source=collection_archive---------0-----------------------#2019-09-17</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/efe442e2523be70e95ebb2b3d5abe6e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*o6NzNc7Rryl_wv8F"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk">Photo by <a class="ae jg" href="https://unsplash.com/@kmitchhodge?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">K. Mitch Hodge</a> on <a class="ae jg" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><div class=""/><div class=""><h2 id="a9c8" class="pw-subtitle-paragraph kg ji jj bd b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dk translated">以及具体什么时候使用它们？</h2></div><p id="0b59" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la jk"> <em class="lu">我们要优化什么？大多数商家都没有回答这个简单的问题。</em></strong></p><p id="4a8a" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la jk"> <em class="lu">每一个业务问题都有一点不同，要有不同的优化。</em> </strong></p><p id="daf8" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们都创建了分类模型。很多时候，我们试图提高评估模型的准确性。<strong class="la jk"> <em class="lu">但是，我们真的想要准确性作为模型性能的度量标准吗？</em> </strong></p><p id="3a1a" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la jk"> <em class="lu">如果我们在预测将要撞击地球的小行星数量会怎么样。</em> </strong></p><p id="7898" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">一直说零就行了。你会有 99%的准确率。我的模型可能相当准确，但一点价值都没有。在这种情况下我们应该怎么做？</p><blockquote class="lv"><p id="65a3" class="lw lx jj bd ly lz ma mb mc md me lt dk translated"><em class="mf">设计数据科学项目比建模本身重要得多。</em></p></blockquote><p id="ded8" class="pw-post-body-paragraph ky kz jj la b lb mg kk ld le mh kn lg lh mi lj lk ll mj ln lo lp mk lr ls lt im bi translated"><strong class="la jk"> <em class="lu">这篇文章是关于各种评估指标以及如何和何时使用它们。</em>T24】</strong></p></div><div class="ab cl ml mm hx mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="im in io ip iq"><h1 id="8131" class="ms mt jj bd mu mv mw mx my mz na nb nc kp nd kq ne ks nf kt ng kv nh kw ni nj bi translated">1.准确度、精确度和召回率:</h1><figure class="nl nm nn no gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nk"><img src="../Images/7a9049c34c210778169bb302e7962ae8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*JpiWBlOFqYTPa8Ta.png"/></div></div></figure></div><div class="ab cl ml mm hx mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="im in io ip iq"><h2 id="b7f7" class="np mt jj bd mu nq nr dn my ns nt dp nc lh nu nv ne ll nw nx ng lp ny nz ni oa bi translated">A.准确(性)</h2><p id="cdf8" class="pw-post-body-paragraph ky kz jj la b lb ob kk ld le oc kn lg lh od lj lk ll oe ln lo lp of lr ls lt im bi translated">准确性是最重要的分类标准。这很容易理解。并且容易适用于二元以及多类分类问题。</p><p id="2f67" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><code class="fe og oh oi oj b">Accuracy = (TP+TN)/(TP+FP+FN+TN)</code></p><p id="3c56" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">准确性是真实结果在检查的案例总数中所占的比例。</p><h2 id="f1fa" class="np mt jj bd mu nq nr dn my ns nt dp nc lh nu nv ne ll nw nx ng lp ny nz ni oa bi translated"><strong class="ak"> <em class="mf">什么时候使用？</em> </strong></h2><p id="4aa9" class="pw-post-body-paragraph ky kz jj la b lb ob kk ld le oc kn lg lh od lj lk ll oe ln lo lp of lr ls lt im bi translated">准确度是对分类问题进行评估的有效选择，这些问题是平衡的，没有偏斜或没有类别不平衡。</p><h2 id="85da" class="np mt jj bd mu nq nr dn my ns nt dp nc lh nu nv ne ll nw nx ng lp ny nz ni oa bi translated"><strong class="ak"> <em class="mf">告诫</em> </strong></h2><p id="5ef6" class="pw-post-body-paragraph ky kz jj la b lb ob kk ld le oc kn lg lh od lj lk ll oe ln lo lp of lr ls lt im bi translated">假设我们的目标类非常稀疏。我们需要准确性作为模型性能的度量吗？<strong class="la jk"> <em class="lu">如果我们在预测小行星会不会撞上地球呢？</em> </strong>一直只说<code class="fe og oh oi oj b">No</code>。你会有 99%的准确率。我的模型可能相当准确，但一点价值都没有。</p></div><div class="ab cl ml mm hx mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="im in io ip iq"><h2 id="a904" class="np mt jj bd mu nq nr dn my ns nt dp nc lh nu nv ne ll nw nx ng lp ny nz ni oa bi translated">B.精确</h2><p id="eb75" class="pw-post-body-paragraph ky kz jj la b lb ob kk ld le oc kn lg lh od lj lk ll oe ln lo lp of lr ls lt im bi translated">先说<em class="lu">精度</em>，它回答了下面这个问题:<strong class="la jk">预测阳性</strong>真正阳性的比例是多少？</p><p id="7438" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><code class="fe og oh oi oj b">Precision = (TP)/(TP+FP)</code></p><p id="b70c" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在小行星预测问题中，我们从来没有预测到一个真正的肯定。</p><p id="171e" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">因此精度=0</p><h2 id="14bf" class="np mt jj bd mu nq nr dn my ns nt dp nc lh nu nv ne ll nw nx ng lp ny nz ni oa bi translated"><strong class="ak"> <em class="mf">什么时候使用？</em>T44】</strong></h2><p id="691c" class="pw-post-body-paragraph ky kz jj la b lb ob kk ld le oc kn lg lh od lj lk ll oe ln lo lp of lr ls lt im bi translated">当我们想要非常确定我们的预测时，精度是评估度量的有效选择。例如:如果我们正在构建一个系统来预测我们是否应该降低特定帐户的信用限额，我们希望对我们的预测非常确定，否则它可能会导致客户不满。</p><h2 id="f037" class="np mt jj bd mu nq nr dn my ns nt dp nc lh nu nv ne ll nw nx ng lp ny nz ni oa bi translated"><strong class="ak"> <em class="mf">注意事项</em> </strong></h2><p id="689c" class="pw-post-body-paragraph ky kz jj la b lb ob kk ld le oc kn lg lh od lj lk ll oe ln lo lp of lr ls lt im bi translated">非常精确意味着我们的模型会让许多信用违约者毫发无损，从而蒙受损失。</p></div><div class="ab cl ml mm hx mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="im in io ip iq"><h2 id="562f" class="np mt jj bd mu nq nr dn my ns nt dp nc lh nu nv ne ll nw nx ng lp ny nz ni oa bi translated">C.回忆</h2><p id="c004" class="pw-post-body-paragraph ky kz jj la b lb ob kk ld le oc kn lg lh od lj lk ll oe ln lo lp of lr ls lt im bi translated">另一个非常有用的方法是<em class="lu">召回</em>，它回答了一个不同的问题:有多少比例的<strong class="la jk">实际阳性</strong>被正确分类？</p><p id="b247" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><code class="fe og oh oi oj b">Recall = (TP)/(TP+FN)</code></p><p id="72b6" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在小行星预测问题中，我们从来没有预测到一个真正的肯定。</p><p id="a7ee" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">因此召回也等于 0。</p><h2 id="6e93" class="np mt jj bd mu nq nr dn my ns nt dp nc lh nu nv ne ll nw nx ng lp ny nz ni oa bi translated"><strong class="ak"> <em class="mf">什么时候使用？</em> </strong></h2><p id="9133" class="pw-post-body-paragraph ky kz jj la b lb ob kk ld le oc kn lg lh od lj lk ll oe ln lo lp of lr ls lt im bi translated">当我们想要捕捉尽可能多的正面信息时，召回是评估指标的有效选择。例如:如果我们正在建立一个系统来预测一个人是否患有癌症，即使我们不是很确定，我们也希望捕捉到疾病。</p><h2 id="5ec1" class="np mt jj bd mu nq nr dn my ns nt dp nc lh nu nv ne ll nw nx ng lp ny nz ni oa bi translated"><strong class="ak"> <em class="mf">注意事项</em> </strong></h2><p id="254a" class="pw-post-body-paragraph ky kz jj la b lb ob kk ld le oc kn lg lh od lj lk ll oe ln lo lp of lr ls lt im bi translated"><strong class="la jk"> <em class="lu">如果我们对所有的例子都预测 1，那么召回就是 1。</em> </strong></p><p id="2d1c" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">由此产生了利用精确度与召回率的折衷的想法— <strong class="la jk"> <em class="lu"> F1 分数</em> </strong>。</p></div><div class="ab cl ml mm hx mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="im in io ip iq"><h1 id="c8eb" class="ms mt jj bd mu mv mw mx my mz na nb nc kp nd kq ne ks nf kt ng kv nh kw ni nj bi translated">2.F1 分数:</h1><p id="c4f0" class="pw-post-body-paragraph ky kz jj la b lb ob kk ld le oc kn lg lh od lj lk ll oe ln lo lp of lr ls lt im bi translated">这是我最喜欢的<strong class="la jk"> <em class="lu">评估指标</em> </strong>，我倾向于在我的分类项目中大量使用它。</p><p id="a102" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">F1 分数是一个介于 0 和 1 之间的数字，是精确度和召回率的调和平均值。</p><figure class="nl nm nn no gt iv gh gi paragraph-image"><div class="gh gi ok"><img src="../Images/8752931b4a915e44958d068b8378912f.png" data-original-src="https://miro.medium.com/v2/resize:fit:752/format:webp/0*-lZUM_HsT3RsgePy.png"/></div></figure><p id="b8fc" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们从一个二元预测问题开始。我们正在预测一颗小行星是否会撞击地球。 </p><p id="e85b" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">所以如果我们对整个训练集说“不”。我们这里的精度是 0。我们正课的回忆是什么？它是零。准确度如何？是 99%以上。</p><p id="b147" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">因此 F1 分数也是 0。因此我们知道，准确率为 99%的分类器对我们的情况来说基本上是没有价值的。因此它解决了我们的问题。</p><h2 id="4782" class="np mt jj bd mu nq nr dn my ns nt dp nc lh nu nv ne ll nw nx ng lp ny nz ni oa bi translated"><strong class="ak"> <em class="mf">什么时候使用？</em> </strong></h2><p id="d50f" class="pw-post-body-paragraph ky kz jj la b lb ob kk ld le oc kn lg lh od lj lk ll oe ln lo lp of lr ls lt im bi translated">我们希望有一个同时具有良好精度和召回率的模型。</p><figure class="nl nm nn no gt iv gh gi paragraph-image"><div class="gh gi ol"><img src="../Images/b5899e4f8e2d6a20986f1f39cbb2b5e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:524/format:webp/0*a0auEep7g3fpNrD3.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk">Precision-Recall Tradeoff</figcaption></figure><p id="da34" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">简单来说，<strong class="la jk"> <em class="lu"> F1 分数在分类器</em> </strong>的精确度和召回率之间保持了平衡。如果你的准确率低，F1 就低，如果召回率又低，你的 F1 分数就低。</p><blockquote class="lv"><p id="b6be" class="lw lx jj bd ly lz ma mb mc md me lt dk translated">如果你是一名警督，你想抓罪犯，你想确定你抓的人是罪犯(精确)，你也想尽可能多地抓到罪犯(回忆)。F1 分数管理这种权衡。</p></blockquote><h2 id="fb45" class="np mt jj bd mu nq om dn my ns on dp nc lh oo nv ne ll op nx ng lp oq nz ni oa bi translated">怎么用？</h2><p id="06bc" class="pw-post-body-paragraph ky kz jj la b lb ob kk ld le oc kn lg lh od lj lk ll oe ln lo lp of lr ls lt im bi translated">您可以使用以下公式计算二元预测问题的 F1 分数:</p><pre class="nl nm nn no gt or oj os ot aw ou bi"><span id="363b" class="np mt jj oj b gy ov ow l ox oy"><strong class="oj jk">from</strong> <strong class="oj jk">sklearn.metrics</strong> <strong class="oj jk">import</strong> f1_score<br/>y_true = [0, 1, 1, 0, 1, 1]<br/>y_pred = [0, 0, 1, 0, 0, 1]</span><span id="672c" class="np mt jj oj b gy oz ow l ox oy"><strong class="oj jk"><em class="lu">f1_score(y_true, y_pred)  </em></strong></span></pre><p id="3791" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这是我的一个函数，我用它来获得最佳阈值，使二元预测的 F1 值最大化。below 函数遍历可能的阈值，以找到给出最佳 F1 分数的阈值。</p><pre class="nl nm nn no gt or oj os ot aw ou bi"><span id="f040" class="np mt jj oj b gy ov ow l ox oy"># y_pred is an array of predictions<br/>def bestThresshold(y_true,y_pred):<br/>    best_thresh = None<br/>    best_score = 0<br/>    for thresh <strong class="oj jk">in</strong> np.arange(0.1, 0.501, 0.01):<br/>        score = f1_score(y_true, np.array(y_pred)&gt;thresh)<br/>        if score &gt; best_score:<br/>            best_thresh = thresh<br/>            best_score = score<br/>    return best_score , best_thresh</span></pre><h2 id="5ffb" class="np mt jj bd mu nq nr dn my ns nt dp nc lh nu nv ne ll nw nx ng lp ny nz ni oa bi translated">警告</h2><p id="6fcc" class="pw-post-body-paragraph ky kz jj la b lb ob kk ld le oc kn lg lh od lj lk ll oe ln lo lp of lr ls lt im bi translated">F1 分数的主要问题在于它对精确度和召回率给予了同等的重视。我们有时可能需要在我们的评估中包括领域知识，我们希望有更多的回忆或更精确。</p><p id="f8b8" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">为了解决这个问题，我们可以通过创建一个加权 F1 指标来实现，如下所示，其中 beta 管理精确度和召回率之间的权衡。</p><figure class="nl nm nn no gt iv gh gi paragraph-image"><div class="gh gi pa"><img src="../Images/336c1fa4e8e0cb830cb8b9141c91ba96.png" data-original-src="https://miro.medium.com/v2/resize:fit:744/0*Z4hC6C2XOV192LgE"/></div></figure><p id="4d77" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这里我们给β倍于精度的重要性来回忆。</p><pre class="nl nm nn no gt or oj os ot aw ou bi"><span id="44c8" class="np mt jj oj b gy ov ow l ox oy"><strong class="oj jk">from</strong> <strong class="oj jk">sklearn.metrics</strong> <strong class="oj jk">import</strong> fbeta_score</span><span id="0961" class="np mt jj oj b gy oz ow l ox oy">y_true = [0, 1, 1, 0, 1, 1]<br/>y_pred = [0, 0, 1, 0, 0, 1]</span><span id="730e" class="np mt jj oj b gy oz ow l ox oy">fbeta_score<strong class="oj jk"><em class="lu">(y_true, y_pred,beta=0.5)</em></strong></span></pre><p id="dc04" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">F1 分数也可以用于多类问题。详情见<a class="ae jg" rel="noopener" target="_blank" href="/multi-class-metrics-made-simple-part-ii-the-f1-score-ebe8b2c2ca1">Boaz shmu Eli</a>的这篇精彩博文。</p></div><div class="ab cl ml mm hx mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="im in io ip iq"><h1 id="815b" class="ms mt jj bd mu mv mw mx my mz na nb nc kp nd kq ne ks nf kt ng kv nh kw ni nj bi translated">3.对数损失/二元交叉熵</h1><p id="b75a" class="pw-post-body-paragraph ky kz jj la b lb ob kk ld le oc kn lg lh od lj lk ll oe ln lo lp of lr ls lt im bi translated">对数损失对于二元分类器来说是一个非常好的评估度量，并且在逻辑回归和神经网络的情况下，它有时也是优化目标。</p><p id="dddf" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">一个例子的二进制对数损失由下面的公式给出，其中 p 是预测 1 的概率。</p><figure class="nl nm nn no gt iv gh gi paragraph-image"><div class="gh gi pd"><img src="../Images/1fd813e62d3278974044ceb839e5268e.png" data-original-src="https://miro.medium.com/v2/resize:fit:526/format:webp/0*St5mouLhYgupz5Oo.png"/></div></figure><figure class="nl nm nn no gt iv gh gi paragraph-image"><div class="gh gi pe"><img src="../Images/58efdbda97289acb681d6fc028465988.png" data-original-src="https://miro.medium.com/v2/resize:fit:1112/format:webp/0*8oDE1l2eWLw81clR.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk">As you can see the log loss decreases as we are fairly certain in our prediction of 1 and the true label is 1.</figcaption></figure><h2 id="efc6" class="np mt jj bd mu nq nr dn my ns nt dp nc lh nu nv ne ll nw nx ng lp ny nz ni oa bi translated">什么时候用？</h2><p id="5e21" class="pw-post-body-paragraph ky kz jj la b lb ob kk ld le oc kn lg lh od lj lk ll oe ln lo lp of lr ls lt im bi translated"><em class="lu">当分类器的输出是预测概率时。</em> <strong class="la jk"> <em class="lu"> Log Loss 根据其与实际标签的差异程度，将您预测的不确定性考虑在内。</em> </strong>这让我们对模型的性能有了更细致的了解。一般来说，最小化日志损失为分类器提供了更高的准确性。</p><h2 id="a9f7" class="np mt jj bd mu nq nr dn my ns nt dp nc lh nu nv ne ll nw nx ng lp ny nz ni oa bi translated">怎么用？</h2><pre class="nl nm nn no gt or oj os ot aw ou bi"><span id="8d4f" class="np mt jj oj b gy ov ow l ox oy"><strong class="oj jk">from</strong> <strong class="oj jk">sklearn.metrics</strong> <strong class="oj jk">import</strong> log_loss  </span><span id="edcb" class="np mt jj oj b gy oz ow l ox oy"># where y_pred are probabilities and y_true are binary class labels<br/>log_loss(y_true, y_pred, eps=1e-15)</span></pre><h2 id="b849" class="np mt jj bd mu nq nr dn my ns nt dp nc lh nu nv ne ll nw nx ng lp ny nz ni oa bi translated">警告</h2><p id="840d" class="pw-post-body-paragraph ky kz jj la b lb ob kk ld le oc kn lg lh od lj lk ll oe ln lo lp of lr ls lt im bi translated">在<a class="ae jg" rel="noopener" target="_blank" href="/the-5-sampling-algorithms-every-data-scientist-need-to-know-43c7bc11d17c">不平衡</a>数据集的情况下易受影响。您可能需要引入类权重来更多地惩罚少数错误，或者您可以在平衡数据集后使用它。</p></div><div class="ab cl ml mm hx mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="im in io ip iq"><h1 id="3363" class="ms mt jj bd mu mv mw mx my mz na nb nc kp nd kq ne ks nf kt ng kv nh kw ni nj bi translated">4.范畴交叉熵</h1><p id="b364" class="pw-post-body-paragraph ky kz jj la b lb ob kk ld le oc kn lg lh od lj lk ll oe ln lo lp of lr ls lt im bi translated">日志丢失也适用于多类问题。多类设置中的分类器必须为所有示例的每个类分配一个概率。如果有 N 个样本属于 M 个类别，那么<em class="lu">分类交叉熵</em>是- <code class="fe og oh oi oj b">ylogp</code>值的总和:</p><figure class="nl nm nn no gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi pf"><img src="../Images/ffe36ed873e4db02cd22ac2f0dd86b42.png" data-original-src="https://miro.medium.com/v2/resize:fit:688/0*zneWdU4GN_WBzTIF.gif"/></div></div></figure><p id="4303" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果样本<code class="fe og oh oi oj b">i</code>属于类别<code class="fe og oh oi oj b">j</code>则<code class="fe og oh oi oj b">y_ij</code>为 1，否则为 0</p><p id="59bc" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><code class="fe og oh oi oj b">p_ij</code>是我们的分类器预测样本<code class="fe og oh oi oj b">i</code>属于类别<code class="fe og oh oi oj b">j</code>的概率。</p><h2 id="3a2e" class="np mt jj bd mu nq nr dn my ns nt dp nc lh nu nv ne ll nw nx ng lp ny nz ni oa bi translated">什么时候用？</h2><p id="bba2" class="pw-post-body-paragraph ky kz jj la b lb ob kk ld le oc kn lg lh od lj lk ll oe ln lo lp of lr ls lt im bi translated"><em class="lu">当一个分类器的输出是多类预测概率时。在神经网络的情况下，我们通常使用分类交叉熵。</em>一般来说，最小化分类交叉熵为分类器提供了更高的准确性。</p><h2 id="9c7e" class="np mt jj bd mu nq nr dn my ns nt dp nc lh nu nv ne ll nw nx ng lp ny nz ni oa bi translated">怎么用？</h2><pre class="nl nm nn no gt or oj os ot aw ou bi"><span id="1551" class="np mt jj oj b gy ov ow l ox oy"><strong class="oj jk">from</strong> <strong class="oj jk">sklearn.metrics</strong> <strong class="oj jk">import</strong> log_loss  </span><span id="ffeb" class="np mt jj oj b gy oz ow l ox oy"># Where y_pred is a matrix of probabilities with shape <strong class="oj jk"><em class="lu">= (n_samples, n_classes)</em></strong> and y_true is an array of class labels</span><span id="fa8d" class="np mt jj oj b gy oz ow l ox oy">log_loss(y_true, y_pred, eps=1e-15)</span></pre><h2 id="1009" class="np mt jj bd mu nq nr dn my ns nt dp nc lh nu nv ne ll nw nx ng lp ny nz ni oa bi translated">警告:</h2><p id="34f6" class="pw-post-body-paragraph ky kz jj la b lb ob kk ld le oc kn lg lh od lj lk ll oe ln lo lp of lr ls lt im bi translated">在<a class="ae jg" rel="noopener" target="_blank" href="/the-5-sampling-algorithms-every-data-scientist-need-to-know-43c7bc11d17c">不平衡</a>数据集的情况下易受影响。</p></div><div class="ab cl ml mm hx mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="im in io ip iq"><h1 id="48a3" class="ms mt jj bd mu mv mw mx my mz na nb nc kp nd kq ne ks nf kt ng kv nh kw ni nj bi translated">5.罗马纪元</h1><p id="e522" class="pw-post-body-paragraph ky kz jj la b lb ob kk ld le oc kn lg lh od lj lk ll oe ln lo lp of lr ls lt im bi translated">AUC 是 ROC 曲线下的面积。</p><p id="239e" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la jk"> <em class="lu"> AUC ROC 表示阳性类别的概率与阴性类别的概率的分离程度</em> </strong></p><p id="8deb" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la jk"> <em class="lu">什么是 ROC 曲线？</em> </strong></p><figure class="nl nm nn no gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nk"><img src="../Images/7a9049c34c210778169bb302e7962ae8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*JpiWBlOFqYTPa8Ta.png"/></div></div></figure><p id="e9b2" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们已经从分类器中得到概率。我们可以使用不同的阈值来绘制曲线上的灵敏度(TPR)和(1-特异性)(FPR ),我们将得到一条 ROC 曲线。</p><p id="faa3" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">其中真正的肯定率或 TPR 只是我们使用我们的算法捕获的真实的比例。</p><p id="33d1" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><code class="fe og oh oi oj b">Sensitivty = TPR(True Positive Rate)= Recall = TP/(TP+FN)</code></p><p id="addd" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">假阳性率或 FPR 就是我们用算法捕捉到的假阳性的比例。</p><p id="e5d1" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><code class="fe og oh oi oj b">1- Specificity = FPR(False Positive Rate)= FP/(TN+FP)</code></p><figure class="nl nm nn no gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi pg"><img src="../Images/f460f5274eccb93084cb201e694d0653.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Dkq9YLJM5t8k0Fcb"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk">ROC Curve</figcaption></figure><p id="140f" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这里我们可以使用 ROC 曲线来决定阈值。<br/>阈值的选择也将取决于分类器的用途。</p><p id="3043" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果这是一个癌症分类应用程序，你不希望你的阈值大到 0.5。即使一个病人患癌症的概率是 0.3，你也会把他归类为 1。</p><p id="9200" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">否则，在降低信用卡限额的应用程序中，您不希望您的阈值低至 0.5。您在这里有点担心降低限制对客户满意度的负面影响。</p><h2 id="0a3e" class="np mt jj bd mu nq nr dn my ns nt dp nc lh nu nv ne ll nw nx ng lp ny nz ni oa bi translated">什么时候用？</h2><p id="cb8c" class="pw-post-body-paragraph ky kz jj la b lb ob kk ld le oc kn lg lh od lj lk ll oe ln lo lp of lr ls lt im bi translated">AUC 是<strong class="la jk">比例不变的</strong>。它衡量预测的排名，而不是它们的绝对值。因此，举例来说，如果你作为一个营销人员想要找到一个用户列表，他们将响应营销活动。AUC 是一个很好的指标，因为按概率排列的预测是您创建用户列表以发送营销活动的顺序。</p><p id="a676" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">使用 AUC 的另一个好处是它像对数损失一样<strong class="la jk">分类阈值不变</strong>。它测量模型预测的质量，而不考虑选择什么分类阈值，不像 F1 分数或准确性取决于阈值的选择。</p><h2 id="f8a6" class="np mt jj bd mu nq nr dn my ns nt dp nc lh nu nv ne ll nw nx ng lp ny nz ni oa bi translated">怎么用？</h2><pre class="nl nm nn no gt or oj os ot aw ou bi"><span id="9e50" class="np mt jj oj b gy ov ow l ox oy">import numpy as np<br/>from sklearn.metrics import roc_auc_score<br/>y_true = np.array([0, 0, 1, 1])<br/>y_scores = np.array([0.1, 0.4, 0.35, 0.8])</span><span id="7f18" class="np mt jj oj b gy oz ow l ox oy"><strong class="oj jk"><em class="lu">print(roc_auc_score(y_true, y_scores))</em></strong></span></pre><h2 id="9e99" class="np mt jj bd mu nq nr dn my ns nt dp nc lh nu nv ne ll nw nx ng lp ny nz ni oa bi translated">警告</h2><p id="8811" class="pw-post-body-paragraph ky kz jj la b lb ob kk ld le oc kn lg lh od lj lk ll oe ln lo lp of lr ls lt im bi translated">有时，我们需要从模型中得到精确校准的概率输出，而 AUC 对此没有帮助。</p></div><div class="ab cl ml mm hx mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="im in io ip iq"><h1 id="e389" class="ms mt jj bd mu mv mw mx my mz na nb nc kp nd kq ne ks nf kt ng kv nh kw ni nj bi translated">结论</h1><p id="01cb" class="pw-post-body-paragraph ky kz jj la b lb ob kk ld le oc kn lg lh od lj lk ll oe ln lo lp of lr ls lt im bi translated">创建我们的<a class="ae jg" rel="noopener" target="_blank" href="/6-important-steps-to-build-a-machine-learning-system-d75e3b83686">机器学习管道</a>的一个重要步骤是相互评估我们不同的模型。评估指标的错误选择可能会对您的整个系统造成严重破坏。</p><p id="7be0" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">因此，要时刻注意你的预测，以及评估指标的选择会如何影响/改变你的最终预测。T12】</p><p id="63ad" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">此外，评估指标的选择应该与业务目标保持一致，因此有点主观。您也可以提出自己的评估标准。</p></div><div class="ab cl ml mm hx mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="im in io ip iq"><h1 id="af01" class="ms mt jj bd mu mv mw mx my mz na nb nc kp nd kq ne ks nf kt ng kv nh kw ni nj bi translated">继续学习</h1><p id="fe08" class="pw-post-body-paragraph ky kz jj la b lb ob kk ld le oc kn lg lh od lj lk ll oe ln lo lp of lr ls lt im bi translated">如果你想<a class="ae jg" rel="noopener" target="_blank" href="/how-did-i-start-with-data-science-3f4de6b501b0?source=---------8------------------">了解</a>更多关于如何构建机器学习项目和最佳实践，我想调出他在 Coursera <a class="ae jg" href="https://coursera.pxf.io/7mKnnY" rel="noopener ugc nofollow" target="_blank">深度学习</a>专业化中的第三门课程，名为构建机器学习项目。一定要去看看。它谈到了陷阱和许多改进模型的基本想法。</p><p id="da85" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">谢谢你的阅读。将来我也会写更多初学者友好的帖子。在<a class="ae jg" href="https://medium.com/@rahul_agarwal?source=post_page---------------------------" rel="noopener"> <strong class="la jk">中</strong> </a>关注我或者订阅我的<a class="ae jg" href="https://mlwhiz.ck.page/a9b8bda70c" rel="noopener ugc nofollow" target="_blank"> <strong class="la jk">博客</strong> </a>了解他们。一如既往，我欢迎反馈和建设性的批评，可以通过 Twitter <a class="ae jg" href="https://twitter.com/MLWhiz?source=post_page---------------------------" rel="noopener ugc nofollow" target="_blank"> @mlwhiz </a>联系到我</p><p id="464e" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">此外，一个小小的免责声明——在这篇文章中可能会有一些相关资源的附属链接，因为分享知识从来都不是一个坏主意。</p></div></div>    
</body>
</html>