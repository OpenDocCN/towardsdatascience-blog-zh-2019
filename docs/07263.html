<html>
<head>
<title>Data Preprocessing — Art or Science</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">数据预处理——艺术还是科学</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/data-preprocessing-art-or-science-7d13ae5663fa?source=collection_archive---------23-----------------------#2019-10-12">https://towardsdatascience.com/data-preprocessing-art-or-science-7d13ae5663fa?source=collection_archive---------23-----------------------#2019-10-12</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="85de" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">缺失值插补</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/e9edec517a678cd53e384e19a57f10ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3mOEGRyRXhX78nd30siz8w.jpeg"/></div></div></figure><h2 id="710d" class="kr ks iq bd kt ku kv dn kw kx ky dp kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">数据预处理(第 1 部分)</h2><p id="f078" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv la lw lx ly le lz ma mb li mc md me mf ij bi translated">大多数人都说任何分析模型的核心是模型构建，但我宁愿说它的数据预处理，而不是模型构建。一个人只能建立模型，一旦他/她处理了数据或干净的数据。所有可用的原始数据都是不完整的，在做任何进一步的分析之前需要清理，因为有一种说法是，如果输入是错误的，输出只会产生误导。</p><p id="ea34" class="pw-post-body-paragraph ln lo iq lp b lq mg jr ls lt mh ju lv la mi lx ly le mj ma mb li mk md me mf ij bi translated">数据预处理是在执行任何任务之前清理数据以使其更有意义的过程，因此，它成为任何分析任务(无论是描述性分析还是预测性分析)的重要组成部分。</p><p id="bd94" class="pw-post-body-paragraph ln lo iq lp b lq mg jr ls lt mh ju lv la mi lx ly le mj ma mb li mk md me mf ij bi translated"><strong class="lp ir">如何进行数据预处理:</strong></p><p id="907a" class="pw-post-body-paragraph ln lo iq lp b lq mg jr ls lt mh ju lv la mi lx ly le mj ma mb li mk md me mf ij bi translated">无用或多余的字段</p><p id="27b3" class="pw-post-body-paragraph ln lo iq lp b lq mg jr ls lt mh ju lv la mi lx ly le mj ma mb li mk md me mf ij bi translated">缺少值</p><p id="3c81" class="pw-post-body-paragraph ln lo iq lp b lq mg jr ls lt mh ju lv la mi lx ly le mj ma mb li mk md me mf ij bi translated">极端值</p><p id="bc75" class="pw-post-body-paragraph ln lo iq lp b lq mg jr ls lt mh ju lv la mi lx ly le mj ma mb li mk md me mf ij bi translated">数据转换</p><p id="5e44" class="pw-post-body-paragraph ln lo iq lp b lq mg jr ls lt mh ju lv la mi lx ly le mj ma mb li mk md me mf ij bi translated">让我们用示例数据信息来详细讨论这些。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ml"><img src="../Images/09bd6f40e10e563f4a03542019fb760e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7A1Mu89JRpofPQt7WC4cPQ.png"/></div></div><figcaption class="mm mn gj gh gi mo mp bd b be z dk">Sample data for Personal Laon user prediction</figcaption></figure><p id="db95" class="pw-post-body-paragraph ln lo iq lp b lq mg jr ls lt mh ju lv la mi lx ly le mj ma mb li mk md me mf ij bi translated">1) <strong class="lp ir">冗余字段:</strong>在开始任何种类的预处理或数据分析之前，必须非常仔细地观察数据。深入数据预处理之前要检查的事项:</p><p id="e963" class="pw-post-body-paragraph ln lo iq lp b lq mg jr ls lt mh ju lv la mi lx ly le mj ma mb li mk md me mf ij bi translated">a)如果发现重复记录，需要删除。</p><p id="b604" class="pw-post-body-paragraph ln lo iq lp b lq mg jr ls lt mh ju lv la mi lx ly le mj ma mb li mk md me mf ij bi translated">b)需要检查数据格式，有时你需要考虑几个变量到文本中，但那可能会变成数字。</p><p id="175c" class="pw-post-body-paragraph ln lo iq lp b lq mg jr ls lt mh ju lv la mi lx ly le mj ma mb li mk md me mf ij bi translated">c)寻找相关变量，如果发现高度相关或完全相关的变量，那么保留两个变量就变得多余，因此可以删除一个变量。堆图，相关矩阵用于检查这一点。</p><p id="202c" class="pw-post-body-paragraph ln lo iq lp b lq mg jr ls lt mh ju lv la mi lx ly le mj ma mb li mk md me mf ij bi translated">2) <strong class="lp ir">缺失值:</strong>数据集经常会有一些数据缺失的变量，我们不知道如何处理这些缺失值。一个简单的方法是删除这样的行或列。但是不知道这样做是否正确，因为数据集可能很小，删除这些值可能会丢失最重要的信息。</p><blockquote class="mq mr ms"><p id="4752" class="ln lo mt lp b lq mg jr ls lt mh ju lv mu mi lx ly mv mj ma mb mw mk md me mf ij bi translated">事实上，Gallit Shmueli、Nitin Patel 和 Peter Bruce 指出，如果 30 个变量的数据集中有 5%的数据值缺失，并且缺失值均匀分布在整个数据中，则几乎 80%的记录至少会有一个缺失值，因此通过简单地删除有缺失数据的行，我们会剩下 20%的数据，因此删除数据始终不是一个解决方案。</p></blockquote><p id="7828" class="pw-post-body-paragraph ln lo iq lp b lq mg jr ls lt mh ju lv la mi lx ly le mj ma mb li mk md me mf ij bi translated">现在的解决方案是用一些值替换缺失值，这叫做<strong class="lp ir">“缺失值插补”</strong>。以下是将 wrt 值输入数据类型的几种方法。</p><p id="f90c" class="pw-post-body-paragraph ln lo iq lp b lq mg jr ls lt mh ju lv la mi lx ly le mj ma mb li mk md me mf ij bi translated">2.1) <strong class="lp ir">用某个常数或零替换缺失值:</strong>一种处理缺失值的方法是用某个常数或零替换缺失值，但这样做，你创建了一个新的类或变量，你可以确定它是否存在，因此这不是估算缺失值的好方法。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mx"><img src="../Images/62b593c392a38f014918b64a35c70c56.png" data-original-src="https://miro.medium.com/v2/resize:fit:900/format:webp/1*PbMrsBKyzuL7xj8eF9V4XA.png"/></div><figcaption class="mm mn gj gh gi mo mp bd b be z dk">Replace missing value with some random value</figcaption></figure><p id="8844" class="pw-post-body-paragraph ln lo iq lp b lq mg jr ls lt mh ju lv la mi lx ly le mj ma mb li mk md me mf ij bi translated">因此，如果我们在婚姻状况中输入一些随机 1，那么它是一个单独的类别，没有任何解释，对于连续变量也是一样，它不会给出太多信息。</p><p id="d2af" class="pw-post-body-paragraph ln lo iq lp b lq mg jr ls lt mh ju lv la mi lx ly le mj ma mb li mk md me mf ij bi translated">2.2) <strong class="lp ir">当变量为连续变量时，替换缺失值:</strong>有多种方法可以对连续变量的数据进行插补。下面列出了其中的一些。</p><p id="3dfa" class="pw-post-body-paragraph ln lo iq lp b lq mg jr ls lt mh ju lv la mi lx ly le mj ma mb li mk md me mf ij bi translated">a) <strong class="lp ir"> <em class="mt">带均值/中值</em> </strong>:您可以通过相应变量的均值/中值估算您的缺失值。这种方法的优点是，它是一种更快的估算数据的方法，当您有小数据集时工作得相当好，但是建模完全是关于数据的可变性，数据点彼此之间有多远或多近，所以如果您用平均值或模式估算数据，它会失去数据的可变性，可能工作得不好。此外，它不能用于分类变量。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi my"><img src="../Images/1eeab44ada31e4887e59c25092ab8f69.png" data-original-src="https://miro.medium.com/v2/resize:fit:1288/format:webp/1*EbgWW9gg_LtXFPVtRDNF1A.png"/></div><figcaption class="mm mn gj gh gi mo mp bd b be z dk">Mean Imputation</figcaption></figure><p id="e1fb" class="pw-post-body-paragraph ln lo iq lp b lq mg jr ls lt mh ju lv la mi lx ly le mj ma mb li mk md me mf ij bi translated">同样，可以进行中位数插补。</p><p id="db2b" class="pw-post-body-paragraph ln lo iq lp b lq mg jr ls lt mh ju lv la mi lx ly le mj ma mb li mk md me mf ij bi translated">b) <strong class="lp ir"> <em class="mt">从分布</em> </strong>中随机选择值:另一种输入连续变量的方法是从该变量的观测分布中随机选择值。这种方法的好处是，与均值/中值替换法相比，中心和扩散的度量更接近原始值。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mz"><img src="../Images/b4b2eabdd385bb0ea7c8fb7f27f2f792.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3v8u4UF2ItBEXIy3c4wDcw.png"/></div></div><figcaption class="mm mn gj gh gi mo mp bd b be z dk">Replace missing value with the random value from distribution</figcaption></figure><p id="54e1" class="pw-post-body-paragraph ln lo iq lp b lq mg jr ls lt mh ju lv la mi lx ly le mj ma mb li mk md me mf ij bi translated">在这种情况下，如果您看到，根据随机值，第二次记录的房屋贷款金额的合格性为 8000，而客户没有抵押财产，因此该值没有意义，因此使用该方法时需要非常小心，因为这不会在插补时考虑其他变量。</p><p id="0b46" class="pw-post-body-paragraph ln lo iq lp b lq mg jr ls lt mh ju lv la mi lx ly le mj ma mb li mk md me mf ij bi translated">c) <strong class="lp ir"> <em class="mt">线性回归:</em> </strong>另一种估算连续数据的方法是通过线性回归。在这种情况下，您要进行插补的变量成为您的目标变量，而 rest 成为您的响应变量(我们在此过程中不考虑实际的目标变量，因为它会在以后的建模中产生偏差)。一旦我们创建了这样的数据，逐步过程就被用于开发线性回归，并且在回归参数被估计之后，缺失值的预测就实现了。</p><p id="890a" class="pw-post-body-paragraph ln lo iq lp b lq mg jr ls lt mh ju lv la mi lx ly le mj ma mb li mk md me mf ij bi translated">现在，如果您必须估计一个记录的两个/多个变量，那么我们将使用以下方法:</p><p id="0dc6" class="pw-post-body-paragraph ln lo iq lp b lq mg jr ls lt mh ju lv la mi lx ly le mj ma mb li mk md me mf ij bi translated">第一步:建立回归模型来估算第一个变量，不要将第二个变量作为预测变量。</p><p id="edad" class="pw-post-body-paragraph ln lo iq lp b lq mg jr ls lt mh ju lv la mi lx ly le mj ma mb li mk md me mf ij bi translated">第二步:构建一个回归模型来估算第二个变量，包括第一步中找到的第二个变量的值。</p><p id="29b8" class="pw-post-body-paragraph ln lo iq lp b lq mg jr ls lt mh ju lv la mi lx ly le mj ma mb li mk md me mf ij bi translated">2.3) <strong class="lp ir">当变量为分类变量时，替换缺失值:</strong>有多种方法可以估算连续变量的数据。下面列出了其中的一些。</p><p id="f2ac" class="pw-post-body-paragraph ln lo iq lp b lq mg jr ls lt mh ju lv la mi lx ly le mj ma mb li mk md me mf ij bi translated"><strong class="lp ir"> a) </strong> <strong class="lp ir"> <em class="mt">带模式:</em> </strong>分类变量可使用该变量内的模式(频率最高的值)进行估算。这是为分类变量估算值的最简单方法，但这一过程可能会在数据中产生偏差，因为您将在变量内所有缺失的空间中估算相同的值。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi na"><img src="../Images/435de97b83fe3937d507601f6101fc36.png" data-original-src="https://miro.medium.com/v2/resize:fit:822/format:webp/1*nGYAT7TwVjpUxjVAQu5gFg.png"/></div></figure><p id="a62a" class="pw-post-body-paragraph ln lo iq lp b lq mg jr ls lt mh ju lv la mi lx ly le mj ma mb li mk md me mf ij bi translated">在这个变量中，大部分缺失值变成了已婚值，如果大部分数据变成了两类中的一类，那么这个变量可能会提供更多的信息。</p><p id="8ed8" class="pw-post-body-paragraph ln lo iq lp b lq mg jr ls lt mh ju lv la mi lx ly le mj ma mb li mk md me mf ij bi translated"><strong class="lp ir"> b) </strong> <strong class="lp ir"> <em class="mt">使用决策树或逻辑回归:</em> </strong>为分类变量估算缺失数据的另一种方法是通过决策树。同样，在这种情况下，您要进行插补的变量成为您的目标变量，而 rest 成为您的预测变量(我们在此过程中不考虑实际的目标变量，因为它会在以后的建模中产生偏差)。一旦我们创建了这样的数据，您就可以运行<em class="mt"> CART </em>算法来寻找规则，并在此基础上对分类变量进行插补。</p><p id="1c26" class="pw-post-body-paragraph ln lo iq lp b lq mg jr ls lt mh ju lv la mi lx ly le mj ma mb li mk md me mf ij bi translated">比方说，在我们的案例中，我们想要估算婚姻状况，那么我们将考虑这样的数据，其中婚姻状况成为目标变量，其余的其他变量成为预测变量。此外，丢失的值行将从变量中删除。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nb"><img src="../Images/9ae4784dbb16feb28b82dff7d51d709b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vx7A2k4RA3I0ssOW5dCdQw.png"/></div></div><figcaption class="mm mn gj gh gi mo mp bd b be z dk">New data for Decision tree imputation</figcaption></figure><p id="7418" class="pw-post-body-paragraph ln lo iq lp b lq mg jr ls lt mh ju lv la mi lx ly le mj ma mb li mk md me mf ij bi translated">因此，决策树将为您提供规则，如年龄&gt; 35 岁，工作=管理，信用违约=否，那么 96%的数据是已婚的，4%是单身的。因此，缺失的值可以通过查看其他变量的信息来替换，准确率为 96%。</p><p id="829c" class="pw-post-body-paragraph ln lo iq lp b lq mg jr ls lt mh ju lv la mi lx ly le mj ma mb li mk md me mf ij bi translated"><strong class="lp ir"> c) </strong> <strong class="lp ir"> <em class="mt">用 K 近邻替换缺失值(KNN): </em> </strong> KNN 是最常用的估算缺失值的方法之一。它既可以用于连续变量，也可以用于分类变量。KNN 算法对相似性度量起作用，例如<em class="mt">欧几里德距离、余弦距离、汉明距离、</em>等。KKN 的基本方法是试图在所有的观察值中找出最近邻来进行距离度量的插补。具有最低距离值的观察值被认为是邻居，然后取 K 个邻居的平均值来估算缺失值，以使其更加精确。k 可以取任何值作为前 3 个邻居、5 个邻居等等。</p><p id="5f34" class="pw-post-body-paragraph ln lo iq lp b lq mg jr ls lt mh ju lv la mi lx ly le mj ma mb li mk md me mf ij bi translated">在下面的例子中，我们有 4 个客户 id 和 3 个变量(这里，为了便于解释，我考虑了一个唯一的连续变量，以便使用欧几里德距离来寻找距离，否则也可以使用分类变量。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nc"><img src="../Images/ffe880836eb2283bf899e54be39f49b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4BBNvovdzb0GsTDimufspQ.png"/></div></div><figcaption class="mm mn gj gh gi mo mp bd b be z dk">Sample data for Decision Tree imputation</figcaption></figure><p id="d286" class="pw-post-body-paragraph ln lo iq lp b lq mg jr ls lt mh ju lv la mi lx ly le mj ma mb li mk md me mf ij bi translated">因此，已经计算了三个客户中的每一个客户到 C1 的距离，对于距离计算来说，缺失数据的变量将被丢弃，而剩余的变量将被取出，该距离将从每个邻居开始计算。我们可以看到，客户 4 与客户 1 的距离最短，因此客户 4 和客户 1 被视为彼此最近的邻居，因此可以估算值。此外，我们可以取 5 个最近的邻居，而不是取一个最近的邻居，并且可以估算平均值。</p><p id="4c43" class="pw-post-body-paragraph ln lo iq lp b lq mg jr ls lt mh ju lv la mi lx ly le mj ma mb li mk md me mf ij bi translated">现在，有两种策略来识别谁将充当观察的邻居，然后执行最近邻居计算:一种是完全案例策略，另一种是不完全案例策略。</p><ol class=""><li id="eb66" class="nd ne iq lp b lq mg lt mh la nf le ng li nh mf ni nj nk nl bi translated"><em class="mt">完整案例策略:</em>案例可以充当邻居当且仅当它包含所有属性。在我们的案例中，完全案例战略将把 C1 视为邻国。</li><li id="95a9" class="nd ne iq lp b lq nm lt nn la no le np li nq mf ni nj nk nl bi translated"><em class="mt">不完整事例策略:</em>当且仅当事例包含要估算的事例具有值的所有属性的值以及要估算的属性的值时，事例才能充当邻居。就我们而言，C1、C2 和 C4 可以成为邻居。</li></ol><p id="8d8d" class="pw-post-body-paragraph ln lo iq lp b lq mg jr ls lt mh ju lv la mi lx ly le mj ma mb li mk md me mf ij bi translated">但是必须意识到，当数据太大时，这个过程是非常耗时的。</p><p id="4abf" class="pw-post-body-paragraph ln lo iq lp b lq mg jr ls lt mh ju lv la mi lx ly le mj ma mb li mk md me mf ij bi translated">因此，缺失值可以通过多种技术和方法进行插补，插补方法没有对错之分，只是哪种方法最适合您的数据集，并能给出最准确的结果。没有办法替换丢失空间中的精确数据，但是可以尝试替换多少相近的值。</p><p id="83f8" class="pw-post-body-paragraph ln lo iq lp b lq mg jr ls lt mh ju lv la mi lx ly le mj ma mb li mk md me mf ij bi translated">以上是关于数据预处理的第 1 部分，我已经谈到了数据冗余和缺失值插补，在数据预处理的第 2 部分，我将讨论异常值和数据转换。</p></div></div>    
</body>
</html>