<html>
<head>
<title>Nucleus Segmentation using U-Net</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">基于 U-网的细胞核分割</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/nucleus-segmentation-using-u-net-eceb14a9ced4?source=collection_archive---------6-----------------------#2019-06-19">https://towardsdatascience.com/nucleus-segmentation-using-u-net-eceb14a9ced4?source=collection_archive---------6-----------------------#2019-06-19</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="8708" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">深度学习如何用于分割医学图像？</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/891749648751b4217a5d5cad404d65a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bWCWgKScOf0blEfZxlcg-g.png"/></div></div></figure><p id="6c36" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">被困在付费墙后面？点击<a class="ae ln" href="https://medium.com/p/nucleus-segmentation-using-u-net-eceb14a9ced4?source=email-c3f5233f3441--writer.postDistributed&amp;sk=881ef594402fb347d56e1c12f077732d" rel="noopener">这里</a>阅读完整故事与我的朋友链接！</p><p id="ceb0" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">显微图像的自动分割是医学图像处理和分析中的一项重要任务。细胞核检测是这项任务的一个重要例子。想象一下加快对几乎所有疾病的研究，从肺癌和心脏病到罕见疾病。2018 年<a class="ae ln" href="https://www.kaggle.com/c/data-science-bowl-2018" rel="noopener ugc nofollow" target="_blank"> <strong class="kt ir">数据科学碗</strong> </a>提供了我们迄今为止最雄心勃勃的任务:创建一种算法来自动检测细胞核。我们都见过人们遭受癌症、心脏病、慢性阻塞性肺病、老年痴呆症和糖尿病等疾病的折磨。想想看，如果治疗来得更快，会有多少人的生活发生改变。通过自动化细胞核检测，您可以帮助更快地找到从罕见疾病到普通感冒的治疗方法。</p><p id="cbec" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这个项目是在 Kaggle 上举行的 2018 年数据科学碗的一部分。</p></div><div class="ab cl lo lp hu lq" role="separator"><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt"/></div><div class="ij ik il im in"><h1 id="f0fd" class="lv lw iq bd lx ly lz ma mb mc md me mf jw mg jx mh jz mi ka mj kc mk kd ml mm bi translated">环境和工具</h1><ol class=""><li id="0c76" class="mn mo iq kt b ku mp kx mq la mr le ms li mt lm mu mv mw mx bi translated">sci kit-学习</li><li id="4db7" class="mn mo iq kt b ku my kx mz la na le nb li nc lm mu mv mw mx bi translated">sci kit-图像</li><li id="fd05" class="mn mo iq kt b ku my kx mz la na le nb li nc lm mu mv mw mx bi translated">numpy</li><li id="ba8c" class="mn mo iq kt b ku my kx mz la na le nb li nc lm mu mv mw mx bi translated">克拉斯</li><li id="f1fe" class="mn mo iq kt b ku my kx mz la na le nb li nc lm mu mv mw mx bi translated">熊猫</li><li id="2c71" class="mn mo iq kt b ku my kx mz la na le nb li nc lm mu mv mw mx bi translated">matplotlib</li><li id="0f75" class="mn mo iq kt b ku my kx mz la na le nb li nc lm mu mv mw mx bi translated">张量流</li></ol><h1 id="6af9" class="lv lw iq bd lx ly nd ma mb mc ne me mf jw nf jx mh jz ng ka mj kc nh kd ml mm bi translated">数据</h1><p id="04d3" class="pw-post-body-paragraph kr ks iq kt b ku mp jr kw kx mq ju kz la ni lc ld le nj lg lh li nk lk ll lm ij bi translated">数据可以从 kaggle 网站下载，可以在<a class="ae ln" href="https://www.kaggle.com/c/data-science-bowl-2018/data" rel="noopener ugc nofollow" target="_blank"> <strong class="kt ir">这里</strong> </a>找到。</p><h1 id="9d24" class="lv lw iq bd lx ly nd ma mb mc ne me mf jw nf jx mh jz ng ka mj kc nh kd ml mm bi translated">基础</h1><p id="eb1a" class="pw-post-body-paragraph kr ks iq kt b ku mp jr kw kx mq ju kz la ni lc ld le nj lg lh li nk lk ll lm ij bi translated">这是一个典型的实例分割问题。在这方面非常成功的两个架构是 U-Net 和 Mask-R-CNN。我在这个项目中使用了 U-Net。</p><ul class=""><li id="1ffe" class="mn mo iq kt b ku kv kx ky la nl le nm li nn lm no mv mw mx bi translated"><strong class="kt ir">图像分类</strong>:对图像中的主要物体类别进行分类。</li><li id="b6f0" class="mn mo iq kt b ku my kx mz la na le nb li nc lm no mv mw mx bi translated"><strong class="kt ir">对象检测</strong>:识别对象类别，并使用图像中每个已知对象的边界框定位位置。</li><li id="a8af" class="mn mo iq kt b ku my kx mz la na le nb li nc lm no mv mw mx bi translated"><strong class="kt ir">语义分割</strong>:为图像中每个已知的物体识别每个像素的物体类别。<strong class="kt ir">标签是类感知的。</strong></li><li id="1e86" class="mn mo iq kt b ku my kx mz la na le nb li nc lm no mv mw mx bi translated"><strong class="kt ir">实例分割</strong>:识别图像中每个已知对象的每个像素的每个对象实例。标签是实例感知的。</li></ul></div><div class="ab cl lo lp hu lq" role="separator"><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt"/></div><div class="ij ik il im in"><h1 id="bdad" class="lv lw iq bd lx ly lz ma mb mc md me mf jw mg jx mh jz mi ka mj kc mk kd ml mm bi translated">代码在哪里？</h1><p id="0924" class="pw-post-body-paragraph kr ks iq kt b ku mp jr kw kx mq ju kz la ni lc ld le nj lg lh li nk lk ll lm ij bi translated">事不宜迟，让我们从代码开始吧。github 上的完整项目可以在这里找到<a class="ae ln" href="https://github.com/abhinavsagar/Kaggle-tutorial" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="3748" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">让我们从加载所有的库和依赖项开始。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="np nq l"/></div></figure><p id="e320" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我们还应该设置一些参数值，并加载训练集和测试集图像。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="np nq l"/></div></figure><p id="8a8f" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">接下来我们应该以我们想要的形式准备数据。为了降低计算复杂度，我们需要调整所有图像的大小。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="np nq l"/></div></figure><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="np nq l"/></div></figure><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="np nq l"/></div></figure><p id="6f48" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">下一步可能是项目中最重要的部分，但却经常被忽视。是的，这就是数据增强。我使用图像剪切来克服过度拟合。由于在这种情况下数据集的大小很小，过度拟合在这里不是一个主要问题。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="np nq l"/></div></figure><p id="51f4" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">让我们展示一些有分割和没有分割的显微图像。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="np nq l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/5ec9f68202fd00b69f42d1e713310677.png" data-original-src="https://miro.medium.com/v2/resize:fit:578/format:webp/1*aHPbJFapSNuC4pF3AHN56w.png"/></div><figcaption class="ns nt gj gh gi nu nv bd b be z dk">without segmentation</figcaption></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/d5ea09e494c1c8d74c5c5c972ddc9da6.png" data-original-src="https://miro.medium.com/v2/resize:fit:648/format:webp/1*FnPBci7hh6jY1qZ4z_XVrQ.png"/></div><figcaption class="ns nt gj gh gi nu nv bd b be z dk">with segmentation</figcaption></figure><p id="4f14" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">让我们也创建一个生成遮罩和图像的生成器。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="np nq l"/></div></figure></div><div class="ab cl lo lp hu lq" role="separator"><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt"/></div><div class="ij ik il im in"><h1 id="c479" class="lv lw iq bd lx ly lz ma mb mc md me mf jw mg jx mh jz mi ka mj kc mk kd ml mm bi translated">优信网</h1><p id="04f3" class="pw-post-body-paragraph kr ks iq kt b ku mp jr kw kx mq ju kz la ni lc ld le nj lg lh li nk lk ll lm ij bi translated">该建筑看起来像一个“U”形，名副其实。这个架构由三个部分组成:收缩部分、瓶颈部分和扩展部分。收缩段由许多收缩块组成。每个模块接受一个输入，并应用两个 3×3 卷积层，然后是一个 2×2 最大池。每个块之后的核或特征图的数量加倍，以便架构可以有效地学习复杂的结构。最底层位于收缩层和膨胀层之间。</p><p id="651b" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">但是这个架构的核心在于扩展部分。类似于收缩层，也是由几个膨胀块组成。每个模块将输入传递到两个 3X3 CNN 层，然后是一个 2×2 上采样层。此外，在每个块之后，卷积层使用的特征图的数量减半以保持对称性。扩展块的数量与收缩块的数量相同。之后，所得到的映射通过另一个 3X3 CNN 层，其特征映射的数量等于期望的分段数量。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nx"><img src="../Images/a22af3ea5dfdb6f7f87fa6cd9a40c28c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kINgQvvpTboU0gfCpsujCQ.png"/></div></div><figcaption class="ns nt gj gh gi nu nv bd b be z dk">U-net architecture</figcaption></figure></div><div class="ab cl lo lp hu lq" role="separator"><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt"/></div><div class="ij ik il im in"><p id="b564" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">让我们继续定义 Union   (IOU)度量上的<a class="ae ln" href="https://en.wikipedia.org/wiki/Jaccard_index" rel="noopener ugc nofollow" target="_blank"> <strong class="kt ir">交集。</strong></a></p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="np nq l"/></div></figure><p id="2e39" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">然后我们应该使用 keras 图层建立如上图所示的 U-Net 模型。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="np nq l"/></div></figure><p id="a271" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我使用早期停止标准作为参数对模型进行了三次迭代训练，它给出了相当好的结果，平均 IOU 为 0.416。请随意使用这里的超参数。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="np nq l"/></div></figure><p id="d7e7" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">最后，我为最后的预测写了几行。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="np nq l"/></div></figure><h1 id="85d3" class="lv lw iq bd lx ly nd ma mb mc ne me mf jw nf jx mh jz ng ka mj kc nh kd ml mm bi translated">结果</h1><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/3aa0e9d25410af9318906e4f9061b048.png" data-original-src="https://miro.medium.com/v2/resize:fit:946/format:webp/1*Hh-YPHGObYa94w61rcfWhA.png"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/dba6f2004e9afc17054e75baa020282b.png" data-original-src="https://miro.medium.com/v2/resize:fit:946/format:webp/1*0wH8KF_dwM6h1KRgVjRBJQ.png"/></div></figure></div><div class="ab cl lo lp hu lq" role="separator"><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt"/></div><div class="ij ik il im in"><h1 id="6899" class="lv lw iq bd lx ly lz ma mb mc md me mf jw mg jx mh jz mi ka mj kc mk kd ml mm bi translated">结论</h1><p id="ab6f" class="pw-post-body-paragraph kr ks iq kt b ku mp jr kw kx mq ju kz la ni lc ld le nj lg lh li nk lk ll lm ij bi translated">这是我参与过的最具挑战性的项目之一，同时也很有趣。虽然这不是一个典型的计算机视觉项目，其中计算复杂性是一个挑战，但它更多的是在相对较大的图像中找到小特征。坦率地说，在图像中分割细胞核是一个挑战。有时，即使是专家也可能在这方面犯错误，因此自动化整个流水线，看起来像是细胞核分割的未来。</p></div><div class="ab cl lo lp hu lq" role="separator"><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt"/></div><div class="ij ik il im in"><h1 id="a744" class="lv lw iq bd lx ly lz ma mb mc md me mf jw mg jx mh jz mi ka mj kc mk kd ml mm bi translated">参考资料/进一步阅读</h1><div class="nz oa gp gr ob oc"><a href="https://arxiv.org/abs/1505.04597" rel="noopener  ugc nofollow" target="_blank"><div class="od ab fo"><div class="oe ab of cl cj og"><h2 class="bd ir gy z fp oh fr fs oi fu fw ip bi translated">U-Net:生物医学图像分割的卷积网络</h2><div class="oj l"><h3 class="bd b gy z fp oh fr fs oi fu fw dk translated">人们普遍认为，深度网络的成功训练需要成千上万个带注释的训练样本。在…</h3></div><div class="ok l"><p class="bd b dl z fp oh fr fs oi fu fw dk translated">arxiv.org</p></div></div></div></a></div><div class="nz oa gp gr ob oc"><a href="https://www.kaggle.com/c/data-science-bowl-2018" rel="noopener  ugc nofollow" target="_blank"><div class="od ab fo"><div class="oe ab of cl cj og"><h2 class="bd ir gy z fp oh fr fs oi fu fw ip bi translated">2018 数据科学碗</h2><div class="oj l"><h3 class="bd b gy z fp oh fr fs oi fu fw dk translated">在不同的图像中找到细胞核以推进医学发现</h3></div><div class="ok l"><p class="bd b dl z fp oh fr fs oi fu fw dk translated">www.kaggle.com</p></div></div><div class="ol l"><div class="om l on oo op ol oq kp oc"/></div></div></a></div><div class="nz oa gp gr ob oc"><a rel="noopener follow" target="_blank" href="/review-u-net-biomedical-image-segmentation-d02bf06ca760"><div class="od ab fo"><div class="oe ab of cl cj og"><h2 class="bd ir gy z fp oh fr fs oi fu fw ip bi translated">综述:U-Net(生物医学图像分割)</h2><div class="oj l"><h3 class="bd b gy z fp oh fr fs oi fu fw dk translated">在这个故事中，我们回顾了 U-Net。U-Net 是生物医学图像领域著名的全卷积网络(FCN)之一</h3></div><div class="ok l"><p class="bd b dl z fp oh fr fs oi fu fw dk translated">towardsdatascience.com</p></div></div><div class="ol l"><div class="or l on oo op ol oq kp oc"/></div></div></a></div></div><div class="ab cl lo lp hu lq" role="separator"><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt"/></div><div class="ij ik il im in"><h1 id="aa19" class="lv lw iq bd lx ly lz ma mb mc md me mf jw mg jx mh jz mi ka mj kc mk kd ml mm bi translated">在你走之前</h1><p id="e7d9" class="pw-post-body-paragraph kr ks iq kt b ku mp jr kw kx mq ju kz la ni lc ld le nj lg lh li nk lk ll lm ij bi translated">相应的源代码可以在这里找到。</p><div class="nz oa gp gr ob oc"><a href="https://github.com/abhinavsagar/Kaggle-tutorial" rel="noopener  ugc nofollow" target="_blank"><div class="od ab fo"><div class="oe ab of cl cj og"><h2 class="bd ir gy z fp oh fr fs oi fu fw ip bi translated">abhinavsagar/ka ggle-教程</h2><div class="oj l"><h3 class="bd b gy z fp oh fr fs oi fu fw dk translated">Kaggle 竞赛笔记本样本。显微图像的自动分割是医学图像处理中的一项重要任务</h3></div><div class="ok l"><p class="bd b dl z fp oh fr fs oi fu fw dk translated">github.com</p></div></div><div class="ol l"><div class="os l on oo op ol oq kp oc"/></div></div></a></div><h1 id="cee3" class="lv lw iq bd lx ly nd ma mb mc ne me mf jw nf jx mh jz ng ka mj kc nh kd ml mm bi translated">联系人</h1><p id="924e" class="pw-post-body-paragraph kr ks iq kt b ku mp jr kw kx mq ju kz la ni lc ld le nj lg lh li nk lk ll lm ij bi translated">如果你想了解我最新的文章和项目<a class="ae ln" href="https://medium.com/@abhinav.sagar" rel="noopener">，请关注我的媒体</a>。以下是我的一些联系人详细信息:</p><ul class=""><li id="47c9" class="mn mo iq kt b ku kv kx ky la nl le nm li nn lm no mv mw mx bi translated"><a class="ae ln" href="https://abhinavsagar.github.io" rel="noopener ugc nofollow" target="_blank">个人网站</a></li><li id="575a" class="mn mo iq kt b ku my kx mz la na le nb li nc lm no mv mw mx bi translated"><a class="ae ln" href="https://in.linkedin.com/in/abhinavsagar4" rel="noopener ugc nofollow" target="_blank">领英</a></li><li id="6139" class="mn mo iq kt b ku my kx mz la na le nb li nc lm no mv mw mx bi translated"><a class="ae ln" href="https://medium.com/@abhinav.sagar" rel="noopener">中等轮廓</a></li><li id="2e6d" class="mn mo iq kt b ku my kx mz la na le nb li nc lm no mv mw mx bi translated"><a class="ae ln" href="https://github.com/abhinavsagar" rel="noopener ugc nofollow" target="_blank"> GitHub </a></li><li id="de97" class="mn mo iq kt b ku my kx mz la na le nb li nc lm no mv mw mx bi translated"><a class="ae ln" href="https://www.kaggle.com/abhinavsagar" rel="noopener ugc nofollow" target="_blank">卡格尔</a></li></ul><p id="2d26" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">快乐阅读，快乐学习，快乐编码。</p></div></div>    
</body>
</html>