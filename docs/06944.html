<html>
<head>
<title>How to Easily Deploy Machine Learning Models Using Flask</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用 Flask 轻松部署机器学习模型</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-easily-deploy-machine-learning-models-using-flask-b95af8fe34d4?source=collection_archive---------0-----------------------#2019-10-02">https://towardsdatascience.com/how-to-easily-deploy-machine-learning-models-using-flask-b95af8fe34d4?source=collection_archive---------0-----------------------#2019-10-02</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="9486" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">把你的模型从 jupyter 笔记本带到生产中</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/990f4e2bc2ba257b73696689e51db82b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pB5Yhj_4dx4hyrr-d-Ck4w.jpeg"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Photo by <a class="ae kv" href="https://unsplash.com/@spacex?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">SpaceX</a> on <a class="ae kv" href="https://unsplash.com/s/photos/rocket-launch?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="b687" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">被困在付费墙后面？点击<a class="ae kv" href="https://medium.com/p/how-to-easily-deploy-machine-learning-models-using-flask-b95af8fe34d4?source=email-c3f5233f3441--writer.postDistributed&amp;sk=9db80eba5a150458734179050ddcab1c" rel="noopener">这里</a>阅读完整故事与我的朋友链接！</p><p id="12f8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">当数据科学家/机器学习工程师使用 Scikit-Learn、TensorFlow、Keras、PyTorch 等开发机器学习模型时，最终目标是使其在生产中可用。很多时候，当我们从事机器学习项目时，我们会把很多精力放在探索性数据分析(EDA)、特征工程、超参数调整等方面。但我们往往会忘记我们的主要目标，即从模型预测中提取真正的价值。</p><p id="9be3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">部署机器学习模型或将模型投入生产意味着将您的模型提供给最终用户或系统。然而，在机器学习模型的部署中存在复杂性。这篇文章旨在让你开始使用 Flask API 将训练好的机器学习模型投入生产。</p><p id="6154" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我将使用线性回归来预测第三个月的销售额，使用前两个月的利率和销售额。</p><h1 id="b207" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">什么是线性回归</h1><p id="35c1" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">线性回归模型的目标是找到一个或多个特征(自变量)和一个连续目标变量(因变量)之间的关系。当只有一个特征时，称为<em class="mp">单变量</em>线性回归，如果有多个特征，称为<em class="mp">多元</em>线性回归。</p><h1 id="4882" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">线性回归假设</h1><p id="e4bf" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">线性回归模型可以由下面的等式表示</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mq"><img src="../Images/c78cf854485412f0d0878a9b1f5d42b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:120/0*sy3_rBdtu0rIBGVY"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mr"><img src="../Images/d9b03502b90cdd289955d7e334e9ecb2.png" data-original-src="https://miro.medium.com/v2/resize:fit:626/format:webp/0*PXhNMlJD356FaDpA.png"/></div></figure><ul class=""><li id="e6af" class="ms mt iq ky b kz la lc ld lf mu lj mv ln mw lr mx my mz na bi translated"><em class="mp"> Y </em>是预测值</li><li id="ba03" class="ms mt iq ky b kz nb lc nc lf nd lj ne ln nf lr mx my mz na bi translated">θ  ₀是偏差项。</li><li id="7d57" class="ms mt iq ky b kz nb lc nc lf nd lj ne ln nf lr mx my mz na bi translated"><em class="mp"> θ </em> ₁,…，<em class="mp"> θ </em> ₙ为模型参数</li><li id="b4de" class="ms mt iq ky b kz nb lc nc lf nd lj ne ln nf lr mx my mz na bi translated"><em class="mp"> x </em> ₁、<em class="mp"> x </em> ₂,…、<em class="mp"> x </em> ₙ为特征值。</li></ul><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/7f8a2966cb3549675bc80ae72fb3b1ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*QiU6DcP_r9qWLznMw0-M_Q.png"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Linear regression illustrated</figcaption></figure><h1 id="6945" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">为什么是烧瓶？</h1><ul class=""><li id="1cc0" class="ms mt iq ky b kz mk lc ml lf nh lj ni ln nj lr mx my mz na bi translated">好用。</li><li id="9633" class="ms mt iq ky b kz nb lc nc lf nd lj ne ln nf lr mx my mz na bi translated">内置开发服务器和调试器。</li><li id="4b1a" class="ms mt iq ky b kz nb lc nc lf nd lj ne ln nf lr mx my mz na bi translated">集成单元测试支持。</li><li id="beb7" class="ms mt iq ky b kz nb lc nc lf nd lj ne ln nf lr mx my mz na bi translated">RESTful 请求调度。</li><li id="5b39" class="ms mt iq ky b kz nb lc nc lf nd lj ne ln nf lr mx my mz na bi translated">大量记录。</li></ul><h1 id="7472" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">项目结构</h1><p id="89d8" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">该项目有四个部分:</p><ol class=""><li id="3fac" class="ms mt iq ky b kz la lc ld lf mu lj mv ln mw lr nk my mz na bi translated">model.py 它包含机器学习模型的代码，用于根据前两个月的销售额预测第三个月的销售额。</li><li id="b07b" class="ms mt iq ky b kz nb lc nc lf nd lj ne ln nf lr nk my mz na bi translated">app . py——它包含 Flask APIs，通过 GUI 或 API 调用接收销售细节，根据我们的模型计算预测值并返回。</li><li id="c5e9" class="ms mt iq ky b kz nb lc nc lf nd lj ne ln nf lr nk my mz na bi translated">request.py —它使用请求模块调用 app.py 中定义的 API，并显示返回值。</li><li id="ce1d" class="ms mt iq ky b kz nb lc nc lf nd lj ne ln nf lr nk my mz na bi translated">HTML/CSS —它包含 HTML 模板和 CSS 样式，允许用户输入销售详细信息，并显示第三个月的预测销售额。</li></ol><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/f76e327b8290493439abd9b280bde555.png" data-original-src="https://miro.medium.com/v2/resize:fit:1150/format:webp/1*R6MR34xT4Ve6fI744EVN0A.png"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Pipeline for deployment of a Machine Learning model</figcaption></figure><h1 id="8074" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">环境和工具</h1><ol class=""><li id="63d2" class="ms mt iq ky b kz mk lc ml lf nh lj ni ln nj lr nk my mz na bi translated">sci kit-学习</li><li id="f7a3" class="ms mt iq ky b kz nb lc nc lf nd lj ne ln nf lr nk my mz na bi translated">熊猫</li><li id="5e08" class="ms mt iq ky b kz nb lc nc lf nd lj ne ln nf lr nk my mz na bi translated">numpy</li><li id="0a44" class="ms mt iq ky b kz nb lc nc lf nd lj ne ln nf lr nk my mz na bi translated">瓶</li></ol><h1 id="818e" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">代码在哪里？</h1><p id="be28" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">事不宜迟，让我们从代码开始吧。github 上的完整项目可以在<a class="ae kv" href="https://github.com/abhinavsagar/Machine-Learning-Deployment-Tutorials" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p><p id="c678" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们从使用 HTML 为用户输入值制作前端开始。有三个字段需要用户填写——利率、第一个月的销售额和第二个月的销售额。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="31ce" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">接下来，我使用 CSS 对输入按钮、登录按钮和背景进行了一些样式设计。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="f59b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我为这个项目创建了一个自定义销售数据集，它有四列——利率、第一个月的销售额、第二个月的销售额和第三个月的销售额。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="10b1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们现在做一个机器学习模型来预测第三个月的销量。首先让我们用熊猫来处理缺失值。当没有为一个或多个项目提供信息时，可能会出现数据缺失。如果没有提供值，我用零填充比率列，用该列的平均值填充第一个月的销售额。我用线性回归作为机器学习算法。</p><h1 id="105d" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">序列化/反序列化</h1><p id="23e2" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">简而言之，序列化是一种在磁盘上编写 python 对象的方法，该对象可以传输到任何地方，稍后可以由 python 脚本反序列化(读取)回来。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi no"><img src="../Images/128f9e5e0c2e498a362f53a6b7cfa982.png" data-original-src="https://miro.medium.com/v2/resize:fit:746/format:webp/1*Menz4NWvM6Ca8H6B0d6VrQ.png"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Serialization, De-Serialization</figcaption></figure><p id="9a18" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我使用 pickling 将 python 对象形式的模型转换为字符流。这个想法是，这个字符流包含在另一个 python 脚本中重建对象所需的所有信息。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="9349" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">下一部分是制作一个 API，它通过 GUI 接收销售细节，并根据我们的模型计算预测的销售值。为此，我以 python 对象的形式反序列化了 pickled 模型。我用<code class="fe np nq nr ns b">index.html</code>设置了主页面。在使用 POST 请求向<code class="fe np nq nr ns b">/predict</code>提交表单值时，我们得到预测的销售额。</p><p id="26cc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">可以通过向<code class="fe np nq nr ns b">/results.</code>发出另一个 POST 请求来显示结果，它接收 JSON 输入，使用训练好的模型进行预测，并以 JSON 格式返回预测，可以通过 API 端点访问该格式。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="fcf9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">最后，我使用请求模块来调用在<code class="fe np nq nr ns b">app.py</code>中定义的 API。它显示第三个月返回的销售额。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nm nn l"/></div></figure><h1 id="6f14" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">结果</h1><p id="5e07" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">使用此命令运行 web 应用程序。</p><pre class="kg kh ki kj gt nt ns nu nv aw nw bi"><span id="9082" class="nx lt iq ns b gy ny nz l oa ob">$ python app.py</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oc"><img src="../Images/a00f3af339ec405557c72a08255e18ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KslU_eRP25IGPSEHIB0LbA.png"/></div></div></figure><p id="d5ba" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在您的网络浏览器中打开<a class="ae kv" href="http://127.0.0.1:5000/" rel="noopener ugc nofollow" target="_blank"> http://127.0.0.1:5000/ </a>，应出现如下所示的 GUI。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi od"><img src="../Images/9742d5fbfc57dcb600f30b007b4dbdf4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1082/format:webp/1*TajI7H3AvWZcxzK4UUxyIQ.png"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Graphical user interface</figcaption></figure><h1 id="dd82" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">结论</h1><p id="3b55" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">本文展示了一种部署机器学习模型的非常简单的方法。我使用线性回归来预测第三个月的销售额，使用利率和前两个月的销售额。人们可以利用在这个博客中获得的知识制作一些很酷的模型，并把它们投入生产，这样其他人就可以欣赏他们的工作。</p><h1 id="7071" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">参考资料/进一步阅读</h1><div class="oe of gp gr og oh"><a rel="noopener follow" target="_blank" href="/writing-a-simple-flask-web-application-in-80-lines-cb5c386b089a"><div class="oi ab fo"><div class="oj ab ok cl cj ol"><h2 class="bd ir gy z fp om fr fs on fu fw ip bi translated">用 80 行代码编写一个简单的 Flask Web 应用程序</h2><div class="oo l"><h3 class="bd b gy z fp om fr fs on fu fw dk translated">快速入门示例教程</h3></div><div class="op l"><p class="bd b dl z fp om fr fs on fu fw dk translated">towardsdatascience.com</p></div></div><div class="oq l"><div class="or l os ot ou oq ov kp oh"/></div></div></a></div><div class="oe of gp gr og oh"><a href="https://www.coursera.org/learn/deploying-machine-learning-models" rel="noopener  ugc nofollow" target="_blank"><div class="oi ab fo"><div class="oj ab ok cl cj ol"><h2 class="bd ir gy z fp om fr fs on fu fw ip bi translated">部署机器学习模型| Coursera</h2><div class="oo l"><h3 class="bd b gy z fp om fr fs on fu fw dk translated">从加州大学圣地亚哥分校学习部署机器学习模型。在本课程中，我们将了解…</h3></div><div class="op l"><p class="bd b dl z fp om fr fs on fu fw dk translated">www.coursera.org</p></div></div><div class="oq l"><div class="ow l os ot ou oq ov kp oh"/></div></div></a></div><div class="oe of gp gr og oh"><a rel="noopener follow" target="_blank" href="/simple-way-to-deploy-machine-learning-models-to-cloud-fd58b771fdcf"><div class="oi ab fo"><div class="oj ab ok cl cj ol"><h2 class="bd ir gy z fp om fr fs on fu fw ip bi translated">将机器学习模型部署到云的简单方法</h2><div class="oo l"><h3 class="bd b gy z fp om fr fs on fu fw dk translated">使用简单的技术堆栈将您的第一个 ML 模型部署到生产环境中</h3></div><div class="op l"><p class="bd b dl z fp om fr fs on fu fw dk translated">towardsdatascience.com</p></div></div><div class="oq l"><div class="ox l os ot ou oq ov kp oh"/></div></div></a></div><div class="oe of gp gr og oh"><a href="https://www.kdnuggets.com/2019/06/approaches-deploying-machine-learning-production.html" rel="noopener  ugc nofollow" target="_blank"><div class="oi ab fo"><div class="oj ab ok cl cj ol"><h2 class="bd ir gy z fp om fr fs on fu fw ip bi translated">在生产中部署机器学习模型的不同方法概述</h2><div class="oo l"><h3 class="bd b gy z fp om fr fs on fu fw dk translated">将模型投入生产的方法有很多种，不同的方法会带来不同的好处</h3></div><div class="op l"><p class="bd b dl z fp om fr fs on fu fw dk translated">www.kdnuggets.com</p></div></div><div class="oq l"><div class="oy l os ot ou oq ov kp oh"/></div></div></a></div><h1 id="a42e" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">在你走之前</h1><p id="29ac" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">相应的源代码可以在这里找到。</p><div class="oe of gp gr og oh"><a href="https://github.com/abhinavsagar/Machine-Learning-Deployment-Tutorials" rel="noopener  ugc nofollow" target="_blank"><div class="oi ab fo"><div class="oj ab ok cl cj ol"><h2 class="bd ir gy z fp om fr fs on fu fw ip bi translated">abhinavsagar/机器学习部署教程</h2><div class="oo l"><h3 class="bd b gy z fp om fr fs on fu fw dk translated">从数据收集到将模型投入生产的端到端项目示例…</h3></div><div class="op l"><p class="bd b dl z fp om fr fs on fu fw dk translated">github.com</p></div></div></div></a></div><h1 id="1182" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">联系人</h1><p id="60bd" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">如果你想了解我最新的文章和项目<a class="ae kv" href="https://medium.com/@abhinav.sagar" rel="noopener">，请关注我的媒体</a>。以下是我的一些联系人详细信息:</p><ul class=""><li id="f946" class="ms mt iq ky b kz la lc ld lf mu lj mv ln mw lr mx my mz na bi translated"><a class="ae kv" href="https://abhinavsagar.github.io/" rel="noopener ugc nofollow" target="_blank">个人网站</a></li><li id="c61d" class="ms mt iq ky b kz nb lc nc lf nd lj ne ln nf lr mx my mz na bi translated"><a class="ae kv" href="https://in.linkedin.com/in/abhinavsagar4" rel="noopener ugc nofollow" target="_blank">领英</a></li><li id="5fd5" class="ms mt iq ky b kz nb lc nc lf nd lj ne ln nf lr mx my mz na bi translated"><a class="ae kv" href="https://medium.com/@abhinav.sagar" rel="noopener">中等轮廓</a></li><li id="0902" class="ms mt iq ky b kz nb lc nc lf nd lj ne ln nf lr mx my mz na bi translated"><a class="ae kv" href="https://github.com/abhinavsagar" rel="noopener ugc nofollow" target="_blank"> GitHub </a></li><li id="2119" class="ms mt iq ky b kz nb lc nc lf nd lj ne ln nf lr mx my mz na bi translated"><a class="ae kv" href="https://www.kaggle.com/abhinavsagar" rel="noopener ugc nofollow" target="_blank">卡格尔</a></li></ul><p id="a802" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">快乐阅读，快乐学习，快乐编码。</p></div></div>    
</body>
</html>