<html>
<head>
<title>Using PCA and Clustering To Analyze Genes and Leukemia</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">利用主成分分析和聚类分析基因与白血病</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-gene-expression-related-to-leukemia-type-using-pca-and-hierarchical-clustering-c8561303853a?source=collection_archive---------24-----------------------#2019-10-23">https://towardsdatascience.com/how-gene-expression-related-to-leukemia-type-using-pca-and-hierarchical-clustering-c8561303853a?source=collection_archive---------24-----------------------#2019-10-23</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="7601" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph">机器学习:无监督学习</h2><div class=""/><div class=""><h2 id="982f" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">无监督学习的现实应用</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/7998b3cb98d00b84730e9d8e9505b310.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JV-liQv_Va530pu6_5Qe4g.jpeg"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk">Photo by <a class="ae lh" href="https://unsplash.com/@nasa?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">NASA</a> on <a class="ae lh" href="https://unsplash.com/s/photos/data?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="cf13" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在机器学习的世界中，无监督学习是在没有标记结果的情况下进行推理的过程。主成分分析和聚类是两种常见的无监督学习技术。</p><p id="656b" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">PCA 是将高维数据缩减为几层关键特征的过程。降维后，我们只需要处理一小部分特征，其他的就不考虑了。</p><p id="606b" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">聚类是将具有相似特征的数据输入分配给特定组的任务。聚类后，同一组中的数据点应该是相似的，但与其他组中的数据点明显不同。</p><p id="9ff6" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在这篇文章中，我将把主成分分析和层次聚类应用于生命科学数据集，以分析特定基因如何影响白血病类型。</p><p id="2878" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">该数据集最初由 Yeoh 等人(2002 年)从 327 名患者(<a class="ae lh" href="https://reader.elsevier.com/reader/sd/pii/S1535610802000326?token=633BF4E89E1BE8827F43547C086071F82354429A051AF7E1E9267CFBA6EBE9614E889B8005144FB14A19995A666E5388" rel="noopener ugc nofollow" target="_blank">此处为</a>)的 7 种白血病亚型中收集了 3141 个基因。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi me"><img src="../Images/e0509e4fd899b6ed3a55b18b506948cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yILm9Q16bFJ2VJomp3-Zcg.jpeg"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk">Photo by <a class="ae lh" href="https://unsplash.com/@dekubaum?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Dennis Kummer</a> on <a class="ae lh" href="https://unsplash.com/s/photos/data?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure></div><div class="ab cl mf mg hx mh" role="separator"><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk"/></div><div class="im in io ip iq"><p id="35c0" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><strong class="lk jd"> #加载数据集并转换数据类型</strong></p><p id="baea" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">将 leukemia_data 的数据类型由字符型改为因子型。</p><pre class="ks kt ku kv gt mm mn mo mp aw mq bi"><span id="5c85" class="mr ms it mn b gy mt mu l mv mw">knitr::opts_chunk$set(echo = TRUE)<br/>library(dplyr)<br/>library(readr)<br/>leukemia_data &lt;- read_csv(“leukemia_data.csv”)<br/>leukemia_data = leukemia_data %&gt;% <br/> mutate(Type=as.factor(leukemia_data$Type))</span><span id="0a7a" class="mr ms it mn b gy mx mu l mv mw">#Display different types of leukemia and count the numbers of each type<br/>#doing explorative data analysis is always preferred for all types of research</span><span id="2dcc" class="mr ms it mn b gy mx mu l mv mw">table(leukemia_data$Type)</span><span id="2480" class="mr ms it mn b gy mx mu l mv mw">BCR-ABL  E2A-PBX1 Hyperdip50     MLL    OTHERS     T-ALL    TEL-AML1 <br/>15         27         64         20       79         43         79</span></pre><p id="7ef5" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">一些描述性数据:BCR-ABL 是最不常见的白血病类型，TEL-AML1 是数据集中最常见的。</p><p id="15b9" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><strong class="lk jd"> #降维</strong></p><p id="bc1d" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">由于有 3141 个基因，我们应该使用主成分分析来减少数量，使之易于解释。</p><pre class="ks kt ku kv gt mm mn mo mp aw mq bi"><span id="e8f0" class="mr ms it mn b gy mt mu l mv mw"># generate PCA results;<br/># scale=TRUE and center=TRUE --&gt; mean 0 and variance 1<br/>pr.out=prcomp(select(leukemia_data,-1),scale=TRUE, center=TRUE)</span><span id="80c0" class="mr ms it mn b gy mx mu l mv mw"># pr.out$sdev: the standard deviations of the principal components; <br/># (pr.out$sdev)²: variance of the principal components<br/>pr.var=(pr.out$sdev)²</span><span id="48f3" class="mr ms it mn b gy mx mu l mv mw"># pve: variance explained by the principal component<br/>pve = pr.var/sum(pr.var)</span><span id="5f4f" class="mr ms it mn b gy mx mu l mv mw"># cumulative explained variance<br/>cumulative_pve &lt;-cumsum(pve)</span><span id="e4ac" class="mr ms it mn b gy mx mu l mv mw"># Plot them <br/>par(mfrow=c(1, 2))<br/>plot(pve, type=”l”, lwd=3) <br/>plot(cumulative_pve, type=”l”, lwd=3)</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi my"><img src="../Images/0b4451fe4e4af791c17d2fc879003b51.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nBoXd6vDPmpkRiD42gR0Og.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk">PVE and Cumulative PVE</figcaption></figure><p id="206e" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">这两个图直观地说明了几个关键特征可以解释总方差的大部分。</p><p id="e71a" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><strong class="lk jd"> #问题:哪些基因在第一主成分(aka。PC1)？</strong></p><pre class="ks kt ku kv gt mm mn mo mp aw mq bi"><span id="51bf" class="mr ms it mn b gy mt mu l mv mw">#project loadings on PC1<br/>Loadings_PC_1 &lt;- pr.out$rotation[,1]</span><span id="ded8" class="mr ms it mn b gy mx mu l mv mw">#in absolute value<br/>Loadings_PC_1_ABS &lt;- abs(Loadings_PC_1)</span><span id="f0f1" class="mr ms it mn b gy mx mu l mv mw">#print and sort the results<br/>print(head(sort(Loadings_PC_1_ABS,decreasing = TRUE)))</span><span id="8b60" class="mr ms it mn b gy mx mu l mv mw">SEMA3F       CCT2       LDHB      COX6C     SNRPD2       ELK3 <br/>0.04517148 0.04323818 0.04231619 0.04183480 0.04179822 0.04155821</span></pre><p id="dbd4" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">PC1 上负载最高的前六个基因是:SEMA3F、CCT2、LDHB、COX6C、SNRPD2 和 ELK3。</p><pre class="ks kt ku kv gt mm mn mo mp aw mq bi"><span id="2112" class="mr ms it mn b gy mt mu l mv mw">#plot the data into the first two principal component dimensions<br/>Projection_1_PC = pr.out$x[,1]<br/>Projection_2_PC = pr.out$x[,2]</span><span id="8c3a" class="mr ms it mn b gy mx mu l mv mw">rainbow_colors &lt;- rainbow(7)<br/>plot_colors &lt;- rainbow_colors[leukemia_data$Type]</span><span id="ab2a" class="mr ms it mn b gy mx mu l mv mw">plot(Projection_1_PC,Projection_2_PC,cex=0.4,col=plot_colors)<br/>text(Projection_1_PC,Projection_2_PC,labels=leukemia_data$Type,col=plot_colors)</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi mz"><img src="../Images/dfb03bd0a2dab38a1a48f9a6eb5afd32.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3b1kAn95B9g4CACKzqq2VA.png"/></div></div></figure><p id="ea38" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">只有 T-all(右上角)是从人群中挑选出来的；其他类型的白血病还粘在一起。换句话说，前两种成分并不是分离的理想选择。</p><p id="7575" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">让我们试试第一台和第三台电脑。</p><pre class="ks kt ku kv gt mm mn mo mp aw mq bi"><span id="75e4" class="mr ms it mn b gy mt mu l mv mw">Projection_3_PC = pr.out$x[,3]<br/>rainbow_colors &lt;- rainbow(7)<br/>plot_colors &lt;- rainbow_colors[leukemia_data$Type]<br/>plot(Projection_1_PC,Projection_3_PC,cex=0.4,col=plot_colors)<br/>text(Projection_1_PC,Projection_3_PC,labels=leukemia_data$Type,col=plot_colors)</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi na"><img src="../Images/2ff1d44d8d5730901a378190881e4f88.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qfMLqpb2rk8siEUlqGeavQ.png"/></div></div></figure><p id="36c3" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">相比之下，第 1 台和第 3 台电脑做得更好，因为分布分散在不同的地区。</p><p id="6261" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><strong class="lk jd">#项目到 PCs </strong></p><pre class="ks kt ku kv gt mm mn mo mp aw mq bi"><span id="be0e" class="mr ms it mn b gy mt mu l mv mw">#install.packages(c(“ggridges”,”ggplot2",”tidyverse”))<br/>library(ggplot2)<br/>library(ggridges)<br/>library(tibble)</span><span id="7750" class="mr ms it mn b gy mx mu l mv mw">#project on PC1<br/>z1 = pr.out$x[,1]</span><span id="7fc1" class="mr ms it mn b gy mx mu l mv mw">#create a new tibble where the first column is the project of the data on the first PC and the second is the leukemia type<br/>TB_1 = tibble(z1,leukemia_data$Type)</span><span id="4dcd" class="mr ms it mn b gy mx mu l mv mw">#plot it <br/>ggplot(TB_1, aes(x = z1, y = leukemia_data$Type, fill = leukemia_data$Type)) + geom_density_ridges()</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nb"><img src="../Images/cfa1baa74f4d921e052f3afe50a6ee03.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*D8IV5cCr7EgvXPCmvR9KAg.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk">z1</figcaption></figure><p id="12af" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">看来 z1 分不清不同类型。</p><p id="555e" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我们试试 z3。</p><pre class="ks kt ku kv gt mm mn mo mp aw mq bi"><span id="07cd" class="mr ms it mn b gy mt mu l mv mw">z3 = pr.out$x[,3]<br/>TB_3 = tibble(z3,leukemia_data$Type)<br/>ggplot(TB_3, aes(x = z3, y = leukemia_data$Type, fill = leukemia_data$Type)) +<br/> geom_density_ridges()</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nc"><img src="../Images/52038b2b2bcd9ed1deb95e264fbca86e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*raa5pvm3OOVq68F1BbHAiA.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk">z3</figcaption></figure><p id="65be" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">很好，我们将 E2A-PBX1(底部的橙色分布)稍微向左移动，将 hyperdip 50(E2A-PBX 1 上方的绿色分布)稍微向右移动。</p></div><div class="ab cl mf mg hx mh" role="separator"><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk"/></div><div class="im in io ip iq"><p id="1d67" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><strong class="lk jd">#让我们应用层次化</strong> <strong class="lk jd">聚类对不同类型的白血病进行分组</strong></p><p id="34bb" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">创建一个包括三种类型白血病的亚组:T-ALL、TEL-AML1 或 Hyperdip50。</p><pre class="ks kt ku kv gt mm mn mo mp aw mq bi"><span id="7e63" class="mr ms it mn b gy mt mu l mv mw">library(dplyr)</span><span id="ca0f" class="mr ms it mn b gy mx mu l mv mw">#subset<br/>leukemia_subset &lt;- filter(leukemia_data,Type==”T-ALL”|Type==”TEL-AML1"|Type==”Hyperdip50")</span><span id="3b43" class="mr ms it mn b gy mx mu l mv mw">#scale() function helps standardization<br/>scaled_leukemia_subset &lt;- scale(leukemia_subset[,-1],center=TRUE, scale=TRUE)#remove the first column and scale it</span><span id="b16e" class="mr ms it mn b gy mx mu l mv mw">#euclidean distance matrix<br/>scaled_leukemia_subset_dist &lt;- dist(scaled_leukemia_subset,method=”euclidean” )</span><span id="6e82" class="mr ms it mn b gy mx mu l mv mw">##hierarchical clustering using complete linkage<br/>set.seed(1)<br/>leukemia.hclust = hclust(scaled_leukemia_subset_dist,method=”complete”)</span><span id="4d0f" class="mr ms it mn b gy mx mu l mv mw">plot(leukemia.hclust, labels=leukemia_subset$Type, main=’Hierarchical Clusting of Leukemia Subset Data’)</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nd"><img src="../Images/c3456ad6d3233dfada2803cacdbaf6ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9ibMpEBzYS0XzY5LcgTOEw.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk">Hierarchical Clustering of Leukemia Subset Data, aka. a <strong class="bd ne">dendrogram</strong></figcaption></figure><p id="a158" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">分级聚类做得非常好，因为同种类型的白血病聚集在一起，而不同类型的则远离。</p></div><div class="ab cl mf mg hx mh" role="separator"><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk"/></div><div class="im in io ip iq"><h1 id="e8c7" class="nf ms it bd ng nh ni nj nk nl nm nn no ki np kj nq kl nr km ns ko nt kp nu nv bi translated">喜欢读这本书吗？</h1><blockquote class="nw nx ny"><p id="99b8" class="li lj nz lk b ll lm kd ln lo lp kg lq oa ls lt lu ob lw lx ly oc ma mb mc md im bi translated">请在<a class="ae lh" href="https://www.linkedin.com/in/leihuaye/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>和<a class="ae lh" href="https://www.youtube.com/channel/UCBBu2nqs6iZPyNSgMjXUGPg" rel="noopener ugc nofollow" target="_blank"> Youtube </a>上找到我。</p><p id="737b" class="li lj nz lk b ll lm kd ln lo lp kg lq oa ls lt lu ob lw lx ly oc ma mb mc md im bi translated">还有，看看我其他关于人工智能和机器学习的帖子。</p></blockquote></div></div>    
</body>
</html>