<html>
<head>
<title>Neural Fictitious Self-Play</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">神经虚拟自我游戏</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/neural-fictitious-self-play-800612b4a53f?source=collection_archive---------22-----------------------#2019-12-30">https://towardsdatascience.com/neural-fictitious-self-play-800612b4a53f?source=collection_archive---------22-----------------------#2019-12-30</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="4725" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">不完全信息博弈中的深度强化学习</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/d1b1f59f058274623985685be3e556a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*FEni8DUTV2eRsg95"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Photo by <a class="ae ky" href="https://unsplash.com/@pawel_czerwinski?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Paweł Czerwiński</a> on <a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="9818" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">更新</strong>:学习和练习强化学习的最好方式是去 http://rl-lab.com<a class="ae ky" href="http://rl-lab.com/" rel="noopener ugc nofollow" target="_blank"/></p><h2 id="83ca" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">介绍</h2><p id="0a2e" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">本文基于 Heinrich &amp; Silver 的一篇科学论文，该论文介绍了第一种可扩展的端到端方法，用于在没有先验知识的情况下学习近似纳什均衡<strong class="lb iu"/>。</p><h2 id="76f2" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">重要提醒</h2><ul class=""><li id="49fd" class="mt mu it lb b lc mo lf mp li mv lm mw lq mx lu my mz na nb bi translated">虚拟游戏:是一种在两人零和游戏中寻找纳什均衡的迭代方法。它的问题是，它适用于标准形式的游戏，这是表格，不捕捉时间或顺序。详情可以在“<a class="ae ky" rel="noopener" target="_blank" href="/introduction-to-fictitious-play-12a8bc4ed1bb">虚拟玩法简介</a>”一文中找到。</li><li id="7c58" class="mt mu it lb b lc nc lf nd li ne lm nf lq ng lu my mz na nb bi translated">虚拟自我游戏:是一种利用扩展形式的游戏，通过整合时间/序列来解决虚拟游戏问题的方法。它还使用强化学习来寻找最佳反应的近似值，并使用监督学习来更新平均策略。证明了它能收敛到一个纳什均衡。更多详情请见文章"<a class="ae ky" rel="noopener" target="_blank" href="/fictitious-self-play-30b76e30ec6a">虚构的自我扮演</a>"</li></ul><h2 id="2037" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">不完美信息博弈</h2><p id="86a1" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">在不完全信息下，玩家根本不知道其他玩家选择的行动。然而，他们知道其他玩家是谁，他们可能的策略/行动是什么，以及这些其他玩家的偏好/收益。因此，在<strong class="lb iu">不完全信息中关于其他参与者的信息是完全的</strong>。</p><p id="4b94" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">另一方面，在不完全信息博弈中，参与者可能知道也可能不知道其他参与者的一些信息，例如他们的“类型”、策略、收益和偏好。</p><p id="d5de" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">国际象棋是一个拥有<strong class="lb iu">完全信息</strong>的游戏的例子，因为每个玩家可以随时看到棋盘上的所有棋子。其他完美信息博弈的例子包括井字游戏、跳棋、<a class="ae ky" href="https://en.wikipedia.org/wiki/Infinite_chess" rel="noopener ugc nofollow" target="_blank">无限象棋</a>和<a class="ae ky" href="https://en.wikipedia.org/wiki/Go_(game)" rel="noopener ugc nofollow" target="_blank">围棋</a>。</p><p id="2bcc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">纸牌游戏中，每个玩家的牌对其他玩家是隐藏的，例如扑克和桥牌，是<strong class="lb iu">不完全信息</strong>游戏的例子。</p><h2 id="65dd" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">储层取样</h2><p id="c726" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">储层采样是一种对长度为 N 的数据流进行采样的算法，使得选择数据项的概率为 1/N，即使 N 是未知的并且存储器大小是有限的并且小于 N，因此在采样之前不是所有的流数据都可以被缓冲。<br/>总之，该算法工作，例如对于第<strong class="lb iu"> <em class="nh">与第</em> </strong>项，我们旋转一个带有<strong class="lb iu"> <em class="nh"> i </em> </strong>槽的轮盘，该轮盘仅包含一个获胜槽。如果获胜的位置被选中，那么我们将从样本中提取该项目。可以证明这种方法对于每个要选择的项目都有 1/N 的概率。</p><h2 id="d1b1" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">预期动态</h2><p id="dbe3" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">预期动力学是一种能够使学习游戏动力学的稳定性发生质的变化的方法。在一般和多人游戏的情况下，这意味着收敛到混合策略纳什均衡。更多细节可以在“<a class="ae ky" href="http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.409.9085&amp;rep=rep1&amp;type=pdf" rel="noopener ugc nofollow" target="_blank">一般进化博弈中的预期学习</a>”一文中找到。</p><p id="46da" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这项技术背后的想法是将<strong class="lb iu">预期的</strong> <strong class="lb iu">修正</strong>引入到动作中。理解它最简单的方法，就是想象向一个移动的目标射击。你通过瞄准目标前方一段距离来修正你的射击。</p><p id="942c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">所以你引入了一个预期修正参数。在神经虚构自我发挥的情况下，这个参数是一个叫做“η”的概率。</p><h2 id="e33f" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">神经虚拟自我游戏</h2><p id="22a5" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">神经虚拟自我游戏(NFSP)将神经网络引入虚拟自我游戏。<br/>它使用两个独立的网络 Q(s，a | θ(Q))和π(s，a |θ(π))以及分别分配给它们的两个存储缓冲器 Mrl 和 Msl:</p><ul class=""><li id="9d64" class="mt mu it lb b lc ld lf lg li ni lm nj lq nk lu my mz na nb bi translated">Mrl 是一个循环缓冲区，以</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/761f94b6f6750cffa08b811ffda63e43.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DkKDX8vWlXkxr8fH3Xr0Dw.png"/></div></figure><ul class=""><li id="72ef" class="mt mu it lb b lc ld lf lg li ni lm nj lq nk lu my mz na nb bi translated">Msl 是一个以[s(t)，a(t)]状态和时间步长 t 的动作的形式存储最佳行为的库。</li><li id="7ff9" class="mt mu it lb b lc nc lf nd li ne lm nf lq ng lu my mz na nb bi translated">Q(s，a | θ(Q))是一个神经网络，使用非策略强化学习从 Mrl 中的数据预测动作值。这个网络近似于最佳反应策略，β = ε-greedy(Q)，以概率ε选择一个随机行动，以概率(1-ε)选择使 Q 值最大化的行动。</li><li id="d872" class="mt mu it lb b lc nc lf nd li ne lm nf lq ng lu my mz na nb bi translated">π(s，a |θ(π))，是一个将状态映射到动作概率的神经网络，定义了智能体的平均策略，π=π。换句话说，它试图从 Msl 中以前的最佳反应行为的历史中使用监督学习来再现最佳反应行为。</li></ul><p id="0b49" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">所以现在我们有两个神经网络来预测行为。<br/> Q(s，a | θ(Q))通过利用过去的经验，另π(s，a |θ(π))通过从最佳反应的历史中抽取。但是代理必须在每个回合使用一个动作，并且必须从这些网络中选择一个动作。<br/>原则上，代理应该使用 it is average 策略π，并使用 Q 生成最佳响应，该最佳响应将被馈入 Msl 以训练其平均策略网络π(s，a |θ(π))。<br/>然而有一个问题！Q 如何从自己的行动中产生经验？请记住，Q 生成β = ε-greedy(Q)并将其馈送给π(s，a |θ(π))，π将使用监督学习来训练其权重θ(π)。所以从π采样的动作不是β，这对于 Q 的体验来说是有问题的，因为它没有观察到其即时动作的结果。</p><p id="496d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">似乎解决这个问题的最佳方式是通过使用预期参数η，使得它以概率η使用ε-greedy(Q ),以概率(1-η)使用π。</p><p id="be66" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最终算法的主要步骤如下:</p><ul class=""><li id="fe14" class="mt mu it lb b lc ld lf lg li ni lm nj lq nk lu my mz na nb bi translated">定义策略σ，使得它是ε-贪婪的(Q)概率为η，π概率为(1-η)。</li><li id="d5ee" class="mt mu it lb b lc nc lf nd li ne lm nf lq ng lu my mz na nb bi translated">从σ <strong class="lb iu">，</strong>中获取动作，在游戏中执行，观察奖励 r(t+1)和下一个状态 s(t+1)以及 Mrl 中的转移[s(t)，a(t)，r(t+1)，s(t+1)]。</li><li id="c8a2" class="mt mu it lb b lc nc lf nd li ne lm nf lq ng lu my mz na nb bi translated">如果σ是ε-greedy(Q)，则存储[s(t)，a(t)]在 Msl 中。</li><li id="fa26" class="mt mu it lb b lc nc lf nd li ne lm nf lq ng lu my mz na nb bi translated">用 Msl 训练π(s，a |θ(π))</li><li id="8888" class="mt mu it lb b lc nc lf nd li ne lm nf lq ng lu my mz na nb bi translated">使用 Mrl 来训练 Q(s，a | θ(Q))</li><li id="46b8" class="mt mu it lb b lc nc lf nd li ne lm nf lq ng lu my mz na nb bi translated">定期更新目标网络权重θ(Q') ← θ(Q)</li></ul><p id="9f63" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">具体算法如下:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nm"><img src="../Images/ad123b2f53f8dd828bc0a105aaa837cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3Dgvif0CyeZ-aiIRaZ86_w.png"/></div></div></figure><h2 id="d1ea" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">结论</h2><p id="0bda" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">Heinrich &amp; Silver 认为，NFSP 是第一个端到端的深度强化学习方法，它从自我博弈中逼近不完全信息博弈的纳什均衡。NFSP 是可扩展的，不需要预先的领域知识。他们表明，在一个小型扑克游戏中，NFSP 可靠地收敛到近似纳什均衡，而 DQN 的贪婪和平均策略没有。NFSP 从零开始学习了一种策略，这种策略可以在现实世界规模的不完全信息游戏中与超人程序竞争，而无需使用明确的先验知识。</p><h2 id="02b5" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">参考</h2><p id="098b" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">Heinrich &amp; Silver 的《<a class="ae ky" href="https://arxiv.org/pdf/1603.01121.pdf" rel="noopener ugc nofollow" target="_blank">不完全信息博弈中自我博弈的深度强化学习</a>》。</p><p id="fd34" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.409.9085&amp;rep=rep1&amp;type=pdf" rel="noopener ugc nofollow" target="_blank">“一般进化游戏中的预期学习</a>”格达尔·阿尔斯兰和杰夫·s·莎玛</p><p id="97ac" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">“<a class="ae ky" href="https://en.wikipedia.org/wiki/Perfect_information" rel="noopener ugc nofollow" target="_blank">完美信息</a>”——维基百科</p><p id="c0c6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://en.wikipedia.org/wiki/Reservoir_sampling" rel="noopener ugc nofollow" target="_blank">油藏取样</a>——维基百科</p></div></div>    
</body>
</html>