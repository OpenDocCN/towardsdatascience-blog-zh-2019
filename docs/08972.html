<html>
<head>
<title>Build pipelines with Pandas using “pdpipe”</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用“pdpipe”与熊猫一起建造管道</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/https-medium-com-tirthajyoti-build-pipelines-with-pandas-using-pdpipe-cade6128cd31?source=collection_archive---------0-----------------------#2019-11-30">https://towardsdatascience.com/https-medium-com-tirthajyoti-build-pipelines-with-pandas-using-pdpipe-cade6128cd31?source=collection_archive---------0-----------------------#2019-11-30</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="3c66" class="pw-subtitle-paragraph jr is it bd b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki dk translated">我们展示了如何使用一个叫做 pdpipe 的奇妙的小库，用 Pandas DataFrame 构建直观而有用的管道。</h2></div><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi kj"><img src="../Images/7711e0089c22423ce86c20d83fcf5043.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4dB1ECCAp5YBGSX1emGfIQ.png"/></div></div></figure><h1 id="cd50" class="kv kw it bd kx ky kz la lb lc ld le lf ka lg kb lh kd li ke lj kg lk kh ll lm bi translated">介绍</h1><p id="c74f" class="pw-post-body-paragraph ln lo it lp b lq lr jv ls lt lu jy lv lw lx ly lz ma mb mc md me mf mg mh mi im bi translated">Pandas 是 Python 生态系统中一个了不起的库，用于数据分析和机器学习。它们在 Excel/CSV 文件和 SQL 表所在的数据世界和 Scikit-learn 或 TensorFlow 施展魔法的建模世界之间形成了完美的桥梁。</p><p id="3e2d" class="pw-post-body-paragraph ln lo it lp b lq mj jv ls lt mk jy lv lw ml ly lz ma mm mc md me mn mg mh mi im bi translated">数据科学流程通常是一系列步骤，数据集必须经过清理、缩放和验证，才能供强大的机器学习算法使用。</p><p id="f951" class="pw-post-body-paragraph ln lo it lp b lq mj jv ls lt mk jy lv lw ml ly lz ma mm mc md me mn mg mh mi im bi translated">当然，这些任务可以通过 Pandas 等软件包提供的许多单步函数/方法来完成，但更好的方式是使用管道。几乎在所有情况下，流水线通过自动化重复的任务减少了出错的机会并节省了时间。</p><p id="09e7" class="pw-post-body-paragraph ln lo it lp b lq mj jv ls lt mk jy lv lw ml ly lz ma mm mc md me mn mg mh mi im bi translated">在数据科学领域，具有管道特性的包的很好的例子是——R 语言的<a class="ae mo" href="https://dplyr.tidyverse.org/" rel="noopener ugc nofollow" target="_blank">DP lyr</a>和 Python 生态系统的<a class="ae mo" href="https://scikit-learn.org/stable/modules/compose.html" rel="noopener ugc nofollow" target="_blank">Scikit-learn</a>。</p><blockquote class="mp"><p id="6863" class="mq mr it bd ms mt mu mv mw mx my mi dk translated">数据科学流程通常是一系列步骤，数据集必须经过清理、缩放和验证才能投入使用</p></blockquote><p id="e4a8" class="pw-post-body-paragraph ln lo it lp b lq mz jv ls lt na jy lv lw nb ly lz ma nc mc md me nd mg mh mi im bi translated">下面是一篇关于它们在机器学习工作流中的使用的精彩文章。</p><div class="ne nf gp gr ng nh"><a href="https://www.kdnuggets.com/2017/12/managing-machine-learning-workflows-scikit-learn-pipelines-part-1.html" rel="noopener  ugc nofollow" target="_blank"><div class="ni ab fo"><div class="nj ab nk cl cj nl"><h2 class="bd iu gy z fp nm fr fs nn fu fw is bi translated">用 Scikit-learn 管道管理机器学习工作流第 1 部分:简介…</h2><div class="no l"><h3 class="bd b gy z fp nm fr fs nn fu fw dk translated">你熟悉 Scikit-learn 管道吗？它们是管理机器的一个非常简单但非常有用的工具…</h3></div><div class="np l"><p class="bd b dl z fp nm fr fs nn fu fw dk translated">www.kdnuggets.com</p></div></div><div class="nq l"><div class="nr l ns nt nu nq nv kt nh"/></div></div></a></div><p id="5293" class="pw-post-body-paragraph ln lo it lp b lq mj jv ls lt mk jy lv lw ml ly lz ma mm mc md me mn mg mh mi im bi translated">Pandas 还提供了一个<code class="fe nw nx ny nz b"><strong class="lp iu">.pipe</strong></code>方法，可用于类似的用户自定义函数。然而，在本文中，我们将讨论一个名为<a class="ae mo" href="https://github.com/shaypal5/pdpipe" rel="noopener ugc nofollow" target="_blank"> <strong class="lp iu"> pdpipe </strong> </a>的奇妙的小库，它专门解决了 Pandas DataFrame 的流水线问题。</p><blockquote class="mp"><p id="18ff" class="mq mr it bd ms mt mu mv mw mx my mi dk translated">几乎在所有情况下，流水线通过自动化重复的任务减少了出错的机会并节省了时间</p></blockquote><h1 id="0a2c" class="kv kw it bd kx ky kz la lb lc ld le lf ka oa kb lh kd ob ke lj kg oc kh ll lm bi translated">熊猫流水线</h1><p id="2fd2" class="pw-post-body-paragraph ln lo it lp b lq lr jv ls lt lu jy lv lw lx ly lz ma mb mc md me mf mg mh mi im bi translated">Jupyter 笔记本的例子可以在我的 Github repo 中找到。让我们看看如何用这个库构建有用的管道。</p><h2 id="4036" class="od kw it bd kx oe of dn lb og oh dp lf lw oi oj lh ma ok ol lj me om on ll oo bi translated">数据集</h2><p id="f25e" class="pw-post-body-paragraph ln lo it lp b lq lr jv ls lt lu jy lv lw lx ly lz ma mb mc md me mf mg mh mi im bi translated">出于演示的目的，我们将使用美国房价的数据集(从 Kaggle 下载)。我们可以在 Pandas 中加载数据集，并显示其汇总统计信息，如下所示:</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi op"><img src="../Images/853af22e4756366d94c22e0b2301ba17.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UzIEuLe3fhTV2bSmdNk4FA.png"/></div></div></figure><p id="e9e3" class="pw-post-body-paragraph ln lo it lp b lq mj jv ls lt mk jy lv lw ml ly lz ma mm mc md me mn mg mh mi im bi translated">但是，数据集还有一个包含文本数据的“地址”字段。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi oq"><img src="../Images/492fd0e8747c646f030f39f7c8984550.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TfWGiDBoFmxpGbiP3rQmug.png"/></div></div></figure><h2 id="827c" class="od kw it bd kx oe of dn lb og oh dp lf lw oi oj lh ma ok ol lj me om on ll oo bi translated">添加大小限定符列</h2><p id="3919" class="pw-post-body-paragraph ln lo it lp b lq lr jv ls lt lu jy lv lw lx ly lz ma mb mc md me mf mg mh mi im bi translated">对于这个演示，我们用下面的代码向数据集添加一列来限定房子的大小，</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div class="gh gi or"><img src="../Images/3ff707c0352427d8944d3d07a5e34687.png" data-original-src="https://miro.medium.com/v2/resize:fit:1342/format:webp/1*UaNJZh2sP-Ff7jbqgbSVqw.png"/></div></figure><p id="063e" class="pw-post-body-paragraph ln lo it lp b lq mj jv ls lt mk jy lv lw ml ly lz ma mm mc md me mn mg mh mi im bi translated">数据集看起来像这样，</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi os"><img src="../Images/3efe802ea3a33867352254aa3c289457.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7-a0rmpVN3XdG9lxCqN1RA.png"/></div></div></figure><h2 id="b464" class="od kw it bd kx oe of dn lb og oh dp lf lw oi oj lh ma ok ol lj me om on ll oo bi translated">最简单的流水线—一个操作</h2><p id="ab11" class="pw-post-body-paragraph ln lo it lp b lq lr jv ls lt lu jy lv lw lx ly lz ma mb mc md me mf mg mh mi im bi translated">我们从最简单的管道开始，只包含一个操作(不要担心，我们很快就会增加复杂性)。</p><p id="3471" class="pw-post-body-paragraph ln lo it lp b lq mj jv ls lt mk jy lv lw ml ly lz ma mm mc md me mn mg mh mi im bi translated">假设机器学习团队和领域专家说，他们认为我们可以安全地忽略<code class="fe nw nx ny nz b">Avg. Area House Age</code>数据进行建模。因此，我们将从数据集中删除该列。</p><p id="d053" class="pw-post-body-paragraph ln lo it lp b lq mj jv ls lt mk jy lv lw ml ly lz ma mm mc md me mn mg mh mi im bi translated">对于这个任务，我们使用<a class="ae mo" href="https://github.com/shaypal5/pdpipe" rel="noopener ugc nofollow" target="_blank"> <strong class="lp iu"> pdpipe </strong> </a>中的<code class="fe nw nx ny nz b">ColDrop</code>方法创建一个管道对象<code class="fe nw nx ny nz b">drop_age</code>，并将数据帧传递给这个管道。</p><pre class="kk kl km kn gt ot nz ou ov aw ow bi"><span id="bb05" class="od kw it nz b gy ox oy l oz pa">import pdpipe as pdp<br/>drop_age = pdp.ColDrop(‘Avg. Area House Age’)<br/>df2 = drop_age(df)</span></pre><p id="3ad7" class="pw-post-body-paragraph ln lo it lp b lq mj jv ls lt mk jy lv lw ml ly lz ma mm mc md me mn mg mh mi im bi translated">如预期的那样，产生的数据帧如下所示:</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi pb"><img src="../Images/97d9248f0f807f6d60fa00a132b5a5ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xHCMfxDD5dyn24ibRMx1Wg.png"/></div></div></figure><h2 id="ae24" class="od kw it bd kx oe of dn lb og oh dp lf lw oi oj lh ma ok ol lj me om on ll oo bi translated">简单地通过添加</h2><p id="9904" class="pw-post-body-paragraph ln lo it lp b lq lr jv ls lt lu jy lv lw lx ly lz ma mb mc md me mf mg mh mi im bi translated">只有当我们能够拥有多个阶段时，管道才是有用和实用的。在<a class="ae mo" href="https://github.com/shaypal5/pdpipe" rel="noopener ugc nofollow" target="_blank"> <strong class="lp iu"> pdpipe </strong> </a>中有多种方法可以做到这一点。然而，最简单、最直观的方法是使用+运算符。这就像手工连接管道一样！</p><p id="9ceb" class="pw-post-body-paragraph ln lo it lp b lq mj jv ls lt mk jy lv lw ml ly lz ma mm mc md me mn mg mh mi im bi translated">比方说，除了删除年龄列，我们还想对<code class="fe nw nx ny nz b">House_size</code>列进行一次热编码，以便可以轻松地对数据集运行分类或回归算法。</p><pre class="kk kl km kn gt ot nz ou ov aw ow bi"><span id="ec2f" class="od kw it nz b gy ox oy l oz pa">pipeline = pdp.ColDrop(‘Avg. Area House Age’)<br/>pipeline+= pdp.OneHotEncode(‘House_size’)<br/>df3 = pipeline(df)</span></pre><p id="1fd5" class="pw-post-body-paragraph ln lo it lp b lq mj jv ls lt mk jy lv lw ml ly lz ma mm mc md me mn mg mh mi im bi translated">因此，我们首先用<code class="fe nw nx ny nz b">ColDrop</code>方法创建了一个管道对象来删除<code class="fe nw nx ny nz b">Avg. Area House Age</code>列。此后，我们只是用通常的 Python <code class="fe nw nx ny nz b">+=</code>语法将<code class="fe nw nx ny nz b">OneHotEncode</code>方法添加到这个管道对象中。</p><p id="19a6" class="pw-post-body-paragraph ln lo it lp b lq mj jv ls lt mk jy lv lw ml ly lz ma mm mc md me mn mg mh mi im bi translated">生成的数据帧如下所示。注意从一次热编码过程中创建的附加指示器列<code class="fe nw nx ny nz b">House_size_Medium</code>和<code class="fe nw nx ny nz b">House_size_Small</code>。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi pc"><img src="../Images/6546da489470decd2d899b62e8785942.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*24OhaaJQx20GELceIR64uA.png"/></div></div></figure><h2 id="106a" class="od kw it bd kx oe of dn lb og oh dp lf lw oi oj lh ma ok ol lj me om on ll oo bi translated">根据行的值删除一些行</h2><p id="90a0" class="pw-post-body-paragraph ln lo it lp b lq lr jv ls lt lu jy lv lw lx ly lz ma mb mc md me mf mg mh mi im bi translated">接下来，我们可能希望根据数据的值删除数据行。具体来说，我们可能希望删除所有房价低于 25 万的数据。我们使用了<code class="fe nw nx ny nz b">ApplybyCol</code>方法将任何用户定义的函数应用于数据帧，还使用了<code class="fe nw nx ny nz b">ValDrop</code>方法根据特定值删除行。我们可以很容易地将这些方法链接到我们的管道中，以选择性地删除行(我们仍在添加现有的<code class="fe nw nx ny nz b">pipeline</code>对象，该对象已经完成了列删除和一次热编码的其他工作)。</p><pre class="kk kl km kn gt ot nz ou ov aw ow bi"><span id="05d5" class="od kw it nz b gy ox oy l oz pa">def price_tag(x):<br/>    if x&gt;250000:<br/>        return 'keep'<br/>    else:<br/>        return 'drop'</span><span id="0662" class="od kw it nz b gy pd oy l oz pa">pipeline+=pdp.ApplyByCols('Price',price_tag,'Price_tag',drop=False)<br/>pipeline+=pdp.ValDrop(['drop'],'Price_tag')<br/>pipeline+= pdp.ColDrop('Price_tag')</span></pre><p id="ee75" class="pw-post-body-paragraph ln lo it lp b lq mj jv ls lt mk jy lv lw ml ly lz ma mm mc md me mn mg mh mi im bi translated">第一种方法通过应用用户定义的函数<code class="fe nw nx ny nz b">price_tag()</code>，基于<code class="fe nw nx ny nz b">Price</code>列中的值标记行，</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi pe"><img src="../Images/d5ae7526b89011831f463b7e45680c1a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EZZlpJ-d66NwahMf63JV5A.png"/></div></div></figure><p id="2d24" class="pw-post-body-paragraph ln lo it lp b lq mj jv ls lt mk jy lv lw ml ly lz ma mm mc md me mn mg mh mi im bi translated">第二种方法在<code class="fe nw nx ny nz b">Price_tag</code>列中查找字符串<code class="fe nw nx ny nz b">drop</code>，并删除匹配的行。最后，第三种方法删除<code class="fe nw nx ny nz b">Price_tag</code>列，清理数据帧。毕竟，这个<code class="fe nw nx ny nz b">Price_tag</code>列只是临时需要的，用来标记特定的行，应该在它达到目的后被删除。</p><p id="f4e2" class="pw-post-body-paragraph ln lo it lp b lq mj jv ls lt mk jy lv lw ml ly lz ma mm mc md me mn mg mh mi im bi translated">所有这些都是通过在同一管道上简单地链接操作阶段来完成的！</p><p id="4ce1" class="pw-post-body-paragraph ln lo it lp b lq mj jv ls lt mk jy lv lw ml ly lz ma mm mc md me mn mg mh mi im bi translated">此时，我们可以回顾一下，看看我们的管道从一开始对数据帧做了什么，</p><ul class=""><li id="821a" class="pf pg it lp b lq mj lt mk lw ph ma pi me pj mi pk pl pm pn bi translated">删除特定列</li><li id="b03b" class="pf pg it lp b lq po lt pp lw pq ma pr me ps mi pk pl pm pn bi translated">one-hot-编码用于建模的分类数据列</li><li id="63b9" class="pf pg it lp b lq po lt pp lw pq ma pr me ps mi pk pl pm pn bi translated">基于用户定义的函数标记数据</li><li id="5d61" class="pf pg it lp b lq po lt pp lw pq ma pr me ps mi pk pl pm pn bi translated">基于标记删除行</li><li id="929a" class="pf pg it lp b lq po lt pp lw pq ma pr me ps mi pk pl pm pn bi translated">删除临时标记列</li></ul><p id="9268" class="pw-post-body-paragraph ln lo it lp b lq mj jv ls lt mk jy lv lw ml ly lz ma mm mc md me mn mg mh mi im bi translated">所有这些——使用下面五行代码，</p><pre class="kk kl km kn gt ot nz ou ov aw ow bi"><span id="2c68" class="od kw it nz b gy ox oy l oz pa">pipeline = pdp.ColDrop('Avg. Area House Age')<br/>pipeline+= pdp.OneHotEncode('House_size')<br/>pipeline+=pdp.ApplyByCols('Price',price_tag,'Price_tag',drop=False)<br/>pipeline+=pdp.ValDrop(['drop'],'Price_tag')<br/>pipeline+= pdp.ColDrop('Price_tag')</span><span id="0cc8" class="od kw it nz b gy pd oy l oz pa">df5 = pipeline(df)</span></pre><h2 id="6930" class="od kw it bd kx oe of dn lb og oh dp lf lw oi oj lh ma ok ol lj me om on ll oo bi translated">最新版本更新:直接降行！</h2><p id="b589" class="pw-post-body-paragraph ln lo it lp b lq lr jv ls lt lu jy lv lw lx ly lz ma mb mc md me mf mg mh mi im bi translated">我与这个包的作者进行了一次精彩的讨论，他告诉我这个包的最新版本可以使用 lambda 函数用一行代码完成 row 的删除(满足给定的条件)。</p><pre class="kk kl km kn gt ot nz ou ov aw ow bi"><span id="20b0" class="od kw it nz b gy ox oy l oz pa">pdp.RowDrop({‘Price’: lambda x: x &lt;= 250000})</span></pre><h1 id="4619" class="kv kw it bd kx ky kz la lb lc ld le lf ka lg kb lh kd li ke lj kg lk kh ll lm bi translated">sci kit-学习和 NLTK 阶段</h1><p id="700e" class="pw-post-body-paragraph ln lo it lp b lq lr jv ls lt lu jy lv lw lx ly lz ma mb mc md me mf mg mh mi im bi translated">有许多更有用和直观的数据帧操作方法可用于数据帧操作。然而，我们只是想表明，即使是 Scikit-learn 和 NLTK 包中的一些操作也包含在<a class="ae mo" href="https://github.com/shaypal5/pdpipe" rel="noopener ugc nofollow" target="_blank"> <strong class="lp iu"> pdpipe </strong> </a>中，以创建令人敬畏的管道。</p><h2 id="9336" class="od kw it bd kx oe of dn lb og oh dp lf lw oi oj lh ma ok ol lj me om on ll oo bi translated">Scikit-learn 的比例估算器</h2><p id="3704" class="pw-post-body-paragraph ln lo it lp b lq lr jv ls lt lu jy lv lw lx ly lz ma mb mc md me mf mg mh mi im bi translated">构建机器学习模型最常见的任务之一是数据的缩放。Scikit-learn 提供了一些不同类型的缩放，如最小-最大缩放或基于标准化的缩放(减去数据集的平均值，然后除以标准偏差)。</p><p id="a919" class="pw-post-body-paragraph ln lo it lp b lq mj jv ls lt mk jy lv lw ml ly lz ma mm mc md me mn mg mh mi im bi translated">我们可以在管道中直接链接这样的缩放操作。下面的代码演示了如何使用，</p><pre class="kk kl km kn gt ot nz ou ov aw ow bi"><span id="86b8" class="od kw it nz b gy ox oy l oz pa">pipeline_scale = pdp.Scale('StandardScaler',exclude_columns=['House_size_Medium','House_size_Small'])</span><span id="b3ca" class="od kw it nz b gy pd oy l oz pa">df6 = pipeline_scale(df5)</span></pre><p id="8531" class="pw-post-body-paragraph ln lo it lp b lq mj jv ls lt mk jy lv lw ml ly lz ma mm mc md me mn mg mh mi im bi translated">这里，我们应用了 Scikit-learn 包中的<code class="fe nw nx ny nz b"><a class="ae mo" href="https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.StandardScaler.html" rel="noopener ugc nofollow" target="_blank">StandardScaler</a></code> <a class="ae mo" href="https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.StandardScaler.html" rel="noopener ugc nofollow" target="_blank">估计器</a>来转换数据，以便进行聚类或神经网络拟合。我们可以有选择地排除不需要这种缩放的列，就像我们在这里对指示器列<code class="fe nw nx ny nz b">House_size_Medium</code>和<code class="fe nw nx ny nz b">House_size_Small</code>所做的那样。</p><p id="a085" class="pw-post-body-paragraph ln lo it lp b lq mj jv ls lt mk jy lv lw ml ly lz ma mm mc md me mn mg mh mi im bi translated">瞧啊。我们得到缩放的数据帧，</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi pv"><img src="../Images/03e584b1c9833f8583eb75e02e82aabf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0JNku5lWL9yE8hHDEgWgMw.png"/></div></div></figure><h2 id="1af7" class="od kw it bd kx oe of dn lb og oh dp lf lw oi oj lh ma ok ol lj me om on ll oo bi translated">NLTK 的标记器</h2><p id="7e84" class="pw-post-body-paragraph ln lo it lp b lq lr jv ls lt lu jy lv lw lx ly lz ma mb mc md me mf mg mh mi im bi translated">我们注意到，数据帧中的地址字段现在几乎没有用。然而，如果我们可以从这些字符串中提取邮政编码或州名，它们可能对某种可视化或机器学习任务有用。</p><p id="1b60" class="pw-post-body-paragraph ln lo it lp b lq mj jv ls lt mk jy lv lw ml ly lz ma mm mc md me mn mg mh mi im bi translated">为此，我们可以使用一个<a class="ae mo" href="https://www.guru99.com/tokenize-words-sentences-nltk.html" rel="noopener ugc nofollow" target="_blank">单词分词器</a>。NLTK 是一个用于文本挖掘和自然语言处理(NLP)的流行而强大的 Python 库，并提供了一系列标记化方法。这里，我们可以使用一个这样的标记器来分割地址字段中的文本，并从中提取州名。我们知道州名是地址串中的倒数第二个单词。因此，遵循链式管道将为我们完成这项工作，</p><pre class="kk kl km kn gt ot nz ou ov aw ow bi"><span id="c493" class="od kw it nz b gy ox oy l oz pa">def extract_state(token):<br/>    return str(token[-2])</span><span id="cf07" class="od kw it nz b gy pd oy l oz pa">pipeline_tokenize=pdp.TokenizeWords('Address')</span><span id="5976" class="od kw it nz b gy pd oy l oz pa">pipeline_state = pdp.ApplyByCols('Address',extract_state,<br/>result_columns='State')</span><span id="8940" class="od kw it nz b gy pd oy l oz pa">pipeline_state_extract = pipeline_tokenize + pipeline_state</span><span id="7b8c" class="od kw it nz b gy pd oy l oz pa">df7 = pipeline_state_extract(df6)</span></pre><p id="a5dd" class="pw-post-body-paragraph ln lo it lp b lq mj jv ls lt mk jy lv lw ml ly lz ma mm mc md me mn mg mh mi im bi translated">产生的数据帧如下所示:</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi pw"><img src="../Images/2846e9c9c6d3e65380e93fee6968e12b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oCkF8yePZfJS_wqge6u3Tg.png"/></div></div></figure><h1 id="b066" class="kv kw it bd kx ky kz la lb lc ld le lf ka lg kb lh kd li ke lj kg lk kh ll lm bi translated">摘要</h1><p id="b71c" class="pw-post-body-paragraph ln lo it lp b lq lr jv ls lt lu jy lv lw lx ly lz ma mb mc md me mf mg mh mi im bi translated">如果我们总结一下本演示中显示的所有操作，看起来如下所示:</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi px"><img src="../Images/ceb22771a13c6898b08db3c8f552660e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RhPa4Uy8UJAsx_no4QsE3w.png"/></div></div></figure><p id="e5b8" class="pw-post-body-paragraph ln lo it lp b lq mj jv ls lt mk jy lv lw ml ly lz ma mm mc md me mn mg mh mi im bi translated">所有这些操作都可能在相似类型的数据集上频繁使用，在数据集准备好进行下一级建模之前，有一组简单的顺序代码块作为预处理操作来执行将是非常好的。</p><p id="d547" class="pw-post-body-paragraph ln lo it lp b lq mj jv ls lt mk jy lv lw ml ly lz ma mm mc md me mn mg mh mi im bi translated">流水线是实现统一的顺序代码块集的关键。Pandas 是在机器学习/数据科学团队中使用最广泛的用于此类数据预处理任务的 Python 库，而<a class="ae mo" href="https://github.com/shaypal5/pdpipe" rel="noopener ugc nofollow" target="_blank"> <strong class="lp iu"> pdpipe </strong> </a>提供了一种简单而强大的方法来构建具有 Pandas 类型操作的管道，这些操作可以直接应用于 Pandas DataFrame 对象。</p><p id="1160" class="pw-post-body-paragraph ln lo it lp b lq mj jv ls lt mk jy lv lw ml ly lz ma mm mc md me mn mg mh mi im bi translated"><a class="ae mo" href="https://github.com/shaypal5/pdpipe" rel="noopener ugc nofollow" target="_blank">自己探索这个库</a>并为您的特定数据科学任务构建更强大的管道。</p></div><div class="ab cl py pz hx qa" role="separator"><span class="qb bw bk qc qd qe"/><span class="qb bw bk qc qd qe"/><span class="qb bw bk qc qd"/></div><div class="im in io ip iq"><p id="96d4" class="pw-post-body-paragraph ln lo it lp b lq mj jv ls lt mk jy lv lw ml ly lz ma mm mc md me mn mg mh mi im bi translated">喜欢这篇文章吗？成为 <a class="ae mo" href="https://medium.com/@tirthajyoti/membership" rel="noopener"> <strong class="lp iu"> <em class="qf">中等会员</em> </strong> </a> <em class="qf">继续</em> <strong class="lp iu"> <em class="qf">无限制学习</em> </strong> <em class="qf">。如果您使用下面的链接，</em> <strong class="lp iu"> <em class="qf">，我将收取您的一部分会员费，而不会对您产生额外费用</em> </strong> <em class="qf">。</em></p><div class="ne nf gp gr ng nh"><a href="https://medium.com/@tirthajyoti/membership" rel="noopener follow" target="_blank"><div class="ni ab fo"><div class="nj ab nk cl cj nl"><h2 class="bd iu gy z fp nm fr fs nn fu fw is bi translated">通过我的推荐链接加入 Medium—Tirthajyoti Sarkar</h2><div class="no l"><h3 class="bd b gy z fp nm fr fs nn fu fw dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="np l"><p class="bd b dl z fp nm fr fs nn fu fw dk translated">medium.com</p></div></div><div class="nq l"><div class="qg l ns nt nu nq nv kt nh"/></div></div></a></div></div></div>    
</body>
</html>