<html>
<head>
<title>Building a Functional Chatbot on Dialogflow</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在 Dialogflow 上构建功能聊天机器人</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/building-a-functional-chatbot-in-dialogflow-aeeba1260353?source=collection_archive---------14-----------------------#2019-07-24">https://towardsdatascience.com/building-a-functional-chatbot-in-dialogflow-aeeba1260353?source=collection_archive---------14-----------------------#2019-07-24</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="1d2e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">虽然 Dialogflow 被广泛认为是一个直观和简单的平台，但它的一些功能可能有点晦涩，我认为任何初学者都可以从迷你指南中受益。这篇博文旨在涵盖与 Dialogflow 相关的许多基本概念和词汇，但是因为这些 NLP 平台之间有许多重叠，所以这里讨论的许多概念也可以应用于其他地方。</p><p id="0dd7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">就像任何其他项目一样，在开始构建聊天机器人之前有一个思维图总是好的。这将有助于确定你需要多少意图、跟进意图和背景。但是等等…什么是意图？</p><h1 id="3974" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">意图</h1><p id="515b" class="pw-post-body-paragraph jn jo iq jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ij bi translated">意图基本上是对话流的核心和灵魂。它们旨在捕捉用户的意图，并触发聊天机器人内部的响应。换句话说，意图捕获用户的意图，对其进行处理，并将其映射到特定的响应。例如，如果用户说“我附近的咖啡店”，一个名为“咖啡店”的假设意图将被触发并响应用户的请求。</p><p id="99ef" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你的聊天机器人最终会有几个意图来处理用户和聊天机器人之间对话的所有场景。</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi lo"><img src="../Images/af62eb848d1cd66a2c764be42a2e402b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lxkizxYAQHE5e6jRz-Q33Q.png"/></div></div></figure><h2 id="7632" class="ma km iq bd kn mb mc dn kr md me dp kv jy mf mg kz kc mh mi ld kg mj mk lh ml bi translated">训练短语</h2><p id="3270" class="pw-post-body-paragraph jn jo iq jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ij bi translated">训练短语是用户说出来触发特定意图的短语。使用上面的同一个咖啡店示例，用户可以通过多种方式要咖啡。</p><ol class=""><li id="ac45" class="mm mn iq jp b jq jr ju jv jy mo kc mp kg mq kk mr ms mt mu bi translated">我附近的咖啡店</li><li id="4f65" class="mm mn iq jp b jq mv ju mw jy mx kc my kg mz kk mr ms mt mu bi translated">我现在真的很想喝杯咖啡</li><li id="2bc5" class="mm mn iq jp b jq mv ju mw jy mx kc my kg mz kk mr ms mt mu bi translated">最近的星巴克或李丁丁在哪里？</li><li id="3a5f" class="mm mn iq jp b jq mv ju mw jy mx kc my kg mz kk mr ms mt mu bi translated">我附近有咖啡馆吗？</li></ol><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi na"><img src="../Images/8d4ff047df69df4ae10c3ff8c24b0601.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7Pi8S0lxSzzpHchH3yo0Ag.png"/></div></div></figure><p id="c035" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">显然，要想出一份详尽的清单列出所有说“我想要咖啡”的可能方式是不可能的。然而，训练短语的妙处在于你不需要提供一个详尽的列表。相当数量的表达相同意图的相似短语足以让自然语言理解引擎将任何输入映射到特定意图</p><h1 id="8fbc" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">实体</h1><p id="6a4c" class="pw-post-body-paragraph jn jo iq jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ij bi translated">意图允许聊天机器人理解用户的意图，而实体则用于从自然语言输入中提取信息。从日期和时间到对象的价格，您想要从用户输入中提取的任何数据都有相应的实体。</p><p id="370a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Dialogflow 有一个预定义的实体列表，称为系统实体；它们包括基本值，如日期、时间、位置、单位等..回到咖啡店的例子，假设我们想在下午 4 点去喝咖啡</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi nc"><img src="../Images/f1dcb9b2076a95145d1761dd2d0bc8b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-6yHBSHfHm4Cyafleo7asw.png"/></div></div></figure><p id="9d86" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我使用了 sys.time 实体，并提取了训练短语中的时间。现在，聊天机器人将寻找这个实体，并试图在用户的输入中提取它。</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/dd5667e03b2919704f62b21102c8a4e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:686/format:webp/1*2YE-v74kXxTTYxEjECTMzw.png"/></div></figure><p id="8d3c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当我测试聊天机器人时，它能够识别并提取上午 10 点的时间值。查看图像底部的时间参数。</p><h1 id="348f" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">反应</h1><p id="1042" class="pw-post-body-paragraph jn jo iq jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ij bi translated">这是 Dialgflow 更容易和更直观的特性之一。每当用户说些什么，一个意图就会被触发，聊天机器人必须用适当的信息来回应——就像它在正常对话中的工作方式一样。</p><p id="1408" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">顾名思义，响应部分就是为了这个目的。response 部分很酷的一点是，您可以重复从用户输入中提取的实体值</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/8609e544c9f154cb3cc699343a5183c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:680/format:webp/1*C9WHBFx045yVJtCh36tnFQ.png"/></div></figure><p id="ad28" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如您所见，我从用户输入中提取了时间，并将其作为确认包含在响应中。</p><h1 id="a9ea" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">上下文</h1><p id="7664" class="pw-post-body-paragraph jn jo iq jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ij bi translated">上下文表示用户请求的当前状态；可以把它们看作是用户在对话结构中所处位置的虚拟检查点。此外，上下文还确保会话以串行方式流动(可以说，不能从检查点 A 跳到检查点 D)。</p><p id="33fe" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">有两种上下文:</p><h2 id="d9ec" class="ma km iq bd kn mb mc dn kr md me dp kv jy mf mg kz kc mh mi ld kg mj mk lh ml bi translated">输出上下文</h2><p id="1a1e" class="pw-post-body-paragraph jn jo iq jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ij bi translated">每当用户有特定意图时，就会创建输出上下文。从更专业的角度来说，可以将输出上下文视为任何特定意图的布尔属性。每当用户有任何特定意图时，输出上下文返回 true 并保持活动状态，直到用户触发另一个意图；然后，另一个意图的输出上下文变为活动的。</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi nf"><img src="../Images/4263a0334ee44819b44668da0c96063f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iEP4Un0l3kZJ2OJssYbPKg.png"/></div></div></figure><h2 id="1e95" class="ma km iq bd kn mb mc dn kr md me dp kv jy mf mg kz kc mh mi ld kg mj mk lh ml bi translated"><strong class="ak">输入上下文</strong></h2><p id="8356" class="pw-post-body-paragraph jn jo iq jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ij bi translated">输入上下文是防止其他不需要的意图被触发的东西。我喜欢把输入上下文想象成“如果”条件。只有当 xyz 上下文处于活动状态时，才会触发 xyz 意图。当用户询问后续问题时，这尤其有用。例如，如果我想预约医生，我会先说“我想预约”，然后再提任何关于我喜欢的时间或日期的事情。时间和日期只有在我表示希望预约时才是相关的。在这种情况下，医生预约意图的输出上下文成为后续意图的输入上下文:日期和时间。</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi ng"><img src="../Images/c9d671e426f78d9102f2fe0e38603899.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uWbaPQMI6o7FuYjesip5sQ.png"/></div></div></figure><h1 id="9f23" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">后续意图</h1><p id="c8e1" class="pw-post-body-paragraph jn jo iq jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ij bi translated">跟进意图是对话流程的关键部分——你会比你想象的更需要它们！几乎每个意向都有后续意向；无论是简单的“是”或“否”响应，还是更具体的请求，如日期或时间偏好。</p><p id="5fbf" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果你对输入和输出环境的工作原理有一个坚实的理解，那么后续的意图应该是轻而易举的。</p><h1 id="67c7" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">更多资源</h1><p id="1549" class="pw-post-body-paragraph jn jo iq jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ij bi translated">我希望这有所帮助；上面讨论的概念应该给你足够的背景知识来在 Dialogflow 上构建一个简单的聊天机器人。</p><p id="ee44" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果你想更了解它，查看文档【https://cloud.google.com/dialogflow/docs/concepts T2】</p><p id="d08f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">请继续关注集成、履行和分析等后端技术！</strong></p></div></div>    
</body>
</html>