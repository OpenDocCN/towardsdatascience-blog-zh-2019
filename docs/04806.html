<html>
<head>
<title>How to Quickly Compare Data Sets</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何快速比较数据集</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-quickly-compare-data-sets-76a694f6868a?source=collection_archive---------5-----------------------#2019-07-21">https://towardsdatascience.com/how-to-quickly-compare-data-sets-76a694f6868a?source=collection_archive---------5-----------------------#2019-07-21</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="bbd4" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">如何快速总结两个数据集之间的差异</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/a0a26dd1ab152868d83118e12252699c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*prQvtC4iO_wdDLZh"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Photo by <a class="ae ky" href="https://unsplash.com/@sortino?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Joshua Sortino</a> on <a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="682d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">时不时地，你会需要比较两个数据集；要么证明没有区别，要么强调它们之间的确切区别。根据数据的大小，您可能有许多选择。</p><p id="3ee9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在我的上一篇文章中，<em class="lv">用 Python 比较数据的 3 种快速方法，</em>我们讨论了许多比较数据的方法。然而，我们讨论的选项都不能给你一个快速、详细的摘要，或者让你适应数据集之间的微小差异。</p><div class="lw lx gp gr ly lz"><a href="https://medium.com/financeexplained/3-quick-ways-to-compare-data-in-python-65201be10b6" rel="noopener follow" target="_blank"><div class="ma ab fo"><div class="mb ab mc cl cj md"><h2 class="bd iu gy z fp me fr fs mf fu fw is bi translated">在 Python 中比较数据的 3 种快速方法</h2><div class="mg l"><h3 class="bd b gy z fp me fr fs mf fu fw dk translated">对于任何从事分析工作的人来说，收到比较数据的请求都太熟悉了。不管那是…</h3></div><div class="mh l"><p class="bd b dl z fp me fr fs mf fu fw dk translated">medium.com</p></div></div><div class="mi l"><div class="mj l mk ml mm mi mn ks lz"/></div></div></a></div><p id="1c40" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这篇文章中，我想给你提供另一种选择；我相信这将会非常有帮助。这一次，我想让您注意 DataComPy python 库。</p><h1 id="4158" class="mo mp it bd mq mr ms mt mu mv mw mx my jz mz ka na kc nb kd nc kf nd kg ne nf bi translated">什么是 DataComPy 库？</h1><p id="7539" class="pw-post-body-paragraph kz la it lb b lc ng ju le lf nh jx lh li ni lk ll lm nj lo lp lq nk ls lt lu im bi translated">正如他们的 GitHub 页面上所强调的，DataComPy 库是一个用来比较两个熊猫数据帧并提供描述差异的人类可读输出的包。</p><p id="9a7a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">示例输出如下所示:</p><pre class="kj kk kl km gt nl nm nn no aw np bi"><span id="f739" class="nq mp it nm b gy nr ns l nt nu">DataComPy Comparison<br/>--------------------</span><span id="11e4" class="nq mp it nm b gy nv ns l nt nu">DataFrame Summary<br/>-----------------</span><span id="868e" class="nq mp it nm b gy nv ns l nt nu">DataFrame  Columns   Rows<br/>0  Original       18  36634<br/>1       New       18  36634</span><span id="25bb" class="nq mp it nm b gy nv ns l nt nu">Column Summary<br/>--------------</span><span id="62d4" class="nq mp it nm b gy nv ns l nt nu">Number of columns in common: 18<br/>Number of columns in Original but not in New: 0<br/>Number of columns in New but not in Original: 0</span><span id="e308" class="nq mp it nm b gy nv ns l nt nu">Row Summary<br/>-----------</span><span id="cc73" class="nq mp it nm b gy nv ns l nt nu">Matched on: policyid<br/>Any duplicates on match values: No<br/>Absolute Tolerance: 0<br/>Relative Tolerance: 0<br/>Number of rows in common: 36,634<br/>Number of rows in Original but not in New: 0<br/>Number of rows in New but not in Original: 0</span><span id="a929" class="nq mp it nm b gy nv ns l nt nu">Number of rows with some compared columns unequal: 2<br/>Number of rows with all compared columns equal: 36,632</span><span id="627a" class="nq mp it nm b gy nv ns l nt nu">Column Comparison<br/>-----------------</span><span id="1526" class="nq mp it nm b gy nv ns l nt nu">Number of columns compared with some values unequal: 2<br/>Number of columns compared with all values equal: 16<br/>Total number of values which compare unequal: 2</span><span id="ce17" class="nq mp it nm b gy nv ns l nt nu">Columns with Unequal Values or Types<br/>------------------------------------</span><span id="071d" class="nq mp it nm b gy nv ns l nt nu">Column Original dtype New dtype  # Unequal   Max Diff  # Null Diff<br/>0  eq_site_limit        float64   float64          1  190601.40            0<br/>1  hu_site_limit        float64   float64          1   79375.76            0</span><span id="022a" class="nq mp it nm b gy nv ns l nt nu">Sample Rows with Unequal Values<br/>-------------------------------</span><span id="4a11" class="nq mp it nm b gy nv ns l nt nu">policyid  eq_site_limit (Original)  eq_site_limit (New)<br/>2    206893                  190724.4                123.0</span><span id="4824" class="nq mp it nm b gy nv ns l nt nu">policyid  hu_site_limit (Original)  hu_site_limit (New)<br/>3    333743                  79520.76                145.0</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nw"><img src="../Images/45e489635239e850e1a4cfe141c5aa10.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ypndUOHmPyX-o9CD"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Photo by <a class="ae ky" href="https://unsplash.com/@franki?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Franki Chamaki</a> on <a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h2 id="c65d" class="nq mp it bd mq nx ny dn mu nz oa dp my li ob oc na lm od oe nc lq of og ne oh bi translated">它是如何工作的？</h2><p id="313c" class="pw-post-body-paragraph kz la it lb b lc ng ju le lf nh jx lh li ni lk ll lm nj lo lp lq nk ls lt lu im bi translated">DataCompPy 要求您提供一列(可以只有一列)作为连接的键。您还可以设置它，使它基于索引工作。如果库在连接键上检测到重复项，那么它将对剩余的字段进行排序，并根据该行号进行连接。</p><h1 id="7169" class="mo mp it bd mq mr ms mt mu mv mw mx my jz mz ka na kc nb kd nc kf nd kg ne nf bi translated">算出例子</h1><p id="fa98" class="pw-post-body-paragraph kz la it lb b lc ng ju le lf nh jx lh li ni lk ll lm nj lo lp lq nk ls lt lu im bi translated">让我们探索一些用例，并确保我们知道如何将其付诸实践。我们需要做的第一件事是安装库。打开命令行窗口，键入以下内容:</p><pre class="kj kk kl km gt nl nm nn no aw np bi"><span id="c481" class="nq mp it nm b gy nr ns l nt nu">pip install datacompy</span></pre><p id="e6ab" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后，我们可以继续在 Python 脚本中导入库。在示例中，我将使用一些本地样本数据集:</p><pre class="kj kk kl km gt nl nm nn no aw np bi"><span id="01a2" class="nq mp it nm b gy nr ns l nt nu">import datacompy, pandas as pd</span><span id="b108" class="nq mp it nm b gy nv ns l nt nu">df1 = pd.read_csv('FL_insurance_sample.csv')</span><span id="81bd" class="nq mp it nm b gy nv ns l nt nu">df2 = pd.read_csv('FL_insurance_sample - Copy.csv')</span><span id="2412" class="nq mp it nm b gy nv ns l nt nu">print(df1.head(10))</span></pre><p id="93d3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">返回:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oi"><img src="../Images/caa7d3b13dec213ecc704a1e7696d7e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Vx2Bonk2OGc1KGnW4kOdhQ.png"/></div></div></figure><h2 id="8fba" class="nq mp it bd mq nx ny dn mu nz oa dp my li ob oc na lm od oe nc lq of og ne oh bi translated">如何使用 DataComPy</h2><p id="41cd" class="pw-post-body-paragraph kz la it lb b lc ng ju le lf nh jx lh li ni lk ll lm nj lo lp lq nk ls lt lu im bi translated">要使用该库，您只需要以下脚本框架:</p><pre class="kj kk kl km gt nl nm nn no aw np bi"><span id="5b5e" class="nq mp it nm b gy nr ns l nt nu">import datacompy</span><span id="f347" class="nq mp it nm b gy nv ns l nt nu">import pandas as pd</span><span id="966b" class="nq mp it nm b gy nv ns l nt nu">df1 = pd.read_csv('FL_insurance_sample.csv')</span><span id="79be" class="nq mp it nm b gy nv ns l nt nu">df2 = pd.read_csv('FL_insurance_sample - Copy.csv')</span><span id="fa65" class="nq mp it nm b gy nv ns l nt nu">compare = datacompy.Compare(</span><span id="06d0" class="nq mp it nm b gy nv ns l nt nu">df1,</span><span id="67bd" class="nq mp it nm b gy nv ns l nt nu">df2,</span><span id="7d89" class="nq mp it nm b gy nv ns l nt nu">join_columns='policyID',  #You can also specify a list of columns eg ['policyID','statecode']</span><span id="f11b" class="nq mp it nm b gy nv ns l nt nu">abs_tol=0, #Optional, defaults to 0</span><span id="a266" class="nq mp it nm b gy nv ns l nt nu">rel_tol=0, #Optional, defaults to 0</span><span id="13af" class="nq mp it nm b gy nv ns l nt nu">df1_name='Original', #Optional, defaults to 'df1'</span><span id="5ea4" class="nq mp it nm b gy nv ns l nt nu">df2_name='New' #Optional, defaults to 'df2'</span><span id="9e42" class="nq mp it nm b gy nv ns l nt nu">)</span><span id="73e3" class="nq mp it nm b gy nv ns l nt nu">print(compare.report())</span></pre><p id="c55e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要根据您的喜好调整上面的脚本，您需要注意以下几点:</p><ul class=""><li id="b9fd" class="oj ok it lb b lc ld lf lg li ol lm om lq on lu oo op oq or bi translated"><em class="lv"> abs_tol </em>和<em class="lv"> rel_tol </em>分别代表<em class="lv">绝对公差</em>和<em class="lv">相对公差</em>。它们允许您指定数值之间的偏差公差。</li><li id="5961" class="oj ok it lb b lc os lf ot li ou lm ov lq ow lu oo op oq or bi translated">您可以将<em class="lv"> join_columns </em>替换为<em class="lv"> on_index=True </em>来连接索引。</li><li id="49b4" class="oj ok it lb b lc os lf ot li ou lm ov lq ow lu oo op oq or bi translated">如果你想要两个数据集之间的交集，你可以使用<em class="lv">compare . intersect _ columns()</em></li></ul><p id="d2b4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">查看<a class="ae ky" href="https://github.com/capitalone/datacompy" rel="noopener ugc nofollow" target="_blank"> <em class="lv">他们的文档</em> </a>以了解特性的全部细节。</p><p id="e4e8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我希望你觉得这是有用的。</p></div><div class="ab cl ox oy hx oz" role="separator"><span class="pa bw bk pb pc pd"/><span class="pa bw bk pb pc pd"/><span class="pa bw bk pb pc"/></div><div class="im in io ip iq"><p id="22c7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您觉得这篇文章有用，您可能还会对以下内容感兴趣:</p><div class="lw lx gp gr ly lz"><a rel="noopener follow" target="_blank" href="/how-to-compare-large-files-f58982eccd3a"><div class="ma ab fo"><div class="mb ab mc cl cj md"><h2 class="bd iu gy z fp me fr fs mf fu fw is bi translated">如何比较大文件</h2><div class="mg l"><h3 class="bd b gy z fp me fr fs mf fu fw dk translated">了解如何使用 Python 比较大文件</h3></div><div class="mh l"><p class="bd b dl z fp me fr fs mf fu fw dk translated">towardsdatascience.com</p></div></div><div class="mi l"><div class="pe l mk ml mm mi mn ks lz"/></div></div></a></div><div class="lw lx gp gr ly lz"><a rel="noopener follow" target="_blank" href="/building-a-python-ui-for-comparing-data-13c10693d9e4"><div class="ma ab fo"><div class="mb ab mc cl cj md"><h2 class="bd iu gy z fp me fr fs mf fu fw is bi translated">构建用于比较数据的 Python UI</h2><div class="mg l"><h3 class="bd b gy z fp me fr fs mf fu fw dk translated">如何快速让您的非技术团队能够比较数据</h3></div><div class="mh l"><p class="bd b dl z fp me fr fs mf fu fw dk translated">towardsdatascience.com</p></div></div><div class="mi l"><div class="pf l mk ml mm mi mn ks lz"/></div></div></a></div><div class="lw lx gp gr ly lz"><a href="https://medium.com/financeexplained/3-quick-ways-to-compare-data-in-python-65201be10b6" rel="noopener follow" target="_blank"><div class="ma ab fo"><div class="mb ab mc cl cj md"><h2 class="bd iu gy z fp me fr fs mf fu fw is bi translated">在 Python 中比较数据的 3 种快速方法</h2><div class="mg l"><h3 class="bd b gy z fp me fr fs mf fu fw dk translated">对于任何从事分析工作的人来说，收到比较数据的请求都太熟悉了。不管那是…</h3></div><div class="mh l"><p class="bd b dl z fp me fr fs mf fu fw dk translated">medium.com</p></div></div><div class="mi l"><div class="mj l mk ml mm mi mn ks lz"/></div></div></a></div></div></div>    
</body>
</html>