# 成本函数:机器学习的基础

> 原文：<https://towardsdatascience.com/cost-functions-the-underpinnings-of-machine-learning-549ac5edb211?source=collection_archive---------19----------------------->

## 这一关键概念决定了您将模型与数据相匹配的能力

![](img/ffd952bff7643c51abaa6e4dff59587c.png)

将数据集拟合到模型是机器学习和数据科学的基础。通过这种方式，我们能够创造预测工具，帮助人们做出重要决策。

这通常是通过最小化模型生成的预测与[模型训练、验证和测试阶段的实际数据之间的差异来实现的。](/how-to-choose-between-multiple-models-a0c274b4228a)

为此，我们必须能够识别模型预测和数据实际值之间的差异。为了使模型符合数据并创建有价值的预测工具，我们必须能够使用最小化函数快速计算出差异。

这是*成本函数*的目标。

## 什么是成本函数？

> 在数据科学中，成本函数计算模型预测和数据集之间的差异。

根据维基百科的定义，*成本函数*是“将一个事件或一个或多个变量的值映射到一个实数上的函数，该实数直观地表示与该事件相关的一些“成本”。从更实际的角度来说，它是一个函数，用来计算一个你将要最小化或最大化的参数。

在数据科学中，这通常意味着识别模型预测和训练数据集之间的差异。通过这种方式，您可以量化模型预测中的误差，并使用优化方法来最小化该误差。

在名称*成本函数*中，“函数”指的是计算一个值的函数，而“成本”指的是该函数正在计算的惩罚。

注意,*成本函数*的概念是非常灵活的，它可以被定制来匹配一种情况。而是写一个等式，抓住你真正关心的东西。

## 成本函数是如何使用的？

使用*成本函数*的一个例子是一个人模拟一栋建筑的能源性能。(S)他希望最小化能量消耗，并相应地写一个*成本函数*。但是最小的能源消耗将是一个从不加热或冷却空间的建筑！显然不能接受。

(S)他可以在*成本函数*中添加一项，该项也对居住者不舒服的小时数的结果进行惩罚。那么优化的结果将是使用最少能量的设计，同时仍然保持空间中的舒适性。这个*成本函数*可能看起来像这样:

成本=能源消耗+ 1，000，000 *不舒适时间

以这种方式，一个小时对居住者的预测不适相当于一百万单位的能量消耗。现在，系统的结果将是找到加热和冷却空间的最节能的方式，而不仅仅是避免加热/冷却空间以节约能源。

## 模型拟合中的代价函数有哪些例子？

> 您可以根据需要设计成本函数，以研究应用程序中最重要的内容。

这是一个非常具体的行业例子。一些更通用的数据科学示例包括:

*   计算模型预测和数据点之间的误差总和，如[了解线性回归的基本原理](/understanding-the-fundamentals-of-linear-regression-7e64afd614e1)中所述。
*   计算模型预测和数据点之间的误差平方和，如[了解多元回归](/understanding-multiple-regression-249b16bde83e)中所述。
*   [平均绝对误差](https://en.wikipedia.org/wiki/Mean_absolute_error) (MAE)，它表示预测值和数据点之间的平均差异
*   [均方根误差](https://en.wikipedia.org/wiki/Root-mean-square_deviation) (RMSE)，计算整个数据集的平均平方误差的平方根。

请记住，您可以根据需要设计您的*成本函数*，以研究在您的应用中什么是最重要的。这很重要，因为所有的*成本函数*都有不同的优点和缺点。

回想一下建筑能源模拟的例子，一个仅检查能源消耗的*成本函数*与一个仅查看不舒适时段的成本函数会产生不同的影响。没有能耗项的建筑没有压力来确保建筑的节能。一个没有不舒服的小时术语的建筑没有压力来确保建筑保持居住者的舒适。

将两者结合成一个单一的*成本函数*迫使模型关注两者。

## 我如何平衡一个多项成本函数？

由于该模型能够检查两者，因此确保在*成本函数*中对每一项给予适当的考虑就变得很重要。这是通过给每一项增加加权因子或乘数来实现的，它告诉*成本函数*你有多关心每一项。

在建筑能耗模拟示例中，能耗的权重系数为 1，不舒适时段的权重系数为 1，000，000。这基本上迫使模型确保不存在 0 小时的不适。

但是如果几个小时的不适可以节省能量呢？然后，您可以更改您的权重因子，以使模型结果在关注能耗和不舒适时间之间达到不同的平衡。

> 加权因子告诉成本函数你有多关心每一项。

一个更直接的数据科学例子是将 MAE 和 RMSE 结合在一个*成本函数*中，该函数用于将模型拟合到数据集。平均而言，MAE 的作用是使模型尽可能接近整个数据集。“平均”在这里是一个重要的术语。这可能导致模型在大多数点上非常接近，而在少数点上非常不准确。RMSE 产生了相反的影响。由于它使用误差平方的平均值，它迫使模型在每一点都有小误差。它避免了带有极少数极不准确点的模型，但可以牺牲平均模型精度来强制实现该目标。

为了平衡这两种方法的优点和缺点，一个模型拟合*成本函数*可以结合 MBE 和 RMSE。然后，您需要对*成本函数*中的两项应用加权因子，以根据您的应用需求平衡这两项。

## 包装它

为了创建有用的预测工具，我们必须能够创建紧密符合数据集的数学模型。为了创建紧密符合数据集的模型，我们必须能够量化我们的模型预测与实际数据的差异。

这就是*成本函数*的作用所在。*成本函数*是计算与情况相关的“成本”的公式。在模型拟合的情况下，*成本函数*通常计算模型中的误差。

成本函数是灵活的，并且可以包括多个项。这使您能够将不同的重要因素合并到一个成本函数中。一个例子是查看建筑物的能耗。结合能源消耗和不舒适时间的术语创建了一个*成本函数*，迫使模型最小化能源消耗，同时还确保人们保持舒适。在模型拟合中，*成本函数*可能想要结合平均绝对误差(MAE)和均方根误差(RMSE)。

*多项成本函数*需要一种方法来平衡这两项，根据你对其中一项的重视程度。加权因子是应用于每一项的乘数，相应地增加/减少该项的值。可以根据需要对每一项进行添加和调整，以确定*成本函数*和最小化结果中的期望平衡。