<html>
<head>
<title>Recommender System in Python — Part 2 (Content-Based System)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python 中的推荐系统——第二部分(基于内容的系统)</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/recommender-system-in-python-part-2-content-based-system-693a0e4bb306?source=collection_archive---------11-----------------------#2019-10-05">https://towardsdatascience.com/recommender-system-in-python-part-2-content-based-system-693a0e4bb306?source=collection_archive---------11-----------------------#2019-10-05</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/dc6ef6b0bfe50353d2f47b254cff03f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CL9gqauLMCFPIPdw9VdM6A.jpeg"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk">Photo by <a class="ae jg" href="https://www.pexels.com/@pixabay?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank">Pixabay </a>from <a class="ae jg" href="https://www.pexels.com/photo/board-cinema-cinematography-clapper-board-274937/?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank">Pexels</a></figcaption></figure><div class=""/><p id="e27a" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">欢迎来到 2 部分系列的第二部分。这篇文章将着重于从以前探索过的电影数据集中开发一个简单的、基于内容的推荐系统。整个数据探索和分析已在第一部分完成，如果您错过了，请点击以下链接:</p><div class="is it gp gr iu le"><a rel="noopener follow" target="_blank" href="/recommender-system-in-python-part-1-preparation-and-analysis-d6bb7939091e"><div class="lf ab fo"><div class="lg ab lh cl cj li"><h2 class="bd jk gy z fp lj fr fs lk fu fw ji bi translated">Python 中的推荐系统第一部分(准备和分析)</h2><div class="ll l"><h3 class="bd b gy z fp lj fr fs lk fu fw dk translated">深入推荐系统的神奇世界，自己构建一个(第 1 部分)</h3></div><div class="lm l"><p class="bd b dl z fp lj fr fs lk fu fw dk translated">towardsdatascience.com</p></div></div><div class="ln l"><div class="lo l lp lq lr ln ls ja le"/></div></div></a></div><p id="df80" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我不得不说，今天的帖子会比上一篇短得多。最主要的原因是，没有太多的推荐系统(<em class="lt">在这个基础层面至少有</em>)。话虽如此，今天的帖子将向您解释一个简单的基于内容的推荐系统背后的直觉和逻辑(<em class="lt">如果您不知道什么是基于内容的系统</em>，请参见第 1 部分)，您将看到这里没有实际的<strong class="ki jk">机器学习</strong>，只有高级的(<em class="lt">类似于</em>)过滤。</p></div><div class="ab cl lu lv hx lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="im in io ip iq"><h1 id="9ac8" class="mb mc jj bd md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my bi translated">你为什么要读这篇文章？</h1><p id="1638" class="pw-post-body-paragraph kg kh jj ki b kj mz kl km kn na kp kq kr nb kt ku kv nc kx ky kz nd lb lc ld im bi translated">与前一篇文章一样，它有两个主要好处:</p><ol class=""><li id="f841" class="ne nf jj ki b kj kk kn ko kr ng kv nh kz ni ld nj nk nl nm bi translated">您将深入推荐系统的世界，并构建您的第一个(<em class="lt">可能是</em>)</li><li id="4ec2" class="ne nf jj ki b kj nn kn no kr np kv nq kz nr ld nj nk nl nm bi translated">你会发现它们比看起来要简单</li></ol></div><div class="ab cl lu lv hx lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="im in io ip iq"><h1 id="43fb" class="mb mc jj bd md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my bi translated">这篇文章是如何组织的？</h1><p id="f5a7" class="pw-post-body-paragraph kg kh jj ki b kj mz kl km kn na kp kq kr nb kt ku kv nc kx ky kz nd lb lc ld im bi translated">前面我说了，这一部分会比上一部分短很多，上一部分涵盖了数据收集、准备和探索的过程。阅读那篇文章是<strong class="ki jk">的先决条件</strong>，因为如果你不阅读它(<em class="lt">或者至少复制其中的代码</em>，你的数据将不会与我的数据格式相同，因此你将无法继续。</p><p id="c032" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">帖子内容如下:</p><ol class=""><li id="922a" class="ne nf jj ki b kj kk kn ko kr ng kv nh kz ni ld nj nk nl nm bi translated">矩阵创建</li><li id="1d7d" class="ne nf jj ki b kj nn kn no kr np kv nq kz nr ld nj nk nl nm bi translated">创建获取推荐的函数</li><li id="163f" class="ne nf jj ki b kj nn kn no kr np kv nq kz nr ld nj nk nl nm bi translated">获取和验证结果</li></ol><p id="c3ef" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在开始之前，数据集应该是这样的:</p><figure class="nt nu nv nw gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ns"><img src="../Images/441f73d6c20f2035529a6df326ecba68.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-9pg66hquZjwMqlPujn60w.png"/></div></div></figure><p id="c750" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki jk"> <em class="lt">弄成这个形状？你可以继续了。</em></strong></p></div><div class="ab cl lu lv hx lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="im in io ip iq"><h1 id="d29b" class="mb mc jj bd md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my bi translated">矩阵创建</h1><p id="4be7" class="pw-post-body-paragraph kg kh jj ki b kj mz kl km kn na kp kq kr nb kt ku kv nc kx ky kz nd lb lc ld im bi translated">对于矩阵，我的意思是您应该以某种方式创建具有以下内容的表:</p><ul class=""><li id="9618" class="ne nf jj ki b kj kk kn ko kr ng kv nh kz ni ld nx nk nl nm bi translated">每个用户 ID 作为一行</li><li id="7d68" class="ne nf jj ki b kj nn kn no kr np kv nq kz nr ld nx nk nl nm bi translated">每个电影标题作为一个专栏</li><li id="e3a7" class="ne nf jj ki b kj nn kn no kr np kv nq kz nr ld nx nk nl nm bi translated">将每个用户对每部电影的评价定为行和列的交集</li></ul><p id="f73c" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这很容易通过<a class="ae jg" href="https://pandas.pydata.org/" rel="noopener ugc nofollow" target="_blank">熊猫</a><strong class="ki jk"><em class="lt">pivot _ table()</em></strong>函数获得:</p><figure class="nt nu nv nw gt iv"><div class="bz fp l di"><div class="ny nz l"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk">Movie Matrix — <a class="ae jg" href="https://gist.github.com/dradecic/339da863583482ef8fc67770e1a40bd7" rel="noopener ugc nofollow" target="_blank">https://gist.github.com/dradecic/339da863583482ef8fc67770e1a40bd7</a></figcaption></figure><p id="13f6" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这个矩阵本质上是一个熊猫<strong class="ki jk"> DataFrame </strong>对象，通过知道你知道你可以调用<strong class="ki jk"> <em class="lt">。</em>头()</strong>在上面:</p><figure class="nt nu nv nw gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi oa"><img src="../Images/5f0f45eb8e1bff1eed7b413b8427f5d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tJ8gfc8ce7HAeQVPSEDkkg.png"/></div></div></figure><p id="08cf" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">是啊，很多<strong class="ki jk"> <em class="lt">男</em> </strong>，我都知道。花一分钟思考为什么这么多的值丢失了，然后继续阅读。</p><p id="4852" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki jk"> <em class="lt">你拿到了吗？</em> </strong></p><p id="a00d" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">原因是，并不是每个人都看过每部电影并对其进行评级。这个表里面有 9700 多部电影，你自己想想吧。你看了多少部电影？在你看过的人中，你公开评价了多少？没那么多吧？</p><p id="0d92" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在你有了矩阵，你可以进行下一步了。</p></div><div class="ab cl lu lv hx lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="im in io ip iq"><h1 id="53d4" class="mb mc jj bd md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my bi translated">创建获取推荐的函数</h1><p id="982b" class="pw-post-body-paragraph kg kh jj ki b kj mz kl km kn na kp kq kr nb kt ku kv nc kx ky kz nd lb lc ld im bi translated">这是邮报的主要内容。如果这是你的第一个推荐系统，你会惊讶地发现做一个是多么容易，至少在初级水平上是这样。</p><p id="e630" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">下面是<strong class="ki jk">你必须实现的逻辑</strong>:</p><ul class=""><li id="714c" class="ne nf jj ki b kj kk kn ko kr ng kv nh kz ni ld nx nk nl nm bi translated">计算所需电影与其他电影的相关性(使用<strong class="ki jk"> <em class="lt">)。</em>corrwith()</strong>法)</li><li id="49a1" class="ne nf jj ki b kj nn kn no kr np kv nq kz nr ld nx nk nl nm bi translated">将具有相关性的电影标题存储在单独的<strong class="ki jk">数据帧</strong></li><li id="85ac" class="ne nf jj ki b kj nn kn no kr np kv nq kz nr ld nx nk nl nm bi translated">将<strong class="ki jk">数据帧</strong>与原数据帧合并，删除重复数据，保留<strong class="ki jk"> <em class="lt">标题</em> </strong>、<strong class="ki jk"> <em class="lt">相关</em> </strong>系数、<strong class="ki jk">编号</strong>列</li><li id="3e8e" class="ne nf jj ki b kj nn kn no kr np kv nq kz nr ld nx nk nl nm bi translated">按相关性降序排序(<em class="lt">从最大相关性到最小相关性</em></li><li id="1da7" class="ne nf jj ki b kj nn kn no kr np kv nq kz nr ld nx nk nl nm bi translated">过滤掉收视率低的电影(<em class="lt">那些电影是不相关的，因为它们只被少数人看过</em></li><li id="2195" class="ne nf jj ki b kj nn kn no kr np kv nq kz nr ld nx nk nl nm bi translated">返回 top <strong class="ki jk"> n </strong>相关电影</li></ul><p id="c7a9" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">听起来工作量很大，但实际上只有 10 行代码。</p><figure class="nt nu nv nw gt iv"><div class="bz fp l di"><div class="ny nz l"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk">The Function — <a class="ae jg" href="https://gist.github.com/dradecic/322359d1bf36de305c55a8fc539fec75" rel="noopener ugc nofollow" target="_blank">https://gist.github.com/dradecic/322359d1bf36de305c55a8fc539fec75</a></figcaption></figure><p id="6b59" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如您所见，我已经设置了作为默认函数参数返回的过滤器数量和电影推荐数量，因此它们更容易调整。</p><p id="b339" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">简而言之，这就是你需要实现的全部逻辑。</p><p id="0461" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki jk"> <em class="lt">容易吧？</em> </strong></p></div><div class="ab cl lu lv hx lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="im in io ip iq"><h1 id="2d21" class="mb mc jj bd md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my bi translated">获取和验证结果</h1><p id="2d10" class="pw-post-body-paragraph kg kh jj ki b kj mz kl km kn na kp kq kr nb kt ku kv nc kx ky kz nd lb lc ld im bi translated">获得推荐的过程现在就像函数调用一样简单。你需要传入的唯一参数是<strong class="ki jk">电影标题</strong>，并且它必须与数据集中存在的那个相同，每个小小的拼写错误都会破坏一切。请随意使用这个函数来解决这个问题。</p><p id="4973" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果我现在拿到低俗小说电影的推荐:</p><figure class="nt nu nv nw gt iv gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/b25c02daca280d17e46537fc781632b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:672/format:webp/1*6v4Xtshl247s7VN7KQPEdg.png"/></div></figure><p id="382b" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">第一个显而易见，<strong class="ki jk">低俗小说</strong>与<strong class="ki jk">低俗小说</strong>完美关联，但看看之后的几个。</p><p id="235c" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">看看<a class="ae jg" href="https://www.imdb.com/" rel="noopener ugc nofollow" target="_blank"> IMDB </a>给了这部电影什么推荐。很酷，对吧？</p><figure class="nt nu nv nw gt iv gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/1938268188371c2412eec39c3b53858e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1278/format:webp/1*yMH3k85yfJ8ytk_lRSHOZA.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk">Obtained from IMDB on 29th September 2019 — <a class="ae jg" href="https://www.imdb.com/title/tt0110912/?ref_=tt_sims_tt" rel="noopener ugc nofollow" target="_blank">https://www.imdb.com/title/tt0110912/?ref_=tt_sims_tt</a></figcaption></figure><p id="184d" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我现在可以对电影<strong class="ki jk">玩具总动员</strong>做同样的事情:</p><figure class="nt nu nv nw gt iv gh gi paragraph-image"><div class="gh gi od"><img src="../Images/2e7f090bca9a6fe1044ca2d07b216111.png" data-original-src="https://miro.medium.com/v2/resize:fit:688/format:webp/1*1L8JwZK4nyGz8LQ1pvnLbw.png"/></div></figure><p id="bbf3" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">很明显这些建议是有效的，但是让我们确认一下以防万一:</p><figure class="nt nu nv nw gt iv gh gi paragraph-image"><div class="gh gi oe"><img src="../Images/88d0ec34c1ef4babd7dfa70e8ff78d7f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1266/format:webp/1*uYMZ2w4xQNPt8-idBoQKUg.png"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk">Obtained from IMDB on 29th September 2019 — <a class="ae jg" href="https://www.imdb.com/title/tt0114709/?ref_=nv_sr_3?ref_=nv_sr_3" rel="noopener ugc nofollow" target="_blank">https://www.imdb.com/title/tt0114709/?ref_=nv_sr_3?ref_=nv_sr_3</a></figcaption></figure><p id="6160" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">《怪兽电力公司》和《海底总动员》是 IMDB 上的前 6 个推荐，而《超人总动员》<strong class="ki jk">在下一页。</strong></p></div><div class="ab cl lu lv hx lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="im in io ip iq"><h1 id="e3b7" class="mb mc jj bd md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my bi translated">结论</h1><p id="27f5" class="pw-post-body-paragraph kg kh jj ki b kj mz kl km kn na kp kq kr nb kt ku kv nc kx ky kz nd lb lc ld im bi translated">推荐系统做起来很有趣，也很容易验证(<em class="lt">至少在这种情况下</em>)。我希望在读完这篇文章后，你不会把它们看作是黑盒，因为它们基本上可以归结为用 Python ( <em class="lt">或你选择的语言</em>)进行一些数据操作。</p><p id="abe8" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki jk"> <em class="lt">你考了哪些电影？你对结果满意吗？请让我知道。</em>T13】</strong></p></div></div>    
</body>
</html>