<html>
<head>
<title>Predicting Grape Varieties</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">预测葡萄品种</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/robosomm-chapter-1-predicting-grape-varieties-4c5beb505a7b?source=collection_archive---------12-----------------------#2019-04-28">https://towardsdatascience.com/robosomm-chapter-1-predicting-grape-varieties-4c5beb505a7b?source=collection_archive---------12-----------------------#2019-04-28</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="b580" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph">机器人</h2><div class=""/><div class=""><h2 id="13cb" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">从葡萄酒评论中提取描述符并探索不同品种的关键特征</h2></div><p id="9bf2" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">有很多关于盲品葡萄酒的艺术和科学的文章和言论。对于世界上最好的品酒师来说，能够正确识别你面前的一杯酒是一种骄傲。Somm 系列纪录片揭示了与此相关的惊人技能。通过使用一种名为“网格”的结构进行多轮有针对性的提问，侍酒师能够识别葡萄品种/混合、地区，有时甚至是一杯葡萄酒的年份。</p><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="gh gi ln"><img src="../Images/3043d53661a6a126298dd69a9a806ad2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*m7na2J9mPxgY2QGqKhb2Dg.gif"/></div></div></figure><p id="fb50" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">在本文中，我们将通过使用数据科学技术，从不同的角度探索盲品。我们可以训练一个算法来盲尝吗？我们能建造自己的机器人吗？</p><p id="de0d" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated"><em class="lz">更详细的请参见更详细的</em> <a class="ae ma" href="https://github.com/RoaldSchuring/Wine-Blind-Tasting-Algorithm" rel="noopener ugc nofollow" target="_blank"> <em class="lz"> GitHub 资源库</em> </a> <em class="lz">以及关联的</em> <a class="ae ma" href="https://github.com/RoaldSchuring/Wine-Blind-Tasting-Algorithm/blob/master/predicting_grape_varieties.ipynb" rel="noopener ugc nofollow" target="_blank"> <em class="lz"> Jupyter 笔记本</em> </a> <em class="lz">。</em></p><h1 id="4d6e" class="mb mc it bd md me mf mg mh mi mj mk ml ki mm kj mn kl mo km mp ko mq kp mr ms bi translated">从例子中学习</h1><p id="f9ee" class="pw-post-body-paragraph kr ks it kt b ku mt kd kw kx mu kg kz la mv lc ld le mw lg lh li mx lk ll lm im bi translated">RoboSomm 将不得不从例子中学习。为此，我们使用了友好的<a class="ae ma" href="https://www.kaggle.com/christopheiv/winemagdata130k" rel="noopener ugc nofollow" target="_blank"> Kaggle 用户</a>从<a class="ae ma" href="https://www.winemag.com/" rel="noopener ugc nofollow" target="_blank">https://www.winemag.com/</a>收集的 17 万条独特的葡萄酒评论。这些葡萄酒评论描述如下:</p><blockquote class="my mz na"><p id="8163" class="kr ks lz kt b ku kv kd kw kx ky kg kz nb lb lc ld nc lf lg lh nd lj lk ll lm im bi translated">无论是嗅觉还是味觉，这款加那查葡萄酒都是温和的有棱角和收缩感，坚硬的单宁带来了一种原始的感觉。其狐狸般的李子味道跳跃而紧张，回味辛辣而参差不齐。</p></blockquote><p id="bc68" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">我们需要修改我们的例子，以确保它们不包含任何盲品时无法通过感官获得的信息。毕竟，当我们试图盲目品尝时，我们不会知道我们试图鉴别的葡萄酒是加纳夏！除了删除任何“不可知”的信息，我们还删除了任何非信息性的术语，并通过了几个文本标准化步骤来标准化我们的文本。从上面的描述中，我们可以获得以下描述符:</p><pre class="lo lp lq lr gt ne nf ng nh aw ni bi"><span id="5d7a" class="nj mc it nf b gy nk nl l nm nn">['hard tannin', 'plum', 'pepperi', 'mild', 'tannin', 'plum flavor']</span></pre><h1 id="810d" class="mb mc it bd md me mf mg mh mi mj mk ml ki mm kj mn kl mo km mp ko mq kp mr ms bi translated">从葡萄品种开始</h1><p id="3e18" class="pw-post-body-paragraph kr ks it kt b ku mt kd kw kx mu kg kz la mv lc ld le mw lg lh li mx lk ll lm im bi translated">世界上最好的品酒师在盲品时可以推断出葡萄酒的品种、产地和年份。这对于第一代 RoboSomm 来说可能有点过于雄心勃勃了。为了限制练习的范围，我们将从看看是否可以训练一个模型来预测数据集中最常见的葡萄品种开始。为简单起见，我们也将删除混合。我们剩下的葡萄品种有:</p><pre class="lo lp lq lr gt ne nf ng nh aw ni bi"><span id="4c7d" class="nj mc it nf b gy nk nl l nm nn">['Pinot Noir', 'Chardonnay', 'Cabernet Sauvignon', 'Riesling', 'Syrah', <br/>'Sauvignon Blanc', 'Zinfandel', 'Sangiovese', 'Merlot', 'Malbec', <br/>'Tempranillo', 'Nebbiolo', 'Pinot Gris', 'Grüner Veltliner', <br/>'Cabernet Franc', 'Grenache', 'Viognier', 'Gamay', 'Gewürztraminer', 'Barbera']</span></pre><p id="d1c4" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">为了让我们熟悉这些葡萄品种，我们可以根据与每种葡萄最相关的描述符来构建词云:</p><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="gh gi no"><img src="../Images/b2ef1bd9360b92363fa124fd7c79a750.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*7MrfoRQhrovrfhaU"/></div></div></figure><p id="b062" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">当一个词出现得越频繁，它在我们的词云中就会越大。我们可以看到许多描述符出现在几乎每一种葡萄品种上——例如，水果和单宁。从上面我们可能会说，一般来说，西拉葡萄酒比歌海娜葡萄酒单宁更强。尽管一些词出现在几个词云中，但我们可以看到葡萄品种之间有显著的差异。长相思比其他葡萄酒有更明显的柑橘味。巴贝拉葡萄酒的辛辣味相对较重。对于夏敦埃酒，我会想到烤面包和苹果。</p><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="gh gi ln"><img src="../Images/4980770f3befcbd147f9dd62b45674f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*mjVkVu6OOkNarY2asMH88w.gif"/></div></div></figure><h1 id="1d0c" class="mb mc it bd md me mf mg mh mi mj mk ml ki mm kj mn kl mo km mp ko mq kp mr ms bi translated">建筑模型</h1><p id="6efa" class="pw-post-body-paragraph kr ks it kt b ku mt kd kw kx mu kg kz la mv lc ld le mw lg lh li mx lk ll lm im bi translated">随着我们的原始文本被转换成描述符，我们几乎准备好开始构建模型了。首先，我们需要将基于文本的描述符转换成数字特征。我们将使用一种简单的方法，称为 one-hot-encoding，来产生一个 1 和 0 的矩阵，以突出每个描述符对于给定的观察是否存在。</p><p id="bc93" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">此外，我们应该花点时间考虑如何评估我们模型的性能。我们希望 RoboSomm 能够高精度地识别出它面前的葡萄酒。当它做出预测时，这个预测需要是准确的。我们对检索特定葡萄品种的所有例子不感兴趣。此外，如果我们的模型能够高精度地识别许多不同的葡萄品种，而不仅仅是我们数据集中最常见的品种，那就太好了。因此，我们将关注的关键性能指标是所有类别的平均精度(不按观察次数加权)。</p><p id="7a1b" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">在进入我们的模型之前，我们应该解决的最后一项内务是我们如何定义训练和测试集——训练集用于训练我们的模型，测试集用于评估它的性能。我们的训练集是数据集的 80%，测试集构成剩余的 20%的数据。</p><p id="77cc" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated"><strong class="kt jd">模型 1:决策树</strong></p><p id="435b" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">当品酒师进行正式的盲品时，他们会使用一种叫做“网格”的结构。网格是一个记忆的属性表。在数据科学的世界中，我们可以认为这类似于决策树。一轮又一轮的连续问题提供了一个简洁的结构，帮助 somms 对面前的葡萄酒进行分类。</p><p id="26d8" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">我们的决策树模型在我们的测试集上仅实现了较低的平均精度(28%)。然而，决策树能告诉我们什么样的连续提问能最有效地让我们区分葡萄品种。让我们想象一下树的前几层(实际的决策树要深得多)，看看我们能学到什么。</p><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="gh gi np"><img src="../Images/9c2760f8641832166cfc6e6833684361.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*2IJX4DSZ9WtBsZeh"/></div></div></figure><p id="d98f" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">可视化练习揭示了一些葡萄酒非常独特。例如，长相思似乎是一个非常安全的赌注，如果有一个甜椒味道/香气，没有荔枝。尽管在我们的数据集中红葡萄和白葡萄品种的数量更多(13 对 7)，但我们可以看到一些内比奥罗(香脂)和加迈(香蕉)葡萄酒具有相当独特的风味特征。不能保证所有的长相思、内比奥罗和佳美葡萄酒都具有上面列出的特征，但是如果特征<em class="lz">存在</em>，这是一个很好的预测指标。</p><p id="f261" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated"><strong class="kt jd">模型 2:投票分类器</strong></p><p id="ced7" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">决策树是一种相当简单的分类算法。还有其他更复杂的算法可以产生更高的性能。对于这个练习，我们探索了多个选项，但是发现多项式朴素贝叶斯(MNB)和随机森林分类器是为我们的测试集产生最高平均精度的算法。</p><p id="f9cb" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">为了从这些算法的相对优势中受益，我们可以更进一步，使用一种叫做投票分类器的东西来组合每个算法返回的预测。投票分类器将运行这两种算法，并对每种算法返回的预测进行加权，以得出单个预测。</p><p id="84a6" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">我们的投票分类器成功地将未加权的平均精度提高到 51%。这似乎更…可口。现在我们有了一个性能更好的分类器，让我们更深入地看看返回的预测。有没有特定的葡萄品种只是比其他品种更难预测？</p><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/fa748125ebd5989b780bce5dff99deec.png" data-original-src="https://miro.medium.com/v2/resize:fit:806/0*vTmzzuVQTAN4-d-B"/></div></figure><p id="3e0b" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">看来有些确实更容易高精度地预测。Gewürztraminer、Grüner Veltliner、Pinot Gris 和 Sauvignon(方便的说都是白葡萄酒)的预测精度在 75%左右。这也可能是因为我们的数据集中只有 7 个白葡萄品种。在红葡萄酒中，内比奥罗和仙粉黛的精确度相对较高。</p><p id="8a93" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">尽管我们的结果令人鼓舞，但一些葡萄品种似乎很难预测。品丽珠和维欧尼不会作为我们测试集的预测返回。让我们深入一点。为什么会出现这种情况？</p><p id="8e12" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">为了更详细地研究我们模型的性能，我们将构建一个混淆矩阵。混淆矩阵是一个网格，显示正确和错误预测的数量，并用计数值汇总。</p><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="gh gi nr"><img src="../Images/ac20493da54f6ddec3591423197d2c0d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*NU6x_JTQiSGPUGV3"/></div></div></figure><p id="6080" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">我们的混淆矩阵可以帮助我们讲述返回的预测的故事。例如，我们可以看到，在我们的测试集中，1232 种黑皮诺葡萄酒被正确预测。我们还可以看到，品丽珠葡萄酒一直被预测为黑皮诺、赤霞珠或西拉。维欧尼葡萄酒一直被认为是霞多丽或雷司令。</p><p id="4079" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">我们可以确定两个可能的原因(在众多原因中！)为什么会这样:</p><ol class=""><li id="e759" class="ns nt it kt b ku kv kx ky la nu le nv li nw lm nx ny nz oa bi translated">我们正在处理一个不平衡的数据集(霞多丽比维欧尼多得多，黑皮诺比卡本内法郎多得多)。这使得普通葡萄品种更有可能作为预测返回，而不是数量较少的葡萄品种。尽管探索了减轻这一问题的技术(欠采样、过采样)，但这些技术显著降低了模型的整体性能。</li><li id="9bb0" class="ns nt it kt b ku ob kx oc la od le oe li of lm nx ny nz oa bi translated">在我们的数据集中，Viognier 和 Cabernet Franc 没有 Gamay 和 Gewürztraminer 等同样多的葡萄品种那么独特。</li></ol><h1 id="7287" class="mb mc it bd md me mf mg mh mi mj mk ml ki mm kj mn kl mo km mp ko mq kp mr ms bi translated">关于葡萄酒相似性的最后一点</h1><p id="d059" class="pw-post-body-paragraph kr ks it kt b ku mt kd kw kx mu kg kz la mv lc ld le mw lg lh li mx lk ll lm im bi translated">为了建立一个更全面的模型，还探索了工程特征的替代方法。我们可以选择用嵌入来表示每个描述符，而不是用 0 和 1 的矩阵来表示描述符的存在或不存在。</p><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div class="gh gi og"><img src="../Images/5894a243cd557ab14d5d6090a6f95cd4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1290/0*MOtsYSlThxTgd9Tf"/></div></figure><p id="a9da" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">单词嵌入是将单词表示为向量的一种方式。通过完成右图中概述的过程，我们可以为每个葡萄酒描述生成一个单独的嵌入。您会注意到，只从原始文本中提取了单个单词，而不是短语——有关这方面的更多详细信息，您可以访问上面引用的 Jupyter 笔记本中的代码。</p><p id="0605" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">不幸的是，这种方法并没有比我们使用 0 和 1 的“简单”方法产生更好的结果。然而，我们也可以使用创建平均单词嵌入的方法来构建给定葡萄品种的所有描述的平均向量。然后使用一种叫做 T-SNE 的技术将这个向量压缩成二维，我们可以建立一个可视化的模型，告诉我们对不同葡萄品种的描述有多相似。</p><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div class="gh gi oh"><img src="../Images/3703e0eb70edf04e3c55f5d6ebefa9a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1008/0*jAi3lXV-3DGyt_bO"/></div></figure><p id="9978" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">尽管解释 T-SNE 视觉化的空间可能会很棘手，但这里还是有一些经验可以借鉴。我们可以看到，白葡萄酒在我们的地块中占据了一个区域，而红葡萄酒都位于底部。较浅的红葡萄酒如歌海娜、黑比诺和加梅位于同一地块，较重、单宁较强的红葡萄酒如西拉、马尔贝克和坦普拉尼洛也彼此相邻。品丽珠，一种经常被误归类为黑比诺或赤霞珠的葡萄酒，确实介于这两种葡萄品种之间。</p><p id="94c9" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">对于白葡萄酒，我们可以看到，较甜的葡萄品种如 Gewürztraminer 和 Riesling 彼此相对靠近，而较干的品种如 Pinot Gris 和 Sauvignon Blanc 占据了地块中的不同区域。有些令人惊讶的是，维欧尼和霞多丽相差如此之远。这两种葡萄酒都被认为是醇厚的白葡萄酒，我们知道维欧尼一直被误认为是夏敦埃酒。这可能是因为我们不能在一个简单的二维图中完全捕捉这些葡萄品种之间的相似性。</p><h1 id="c6da" class="mb mc it bd md me mf mg mh mi mj mk ml ki mm kj mn kl mo km mp ko mq kp mr ms bi translated">结论</h1><p id="a0cb" class="pw-post-body-paragraph kr ks it kt b ku mt kd kw kx mu kg kz la mv lc ld le mw lg lh li mx lk ll lm im bi translated">总的来说，在我们能够建立一个能够在盲品中可靠识别葡萄酒的机器人之前，还有很多工作要做。尽管如此，我们在这次探索性练习中学到了很多东西。我们已经研究了将基于文本的葡萄酒描述转换成一组描述符的方法，并研究了 20 种受欢迎的葡萄品种之间的差异。我们已经建立了一些预测葡萄品种的初步模型。由于仍有足够的改进空间，我们可以继续调查以下事项:</p><ul class=""><li id="2b43" class="ns nt it kt b ku kv kx ky la nu le nv li nw lm oi ny nz oa bi translated">我们能使用更复杂的模型来预测葡萄品种吗？</li><li id="e681" class="ns nt it kt b ku ob kx oc la od le oe li of lm oi ny nz oa bi translated">我们能为不同的葡萄品种建立比本文中探索的单词云可视化更全面的风味特征吗？</li><li id="56e5" class="ns nt it kt b ku ob kx oc la od le oe li of lm oi ny nz oa bi translated">我们能否超越葡萄品种，建立一个模型来预测不同葡萄品种的葡萄酒风格(例如橡木桶陈酿的霞多丽和未橡木桶陈酿的霞多丽)？</li><li id="de0f" class="ns nt it kt b ku ob kx oc la od le oe li of lm oi ny nz oa bi translated">除了预测葡萄酒的风格，我们还可以预测与葡萄酒相关的地区和年份吗？</li></ul><p id="50ea" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">作为临别赠言，让我们借用伟大的侍酒师弗雷德·丹姆的一些至理名言。在生活中，在数据科学中…</p><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="gh gi ln"><img src="../Images/f27d2c4df4dcc912c1c610966db13a41.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*r8JLAtlD_LzjVGMRxsIzJw.gif"/></div></div></figure></div></div>    
</body>
</html>