<html>
<head>
<title>Saving and loading Pytorch models in Kaggle</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在 Kaggle 中保存和加载 Pytorch 模型</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/saving-and-loading-pytorch-models-in-kaggle-3dadc0af1bd9?source=collection_archive---------21-----------------------#2019-07-18">https://towardsdatascience.com/saving-and-loading-pytorch-models-in-kaggle-3dadc0af1bd9?source=collection_archive---------21-----------------------#2019-07-18</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="1374" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">在 Kaggle 上训练 Pytorch 模型的初学者指南</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/2d33be8fea5b9ce55e66978eda463914.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*EcNt1Y_p5njLMX3F"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk"><a class="ae kv" href="https://www.google.com/url?sa=i&amp;source=images&amp;cd=&amp;ved=2ahUKEwiSttqlub7jAhVOQBoKHdbLCFwQjRx6BAgBEAU&amp;url=https%3A%2F%2Fwww.jessicayung.com%2Fgetting-started-with-kaggle-1-text-data-quora-question-pairs-spam-smses%2F&amp;psig=AOvVaw2Pf-0QVvxFFJh1xMOqY_EZ&amp;ust=1563537857106408" rel="noopener ugc nofollow" target="_blank">source</a></figcaption></figure><p id="8d7a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">你听说过卡格尔很棒。你也在努力提高你的数据科学技能，并开始深度学习或刚刚开始 Kaggle。</p><p id="e3ed" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">就在你认为你正在 Kaggle 上训练你的深度神经网络的时候，你卡住了。</p><h1 id="43bf" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">那么问题出在哪里？</h1><p id="e066" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">所以你已经知道你可以保存 Pytorch 模型(严格地说，是状态字典)并在以后方便的时候加载它们。你已经在 Kaggle 上训练了你的模型并保存了它。当您需要访问保存的模型时，您就是找不到它，这可能会迫使您重新开始。😓😓😓</p><p id="b607" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们都知道训练一个模特可能是一个非常痛苦的过程，所以不得不从头再来一遍不是一个选择。别担心，我(和卡格尔)抓住你了！</p><p id="9bdc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在本文中，我将向您展示如何通过 5 个简单的步骤加载您训练过的 Pytorch 模型。</p><h2 id="eb05" class="mp lt iq bd lu mq mr dn ly ms mt dp mc lf mu mv me lj mw mx mg ln my mz mi na bi translated">假设</h2><p id="3b1d" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">我将假设:</p><ol class=""><li id="fcc8" class="nb nc iq ky b kz la lc ld lf nd lj ne ln nf lr ng nh ni nj bi translated">你已经知道如何训练一个模特了。</li><li id="7129" class="nb nc iq ky b kz nk lc nl lf nm lj nn ln no lr ng nh ni nj bi translated">你理解 Pytorch 的模型状态字典的概念。查看<a class="ae kv" href="https://medium.com/udacity-pytorch-challengers/saving-loading-your-model-in-pytorch-741b80daf3c" rel="noopener">该资源</a>了解更多信息。</li><li id="702c" class="nb nc iq ky b kz nk lc nl lf nm lj nn ln no lr ng nh ni nj bi translated">您至少对如何保存和加载 Pytorch 模型有了基本的了解。如果没有，<a class="ae kv" href="https://medium.com/udacity-pytorch-challengers/saving-loading-your-model-in-pytorch-741b80daf3c" rel="noopener">这个帖子</a>是一个很好的起点。</li></ol><p id="879a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我正在进行的项目以及随后撰写这篇文章的需要都源于我对<a class="ae kv" href="https://www.udacity.com/facebook-pytorch-scholarship?source=post_page---------------------------" rel="noopener ugc nofollow" target="_blank"> Udacity Pytorch 挑战赛</a>的参与。</p></div><div class="ab cl np nq hu nr" role="separator"><span class="ns bw bk nt nu nv"/><span class="ns bw bk nt nu nv"/><span class="ns bw bk nt nu"/></div><div class="ij ik il im in"><p id="a127" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">第一步:训练你的模型</p><p id="c14a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这个例子中，我编写了一个名为 train()的函数，它将历元数作为参数。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nw"><img src="../Images/6f536fb7606d74924408488557cc93e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3W2C7NxM2COW5IwUFO5KKg.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Step 1: Training the model</figcaption></figure></div><div class="ab cl np nq hu nr" role="separator"><span class="ns bw bk nt nu nv"/><span class="ns bw bk nt nu nv"/><span class="ns bw bk nt nu"/></div><div class="ij ik il im in"><p id="239c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">第二步:保存你的模型</strong></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nx"><img src="../Images/ffa242fd36f0852418781c2d72aa43dc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LVn_YVF0VC0xaH4YFEYQCA.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Step 2: Save your model</figcaption></figure><p id="685f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">注意</strong>:上述方法(仅保存状态字典)可能不是最好的，因为当您加载时，您将需要构建一个与您保存的模型具有相同架构的模型。</p></div><div class="ab cl np nq hu nr" role="separator"><span class="ns bw bk nt nu nv"/><span class="ns bw bk nt nu nv"/><span class="ns bw bk nt nu"/></div><div class="ij ik il im in"><p id="ae98" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">第三步:提交你的内核</strong></p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ny nz l"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Step 3: Committing your Kernel in Kaggle</figcaption></figure><p id="a6e6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">完整的提交看起来像什么。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oa"><img src="../Images/547fba113d2198f19963d31dda10b750.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PmVoCUvRa6HftBPCyOfpsA.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Successfully completed commit</figcaption></figure><p id="9fc7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您可能需要等待几分钟，Kaggle 服务器才会发布您保存的文件。然后您可以打开您的内核，您将在输出部分看到您的文件，如下所示。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ob"><img src="../Images/600530f227994ea8dda2b3f87f7f257a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oz35_Q2r_wvKLqjQ_0hgvA.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Viewing the saved checkpoint file</figcaption></figure></div><div class="ab cl np nq hu nr" role="separator"><span class="ns bw bk nt nu nv"/><span class="ns bw bk nt nu nv"/><span class="ns bw bk nt nu"/></div><div class="ij ik il im in"><p id="4a56" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">第四步:添加你的内核作为数据集</strong></p><p id="ce24" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这还不是结束。转到最右边的<strong class="ky ir"> +dataset </strong>选项卡，点击它来添加您的内核输出文件作为数据源。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ny nz l"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Adding your kernel output as a dataset</figcaption></figure><p id="2d78" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您的内核现在被列为数据源。打印输入文件夹的内容会将您的内核列为来源之一。</p><p id="8cb1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">有关如何使用代码查看和访问输出文件，请参见下图。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oc"><img src="../Images/a3ea3e999f53b0ce6701a15655bb636a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uTmFjWPGFvQgp7cTbYJD8A.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Accessing your saved output file</figcaption></figure><p id="33d1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">要在侧边栏上查看您的文件，单击 Workspace -&gt; input，然后您会看到您的内核被列为输入目录中的内核下的一个文件。</p></div><div class="ab cl np nq hu nr" role="separator"><span class="ns bw bk nt nu nv"/><span class="ns bw bk nt nu nv"/><span class="ns bw bk nt nu"/></div><div class="ij ik il im in"><p id="c53b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">第五步:加载你的模型</strong></p><p id="e7b8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在你知道如何访问你保存的检查点，你准备好加载你的重量！</p><p id="0d3b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">确保您构建的模型与您保存其状态字典的模型具有相同的架构。有一种方法可以将架构和状态字典都保存在一个文件中，这样你就不用去记忆了，但这不是本教程的重点。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi od"><img src="../Images/49d348e0d430be6c56173e9cd8924a17.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vppfnA-wRfkt5ejSmszs6Q.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Loading the state dictionary to your model</figcaption></figure></div><div class="ab cl np nq hu nr" role="separator"><span class="ns bw bk nt nu nv"/><span class="ns bw bk nt nu nv"/><span class="ns bw bk nt nu"/></div><div class="ij ik il im in"><p id="50b6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">就是这样！</p><p id="6275" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我希望这个-&gt;😃😃😃是您成功加载第一个模型后的心情。勇往直前，繁荣昌盛！当然，请在下面的评论区留下您的反馈。</p></div></div>    
</body>
</html>