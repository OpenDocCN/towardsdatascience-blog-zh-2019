<html>
<head>
<title>How to deal with outliers in a noisy population?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何处理嘈杂人群中的异常值？</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-deal-with-outliers-in-a-noisy-population-736d7a048199?source=collection_archive---------26-----------------------#2019-06-11">https://towardsdatascience.com/how-to-deal-with-outliers-in-a-noisy-population-736d7a048199?source=collection_archive---------26-----------------------#2019-06-11</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="4a23" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">定义异常值可能是一项简单的任务。另一方面，决定如何处理它们总是需要一些更深入的研究。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/105060c1ce3e5b71d3dae2c6f6f23719.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xe2dKed4FnA3YHrTYrTiNQ.jpeg"/></div></div></figure><h1 id="0e2b" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">动机</h1><p id="eff8" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">数据可能会有噪音。当你有一个小的(相对于人口规模)，随机样本的人口，尤其是嘈杂的人口，它可以是一个相当大的挑战，如果不是不可能的，建立一个模型，将概括得很好。</p><p id="3529" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">假设您构建了一个简单的线性模型，该模型对您的数据表现不佳。然后，您决定计算学生化残差，并移除超出特定范围的所有观察值。因此，您的模型更符合数据。最后，你把它投入生产，这是一场噩梦。</p><p id="cdcf" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">噪声数据并不罕见，它会极大地影响您的发现。知道如何识别和如何处理对任何准确的发现都很重要。模拟是帮助我们探索和更好理解这个问题的一个很好的工具。</p><h1 id="5cc2" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">模拟异常值和简单的线性模型</h1><p id="fd6c" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">如果你还没有，你应该建立自己的模拟。这是巩固你从统计教科书或课程中学到的知识的好方法。您可以尝试从头开始创建示例，甚至可以随意修改。</p><p id="6421" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">为此，我喜欢使用 Rstudio。比方说，我们正在就二手车相对于里程数的定价向二手车经销商提供建议。让我们假设这两个变量的大小为 100，可以使用简单的线性回归很好地建模。我将用以下系数定义真实人口回归线:</p><pre class="kg kh ki kj gt mk ml mm mn aw mo bi"><span id="1a19" class="mp ks iq ml b gy mq mr l ms mt">b0 &lt;- 21345<br/>b1 &lt;- -0,1349</span></pre><p id="5348" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">让我们通过从均值为 76950.45、标准偏差为 16978.58 的正态分布中取样来创建独立变量里程:(这些值是根据可用的数据集<a class="ae mu" href="https://github.com/Fumanguyen/drivetime-sedans-used-vehicle-market" rel="noopener ugc nofollow" target="_blank">选择的，此处为</a>。)</p><pre class="kg kh ki kj gt mk ml mm mn aw mo bi"><span id="5695" class="mp ks iq ml b gy mq mr l ms mt">mileage &lt;- rnorm(n = 100, mean = 76950.45, sd = 16978.58)</span></pre><p id="e203" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">接下来，我将引入带有随机误差项的噪声。我将从标准偏差等于 500 的正态分布中对其进行采样，并且我将更改单个值以创建合适的异常值。</p><pre class="kg kh ki kj gt mk ml mm mn aw mo bi"><span id="2a36" class="mp ks iq ml b gy mq mr l ms mt">eps &lt;- rnorm(n = 100, mean = 0, sd = 500)<br/>eps[81] &lt;- 15000</span></pre><p id="4f41" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">通过改变这个单一值，随机误差项标准偏差增加了三倍:</p><pre class="kg kh ki kj gt mk ml mm mn aw mo bi"><span id="5e78" class="mp ks iq ml b gy mq mr l ms mt">&gt; sd(eps)<br/>[1] 1586,312</span></pre><p id="538d" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">因变量的时间:</p><pre class="kg kh ki kj gt mk ml mm mn aw mo bi"><span id="36ec" class="mp ks iq ml b gy mq mr l ms mt">price &lt;- (b0 + b1*mileage + eps)</span></pre><p id="f193" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">让我们绘制数据:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mv"><img src="../Images/57fbb5d19c80c994daa3dcdb6e28cf79.png" data-original-src="https://miro.medium.com/v2/resize:fit:1228/format:webp/1*IOZQvWWOaj_xkA01ZEINyQ.jpeg"/></div><figcaption class="mw mx gj gh gi my mz bd b be z dk">Figure 1: Scatter plot of mileage versus price showing the true regression line in black, the least-squares line in blue and two outliers colored yellow and red.</figcaption></figure><p id="30f1" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">我们可以清楚地看到图 1 中的两个异常值。其余里程值方面，两者都有不寻常的值。两者都是高杠杆点。但是，如果我们只去掉红点，我们会发现它是唯一有影响的点:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mv"><img src="../Images/d59e46148346b769bdea40c0098cb8b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1228/format:webp/1*MqmkAjMPFrZQVZCxdH_YZg.jpeg"/></div><figcaption class="mw mx gj gh gi my mz bd b be z dk">Figure 2: Scatter plot after the removal of the influential point. Although the yellow point is influencing the least-squares line by decreasing its slope, its influence is so small it can be ignored.</figcaption></figure><p id="16b5" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">如果我们比较这两个模型的统计数据，我们可以看到一些非常不同的值。例如，在我们去除影响点之后，剩余标准误差从 1518 下降到 514，这分别非常接近误差项标准偏差的实际值 1586 和 500。</p><p id="7223" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">这是两个残差图:</p><div class="kg kh ki kj gt ab cb"><figure class="na kk nb nc nd ne nf paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/6cf79696ceb5dc0a8fb7bd2b1ddc1cf8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*9wgMWnHGcpO4LfuXfrThew.jpeg"/></div></figure><figure class="na kk nb nc nd ne nf paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/55269d8b2e1a36ecc44143043086efcb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*DEqy2xXuKRf7PR_LF2nL9w.jpeg"/></div><figcaption class="mw mx gj gh gi my mz bd b be z dk ng di nh ni">Figure 3: Left: Scatter plot of the residuals before removing the influential point. Right: Scatter plot of the residuals after removing the influential point.</figcaption></figure></div><p id="91aa" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">我们在本例中没有看到但应该提到的一点是，有时不影响最小二乘方线的异常值可能具有较大的残差。这仍然是一个问题，因为正如我们在上面看到的，一个大的残差会产生一个大的残差标准差，我们用它来确定置信区间和 p 值。</p><h1 id="6c58" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">解决示例问题</h1><p id="7fce" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">现在我们需要决定是否要完全移除影响点。对这个问题要格外小心。你需要一个非常好的理由来删除它。如果我们观察这两个模型的 R 平方，我们会看到很大的不同。具有影响点的模型具有大约 60%的 R 平方，而当影响点被移除时，R 平方为 95%。这种差异可能看起来是删除的一个足够好的理由，但就其本身而言，它不是。</p><p id="df37" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">为了更好地理解这一点，我们需要了解一个经常被忽视的简单事实。我们的目标不是预测过去，而是预测未来。上述数据的小窗口由 100 个单独的观察值组成。在该窗口上计算的每个统计量都是真实总体统计量的点估计。简单的线性回归确实擅长捕捉窗口内两个变量之间的关系，但不一定能捕捉到窗口外的关系。在使用你的模型进行推断时，你应该非常小心。当我们从这两个模型中选择一个时，我们实质上是对总体做了一个假设。没有影响点 RSE 的模型小三倍。这意味着 95%的置信区间将缩小三倍。本质上，我们的预测会更有信心。数据中没有任何东西告诉我们可以对人口做出如此自信的假设。为了了解种群的样子，我们需要做一些研究。与模拟不同，我们永远不会知道真实的人口统计是什么样子。所以我们需要一个想法，我们需要对人口进行假设。</p><p id="6e8e" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">让我们想象一下，我们明显的目的地是我们的客户，汽车拍卖商。车主告诉我们，这辆车是一辆不寻常的旧车，吸引了一小群非常想要它的买家的注意。他们相互竞价，把价格抬得异常高。此外，老板向我们保证，这是该公司 20 多年历史中唯一的一次，不会再发生了。他们处理普通的日常车辆。</p><p id="21e6" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">有了这些知识，我们回到我们的模型，自信地去除异常值。就模型统计而言，这意味着我们确信模型的剩余标准误差为 514，这进一步意味着我们可以假设真实误差项标准偏差接近该数字(因为数据是模拟的，所以我们知道它等于 500)。如果我们想得到正确的其他点估计，这个人口估计是至关重要的。</p><p id="7980" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">如果所有者不是如此自信，我们就不应该决定移除异常值。相反，我们可以探索二手车市场，并试图找到真实误差项标准差的外部估计。如果我们的模型，或者任何其他的模型，忽略了我们不能确信在生产中不会发生的极端值，那么它在投入生产时会表现很差。剔除不当的异常值会导致过于自信的估计。</p><h1 id="1fe3" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">结论</h1><p id="8150" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">忽略或删除异常值是很诱人的。没有非常好的理由不要做它。总是做外部研究，以便找到假设的真实人口统计数据。这可能是说起来容易做起来难。</p><p id="02b0" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">在这个例子中，真实世界不像模拟数据那样容易理解。尽管如此，我认为这个例子应该作为进一步研究的动力。它应该激励你去解决一个现实世界的问题，不仅仅是用一个数学公式来决定你的数据中哪些离群值应该被删除，而是去实验和假设真实的人口统计数据。只有深入了解总体情况，才能回答要剔除哪些异常值的问题。</p><h1 id="fb31" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">参考</h1><p id="5262" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">戴维·M·迭斯、克里斯托弗·D·巴尔(2015 年)。统计学第三版。openintro.org</p><p id="4b07" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">加雷斯·詹姆斯，丹妮拉·威滕，特雷弗·哈斯蒂，罗伯特·蒂布拉尼(2017)。统计学习导论及其在 r。</p><p id="5d32" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">阿里尔·马尔登(2018)。<a class="ae mu" href="https://aosmith.rbind.io/2018/01/09/simulate-simulate-part1/" rel="noopener ugc nofollow" target="_blank">模拟！模拟！—第 1 部分:线性模型。</a></p><p id="e7dd" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">安德鲁·盖尔曼，约翰·卡林(2014)。超越功率计算:评估 S 型(符号)和 M 型(幅度)误差(2014)。心理科学透视第 9 卷第 6 期 641-651 页。</p><p id="6fa0" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">布兰登·福尔茨(2019)。<a class="ae mu" href="https://www.youtube.com/watch?v=fJSXS4oVf88" rel="noopener ugc nofollow" target="_blank">统计学 101:线性回归、异常值和有影响的观察。</a></p></div></div>    
</body>
</html>