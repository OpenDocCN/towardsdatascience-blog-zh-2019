<html>
<head>
<title>Web Scraping Google Sheets with RSelenium</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">ç”¨ RSelenium æŠ“å–è°·æ­Œè¡¨å•</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://towardsdatascience.com/web-scraping-google-sheets-with-rselenium-9001eda399b0?source=collection_archive---------9-----------------------#2019-01-29">https://towardsdatascience.com/web-scraping-google-sheets-with-rselenium-9001eda399b0?source=collection_archive---------9-----------------------#2019-01-29</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/1b0dffeaad7c22c0d83fc7e74908ebe5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eBZrWn2oyPO3oAIm-v5uPg.jpeg"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/photos/ZArDeAtxj0Q?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">freestocks.org</a> on <a class="ae kc" href="https://unsplash.com/search/photos/web-scraping?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="b016" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">æˆ‘å–œæ¬¢å­¦ä¹ æ–°çš„ä¸œè¥¿ï¼Œæˆ‘å­¦å¾—æœ€å¥½çš„æ–¹æ³•ä¹‹ä¸€å°±æ˜¯å®è·µã€‚ä¹Ÿæœ‰äººè¯´<a class="ae kc" href="https://kottke.org/17/06/if-you-cant-explain-something-in-simple-terms-you-dont-understand-it" rel="noopener ugc nofollow" target="_blank">ä½ æ°¸è¿œä¸ä¼šå®Œå…¨ç†è§£ä¸€ä¸ªè¯é¢˜ï¼Œç›´åˆ°ä½ èƒ½å¤Ÿè§£é‡Šå®ƒ</a>ï¼Œæˆ‘è®¤ä¸ºåšå®¢æ˜¯è§£é‡Šäº‹æƒ…çš„ä¸€ä¸ªä½é—¨æ§›ã€‚</p><p id="076b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">æˆ‘åœ¨è’™ç‰¹åˆ©å°”çš„ä¸€ä¸ªå½“åœ°æ•°æ®ç§‘å­¦ä¼šè®®ä¸Šé‡åˆ°çš„ä¸€ä¸ªäººæƒ³è¦å¸®åŠ©ç½‘ç»œæŠ“å–ï¼Œä»¥ä»<a class="ae kc" href="http://www.puzzledpint.com/standings/" rel="noopener ugc nofollow" target="_blank">puzzled point</a>è·å¾—å›¢é˜Ÿæ’åã€‚æˆ‘æŠ“ä½äº†è¿™ä¸ªæœºä¼šï¼Œå› ä¸ºæˆ‘çŸ¥é“è¿™å°†æ˜¯æˆ‘æœ€ç»ˆå­¦ä¹ <a class="ae kc" href="https://github.com/ropensci/RSelenium" rel="noopener ugc nofollow" target="_blank"> <strong class="kf ir">ç¡’çš„æœºä¼šï¼</strong> </a></p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lb"><img src="../Images/9feb84414be89e9fffa33616f6354f4b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*txFP2X4BWaCm0fefpSzqbg.jpeg"/></div></div></figure><h1 id="e464" class="lg lh iq bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">é™æ€åˆ®æ“¦ä¸åŠ¨æ€åˆ®æ“¦</h1><p id="32aa" class="pw-post-body-paragraph kd ke iq kf b kg me ki kj kk mf km kn ko mg kq kr ks mh ku kv kw mi ky kz la ij bi translated">é™æ€æŠ“å–å¿½ç•¥ JavaScriptã€‚å®ƒä¸éœ€è¦æµè§ˆå™¨çš„å¸®åŠ©å°±å¯ä»¥ä»æœåŠ¡å™¨è·å–ç½‘é¡µã€‚ä½ å¾—åˆ°çš„æ­£æ˜¯ä½ åœ¨â€œæŸ¥çœ‹é¡µé¢æºä»£ç â€ä¸­çœ‹åˆ°çš„å†…å®¹ï¼Œç„¶åä½ å¯¹å®ƒè¿›è¡Œåˆ†å‰²ã€‚å¦‚æœä½ æ­£åœ¨å¯»æ‰¾çš„å†…å®¹æ˜¯å¯ç”¨çš„ï¼Œä½ ä¸éœ€è¦å†è¿›ä¸€æ­¥ã€‚ä½†æ˜¯ï¼Œå¦‚æœå†…å®¹ç±»ä¼¼äºâ€œiframe â€,å°±éœ€è¦åŠ¨æ€æŠ“å–ã€‚</p><p id="f022" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">åŠ¨æ€æŠ“å–ä½¿ç”¨å®é™…çš„æµè§ˆå™¨(æˆ–æ— å¤´æµè§ˆå™¨),è®© JavaScript æ¥å®Œæˆå®ƒçš„å·¥ä½œã€‚ç„¶åï¼Œå®ƒæŸ¥è¯¢ DOM æ¥æå–å®ƒæ­£åœ¨å¯»æ‰¾çš„å†…å®¹ã€‚æœ‰æ—¶ï¼Œæ‚¨éœ€è¦é€šè¿‡æ¨¡æ‹Ÿç”¨æˆ·æ¥è·å¾—æ‚¨éœ€è¦çš„å†…å®¹ï¼Œä»è€Œä½¿æµè§ˆå™¨è‡ªåŠ¨åŒ–ã€‚ä¸ºäº†è®©æˆ‘è·å¾—å…¶ä½™å¸–å­çš„ç›¸åŒè¯¦ç»†ä¿¡æ¯ï¼Œæˆ‘éœ€è¦é¦–å…ˆå¯¼èˆªåˆ°ä¸‹ä¸€é¡µï¼Œè¿™åŒ…æ‹¬å•å‡»æœç´¢ç»“æœé¡µåº•éƒ¨çš„ next æŒ‰é’®ã€‚</p><h1 id="0f87" class="lg lh iq bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">ç”¨ Docker è®¾ç½® RSelenium</h1><p id="8860" class="pw-post-body-paragraph kd ke iq kf b kg me ki kj kk mf km kn ko mg kq kr ks mh ku kv kw mi ky kz la ij bi translated">RSelenium ä¸º Selenium Webdriver API æä¾›äº†<strong class="kf ir"> R </strong>ç»‘å®šã€‚Selenium æ˜¯ä¸€ä¸ªä¸“æ³¨äº web æµè§ˆå™¨è‡ªåŠ¨åŒ–çš„é¡¹ç›®ã€‚</p><p id="7b5d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">æ‚¨éœ€è¦éµå¾ª Windows æˆ– Ubuntu ä¸Š Docker Toolbox çš„<a class="ae kc" href="https://docs.docker.com/toolbox/toolbox_install_windows/" rel="noopener ugc nofollow" target="_blank">å®‰è£…è¯´æ˜</a>ã€‚</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mj"><img src="../Images/76450a55caee895510cfdc781a33ef70.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XvJ0GDWOAEHNApZvw-dOVQ.png"/></div></div></figure><p id="686e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Docker é€šè¿‡ä½¿ç”¨å®¹å™¨æ¥è¿è¡Œåº”ç”¨ç¨‹åºã€‚å®¹å™¨åªæ˜¯ä¸€ä¸ªåŒ…ä¸­çš„ä¸€ç»„åº“å’Œå…¶ä»–ä¾èµ–é¡¹ã€‚ä½ å¯ä»¥æŠŠå®ƒæƒ³è±¡æˆä¸€ä¸ªè™šæ‹Ÿæœºï¼Œä½†å®ƒä¸æ˜¯åˆ›å»ºä¸€ä¸ªå®Œæ•´çš„æ“ä½œç³»ç»Ÿï¼Œè€Œæ˜¯å…è®¸åº”ç”¨ç¨‹åºä½¿ç”¨åŒä¸€ä¸ª Linux å†…æ ¸ï¼Œåªæ˜¯æ²¡æœ‰åœ¨ä¸»æœºä¸Šè¿è¡Œã€‚åŸºæœ¬ä¸Šï¼Œå®ƒæ˜¾è‘—æé«˜äº†æ€§èƒ½å¹¶å‡å°äº†åº”ç”¨ç¨‹åºçš„å¤§å°ã€‚æ­¤å¤–ï¼Œæ‚¨å¯ä»¥æ”¾å¿ƒï¼Œåº”ç”¨ç¨‹åºå°†åœ¨ä»»ä½•å…¶ä»– Linux æœºå™¨ä¸Šè¿è¡Œï¼Œè€Œä¸ç®¡è¯¥æœºå™¨çš„ä»»ä½•å®šåˆ¶è®¾ç½®å¯èƒ½ä¸ç”¨äºç¼–å†™å’Œæµ‹è¯•ä»£ç çš„æœºå™¨ä¸åŒã€‚</p><p id="d12c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">ä½ è¿˜éœ€è¦<a class="ae kc" href="http://www.tightvnc.com/download.php" rel="noopener ugc nofollow" target="_blank">å®‰è£… TightVNC </a>ï¼Œè¿™å°†å…è®¸ä½ çœ‹åˆ°ä½ æ˜¯å¦‚ä½•ç”¨ RSelenium å®æ—¶æ“çºµç½‘é¡µçš„ã€‚</p><p id="9a75" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">æ¥ä¸‹æ¥æŒ‰ç…§<a class="ae kc" href="http://ropensci.github.io/RSelenium/articles/docker.html" rel="noopener ugc nofollow" target="_blank">çš„è¯´æ˜åˆ›å»ºä¸€ä¸ª Docker å®¹å™¨ï¼Œè¿è¡Œ selenium æœåŠ¡å™¨å’Œå®ƒè‡ªå·±çš„ firefox </a>ã€‚</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ml"><img src="../Images/0e25922416132f3694c19d879eaa9bb3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rMlftpSVS9BHbh9UBwCgsw.png"/></div></div></figure><blockquote class="mm mn mo"><p id="aaba" class="kd ke mk kf b kg kh ki kj kk kl km kn mp kp kq kr mq kt ku kv mr kx ky kz la ij bi translated"><em class="iq">æ³¨æ„:ä¸€æ—¦ä½ è®¾ç½®äº† docker å®¹å™¨(å¹¶ä¸”æ¯æ¬¡ä½ é‡æ–°å¯åŠ¨ä½ çš„è®¡ç®—æœºæˆ–å†æ¬¡å¯åŠ¨æ—¶),æ‰“å¼€ Docker Quickstart ç»ˆç«¯å¹¶è¿è¡Œä¸‹é¢çš„å‘½ä»¤ã€‚</em></p></blockquote><pre class="lc ld le lf gt ms mt mu mv aw mw bi"><span id="e650" class="mx lh iq mt b gy my mz l na nb">docker run -d -p 4445:4444 selenium/standalone-firefox:2.53.0</span></pre><p id="2a03" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">ç°åœ¨ä½ å·²ç»å¯åŠ¨äº†ä½ çš„<strong class="kf ir"> Docker Quickstart ç»ˆç«¯</strong>è¿›å…¥<strong class="kf ir"> R </strong>å¹¶è¿æ¥åˆ°ä¸€ä¸ªæ­£åœ¨è¿è¡Œçš„æœåŠ¡å™¨ã€‚</p><pre class="lc ld le lf gt ms mt mu mv aw mw bi"><span id="a928" class="mx lh iq mt b gy my mz l na nb">library(RSelenium)<br/>remDr &lt;- remoteDriver(<br/>  remoteServerAddr = "192.168.99.100",<br/>  port = 4445L<br/>)<br/>remDr$open()</span></pre><p id="c575" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">ä½¿ç”¨ Rselenium å¯¼èˆªåˆ°é¡µé¢ã€‚</p><pre class="lc ld le lf gt ms mt mu mv aw mw bi"><span id="6e79" class="mx lh iq mt b gy my mz l na nb"># navigate to the website of interest<br/>remDr$navigate("<a class="ae kc" href="http://www.puzzledpint.com/standings/" rel="noopener ugc nofollow" target="_blank">http://www.puzzledpint.com/standings/</a>")<br/># confirm you got there<br/>remDr$getTitle()0</span></pre><p id="65eb" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">å¥½äº†ï¼Œè®©æˆ‘ä»¬åœ¨ RStudio çš„<strong class="kf ir">æŸ¥çœ‹å™¨</strong>é€‰é¡¹å¡ä¸­è·å–ä¸€ä¸ªç°åœºæˆªå›¾ã€‚</p><pre class="lc ld le lf gt ms mt mu mv aw mw bi"><span id="ce00" class="mx lh iq mt b gy my mz l na nb">remDr$screenshot(display = TRUE)</span></pre><figure class="lc ld le lf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lb"><img src="../Images/d9c9dcd2ca27f732a8b812ddd7e54b30.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tzaElAcPM2Mp-8tiVvHHXg.jpeg"/></div></div></figure><p id="f37c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">è¯·è®°ä½ï¼Œè¿™åªæ˜¯ä¸€ä¸ªé™æ€çš„å±å¹•æˆªå›¾ã€‚åœ¨å¼€å‘ä½ çš„ç®¡é“æ—¶ï¼Œä½ éœ€è¦ä½¿ç”¨<strong class="kf ir"> TightVNC </strong>æ¥å®æ—¶æŸ¥çœ‹ä½ çš„äº’åŠ¨ï¼Œè¿™æ ·ä½ å°±å¯ä»¥çœ‹åˆ°ä½ æ˜¯å¦‚ä½•ä¸ç½‘ç«™äº’åŠ¨çš„ã€‚</p><blockquote class="mm mn mo"><p id="a2e5" class="kd ke mk kf b kg kh ki kj kk kl km kn mp kp kq kr mq kt ku kv mr kx ky kz la ij bi translated">å½“ä½ åœ¨ä½ çš„<code class="fe nc nd ne mt b">â€¦$findElement()</code>å’Œ<code class="fe nc nd ne mt b">â€¦$switchToFrame()</code> / <code class="fe nc nd ne mt b">â€¦$clickElement()</code>å‘½ä»¤ä¹‹é—´ä½¿ç”¨<code class="fe nc nd ne mt b">â€¦$highlightElement()</code>æ—¶ï¼Œæ³¨æ„ TightVNC æ˜¯å¾ˆé‡è¦çš„ï¼Œè¿™æ ·ä½ å®é™…ä¸ŠçŸ¥é“ä½ é€‰æ‹©äº†åˆé€‚çš„ä¸œè¥¿ï¼</p></blockquote><figure class="lc ld le lf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lb"><img src="../Images/59d99f95d4ab7d4ce46ecd3898e86865.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*v4u3CxR8Z3e5PSwnzEpjKQ.jpeg"/></div></div></figure><p id="c06a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">æ‰“å¼€<strong class="kf ir"> TighVNC æŸ¥çœ‹å™¨</strong>ï¼Œè¾“å…¥ç«¯å£å·ï¼›åœ¨æœ¬ä¾‹ä¸­ä¸º<code class="fe nc nd ne mt b">192.168.99.100</code>ï¼Œå¹¶åœ¨<strong class="kf ir">è¿œç¨‹ä¸»æœº:</strong>å­—æ®µä¸­è¾“å…¥ã€‚ç‚¹å‡»<strong class="kf ir">è¿æ¥</strong>ï¼Œè¾“å…¥å¯†ç :<code class="fe nc nd ne mt b">secret</code>ã€‚</p><blockquote class="mm mn mo"><p id="d7ac" class="kd ke mk kf b kg kh ki kj kk kl km kn mp kp kq kr mq kt ku kv mr kx ky kz la ij bi translated">æ³¨æ„:å¦‚æœ TightVNC åœæ­¢å·¥ä½œ(åœ¨ Windows 10 ä¸Šç»å¸¸å¦‚æ­¤)å¹¶ç»™å‡ºé”™è¯¯æ¶ˆæ¯:â€œç”±äºç›®æ ‡æœºå™¨ä¸»åŠ¨æ‹’ç»ï¼Œæ— æ³•å»ºç«‹è¿æ¥â€ï¼Œé‚£ä¹ˆè¯·æŒ‰ç…§<a class="ae kc" href="http://ropensci.github.io/RSelenium/articles/docker.html" rel="noopener ugc nofollow" target="_blank">â€œä½¿ç”¨ VNC è°ƒè¯•â€çš„æ­¥éª¤è¿›è¡Œæ“ä½œã€‚</a></p></blockquote><h1 id="bb40" class="lg lh iq bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">è®¿é—® DOM ä¸­çš„å…ƒç´ </h1><p id="2a1b" class="pw-post-body-paragraph kd ke iq kf b kg me ki kj kk mf km kn ko mg kq kr ks mh ku kv kw mi ky kz la ij bi translated">ç½‘é¡µæ˜¯ä¸€ç»„åµŒå¥—å¯¹è±¡(ç»Ÿç§°ä¸º<strong class="kf ir">æ–‡æ¡£å¯¹è±¡æ¨¡å‹</strong>æˆ–<strong class="kf ir"> DOM </strong>)ã€‚å®ƒæ˜¯ä¸€ç§è·¨å¹³å°å’Œç‹¬ç«‹äºè¯­è¨€çš„çº¦å®šï¼Œç”¨äºè¡¨ç¤º HTMLã€XHTML å’Œ XML æ–‡æ¡£ä¸­çš„å¯¹è±¡å¹¶ä¸ä¹‹äº¤äº’ã€‚ä¸ DOM çš„äº’åŠ¨å¯¹æˆ‘ä»¬ä¸ç¡’å…ƒç´ çš„å…³ç³»éå¸¸é‡è¦ã€‚</p><p id="6a1e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Hadley Wickham å»ºè®®ä½¿ç”¨ Chrome æ‰©å±•è½¯ä»¶<a class="ae kc" href="http://selectorgadget.com/" rel="noopener ugc nofollow" target="_blank"> Selectorgadget </a>ï¼Œæ¥å¸®åŠ©è¯†åˆ«ä½ éœ€è¦çš„ç½‘é¡µå…ƒç´ ã€‚ä»–æ¨è<a class="ae kc" href="http://flukeout.github.io/" rel="noopener ugc nofollow" target="_blank">è¿™ä¸€é¡µ</a>æ¥å­¦ä¹ æ›´å¤šå…³äºé€‰æ‹©å™¨çš„çŸ¥è¯†ã€‚</p><p id="03aa" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">ä¾‹å¦‚ï¼Œé€šè¿‡ä½¿ç”¨ SelectorGadgetï¼Œæ‚¨å¯ä»¥é€‰æ‹©æ„Ÿå…´è¶£çš„è¡¨ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå®ƒè¯´è¿™æ˜¯ä¸€ä¸ª<strong class="kf ir"> iframe </strong>ã€‚ä¸ºäº†ä»…éš”ç¦»æœˆåº¦æ’åï¼Œæˆ‘ä»¬å°†å•å‡»å¦ä¸€ä¸ªæ¡†ï¼Œä»…é€‰æ‹©æ„Ÿå…´è¶£çš„ä¸€ä¸ª:<code class="fe nc nd ne mt b">iframe:nth-child(68)</code>ã€‚</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lb"><img src="../Images/4890e731ad73e6b2b6bff424a9e16efb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RDfMiT9bM80mW7xMeD-jPQ.jpeg"/></div></div></figure><p id="4cc6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">åœ¨ web æµè§ˆå™¨çš„ä¸Šä¸‹æ–‡ä¸­ï¼Œæ¡†æ¶æ˜¯ç½‘é¡µæˆ–æµè§ˆå™¨çª—å£çš„ä¸€éƒ¨åˆ†ï¼Œå®ƒç‹¬ç«‹äºå…¶å®¹å™¨æ˜¾ç¤ºå†…å®¹ï¼Œå¹¶å…·æœ‰ç‹¬ç«‹åŠ è½½å†…å®¹çš„èƒ½åŠ›ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œç½‘ç«™ä»å¦ä¸€ä¸ªæ¥æºè·å–æ•°æ®ï¼Œåœ¨ä¸»æ’åé¡µé¢ä¹‹å¤–ä»¥äº¤äº’æ–¹å¼æ˜¾ç¤ºè¿™äº›è¡¨æ ¼ã€‚å¯¹æˆ‘æ¥è¯´å¹¸è¿çš„æ˜¯ï¼Œå®ƒä»¬éƒ½æ¥è‡ª Google Sheetsï¼Œæ‰€ä»¥è¿™å°†ä½¿æˆ‘æ›´åŠ å®¹æ˜“ã€‚é—æ†¾çš„æ˜¯ï¼Œæ‚¨æ— æ³•ä½¿ç”¨â€œselectorgadgetâ€æ‰¾åˆ°è¿™äº›å·¥ä½œè¡¨çš„é“¾æ¥ã€‚ä½ éœ€è¦åœ¨ Chrome æˆ– Firefox ä¸­ä½¿ç”¨åä¸ºâ€œInspectorâ€çš„å¼€å‘è€…å·¥å…·ä»”ç»†æŸ¥çœ‹æºä»£ç ã€‚å¦‚æœä½ æœ‰ Windows å’Œ Firefoxï¼Œä½ å¯ä»¥ç‚¹å‡»<strong class="kf ir">æ‰“å¼€èœå•</strong>ç„¶åç‚¹å‡»<code class="fe nc nd ne mt b">Web Developer &gt; Inspector</code>æˆ–è€…ç›´æ¥ç‚¹å‡»<code class="fe nc nd ne mt b">Ctrl+Shift+c</code>ã€‚ç„¶åæˆ‘ç”¨æœç´¢æ¡†å¯»æ‰¾ MontrÃ©al çš„é“¾æ¥(<code class="fe nc nd ne mt b">src=</code>)ã€‚</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lb"><img src="../Images/9a772010b47adee78c1fd9b44c8831ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yEL28XbgOFIF0yTR5SmAMg.jpeg"/></div></div></figure><blockquote class="mm mn mo"><p id="83fb" class="kd ke mk kf b kg kh ki kj kk kl km kn mp kp kq kr mq kt ku kv mr kx ky kz la ij bi translated">å¯¹æˆ‘æ¥è¯´ï¼Œæ‰¾åˆ°æˆ‘è¦æ‰¾çš„ä¸œè¥¿æ˜¯ä¸€ä»¶éå¸¸ç—›è‹¦çš„äº‹æƒ…ï¼Œå› ä¸ºæœ‰æ—¶å€™é«˜å…‰çœ‹èµ·æ¥åƒä½ æƒ³è¦çš„ï¼Œä½†å®é™…ä¸Šä¸æ˜¯ã€‚ä¾‹å¦‚:</p></blockquote><figure class="lc ld le lf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lb"><img src="../Images/87475eaf784f11cde239666d426b6c45.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8Bu0acQcB_CpRmdDhOKLtA.jpeg"/></div></div></figure><p id="2549" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">æœ€åï¼Œæˆ‘çŒœè¦å¼„æ¸…æ¥š HTMLï¼Œå®ƒæ¶‰åŠåˆ°é€æ¸çš„â€œ<strong class="kf ir">æ‹’ç»å’Œé”™è¯¯</strong>â€å°è¯•ã€‚</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/27e804387a5a01cb860be2a045fa261b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1228/format:webp/1*CP-fXLA8NMeNbl81qjJ2wQ.jpeg"/></div></figure><h1 id="cb2a" class="lg lh iq bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">ç”¨ RSelenium æŠ“å– Google è¡¨å•</h1><h2 id="80f8" class="mx lh iq bd li ng nh dn lm ni nj dp lq ko nk nl lu ks nm nn ly kw no np mc nq bi translated">æ³•å¾‹å…è´£å£°æ˜</h2><p id="227a" class="pw-post-body-paragraph kd ke iq kf b kg me ki kj kk mf km kn ko mg kq kr ks mh ku kv kw mi ky kz la ij bi translated">å€¼å¾—ä¸€æçš„æ˜¯ï¼Œç®¡ç†å‘˜å¯èƒ½å‡ºäºå¤šç§åŸå› <a class="ae kc" href="http://www.robotstxt.org/norobots-rfc.txt" rel="noopener ugc nofollow" target="_blank">æƒ³è¦ä¿æŠ¤ä»–ä»¬ç½‘ç«™çš„æŸäº›éƒ¨åˆ†</a>ï¼Œä¾‹å¦‚"<em class="mk">å¯¹æœªç»å®£å¸ƒçš„ç«™ç‚¹è¿›è¡Œç´¢å¼•ã€éå†éœ€è¦å¤§é‡æœåŠ¡å™¨èµ„æºçš„ç«™ç‚¹éƒ¨åˆ†ã€é€’å½’éå†æ— é™ URL ç©ºé—´ç­‰ã€‚</em></p><p id="7812" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">å› æ­¤ï¼Œåº”è¯¥ç»å¸¸æ£€æŸ¥ä»–ä»¬æ˜¯å¦æœ‰è®¸å¯ã€‚ä¸€ç§æ–¹æ³•æ˜¯ä½¿ç”¨ robotstxt åŒ…æ¥æ£€æŸ¥ä½ çš„ç½‘ç»œæœºå™¨äººæ˜¯å¦æœ‰æƒé™è®¿é—®ç½‘é¡µçš„æŸäº›éƒ¨åˆ†ã€‚</p><pre class="lc ld le lf gt ms mt mu mv aw mw bi"><span id="f3e2" class="mx lh iq mt b gy my mz l na nb"># check permissions<br/>library(robotstxt)<br/>paths_allowed("<a class="ae kc" href="https://docs.google.com/spreadsheets/d/1o1PlLIQS8v-XSuEz1eqZB80kcJk9xg5lsbueB7mTg1U/pub?output=html&amp;widget=true#gid=690408156" rel="noopener ugc nofollow" target="_blank">https://docs.google.com/spreadsheets/d/1o1PlLIQS8v-XSuEz1eqZB80kcJk9xg5lsbueB7mTg1U/pub?output=html&amp;widget=true#gid=690408156</a>")</span></pre><p id="5653" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">å¦‚æœåœ¨ç‰¹å®šçš„é¡µé¢ä¸Šå†™ç€<strong class="kf ir">çœŸ</strong>ä½ å°±æœ‰æƒé™ã€‚æˆ–è€…ï¼Œåªéœ€è½¬åˆ°ä¸»é¡µ url ä¸Šçš„ robots.txt æ–‡ä»¶ï¼Œå°±å¯ä»¥æ›´å¹¿æ³›åœ°äº†è§£ä»€ä¹ˆæ˜¯å…è®¸çš„(ä»€ä¹ˆæ˜¯ä¸å…è®¸çš„)ã€‚</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/b93008ea8b685f74a5ac3dbceb664ce4.png" data-original-src="https://miro.medium.com/v2/resize:fit:720/format:webp/1*Y5y6dhHtDd_6U0m9L8KNNg.jpeg"/></div></figure><h2 id="a795" class="mx lh iq bd li ng nh dn lm ni nj dp lq ko nk nl lu ks nm nn ly kw no np mc nq bi translated">æ–¹æ³• 1</h2><p id="2110" class="pw-post-body-paragraph kd ke iq kf b kg me ki kj kk mf km kn ko mg kq kr ks mh ku kv kw mi ky kz la ij bi translated">æœ‰æ—¶å€™ç½‘ç«™å¯ä»¥ç”¨æ¡†æ¶æ¥ç»„æˆã€‚è¿™äº›å®é™…ä¸Šæ˜¯è¢«æ”¾åœ¨ä¸€ä¸ªæ¡†æ¶é›†ä¸­çš„ç‹¬ç«‹ç½‘é¡µã€‚æˆ‘ä»¬éœ€è¦åœ¨è¿™äº›å¸§ä¹‹é—´æ¥å›è·³è½¬ã€‚</p><pre class="lc ld le lf gt ms mt mu mv aw mw bi"><span id="9e1d" class="mx lh iq mt b gy my mz l na nb">library(RSelenium)<br/>library(XML)<br/>library(janitor)<br/>library(lubridate)<br/>library(magrittr)<br/>library(dplyr)</span><span id="5d5e" class="mx lh iq mt b gy ns mz l na nb">remDr &lt;- remoteDriver(<br/>  remoteServerAddr = "192.168.99.100",<br/>  port = 4445L<br/>)<br/>remDr$open()</span><span id="7868" class="mx lh iq mt b gy ns mz l na nb"># Now open TightVNC to follow along with Selenium driving the browser. Set 192.168.99.100:5901 and password: secret</span><span id="b734" class="mx lh iq mt b gy ns mz l na nb"># navigate to the main page<br/>remDr$navigate("<a class="ae kc" href="https://docs.google.com/spreadsheets/d/1o1PlLIQS8v-XSuEz1eqZB80kcJk9xg5lsbueB7mTg1U/pub?output=html&amp;widget=true#gid=690408156" rel="noopener ugc nofollow" target="_blank">https://docs.google.com/spreadsheets/d/1o1PlLIQS8v-XSuEz1eqZB80kcJk9xg5lsbueB7mTg1U/pub?output=html&amp;widget=true#gid=690408156</a>")</span><span id="8136" class="mx lh iq mt b gy ns mz l na nb"># <a class="ae kc" href="https://docs.google.com/spreadsheets/d/1o1PlLIQS8v-XSuEz1eqZB80kcJk9xg5lsbueB7mTg1U/pub?output=html&amp;widget=true#gid=552987877" rel="noopener ugc nofollow" target="_blank">https://docs.google.com/spreadsheets/d/1o1PlLIQS8v-XSuEz1eqZB80kcJk9xg5lsbueB7mTg1U/pub?output=html&amp;widget=true#gid=552987877</a></span><span id="ad0c" class="mx lh iq mt b gy ns mz l na nb"># look for table element<br/>tableElem &lt;- remDr$findElement(using = "id", "pageswitcher-content")</span><span id="e619" class="mx lh iq mt b gy ns mz l na nb"># switch to table<br/>remDr$switchToFrame(tableElem)<br/># parse html<br/>doc &lt;- htmlParse(remDr$getPageSource()[[1]])<br/>table_tmp &lt;- readHTMLTable(doc)<br/>table_tmp &lt;- table_tmp[[1]][-2,-1]<br/>table_tmp &lt;- table_tmp[-1,]<br/>colnames(table_tmp) &lt;- c("team_name", "team_size", "start_time", "end_time", "total_time", "puzzels_solved")<br/>table_tmp$city &lt;- rep("montreal", nrow(table_tmp))<br/>table_tmp$date &lt;- rep(Sys.Date()-5, nrow(table_tmp))</span></pre><p id="d152" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">ç°åœ¨æˆ‘ä»¬æœ‰äº†ç¬¬ä¸€ä¸ªæœˆï¼Œæˆ‘ä»¬å¯ä»¥ä¸ºå‰©ä¸‹çš„æ—¥æœŸåˆ›å»ºä¸€ä¸ª for å¾ªç¯ã€‚é¦–å…ˆè®©æˆ‘ä»¬åˆ‡æ¢å›å¤–éƒ¨æ¡†æ¶ï¼Œå¹¶é€‰æ‹©æˆ‘ä»¬å°†è¦æ“ä½œçš„å…ƒç´ ã€‚</p><pre class="lc ld le lf gt ms mt mu mv aw mw bi"><span id="af50" class="mx lh iq mt b gy my mz l na nb"># switch back to the main/outter frame<br/>remDr$switchToFrame(NULL)</span><span id="3a4e" class="mx lh iq mt b gy ns mz l na nb"># find the elements you'll manipulate with Inspector mode in a browser<br/>webElems &lt;- remDr$findElements(using = "css", ".switcherItem") # Month/Year tabs at the bottom<br/>arrowElems &lt;- remDr$findElements(using = "css", ".switcherArrows") # Arrows to scroll left and right at the bottom<br/>tableElem &lt;- remDr$findElement(using = "id", "pageswitcher-content") # The inner table frame</span></pre><p id="0d92" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">æˆ‘çŸ¥é“ä¼šæœ‰å¾ˆå¤šæ¡Œå­ï¼Œä½†æ˜¯åˆ°åº•æœ‰å¤šå°‘å‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥é€šè¿‡<code class="fe nc nd ne mt b">length(webElems)</code>æ¥æ£€æŸ¥è¿™ä¸ªã€‚</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lb"><img src="../Images/43e0b21d50a59bf2f4acc2793d7edd6e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yQhjpdvfaEJ95OvaNY-C8A.jpeg"/></div></div></figure><p id="bf8d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">å®é™…ä¸Šæ€»å…±æœ‰ 49 ä¸ªè¡¨ï¼Œä½†æ˜¯ä»ä¸Šé¢çš„ç¬¬ä¸€ä¸ªè¡¨å¼€å§‹ï¼Œåªæœ‰ 48 ä¸ªé“¾æ¥ã€‚ä¸å…¶ç¡¬ç¼–ç <code class="fe nc nd ne mt b">1:48</code>,ä¸å¦‚é€šè¿‡ä»£ç æ¥å®ç°ï¼Œå› ä¸ºå°†æ¥ä¼šæ·»åŠ æ›´å¤šçš„è¡¨ã€‚</p><pre class="lc ld le lf gt ms mt mu mv aw mw bi"><span id="bcb8" class="mx lh iq mt b gy my mz l na nb"># Create NULL object to be used in forloop<br/>big_df &lt;- NULL<br/>for (i in seq(length(webElems))){ # for every <br/>check &lt;- try(expression, silent = TRUE) # or suppressMessages(try(expression, silent = TRUE))<br/>if (any(class(check) == "try-error")) {<br/>        # choose the i'th Month/Year tab <br/>        webElem &lt;- webElems[[i]]<br/>        webElem$clickElement()</span><span id="d15b" class="mx lh iq mt b gy ns mz l na nb"># Find the tableElem again other wise you get a StaleElementReference <br/>## TO DO: look into WebDriverWait: <a class="ae kc" href="https://stackoverflow.com/questions/5709204/random-element-is-no-longer-attached-to-the-dom-staleelementreferenceexception" rel="noopener ugc nofollow" target="_blank">https://stackoverflow.com/questions/5709204/random-element-is-no-longer-attached-to-the-dom-staleelementreferenceexception</a> <br/>tableElem &lt;- remDr$findElement(using = "id", "pageswitcher-content") # The inner table frame</span><span id="8df6" class="mx lh iq mt b gy ns mz l na nb"># switch to table frame<br/>remDr$switchToFrame(tableElem)<br/>Sys.sleep(3)<br/># parse html with XML package<br/>doc &lt;- htmlParse(remDr$getPageSource()[[1]])<br/>Sys.sleep(3)<br/># Extract data from HTML table in HTML doucment<br/>table_tmp &lt;- readHTMLTable(doc)<br/>Sys.sleep(3)<br/># put this into a format you can use<br/>table &lt;- table_tmp[[1]][-2,-1]<br/>table &lt;- table[-1,]<br/># rename the columns<br/>colnames(table) &lt;- c("team_name", "team_size", "start_time", "end_time", "total_time", "puzzels_solved")<br/># add city name to a column<br/>table$city &lt;- rep("Montreal", nrow(table))</span><span id="cd57" class="mx lh iq mt b gy ns mz l na nb"># add the Month/Year this table was extracted from<br/>today &lt;- Sys.Date() %m-% months(i + 1)<br/>table$date &lt;- today</span><span id="b43c" class="mx lh iq mt b gy ns mz l na nb"># concatenate each table together<br/>big_df &lt;- dplyr::bind_rows(big_df, table)</span><span id="b47b" class="mx lh iq mt b gy ns mz l na nb"># Switch back to the main frame<br/>remDr$switchToFrame(NULL)</span><span id="fc4e" class="mx lh iq mt b gy ns mz l na nb">arrowElem &lt;- arrowElems[[1]]<br/># once you "click"" the element it is "held down" as far as I know there is no way to " unclick"<br/># to prevent it from scrolling too far I make sure not to take too long by setting the sleep short<br/>arrowElem$clickElement()<br/># give it "just enough time" to scroll right<br/>Sys.sleep(0.3)<br/># switch back to outer frame to re-start the loop<br/>remDr$switchToFrame(NULL)<br/>        }<br/>}</span><span id="4baf" class="mx lh iq mt b gy ns mz l na nb">temp1 &lt;- dplyr::bind_rows(table_tmp, big_df)</span></pre><p id="8271" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">è¿™é‡Œçš„é—®é¢˜æ˜¯ï¼Œå½“ for å¾ªç¯è¯•å›¾å•å‡»å³ç®­å¤´æ—¶ï¼Œå®ƒæœ€ç»ˆä¼šå¤±è´¥ï¼Œä½†å®ƒå·²ç»å°½å¯èƒ½åœ°å‘å³äº†ï¼Œå› æ­¤å®ƒä¸ä¼šä¸‹è½½æœ€åå‡ ä¸ªè¡¨(~5)ã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œäººä»¬ä¼šè¿™æ ·å¤„ç†è¿™ç§æƒ…å†µ:</p><pre class="lc ld le lf gt ms mt mu mv aw mw bi"><span id="bfc3" class="mx lh iq mt b gy my mz l na nb">check &lt;- try(expression, silent = TRUE) # or suppressMessages(try(expression, silent = TRUE))<br/>if (any(class(check) == "try-error")) {<br/>  # do stuff<br/>}</span></pre><p id="26d9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">å®ƒé€šå¸¸è¿è¡Œè‰¯å¥½ï¼ŒåŒ…æ‹¬ä½¿ç”¨ç¡’æ—¶ã€‚ç„¶è€Œï¼Œè¿™é‡Œé‡åˆ°çš„é—®é¢˜æ˜¯ï¼Œå•å‡»ä¸€æ¬¡ç®­å¤´æ€»æ˜¯ä¼šå°†æˆ‘å¸¦åˆ°æœ€åä¸€å¼ <em class="mk">å¯è§çš„å·¥ä½œè¡¨ï¼Œè·³è¿‡ä¸­é—´çš„æ‰€æœ‰å†…å®¹ã€‚å› æ­¤ï¼Œæˆ‘çš„å·¥ä½œæ˜¯è¿™æ ·çš„:</em></p><pre class="lc ld le lf gt ms mt mu mv aw mw bi"><span id="813c" class="mx lh iq mt b gy my mz l na nb"># ctrl+x from the google sheet then use the read.delim() to assign it to an object<br/>march &lt;- read.delim("clipboard")<br/>february &lt;- read.delim("clipboard")<br/>january &lt;- read.delim("clipboard")<br/>december &lt;- read.delim("clipboard")<br/>november &lt;- read.delim("clipboard")</span><span id="e084" class="mx lh iq mt b gy ns mz l na nb"># add the city and date<br/>january$city &lt;- rep("montreal", nrow(january))<br/>january$date &lt;- rep("2015-01-30", nrow(january))</span><span id="d89e" class="mx lh iq mt b gy ns mz l na nb">february$city &lt;- rep("montreal", nrow(february))<br/>february$date &lt;- rep("2015-02-15", nrow(february))</span><span id="eaa1" class="mx lh iq mt b gy ns mz l na nb">march$city &lt;- rep("montreal", nrow(march))<br/>march$date &lt;- rep("2015-03-15", nrow(march))</span><span id="f5b7" class="mx lh iq mt b gy ns mz l na nb">december$city &lt;- rep("montreal", nrow(december))<br/>december$date &lt;- rep("2014-12-15", nrow(december))</span><span id="f947" class="mx lh iq mt b gy ns mz l na nb">november$city &lt;- rep("montreal", nrow(november))<br/>november$date &lt;- rep("2014-11-15", nrow(november))</span><span id="8894" class="mx lh iq mt b gy ns mz l na nb"># clean up the column names<br/>january %&lt;&gt;% janitor::clean_names()<br/>february %&lt;&gt;% janitor::clean_names()<br/>march %&lt;&gt;% janitor::clean_names()<br/>december %&lt;&gt;% janitor::clean_names()<br/>november %&lt;&gt;% janitor::clean_names()</span><span id="b578" class="mx lh iq mt b gy ns mz l na nb"># concatenate these five dataframes together<br/>xyz &lt;- bind_rows(march, february, january, december, november)</span><span id="8d8d" class="mx lh iq mt b gy ns mz l na nb"># convert characters into actual dates<br/>xyz$date &lt;-as.Date(xyz$date)</span><span id="c177" class="mx lh iq mt b gy ns mz l na nb"># reorder the columns<br/>xyz %&lt;&gt;% dplyr::select(team_name, team_size, start_time, end_time, total_time, puzzles, city, date)</span><span id="0e6b" class="mx lh iq mt b gy ns mz l na nb"># rename this column to match temp1<br/>xyz &lt;- rename(xyz, puzzels_solved = puzzles)</span><span id="a9df" class="mx lh iq mt b gy ns mz l na nb"># change to a character<br/>xyz$puzzels_solved &lt;- as.character(xyz$puzzels_solved)</span><span id="8d3f" class="mx lh iq mt b gy ns mz l na nb"># add NA for team size<br/>xyz$team_size &lt;- rep(NA, nrow(xyz))</span><span id="5c8b" class="mx lh iq mt b gy ns mz l na nb"># concatenate this onto the larger dataframe<br/>temp2 &lt;- bind_rows(temp1, xyz)</span><span id="7c82" class="mx lh iq mt b gy ns mz l na nb"># save the object<br/>write_csv(temp2, "puzzeld_pint_raw.csv")</span></pre><h2 id="6dfd" class="mx lh iq bd li ng nh dn lm ni nj dp lq ko nk nl lu ks nm nn ly kw no np mc nq bi translated">æ–¹æ³• 2</h2><p id="c837" class="pw-post-body-paragraph kd ke iq kf b kg me ki kj kk mf km kn ko mg kq kr ks mh ku kv kw mi ky kz la ij bi translated">éå¸¸æ„Ÿè°¢ Nate on SO æŒ‡å‡ºäº†ä¸€ä¸ªæ›¿ä»£æ–¹æ¡ˆï¼Œè§£å†³äº†<em class="mk">åºŸå¼ƒè¡¨</em>çš„ä»»åŠ¡ï¼Œä½†<strong class="kf ir">æ²¡æœ‰è§£å†³ä¸Šè¿°æ„ä¹‰ä¸Šçš„</strong>å¼‚å¸¸å¤„ç†çš„ä»»åŠ¡ã€‚</p><pre class="lc ld le lf gt ms mt mu mv aw mw bi"><span id="2e97" class="mx lh iq mt b gy my mz l na nb">remDr &lt;- RSelenium::remoteDriver(<br/>  remoteServerAddr = "192.168.99.100",<br/>  port = 4445L<br/>)<br/>remDr$open(silent = TRUE)</span><span id="d942" class="mx lh iq mt b gy ns mz l na nb"># navigate to the main page<br/># needs no be done once before looping, else content is not available<br/>remDr$navigate("https://docs.google.com/spreadsheets/d/1o1PlLIQS8v-XSuEz1eqZB80kcJk9xg5lsbueB7mTg1U/pub?output=html&amp;widget=true#gid=690408156")</span><span id="767f" class="mx lh iq mt b gy ns mz l na nb"># I. Preliminaries:<br/># <br/># 1. build the links to all spreadsheets<br/># 2. define the function create_table<br/># <br/># 1.<br/># get page source<br/>html &lt;- remDr$getPageSource()[[1]]<br/># split it line by line<br/>html &lt;- unlist(strsplit(html, '\n'))<br/># restrict to script section<br/>script &lt;- grep('^\\s*var\\s+gidMatch', html, value = TRUE)<br/># split the script by semi-colon<br/>script &lt;- unlist(strsplit(script, ';'))<br/># retrieve information<br/>sheet_months &lt;- gsub('.*name:.{2}(.*?).{1},.*', '\\1', <br/>                     grep('\\{name\\s*\\:', script, value = TRUE), perl = TRUE)<br/>sheet_gid &lt;- gsub('.*gid:.{2}(.*?).{1},.*', '\\1', <br/>                  grep('\\gid\\s*\\:', script, value = TRUE), perl = TRUE)<br/>sheet_url &lt;- paste0('https://docs.google.com/spreadsheets/d/1o1PlLIQS8v-XSuEz1eqZB80kcJk9xg5lsbueB7mTg1U/pubhtml/sheet?headers%5Cx3dfalse&amp;gid=',<br/>                    sheet_gid)</span><span id="66cb" class="mx lh iq mt b gy ns mz l na nb"># 2.<br/># table yielding function<br/># just for readability in the loop<br/>create_table &lt;- function (remDr) {<br/>  # parse html with XML package<br/>  doc &lt;- XML::htmlParse(remDr$getPageSource()[[1]])<br/>  Sys.sleep(3)<br/>  # Extract data from HTML table in HTML document<br/>  table_tmp &lt;- XML::readHTMLTable(doc)<br/>  Sys.sleep(3)<br/>  # put this into a format you can use<br/>  table &lt;- table_tmp[[1]][-2, -1]<br/>  # add a check-up for size mismatch<br/>  table_fields &lt;- as.character(t(table[1,]))<br/>  if (! any(grepl("size", tolower(table_fields)))) {<br/>    table &lt;- table[-1, ]<br/>    # rename the columns<br/>    colnames(table) &lt;- c("team_name", "start_time", "end_time", "total_time", "puzzels_solved")<br/>    table$team_size &lt;- NA_integer_<br/>    table &lt;- table[,c("team_name", "team_size", "start_time", "end_time", "total_time", "puzzels_solved")]<br/>  } else {<br/>    table &lt;- table[-1, ]<br/>    # rename the columns<br/>    colnames(table) &lt;- c("team_name", "team_size", "start_time", "end_time", "total_time", "puzzels_solved")<br/>  }<br/>  # add city name to a column<br/>  table$city &lt;- rep("Montreal", nrow(table))<br/><br/>  # add the Month/Year this table was extracted from<br/>  today &lt;- Sys.Date()<br/>  lubridate::month(today) &lt;- lubridate::month(today)+1<br/>  table$date &lt;- today<br/><br/>  # returns the table<br/>  table<br/>}<br/><br/># II. Scrapping the content<br/># <br/># 1. selenium to generate the pages<br/># 2. use create_table to extract the table<br/># <br/>big_df &lt;- NULL<br/>for (k in seq_along(sheet_url)) {<br/>  # 1. navigate to the page<br/>  remDr$navigate(sheet_url[k])<br/>  # remDr$screenshot(display = TRUE) maybe one wants to see progress<br/>  table &lt;- create_table(remDr)<br/><br/>  # 2. concatenate each table together<br/>  big_df &lt;- dplyr::bind_rows(big_df, table)<br/><br/>  # inform progress <br/>  cat(paste0('\nGathered table for: \t', sheet_months[k]))<br/>}<br/><br/># close session<br/>remDr$close()</span></pre><p id="be8b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">è¦æ‰§è¡Œè¿™é¡¹ä»»åŠ¡ï¼Œé¦–å…ˆè¦ç”Ÿæˆæ–‡æ¡£ä¸­æ‰€æœ‰ç”µå­è¡¨æ ¼çš„é“¾æ¥ã€‚ä¸ºæ­¤:</p><ul class=""><li id="ddec" class="nt nu iq kf b kg kh kk kl ko nv ks nw kw nx la ny nz oa ob bi translated">å¯¼èˆªåˆ°æ–‡æ¡£ä¸€æ¬¡</li><li id="a80c" class="nt nu iq kf b kg oc kk od ko oe ks of kw og la ny nz oa ob bi translated">æå–æºä»£ç </li><li id="35e5" class="nt nu iq kf b kg oc kk od ko oe ks of kw og la ny nz oa ob bi translated">ä½¿ç”¨<code class="fe nc nd ne mt b">regex</code>æå–å·¥ä½œè¡¨æœˆä»½å’Œ URL(é€šè¿‡<code class="fe nc nd ne mt b">gid</code>æ•°å­—)</li><li id="7e68" class="nt nu iq kf b kg oc kk od ko oe ks of kw og la ny nz oa ob bi translated">å®Œæˆåï¼Œéå† URLï¼Œæ”¶é›†å¹¶ç»‘å®šè¡¨</li></ul><p id="e77f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">æœ‰ä¸€ä¸ªåä¸º<code class="fe nc nd ne mt b">create_table</code>çš„å°å‡½æ•°ï¼Œå®ƒä»¥æ­£ç¡®çš„æ ¼å¼è¿”å›æœ€ç»ˆçš„è¡¨æ ¼ï¼Œå¹¶å¯¹åˆ—æ•°è¿›è¡Œå®‰å…¨åº¦é‡(ä¸€äº›ç”µå­è¡¨æ ¼æ²¡æœ‰<code class="fe nc nd ne mt b">team_size</code>å­—æ®µâ€”â€”åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘å°†å…¶è®¾ç½®ä¸º<code class="fe nc nd ne mt b">NA_integer</code>)ã€‚</p><p id="9ed1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">å¦‚æœä½ è§‰å¾—è¿™ç¯‡æ–‡ç« æœ‰ç”¨ï¼Œè¯·éšæ„ä¸ä»–äººåˆ†äº«æˆ–æ¨èè¿™ç¯‡æ–‡ç« ï¼ğŸ˜ƒ</p><p id="1d69" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">ä¸€å¦‚æ—¢å¾€ï¼Œå¦‚æœæ‚¨æœ‰ä»»ä½•é—®é¢˜æˆ–æ„è§ï¼Œè¯·éšæ—¶åœ¨ä¸‹é¢ç•™ä¸‹æ‚¨çš„åé¦ˆï¼Œæˆ–è€…æ‚¨å¯ä»¥éšæ—¶é€šè¿‡<a class="ae kc" href="https://www.linkedin.com/in/matthewoldach/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>è”ç³»æˆ‘ã€‚åœ¨é‚£ä¹‹å‰ï¼Œä¸‹ä¸€ç¯‡æ–‡ç« å†è§ï¼ğŸ˜„</p></div></div>    
</body>
</html>