<html>
<head>
<title>Building a Content Based Recommender System for Hotels in Seattle</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">为西雅图的酒店建立基于内容的推荐系统</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/building-a-content-based-recommender-system-for-hotels-in-seattle-d724f0a32070?source=collection_archive---------3-----------------------#2019-03-31">https://towardsdatascience.com/building-a-content-based-recommender-system-for-hotels-in-seattle-d724f0a32070?source=collection_archive---------3-----------------------#2019-03-31</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="ip iq gp gr ir is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/3d2b89dec4d7574a7ebbca6f95a62e05.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*o2BAwSt9etiRqO1nZyMDHg.jpeg"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Photo Credit: Pixabay</figcaption></figure><div class=""/><div class=""><h2 id="bf5b" class="pw-subtitle-paragraph kc je jf bd b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt dk translated">如何使用酒店描述来推荐相似的酒店？</h2></div><p id="6f73" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">对于<a class="ae lq" href="https://en.wikipedia.org/wiki/Recommender_system" rel="noopener ugc nofollow" target="_blank">推荐系统</a>来说，<a class="ae lq" href="https://en.wikipedia.org/wiki/Cold_start_(computing)" rel="noopener ugc nofollow" target="_blank">冷启动</a>问题是一个众所周知且经过充分研究的问题，其中系统不能向用户推荐项目。由于三种不同的情况，即新用户、新产品和新网站。</p><p id="8d6a" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated"><a class="ae lq" href="http://recommender-systems.org/content-based-filtering/" rel="noopener ugc nofollow" target="_blank">基于内容的过滤</a>就是解决这个问题的方法。我们的系统在创建推荐时首先使用新产品的元数据，而在一定时间内访问者的行为是次要的。并且我们的系统基于产品的类别和描述向用户推荐产品。</p><p id="ce68" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">基于内容的推荐系统可以用于从推荐网页、新闻文章、餐馆、电视节目和酒店的各种领域。基于内容的过滤的优点是它没有冷启动问题。如果你刚开始做一个新网站，或者有什么新产品可以马上推荐。</p><p id="49c9" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">假设我们正在创办一家新的在线旅行社(OTA ),我们已经签约了数千家愿意在我们的平台上销售的酒店，我们开始看到来自我们网站用户的流量，但我们没有任何用户历史记录，因此，我们将建立一个基于内容的推荐系统来分析酒店描述，以确定用户特别感兴趣的酒店。</p><p id="0bd0" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">我们希望根据用户已经预订或使用余弦相似度查看的酒店来推荐酒店。我们会推荐与用户之前预订、查看或表示出兴趣的酒店最相似的酒店。我们的推荐系统高度依赖于定义一个合适的相似性度量。最后，我们选择酒店的子集显示给用户，或者确定酒店的显示顺序。</p><h1 id="7783" class="lr ls jf bd lt lu lv lw lx ly lz ma mb kl mc km md ko me kp mf kr mg ks mh mi bi translated">数据</h1><p id="efb9" class="pw-post-body-paragraph ku kv jf kw b kx mj kg kz la mk kj lc ld ml lf lg lh mm lj lk ll mn ln lo lp ij bi translated">很难找到公开可用的酒店描述数据，因此，我自己从西雅图地区 150 多家酒店的主页上收集了这些数据，其中包括市中心的商务酒店、精品酒店和住宿加早餐酒店、机场商务酒店、大学附近的客栈、偏远地区的汽车旅馆等等。数据可以在<a class="ae lq" href="https://github.com/susanli2016/Machine-Learning-with-Python/blob/master/Seattle_Hotels.csv" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p><pre class="mo mp mq mr gt ms mt mu mv aw mw bi"><span id="8ac1" class="mx ls jf mt b gy my mz l na nb">import pandas as pd<br/>import numpy as np<br/>from nltk.corpus import stopwords<br/>from sklearn.metrics.pairwise import linear_kernel<br/>from sklearn.feature_extraction.text import CountVectorizer<br/>from sklearn.feature_extraction.text import TfidfVectorizer<br/>from sklearn.decomposition import LatentDirichletAllocation<br/>import re<br/>import random<br/>import plotly.graph_objs as go<br/>import plotly.plotly as py<br/>import cufflinks<br/>pd.options.display.max_columns = 30<br/>from IPython.core.interactiveshell import InteractiveShell<br/>import plotly.figure_factory as ff<br/>InteractiveShell.ast_node_interactivity = 'all'<br/>from plotly.offline import iplot<br/>cufflinks.go_offline()<br/>cufflinks.set_config_file(world_readable=True, theme='solar')</span><span id="650c" class="mx ls jf mt b gy nc mz l na nb">df = pd.read_csv('Seattle_Hotels.csv', encoding="latin-1")<br/>df.head()<br/>print('We have ', len(df), 'hotels in the data')</span></pre><figure class="mo mp mq mr gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nd"><img src="../Images/ab5bd80d505a3971f907a8c28c4b8ec7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fCQQMz9u4VCaSFsb1MXggg.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Table 1</figcaption></figure><figure class="mo mp mq mr gt is gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/c29a3728c6be6a4152eafb15a6972876.png" data-original-src="https://miro.medium.com/v2/resize:fit:940/format:webp/1*AF7ibwdtaZOtTipqgT7R5g.png"/></div></figure><p id="7832" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">看一些酒店名称和描述对。</p><figure class="mo mp mq mr gt is"><div class="bz fp l di"><div class="nf ng l"/></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">print_description.py</figcaption></figure><pre class="mo mp mq mr gt ms mt mu mv aw mw bi"><span id="73da" class="mx ls jf mt b gy my mz l na nb">print_description(10)</span></pre><figure class="mo mp mq mr gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nh"><img src="../Images/90fea3633969715bf61b3a230dcd0a50.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EIotecVEbkMPLMSTd9ryJQ.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Figure 1</figcaption></figure><pre class="mo mp mq mr gt ms mt mu mv aw mw bi"><span id="00b0" class="mx ls jf mt b gy my mz l na nb">print_description(100)</span></pre><figure class="mo mp mq mr gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ni"><img src="../Images/26299770de597a931c4a492281186faa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ldvaGF51eIHTShPsky6iDw.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Figure 2</figcaption></figure><h1 id="555e" class="lr ls jf bd lt lu lv lw lx ly lz ma mb kl mc km md ko me kp mf kr mg ks mh mi bi translated">电子设计自动化(Electronic Design Automation)</h1><h2 id="94bc" class="mx ls jf bd lt nj nk dn lx nl nm dp mb ld nn no md lh np nq mf ll nr ns mh nt bi translated"><strong class="ak">去除停用词之前的令牌(词汇)频率分布</strong></h2><figure class="mo mp mq mr gt is"><div class="bz fp l di"><div class="nf ng l"/></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">unigram_distribution.py</figcaption></figure><figure class="mo mp mq mr gt is"><div class="bz fp l di"><div class="nu ng l"/></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Figure 3</figcaption></figure><h2 id="161f" class="mx ls jf bd lt nj nk dn lx nl nm dp mb ld nn no md lh np nq mf ll nr ns mh nt bi translated">去除停用词后的标记(词汇)频率分布</h2><figure class="mo mp mq mr gt is"><div class="bz fp l di"><div class="nf ng l"/></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">unigram_distribution_stopwords_removed.py</figcaption></figure><figure class="mo mp mq mr gt is"><div class="bz fp l di"><div class="nu ng l"/></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Figure 4</figcaption></figure><h2 id="4507" class="mx ls jf bd lt nj nk dn lx nl nm dp mb ld nn no md lh np nq mf ll nr ns mh nt bi translated">去除停用词前的二元模型频率分布</h2><figure class="mo mp mq mr gt is"><div class="bz fp l di"><div class="nf ng l"/></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">bigrams_distribution.py</figcaption></figure><figure class="mo mp mq mr gt is"><div class="bz fp l di"><div class="nu ng l"/></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Figure 5</figcaption></figure><h2 id="ff7c" class="mx ls jf bd lt nj nk dn lx nl nm dp mb ld nn no md lh np nq mf ll nr ns mh nt bi translated">去除停用词后的二元模型频率分布</h2><figure class="mo mp mq mr gt is"><div class="bz fp l di"><div class="nf ng l"/></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">bigrams_distribution_stopwords_removed.py</figcaption></figure><figure class="mo mp mq mr gt is"><div class="bz fp l di"><div class="nu ng l"/></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Figure 6</figcaption></figure><h2 id="5d23" class="mx ls jf bd lt nj nk dn lx nl nm dp mb ld nn no md lh np nq mf ll nr ns mh nt bi translated">去除停用词前的三元模型频率分布</h2><figure class="mo mp mq mr gt is"><div class="bz fp l di"><div class="nf ng l"/></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">trigrams_distribution.py</figcaption></figure><figure class="mo mp mq mr gt is"><div class="bz fp l di"><div class="nu ng l"/></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Figure 7</figcaption></figure><h2 id="3ec2" class="mx ls jf bd lt nj nk dn lx nl nm dp mb ld nn no md lh np nq mf ll nr ns mh nt bi translated">去除停用词后的三元模型频率分布</h2><figure class="mo mp mq mr gt is"><div class="bz fp l di"><div class="nf ng l"/></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">trigrams_distribution_stopwords_removed.py</figcaption></figure><figure class="mo mp mq mr gt is"><div class="bz fp l di"><div class="nu ng l"/></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Figure 8</figcaption></figure><p id="a066" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">每个人都知道西雅图的派克市场，它不仅仅是一个公共农贸市场。这是一个充满活力的历史旅游景点，由数百名农民、手工艺者和小企业组成。酒店行业因位置而繁荣，游客寻找可能离市中心和/或城市必游景点最近的酒店。所以，每个酒店如果离酒店不太远，都会吹嘘一番。</p><h2 id="3a11" class="mx ls jf bd lt nj nk dn lx nl nm dp mb ld nn no md lh np nq mf ll nr ns mh nt bi translated">酒店描述字数分布</h2><pre class="mo mp mq mr gt ms mt mu mv aw mw bi"><span id="9d03" class="mx ls jf mt b gy my mz l na nb">df['word_count'] = df['desc'].apply(lambda x: len(str(x).split()))<br/>desc_lengths = list(df['word_count'])</span><span id="19db" class="mx ls jf mt b gy nc mz l na nb">print("Number of descriptions:",len(desc_lengths),<br/>      "\nAverage word count", np.average(desc_lengths),<br/>      "\nMinimum word count", min(desc_lengths),<br/>      "\nMaximum word count", max(desc_lengths))</span></pre><figure class="mo mp mq mr gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nv"><img src="../Images/bdaf9352eab669a5e56428c154ce86a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1188/format:webp/1*rWoPEKu2w7J-QBzmi_4ybQ.png"/></div></div></figure><figure class="mo mp mq mr gt is"><div class="bz fp l di"><div class="nf ng l"/></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">word_count_distribution.py</figcaption></figure><figure class="mo mp mq mr gt is"><div class="bz fp l di"><div class="nu ng l"/></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Figure 9</figcaption></figure><p id="7561" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">许多酒店充分利用描述，知道如何利用吸引人的描述来吸引游客的情绪，从而推动直接预订。他们的描述可能比其他人更长。</p><h1 id="e6e7" class="lr ls jf bd lt lu lv lw lx ly lz ma mb kl mc km md ko me kp mf kr mg ks mh mi bi translated">文本预处理</h1><p id="ca0a" class="pw-post-body-paragraph ku kv jf kw b kx mj kg kz la mk kj lc ld ml lf lg lh mm lj lk ll mn ln lo lp ij bi translated">测试很简单，我们没什么可做的，但以防万一。</p><figure class="mo mp mq mr gt is"><div class="bz fp l di"><div class="nf ng l"/></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">description_preprocessing.py</figcaption></figure><h1 id="adbe" class="lr ls jf bd lt lu lv lw lx ly lz ma mb kl mc km md ko me kp mf kr mg ks mh mi bi translated">建模</h1><ul class=""><li id="e6dc" class="nw nx jf kw b kx mj la mk ld ny lh nz ll oa lp ob oc od oe bi translated">为每家酒店创建一个包含一元、二元和三元模型的 TF-IDF 矩阵。</li><li id="2349" class="nw nx jf kw b kx of la og ld oh lh oi ll oj lp ob oc od oe bi translated">使用<a class="ae lq" href="https://scikit-learn.org/stable/modules/generated/sklearn.metrics.pairwise.linear_kernel.html#sklearn.metrics.pairwise.linear_kernel" rel="noopener ugc nofollow" target="_blank"> sklearn 的 linear_kernel </a>计算所有酒店之间的相似度(相当于我们案例中的<a class="ae lq" href="https://scikit-learn.org/stable/modules/generated/sklearn.metrics.pairwise.cosine_similarity.html#sklearn.metrics.pairwise.cosine_similarity" rel="noopener ugc nofollow" target="_blank">余弦相似度</a>)。</li><li id="2f68" class="nw nx jf kw b kx of la og ld oh lh oi ll oj lp ob oc od oe bi translated">定义一个函数，将酒店名称作为输入，并返回推荐的前 10 家酒店。</li></ul><figure class="mo mp mq mr gt is"><div class="bz fp l di"><div class="nf ng l"/></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">hotel_rec_model.py</figcaption></figure><h1 id="7da9" class="lr ls jf bd lt lu lv lw lx ly lz ma mb kl mc km md ko me kp mf kr mg ks mh mi bi translated">推荐</h1><p id="36af" class="pw-post-body-paragraph ku kv jf kw b kx mj kg kz la mk kj lc ld ml lf lg lh mm lj lk ll mn ln lo lp ij bi translated">大家来做一些推荐吧！</p><pre class="mo mp mq mr gt ms mt mu mv aw mw bi"><span id="7b47" class="mx ls jf mt b gy my mz l na nb">recommendations('Hilton Seattle Airport &amp; Conference Center')</span></pre><figure class="mo mp mq mr gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ok"><img src="../Images/00d7f36de6c1ca6e542845f3168bf006.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ng6dTRsOSfTZcJcVA1feNg.png"/></div></div></figure><p id="3e27" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">对我们的相似性是否起作用的一个好的测试是，当机场酒店是种子时，基于内容的推荐器返回所有机场酒店。</p><p id="1a8e" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">我们也可以问问谷歌。以下是谷歌为“西雅图希尔顿机场和会议中心”推荐的:</p><figure class="mo mp mq mr gt is gh gi paragraph-image"><div class="gh gi ol"><img src="../Images/b9c65a0890a68ab3f4c341a80cee1ebd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1072/format:webp/1*Yja1Ya1YcM-lLMD8H5ciCw.png"/></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Figure 10</figcaption></figure><p id="e367" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">Google 推荐的四分之三也是我们推荐的。</p><p id="f335" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">以下是<a class="ae lq" href="https://www.tripadvisor.ca/Hotel_Review-g58732-d100617-Reviews-Hilton_Seattle_Airport_Conference_Center-SeaTac_Washington.html" rel="noopener ugc nofollow" target="_blank"> tripadvisor </a>为“西雅图希尔顿机场&amp;会议中心”推荐的:</p><figure class="mo mp mq mr gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi om"><img src="../Images/875a315b4659293053709976d5d4e1f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*j0RT4z5dwMa-zt5dPOl5xQ.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Figure 11</figcaption></figure><p id="6153" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">也不错。</p><p id="6922" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">试试住宿加早餐。</p><pre class="mo mp mq mr gt ms mt mu mv aw mw bi"><span id="dff4" class="mx ls jf mt b gy my mz l na nb">recommendations("The Bacon Mansion Bed and Breakfast")</span></pre><figure class="mo mp mq mr gt is gh gi paragraph-image"><div class="gh gi on"><img src="../Images/6ece524778dae3cf767aeb90b3d60bc7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1348/format:webp/1*cWJRnw_zCygKSH34pEFTBA.png"/></div></figure><p id="02cb" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">以下是谷歌推荐的《培根公馆民宿》:</p><figure class="mo mp mq mr gt is gh gi paragraph-image"><div class="gh gi oo"><img src="../Images/fe843fb078f1f5dfc3b5beac1e3c5864.png" data-original-src="https://miro.medium.com/v2/resize:fit:1074/format:webp/1*4dTZKUrUEVwU9jspXpGusA.png"/></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Figure 12</figcaption></figure><p id="9e59" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">酷！</p><p id="8f10" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">以下是 tripadvisor 推荐的《培根公馆民宿》，我印象不深。</p><figure class="mo mp mq mr gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi op"><img src="../Images/cfebb3f9bbd36d0d5b807f696fdd370b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*k0FYWVkV-RPVuFOE4Ye42w.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Figure 13</figcaption></figure><p id="3999" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">Jupyter 笔记本可以在 Github 上找到，如果你喜欢，这是一个<a class="ae lq" href="https://nbviewer.jupyter.org/github/susanli2016/Machine-Learning-with-Python/blob/master/Seattle%20Hotels%20Recommender.ipynb" rel="noopener ugc nofollow" target="_blank"> nbviewer 版本</a>。</p><p id="6bd7" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">祝你一周工作顺利！</p></div></div>    
</body>
</html>