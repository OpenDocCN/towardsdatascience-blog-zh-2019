<html>
<head>
<title>From Econometrics to Machine Learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">从计量经济学到机器学习</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/from-econometrics-to-machine-learning-ee182f3a45d7?source=collection_archive---------5-----------------------#2019-09-08">https://towardsdatascience.com/from-econometrics-to-machine-learning-ee182f3a45d7?source=collection_archive---------5-----------------------#2019-09-08</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="ab24" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">为什么计量经济学应该成为你技能的一部分</h2></div><p id="c8ef" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">作为一名拥有计量经济学硕士学位的数据科学家，我花了一些时间来理解让机器学习成为与计量经济学不同的学科的微妙之处。我想和你们谈谈这些乍一看并不明显的微妙之处，它们让我在整个旅程中都感到好奇。</p><h2 id="e6ba" class="le lf it bd lg lh li dn lj lk ll dp lm kr ln lo lp kv lq lr ls kz lt lu lv lw bi translated">首先…什么是机器学习？…什么是计量经济学？</h2></div><div class="ab cl lx ly hx lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="im in io ip iq"><blockquote class="me mf mg"><p id="8790" class="ki kj mh kk b kl km ju kn ko kp jx kq mi ks kt ku mj kw kx ky mk la lb lc ld im bi translated"><a class="ae ml" href="https://en.wikipedia.org/wiki/Econometrics" rel="noopener ugc nofollow" target="_blank"> <strong class="kk iu"> <em class="it">计量经济学</em> </strong> </a> <em class="it">是将统计方法应用于经济数据，以便赋予经济关系以实证内容。更准确地说，它是“基于理论和观察的并行发展，通过适当的推理方法对实际经济现象进行的定量分析”</em></p></blockquote></div><div class="ab cl lx ly hx lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="im in io ip iq"><blockquote class="me mf mg"><p id="4597" class="ki kj mh kk b kl km ju kn ko kp jx kq mi ks kt ku mj kw kx ky mk la lb lc ld im bi translated"><a class="ae ml" href="https://en.wikipedia.org/wiki/Machine_learning" rel="noopener ugc nofollow" target="_blank"> <strong class="kk iu"> <em class="it">机器学习</em></strong><em class="it">(</em><strong class="kk iu"><em class="it">ML</em></strong><em class="it">)</em></a><em class="it">是计算机系统用来执行特定任务的算法和统计模型的科学研究，不使用明确的指令，而是依靠模式和推理。它被视为人工智能的一个子集。机器学习算法基于样本数据(称为训练数据)构建数学模型，以便在没有明确编程执行任务的情况下做出预测或决策</em></p></blockquote><p id="01b2" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">很好，所以他们看起来都需要数据，都使用统计模型，都做出推论，所以根据他们的定义，机器学习似乎可以处理更广泛的问题，而不仅仅是经济。那么，计量经济学为什么还存在？！这是我在开始计量经济学研究的同时发现机器学习时问自己的问题。</p><p id="db09" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">作为一名未来优秀的经济学家，我需要完美地处理数字，拥有扎实的<code class="fe mm mn mo mp b"><a class="ae ml" href="https://en.wikipedia.org/wiki/Statistics" rel="noopener ugc nofollow" target="_blank">Statistics</a></code>背景，成为<code class="fe mm mn mo mp b"><a class="ae ml" href="https://en.wikipedia.org/wiki/Linear_algebra" rel="noopener ugc nofollow" target="_blank">linear algreba</a> </code>和<code class="fe mm mn mo mp b"><a class="ae ml" href="https://en.wikipedia.org/wiki/Mathematical_optimization" rel="noopener ugc nofollow" target="_blank">Mathematical optimization</a></code>的专家，最后拥有处理数据的计算机技能。这些技能将用于理解、演示应用我的回归、分类、聚类算法或时间序列预测。在这一年里，我将深入学习一些算法，如<em class="mh"/><code class="fe mm mn mo mp b"><a class="ae ml" href="https://en.wikipedia.org/wiki/Linear_regression" rel="noopener ugc nofollow" target="_blank">Linear Regression</a></code><em class="mh"/><code class="fe mm mn mo mp b"><a class="ae ml" href="https://en.wikipedia.org/wiki/Logistic_regression" rel="noopener ugc nofollow" target="_blank">Logistic Regression</a></code><em class="mh"/><code class="fe mm mn mo mp b"><a class="ae ml" href="https://en.wikipedia.org/wiki/K-means_clustering" rel="noopener ugc nofollow" target="_blank">Kmeans</a></code><em class="mh"/><code class="fe mm mn mo mp b"><a class="ae ml" href="https://en.wikipedia.org/wiki/Autoregressive_integrated_moving_average" rel="noopener ugc nofollow" target="_blank">ARIMA</a></code><em class="mh"/><code class="fe mm mn mo mp b"><a class="ae ml" href="https://en.wikipedia.org/wiki/Vector_autoregression" rel="noopener ugc nofollow" target="_blank">VAR</a></code><em class="mh">……等等。等等？</em>这些算法也用于机器学习！</p><h2 id="b5d8" class="le lf it bd lg lh li dn lj lk ll dp lm kr ln lo lp kv lq lr ls kz lt lu lv lw bi translated">从理论效率到经验效率</h2><p id="ba48" class="pw-post-body-paragraph ki kj it kk b kl mq ju kn ko mr jx kq kr ms kt ku kv mt kx ky kz mu lb lc ld im bi translated">机器学习和计量经济学的一个根本区别在于它们的理论基础。计量经济学有扎实的数理统计和概率论基础。算法在数学上是稳健的，具有可论证的和吸引人的性质，这些算法主要基于其基础的稳健性进行评估。</p><p id="ed48" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">对于机器学习，数学当然不会缺席，但它的存在是为了解释算法的行为，而不是展示其可靠性和吸引人的属性。这些算法主要根据它们的经验有效性进行评估。一个非常有启发性的例子是 Xgboost 算法的成功，它的成功归功于它在几个机器学习竞赛中的统治地位，而不是它的数学证明。</p><h2 id="495c" class="le lf it bd lg lh li dn lj lk ll dp lm kr ln lo lp kv lq lr ls kz lt lu lv lw bi translated">从精确到近似</h2><p id="9642" class="pw-post-body-paragraph ki kj it kk b kl mq ju kn ko mr jx kq kr ms kt ku kv mt kx ky kz mu lb lc ld im bi translated">另一个区别是，计量经济学只有一个解决方案，给定一个指定的模型和数据集，参数回归的参数是使用代数公式计算的。系数的<code class="fe mm mn mo mp b"><a class="ae ml" href="https://en.wikipedia.org/wiki/Gauss%E2%80%93Markov_theorem" rel="noopener ugc nofollow" target="_blank">best linear unbiased estimator</a></code> ( <strong class="kk iu">蓝色</strong>)由<a class="ae ml" href="https://en.wikipedia.org/wiki/Ordinary_least_squares" rel="noopener ugc nofollow" target="_blank">普通最小二乘</a> (OLS)估计器在某些假设得到尊重的情况下给出。这里的“最佳”是指与其他无偏的线性估计量相比，给出估计的最低方差。</p><p id="dabc" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">而大多数机器学习算法过于复杂，无法用单一的数学公式来描述。他们的解决方案是通过称为训练阶段的迭代方法在算法上确定的，训练阶段的目标是找到最适合我们数据的解决方案，因此由机器学习算法确定的解决方案是近似的，并且只是最有可能是最优的。</p><h2 id="8393" class="le lf it bd lg lh li dn lj lk ll dp lm kr ln lo lp kv lq lr ls kz lt lu lv lw bi translated">从参数模型到非参数模型</h2><p id="df36" class="pw-post-body-paragraph ki kj it kk b kl mq ju kn ko mr jx kq kr ms kt ku kv mt kx ky kz mu lb lc ld im bi translated">计量经济学模型(即:大多数时候是参数模型)是基于经济理论的。然后使用传统的统计推断工具(如最大似然法)来估计参数模型 mθ中参数向量θ的值。渐近理论然后发挥了重要作用(泰勒的发展，大数定律和中心极限定理…等)。</p><p id="5c16" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">另一方面，在机器学习中，通常构造非参数模型，几乎完全基于数据(没有进行底层分布假设)和所使用的元参数(树深度、惩罚参数等)。)通过交叉验证、网格搜索算法或任何超参数优化算法进行优化。</p><h2 id="61cf" class="le lf it bd lg lh li dn lj lk ll dp lm kr ln lo lp kv lq lr ls kz lt lu lv lw bi translated">从理论到实证的验证</h2><p id="010b" class="pw-post-body-paragraph ki kj it kk b kl mq ju kn ko mr jx kq kr ms kt ku kv mt kx ky kz mu lb lc ld im bi translated">你会明白的，模式会和以前一样，计量经济学依靠稳健的数学测试来验证模型，我们通常说的是模型的<code class="fe mm mn mo mp b"><a class="ae ml" href="https://en.wikipedia.org/wiki/Goodness_of_fit" rel="noopener ugc nofollow" target="_blank">goodness of fit</a></code>。它通过假设检验、残差的正态性评估、样本分布的比较来评估。我们还将讨论<code class="fe mm mn mo mp b"><a class="ae ml" href="https://en.wikipedia.org/wiki/Coefficient_of_determination" rel="noopener ugc nofollow" target="_blank">R²</a> </code>，它是从自变量中可预测的因变量方差的比例，以及<code class="fe mm mn mo mp b"><a class="ae ml" href="https://en.wikipedia.org/wiki/Akaike_information_criterion" rel="noopener ugc nofollow" target="_blank">AIC|BIC</a></code>，它通过<code class="fe mm mn mo mp b"><a class="ae ml" href="https://en.wikipedia.org/wiki/P-value" rel="noopener ugc nofollow" target="_blank">p-value</a></code>评估每个模型相对于其他每个模型或变量评估的质量。</p><p id="66e7" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">机器学习模型的评估将取决于它的预测，其基本思想是，如果模型能够很好地预测，那么它已经成功地学习了数据中的隐藏模式。为了确保模型不会过度拟合，数据集将被分为训练集和测试集，然后使用<code class="fe mm mn mo mp b"><a class="ae ml" href="https://en.wikipedia.org/wiki/Cross-validation_(statistics)" rel="noopener ugc nofollow" target="_blank">cross-validation</a></code>砖块来验证模型的泛化能力，并确保数据分离没有偏差。最后，我们将使用 KPI 来衡量与现实的差距，如<code class="fe mm mn mo mp b"><a class="ae ml" href="https://en.wikipedia.org/wiki/Root-mean-square_deviation" rel="noopener ugc nofollow" target="_blank">RMSE</a>, <a class="ae ml" href="https://en.wikipedia.org/wiki/Mean_absolute_error" rel="noopener ugc nofollow" target="_blank">MAE</a></code>或<code class="fe mm mn mo mp b"><a class="ae ml" href="https://en.wikipedia.org/wiki/Accuracy_and_precision" rel="noopener ugc nofollow" target="_blank">Accuracy</a></code>。</p><h2 id="aae7" class="le lf it bd lg lh li dn lj lk ll dp lm kr ln lo lp kv lq lr ls kz lt lu lv lw bi translated">从理论趋同到目的分歧</h2><p id="609e" class="pw-post-body-paragraph ki kj it kk b kl mq ju kn ko mr jx kq kr ms kt ku kv mt kx ky kz mu lb lc ld im bi translated">计量经济学和机器学习都试图定义一个函数，该函数定义一组将对预测变量建模预测变量:</p><figure class="mw mx my mz gt na gh gi paragraph-image"><div class="gh gi mv"><img src="../Images/9d7b04bbb0848d48fd458f23a79230fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:210/1*5hzZyoer1xyqs4nAvu8Okg.gif"/></div></figure><figure class="mw mx my mz gt na gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/352285924aaa22c36f961c13b9e6299c.png" data-original-src="https://miro.medium.com/v2/resize:fit:292/1*KitFT0z0vkgrMtyAOLXzOQ.gif"/></div></figure><ul class=""><li id="0c79" class="ne nf it kk b kl km ko kp kr ng kv nh kz ni ld nj nk nl nm bi translated">ɛ是随机变量 i.i.d .，规律 N (0，σ2)的实现也称为残差，来自计量经济学，否则 y = f(x)属于机器学习。</li></ul><p id="e1b0" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">理论上，这两者在现阶段似乎是一致的，但在方式和目标上，他们也会有分歧。机器学习的目的是<strong class="kk iu"> y </strong>在大多数情况下，而计量经济学的目的是估计每个预测因子的β。</p><figure class="mw mx my mz gt na gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/4461fbe03711474d54de4bff44c93eaa.png" data-original-src="https://miro.medium.com/v2/resize:fit:406/1*eSleSmHkVrhGZ7aNkNPB4g.gif"/></div></figure><blockquote class="no"><p id="0df0" class="np nq it bd nr ns nt nu nv nw nx ld dk translated">计量经济学的主要目的不是预测而是量化一种经济现象</p></blockquote><h2 id="2ca9" class="le lf it bd lg lh ny dn lj lk nz dp lm kr oa lo lp kv ob lr ls kz oc lu lv lw bi translated">从理论到实践！</h2><p id="f79f" class="pw-post-body-paragraph ki kj it kk b kl mq ju kn ko mr jx kq kr ms kt ku kv mt kx ky kz mu lb lc ld im bi translated">如果我们在实践中观察这些差异，我们将从一个经典的计量经济学模型和一个最广泛使用的模型线性回归开始。为此，我们将通过主要服务于机器学习模型的<code class="fe mm mn mo mp b"><a class="ae ml" href="https://scikit-learn.org/stable/index.html" rel="noopener ugc nofollow" target="_blank">sklearn</a></code>库的实现和更加面向计量经济学的<code class="fe mm mn mo mp b"><a class="ae ml" href="https://www.statsmodels.org/stable/index.html" rel="noopener ugc nofollow" target="_blank">statsmodels</a></code>库的实现来观察我们建模的结果。</p><pre class="mw mx my mz gt od mp oe of aw og bi"><span id="9354" class="le lf it mp b gy oh oi l oj ok">#import library<br/>import pandas as pd<br/>import numpy as np<br/>import seaborn as sns<br/>import statsmodels.api as sm<br/>from sklearn import linear_model</span><span id="583a" class="le lf it mp b gy ol oi l oj ok">#import data <br/>iris = sns.load_dataset("iris")</span></pre><p id="2b48" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们比较一下这两种实现</p><pre class="mw mx my mz gt od mp oe of aw og bi"><span id="c906" class="le lf it mp b gy oh oi l oj ok">dummies = pd.get_dummies(iris["species"], drop_first=False)<br/>iris = pd.concat([iris, dummies], axis=1)<br/>iris.head()</span></pre><figure class="mw mx my mz gt na gh gi paragraph-image"><div role="button" tabindex="0" class="on oo di op bf oq"><div class="gh gi om"><img src="../Images/fb9821d430a6da7ef018dc650946a4b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nq363AaS_BvxhNyZjrp7dA.png"/></div></div></figure><p id="3ecd" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">由于物种是一个分类变量，我们需要将它转换成计算机可以处理的格式，所以我们转向一次性编码格式。让我们从机器学习开始。</p><figure class="mw mx my mz gt na"><div class="bz fp l di"><div class="or os l"/></div></figure><figure class="mw mx my mz gt na gh gi paragraph-image"><div class="gh gi ot"><img src="../Images/b64492ad2d636fd9aecab41c44ec34ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:442/format:webp/1*coec8zJhtuZsZQxgjhyPQA.png"/></div></figure><p id="6f28" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们可以通过模型对象提取模型系数和斜率参数β0。让我们用 statsmodels 试一试。</p><figure class="mw mx my mz gt na"><div class="bz fp l di"><div class="or os l"/></div></figure><figure class="mw mx my mz gt na gh gi paragraph-image"><div class="gh gi ou"><img src="../Images/2d0af7bde591c52654fb5f1707252ae7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1290/format:webp/1*yUTYScHKNMtkyXbbNjx1Yw.png"/></div></figure><p id="6a28" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">与 sklearn 相比，Statsmodels 给了我们很多信息，我们得到了非常好的 R，我们之前讨论过的 AIC、BIC、每个变量的系数和警告。让我们试着预测一下:</p><figure class="mw mx my mz gt na"><div class="bz fp l di"><div class="or os l"/></div></figure><p id="ee26" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们得到了相同的 R 和非常好的 mae 和 Rmse …但是我们认为两个模型的系数不相等。Statsmodels 警告我们，我们的模型有可能是<code class="fe mm mn mo mp b"><a class="ae ml" href="https://en.wikipedia.org/wiki/Multicollinearity" rel="noopener ugc nofollow" target="_blank">Multicollinear</a></code>！这是指一个<a class="ae ml" href="https://en.wikipedia.org/wiki/Multiple_regression" rel="noopener ugc nofollow" target="_blank">多元回归</a>模型中的两个或更多解释变量高度线性相关的情况，这意味着我们的数据集中有冗余信息。这些信息来自物种变量，我们必须放弃一个类别，因为很明显，如果鸢尾不是 setosa 或 verginica 它是杂色的。</p><blockquote class="me mf mg"><p id="923a" class="ki kj mh kk b kl km ju kn ko kp jx kq mi ks kt ku mj kw kx ky mk la lb lc ld im bi translated">这意味着，尽管我们的模型有很强的 R，因此有很强的预测能力，但这些系数是有偏差的，无法解释的。</p></blockquote><p id="027c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">sklearn 尚未将此信息传输给我们。让我们通过传递 drop_first = True 来更正它。</p><figure class="mw mx my mz gt na gh gi paragraph-image"><div class="gh gi ov"><img src="../Images/d871640a51dfb6ec8eeda5587cc259cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1318/format:webp/1*GHlWY9BdlMmNMU6kGApO3g.png"/></div></figure><p id="eae7" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">Statsmodel 删除了它的警告，我们现在有了无偏系数。此外，偏度接近 0，峰度也意味着我们的残差可能是正态的，Jarque-Bera 的概率证实了这是一个很好的模型。让我们重新运行我们的 sklearn 模型:</p><figure class="mw mx my mz gt na gh gi paragraph-image"><div class="gh gi ow"><img src="../Images/5a95a0f0af2a27336ae95d8384061211.png" data-original-src="https://miro.medium.com/v2/resize:fit:452/format:webp/1*66a1YreVPNbZVhB4Y4boeA.png"/></div></figure><p id="03f5" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">最后，我们得到了相同的，让我们做一些阅读。可以看出，在所有其他因素都相同的情况下，花瓣长度增加 1%会使花瓣宽度增加 0.24 厘米。在分类变量的情况下，我们总是指缺失类别。我们可以看到，在所有因素都相同的情况下，verginica 物种的花瓣比缺失物种 setosa 宽 1.04 厘米。所有的 p 值在 5%的阈值下是显著的，因此我们的系数被认为是稳健的和无偏的。我们已经看到了线性回归模型的分析，它也可以转置到分类。逻辑回归在模型分析中提供了一个非常有趣的读数，我会在以后的文章中讨论比值比的读数。</p><p id="5b44" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">阅读模型分析，我会在以后的文章中讨论优势比的阅读。</p><h2 id="a2fd" class="le lf it bd lg lh li dn lj lk ll dp lm kr ln lo lp kv lq lr ls kz lt lu lv lw bi translated">最后</h2><p id="b2fd" class="pw-post-body-paragraph ki kj it kk b kl mq ju kn ko mr jx kq kr ms kt ku kv mt kx ky kz mu lb lc ld im bi translated">计量经济学的概率基础无疑是它的强项，它不仅具有模型的可解释性，还具有不确定性的量化。然而，机器学习模型的预测性能是有趣的，因为它们允许我们突出计量经济学模型的不良规范，并且其中一些算法更适合于非结构化数据。计量经济学旨在严谨，但成为一种非常相关的经济因素分析工具，如果你的经理要求你量化一种影响，它除了给你统计和数学上的合法性外，还可能是相关的。</p></div></div>    
</body>
</html>