<html>
<head>
<title>Deep Neural Networks for Kinship prediction using face photos</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">基于人脸照片的深度神经网络亲属关系预测</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/deep-neural-networks-for-kinship-prediction-using-face-photos-f2ad9ab53834?source=collection_archive---------25-----------------------#2019-05-16">https://towardsdatascience.com/deep-neural-networks-for-kinship-prediction-using-face-photos-f2ad9ab53834?source=collection_archive---------25-----------------------#2019-05-16</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/359a87d55a030a8bb7a705098e0efdac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*a9T4iYgn1Xj6KwaZ5sn3jA.jpeg"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/photos/GFhqLXCJ-g8?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Alex Guillaume</a> on <a class="ae kc" href="https://unsplash.com/search/photos/familly?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="4745" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">给定两个人的面部照片，我们能预测他们是否有血缘关系吗？<br/>这就是我们在本帖中试图通过使用<a class="ae kc" href="https://web.northeastern.edu/smilelab/fiw/" rel="noopener ugc nofollow" target="_blank">野外家庭:一个亲属识别基准</a>数据集来做的事情，数据集的格式在 Kaggle 上共享:<a class="ae kc" href="https://www.kaggle.com/c/recognizing-faces-in-the-wild/data" rel="noopener ugc nofollow" target="_blank">https://www.kaggle.com/c/recognizing-faces-in-the-wild/data</a></p><p id="d8c1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们将探索深度神经网络的有效性，并转移学习技术来训练一个神经网络，该网络将预测两个人是否有血缘关系或是否给定了他们的面部照片。</p><h1 id="7b6e" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">数据集:</h1><p id="f0b9" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们将使用在<a class="ae kc" href="https://www.kaggle.com/c/recognizing-faces-in-the-wild/data" rel="noopener ugc nofollow" target="_blank"> kaggle </a>上共享的野生数据集中的家族。这是同类中规模最大的数据集，其中人脸照片按人分组，然后按家庭分组。</p><figure class="mf mg mh mi gt jr gh gi paragraph-image"><div class="gh gi me"><img src="../Images/ed7b0b5c991f8d2d43a0d4c3c845e94c.png" data-original-src="https://miro.medium.com/v2/resize:fit:958/format:webp/1*am4xEqhFkLlgiu7JC9CrWw.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Image organization in the FIW dataset</figcaption></figure><p id="e0db" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">除了图像文件夹之外，我们还有一个文件，列出了一个家庭中两个人有血缘关系的所有情况，但并不是所有家庭成员都有血缘关系。(就像母亲和父亲，除非我们说的是兰尼斯特😄)</p><h1 id="27b3" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">型号:</h1><p id="dfd3" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">为了解决这个任务，我们将使用一个暹罗网络，它拍摄一对图像，如果照片中的人是相关的，则预测 1，否则预测 0。</p><figure class="mf mg mh mi gt jr gh gi paragraph-image"><div class="gh gi mj"><img src="../Images/65c8bd5f566685a94fe389b9c9e2c0cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:722/format:webp/1*8h3JpmmLLjeDFUHJYGCl0Q.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Siamese Network</figcaption></figure><p id="f720" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">图像编码器应用于每个输入图像，并将它们中的每一个编码成固定长度的向量。两个图像向量之间的差的平方被馈送到完全连接的层，该层然后预测亲属关系的二进制标签。</p><figure class="mf mg mh mi gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mk"><img src="../Images/8ddd5b534377d46a6a8d79516420a143.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YEt68fg0lmm01CWqR6BO1A.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Example of input/output</figcaption></figure><h1 id="b427" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">迁移学习:</h1><p id="1ea5" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们的解决方案将基于使用两种不同设置的预训练图像编码器:</p><p id="e558" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">ImageNet 上的预处理:1400 万张<em class="ml">手动标记图像的数据集，用于分类，如狗、猫、飞机、草莓…</em></p><p id="7280" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><a class="ae kc" href="https://github.com/rcmalli/keras-vggface" rel="noopener ugc nofollow" target="_blank">vgg face 2</a>上的预训练:一个由<em class="ml">330 万张</em>人脸图像和 9000 多个不同种族、口音、职业和年龄的身份组成的数据集。</p><p id="294c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">预训练技术是有用的，因为它们允许我们将在源任务(这里是图像分类或回归)中学到的表征转移到目标任务，在这种情况下是亲属关系预测。<br/>这有助于减少过度拟合，并实现更快的收敛速度，尤其是在源任务和目标任务有些接近的情况下。</p><h1 id="278b" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结果:</h1><p id="eed7" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们将使用准确性和 AUC 分数来评估每个模型的结果。</p><p id="d576" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Resnet50 Imagenet 测试 ROC AUC : <strong class="kf ir"> 0.70 </strong></p><figure class="mf mg mh mi gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mm"><img src="../Images/9c29c1458df8e3b385d32c3ce1839b75.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XzBsM43ttD4px7d-iIx0Yg.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Evaluation on the test set through kaggle submission</figcaption></figure><p id="3963" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Resnet50 VGGFACE2 测试 ROC AUC : <strong class="kf ir"> 0.81 </strong></p><figure class="mf mg mh mi gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mn"><img src="../Images/029d1f8048105bf3cfbf7857291928f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*k1sZBMiXcwP6zsKUWKgDag.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Evaluation on the test set through kaggle submission</figcaption></figure><figure class="mf mg mh mi gt jr gh gi paragraph-image"><div class="gh gi mo"><img src="../Images/a9854cb458b3f9cf0550e96455268be9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*KCpJNyyraN1gyF4H1IfhkA.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Validation Accuracy Comparison</figcaption></figure><p id="4ade" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以看到，即使两种不同设置中的架构是相同的，在 VGGFace2 上预训练的模型<a class="ae kc" href="https://github.com/rcmalli/keras-vggface" rel="noopener ugc nofollow" target="_blank">上的结果也要好得多，因为与 Imagenet 相比，它是更接近亲属预测目标任务的源任务。</a></p><h1 id="4bd9" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论:</h1><p id="7d26" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们展示了我们可以训练一个暹罗网络来预测两个人是否有血缘关系。通过使用迁移学习，我们能够在 AUC ROC 中获得令人鼓舞的结果<strong class="kf ir"> 0.81 </strong>，特别是考虑到亲缘关系的任务👪即使对人类来说，预测也很难。</p><p id="048a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">可在 https://github.com/CVxTz/kinship_prediction<a class="ae kc" href="https://github.com/CVxTz/kinship_prediction" rel="noopener ugc nofollow" target="_blank">获得重现结果的代码</a></p><p id="cbf1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果你有任何问题，请随意评论。</p></div></div>    
</body>
</html>