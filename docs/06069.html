<html>
<head>
<title>Anime2vec : A sequence recommender system</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Anime2vec:一个序列推荐系统</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/anime2vec-a-sequence-recommender-1e0a3e558c44?source=collection_archive---------28-----------------------#2019-09-03">https://towardsdatascience.com/anime2vec-a-sequence-recommender-1e0a3e558c44?source=collection_archive---------28-----------------------#2019-09-03</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="001e" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">从 skipgram 模型中提取嵌入</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/ae704ab84c23d81df72516d05ecf1ad8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*5w0MLK-Hl2eDuU9l.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Source: <a class="ae ky" href="https://arxiv.org/pdf/1309.4168v1.pdf" rel="noopener ugc nofollow" target="_blank">Exploiting Similarities among Languages for Machine Translation</a> paper.</figcaption></figure><p id="db80" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这篇文章中，我将向你展示如何实现一个简单的 word2vec 或<strong class="lb iu"> Anything2vec </strong>的变体，以便拥有一个基于项目的推荐系统。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><p id="d03f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们从我们的数据开始，为了创建一个推荐器，我们需要几个<strong class="lb iu">项目</strong>，一些<strong class="lb iu">用户</strong>和一个隐式或显式的<strong class="lb iu">反馈。</strong>在这里，我们有动漫，有用户，也有他们的评分。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mc"><img src="../Images/c58c99b95860d647ea7f72239c4303c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1148/format:webp/1*lYxA5E6qE03rb7ukPeyEJQ.png"/></div></figure><p id="cd05" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们将重新设计我们的数据，以便它可以被序列模型接收。为此，我们将创建一个数组列表来表示用户的观察列表。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="md me l"/></div></figure><pre class="kj kk kl km gt mf mg mh mi aw mj bi"><span id="8dac" class="mk ml it mg b gy mm mn l mo mp">print(data[:10])</span><span id="4064" class="mk ml it mg b gy mq mn l mo mp">[array([39, 20,  2, 36, 13, 18, 73, 31, 78, 68, 80, 54, 62, 60, 64, 27, 52,<br/>         3, 84, 29, 17, 35, 12, 63,  8], dtype=int64),<br/> array([73,  7, 51, 62, 33,  1, 35, 30, 10, 80,  2], dtype=int64),<br/> array([28,  2, 61, 15, 89, 14, 26,  7,  1, 32, 57,  6], dtype=int64),<br/> array([77, 88, 12,  8,  2, 14, 19, 10, 47,  6,  4], dtype=int64),<br/> array([24,  1,  8, 88, 14, 12,  2,  6, 47, 10], dtype=int64),<br/> array([54,  3, 33, 45, 35,  4, 19, 30,  6,  2, 10], dtype=int64),<br/> array([52, 84, 50,  3, 14, 27, 64, 69, 80, 32,  4], dtype=int64),<br/> array([25, 22,  1, 17, 46, 35, 80,  4, 47,  3, 26], dtype=int64),<br/> array([77, 52, 74, 45, 17, 19,  8,  2, 88, 67,  5,  9, 11,  6,  1,  4, 14,<br/>        22, 47, 26, 29], dtype=int64),<br/> array([38, 36, 83, 85, 31, 42, 53, 58, 13, 23, 56, 65, 39, 72, 37, 74, 70,<br/>        76,  7, 33, 66, 50, 54, 59, 64, 51, 49, 21,  5,  3, 45, 73, 24, 11,<br/>        89, 84, 12, 48, 71,  9,  2,  1, 14, 19, 17, 80,  6,  4, 26],<br/>       dtype=int64)]</span></pre><p id="7f52" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后我们将定义我们的<strong class="lb iu"> SkipGram 模型</strong></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="md me l"/></div></figure><h2 id="16f0" class="mk ml it bd mr ms mt dn mu mv mw dp mx li my mz na lm nb nc nd lq ne nf ng nh bi translated">直觉</h2><blockquote class="ni nj nk"><p id="341f" class="kz la nl lb b lc ld ju le lf lg jx lh nm lj lk ll nn ln lo lp no lr ls lt lu im bi translated"><em class="it">给定一组顺序数据，SkipGram 模型将循环遍历序列的每个</em> <strong class="lb iu"> <em class="it">项</em> </strong> <em class="it">，并尝试使用上下文</em>(固定窗口大小中当前项的每个邻居)<em class="it">来预测当前项。通过这个过程，我们将训练一个简单的神经网络，该网络有一个单独的隐藏层作为分类任务。输出是一个 softmax 层，它返回给定上下文的每个项目成为当前项目的概率分布。在训练过程中，每个权重都会更新，我们将提取隐藏层的权重，即</em> <strong class="lb iu"> <em class="it">项向量</em> </strong> <em class="it">。在我们的例子中，简而言之，该算法将试图找到给定的上一部</em> k <em class="it">和下一部</em> k <em class="it">的理想动画。</em></p></blockquote></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><p id="7e04" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后我们将定义一个生成器函数来提供数据。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="md me l"/></div></figure><p id="e812" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们实例化一些参数。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="md me l"/></div></figure><p id="43cf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们训练我们的模型，提取一个形状的嵌入(len(unique_anime)，200)。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="md me l"/></div></figure><p id="bc3b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，通过嵌入，我们可以提取一些项目-项目相似性。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="md me l"/></div></figure><pre class="kj kk kl km gt mf mg mh mi aw mj bi"><span id="7459" class="mk ml it mg b gy mm mn l mo mp">Nearest to - Clannad:<br/>	Angel Beats ,<br/>	School Days,<br/>	Suzumiya Haruhi no Shoushitsu,<br/>	Suzumiya Haruhi no Yuuutsu 2009 ,<br/>	Code Geass Hangyaku no Lelouch R2,<br/><br/><br/>Nearest to - Mononoke Hime:<br/>	Majo no Takkyuubin,<br/>	Sen to Chihiro no Kamikakushi,<br/>	Hotaru no Haka,<br/>	Samurai Champloo,<br/>	Howl no Ugoku Shiro,<br/><br/><br/>Nearest to - Hajime no Ippo:<br/>	Hajime no Ippo New Challenger,<br/>	Great Teacher Onizuka,<br/>	Monster,<br/>	One Outs,<br/>	Hunter x Hunter 2011 </span></pre><p id="9423" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了获得一些见解，我们可以通过降维算法展示更多的嵌入，通过传递 2 个组件，我们可以在 2D 图中绘制部分相似性。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="md me l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi np"><img src="../Images/0f0bda81cdaf2855a52d4abfffee021d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*d9EybhvJQgqimiPZmTbmlw.png"/></div></div></figure><h2 id="cd9a" class="mk ml it bd mr ms mt dn mu mv mw dp mx li my mz na lm nb nc nd lq ne nf ng nh bi translated">最后</h2><p id="7a77" class="pw-post-body-paragraph kz la it lb b lc nq ju le lf nr jx lh li ns lk ll lm nt lo lp lq nu ls lt lu im bi translated">在这篇文章中，我采用了一个基于动画的 skipgram 模型，这篇文章的结果仅来自于对一个样本的训练，并且是可完善的。代码可用<code class="fe nv nw nx mg b"><a class="ae ky" href="https://github.com/AlexWarembourg/Medium/blob/master/SkipGramModel.ipynb" rel="noopener ugc nofollow" target="_blank">here</a></code>。为了改进这个模型，我们可以用丰富的数据训练我们的模型，然后创建一个用户配置文件，以便将我们基于项目的系统转换为定制系统，我将在另一篇文章中重点讨论这一部分。</p></div></div>    
</body>
</html>