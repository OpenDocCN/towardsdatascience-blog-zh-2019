<html>
<head>
<title>Exploratory Data Analysis in R for beginners (Part 1)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">面向初学者的 R 中的探索性数据分析(第 1 部分)</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/exploratory-data-analysis-in-r-for-beginners-fe031add7072?source=collection_archive---------0-----------------------#2019-10-09">https://towardsdatascience.com/exploratory-data-analysis-in-r-for-beginners-fe031add7072?source=collection_archive---------0-----------------------#2019-10-09</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="2129" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">从数据导入到清理和可视化的逐步方法</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/2dc3fcba6007e804034f047abf45b9d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ej6IfcuIN8oZshTw"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Photo by <a class="ae ky" href="https://unsplash.com/@goumbik?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Lukas Blazek</a> on <a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="18b9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">探索性数据分析</strong> ( <strong class="lb iu"> EDA </strong>)是对数据进行分析和可视化的过程，以更好地理解数据并从中获得洞察力。进行 EDA 时会涉及各种步骤，但以下是数据分析师在进行 EDA 时可以采取的常见步骤:</p><ol class=""><li id="da29" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">导入数据</li><li id="8f31" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">清理数据</li><li id="d057" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">处理数据</li><li id="f472" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">将数据可视化</li></ol><h1 id="c6e8" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">你希望在这篇文章中找到什么？</h1><p id="2545" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">本文重点关注数据集的 EDA，这意味着它将涉及上述所有步骤。因此，本文将带您了解所需的所有步骤以及每个步骤中使用的工具。因此，您可能会在本文中找到以下内容:</p><ol class=""><li id="0a78" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated"><strong class="lb iu">整理数据集的 Tidyverse </strong>包</li><li id="6a0a" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">用于可视化的<strong class="lb iu"> ggplot2 </strong>包</li><li id="ad02" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><strong class="lb iu">相关图</strong>相关图包</li><li id="77dd" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">其他一些操作数据的基本函数，如 strsplit()、cbind()、matrix()等等。</li></ol><p id="acbe" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于 EDA 初学者，<em class="ng">如果你没有很多时间</em>和<em class="ng">不知道从哪里开始</em>，我会推荐你从<strong class="lb iu"> Tidyverse </strong>和<strong class="lb iu"> ggplot2 </strong>开始。你可以用这两个包做几乎所有关于 EDA 的事情。网上有各种资源，像<a class="ae ky" href="https://www.datacamp.com/" rel="noopener ugc nofollow" target="_blank"> DataCamp </a>、<a class="ae ky" href="https://setscholars.net/" rel="noopener ugc nofollow" target="_blank"> Setscholars </a>，还有像<a class="ae ky" href="https://rafalab.github.io/dsbook/" rel="noopener ugc nofollow" target="_blank">Data Science Introduction</a>之类的书籍。</p><p id="d2af" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本文中，我将通过对 PISA 分数数据集的分析，带您了解 EDA 的过程。</p><p id="ee40" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们开始吧，伙计们！！</p><h1 id="d262" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">导入数据</h1><p id="4ca9" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">在将数据导入 R 进行分析之前，让我们看看数据是什么样子的:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nh"><img src="../Images/570ef4407c0054979a4f7a12bf582156.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*20JmQEUtBt7bNMO6tXF0qg.png"/></div></div></figure><p id="ed30" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当将这些数据导入 R 时，我们希望最后一列是“数字”，其余的是“因子”。考虑到这一点，我们来看看以下 3 种情况:</p><pre class="kj kk kl km gt ni nj nk nl aw nm bi"><span id="78b5" class="nn mk it nj b gy no np l nq nr">df.raw &lt;- read.csv(file ='Pisa scores 2013 - 2015 Data.csv', fileEncoding="UTF-8-BOM", na.strings = '..')</span><span id="4391" class="nn mk it nj b gy ns np l nq nr">df.raw1 &lt;- read.csv(file ='Pisa scores 2013 - 2015 Data.csv')</span><span id="ff52" class="nn mk it nj b gy ns np l nq nr">df.raw2 &lt;- read.csv(file ='Pisa scores 2013 - 2015 Data.csv',na.strings = '..')</span></pre><p id="bb3d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是将数据导入 r 的 3 种方式。通常，一种是用 go 导入 df.raw1，因为这似乎是导入数据最方便的方式。让我们看看导入数据的结构:</p><pre class="kj kk kl km gt ni nj nk nl aw nm bi"><span id="5946" class="nn mk it nj b gy no np l nq nr">df.raw1 &lt;- read.csv(file ='Pisa scores 2013 - 2015 Data.csv')</span><span id="c9d0" class="nn mk it nj b gy ns np l nq nr">str(df.raw1)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nt"><img src="../Images/735ab9e043a2e8fa0bb9dea383181b24.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2VSQtE1rVVjPt0OD-qpC6w.png"/></div></div></figure><p id="f243" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以立即发现两个问题。最后一列是“因子”，而不是我们想要的“数字”。其次，第一列“国家名称”的编码不同于原始数据集。</p><p id="9f40" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">现在让我们尝试第二种情况</strong></p><pre class="kj kk kl km gt ni nj nk nl aw nm bi"><span id="5a37" class="nn mk it nj b gy no np l nq nr">df.raw2 &lt;- read.csv(file ='Pisa scores 2013 - 2015 Data.csv',na.strings = '..')</span><span id="2a31" class="nn mk it nj b gy ns np l nq nr">str(df.raw2)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nu"><img src="../Images/88667f6d321287cc160a557a970befbe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bZm_PqmlRoQKDaqVsnzwuw.png"/></div></div></figure><p id="51e0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后一列现在是“数字”。但是，第一列的名称没有正确导入。</p><p id="579d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后一个场景呢？</p><pre class="kj kk kl km gt ni nj nk nl aw nm bi"><span id="1858" class="nn mk it nj b gy no np l nq nr">df.raw &lt;- read.csv(file ='Pisa scores 2013 - 2015 Data.csv', fileEncoding="UTF-8-BOM", na.strings = '..')<br/>str(df.raw)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nv"><img src="../Images/d355790256ed6fc11e1917ba3b37918e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*i4MO0SXNv4kv0TF-U5xqnQ.png"/></div></div></figure><p id="0b08" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如您所见，第一列现在已正确命名，最后一列是“数字”。</p><pre class="kj kk kl km gt ni nj nk nl aw nm bi"><span id="9a84" class="nn mk it nj b gy no np l nq nr"><strong class="nj iu">na.strings = '..'</strong></span></pre><p id="6a2d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这允许 R 用 NA 替换数据集中的那些空白。这将是有用的和方便的，当我们想删除所有的 NA 的时候。</p><pre class="kj kk kl km gt ni nj nk nl aw nm bi"><span id="5811" class="nn mk it nj b gy no np l nq nr"><strong class="nj iu">fileEncoding="UTF-8-BOM"</strong></span></pre><p id="49c1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">用外行人的话来说，这允许 R 正确地读取字符，就像它们出现在原始数据集中一样。</p><h1 id="aee4" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">清理和处理数据</h1><pre class="kj kk kl km gt ni nj nk nl aw nm bi"><span id="2554" class="nn mk it nj b gy no np l nq nr">install.packages("tidyverse")<br/>library(tidyverse)</span></pre><p id="cbef" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们想做一些事情来清理数据集:</p><ol class=""><li id="c322" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">确保数据集中的每一行只对应一个国家:使用 tidyverse 包中的 spread()函数</li><li id="69dd" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">确保只保留有用的列和行:使用 drop_na()和数据子集</li><li id="2e89" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">重命名系列代码列以获得有意义的解释:使用 Rename()</li></ol><pre class="kj kk kl km gt ni nj nk nl aw nm bi"><span id="01e3" class="nn mk it nj b gy no np l nq nr">df &lt;- df.raw[1:1161, c(1, 4, 7)] #select relevant rows and cols<br/>    %&gt;%  spread(key=Series.Code, value=X2015..YR2015.) <br/>    %&gt;%  rename(Maths = LO.PISA.MAT,                        <br/>         Maths.F = LO.PISA.MAT.FE,<br/>         Maths.M = LO.PISA.MAT.MA,<br/>         Reading = LO.PISA.REA,<br/>         Reading.F = LO.PISA.REA.FE,<br/>         Reading.M = LO.PISA.REA.MA,<br/>         Science = LO.PISA.SCI,<br/>         Science.F = LO.PISA.SCI.FE,<br/>         Science.M = LO.PISA.SCI.MA<br/>         ) %&gt;%<br/>  drop_na()</span></pre><p id="81c9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在让我们看看干净的数据是什么样的:</p><pre class="kj kk kl km gt ni nj nk nl aw nm bi"><span id="3cb4" class="nn mk it nj b gy no np l nq nr">view(df)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nw"><img src="../Images/2a1a84fbd22bc5e796d3143f3cacf37f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Mf0innJ2UjdK9CW5HwVMtQ.png"/></div></div></figure><h1 id="d31c" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated"><strong class="ak">可视化数据</strong></h1><ol class=""><li id="c841" class="lv lw it lb b lc nb lf nc li nx lm ny lq nz lu ma mb mc md bi translated"><strong class="lb iu">柱状图</strong></li></ol><pre class="kj kk kl km gt ni nj nk nl aw nm bi"><span id="9623" class="nn mk it nj b gy no np l nq nr">install.packages("ggplot2")<br/>library(ggplot2)</span><span id="b200" class="nn mk it nj b gy ns np l nq nr">#Ranking of Maths Score by Countries</span><span id="2e62" class="nn mk it nj b gy ns np l nq nr">ggplot(data=df,aes(x=reorder(Country.Name,Maths),y=Maths)) + <br/>  geom_bar(stat ='identity',aes(fill=Maths))+<br/>  coord_flip() + <br/>  theme_grey() + <br/>  scale_fill_gradient(name="Maths Score Level")+<br/>  labs(title = 'Ranking of Countries by Maths Score',<br/>       y='Score',x='Countries')+ <br/>  geom_hline(yintercept = mean(df$Maths),size = 1, color = 'blue')</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oa"><img src="../Images/7d774c5d39545aabcef886f96f4b5920.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9tb06znBImtVXeFkugEGkw.png"/></div></div></figure><p id="2213" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">同样，我们也可以通过科学分数和阅读分数来排名，只是相应地改变名称。</p><p id="ecdc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu"> 2。箱线图</strong></p><p id="d085" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果我们使用上面的数据集，我们将无法绘制箱线图。这是因为箱线图只需要 2 个变量 x 和 y，但在我们清理过的数据中，有如此多的变量。所以我们需要把它们合并成两个变量。我们将其命名为<strong class="lb iu"> df2 </strong></p><pre class="kj kk kl km gt ni nj nk nl aw nm bi"><span id="31fe" class="nn mk it nj b gy no np l nq nr">df2 = df[,c(1,3,4,6,7,9,10)] %&gt;%   # select relevant columns <br/>  pivot_longer(c(2,3,4,5,6,7),names_to = 'Score')</span><span id="f2b7" class="nn mk it nj b gy ns np l nq nr">view(df2) </span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/36f951e9f6fbacb80884845726087881.png" data-original-src="https://miro.medium.com/v2/resize:fit:530/format:webp/1*S3VsC475kb9K1PC8ZeKFrw.png"/></div></figure><p id="1edf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">太好了！现在我们可以做箱线图了</p><pre class="kj kk kl km gt ni nj nk nl aw nm bi"><span id="e873" class="nn mk it nj b gy no np l nq nr">ggplot(data = df2, aes(x=Score,y=value, <strong class="nj iu">color=Score</strong>)) + <br/>  geom_boxplot()+<br/>  scale_<strong class="nj iu">color</strong>_brewer(palette="Dark2") + <br/>  geom_jitter(shape=16, position=position_jitter(0.2))+<br/>  labs(title = 'Did males perform better than females?',<br/>       y='Scores',x='Test Type')</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oc"><img src="../Images/67480b5730d8ad1949da67c396365c51.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KoQ33PP64xzbNaXjJg-FIg.png"/></div></div></figure><p id="1d9a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">geom_jitter()允许您在图上绘制数据点。</p><p id="b603" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你可以用上面的代码来得到不同的情节。例如，我可以将“颜色=分数”改为“填充=分数”:</p><pre class="kj kk kl km gt ni nj nk nl aw nm bi"><span id="0314" class="nn mk it nj b gy no np l nq nr">ggplot(data = df2, aes(x=Score,y=value, <strong class="nj iu">fill=Score</strong>)) + <br/>  geom_boxplot()+<br/>  scale_<strong class="nj iu">fill</strong>_brewer(palette="Green") + <br/>  geom_jitter(shape=16, position=position_jitter(0.2))+<br/>  labs(title = 'Did males perform better than females?',<br/>       y='Scores',x='Test Type')</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi od"><img src="../Images/7cc342ab8d5f3d8cf675b913d577f4b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*muDJQ3vkcPjN9NUaGTIybQ.png"/></div></div></figure><p id="572b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">剧情看起来有点乱。一个更好的视觉化方法是将主题和性别分开，并把它们并排放在一起。</p><p id="ea1d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们如何才能做到这一点？</p><p id="2b0e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因为我们想从包含“主题”的列中分离主题和性别。性别’(如数学。f)，我们需要使用 strsplit()来为我们做这项工作</p><pre class="kj kk kl km gt ni nj nk nl aw nm bi"><span id="f379" class="nn mk it nj b gy no np l nq nr">S = numeric(408)     # create an empty vector<br/>for (i in 1:length(df2$Score)) {<br/>  S[i] = strsplit(df2$Score[i],".",fixed = TRUE)<br/>}</span></pre><p id="6cba" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在 S 是 408 个组件的列表，每个组件有 2 个子组件“主题”和“性别”。我们需要将 S 转换成 1 列<strong class="lb iu">主题</strong>和 1 列<strong class="lb iu">性别</strong>的数据帧。我们将这个数据帧命名为<strong class="lb iu"> df3 </strong></p><pre class="kj kk kl km gt ni nj nk nl aw nm bi"><span id="dd4c" class="nn mk it nj b gy no np l nq nr">df3 = S%&gt;%unlist() %&gt;% matrix(ncol = 2, byrow = TRUE)%&gt;% as.data.frame()</span><span id="aecf" class="nn mk it nj b gy ns np l nq nr">view(df3)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oe"><img src="../Images/ade5a4e3b4d7cfc77d3b87e8d949f8b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:280/format:webp/1*nuDN3u7RLeAqgE_NlxWiXg.png"/></div></figure><p id="8b2b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们现在需要将这个<strong class="lb iu"> df3 </strong>与我们之前创建的<strong class="lb iu"> df2 </strong>合并，并将结果命名为<strong class="lb iu"> df4 </strong></p><pre class="kj kk kl km gt ni nj nk nl aw nm bi"><span id="9ad9" class="nn mk it nj b gy no np l nq nr">df4 = cbind(df2,df3) <br/>colnames(df4) = c('Country','Score','Value','Test','Gender')<br/>df4$Score = NULL # since the 'Score' column is redundant<br/>view(df4)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi of"><img src="../Images/3eed215a117a00516aeb93b07295eb8e.png" data-original-src="https://miro.medium.com/v2/resize:fit:644/format:webp/1*AZ1j8MP-AnScOIWjM7clGA.png"/></div></figure><p id="df93" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">厉害！现在数据看起来干净整洁。让我们使用<strong class="lb iu"> ggplot2 </strong>中的<strong class="lb iu"> facet_wrap() </strong>函数创建<strong class="lb iu">多个图</strong></p><pre class="kj kk kl km gt ni nj nk nl aw nm bi"><span id="676f" class="nn mk it nj b gy no np l nq nr">ggplot(data = df4, aes(x=Test,y=Value, fill=Test)) + <br/>  geom_boxplot()+<br/>  scale_fill_brewer(palette="Green") + <br/>  geom_jitter(shape=16, position=position_jitter(0.2))+<br/>  labs(title = 'Did males perform better than females?',<br/>       y='Scores',x='Test')+<br/>  <strong class="nj iu">facet_wrap(~Gender,nrow = 1)</strong></span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi og"><img src="../Images/f87d2ffa420e04f0ddfbaa426e6d7836.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KCpYpIbvoHxF6v8mkJ5uuA.png"/></div></div></figure><p id="a514" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这里，我们按照性别对情节进行分类，因此<strong class="lb iu"> facet_wrap(~Gender，nrow = 1) </strong></p><p id="d277" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们也可以通过改变<strong class="lb iu"> facet_wrap(~Test，nrow = 1) </strong>来对图进行分类</p><pre class="kj kk kl km gt ni nj nk nl aw nm bi"><span id="7364" class="nn mk it nj b gy no np l nq nr">ggplot(data = df4, aes(x=Gender,y=Value, fill=Gender)) + <br/>  geom_boxplot()+<br/>  scale_fill_brewer(palette="Green") + <br/>  geom_jitter(shape=16, position=position_jitter(0.2))+<br/>  labs(title = 'Did males perform better than females?',<br/>       y='Scores',x='')+<br/>  <strong class="nj iu">facet_wrap(~Test,nrow = 1)</strong></span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oh"><img src="../Images/dedd81fc461bf392cd1361f599d0f59e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WXODEDmtS1CB82JltyP2Ww.png"/></div></div></figure><p id="1b4a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">通过观察这些情节，我们可以对男性和女性的表现有所了解。一般来说，男性在科学和数学方面表现更好，但女性在阅读方面表现更好。然而，如果我们只看了箱线图就下结论，那就太天真了。让我们更深入地研究数据，看看在处理数据集后我们还能获得什么其他见解。</p><p id="9e4d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因为我想比较所有参与国家中男性和女性在每一科目中的表现，所以我需要计算男性和女性在每一科目中得分的百分比差异，然后绘制出来以进行可视化。</p><p id="e2c7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在 R 中我该如何做呢？使用 mutate()函数</p><p id="51c5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们看看我们拥有的原始干净数据集，<strong class="lb iu"> df </strong></p><p id="4907" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，我们将使用 mutate()函数来计算每个国家的男性和女性之间的百分比差异。</p><pre class="kj kk kl km gt ni nj nk nl aw nm bi"><span id="d557" class="nn mk it nj b gy no np l nq nr">df = df %&gt;% mutate(Maths.Diff = ((Maths.M - Maths.F)/Maths.F)*100,<br/>         Reading.Diff = ((Reading.M - Reading.F)/Reading.F)*100,<br/>         Science.Diff = ((Science.M - Science.F)/Science.F)*100,<br/>         Total.Score = Maths + Reading + Science,<br/>         Avg.Diff = (Maths.Diff+Reading.Diff+Science.Diff)/3<br/>         )</span><span id="7027" class="nn mk it nj b gy ns np l nq nr">view(df)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oi"><img src="../Images/f2f49f3ac8a2526f6712b70ed9585e52.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*o1jFDioNPeKHN5DFI2a23Q.png"/></div></div></figure><p id="c6d7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在让我们把它画出来，以便更好地可视化数据</p><pre class="kj kk kl km gt ni nj nk nl aw nm bi"><span id="b760" class="nn mk it nj b gy no np l nq nr">##### MATHS SCORE #####<br/>ggplot(data=df, aes(x=reorder(Country.Name, Maths.Diff), y=Maths.Diff)) +<br/>  geom_bar(stat = "identity", aes(fill=Maths.Diff)) +<br/>  coord_flip() +<br/>  theme_light() +<br/>  geom_hline(yintercept = mean(df$Maths.Diff), size=1, color="black") +<br/>  scale_fill_gradient(name="% Difference Level") +<br/>  labs(title="Are Males better at math?", x="", y="% difference from female")</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oh"><img src="../Images/72d9b85b101385178604d8a6c3e0b57f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9bdd3Vjido6-tJfoLl_kCg.png"/></div></div></figure><p id="a257" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">该图表示使用<strong class="lb iu">雌性</strong>作为<strong class="lb iu">参照</strong>的分数差异百分比。<strong class="lb iu">正差异</strong> <strong class="lb iu">表示男性得分较高，负差异表示男性得分较低</strong>。黑线代表所有国家的平均差异。</p><p id="ab66" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">从这里可以得出一些有趣的见解:</p><ul class=""><li id="8149" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu oj mb mc md bi translated">总体而言，男性在数学方面比女性表现更好，尤其是在大多数发展中国家，男性的分数普遍高于女性</li><li id="fa7e" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu oj mb mc md bi translated">有趣的是，在新加坡和香港，女性和男性的表现一样好，在这两个国家的得分差异都在 0 左右。这也许对政策制定者来说是一个很好的见解，因为我们不希望男女在教育方面有巨大的差距。</li></ul><p id="b971" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以对阅读和科学分数做同样的事情。</p><p id="7539" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu"> 3。相关图</strong></p><pre class="kj kk kl km gt ni nj nk nl aw nm bi"><span id="e8a9" class="nn mk it nj b gy no np l nq nr">df = df[,c(1,3,4,6,7,9,10)] #select relevant columns</span></pre><p id="fec2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要创建相关图，只需使用 cor():</p><pre class="kj kk kl km gt ni nj nk nl aw nm bi"><span id="970b" class="nn mk it nj b gy no np l nq nr">res = cor(df[,-1]) # -1 here means we look at all columns except the first column</span><span id="3bcb" class="nn mk it nj b gy ns np l nq nr">res</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ok"><img src="../Images/c96f2344e4b42276ad277eb9f8860297.png" data-original-src="https://miro.medium.com/v2/resize:fit:1362/format:webp/1*74HKjBcY36CKFrEHwfbqww.png"/></div></figure><p id="05f1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以计算 p 值，看看相关性是否显著</p><pre class="kj kk kl km gt ni nj nk nl aw nm bi"><span id="794a" class="nn mk it nj b gy no np l nq nr">install.packages("Hmisc")<br/>library("Hmisc")</span><span id="7919" class="nn mk it nj b gy ns np l nq nr">res2 &lt;- rcorr(as.matrix(df[,-1))</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ol"><img src="../Images/40945d93aa8997a0fa2ecec4df164517.png" data-original-src="https://miro.medium.com/v2/resize:fit:1312/format:webp/1*-NwRWKK29BOYC9KasX86uQ.png"/></div></figure><p id="ce2a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">p 值越小，相关性越显著。</p><p id="2bbe" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">本节关于相关图的目的是向您介绍如何计算 r 中变量之间的相关性。对于这个数据集，很明显所有变量都是相关的</p><p id="4a46" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">想象</p><pre class="kj kk kl km gt ni nj nk nl aw nm bi"><span id="c63b" class="nn mk it nj b gy no np l nq nr">install.packages("corrplot")<br/><br/>library(corrplot)<br/>corrplot(res, type = "upper", order = "hclust", <br/>         tl.col = "black", tl.srt = 45)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi om"><img src="../Images/d30eac48a3444c08531d3dc487fbb266.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BNeiJq_JcI37HVaqqA2OFg.png"/></div></div></figure><p id="e226" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">颜色越浓，尺寸越大，相关性越高。结果和我们之前得到的相似:所有的变量都是相互关联的。</p><p id="aabd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">就是这样！希望你们喜欢这篇文章，并从中有所收获。虽然本指南并不详尽，但它或多或少会给你一些如何用 r 做一些基本 EDA 的想法。</p><p id="b28e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你有任何问题，请在下面的评论区写下来。谢谢你的阅读。祝您愉快，编程愉快！！！</p></div><div class="ab cl on oo hx op" role="separator"><span class="oq bw bk or os ot"/><span class="oq bw bk or os ot"/><span class="oq bw bk or os"/></div><div class="im in io ip iq"><blockquote class="ou ov ow"><p id="6d60" class="kz la ng lb b lc ld ju le lf lg jx lh ox lj lk ll oy ln lo lp oz lr ls lt lu im bi translated">点击查看本系列<a class="ae ky" href="https://medium.com/@hoangkhangtran99/exploratory-data-analysis-in-r-for-beginners-part-2-5bfd35fc9781" rel="noopener">的第 2 部分</a></p><p id="d58a" class="kz la ng lb b lc ld ju le lf lg jx lh ox lj lk ll oy ln lo lp oz lr ls lt lu im bi translated">如果你有兴趣，可以看看我在<a class="ae ky" rel="noopener" target="_blank" href="/implement-random-forest-in-r-b00b69eb8501">随机森林</a>和<a class="ae ky" rel="noopener" target="_blank" href="/implementing-prophet-time-series-forecasting-model-f16d2a191acc">预测</a>上的其他帖子！</p></blockquote></div></div>    
</body>
</html>