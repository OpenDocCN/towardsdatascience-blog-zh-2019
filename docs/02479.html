<html>
<head>
<title>Oracle Machine Learning for Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">面向 Python 的 Oracle 机器学习</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/oracle-machine-learning-for-python-e335fc0a50e8?source=collection_archive---------12-----------------------#2019-04-23">https://towardsdatascience.com/oracle-machine-learning-for-python-e335fc0a50e8?source=collection_archive---------12-----------------------#2019-04-23</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="d684" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated"><strong class="ak">oml 4 py</strong>:Oracle 高级分析的 Python 扩展。</h2></div><h1 id="b8bc" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">引言。</h1><p id="3a3b" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">这些天，我和我的同事 C. De Bari 正在为客户和合作伙伴安排培训，我们将在培训中讨论 Oracle <strong class="lc iu">针对 Python 的机器学习</strong>。酷，但这是什么？</p><p id="aa33" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">Oracle DB 很久以来就有一个选项叫做:<strong class="lc iu"> Oracle 高级分析</strong>。它是一个选项，让您可以访问许多广泛使用的机器学习算法，并使您能够运行这些算法，而无需将数据从数据库中移出。</p><p id="91fa" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">有很多算法可用。用于回归、分类、异常检测、聚类、特征提取等的算法。名单很长。</p><p id="3717" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">将这些算法作为 Oracle DB 的一部分，不仅可以让您在不将数据从数据库中移出的情况下获得机器学习的能力，以及安全性、效率等方面的所有积极影响，还可以利用底层并行数据库引擎。</p><p id="c537" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">到目前为止，唯一可用的接口是:PL/SQL 和 R. <strong class="lc iu"> OML4Py </strong>让您能够调用所有这些算法，其中一些是最近添加的，使用的是现在数据科学中使用最广泛的语言:<strong class="lc iu"> Python </strong>。</p><p id="e98e" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">OML4Py 将很快作为 Oracle Database 19c 的一部分在内部提供，然后作为<strong class="lc iu"> Oracle Cloud 的一部分。</strong></p><h1 id="ff97" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">Python 客户端库。</h1><p id="1805" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">首先，我们可以将 OML4PY 看作一个<strong class="lc iu">客户端库</strong>，您可以在 Python 程序或 Jupyter 笔记本中使用它来调用 Oracle 机器学习算法。</p><p id="2bed" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">好的一面是，这个库的设计使得那些已经在使用像 Scikit-learn 这样的开源框架的人开始编写 ML 代码变得更加容易。API 非常相似。</p><p id="a8fd" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">使用 OML4PY，您可以:</p><ul class=""><li id="b0a5" class="mb mc it lc b ld lw lg lx lj md ln me lr mf lv mg mh mi mj bi translated">连接到数据库</li><li id="666e" class="mb mc it lc b ld mk lg ml lj mm ln mn lr mo lv mg mh mi mj bi translated">创建 Python 数据帧，它们是 Oracle DB 表的代理对象</li><li id="cec1" class="mb mc it lc b ld mk lg ml lj mm ln mn lr mo lv mg mh mi mj bi translated">根据这些表中的数据训练您选择的算法</li><li id="614b" class="mb mc it lc b ld mk lg ml lj mm ln mn lr mo lv mg mh mi mj bi translated">给你的算法打分，提高性能</li><li id="08bb" class="mb mc it lc b ld mk lg ml lj mm ln mn lr mo lv mg mh mi mj bi translated">根据新数据进行预测</li></ul><p id="d5d7" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">OML4Py 将通过基于<strong class="lc iu"> cx_Oracle </strong>的 Python 模块(OML)提供。</p><h1 id="4fe8" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">部署架构。</h1><figure class="mq mr ms mt gt mu gh gi paragraph-image"><div role="button" tabindex="0" class="mv mw di mx bf my"><div class="gh gi mp"><img src="../Images/8cc38823833d6a0f44f06de4c9ae80aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yUPXFxpn0W418At1VvSqtg.png"/></div></div></figure><h1 id="86bb" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">代理对象。</h1><p id="76b9" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">这是一个很好的特点。</p><p id="1910" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">如果你在<strong class="lc iu"> scikit-learn </strong>上学习过 ML，你会意识到很多例子都使用了包装在 Pandas DataFrame 中的数据。<strong class="lc iu"> DataFrame </strong>是一种表格结构，在许多方面类似于 DB 表，有行和列。您可以使用一行 Python 代码从 csv 文件或 Oracle DB 表中加载 Pandas 数据帧。但是熊猫的数据帧完全保存在内存中。因此，它的大小受到可用内存的限制。</p><p id="fff4" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">使用 OML4Py，在与 Oracle DB 建立连接之后，您可以轻松地创建一个与 DB 表同步的<strong class="lc iu"> OML 数据框架</strong>。</p><pre class="mq mr ms mt gt nb nc nd ne aw nf bi"><span id="afa3" class="ng kj it nc b gy nh ni l nj nk">data = oml.sync(table = 'BREASTCANCER')</span></pre><p id="d0ef" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">有什么区别？不同的是，“数据”是一个“<strong class="lc iu">代理对象</strong>”。同步调用不会将内存中的数据从数据库中取出。相反，它将 Python 对象连接到 DB 表，对 OML 数据帧对象的所有后续调用都将被翻译成在 DB 内部执行的 SQL 指令。</p><p id="c491" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">例如，您可以调用:</p><pre class="mq mr ms mt gt nb nc nd ne aw nf bi"><span id="8549" class="ng kj it nc b gy nh ni l nj nk">data.head()</span></pre><p id="0773" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">其中数据是 OML 数据帧，你会在你的笔记本上看到前 10 行的列表。head 调用被翻译成一个<strong class="lc iu"> SQL SELECT </strong>语句，只有第一行从 DB 中提取出来并返回给 Python 进程。</p><p id="8193" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">从最大似然的观点来看，重要的是你将使用 OML 数据框架作为训练你的最大似然算法的起点，就像你在 scikit-learn 中使用熊猫数据框架一样。</p><p id="3ffc" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">如果需要，您也可以从 OML 数据帧中提取熊猫数据帧，使用:</p><pre class="mq mr ms mt gt nb nc nd ne aw nf bi"><span id="6bff" class="ng kj it nc b gy nh ni l nj nk">data.pull()</span></pre><p id="2c4d" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">这样你就可以使用你已经开发的所有 Python 代码。</p><h1 id="0fd9" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">算法。</h1><p id="cfa6" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">受支持的 ML 算法列表相当长且完整。</p><p id="c1b9" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">只是给你一个想法，你可以用:</p><ul class=""><li id="dbec" class="mb mc it lc b ld lw lg lx lj md ln me lr mf lv mg mh mi mj bi translated">朴素贝叶斯</li><li id="cefa" class="mb mc it lc b ld mk lg ml lj mm ln mn lr mo lv mg mh mi mj bi translated">广义线性模型</li><li id="26da" class="mb mc it lc b ld mk lg ml lj mm ln mn lr mo lv mg mh mi mj bi translated">决策图表</li><li id="8f88" class="mb mc it lc b ld mk lg ml lj mm ln mn lr mo lv mg mh mi mj bi translated">随机森林</li><li id="30cb" class="mb mc it lc b ld mk lg ml lj mm ln mn lr mo lv mg mh mi mj bi translated">支持向量机(线性，高斯)</li><li id="54e4" class="mb mc it lc b ld mk lg ml lj mm ln mn lr mo lv mg mh mi mj bi translated">k 均值(聚类)</li><li id="9800" class="mb mc it lc b ld mk lg ml lj mm ln mn lr mo lv mg mh mi mj bi translated">一级 SVM(异常检测)</li><li id="3a74" class="mb mc it lc b ld mk lg ml lj mm ln mn lr mo lv mg mh mi mj bi translated">神经网络(目前是密集的)</li></ul><p id="b907" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">但是，您不仅有一个很好的 Oracle DB ML 实现的 Python 接口，还有一些重要的特性，如:</p><ul class=""><li id="20cd" class="mb mc it lc b ld lw lg lx lj md ln me lr mf lv mg mh mi mj bi translated">超参数的自动调谐</li><li id="6add" class="mb mc it lc b ld mk lg ml lj mm ln mn lr mo lv mg mh mi mj bi translated">自动型号选择</li><li id="92e1" class="mb mc it lc b ld mk lg ml lj mm ln mn lr mo lv mg mh mi mj bi translated">自动特征提取</li></ul><p id="c6c9" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">换句话说，<strong class="lc iu"> AutoML </strong>，它可以极大地简化你的机器学习模型的调整，并减少为你的商业案例获得正确模型性能所需的时间。</p><p id="b03e" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">另一个旨在<strong class="lc iu">简化 ML 采用的重要特性</strong>是，许多算法自动处理空值、分类特征编码和特征缩放。在 scikit-learn 中，如果你想获得正确的性能，你必须做所有这些事情写代码。</p><p id="d0ed" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">我已经使用威斯康星乳腺癌数据集对 OML4Py 和 scikit-learn 进行了测试，在所有使用 AutoML 的情况下，我都看到了比 scikit-learn 更好的准确性。我已经达到了相当的准确性，只做特征缩放和准确的超参数选择。有时是一个相当长的过程。</p><h1 id="58b5" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">还有什么？</h1><p id="6728" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">此外，使用 OML4PY，您可以轻松地从 DB 加载和存储数据。</p><p id="8709" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">但是，最有趣的是名为“<strong class="lc iu">嵌入式执行</strong>的特性。这意味着您还可以编写自己的 Python 代码，例如使用 scikit-learn 算法的函数，将该代码存储在数据库中，并调用该函数将其应用于从数据库中选择的数据。只有几行代码。</p><p id="b0a1" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">这是一个有趣的扩展机制，我将在接下来的几周中对其进行更多的探索。</p><h1 id="ba5e" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">举个例子。</h1><p id="5f98" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">在下面的代码示例中，我展示了如何使用支持向量机创建一个机器学习模型，用于对患者进行分类。该示例基于 Wisconsin 乳腺癌数据集，数据存储在 Oracle DB 表中。</p><pre class="mq mr ms mt gt nb nc nd ne aw nf bi"><span id="ff8b" class="ng kj it nc b gy nh ni l nj nk">import oml<br/>from oml.automl import ModelTuning<br/>from oml import algo<br/>import config<br/><br/># connection to Oracle DB...<br/>oml.connect(config.USER,config.PWD,<br/> '(DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=localhost)(PORT=1521))(CONNECT_DATA=(service_name=OAA1)))',<br/> automl=True)<br/># test if connected<br/>oml.isconnected()<br/><br/># create an OML dataframe connected to DB table<br/>BREASTCANCER = oml.sync(table = 'BREASTCANCER')<br/><br/># train, test set split<br/>train_dat, test_dat = BREASTCANCER.split(ratio=(0.8, 0.2), seed=1234)<br/>train_x = train_dat.drop('TARGET')<br/>train_y = train_dat['TARGET']<br/>test_x = test_dat['TARGET']<br/>test_y = test_dat.drop('TARGET')<br/><br/># I'll be using AutoTuning<br/>at = ModelTuning(mining_function = 'classification', parallel=4)<br/><br/># search the best algorithm and fit<br/>results = at.run('svm_linear', train_x, train_y, score_metric='accuracy')<br/><br/>tuned_model = results['best_model']<br/><br/># make the prediction on test set<br/>pred_y = tuned_model.predict(test_x)<br/><br/>test_y_df = test_y.pull()<br/>pred_y_df = pred_y.pull()<br/><br/># utility function based on sklearn for displaying accuracy, precision, recall, F1 score<br/>myutils.print_metrics(pred_y_df, test_y_df)</span></pre><h1 id="97f9" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">结论。</h1><p id="a995" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated"><strong class="lc iu"> OML4PY </strong>是对 Oracle Advanced Analytics 的扩展，它为您提供了一个与 Oracle DB 机器学习算法的友好易用的 Python 接口。</p><p id="dbb7" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">使用 OML4Py，您可以开发 ML 模型，在 Oracle DB 中运行，编写 Python 代码，这些代码在许多方面类似于您使用 scikit-learn 编写的代码。</p><p id="4516" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">但是，除此之外，您还可以使用自动功能选择、自动型号选择和自动调谐等功能。</p><p id="efb0" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated"><strong class="lc iu">它将很快向客户全面推出</strong>，我们正在为意大利的客户和合作伙伴提供一些培训。</p><p id="be2c" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">我将很快就这个主题写一些更详细的文章。</p></div></div>    
</body>
</html>