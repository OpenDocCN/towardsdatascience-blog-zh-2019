<html>
<head>
<title>Data Preparation for Machine Learning: Cleansing, Transformation &amp; Feature Engineering</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">机器学习的数据准备:清洗、转换和特征工程</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/data-preparation-for-machine-learning-cleansing-transformation-feature-engineering-d2334079b06d?source=collection_archive---------5-----------------------#2019-09-19">https://towardsdatascience.com/data-preparation-for-machine-learning-cleansing-transformation-feature-engineering-d2334079b06d?source=collection_archive---------5-----------------------#2019-09-19</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/d3d85252c69e9daa3038f441eb45a7dc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4ycWC6I9G8fEV7Y3mLhaaQ.jpeg"/></div></div></figure><p id="a43f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">数据准备阶段的目的是将数据转换为机器学习的最佳格式，这包括三个阶段:数据清理、数据转换和特征工程。高质量的数据比使用复杂的算法更重要，因此这是非常重要的一步，不应该跳过。</p><h1 id="8c93" class="kw kx iq bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">数据清理</h1><p id="499c" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">在<a class="ae lz" href="https://medium.com/@srnghn/data-understanding-for-machine-learning-assessment-exploration-aca1aadc1cb6" rel="noopener">数据理解</a>活动中，您研究了您的数据并检测到不完整或不正确的值。在此阶段，您需要解决这些问题，活动包括:</p><ul class=""><li id="3e02" class="ma mb iq ka b kb kc kf kg kj mc kn md kr me kv mf mg mh mi bi translated">处理缺失值</li><li id="0c88" class="ma mb iq ka b kb mj kf mk kj ml kn mm kr mn kv mf mg mh mi bi translated">处理异常值</li><li id="3c29" class="ma mb iq ka b kb mj kf mk kj ml kn mm kr mn kv mf mg mh mi bi translated">纠正错别字</li><li id="a276" class="ma mb iq ka b kb mj kf mk kj ml kn mm kr mn kv mf mg mh mi bi translated">分组稀疏类</li><li id="cab0" class="ma mb iq ka b kb mj kf mk kj ml kn mm kr mn kv mf mg mh mi bi translated">删除重复项</li></ul><h2 id="51d3" class="mo kx iq bd ky mp mq dn lc mr ms dp lg kj mt mu lk kn mv mw lo kr mx my ls mz bi translated">主要考虑事项</h2><p id="ce02" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated"><strong class="ka ir">缺失值</strong></p><p id="eec2" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">大多数机器学习模型要求所有特征都是完整的，因此，必须处理缺失值。最简单的解决方案是删除所有缺少值的行，但重要信息可能会丢失或引入偏差。</p><p id="2472" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在数据探索阶段，您应该已经探索了丢失数据的可能原因，以帮助指导是否可以删除这些数据点。或者，你可以估算这个值；为缺失的数据提供适当的替代。常见的插补使用平均值、中间值或众数。对于分类数据，可以创建新的类别(例如“未知”)。更复杂的解决方案包括使用 K-最近邻(KNN)或链式方程多元插补(MICE)。</p><p id="f12b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">离群值</strong></p><p id="5d06" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果您在数据探索期间的异常值调查只发现了可能是错误的低频异常值，则这些异常值可以被视为缺失数据，并被移除或替换。从数据集中移除异常值的过程称为修剪或截断。</p><p id="27d2" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果您认为删除或更改异常值会丢失重要信息，您可能希望保留它们，并使用机器学习算法和对异常值稳健的优化度量。</p><p id="a1a3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">异常值可以用类似于缺失数据的技术来代替，例如用平均值、众数或中位数。更复杂的技术包括 Winsorizing(用最小和最大百分位数替换极值)和离散化(宁滨)，即将连续变量分成离散的组。</p><p id="d0c4" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">分组稀疏类</strong></p><p id="b3c4" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">分类特征通常具有大量不同的值，其中一些值出现的频率很低。当数据以自由文本的形式输入并且容易出现输入错误时，这种情况尤其常见。</p><p id="96c7" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在数据转换阶段，我们将讨论如何将分类数据转换为机器学习模型可以读取的格式。然而，这通常涉及为该类别中的每个不同的值创建一个新的特性；如果每个分类特征都有许多不同的值，这种转换会产生许多附加特征。</p><p id="5629" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">许多机器学习算法可能会因为太多的特征而陷入困境，这被称为维数灾难。为了解决这一问题，您可能希望对质量相似的值进行分组。这很可能是与主题专家合作的手工工作。尽管对于拼写错误或大小写不一致的情况，可以使用模式或模糊匹配工具。</p><h1 id="1501" class="kw kx iq bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">数据转换</h1><p id="1257" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">收集数据仅仅是为了进行预测是很少见的。因此，您可用的数据可能格式不正确，或者可能需要转换以使其更有用。数据转换活动和技术包括:</p><ul class=""><li id="7493" class="ma mb iq ka b kb kc kf kg kj mc kn md kr me kv mf mg mh mi bi translated">分类编码</li><li id="20f7" class="ma mb iq ka b kb mj kf mk kj ml kn mm kr mn kv mf mg mh mi bi translated">处理扭曲的数据</li><li id="2208" class="ma mb iq ka b kb mj kf mk kj ml kn mm kr mn kv mf mg mh mi bi translated">偏差缓解</li><li id="92ab" class="ma mb iq ka b kb mj kf mk kj ml kn mm kr mn kv mf mg mh mi bi translated">缩放比例</li><li id="f8a0" class="ma mb iq ka b kb mj kf mk kj ml kn mm kr mn kv mf mg mh mi bi translated">秩变换</li><li id="8566" class="ma mb iq ka b kb mj kf mk kj ml kn mm kr mn kv mf mg mh mi bi translated">幂函数</li></ul><h2 id="3acc" class="mo kx iq bd ky mp mq dn lc mr ms dp lg kj mt mu lk kn mv mw lo kr mx my ls mz bi translated">主要考虑事项</h2><p id="9fcd" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated"><strong class="ka ir">分类编码</strong></p><p id="2cda" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">标签编码将分类变量转换成机器可读的数字表示。</p><p id="c133" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">首先要明白的是，无论你的类别是有序的，类都是有顺序的。例如，教育水平有一个顺序，硕士学位的排名高于学士学位。为了保持这种关系，您将希望根据它们的相关大小对它们进行排序，并将它们的排序作为模型的输入。</p><p id="c7fb" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果类别不是有序的，你可以对你的类别进行一次热编码；这将为每个唯一值创建一个新列。例如，如果您有一个婚姻状态特征，带有“单身”、“已婚”、“离婚”或“未公开”，这将变成四个不同的列。具有“单一”状态的观察将在“单一”列中有一个 1，在其余三列中有零。</p><p id="525d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">对于神经网络或处理文本数据，您可能希望使用嵌入，这些是数据的矢量表示。与权重类似，嵌入是在模型训练期间学习的。这允许模型学习数据的丰富表示。</p><p id="f964" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">处理偏斜数据</strong></p><p id="22ad" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">统计技术通常假设正态性；如果您使用的是线性回归或神经网络等回归算法，那么在转换具有偏态分布的变量时，您可能会看到很大的改进。</p><p id="61dc" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">为了近似更对称的分布，您可以使用根(即平方根、立方根)、对数(即以 e 为底或以 10 为底)、倒数(即正或负)或 Box-Cox 变换。</p><p id="25d8" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">缩放</strong></p><p id="000d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">缩放是一种将数据转换到特定范围的方法。这在使用回归算法和使用欧几里德距离的算法(例如 KNN 或 K-Means)时非常重要，因为它们对要素之间的大小和范围变化非常敏感。</p><p id="529c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">缩放的目标是将数据集中每个数值特征的值更改为一个通用的比例。通过这样做，不同特征的变化变得更具可比性。缩放可以通过归一化(最小-最大缩放)或 z 分数标准化来完成。</p><p id="d0bd" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">偏差缓解</strong></p><p id="f7fd" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果您发现数据中存在偏差，您可以使用各种预处理技术来减轻这种情况。这些通常会用更公平的模型来代替当前的值或标签。</p><p id="59c3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">预处理偏差减轻算法的例子是重新加权、优化预处理、学习公平表示和不同影响去除器。</p><h1 id="a1d6" class="kw kx iq bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">特征工程</h1><p id="1bf2" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">特征工程是基于关于当前特征和所需任务的知识来创建新特征的过程。要完成这一步，对数据有一个清晰的理解是很重要的，这可能需要你和一个主题专家一起工作。这项活动可能还需要您寻找新的数据源。两项关键活动是:</p><ul class=""><li id="dbed" class="ma mb iq ka b kb kc kf kg kj mc kn md kr me kv mf mg mh mi bi translated">特征提取，以及</li><li id="4cbe" class="ma mb iq ka b kb mj kf mk kj ml kn mm kr mn kv mf mg mh mi bi translated">捕捉特征关系</li></ul><h2 id="5419" class="mo kx iq bd ky mp mq dn lc mr ms dp lg kj mt mu lk kn mv mw lo kr mx my ls mz bi translated">特征抽出</h2><p id="8e7a" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">您可能会发现数据中的列在当前状态下没有用，可能是因为它们太细了。例如，时间戳不太可能有助于发现趋势，而一天中的时间或一周中的某一天可能有助于发现趋势。</p><p id="de0b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在文本分析中，特征提取涉及从原始文本串创建结构化(柱状)文本串。这可以简单地创建具有值 1 或 0 的新列，指示是否提到了特定短语，或者可以为每个单词(单词袋)创建列，并且它们的值是它们的频率的表示(TF 或 TF-IDF)。</p><h2 id="5398" class="mo kx iq bd ky mp mq dn lc mr ms dp lg kj mt mu lk kn mv mw lo kr mx my ls mz bi translated">捕捉特征关系</h2><p id="15c4" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">不要期望模型找到两个特征之间的关系，它们可以被显式地调用。然后，你可以帮助你的算法专注于你或你的主题专家所知道的重要的东西。</p><p id="ddcc" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">导出关系的可能方法包括计算和、差、积或商。例如，机器学习模型可能不容易找到两个地址的经度和纬度值之间的联系，但通过提供两者之间的距离，您可以更好地使它能够导出模式。</p></div></div>    
</body>
</html>