<html>
<head>
<title>Understanding Encoder-Decoder Sequence to Sequence Model</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">理解编码器-解码器序列到序列模型</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/understanding-encoder-decoder-sequence-to-sequence-model-679e04af4346?source=collection_archive---------1-----------------------#2019-02-05">https://towardsdatascience.com/understanding-encoder-decoder-sequence-to-sequence-model-679e04af4346?source=collection_archive---------1-----------------------#2019-02-05</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="ip iq gp gr ir is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/0bb46d5ad1f5ccc71798823f02e1a9b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VSc2CM7b-ZIon95AFyFUAw.jpeg"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Photo by <a class="ae jd" href="https://unsplash.com/photos/TrhLCn1abMU?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Capturing the human heart.</a> on <a class="ae jd" href="https://unsplash.com/search/photos/mapping?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><div class=""/><p id="6e81" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我将尝试对序列对序列模型给出一个简短的解释，该模型最近在机器翻译、视频字幕、问答等相当复杂的任务上取得了显著的成果。</p><p id="f974" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">先决条件:读者应该已经熟悉神经网络，特别是递归神经网络(RNNs)。此外，了解 LSTM 或 GRU 模型更佳。如果你还不熟悉 RNNs，我推荐阅读 <a class="ae jd" rel="noopener" target="_blank" href="/learn-how-recurrent-neural-networks-work-84e975feaaf7"> <em class="lb">这篇文章</em> </a> <em class="lb">它会让你快速入门。对于 LSTM 和 GRU，我建议看看</em> <a class="ae jd" href="http://colah.github.io/posts/2015-08-Understanding-LSTMs/" rel="noopener ugc nofollow" target="_blank"> <em class="lb">【了解 LSTM 网络】</em> </a> <em class="lb">以及</em> <a class="ae jd" rel="noopener" target="_blank" href="/understanding-gru-networks-2ef37df6c9be"> <em class="lb">【了解 GRU 网络】</em> </a> <em class="lb">。</em></p><h1 id="4c3d" class="lc ld jg bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">序列对序列模型的用例</h1><p id="4791" class="pw-post-body-paragraph kd ke jg kf b kg ma ki kj kk mb km kn ko mc kq kr ks md ku kv kw me ky kz la ij bi translated">您每天面对的众多系统背后都有一个序列对序列模型。例如，seq2seq 模型支持谷歌翻译、语音设备和在线聊天机器人等应用。一般来说，这些应用程序包括:</p><ul class=""><li id="a173" class="mf mg jg kf b kg kh kk kl ko mh ks mi kw mj la mk ml mm mn bi translated"><em class="lb">机器翻译</em>——谷歌 2016 年的一篇<a class="ae jd" href="https://arxiv.org/pdf/1409.3215.pdf" rel="noopener ugc nofollow" target="_blank">论文</a>展示了 seq2seq 模型的翻译质量如何“接近或超过目前所有公布的结果”。</li></ul><figure class="mp mq mr ms gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mo"><img src="../Images/2c2c7f3960c27a5419eca5205975c98e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*D2eqzElv414FFFAN1hg0WQ.png"/></div></div></figure><ul class=""><li id="bdb5" class="mf mg jg kf b kg kh kk kl ko mh ks mi kw mj la mk ml mm mn bi translated"><em class="lb">语音识别</em> —另一篇 Google <a class="ae jd" href="https://www.isca-speech.org/archive/Interspeech_2017/pdfs/0233.PDF" rel="noopener ugc nofollow" target="_blank">论文</a>在语音识别任务上对比了现有的 seq2seq 模型。</li></ul><figure class="mp mq mr ms gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mt"><img src="../Images/2d2c5372b5596a3d25e935c85f54507f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NM_l6Ww2kQeEms_opuXxAg.png"/></div></div></figure><ul class=""><li id="25a4" class="mf mg jg kf b kg kh kk kl ko mh ks mi kw mj la mk ml mm mn bi translated"><em class="lb">视频字幕</em>—2015 年<a class="ae jd" href="https://arxiv.org/pdf/1505.00487.pdf" rel="noopener ugc nofollow" target="_blank">的一篇论文</a>展示了 seq2seq 如何在生成电影描述方面产生巨大的结果。</li></ul><figure class="mp mq mr ms gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mu"><img src="../Images/9e64ff989eb71cda24b5d305d2c7c7b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lQGaPX7Vy1Q_s1sc5N_IXw.png"/></div></div></figure><p id="0881" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这些只是 seq2seq 被视为最佳解决方案的一些应用。该模型可用作任何基于序列的问题的解决方案，尤其是输入和输出具有不同大小和类别的问题。我们将在下面详细讨论模型结构。</p><h1 id="a74b" class="lc ld jg bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">序列到序列模型的定义</h1><p id="5ba1" class="pw-post-body-paragraph kd ke jg kf b kg ma ki kj kk mb km kn ko mc kq kr ks md ku kv kw me ky kz la ij bi translated"><a class="ae jd" href="https://arxiv.org/pdf/1409.3215.pdf" rel="noopener ugc nofollow" target="_blank">由 Google </a>于 2014 年首次推出，序列到序列模型旨在将固定长度的输入与固定长度的输出进行映射，其中输入和输出的长度可能不同。</p><p id="9dde" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi">For example, translating “What are you doing today?” from English to Chinese has input of 5 words and output of 7 symbols (今天你在做什麼？). Clearly, we can’t use a regular LSTM network to map each word from the English sentence to the Chinese sentence.</p><p id="5df2" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这就是为什么序列对序列模型被用来解决这样的问题。</p><h1 id="fa00" class="lc ld jg bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">序列对序列模型如何工作？</h1><p id="c32d" class="pw-post-body-paragraph kd ke jg kf b kg ma ki kj kk mb km kn ko mc kq kr ks md ku kv kw me ky kz la ij bi translated">为了充分理解模型的基本逻辑，我们将浏览下图:</p><figure class="mp mq mr ms gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mv"><img src="../Images/761a214018e3be7f5183e140a0909ba4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1JcHGUU7rFgtXC_mydUA_Q.jpeg"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Encoder-decoder sequence to sequence model</figcaption></figure><p id="3e33" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">该模型由 3 部分组成:编码器、中间(编码器)向量和解码器。</p><h2 id="ece4" class="mw ld jg bd le mx my dn li mz na dp lm ko nb nc lq ks nd ne lu kw nf ng ly nh bi translated"><strong class="ak">编码器</strong></h2><ul class=""><li id="709e" class="mf mg jg kf b kg ma kk mb ko ni ks nj kw nk la mk ml mm mn bi translated">几个循环单元(LSTM 单元或 GRU 单元，性能更好)的堆栈，其中每个单元接受输入序列的单个元素，收集该元素的信息并将其向前传播。</li><li id="0625" class="mf mg jg kf b kg nl kk nm ko nn ks no kw np la mk ml mm mn bi translated">在问答问题中，输入序列是问题中所有单词的集合。每个单词被表示为<em class="lb"> x_i </em>，其中<em class="lb"> i </em>是该单词的顺序。</li><li id="4f29" class="mf mg jg kf b kg nl kk nm ko nn ks no kw np la mk ml mm mn bi translated">隐藏状态<em class="lb"> h_i </em>使用以下公式计算:</li></ul><figure class="mp mq mr ms gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nq"><img src="../Images/3cea2f00d1c787c1ff7d7cb46aeab27d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sKqGIDJm3P8DeSwl0WHGkg.png"/></div></div></figure><p id="b502" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这个简单的公式代表了普通递归神经网络的结果。正如你所看到的，我们只是将适当的权重应用于先前的隐藏状态<em class="lb"> h_(t-1) </em>和输入向量<em class="lb"> x_t. </em></p><h2 id="e25f" class="mw ld jg bd le mx my dn li mz na dp lm ko nb nc lq ks nd ne lu kw nf ng ly nh bi translated">编码器向量</h2><ul class=""><li id="ebb7" class="mf mg jg kf b kg ma kk mb ko ni ks nj kw nk la mk ml mm mn bi translated">这是从模型的编码器部分产生的最终隐藏状态。它是用上面的公式计算的。</li><li id="0c1d" class="mf mg jg kf b kg nl kk nm ko nn ks no kw np la mk ml mm mn bi translated">该向量旨在封装所有输入元素的信息，以帮助解码器做出准确的预测。</li><li id="1c22" class="mf mg jg kf b kg nl kk nm ko nn ks no kw np la mk ml mm mn bi translated">它充当模型解码器部分的初始隐藏状态。</li></ul><h2 id="28ba" class="mw ld jg bd le mx my dn li mz na dp lm ko nb nc lq ks nd ne lu kw nf ng ly nh bi translated">解码器</h2><ul class=""><li id="d5eb" class="mf mg jg kf b kg ma kk mb ko ni ks nj kw nk la mk ml mm mn bi translated">几个循环单元的堆栈，每个循环单元在时间步长<em class="lb"> t </em>预测一个输出<em class="lb"> y_t </em>。</li><li id="c3fb" class="mf mg jg kf b kg nl kk nm ko nn ks no kw np la mk ml mm mn bi translated">每个递归单元接受来自前一个单元的隐藏状态，并产生和输出它自己的隐藏状态。</li><li id="3f07" class="mf mg jg kf b kg nl kk nm ko nn ks no kw np la mk ml mm mn bi translated">在问答问题中，输出序列是答案中所有单词的集合。每个单词表示为<em class="lb"> y_i </em>，其中<em class="lb"> i </em>是该单词的顺序。</li><li id="a56b" class="mf mg jg kf b kg nl kk nm ko nn ks no kw np la mk ml mm mn bi translated">任何隐藏状态<em class="lb"> h_i </em>都是使用以下公式计算的<em class="lb"> </em>:</li></ul><figure class="mp mq mr ms gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nr"><img src="../Images/579486723dfcc25f798fcdffe4997c59.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sdxvcjeV7NOUsR_VQ_nrUQ.png"/></div></div></figure><p id="d1d6" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如你所见，我们只是使用前一个隐藏状态来计算下一个。</p><ul class=""><li id="7c9e" class="mf mg jg kf b kg kh kk kl ko mh ks mi kw mj la mk ml mm mn bi translated">使用以下公式计算时间步长<em class="lb"> t </em>的输出<em class="lb"> y_t </em>:</li></ul><figure class="mp mq mr ms gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ns"><img src="../Images/5f8a5f4feea1a12ba214db73b8451601.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*y5T2-J2mrCRZp5M9Q4METw.png"/></div></div></figure><p id="c81d" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们使用当前时间步长的隐藏状态以及相应的权重 W(S)来计算输出。<a class="ae jd" href="https://www.youtube.com/watch?v=LLux1SW--oM" rel="noopener ugc nofollow" target="_blank"> Softmax </a>用于创建一个概率向量，该向量将帮助我们确定最终输出(如问答问题中的单词)。</p><p id="64cf" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf jh">这个模型的强大之处在于它可以将不同长度的序列相互映射。</strong>正如你所看到的，输入和输出是不相关的，它们的长度可以不同。这开启了一系列全新的问题，现在可以使用这种架构来解决。</p><h2 id="d5da" class="mw ld jg bd le mx my dn li mz na dp lm ko nb nc lq ks nd ne lu kw nf ng ly nh bi translated">进一步阅读</h2><p id="a962" class="pw-post-body-paragraph kd ke jg kf b kg ma ki kj kk mb km kn ko mc kq kr ks md ku kv kw me ky kz la ij bi translated">上面的解释只涵盖了最简单的序列对序列模型，因此，我们不能期望它在复杂的任务中表现良好。原因是使用单个向量来编码整个输入序列不能捕获全部信息。</p><p id="559f" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这就是引入多种增强功能的原因。每一个都旨在增强该模型在具有长输入和输出序列的稍微复杂的任务上的性能。例如:</p><ul class=""><li id="0f6f" class="mf mg jg kf b kg kh kk kl ko mh ks mi kw mj la mk ml mm mn bi translated"><a class="ae jd" href="https://arxiv.org/pdf/1409.3215.pdf" rel="noopener ugc nofollow" target="_blank">颠倒输入顺序</a>。</li><li id="a220" class="mf mg jg kf b kg nl kk nm ko nn ks no kw np la mk ml mm mn bi translated">使用 LSTM 或 GRU 细胞。</li><li id="b922" class="mf mg jg kf b kg nl kk nm ko nn ks no kw np la mk ml mm mn bi translated"><a class="ae jd" href="http://www.wildml.com/2016/01/attention-and-memory-in-deep-learning-and-nlp/" rel="noopener ugc nofollow" target="_blank">引入注意机制</a>。</li><li id="f5c4" class="mf mg jg kf b kg nl kk nm ko nn ks no kw np la mk ml mm mn bi translated">还有很多。</li></ul><p id="301a" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果你想加强你对这种奇妙的深度学习模型的了解，我强烈推荐你观看<a class="ae jd" href="https://youtu.be/QuELiw8tbx8?list=PL3FW7Lu3i5Jsnh1rnUwq_TcylNr7EkRe6&amp;t=1190" rel="noopener ugc nofollow" target="_blank"> Richard Socher 关于机器翻译的讲座</a>。如果你仍然感到迷茫或有任何问题，请在评论区提问，我很乐意帮助你。</p><p id="fb8f" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我希望这篇文章能让你很好地理解处理序列的最新模型(seq2seq ),并对你激动人心的深度学习之旅有所贡献。</p><blockquote class="nt"><p id="0e05" class="nu nv jg bd nw nx ny nz oa ob oc la dk translated">还有哪些 AI 内容？在 LinkedIn 上关注我的每日更新。</p></blockquote><h2 id="2d62" class="mw ld jg bd le mx od dn li mz oe dp lm ko of nc lq ks og ne lu kw oh ng ly nh bi translated">感谢您的阅读。如果你喜欢这篇文章，给它一些掌声👏。希望你有一个伟大的一天！</h2></div></div>    
</body>
</html>