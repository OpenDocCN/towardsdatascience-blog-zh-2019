<html>
<head>
<title>Predicting the Weather with Markov Chains</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用马尔可夫链预测天气</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/predicting-the-weather-with-markov-chains-a34735f0c4df?source=collection_archive---------10-----------------------#2019-10-10">https://towardsdatascience.com/predicting-the-weather-with-markov-chains-a34735f0c4df?source=collection_archive---------10-----------------------#2019-10-10</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="fbcc" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">基于历史天气数据构建马尔可夫链</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/ab92cb728834b3675f294b8cbc72ff85.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qF517yRFyGP3yS9el0kk3Q.png"/></div></div></figure><p id="0bb7" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在我们的机器学习工具箱中，有从简单到复杂的各种工具。马尔可夫链处于光谱的简单一端。</p><p id="5c33" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我们将通过使用马尔可夫链来学习预测明天的天气。</p><p id="6aef" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">根据<a class="ae ln" href="https://en.wikipedia.org/wiki/Markov_chain" rel="noopener ugc nofollow" target="_blank">维基百科</a>，</p><blockquote class="lo lp lq"><p id="d64c" class="kr ks lr kt b ku kv jr kw kx ky ju kz ls lb lc ld lt lf lg lh lu lj lk ll lm ij bi translated">马尔可夫链是描述一系列可能事件的随机模型，其中每个事件的概率仅取决于前一个事件达到的状态。</p></blockquote><p id="abde" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir">翻译:</strong>马尔可夫链有有限个可能的状态。每个时间段，它从一个状态跳到另一个状态(或同一个状态)。跳到特定状态的概率只取决于与我们当前状态相关的概率。</p><p id="5f78" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">当我们在示例的上下文中查看它时，它会更有意义。</p><h1 id="1337" class="lv lw iq bd lx ly lz ma mb mc md me mf jw mg jx mh jz mi ka mj kc mk kd ml mm bi translated">天气</h1><p id="a9b9" class="pw-post-body-paragraph kr ks iq kt b ku mn jr kw kx mo ju kz la mp lc ld le mq lg lh li mr lk ll lm ij bi translated">在我们简化的宇宙中，天气只能有两种可能的状态，“晴天”或“雨天”。</p><p id="61a5" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">(在马尔可夫链的背景下)问题是，明天<strong class="kt ir">是晴天还是雨天</strong>，取决于今天<strong class="kt ir">是晴天还是雨天</strong>。</p><p id="0db8" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我们将从过去的数据中推导出这些概率，并构建一个<strong class="kt ir">转移矩阵</strong>。</p><p id="666a" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我已经生成了 7 天的历史数据来“训练”我们的马尔可夫链。日子是:[雨，太阳，雨，太阳，雨，雨，太阳]</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ms"><img src="../Images/0111ab6f900738b1d3b13a6346a9a771.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*g5-MuWDAvZbdmFeiCQBRkg.png"/></div></div><figcaption class="mt mu gj gh gi mv mw bd b be z dk">R S R S R R S</figcaption></figure><p id="93df" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">现在计算紧接着雨天的晴天的百分比。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mx"><img src="../Images/a224f0bdf64ac871dfb6ae93c01a11ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2UkLgLHz7m-k_psyrDeLyQ.png"/></div></div></figure><p id="8795" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">3/4 所以 75%。</p><p id="1f00" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">现在计算紧接着晴天的雨天的百分比。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/ab92cb728834b3675f294b8cbc72ff85.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qF517yRFyGP3yS9el0kk3Q.png"/></div></div></figure><p id="3660" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">那是 2/2 所以 100%。</p><p id="d680" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我们将利用这些信息构建我们的转换矩阵，从我们已经获得的信息中推断缺失百分比(雨后= 25%和太阳后= 0%)。</p><h1 id="fbb4" class="lv lw iq bd lx ly lz ma mb mc md me mf jw mg jx mh jz mi ka mj kc mk kd ml mm bi translated">跃迁矩阵</h1><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi my"><img src="../Images/a075c6dbe40a4dd1bac046f161b00e20.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/format:webp/1*HPH9K-KJjDY8Ds_t5E-WaA.png"/></div></figure><p id="c1cb" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我们也可以用图表显示上述信息。</p><p id="8137" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir">马尔可夫链</strong></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mz"><img src="../Images/ca2fcdbdc90f3516685302c0edaef311.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*chijfFZk3BCzsxz-v_mEWg.png"/></div></div><figcaption class="mt mu gj gh gi mv mw bd b be z dk">R = rainy, S = sunny</figcaption></figure><p id="c363" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这张图表说明了一个事实，即概率完全取决于当前状态，而不是昨天或前天的天气。</p><p id="1934" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">让我们做一些预测</p><p id="f373" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir">例一:</strong> <br/>前 3 天为【雨天、晴天、雨天】。明天下雨的概率有多大？</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi na"><img src="../Images/c932eb192e968126fcd9271045c13153.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7k4kvXXKp_m9cJlPUX-qFA.png"/></div></div><figcaption class="mt mu gj gh gi mv mw bd b be z dk">R, S, R</figcaption></figure><p id="7ec6" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">基于我们之前训练的模型。明天有 75%的机会出太阳，25%的机会下雨。</p><p id="5a99" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir">例二:</strong> <br/>前 2 天是【雨天，雨天】。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nb"><img src="../Images/f7bc77953f7e8305f0f7816613374aee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*T0IM4HjpbNm5LSaFrw8lQA.png"/></div></div><figcaption class="mt mu gj gh gi mv mw bd b be z dk">R R</figcaption></figure><p id="9284" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">同样，明天有 75%的机会出太阳，25%的机会下雨。</p><p id="a2d6" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir">例三:</strong> <br/>前 3 天都是【晴、雨、晴】。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nc"><img src="../Images/a72ce24bfc50420d4cfd2165c6d6b378.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DQrvBqOaAJT4u6z9KXFyGw.png"/></div></div><figcaption class="mt mu gj gh gi mv mw bd b be z dk">S R S</figcaption></figure><p id="29e1" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">明天有 100%的可能下雨。太阳落山后的日子总是下雨…我知道这很悲伤…</p><p id="b3ce" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">记住，我们只考虑当天的天气，然后在转移矩阵中查找天气状态的转移概率。</p><p id="c800" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">太简单了？很有可能。</p><p id="964d" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">但有时最好的起点是一个简单的模型，它比随机猜测表现得更好。</p></div></div>    
</body>
</html>