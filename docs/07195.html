<html>
<head>
<title>Interpreting Machine Learning Model</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">解释机器学习模型</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/interpreting-machine-learning-model-70fa49d20af1?source=collection_archive---------24-----------------------#2019-10-10">https://towardsdatascience.com/interpreting-machine-learning-model-70fa49d20af1?source=collection_archive---------24-----------------------#2019-10-10</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="e8ff" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">第 1 部分—简介</h2></div><p id="fd47" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在这一系列的 6 篇文章中，我们将把预测的基础放在一边，看看数据科学和机器学习的更手工的方面，例如解释、获得洞察力和理解算法中发生的事情。这不是一件小事，还远远没有穷尽。在这一系列的帖子中，我们将从最简单的统计模型开始，以及我们如何模拟最复杂的集成和深度学习模型，试图找出预测的原因。</p><p id="6882" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">对这一系列内容的初步建议如下:</p><p id="e02b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><a class="ae le" href="https://medium.com/swlh/data-science-and-the-data-scientist-db200aac4ea0" rel="noopener"> Part 0—什么是数据科学的范围</a> <strong class="kk iu"> <br/> Part 1 —解读 ML 简介(本帖)<br/> </strong> <a class="ae le" rel="noopener" target="_blank" href="/statistical-modeling-the-full-pragmatic-guide-7aeb56e38b36"> Part 2 —解读高偏倚低方差模型。<br/> </a>第 3 部分——解读低偏差和高方差模型。<br/>第 4 部分——有可能解决偏倚和方差之间的权衡吗？<br/>第 5 部分——可解释性的本地方法。<br/> <a class="ae le" href="https://medium.com/@marcos.silva0/the-ultimate-guide-using-game-theory-to-interpret-machine-learning-c384cbb6929?sk=8817fb3b75f2da2030cee7a699c8854b" rel="noopener">第 6 部分——可解释性的全局方法。</a></p><h1 id="71ca" class="lf lg it bd lh li lj lk ll lm ln lo lp jz lq ka lr kc ls kd lt kf lu kg lv lw bi translated">我们在说什么？</h1><p id="380b" class="pw-post-body-paragraph ki kj it kk b kl lx ju kn ko ly jx kq kr lz kt ku kv ma kx ky kz mb lb lc ld im bi translated">要理解如何解读机器学习算法，我们先来理解什么是机器学习算法。</p><p id="8d20" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">一般来说，对于我们来说，机器学习算法(以下简称 ML)是从“传统编程”到新概念的范式转变，在传统编程中，我们需要显式地传递所有启发，而不是编写算法必须执行的每个动作，我们只是通过几个例子，让 ML 学习什么是“最佳”(最低成本)决策。</p><figure class="md me mf mg gt mh gh gi paragraph-image"><div class="gh gi mc"><img src="../Images/a2981c3e614a0edb379284b75a395f9d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1156/format:webp/1*oLWIjSAZmIw1o7JQzemoSA.png"/></div><figcaption class="mk ml gj gh gi mm mn bd b be z dk">Figure 1 — Paradigm shift from traditional programming to Machine Learning</figcaption></figure><p id="a1e8" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">也就是说，对于我们来说，接收输入并可以转换输出而无需显式编程的算法将是 ML 算法。解释 ML 算法就是理解它们如何将输入转化为输出。</p><h1 id="c94d" class="lf lg it bd lh li lj lk ll lm ln lo lp jz lq ka lr kc ls kd lt kf lu kg lv lw bi translated">理解预测有多重要？</h1><p id="7b6d" class="pw-post-body-paragraph ki kj it kk b kl lx ju kn ko ly jx kq kr lz kt ku kv ma kx ky kz mb lb lc ld im bi translated">如果 ML 只是一种以(有时)非常聪明的方式将输入映射到输出的方式，那么理解它是如何做到这一点似乎是一个好主意，对吗？</p><p id="6831" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">一个例子:银行欺诈检测算法。<br/>我们绘制一个行为，收集数据，训练一个模型，你就大功告成了！我们有一个非常聪明的方法来检测未来的欺诈行为。现在呢？这个算法在做什么？如果仅仅出于好奇去理解它不再有意义，这里有一些更实际的原因:</p><figure class="md me mf mg gt mh gh gi paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="gh gi mo"><img src="../Images/5175b015f04e88f94e85c3327d56d89f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*qKas04DQxA9r940szzhKnA.gif"/></div></div><figcaption class="mk ml gj gh gi mm mn bd b be z dk">Figure 2 — Nature -&gt; Data -&gt; ML -&gt; Predictions</figcaption></figure><ul class=""><li id="5834" class="mt mu it kk b kl km ko kp kr mv kv mw kz mx ld my mz na nb bi translated">这位客户做了什么会被认为是欺诈者？</li><li id="f5a5" class="mt mu it kk b kl nc ko nd kr ne kv nf kz ng ld my mz na nb bi translated">他犯了什么样的欺诈罪？</li><li id="eac3" class="mt mu it kk b kl nc ko nd kr ne kv nf kz ng ld my mz na nb bi translated">我的算法有偏差吗？</li><li id="3497" class="mt mu it kk b kl nc ko nd kr ne kv nf kz ng ld my mz na nb bi translated">我的算法有没有漏洞？</li><li id="6616" class="mt mu it kk b kl nc ko nd kr ne kv nf kz ng ld my mz na nb bi translated">如果客户想知道为什么他们的购买被拒绝，我会说是我不懂的算法吗？</li><li id="53e4" class="mt mu it kk b kl nc ko nd kr ne kv nf kz ng ld my mz na nb bi translated">经理是否想了解模型欺诈者的行为是如何随着时间的推移而变化的？</li><li id="8c7f" class="mt mu it kk b kl nc ko nd kr ne kv nf kz ng ld my mz na nb bi translated">如果我们不是简单地预测，而是对修复安全漏洞以防范未来的欺诈感兴趣，我如何知道哪个杠杆是正确的？</li></ul><p id="2a9e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">即使在这个非常简单的例子中，我们已经确定了几个理解算法内部工作的好理由。</p><p id="bef3" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果你仍然不相信它的重要性，从欧洲开始有一个非常强大的趋势，公司已经被迫解释做出决定的原因，如拒绝信贷、保险、职位空缺等。很有道理，所以用不了多久，这就会成为使用预测模型时的日常问题。</p><h1 id="7a02" class="lf lg it bd lh li lj lk ll lm ln lo lp jz lq ka lr kc ls kd lt kf lu kg lv lw bi translated">重要概念:偏差和方差。</h1><p id="031a" class="pw-post-body-paragraph ki kj it kk b kl lx ju kn ko ly jx kq kr lz kt ku kv ma kx ky kz mb lb lc ld im bi translated">有数百个帖子在讨论偏差和方差之间的权衡，这里的目标不是重新解释所有的概念，只是将它们作为下一篇帖子的语言。因此，在没有理论形式的情况下，我们可以将任何模型的预测误差(y-yhat)分成 3 个不同的部分。</p><figure class="md me mf mg gt mh gh gi paragraph-image"><div class="gh gi nh"><img src="../Images/54bc71961094b069954cef6c205e9e25.png" data-original-src="https://miro.medium.com/v2/resize:fit:876/format:webp/1*yI_3sLiQir-Y2K6aBF-V8Q.png"/></div><figcaption class="mk ml gj gh gi mm mn bd b be z dk">Figure 3 — Trade-off between bias and Variance.</figcaption></figure><pre class="md me mf mg gt ni nj nk nl aw nm bi"><span id="243d" class="nn lg it nj b gy no np l nq nr">y_real - y_hat = Error = Random Part + Bias + Variance</span></pre><ol class=""><li id="738a" class="mt mu it kk b kl km ko kp kr mv kv mw kz mx ld ns mz na nb bi translated"><strong class="kk iu">随机部分</strong>:我们生活在一个随机的世界，而不是十九世纪后期实证主义者所认为的确定性世界。因此，即使是最简单、最明显的模型也仍然具有随机性。即使你的模型是完美的，也不会达到 Error = 0，除非是纯确定性问题。有些问题比其他问题“更随机”。例如，预测行星轨道的模型比预测欺诈的模型具有更小的随机成分。随机部分可以视为上图中的水平线，因为它不依赖于复杂性。</li><li id="90c1" class="mt mu it kk b kl nc ko nd kr ne kv nf kz ng ld ns mz na nb bi translated"><strong class="kk iu">方差:</strong>对方差的解释，对我们来说，将是一种“波动性”的预测。X 的小变化引起 y 的大变化？- &gt;方差。通常方差误差范围被认为是预测的训练和测试结果之间的差异，但这是一个结果而不是原因。方差随着模型复杂性的增加而增加。</li><li id="8b0a" class="mt mu it kk b kl nc ko nd kr ne kv nf kz ng ld ns mz na nb bi translated"><strong class="kk iu">偏见</strong>:这是我们最重要的一种错误。偏见在不同的上下文中有几种解释。在这里，偏差意味着我们的模型的简化，我们必须为模型的工作做出假设。根据定义，更简单的模型是更扭曲的模型，具有更强的先决条件。偏差随着复杂性的增加而减小。</li></ol><h1 id="7507" class="lf lg it bd lh li lj lk ll lm ln lo lp jz lq ka lr kc ls kd lt kf lu kg lv lw bi translated">方法:统计与机器学习</h1><p id="abfa" class="pw-post-body-paragraph ki kj it kk b kl lx ju kn ko ly jx kq kr lz kt ku kv ma kx ky kz mb lb lc ld im bi translated">我们在<a class="ae le" href="https://medium.com/swlh/data-science-and-the-data-scientist-db200aac4ea0" rel="noopener">之前的帖子</a>中讨论过，机器学习可能不同于统计学，因为前者涉及推理、因果关系、外生性等。而后者几乎只关心改进预测。因此，我们可以采用相同的功能，例如逻辑回归和统计分析，这将解释 betas 是否显著，浪费是否具有正态分布或机器学习分析，精确度和召回之间的关系如何，模型的 AUC 是多少，等等。</p><figure class="md me mf mg gt mh gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/0974e16efdc277d8fc4d2b5a16d46ead.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UCmCvjQYblcqiQ_5XdGEXg.jpeg"/></div><figcaption class="mk ml gj gh gi mm mn bd b be z dk">Figure 4 — Funny meme. But wrong.</figcaption></figure><p id="e9b0" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">所以，因为统计学对理解数据感兴趣，你为它创建模型，这些模型需要高度可解释！为了使它们具有可解释性，模型必须简单！但是，如果模型很简单，正如我们所看到的，它们是高度倾斜的。</p><figure class="md me mf mg gt mh gh gi paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="gh gi nu"><img src="../Images/7a0bb1f0b850edbd9e305798bb90644e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*k_3rh-3zr_ebX06vFSkZHw.png"/></div></div><figcaption class="mk ml gj gh gi mm mn bd b be z dk">Figure 5 — Trade-off between prediction quality and model interpretability</figcaption></figure><p id="8326" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">ML 模型正好相反，因为我们最初并不关心对它们的解释，它们非常有偏见，在我们的概念中，它们几乎没有先决条件，其代价是缺乏可解释性，这一系列的帖子试图将这两个世界结合在一起。具有高度可解释性的高指标。</p><figure class="md me mf mg gt mh gh gi paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="gh gi nv"><img src="../Images/a2ad172c2c5f21dedfbc11099600e675.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eJYDfncrjRfXXZn2b2MSbQ.png"/></div></div><figcaption class="mk ml gj gh gi mm mn bd b be z dk">Figure 6 — Evolution from Statistical algorithms to Machine Learning algorithms.</figcaption></figure><p id="2f91" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">一个简单的例子是线性回归，这是最古老和最简单的算法之一，可解释性强，方差非常低(我们在测试训练中几乎不需要分离数据)，但有很大的偏差。由于此处的偏差是为使模型工作良好而进行的简化，低于使用此方法的一些<br/>前要求:</p><ol class=""><li id="64c1" class="mt mu it kk b kl km ko kp kr mv kv mw kz mx ld ns mz na nb bi translated">输入变量需要是外生的，所以不理解变量之间的交互作用；</li><li id="d3cb" class="mt mu it kk b kl nc ko nd kr ne kv nf kz ng ld ns mz na nb bi translated">X 和 y 之间的影响需要是恒定的(因此<strong class="kk iu">线性</strong>名称)；</li><li id="9ec7" class="mt mu it kk b kl nc ko nd kr ne kv nf kz ng ld ns mz na nb bi translated">y 分布需要“表现良好”。</li></ol><p id="d7a3" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们将在下一篇文章中探讨这些和其他先决条件，以及如何解释它们。</p><h1 id="075f" class="lf lg it bd lh li lj lk ll lm ln lo lp jz lq ka lr kc ls kd lt kf lu kg lv lw bi translated">一种新的算法分类方法。</h1><p id="c1a1" class="pw-post-body-paragraph ki kj it kk b kl lx ju kn ko ly jx kq kr lz kt ku kv ma kx ky kz mb lb lc ld im bi translated">综合起来，让我们用一个新的术语来描述这种分离/分类 ML 算法的新方式。一方面，我们有最传统的算法，诞生于统计学和计量经济学，有一些工作的先决条件和高度可解释性，没有它们就没有现代科学，它们的解释是数据科学的科学特征，是“白盒”算法。</p><p id="ee3e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在另一个极端，我们有那些我们知道工作得很好的 ML 算法，因为它们的度量很好，它们可以同时处理数百万个变量，它们可以在更小的维度上表示复杂的向量空间，只有很少的先决条件(低偏差)，<br/>甚至可以生成图像和文本，代价是我们无法控制他在里面做什么，我们将这些算法称为“黑盒”。</p><figure class="md me mf mg gt mh gh gi paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="gh gi nw"><img src="../Images/0262c9085a4c9bdb5029e110c0f2cd7b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yUaxwNoI3ogLt5h75aYing.png"/></div></div><figcaption class="mk ml gj gh gi mm mn bd b be z dk">Figure 7 — Representing the different data scientist tools, more interpretable or more predictive, depending on the purpose.</figcaption></figure><p id="7c71" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在接下来的文章中，我们的目标将是结合这两个极端的优点，高解释能力和高预测能力。</p><p id="db23" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">下一篇文章:<a class="ae le" rel="noopener" target="_blank" href="/statistical-modeling-the-full-pragmatic-guide-7aeb56e38b36">第二部分——解读高偏差和低方差模型。</a></p><p id="3a9b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><a class="ae le" href="https://www.linkedin.com/in/marcosviniciusenator/" rel="noopener ugc nofollow" target="_blank">LinkedIn</a>；<a class="ae le" href="https://github.com/sn3fru/datascience_course" rel="noopener ugc nofollow" target="_blank">GitHub</a>；<a class="ae le" href="https://www.youtube.com/watch?v=0sUPqxN46dg&amp;list=PLWnpyRSGtS9V333v2OA8vRQSB_zNw4l7z" rel="noopener ugc nofollow" target="_blank">播放列表</a>；<a class="ae le" href="https://medium.com/@marcos.silva0/interpretando-modelos-de-machine-learning-96db60781354" rel="noopener">版本 pt-br</a>；</p></div></div>    
</body>
</html>