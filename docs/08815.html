<html>
<head>
<title>Apache Spark-3.0 Sneek peak</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">阿帕奇火花-3.0 斯内克峰</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/apache-spark-3-0-sneek-peak-284da5ad4166?source=collection_archive---------18-----------------------#2019-11-25">https://towardsdatascience.com/apache-spark-3-0-sneek-peak-284da5ad4166?source=collection_archive---------18-----------------------#2019-11-25</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="de29" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Apache Spark 多年来一直保持强劲，现在带着其主要版本之一回归，其持续的目标是统一分析，将批处理和流世界融合为一。让我们来看看它的一些特点。</p><ol class=""><li id="945c" class="kl km iq jp b jq jr ju jv jy kn kc ko kg kp kk kq kr ks kt bi translated">改进的优化器和目录</li><li id="2610" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">三角洲湖(酸性交易)+ Linux 基金会</li><li id="7c23" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">考拉:给熊猫带来火花尺度</li><li id="734d" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">Python 升级</li><li id="1ddc" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">深度学习</li><li id="2059" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">库伯内特斯</li><li id="b712" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">Scala 版本升级</li><li id="b399" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">图形 API —图形和密码脚本。</li><li id="6aef" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">GPU 支持以及氢项目</li><li id="0152" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">Java 升级</li><li id="0c83" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">纱线升级</li><li id="217f" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">二进制文件</li></ol><h2 id="a080" class="kz la iq bd lb lc ld dn le lf lg dp lh jy li lj lk kc ll lm ln kg lo lp lq lr bi translated"><strong class="ak">改进的优化器和目录:</strong></h2><p id="13b3" class="pw-post-body-paragraph jn jo iq jp b jq ls js jt ju lt jw jx jy lu ka kb kc lv ke kf kg lw ki kj kk ij bi translated">i) <strong class="jp ir">可插拔数据目录:(DataSourceV2) </strong></p><ul class=""><li id="c9af" class="kl km iq jp b jq jr ju jv jy kn kc ko kg kp kk lx kr ks kt bi translated">可插拔目录集成</li><li id="6dd7" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk lx kr ks kt bi translated">改进的下推</li><li id="d4f8" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk lx kr ks kt bi translated">面向流和批处理的统一 API</li></ul><pre class="ly lz ma mb gt mc md me mf aw mg bi"><span id="9e18" class="kz la iq md b gy mh mi l mj mk">eg: df.writeTo(“catalog.db.table”).overwrite($”year” === “2019”)</span></pre><p id="04a9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ii) <strong class="jp ir">自适应查询执行</strong></p><ul class=""><li id="fdae" class="kl km iq jp b jq jr ju jv jy kn kc ko kg kp kk lx kr ks kt bi translated">在查询执行期间做出更好的优化决策</li></ul><p id="ce26" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">例如:它解释表的大小，并自动从排序合并连接变为广播连接等等..如果其中一张桌子很小</p><ul class=""><li id="dbc6" class="kl km iq jp b jq jr ju jv jy kn kc ko kg kp kk lx kr ks kt bi translated"><strong class="jp ir">动态分区修剪</strong>加速昂贵的连接</li></ul><p id="5dae" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">基于维度表(小表)过滤器查询事实表(大表)也将被过滤，使连接更容易和最佳</p><h2 id="0ffc" class="kz la iq bd lb lc ld dn le lf lg dp lh jy li lj lk kc ll lm ln kg lo lp lq lr bi translated">三角洲湖:</h2><p id="e2e5" class="pw-post-body-paragraph jn jo iq jp b jq ls js jt ju lt jw jx jy lu ka kb kc lv ke kf kg lw ki kj kk ij bi translated">Delta Lake 已经开源了很长一段时间，并且由于其易于实现和升级到任何现有的 Spark 应用程序而广受欢迎。我相信，这是下一代的数据湖，有助于克服数据沼泽以及 Lambda 和 Kappa 架构的局限性。现在有了 Linux 基金会的支持，这个程序将会更上一层楼。</p><p id="85a1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">以下是一些有助于我们向统一分析迈进一步的功能。</p><ul class=""><li id="61fc" class="kl km iq jp b jq jr ju jv jy kn kc ko kg kp kk lx kr ks kt bi translated">酸性交易</li><li id="19c3" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk lx kr ks kt bi translated">架构实施</li><li id="955e" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk lx kr ks kt bi translated">可扩展元数据处理</li><li id="201a" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk lx kr ks kt bi translated">时间旅行</li></ul><p id="8206" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">注:</strong>关于 DeltaLake 的更多细节将会在我不久后的每日帖子中更新——(同时<a class="ae ml" href="https://www.linkedin.com/in/jayvardhan-reddy-vanchireddy/" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir">关注我</strong> </a>或标签<a class="ae ml" href="https://www.linkedin.com/feed/hashtag/jayreddy/" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir"> #jayReddy </strong> </a>)</p><h2 id="dd42" class="kz la iq bd lb lc ld dn le lf lg dp lh jy li lj lk kc ll lm ln kg lo lp lq lr bi translated">考拉:给熊猫带来火花尺度:</h2><p id="c3aa" class="pw-post-body-paragraph jn jo iq jp b jq ls js jt ju lt jw jx jy lu ka kb kc lv ke kf kg lw ki kj kk ij bi translated">考拉最近已经发布，它是 Python 开发人员的一个很大的附加产品，对于数据工程师和数据科学家来说都是如此，因为它在数据帧和熊猫之间有相似之处。现在，他们可以从单节点环境扩展到分布式环境，而不必单独学习 Spark 数据帧。</p><ul class=""><li id="d3ee" class="kl km iq jp b jq jr ju jv jy kn kc ko kg kp kk lx kr ks kt bi translated">集成到 Python 数据科学生态系统中。例如:numpy，matpotlib</li><li id="04f6" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk lx kr ks kt bi translated">数据框架/系列 API 的 60%</li><li id="ed09" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk lx kr ks kt bi translated">60%的数据帧分组依据</li><li id="6f24" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk lx kr ks kt bi translated">指数/多指数 API 的 15%</li><li id="6f2e" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk lx kr ks kt bi translated">如果图起作用，80%</li><li id="6dbc" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk lx kr ks kt bi translated">90%的多索引列</li></ul><figure class="ly lz ma mb gt mn gh gi paragraph-image"><div role="button" tabindex="0" class="mo mp di mq bf mr"><div class="gh gi mm"><img src="../Images/6f8f688a0f9d82962f942810b9228141.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*PN-a3wwWbf6LLOo0"/></div></div></figure><h2 id="8a58" class="kz la iq bd lb lc ld dn le lf lg dp lh jy li lj lk kc ll lm ln kg lo lp lq lr bi translated">Python 升级:</h2><p id="d2a7" class="pw-post-body-paragraph jn jo iq jp b jq ls js jt ju lt jw jx jy lu ka kb kc lv ke kf kg lw ki kj kk ij bi translated">Python 有望完全从版本 2 迁移到版本 3。</p><h2 id="55ba" class="kz la iq bd lb lc ld dn le lf lg dp lh jy li lj lk kc ll lm ln kg lo lp lq lr bi translated">深度学习:</h2><ul class=""><li id="71e9" class="kl km iq jp b jq ls ju lt jy mu kc mv kg mw kk lx kr ks kt bi translated">请求 RDD 操作中的 GPU。也就是说，您可以指定在 RDD 操作中每个任务使用多少个 GPU，例如用于 DL 训练和推理。</li><li id="242e" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk lx kr ks kt bi translated">YARN+Docker 支持用 GPU 资源推出我的 Spark 应用。所以您可以很容易地在 docker 文件中定义 DL 环境。</li></ul><h2 id="04f2" class="kz la iq bd lb lc ld dn le lf lg dp lh jy li lj lk kc ll lm ln kg lo lp lq lr bi translated">Kubernetes:</h2><p id="3a8a" class="pw-post-body-paragraph jn jo iq jp b jq ls js jt ju lt jw jx jy lu ka kb kc lv ke kf kg lw ki kj kk ij bi translated">通过 Kubernetes 的主机集群是下一件大事，它可能是内部部署或云。与其他编排容器(如 Mesos 和 Docker Swarm)所用的时间相比，部署、管理和启动时间的简易性将会大大提高。</p><ul class=""><li id="e449" class="kl km iq jp b jq jr ju jv jy kn kc ko kg kp kk lx kr ks kt bi translated">Spark-submit 使用变异的 webhook confs 在运行时修改 pods</li><li id="ecf1" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk lx kr ks kt bi translated">GPU 资源的自动发现</li><li id="096b" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk lx kr ks kt bi translated">执行程序 pod 级别的 GPU 隔离</li><li id="b9ba" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk lx kr ks kt bi translated">spark-使用 pod 模板提交</li><li id="a19e" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk lx kr ks kt bi translated">指定用于任务的 GPU 数量(RDD 舞台，熊猫 UDF)</li></ul><p id="96ac" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Kubernetes 编排容器并支持一些容器运行时，包括 Docker。Spark(版本 2.3 以上)附带了一个 docker 文件，可以用于此目的，并根据特定的应用程序需求进行定制。</p><h2 id="b1c0" class="kz la iq bd lb lc ld dn le lf lg dp lh jy li lj lk kc ll lm ln kg lo lp lq lr bi translated">Scala 版本升级:</h2><ul class=""><li id="f1bb" class="kl km iq jp b jq ls ju lt jy mu kc mv kg mw kk lx kr ks kt bi translated">Scala 2.12</li></ul><h2 id="7180" class="kz la iq bd lb lc ld dn le lf lg dp lh jy li lj lk kc ll lm ln kg lo lp lq lr bi translated">图形 API —图形和密码脚本:</h2><p id="dccc" class="pw-post-body-paragraph jn jo iq jp b jq ls js jt ju lt jw jx jy lu ka kb kc lv ke kf kg lw ki kj kk ij bi translated">火花图形 Api 有一个新的附加组件。</p><ul class=""><li id="fbd5" class="kl km iq jp b jq jr ju jv jy kn kc ko kg kp kk lx kr ks kt bi translated">一个图形以及属性图和密码脚本。</li></ul><p id="ff57" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">密码查询执行、查询结果处理和属性图存储/加载。为 API 提供一个独立模块的想法是允许一个 Cypher 查询引擎的多种实现。</p><ul class=""><li id="a76d" class="kl km iq jp b jq jr ju jv jy kn kc ko kg kp kk lx kr ks kt bi translated">Graph query 将有自己的催化剂&amp;它将遵循与 SparkSQL 相似的原则。</li></ul><h2 id="c88a" class="kz la iq bd lb lc ld dn le lf lg dp lh jy li lj lk kc ll lm ln kg lo lp lq lr bi translated">GPU 支持以及氢项目:</h2><p id="2db5" class="pw-post-body-paragraph jn jo iq jp b jq ls js jt ju lt jw jx jy lu ka kb kc lv ke kf kg lw ki kj kk ij bi translated">NVIDIA 拥有最好的 GPU，它已经远远超过了任何其他供应商。Spark 3.0 最适合这种情况。(英伟达 RTX——2080)是值得警惕的。</p><ul class=""><li id="2eca" class="kl km iq jp b jq jr ju jv jy kn kc ko kg kp kk lx kr ks kt bi translated">列出 GPU 资源</li><li id="12fe" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk lx kr ks kt bi translated">自动发现 GPU</li><li id="b91c" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk lx kr ks kt bi translated">GPU 分配给作业和回退</li><li id="d048" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk lx kr ks kt bi translated">熊猫 UDF 的 GPU</li><li id="64d1" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk lx kr ks kt bi translated">GPU 利用和监控</li><li id="0f66" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk lx kr ks kt bi translated">支持异构 GPU (AMD、Intel、Nvidia)</li></ul><h2 id="ad17" class="kz la iq bd lb lc ld dn le lf lg dp lh jy li lj lk kc ll lm ln kg lo lp lq lr bi translated">Java 升级:</h2><p id="7fea" class="pw-post-body-paragraph jn jo iq jp b jq ls js jt ju lt jw jx jy lu ka kb kc lv ke kf kg lw ki kj kk ij bi translated">随着 Java 社区每一个新的 JDK 版本的发布，我们都可以看到它向函数式编程迈近了一步。</p><p id="fb1c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Java-8 版本的发布是它的开始，从 Lambda 表达式开始。</p><p id="adfd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">下面是一个变量声明的例子:</p><p id="691c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">Java 10 版本之前:</strong></p><pre class="ly lz ma mb gt mc md me mf aw mg bi"><span id="d403" class="kz la iq md b gy mh mi l mj mk">String text = "HelloO Java 9";</span></pre><p id="46bb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">来自 Java 10 及更高版本:</strong></p><pre class="ly lz ma mb gt mc md me mf aw mg bi"><span id="b751" class="kz la iq md b gy mh mi l mj mk">var text = "HelloO Java 10 or Java 11";</span></pre><h2 id="f030" class="kz la iq bd lb lc ld dn le lf lg dp lh jy li lj lk kc ll lm ln kg lo lp lq lr bi translated">纱线升级:</h2><ul class=""><li id="b508" class="kl km iq jp b jq ls ju lt jy mu kc mv kg mw kk lx kr ks kt bi translated">GPU 调度支持</li><li id="04e6" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk lx kr ks kt bi translated">GPU 的自动发现</li><li id="cb43" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk lx kr ks kt bi translated">进程级的 GPU 隔离</li></ul><p id="ef79" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">下面是支持从 Spark 或 Yarn 3 版本开始的 GPU 的配置设置</p><h2 id="7369" class="kz la iq bd lb lc ld dn le lf lg dp lh jy li lj lk kc ll lm ln kg lo lp lq lr bi translated">GPU 调度</h2><p id="05d8" class="pw-post-body-paragraph jn jo iq jp b jq ls js jt ju lt jw jx jy lu ka kb kc lv ke kf kg lw ki kj kk ij bi translated"><strong class="jp ir">在 resource-types.xml 中</strong></p><pre class="ly lz ma mb gt mc md me mf aw mg bi"><span id="a676" class="kz la iq md b gy mh mi l mj mk">configuration&gt;<br/>  &lt;property&gt;<br/>     &lt;name&gt;yarn.resource-types&lt;/name&gt;<br/>     &lt;value&gt;yarn.io/gpu&lt;/value&gt;<br/>  &lt;/property&gt;<br/>&lt;/configuration&gt;</span></pre><p id="0337" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">在 yarn-site.xml 中</strong></p><pre class="ly lz ma mb gt mc md me mf aw mg bi"><span id="7a18" class="kz la iq md b gy mh mi l mj mk">&lt;property&gt;<br/>    &lt;name&gt;yarn.nodemanager.resource-plugins&lt;/name&gt;<br/>    &lt;value&gt;yarn.io/gpu&lt;/value&gt;<br/>  &lt;/property&gt;</span></pre><h2 id="fb9a" class="kz la iq bd lb lc ld dn le lf lg dp lh jy li lj lk kc ll lm ln kg lo lp lq lr bi translated">二进制文件:</h2><p id="c8b1" class="pw-post-body-paragraph jn jo iq jp b jq ls js jt ju lt jw jx jy lu ka kb kc lv ke kf kg lw ki kj kk ij bi translated">为支持非结构化数据而添加的另一种文件格式。你可以用它来加载图像、视频等等。限制是它不能执行写操作。</p><pre class="ly lz ma mb gt mc md me mf aw mg bi"><span id="7d78" class="kz la iq md b gy mh mi l mj mk">val df = spark.read.format(BINARY_FILE).load("Path")</span></pre><p id="bccf" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在你已经知道了 Spark 下一个主要版本，你可以看看 Spark 3.0  预览版。</p><p id="8fe0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果你喜欢这篇文章，那么你可以看看我的文章</p><ul class=""><li id="2636" class="kl km iq jp b jq jr ju jv jy kn kc ko kg kp kk lx kr ks kt bi translated"><a class="ae ml" href="https://medium.com/free-code-camp/deep-dive-into-spark-internals-and-architecture-f6e32045393b" rel="noopener"> <strong class="jp ir">深入火花内部架构</strong> </a>。</li><li id="cacd" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk lx kr ks kt bi translated"><a class="ae ml" href="https://github.com/Jayvardhan-Reddy/BigData-Ecosystem-Architecture" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir">大数据生态系统架构</strong> </a></li></ul><p id="2106" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">注:</strong> Delta-Lake 和考拉既可以是 Spark-3.0 的一部分，也可以作为单独的实体作为 Databricks 的一部分。</p></div><div class="ab cl mx my hu mz" role="separator"><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc"/></div><div class="ij ik il im in"><p id="c585" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果你也愿意，可以在 LinkedIn 上与我联系— <a class="ae ml" href="https://www.linkedin.com/in/jayvardhan-reddy-vanchireddy" rel="noopener ugc nofollow" target="_blank"> Jayvardhan Reddy </a>。</p><p id="9c58" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"># Apachespark # bigdata #数据工程师#数据科学#深度学习# ai # jayReddy # python # Scala # spark</p></div></div>    
</body>
</html>