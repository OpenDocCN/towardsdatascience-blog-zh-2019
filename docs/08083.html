<html>
<head>
<title>Tensorflow GPU installation made easy: Ubuntu Version</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Tensorflow GPU 安装变得简单:Ubuntu 版本</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/tensorflow-gpu-installation-made-easy-ubuntu-version-4260a52dd7b0?source=collection_archive---------6-----------------------#2019-11-06">https://towardsdatascience.com/tensorflow-gpu-installation-made-easy-ubuntu-version-4260a52dd7b0?source=collection_archive---------6-----------------------#2019-11-06</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="86a0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在 ubuntu 上安装 Tensorflow GPU 对于正确版本的 cuda 和 cudnn 来说是一个挑战。一年前，我写了一篇文章，讨论了用 conda 安装 Tensorflow GPU，而不是用单行命令安装 pip。这是那篇文章的链接。</p><div class="kl km gp gr kn ko"><a rel="noopener follow" target="_blank" href="/tensorflow-gpu-installation-made-easy-use-conda-instead-of-pip-52e5249374bc"><div class="kp ab fo"><div class="kq ab kr cl cj ks"><h2 class="bd ir gy z fp kt fr fs ku fu fw ip bi translated">Tensorflow GPU 安装变得简单:使用 conda 而不是 pip</h2><div class="kv l"><h3 class="bd b gy z fp kt fr fs ku fu fw dk translated">我有一个配置不错的 GPU，以前玩 FIFA 都是用它。转行 AI，本来想用 GPU 做深度学习的…</h3></div><div class="kw l"><p class="bd b dl z fp kt fr fs ku fu fw dk translated">towardsdatascience.com</p></div></div><div class="kx l"><div class="ky l kz la lb kx lc ld ko"/></div></div></a></div><p id="8063" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这篇文章已经被阅读了超过 25 万次，但仍然有一些 Ubuntu 用户在使用正确版本的 CUDA 和 CUDNN 运行 Tensorflow GPU 时面临问题。我知道这篇文章的标题可能会误导人，但是相信我，如果你一步一步的去做，那么在 ubuntu 上正确的安装是很容易的。</p></div><div class="ab cl le lf hu lg" role="separator"><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj"/></div><div class="ij ik il im in"><h2 id="448b" class="ll lm iq bd ln lo lp dn lq lr ls dp lt jy lu lv lw kc lx ly lz kg ma mb mc md bi translated">目录:</h2><ol class=""><li id="58fb" class="me mf iq jp b jq mg ju mh jy mi kc mj kg mk kk ml mm mn mo bi translated">检查 GPU 与 Tensorflow GPU 的兼容性！</li><li id="4d53" class="me mf iq jp b jq mp ju mq jy mr kc ms kg mt kk ml mm mn mo bi translated">切换到图形卡</li><li id="3c90" class="me mf iq jp b jq mp ju mq jy mr kc ms kg mt kk ml mm mn mo bi translated">检查 CUDA 与图形卡的兼容性</li><li id="458f" class="me mf iq jp b jq mp ju mq jy mr kc ms kg mt kk ml mm mn mo bi translated">根据 CUDA 确定 Tensorflow 版本</li><li id="7621" class="me mf iq jp b jq mp ju mq jy mr kc ms kg mt kk ml mm mn mo bi translated">下载 CUDA 工具包</li><li id="7035" class="me mf iq jp b jq mp ju mq jy mr kc ms kg mt kk ml mm mn mo bi translated">安装 CUDA</li><li id="95f4" class="me mf iq jp b jq mp ju mq jy mr kc ms kg mt kk ml mm mn mo bi translated">下载 cudnn 并安装</li><li id="883d" class="me mf iq jp b jq mp ju mq jy mr kc ms kg mt kk ml mm mn mo bi translated">验证 cudnn 安装</li><li id="b229" class="me mf iq jp b jq mp ju mq jy mr kc ms kg mt kk ml mm mn mo bi translated">在使用 Conda 的新环境中使用 pip 安装 Tensorflow-gpu</li><li id="955b" class="me mf iq jp b jq mp ju mq jy mr kc ms kg mt kk ml mm mn mo bi translated">验证 tensorflow 正在使用 GPU。</li></ol><h2 id="0841" class="ll lm iq bd ln lo lp dn lq lr ls dp lt jy lu lv lw kc lx ly lz kg ma mb mc md bi translated">注意-你可以使用这篇文章安装任何版本的 TENSORFLOW，确保你正确的决定了 CUDA 的版本。</h2></div><div class="ab cl le lf hu lg" role="separator"><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj"/></div><div class="ij ik il im in"><ol class=""><li id="7e5e" class="me mf iq jp b jq jr ju jv jy mu kc mv kg mw kk ml mm mn mo bi translated">检查 GPU 与 Tensorflow GPU 的兼容性(从<a class="ae mx" href="https://developer.nvidia.com/cuda-gpus" rel="noopener ugc nofollow" target="_blank">到此处</a></li><li id="afd9" class="me mf iq jp b jq mp ju mq jy mr kc ms kg mt kk ml mm mn mo bi translated">打开显卡<br/>进入菜单&gt;搜索“驱动程序设置”&gt;点击附加驱动程序</li></ol><figure class="mz na nb nc gt nd gh gi paragraph-image"><div class="gh gi my"><img src="../Images/1dcf16956dce00cf7d1c6cc5bbe3f86d.png" data-original-src="https://miro.medium.com/v2/resize:fit:860/format:webp/1*Xti_IGeam3m64RPoP_csQA.png"/></div></figure><p id="865a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">选择 NVIDIA 二进制驱动程序，在我的例子中是 384 版本的<strong class="jp ir">。这是非常重要的记录下来，因为这个驱动程序版本将有助于我们确定 CUDA 版本。</strong></p><figure class="mz na nb nc gt nd gh gi paragraph-image"><div role="button" tabindex="0" class="nf ng di nh bf ni"><div class="gh gi my"><img src="../Images/7729af694f2d9d1fa0b89dce5469d30b.png" data-original-src="https://miro.medium.com/v2/resize:fit:860/format:webp/1*HlY4lEBXp2vSnDS7-JP8-A.png"/></div></div></figure><p id="0f5f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，如果你去一个终端，键入 nvidia-smi，你也会得到驱动程序版本。</p><figure class="mz na nb nc gt nd gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/ad1c039ca402cbee0e8e0f0aed43ab2e.png" data-original-src="https://miro.medium.com/v2/resize:fit:950/format:webp/1*kAiwoNrDtgAGd_nToUD3XA.png"/></div></figure><p id="fac3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">3.从<a class="ae mx" href="https://docs.nvidia.com/deploy/cuda-compatibility/" rel="noopener ugc nofollow" target="_blank">这里</a>检查 CUDA 与您的驱动程序版本的兼容性。</p><figure class="mz na nb nc gt nd gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/1f39afff76bd892bb76a9494afadcf63.png" data-original-src="https://miro.medium.com/v2/resize:fit:916/format:webp/1*Nj9Thc8HUBxIxnzvbMTUmA.png"/></div></figure><p id="c8d0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">在我们的例子中，因为驱动程序版本是 384.130，所以我们只能安装 CUDA 9.0</strong></p><p id="037f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">4.根据 CUDA 确定 Tensorflow 版本</p><figure class="mz na nb nc gt nd gh gi paragraph-image"><div role="button" tabindex="0" class="nf ng di nh bf ni"><div class="gh gi nl"><img src="../Images/58fe6a2e3b46c24333e3bd031fe4f161.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*la5vGjrIwpB4XqDL0FzXxw.png"/></div></div></figure><p id="613f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">完成这一步后，你应该对 3 件事非常清楚:<br/> i)你要安装什么 Tensorflow 版本(tensorflow-gpu 1.12.0) <br/> ii)你要安装什么 CUDA 版本(9.0) <br/> iii)你要安装什么 cudnn 版本。(7)</p><p id="ae99" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">注意:这些问题的答案会因您当前使用的驱动程序版本而异。</strong></p><p id="1816" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果你知道这三个问题的答案，那么你已经闻到胜利的味道了。</p><p id="0370" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">5.下载 CUDA 工具包<br/>转到此<a class="ae mx" href="https://developer.nvidia.com/cuda-toolkit-archive" rel="noopener ugc nofollow" target="_blank">链接</a>并下载您在步骤 4 中找到的 CUDA 的具体版本(本例中为 CUDA 9.0)</p><figure class="mz na nb nc gt nd gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/4a28ee899bf67b1795798cb72c1df1d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1162/format:webp/1*b0fsWRF69ymW1j57rDHPPw.png"/></div></figure><p id="610e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">6.CUDA 安装</p><figure class="mz na nb nc gt nd gh gi paragraph-image"><div role="button" tabindex="0" class="nf ng di nh bf ni"><div class="gh gi no"><img src="../Images/f0e7c86352b7d5569a9bae749c159c20.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jNSCIz-4PSjqdwrijMKPzA.png"/></div></div><figcaption class="np nq gj gh gi nr ns bd b be z dk">Execute the run file downloaded</figcaption></figure><p id="a82c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你将获得软件许可证，长按回车键。现在接受除驱动程序安装之外的所有内容。</p><figure class="mz na nb nc gt nd gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/fee97178bb4af12fbd68ea897e6e413f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1132/format:webp/1*as16JH_q6NoHlUBmLstUMQ.png"/></div></figure><p id="09e1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">安装后，您将收到以下消息:</p><figure class="mz na nb nc gt nd gh gi paragraph-image"><div role="button" tabindex="0" class="nf ng di nh bf ni"><div class="gh gi nu"><img src="../Images/88523726250690d039a623514ef2b34f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oT9quGwpXSa2QCmggRxBng.png"/></div></div></figure><p id="f030" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在你必须在 bashrc 文件中输入特定的路径，这样你才能访问 cuda。打开终端并运行命令</p><blockquote class="nv nw nx"><p id="d365" class="jn jo nm jp b jq jr js jt ju jv jw jx ny jz ka kb nz kd ke kf oa kh ki kj kk ij bi translated">sudo su <br/> sudo gedit ~/。bashrc</p><p id="2191" class="jn jo nm jp b jq jr js jt ju jv jw jx ny jz ka kb nz kd ke kf oa kh ki kj kk ij bi translated">(在文件末尾添加以下行)</p></blockquote><pre class="mz na nb nc gt ob oc od oe aw of bi"><span id="c438" class="ll lm iq oc b gy og oh l oi oj">export PATH=/usr/local/cuda/bin:/usr/lib/:$PATH<br/>export LD_LIBRARY_PATH=/usr/local/cuda/lib64:/usr/lib/nvidia-384:$LD_LIBRARY_PATH<br/>export CUDA_HOME=/usr/local/cuda-9.0</span></pre><p id="db53" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">保存并关闭文件，然后将 bashrc 文件作为源，以使更改生效。</p><blockquote class="nv nw nx"><p id="f9e5" class="jn jo nm jp b jq jr js jt ju jv jw jx ny jz ka kb nz kd ke kf oa kh ki kj kk ij bi translated">来源~/。bashrc</p></blockquote><p id="3fe0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在打开一个终端并编写命令</p><pre class="mz na nb nc gt ob oc od oe aw of bi"><span id="d383" class="ll lm iq oc b gy og oh l oi oj">nvcc -V</span></pre><figure class="mz na nb nc gt nd gh gi paragraph-image"><div class="gh gi ok"><img src="../Images/0b2ffb522e7cfbf4d284db38de643d0d.png" data-original-src="https://miro.medium.com/v2/resize:fit:832/format:webp/1*4z8w2MxS8Ao_wdjI7JQStw.png"/></div></figure><p id="e20b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">您将获得运行的 CUDA 版本。</p><p id="55b7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">6.验证 CUDA 安装(可选):如果你对 nvcc 版本满意，那么你可以跳过这一步。</p><p id="5b03" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">打开终端并运行以下命令:</p><pre class="mz na nb nc gt ob oc od oe aw of bi"><span id="cd30" class="ll lm iq oc b gy og oh l oi oj">cd /usr/local/cuda/samples/1_Utilities/deviceQuery<br/>sudo make<br/>./deviceQuery</span></pre><figure class="mz na nb nc gt nd gh gi paragraph-image"><div role="button" tabindex="0" class="nf ng di nh bf ni"><div class="gh gi ol"><img src="../Images/11d44ee0eba29baa83f99599cb80ad06.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*K7mlcH6yrVhg1oDI69bMwQ.png"/></div></div></figure><p id="18e0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">7.下载与 CUDA 兼容的 cudnn 并安装</p><p id="d0c9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">进入<a class="ae mx" href="https://docs.nvidia.com/deeplearning/sdk/cudnn-archived/index.html" rel="noopener ugc nofollow" target="_blank">链接</a>并安装 cudnn。记住在这里下载 cudnn 的版本，它与 CUDA 兼容，在这里是 7。你需要注册 NVIDIA 网站来下载这个。</p><figure class="mz na nb nc gt nd gh gi paragraph-image"><div class="gh gi om"><img src="../Images/040d41b9af5dc7b115c184da3e098f92.png" data-original-src="https://miro.medium.com/v2/resize:fit:606/format:webp/1*IgNFko8FQOky2sf2sAVGog.png"/></div><figcaption class="np nq gj gh gi nr ns bd b be z dk">Download all the three files.</figcaption></figure><p id="96e9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">按照以下顺序安装 cudnn 包:运行时&gt;开发人员&gt;文档。使用命令</p><blockquote class="nv nw nx"><p id="ddea" class="jn jo nm jp b jq jr js jt ju jv jw jx ny jz ka kb nz kd ke kf oa kh ki kj kk ij bi translated">sudo dpkg -i <package_name/></p></blockquote><figure class="mz na nb nc gt nd gh gi paragraph-image"><div role="button" tabindex="0" class="nf ng di nh bf ni"><div class="gh gi on"><img src="../Images/15faeeee55a1fbe68370bbfc760452f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ht2frwdVncnO3_q3BYTxmw.png"/></div></div></figure><p id="0b29" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">8.验证 cudnn 安装</p><p id="37bc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">为了验证我们的 cudnn 安装，我们将测试一个 cudnn 样本。打开终端并发出以下命令:</p><pre class="mz na nb nc gt ob oc od oe aw of bi"><span id="9ee1" class="ll lm iq oc b gy og oh l oi oj">cp -r /usr/src/cudnn_samples_v7/ $HOME<br/>cd  $HOME/cudnn_samples_v7/mnistCUDNN<br/>make clean &amp;&amp; make<br/>./mnistCUDNN</span></pre><p id="817f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果 cudnn 安装正确，您将会看到这样的消息:测试通过</p><figure class="mz na nb nc gt nd gh gi paragraph-image"><div role="button" tabindex="0" class="nf ng di nh bf ni"><div class="gh gi oo"><img src="../Images/dcf84c0135413d5c3d31db9a206db995.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sBhywOC68NsmQu0Wjlr9YA.png"/></div></div></figure><p id="75ec" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">9.下载 Miniconda 并安装。记得不要 root 安装。</p><p id="bd5c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在创建一个安装 tensorflow-gpu 的环境。</p><pre class="mz na nb nc gt ob oc od oe aw of bi"><span id="20be" class="ll lm iq oc b gy og oh l oi oj">conda create  --name tf1 python=3.6</span></pre><p id="f254" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">执行此命令后，将使用 python 版安装一个名为 tf1 的新环境。现在激活环境并执行命令来安装我们在步骤 4 中找到的特定版本的 tensorflow-gpu。</p><pre class="mz na nb nc gt ob oc od oe aw of bi"><span id="0c9f" class="ll lm iq oc b gy og oh l oi oj">source activate tf1<br/>pip install tensorflow-gpu==1.12</span></pre><p id="9cb1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">10.要测试 tensorflow 安装，请遵循以下步骤:</p><ol class=""><li id="2c9d" class="me mf iq jp b jq jr ju jv jy mu kc mv kg mw kk ml mm mn mo bi translated">打开终端，使用<em class="nm">‘源激活 tf1’激活环境。</em></li><li id="7ba8" class="me mf iq jp b jq mp ju mq jy mr kc ms kg mt kk ml mm mn mo bi translated">使用<em class="nm">python</em>进入 python 控制台</li></ol><pre class="mz na nb nc gt ob oc od oe aw of bi"><span id="c258" class="ll lm iq oc b gy og oh l oi oj">import tensorflow as tfsess = tf.Session(config=tf.ConfigProto(log_device_placement=True))</span></pre><p id="4d82" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，如果您能够在终端中看到您的 GPU 信息，那么恭喜您，您终于成功了！</p><figure class="mz na nb nc gt nd gh gi paragraph-image"><div role="button" tabindex="0" class="nf ng di nh bf ni"><div class="gh gi op"><img src="../Images/38698e626db48905d90ab069ca39edb1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yKX-qKKHEh7XuhdgsjjrBg.png"/></div></div></figure></div><div class="ab cl le lf hu lg" role="separator"><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj"/></div><div class="ij ik il im in"><p id="c6d9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">谢谢你的时间。请通过<a class="ae mx" href="http://linkedin.com/in/harveenchadha" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>与我联系，了解更多关于数据科学的更新和文章。</p></div></div>    
</body>
</html>