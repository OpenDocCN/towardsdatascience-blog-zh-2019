<html>
<head>
<title>Pitfalls of Data Normalization</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">数据规范化的陷阱</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/pitfalls-of-data-normalization-bf05d65f1f4c?source=collection_archive---------15-----------------------#2019-07-29">https://towardsdatascience.com/pitfalls-of-data-normalization-bf05d65f1f4c?source=collection_archive---------15-----------------------#2019-07-29</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="3254" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsdatascience.com/tagged/stats-ml-life-sciences" rel="noopener" target="_blank">生命科学的数理统计和机器学习</a></h2><div class=""/><div class=""><h2 id="7606" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">标准化如何导致单纯形中的虚假相关</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/ddf3df134ccc15e6817aa601c8c2a693.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TC4HsDUv9V3AetnDVHa9dw.jpeg"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk"><a class="ae lh" href="https://en.wikipedia.org/wiki/Simplex" rel="noopener ugc nofollow" target="_blank">Image source</a></figcaption></figure><p id="4f6b" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">这是专栏<a class="ae lh" href="https://towardsdatascience.com/tagged/stats-ml-life-sciences?source=post_page---------------------------" rel="noopener" target="_blank">第四篇<strong class="lk jd">生命科学的数理统计与机器学习</strong>T5。<strong class="lk jd"> </strong>在本专栏以及</a><a class="ae lh" href="https://towardsdatascience.com/tagged/dl-for-life-sciences" rel="noopener" target="_blank"> <strong class="lk jd">生命科学的深度学习</strong> </a>中，我一直在反复强调，我们在生命科学中处理的数据是<strong class="lk jd">高维度的</strong>，这一事实我们并不总是意识到并且适当地考虑到。今天，我们将讨论另一个典型的陷阱，即如何执行<strong class="lk jd">数据标准化</strong>您可能会在<strong class="lk jd">单形空间</strong>中结束，在那里欧几里德距离不再有效，经典的频率统计数据失效。</p><h1 id="40f0" class="me mf it bd mg mh mi mj mk ml mm mn mo ki mp kj mq kl mr km ms ko mt kp mu mv bi translated">为什么要归一化数据？</h1><p id="a626" class="pw-post-body-paragraph li lj it lk b ll mw kd ln lo mx kg lq lr my lt lu lv mz lx ly lz na mb mc md im bi translated">数据标准化对于分析<a class="ae lh" href="https://en.wikipedia.org/wiki/DNA_sequencing" rel="noopener ugc nofollow" target="_blank"><strong class="lk jd">【NGS】</strong></a>数据，例如<a class="ae lh" href="https://en.wikipedia.org/wiki/RNA-Seq" rel="noopener ugc nofollow" target="_blank"> <strong class="lk jd"> RNA 测序(RNAseq) </strong> </a>和<a class="ae lh" href="https://en.wikipedia.org/wiki/Metagenomics" rel="noopener ugc nofollow" target="_blank"> <strong class="lk jd">宏基因组学</strong> </a>非常重要，以避免由于技术人为因素造成的混淆效应。事实上，有时一个基因在患病个体中的表达似乎比健康个体高，这仅仅是因为由于技术噪音，所有基因的总表达，生物信息学术语中的<strong class="lk jd">测序深度</strong>或<strong class="lk jd">文库大小</strong>碰巧在患病个体中更高。例如，如果你为我在这一系列文章中一直使用的<a class="ae lh" href="https://www.nature.com/articles/s41467-018-07582-3" rel="noopener ugc nofollow" target="_blank">癌症相关成纤维细胞(CAFs) </a>数据集绘制所有细胞的库大小，你会发现细胞与细胞之间的巨大差异，这些差异可能具有<strong class="lk jd">生物学</strong>或<strong class="lk jd">技术(噪声)</strong>性质。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="nb nc l"/></div></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nd"><img src="../Images/3dd16bd2623091918e422a42f78395ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*i-6wL_2yqCbOgeeo0drHtw.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk">Library sizes (total expression of all genes) for <a class="ae lh" href="https://www.nature.com/articles/s41467-018-07582-3" rel="noopener ugc nofollow" target="_blank">Cancer Associated Fibroblasts (CAFs)</a></figcaption></figure><p id="a578" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">为了安全起见，通常假设细胞之间的总基因表达应该没有太大差异，观察到的测序深度的巨大差异是由于技术偏差。因此，通过简单地将每个基因的表达除以所有基因的总基因表达(文库大小)来均衡细胞间的“平均”基因表达是非常诱人的。这种方法在 RNAseq 中被称为<strong class="lk jd">文库大小归一化</strong>，在宏基因组学社区被称为<strong class="lk jd">总和缩放(TSS) </strong>。</p><h1 id="043c" class="me mf it bd mg mh mi mj mk ml mm mn mo ki mp kj mq kl mr km ms ko mt kp mu mv bi translated">标准化会导致虚假的相关性</h1><p id="da54" class="pw-post-body-paragraph li lj it lk b ll mw kd ln lo mx kg lq lr my lt lu lv mz lx ly lz na mb mc md im bi translated">在这里，我们将证明如果我们天真地将文库大小标准化应用于 RNAseq 基因表达数据会发生什么。为了简单起见，让我们模拟两个基因的表达。我们独立地从<a class="ae lh" href="https://bioramble.wordpress.com/2016/01/30/why-sequencing-data-is-modeled-as-negative-binomial/" rel="noopener ugc nofollow" target="_blank"> <strong class="lk jd">负二项分布</strong> </a>中得出它们的表达值(计数)，因此基因应该不相关，我们可以通过计算<a class="ae lh" href="https://en.wikipedia.org/wiki/Spearman%27s_rank_correlation_coefficient" rel="noopener ugc nofollow" target="_blank"> Spearman 相关性</a>容易地确认它:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="nb nc l"/></div></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ne"><img src="../Images/23728efa65ca68eaf8d82d074eb8366c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Gg_oR_KdNXBinG20zQKBtg.png"/></div></div></figure><p id="841e" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我们可以看到，Spearman 相关性ρ= 0.001，p 值= 0.99，所以根本不显著相关。从基因 1 对基因 2 的图中，我们确认<strong class="lk jd">两个基因之间没有可见的相关性</strong>。现在让我们应用库大小归一化，这意味着每个计数将除以来自相应样品/柱的计数总和。之后，我们再次计算 Spearman 相关系数，并绘制两个基因的表达图。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="nb nc l"/></div></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nf"><img src="../Images/c4febfd880e15b7cb5967073896946ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qBxX4OyqH5x6C5d5Ytof1A.png"/></div></div></figure><p id="9982" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在这里我们可以看到一些惊人的东西。现在，这些基因似乎完全相关。Spearman 系数ρ=-1，p 值非常显著，该图显示了两个基因之间的完美相关性。</p><blockquote class="ng"><p id="d0a8" class="nh ni it bd nj nk nl nm nn no np md dk translated">发生了什么事？看起来，通过应用库大小标准化，我们发现了一种新的生物学！</p></blockquote><p id="e715" class="pw-post-body-paragraph li lj it lk b ll nq kd ln lo nr kg lq lr ns lt lu lv nt lx ly lz nu mb mc md im bi translated">基因在标准化之前是不相关的，但现在它们似乎一起表达(<strong class="lk jd">共表达</strong>)。等一下！我们知道，我们没有模拟两个基因相关/共表达，我们模拟了数据，所以我们知道真相:<strong class="lk jd">基因</strong> <strong class="lk jd">不应该</strong><strong class="lk jd"/><strong class="lk jd">相关，而是</strong> <strong class="lk jd">它们在文库大小标准化</strong>之后。真是自相矛盾！</p><h1 id="7cc0" class="me mf it bd mg mh mi mj mk ml mm mn mo ki mp kj mq kl mr km ms ko mt kp mu mv bi translated">合成数据和单纯形空间</h1><p id="574e" class="pw-post-body-paragraph li lj it lk b ll mw kd ln lo mx kg lq lr my lt lu lv mz lx ly lz na mb mc md im bi translated">我们刚刚观察到的效应叫做<a class="ae lh" href="https://en.wikipedia.org/wiki/Spurious_correlation_of_ratios" rel="noopener ugc nofollow" target="_blank"><strong class="lk jd"/></a>比率的虚假相关。<a class="ae lh" href="https://en.wikipedia.org/wiki/Karl_Pearson" rel="noopener ugc nofollow" target="_blank">卡尔·皮尔逊</a>(还记得皮尔逊相关系数吗？)最初是推动库大小规范化的人。然而，在他发现虚假相关性的影响后，他强烈反对通过库大小/总和来进行数据标准化。</p><p id="3019" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">库大小标准化的问题是给定样本<strong class="lk jd">的跨基因计数总计为 1 </strong>，即它们不再是<strong class="lk jd">独立的</strong>，而是<strong class="lk jd">受限的</strong>，因此它们变成<a class="ae lh" href="https://en.wikipedia.org/wiki/Compositional_data" rel="noopener ugc nofollow" target="_blank"> <strong class="lk jd">组成的</strong> </a>。通过构建复合数据，您不再处于传统频率统计所基于的欧几里得空间，因为欧几里得空间/距离是高斯分布的结果。事实上，你最终会进入<strong class="lk jd">单形空间</strong>，在这里传统的统计方法不再适用，因为两点之间的距离不再是欧几里德距离，而是“带约束的欧几里德距离”，即<a class="ae lh" href="https://en.wikipedia.org/wiki/Compositional_data#Aitchison_geometry" rel="noopener ugc nofollow" target="_blank"> <strong class="lk jd">艾奇逊距离</strong> </a>。</p><p id="73b1" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">如果您在单纯形空间中，您不应使用任何传统的统计方法，如线性回归、相关或主成分分析(PCA ),因为它们基于数据点之间的欧几里得距离。而且如果你在做 RNAseq 分析，文库大小归一化可能会彻底毁了<a class="ae lh" href="https://bmcbioinformatics.biomedcentral.com/articles/10.1186/1471-2105-9-559" rel="noopener ugc nofollow" target="_blank"> <strong class="lk jd">基因网络分析</strong> </a>，这对基因表达数据的生物学解读非常重要。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nv"><img src="../Images/3878d1333f1c7cc3dfd02808ddb6fc9e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*icEiOu5lSvOC7EWcIJHzNw.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk">Library Size Normalization may severely damage the gene network analysis, <a class="ae lh" href="https://bmcbioinformatics.biomedcentral.com/articles/10.1186/1471-2105-9-559" rel="noopener ugc nofollow" target="_blank">image source</a></figcaption></figure><p id="983c" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">如果您仍然想对成分数据使用 PCA，您应该执行<a class="ae lh" href="https://en.wikipedia.org/wiki/Compositional_data#Additive_logratio_transform" rel="noopener ugc nofollow" target="_blank">对数比转换</a>之一，将数据从单纯形转换回欧几里德空间:<strong class="lk jd">加法(alr)、中心(clr)或异构(ilr)对数比转换</strong>。</p><p id="5a83" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">单纯形空间的效果似乎是<a class="ae lh" href="https://microbiomejournal.biomedcentral.com/articles/10.1186/s40168-017-0237-y" rel="noopener ugc nofollow" target="_blank"> <strong class="lk jd">众所周知的</strong> </a> <strong class="lk jd">在</strong> <strong class="lk jd">宏基因组学</strong> <strong class="lk jd">区域</strong>，这里的社区通常使用对数比变换或<a class="ae lh" href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4010126/" rel="noopener ugc nofollow" target="_blank"> <strong class="lk jd">累积和缩放(CSS) </strong> </a>而不是总和缩放(TSS)。令人惊讶的是，我从未在 RNAseq 或 scRNAseq 文献中听到任何关于单形空间偏差的提及。对数比变换(alr，clr，ilr)使用对数函数，我假设这就是为什么 RNAseq 人喜欢对数变换他们的数据，而没有意识到<strong class="lk jd">这种操作实际上允许他们放弃单纯形空间</strong>。</p><h1 id="b4b1" class="me mf it bd mg mh mi mj mk ml mm mn mo ki mp kj mq kl mr km ms ko mt kp mu mv bi translated">为什么要 TPM 正常化？</h1><p id="95c3" class="pw-post-body-paragraph li lj it lk b ll mw kd ln lo mx kg lq lr my lt lu lv mz lx ly lz na mb mc md im bi translated">有趣的是，<a class="ae lh" href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2820677/" rel="noopener ugc nofollow" target="_blank"><strong class="lk jd">【TPM】</strong></a>最近成了一种流行的归一化策略。<a class="ae lh" href="https://gtexportal.org/home/" rel="noopener ugc nofollow" target="_blank"> <strong class="lk jd"> GTEX </strong> </a>，也许是<strong class="lk jd">最大的公共</strong> <strong class="lk jd"> RNAseq 资源</strong>，默认提供基因表达数据作为 TPM 标准化计数。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nw"><img src="../Images/676a53703ad0bbccc284af83b0cda369.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_af2ONOMQWIRQTumVtP-9Q.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk">GTEX RNAseq resource provides TPM normalized gene expression by default</figcaption></figure><p id="fa63" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">根据定义，给定样本的 TPM 计数<a class="ae lh" href="https://www.rna-seqblog.com/rpkm-fpkm-and-tpm-clearly-explained/" rel="noopener ugc nofollow" target="_blank">总计为一百万</a>，这是一个单纯形空间约束。因此<strong class="lk jd"> TPM 计数并不比库大小标准化计数</strong>更好，因为它们也遭受单形空间偏差，并且不应该天真地对这些计数应用例如 PCA。很多 GTEX 用户似乎并不知道这个陷阱，在 GTEX 门户上<strong class="lk jd">没有提到</strong> <strong class="lk jd">。因此，我要问所有 GTEX 开发者、用户和 RNAseq 社区的问题是:</strong></p><blockquote class="ng"><p id="aef4" class="nh ni it bd nj nk nl nm nn no np md dk translated">你们意识到你们是通过使用 TPM 标准化基因表达计数在单纯形空间中工作的吗？</p></blockquote><h1 id="51bc" class="me mf it bd mg mh mi mj mk ml mm mn mo ki nx kj mq kl ny km ms ko nz kp mu mv bi translated">摘要</h1><p id="41fe" class="pw-post-body-paragraph li lj it lk b ll mw kd ln lo mx kg lq lr my lt lu lv mz lx ly lz na mb mc md im bi translated">在这篇文章中，我们了解到<strong class="lk jd"> RNAseq 数据标准化</strong>是<strong class="lk jd">避免技术偏差</strong>的重要一步，然而<strong class="lk jd">文库大小</strong>标准化可能导致<strong class="lk jd">基因之间虚假的相关性</strong>。这是因为库大小标准化的表达式值不再是欧几里德空间中的<strong class="lk jd">而是单纯形空间</strong>中的<strong class="lk jd">传统的</strong> <strong class="lk jd">频数统计中断</strong>和<strong class="lk jd">对数比变换</strong>必须被应用以避免错误的结果。</p><p id="8ba3" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在下面的评论中让我知道生命科学中的哪些分析对你来说是特别神秘的，我会在这个专栏中尽力解答。在媒体<a class="oa ob ep" href="https://medium.com/u/8570b484f56c?source=post_page-----bf05d65f1f4c--------------------------------" rel="noopener" target="_blank">关注我，在 Twitter @NikolayOskolkov 关注我，在 Linkedin </a>关注我。我的下一个帖子将是关于<strong class="lk jd">神秘的孟德尔随机化</strong>，敬请关注。</p></div></div>    
</body>
</html>