<html>
<head>
<title>Docker + OpenCV: Real-Time Facial Recognition in 1 minute</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">docker+OpenCV:1 分钟实时面部识别</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/real-time-facial-recognition-in-1-minute-docker-opencv-e89f281c8f01?source=collection_archive---------11-----------------------#2019-10-23">https://towardsdatascience.com/real-time-facial-recognition-in-1-minute-docker-opencv-e89f281c8f01?source=collection_archive---------11-----------------------#2019-10-23</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="474f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">集成 Docker、OpenCV.js 和 Nginx，快速部署实时面部识别机器学习模型。对于 Mac Docker 社区来说，这是一个方便的解决方案，他们正在努力获得网络摄像头的访问，因为 Docker hyper kit 支持的缺点在 Nginx 的帮助下。该解决方案可以很容易地扩展到包括 OpenCV、Keras、Tensorflow 等任何现成的机器学习模型..</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi kl"><img src="../Images/ede26276229294a51befb10d7dd014d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/1*rcLEuhP35RiIWBeYIGVcPg.gif"/></div></figure><p id="631f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">动机:</strong></p><ol class=""><li id="f372" class="kt ku iq jp b jq jr ju jv jy kv kc kw kg kx kk ky kz la lb bi translated">虽然推荐从源代码构建 OpenCV.js，但是需要 LLVM-to-JavaScript 编译器和 CMAKE，这相当复杂。</li><li id="ee99" class="kt ku iq jp b jq lc ju ld jy le kc lf kg lg kk ky kz la lb bi translated">由于 Docker 超级工具包支持的缺点，从 Docker 容器访问 Mac 网络摄像头是不可能的。因此，在 Mac 上部署实时面部识别模型是不可能的。</li></ol><p id="ada4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">因此，我决定让任何人在 Docker 的帮助下在几秒钟内部署 OpenCV 模型变得尽可能容易。我通过使用夜间构建克服了<strong class="jp ir">点 1 </strong>，通过使用 Nginx 克服了<strong class="jp ir">点 2 </strong>。这完全是为了让读者熟悉 Docker 的机器学习的<strong class="jp ir">部署</strong>方面，而不是为了建立面部识别的机器学习模型。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="gh gi lh"><img src="../Images/0a82ca5f84a63cd8405d9b9c32bb949b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mc1QHpXD9MN8kmWTyBzWpw.png"/></div></div></figure><p id="ace6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">项目结构:</strong>从<strong class="jp ir"> Github repo </strong>这里<a class="ae lm" href="https://github.com/gomesc166/MediumRepo" rel="noopener ugc nofollow" target="_blank">克隆项目</a>。</p><pre class="km kn ko kp gt ln lo lp lq aw lr bi"><span id="3abe" class="ls lt iq lo b gy lu lv l lw lx">. <br/>├── Version1            <br/>│ ├── Dockerfile                    #Building the image <br/>│ ├── docker-compose.yml            #Defining the files for mounting    <br/>│ ├── CV                            #OpenCV.js soure code<br/>|    ├──js_face_recognition.html<br/>|    ├──opencv.js<br/>|    ├──utils.js</span></pre><ol class=""><li id="519c" class="kt ku iq jp b jq jr ju jv jy kv kc kw kg kx kk ky kz la lb bi translated"><strong class="jp ir"> Dockerfile </strong></li></ol><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="ly lz l"/></div></figure><p id="b451" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> 2。docker-compose.yml </strong></p><p id="06fc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">请更新此文件中项目文件夹的路径。注意 Nginx 服务器被设置为在端口 80 上运行。</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="ly lz l"/></div><figcaption class="ma mb gj gh gi mc md bd b be z dk">docker-compose.yml</figcaption></figure><p id="3e9b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> CV 文件夹</strong>驻留了该项目的源代码，包括 OpenCV.js 的夜间构建。我使用了 OpenCV.js <a class="ae lm" href="https://docs.opencv.org/3.4/d9/df8/tutorial_root.html" rel="noopener ugc nofollow" target="_blank">官方网站</a>的教程中的面部识别代码，也可以从 OpenCV 的官方 GitHub repo 中获得。他们提供的教程真的很有帮助，也是我学习大多数 OpenCV.js 应用程序的地方。</p><h2 id="6a6c" class="ls lt iq bd me mf mg dn mh mi mj dp mk jy ml mm mn kc mo mp mq kg mr ms mt mu bi translated"><strong class="ak">第一步:</strong></h2><pre class="km kn ko kp gt ln lo lp lq aw lr bi"><span id="79c9" class="ls lt iq lo b gy lu lv l lw lx">#Clone the repo <br/>git clone <a class="ae lm" href="mailto:git@github.com" rel="noopener ugc nofollow" target="_blank">git@github.com</a>:gomesc166/MediumRepo.git</span><span id="b7f1" class="ls lt iq lo b gy mv lv l lw lx">#Go to ObjectDetection directory <br/>cd Version1</span></pre><h2 id="c5c8" class="ls lt iq bd me mf mg dn mh mi mj dp mk jy ml mm mn kc mo mp mq kg mr ms mt mu bi translated"><strong class="ak">第二步:</strong></h2><pre class="km kn ko kp gt ln lo lp lq aw lr bi"><span id="62a7" class="ls lt iq lo b gy lu lv l lw lx">#Build the image<br/>docker build -t object-detection-image .</span></pre><h2 id="5266" class="ls lt iq bd me mf mg dn mh mi mj dp mk jy ml mm mn kc mo mp mq kg mr ms mt mu bi translated"><strong class="ak">第三步:</strong></h2><pre class="km kn ko kp gt ln lo lp lq aw lr bi"><span id="431f" class="ls lt iq lo b gy lu lv l lw lx">#Start the Container<br/>docker-compose up</span></pre><p id="56d4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">注意:</strong>编辑主机上项目的路径。</p><h2 id="63b7" class="ls lt iq bd me mf mg dn mh mi mj dp mk jy ml mm mn kc mo mp mq kg mr ms mt mu bi translated"><strong class="ak">第四步:</strong></h2><p id="0657" class="pw-post-body-paragraph jn jo iq jp b jq mw js jt ju mx jw jx jy my ka kb kc mz ke kf kg na ki kj kk ij bi translated">在浏览器上访问<strong class="jp ir"> localhost:80 </strong></p><p id="97ac" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">单击下载模型按钮。模型下载完成后，您可以添加任意多的人进行识别。如果您想要添加自定义的 Keras/Tensorflow 模型，您必须调整 JS 脚本。</p></div><div class="ab cl nb nc hu nd" role="separator"><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng"/></div><div class="ij ik il im in"><p id="21a0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果您对代码有任何疑问，请留下您的回复，我会尽快回复您。我使用了官方 OpenCV.js 教程中的 JS 脚本。请记住，这篇文章的主要目的是让用户了解如何使用 Docker 轻松部署现成的模型，并克服在 Mac 上使用 Docker hyper kit 的限制。干杯..</p></div></div>    
</body>
</html>