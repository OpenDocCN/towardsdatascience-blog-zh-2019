<html>
<head>
<title>Causal Inference Using Synthetic Control: The Ultimate Guide</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用综合控制的因果推理:最终指南</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/causal-inference-using-synthetic-control-the-ultimate-guide-a622ad5cf827?source=collection_archive---------4-----------------------#2019-12-27">https://towardsdatascience.com/causal-inference-using-synthetic-control-the-ultimate-guide-a622ad5cf827?source=collection_archive---------4-----------------------#2019-12-27</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="a743" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph">实验和因果推理</h2><div class=""/><div class=""><h2 id="711a" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">我们可以只用一个治疗病例和少数对照病例进行因果推断吗？</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/86d92d4bb152aeebab591e4409d73c90.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7zKjE0bIN7pzZaU_y5558Q.jpeg"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk">Photo by <a class="ae lh" href="https://unsplash.com/@franki?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Franki Chamaki</a> on <a class="ae lh" href="https://unsplash.com/s/photos/artificial-intelligence?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="4fa6" class="li lj it bd lk ll lm ln lo lp lq lr ls ki lt kj lu kl lv km lw ko lx kp ly lz bi translated">技术困境</h1><p id="ca21" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">在其他帖子中，我解释了什么是因果关系，以及如何使用准实验设计进行因果推断(<a class="ae lh" rel="noopener" target="_blank" href="/does-minimum-wage-decrease-employment-a-difference-in-differences-approach-cb208ed07327">做了</a>，<a class="ae lh" rel="noopener" target="_blank" href="/what-is-the-strongest-quasi-experimental-method-interrupted-time-series-period-f59fe5b00b31">做了</a>，<a class="ae lh" rel="noopener" target="_blank" href="/the-crown-jewel-of-causal-inference-regression-discontinuity-design-rdd-bad37a68e786"> RDD </a>)。几乎所有的研究方法都必须满足两个前提条件，才能产生有意义的见解:</p><blockquote class="mw mx my"><p id="2594" class="ma mb mz mc b md na kd mf mg nb kg mi nc nd ml mm ne nf mp mq ng nh mt mu mv im bi translated">1.治疗组看起来与对照组相似(<strong class="mc jd">相似性可比性</strong>)；</p><p id="82e7" class="ma mb mz mc b md na kd mf mg nb kg mi nc nd ml mm ne nf mp mq ng nh mt mu mv im bi translated">2.每组内足够多的观察值(<strong class="mc jd">大 n </strong>)。</p></blockquote><p id="550c" class="pw-post-body-paragraph ma mb it mc b md na kd mf mg nb kg mi mj nd ml mm mn nf mp mq mr nh mt mu mv im bi translated">这两个前提条件为因果推断奠定了基础。但是，如果我们只有一个治疗病例和几个对照病例，有可能做因果推断吗？更糟糕的是，如果没有与治疗病例有相似协变量的对照病例，我们该怎么办？</p><p id="b6d2" class="pw-post-body-paragraph ma mb it mc b md na kd mf mg nb kg mi mj nd ml mm mn nf mp mq mr nh mt mu mv im bi translated">在这些情况下，基于回归的解决方案(例如，关键变量匹配或倾向得分匹配)表现不佳。此外，其他准实验设计，如 DID 方法，在治疗组和对照组之间需要相似的协变量，在这两种情况下会产生巨大的偏差。</p><p id="86b0" class="pw-post-body-paragraph ma mb it mc b md na kd mf mg nb kg mi mj nd ml mm mn nf mp mq mr nh mt mu mv im bi translated">在这篇文章中，我自豪地提出一个统计解决方案，即<strong class="mc jd">综合控制方法(SCM) </strong>，它是由一群像我一样的政治科学家提出的。老实说，供应链管理有巨大的因果潜力，但目前仍未得到充分重视。随着面向消费者的公司希望了解模拟的消费者行为，它开始在行业中引起一些关注。</p></div><div class="ab cl ni nj hx nk" role="separator"><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn"/></div><div class="im in io ip iq"><h1 id="15c9" class="li lj it bd lk ll np ln lo lp nq lr ls ki nr kj lu kl ns km lw ko nt kp ly lz bi translated">基础</h1><p id="86eb" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">SCM 使用来自“供体”池的多个病例的加权平均值来创建人工对照病例。</p><p id="88af" class="pw-post-body-paragraph ma mb it mc b md na kd mf mg nb kg mi mj nd ml mm mn nf mp mq mr nh mt mu mv im bi translated">下面是一个简化的过程:</p><ol class=""><li id="eb86" class="nu nv it mc b md na mg nb mj nw mn nx mr ny mv nz oa ob oc bi translated">假设有 J + 1 个单位；</li><li id="e87b" class="nu nv it mc b md od mg oe mj of mn og mr oh mv nz oa ob oc bi translated">j(1)是已治疗的病例(一个<strong class="mc jd"> <em class="mz">注意</em> </strong> <em class="mz"> : </em> <strong class="mc jd"> <em class="mz">只有一个已治疗的病例</em></strong>)；从 j(2)到 j(j+1)的单元是构成“<strong class="mc jd"> <em class="mz">供体池</em> </strong>”的未曝光病例；</li><li id="b0c0" class="nu nv it mc b md od mg oe mj of mn og mr oh mv nz oa ob oc bi translated">从捐献者那里收集并得到单位的加权平均值</li><li id="d53c" class="nu nv it mc b md od mg oe mj of mn og mr oh mv nz oa ob oc bi translated">选择使以下损失函数最小的加权值 W*:</li></ol><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi oi"><img src="../Images/707bbb243103ce7ba4df5cad5025133b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pJvZ0Z7mpsnqv6tKrKRVXA.png"/></div></div></figure><p id="1d37" class="pw-post-body-paragraph ma mb it mc b md na kd mf mg nb kg mi mj nd ml mm mn nf mp mq mr nh mt mu mv im bi translated"><em class="mz">(详细描述请参考</em> <strong class="mc jd"> <em class="mz">阿巴迪等人 2010 </em> </strong> <em class="mz">和</em> <strong class="mc jd"> <em class="mz">阿巴迪等人 2015 </em> </strong> <em class="mz">)。)</em></p><p id="211c" class="pw-post-body-paragraph ma mb it mc b md na kd mf mg nb kg mi mj nd ml mm mn nf mp mq mr nh mt mu mv im bi translated">总之，SCM 通过提供正式的标准和程序引导我们通过生成控制案例的过程，这是<a class="ae lh" href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2943670/" rel="noopener ugc nofollow" target="_blank"> matching </a>或其他基于回归的方法无法实现的。</p><p id="44d2" class="pw-post-body-paragraph ma mb it mc b md na kd mf mg nb kg mi mj nd ml mm mn nf mp mq mr nh mt mu mv im bi translated">SCM 的另一个优点是，它能够使合成病例在关键指标方面看起来像治疗过的病例，如先前的协变量和其他事后结果预测(Abadie 等人，2010 年)。<strong class="mc jd">换句话说，供应链管理可以提供比较。</strong></p></div><div class="ab cl ni nj hx nk" role="separator"><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn"/></div><div class="im in io ip iq"><h1 id="600a" class="li lj it bd lk ll np ln lo lp nq lr ls ki nr kj lu kl ns km lw ko nt kp ly lz bi translated"><strong class="ak">什么时候使用 SCM？</strong></h1><p id="793d" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">SCM 是以下两种情况的理想选择:</p><ol class=""><li id="c378" class="nu nv it mc b md na mg nb mj nw mn nx mr ny mv nz oa ob oc bi translated">社会事件发生在总体层面，如县、州、省。</li><li id="b3f0" class="nu nv it mc b md od mg oe mj of mn og mr oh mv nz oa ob oc bi translated">只有一个治疗病例和几个对照病例。</li></ol><p id="b930" class="pw-post-body-paragraph ma mb it mc b md na kd mf mg nb kg mi mj nd ml mm mn nf mp mq mr nh mt mu mv im bi translated">由于这两个特点，当涉及到大规模项目评估时，SCM 是一种可行的方法(例如，<a class="ae lh" href="https://economics.mit.edu/files/11859" rel="noopener ugc nofollow" target="_blank">加州的烟草控制项目</a>，<a class="ae lh" href="https://link.springer.com/article/10.1007/s10940-014-9226-5" rel="noopener ugc nofollow" target="_blank">评估基于场所的犯罪干预</a>)。说真的，业界真的应该把它添加到他们的 DS 工具包中。</p></div><div class="ab cl ni nj hx nk" role="separator"><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn"/></div><div class="im in io ip iq"><h1 id="e8b8" class="li lj it bd lk ll np ln lo lp nq lr ls ki nr kj lu kl ns km lw ko nt kp ly lz bi translated"><strong class="ak">优点</strong></h1><p id="24eb" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">总的来说，供应链管理有三个优势。</p><ol class=""><li id="ad67" class="nu nv it mc b md na mg nb mj nw mn nx mr ny mv nz oa ob oc bi translated">它在 0 和 1 之间分配权重，因此<strong class="mc jd">避免了外推</strong>。外推意味着我们不将权重限制在 0 和 1 之间，但是如果权重保持在 100%之外，这是没有意义的。我是说怎么解读一个权重 200%？完全没有任何直觉。</li><li id="5bec" class="nu nv it mc b md od mg oe mj of mn og mr oh mv nz oa ob oc bi translated">它列出了选择标准，并解释了每个捐赠者的相对重要性。</li><li id="53e2" class="nu nv it mc b md od mg oe mj of mn og mr oh mv nz oa ob oc bi translated">合成对照病例与治疗病例非常相似，几乎相同。</li><li id="0d8d" class="nu nv it mc b md od mg oe mj of mn og mr oh mv nz oa ob oc bi translated">合成对照的选择不依赖于干预后的结果，这使得不可能挑选可能影响结论的研究设计。</li></ol></div><div class="ab cl ni nj hx nk" role="separator"><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn"/></div><div class="im in io ip iq"><h1 id="73d3" class="li lj it bd lk ll np ln lo lp nq lr ls ki nr kj lu kl ns km lw ko nt kp ly lz bi translated">怎么用？</h1><h2 id="8ddf" class="oj lj it bd lk ok ol dn lo om on dp ls mj oo op lu mn oq or lw mr os ot ly iz bi translated"><strong class="ak"> 1。行业应用</strong></h2><ol class=""><li id="3b55" class="nu nv it mc b md me mg mh mj ou mn ov mr ow mv nz oa ob oc bi translated"><strong class="mc jd">程序评估。</strong></li></ol><ul class=""><li id="3be8" class="nu nv it mc b md na mg nb mj nw mn nx mr ny mv ox oa ob oc bi translated"><a class="ae lh" href="https://economics.mit.edu/files/11859" rel="noopener ugc nofollow" target="_blank">比较案例研究的综合控制方法:评估加州烟草控制项目的效果</a></li><li id="bb54" class="nu nv it mc b md od mg oe mj of mn og mr oh mv ox oa ob oc bi translated"><a class="ae lh" href="https://www.aeaweb.org/articles?id=10.1257/000282803321455188" rel="noopener ugc nofollow" target="_blank">冲突的经济成本:巴斯克地区的案例研究</a></li></ul><p id="1bbc" class="pw-post-body-paragraph ma mb it mc b md na kd mf mg nb kg mi mj nd ml mm mn nf mp mq mr nh mt mu mv im bi translated"><strong class="mc jd"> 2。犯罪研究</strong></p><ul class=""><li id="5636" class="nu nv it mc b md na mg nb mj nw mn nx mr ny mv ox oa ob oc bi translated"><a class="ae lh" href="https://link.springer.com/article/10.1007/s10940-014-9226-5" rel="noopener ugc nofollow" target="_blank">评估基于场所的犯罪干预的综合控制方法</a></li><li id="c902" class="nu nv it mc b md od mg oe mj of mn og mr oh mv ox oa ob oc bi translated"><a class="ae lh" href="https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0185629" rel="noopener ugc nofollow" target="_blank">干旱对加州犯罪的影响:综合控制方法</a></li></ul><p id="085d" class="pw-post-body-paragraph ma mb it mc b md na kd mf mg nb kg mi mj nd ml mm mn nf mp mq mr nh mt mu mv im bi translated"><strong class="mc jd"> 3。罕见事件</strong></p><ul class=""><li id="44b7" class="nu nv it mc b md na mg nb mj nw mn nx mr ny mv ox oa ob oc bi translated">潜在地，我们可以应用合成控制来为罕见事件生成更多的案例，因为罕见事件缺乏数据供应。请查看我的另一篇关于如何使用 5 个机器学习分类器对罕见事件进行分类的帖子。</li></ul><div class="oy oz gp gr pa pb"><a rel="noopener follow" target="_blank" href="/classifying-rare-events-using-five-machine-learning-techniques-fab464573233"><div class="pc ab fo"><div class="pd ab pe cl cj pf"><h2 class="bd jd gy z fp pg fr fs ph fu fw jc bi translated">脖子上的痛:使用 5 种机器学习方法预测罕见事件</h2><div class="pi l"><h3 class="bd b gy z fp pg fr fs ph fu fw dk translated">哪一种最适合不平衡数据？有什么权衡吗？</h3></div><div class="pj l"><p class="bd b dl z fp pg fr fs ph fu fw dk translated">towardsdatascience.com</p></div></div><div class="pk l"><div class="pl l pm pn po pk pp lb pb"/></div></div></a></div></div><div class="ab cl ni nj hx nk" role="separator"><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn"/></div><div class="im in io ip iq"><h2 id="5d09" class="oj lj it bd lk ok ol dn lo om on dp ls mj oo op lu mn oq or lw mr os ot ly iz bi translated">2.r 实施</h2><p id="e049" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">在这一节中，我将复制 Abadie (2003) 的结果，该结果研究了恐怖主义如何影响西班牙巴斯克地区的经济产出。我们将使用 R 包“Synth”进行分析，详细的数学解释和 R 指令请参考<a class="ae lh" href="https://core.ac.uk/download/pdf/6287910.pdf" rel="noopener ugc nofollow" target="_blank"> Synth:比较案例研究中综合控制方法的 R 包</a>。</p><p id="3146" class="pw-post-body-paragraph ma mb it mc b md na kd mf mg nb kg mi mj nd ml mm mn nf mp mq mr nh mt mu mv im bi translated"><strong class="mc jd">步骤 0:包、库和探索性数据分析</strong></p><pre class="ks kt ku kv gt pq pr ps pt aw pu bi"><span id="e21c" class="oj lj it pr b gy pv pw l px py"># install and load package<br/>install.packages("Synth") <br/>library(Synth)</span><span id="ecdf" class="oj lj it pr b gy pz pw l px py"># read the dataset "basque"<br/>data("basque")</span><span id="5e5b" class="oj lj it pr b gy pz pw l px py">#EDA<br/>dim(basque) #774*17<br/>basque[1:10,]</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi qa"><img src="../Images/be680cd129273871c8230ada85365d91.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9vZEpxE7rr9v1feHLrfX3w.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk">Table 1</figcaption></figure><p id="15b4" class="pw-post-body-paragraph ma mb it mc b md na kd mf mg nb kg mi mj nd ml mm mn nf mp mq mr nh mt mu mv im bi translated">从表 1 中，有 774 个观察值和 17 个变量(列)。</p><p id="16e4" class="pw-post-body-paragraph ma mb it mc b md na kd mf mg nb kg mi mj nd ml mm mn nf mp mq mr nh mt mu mv im bi translated"><em class="mz">第 1–3 列:地区号、名称和年份(ID 信息)</em></p><p id="79ef" class="pw-post-body-paragraph ma mb it mc b md na kd mf mg nb kg mi mj nd ml mm mn nf mp mq mr nh mt mu mv im bi translated"><em class="mz"> DV: gdpcap(人均 GDP)</em></p><p id="22fd" class="pw-post-body-paragraph ma mb it mc b md na kd mf mg nb kg mi mj nd ml mm mn nf mp mq mr nh mt mu mv im bi translated"><em class="mz">其他列:有 13 个预测变量。</em></p><p id="b465" class="pw-post-body-paragraph ma mb it mc b md na kd mf mg nb kg mi mj nd ml mm mn nf mp mq mr nh mt mu mv im bi translated"><strong class="mc jd">第一步:数据准备</strong></p><p id="5456" class="pw-post-body-paragraph ma mb it mc b md na kd mf mg nb kg mi mj nd ml mm mn nf mp mq mr nh mt mu mv im bi translated">原始数据集“巴斯克”有一个传统的面板格式，为了使用<strong class="mc jd"> synth() </strong>，我们需要以另一种形式读取它。</p><pre class="ks kt ku kv gt pq pr ps pt aw pu bi"><span id="3616" class="oj lj it pr b gy pv pw l px py"># set up different arguments<br/># foo:  </span><span id="ad15" class="oj lj it pr b gy pz pw l px py">dataprep.out &lt;- dataprep(foo = basque,<br/> predictors = c(“school.illit”, “school.prim”, “school.med”,<br/> “school.high”, “school.post.high”, “invest”),<br/> predictors.op = “mean”, <strong class="pr jd"># the operator</strong><br/> time.predictors.prior = 1964:1969, <strong class="pr jd">#the entire time frame from the #beginning to the end</strong><br/> special.predictors = list(<br/> list(“gdpcap”, 1960:1969, “mean”),<br/> list(“sec.agriculture”, seq(1961,1969,2),”mean”),<br/> list(“sec.energy”,seq(1961,1969,2),”mean”),<br/> list(“sec.industry”, seq(1961,1969,2),”mean”),<br/> list(“sec.construction”, seq(1961,1969,2),”mean”),<br/> list(“sec.services.venta”, seq(1961,1969,2),”mean”),<br/> list(“sec.services.nonventa”,seq(1961,1969,2),”mean”),<br/> list(“popdens”, 1969, “mean”)),<br/> dependent = “gdpcap”, <strong class="pr jd"># dv</strong><br/> unit.variable = “regionno”,<strong class="pr jd">#identifying unit numbers</strong><br/> unit.names.variable = “regionname”,<strong class="pr jd">#identifying unit names</strong><br/> time.variable = “year”,<strong class="pr jd">#time-periods</strong><br/> treatment.identifier = 17,<strong class="pr jd">#the treated case</strong><br/> controls.identifier = c(2:16, 18),<strong class="pr jd">#the control cases; all others #except number 17</strong><br/> time.optimize.ssr = 1960:1969,<strong class="pr jd">#the time-period over which to optimize</strong><br/> time.plot = 1955:1997)<strong class="pr jd">#the entire time period before/after the treatment</strong></span></pre><p id="ed22" class="pw-post-body-paragraph ma mb it mc b md na kd mf mg nb kg mi mj nd ml mm mn nf mp mq mr nh mt mu mv im bi translated"><strong class="mc jd"> dataprep.out </strong>获得四个值(X1，X0，Z1，Z0 ),允许我们进行因果推断。</p><p id="37fb" class="pw-post-body-paragraph ma mb it mc b md na kd mf mg nb kg mi mj nd ml mm mn nf mp mq mr nh mt mu mv im bi translated"><strong class="mc jd"> X1 </strong>:治疗前的对照病例</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi qb"><img src="../Images/ed27e6f0c454b3cca07a240174c311a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xwazPhL_9lAhY6VrarD7aQ.png"/></div></div></figure><p id="69c3" class="pw-post-body-paragraph ma mb it mc b md na kd mf mg nb kg mi mj nd ml mm mn nf mp mq mr nh mt mu mv im bi translated"><strong class="mc jd"> X0 </strong>:治疗后对照病例</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi qc"><img src="../Images/1f5ef153e880a717636849c25f3ae781.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0jdLKPyD0vTpSJTnQAaQUg.png"/></div></div></figure><p id="c59a" class="pw-post-body-paragraph ma mb it mc b md na kd mf mg nb kg mi mj nd ml mm mn nf mp mq mr nh mt mu mv im bi translated"><strong class="mc jd"> Z1 </strong>:治疗前的治疗案例</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi qd"><img src="../Images/228868fb9668e56a2b623188ccb3a65e.png" data-original-src="https://miro.medium.com/v2/resize:fit:552/format:webp/1*XahXZQz5PaA83uv1uJ5pnw.png"/></div></figure><p id="64d5" class="pw-post-body-paragraph ma mb it mc b md na kd mf mg nb kg mi mj nd ml mm mn nf mp mq mr nh mt mu mv im bi translated"><strong class="mc jd"> Z0 </strong>:治疗后的治疗案例</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi qe"><img src="../Images/e78fcbc691954361541f0aa023a5ed7d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8iEozdVHNLJNfLiuu12F4A.png"/></div></div></figure><p id="0088" class="pw-post-body-paragraph ma mb it mc b md na kd mf mg nb kg mi mj nd ml mm mn nf mp mq mr nh mt mu mv im bi translated"><strong class="mc jd">第二步:运行 synth() </strong></p><pre class="ks kt ku kv gt pq pr ps pt aw pu bi"><span id="cd62" class="oj lj it pr b gy pv pw l px py">synth.out = synth(data.prep.obj = dataprep.out, method = “BFGS”)</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi qf"><img src="../Images/330e7ce246e99c2256eae86e48256314.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*npSBPvBeAzE4s4vOUADzjQ.png"/></div></div></figure><p id="c43d" class="pw-post-body-paragraph ma mb it mc b md na kd mf mg nb kg mi mj nd ml mm mn nf mp mq mr nh mt mu mv im bi translated">要计算真实基本区域和合成控制之间的差异，如下所示:</p><pre class="ks kt ku kv gt pq pr ps pt aw pu bi"><span id="f9c0" class="oj lj it pr b gy pv pw l px py">gaps = dataprep.out$Y1plot — (dataprep.out$Y0plot <br/>                                     %*% synth.out$solution.w)<br/>gaps[1:3,1]</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi qg"><img src="../Images/d9b68065411c8024c79ec573326fc250.png" data-original-src="https://miro.medium.com/v2/resize:fit:1080/format:webp/1*k2QezNoeHqwDprtkXyH41g.png"/></div></figure><p id="af2f" class="pw-post-body-paragraph ma mb it mc b md na kd mf mg nb kg mi mj nd ml mm mn nf mp mq mr nh mt mu mv im bi translated">为了提供一些汇总表，</p><pre class="ks kt ku kv gt pq pr ps pt aw pu bi"><span id="fd45" class="oj lj it pr b gy pv pw l px py">synth.tables = synth.tab(dataprep.res = dataprep.out,<br/>                         synth.res = synth.out)<br/>names(synth.tables)<br/>[1] "tab.pred" "tab.v"    "tab.w"    "tab.loss"</span></pre><p id="48f5" class="pw-post-body-paragraph ma mb it mc b md na kd mf mg nb kg mi mj nd ml mm mn nf mp mq mr nh mt mu mv im bi translated">注:<strong class="mc jd"> synth.tables$tab.pred </strong>是<strong class="mc jd"> </strong>一个比较处理单元、合成对照和样本中所有单元的预处理预测值的表格</p><pre class="ks kt ku kv gt pq pr ps pt aw pu bi"><span id="b744" class="oj lj it pr b gy pv pw l px py">synth.tables$tab.pred[1:13,]</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi qh"><img src="../Images/1b26dd104638a02cf8e935f411f22309.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KzKJjjLAjA94x_Ulkx5OfA.png"/></div></div></figure><p id="2891" class="pw-post-body-paragraph ma mb it mc b md na kd mf mg nb kg mi mj nd ml mm mn nf mp mq mr nh mt mu mv im bi translated">老实说，我无法生成与原始论文相同的结果。原始代码(synth.tables$tab.pred[1:5，])查看了处理案例和合成案例之间的前 5 个协变量，发现它们非常相似。因此，我将代码扩展到包括 13 个协变量，并发现除了少数几个之外，其余变量都非常相似。</p><p id="42ac" class="pw-post-body-paragraph ma mb it mc b md na kd mf mg nb kg mi mj nd ml mm mn nf mp mq mr nh mt mu mv im bi translated">如上所述，SCM 允许我们检查每个单元的相对重要性。</p><pre class="ks kt ku kv gt pq pr ps pt aw pu bi"><span id="df3b" class="oj lj it pr b gy pv pw l px py">synth.tables$tab.w[8:14, ]</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi qi"><img src="../Images/c58b8e5c82040a1d70b333939b030d3f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5-4GkjKUabGKCoEeNVyO-g.png"/></div></div></figure><p id="2d0a" class="pw-post-body-paragraph ma mb it mc b md na kd mf mg nb kg mi mj nd ml mm mn nf mp mq mr nh mt mu mv im bi translated">如图所示，第 10 号单位 Cataluna 对该案件的贡献为 85.1%，第 14 号单位 Madrid (Comunidad De)对其余的 14.9%做出了贡献。所有其他对照案例都没有贡献。</p><pre class="ks kt ku kv gt pq pr ps pt aw pu bi"><span id="deb5" class="oj lj it pr b gy pv pw l px py"># plot the changes before and after the treatment <br/>path.plot(synth.res=synth.out,dataprep.res = dataprep.out, <br/>          Ylab="real per-capita gdp (1986 USD, thousand)",Xlab="year",<br/>          Ylim = c(0,12),Legend = c("Basque country", <br/>                                    "synthetic Basque country"),<br/>          Legend.position = "bottomright")</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi qj"><img src="../Images/872cf3415407023318cb1f386424d855.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-_jWoB98yYz_HQg6atanUQ.png"/></div></div></figure><pre class="ks kt ku kv gt pq pr ps pt aw pu bi"><span id="b585" class="oj lj it pr b gy pv pw l px py">gaps.plot(synth.res = synth.out, dataprep.res = dataprep.out,<br/> Ylab = “gap in real per-capita GDP (1986 USD, thousand)”, Xlab= “year”,<br/> Ylim = c(-1.5,1.5), Main = NA)</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi qk"><img src="../Images/c5b843c650482d6d9d2543ae325f0b84.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8Rza-UZf3F_9tAIryta-Fw.png"/></div></div></figure><h1 id="ac3c" class="li lj it bd lk ll lm ln lo lp lq lr ls ki lt kj lu kl lv km lw ko lx kp ly lz bi translated">参考和更多资源</h1><ul class=""><li id="fa41" class="nu nv it mc b md me mg mh mj ou mn ov mr ow mv ox oa ob oc bi translated">Synth:在比较案例研究中综合控制方法的 R 包</li><li id="83ea" class="nu nv it mc b md od mg oe mj of mn og mr oh mv ox oa ob oc bi translated"><a class="ae lh" href="https://cran.r-project.org/web/packages/Synth/Synth.pdf" rel="noopener ugc nofollow" target="_blank">包‘合成’</a></li><li id="1b42" class="nu nv it mc b md od mg oe mj of mn og mr oh mv ox oa ob oc bi translated"><a class="ae lh" href="https://cran.r-project.org/web/packages/microsynth/vignettes/introduction.html" rel="noopener ugc nofollow" target="_blank">微合成:一个教程</a></li><li id="c4ea" class="nu nv it mc b md od mg oe mj of mn og mr oh mv ox oa ob oc bi translated">阿巴迪等人，2003 年。冲突的经济成本</li><li id="5890" class="nu nv it mc b md od mg oe mj of mn og mr oh mv ox oa ob oc bi translated"><a class="ae lh" href="https://amstat.tandfonline.com/doi/abs/10.1198/jasa.2009.ap08746" rel="noopener ugc nofollow" target="_blank">阿巴迪等人，2010 年。对比案例研究的综合控制方法</a></li><li id="49ee" class="nu nv it mc b md od mg oe mj of mn og mr oh mv ox oa ob oc bi translated"><a class="ae lh" href="https://onlinelibrary.wiley.com/doi/abs/10.1111/ajps.12116" rel="noopener ugc nofollow" target="_blank">阿巴迪等人 2015 年。比较政治学与综合控制方法</a></li></ul></div><div class="ab cl ni nj hx nk" role="separator"><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn"/></div><div class="im in io ip iq"><p id="ab56" class="pw-post-body-paragraph ma mb it mc b md na kd mf mg nb kg mi mj nd ml mm mn nf mp mq mr nh mt mu mv im bi translated"><em class="mz"> Medium 最近进化出了自己的</em> <a class="ae lh" href="https://blog.medium.com/evolving-the-partner-program-2613708f9f3c" rel="noopener"> <em class="mz">作家合伙人计划</em> </a> <em class="mz">，支持像我这样的普通作家。如果你还不是订户，通过下面的链接注册，我会收到一部分会员费。</em></p><div class="oy oz gp gr pa pb"><a href="https://leihua-ye.medium.com/membership" rel="noopener follow" target="_blank"><div class="pc ab fo"><div class="pd ab pe cl cj pf"><h2 class="bd jd gy z fp pg fr fs ph fu fw jc bi translated">阅读叶雷华博士研究员(以及其他成千上万的媒体作家)的每一个故事</h2><div class="pi l"><h3 class="bd b gy z fp pg fr fs ph fu fw dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="pj l"><p class="bd b dl z fp pg fr fs ph fu fw dk translated">leihua-ye.medium.com</p></div></div><div class="pk l"><div class="ql l pm pn po pk pp lb pb"/></div></div></a></div></div><div class="ab cl ni nj hx nk" role="separator"><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn"/></div><div class="im in io ip iq"><h1 id="961c" class="li lj it bd lk ll np ln lo lp nq lr ls ki nr kj lu kl ns km lw ko nt kp ly lz bi translated">延伸阅读:</h1><div class="oy oz gp gr pa pb"><a rel="noopener follow" target="_blank" href="/classifying-rare-events-using-five-machine-learning-techniques-fab464573233"><div class="pc ab fo"><div class="pd ab pe cl cj pf"><h2 class="bd jd gy z fp pg fr fs ph fu fw jc bi translated">一个巨大的挑战:如何使用 5 种机器学习方法预测罕见事件</h2><div class="pi l"><h3 class="bd b gy z fp pg fr fs ph fu fw dk translated">当结果变量高度不平衡时，哪种 ML 方法效果最好？有哪些权衡？</h3></div><div class="pj l"><p class="bd b dl z fp pg fr fs ph fu fw dk translated">towardsdatascience.com</p></div></div><div class="pk l"><div class="pl l pm pn po pk pp lb pb"/></div></div></a></div><div class="oy oz gp gr pa pb"><a rel="noopener follow" target="_blank" href="/beginners-guide-to-k-nearest-neighbors-in-r-from-zero-to-hero-d92cd4074bdb"><div class="pc ab fo"><div class="pd ab pe cl cj pf"><h2 class="bd jd gy z fp pg fr fs ph fu fw jc bi translated">R 中 K-最近邻初学者指南:从零到英雄</h2><div class="pi l"><h3 class="bd b gy z fp pg fr fs ph fu fw dk translated">使用各种度量标准在 R 中构建 KNN 模型的管道</h3></div><div class="pj l"><p class="bd b dl z fp pg fr fs ph fu fw dk translated">towardsdatascience.com</p></div></div><div class="pk l"><div class="qm l pm pn po pk pp lb pb"/></div></div></a></div><div class="oy oz gp gr pa pb"><a rel="noopener follow" target="_blank" href="/how-to-build-a-spam-classifier-using-decision-tree-b75d0c7f25e"><div class="pc ab fo"><div class="pd ab pe cl cj pf"><h2 class="bd jd gy z fp pg fr fs ph fu fw jc bi translated">如何使用决策树构建垃圾邮件分类器</h2><div class="pi l"><h3 class="bd b gy z fp pg fr fs ph fu fw dk translated">简单的方法是更好的方法！</h3></div><div class="pj l"><p class="bd b dl z fp pg fr fs ph fu fw dk translated">towardsdatascience.com</p></div></div><div class="pk l"><div class="qn l pm pn po pk pp lb pb"/></div></div></a></div></div><div class="ab cl ni nj hx nk" role="separator"><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn"/></div><div class="im in io ip iq"><h1 id="e583" class="li lj it bd lk ll np ln lo lp nq lr ls ki nr kj lu kl ns km lw ko nt kp ly lz bi translated">喜欢读这本书吗？</h1><blockquote class="mw mx my"><p id="99b8" class="ma mb mz mc b md na kd mf mg nb kg mi nc nd ml mm ne nf mp mq ng nh mt mu mv im bi translated">请在<a class="ae lh" href="https://www.linkedin.com/in/leihuaye/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>和<a class="ae lh" href="https://www.youtube.com/channel/UCBBu2nqs6iZPyNSgMjXUGPg" rel="noopener ugc nofollow" target="_blank"> Youtube </a>上找到我。</p><p id="6b25" class="ma mb mz mc b md na kd mf mg nb kg mi nc nd ml mm ne nf mp mq ng nh mt mu mv im bi translated">还有，看看我其他关于人工智能和机器学习的帖子。</p></blockquote></div></div>    
</body>
</html>