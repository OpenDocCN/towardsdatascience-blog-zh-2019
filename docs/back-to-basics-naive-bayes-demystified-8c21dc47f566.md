# å›å½’åŸºç¡€:æœ´ç´ è´å¶æ–¯å»ç¥ç§˜åŒ–

> åŸæ–‡ï¼š<https://towardsdatascience.com/back-to-basics-naive-bayes-demystified-8c21dc47f566?source=collection_archive---------21----------------------->

## æˆ‘ä»¬çš„ç›®æ ‡æ˜¯å­¦ä¹ æœ´ç´ è´å¶æ–¯ï¼Œå¹¶å°†å…¶åº”ç”¨äºç°å®ä¸–ç•Œçš„é—®é¢˜ï¼Œåƒåœ¾é‚®ä»¶æ£€æµ‹ã€‚ä¸ºä»€ä¹ˆæ˜¯æœ´ç´ è´å¶æ–¯ï¼Ÿåœ¨è¿™é‡Œæ‰¾åˆ°ç­”æ¡ˆï¼

![](img/f1006a0f5bc3533a1917ea93fd23acda.png)

Photo by [Webaroo.com.au](https://unsplash.com/@webaroo?utm_source=medium&utm_medium=referral) on [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral)

æˆ‘ä»¬çš„ç›®æ ‡æ˜¯å­¦ä¹ æœ´ç´ è´å¶æ–¯ï¼Œå¹¶å°†å…¶åº”ç”¨äºç°å®ä¸–ç•Œçš„é—®é¢˜ï¼Œåƒåœ¾é‚®ä»¶æ£€æµ‹ã€‚ä¸ºä»€ä¹ˆæ˜¯æœ´ç´ è´å¶æ–¯ï¼Ÿè€ƒè™‘ä½¿ç”¨æœºå™¨å­¦ä¹ å»ºç«‹ä¸€ä¸ªåƒåœ¾é‚®ä»¶è¿‡æ»¤å™¨ã€‚æ‚¨å¸Œæœ›æ ¹æ®é‚®ä»¶æ˜¯æœªç»è¯·æ±‚çš„å•†ä¸šé‚®ä»¶(*åƒåœ¾é‚®ä»¶*)è¿˜æ˜¯éåƒåœ¾é‚®ä»¶(*ç«è…¿*)å¯¹é‚®ä»¶è¿›è¡Œåˆ†ç±»ã€‚**åˆ†ç±»*åƒåœ¾é‚®ä»¶* vs. *ç«è…¿*æ˜¯ä¸€ç»„æ›´å¹¿æ³›çš„é—®é¢˜çš„ä¸€ä¸ªä¾‹å­ï¼Œç§°ä¸ºæ–‡æœ¬åˆ†ç±»ï¼Œä¸€ç»„é—®é¢˜ï¼Œæœ´ç´ è´å¶æ–¯å¯ä»¥ä»¥ç›¸å¯¹è¾ƒé«˜çš„æ€§èƒ½è§£å†³ã€‚**æœ´ç´ è´å¶æ–¯åˆ†ç±»å™¨æ˜¯ä¸€ç§åŸºäºæ¡ä»¶æ¦‚ç‡å»ºæ¨¡çš„å¼ºå¤§åˆ†ç±»ç®—æ³•ã€‚å®ƒå¯¹äºå…·æœ‰å¤šå¯¹å¤šç‰¹å¾çš„åˆ†ç±»é—®é¢˜ç‰¹åˆ«æœ‰ç”¨ï¼Œè€Œä¸”æˆ‘ä»¬å¾ˆå¿«å°±ä¼šå‘ç°ï¼Œå¯ä»¥å¿½ç•¥çš„æ¡ä»¶ä¾èµ–ã€‚**åå­—â€œå¤©çœŸâ€æš—ç¤ºæˆ‘ä»¬åœ¨è¿™é‡Œåšäº†ä¸€ä¸ªé”™è¯¯çš„å‡è®¾ï¼›äº‹å®ä¸Šï¼Œæˆ‘ä»¬æ˜¯ï¼ä½†äº‹å®è¯æ˜ï¼Œæˆ‘ä»¬å¤©çœŸçš„å‡è®¾åœ¨å®è·µä¸­éå¸¸æœ‰æ•ˆã€‚**

# æœ´ç´ è´å¶æ–¯

è®©æˆ‘ä»¬å‡è®¾æˆ‘ä»¬å¯¹åˆ†ç±»å¤§é‡ç”µå­é‚®ä»¶æ„Ÿå…´è¶£ï¼Œå¹¶æ£€æµ‹*åƒåœ¾é‚®ä»¶*ä¸*åƒåœ¾é‚®ä»¶*ã€‚æˆ‘ä»¬ç”¨ *x* è¡¨ç¤ºæˆ‘ä»¬çš„è¾“å…¥å‘é‡ã€‚è¾“å…¥å‘é‡æ˜¯æ¯å°é‚®ä»¶ä¸­å•è¯çš„æœ‰åºé›†åˆï¼Œæ¯”å¦‚ *x = {Iï¼Œamï¼Œhappy}* ã€‚æˆ‘ä»¬è®­ç»ƒæ¨¡å‹çš„ç›®æ ‡æ˜¯å†³å®šè¿™ä¸ªå‘é‡å±äºå“ªä¸€ç±»ç»“æœã€‚æˆ‘ä»¬æŠŠæˆ‘ä»¬å¯èƒ½çš„ç»“æœé›†åˆè¡¨ç¤ºä¸º*C*ï¼›åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ *C={spamï¼Œham}* ã€‚

æˆ‘ä»¬å¯ä»¥è®¤ä¸ºåƒåœ¾é‚®ä»¶æ£€æµ‹æ˜¯ä¸€ä¸ªæ¦‚ç‡é—®é¢˜ï¼Œæˆ‘ä»¬æƒ³çŸ¥é“æˆ‘ä»¬çš„ç”µå­é‚®ä»¶æ˜¯åƒåœ¾é‚®ä»¶è¿˜æ˜¯åƒåœ¾é‚®ä»¶çš„å‡ ç‡ï¼Œå¹¶è‡ªç„¶åœ°é€‰æ‹©å‡ ç‡æ›´é«˜çš„é‚®ä»¶ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šå‘ç°*åƒåœ¾é‚®ä»¶*çš„å‡ ç‡ä¸º 40%ï¼Œå› æ­¤*åƒåœ¾é‚®ä»¶*çš„å‡ ç‡ä¸º 60%(60% = 100%â€”40%)ï¼›ç„¶åï¼Œæˆ‘ä»¬æœŸæœ›æˆ‘ä»¬çš„æ¨¡å‹å°†ç»™å®šçš„ç”µå­é‚®ä»¶æ£€æµ‹ä¸º *ham* ã€‚æ•°å­¦ä¸Šæˆ‘ä»¬ç”¨ *P(spam|x)= 0.4* å’Œ *P(ham|x)= 0.6* æˆ–è€…å¦‚æœæˆ‘ä»¬çœŸçš„æƒ³ä¹±ä¸€ç‚¹çš„è¯ï¼Œ *P(spam| Iï¼Œamï¼Œhappy)= 0.4* å’Œ *P(ham| Iï¼Œamï¼Œhappy)= 0.6* ã€‚æœ¯è¯­ *P(spam|x)* è¯»ä½œç”µå­é‚®ä»¶æ˜¯*åƒåœ¾é‚®ä»¶* ( *åƒåœ¾é‚®ä»¶*å‘ç”Ÿ)çš„æ¦‚ç‡ï¼Œå‡è®¾ç”µå­é‚®ä»¶æ˜¯ *x* ( *x* å‘ç”Ÿ)ã€‚

åˆ°ç›®å‰ä¸ºæ­¢ï¼Œä¸€åˆ‡é¡ºåˆ©ï¼ä½†è¿™é‡Œæœ‰ä¸€ä¸ªé—®é¢˜ã€‚**æ€ä¹ˆæ‰èƒ½æ‰¾åˆ°è¿™äº›æ¦‚ç‡å‘¢ï¼Ÿ**æˆ‘ä»¬éœ€è¦æ‰¾åˆ°æ‰€æœ‰å†…å®¹ä¸º *x* çš„ç”µå­é‚®ä»¶ï¼Œå¹¶ç»Ÿè®¡å®ƒä»¬è¢«*åƒåœ¾é‚®ä»¶*vs*ç«è…¿*çš„æ¬¡æ•°ã€‚æ¯”æ–¹è¯´ï¼Œæˆ‘ä»¬æ”¶åˆ° 100 å°å†…å®¹ä¸º *x* çš„ç”µå­é‚®ä»¶ï¼Œå…¶ä¸­ 60 å°ä¸æ˜¯*åƒåœ¾é‚®ä»¶*ï¼Œ40 å°æ˜¯ï¼Œé‚£ä¹ˆ:

![](img/169b1e783c6b3cb8315e2b5ed2412a2d.png)![](img/542978a9ce9165244d55d2d3ab661f5b.png)

ä¸è¿‡è¿™é‡Œæœ‰ä¸€ä¸ªå°é—®é¢˜ï¼ä¸ºäº†æ£€æµ‹ä¸€å°ç”µå­é‚®ä»¶å¹¶å†³å®šå®ƒæ˜¯å¦æ˜¯åƒåœ¾é‚®ä»¶ï¼Œæˆ‘ä»¬éœ€è¦æ¥æ”¶è®¸å¤šå®Œå…¨ç›¸åŒçš„ç”µå­é‚®ä»¶ï¼Œå¹¶åœ¨èƒ½å¤Ÿå¯¹å®ƒä»¬è¿›è¡Œåˆ†ç±»ä¹‹å‰å°†å®ƒä»¬è®°å½•åœ¨æˆ‘ä»¬çš„è®°å½•ä¸­ã€‚**ä¸å®ç”¨ï¼**å¹¸è¿çš„æ˜¯ï¼Œæ¡ä»¶æ¦‚ç‡çš„è´å¶æ–¯å®šç†å¯ä»¥å¸®åŠ©æˆ‘ä»¬ã€‚è¯·æ³¨æ„**è´å¶æ–¯å®šç†ä¸åŒäºæœ´ç´ è´å¶æ–¯å‡è®¾ï¼**è´å¶æ–¯å®šç†å¯ä»¥å†™æˆ:

![](img/9bc3d2e860b578adb9d6a927838f03aa.png)

è´å¶æ–¯å®šç†æ˜¯æ¦‚ç‡è®ºä¸­çš„ä¸€ä¸ªåŸºæœ¬å®šç†ã€‚å¥½å§ï¼Œå°±ç”¨å®ƒå§ï¼

![](img/3503bab681d7bc24d1103eb5f79b1b43.png)![](img/50d7c98751c40d386692ea47cc3929e9.png)

å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œæˆ‘ä»¬çœŸçš„æƒ³çŸ¥é“`**ğ‘ƒ(spam|x)/ ğ‘ƒ(ham|x)>1**`æ˜¯å¦å­˜åœ¨ï¼›æˆ‘ä»¬å¹¶ä¸åœ¨ä¹å®ƒä»¬çš„ç»å¯¹å€¼ã€‚æ‰€ä»¥æˆ‘ä»¬çœŸçš„æƒ³ä¼°è®¡ä¸€ä¸‹:

![](img/78a05ccd8220c14ae08452ab4ab8d71f.png)

å¥½æ¶ˆæ¯æ˜¯ï¼Œä¸ç›´æ¥ä¼°ç®—*ğ‘ƒ(spam|xã€‘*å’Œ *ğ‘ƒ(ham|x)* ç›¸æ¯”ï¼Œæˆ‘ä»¬èƒ½æ›´å¥½åœ°ä¼°ç®—*ğ‘ƒ(spam|xã€‘**ğ‘ƒ(x|hamã€‘**ğ‘ƒ(hamã€‘*ã€‚æ®æ¨æµ‹ï¼Œæˆ‘ä»¬æœ‰å¾ˆå¤šå¾ˆå¤šçš„ç”µå­é‚®ä»¶è¦ä¹ˆæ˜¯åƒåœ¾é‚®ä»¶ï¼Œè¦ä¹ˆæ˜¯åƒåœ¾é‚®ä»¶ï¼Œå…¶ä¸­ä¸€äº›é‚®ä»¶çš„å†…å®¹å¯èƒ½æ˜¯åƒåœ¾é‚®ä»¶ã€‚è¿™æœ‰åŠ©äºæˆ‘ä»¬å¤„ç†ä¸å¤ªé¢‘ç¹ä½†å­˜åœ¨äºæˆ‘ä»¬æ•°æ®åº“ä¸­çš„ç”µå­é‚®ä»¶ã€‚**ä½†æ˜¯ï¼Œæˆ‘ä»¬å¯èƒ½æ‰¾ä¸åˆ°ä»¥ *x* ä¸ºå†…å®¹çš„ç”µå­é‚®ä»¶ï¼æˆ‘ä»¬è¯¥æ€ä¹ˆåŠï¼Ÿè¿™å°±æ˜¯æœ´ç´ è´å¶æ–¯å¸®åŠ©æˆ‘ä»¬çš„åœ°æ–¹ï¼è¿˜æœ‰ä¸€ä¸ªæ¦‚ç‡å®šç†æ˜¯åŸºæœ¬å®šç†ã€‚**

![](img/1a8920b3c52b2f06b6389dd432f6035b.png)![](img/a2166e6fd3d61069999f34aa32bdd6d4.png)

Photo by [JESHOOTS.COM](https://unsplash.com/@jeshoots?utm_source=medium&utm_medium=referral) on [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral)

è®©æˆ‘ä»¬å°†è¿™ä¸ªå®šç†åº”ç”¨åˆ°æˆ‘ä»¬çš„ç”µå­é‚®ä»¶ç¤ºä¾‹ä¸­ã€‚

![](img/db0ef3176a6bed40a5cbd3ae051c07c6.png)

æ›´å¥½çœ‹ï¼å¥½ï¼Œè®©æˆ‘ä»¬å†æ¬¡åº”ç”¨åŒæ ·çš„å®šç†ã€‚

![](img/00783e131bb5dc02f28632c1cf3c8f64.png)

ç°åœ¨æ˜¯**æœ´ç´ è´å¶æ–¯å‡è®¾**å¤§æ”¾å¼‚å½©çš„æ—¶å€™äº†ï¼**æœ´ç´ è´å¶æ–¯å‡è®¾ *x* çš„å…ƒç´ æ˜¯æ¡ä»¶ç‹¬ç«‹çš„ï¼Œç»™å®š *C* ã€‚**æ¢å¥è¯è¯´ï¼Œåœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å°†å‡è®¾:

![](img/17a0b2e486a8173419f51096d894ad70.png)![](img/464cb102d9c9142d4612d8875c992951.png)

**è¿™ä¸ªå‡è®¾ä¸ä»…å¬èµ·æ¥ä¸å¯¹ï¼Œç®€ç›´è’è°¬ï¼å¦‚æœé‚®ä»¶ä¸­æœ‰â€œam â€,æˆ‘ä»¬è‡ªç„¶ä¼šæœŸæœ›æœ‰æ›´é«˜çš„å‡ ç‡å‡ºç°â€œIâ€ã€‚ç„¶è€Œï¼Œå®ƒå·¥ä½œå¾—ç›¸å½“å¥½ï¼ä¸ºä»€ä¹ˆï¼Ÿè¿™éœ€è¦å¯¹æ­£åœ¨å‘ç”Ÿçš„äº‹æƒ…æœ‰æ›´æ·±å…¥çš„äº†è§£ï¼Œä½†æœ¬è´¨ä¸Šæ¯ä¸ªå•è¯çš„ä¸ªä½“æ¦‚ç‡å¯¹äºå¤§å¤šæ•°å¸¸è§çš„åˆ†ç±»ç±»å‹æ¥è¯´å·²ç»è¶³å¤Ÿäº†ã€‚å¥½äº†ï¼Œè®©æˆ‘ä»¬æŠŠæ‰€æœ‰çš„ä¸œè¥¿æ”¾åœ¨ä¸€ä¸ªç­‰å¼é‡Œ:**

![](img/2db21b71077aca61b954b8f6a97ccfb9.png)

å‰©ä¸‹çš„å°±å¥½åŠäº†ï¼æˆ‘ä»¬åªéœ€è¦æŸ¥æ‰¾åŒ…å«å„ç§å•è¯çš„ç”µå­é‚®ä»¶ï¼Œè€Œä¸æ˜¯æ‰€æœ‰å•è¯éƒ½æ”¾åœ¨ä¸€èµ·ã€‚é‚£æ˜¯ä¸€ç§æ›´å®é™…çš„é”»ç‚¼æ–¹å¼ï¼å‡è®¾æˆ‘ä»¬æœ‰*1000 ä¸‡*å°*åƒåœ¾é‚®ä»¶*å’Œ *1000 å°*é‚®ä»¶ä¸­æœ‰â€œå¿«ä¹â€å­—æ ·ã€‚å¦å¤–ï¼Œå‡è®¾æˆ‘ä»¬æœ‰ *1 äº¿*é*åƒåœ¾é‚®ä»¶*ï¼Œå…¶ä¸­ 100 ä¸‡åŒ…å«â€œhappy â€,é‚£ä¹ˆ:

![](img/cbe6c0e6b8dbcbb216322c2d0565c898.png)![](img/da4220a1e33b4a4b5ea99374d505cb9c.png)![](img/4dc758e2db75acd1988c7d5864e003c5.png)![](img/dbb3f3ff7408221871ed6d16f1991e2d.png)![](img/6e4b085b6c0bb04b7b05ef655244cca0.png)

Photo by [Hitesh Choudhary](https://unsplash.com/@hiteshchoudhary?utm_source=medium&utm_medium=referral) on [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral)

# ä½¿ç”¨ Python è¿›è¡Œåƒåœ¾é‚®ä»¶æ£€æµ‹

æˆ‘å¾ˆç¡®å®šæ²¡æœ‰äººæƒ³è‡ªå·±åšä¸Šé¢æ‰€æœ‰çš„è®¡ç®—ï¼›æ‰€ä»¥è®©æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ª Python åº“ï¼æˆ‘ä»¬å°†ä½¿ç”¨ä¸€å † Python åº“å°†ç”µå­é‚®ä»¶åˆ†ç±»ä¸º*åƒåœ¾é‚®ä»¶*å’Œ*ç«è…¿*ã€‚è®¡ç®—æœºåœ¨ç†è§£æ–‡æœ¬æ–¹é¢å¹¶ä¸æ“…é•¿ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦åšçš„ç¬¬ä¸€ä»¶äº‹æ˜¯ç”¨å¦ä¸€ç§å½¢å¼è¡¨ç¤ºæ¯å°é‚®ä»¶çš„å†…å®¹ã€‚è¡¨ç¤ºè¦åœ¨æœºå™¨å­¦ä¹ ä¸Šä¸‹æ–‡ä¸­ä½¿ç”¨çš„æ–‡æœ¬çš„ä¸€ç§æ–¹å¼æ˜¯ä½¿ç”¨å•è¯è¢‹è¡¨ç¤ºæ³•(BOW)ã€‚åœ¨æ”¶é›†äº†æ‰€æœ‰å¯èƒ½çš„å•è¯å¹¶å°†å®ƒä»¬æ”¾å…¥å­—å…¸åï¼Œæˆ‘ä»¬ä¸ºå­—å…¸ä¸­çš„æ¯ä¸ªå•è¯åˆ†é…ä¸€ä¸ªå‘é‡ã€‚æ¯ä¸ªå‘é‡çš„é•¿åº¦ç­‰äºå­—å…¸ä¸­çš„å•è¯æ•°ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæˆ‘ä»¬çš„å­—å…¸ä¸­åªæœ‰å››ä¸ªå•è¯ *{helloï¼ŒIï¼Œamï¼Œhappy}* ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ä¸ºå®ƒä»¬åˆ†é…ä»¥ä¸‹å‘é‡:

![](img/90196f237a22139c12249bfe9cf0ac93.png)

åœ¨ BOW è¡¨ç¤ºä¸­ï¼Œæ–‡æ¡£è¢«ç®€å•åœ°è¡¨ç¤ºä¸ºå­—æ•°çš„å‘é‡ï¼›**å¿½ç•¥å•è¯é¡ºåº**ã€‚ä¸€ä¸ªç®€å•çš„è¡¨ç¤ºâ€œæˆ‘å¾ˆå¼€å¿ƒå¾ˆå¼€å¿ƒâ€çš„é èº¬æ˜¯:

![](img/0d4bcade712b8c55c3daae75e2c26f12.png)

åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨è¿™é‡Œå¯ç”¨çš„æ•°æ®(æ„Ÿè°¢ Kaggle)ã€‚ä»æŠ€æœ¯ä¸Šè®²ï¼Œè¿™ä¸æ˜¯ä¸€ä¸ªç”µå­é‚®ä»¶æ•°æ®é›†ï¼Œä½†å®ƒæ˜¯ç¡®å®šçš„ã€‚æœ´ç´ è´å¶æ–¯ä¹Ÿåœ¨è¿™é‡Œå·¥ä½œï¼æ•°æ®é›†åœ¨è¢«æ‚¨â€”â€”é¥¥é¥¿çš„æ•°æ®ç§‘å­¦å®¶â€”â€”ä½¿ç”¨ä¹‹å‰åªéœ€è¦å°‘é‡çš„æ¸…ç†å·¥ä½œï¼ä¸‹è½½ CSV æ–‡ä»¶åï¼Œæˆ‘ä»¬ä½¿ç”¨æˆ‘ä»¬çš„æœ‹å‹ï¼Œ' ***ç†ŠçŒ«*** 'ï¼Œæ¥åŠ è½½æ•°æ®ã€‚

```
import pandas as pd
file_encoding = 'utf8'
input_fd = open('./spam.csv', encoding=file_encoding, errors = 'backslashreplace') #the file has some non utf8 parts
data = pd.read_csv(input_fd)
data = data.iloc[:,0:2]    #removing the null columns
data.columns = ['label','content']
data.head()
```

![](img/06c44381670184420e44bf1d3a075fd1.png)

æˆ‘ä»¬éœ€è¦å°†ç”µå­é‚®ä»¶æ”¾å…¥ BOW è¡¨ç¤ºä¸­ã€‚æ²¡é—®é¢˜ï¼æˆ‘ä»¬å°†ä½¿ç”¨æ¨¡å—'***text***' from '***sk learn***'æ¥å¤„ç†è¿™ä¸ªé—®é¢˜ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦å‘Šè¯‰ Python ä¸ºæˆ‘ä»¬åˆ¶ä½œæˆ‘ä»¬éœ€è¦çš„å­—å…¸ã€‚

```
from sklearn.feature_extraction import text 
word_bagger = text.CountVectorizer()
```

> æ³¨æ„:ä»»ä½•è¯­è¨€ä¸­éƒ½æœ‰ä¸€äº›å•è¯å¯¹æ–‡æœ¬åˆ†ç±»ç­‰æ²¡æœ‰é‚£ä¹ˆå¤§çš„ä»·å€¼ï¼›ä¸€ä¸ªåŸå› æ˜¯å®ƒä»¬åœ¨ä»»ä½•ä¸Šä¸‹æ–‡ä¸­éƒ½å¾ˆå¸¸è§ï¼Œä¾‹å¦‚ï¼Œâ€œtheâ€ã€â€œamâ€å’Œâ€œthisâ€æ— å¤„ä¸åœ¨ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„é€‰é¡¹æ¥æ‘†è„±å®ƒä»¬ã€‚

```
word_bagger = text.CountVectorizer(stop_words="english")
```

å¦‚æœä½ æœ‰å…´è¶£çœ‹çœ‹ä½ çš„å­—å…¸é‡Œæœ‰å¤šå°‘å•è¯ï¼Œç”šè‡³çœ‹ä¸€çœ‹å®ƒä»¬ï¼Œåšæˆ‘çš„çŒœæµ‹å§ï¼æ‚¨å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼è½»æ¾æŸ¥çœ‹:

```
words = word_bagger.get_feature_names()
len(all_words)
```

å¦‚ä½ æ‰€è§ï¼Œæˆ‘ä»¬çš„å­—å…¸é‡Œæœ‰ *8692* ã€‚å¦‚æœä½ å¯¹ word *1001* åˆ° *1010* æ„Ÿåˆ°ç–‘æƒ‘ï¼Œé‚£ä¹ˆä½ å¯ä»¥çœ‹çœ‹ï¼

```
words[2000:2010]
```

æˆ‘ä»¬å¾—åˆ°ä¸‹é¢çš„è¯:

![](img/c5d8c4a29b32ada4fb1c6a5cdc5130e8.png)

ç°åœ¨æˆ‘ä»¬æœ‰äº†å­—å…¸ï¼Œæˆ‘ä»¬å¯ä»¥å°†ä»»ä½•å¥å­è½¬æ¢æˆå‘é‡ã€‚åªè¦ç…§ç€è¿™ä¸ªåš:

```
X = word_bagger.transform(data['content'])
```

è®©æˆ‘ä»¬çœ‹çœ‹å®ƒé€šè¿‡è½¬æ¢'*æˆ‘å¾ˆå¼€å¿ƒå¾ˆå¼€å¿ƒã€T1]'åšäº†ä»€ä¹ˆï¼*

```
test = word_bagger.transform(['I am happy happy'])
```

å¦‚æœä½ æŸ¥çœ‹å˜é‡ *test* ï¼Œå®ƒè¢«å­˜å‚¨ä¸º*â€˜å‹ç¼©ç¨€ç–è¡Œ*â€™ã€‚è¿™æ˜¯å› ä¸º' ***sklearn*** 'éå¸¸æ³¨æ„æœ‰æ•ˆåœ°ä½¿ç”¨å†…å­˜ï¼Œå¹¶å¸Œæœ›æœ€å°åŒ–ä»»ä½•å†—ä½™å­˜å‚¨ã€‚å› æ­¤ï¼Œå®ƒåªè·Ÿè¸ªéé›¶å…ƒç´ ã€‚åªéœ€ä½¿ç”¨ *print* å‘½ä»¤æŸ¥çœ‹*æµ‹è¯•*çš„éé›¶å…ƒç´ ã€‚

```
print(test)
```

![](img/83df683ea1dcd4ef6681238a67576b42.png)

# è®­ç»ƒæ¨¡å‹:

ä¿¡ä¸ä¿¡ç”±ä½ ï¼Œæˆ‘ä»¬å·²ç»å®Œæˆäº†å¤§éƒ¨åˆ†å·¥ä½œï¼æˆ‘ä»¬ç°åœ¨å°†ä½¿ç”¨å¦ä¸€ä¸ª' ***sklearn*** 'æ¨¡å—æ¥è®­ç»ƒæˆ‘ä»¬çš„æœ´ç´ è´å¶æ–¯åˆ†ç±»å™¨ã€‚æ ¹æ®è¾“å…¥å˜é‡çš„ç‰¹å¾ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨ä¸åŒç‰ˆæœ¬çš„æœ´ç´ è´å¶æ–¯ã€‚å®ƒä»¬æ˜¯ä»€ä¹ˆï¼Ÿè®©æˆ‘ä»¬æ¥çœ‹çœ‹ã€‚

*   **é«˜æ–¯æœ´ç´ è´å¶æ–¯**:å¯¹äºç‰¹å¾æœä»é«˜æ–¯åˆ†å¸ƒçš„è¿ç»­æ•°æ®ã€‚
*   **å¤šé¡¹å¼æœ´ç´ è´å¶æ–¯**:é’ˆå¯¹ç‰¹å¾ä¸º*è®¡æ•°*(å³éè´Ÿæ•´æ•°)çš„ç¦»æ•£æ•°æ®ã€‚
*   **ä¼¯åŠªåˆ©æœ´ç´ è´å¶æ–¯**:é’ˆå¯¹å…·æœ‰äºŒè¿›åˆ¶å€¼ç‰¹å¾çš„ç¦»æ•£æ•°æ®ã€‚

åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨**å¤šé¡¹å¼æœ´ç´ è´å¶æ–¯**ï¼›è®©æˆ‘ä»¬å¯¼å…¥å®ƒï¼Œç„¶ååœ¨æˆ‘ä»¬çš„æ•°æ®é›†**ä¸Šè®­ç»ƒæ¨¡å‹ã€‚**

```
from sklearn.naive_bayes import MultinomialNB
spam_nb = MultinomialNB()
spam_nb.fit(X, y)
```

![](img/80f59f7ae516520e6ad2ba671f9e00e2.png)

æˆ‘ä»¬å¯ä»¥ä½¿ç”¨' ***sklearn*** 'æä¾›çš„åŸç”Ÿè¯„åˆ†å‡½æ•°è½»æ¾æ£€æŸ¥æˆ‘ä»¬è®­ç»ƒå¥½çš„æ¨¡å‹çš„æ ·æœ¬å†…å‡†ç¡®ç‡ã€‚

```
spam_nb.score(X,y)
```

![](img/d52e6c6329919daa9335a4d96fd13d6b.png)

> æ³¨æ„:è¿™æ˜¯ä¸€æ¡é€šå¾€é«˜åˆ†çš„é“è·¯ï¼æˆ‘ä»¬åœ¨è¿™é‡Œç»å¯¹æ˜¯è¿‡åº¦é€‚åº”äº†ã€‚è¿™å¯ä»¥ä½¿ç”¨é€šå¸¸çš„äº¤å‰éªŒè¯æˆ–å…¶ä»–ç”¨äºé¿å…è¿‡åº¦æ‹Ÿåˆçš„æ–¹æ³•æ¥é¿å…ã€‚

æˆ‘ä»¬å®Œäº†ï¼åˆçŸ­åˆç”œï¼Œå¯¹å§ï¼Ÿæˆ‘ä»¬å¯ä»¥åœ¨ä¸€äº›æ ·æœ¬æ¡ˆä¾‹ä¸Šå°è¯•æˆ‘ä»¬çš„è®­ç»ƒæ¨¡å‹ï¼Œçœ‹çœ‹ç»“æœæ˜¯å¦ç¬¦åˆæˆ‘ä»¬çš„é¢„æœŸã€‚

```
ham = "Let me know if it works for you? I will keep you posted!"
spam = "Buy real cheap eyeglasses here, eyeglasses.club!"
test_bagged = word_bagger.transform([ham, spam])
spam_nb.predict(bagged)
```

![](img/3299dc37c0c28ea86fd829996785457c.png)

æˆ‘ä»¬ç¡®å®åšå¾—å¾ˆå¥½ï¼æ€»ä¹‹ï¼Œè¿™æ˜¯ä¸€ä¸ªåŸºæœ¬çš„æœºå™¨å­¦ä¹ ç®—æ³•ï¼Œå®ƒæ˜¯å¯é çš„ï¼Œå› ä¸ºå¾ˆå¤šå¾ˆå¤šçš„åŸå› ï¼Œæ¯”å¦‚æ˜“ç”¨æ€§å’Œå¿«é€Ÿè®¡ç®—æ—¶é—´ã€‚

å¿«ä¹é˜…è¯»&ä¿æŒå¥½å¥‡ï¼

*åŸè½½äº 2019 å¹´ 12 æœˆ 31 æ—¥*[*http://hamidomid.com*](http://hamidomid.com/naive-bayes-classifier-demystified)*ã€‚*