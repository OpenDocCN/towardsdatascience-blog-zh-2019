<html>
<head>
<title>Automate UI Testing with PyAutoGUI in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用 Python 中的 PyAutoGUI 实现自动化 UI 测试</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/automate-ui-testing-with-pyautogui-in-python-4a3762121973?source=collection_archive---------10-----------------------#2019-08-06">https://towardsdatascience.com/automate-ui-testing-with-pyautogui-in-python-4a3762121973?source=collection_archive---------10-----------------------#2019-08-06</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="b25a" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">回归测试你的用户界面的一个快速简单的方法</h2></div><p id="6dd3" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">当没有必要的安全措施来保证质量控制时，发布一个新版本的产品可能是一个令人紧张的经历。假设您的产品有一个用户界面(UI)，那么在每次发布之前进行 UI 测试是明智的。</p><p id="cd3a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">当然，您已经准备好了集成测试，并且您确信系统将端到端地工作，包括 UI。然而，根据您所在的行业以及您的应用程序的重要性，您可能需要确保并证明它是可行的。鉴于这是您每次发布应用程序时都想要重复的事情，您可能想要自动化这种类型的测试。</p><p id="4e1f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">一种快速简单的方法是利用一个名为 PyAutoGUI 的 Python 库，它将允许您执行自动化的 UI 测试。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi le"><img src="../Images/af7a54217db987ebb97bb251e597881d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*itLic_dIJTzRPH1_"/></div></div><figcaption class="lq lr gj gh gi ls lt bd b be z dk">Photo by <a class="ae lu" href="https://unsplash.com/@medbadrc?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Med Badr Chemmaoui</a> on <a class="ae lu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="5b54" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">简介 PyAutoGUI</h1><p id="1710" class="pw-post-body-paragraph ki kj it kk b kl mn ju kn ko mo jx kq kr mp kt ku kv mq kx ky kz mr lb lc ld im bi translated">PyAutoGUI 本质上是一个 Python 包，可以跨 Windows、MacOS X 和 Linux 工作，它提供了模拟鼠标光标移动和点击以及键盘按钮按压的能力。</p><p id="b07a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">你可以在他们的<a class="ae lu" href="https://pyautogui.readthedocs.io/en/latest/introduction.html" rel="noopener ugc nofollow" target="_blank">主页</a>上找到关于这个包的更多信息，包括下面显示的快速概览:</p><pre class="lf lg lh li gt ms mt mu mv aw mw bi"><span id="d7dc" class="mx lw it mt b gy my mz l na nb">import pyautogui<br/>screenWidth, screenHeight = pyautogui.size()<br/>currentMouseX, currentMouseY = pyautogui.position()<br/>pyautogui.moveTo(100, 150)<br/>pyautogui.click()<br/>pyautogui.moveRel(None, 10)  # move mouse 10 pixels down<br/>pyautogui.doubleClick()<br/>pyautogui.moveTo(500, 500, duration=2, tween=pyautogui.easeInOutQuad)  # use tweening/easing function to move mouse over 2 seconds.<br/>pyautogui.typewrite('Hello world!', interval=0.25)  # type with quarter-second pause in between each key<br/>pyautogui.press('esc')<br/>pyautogui.keyDown('shift')<br/>pyautogui.press(['left', 'left', 'left', 'left', 'left', 'left'])<br/>pyautogui.keyUp('shift')<br/>pyautogui.hotkey('ctrl', 'c')</span></pre><h1 id="4699" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">用法示例</h1><p id="23a4" class="pw-post-body-paragraph ki kj it kk b kl mn ju kn ko mo jx kq kr mp kt ku kv mq kx ky kz mr lb lc ld im bi translated">为了了解这在实践中是如何工作的，让我们快速构建一个示例 python 脚本。我们首先假设我们的应用程序 Firefox(作为一个例子)已经部署到一台测试 Windows 10 的机器上，我们希望自动测试 UI 的某些方面。</p><p id="1378" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">要做的第一件事，是导入包并捕捉我们屏幕的大小。我们也可以假设 Windows 任务栏总是在屏幕的底部，所以我们可以继续启动开始菜单按钮。</p><pre class="lf lg lh li gt ms mt mu mv aw mw bi"><span id="3996" class="mx lw it mt b gy my mz l na nb">import pyautogui as gui, time<br/>screenWidth, screenHeight = gui.size()<br/>gui.moveTo(0,screenHeight)<br/>gui.click()</span></pre><p id="9e9f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">一旦执行了上面的代码，我们就可以搜索 Firefox，然后启动它。</p><pre class="lf lg lh li gt ms mt mu mv aw mw bi"><span id="670d" class="mx lw it mt b gy my mz l na nb">gui.typewrite('Firefox', interval=0.25)<br/>gui.press('enter')</span></pre><p id="0b9c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我增加了每个字母的打字间隔，以适应较慢的机器。然后，我们需要确保窗口最大化到屏幕上。windows 的快捷键是 Alt + Space，然后是 x。</p><pre class="lf lg lh li gt ms mt mu mv aw mw bi"><span id="4ff5" class="mx lw it mt b gy my mz l na nb">time.sleep(2) #give 2 seconds for firefox to launch<br/>gui.keyDown('alt')<br/>gui.press(' ')<br/>gui.press('x')<br/>gui.keyUp('alt')</span></pre><p id="0f37" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">此时，我们可以开始添加我们希望工具测试的特性。例如，我们可能想测试打开一个新标签页并在网站中键入内容。为此，我们想知道屏幕上的某些位置。为了识别它们，我们可以在后台运行以下脚本，当我们将鼠标悬停在我们想要的位置上时，可以看到位置输出:</p><pre class="lf lg lh li gt ms mt mu mv aw mw bi"><span id="0a65" class="mx lw it mt b gy my mz l na nb">import pyautogui as gui, time<br/>def identifyloc():<br/>    while True:<br/>        currentMouseX, currentMouseY = gui.position()<br/>        print(currentMouseX,currentMouseY)<br/>        time.sleep(3)<br/>identifyloc()</span></pre><p id="70b2" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">使用这个，我发现“新标签”按钮在位置(250，22)，地址栏在(371，51)。因此，我可以使用下面的代码:</p><pre class="lf lg lh li gt ms mt mu mv aw mw bi"><span id="df25" class="mx lw it mt b gy my mz l na nb">gui.click(250,22)<br/>gui.click(371,51)<br/>gui.typewrite('https://medium.com/financeexplained')<br/>gui.press('enter')</span></pre><p id="6bf9" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后我们可以继续添加尽可能多的测试场景。当然，在执行完所有这些之后，仍然需要有人查看日志和 UI，以确保我们没有遇到任何错误。</p><p id="1c39" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">将所有这些放在一起:</p><pre class="lf lg lh li gt ms mt mu mv aw mw bi"><span id="f7d1" class="mx lw it mt b gy my mz l na nb">import pyautogui as gui, time<br/>def testfirefox():<br/>    screenWidth, screenHeight = gui.size()<br/>    gui.moveTo(0,screenHeight)<br/>    gui.click()<br/>    gui.typewrite('Firefox', interval=0.25)<br/>    gui.press('enter')<br/>    time.sleep(2)<br/>    gui.keyDown('alt')<br/>    gui.press(' ')<br/>    gui.press('x')<br/>    gui.keyUp('alt')<br/>    gui.click(250,22)<br/>    gui.click(371,51)<br/>    gui.typewrite('<a class="ae lu" href="https://medium.com/financeexplained'" rel="noopener">https://medium.com/financeexplained'</a>)<br/>    gui.press('enter')</span><span id="4e03" class="mx lw it mt b gy nc mz l na nb">def identifyloc():<br/>    while True:<br/>        currentMouseX, currentMouseY = gui.position()<br/>        print(currentMouseX,currentMouseY)<br/>        time.sleep(3)</span><span id="f7fd" class="mx lw it mt b gy nc mz l na nb">testfirefox()</span></pre><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi nd"><img src="../Images/b50226ba463297e96d3d20a2e07e3c70.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ryDNtPWAlhyO1aLO.gif"/></div></div></figure></div><div class="ab cl ne nf hx ng" role="separator"><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj"/></div><div class="im in io ip iq"><p id="add3" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在你走之前，我经常写关于金融和技术的博客。如果你想了解我的文章，别忘了<a class="ae lu" href="https://medium.com/@costasandreou" rel="noopener">关注我</a>！</p></div></div>    
</body>
</html>