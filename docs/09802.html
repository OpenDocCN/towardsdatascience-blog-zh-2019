<html>
<head>
<title>A Classification Problem with Python — Homesite Quote Conversion</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python 的分类问题——网站报价转换</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/a-classification-problem-with-python-homesite-quote-conversion-15174bca09b8?source=collection_archive---------26-----------------------#2019-12-23">https://towardsdatascience.com/a-classification-problem-with-python-homesite-quote-conversion-15174bca09b8?source=collection_archive---------26-----------------------#2019-12-23</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="a8d4" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">通过 Scikit-Learn 了解 Python 中的分类方法</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ki"><img src="../Images/867c772098c58e7210749f96e97af6aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cMmg7UvJ324tKrUyBubNwg.png"/></div></figure><p id="696a" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">领先的房屋保险提供商 Homesite 目前还没有一个动态转换率模型来让他们相信报价会导致购买。他们使用客户和销售活动信息的匿名数据库，包括财产和保险信息，要求我们预测哪些客户将购买给定的报价。准确预测转换率将有助于 Homesite 更好地了解提议的价格变化的影响，并保持理想的客户群组合。</p></div><div class="ab cl ln lo hx lp" role="separator"><span class="lq bw bk lr ls lt"/><span class="lq bw bk lr ls lt"/><span class="lq bw bk lr ls"/></div><div class="im in io ip iq"><h1 id="a39b" class="lu lv it bd lw lx ly lz ma mb mc md me jz mf ka mg kc mh kd mi kf mj kg mk ml bi translated">数据描述</h1><p id="92c3" class="pw-post-body-paragraph kq kr it ks b kt mm ju kv kw mn jx ky kz mo lb lc ld mp lf lg lh mq lj lk ll im bi translated">该数据集代表了对从 Homesite 购买保单感兴趣的大量客户的活动。每个<strong class="ks iu"> <em class="mr">报价号</em> </strong>对应一个潜在客户，<strong class="ks iu"> <em class="mr">报价转换 _ 标志</em> </strong>表示该客户是否购买了保单。所提供的特征是匿名的，并且提供了潜在客户和策略的丰富表示。它们包括特定的覆盖范围信息、销售信息、个人信息、财产信息和地理信息。我们的任务是预测测试集中每个 QuoteNumber 的 QuoteConversion_Flag。</p><p id="1311" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">我们先看数据，看看这个数据。</p><blockquote class="ms mt mu"><p id="fe06" class="kq kr mr ks b kt ku ju kv kw kx jx ky mv la lb lc mw le lf lg mx li lj lk ll im bi translated"><strong class="ks iu"> <em class="it">训练数据集</em> </strong> <em class="it"> : </em>训练一个模型的子集。</p><p id="4148" class="kq kr mr ks b kt ku ju kv kw kx jx ky mv la lb lc mw le lf lg mx li lj lk ll im bi translated"><strong class="ks iu"> <em class="it">测试数据集</em> </strong> <em class="it"> : </em>测试已训练模型的子集。</p></blockquote><pre class="kj kk kl km gt my mz na nb aw nc bi"><span id="c02d" class="nd lv it mz b gy ne nf l ng nh">trainfile = r'RevisedHomesiteTrain.csv'<br/>train_data = pd.read_csv(trainfile)</span><span id="e244" class="nd lv it mz b gy ni nf l ng nh">testfile = r'RevisedHomesiteTest.csv'<br/>test_data = pd.read_csv(testfile)</span><span id="a41a" class="nd lv it mz b gy ni nf l ng nh">print(train_data.shape)<br/>print(train_data.head())</span><span id="1db2" class="nd lv it mz b gy ni nf l ng nh">print(test_data.shape)<br/>print(test_data.head())</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="nk nl di nm bf nn"><div class="gh gi nj"><img src="../Images/001598dd6acaf8776f99cdaae1561289.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LwuwNkzhSzeCWX4rmyDRJQ.png"/></div></div><figcaption class="no np gj gh gi nq nr bd b be z dk">Figure 1</figcaption></figure><p id="db92" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">我们复制不包括目标的训练数据，并将训练数据和测试数据分开。然后，我们只选择目标列。</p><pre class="kj kk kl km gt my mz na nb aw nc bi"><span id="9559" class="nd lv it mz b gy ne nf l ng nh">trainData_Copy = train_data.drop('QuoteNumber', axis=1).iloc[:, :-1].copy()<br/>testData_Copy = test_data.drop('QuoteNumber', axis=1).iloc[:, :-1].copy()</span><span id="a115" class="nd lv it mz b gy ni nf l ng nh">X_train = trainData_Copy<br/>X_test = testData_Copy<br/>y_train = train_data["QuoteConversion_Flag"]</span><span id="e904" class="nd lv it mz b gy ni nf l ng nh">y_train = train_data.iloc[:, -1]<br/>y_test = test_data.iloc[:, -1]</span></pre></div><div class="ab cl ln lo hx lp" role="separator"><span class="lq bw bk lr ls lt"/><span class="lq bw bk lr ls lt"/><span class="lq bw bk lr ls"/></div><div class="im in io ip iq"><h1 id="9dd8" class="lu lv it bd lw lx ly lz ma mb mc md me jz mf ka mg kc mh kd mi kf mj kg mk ml bi translated">从<strong class="ak"> <em class="ns">训练数据集</em> </strong>创建验证数据集</h1><pre class="kj kk kl km gt my mz na nb aw nc bi"><span id="e65c" class="nd lv it mz b gy ne nf l ng nh">from sklearn.model_selection import train_test_split<br/>X_train1, X_val, y_train1, y_val = train_test_split(X_train, y_train, test_size = 0.2)</span></pre></div><div class="ab cl ln lo hx lp" role="separator"><span class="lq bw bk lr ls lt"/><span class="lq bw bk lr ls lt"/><span class="lq bw bk lr ls"/></div><div class="im in io ip iq"><h1 id="bcc2" class="lu lv it bd lw lx ly lz ma mb mc md me jz mf ka mg kc mh kd mi kf mj kg mk ml bi translated">模型</h1><h2 id="6f6d" class="nd lv it bd lw nt nu dn ma nv nw dp me kz nx ny mg ld nz oa mi lh ob oc mk od bi translated">决策图表</h2><p id="4cd7" class="pw-post-body-paragraph kq kr it ks b kt mm ju kv kw mn jx ky kz mo lb lc ld mp lf lg lh mq lj lk ll im bi translated">决策树是一种决策支持工具，它使用树状图形或决策模型及其可能的结果，包括偶然事件结果、资源成本和效用。这是显示只包含条件控制语句的算法的一种方式。决策树分类器通过基于不同的标准将数据集分解成越来越小的子集来工作。将使用不同的分类标准来划分数据集，每次划分的示例数量都会减少。</p><pre class="kj kk kl km gt my mz na nb aw nc bi"><span id="8a08" class="nd lv it mz b gy ne nf l ng nh">from sklearn.tree import DecisionTreeClassifier</span><span id="7ae9" class="nd lv it mz b gy ni nf l ng nh">clf = DecisionTreeClassifier()<br/>clf.fit(X_train1, y_train1)<br/>clf_predict = clf.predict(X_val)</span></pre><p id="2b3b" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">决策树分类器的 Kaggle 得分:0.94499</p><h2 id="5d37" class="nd lv it bd lw nt nu dn ma nv nw dp me kz nx ny mg ld nz oa mi lh ob oc mk od bi translated">随机森林</h2><p id="9874" class="pw-post-body-paragraph kq kr it ks b kt mm ju kv kw mn jx ky kz mo lb lc ld mp lf lg lh mq lj lk ll im bi translated">随机森林是一种集成学习方法，它在数据子集上拟合多个决策树，并对结果进行平均。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oe"><img src="../Images/8ce2e0b07006809eb10e6f29d011c4bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1134/format:webp/1*Mb8awDiY9T6rsOjtNTRcIg.png"/></div><figcaption class="no np gj gh gi nq nr bd b be z dk">Random Forest</figcaption></figure><pre class="kj kk kl km gt my mz na nb aw nc bi"><span id="db45" class="nd lv it mz b gy ne nf l ng nh">from sklearn.ensemble import RandomForestClassifier</span><span id="4e23" class="nd lv it mz b gy ni nf l ng nh">rfc = RandomForestClassifier()<br/>rfc.fit(X_train, y_train)<br/>rfc_predict = rfc.predict(X_test)</span></pre><p id="f2bd" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">随机森林分类器的 Kaggle 得分:0.91963</p><h2 id="6993" class="nd lv it bd lw nt nu dn ma nv nw dp me kz nx ny mg ld nz oa mi lh ob oc mk od bi translated">k-最近邻</h2><p id="89c7" class="pw-post-body-paragraph kq kr it ks b kt mm ju kv kw mn jx ky kz mo lb lc ld mp lf lg lh mq lj lk ll im bi translated">k-最近邻通过检查从某个测试示例到某个训练示例的已知值的距离来操作。给出训练点和测试点之间最小距离的数据点组/类是被选择的类。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="nk nl di nm bf nn"><div class="gh gi of"><img src="../Images/b7eb37d7129627e35263b9b783efd27c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*31YG0pcvM5MvUOgSq2aKZg.png"/></div></div><figcaption class="no np gj gh gi nq nr bd b be z dk">K-Nearest Neighbors</figcaption></figure><pre class="kj kk kl km gt my mz na nb aw nc bi"><span id="efcd" class="nd lv it mz b gy ne nf l ng nh">from sklearn.neighbors import KNeighborsClassifier</span><span id="5784" class="nd lv it mz b gy ni nf l ng nh">knc = KNeighborsClassifier()<br/>knc.fit(X_train, y_train)<br/>knc_predict = knc.predict(X_test)</span></pre><p id="91e2" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">K-最近邻分类器的 Kaggle 得分:0.60289</p><h2 id="e303" class="nd lv it bd lw nt nu dn ma nv nw dp me kz nx ny mg ld nz oa mi lh ob oc mk od bi translated">神经网络</h2><p id="9533" class="pw-post-body-paragraph kq kr it ks b kt mm ju kv kw mn jx ky kz mo lb lc ld mp lf lg lh mq lj lk ll im bi translated">神经网络是一种机器学习算法，涉及拟合许多用于表示与突触激活功能相连的神经元的隐藏层。这些基本上使用一个非常简化的大脑模型来建模和预测数据。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="nk nl di nm bf nn"><div class="gh gi og"><img src="../Images/a8150e44ef20d38e38f8a083eb7d0735.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ysUVjIIZiHVIkdtZqsGFXQ.png"/></div></div><figcaption class="no np gj gh gi nq nr bd b be z dk">Neural Networks</figcaption></figure><pre class="kj kk kl km gt my mz na nb aw nc bi"><span id="213b" class="nd lv it mz b gy ne nf l ng nh">from sklearn.neural_network import MLPClassifier</span><span id="19d5" class="nd lv it mz b gy ni nf l ng nh">mlp = MLPClassifier()<br/>mlp.fit(X_train, y_train)<br/>mlp_predict = mlp.predict(X_test)</span></pre><p id="909e" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">神经网络分类器的 Kaggle 得分:0.86759</p><h2 id="a116" class="nd lv it bd lw nt nu dn ma nv nw dp me kz nx ny mg ld nz oa mi lh ob oc mk od bi translated">梯度推进</h2><p id="f5e1" class="pw-post-body-paragraph kq kr it ks b kt mm ju kv kw mn jx ky kz mo lb lc ld mp lf lg lh mq lj lk ll im bi translated">梯度提升分类器是一组机器学习算法，将许多弱学习模型结合在一起，创建一个强预测模型。决策树通常在做梯度提升时使用。</p><pre class="kj kk kl km gt my mz na nb aw nc bi"><span id="a2a6" class="nd lv it mz b gy ne nf l ng nh">from sklearn.ensemble import GradientBoostingClassifier</span><span id="1870" class="nd lv it mz b gy ni nf l ng nh">abc = GradientBoostingClassifier()<br/>abc.fit(X_train, y_train)<br/>abc_predict = abc.predict(X_test)</span></pre><p id="f68a" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">神经网络分类器的 Kaggle 得分:0.95882</p></div><div class="ab cl ln lo hx lp" role="separator"><span class="lq bw bk lr ls lt"/><span class="lq bw bk lr ls lt"/><span class="lq bw bk lr ls"/></div><div class="im in io ip iq"><h1 id="7b04" class="lu lv it bd lw lx ly lz ma mb mc md me jz mf ka mg kc mh kd mi kf mj kg mk ml bi translated">比较</h1><p id="f9c5" class="pw-post-body-paragraph kq kr it ks b kt mm ju kv kw mn jx ky kz mo lb lc ld mp lf lg lh mq lj lk ll im bi translated">基于我创建的模型，首先我们可以认识到梯度提升分类器得到最高的 Kaggle 得分。此外，梯度推进模型因其在分类复杂数据集方面的有效性而变得越来越受欢迎，最近已被用于赢得许多 Kaggle 数据科学竞赛。</p></div><div class="ab cl ln lo hx lp" role="separator"><span class="lq bw bk lr ls lt"/><span class="lq bw bk lr ls lt"/><span class="lq bw bk lr ls"/></div><div class="im in io ip iq"><h1 id="0b0e" class="lu lv it bd lw lx ly lz ma mb mc md me jz mf ka mg kc mh kd mi kf mj kg mk ml bi translated">结论</h1><p id="6ab5" class="pw-post-body-paragraph kq kr it ks b kt mm ju kv kw mn jx ky kz mo lb lc ld mp lf lg lh mq lj lk ll im bi translated">总之，我们使用 Scikit Learn 的不同分类方法(决策树、随机森林、K-最近邻、神经网络和梯度推进)来预测客户购买报价保险计划的概率，并专注于预测准确性。目的是学习一个可以最大化预测精度的模型，比较不同的算法，选择性能最好的一个。</p><p id="5410" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">创建这篇文章的源代码可以在<a class="ae lm" href="https://github.com/shirley0823/Machine-Learning-with-Python/blob/master/Homesite_Quote_Conversion.ipynb" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p></div><div class="ab cl ln lo hx lp" role="separator"><span class="lq bw bk lr ls lt"/><span class="lq bw bk lr ls lt"/><span class="lq bw bk lr ls"/></div><div class="im in io ip iq"><h1 id="eb11" class="lu lv it bd lw lx ly lz ma mb mc md me jz mf ka mg kc mh kd mi kf mj kg mk ml bi translated">关于我</h1><p id="440b" class="pw-post-body-paragraph kq kr it ks b kt mm ju kv kw mn jx ky kz mo lb lc ld mp lf lg lh mq lj lk ll im bi translated">非常感谢您阅读我的文章！大家好，我是雪莉，目前在亚利桑那州立大学攻读商业分析硕士学位。如果您有任何问题，请随时联系我！</p><pre class="kj kk kl km gt my mz na nb aw nc bi"><span id="3bef" class="nd lv it mz b gy ne nf l ng nh">Email me at <strong class="mz iu"><em class="mr">kchen122@asu.edu</em></strong><em class="mr"> </em>and feel free to connect me on <a class="ae lm" href="https://www.linkedin.com/in/kuanyinchen-shirley/" rel="noopener ugc nofollow" target="_blank"><strong class="mz iu">LinkedIn</strong></a>!</span></pre></div></div>    
</body>
</html>