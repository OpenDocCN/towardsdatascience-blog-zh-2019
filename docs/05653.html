<html>
<head>
<title>When and how to use Python mock</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">何时以及如何使用 Python mock</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/when-and-how-to-use-python-mock-b626e5f9bf7?source=collection_archive---------15-----------------------#2019-08-19">https://towardsdatascience.com/when-and-how-to-use-python-mock-b626e5f9bf7?source=collection_archive---------15-----------------------#2019-08-19</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/58b881230ab7e8c5bd333225049c372e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*AYsmvOsJ6rXcyLZU"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk">Photo by <a class="ae jg" href="https://unsplash.com/@scw1217?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Suzanne D. Williams</a> on <a class="ae jg" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><div class=""/><div class=""><h2 id="d41a" class="pw-subtitle-paragraph kg ji jj bd b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dk translated">使用 mock 减少您的测试执行时间</h2></div><h2 id="eff5" class="ky kz jj bd la lb lc dn ld le lf dp lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">议程</h2><p id="fdca" class="pw-post-body-paragraph lu lv jj lw b lx ly kk lz ma mb kn mc lh md me mf ll mg mh mi lp mj mk ml mm im bi translated">这篇文章将涵盖何时以及如何使用<code class="fe mn mo mp mq b">unittest.mock</code>库。</p><p id="7ca7" class="pw-post-body-paragraph lu lv jj lw b lx mr kk lz ma ms kn mc lh mt me mf ll mu mh mi lp mv mk ml mm im bi translated">Python 文档恰当地描述了模拟库:</p><pre class="mw mx my mz gt na mq nb nc aw nd bi"><span id="223c" class="ky kz jj mq b gy ne nf l ng nh">unittest.mock allows you to replace parts of your system under test with mock objects and make assertions about how they have been used.</span></pre><h2 id="6b25" class="ky kz jj bd la lb lc dn ld le lf dp lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">何时使用模拟库</h2><p id="e79c" class="pw-post-body-paragraph lu lv jj lw b lx ly kk lz ma mb kn mc lh md me mf ll mg mh mi lp mj mk ml mm im bi translated">简短的回答是“大多数时候”。下面的例子将使这一主张更加清晰:</p><p id="6551" class="pw-post-body-paragraph lu lv jj lw b lx mr kk lz ma ms kn mc lh mt me mf ll mu mh mi lp mv mk ml mm im bi translated">在 shell 上定义以下三个函数。</p><pre class="mw mx my mz gt na mq nb nc aw nd bi"><span id="fcca" class="ky kz jj mq b gy ne nf l ng nh">In [1]: def cow():<br/>   ...:     print("cow")<br/>   ...:     return {'cow': 'moo'}<br/>   ...:</span><span id="6813" class="ky kz jj mq b gy ni nf l ng nh">In [2]: def dog():<br/>   ...:     print("dog")<br/>   ...:     return {'dog': 'bark'}<br/>   ...:</span><span id="a329" class="ky kz jj mq b gy ni nf l ng nh">In [3]: def animals():<br/>   ...:     data = cow()<br/>   ...:     data.update(dog())<br/>   ...:     data['pig'] = 'oink'<br/>   ...:     return data<br/>   ...:</span></pre><p id="e415" class="pw-post-body-paragraph lu lv jj lw b lx mr kk lz ma ms kn mc lh mt me mf ll mu mh mi lp mv mk ml mm im bi translated">让我们执行<code class="fe mn mo mp mq b">animals</code>。素食者会杀了我；)</p><pre class="mw mx my mz gt na mq nb nc aw nd bi"><span id="7f4c" class="ky kz jj mq b gy ne nf l ng nh">In [4]: animals()<br/>cow<br/>dog<br/>Out[4]: {'cow': 'moo', 'dog': 'bark', 'pig': 'oink'}</span></pre><p id="6dc9" class="pw-post-body-paragraph lu lv jj lw b lx mr kk lz ma ms kn mc lh mt me mf ll mu mh mi lp mv mk ml mm im bi translated">输出确认了从<code class="fe mn mo mp mq b">animals()</code>调用了<code class="fe mn mo mp mq b">cow</code>和<code class="fe mn mo mp mq b">dog</code>。</p><p id="4d2b" class="pw-post-body-paragraph lu lv jj lw b lx mr kk lz ma ms kn mc lh mt me mf ll mu mh mi lp mv mk ml mm im bi translated">让我们为<code class="fe mn mo mp mq b">cow</code>写一个测试。</p><pre class="mw mx my mz gt na mq nb nc aw nd bi"><span id="fcd6" class="ky kz jj mq b gy ne nf l ng nh">In [5]: def test_cow():<br/>   ...:     assert cow() == {'cow': 'moo'}<br/>   ...:</span></pre><p id="d31b" class="pw-post-body-paragraph lu lv jj lw b lx mr kk lz ma ms kn mc lh mt me mf ll mu mh mi lp mv mk ml mm im bi translated">让我们执行<code class="fe mn mo mp mq b">test_cow</code>来确保<code class="fe mn mo mp mq b">cow</code>按预期运行。</p><pre class="mw mx my mz gt na mq nb nc aw nd bi"><span id="58c6" class="ky kz jj mq b gy ne nf l ng nh">In [6]: test_cow()<br/>cow</span></pre><p id="69ee" class="pw-post-body-paragraph lu lv jj lw b lx mr kk lz ma ms kn mc lh mt me mf ll mu mh mi lp mv mk ml mm im bi translated">让我们同样测试<code class="fe mn mo mp mq b">dog</code>。</p><pre class="mw mx my mz gt na mq nb nc aw nd bi"><span id="b526" class="ky kz jj mq b gy ne nf l ng nh">In [7]: def test_dog():<br/>   ...:     assert dog() == {'dog': 'bark'}<br/>   ...:</span><span id="1b9f" class="ky kz jj mq b gy ni nf l ng nh">In [8]: test_dog()<br/>dog</span></pre><p id="fce1" class="pw-post-body-paragraph lu lv jj lw b lx mr kk lz ma ms kn mc lh mt me mf ll mu mh mi lp mv mk ml mm im bi translated">下面给<code class="fe mn mo mp mq b">animals</code>加个测试。</p><pre class="mw mx my mz gt na mq nb nc aw nd bi"><span id="8d79" class="ky kz jj mq b gy ne nf l ng nh">In [9]: def test_animals():<br/>   ...:     assert animals() == {'dog': 'bark', 'cow': 'moo', 'pig': 'oink'}<br/>   ...:</span><span id="034c" class="ky kz jj mq b gy ni nf l ng nh">In [10]: test_animals()<br/>cow<br/>dog</span></pre><p id="98d6" class="pw-post-body-paragraph lu lv jj lw b lx mr kk lz ma ms kn mc lh mt me mf ll mu mh mi lp mv mk ml mm im bi translated">从打印的声明中可以看出，<code class="fe mn mo mp mq b">cow()</code>和<code class="fe mn mo mp mq b">dog()</code>是从<code class="fe mn mo mp mq b">test_animals()</code>开始执行的。</p><p id="2e30" class="pw-post-body-paragraph lu lv jj lw b lx mr kk lz ma ms kn mc lh mt me mf ll mu mh mi lp mv mk ml mm im bi translated">测试<code class="fe mn mo mp mq b">animals</code>时不需要执行<code class="fe mn mo mp mq b">cow</code>和<code class="fe mn mo mp mq b">dog</code>，因为<code class="fe mn mo mp mq b">cow </code>和<code class="fe mn mo mp mq b">dog</code>已经单独测试过了。</p><p id="0487" class="pw-post-body-paragraph lu lv jj lw b lx mr kk lz ma ms kn mc lh mt me mf ll mu mh mi lp mv mk ml mm im bi translated">在测试<code class="fe mn mo mp mq b">animals</code>时，我们只想确保<code class="fe mn mo mp mq b">cow</code>和<code class="fe mn mo mp mq b">dog</code>会被执行。我们不希望真正的处决发生。</p><p id="8685" class="pw-post-body-paragraph lu lv jj lw b lx mr kk lz ma ms kn mc lh mt me mf ll mu mh mi lp mv mk ml mm im bi translated"><code class="fe mn mo mp mq b">cow</code>和<code class="fe mn mo mp mq b">dog</code>是微小函数。从<code class="fe mn mo mp mq b">test_animals</code>开始的执行目前不是什么大事。如果函数<code class="fe mn mo mp mq b">cow</code>和<code class="fe mn mo mp mq b">dog</code>很大，<code class="fe mn mo mp mq b">test_animals</code>可能需要很长时间才能完成。</p><p id="bee7" class="pw-post-body-paragraph lu lv jj lw b lx mr kk lz ma ms kn mc lh mt me mf ll mu mh mi lp mv mk ml mm im bi translated">如果我们使用<code class="fe mn mo mp mq b">unitest.mock.patch</code>，这种情况是可以避免的。</p><p id="28e7" class="pw-post-body-paragraph lu lv jj lw b lx mr kk lz ma ms kn mc lh mt me mf ll mu mh mi lp mv mk ml mm im bi translated">让我们修改<code class="fe mn mo mp mq b">test_animals</code>如下所示:</p><pre class="mw mx my mz gt na mq nb nc aw nd bi"><span id="2c2d" class="ky kz jj mq b gy ne nf l ng nh">In [17]: from unittest.mock import patch</span><span id="01fa" class="ky kz jj mq b gy ni nf l ng nh">In [18]: <a class="ae jg" href="http://twitter.com/patch" rel="noopener ugc nofollow" target="_blank">@patch</a>('__main__.cow')<br/>    ...: <a class="ae jg" href="http://twitter.com/patch" rel="noopener ugc nofollow" target="_blank">@patch</a>('__main__.dog')<br/>    ...: def test_animals(patched_dog, patched_cow):<br/>    ...:     data = animals()<br/>    ...:     assert patched_dog.called is True<br/>    ...:     assert patched_cow.called is True<br/>    ...:</span></pre><p id="872b" class="pw-post-body-paragraph lu lv jj lw b lx mr kk lz ma ms kn mc lh mt me mf ll mu mh mi lp mv mk ml mm im bi translated">执行` test_animals()`。</p><pre class="mw mx my mz gt na mq nb nc aw nd bi"><span id="2889" class="ky kz jj mq b gy ne nf l ng nh">In [19]: test_animals()</span></pre><p id="eb10" class="pw-post-body-paragraph lu lv jj lw b lx mr kk lz ma ms kn mc lh mt me mf ll mu mh mi lp mv mk ml mm im bi translated">我们再也看不到<code class="fe mn mo mp mq b">cow</code>和<code class="fe mn mo mp mq b">dog</code>的打印声明。这确认了<code class="fe mn mo mp mq b">cow</code>和<code class="fe mn mo mp mq b">dog</code>没有被执行。</p><p id="ad1f" class="pw-post-body-paragraph lu lv jj lw b lx mr kk lz ma ms kn mc lh mt me mf ll mu mh mi lp mv mk ml mm im bi translated">我们来解剖一下<code class="fe mn mo mp mq b">test_animals</code>。</p><p id="0e61" class="pw-post-body-paragraph lu lv jj lw b lx mr kk lz ma ms kn mc lh mt me mf ll mu mh mi lp mv mk ml mm im bi translated"><code class="fe mn mo mp mq b">test_animals</code>已装饰有<code class="fe mn mo mp mq b">@patch</code>。函数<code class="fe mn mo mp mq b">dog</code>作为参数传递给<code class="fe mn mo mp mq b">@patch</code>。</p><p id="c8c3" class="pw-post-body-paragraph lu lv jj lw b lx mr kk lz ma ms kn mc lh mt me mf ll mu mh mi lp mv mk ml mm im bi translated">由于<code class="fe mn mo mp mq b">test_animals</code>已经被修饰，所以在<code class="fe mn mo mp mq b">test_animals</code>的上下文中，实际的函数<code class="fe mn mo mp mq b">dog</code>已经被替换为一个<code class="fe mn mo mp mq b">unittest.mock.Mock</code>实例。这个<code class="fe mn mo mp mq b">Mock</code>实例被称为<code class="fe mn mo mp mq b">patched_dog</code>。</p><p id="e702" class="pw-post-body-paragraph lu lv jj lw b lx mr kk lz ma ms kn mc lh mt me mf ll mu mh mi lp mv mk ml mm im bi translated">由于<code class="fe mn mo mp mq b">animals()</code>是在<code class="fe mn mo mp mq b">test_animals()</code>的上下文中执行的，所以没有从<code class="fe mn mo mp mq b">animals</code>实际调用<code class="fe mn mo mp mq b">dog</code>。取而代之的是<code class="fe mn mo mp mq b">patched_dog</code>的称呼。</p><p id="0cc1" class="pw-post-body-paragraph lu lv jj lw b lx mr kk lz ma ms kn mc lh mt me mf ll mu mh mi lp mv mk ml mm im bi translated"><code class="fe mn mo mp mq b">Mock</code>实例有一个名为<code class="fe mn mo mp mq b">called</code>的属性，如果从测试中的函数调用模拟实例，该属性将被设置为 true。我们断言模拟实例<code class="fe mn mo mp mq b">patched_dog</code>已经被调用。</p><p id="a563" class="pw-post-body-paragraph lu lv jj lw b lx mr kk lz ma ms kn mc lh mt me mf ll mu mh mi lp mv mk ml mm im bi translated">如果从<code class="fe mn mo mp mq b">animals</code>到<code class="fe mn mo mp mq b">dog</code>的调用被移除/注释，那么<code class="fe mn mo mp mq b">test_animals</code>将失败。</p><pre class="mw mx my mz gt na mq nb nc aw nd bi"><span id="5f03" class="ky kz jj mq b gy ne nf l ng nh">In [20]: def animals():<br/>    ...:     data = cow()<br/>    ...:     #data.update(dog())<br/>    ...:     data['pig'] = 'oink'<br/>    ...:     return data<br/>    ...:</span><span id="cb30" class="ky kz jj mq b gy ni nf l ng nh">In [21]: test_animals()<br/>---------------------------------------------------------------------------<br/>AssertionError                            Traceback (most recent call last)<br/>&lt;ipython-input-21-f8c77986484f&gt; in &lt;module&gt;<br/>----&gt; 1 test_animals()</span><span id="abe8" class="ky kz jj mq b gy ni nf l ng nh">/usr/local/Cellar/python/3.6.5/Frameworks/Python.framework/Versions/3.6/lib/python3.6/unittest/mock.py in patched(*args, **keywargs)<br/>   1177<br/>   1178                 args += tuple(extra_args)<br/>-&gt; 1179                 return func(*args, **keywargs)<br/>   1180             except:<br/>   1181                 if (patching not in entered_patchers and</span><span id="1eb2" class="ky kz jj mq b gy ni nf l ng nh">&lt;ipython-input-18-a243d0eea2e8&gt; in test_animals(patched_dog, patched_cow)<br/>      3 def test_animals(patched_dog, patched_cow):<br/>      4     data = animals()<br/>----&gt; 5     assert patched_dog.called is True<br/>      6     assert patched_cow.called is True<br/>      7</span><span id="5780" class="ky kz jj mq b gy ni nf l ng nh">AssertionError:</span></pre><p id="8879" class="pw-post-body-paragraph lu lv jj lw b lx mr kk lz ma ms kn mc lh mt me mf ll mu mh mi lp mv mk ml mm im bi translated">这证实了测试提供了正确的覆盖范围，而没有实际执行<code class="fe mn mo mp mq b">cow</code>和<code class="fe mn mo mp mq b">dog</code>。</p><h2 id="51fa" class="ky kz jj bd la lb lc dn ld le lf dp lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">在模拟实例上设置 return_value</h2><p id="c49b" class="pw-post-body-paragraph lu lv jj lw b lx ly kk lz ma mb kn mc lh md me mf ll mg mh mi lp mj mk ml mm im bi translated">取消注释代码。</p><p id="3c3d" class="pw-post-body-paragraph lu lv jj lw b lx mr kk lz ma ms kn mc lh mt me mf ll mu mh mi lp mv mk ml mm im bi translated"><code class="fe mn mo mp mq b">animals</code>中除了调用<code class="fe mn mo mp mq b">cow</code>和<code class="fe mn mo mp mq b">dog</code>还有额外的代码。<code class="fe mn mo mp mq b">animals</code>也将猪添加到数据中。</p><p id="4047" class="pw-post-body-paragraph lu lv jj lw b lx mr kk lz ma ms kn mc lh mt me mf ll mu mh mi lp mv mk ml mm im bi translated">我们来测试一下<code class="fe mn mo mp mq b">animals</code>的附加代码。</p><pre class="mw mx my mz gt na mq nb nc aw nd bi"><span id="ca46" class="ky kz jj mq b gy ne nf l ng nh">In [43]: <a class="ae jg" href="http://twitter.com/patch" rel="noopener ugc nofollow" target="_blank">@patch</a>('__main__.cow')<br/>    ...: <a class="ae jg" href="http://twitter.com/patch" rel="noopener ugc nofollow" target="_blank">@patch</a>('__main__.dog')<br/>    ...: def test_animals(patched_dog, patched_cow):<br/>    ...:     patched_cow.return_value = {'c': 'm'}<br/>    ...:     patched_dog.return_value = {'d': 'b'}<br/>    ...:     data = animals()<br/>    ...:     assert patched_dog.called is True<br/>    ...:     assert patched_cow.called is True<br/>    ...:     assert 'pig' in data</span></pre><p id="8ea2" class="pw-post-body-paragraph lu lv jj lw b lx mr kk lz ma ms kn mc lh mt me mf ll mu mh mi lp mv mk ml mm im bi translated">让我们执行测试</p><pre class="mw mx my mz gt na mq nb nc aw nd bi"><span id="4d65" class="ky kz jj mq b gy ne nf l ng nh">In [45]: test_animals()</span></pre><p id="f29a" class="pw-post-body-paragraph lu lv jj lw b lx mr kk lz ma ms kn mc lh mt me mf ll mu mh mi lp mv mk ml mm im bi translated">我们所有的断言都通过了，因为没有断言错误。</p><p id="c616" class="pw-post-body-paragraph lu lv jj lw b lx mr kk lz ma ms kn mc lh mt me mf ll mu mh mi lp mv mk ml mm im bi translated">调用<code class="fe mn mo mp mq b">Mock</code>函数的默认返回值是另一个<code class="fe mn mo mp mq b">Mock</code>实例。因此，当在<code class="fe mn mo mp mq b">test_animals</code>上下文中从<code class="fe mn mo mp mq b">animals</code>调用<code class="fe mn mo mp mq b">patched_dog</code>时，它会返回一个模拟实例。我们不希望它返回一个模拟实例，因为<code class="fe mn mo mp mq b">animals</code>的附加代码期望它是一个字典。</p><p id="a9bd" class="pw-post-body-paragraph lu lv jj lw b lx mr kk lz ma ms kn mc lh mt me mf ll mu mh mi lp mv mk ml mm im bi translated">我们在<code class="fe mn mo mp mq b">patched_cow</code>上设置一个<code class="fe mn mo mp mq b">return_value</code>作为字典。同样适用于<code class="fe mn mo mp mq b">patched_dog</code>。</p><p id="4536" class="pw-post-body-paragraph lu lv jj lw b lx mr kk lz ma ms kn mc lh mt me mf ll mu mh mi lp mv mk ml mm im bi translated">现在<code class="fe mn mo mp mq b">animals</code>的附加代码也被测试覆盖。</p><h2 id="0aa8" class="ky kz jj bd la lb lc dn ld le lf dp lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">另一个例子</h2><p id="a01b" class="pw-post-body-paragraph lu lv jj lw b lx ly kk lz ma mb kn mc lh md me mf ll mg mh mi lp mj mk ml mm im bi translated">让我们定义一个函数来测试 url 是否有效。这个靠 Python 的<code class="fe mn mo mp mq b">requests</code>。</p><pre class="mw mx my mz gt na mq nb nc aw nd bi"><span id="6fb6" class="ky kz jj mq b gy ne nf l ng nh">In [59]: import requests</span><span id="7362" class="ky kz jj mq b gy ni nf l ng nh">In [60]: def is_valid_url(url):<br/>    ...:     try:<br/>    ...:         response = requests.get(url)<br/>    ...:     except Exception:<br/>    ...:         return False<br/>    ...:     return response.status_code == 200</span></pre><p id="2c6a" class="pw-post-body-paragraph lu lv jj lw b lx mr kk lz ma ms kn mc lh mt me mf ll mu mh mi lp mv mk ml mm im bi translated">下面给<code class="fe mn mo mp mq b">is_valid_url</code>加个测试。</p><pre class="mw mx my mz gt na mq nb nc aw nd bi"><span id="a9f3" class="ky kz jj mq b gy ne nf l ng nh">In [69]: def test_is_valid_url():<br/>    ...:     assert is_valid_url('<a class="ae jg" href="http://agiliq.com'" rel="noopener ugc nofollow" target="_blank">http://agiliq.com'</a>) is True<br/>    ...:     assert is_valid_url('<a class="ae jg" href="http://agiliq.com/eerwweeee'" rel="noopener ugc nofollow" target="_blank">http://agiliq.com/eerwweeee'</a>) is False # We want False in 404 pages too<br/>    ...:     assert is_valid_url('<a class="ae jg" href="http://aeewererr.com'" rel="noopener ugc nofollow" target="_blank">http://aeewererr.com'</a>) is False</span><span id="5493" class="ky kz jj mq b gy ni nf l ng nh">In [70]: test_is_valid_url()</span></pre><p id="c159" class="pw-post-body-paragraph lu lv jj lw b lx mr kk lz ma ms kn mc lh mt me mf ll mu mh mi lp mv mk ml mm im bi translated">您会注意到您的测试在进行网络调用时有多慢。</p><p id="1962" class="pw-post-body-paragraph lu lv jj lw b lx mr kk lz ma ms kn mc lh mt me mf ll mu mh mi lp mv mk ml mm im bi translated">让我们通过利用<code class="fe mn mo mp mq b">patch</code>和<code class="fe mn mo mp mq b">Mock</code>使我们的测试更快来解决这个问题。</p><pre class="mw mx my mz gt na mq nb nc aw nd bi"><span id="7888" class="ky kz jj mq b gy ne nf l ng nh">In [71]: <a class="ae jg" href="http://twitter.com/patch" rel="noopener ugc nofollow" target="_blank">@patch</a>('__main__.requests')<br/>    ...: def test_is_valid_url(patched_requests):<br/>    ...:     patched_requests.get.return_value = Mock(status_code=200)<br/>    ...:     assert is_valid_url('<a class="ae jg" href="http://agiliq.com'" rel="noopener ugc nofollow" target="_blank">http://agiliq.com'</a>) is True<br/>    ...:     patched_requests.get.return_value = Mock(status_code=404)<br/>    ...:     assert is_valid_url('<a class="ae jg" href="http://agiliq.com/eerwweeee'" rel="noopener ugc nofollow" target="_blank">http://agiliq.com/eerwweeee'</a>) is False # We want False in 404 pages too<br/>    ...:     patched_requests.get = Mock(side_effect=Exception())<br/>    ...:     assert is_valid_url('<a class="ae jg" href="http://aeewererr.com'" rel="noopener ugc nofollow" target="_blank">http://aeewererr.com'</a>) is False<br/>    ...:</span><span id="cf0a" class="ky kz jj mq b gy ni nf l ng nh">In [72]: test_is_valid_url()</span></pre><p id="0522" class="pw-post-body-paragraph lu lv jj lw b lx mr kk lz ma ms kn mc lh mt me mf ll mu mh mi lp mv mk ml mm im bi translated">你应该注意到了速度的提升。</p></div><div class="ab cl nj nk hx nl" role="separator"><span class="nm bw bk nn no np"/><span class="nm bw bk nn no np"/><span class="nm bw bk nn no"/></div><div class="im in io ip iq"><h2 id="4645" class="ky kz jj bd la lb lc dn ld le lf dp lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">摘要</h2><p id="509c" class="pw-post-body-paragraph lu lv jj lw b lx ly kk lz ma mb kn mc lh md me mf ll mg mh mi lp mj mk ml mm im bi translated">模拟应该在下列情况下使用:</p><ul class=""><li id="cdbe" class="nq nr jj lw b lx mr ma ms lh ns ll nt lp nu mm nv nw nx ny bi translated">来模拟任何已经单独测试过的依赖项。<code class="fe mn mo mp mq b">cow</code>是<code class="fe mn mo mp mq b">animals</code>的属地，所以我们嘲讽了<code class="fe mn mo mp mq b">cow</code>。</li><li id="48c5" class="nq nr jj lw b lx nz ma oa lh ob ll oc lp od mm nv nw nx ny bi translated">来模拟网络通话。<code class="fe mn mo mp mq b">requests </code>或<code class="fe mn mo mp mq b">send_mail</code>应该被嘲讽以避免网络调用。</li><li id="c3ab" class="nq nr jj lw b lx nz ma oa lh ob ll oc lp od mm nv nw nx ny bi translated">模拟任何大型函数以减少测试执行时间。</li></ul></div><div class="ab cl nj nk hx nl" role="separator"><span class="nm bw bk nn no np"/><span class="nm bw bk nn no np"/><span class="nm bw bk nn no"/></div><div class="im in io ip iq"><h2 id="a489" class="ky kz jj bd la lb lc dn ld le lf dp lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">签署</h2><p id="9f25" class="pw-post-body-paragraph lu lv jj lw b lx ly kk lz ma mb kn mc lh md me mf ll mg mh mi lp mj mk ml mm im bi translated">希望这篇文章有用。</p><p id="22b6" class="pw-post-body-paragraph lu lv jj lw b lx mr kk lz ma ms kn mc lh mt me mf ll mu mh mi lp mv mk ml mm im bi translated">如果你喜欢这篇文章，考虑发送至少 50 个掌声:)</p></div></div>    
</body>
</html>