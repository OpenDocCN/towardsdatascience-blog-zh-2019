<html>
<head>
<title>Neural Networks Intuitions: 1.Balanced Cross Entropy</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">神经网络直觉:1。平衡交叉熵</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/neural-networks-intuitions-1-balanced-cross-entropy-331995cd5033?source=collection_archive---------15-----------------------#2019-01-03">https://towardsdatascience.com/neural-networks-intuitions-1-balanced-cross-entropy-331995cd5033?source=collection_archive---------15-----------------------#2019-01-03</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="e09b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">大家好！</p><p id="062d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这是我的第一篇媒体博客。创建这个系列的目的是为了更好地理解从神经网络的基础到损失函数、神经网络架构等等(不需要深入研究数学)。自从我开始深度学习生涯以来，我一直觉得在模型工程期间或解决问题/调试神经网络时，形成直觉对取得进展有很大帮助。这一系列博客文章(我希望以后继续)的主要目的是让<strong class="jp ir">洞察<strong class="jp ir">正在发生的事情</strong>，即使其中的数学部分很难理解。</strong></p><p id="bcef" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">PS:我也希望向你们学习:-)</p></div><div class="ab cl kl km hu kn" role="separator"><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq"/></div><div class="ij ik il im in"><p id="f56d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">问题:</strong>在<strong class="jp ir"> </strong>解释什么是平衡交叉熵之前，让我们考虑一个物体(在我们的例子中是<strong class="jp ir">正文</strong>)检测问题。众所周知的文本检测架构是<strong class="jp ir"> DenseBox </strong>和它著名的实现<strong class="jp ir"> EAST:一个高效准确的场景文本检测器。</strong> DenseBox 接收输入场景图像并输出激活图(二进制或灰色),其中激活图中的白色区域表示文本区域，黑色或灰色区域表示背景。所以基本上有两类(文本和背景)并且使用的损失函数是<strong class="jp ir">二进制交叉熵</strong>。因为很明显，在任何给定的文本检测数据集中背景类实例的数量通常多于文本类实例的数量，所以训练神经网络可能使其偏向于输出更多的背景类而不是文本类。所以使用二元交叉熵，或者其他损失函数是行不通的。</p><blockquote class="ks kt ku"><p id="5290" class="jn jo kv jp b jq jr js jt ju jv jw jx kw jz ka kb kx kd ke kf ky kh ki kj kk ij bi translated">我说的“照原样使用二元交叉熵或任何其他损失函数都行不通”是什么意思？</p></blockquote><p id="b17a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">任何深度学习实践者都很清楚这样一个事实，即类不平衡会影响神经网络的性能。类别不平衡的问题可以通过在训练数据中添加不太占优势的类别的更多实例来解决。我不打算深究这个问题，因为有几种方法可以解决阶级不平衡的问题。</p><blockquote class="ks kt ku"><p id="4e97" class="jn jo kv jp b jq jr js jt ju jv jw jx kw jz ka kb kx kd ke kf ky kh ki kj kk ij bi translated">有没有什么优雅的方法可以在不修改数据集的情况下解决类不平衡的问题？</p></blockquote><p id="52e3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">解决这个问题的一个方法是调整损失函数，就像 DenseBox 论文中所做的那样。</p></div><div class="ab cl kl km hu kn" role="separator"><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq"/></div><div class="ij ik il im in"><p id="ba20" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">解决方案:</strong></p><p id="7961" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">平衡交叉熵:</p><figure class="la lb lc ld gt le gh gi paragraph-image"><div class="gh gi kz"><img src="../Images/f07dc518b431f75eebe6b4ad9742018d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1060/format:webp/1*yEw6qiz5s6NuOvfcRfTtHw.png"/></div><figcaption class="lh li gj gh gi lj lk bd b be z dk">* as mentioned in EAST paper</figcaption></figure><p id="bc5f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">看着上面的方程，我们可以很好地发现二元交叉熵和平衡交叉熵之间的区别。它是变量<strong class="jp ir"> β </strong>。</p><blockquote class="ks kt ku"><p id="14b9" class="jn jo kv jp b jq jr js jt ju jv jw jx kw jz ka kb kx kd ke kf ky kh ki kj kk ij bi translated">那么<strong class="jp ir"> β </strong>意味着什么呢？</p></blockquote><p id="6cb5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">β =阴性样本数/样本总数。换句话说，β是样本的<strong class="jp ir">部分，它在数据集中占优势</strong>。1 — β表示另一类的<strong class="jp ir">分数(明显！).</strong></p><blockquote class="ks kt ku"><p id="837e" class="jn jo kv jp b jq jr js jt ju jv jw jx kw jz ka kb kx kd ke kf ky kh ki kj kk ij bi translated"><strong class="jp ir"> β </strong>如何帮助解决阶级失衡问题？</p></blockquote><p id="1e0b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">由于乘以 Y = 0 的项(1 — β)，损失评估为一个非常小的值，从而导致<strong class="jp ir">小于</strong>(当β接近 0 时，例如 0.1，0.2)或<strong class="jp ir">没有</strong>(当β为 0 时)<strong class="jp ir">学习。</strong>正类的分数越小，Y=0 时的损失值越小。</p><p id="c8fb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">请注意，在这种情况下，负类(Y=0)比正类(Y=1)更大。</p><p id="a39e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="kv">简单来说，你</em> <strong class="jp ir"> <em class="kv">将损失函数中对应于主导类的部分乘以一个较小的值</em> </strong> <em class="kv">，即乘以次主导类的分数。这使得损失值非常小(当数据集中只有一个类时甚至为零)，因此神经网络权重不会经常调整为输出主导类。</em></p><p id="b590" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">上述等式也适用于数据集中正类(Y=1)占优势的情况。在这种情况下，将 Y * log Yˆ乘以 1 — β，可以比实际情况进一步降低损耗。请注意，乘以<strong class="jp ir"> β或 1- β </strong>取决于您选择的<strong class="jp ir"> β </strong>是什么。</p><p id="f22e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这是我对平衡交叉熵的理解，以及它如何帮助解决类不平衡的问题。请随意指出我博客中的任何错误，或者我对此的直觉是错误的。</p><p id="74eb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">干杯:-)</p></div></div>    
</body>
</html>