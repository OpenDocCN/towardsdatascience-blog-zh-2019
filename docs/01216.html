<html>
<head>
<title>Working with APIs using Flask, Flask-RESTPlus and Swagger UI</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用 Flask、Flask-RESTPlus 和 Swagger UI 处理 API</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/working-with-apis-using-flask-flask-restplus-and-swagger-ui-7cf447deda7f?source=collection_archive---------0-----------------------#2019-02-25">https://towardsdatascience.com/working-with-apis-using-flask-flask-restplus-and-swagger-ui-7cf447deda7f?source=collection_archive---------0-----------------------#2019-02-25</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/262527e3a0d7bf2b3caef6e4c5aa1321.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*7JCS29jcDv4WYk7s"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@andrewwelch3?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">andrew welch</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="618d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在从事机器学习项目时，我决定开发完整的应用程序。这将需要开发 API，这样我们就可以发布值并获得预测的响应。这就是 Flask 和 Flask-RESTPlus 的用武之地。</p><p id="bb17" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><a class="ae kc" href="http://flask.pocoo.org/" rel="noopener ugc nofollow" target="_blank"> Flask </a>支持将 Python 函数公开为 API。Flask-RESTPlus 是 Flask 的扩展，改进了它的功能。它不仅允许我们定义 REST APIs，还为所有 API 引入了 Swagger UI。</p><p id="22cb" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我将解释如何用几个 API 和虚拟数据开发 Flask 应用程序。该项目可以作为一个 GitHub 库使用。</p><h1 id="eba0" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">装置</h1><p id="2f14" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我通过使用<code class="fe me mf mg mh b">pipenv</code>创建一个虚拟环境开始了这个过程。你可以在我的关于虚拟环境比较的文章中读到更多。我安装了 Flask 和 Flask-RESTPlus。</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="6a30" class="mq lc iq mh b gy mr ms l mt mu">pipenv install flask<br/>pipenv install flask-restplus</span></pre><p id="bb0e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然而，如果您不希望在一个<code class="fe me mf mg mh b">pipenv</code>环境中工作，您可以简单地使用下面的命令。</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="d26f" class="mq lc iq mh b gy mr ms l mt mu">pip install flask<br/>pip install flask-restplus</span></pre><h1 id="3a6e" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">基础</h1><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mv"><img src="../Images/242a9abd82907a2e174d5a01eb9fbe94.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*M_qMn9i4IbZsXB25"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@aaronburden?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Aaron Burden</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h2 id="a934" class="mq lc iq bd ld mw mx dn lh my mz dp ll ko na nb lp ks nc nd lt kw ne nf lx ng bi translated">导入</h2><p id="3852" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我开始是从<code class="fe me mf mg mh b">flask</code>进口<code class="fe me mf mg mh b">Flask</code>。从<code class="fe me mf mg mh b">flask_restplus</code>中，我导入了<code class="fe me mf mg mh b">Api</code>来定义 app 和<code class="fe me mf mg mh b">Resource</code>，后者作为参数被接收到项目中定义的各个类中。</p><figure class="mi mj mk ml gt jr"><div class="bz fp l di"><div class="nh ni l"/></div></figure><h2 id="73cb" class="mq lc iq bd ld mw mx dn lh my mz dp ll ko na nb lp ks nc nd lt kw ne nf lx ng bi translated">定义应用程序</h2><p id="356b" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我使用方法<code class="fe me mf mg mh b">Flask()</code>将应用程序定义为 flask 应用程序，该方法使用<code class="fe me mf mg mh b">__name__</code>设置名称。接下来，我将使用<code class="fe me mf mg mh b">Api</code>来初始化应用程序。</p><figure class="mi mj mk ml gt jr"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="6d12" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我在这里定义了一个<code class="fe me mf mg mh b">namespace</code>。概念很简单。每当在给定的名称空间下定义 API 时，它们都会出现在 Swagger 中的给定标题下(我们将在本文后面探讨 Swagger)。在<code class="fe me mf mg mh b">namespace</code>中，第一个变量定义路径，第二个变量定义该空间的描述。</p><p id="4f3e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在上面的例子中，名称空间的 url 是<code class="fe me mf mg mh b">http://127.0.0.1:5000/main</code>，在 Swagger 中描述为<strong class="kf ir">主 API</strong>。</p><h2 id="cfdd" class="mq lc iq bd ld mw mx dn lh my mz dp ll ko na nb lp ks nc nd lt kw ne nf lx ng bi translated">定义 API</h2><p id="bfc1" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">最后，我定义了端点。由于我们的名称空间是<code class="fe me mf mg mh b">name_space</code>，我将通过 route 定义 url 为<code class="fe me mf mg mh b">@name_space.route("/")</code>。接下来，Flask-RESTPlus 要求我们定义一个类中给定路径下的所有端点。方法可以是<code class="fe me mf mg mh b">get()</code>、<code class="fe me mf mg mh b">put()</code>等等。</p><figure class="mi mj mk ml gt jr"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="4b10" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在上面的例子中，可以通过路径<code class="fe me mf mg mh b">http://127.0.0.1:5000/main</code>访问 API。类名设置为<code class="fe me mf mg mh b">MainClass</code>，有<code class="fe me mf mg mh b">get()</code>和<code class="fe me mf mg mh b">post()</code>两种方法。无论何时，当我进行 GET 调用时，我得到的回复是字段为<code class="fe me mf mg mh b">status</code>的<code class="fe me mf mg mh b">Got new data</code>，而对于 POST 调用，我得到的回复是<code class="fe me mf mg mh b">Posted new data</code>。</p><h2 id="6d51" class="mq lc iq bd ld mw mx dn lh my mz dp ll ko na nb lp ks nc nd lt kw ne nf lx ng bi translated">运行应用程序</h2><p id="4858" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">现在，一切都准备好了。文件保存为<a class="ae kc" href="https://github.com/kb22/Understanding-Flask-and-Flask-RESTPlus/blob/master/basic.py" rel="noopener ugc nofollow" target="_blank"> basic.py </a>。我使用<code class="fe me mf mg mh b">pipenv</code>通过以下命令运行应用程序。</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="b8f1" class="mq lc iq mh b gy mr ms l mt mu">pipenv shell<br/>FLASK_APP=basic.py flask run</span></pre><p id="5d29" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">使用 pip，您可以使用以下命令。</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="9b0d" class="mq lc iq mh b gy mr ms l mt mu">FLASK_APP=basic.py flask run</span></pre><h2 id="763a" class="mq lc iq bd ld mw mx dn lh my mz dp ll ko na nb lp ks nc nd lt kw ne nf lx ng bi translated">Swagger UI</h2><p id="801e" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">Flask-RESTPlus 最好的部分是它自动记录我们创建的 API，并且它们在 Swagger UI 中是可见的。转到<code class="fe me mf mg mh b">http://127.0.0.1:5000/</code>可以看到所有的 API。</p><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nj"><img src="../Images/0106bd1a9697fda09e23739e93a9d165.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8JdAypvSZ8bZneT_HfzPRg.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Swagger UI</figcaption></figure><p id="692f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这两个 API 都可以在名称空间<code class="fe me mf mg mh b">main</code>下看到，描述为<code class="fe me mf mg mh b">Main APIs</code>。我们可以通过点击<code class="fe me mf mg mh b">Try it out</code>按钮来尝试任一 API 并检查其功能。</p><h2 id="ea48" class="mq lc iq bd ld mw mx dn lh my mz dp ll ko na nb lp ks nc nd lt kw ne nf lx ng bi translated">尝试 API</h2><p id="b1d4" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我使用<a class="ae kc" href="https://curl.haxx.se/docs/manpage.html" rel="noopener ugc nofollow" target="_blank"> curl </a>从终端发出 GET 和 POST 请求。</p><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nk"><img src="../Images/7aa3231a52fea1f76955f03af1518d72.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_ZDjaHWl1CUl2kPJG4yygQ.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Making API Requests</figcaption></figure><p id="1522" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">使用<code class="fe me mf mg mh b">curl</code>命令时，首先使用单词<code class="fe me mf mg mh b">curl</code>，然后在字符<code class="fe me mf mg mh b">-X</code>后使用方法。最后，指定端点。看一下我们的 curl 响应，我们看到我收到了正确的<code class="fe me mf mg mh b">GET</code>和<code class="fe me mf mg mh b">POST</code>API 数据。</p><h1 id="cf58" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">更上一层楼</h1><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nl"><img src="../Images/9128e916224ba9d0bba6b128fffd8cbd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*aNnEryIs54sR0gec"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@markusspiske?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Markus Spiske</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="8b26" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Flask 和 Flask REST-Plus 还有更多功能。让我们更深入地探索它们，更好地理解它们。下面的代码在 GitHub 资源库中以<code class="fe me mf mg mh b"><a class="ae kc" href="https://github.com/kb22/Understanding-Flask-and-Flask-RESTPlus/blob/master/app.py" rel="noopener ugc nofollow" target="_blank">app.py</a></code>的名字提供。</p><p id="f8b5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以使用 POST 请求来发送数据并保存它。然后，我们可以使用 GET 请求来获取数据。假设我们有一个管理个人姓名并存储它们的项目。我们创建一个 GET 端点来使用<code class="fe me mf mg mh b">id</code>获取名称，创建一个 POST 端点来根据<code class="fe me mf mg mh b">id</code>保存名称。</p><p id="c4e8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在这里，我已经创建了路径为<code class="fe me mf mg mh b">http://127.0.0.1:5000/names/&lt;int:id&gt;</code>，在这里我们每次都会经过<code class="fe me mf mg mh b">id</code>。为了存储名字，我创建了一个对象<code class="fe me mf mg mh b">list_of_names</code>，用于获取和接收数据。</p><h2 id="4a23" class="mq lc iq bd ld mw mx dn lh my mz dp ll ko na nb lp ks nc nd lt kw ne nf lx ng bi translated">导入更多库</h2><p id="5695" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们已经导入了 Flask、Api 和资源。我们也从<code class="fe me mf mg mh b">flask</code>包中导入<code class="fe me mf mg mh b">request</code>。这有助于我们获得请求对象，然后从中检索信息，比如 JSON 数据。我们还从<code class="fe me mf mg mh b">flask_restplus</code>包中导入<code class="fe me mf mg mh b">fields</code>来定义元素的类型，比如<em class="nm">字符串</em>。</p><figure class="mi mj mk ml gt jr"><div class="bz fp l di"><div class="nh ni l"/></div></figure><h2 id="b42a" class="mq lc iq bd ld mw mx dn lh my mz dp ll ko na nb lp ks nc nd lt kw ne nf lx ng bi translated">添加申请信息</h2><p id="116e" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们还可以在 Flask 应用程序中添加额外的信息。这些信息非常有用，显示在 Swagger UI 中。</p><figure class="mi mj mk ml gt jr"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="10c3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以定义应用程序的<code class="fe me mf mg mh b">version</code>、<code class="fe me mf mg mh b">title</code>和<code class="fe me mf mg mh b">description</code>。我们只设置了一个名称空间，即<code class="fe me mf mg mh b">names</code>。Swagger UI 标题现在看起来如下图所示。</p><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nn"><img src="../Images/cb082c871e277aac0d9dab5aa0821f8b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*L-bXqBtnDiSjjqo-xY1FLg.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Swagger UI Header</figcaption></figure><h2 id="be64" class="mq lc iq bd ld mw mx dn lh my mz dp ll ko na nb lp ks nc nd lt kw ne nf lx ng bi translated">定义模型</h2><p id="1420" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">每当我们想要接收或发送特定格式(JSON)的信息时，我们都要借助<code class="fe me mf mg mh b">model</code>来完成。我们指定模型的名称。接下来，我们描述它期望的信息和每个期望值的属性。</p><figure class="mi mj mk ml gt jr"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="fc68" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们将型号名称定义为<code class="fe me mf mg mh b">Name Model</code>。它包括一个参数，即<code class="fe me mf mg mh b">name</code>，为必填字段，定义其描述和帮助文本。将使用这个模型的 API 将期待一个带有关键字<code class="fe me mf mg mh b">name</code>的 JSON。</p><figure class="mi mj mk ml gt jr"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="95c8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了跟踪所有的名字，我将它们存储在<code class="fe me mf mg mh b">list_of_names</code>中。</p><h2 id="b72e" class="mq lc iq bd ld mw mx dn lh my mz dp ll ko na nb lp ks nc nd lt kw ne nf lx ng bi translated">定义 API</h2><figure class="mi mj mk ml gt jr"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="3eb5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我们将上面的代码片段分解成更小的部分，以便更好地理解它。我们将探索<code class="fe me mf mg mh b">POST</code>端点。<code class="fe me mf mg mh b">GET</code>的功能将非常相似。</p><p id="d748" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">定义路线和等级</strong></p><figure class="mi mj mk ml gt jr"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="7fa9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们使用<code class="fe me mf mg mh b">name_space</code>命名空间来定义路由，即<code class="fe me mf mg mh b">http://127.0.0.1:5000/main/&lt;int:id&gt;</code>。它期望 Id 以整数形式发送。out 类的名称是<code class="fe me mf mg mh b">MainClass</code>，它有一个参数<code class="fe me mf mg mh b">Resource</code>。</p><p id="1fff" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">为 API 定义文档</strong></p><figure class="mi mj mk ml gt jr"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="61ab" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">使用<code class="fe me mf mg mh b">doc</code>,我们可以在 Swagger 中定义 API 的文档。<code class="fe me mf mg mh b">responses</code>键定义了各种可能的 HTTP 状态代码。对于每个状态代码，我们还定义了向用户描述它的文本。<code class="fe me mf mg mh b">params</code>键定义预期的参数。API 期望 URL 中有<code class="fe me mf mg mh b">id</code>，我们为用户指定一个帮助文本。Swagger UI 如下图所示。</p><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi no"><img src="../Images/d3f3bf72d19198e883cc7c96e6252aaf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*baDPFgFgx_-U71YuFEGgww.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">POST API (Swagger UI)</figcaption></figure><p id="3d1a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">参数在顶部定义。所有预期的响应及其描述出现在下半部分。</p><p id="c051" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">定义方法</strong></p><figure class="mi mj mk ml gt jr"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="aad7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们现在可以定义我们的方法了。在我们的方法之前，我们添加了行<code class="fe me mf mg mh b">expect(model)</code>，它定义了 API 期望的<code class="fe me mf mg mh b">model</code>。我们将代码包装在一个<code class="fe me mf mg mh b">try</code>块中，并捕捉所有可能发生的错误。<code class="fe me mf mg mh b">request.json['name]</code>获取我们收到的名称，我们可以保存它，并在响应中将其发送回去。如果<code class="fe me mf mg mh b">name</code>键丢失，我们得到<code class="fe me mf mg mh b">KeyError</code>并发送状态代码 500。在其他情况下，我们发送状态代码 400。</p><h2 id="2c40" class="mq lc iq bd ld mw mx dn lh my mz dp ll ko na nb lp ks nc nd lt kw ne nf lx ng bi translated">尝试应用程序</h2><p id="ef94" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">让我们启动应用程序。</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="45c6" class="mq lc iq mh b gy mr ms l mt mu">FLASK_APP=app.py flask run</span></pre><p id="59b4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir"> POST </strong> <br/>我们解析来自请求的响应，读取<code class="fe me mf mg mh b">name</code>并将它存储在<code class="fe me mf mg mh b">list_of_names</code>中的<code class="fe me mf mg mh b">id</code>中。我们还返回新添加人员的状态和姓名。</p><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi np"><img src="../Images/fa4dcacc45a72525f48d03336af696c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xmte7ixIxv5Ebv9xkUMRPw.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">POST Request with id = 1 and name = Karan Bhanot</figcaption></figure><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nq"><img src="../Images/04a0a0f489c4c7e5ac23009a0b2518cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tPqlvmN-_eX9j7Bu8Z_AZw.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Response of POST Request</figcaption></figure><p id="f3ab" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">发布请求中的错误</strong></p><p id="9e3e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">比方说，我们忘记了在数据对象中提供<code class="fe me mf mg mh b">name</code>参数。在这种情况下，我们会得到一个错误。</p><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nr"><img src="../Images/d2f4d22d34b5cdcd592acf60e5c3864e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JA5if8JWUxTgOTWN2wdRNg.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">POST without <strong class="bd ns">name</strong> key</figcaption></figure><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nt"><img src="../Images/a64adf2c334e010466cc4a892b1fe943.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mDb9m5d2eccwzoxVW3909Q.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">500 Error</figcaption></figure><p id="9dc8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">由于没有提供密钥<code class="fe me mf mg mh b">name</code>，我们收到了状态代码为 500 的错误和消息<code class="fe me mf mg mh b">Mapping key not found.</code></p><p id="0dd3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir"> GET </strong> <br/>我们只需传递我们想要获取其姓名的<code class="fe me mf mg mh b">id</code>，如果可用的话，我们将获取该人的状态和姓名。</p><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nt"><img src="../Images/8761d4427151e303713f4bbe7c1308b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*l6-9ElxO4qH4C0ZgFlI6Dw.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">GET Request with id = 1</figcaption></figure><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nq"><img src="../Images/6c058cdbecb84e0b9f165a424f6f7a76.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GI8M2h45tBLB73Tkh1FmIA.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Response of GET Request</figcaption></figure><p id="6592" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">获取请求时出错</strong></p><p id="cc28" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">比方说，我们没有人反对 Id 2。如果我们试图检索这些信息，它会抛出一个错误。</p><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi np"><img src="../Images/165e3cdb3545a23c4b11d7e20fdc1e77.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5t40IdIY9wV8g9LxrZYzjg.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">GET to fetch data against Id 2</figcaption></figure><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nt"><img src="../Images/17a10fe61c882cc61785d074891a5cd5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KbH85dAQ9WVs-2q52opdSA.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">500 Error</figcaption></figure><p id="120c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">由于没有找到那个特定的 Id，我们得到状态代码 500 和消息<code class="fe me mf mg mh b">Mapping key not found.</code></p><h1 id="5a01" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="806e" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">在本文中，我们探索了使用 Flask 和 Flask-RESTPlus 创建 API。这两个都是很好的开发库，可以用 Python 编写 API 文档，并使用 Swagger 与 API 进行交互。</p></div><div class="ab cl nu nv hu nw" role="separator"><span class="nx bw bk ny nz oa"/><span class="nx bw bk ny nz oa"/><span class="nx bw bk ny nz"/></div><div class="ij ik il im in"><p id="2867" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">请随时分享你的想法和想法。</p></div></div>    
</body>
</html>