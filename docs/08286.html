<html>
<head>
<title>Pandasâ€™ groupby explained in detail</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">ç†ŠçŒ«å°ç»„è¯¦ç»†è§£é‡Šäº†</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://towardsdatascience.com/pandas-groupby-aggregate-transform-filter-c95ba3444bbb?source=collection_archive---------0-----------------------#2019-11-12">https://towardsdatascience.com/pandas-groupby-aggregate-transform-filter-c95ba3444bbb?source=collection_archive---------0-----------------------#2019-11-12</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="4d85" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph">ç†ŠçŒ«ç»ˆææŒ‡å—</h2><div class=""/><div class=""><h2 id="ef23" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">äº†è§£å¦‚ä½•æŒæ¡æ‰€æœ‰ Pandas çš„ groupby åŠŸèƒ½ï¼Œå¦‚èšé›†ã€è½¬æ¢å’Œè¿‡æ»¤â€”â€”è¿™æ˜¯ä¸€ä»½é™„æœ‰å¤§é‡ç¤ºä¾‹çš„ä»£ç æŒ‡å—</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/7000bf860d83631838a8a7dd8fd1a5c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6d5dw6dPhy4vBp2vRW6uzw.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk"><a class="ae lh" href="https://www.economist.com/china/2016/09/08/survival-of-the-cutest" rel="noopener ugc nofollow" target="_blank">Source</a></figcaption></figure><p id="890c" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi me translated">å†™å…³äºç†ŠçŒ«çš„æ–‡ç« æ˜¯æœ€å¥½çš„ã€‚æˆ‘æœ€å–œæ¬¢çš„éƒ¨åˆ†æ˜¯å½“æˆ‘åœ¨ç½‘ä¸Šæœç´¢å¯çˆ±çš„ç†ŠçŒ«å›¾ç‰‡çš„æ—¶å€™ã€‚Cmon ä½ æ€ä¹ˆèƒ½ä¸çˆ±ç†ŠçŒ«å‘¢ï¼Ÿè¿˜æœ‰æˆç¾¤çš„ç†ŠçŒ«ï¼Œæ›´å¥½ï¼åæ­£æˆ‘è·‘é¢˜äº†â€¦</p></div><div class="ab cl mn mo hx mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="im in io ip iq"><h1 id="0d07" class="mu mv it bd mw mx my mz na nb nc nd ne ki nf kj ng kl nh km ni ko nj kp nk nl bi translated">ä»‹ç»</h1><p id="07cc" class="pw-post-body-paragraph li lj it lk b ll nm kd ln lo nn kg lq lr no lt lu lv np lx ly lz nq mb mc md im bi me translated">andas çš„ groupby æ— ç–‘æ˜¯ç†ŠçŒ«å¸¦æ¥çš„æœ€å¼ºå¤§çš„åŠŸèƒ½ä¹‹ä¸€ã€‚ç„¶è€Œï¼Œ<strong class="lk jd">å¤§å¤šæ•°ç”¨æˆ·åªåˆ©ç”¨äº†</strong> <code class="fe nr ns nt nu b"><strong class="lk jd">groupby</strong></code>çš„ä¸€å°éƒ¨åˆ†åŠŸèƒ½ã€‚</p><p id="164c" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><code class="fe nr ns nt nu b">Groupby</code>å…è®¸å¯¹æ•°æ®é›†é‡‡ç”¨æ‹†åˆ†-åº”ç”¨-ç»„åˆçš„æ–¹æ³•ã€‚è¿™ç§æ–¹æ³•é€šå¸¸ç”¨äºå¯¹æ•°æ®è¿›è¡Œåˆ†å‰²ï¼Œä»¥ä¾¿æ•°æ®åˆ†æå¸ˆå¯ä»¥å›ç­”ç‰¹å®šçš„é—®é¢˜ã€‚</p><h2 id="4f62" class="nv mv it bd mw nw nx dn na ny nz dp ne lr oa ob ng lv oc od ni lz oe of nk iz bi translated">åœ¨é«˜çº§åˆ†ç»„ä¸Šï¼Œby å…è®¸:</h2><ol class=""><li id="7302" class="og oh it lk b ll nm lo nn lr oi lv oj lz ok md ol om on oo bi translated">æ ¹æ®åˆ—/æ¡ä»¶å°†æ•°æ®åˆ†æˆç»„ï¼›</li><li id="4574" class="og oh it lk b ll op lo oq lr or lv os lz ot md ol om on oo bi translated">å¯¹æ‰€æœ‰ç»„åº”ç”¨å‡½æ•°/å˜æ¢ï¼Œå¹¶å°†ç»“æœç»„åˆæˆè¾“å‡º</li></ol><h2 id="4179" class="nv mv it bd mw nw nx dn na ny nz dp ne lr oa ob ng lv oc od ni lz oe of nk iz bi translated">åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†è®¨è®ºä»¥ä¸‹ä¸»é¢˜:</h2><ol class=""><li id="3bd1" class="og oh it lk b ll nm lo nn lr oi lv oj lz ok md ol om on oo bi translated"><a class="ae lh" href="#08dc" rel="noopener ugc nofollow">åŠ è½½æ•°æ®</a></li><li id="fc9a" class="og oh it lk b ll op lo oq lr or lv os lz ot md ol om on oo bi translated"><a class="ae lh" href="#3a1f" rel="noopener ugc nofollow">åˆ†ç»„ä¾æ®â€”æ‹†åˆ†æ•°æ®</a></li><li id="f9f2" class="og oh it lk b ll op lo oq lr or lv os lz ot md ol om on oo bi translated"><a class="ae lh" href="#d6c9" rel="noopener ugc nofollow">åº”ç”¨å¹¶ç»„åˆâ€” </a> <code class="fe nr ns nt nu b"><a class="ae lh" href="#d6c9" rel="noopener ugc nofollow">apply</a></code> <a class="ae lh" href="#d6c9" rel="noopener ugc nofollow">ï¼Œ</a> <code class="fe nr ns nt nu b"><a class="ae lh" href="#d6c9" rel="noopener ugc nofollow">agg(regate)</a></code> <a class="ae lh" href="#d6c9" rel="noopener ugc nofollow">ï¼Œ</a> <code class="fe nr ns nt nu b"><a class="ae lh" href="#d6c9" rel="noopener ugc nofollow">transform</a></code> <a class="ae lh" href="#d6c9" rel="noopener ugc nofollow">ï¼Œ</a> <code class="fe nr ns nt nu b"><a class="ae lh" href="#d6c9" rel="noopener ugc nofollow">filter</a></code></li></ol><p id="47d3" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">ä½ å¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°å®Œæ•´çš„ Jupyter ç¬”è®°æœ¬ã€‚ä½†æ˜¯æˆ‘å¼ºçƒˆå»ºè®®æ‚¨äº²è‡ªå®Œæˆè¿™äº›æ­¥éª¤ã€‚æ¯•ç«Ÿï¼Œç†Ÿèƒ½ç”Ÿå·§ã€‚</p></div><div class="ab cl mn mo hx mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="im in io ip iq"><h1 id="08dc" class="mu mv it bd mw mx my mz na nb nc nd ne ki nf kj ng kl nh km ni ko nj kp nk nl bi translated">â‘ åŠ è½½æ•°æ®</h1><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ou"><img src="../Images/9d43ec413213993003f79a19ec4bde88.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*UlhZFIMA35p62wGP"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk">Photo by <a class="ae lh" href="https://unsplash.com/@nasa?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">NASA</a> on <a class="ae lh" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="696f" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi me translated">æˆ‘ä»¬å°†ä½¿ç”¨ä¸€ä¸ªå‡è®¾çš„é”€å”®éƒ¨é—¨çš„æ•°æ®ã€‚æ•°æ®é›†ç”±è™šæ„çš„é”€å”®ä»£è¡¨ã€è®¢å•çº¿ç´¢ã€å¯èƒ½è¾¾æˆäº¤æ˜“çš„å…¬å¸ã€è®¢å•ä»·å€¼å’Œçº¿ç´¢æ—¥æœŸç­‰åˆ—ç»„æˆã€‚</p><pre class="ks kt ku kv gt ov nu ow ox aw oy bi"><span id="7f21" class="nv mv it nu b gy oz pa l pb pc">order_leads = pd.read_csv(<br/>    '<a class="ae lh" href="https://raw.githubusercontent.com/FBosler/Medium-Data-Exploration/master/order_leads.csv'" rel="noopener ugc nofollow" target="_blank">https://raw.githubusercontent.com/FBosler/Medium-Data-Exploration/master/order_leads.csv'</a>,<br/>    parse_dates = [3]<br/>)<br/>sales_team = pd.read_csv(<br/>    '<a class="ae lh" href="https://raw.githubusercontent.com/FBosler/Medium-Data-Exploration/master/sales_team.csv'" rel="noopener ugc nofollow" target="_blank">https://raw.githubusercontent.com/FBosler/Medium-Data-Exploration/master/sales_team.csv'</a>,<br/>    parse_dates = [3]<br/>)</span><span id="792a" class="nv mv it nu b gy pd pa l pb pc">df = pd.merge(<br/>  order_leads,<br/>  sales_team,<br/>  on=['Company Id','Company Name']<br/>)</span><span id="3ad0" class="nv mv it nu b gy pd pa l pb pc">df = df.rename(<br/>  columns={'Order Value':'Val','Converted':'Sale'}<br/>)</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi pe"><img src="../Images/5b4b5e8b95d7ca4e44a3789ecc63809d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xdVezf0wUdENHwU3oFK3lw.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk">100k rows of order lead data</figcaption></figure></div><div class="ab cl mn mo hx mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="im in io ip iq"><h1 id="3a1f" class="mu mv it bd mw mx my mz na nb nc nd ne ki nf kj ng kl nh km ni ko nj kp nk nl bi translated">â‘¡åˆ†ç»„ä¾æ®â€”â€”æ‹†åˆ†æ•°æ®</h1><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi pf"><img src="../Images/629e6ee302d9f1441656d4eafab1c246.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XBETIXH-vrY2xgTxvoSDMQ.jpeg"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk">Photo by <a class="ae lh" href="https://unsplash.com/@chris23?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Chris Child</a> on <a class="ae lh" href="https://unsplash.com/s/photos/splitting-wood?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="bc58" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi me translated">è°ƒç”¨ groupby çš„é»˜è®¤æ–¹æ³•æ˜¯é€šè¿‡æ˜¾å¼æä¾›ä¸€ä¸ªåˆ—åæ¥æ‹†åˆ†æ•°æ®é›†ã€‚ä½†æ˜¯ï¼Œè¿˜æœ‰ä¸€ç‚¹ä¸å¤ªä¸ºäººæ‰€çŸ¥ï¼Œé‚£å°±æ˜¯æ‚¨ä¹Ÿå¯ä»¥å°†ä¸€ä¸ªç³»åˆ—ä¼ é€’ç»™ groupbyã€‚å”¯ä¸€çš„é™åˆ¶æ˜¯åºåˆ—çš„é•¿åº¦ä¸æ•°æ®å¸§çš„é•¿åº¦ç›¸åŒã€‚<br/>èƒ½å¤Ÿä¼ é€’ä¸€ä¸ªåºåˆ—æ„å‘³ç€æ‚¨å¯ä»¥æ ¹æ®ä¸€ä¸ªåˆ—çš„å¤„ç†ç‰ˆæœ¬è¿›è¡Œåˆ†ç»„ï¼Œè€Œä¸å¿…ä¸ºæ­¤åˆ›å»ºä¸€ä¸ªæ–°çš„å¸®åŠ©åˆ—ã€‚</p><h2 id="d4c6" class="nv mv it bd mw nw nx dn na ny nz dp ne lr oa ob ng lv oc od ni lz oe of nk iz bi translated">æŒ‰é”€å”®ä»£è¡¨åˆ†ç»„</h2><p id="69c3" class="pw-post-body-paragraph li lj it lk b ll nm kd ln lo nn kg lq lr no lt lu lv np lx ly lz nq mb mc md im bi translated">é¦–å…ˆï¼Œè®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªåˆ†ç»„çš„æ•°æ®æ¡†æ¶ï¼Œå³å°†æ•°æ®é›†æ‹†åˆ†ã€‚</p><pre class="ks kt ku kv gt ov nu ow ox aw oy bi"><span id="ad01" class="nv mv it nu b gy oz pa l pb pc"><strong class="nu jd">IN:</strong><br/>grouped = df.groupby('Sales Rep')<br/>grouped</span><span id="4f3b" class="nv mv it nu b gy pd pa l pb pc"><strong class="nu jd">OUT:<br/></strong>&lt;pandas.core.groupby.generic.DataFrameGroupBy object at 0x12464a160&gt;</span><span id="ff60" class="nv mv it nu b gy pd pa l pb pc"><strong class="nu jd">IN:<br/></strong>type(grouped)</span><span id="5596" class="nv mv it nu b gy pd pa l pb pc"><strong class="nu jd">OUT:<br/></strong>pandas.core.groupby.generic.DataFrameGroupBy</span></pre><p id="b580" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">æˆ‘ä»¬ç°åœ¨å·²ç»åˆ›å»ºäº†ä¸€ä¸ª<code class="fe nr ns nt nu b"><strong class="lk jd">DataFrameGroupBy</strong></code>å¯¹è±¡ã€‚è®©æˆ‘ä»¬è¿›ä¸€æ­¥è°ƒæŸ¥:</p><h2 id="0a81" class="nv mv it bd mw nw nx dn na ny nz dp ne lr oa ob ng lv oc od ni lz oe of nk iz bi translated">æ˜¾ç¤ºæ‰€æœ‰ç»„</h2><p id="d092" class="pw-post-body-paragraph li lj it lk b ll nm kd ln lo nn kg lq lr no lt lu lv np lx ly lz nq mb mc md im bi translated">åœ¨åˆ†ç»„å¯¹è±¡ä¸Šè°ƒç”¨<code class="fe nr ns nt nu b">groups</code>ä¼šè¿”å›æ¯ä¸ªç»„çš„ç´¢å¼•åˆ—è¡¨(å› ä¸ºæ¯ä¸€è¡Œéƒ½å¯ä»¥é€šè¿‡å…¶ç´¢å¼•å”¯ä¸€åœ°æ ‡è¯†)</p><pre class="ks kt ku kv gt ov nu ow ox aw oy bi"><span id="0943" class="nv mv it nu b gy oz pa l pb pc"><strong class="nu jd">IN:<br/></strong>grouped.groups</span><span id="a20f" class="nv mv it nu b gy pd pa l pb pc"><strong class="nu jd">OUT:<br/></strong>{<br/><strong class="nu jd">'Aaron Hendrickson'</strong>: Int64Index(<br/>[25612, 25613, 25614, 25615, 25616, 25617, 25618, 25619, 25620, 25621,..., 25894, 25895, 25896, 25897, 25898, 25899, 25900, 25901, 25902, 25903], dtype='int64', length=292<br/>),</span><span id="ec2f" class="nv mv it nu b gy pd pa l pb pc"><strong class="nu jd">'Adam Sawyer'</strong>: Int64Index(<br/>[67140, 67141, 67142, 67143, 67144, 67145, 67146, 67147, 67148, 67149, ..., 67454, 67455, 67456, 67457, 67458, 67459, 67460, 67461, 67462, 67463], dtype='int64', length=324<br/>),</span><span id="27b3" class="nv mv it nu b gy pd pa l pb pc"><strong class="nu jd">...</strong></span><span id="0e58" class="nv mv it nu b gy pd pa l pb pc"><strong class="nu jd">'Yvonne Lindsey'</strong>: Int64Index([20384, 20385, 20386, 20387, 20388, 20389, 20390, 20391, 20392, 20393, 20394, 20395, 20396, 20397, 20398, 20399, 20400, 20401, ... , 20447, 20448, 20449, 20450], dtype='int64', length=67)<br/>}</span></pre><h2 id="c01f" class="nv mv it bd mw nw nx dn na ny nz dp ne lr oa ob ng lv oc od ni lz oe of nk iz bi translated">é€‰æ‹©ç‰¹å®šçš„ç»„</h2><p id="9489" class="pw-post-body-paragraph li lj it lk b ll nm kd ln lo nn kg lq lr no lt lu lv np lx ly lz nq mb mc md im bi translated">é€šè¿‡ç”¨ç»„åè°ƒç”¨<code class="fe nr ns nt nu b">get_group</code>ï¼Œæˆ‘ä»¬å¯ä»¥è¿”å›å„è‡ªçš„æ•°æ®å­é›†ã€‚</p><pre class="ks kt ku kv gt ov nu ow ox aw oy bi"><span id="624f" class="nv mv it nu b gy oz pa l pb pc">grouped.get_group('Aaron Hendrickson')</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi pg"><img src="../Images/f1109d380358bccb613aa9e256402704.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Drwub3OL7kekJ-V921Svkw.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk">â€˜Aaron Hendricksonâ€™ group</figcaption></figure></div><div class="ab cl mn mo hx mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="im in io ip iq"><p id="e560" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">ä¸ºäº†æ¼”ç¤ºä¸€äº›é«˜çº§åˆ†ç»„åŠŸèƒ½ï¼Œæˆ‘ä»¬å°†é€šè¿‡<code class="fe nr ns nt nu b">size</code>æ–¹æ³•ä½¿ç”¨ apply æ­¥éª¤çš„æœ€ç®€å•ç‰ˆæœ¬(å¹¶è®¡ç®—æ¯ä¸ªç»„ä¸­çš„è¡Œæ•°)ã€‚æˆ‘ä»¬è¿™æ ·åšæ˜¯ä¸ºäº†å°†é‡ç‚¹æ”¾åœ¨ groupby æ“ä½œä¸Šã€‚</p><p id="8b7d" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">æˆ‘ä»¬å°†åœ¨æ–‡ç« çš„ç¬¬ 2 éƒ¨åˆ†æ›´è¯¦ç»†åœ°è®¨è®ºåº”ç”¨æ–¹æ³•ã€‚</p><h2 id="b73f" class="nv mv it bd mw nw nx dn na ny nz dp ne lr oa ob ng lv oc od ni lz oe of nk iz bi translated">è®¡ç®—æ¯ç»„ä¸­çš„è¡Œæ•°</h2><pre class="ks kt ku kv gt ov nu ow ox aw oy bi"><span id="1666" class="nv mv it nu b gy oz pa l pb pc"><strong class="nu jd">IN:<br/></strong>grouped.size()</span><span id="5f7f" class="nv mv it nu b gy pd pa l pb pc"><strong class="nu jd">OUT:<br/></strong>Sales Rep<br/>Aaron Hendrickson    292<br/>Adam Sawyer          324<br/>Adele Kimmel         115<br/>Adrian Daugherty     369<br/>Adrianna Shelton      37<br/>                    ... <br/>Willie Lin            44<br/>Willie Rau            95<br/>Willie Sanchez       309<br/>Yvonne Jones          74<br/>Yvonne Lindsey        67<br/>Length: 499, dtype: int64</span></pre><h2 id="b084" class="nv mv it bd mw nw nx dn na ny nz dp ne lr oa ob ng lv oc od ni lz oe of nk iz bi translated">æŒ‰é”€å”®ä»£è¡¨çš„åå­—åˆ†ç»„</h2><p id="074d" class="pw-post-body-paragraph li lj it lk b ll nm kd ln lo nn kg lq lr no lt lu lv np lx ly lz nq mb mc md im bi translated">ä¸‹é¢æ˜¯ç¬¬ä¸€ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬æ ¹æ®ä¸€ä¸ªç°æœ‰åˆ—çš„å˜åŒ–è¿›è¡Œåˆ†ç»„ã€‚æˆ‘å‘ç°è¿™æ¯”ä¸€ç›´åˆ›å»ºåŠ©æ‰‹åˆ—æœ‰äº†å¾ˆå¤§çš„æ”¹è¿›ã€‚å®ƒåªæ˜¯è®©æ•°æ®æ›´å¹²å‡€ã€‚</p><p id="1a66" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªå­—ç¬¦ä¸²è®¿é—®å™¨æ¥æ£€ç´¢åå­—ã€‚ä½ å¯ä»¥åœ¨è¿™é‡Œé˜…è¯»è®¿é—®å™¨<a class="ae lh" rel="noopener" target="_blank" href="/learn-advanced-features-for-pythons-main-data-analysis-library-in-20-minutes-d0eedd90d086#cfea"/>ã€‚</p><pre class="ks kt ku kv gt ov nu ow ox aw oy bi"><span id="8e84" class="nv mv it nu b gy oz pa l pb pc"><strong class="nu jd">IN:</strong><br/>df.groupby(<br/>  df['Sales Rep'].str.split(' ').str[0]<br/>).size()</span><span id="a7c4" class="nv mv it nu b gy pd pa l pb pc"><strong class="nu jd">OUT:<br/></strong>Sales Rep<br/>Aaron        292<br/>Adam         324<br/>Adele        115<br/>Adrian       369<br/>Adrianna      37<br/>            ... <br/>Wesley       144<br/>Wilbert      213<br/>William     1393 <strong class="nu jd"><em class="ph"># Plenty of Williams</em></strong><br/>Willie       448<br/>Yvonne       141<br/>Length: 318, dtype: int64</span></pre><h2 id="8e5e" class="nv mv it bd mw nw nx dn na ny nz dp ne lr oa ob ng lv oc od ni lz oe of nk iz bi translated">æ ¹æ®ä»£è¡¨å§“åä¸­æ˜¯å¦æœ‰â€œWilliamâ€è¿›è¡Œåˆ†ç»„</h2><p id="5246" class="pw-post-body-paragraph li lj it lk b ll nm kd ln lo nn kg lq lr no lt lu lv np lx ly lz nq mb mc md im bi translated">æˆ‘ä»¬çœ‹åˆ°ä¼¼ä¹æœ‰å¾ˆå¤š Williamsï¼Œè®©æˆ‘ä»¬å°†æ‰€æœ‰åå­—ä¸­æœ‰ William çš„é”€å”®ä»£è¡¨åˆ†ç»„ã€‚</p><pre class="ks kt ku kv gt ov nu ow ox aw oy bi"><span id="ef91" class="nv mv it nu b gy oz pa l pb pc"><strong class="nu jd">IN:<br/></strong>df.groupby(<br/>  df['Sales Rep'].apply(lambda x: 'William' in x)<br/>).size()</span><span id="a817" class="nv mv it nu b gy pd pa l pb pc"><strong class="nu jd">OUT:<br/></strong>Sales Rep<br/>False    97111<br/>True      2889<br/>dtype: int64</span></pre><h2 id="149d" class="nv mv it bd mw nw nx dn na ny nz dp ne lr oa ob ng lv oc od ni lz oe of nk iz bi translated">æŒ‰éšæœºç³»åˆ—åˆ†ç»„(ä»…ä¾›è¯´æ˜)</h2><p id="b9be" class="pw-post-body-paragraph li lj it lk b ll nm kd ln lo nn kg lq lr no lt lu lv np lx ly lz nq mb mc md im bi translated">ä¸å¯å¦è®¤ï¼Œè¿™ä¸ªä¾‹å­å¾ˆå‚»ï¼Œä½†æ˜¯å®ƒè¯´æ˜äº†ä½ å¯ä»¥å¾ˆå¥½åœ°æŒ‰ç…§ä»»æ„åºåˆ—è¿›è¡Œåˆ†ç»„ã€‚</p><pre class="ks kt ku kv gt ov nu ow ox aw oy bi"><span id="7060" class="nv mv it nu b gy oz pa l pb pc"><strong class="nu jd">IN:<br/></strong>df.groupby(<br/>    pd.Series(np.random.choice(list('ABCDG'),len(df)))<br/>).size()</span><span id="fa9c" class="nv mv it nu b gy pd pa l pb pc"><strong class="nu jd">OUT:<br/></strong>A    19895<br/>B    20114<br/>C    19894<br/>D    20108<br/>G    19989<br/>dtype: int64</span></pre><h2 id="0950" class="nv mv it bd mw nw nx dn na ny nz dp ne lr oa ob ng lv oc od ni lz oe of nk iz bi translated">é€šè¿‡ä¸‰ä¸ªå‡åŒ€åˆ‡å‰²çš„â€œValâ€æ¡¶è¿›è¡Œåˆ†ç»„</h2><p id="8281" class="pw-post-body-paragraph li lj it lk b ll nm kd ln lo nn kg lq lr no lt lu lv np lx ly lz nq mb mc md im bi translated">åœ¨ä¸‹é¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆå°†<code class="fe nr ns nt nu b">qcut</code>åº”ç”¨äºä¸€ä¸ªæ•°å­—åˆ—ã€‚<code class="fe nr ns nt nu b">qcut</code>å°†æ•°æ®å¹³å‡åˆ†é…åˆ°å›ºå®šæ•°é‡çš„ç®±ä¸­ã€‚</p><pre class="ks kt ku kv gt ov nu ow ox aw oy bi"><span id="7dd5" class="nv mv it nu b gy oz pa l pb pc"><strong class="nu jd">IN:</strong><br/>df.groupby(<br/>  pd.qcut(<br/>    x=df['Val'],<br/>    q=3,<br/>    labels=['low','mid','high']<br/>  )<br/>).size()</span><span id="9b48" class="nv mv it nu b gy pd pa l pb pc"><strong class="nu jd">OUT:<br/></strong>Val<br/>low     33339<br/>mid     33336<br/>high    33325<br/>dtype: int64</span></pre><h2 id="206a" class="nv mv it bd mw nw nx dn na ny nz dp ne lr oa ob ng lv oc od ni lz oe of nk iz bi translated">æŒ‰å®šåˆ¶å¤§å°çš„â€œæœ‰å€¼â€å­˜å‚¨æ¡¶åˆ†ç»„</h2><p id="1318" class="pw-post-body-paragraph li lj it lk b ll nm kd ln lo nn kg lq lr no lt lu lv np lx ly lz nq mb mc md im bi translated">åƒå‰é¢çš„ä¾‹å­ä¸€æ ·ï¼Œæˆ‘ä»¬å°†æ•°æ®åˆ†é…åˆ°æ¡¶ä¸­ã€‚ç„¶è€Œï¼Œè¿™ä¸€æ¬¡æˆ‘ä»¬ä¹ŸæŒ‡å®šäº†å®¹å™¨çš„è¾¹ç•Œã€‚</p><pre class="ks kt ku kv gt ov nu ow ox aw oy bi"><span id="7530" class="nv mv it nu b gy oz pa l pb pc"><strong class="nu jd">IN:</strong><br/>df.groupby(<br/>  pd.cut(<br/>    df['Val'],<br/>    [0,3000,5000,7000,10000]<br/>  )<br/>).size()</span><span id="0410" class="nv mv it nu b gy pd pa l pb pc"><strong class="nu jd">OUT:<br/></strong>Val<br/>(0, 3000]        29220<br/>(3000, 5000]     19892<br/>(5000, 7000]     20359<br/>(7000, 10000]    30529<br/>dtype: int64</span></pre><h1 id="3410" class="mu mv it bd mw mx pi mz na nb pj nd ne ki pk kj ng kl pl km ni ko pm kp nk nl bi translated"><code class="fe nr ns nt nu b">pd.Grouper</code></h1><p id="c98a" class="pw-post-body-paragraph li lj it lk b ll nm kd ln lo nn kg lq lr no lt lu lv np lx ly lz nq mb mc md im bi translated"><code class="fe nr ns nt nu b"><strong class="lk jd">pd.Grouper</strong></code>é‡è¦ï¼è¿™ä¸ªæ–¹æ³•èŠ±äº†æˆ‘å¾ˆé•¿æ—¶é—´æ‰å­¦ä¼šï¼Œå› ä¸ºå®ƒåœ¨å¤„ç†æ—¶é—´åºåˆ—æ•°æ®æ—¶éå¸¸æœ‰ç”¨ã€‚</p><h2 id="8952" class="nv mv it bd mw nw nx dn na ny nz dp ne lr oa ob ng lv oc od ni lz oe of nk iz bi translated">æŒ‰å¹´ä»½åˆ†ç»„</h2><p id="437b" class="pw-post-body-paragraph li lj it lk b ll nm kd ln lo nn kg lq lr no lt lu lv np lx ly lz nq mb mc md im bi translated">åœ¨ä¸‹é¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨<code class="fe nr ns nt nu b">pd.Grouper(key=&lt;INPUT COLUMN&gt;, freq=&lt;DESIRED FREQUENCY&gt;)</code>æ ¹æ®æŒ‡å®šåˆ—çš„æŒ‡å®šé¢‘ç‡å¯¹æ•°æ®è¿›è¡Œåˆ†ç»„ã€‚åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œé¢‘ç‡æ˜¯<code class="fe nr ns nt nu b">'Y'</code>ï¼Œç›¸å…³åˆ—æ˜¯<code class="fe nr ns nt nu b">'Date'</code>ã€‚</p><pre class="ks kt ku kv gt ov nu ow ox aw oy bi"><span id="da31" class="nv mv it nu b gy oz pa l pb pc"><strong class="nu jd">IN:</strong><br/>df.groupby(<br/>  pd.Grouper(<br/>    key='Date',<br/><strong class="nu jd">    </strong>freq='Y'<strong class="nu jd"><br/>  </strong>)<br/>).size()</span><span id="0cee" class="nv mv it nu b gy pd pa l pb pc"><strong class="nu jd">OUT:<br/></strong>Date<br/>2014-12-31    19956<br/>2015-12-31    20054<br/>2016-12-31    20133<br/>2017-12-31    20079<br/>2018-12-31    19778<br/>Freq: A-DEC, dtype: int64</span></pre><h2 id="46ac" class="nv mv it bd mw nw nx dn na ny nz dp ne lr oa ob ng lv oc od ni lz oe of nk iz bi translated">æŒ‰å››åˆ†ä¹‹ä¸€æˆ–å…¶ä»–é¢‘ç‡åˆ†ç»„</h2><p id="5940" class="pw-post-body-paragraph li lj it lk b ll nm kd ln lo nn kg lq lr no lt lu lv np lx ly lz nq mb mc md im bi translated">ä»£æ›¿<code class="fe nr ns nt nu b">'Y'</code>ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸åŒçš„æ ‡å‡†é¢‘ç‡ï¼Œå¦‚<code class="fe nr ns nt nu b">'D','W','M', or 'Q'</code>ã€‚æœ‰å…³ä¸å¸¸ç”¨é¢‘ç‡çš„åˆ—è¡¨ï¼Œè¯·æŸ¥é˜…<a class="ae lh" href="http://pandas.pydata.org/pandas-docs/stable/user_guide/timeseries.html#offset-aliases" rel="noopener ugc nofollow" target="_blank">æ–‡æ¡£</a>ã€‚<br/>æˆ‘å‘ç°<code class="fe nr ns nt nu b">'SM'</code>çš„åŠæœˆæœ«é¢‘ç‡(15 æ—¥å’Œæœˆæœ«)æ˜¯ä¸€ä¸ªæœ‰è¶£çš„é¢‘ç‡ã€‚</p><pre class="ks kt ku kv gt ov nu ow ox aw oy bi"><span id="61e2" class="nv mv it nu b gy oz pa l pb pc"><strong class="nu jd">IN:</strong><br/>df.groupby(pd.Grouper(key='Date',freq='Q')).size()</span><span id="166d" class="nv mv it nu b gy pd pa l pb pc"><strong class="nu jd">OUT:<br/></strong>Date<br/>2014-03-31    4949<br/>2014-06-30    4948<br/>2014-09-30    4986<br/>2014-12-31    5073<br/>2015-03-31    4958<br/>2015-06-30    4968<br/>2015-09-30    5109<br/>2015-12-31    5019<br/>2016-03-31    5064<br/>2016-06-30    4892<br/>2016-09-30    5148<br/>2016-12-31    5029<br/>2017-03-31    4959<br/>2017-06-30    5102<br/>2017-09-30    5077<br/>2017-12-31    4941<br/>2018-03-31    4889<br/>2018-06-30    4939<br/>2018-09-30    4975<br/>2018-12-31    4975<br/>Freq: Q-DEC, dtype: int64</span></pre><h2 id="ef1c" class="nv mv it bd mw nw nx dn na ny nz dp ne lr oa ob ng lv oc od ni lz oe of nk iz bi translated">æŒ‰å¤šåˆ—åˆ†ç»„</h2><p id="8aec" class="pw-post-body-paragraph li lj it lk b ll nm kd ln lo nn kg lq lr no lt lu lv np lx ly lz nq mb mc md im bi translated">åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬åªæŒ‰ä¸€ä¸ªåˆ—æˆ–è½¬æ¢è¿›è¡Œäº†åˆ†ç»„ã€‚å½“æˆ‘ä»¬æƒ³è¦é€šè¿‡å¤šä¸ªåˆ—æˆ–è½¬æ¢è¿›è¡Œåˆ†ç»„æ—¶ï¼ŒåŒæ ·çš„é€»è¾‘ä¹Ÿé€‚ç”¨ã€‚æˆ‘ä»¬è¦åšçš„å°±æ˜¯ä¼ é€’ä¸€ä¸ªåˆ—è¡¨ç»™<code class="fe nr ns nt nu b">groupby</code>ã€‚</p><pre class="ks kt ku kv gt ov nu ow ox aw oy bi"><span id="d853" class="nv mv it nu b gy oz pa l pb pc"><strong class="nu jd">IN:</strong><br/>df.groupby(['Sales Rep','Company Name']).size()</span><span id="53ef" class="nv mv it nu b gy pd pa l pb pc"><strong class="nu jd">OUT:<br/></strong>Sales Rep          Company Name               <br/>Aaron Hendrickson  6-Foot Homosexuals             20<br/>                   63D House'S                    27<br/>                   Angular Liberalism             28<br/>                   Boon Blish'S                   18<br/>                   Business-Like Structures       21<br/>                                                  ..<br/>Yvonne Jones       Entry-Limiting Westinghouse    20<br/>                   Intractable Fairgoers          18<br/>                   Smarter Java                   17<br/>Yvonne Lindsey     Meretricious Fabrication       28<br/>                   Shrill Co-Op                   39<br/>Length: 4619, dtype: int64</span></pre><p id="95ed" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">éšæœºçš„åå­—ï¼Œæˆ‘å‘èª“ï¼</p></div><div class="ab cl mn mo hx mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="im in io ip iq"><h1 id="d6c9" class="mu mv it bd mw mx my mz na nb nc nd ne ki nf kj ng kl nh km ni ko nj kp nk nl bi translated">â‘¢åº”ç”¨å¹¶ç»„åˆâ€” <code class="fe nr ns nt nu b">apply</code>ã€<code class="fe nr ns nt nu b">agg(regate)</code>ã€<code class="fe nr ns nt nu b">transform</code>å’Œ<code class="fe nr ns nt nu b">filter</code></h1><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi pn"><img src="../Images/cdbc2734991f15300c0723ace0233ea1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ybLDn8JZ0u8ysrIY8pAyDw.jpeg"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk">Photo by <a class="ae lh" href="https://unsplash.com/@andrewwelch3?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">andrew welch</a> on <a class="ae lh" href="https://unsplash.com/s/photos/glue-together?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="ed14" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi me translated"><span class="l mf mg mh bm mi mj mk ml mm di">åœ¨å‰é¢çš„ç« èŠ‚ä¸­ï¼Œæˆ‘ä»¬è®¨è®ºäº†å¦‚ä½•æ ¹æ®å„ç§æ¡ä»¶å¯¹æ•°æ®è¿›è¡Œåˆ†ç»„ã€‚æœ¬èŠ‚è®¨è®ºåœ¨å°†å®ƒä»¬ç»„åˆæˆæœ€ç»ˆç»“æœä¹‹å‰ï¼Œæˆ‘ä»¬å¯ä»¥åº”ç”¨äºè¿™äº›ç»„çš„å¯ç”¨å‡½æ•°ã€‚</span></p><h2 id="3867" class="nv mv it bd mw nw nx dn na ny nz dp ne lr oa ob ng lv oc od ni lz oe of nk iz bi translated">æœ¬èŠ‚å›´ç»•å¦‚ä½•ä½¿ç”¨</h2><p id="04c1" class="pw-post-body-paragraph li lj it lk b ll nm kd ln lo nn kg lq lr no lt lu lv np lx ly lz nq mb mc md im bi translated">ğŸ… <code class="fe nr ns nt nu b">apply</code>ã€<br/> ğŸ…‘ <code class="fe nr ns nt nu b">agg(regate)</code>ã€<br/> ğŸ…’ <code class="fe nr ns nt nu b">transform</code>ã€<br/> ğŸ…“ <code class="fe nr ns nt nu b">filter</code></p><p id="b251" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">å¦‚æœä½ åœ¨æˆ‘å¼€å§‹ä½¿ç”¨ groupby æ—¶å’Œæˆ‘ä¸€æ ·ï¼Œä½ å¯èƒ½æ­£åœ¨ä½¿ç”¨ğŸ…å’ŒğŸ…‘çš„ç»„åˆï¼Œå¤§è‡´å¦‚ä¸‹:</p><pre class="ks kt ku kv gt ov nu ow ox aw oy bi"><span id="bec7" class="nv mv it nu b gy oz pa l pb pc">grouped = df.groupby('GROUP') and then:<br/>- group.apply(mean)<br/>- group.agg(mean)<br/>- group['INTERSTING COLUMN'].apply(mean)<br/>- group.agg({'INTERSTING COLUMN':mean})<br/>- group.mean()</span></pre><p id="2e3f" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">å…¶ä¸­<code class="fe nr ns nt nu b">mean</code>ä¹Ÿå¯ä»¥æ˜¯å¦ä¸€ä¸ªå‡½æ•°ã€‚</p><p id="64ca" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">å¥½æ¶ˆæ¯æ˜¯ï¼Œå®ƒä»¬å…¨éƒ½æœ‰æ•ˆã€‚å¤§å¤šæ•°æ—¶å€™ï¼Œç»“æœä¼šå’Œä½ é¢„æœŸçš„å·®ä¸å¤šã€‚</p><p id="e2dc" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">åæ¶ˆæ¯:apply å’Œ agg éƒ½æœ‰å€¼å¾—æ·±ç©¶çš„ç»†å¾®å·®åˆ«ã€‚</p><p id="2621" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">æ­¤å¤–ï¼Œæ›´é‡è¦çš„æ˜¯ï¼Œä¸¤ä¸ªé²œä¸ºäººçŸ¥çš„å¼ºå¤§åŠŸèƒ½å¯ä»¥ç”¨åœ¨ä¸€ä¸ªåˆ†ç»„å¯¹è±¡ä¸Šï¼Œ<code class="fe nr ns nt nu b">filter</code>å’Œ<code class="fe nr ns nt nu b">transform</code>ã€‚</p></div><div class="ab cl mn mo hx mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="im in io ip iq"><h2 id="3a99" class="nv mv it bd mw nw nx dn na ny nz dp ne lr oa ob ng lv oc od ni lz oe of nk iz bi translated">ğŸ…Â·é˜¿æ™®ç”³:è®©æˆ‘ä»¬æŠŠé˜¿æ™®ç”³å¼„æ¸…æ¥š</h2><p id="5abe" class="pw-post-body-paragraph li lj it lk b ll nm kd ln lo nn kg lq lr no lt lu lv np lx ly lz nq mb mc md im bi translated">Apply æœ‰ç‚¹ä»¤äººå›°æƒ‘ï¼Œå› ä¸ºæˆ‘ä»¬ç»å¸¸è°ˆè®ºåº”ç”¨å‡½æ•°ï¼Œè€Œå®é™…ä¸Šä¹Ÿæœ‰åº”ç”¨å‡½æ•°ã€‚ä½†æ˜¯è¯·åŸè°…æˆ‘ã€‚<code class="fe nr ns nt nu b">apply</code>å‡½æ•°æ²¿æ•°æ®å¸§çš„è½´åº”ç”¨ä¸€ä¸ªå‡½æ•°ã€‚åº”ç”¨ç¨‹åºå¯ä»¥æ˜¯æŒ‰åˆ—æˆ–æŒ‰è¡Œçš„ã€‚<br/> <code class="fe nr ns nt nu b">apply</code>ä¸¥æ ¼æ¥è¯´å¹¶ä¸æ˜¯ä¸€ä¸ªåªèƒ½åœ¨ groupby ä¸Šä¸‹æ–‡ä¸­ä½¿ç”¨çš„å‡½æ•°ã€‚æ‚¨è¿˜å¯ä»¥åœ¨å®Œæ•´çš„æ•°æ®å¸§ä¸Šä½¿ç”¨<code class="fe nr ns nt nu b">apply</code>ï¼Œå¦‚ä¸‹ä¾‹æ‰€ç¤º(æˆ‘ä»¬ä½¿ç”¨<code class="fe nr ns nt nu b">_</code>ä½œä¸ºæŠ›å¼ƒå˜é‡)ã€‚</p><pre class="ks kt ku kv gt ov nu ow ox aw oy bi"><span id="9577" class="nv mv it nu b gy oz pa l pb pc">_ = pd.DataFrame(<br/>    np.random.random((2,6)),<br/>    columns=list('ABCDEF')<br/>)<br/>_</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi po"><img src="../Images/8fe5bf9ff447fb4146a56b667d9edd15.png" data-original-src="https://miro.medium.com/v2/resize:fit:1296/format:webp/1*MwTlm5i9vL0uNmbgP86eJQ.png"/></div><figcaption class="ld le gj gh gi lf lg bd b be z dk">Random DataFrame with six columns</figcaption></figure><pre class="ks kt ku kv gt ov nu ow ox aw oy bi"><span id="76a1" class="nv mv it nu b gy oz pa l pb pc"><strong class="nu jd">IN:</strong><br/>_.apply(sum, axis=0) <strong class="nu jd"><em class="ph"># axis=0 is default, so you could drop it</em></strong></span><span id="2dfd" class="nv mv it nu b gy pd pa l pb pc"><strong class="nu jd">OUT:<br/></strong>A    0.620289<br/>B    0.818850<br/>C    0.672706<br/>D    1.269064<br/>E    1.156606<br/>F    0.934941<br/>dtype: float64</span><span id="0134" class="nv mv it nu b gy pd pa l pb pc"><strong class="nu jd">IN:<br/></strong>_.apply(sum, axis=1)</span><span id="ee08" class="nv mv it nu b gy pd pa l pb pc"><strong class="nu jd">OUT:<br/></strong>0    2.868145<br/>1    2.604311<br/>dtype: float64</span></pre><p id="beea" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">ä½†æ˜¯<code class="fe nr ns nt nu b">apply</code>ä¹Ÿå¯ä»¥ç”¨åœ¨ groupby ä¸Šä¸‹æ–‡ä¸­ã€‚è¿™å¾ˆæœ‰æ„ä¹‰ï¼Œå› ä¸ºæ¯ä¸ªç»„æœ¬èº«å°±æ˜¯ä¸€ä¸ªæ›´å°çš„æ•°æ®æ¡†æ¶ã€‚è¯·è®°ä½ï¼Œè¯¥å‡½æ•°å°†åº”ç”¨äºæ•´ä¸ªæ•°æ®å¸§ã€‚å°†è¯¥å‡½æ•°åº”ç”¨äºæ•´ä¸ªæ•°æ®å¸§é€šå¸¸æ„å‘³ç€æ‚¨æƒ³è¦é€‰æ‹©ä½¿ç”¨å‡½æ•°çš„åˆ—ã€‚æˆ‘ä»¬å°†æŠŠå®ƒç•™åœ¨ä¸‹é¢çš„ä¸¤ä¸ªä¾‹å­ä¸­ï¼Œè€Œæ˜¯é›†ä¸­åœ¨<code class="fe nr ns nt nu b">agg(regation)</code>ä¸Šï¼Œè¿™æ˜¯èšåˆç»„çš„â€œé¢„æœŸâ€æ–¹å¼ã€‚</p><pre class="ks kt ku kv gt ov nu ow ox aw oy bi"><span id="07e7" class="nv mv it nu b gy oz pa l pb pc"><strong class="nu jd">IN:</strong><br/>df.groupby(<br/>    pd.Grouper(key='Date',freq='Y')<br/>)['Sale'].apply(sum)</span><span id="e261" class="nv mv it nu b gy pd pa l pb pc"><strong class="nu jd">OUT:<br/></strong>Date<br/>2014-12-31    3681<br/>2015-12-31    3800<br/>2016-12-31    3881<br/>2017-12-31    3068<br/>2018-12-31    2478<br/>Freq: A-DEC, Name: Sale, dtype: int64</span><span id="2b1d" class="nv mv it nu b gy pd pa l pb pc"><strong class="nu jd">IN:<br/></strong>df.groupby(<br/>    pd.Grouper(key='Date',freq='Y')<br/>)['Val','Sale'].apply(sum)</span><span id="5283" class="nv mv it nu b gy pd pa l pb pc"><strong class="nu jd">OUT:<br/></strong>Date       Val       Sale<br/>2014-12-31 100422394 3681<br/>2015-12-31 101724648 3800<br/>2016-12-31 101789642 3881<br/>2017-12-31 101957784 3068<br/>2018-12-31 100399962 2478</span></pre></div><div class="ab cl mn mo hx mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="im in io ip iq"><h2 id="2398" class="nv mv it bd mw nw nx dn na ny nz dp ne lr oa ob ng lv oc od ni lz oe of nk iz bi translated">ğŸ…‘Â·é˜¿æ ¼(é›·åŠ ç‰¹)</h2><p id="5c3d" class="pw-post-body-paragraph li lj it lk b ll nm kd ln lo nn kg lq lr no lt lu lv np lx ly lz nq mb mc md im bi translated">è¯·æ³¨æ„<code class="fe nr ns nt nu b">agg</code>å’Œ<code class="fe nr ns nt nu b">aggregate</code>å¯ä»¥äº’æ¢ä½¿ç”¨ã€‚<code class="fe nr ns nt nu b">agg</code>æ›´çŸ­ï¼Œæ‰€ä»¥æˆ‘å°†ç»§ç»­ä½¿ç”¨å®ƒã€‚</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi pp"><img src="../Images/0b6b87fbb4e09376004f93a22882abc2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WTlC_t-5RQqeqS0tcbkCKQ.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk">Visualization of a typical split-apply-combine process with multiple aggregations functions that are being applied to each group individually</figcaption></figure><p id="f28d" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">æ€»çš„æ¥è¯´ï¼Œèšåˆæ˜¯å…¶ä¸­æœ€å¼ºå¤§çš„ã€‚è®©æˆ‘ä»¬ä»”ç»†åˆ†æä¸Šé¢çš„å›¾åƒï¼Œä¸»è¦å…³æ³¨è¿™ä¸ªè¿‡ç¨‹çš„å³è¾¹éƒ¨åˆ†ã€‚ä¸‹é¢çš„ä»£ç ç‰‡æ®µåˆ›å»ºäº†ä¸Šå›¾çš„æ”¾å¤§ç‰ˆæœ¬ã€‚</p><pre class="ks kt ku kv gt ov nu ow ox aw oy bi"><span id="c9d7" class="nv mv it nu b gy oz pa l pb pc">df.groupby('Sales Rep').agg({ <br/>    'Order Id':'size',<br/>    'Val':['sum','mean'],<br/>    'Sale':['sum','mean']<br/>})</span></pre><p id="a8fd" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">æˆ‘ä»¬å°†ä¸€ä¸ªå­—å…¸ä¼ é€’ç»™èšåˆå‡½æ•°ï¼Œå…¶ä¸­é”®(å³<code class="fe nr ns nt nu b">Order Id</code>ã€<code class="fe nr ns nt nu b">Val</code>ã€<code class="fe nr ns nt nu b">Sale</code>)æ˜¯åˆ—ï¼Œå€¼(<code class="fe nr ns nt nu b">'size'</code>ã€<code class="fe nr ns nt nu b">['sum','mean']</code>ã€<code class="fe nr ns nt nu b">['sum','mean']</code>)æ˜¯åº”ç”¨äºå„ä¸ªåˆ—çš„å‡½æ•°ã€‚</p><p id="de1d" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">è¯·æ³¨æ„ï¼Œå‡½æ•°å¯ä»¥æ˜¯å•ä¸ªå‡½æ•°ï¼Œä¹Ÿå¯ä»¥æ˜¯å‡½æ•°åˆ—è¡¨(æ‰€æœ‰å‡½æ•°éƒ½å°†è¢«åº”ç”¨)ã€‚å¦å¤–ï¼Œè¯·æ³¨æ„<code class="fe nr ns nt nu b">agg</code>å¯ä»¥ä½¿ç”¨å‡½æ•°å(å³å­—ç¬¦ä¸²)æˆ–å®é™…å‡½æ•°(å³ Python å¯¹è±¡)ã€‚åœ¨è¿™é‡Œå¯ä»¥æ‰¾åˆ°åŠŸèƒ½çš„éè¯¦å°½åˆ—è¡¨<a class="ae lh" href="https://pandas.pydata.org/pandas-docs/stable/getting_started/basics.html#descriptive-statistics" rel="noopener ugc nofollow" target="_blank">ã€‚æˆ‘æœ€å¸¸ç”¨çš„æ˜¯:</a></p><ul class=""><li id="8911" class="og oh it lk b ll lm lo lp lr pq lv pr lz ps md pt om on oo bi translated"><code class="fe nr ns nt nu b"><strong class="lk jd">'size'</strong></code> <strong class="lk jd"> : </strong>ç»Ÿè®¡è¡Œæ•°</li><li id="86ed" class="og oh it lk b ll op lo oq lr or lv os lz ot md pt om on oo bi translated"><code class="fe nr ns nt nu b"><strong class="lk jd">'sum'</strong></code> <strong class="lk jd"> : </strong>å‘ä¸Šå¯¹åˆ—æ±‚å’Œ</li><li id="f03f" class="og oh it lk b ll op lo oq lr or lv os lz ot md pt om on oo bi translated"><code class="fe nr ns nt nu b"><strong class="lk jd">'mean'/'median'</strong></code> <strong class="lk jd"> : </strong>åˆ—çš„å¹³å‡å€¼/ä¸­å€¼</li><li id="971f" class="og oh it lk b ll op lo oq lr or lv os lz ot md pt om on oo bi translated"><code class="fe nr ns nt nu b"><strong class="lk jd">'max'/'min'</strong></code> <strong class="lk jd"> : </strong>åˆ—çš„æœ€å¤§å€¼/æœ€å°å€¼</li><li id="4a33" class="og oh it lk b ll op lo oq lr or lv os lz ot md pt om on oo bi translated"><code class="fe nr ns nt nu b"><strong class="lk jd">'idxmax'/'idxmin'</strong></code> <strong class="lk jd"> : </strong>åˆ—çš„æœ€å¤§å€¼/æœ€å°å€¼ç´¢å¼•ã€‚è·å–æœ€å°å€¼æˆ–æœ€å¤§å€¼çš„ç´¢å¼•æœ‰åŠ©äºæ˜ å°„å…¶ä»–åˆ—ï¼Œä¾‹å¦‚ï¼Œæ¯ä¸ªé”€å”®ä»£è¡¨çš„æœ€å¤§äº¤æ˜“çš„å…¬å¸åç§°æ˜¯ä»€ä¹ˆ</li><li id="19a1" class="og oh it lk b ll op lo oq lr or lv os lz ot md pt om on oo bi translated"><code class="fe nr ns nt nu b"><strong class="lk jd">pd.Series.nunique</strong></code> <strong class="lk jd"> : </strong>ç»Ÿè®¡å”¯ä¸€å€¼ã€‚æ³¨æ„ï¼Œä¸å‰é¢çš„å‡½æ•°ä¸åŒï¼Œè¿™æ˜¯ä¸€ä¸ªå®é™…çš„å‡½æ•°ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚</li></ul><h2 id="902c" class="nv mv it bd mw nw nx dn na ny nz dp ne lr oa ob ng lv oc od ni lz oe of nk iz bi translated">è­¦å¯Ÿã€‚NamedAgg</h2><p id="8929" class="pw-post-body-paragraph li lj it lk b ll nm kd ln lo nn kg lq lr no lt lu lv np lx ly lz nq mb mc md im bi translated">ç°åœ¨ï¼Œå½“ä»¥è¿™ç§æ–¹å¼å°†å¤šä¸ªèšåˆå‡½æ•°åº”ç”¨äºå¤šä¸ªåˆ—æ—¶ï¼Œä¸€ä¸ªé—®é¢˜æ˜¯ç»“æœä¼šå˜å¾—æœ‰ç‚¹æ··ä¹±ï¼Œå¹¶ä¸”æ— æ³•æ§åˆ¶åˆ—åã€‚åœ¨è¿‡å»ï¼Œæˆ‘ç»å¸¸å‘ç°è‡ªå·±èšé›†äº†ä¸€ä¸ªæ•°æ®å¸§ï¼Œç„¶åç›´æ¥é‡å‘½åç»“æœã€‚æˆ‘æ€»è§‰å¾—é‚£æœ‰ç‚¹ä½æ•ˆã€‚</p><p id="1acb" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">åƒè¿™æ ·çš„æƒ…å†µæ­£æ˜¯<code class="fe nr ns nt nu b">pd.NamedAgg</code>æ´¾ä¸Šç”¨åœºçš„æ—¶å€™ã€‚<code class="fe nr ns nt nu b">pd.NamedAgg</code>æ˜¯åœ¨ Pandas ç‰ˆæœ¬ 0.25 ä¸­å¼•å…¥çš„ï¼Œå…è®¸æŒ‡å®šç›®æ ‡åˆ—çš„åç§°ã€‚</p><pre class="ks kt ku kv gt ov nu ow ox aw oy bi"><span id="4950" class="nv mv it nu b gy oz pa l pb pc">def cr(x):<br/>    return round(np.mean(x),2)</span><span id="086d" class="nv mv it nu b gy pd pa l pb pc"><strong class="nu jd"># Long Form: Explictly specifying the NamedAgg</strong><br/>aggregation = {<br/>    'Potential Sales': pd.NamedAgg(column='Val', aggfunc='size'),<br/>    'Sales': pd.NamedAgg(column='Sale', aggfunc='sum'),<br/>    'Conversion Rate': pd.NamedAgg(column='Sale', aggfunc=cr)<br/>}</span><span id="da01" class="nv mv it nu b gy pd pa l pb pc"><strong class="nu jd"># Alternative: Since the NamedAgg is just a tuple, we can also pass regular tuples</strong><br/>aggregation = {<br/>    'Potential Sales': ('Val','size'),<br/>    'Sales': ('Sale','sum'),<br/>    'Conversion Rate': ('Sale',cr)<br/>}</span><span id="b604" class="nv mv it nu b gy pd pa l pb pc">df.groupby('Sales Rep').agg(**aggregation)</span></pre><p id="917d" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">è¿è¡Œä¸Šé¢çš„ä»£ç ç‰‡æ®µä¼šå¯¼è‡´:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi pu"><img src="../Images/054853fb594b487be7cef1bde39cbe9d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1212/format:webp/1*3yQ0e29L1-ZUy3xJXK9hSw.png"/></div><figcaption class="ld le gj gh gi lf lg bd b be z dk">Result of aggregation with built-in renaming of columns</figcaption></figure></div><div class="ab cl mn mo hx mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="im in io ip iq"><h2 id="167e" class="nv mv it bd mw nw nx dn na ny nz dp ne lr oa ob ng lv oc od ni lz oe of nk iz bi translated">ğŸ…’ <code class="fe nr ns nt nu b">transform</code></h2><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi pv"><img src="../Images/a4877ef7dbf3baf368e88ff0c57e4205.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fxdhr6i-jlzeex7f5RkIlw.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk">Visualization of a typical split-apply-combine process with transform being applied to the â€˜Valâ€™ column. Transform sums up the column on a group level and assigns the summed value back to every row.</figcaption></figure><p id="d6d4" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">agg è¿”å›è¾“å…¥çš„ç®€åŒ–ç‰ˆæœ¬ï¼Œè€Œ transform è¿”å›å®Œæ•´æ•°æ®çš„ç»„çº§è½¬æ¢ç‰ˆæœ¬çš„ã€‚æ–°è¾“å‡ºæ•°æ®çš„é•¿åº¦ä¸è¾“å…¥æ•°æ®çš„é•¿åº¦ç›¸åŒã€‚å¯¹äºæ¥è‡ª SQL çš„ç”¨æˆ·ï¼Œå¯ä»¥å°† transform çœ‹ä½œä¸€ä¸ªçª—å£å‡½æ•°ã€‚</p><p id="bdd9" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">ä¸€ä¸ªå…¸å‹çš„ä¾‹å­æ˜¯é€šè¿‡é™¤ä»¥ç»„é—´æ€»å’Œæ¥è·å¾—ç»„æ€»æ•°çš„ç™¾åˆ†æ¯”ã€‚</p><pre class="ks kt ku kv gt ov nu ow ox aw oy bi"><span id="c8c4" class="nv mv it nu b gy oz pa l pb pc"><strong class="nu jd">IN:</strong><br/>df.groupby('Sales Rep')['Val'].transform(lambda x: x/sum(x))</span><span id="d94d" class="nv mv it nu b gy pd pa l pb pc"><strong class="nu jd">OUT:<br/></strong>0        0.004991<br/>1        0.005693<br/>2        0.003976<br/>3        0.000799<br/>4        0.003300<br/>           ...   <br/>99995    0.012088<br/>99996    0.000711<br/>99997    0.013741<br/>99998    0.010695<br/>99999    0.001533<br/>Name: Val, Length: 100000, dtype: float64</span></pre><p id="e13a" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">ä¸<code class="fe nr ns nt nu b">agg</code>ä¸åŒï¼Œ<code class="fe nr ns nt nu b">transform</code>é€šå¸¸é€šè¿‡å°†ç»“æœåˆ†é…ç»™æ–°åˆ—æ¥ä½¿ç”¨ã€‚åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥:</p><pre class="ks kt ku kv gt ov nu ow ox aw oy bi"><span id="6798" class="nv mv it nu b gy oz pa l pb pc">df['%'] = df.groupby('Sales Rep')['Val'].transform(<br/>  lambda x: x/sum(x)<br/>)</span></pre><p id="0b53" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">æŸ¥çœ‹è¿™ç¯‡æ–‡ç« ï¼Œå­¦ä¹ å¦‚ä½•ä½¿ç”¨<code class="fe nr ns nt nu b">transform</code>æ¥åˆ é™¤ä¸¢å¤±çš„å€¼ã€‚</p><div class="pw px gp gr py pz"><a rel="noopener follow" target="_blank" href="/using-pandas-transform-and-apply-to-deal-with-missing-data-on-a-group-level-cb6ccf060531"><div class="qa ab fo"><div class="qb ab qc cl cj qd"><h2 class="bd jd gy z fp qe fr fs qf fu fw jc bi translated">ä½¿ç”¨ Panda çš„â€œè½¬æ¢â€å’Œâ€œåº”ç”¨â€åœ¨ç»„çº§åˆ«å¤„ç†ç¼ºå¤±æ•°æ®</h2><div class="qg l"><h3 class="bd b gy z fp qe fr fs qf fu fw dk translated">äº†è§£å½“æ‚¨ä¸æƒ³ç®€å•åœ°ä¸¢å¼ƒä¸¢å¤±çš„æ•°æ®æ—¶åº”è¯¥æ€ä¹ˆåšã€‚</h3></div><div class="qh l"><p class="bd b dl z fp qe fr fs qf fu fw dk translated">towardsdatascience.com</p></div></div><div class="qi l"><div class="qj l qk ql qm qi qn lb pz"/></div></div></a></div></div><div class="ab cl mn mo hx mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="im in io ip iq"><h2 id="ab98" class="nv mv it bd mw nw nx dn na ny nz dp ne lr oa ob ng lv oc od ni lz oe of nk iz bi translated">ğŸ…“ <code class="fe nr ns nt nu b">filter</code></h2><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi qo"><img src="../Images/7b845699e119eacb31337a946009ec39.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lDZgurT8zja-u77DW758KQ.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk">Visualization of a typical split-apply-combine process with the filter being applied to the â€˜Saleâ€™ column. The specified filter is used on a group level and will only leave groups with at least one Sale.</figcaption></figure><p id="c37a" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">é¡¾åæ€ä¹‰ï¼ŒFilter ä¸ä»¥ä»»ä½•æ–¹å¼æ”¹å˜æ•°æ®ï¼Œè€Œæ˜¯é€‰æ‹©æ•°æ®çš„å­é›†ã€‚å¯¹äºæ¥è‡ª SQL çš„ç”¨æˆ·ï¼Œå¯ä»¥æŠŠ filter çœ‹ä½œ HAVING æ¡ä»¶ã€‚</p><p id="0347" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥ç­›é€‰æ‰€æœ‰è‡³å°‘èµšäº† 20 ä¸‡è‹±é•‘çš„é”€å”®ä»£è¡¨</p><pre class="ks kt ku kv gt ov nu ow ox aw oy bi"><span id="40ef" class="nv mv it nu b gy oz pa l pb pc"><strong class="nu jd">IN:<br/></strong>df.groupby('Sales Rep').filter(<br/>  lambda x: (x['Val'] * x['Sale']).sum() &gt; 200000<br/>)</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi qp"><img src="../Images/7a2690e5a103e6e3906b48e8ed8f6626.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vis_mI0UDZ8elAoSPnApww.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk">Filtered DataFrame â€” Condition: Realized Sales &gt; 200k</figcaption></figure><p id="388c" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">æˆ–è€…è½¬åŒ–ç‡&gt; 30%çš„æ‰€æœ‰é”€å”®ä»£è¡¨:</p><pre class="ks kt ku kv gt ov nu ow ox aw oy bi"><span id="b8d7" class="nv mv it nu b gy oz pa l pb pc"><strong class="nu jd">IN:</strong><br/><strong class="nu jd"># Let's add this for verification</strong><br/>df['cr'] = df.groupby('Sales Rep')['Sale'].transform('mean')</span><span id="2a43" class="nv mv it nu b gy pd pa l pb pc">df.groupby('Sales Rep').filter(lambda x: x['Sale'].mean() &gt; .3)</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi qq"><img src="../Images/418e12612a9afa05784da9fbf86f0035.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wfVSE2X5pc0JUVJjeeBcCg.png"/></div></div></figure><h1 id="a7f5" class="mu mv it bd mw mx pi mz na nb pj nd ne ki pk kj ng kl pl km ni ko pm kp nk nl bi translated">ç»“æŸè¯­</h1><p id="b587" class="pw-post-body-paragraph li lj it lk b ll nm kd ln lo nn kg lq lr no lt lu lv np lx ly lz nq mb mc md im bi translated">åœ¨æœ¬æ–‡ä¸­ï¼Œæ‚¨å­¦ä¹ äº†å¦‚ä½•åƒçœŸæ­£çš„ç†ŠçŒ«ä¸“å®¶ä¸€æ ·å¯¹æ•°æ®å¸§è¿›è¡Œåˆ†ç»„ã€‚æ‚¨å­¦ä¹ äº†è®¸å¤šå¯¹æ•°æ®è¿›è¡Œåˆ†ç»„çš„æ–¹æ³•ã€‚ä½ å­¦ä¼šäº†åŒºåˆ†<code class="fe nr ns nt nu b">apply</code>å’Œ<code class="fe nr ns nt nu b">agg</code>ã€‚æ‚¨å­¦ä¹ å¹¶åº”ç”¨äº†æœ€å¸¸è§çš„èšåˆå‡½æ•°ã€‚ä½ å·²ç»çœ‹åˆ°äº†ä¸å¸¸ç”¨çš„<code class="fe nr ns nt nu b">transform</code>å’Œ<code class="fe nr ns nt nu b">filter</code>æ´¾ä¸Šäº†ç”¨åœºã€‚</p><p id="3635" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">æƒ³èŠå¤©è¯·ç™»é™†<a class="ae lh" href="https://www.linkedin.com/in/fbosler/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>ï¼æˆ‘å¾ˆä¹æ„å’Œä½ è°ˆè°ˆï¼Œæˆ–è€…å›ç­”ä½ å¯èƒ½æœ‰çš„ä»»ä½•é—®é¢˜ã€‚</p><p id="d979" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">å¦å¤–ï¼Œçœ‹çœ‹æˆ‘åœ¨ Medium ä¸Šå†™çš„å…¶ä»–æ–‡ç« </p><p id="79b1" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">å¹²å¾—å¥½ï¼Œæ„Ÿè°¢æ‚¨çš„é˜…è¯»ï¼</p></div></div>    
</body>
</html>