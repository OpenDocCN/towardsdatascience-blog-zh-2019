<html>
<head>
<title>Decomposing a Time series in a Simple and Intuitive way</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">以简单直观的方式分解时间序列</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/decomposing-a-time-series-in-a-simple-and-intuitive-way-19d3213c420b?source=collection_archive---------14-----------------------#2019-03-27">https://towardsdatascience.com/decomposing-a-time-series-in-a-simple-and-intuitive-way-19d3213c420b?source=collection_archive---------14-----------------------#2019-03-27</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="5025" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">可解释的时间序列模型</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/ab2e7c370bcc651117ca7e8fd880165b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1ELONsAgIfXnJQFbUpe44A.jpeg"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Predict store sales</figcaption></figure><p id="e22e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们都曾与传统的时间序列模型如 ARIMA、指数平滑等进行过斗争，这些模型不太直观，如果不用纯粹的统计术语，很难向企业解释。</p><p id="45b8" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">给定基于时间的销售数据，直觉上我们想到的是计算出像月度趋势、同比趋势、日间趋势、周峰值等模式。因此，这促使我设计了一种方法，可以分解时间序列以轻松找到所有这些参数，并使我们能够以更简单和直观的方式对未来进行预测。</p><p id="2dc8" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在本帖中，我们将使用从 2013 年 1 月<em class="lu">日</em>到 2015 年 6 月<em class="lu">日</em>约 2.5 年的商店销售数据，从<em class="lu"> </em> <a class="ae lv" href="https://www.kaggle.com/c/rossmann-store-sales" rel="noopener ugc nofollow" target="_blank">罗斯曼商店销售卡格尔挑战</a>。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi lw"><img src="../Images/36156f0a70d344c0ce93f94c466b53c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:672/format:webp/1*gUQZ5bnWCJ_S1mXZEKT99A.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk"><strong class="bd lx">Table 1: Sales Data for Store XYZ</strong></figcaption></figure><h1 id="0e10" class="ly lz it bd ma mb mc md me mf mg mh mi jz mj ka mk kc ml kd mm kf mn kg mo mp bi translated">创造流动</h1><p id="a277" class="pw-post-body-paragraph ky kz it la b lb mq ju ld le mr jx lg lh ms lj lk ll mt ln lo lp mu lr ls lt im bi translated">为了实现我们的最终目标，即识别(分解)时间序列的不同组成部分，并将我们的学习转化为更简单、更直观的模型，我们对任务的总体看法是:</p><ol class=""><li id="70d0" class="mv mw it la b lb lc le lf lh mx ll my lp mz lt na nb nc nd bi translated">数据分析(<a class="ae lv" href="https://en.wikipedia.org/wiki/Exploratory_data_analysis" rel="noopener ugc nofollow" target="_blank"> EDA </a>)</li><li id="e23c" class="mv mw it la b lb ne le nf lh ng ll nh lp ni lt na nb nc nd bi translated">功能创建和平均销售额计算</li><li id="f13f" class="mv mw it la b lb ne le nf lh ng ll nh lp ni lt na nb nc nd bi translated">推导模型的方程式</li><li id="99f4" class="mv mw it la b lb ne le nf lh ng ll nh lp ni lt na nb nc nd bi translated">训练模型</li><li id="5fe2" class="mv mw it la b lb ne le nf lh ng ll nh lp ni lt na nb nc nd bi translated">分解时间序列的不同组成部分</li><li id="95a7" class="mv mw it la b lb ne le nf lh ng ll nh lp ni lt na nb nc nd bi translated">使用分解的组件创建一个更简单和直观的模型</li><li id="e8b4" class="mv mw it la b lb ne le nf lh ng ll nh lp ni lt na nb nc nd bi translated">模型的质量分析并利用它获得其他有用的信息</li><li id="5ccb" class="mv mw it la b lb ne le nf lh ng ll nh lp ni lt na nb nc nd bi translated">结论</li></ol><h1 id="e514" class="ly lz it bd ma mb mc md me mf mg mh mi jz mj ka mk kc ml kd mm kf mn kg mo mp bi translated">1.数据分析</h1><blockquote class="nj nk nl"><p id="1ec2" class="ky kz lu la b lb lc ju ld le lf jx lg nm li lj lk nn lm ln lo no lq lr ls lt im bi translated">让我们开始我们的旅程。我们有特定日期的商店销售。字段<strong class="la iu">打开</strong>表示商店当天是否正常营业。XYZ 商店在星期天仍然关闭。所以，我们会考虑到日子，只有当商店开门。</p></blockquote><p id="a892" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">一段时间内商店销售的图形可视化。</p><p id="01ed" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">随时间推移可视化销售的代码</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi np"><img src="../Images/d240796940a11c3f61117482e4293ffb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*j2d-cV_9Kk1FfWtmLXIX5Q.jpeg"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Store sales over time</figcaption></figure><p id="3c50" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们在每年的 12 月份看到一个明显的高峰。除此之外，多年来的下降趋势也很明显。2014 年和 2015 年显示出类似的趋势，但与 2013 年相比明显下降。一个好的方法应该能够捕捉这些变化。</p><p id="08f6" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">接下来，我们将执行<a class="ae lv" href="https://en.wikipedia.org/wiki/Exploratory_data_analysis" rel="noopener ugc nofollow" target="_blank"> EDA </a>来了解一周内几天的销售变化。</p><p id="2fe2" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">可视化一周内销售额的代码</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nq"><img src="../Images/790265b2f2ab5b9ce33439d709f5df38.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qrFKVdw4DPDJsqPSuF76Cw.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Store sales during days in a week</figcaption></figure><p id="29f3" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">星期天没有销售，因为商店仍然关闭。我们可以在周六和周一看到一个明显的高峰。周末可能是周六销售额增加的一个原因。类似地，商店在周日停止营业可能会导致周一销售额增加。一个好的方法应该能够捕捉这些变化。</p><p id="6906" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们已经看到了 12 月份的销售高峰，但是让我们用类似的 EDA 来重新确认我们的假设，就像我们对一周内几天的销售所做的那样。</p><p id="59ad" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">跨月销售可视化代码</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nr"><img src="../Images/15d88f923439c3e23d1d4406439c1467.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CBN8E0-YhFHN8osrYyz8Aw.jpeg"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Store sales across months</figcaption></figure><p id="ac86" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">另一件事，我们可以调查的是一个月中几周的销售模式。我有一种直觉，这不会是一个很强的模式，一个月中几周的销售应该表现类似。但是，为什么不测试一下呢？这个世界充满了惊喜，不是吗？我们将分析一周中每天的平均销售额。</p><p id="955a" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">可视化一个月中几周销售额的代码</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ns"><img src="../Images/c9b9a0bf03ed2d1772adaddcccbe4987.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5Y0htV5Tcr40rXEatJtGIg.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Sales across weeks in a month</figcaption></figure><p id="8e39" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在一个月的第一周和最后一周的几天里，销售额都比较高。一个随机的猜测可能是月末工资和更多人购物的功劳。</p></div><div class="ab cl nt nu hx nv" role="separator"><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny"/></div><div class="im in io ip iq"><h1 id="6290" class="ly lz it bd ma mb oa md me mf ob mh mi jz oc ka mk kc od kd mm kf oe kg mo mp bi translated">2.特色创造和平均销售额</h1><blockquote class="nj nk nl"><p id="2198" class="ky kz lu la b lb lc ju ld le lf jx lg nm li lj lk nn lm ln lo no lq lr ls lt im bi translated">每个日期都可以通过其年、月、周和日来唯一标识。以这种方式表示日期的主要原因是为了发现月趋势、年趋势、日趋势和周趋势。</p><p id="7f27" class="ky kz lu la b lb lc ju ld le lf jx lg nm li lj lk nn lm ln lo no lq lr ls lt im bi translated">保持周数的原因是为了确定销售是否随着月份的进展而增加、减少或者根本没有影响。我们称之为每周趋势。</p><p id="24e0" class="ky kz lu la b lb lc ju ld le lf jx lg nm li lj lk nn lm ln lo no lq lr ls lt im bi translated">此外，我们将删除商店仍然关闭的数据点。星期天，商店仍然关门。</p></blockquote><p id="8072" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">执行特征创建和清理步骤后，数据如下所示</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi of"><img src="../Images/1c91eace0aa376f6f705afd47a703a84.png" data-original-src="https://miro.medium.com/v2/resize:fit:1080/format:webp/1*OVgRtnqNoNvJJm-zDp3xIQ.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Table2: Data Overview</figcaption></figure><p id="b439" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">接下来，我们将对年、月、日和周字段执行一次性编码。一种热门编码是分类数据的二进制表示。这一步的结果是，我们将拥有以下字段。</p><pre class="kj kk kl km gt og oh oi oj aw ok bi"><span id="4edd" class="ol lz it oh b gy om on l oo op">'Sales', 'weekday_0', 'weekday_1', 'weekday_2',<br/>'weekday_3', 'weekday_4', 'weekday_5', 'year_2013', 'year_2014',<br/>'year_2015', 'month_01', 'month_02', 'month_03', 'month_04', 'month_05','month_06', 'month_07', 'month_08', 'month_09', 'month_10', 'month_11','month_12', 'weeknbr_1', 'weeknbr_2', 'weeknbr_3', 'weeknbr_4','weeknbr_5'</span></pre><h2 id="a10a" class="ol lz it bd ma oq or dn me os ot dp mi lh ou ov mk ll ow ox mm lp oy oz mo pa bi translated">平均销售额</h2><blockquote class="nj nk nl"><p id="77d5" class="ky kz lu la b lb lc ju ld le lf jx lg nm li lj lk nn lm ln lo no lq lr ls lt im bi translated">我们将从计算平均销售额开始。我们将用<strong class="la iu"> avgSales </strong>来表示。我们有 2.5 年的数据，即 2013 年、2014 年和 2015 年年中。由于没有 2015 年全年数据，如果用于平均销售额计算，很可能会添加噪声。我们将仅使用 2013 年和 2014 年的销售数据来计算 avgSales。</p></blockquote><p id="d5f9" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">计算平均销售额的代码</p><p id="2c4a" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><em class="lu"> avgSales </em>出来是<strong class="la iu"> 4825.98 </strong></p></div><div class="ab cl nt nu hx nv" role="separator"><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny"/></div><div class="im in io ip iq"><h1 id="630f" class="ly lz it bd ma mb oa md me mf ob mh mi jz oc ka mk kc od kd mm kf oe kg mo mp bi translated">3.推导模型的方程式</h1><p id="620a" class="pw-post-body-paragraph ky kz it la b lb mq ju ld le mr jx lg lh ms lj lk ll mt ln lo lp mu lr ls lt im bi translated">主要的想法是找到每月，每年，每天和每周的趋势。我们希望给它加上一个值，叫做指数。因此，我们希望获得月度、年度、日和周趋势指数。我们假设这些趋势是一天中销售额的唯一原因，超过了我们上面计算的平均销售额(avgSales)。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pb"><img src="../Images/51398dfbae36162fbb882c0ef0950112.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EWNpR_AkWG6wV5ohBQQgKg.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Model’s equation (1)</figcaption></figure><p id="204c" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们有一次性编码输入功能。在一个时间，只有一个月会高或设置为 1，随着一天，一周数和一年。输入会处理好的。因此，我们的输入等式被修改为:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pc"><img src="../Images/b2578a44d6204bb97d5597c261a20a98.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hPCdQF6GUuUO3ayeU4DGNw.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Model’s equation (2)</figcaption></figure><p id="a05e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们看看 2014 年 5 月 17 日模型方程的形式。在这种情况下，年将是 2014 年，月将是 5 月，周数将是 3 日，日将是星期六。所有其他输入将为 0。系数的 0 次方将变成 1。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pd"><img src="../Images/e1cb2adad8363ede331898a4cb42d063.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6qWxhuiAJkmD5EDbtyE_7A.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Model’s equation form for 17th May 2014</figcaption></figure><p id="bc23" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们将两边都取对数，以简化方程，并将其转换为易于应用线性回归的形式。我们将应用无截距回归，并取模型系数的反对数，以获得月度、同比、每日和每周趋势指数。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pe"><img src="../Images/1c0101b821458cb6a8e0178f540900f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SHEEhwWK1ZeS5fjaG-2WEQ.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Model’s equation to apply regression</figcaption></figure></div><div class="ab cl nt nu hx nv" role="separator"><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny"/></div><div class="im in io ip iq"><h1 id="1c5a" class="ly lz it bd ma mb oa md me mf ob mh mi jz oc ka mk kc od kd mm kf oe kg mo mp bi translated">4.训练模型</h1><p id="7337" class="pw-post-body-paragraph ky kz it la b lb mq ju ld le mr jx lg lh ms lj lk ll mt ln lo lp mu lr ls lt im bi translated">这里的因变量是 ln(销售)-ln(avg 销售)，我们将采用以 2 为基数的对数。我们有一家店铺从 2013 年 1 月<em class="lu">日到 2015 年 6 月<em class="lu">日</em>约 2.5 年的销售数据。我们不会使用上个月的数据并保留它来验证模型的性能。</em></p><p id="5874" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">训练模型</p><p id="9035" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">接下来，我们将对模型的系数取反对数，以获得相应的指数。</p><p id="12d2" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">取模型系数的对数</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pf"><img src="../Images/d1939e5ad0a8f15e76426d0c4b7f7de2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1152/format:webp/1*NfowimX-QuykVzj7hCJdzA.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Yearly Index</figcaption></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pg"><img src="../Images/748afcfea26996070b62b173d49ca219.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9GXkOE0jNszcMVDkPzxZxQ.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Monthly Index</figcaption></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ph"><img src="../Images/e9c490d663559922d56ad982a7917b37.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TcpM9wDn_D-PvxvnuvYVMw.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Day-wise Index</figcaption></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pi"><img src="../Images/a89f820f7904591b92b092b566ced7b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1208/format:webp/1*42wANw6fuHtdkl-7GsBkTg.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Weekly Index</figcaption></figure></div><div class="ab cl nt nu hx nv" role="separator"><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny"/></div><div class="im in io ip iq"><h1 id="d1a9" class="ly lz it bd ma mb oa md me mf ob mh mi jz oc ka mk kc od kd mm kf oe kg mo mp bi translated">5.从回归模型中学习分解时间序列</h1><h2 id="5096" class="ol lz it bd ma oq or dn me os ot dp mi lh ou ov mk ll ow ox mm lp oy oz mo pa bi translated">年度趋势</h2><p id="d0b2" class="pw-post-body-paragraph ky kz it la b lb mq ju ld le mr jx lg lh ms lj lk ll mt ln lo lp mu lr ls lt im bi translated">时间序列的一个重要组成部分是逐年趋势。与 2014 年和 2015 年相比，我们的模型学习的年度指数在 2013 年明显捕捉到了更高的趋势。捕获的年度指数将帮助我们从时间序列数据中分解年度趋势。让我们想象一下结果。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pf"><img src="../Images/d1939e5ad0a8f15e76426d0c4b7f7de2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1152/format:webp/1*NfowimX-QuykVzj7hCJdzA.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Yearly Index</figcaption></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pj"><img src="../Images/aad5c7bc9321dd1ec8b149d32ff19f3a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0RsUI_0CXQafMdX3HC-YMw.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Yearly trend</figcaption></figure><p id="07d3" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们可以清楚地看到一个逐年下降的趋势。下降趋势可能有许多原因，如商店质量下降或竞争对手商店开业等。需要做更深入的分析才能发现。这将是一个有趣的发现。</p><h2 id="2c89" class="ol lz it bd ma oq or dn me os ot dp mi lh ou ov mk ll ow ox mm lp oy oz mo pa bi translated">月度趋势</h2><p id="02c3" class="pw-post-body-paragraph ky kz it la b lb mq ju ld le mr jx lg lh ms lj lk ll mt ln lo lp mu lr ls lt im bi translated">时间序列的另一个重要组成部分是月趋势。我们的模型学习的月度指数已经清楚地捕捉到了 12 月份的较高趋势。这将有助于我们从时间序列数据中分解月趋势。让我们想象一下结果。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pg"><img src="../Images/748afcfea26996070b62b173d49ca219.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9GXkOE0jNszcMVDkPzxZxQ.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Monthly Index</figcaption></figure><p id="df17" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">可视化月度趋势</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pk"><img src="../Images/47138e9bf7915c8e3ba90c199c17506e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DqTvaALBJ_Y_mAK63zCfAw.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Monthly trend</figcaption></figure><h2 id="c725" class="ol lz it bd ma oq or dn me os ot dp mi lh ou ov mk ll ow ox mm lp oy oz mo pa bi translated">日间趋势</h2><p id="0e8f" class="pw-post-body-paragraph ky kz it la b lb mq ju ld le mr jx lg lh ms lj lk ll mt ln lo lp mu lr ls lt im bi translated">在 EDA 部分中，我们分析了一周中几天的销售情况。我们已经看到星期六和星期一的销售额较高。模型学习的日指数能够捕捉这些模式。让我们想象一下结果。</p><p id="1388" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">可视化每日趋势</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pl"><img src="../Images/122dc778b1b379b4507b5f9e502e4c3d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TjZQ4_9AD7FuJ26gSYdHLw.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Day-wise trend</figcaption></figure><h2 id="548a" class="ol lz it bd ma oq or dn me os ot dp mi lh ou ov mk ll ow ox mm lp oy oz mo pa bi translated">每周趋势</h2><p id="cca1" class="pw-post-body-paragraph ky kz it la b lb mq ju ld le mr jx lg lh ms lj lk ll mt ln lo lp mu lr ls lt im bi translated">在 EDA 部分，我们在一个月的第一周和最后一周看到了一个小高峰。模型学习的周线指数能够捕捉到这种模式。让我们想象一下结果。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pi"><img src="../Images/a89f820f7904591b92b092b566ced7b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1208/format:webp/1*42wANw6fuHtdkl-7GsBkTg.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Weekly Index</figcaption></figure><p id="4585" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">可视化每周趋势</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pl"><img src="../Images/cad4d2a6e9740c1d33cc1052f1018ce4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jPF6gsbVz2_0Q3Sk2nojAA.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Weekly trends</figcaption></figure></div><div class="ab cl nt nu hx nv" role="separator"><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny"/></div><div class="im in io ip iq"><h1 id="ccdb" class="ly lz it bd ma mb oa md me mf ob mh mi jz oc ka mk kc od kd mm kf oe kg mo mp bi translated">6.使用分解组件的更简单和直观的模型</h1><p id="adb5" class="pw-post-body-paragraph ky kz it la b lb mq ju ld le mr jx lg lh ms lj lk ll mt ln lo lp mu lr ls lt im bi translated">我们将利用上述知识设计一个新的简单直观的模型，我们称之为乘法模型。最终的模型方程将是:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pb"><img src="../Images/51398dfbae36162fbb882c0ef0950112.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EWNpR_AkWG6wV5ohBQQgKg.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Model’s equation (1)</figcaption></figure><p id="2c88" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">根据日期，将从计算表中使用 yearly_index、monthly_index、day_index 和 weekNbr_index。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pm"><img src="../Images/bbd22cd1ad06ebfee32fed2fce415222.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5-RHcAuS7GiWS65LYgsDQw.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Coefficients table</figcaption></figure><p id="76eb" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">使用上述模型对 2015 年 9 月 21 日进行预测。它发生在 2015 年 9 月的第三周</p><p id="7555" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">销售= avg sales * Sep _ index * 3rd week _ index * 2015 _ index<br/>= 4825.98 * 0.880 * 0.98 * 0.9425 = 3922.54</p><p id="1393" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">2015 年 12 月 31 日的预测？它发生在 2015 年 12 月的第 5 周</p><p id="c8b3" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">sales = avg sales * Dec _ coefficient * 5th week _ coefficient * 2015 _ index<br/>= 4825.98 * 1.244 * 1.069 * 0.9425 = 6048.74</p></div><div class="ab cl nt nu hx nv" role="separator"><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny"/></div><div class="im in io ip iq"><h1 id="2451" class="ly lz it bd ma mb oa md me mf ob mh mi jz oc ka mk kc od kd mm kf oe kg mo mp bi translated">7.模型的质量分析并利用它获得其他有用的信息</h1><p id="dec2" class="pw-post-body-paragraph ky kz it la b lb mq ju ld le mr jx lg lh ms lj lk ll mt ln lo lp mu lr ls lt im bi translated">同时，还训练了对截距或特征对数没有任何限制的线性回归模型。让我们称之为模型 1 和我们的乘法模型，模型 2。我们对这两个模型进行了为期 3 个月的测试，测试数据来自 50 多家商店的未公开数据。</p><p id="b48c" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在 RMSE 值相似的情况下，这两种模型在均方根误差<a class="ae lv" href="https://en.wikipedia.org/wiki/Root-mean-square_deviation" rel="noopener ugc nofollow" target="_blank">方面的表现基本相同。在某些情况下，与模型 1 相比，模型 2 明显是 RMSE 较低的赢家。一个可能的原因可能是领域知识的供给，avgSales，不允许它过度适应和在看不见的数据上表现良好。</a></p><p id="5fbc" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">比较两个模型性能的代码</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ca"><img src="../Images/45ff70940cb95334f27364058aa1524f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JaLoERz1rCw6vfkfMUTaOA.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Both model performing similarly for most of the cases</figcaption></figure><p id="0e93" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">乘法模型(模型-2)是商店 39、85 和 88 的明显赢家</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pn"><img src="../Images/c395d6eefcf78c1543c40d495d5c332a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_laDqgqpO5znKp1sYGTAKA.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Multiplicative Model is a winner</figcaption></figure><h2 id="73c8" class="ol lz it bd ma oq or dn me os ot dp mi lh ou ov mk ll ow ox mm lp oy oz mo pa bi translated">从乘法模型中获取其他有用信息</h2><p id="e769" class="pw-post-body-paragraph ky kz it la b lb mq ju ld le mr jx lg lh ms lj lk ll mt ln lo lp mu lr ls lt im bi translated">一些重要的信息和有趣的事实可以很容易地从乘法模型中推导出来。比如，如果企业问我们该怎么回答，或者我们如何比较 2014 年 5 月和 2014 年 11 月的销售额。我们使用学到的月、年、日和周指数的值来回答这些问题。</p><p id="0dbc" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">2014 年 5 月= 5 月指数* 2014 年指数= 1.02 * 0.9879 = 1.007</p><p id="e8ab" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">2014 年 11 月= 11 月指数* 2014 指数= 1.051 * 0.9879 = 1.038</p><p id="b1ae" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">与 2014 年 5 月相比，2014 年 11 月的销售额增加了多少</p><p id="fe0d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi">(1.038–1.007)/1.007 = 0.0307</p><p id="bf77" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">因此，2014 年 11 月的季节性比 2014 年 5 月高 3.07%。我们可以跨年度对月、周、日进行类似的比较，并从分解的预测模型中获得更清晰的图像。</p></div><div class="ab cl nt nu hx nv" role="separator"><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny"/></div><div class="im in io ip iq"><h1 id="c301" class="ly lz it bd ma mb oa md me mf ob mh mi jz oc ka mk kc od kd mm kf oe kg mo mp bi translated">8.结论</h1><p id="618d" class="pw-post-body-paragraph ky kz it la b lb mq ju ld le mr jx lg lh ms lj lk ll mt ln lo lp mu lr ls lt im bi translated">这篇博文的主要思想是调整传统模型来分解时间序列，并创建一个更简单和直观的模型。希望目的达到了。让我知道你的想法和我如何能进一步改善这种方法。</p><p id="9cf4" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu"> <em class="lu">我的 Youtube 频道更多内容:</em> </strong></p><div class="po pp gp gr pq pr"><a href="https://www.youtube.com/channel/UCg0PxC9ThQrbD9nM_FU1vWA" rel="noopener  ugc nofollow" target="_blank"><div class="ps ab fo"><div class="pt ab pu cl cj pv"><h2 class="bd iu gy z fp pw fr fs px fu fw is bi translated">阿布舍克·蒙戈利</h2><div class="py l"><h3 class="bd b gy z fp pw fr fs px fu fw dk translated">嗨，伙计们，欢迎来到频道。该频道旨在涵盖各种主题，从机器学习，数据科学…</h3></div><div class="pz l"><p class="bd b dl z fp pw fr fs px fu fw dk translated">www.youtube.com</p></div></div><div class="qa l"><div class="qb l qc qd qe qa qf ks pr"/></div></div></a></div></div></div>    
</body>
</html>