<html>
<head>
<title>Data Pre-processing with Pandas on Trending YouTuBe Video Statistics 〠 ❤︎ ✔︎</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">〠 ❤︎ ✔︎趋势 YouTuBe 视频统计中熊猫的数据预处理</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/data-pre-processing-with-pandas-on-trending-youtube-video-statistics-%EF%B8%8E-%EF%B8%8E-c7ce698fbdcb?source=collection_archive---------22-----------------------#2019-02-24">https://towardsdatascience.com/data-pre-processing-with-pandas-on-trending-youtube-video-statistics-%EF%B8%8E-%EF%B8%8E-c7ce698fbdcb?source=collection_archive---------22-----------------------#2019-02-24</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="5905" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">本文的目的是提供一个标准化的数据预处理解决方案，可以应用于任何类型的数据集。您将学习如何将数据从最初的原始形式转换为另一种格式，以便为探索性分析和机器学习模型准备数据。</p><h1 id="6ae3" class="ko kp it bd kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll bi translated">数据概述</h1><ul class=""><li id="070b" class="lm ln it js b jt lo jx lp kb lq kf lr kj ls kn lt lu lv lw bi translated">这个数据集是来自美国的热门 YouTube 视频的每日记录。</li><li id="82cb" class="lm ln it js b jt lx jx ly kb lz kf ma kj mb kn lt lu lv lw bi translated">数据包括视频标题、频道标题、发布时间、标签、视图、喜欢和不喜欢、描述和评论计数等。</li><li id="37a3" class="lm ln it js b jt lx jx ly kb lz kf ma kj mb kn lt lu lv lw bi translated">数据集的形状是 16580 行* 16 列。</li></ul><h1 id="c354" class="ko kp it bd kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll bi translated">数据预处理路线图</h1><figure class="md me mf mg gt mh gh gi paragraph-image"><div class="gh gi mc"><img src="../Images/6719c8a27c8a1beadc85f2c08a955f15.png" data-original-src="https://miro.medium.com/v2/resize:fit:1142/format:webp/1*qWUkEgmUmv-n_aWBxQWraQ.png"/></div></figure><h1 id="6425" class="ko kp it bd kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll bi translated"><strong class="ak">数据预处理源代码</strong></h1><h2 id="c34f" class="mk kp it bd kq ml mm dn ku mn mo dp ky kb mp mq lc kf mr ms lg kj mt mu lk mv bi translated">数据集的基本观点</h2><pre class="md me mf mg gt mw mx my mz aw na bi"><span id="8a1d" class="mk kp it mx b gy nb nc l nd ne"># A quick look at the dataset. Return 5 random rows.<br/>df.sample(5)</span></pre><figure class="md me mf mg gt mh gh gi paragraph-image"><div role="button" tabindex="0" class="ng nh di ni bf nj"><div class="gh gi nf"><img src="../Images/a38f88fe10fc0ecbb3a7106273b47902.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZzDEWk0hCR4f9SQtpN5zbQ.png"/></div></div></figure><pre class="md me mf mg gt mw mx my mz aw na bi"><span id="a1c0" class="mk kp it mx b gy nb nc l nd ne"># Return data types<br/>df.dtypes</span></pre><figure class="md me mf mg gt mh gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/26c8cc8b15a67c18622fc6c4de1de23f.png" data-original-src="https://miro.medium.com/v2/resize:fit:648/format:webp/1*A0zZSs4TCaoZ7Au2QNQYLQ.png"/></div></figure><pre class="md me mf mg gt mw mx my mz aw na bi"><span id="b94c" class="mk kp it mx b gy nb nc l nd ne"># Dimensions of dataset<br/>df.shape</span></pre><figure class="md me mf mg gt mh gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/37231dc963a3a728b1e03423ef18b52d.png" data-original-src="https://miro.medium.com/v2/resize:fit:216/format:webp/1*YjiRrOFqm9xNFHX4BjKgZQ.png"/></div></figure><pre class="md me mf mg gt mw mx my mz aw na bi"><span id="a596" class="mk kp it mx b gy nb nc l nd ne"># Statistical summary<br/>df.describe()</span></pre><figure class="md me mf mg gt mh gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/ca8939d75b15a21608e96651f63c1335.png" data-original-src="https://miro.medium.com/v2/resize:fit:1094/format:webp/1*DCLy_CoHQBSf2ke4WDA7sw.png"/></div></figure><pre class="md me mf mg gt mw mx my mz aw na bi"><span id="c57c" class="mk kp it mx b gy nb nc l nd ne">df_summary = df.describe(include="all")<br/>df_summary</span></pre><figure class="md me mf mg gt mh gh gi paragraph-image"><div role="button" tabindex="0" class="ng nh di ni bf nj"><div class="gh gi nn"><img src="../Images/07fe669fc1d40019e9378f614a44d576.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zA_dINDeUkgv4wvMboJv9Q.png"/></div></div></figure><ul class=""><li id="e097" class="lm ln it js b jt ju jx jy kb no kf np kj nq kn lt lu lv lw bi translated">“top”是最常出现的项目</li><li id="45d4" class="lm ln it js b jt lx jx ly kb lz kf ma kj mb kn lt lu lv lw bi translated">“频率”是热门项目显示的次数</li><li id="ff70" class="lm ln it js b jt lx jx ly kb lz kf ma kj mb kn lt lu lv lw bi translated">“NaN”表示无法对该类数据进行计算</li></ul><pre class="md me mf mg gt mw mx my mz aw na bi"><span id="06c6" class="mk kp it mx b gy nb nc l nd ne"># Unique value: value counts of a specific column<br/>df['category_id'].value_counts()</span></pre><figure class="md me mf mg gt mh gh gi paragraph-image"><div role="button" tabindex="0" class="ng nh di ni bf nj"><div class="gh gi nr"><img src="../Images/122a0d1cbc8f0504e5d24040e95d9a06.png" data-original-src="https://miro.medium.com/v2/resize:fit:658/format:webp/1*vmfZRDf31WdvSNURvhGSMQ.png"/></div></div></figure><p id="8ce5" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">上图显示了“category_id”列中的唯一值。值“24”的计数是 3911。</p><pre class="md me mf mg gt mw mx my mz aw na bi"><span id="9cef" class="mk kp it mx b gy nb nc l nd ne"># Look at a specific field<br/>df.iloc[23,5]</span></pre><figure class="md me mf mg gt mh gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/8ef9c74d58b85fa2c7d2f9193e488532.png" data-original-src="https://miro.medium.com/v2/resize:fit:408/format:webp/1*SIPlrVWT9PlJ_Qg9MjyO7g.png"/></div></figure><pre class="md me mf mg gt mw mx my mz aw na bi"><span id="2062" class="mk kp it mx b gy nb nc l nd ne"># Look at selected columns<br/>columnWeCareAbout=['title','views','likes','dislikes','comment_count']<br/>df[columnWeCareAbout].sample(5)</span></pre><figure class="md me mf mg gt mh gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/c632bd3f50234eb8885b7044c83d091f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1158/format:webp/1*1lg6GNbnCKt7ILAo3KzXyg.png"/></div></figure><h2 id="d06d" class="mk kp it bd kq ml mm dn ku mn mo dp ky kb mp mq lc kf mr ms lg kj mt mu lk mv bi translated">识别和处理丢失的数据</h2><pre class="md me mf mg gt mw mx my mz aw na bi"><span id="b9c4" class="mk kp it mx b gy nb nc l nd ne"># Use heatmap to check missing data<br/>sns.heatmap(df_summary.isnull(), yticklabels=False, cbar=False, cmap='viridis')</span></pre><figure class="md me mf mg gt mh gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/8b4584c0d39f6162864f68666e8bd820.png" data-original-src="https://miro.medium.com/v2/resize:fit:762/format:webp/1*xzDoeAaPfjbibnj9a0Fd0g.png"/></div></figure><pre class="md me mf mg gt mw mx my mz aw na bi"><span id="f64e" class="mk kp it mx b gy nb nc l nd ne"># See counts of missing value<br/>for c in df_summary.columns:<br/>    print(c,np.sum(df_summary[c].isnull()))</span></pre><figure class="md me mf mg gt mh gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/73e09a7a468649b98838809fe13aacde.png" data-original-src="https://miro.medium.com/v2/resize:fit:592/format:webp/1*NiYch0vDswmN49_jbhQvzg.png"/></div></figure><pre class="md me mf mg gt mw mx my mz aw na bi"><span id="09a2" class="mk kp it mx b gy nb nc l nd ne"># Replace missing data<br/>df_summary['views'].fillna(df_summary['views'].mean(), inplace=True)</span></pre><p id="d34a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">以上代码用平均值填充缺失的数据。你可以在实际案例中考虑插值、中值或其他方法。</p><pre class="md me mf mg gt mw mx my mz aw na bi"><span id="32b0" class="mk kp it mx b gy nb nc l nd ne"># Drop a column most value are missing<br/>df_summary.drop(['thumbnail_link'], axis=1, inplace=True)</span><span id="fb03" class="mk kp it mx b gy nw nc l nd ne">sns.heatmap(df_summary.isnull(), yticklabels=False, cbar=False, cmap='viridis')</span></pre><figure class="md me mf mg gt mh gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/3ede342e434daef83ec1fb22b552a1a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:844/format:webp/1*mTtMdSYx2ZnqYljqIeNZzw.png"/></div><figcaption class="ny nz gj gh gi oa ob bd b be z dk">No missing value detected</figcaption></figure><h2 id="a51b" class="mk kp it bd kq ml mm dn ku mn mo dp ky kb mp mq lc kf mr ms lg kj mt mu lk mv bi translated">数据格式编排</h2><pre class="md me mf mg gt mw mx my mz aw na bi"><span id="c2ee" class="mk kp it mx b gy nb nc l nd ne"># Change data type if needed<br/>df['left_publish_time'] = pd.to_datetime(df['left_publish_time'], format='%Y-%m-%dT%H:%M:%S')</span></pre><div class="md me mf mg gt ab cb"><figure class="oc mh od oe of og oh paragraph-image"><img src="../Images/21886bcf4fbf9d8c3be464f5bc8b4cdb.png" data-original-src="https://miro.medium.com/v2/resize:fit:718/format:webp/1*xcFkZ14WCmV1F7_g8-s6Bw.png"/></figure><figure class="oc mh oi oe of og oh paragraph-image"><img src="../Images/5f785dec6f62d0909fde1cb3a14b6f27.png" data-original-src="https://miro.medium.com/v2/resize:fit:876/format:webp/1*ZYEPTo0s5idMUPsyyuM97A.png"/><figcaption class="ny nz gj gh gi oa ob bd b be z dk oj di ok ol">Change type from object to datetime</figcaption></figure></div><pre class="md me mf mg gt mw mx my mz aw na bi"><span id="0ab4" class="mk kp it mx b gy nb nc l nd ne"># Unit conversion</span><span id="ec7f" class="mk kp it mx b gy nw nc l nd ne"># conversion factor<br/>conv_fac = 0.621371</span><span id="0842" class="mk kp it mx b gy nw nc l nd ne"># calculate miles<br/>miles = kilometers * conv_fac</span></pre><h2 id="b757" class="mk kp it bd kq ml mm dn ku mn mo dp ky kb mp mq lc kf mr ms lg kj mt mu lk mv bi translated">数据标准化</h2><pre class="md me mf mg gt mw mx my mz aw na bi"><span id="24b5" class="mk kp it mx b gy nb nc l nd ne"># Number in different range which influence the result differently<br/>df[['views','likes','dislikes','comment_count']].head()</span></pre><figure class="md me mf mg gt mh gh gi paragraph-image"><div class="gh gi om"><img src="../Images/dfa6fe35230e22dc4a44e8d7864c3f51.png" data-original-src="https://miro.medium.com/v2/resize:fit:686/format:webp/1*8bX-YJ1fPTHsrEjKhuzLyg.png"/></div></figure><pre class="md me mf mg gt mw mx my mz aw na bi"><span id="869d" class="mk kp it mx b gy nb nc l nd ne"># Simple feature scaling<br/>df['views'] = df['views'] / df['views'].max()<br/>df[['views','likes','dislikes','comment_count']].head()</span></pre><figure class="md me mf mg gt mh gh gi paragraph-image"><div role="button" tabindex="0" class="ng nh di ni bf nj"><div class="gh gi on"><img src="../Images/ee42df6765b6069bbea012a137869bdf.png" data-original-src="https://miro.medium.com/v2/resize:fit:690/format:webp/1*8VEmy4eVMm3awdDRcMVjHA.png"/></div></div><figcaption class="ny nz gj gh gi oa ob bd b be z dk">New values in column “views”</figcaption></figure><pre class="md me mf mg gt mw mx my mz aw na bi"><span id="f0a5" class="mk kp it mx b gy nb nc l nd ne"># Min-max<br/>df['likes'] = (df['likes'] - df['likes'].min()) / (df['likes'].max() - df['likes'].min())<br/>df[['views','likes','dislikes','comment_count']].head()</span></pre><figure class="md me mf mg gt mh gh gi paragraph-image"><div class="gh gi oo"><img src="../Images/acbf6b22e0ca2b49aab99973f0da4d73.png" data-original-src="https://miro.medium.com/v2/resize:fit:674/format:webp/1*ixeHEfZFpQ8V6AFdrdtirw.png"/></div><figcaption class="ny nz gj gh gi oa ob bd b be z dk">Normalized value in column “likes”</figcaption></figure><pre class="md me mf mg gt mw mx my mz aw na bi"><span id="aa87" class="mk kp it mx b gy nb nc l nd ne"># Z-score<br/>df['dislikes'] = (df['dislikes'] - df['dislikes'].mean()) / df['dislikes'].std()<br/>df['comment_count'] = (df['comment_count'] - df['comment_count'].mean()) / df['comment_count'].std()</span><span id="c5ed" class="mk kp it mx b gy nw nc l nd ne">df[['views','likes','dislikes','comment_count']].head()</span></pre><figure class="md me mf mg gt mh gh gi paragraph-image"><div class="gh gi op"><img src="../Images/51e21c92a99f5761be281b3abf01928f.png" data-original-src="https://miro.medium.com/v2/resize:fit:720/format:webp/1*jdpH5nHylFzmRLYbI6e0lg.png"/></div></figure><h2 id="5535" class="mk kp it bd kq ml mm dn ku mn mo dp ky kb mp mq lc kf mr ms lg kj mt mu lk mv bi translated">扔掉</h2><ul class=""><li id="30ec" class="lm ln it js b jt lo jx lp kb lq kf lr kj ls kn lt lu lv lw bi translated">将值分组到箱中</li><li id="e4d2" class="lm ln it js b jt lx jx ly kb lz kf ma kj mb kn lt lu lv lw bi translated">将数值转换成分类变量</li><li id="57ef" class="lm ln it js b jt lx jx ly kb lz kf ma kj mb kn lt lu lv lw bi translated">“喜欢”是数字，我们希望将其转换为“低”、“中”、“高”，以更好地表示视频的受欢迎程度</li></ul><pre class="md me mf mg gt mw mx my mz aw na bi"><span id="e501" class="mk kp it mx b gy nb nc l nd ne">binwidth = int(max(df['likes'])-min(df['likes']))/3<br/>binwidth</span></pre><figure class="md me mf mg gt mh gh gi paragraph-image"><div class="gh gi oq"><img src="../Images/4640aa75f1aa3f4208088285c467495e.png" data-original-src="https://miro.medium.com/v2/resize:fit:138/format:webp/1*Cb-Mb04rWAHPtaNYG8I0Gw.png"/></div></figure><pre class="md me mf mg gt mw mx my mz aw na bi"><span id="bebb" class="mk kp it mx b gy nb nc l nd ne">bins = range(min(df['likes']), max(df['likes']),binwidth)<br/>group_names = ['Low','Medium','High']<br/>df['likes-binned'] = pd.cut(df['likes'], bins, labels=group_names)<br/>df['likes-binned']</span></pre><figure class="md me mf mg gt mh gh gi paragraph-image"><div class="gh gi or"><img src="../Images/a819dd4fac776fca09e8281837cb4c0e.png" data-original-src="https://miro.medium.com/v2/resize:fit:324/format:webp/1*7-DYJrRbQAc4iYuM0pAAiQ.png"/></div></figure><figure class="md me mf mg gt mh gh gi paragraph-image"><div class="gh gi os"><img src="../Images/e5696bb8ccc47766d51c853cb4d9dc9e.png" data-original-src="https://miro.medium.com/v2/resize:fit:824/format:webp/1*3i1B64zy7inhy5g14yO-mQ.png"/></div><figcaption class="ny nz gj gh gi oa ob bd b be z dk">Visualizing binned data</figcaption></figure><h2 id="92c4" class="mk kp it bd kq ml mm dn ku mn mo dp ky kb mp mq lc kf mr ms lg kj mt mu lk mv bi translated">一键编码</h2><ul class=""><li id="f2fc" class="lm ln it js b jt lo jx lp kb lq kf lr kj ls kn lt lu lv lw bi translated">为每个独特的类别添加虚拟变量</li><li id="f48b" class="lm ln it js b jt lx jx ly kb lz kf ma kj mb kn lt lu lv lw bi translated">在每个类别中分配 0 或 1</li><li id="1e80" class="lm ln it js b jt lx jx ly kb lz kf ma kj mb kn lt lu lv lw bi translated">将分类变量转换为数值</li></ul><pre class="md me mf mg gt mw mx my mz aw na bi"><span id="8c47" class="mk kp it mx b gy nb nc l nd ne">df['category_id'].sample(5)</span></pre><figure class="md me mf mg gt mh gh gi paragraph-image"><div class="gh gi oo"><img src="../Images/e8219658fff68f224d4817415443e3fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:674/format:webp/1*do_DEgve1XYtwPEap7kQUw.png"/></div></figure><pre class="md me mf mg gt mw mx my mz aw na bi"><span id="3643" class="mk kp it mx b gy nb nc l nd ne">category = pd.get_dummies(df['category_id'], drop_first=True)<br/>category.head()</span></pre><figure class="md me mf mg gt mh gh gi paragraph-image"><div class="gh gi ot"><img src="../Images/feb9863d686e29c12a3185f0d27e6bac.png" data-original-src="https://miro.medium.com/v2/resize:fit:842/format:webp/1*xfERDNQy_yloWcGj-fzSDg.png"/></div></figure><pre class="md me mf mg gt mw mx my mz aw na bi"><span id="83b3" class="mk kp it mx b gy nb nc l nd ne"># Add dummy values into data frame<br/>df = pd.concat([df, category], axis=1)<br/>df.sample(5)</span></pre><figure class="md me mf mg gt mh gh gi paragraph-image"><div class="gh gi ou"><img src="../Images/c899fce4f7cb4e6cd29f01083dd2a938.png" data-original-src="https://miro.medium.com/v2/resize:fit:880/format:webp/1*RHxYXkH7P2-WkeCxgLEOgQ.png"/></div></figure><h2 id="9c62" class="mk kp it bd kq ml mm dn ku mn mo dp ky kb mp mq lc kf mr ms lg kj mt mu lk mv bi translated">应用 IF 条件</h2><pre class="md me mf mg gt mw mx my mz aw na bi"><span id="608b" class="mk kp it mx b gy nb nc l nd ne"># Add a column base on the conditions</span><span id="8acf" class="mk kp it mx b gy nw nc l nd ne"># df.loc[df.column_name condition, 'new column name'] = 'value if condition is met'</span><span id="4ab9" class="mk kp it mx b gy nw nc l nd ne">df.loc[ df['likes'] &gt; 1000 | df['views'] &gt; 10000, 'popularity'] = 'Yes'  <br/>df.loc[ df['likes'] &lt;= 1000 &amp; df['views'] &lt;= 10000, 'popularity'] = 'No'</span></pre><p id="f260" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">恭喜你。您完成了一篇冗长的文章，现在您知道了一个标准化的数据预处理解决方案，可以应用于任何类型的数据集。你的数据科学家难题又多了一块！源数据可以在这个<a class="ae ov" href="https://www.kaggle.com/datasnaek/youtube-new" rel="noopener ugc nofollow" target="_blank">链接</a>找到。</p><p id="06ea" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">测验:为什么我们需要数据标准化？</p></div><div class="ab cl ow ox hx oy" role="separator"><span class="oz bw bk pa pb pc"/><span class="oz bw bk pa pb pc"/><span class="oz bw bk pa pb"/></div><div class="im in io ip iq"><p id="aa37" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">下一步:探索性数据分析(EDA ),熊猫对 YouTuBe 视频统计数据进行趋势分析</p></div></div>    
</body>
</html>