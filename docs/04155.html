<html>
<head>
<title>Automate your Python Scripts with Task Scheduler</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用任务调度器自动化您的 Python 脚本</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/automate-your-python-scripts-with-task-scheduler-661d0a40b279?source=collection_archive---------0-----------------------#2019-06-30">https://towardsdatascience.com/automate-your-python-scripts-with-task-scheduler-661d0a40b279?source=collection_archive---------0-----------------------#2019-06-30</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="a157" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph">数据专业人员权威指南</h2><div class=""/><div class=""><h2 id="31c5" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">Windows 任务计划程序抓取替代数据</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/ed91232274bcb6d0415e64a0376cc079.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*FXOxBCj7qoODjAfH.jpg"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk">Credit: Stocksnap</figcaption></figure><blockquote class="lh li lj"><p id="0d7b" class="lk ll lm ln b lo lp kd lq lr ls kg lt lu lv lw lx ly lz ma mb mc md me mf mg im bi translated">每天运行我的 Python 脚本太麻烦了。</p><p id="c569" class="lk ll lm ln b lo lp kd lq lr ls kg lt lu lv lw lx ly lz ma mb mc md me mf mg im bi translated">我需要一种定期自动运行我的 Python 脚本的方法</p></blockquote><p id="5a8c" class="pw-post-body-paragraph lk ll it ln b lo lp kd lq lr ls kg lt mh lv lw lx mi lz ma mb mj md me mf mg im bi translated">想象一下，你的经理让你半夜醒来运行一个脚本。这将是你最大的噩梦。你过早醒来，暴露在可怕的蓝光下，每天午夜都不能好好睡觉。</p><p id="a163" class="pw-post-body-paragraph lk ll it ln b lo lp kd lq lr ls kg lt mh lv lw lx mi lz ma mb mj md me mf mg im bi translated">作为任何数据专业人员，您可能需要运行多个脚本来生成报告或部署分析管道。因此，你需要了解一下<strong class="ln jd">计划者</strong>来避免破坏你的周末。</p><blockquote class="lh li lj"><p id="365f" class="lk ll lm ln b lo lp kd lq lr ls kg lt lu lv lw lx ly lz ma mb mc md me mf mg im bi translated">每个数据工程师和科学家在某个时间点都需要运行定期任务。</p></blockquote><p id="83f7" class="pw-post-body-paragraph lk ll it ln b lo lp kd lq lr ls kg lt mh lv lw lx mi lz ma mb mj md me mf mg im bi translated">根据定义，周期性任务是指在没有或很少人工干预的情况下，按照一定的时间间隔重复执行的任务。在数据和技术快速发展的时期，你需要运行脚本来开发数据库备份、Twitter 流等。</p><p id="06e4" class="pw-post-body-paragraph lk ll it ln b lo lp kd lq lr ls kg lt mh lv lw lx mi lz ma mb mj md me mf mg im bi translated">幸运的是，有了任务调度器，您现在可以根据需要每天/每周/每月/每年运行 Python 脚本来执行定期任务。</p><p id="40c2" class="pw-post-body-paragraph lk ll it ln b lo lp kd lq lr ls kg lt mh lv lw lx mi lz ma mb mj md me mf mg im bi translated">在本教程中，您将学习如何运行任务调度程序来从 Lazada (电子商务)网站的<a class="ae mk" rel="noopener" target="_blank" href="/in-10-minutes-web-scraping-with-beautiful-soup-and-selenium-for-data-professionals-8de169d36319">网页抓取数据，并将其转储到</a><a class="ae mk" rel="noopener" target="_blank" href="/relational-database-management-rdbms-basic-for-data-professionals-aca3567f03da"> SQLite RDBMS </a>数据库中。</p><p id="2136" class="pw-post-body-paragraph lk ll it ln b lo lp kd lq lr ls kg lt mh lv lw lx mi lz ma mb mj md me mf mg im bi translated">这是自动运行您的脚本的快速一瞥！</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi ml"><img src="../Images/a74825ce52dcb6ac5499edf9ef11a9f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*4mMQZUInec491zWyb2pufQ.gif"/></div><figcaption class="ld le gj gh gi lf lg bd b be z dk">Running Web Scraping Scripts with Task Scheduler then append it to SQLite Disk</figcaption></figure><blockquote class="mm"><p id="d1a5" class="mn mo it bd mp mq mr ms mt mu mv mg dk translated">我们开始吧！</p></blockquote><h1 id="5d1a" class="mw mx it bd my mz na nb nc nd ne nf ng ki nh kj ni kl nj km nk ko nl kp nm nn bi translated">这些方法</h1><p id="c4d9" class="pw-post-body-paragraph lk ll it ln b lo no kd lq lr np kg lt mh nq lw lx mi nr ma mb mj ns me mf mg im bi translated">在本教程中，我们将使用 Windows 任务计划程序运行 bat 脚本，该脚本将触发 Python 脚本。要执行这些脚本，我们有两个简单的步骤:</p><ol class=""><li id="a948" class="nt nu it ln b lo lp lr ls mh nv mi nw mj nx mg ny nz oa ob bi translated">创建 Python 可执行文件(bat 文件)</li><li id="5346" class="nt nu it ln b lo oc lr od mh oe mi of mj og mg ny nz oa ob bi translated">在 Windows 任务计划程序中配置任务</li></ol><p id="8da7" class="pw-post-body-paragraph lk ll it ln b lo lp kd lq lr ls kg lt mh lv lw lx mi lz ma mb mj md me mf mg im bi translated">但是，如果您是 Linux 用户，并且没有可用的 Windows 任务调度程序，您应该使用<a class="ae mk" href="https://medium.com/@Ratik96/https-medium-com-ratik96-scheduling-jobs-with-crontab-on-macos-add5a8b26c30" rel="noopener"> cron 调度程序</a>。</p><h1 id="223c" class="mw mx it bd my mz na nb nc nd ne nf ng ki oh kj ni kl oi km nk ko oj kp nm nn bi translated">创建 Windows 可执行 bat 文件以运行 Python</h1><blockquote class="lh li lj"><p id="190a" class="lk ll lm ln b lo lp kd lq lr ls kg lt lu lv lw lx ly lz ma mb mc md me mf mg im bi translated">一个<strong class="ln jd"> BAT 文件</strong>是一个 DOS <strong class="ln jd">批处理文件</strong>用来执行 Windows 命令提示符(cmd.exe)下的命令。它包含一系列通常可能在 DOS 命令提示符下输入的行命令。<strong class="ln jd"> BAT 文件</strong>最常用于在 Windows 中启动程序和运行维护实用程序。—fileinfo.com</p></blockquote><p id="3eeb" class="pw-post-body-paragraph lk ll it ln b lo lp kd lq lr ls kg lt mh lv lw lx mi lz ma mb mj md me mf mg im bi translated">使用 bat 文件作为我们的可执行文件，我们将运行脚本存储在一个文件中，然后双击 bat 文件，在 cmd(命令提示符)上执行命令来运行 python 脚本。</p><p id="9b28" class="pw-post-body-paragraph lk ll it ln b lo lp kd lq lr ls kg lt mh lv lw lx mi lz ma mb mj md me mf mg im bi translated">你需要做的就是创建一个新的 bat 文件(例如:web-scraping.bat)并编写可执行脚本，格式为<strong class="ln jd"> &lt;你的 Python.exe 位置&gt; &lt;你的 python 脚本位置&gt; </strong>。可以添加<em class="lm">暂停</em>命令，避免执行后关闭命令提示符。</p><pre class="ks kt ku kv gt ok ol om on aw oo bi"><span id="40f8" class="op mx it ol b gy oq or l os ot">C:\new_software\finance\Scripts\python.exe "C:/new_software/Web Scraping/Web-Scraping/Selenium Web Scraping/scraping-lazada.py"<br/>pause</span></pre><p id="103d" class="pw-post-body-paragraph lk ll it ln b lo lp kd lq lr ls kg lt mh lv lw lx mi lz ma mb mj md me mf mg im bi translated">一旦你双击这个 bat 文件，Windows 将打开你的命令提示符并运行网页抓取工具。为了调度这个双击/执行，我们将把我们的任务调度器挂接到 bat 文件。</p><h1 id="7134" class="mw mx it bd my mz na nb nc nd ne nf ng ki oh kj ni kl oi km nk ko oj kp nm nn bi translated">在 Windows 任务计划程序中配置任务</h1><p id="50e3" class="pw-post-body-paragraph lk ll it ln b lo no kd lq lr np kg lt mh nq lw lx mi nr ma mb mj ns me mf mg im bi translated"><strong class="ln jd"> Windows 任务调度器</strong>是一个默认的 Windows 应用程序，用于管理任务以响应基于事件或基于时间的触发。例如，你可以建议某个点击和计算机动作(比如重启)，甚至建议像每个财政季度第一天的<em class="lm">这样的时间来执行任务。</em></p><p id="6c5b" class="pw-post-body-paragraph lk ll it ln b lo lp kd lq lr ls kg lt mh lv lw lx mi lz ma mb mj md me mf mg im bi translated">从更大的角度来看，这个任务将包含脚本和元数据，以定义将执行什么操作以及如何执行操作。您可以在参数中添加特定的安全上下文，并控制调度程序将在何处运行程序。Windows 将把所有这些任务序列化为<strong class="ln jd">。作业</strong>文件放在一个叫做<strong class="ln jd">任务文件夹</strong>的特殊文件夹中。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ou"><img src="../Images/0507a39a1ab15aa5b740098b10109567.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*F-gCBEpQioL5bfrKTBwW2w.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk">The process flow of Task Scheduler to automate application’s web scraping</figcaption></figure><p id="cde9" class="pw-post-body-paragraph lk ll it ln b lo lp kd lq lr ls kg lt mh lv lw lx mi lz ma mb mj md me mf mg im bi translated">在本教程中，我们将设置一个基于时间的事件来运行我们的应用程序，并将数据转储到 SQLite 中。总共有多少</p><ol class=""><li id="8f44" class="nt nu it ln b lo lp lr ls mh nv mi nw mj nx mg ny nz oa ob bi translated">点击开始窗口，搜索任务计划程序，并打开它。</li><li id="e09b" class="nt nu it ln b lo oc lr od mh oe mi of mj og mg ny nz oa ob bi translated">单击右侧窗口中的创建基本任务</li><li id="0607" class="nt nu it ln b lo oc lr od mh oe mi of mj og mg ny nz oa ob bi translated">选择你的触发时间。</li><li id="31a5" class="nt nu it ln b lo oc lr od mh oe mi of mj og mg ny nz oa ob bi translated">为我们之前的选择选择准确的时间。</li><li id="1254" class="nt nu it ln b lo oc lr od mh oe mi of mj og mg ny nz oa ob bi translated">开始一项计划</li><li id="e631" class="nt nu it ln b lo oc lr od mh oe mi of mj og mg ny nz oa ob bi translated">在之前保存 bat 文件的地方插入程序脚本。</li><li id="3238" class="nt nu it ln b lo oc lr od mh oe mi of mj og mg ny nz oa ob bi translated">单击完成。</li></ol><h2 id="a6d1" class="op mx it bd my ov ow dn nc ox oy dp ng mh oz pa ni mi pb pc nk mj pd pe nm iz bi translated">我们开始吧！</h2><ol class=""><li id="01a4" class="nt nu it ln b lo no lr np mh pf mi pg mj ph mg ny nz oa ob bi translated"><strong class="ln jd">点击开始窗口，搜索任务调度器，打开</strong>。</li></ol><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi pi"><img src="../Images/9a22c4e0b1f2ebd276d2a7392f3042bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mZQ2Zy5su6r8QzCaGpLckw.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk">Task Scheduler Windows</figcaption></figure><p id="0f13" class="pw-post-body-paragraph lk ll it ln b lo lp kd lq lr ls kg lt mh lv lw lx mi lz ma mb mj md me mf mg im bi translated">2.<strong class="ln jd">在右侧窗口</strong>点击创建基本任务。</p><p id="d6f8" class="pw-post-body-paragraph lk ll it ln b lo lp kd lq lr ls kg lt mh lv lw lx mi lz ma mb mj md me mf mg im bi translated">你应该把你的任务名称(如:网页抓取)和描述(如:网页抓取和 SQLite 转储自动每天下午 6 点)</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi pj"><img src="../Images/517296bb630f2ae8c5606d17fd6bfbd2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rcZMqC46mIHnEkvTCNY87w.png"/></div></div></figure><p id="acdb" class="pw-post-body-paragraph lk ll it ln b lo lp kd lq lr ls kg lt mh lv lw lx mi lz ma mb mj md me mf mg im bi translated">3.<strong class="ln jd">选择您的触发时间</strong>。</p><p id="f184" class="pw-post-body-paragraph lk ll it ln b lo lp kd lq lr ls kg lt mh lv lw lx mi lz ma mb mj md me mf mg im bi translated">你可以选择每天，每周，甚至每月触发时间。从逻辑上讲，这种选择很大程度上取决于您希望刷新数据源中的值的频率。例如，如果您的任务是收集 MarketWatch 股票资产负债表，您应该在每个财务季度运行这些脚本。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi pj"><img src="../Images/1930c6fe55594359c4ffc7326608622a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xVl7Y3UWv4dGDV9GFCE8Ww.png"/></div></div></figure><p id="31fb" class="pw-post-body-paragraph lk ll it ln b lo lp kd lq lr ls kg lt mh lv lw lx mi lz ma mb mj md me mf mg im bi translated">4.<strong class="ln jd">为我们之前的选择选择准确的时间</strong>。</p><p id="08a1" class="pw-post-body-paragraph lk ll it ln b lo lp kd lq lr ls kg lt mh lv lw lx mi lz ma mb mj md me mf mg im bi translated">我们将选择一月、四月、七月和九月来表示所有早期财务季度。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi pj"><img src="../Images/6cf700f959a0c3c736a9c4bb6efcdb3b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AJt6qLbO4lyBF4tI0x3BwQ.png"/></div></div></figure><p id="b991" class="pw-post-body-paragraph lk ll it ln b lo lp kd lq lr ls kg lt mh lv lw lx mi lz ma mb mj md me mf mg im bi translated">5.<strong class="ln jd">启动程序</strong></p><p id="634e" class="pw-post-body-paragraph lk ll it ln b lo lp kd lq lr ls kg lt mh lv lw lx mi lz ma mb mj md me mf mg im bi translated">在这里，您将能够启动 Python 脚本，发送电子邮件，甚至显示消息。请随意选择你最喜欢的。但是，您应该小心，因为有一些不推荐使用的任务将在后续补丁中删除。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi pj"><img src="../Images/c297ba2f91334cf7658a7a4302d27672.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qvt7Z6rQE_MpoNqONhXd8w.png"/></div></div></figure><p id="0cfc" class="pw-post-body-paragraph lk ll it ln b lo lp kd lq lr ls kg lt mh lv lw lx mi lz ma mb mj md me mf mg im bi translated">6.在之前保存 bat 文件的地方插入程序脚本。</p><p id="9a72" class="pw-post-body-paragraph lk ll it ln b lo lp kd lq lr ls kg lt mh lv lw lx mi lz ma mb mj md me mf mg im bi translated">这将自动运行 Python 脚本的任务调度程序。确保在应用程序文件夹的位置包含 Start in，以便访问所有相关的元素(Selenium Browser 可执行文件/ SQLite 磁盘)</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi pj"><img src="../Images/6272d2fe9166e2965031adb320798b32.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FlaW7UWGzgUNJqmyT7LM7A.png"/></div></div></figure><p id="af2d" class="pw-post-body-paragraph lk ll it ln b lo lp kd lq lr ls kg lt mh lv lw lx mi lz ma mb mj md me mf mg im bi translated">7.<strong class="ln jd">点击完成</strong>。</p><p id="5043" class="pw-post-body-paragraph lk ll it ln b lo lp kd lq lr ls kg lt mh lv lw lx mi lz ma mb mj md me mf mg im bi translated">您可以在任务计划程序的首页查看您创建的任务计划。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi pk"><img src="../Images/29f4bba56467c5668a18bb4297c4fecf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bXZJFbumCoG36syta-GlwA.png"/></div></div></figure><blockquote class="mm"><p id="da40" class="mn mo it bd mp mq mr ms mt mu mv mg dk translated">祝贺您，您已经在 Windows 中设置了第一个自动计划程序。</p></blockquote><h1 id="a005" class="mw mx it bd my mz na nb nc nd ne nf ng ki nh kj ni kl nj km nk ko nl kp nm nn bi translated">结果</h1><p id="4d08" class="pw-post-body-paragraph lk ll it ln b lo no kd lq lr np kg lt mh nq lw lx mi nr ma mb mj ns me mf mg im bi translated">下面是 gif 动画，供大家参考。请注意调度程序是如何自己运行 Python 脚本的。一旦脚本运行完毕，它会将提取的值转储到 SQLite 数据库中。将来，该应用程序将在每次满足触发条件时运行，并将更新后的值追加到 SQLite 中。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi ml"><img src="../Images/a74825ce52dcb6ac5499edf9ef11a9f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*4mMQZUInec491zWyb2pufQ.gif"/></div><figcaption class="ld le gj gh gi lf lg bd b be z dk">Running Web Scraping Scripts with Task Scheduler then append it to SQLite Disk</figcaption></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi pl"><img src="../Images/711f965ebd99295cd6253e8ba9ea1546.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kmgbxc_M5JWRCzTG5EL3yw.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk">Data appended into SQLite using Task Scheduler</figcaption></figure><h2 id="4e49" class="op mx it bd my ov ow dn nc ox oy dp ng mh oz pa ni mi pb pc nk mj pd pe nm iz bi translated">最后…</h2><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi pm"><img src="../Images/0598e9a3cdec30f1409cb6ee4ae8a8ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*GyLaSQxHu0RWXVGY"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk">Boy laughing while reading a book, source: Unsplash</figcaption></figure><p id="4a40" class="pw-post-body-paragraph lk ll it ln b lo lp kd lq lr ls kg lt mh lv lw lx mi lz ma mb mj md me mf mg im bi translated">我真的希望这是一本很棒的读物，是你发展和创新的灵感来源。</p><p id="82f1" class="pw-post-body-paragraph lk ll it ln b lo lp kd lq lr ls kg lt mh lv lw lx mi lz ma mb mj md me mf mg im bi translated">请<strong class="ln jd">在下面评论</strong>出来建议和反馈。</p><p id="2842" class="pw-post-body-paragraph lk ll it ln b lo lp kd lq lr ls kg lt mh lv lw lx mi lz ma mb mj md me mf mg im bi translated">如果你真的喜欢它，请查看我的个人资料。还有更多关于数据分析和 Python 项目的文章会让你感兴趣。</p><p id="1da9" class="pw-post-body-paragraph lk ll it ln b lo lp kd lq lr ls kg lt mh lv lw lx mi lz ma mb mj md me mf mg im bi translated">快乐编码:)</p><h1 id="f668" class="mw mx it bd my mz na nb nc nd ne nf ng ki oh kj ni kl oi km nk ko oj kp nm nn bi translated">关于作者</h1><p id="5193" class="pw-post-body-paragraph lk ll it ln b lo no kd lq lr np kg lt mh nq lw lx mi nr ma mb mj ns me mf mg im bi translated">Vincent Tatan 是一名数据和技术爱好者，拥有在 Visa Inc .和 Lazada 实施微服务架构、商业智能和分析管道项目<a class="ae mk" href="https://bit.ly/2I8jkWV." rel="noopener ugc nofollow" target="_blank">的相关工作经验。</a></p><p id="cee0" class="pw-post-body-paragraph lk ll it ln b lo lp kd lq lr ls kg lt mh lv lw lx mi lz ma mb mj md me mf mg im bi translated">Vincent 是土生土长的印度尼西亚人，在解决问题方面成绩斐然，擅长全栈开发、数据分析和战略规划。</p><p id="d165" class="pw-post-body-paragraph lk ll it ln b lo lp kd lq lr ls kg lt mh lv lw lx mi lz ma mb mj md me mf mg im bi translated">他一直积极咨询 SMU BI &amp; Analytics Club，指导来自不同背景的有抱负的数据科学家和工程师，并为企业开发他们的产品开放他的专业知识。</p><p id="066a" class="pw-post-body-paragraph lk ll it ln b lo lp kd lq lr ls kg lt mh lv lw lx mi lz ma mb mj md me mf mg im bi translated">请通过<a class="ae mk" href="http://www.linkedin.com/in/vincenttatan/" rel="noopener ugc nofollow" target="_blank"> <strong class="ln jd"> LinkedIn </strong> </a> <strong class="ln jd">，</strong><a class="ae mk" href="https://medium.com/@vincentkernn" rel="noopener"><strong class="ln jd">Medium</strong></a><strong class="ln jd">或</strong> <a class="ae mk" href="https://www.youtube.com/user/vincelance1/videos" rel="noopener ugc nofollow" target="_blank"> <strong class="ln jd"> Youtube 频道</strong> </a>联系文森特</p></div></div>    
</body>
</html>