<html>
<head>
<title>Is the Difficulty Bomb Exploding</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">难度炸弹爆炸了吗</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/quickblarks-62aa90169ff0?source=collection_archive---------22-----------------------#2019-01-21">https://towardsdatascience.com/quickblarks-62aa90169ff0?source=collection_archive---------22-----------------------#2019-01-21</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="1a4a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我想与你分享(通过一系列图表)当一个人在新鲜出炉的以太坊难度数据上发布像<a class="kl km ep" href="https://medium.com/u/d272dbeef59a?source=post_page-----62aa90169ff0--------------------------------" rel="noopener" target="_blank"> Ed Mazurek </a>这样的世界级数据科学家时会发生什么。</p><p id="5683" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你得到了 QuickBlarks(如果你想知道的话，这是“QuickBlocks”和“R”的组合<a class="ae kn" href="https://www.google.com/search?q=define+portmanteau&amp;rlz=1C5CHFA_enUS740US740&amp;oq=define+portman&amp;aqs=chrome.0.0j69i57j0l4.4375j1j7&amp;sourceid=chrome&amp;ie=UTF-8" rel="noopener ugc nofollow" target="_blank">)。如果你不知道“R”和</a><a class="ae kn" href="https://www.rstudio.com/" rel="noopener ugc nofollow" target="_blank"> R 工作室</a>，你应该知道。太神奇了。</p><p id="bfda" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在几乎没有任何解释的情况下，我将把“R”代码复制并粘贴到用于创建它的图表旁边。问艾德代码是什么意思。</p><p id="6043" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">逗号分隔的数据如下所示:</p><blockquote class="ko kp kq"><p id="a8d4" class="jn jo kr jp b jq jr js jt ju jv jw jx ks jz ka kb kt kd ke kf ku kh ki kj kk ij bi translated">块号，时间戳，难度<br/>11438269988，17171480576<br/>21438270017，17163096064<br/>31438270048，17154715646<br/>41438270077，17146339321 <br/> …</p></blockquote><p id="d1bc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在编写本报告时，已生成的 7，105，056 个数据块中的每一个都有一条记录。下面是一些初步的设置代码，用于读取数据并对其进行一些清理。</p><pre class="kv kw kx ky gt kz la lb lc aw ld bi"><span id="bc8a" class="le lf iq la b gy lg lh l li lj">require(tidyverse)<br/>require(scales)<br/>require(dplyr)<br/>require(magrittr)</span><span id="58e0" class="le lf iq la b gy lk lh l li lj">homestead.block &lt;- 1150000<br/>byzantium.block &lt;- 4370000<br/>bin_size &lt;- 200<br/>period_size &lt;- 100000<br/>sample_size &lt;- 50000</span><span id="fcb3" class="le lf iq la b gy lk lh l li lj">difficulty &lt;- read_csv(‘difficulty-generated-1a.csv’) %&gt;%<br/> filter(block.number &gt; homestead.block) %&gt;%<br/> mutate(block.bin = floor(block.number / bin_size) * bin_size) %&gt;%<br/> mutate(fake.block =<br/>   ifelse(block.number &gt;= byzantium.block,<br/>      block.number — 3000000,<br/>      block.number) + 1) %&gt;%<br/> mutate(period = floor(fake.block / period_size)) %&gt;%<br/> mutate(bomb = 2 ^ period) %&gt;%<br/> mutate(parent.difficulty = lag(difficulty)) %&gt;%<br/> mutate(parent.ts = lag(timestamp)) %&gt;%<br/> mutate(diff.delta = difficulty — parent.difficulty) %&gt;%<br/> mutate(ts.delta = timestamp — parent.ts) %&gt;%<br/> mutate(diff.sensitivity = diff.delta / difficulty) %&gt;%<br/> mutate(ts.sensitivity = ts.delta / timestamp)</span><span id="992c" class="le lf iq la b gy lk lh l li lj">current.block &lt;- difficulty$block.number %&gt;% tail(1)<br/>current.bomb &lt;- max(difficulty$bomb)</span></pre><h2 id="d9ae" class="le lf iq bd ll lm ln dn lo lp lq dp lr jy ls lt lu kc lv lw lx kg ly lz ma mb bi translated">代码</h2><p id="063b" class="pw-post-body-paragraph jn jo iq jp b jq mc js jt ju md jw jx jy me ka kb kc mf ke kf kg mg ki kj kk ij bi translated">这是我们第一个图表的代码:</p><pre class="kv kw kx ky gt kz la lb lc aw ld bi"><span id="a3d5" class="le lf iq la b gy lg lh l li lj">difficulty %&gt;%<br/>    sample_n(sample_size) %&gt;%<br/>    group_by(block.bin) %&gt;%<br/>    ggplot(aes(x=block.number)) +<br/>    geom_line(aes(y=diff.delta, color=’diff.delta’)) +<br/>    geom_line(aes(y=bomb, color=’bomb’))</span></pre><p id="6032" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这是第一个图表，显示了前 710 万个块中每个块的<code class="fe mh mi mj la b">difficulty</code>中的<code class="fe mh mi mj la b">delta</code>。它还用红线显示了难度炸弹。你可以看到它又爬上来了。</p><figure class="kv kw kx ky gt ml gh gi paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><div class="gh gi mk"><img src="../Images/e32ac0da23e60aaaf442eb08a9f9677d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Fi-ioDLHofYwpB8WZtOLDw.png"/></div></div></figure></div><div class="ab cl ms mt hu mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="ij ik il im in"><p id="f878" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">下一个图表，是用这段代码制作的，</p><pre class="kv kw kx ky gt kz la lb lc aw ld bi"><span id="7596" class="le lf iq la b gy lg lh l li lj">difficulty %&gt;%<br/>    sample_n(sample_size) %&gt;%<br/>    group_by(block.bin) %&gt;%<br/>    ggplot(aes(x=block.number)) +<br/>    geom_line(aes(y=diff.sensitivity, color=’diff.sensitivity’))</span></pre><p id="0489" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">显示难度计算对当前情况的“反应”。我们用<code class="fe mh mi mj la b">diff.delta</code>除以<code class="fe mh mi mj la b">block.difficulty</code>来计算<code class="fe mh mi mj la b">sensitivity</code>。我不确定，但我认为 jaggys 来自于难度值的计算方式。它捕捉到下一个最近的 10 秒来调整，所以 10，11，12，… 19 都给出相同的调整，但 20，21，22，…给出不同的调整。</p><figure class="kv kw kx ky gt ml gh gi paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><div class="gh gi mz"><img src="../Images/989c83235dda60712130d6a21d0ea7ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_mzRfLsBraa1VmYwAVM1SA.png"/></div></div><figcaption class="na nb gj gh gi nc nd bd b be z dk">Sensitivity vs. Block Number</figcaption></figure></div><div class="ab cl ms mt hu mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="ij ik il im in"><p id="7fe4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">下一个图表，由这个“R”代码生成，</p><pre class="kv kw kx ky gt kz la lb lc aw ld bi"><span id="5b4f" class="le lf iq la b gy lg lh l li lj">difficulty %&gt;%<br/> group_by(block.bin) %&gt;%<br/> summarize(sum.diff.delta = sum(diff.delta), na.rm=T) %&gt;%<br/> ggplot(aes(x=block.bin, y=sum.diff.delta)) +<br/> geom_line()</span></pre><p id="3573" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">显示<code class="fe mh mi mj la b">diff.delta</code>值的累计和。可以清楚的看到前拜占庭难度炸弹发动的战斗。上，下，上，下。事实上，难度在目标附近徘徊正是难度计算器应该做的。它保持块的时序一致。</p><p id="b4cf" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="kl km ep" href="https://medium.com/u/9f3988a56032?source=post_page-----62aa90169ff0--------------------------------" rel="noopener" target="_blank">莱恩·雷蒂格</a>想知道，由于当前链的散列率增加，难度炸弹的效果是否会被掩盖。我不确定(我什么都不确定)，但自拜占庭以来积木难度的更广泛传播可能表明他的直觉是正确的。难度炸弹是不是藏在大黑静电里？</p><figure class="kv kw kx ky gt ml gh gi paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><div class="gh gi mz"><img src="../Images/3cec36b1f69ebe4f50c850ff4957d2aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MMEMlQ5cO4g8zSi4BMaoIw.png"/></div></div></figure><p id="7b8d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在下面的图表中，我们展示了一些用更多的“R”代码制作的其他东西。在本节中，我们计算数据块时间戳平均值的差值，或者数据块时间戳差值的平均值，然后根据之前的图表(如果你想理解，你必须问 Ed)。</p><pre class="kv kw kx ky gt kz la lb lc aw ld bi"><span id="1ed5" class="le lf iq la b gy lg lh l li lj">difficulty %&gt;%<br/> group_by(block.bin) %&gt;%<br/> summarize(sum.diff.delta = sum(diff.delta, na.rm=T), mean.ts.delta = mean(ts.delta, na.rm=T)) %&gt;%<br/> gather(key = vars, value = val, -block.bin) %&gt;%<br/> ggplot(aes(x=block.bin, y = val)) +<br/> geom_line() +<br/> facet_wrap(facets = ‘vars’, scales = ‘free’, ncol = 1)</span></pre><figure class="kv kw kx ky gt ml gh gi paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><div class="gh gi ne"><img src="../Images/ab71cd0e8f6ba18204dd1dc451280323.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YJDuupqtVOm6IHqRM1yEoQ.png"/></div></div></figure><p id="5f23" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在我们只是展示了一大堆看起来很酷的黑色锯齿的疯狂图表(坚持住，下面有一些有趣的东西)。</p><figure class="kv kw kx ky gt ml gh gi paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><div class="gh gi mz"><img src="../Images/c7b05de7c027ec12514b3002cdea4d00.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pFMvZptzLUOSA8Envn5U5w.png"/></div></div></figure><p id="173b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">上面的图表是用这种几乎难以理解的代码制作的:</p><pre class="kv kw kx ky gt kz la lb lc aw ld bi"><span id="55c1" class="le lf iq la b gy lg lh l li lj">difficulty %&gt;%<br/> group_by(block.bin) %&gt;%<br/> summarize(sum.difficulty = sum(difficulty), sum.diff.delta = sum(diff.delta, na.rm=T),mean.ts.delta=mean(ts.delta, na.rm=T)) %&gt;%<br/> mutate(percent.delta = sum.diff.delta / sum.difficulty) %&gt;%<br/> gather(key = vars, value = val, -block.bin) %&gt;%<br/> ggplot(aes(x=block.bin, y = val)) +<br/> geom_line() +<br/> facet_wrap(facets = ‘vars’, scales = ‘free’, ncol = 2)</span></pre><h2 id="87fc" class="le lf iq bd ll lm ln dn lo lp lq dp lr jy ls lt lu kc lv lw lx kg ly lz ma mb bi translated">最后，一些真正有趣的事情</h2><p id="f640" class="pw-post-body-paragraph jn jo iq jp b jq mc js jt ju md jw jx jy me ka kb kc mf ke kf kg mg ki kj kk ij bi translated">10 月份，在 T4 举办的状态黑客马拉松上，艾德和我受到启发，着手解决以太坊难度计算的问题。他担心，当前链条的散列率比拜占庭爆炸前高得多，会使炸弹更长时间地模糊不清，然后，一旦爆炸，会让人们措手不及。</p><p id="a95c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们想看看他的直觉是否正确。</p><p id="cb4c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">简单说说炸弹。它以指数增长曲线爆炸，每 100，000 块翻一番。这产生了一个锯齿曲线的效果，因为链条很难抑制上升，正如我们在之前的中讨论的<a class="ae kn" href="https://medium.com/@tjayrush/ethereum-block-production-continues-to-slide-1b74a2123e3f" rel="noopener">。</a></p><p id="bea4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在下一组图表中，我们将数据分成 100，000 个数据块的存储桶，并将这些存储桶称为<code class="fe mh mi mj la b">periods</code>。(下面黑线显示的是电流<code class="fe mh mi mj la b">period</code>。)这种波动在下面的图表中很明显，我们也将数据分成分组:前拜占庭和后拜占庭。这使我们能够将两个爆炸的炸弹排在一起进行比较。</p><p id="9a30" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当我们这样看数据时，我们看到了什么？首先，我们看到后拜占庭时代的炸弹开始抬头。</p><pre class="kv kw kx ky gt kz la lb lc aw ld bi"><span id="6179" class="le lf iq la b gy lg lh l li lj">difficulty %&gt;%<br/> mutate(era = ifelse(block.number &lt;= byzantium.block, ‘before byzantium’, ‘post byzantium’)) %&gt;%<br/> sample_n(sample_size) %&gt;%<br/> ggplot(aes(y = diff.sensitivity, x = period, color=block.number)) +<br/> scale_colour_gradient2(low = “red”, mid = “green”, high = “blue”, midpoint = byzantium.block, space = “Lab”, na.value = “grey50”, guide = “colourbar”) +<br/> geom_point(size = point_size) + <br/> facet_wrap(facets = ‘era’, nrow = 2) +<br/> geom_vline(xintercept = 41)</span></pre><p id="5dd7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">上面的代码给了我们这个图表:</p><figure class="kv kw kx ky gt ml gh gi paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><div class="gh gi mz"><img src="../Images/ecc98f434e7f7fd6cadd035e87215395.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HrKZ_7f36nzqaYCAax60NA.png"/></div></div></figure><p id="b688" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这里，我想，我们终于找到了一些有趣的东西。虽然，我们还没完。</p><p id="f537" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">接下来，我们将后拜占庭时期的数据和前拜占庭时期的数据相互叠加。</p><p id="ab88" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们现在看到的是，如果我们足够仔细地观察，紫色的小点(现在的子炸弹)比绿色的小点(以前的子炸弹)更低。</p><p id="9cda" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">莱恩是对的。这一次，难度炸弹的效果会变得模糊不清，不像以前那么明显。这可能会让它的效果不太明显，直到爆炸。那要多久？炸弹什么时候来？我们已经在第 41 期了。最后一颗炸弹(<a class="ae kn" href="https://medium.com/@tjayrush/ethereum-block-production-continues-to-slide-1b74a2123e3f" rel="noopener">见此图</a>)现在开始显示减速。最后一枚炸弹现在已经开始加速了。我认为这一次也是如此，但它隐藏在更高的哈希速率后面。</p><figure class="kv kw kx ky gt ml gh gi paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><div class="gh gi mz"><img src="../Images/9c68f33966e42bda45a0a20c1ae3c235.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*27WvZsZcsVTSvELEEqrLGg.png"/></div></div></figure><h2 id="6c68" class="le lf iq bd ll lm ln dn lo lp lq dp lr jy ls lt lu kc lv lw lx kg ly lz ma mb bi translated">结论</h2><p id="5d0f" class="pw-post-body-paragraph jn jo iq jp b jq mc js jt ju md jw jx jy me ka kb kc mf ke kf kg mg ki kj kk ij bi translated">该叉了。</p></div><div class="ab cl ms mt hu mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="ij ik il im in"><p id="b848" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> Thomas Jay Rush </strong>拥有软件公司 QuickBlocks，其主要项目也被称为 QuickBlocks，这是一个软件库和应用程序的集合，能够对以太坊区块链进行实时、逐块的智能合同监控和分析。通过<a class="ae kn" href="http://www.quickblocks.io" rel="noopener ugc nofollow" target="_blank">网站</a>联系他。</p></div></div>    
</body>
</html>