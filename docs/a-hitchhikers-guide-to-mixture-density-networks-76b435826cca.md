# æ··åˆå¯†åº¦ç½‘ç»œæ­ä¾¿è½¦æŒ‡å—

> åŸæ–‡ï¼š<https://towardsdatascience.com/a-hitchhikers-guide-to-mixture-density-networks-76b435826cca?source=collection_archive---------5----------------------->

## è¯„ä¼°é¢„æµ‹çš„ä¸ç¡®å®šæ€§æ˜¯å•†ä¸šå†³ç­–çš„åŸºç¡€ã€‚æ··åˆå¯†åº¦ç½‘ç»œå¸®åŠ©ä½ æ›´å¥½åœ°ç†è§£ä½ åœ¨ç°å®ä¸–ç•Œä¸­é¢ä¸´çš„ä¸ç¡®å®šæ€§ã€‚

![](img/00637a866e1e3c0fcd748ba1508f5d5c.png)

Photo by [Adi Goldstein](https://unsplash.com/@adigold1?utm_source=medium&utm_medium=referral) on [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral)

# ä»‹ç»

ä¸ç¡®å®šæ€§æ˜¯æˆ‘ä»¬åšå‡ºæ¯ä¸ªå†³å®šçš„å…³é”®å› ç´ ã€‚ç„¶è€Œï¼Œåœ¨å•†ä¸šä¸­ï¼Œç»ç†ä»¬ç»å¸¸ä¼šé¢ä¸´å„ç§å„æ ·ä¸å¯é¢„è§çš„åæœã€‚ç»ç†å¯èƒ½ä¼šå¤„ç†ä»¥ä¸‹é—®é¢˜:

*   "æˆ‘ä»¬å¦‚ä½•æ ¹æ®äº§å“å±æ€§ä¸º XYZ å®šä»·ï¼Ÿ"
*   "è¿™ä¸ªå¹¿å‘Šä¼šå¸¦æ¥å¤šå°‘ç½‘ç«™è®¿é—®é‡ï¼Ÿ"
*   "é¡¾å®¢ Z-A137 çš„é¢„æœŸé¡¾å®¢ç»ˆèº«ä»·å€¼æ˜¯å¤šå°‘ï¼Ÿ"
*   "è€ƒè™‘åˆ°å¸‚åœºå½¢åŠ¿ï¼Œæˆ‘ä»¬åº”è¯¥åœ¨å¹¿å‘Šä¸ŠèŠ±å¤šå°‘é’±ï¼Ÿ"

è¿™äº›é—®é¢˜ä¸­çš„æ¯ä¸€ä¸ªéƒ½æ„å‘³ç€ä¸€ä¸ªå†³ç­–ï¼Œè¿™ä¸ªå†³ç­–æœ€å¥½æ˜¯å……åˆ†çŸ¥æƒ…çš„ï¼Œå¹¶ä¸”è€ƒè™‘(æˆ–è€…è‡³å°‘æ‰¿è®¤)æ½œåœ¨çš„ä¸ç¡®å®šæ€§ã€‚ä¾‹å¦‚:é”™è¯¯çš„å®šä»·ä¼šå¯¼è‡´æ”¶å…¥å‡å°‘ï¼Œè¿™åè¿‡æ¥å¯èƒ½ä¼šå¯¼è‡´èŠ‚çº¦æˆæœ¬çš„å¿…è¦æ€§ã€‚

![](img/01c7a65b964fe341ab1ac8e76b5a02db.png)

Photo by [rawpixel](https://unsplash.com/@rawpixel?utm_source=medium&utm_medium=referral) on [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral)

è¿™ç¯‡æ–‡ç« é¢å‘*é¢å‘ä¸šåŠ¡çš„æ•°æ®ç§‘å­¦å—ä¼—*ã€‚æˆ‘ä»¬å°†æ¢è®¨ä¸€äº›å…³äºé¢„æµ‹è¿ç»­å€¼çš„æŠ€æœ¯é—®é¢˜ï¼Œä»¥åŠä¼—æ‰€å‘¨çŸ¥çš„çº¿æ€§æ¨¡å‹åœ¨æŸäº›æƒ…å†µä¸‹çš„å±€é™æ€§ã€‚ç„¶åï¼Œæˆ‘ä»¬å±•ç¤ºäº†ä¸€ç§ç§°ä¸ºæ··åˆå¯†åº¦ç½‘ç»œ(MDN)çš„ç¥ç»ç½‘ç»œå˜ä½“ï¼Œä»¥è§„é¿è¿™äº›é™åˆ¶ã€‚å› æ­¤ï¼Œç®¡ç†è€…å¯ä»¥æ›´å¥½åœ°ç†è§£é¢„æµ‹çš„æ½œåœ¨ä¸ç¡®å®šæ€§ã€‚

å‰é¢æå‡ºçš„é—®é¢˜éœ€è¦é¢„æµ‹ï¼Œå¹¶ä¸”æœ‰ä¸‰ä¸ªå…±åŒçš„åŸºæœ¬ç‰¹å¾ã€‚**ç¬¬ä¸€ä¸ª**æ˜¯ï¼Œæˆ‘ä»¬å¸Œæœ›é¢„æµ‹ä¸€ä¸ªè¿ç»­çš„æ•°é‡(ä»·æ ¼ã€ç½‘ç«™è®¿é—®é‡ã€é”€å”®é¢ï¼Œä½ èƒ½æƒ³åˆ°çš„)ã€‚**ç¬¬äºŒä¸ª**ï¼Œé¢„æµ‹æ˜¯åœ¨ä¸ç¡®å®šæ€§ä¸‹åšå‡ºçš„ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¾ˆæƒ³äº†è§£ä¸€ä¸‹æˆ‘ä»¬å¯¹é¢„æµ‹çš„ä¸ç¡®å®šæ€§ã€‚**ç¬¬ä¸‰**ï¼Œé¢„æµ‹å–å†³äºä¸€äº›è¾“å…¥è§‚å¯Ÿ(äº§å“å±æ€§ã€å®¢æˆ·ã€å¹¿å‘Šè®¾è®¡)ã€‚ç†æƒ³æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¸å¸Œæœ›å¾—åˆ°é—®é¢˜çš„å•ä¸€ç­”æ¡ˆï¼Œè€Œæ˜¯å¸Œæœ›å¾—åˆ°ä¸€ç³»åˆ—ç­”æ¡ˆæ¥è¯„ä¼°æ¯ä¸ªç­”æ¡ˆçš„æ¦‚ç‡ã€‚ç®€è€Œè¨€ä¹‹:æˆ‘ä»¬æ­£åœ¨å¯»æ‰¾ä¸€ä¸ª**æ¦‚ç‡åˆ†å¸ƒ**åœ¨ç»™å®šè¾“å…¥çš„ç­”æ¡ˆèŒƒå›´å†…ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¢å¼ºäº†å¯¹é¢„æµ‹çš„ç†è§£ï¼Œç”šè‡³å¯ä»¥ä½œä¸ºç»ç†æˆ–å®¢æˆ·åšå‡ºæ›´æ˜æ™ºçš„å†³ç­–ã€‚

# **é«˜æ–¯æ··åˆçš„ç›´è§‰**

ä¸¾ä¸ªä¾‹å­:è®©æˆ‘ä»¬å‡è®¾ï¼Œæˆ‘ä»¬å°†è¦é¢„æµ‹ä¸€ä¸ªäº§å“çš„ä»·æ ¼ï¼Œæ¯”å¦‚è¯´è€³æœºã€‚çœ‹ä¸€ä¸‹å¸‚åœºä»·æ ¼çš„æŸ±çŠ¶å›¾ï¼Œæˆ‘ä»¬æ¨æ–­å‡ºå­˜åœ¨ä½ä»·ä½(ï½30 ç¾å…ƒ)ã€ä¸­ä½(ï½60 ç¾å…ƒ)å’Œé«˜ä»·(ï½120 ç¾å…ƒ)çš„è€³æœºã€‚å›å½’åˆ°ç®€å•çš„é«˜æ–¯åˆ†å¸ƒæ¥æ¨¡æ‹Ÿæ•°æ®æ³¨å®šä¼šå¤±è´¥ï¼Œä»ç»éªŒé«˜æ–¯åˆ†å¸ƒçš„æ›²çº¿å¯ä»¥å¾ˆå®¹æ˜“åœ°çœ‹å‡ºè¿™ä¸€ç‚¹ã€‚è¯·è®°ä½ï¼Œé«˜æ–¯æ­£æ€åˆ†å¸ƒ(ğ’©)ç”±ä¸¤ä¸ªå€¼å‚æ•°åŒ–:å‡å€¼(Î¼)å’Œæ ‡å‡†å·®(Ïƒ)ã€‚æ ¹æ®æ ·æœ¬å¹³å‡å€¼(Î¼=47.95)å’Œæ ‡å‡†å·®ï¼Œå°†ğ’©æ‹Ÿåˆåˆ°æ•°æ®ä¸­ã€‚åå·®(Ïƒ=27.76)å°†æ¦‚ç‡åˆ†é…ç»™ä»·æ ¼åŒºåŸŸï¼Œè¿™æ˜¯æˆ‘ä»¬åœ¨è™šæ‹Ÿå¸‚åœºä¸­è§‚å¯Ÿä¸åˆ°çš„(å³ä»·æ ¼åœ¨$90 åˆ°$110 ä¹‹é—´)ã€‚æ­¤å¤–ï¼Œæ ¹æ®æ›²çº¿çš„å·¦ä¾§ï¼Œ**è´Ÿçš„**ä»·æ ¼æ˜¯â€œåˆç†çš„â€ã€‚

![](img/56d9f530ee6acf0f55a7efc94b4f3ccd.png)

Source: Author

äº§ç”Ÿä»·æ ¼åˆ†å¸ƒçš„åŸºç¡€æ•°æ®æ˜¯é«˜æ–¯æ··åˆçš„ã€‚æ··åˆç‰©æ˜¯å¤šå³°çš„ï¼›å› æ­¤ï¼Œå®ƒè¡¨ç°å‡ºå¤šä¸ªâ€œå³°å€¼â€ã€‚ä¸ºäº†é€‚åº”æˆ‘ä»¬è™šæ„çš„å®šä»·æ•°æ®çš„åˆ†å¸ƒï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸æ˜¯ä¸€ä¸ªï¼Œä¸æ˜¯ä¸¤ä¸ªï¼Œè€Œæ˜¯ä¸‰ä¸ªå……åˆ†æ··åˆçš„é«˜æ–¯åˆ†é‡ã€‚æˆ‘ä»¬â€œåªâ€éœ€è¦é€‰æ‹©å‚æ•°(Î¼ï¼ŒÏƒ)ï¼Œé€šè¿‡åŠ æƒ(âº)å½’ä¸€åŒ–åˆ†å¸ƒï¼Œå¹¶å¯¹å®ƒä»¬æ±‚å’Œ(ç¨åå°†è¯¦ç»†ä»‹ç»)ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œå·§å¦™åœ°æ··åˆè¿™äº›ç»„ä»¶åæ˜ äº†çœŸå®çš„æ•°æ®ã€‚

![](img/8318516cfc0f80b328629a3219f38e15.png)

Source: Author

æˆ‘ä»¬å°†åœ¨åç»­ç« èŠ‚ä¸­ä½¿ç”¨ tensor flow(ã€www.tensorflow.orgã€‘)åŠå…¶æ‰©å±• tensor flow-Probability([ã€www.tensorflow.org/probabilityã€‘](http://www.tensorflow.org/probability))ã€‚è¯¥ç¤ºä¾‹æ˜¯åœ¨ Tensorflow Probability ä¸­ä½¿ç”¨ä¸‹é¢ä»£ç ç‰‡æ®µä¸­æ˜¾ç¤ºçš„å€¼ç”Ÿæˆçš„ã€‚æˆ‘ä»¬åŸºæœ¬ä¸Šå®šä¹‰äº†åŒä¸€ä¸ªæ—çš„æ··åˆåˆ†å¸ƒã€‚

# **çº¿æ€§å›å½’çš„å‡è®¾**

æœ¬æ–‡å¼€å¤´æå‡ºçš„é—®é¢˜çš„ç¬¬ä¸€ä¸ªè§£å†³æ–¹æ¡ˆç¡®å®æ˜¯æ‰§è¡Œä¸€ä¸ªç®€å•çš„çº¿æ€§å›å½’ã€‚æˆ‘ä»¬å‡ ä¹å¯ä»¥å¬åˆ°ä½ åœ¨æ‰“å“ˆæ¬ ã€‚

ä½†æ˜¯ç­‰ç­‰ï¼Œæˆ‘ä»¬ä¼šç»™å®ƒä¸€ä¸ªç®€çŸ­çš„æŠ€æœ¯é•œå¤´ï¼ç»™å®šä¸€ä¸ªè¾“å…¥å‘é‡ **x** (äº§å“å±æ€§ã€å®¢æˆ·â€¦â€¦ç­‰ç­‰)**ï¼Œ**æˆ‘ä»¬å¸Œæœ›é¢„æµ‹ *y* (ä»·æ ¼ã€ç½‘ç«™è®¿é—®é‡â€¦â€¦ç­‰ç­‰)ã€‚æ›´å‡†ç¡®åœ°è¯´:æˆ‘ä»¬çš„ç›®æ ‡æ˜¯åœ¨ç»™å®š**x**:*p(y |***x***)çš„æƒ…å†µä¸‹è·å¾— *y* çš„æ¦‚ç‡ã€‚*å¦‚æœæˆ‘ä»¬å‡è®¾å®å€¼ç›®æ ‡æ•°æ®çš„é«˜æ–¯åˆ†å¸ƒ(æ­£å¦‚æˆ‘ä»¬é€šå¸¸æ‰€åšçš„ï¼Œå½“æˆ‘ä»¬æœ€å°åŒ–å¹³æ–¹è¯¯å·®æ—¶)ï¼Œé‚£ä¹ˆ*p(y |***x***)*é‡‡ç”¨ä¼—æ‰€å‘¨çŸ¥çš„å½¢å¼:

![](img/7a81d0c3037fd6a99e4d8c36eef850c2.png)

åœ¨å®é™…åº”ç”¨ä¸­ï¼Œå¯¹äºæŸæ•°æ®é›†ğ”».ä¸­çš„æ‰€æœ‰( **x** ã€**t15ã€‘*y*)å¯¹ï¼Œç»™å®š **x** ã€å…¶å‚æ•°**Î¸**å’Œç›®æ ‡å€¼ *y* ï¼Œæˆ‘ä»¬æœ€å°åŒ–çº¿æ€§å‡½æ•°Î¼çš„è¾“å‡ºçš„å¹³æ–¹è¯¯å·®é¡¹(Î¼( **x** ã€**Î¸**-*y*)åœ¨ç»™å®šæ•°æ®å’Œå‚æ•°çš„æƒ…å†µä¸‹ï¼Œå­¦ä¹ å‡½æ•°å®è´¨ä¸Šâ€œåå‡ºâ€äº†é«˜æ–¯åˆ†å¸ƒÎ¼( **x** ï¼Œ**Î¸**)çš„æ¡ä»¶å‡å€¼ã€‚å®ƒæ‰”æ‰äº†æ€§ç—…ã€‚åå·®å’Œå½’ä¸€åŒ–å¸¸æ•°ï¼Œä¸ä¾èµ–äº**Î¸**ã€‚é€šè¿‡è¿™æ ·åšï¼Œè¯¥æ¨¡å‹å¼ºåŠ äº†å¤šä¸ªé‡è¦çš„å‡è®¾ï¼Œè¿™äº›å‡è®¾åœ¨å®è·µä¸­å¯èƒ½éå¸¸æœ‰é™:**

1.  æ•°æ®åˆ†å¸ƒæ˜¯é«˜æ–¯åˆ†å¸ƒã€‚å¼•ç”¨[1]:
    *â€œå®é™…çš„æœºå™¨å­¦ä¹ é—®é¢˜å¾€å¾€å¯ä»¥æœ‰æ˜¾è‘—çš„éé«˜æ–¯åˆ†å¸ƒâ€*(ç¬¬ 272 é¡µ)ã€‚
2.  äº§å‡ºåˆ†å¸ƒæ˜¯å•å³°çš„ã€‚å› æ­¤ï¼Œæˆ‘ä»¬æ— æ³•è§£é‡Š **x** å¯ä»¥äº§ç”Ÿå¤šä¸ªæœ‰æ•ˆç­”æ¡ˆçš„æƒ…å†µï¼Œè€Œå¤šæ¨¡æ€åˆ†å¸ƒå¯ä»¥æ•è·è¿™äº›ç­”æ¡ˆ(å¦‚ä¸Šé¢çš„è€³æœºç¤ºä¾‹)ã€‚
3.  æ€§ç—…ã€‚å‡è®¾å™ªå£°åˆ†å¸ƒçš„åå·®Ïƒä¸ºå¸¸æ•°ï¼Œå› æ­¤ä¸€å®šä¸ä¾èµ–äº **x** (åŒè´¨æ€§ï¼Œå„å‘åŒæ€§åæ–¹å·®çŸ©é˜µ)ã€‚åŒæ ·ï¼Œåœ¨ç°å®ä¸–ç•Œä¸­æƒ…å†µå¹¶ä¸æ€»æ˜¯å¦‚æ­¤ã€‚
4.  å‡½æ•°Î¼( **x** ï¼Œ**Î¸**)æ˜¯çº¿æ€§çš„ï¼Œå³Î¼( **x** ï¼Œ**Î¸**)=**x**Ã—**w**+*b***ï¼Œ**å…¶ä¸­**Î¸**= {**w**ï¼Œ*b* çº¿æ€§æ¨¡å‹è¢«å¹¿æ³›è®¤ä¸ºæ›´å®¹æ˜“è§£é‡Šã€‚å¦ä¸€æ–¹é¢ï¼Œç¥ç»ç½‘ç»œæä¾›äº†æå¥½çš„é¢„æµ‹èƒ½åŠ›ï¼Œå› ä¸ºå®ƒä»¬ç†è®ºä¸Šèƒ½å¤Ÿæ¨¡æ‹Ÿä»»ä½•å‡½æ•°ã€‚

è®©æˆ‘ä»¬è€ƒè™‘ä¸¤ç§æƒ…å†µï¼Œè¿™ä¸¤ç§æƒ…å†µå½¢è±¡åœ°æ¿€å‘äº†å…ˆå‰æ¦‚è¿°çš„æŠ€æœ¯é—®é¢˜:

![](img/11b2f8ba305c7293f1312dfee2119890.png)

Source: Author

(LHS):åŸºæœ¬å‡½æ•°æ˜¯çº¿æ€§çš„ã€‚ç„¶è€Œï¼Œæˆ‘ä»¬è§‚å¯Ÿåˆ°ä¸¤ä¸ªè¿å:**é¦–å…ˆæ˜¯**ï¼Œstdã€‚(å™ªå£°)åˆ†å¸ƒçš„åå·®ä¸æ˜¯å¸¸æ•°ã€‚**å…¶æ¬¡**ï¼Œå™ªå£°ç¡®å®å–å†³äºè¾“å…¥ã€‚

(RHS):ä¸ä»…æ˜¯æ€§ç—…ã€‚å™ªå£°åˆ†å¸ƒçš„åå·®å–å†³äº **x** ï¼Œä½†æ˜¯è¾“å‡ºé¢å¤–ä¸º**éçº¿æ€§**ã€‚æ­¤å¤–ï¼Œè¾“å‡ºåˆ†é…æ˜¯**å¤šæ¨¡æ€**ã€‚å¯¹äºæŸäº›æ•°æ®åŒºåŸŸ(å¤§çº¦ 8)ï¼Œç®€å•å¹³å‡å€¼ä¸æ˜¯ä¸€ä¸ªåˆç†çš„è§£å†³æ–¹æ¡ˆã€‚å½“æˆ‘ä»¬è¦é¢„æµ‹éµå¾ªå¦‚æ­¤å¤æ‚æ¨¡å¼çš„ç»“æœæ—¶ï¼Œå¼ºåŠ å…ˆå‰æ¦‚è¿°çš„å‡è®¾å¯èƒ½å®¹æ˜“è¯¯å¯¼ã€‚

# MDN çš„èƒŒæ™¯

è€ƒè™‘åˆ°ä¸Šè¿°é™åˆ¶ï¼Œ[2]å»ºè®®é€šè¿‡ DNN å¯¹æ··åˆåˆ†å¸ƒè¿›è¡Œå‚æ•°åŒ–ã€‚MDN æœ€åˆæ„æƒ³äº 1994 å¹´[1] [2]ï¼Œæœ€è¿‘å‘ç°äº†ä¸€ç³»åˆ—ä¸åŒçš„åº”ç”¨ã€‚æ¯”å¦‚:è‹¹æœ iOS 11 ä¸­çš„ Siri ä½¿ç”¨ MDN è¿›è¡Œè¯­éŸ³ç”Ÿæˆ[3]ã€‚Alex Graves ä½¿ç”¨ MDN ç»“åˆ rnn æ¥ç”Ÿæˆäººå·¥ç¬”è¿¹[4]ã€‚æ­¤å¤–ï¼Œè¿˜æœ‰å¤šä¸ªåšå®¢å¸–å­ä¸“é—¨è®¨è®ºè¿™ä¸ªä¸»é¢˜[5] [6] [7] [8]ã€‚Amazon Forecast ä¸ºå…¶å®¢æˆ·æä¾› MDN ä½œä¸ºç®—æ³•[9]ï¼Œè€Œ[10]å†™äº†ä¸€ç¯‡å…³äºè¿™ä¸ªä¸»é¢˜çš„ç¡•å£«è®ºæ–‡ã€‚

ç„¶è€Œï¼Œæˆ‘ä»¬å¸Œæœ›ä¸º**æ›´å¹¿æ³›çš„å—ä¼—**å»ºç«‹æ–¹æ³•ã€‚åŸå› å¾ˆç®€å•ï¼Œè®¸å¤šç°ä»£ç¥ç»ç½‘ç»œæ¶æ„å¯ä»¥æ‰©å±•ä¸º MDN(Transformerã€LSTMsã€CovNets ç­‰)ã€‚MDNs æœ¬è´¨ä¸Šå¯ä»¥è¢«è§†ä¸ºä¸€ä¸ªæ‰©å±•æ¨¡å—ï¼Œé€‚ç”¨äºå„ç§å„æ ·çš„ä¸šåŠ¡ç›¸å…³ä»»åŠ¡ã€‚

![](img/105932726e8ab2f961872e0f05a73e05.png)

Source: Author

åœ¨å…¶æ ¸å¿ƒï¼ŒMDN çš„æ¦‚å¿µæ˜¯ç®€å•çš„ï¼Œç›´æˆªäº†å½“çš„ï¼Œæœ‰å¸å¼•åŠ›çš„:**ç»“åˆäº†æ·±åº¦ç¥ç»ç½‘ç»œ(DNN)å’Œæ··åˆåˆ†å¸ƒã€‚**DNN ä¸ºå¤šä¸ªåˆ†å¸ƒæä¾›å‚æ•°ï¼Œç„¶åé€šè¿‡ä¸€äº›æƒé‡è¿›è¡Œæ··åˆã€‚è¿™äº›ç ç ä¹Ÿç”± DNN æä¾›ã€‚ç”±æ­¤äº§ç”Ÿçš„(å¤šæ¨¡æ€)æ¡ä»¶æ¦‚ç‡åˆ†å¸ƒæœ‰åŠ©äºæˆ‘ä»¬å¯¹ç°å®ä¸–ç•Œæ•°æ®ä¸­çš„å¤æ‚æ¨¡å¼è¿›è¡Œå»ºæ¨¡ã€‚å› æ­¤ï¼Œæˆ‘ä»¬èƒ½å¤Ÿæ›´å¥½åœ°è¯„ä¼°ï¼Œæˆ‘ä»¬é¢„æµ‹çš„æŸäº›å€¼æœ‰å¤šå¤§çš„å¯èƒ½æ€§ã€‚

# **æ··åˆæ¨¡å‹çš„å½¢å¼åŒ–**

ç†è®ºä¸Šï¼Œé«˜æ–¯æ··åˆèƒ½å¤Ÿæ¨¡æ‹Ÿä»»æ„æ¦‚ç‡å¯†åº¦[2]ï¼Œå¦‚æœå®ƒè¢«å……åˆ†å‚æ•°åŒ–(ä¾‹å¦‚ï¼Œç»™å®šè¶³å¤Ÿçš„åˆ†é‡)ã€‚å½¢å¼ä¸Šï¼Œæ··åˆç‰©çš„æ¡ä»¶æ¦‚ç‡å®šä¹‰ä¸º

![](img/d6a6ed41818fe662956c3e4090ea04c0.png)

è®©æˆ‘ä»¬åˆ†åˆ«é˜è¿°æ¯ä¸ªå‚æ•°:

*   *c* è¡¨ç¤ºç›¸åº”æ··åˆç‰©æˆåˆ†çš„æŒ‡æ•°ã€‚æ¯ä¸ªè¾“å‡ºæœ€å¤šæœ‰ *C* ä¸ªæ··åˆæˆåˆ†(å³:åˆ†å¸ƒ)ï¼Œè¿™æ˜¯ä¸€ä¸ªç”¨æˆ·å¯å®šä¹‰çš„è¶…å‚æ•°ã€‚
*   âºè¡¨ç¤ºæ··åˆå‚æ•°ã€‚å°†æ··éŸ³å‚æ•°æƒ³è±¡æˆæ»‘å—ï¼Œä»¥ä¸åŒçš„å¼ºåº¦å°†ä¸åŒçš„éŸ³é¢‘ä¿¡å·æ··åˆåœ¨ä¸€èµ·ï¼Œäº§ç”Ÿæ›´ä¸°å¯Œçš„è¾“å‡ºã€‚æ··åˆå‚æ•°å–å†³äºè¾“å…¥ **x** ã€‚
*   ğ’Ÿæ˜¯è¦æ··åˆçš„ç›¸åº”åˆ†å¸ƒ(éŸ³é¢‘ä¿¡å·)ã€‚å¯ä»¥æ ¹æ®ä»»åŠ¡æˆ–åº”ç”¨æ¥é€‰æ‹©åˆ†å¸ƒã€‚
*   Î»è¡¨ç¤ºåˆ†å¸ƒğ’Ÿ.çš„å‚æ•°å¦‚æœæˆ‘ä»¬å°†ğ’Ÿè¡¨ç¤ºä¸ºé«˜æ–¯åˆ†å¸ƒï¼ŒÎ»1 å¯¹åº”äºæ¡ä»¶å‡å€¼Î¼( **x** )ï¼ŒÎ»2 å¯¹åº”äºæ¡ä»¶æ ‡å‡†å·®ã€‚åå·®Ïƒ( **x** )ã€‚åˆ†å¸ƒå¯ä»¥æœ‰å¤šä¸ªå‚æ•°(ä¾‹å¦‚:Bernoulli å’Œ Chi2 æœ‰ä¸€ä¸ªå‚æ•°ï¼ŒGaussian å’Œ Beta æœ‰ä¸¤ä¸ªå‚æ•°ï¼Œæˆªæ–­çš„ Gaussian æœ€å¤šæœ‰å››ä¸ªå‚æ•°)ã€‚**è¿™äº›æ˜¯ç¥ç»ç½‘ç»œè¾“å‡ºçš„å‚æ•°ã€‚**

å°†æ¡ä»¶æ¦‚ç‡å…¬å¼åŒ–ä¸ºåˆ†å¸ƒçš„æ··åˆå·²ç»è§£å†³äº†ä¸æ¦‚è¿°çš„å‡è®¾ç›¸å…³çš„å¤šä¸ªé—®é¢˜ã€‚**é¦–å…ˆ**ï¼Œåˆ†å¸ƒå¯ä»¥æ˜¯ä»»æ„çš„ï¼Œå› ä¸ºæˆ‘ä»¬ç†è®ºä¸Šèƒ½å¤Ÿå°†æ¯ä¸ªåˆ†å¸ƒå»ºæ¨¡ä¸ºé«˜æ–¯åˆ†å¸ƒçš„æ··åˆç‰©[2]ã€‚**å…¶æ¬¡**ï¼Œä½¿ç”¨å¤šç§åˆ†å¸ƒæœ‰åŠ©äºæˆ‘ä»¬å¯¹å¤šæ¨¡æ€ä¿¡å·è¿›è¡Œå»ºæ¨¡ã€‚è€ƒè™‘æˆ‘ä»¬çš„è€³æœºä»·æ ¼ä¾‹å­ï¼Œè¿™æ˜¾ç„¶æ˜¯å¤šæ¨¡æ€çš„ã€‚**ç¬¬ä¸‰ï¼Œ**æ€§ç—…ã€‚åå·®ç°åœ¨ä»¥è¾“å…¥ä¸ºæ¡ä»¶ï¼Œå…è®¸æˆ‘ä»¬è€ƒè™‘å˜é‡ stdã€‚åå·®ã€‚å³ä½¿æˆ‘ä»¬åªä½¿ç”¨å•ä¸€çš„é«˜æ–¯åˆ†å¸ƒï¼Œè¿™ä¸ªä¼˜åŠ¿ä¹Ÿé€‚ç”¨ã€‚**ç¬¬å››ä¸ª**ï¼Œå‡½æ•°çš„çº¿æ€§é—®é¢˜å¯ä»¥é€šè¿‡é€‰æ‹©ä¸€ä¸ªéçº¿æ€§æ¨¡å‹æ¥è§£å†³ï¼Œè¯¥æ¨¡å‹å†³å®šäº†è¾“å…¥çš„åˆ†å¸ƒå‚æ•°ã€‚

ä¸ºäº†è·å¾—æ··åˆç‰©çš„å‚æ•°ï¼ŒDNN è¢«ä¿®æ”¹ä»¥è¾“å‡º**å¤šä¸ªå‚æ•°å‘é‡**ã€‚æˆ‘ä»¬ä»å•å±‚ DNN å’Œ ReLU æ¿€æ´»å¼€å§‹ã€‚ä½¿ç”¨éšè—å±‚ h1( **x** )ï¼Œæˆ‘ä»¬ç»§ç»­è®¡ç®—æ··åˆç‰©çš„å‚æ•°å¦‚ä¸‹:

![](img/d6b5b64ffa4427bbc83dbe0b3c89fab2.png)

æ··åˆç³»æ•°å¿…é¡»**æ€»å’Œä¸º 1**:âˆ‘âº(**x**)= 1ã€‚å› æ­¤ï¼Œæˆ‘ä»¬ä½¿ç”¨ softmax å‡½æ•°æ¥çº¦æŸè¾“å‡ºã€‚è¿™ä¸€æ­¥å¾ˆé‡è¦ï¼Œå› ä¸ºæ¦‚ç‡çš„æ··åˆå¿…é¡»æ•´åˆä¸ºä¸€ã€‚Î»1 å’ŒÎ»2 çš„çº¦æŸæœ¬èº«å–å†³äºæˆ‘ä»¬ä¸ºæ¨¡å‹é€‰æ‹©çš„åˆ†å¸ƒã€‚æˆ‘ä»¬å¿…é¡»å¯¹é«˜æ–¯å‡½æ•°æ–½åŠ çš„å”¯ä¸€çº¦æŸæ˜¯ã€‚åå·®ä¸º
Ïƒ( **x** ) > 0ã€‚è¿™ç§æ•ˆæœå¯ä»¥é€šè¿‡å¤šç§æ–¹å¼å®ç°ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æœ€åˆç”± Bishop [1] [2]æå‡ºçš„æŒ‡æ•°æ¿€æ´»ã€‚ç„¶è€Œï¼ŒæŒ‡æ•°ä¼šå¯¼è‡´æ•°å€¼ä¸ç¨³å®šã€‚æˆ–è€…ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ç®€å•çš„ softplus æ¿€æ´»ï¼Œç±»ä¼¼äº[11]ä¸­ä½¿ç”¨çš„ oneplus æ¿€æ´»ã€‚æˆ–è€…æˆ‘ä»¬é‡‡ç”¨ä¸€ç§æœ‰åç§»çš„ ELU æ¿€æ´»çš„å˜ä½“ã€‚ç”±äºæœ€è¿‘ ELU çš„çªå‡ºï¼Œæˆ‘ä»¬é€‰æ‹©äº†åè€…ã€‚å› æ­¤ï¼Œæˆ‘ä»¬æœ€ç»ˆå®Œæˆäº†ä»¥ä¸‹è½¬æ¢:

![](img/20fb5e9fccc2fa8aaf90c065472837ec.png)

çº¦æŸæ¡ä»¶çš„é€‰æ‹©å–å†³äºåˆ†å¸ƒå’Œæ•°æ®ã€‚ä¸€å¦‚æ—¢å¾€:ä¸åŒçš„çº¦æŸå¯èƒ½åœ¨ä¸åŒçš„æ•°æ®é›†ä¸Šè¡¨ç°å¾—æ›´å¥½ã€‚æœ‰äººç”šè‡³ä¼šè¯´ï¼Œä»å•†ä¸šè§’åº¦æ¥çœ‹ï¼Œå°†Î¼( **x** )é™åˆ¶ä¸ºæ­£å€¼ä¹Ÿæ˜¯æ˜æ™ºçš„ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥è®¤ä¸ºè´Ÿä»·æ ¼æ˜¯ä¸å¯èƒ½çš„ã€‚

![](img/a33f96332d0970fd949bc7d5c911de3e.png)

æ—¢ç„¶æˆ‘ä»¬ç°åœ¨æŒ‡å®šäº†å‚æ•°å’Œæ¡ä»¶æ¦‚ç‡ï¼Œæˆ‘ä»¬å°±æœ‰äº†ä½¿ç”¨æŸç§å½¢å¼çš„æ¢¯åº¦ä¸‹é™(SGDã€Adagradã€Adadeltaã€Adamã€RMSProp ç­‰)ç›´æ¥æœ€å°åŒ–å¹³å‡è´Ÿå¯¹æ•°ä¼¼ç„¶(NLL)æ‰€éœ€çš„ä¸€åˆ‡ã€‚).

# åƒå¹´å‘å±•ç›®æ ‡çš„å®æ–½

> **ä»£ç åœ¨**[**Github**](https://github.com/oborchers/Medium_Repo)**/**[**Colab**](https://colab.research.google.com/drive/1at5lIq0jYvA58AmJ0aVgn2aUVpzIbwS3)**ä¸Šæœ‰ã€‚**

å»ºç«‹äº† MDN çš„åŸºæœ¬ç†è®ºåï¼Œæˆ‘ä»¬ç°åœ¨å±•ç¤ºå¦‚ä½•åœ¨ Tensorflow/Keras ä¸­å®ç°è¯¥æ¨¡å‹ã€‚æˆ‘ä»¬åŸºæœ¬ä¸Šéœ€è¦ä¸¤ä¸ªç»„ä»¶:è®¡ç®—å‚æ•°çš„è‡ªå®šä¹‰å±‚å’Œæœ€å°åŒ–çš„æŸå¤±å‡½æ•°ã€‚å‡ºäºæ•°å€¼ç¨³å®šæ€§å’Œæ–¹ä¾¿æ€§çš„åŸå› ï¼Œæˆ‘ä»¬å°†åœ¨å¼ é‡æµå‡½æ•°ä¸­è¿›è¡Œå¤§éƒ¨åˆ†è®¡ç®—ã€‚æ­£å¦‚æˆ‘ä»¬ä¹‹å‰å¼ºè°ƒçš„ MDN æ¡†æ¶çš„çµæ´»æ€§ä¸€æ ·ï¼Œæˆ‘ä»¬å¹¶æ²¡æœ‰è®¨è®ºæ‰€æœ‰çš„å†…å®¹ï¼Œè€Œæ˜¯è®¨è®ºäº†ä¸æ‚¨æ„å»ºè‡ªå·±ç‰ˆæœ¬çš„ MDN æ¡†æ¶ç›¸å…³çš„éƒ¨åˆ†ã€‚å®šä¹‰ DNN å¾ˆç®€å•:

æ ¹æ®æ•°æ®å’Œåº”ç”¨ï¼Œå¯¹ sigmas è¿›è¡Œé¢å¤–çš„æ´»åŠ¨è°ƒæ•´ä»¥é˜²æ­¢ std ä¹Ÿå¯èƒ½æ˜¯æœ‰æ„ä¹‰çš„ã€‚åç¦»ç‚¸æ¯ã€‚ç®€å•çš„ L2 æ­£åˆ™åŒ–å°†æ˜¯ä¸€ä¸ªæ˜æ™ºçš„é€‰æ‹©ã€‚

ä»£ç ç¤ºä¾‹éœ€è¦ä¸€ä¸ªâ€œéè´ŸæŒ‡æ•°çº¿æ€§å•ä½â€æ¿€æ´»å‡½æ•°ï¼Œç¡®ä¿ sigmas ä¸¥æ ¼å¤§äºé›¶ã€‚Tensorflow æä¾›äº†ä¸€ç§éå¸¸å‹å¥½çš„æ–¹å¼æ¥å®šä¹‰æ‰€éœ€çš„æ¿€æ´»å‡½æ•°ã€‚æˆ‘ä»¬åªæ˜¯è®© nnelu æˆä¸ºä¸€ä¸ªå¯è°ƒç”¨çš„å‡½æ•°ï¼Œå¹¶åœ¨ Keras ä¸­å°†å…¶æ³¨å†Œä¸ºè‡ªå®šä¹‰æ¿€æ´»å‡½æ•°ã€‚

å‰©ä¸‹çš„æ„å»ºæ¨¡å—æ˜¯æŸå¤±å‡½æ•°çš„å®ç°ã€‚Tensorflow-Probability çš„åº”ç”¨å¾ˆæ–¹ä¾¿ï¼Œå› ä¸ºæˆ‘ä»¬åªæ˜¯ç¨å¾®é‡æ–°å®šä¹‰äº†æœ¬æ–‡å¼€å¤´çš„ä¾‹å­ã€‚MixtureSameFamily éœ€è¦æ··åˆåˆ†å¸ƒå’Œç»„ä»¶åˆ†å¸ƒã€‚å‰è€…æ˜¯ä¸€ä¸ªç®€å•çš„åˆ†ç±»åˆ†å¸ƒï¼Œå®ƒå¾—åˆ°æ··åˆæƒé‡âº( **x** ã€‚åè€…æ˜¯æ­£æ€åˆ†å¸ƒï¼Œç”±å¹³å‡å€¼å’Œæ ‡å‡†å·®å‚æ•°åŒ–ã€‚åå·®ã€‚éšåï¼Œæˆ‘ä»¬åªéœ€è®¡ç®— *y* åŠå…¶è´Ÿå¹³å‡å€¼çš„å¯¹æ•°ä¼¼ç„¶ã€‚é€šè¿‡å›å½’åˆ°å¼ é‡æµæ¦‚ç‡ï¼Œæˆ‘ä»¬é¿å…äº†æ•°å€¼ä¸Šæº¢/ä¸‹æº¢(æ‰‹åŠ¨å®ç°è¿™ä¸€ç‚¹å®é™…ä¸Šç›¸å½“æ£˜æ‰‹)ã€‚

åœ¨å®šä¹‰äº† MDN æœ€é‡è¦çš„ç»„ä»¶ä¹‹åï¼Œåªå‰©ä¸‹æ¨¡å‹çš„ç¼–è¯‘äº†ã€‚

# æ¨¡æ‹Ÿæ•°æ®çš„åº”ç”¨

æ˜¯æ—¶å€™å›åˆ°æˆ‘ä»¬ä¹‹å‰çš„ä¾‹å­äº†ã€‚æˆ‘ä»¬è®­ç»ƒå…·æœ‰ä¸¤å±‚çš„ç®€å• MDNï¼Œæ¯å±‚ 200 ä¸ªç¥ç»å…ƒï¼Œå¹¶ä¸”åœ¨çº¿æ€§æ•°æ®é›†ä¸Šæœ‰ä¸€ä¸ª**é«˜æ–¯åˆ†é‡ã€‚MDN æ˜¾ç¤ºäº†å®ƒçš„å®åŠ›:ç”±äºè°ƒèŠ‚æ€§ç—…ã€‚è¾“å…¥ä¸Šåˆ†å¸ƒçš„åå·®ï¼ŒMDN å¯ä»¥é€‚åº”åº•å±‚æ•°æ®åˆ†å¸ƒçš„å˜åŒ–ã€‚å®ƒå·§å¦™åœ°æ•æ‰åˆ°äº†çº¿æ€§è¶‹åŠ¿(å¦‚é¢„æœŸçš„é‚£æ ·)ï¼Œä½†è°ƒæ•´äº†æ ‡å‡†å·®ã€‚æ ¹æ®æ•°æ®ä¸­å­˜åœ¨çš„ä¸ç¡®å®šæ€§çš„å¢åŠ è€Œäº§ç”Ÿçš„åå·®(æˆ‘å–œæ¬¢è¿™ä¸ªå›¾è¡¨ã€‚çœ‹èµ·æ¥åƒæµæ˜Ÿ)ã€‚**

![](img/42fac45faa97d7e92900948a5aed436a.png)

Source: Author

ä¸ºäº†æ›´å¥½åœ°æŒæ¡ç»“æœï¼Œæˆ‘ä»¬è¿˜å¯¹å‡ ä¸ªæ¨¡å‹çš„å¹³å‡è´Ÿå¯¹æ•°ä¼¼ç„¶è¿›è¡Œäº†æ¯”è¾ƒã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹é›¶æ¨¡å‹(æ ·æœ¬å‡å€¼å’Œæ ·æœ¬æ ‡å‡†å·®ã€‚åå·®)ã€çº¿æ€§æ¨¡å‹(çº¿æ€§æ¡ä»¶å‡å€¼å’Œæ ·æœ¬æ ‡å‡†å·®ã€‚åå·®)ã€DNN(éçº¿æ€§æ¡ä»¶å‡å€¼å’Œæ ·æœ¬æ ‡å‡†å·®ã€‚åå·®)å’Œ MDN(éçº¿æ€§æ¡ä»¶å‡å€¼å’Œéçº¿æ€§æ¡ä»¶æ ‡å‡†å·®)ã€‚åå·®)ã€‚DNN å’Œ MDN ä½¿ç”¨ç›¸åŒçš„å‚æ•°å’Œè®­ç»ƒç¨‹åºã€‚å¹¸è¿çš„æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ Tensorboard ç›‘æ§ MDN çš„è®­ç»ƒè¿›åº¦ã€‚æ‰€è¦åšçš„å°±æ˜¯å›è°ƒ fit ä¾‹ç¨‹ã€‚å› æ­¤ï¼Œæˆ‘ä»¬ä¸éœ€è¦è´¹å¿ƒå•ç‹¬å­˜å‚¨è®­ç»ƒæŸå¤±ã€‚æˆ‘ä»¬æ­£åœ¨æ±‡åˆï¼

![](img/721ef1217ab706460d61e1b003fc73c4.png)

MDN nll-loss during optimization. Source: Author

![](img/972629942c8c066b33645ba76cf64b14.png)

Source: Author

æ‰€æœ‰æ¨¡å‹éƒ½èƒ½å¤Ÿå‡»è´¥é›¶æ¨¡å‹ã€‚å…¶ä½™æ¨¡å‹åœ¨ MSE æ–¹é¢è¡¨ç°ç›¸åŒï¼Œå› ä¸º MSE å‡è®¾ stdã€‚åŸºç¡€åˆ†å¸ƒçš„åå·®æ˜¯å¸¸æ•°ã€‚æˆ‘ä»¬æ— æ³•å……åˆ†æ•æ‰æ•°æ®çš„è¡Œä¸ºï¼NLL åŒ…å«äº† stdã€‚åå·®ï¼Œç¡®å®åæ˜ äº†ä¸€ä¸ªæ›´å¾®å¦™çš„ç”»é¢ã€‚ç”±äºåŸºç¡€å‡½æ•°æ˜¯çº¿æ€§çš„ï¼Œå› æ­¤ DNN å’Œçº¿æ€§æ¨¡å‹çš„æ€§èƒ½ç›¸å½“ã€‚ç„¶è€Œï¼ŒMDN**èƒ½å¤Ÿæ›´å¥½åœ°é€‚åº”æ•°æ®åˆ†å¸ƒ**ï¼Œä»è€Œäº§ç”Ÿæœ€ä½çš„ NLL å€¼ã€‚

ä¸ºäº†ä»å•ä¸ªæ•°æ®ç‚¹çš„ MDN çš„æ¦‚ç‡å¯†åº¦ä¸­å¯¼å‡ºæ¡ä»¶å‡å€¼ï¼Œå¯ä»¥è®¡ç®—:

![](img/52633968bba3cbb96cc246c593fef479.png)

çœ‹ä¸€ä¸‹è¿™ä¸ªå…¬å¼å°±å¯ä»¥è§£é‡Šè¿™ä¸ªç»“æœ:å¹³å‡å€¼æ²¡æœ‰åŒ…å«æ ‡å‡†å·®ã€‚åå·®Ïƒ( **x** )ã€‚ä»…ä»…æŸ¥çœ‹ MDN çš„å«ä¹‰å°±ä¸¢å¼ƒäº†æœ‰ä»·å€¼çš„ä¿¡æ¯ï¼Œè€Œè¿™äº›ä¿¡æ¯åœ¨ç°å®ä¸–ç•Œçš„åº”ç”¨ç¨‹åºä¸­å¯èƒ½æ˜¯éœ€è¦çš„ã€‚æœ‰äº†è¿™ç§åˆ†å¸ƒï¼Œæˆ‘ä»¬å°±å¯ä»¥è®¡ç®—æ›´ç²¾ç»†çš„æ•°é‡ã€‚ä¾‹å¦‚ï¼Œé¦™å†œç†µå¯ä»¥ä½œä¸ºæˆ‘ä»¬æœ‰å¤šç¡®å®šçš„æŒ‡æ ‡ã€‚æˆ–è€…æˆ‘ä»¬å¯ä»¥è®¡ç®— f-æ•£åº¦æ¥è¯„ä¼°ï¼Œé¢„æµ‹æœ‰å¤šç›¸ä¼¼ã€‚

ç°åœ¨è®©æˆ‘ä»¬è½¬å‘ç¬¬äºŒä¸ªéçº¿æ€§çš„ä¾‹å­ã€‚æˆ‘ä»¬é¦–å…ˆä½¿ç”¨æœ€å°-æœ€å¤§ç¼©æ”¾å™¨å°† *y* è½¬æ¢ä¸º DNN / MDN çš„åˆç†èŒƒå›´ï¼Œä»¥åŠ é€Ÿå­¦ä¹ ã€‚

![](img/c3449e08418af5634506120ded1e8b29.png)

Source: Author

MDN ä¸ä»…èƒ½æ•æ‰æ½œåœ¨çš„éçº¿æ€§ï¼Œè¿˜èƒ½æ•æ‰è¾“å‡ºçš„å¤šæ¨¡æ€å’Œæ ‡å‡†å·®çš„å˜åŒ–ã€‚åå·®ã€‚æ•°æ®ç”Ÿæˆåˆ†å¸ƒè¢«å……åˆ†æ•è·ã€‚æŸ¥çœ‹ **x** = 8 çš„æ¡ä»¶å¯†åº¦ï¼Œæˆ‘ä»¬çœ‹åˆ° MDN äº§ç”Ÿä¸¤ä¸ªä¸ç›¸äº¤çš„å³°å€¼:

![](img/8fb6f313be03485787839947fa74aaed.png)

Source: Author

å¯¹è¿™äº›å¤æ‚åˆ†å¸ƒå»ºæ¨¡çš„èƒ½åŠ›åæ˜ åœ¨ NLL ä¸­ï¼ŒMDN åœ¨ NLL ä¸­å–å¾—äº†æœ€å¥½çš„æ•ˆæœã€‚

![](img/31eb0efcd81cfa5e4cb65249b3df35ff.png)

Source: Author

# çœŸå®ä¸–ç•Œæ•°æ®çš„åº”ç”¨

æˆ‘ä»¬ä»¥é¢„æµ‹ä»·æ ¼çš„ä¾‹å­å¼€å§‹è¿™ç¯‡æ–‡ç« ã€‚åœ¨å†—é•¿çš„æŠ€æœ¯é˜è¿°ä¹‹åï¼Œè®©æˆ‘ä»¬å›åˆ°æœ€åˆçš„ä¾‹å­:é¢„æµ‹ä»·æ ¼ã€‚

ä¸ºäº†ä¾¿äºåˆ†æï¼Œæˆ‘ä»¬ä½¿ç”¨æ•°æ®é›†çš„æœè‡:æ³¢å£«é¡¿ä½æˆ¿ã€‚ç»™å®šå¤§çº¦ 13 ä¸ªç‹¬ç«‹å˜é‡ï¼Œç›®æ ‡æ˜¯é¢„æµ‹ä»¥ 1000 ç¾å…ƒä¸ºå•ä½çš„è‡ªæœ‰ä½æˆ¿çš„ä¸­å€¼(MDEV)ã€‚è¿™ä¸ªä¾‹å­å¯èƒ½æ²¡æœ‰å……åˆ†åˆ©ç”¨ MDNs çš„èƒ½åŠ›æ¥å»ºæ¨¡å¤šæ¨¡æ€åˆ†å¸ƒã€‚å°½ç®¡å¦‚æ­¤ï¼Œå®ƒæ˜¾ç¤ºäº† MDN å¦‚ä½•èƒ½å¤Ÿæ¨¡æ‹Ÿä»·æ ¼çš„ä¸ç¡®å®šæ€§ã€‚è‡ªå˜é‡ä½¿ç”¨æœ€å°-æœ€å¤§ç¼©æ”¾å™¨è¿›è¡Œè½¬æ¢ï¼Œè€Œä»·æ ¼åˆ™è¿›è¡Œå¯¹æ•°è½¬æ¢ã€‚

![](img/6ddb95722e658ed36c8633445bb7cf63.png)

Source: Author

åœ¨ NLL ä¸­ï¼Œæˆ‘ä»¬è§‚å¯Ÿåˆ°ä¸å‰é¢çš„ä¾‹å­ç±»ä¼¼çš„è¡Œä¸ºã€‚MDN èƒ½å¤Ÿæ›´å¥½åœ°å¤„ç†æ•°æ®ã€‚å› æ­¤ï¼Œè™½ç„¶æˆ‘ä»¬åœ¨ä¾‹å­ä¸­å¯èƒ½æ²¡æœ‰å¤šæ¨¡æ€ï¼Œä½†æˆ‘ä»¬è‚¯å®šå—ç›Šäº**å¯¹å®Œæ•´æ¡ä»¶æ¦‚ç‡**çš„å»ºæ¨¡ï¼Œè€Œä¸ä»…ä»…æ˜¯ç‚¹ä¼°è®¡ã€‚

![](img/53700a4f003f1ddcf8774c258e7905bb.png)

Source: Author

åˆ†æä¸åŒæˆ¿å±‹çš„æ¡ä»¶å¯†åº¦æœ‰åŠ©äºæˆ‘ä»¬æ›´å¥½åœ°åšå‡ºå†³å®šã€‚æˆ‘ä»¬å¯¹ 18 å·æˆ¿çš„é«˜ä»·ç›¸å½“æœ‰ä¿¡å¿ƒï¼Œå› æ­¤ï¼Œä½œä¸ºç®¡ç†è€…ï¼Œæˆ‘ä»¬å¯ä»¥ç›¸åº”åœ°è®¾å®šä»·æ ¼ã€‚

å¯¹ 12 å·æˆ¿çš„é¢„æµ‹å¾ˆä¸ç¡®å®šã€‚å¯èƒ½éœ€è¦äººç±»ä¸“å®¶ç›´æ¥è¯„ä¼°æ¡ˆä¾‹æ¥è®¾å®šä»·æ ¼ã€‚

æˆ¿å­ 13 å’Œ 45 åœ¨ä»·æ ¼ä¸Šç¡®å®é‡å ã€‚ç›´æ¥åˆ†æå®ƒä»¬çš„å±æ€§æ˜¯æœ‰æ„ä¹‰çš„ï¼Œä»¥æŸ¥çœ‹å®ƒä»¬æ˜¯å¦å¯ä»¥ä½œä¸ºç›¸åŒä»·æ ¼èŒƒå›´å†…çš„ä¹°å®¶æ„Ÿå…´è¶£çš„å¯¹è±¡ã€‚è™½ç„¶æˆ‘ä»¬æ²¡æœ‰åœ¨è¿™ä¸ªç®€å•çš„æ•°æ®é›†ä¸­æŒ–æ˜æ¨¡å‹çš„å…¨éƒ¨æ½œåŠ›ï¼Œä½†æˆ‘ä»¬ä»ç„¶ä»é™„åŠ åŠŸèƒ½ä¸­å—ç›Šã€‚

# æ‘˜è¦

è¯„ä¼°ä¸ç¡®å®šæ€§æ˜¯ç°ä»£ä¼ä¸šçš„ä¸€ä¸ªé‡è¦æ–¹é¢ã€‚è¿™ç¯‡åšæ–‡é‡ç‚¹ä»‹ç»äº†ç†è®ºæ¨ç†ã€å®ç°ç»†èŠ‚ä»¥åŠä½¿ç”¨ MDN æ—¶çš„ä¸€äº›æŠ€å·§å’Œè¯€çªã€‚æˆ‘ä»¬å±•ç¤ºäº† MDN åœ¨æ¨¡æ‹Ÿå’Œå®é™…åº”ç”¨ä¸­çš„èƒ½åŠ›ã€‚ç”±äºå®ƒçš„ç®€å•æ€§å’Œæ¨¡å—åŒ–ï¼Œæˆ‘ä»¬æœŸå¾…å¹¿æ³›çš„åº”ç”¨ã€‚

å¦‚æœ‰ç–‘é—®ï¼Œæ¬¢è¿è”ç³» [me](mailto:borchers@bwl.uni-mannheim.de) ã€‚

## é™„åŠ è¯´æ˜

> **ä»£ç åœ¨**[**Github**](https://github.com/oborchers/Medium_Repo)**/**[**Colab**](https://colab.research.google.com/drive/1at5lIq0jYvA58AmJ0aVgn2aUVpzIbwS3)**ä¸Šæœ‰ã€‚**æœ¬æŒ‡å—æ˜¯ä¸º Tensorflow 1.12.0 å’Œ Tensorflow-Probability 0.5.0 ç¼–å†™çš„ã€‚

## æ–‡å­¦

[1] Christopher M. Bishopï¼Œ[æ¨¡å¼è¯†åˆ«ä¸æœºå™¨å­¦ä¹ ](http://users.isr.ist.utl.pt/~wurmd/Livros/school/Bishop%20-%20Pattern%20Recognition%20And%20Machine%20Learning%20-%20Springer%20%202006.pdf) (2006)

[2]å…‹é‡Œæ–¯æ‰˜å¼—Â·mÂ·æ¯•æ™“æ™®ï¼Œ[æ··åˆå¯†åº¦ç½‘ç»œ](https://publications.aston.ac.uk/373/1/NCRG_94_004.pdf) (1994)

[3] Siri å›¢é˜Ÿï¼Œ[Siri è¯­éŸ³çš„æ·±åº¦å­¦ä¹ :ç”¨äºæ··åˆå•å…ƒé€‰æ‹©åˆæˆçš„è®¾å¤‡ä¸Šæ·±åº¦æ··åˆå¯†åº¦ç½‘ç»œ](https://machinelearning.apple.com/2017/08/06/siri-voices.html) (2017)

[4] Alex Gravesï¼Œ[ç”¨é€’å½’ç¥ç»ç½‘ç»œç”Ÿæˆåºåˆ—](https://arxiv.org/pdf/1308.0850.pdf) (2014)

[5] Christopher Bonnettï¼Œ[Edwardï¼ŒKeras å’Œ TensorFlow çš„æ··åˆå¯†åº¦ç½‘ç»œ](http://cbonnett.github.io/MDN_EDWARD_KERAS_TF.html) (2016)

[6]å´ç‚³æµ©ï¼Œ[æ··åˆå¯†åº¦ç½‘ç»œ:åŸºç¡€çŸ¥è¯†](https://ngbinghao.gitlab.io/posts/mixture-density-networks-basics/) (2017)

[7] Otoroï¼Œ[tensor flow æ··åˆå¯†åº¦ç½‘ç»œ](http://blog.otoro.net/2015/11/24/mixture-density-networks-with-tensorflow/) (2016)

[8] Mike Dusenberryï¼Œ[æ··åˆå¯†åº¦ç½‘ç»œ](https://mikedusenberry.com/mixture-density-networks) (2017)

[9]äºšé©¬é€Šï¼Œ[æ··åˆå¯†åº¦ç½‘ç»œé…æ–¹](https://docs.aws.amazon.com/forecast/latest/dg/aws-forecast-recipe-mdn.html) (2019)

[10] Axel Brandoï¼Œ[åˆ†å¸ƒå’Œä¸ç¡®å®šæ€§ä¼°è®¡çš„æ··åˆå¯†åº¦ç½‘ç»œå®æ–½](https://github.com/axelbrando/Mixture-Density-Networks-for-distribution-and-uncertainty-estimation) (2017)

[11] Alex Graves ç­‰äººï¼Œ[ä½¿ç”¨å…·æœ‰åŠ¨æ€å¤–éƒ¨å­˜å‚¨å™¨çš„ç¥ç»ç½‘ç»œçš„æ··åˆè®¡ç®—](https://www.nature.com/articles/nature20101.pdf) (2016)

## æ”¾å¼ƒ

è¡¨è¾¾çš„è§‚ç‚¹ä»…ä»£è¡¨æˆ‘ä¸ªäººï¼Œå¹¶ä¸ä»£è¡¨æˆ‘çš„é›‡ä¸»çš„è§‚ç‚¹æˆ–æ„è§ã€‚ä½œè€…å¯¹æœ¬ç½‘ç«™å†…å®¹çš„ä»»ä½•é”™è¯¯æˆ–é—æ¼ä¸æ‰¿æ‹…ä»»ä½•è´£ä»»æˆ–ä¹‰åŠ¡ã€‚æœ¬ç½‘ç«™åŒ…å«çš„ä¿¡æ¯æŒ‰â€œåŸæ ·â€æä¾›ï¼Œä¸ä¿è¯å®Œæ•´æ€§ã€å‡†ç¡®æ€§ã€æœ‰ç”¨æ€§æˆ–åŠæ—¶æ€§ã€‚