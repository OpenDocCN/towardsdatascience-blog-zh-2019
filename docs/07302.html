<html>
<head>
<title>A Deep dive into H2O’s AutoML</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">对 H2O 汽车的深入探究</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/a-deep-dive-into-h2os-automl-4b1fe51d3f3e?source=collection_archive---------6-----------------------#2019-10-14">https://towardsdatascience.com/a-deep-dive-into-h2os-automl-4b1fe51d3f3e?source=collection_archive---------6-----------------------#2019-10-14</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="79f6" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">H2O 汽车公司的自动机器学习概述</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/45b7f1d04a14bb2ac48ca9bb8dfe0933.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kBVmV9ju5BG3dat-74uwEQ.jpeg"/></div></div></figure><p id="4b89" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">过去几年，对机器学习系统的需求激增。这主要是由于机器学习技术在广泛应用中的成功。AutoML 通过让来自不同背景的人使用机器学习模型来解决复杂的场景，从根本上改变了今天基于 ML 的解决方案的面貌。然而，即使有明确的迹象表明机器学习可以促进某些业务，今天许多公司仍在努力部署 ML 模型。</p><p id="3350" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这是因为该行业缺乏经验丰富的数据科学家。在某种程度上，对机器学习专家的需求已经超过了供应。其次，大量的机器学习步骤需要的经验多于知识，尤其是在决定训练哪些模型以及如何评估它们的时候。如今，这种差距非常明显，人们正在努力解决这些问题。自动机器学习可能是这些障碍的答案，在本文中，我们将深入了解如何实现这一点。</p></div><div class="ab cl lq lr hx ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="im in io ip iq"><h1 id="3512" class="lx ly it bd lz ma mb mc md me mf mg mh jz mi ka mj kc mk kd ml kf mm kg mn mo bi translated">自动机器学习:AutoML</h1><p id="103a" class="pw-post-body-paragraph ku kv it kw b kx mp ju kz la mq jx lc ld mr lf lg lh ms lj lk ll mt ln lo lp im bi translated"><strong class="kw iu">自动化机器学习</strong> ( <strong class="kw iu"> AutoML </strong>)是将机器学习应用于现实世界问题的端到端过程自动化的过程。AutoML 倾向于自动化 ML 管道中的最大数量的步骤——用最少的人力——而不损害模型的性能。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mu"><img src="../Images/dca9065d7f26da5425ae787542705c4b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*X1inNyeToc3AX3TwZWrh4g.png"/></div></div><figcaption class="mv mw gj gh gi mx my bd b be z dk">Aspects of Automated Machine Learning</figcaption></figure><p id="ac99" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">自动化机器学习可以被认为是标准的机器学习过程，其中涉及一些步骤的自动化。AutoML 非常广泛地包括:</p><ul class=""><li id="1974" class="mz na it kw b kx ky la lb ld nb lh nc ll nd lp ne nf ng nh bi translated">自动化数据准备的某些部分，如插补、标准化、特征选择等。</li><li id="1ef9" class="mz na it kw b kx ni la nj ld nk lh nl ll nm lp ne nf ng nh bi translated">能够自动生成各种模型，如随机网格搜索、贝叶斯超参数优化等。</li><li id="42d3" class="mz na it kw b kx ni la nj ld nk lh nl ll nm lp ne nf ng nh bi translated">从所有生成的模型中获取最佳模型，这些模型大多数情况下是集成的，例如集成选择、堆叠等。</li></ul></div><div class="ab cl lq lr hx ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="im in io ip iq"><h1 id="dda2" class="lx ly it bd lz ma mb mc md me mf mg mh jz mi ka mj kc mk kd ml kf mm kg mn mo bi translated">H2O 的自动机器学习</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/cb161b6ca81655615588b65752d8aa96.png" data-original-src="https://miro.medium.com/v2/resize:fit:1086/format:webp/1*S6kE_nwoge5m7ok1onsjsQ.png"/></div></figure><p id="64d6" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><a class="ae no" href="https://www.h2o.ai/products/h2o/#overview" rel="noopener ugc nofollow" target="_blank"><strong class="kw iu"/></a>是一个完全开源的、分布式内存中的机器学习平台，具有线性可扩展性。H2O 支持最广泛使用的统计&amp;机器学习算法，包括梯度增强机器、广义线性模型、深度学习等等。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi np"><img src="../Images/4eae57fb3d12aba64a5e3aa2ce05843a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4OORCfjnEIa9hFWOJySvuw.png"/></div></div><figcaption class="mv mw gj gh gi mx my bd b be z dk">Features of H2O</figcaption></figure><p id="1c15" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">H2O 还拥有业界领先的 AutoML 功能(在 H2O ≥3.14 版本中可用)，该功能可以自动构建大量模型，从而在数据科学家没有任何先验知识或工作的情况下找到“<strong class="kw iu">最佳</strong>”模型。H2O AutoML 可用于自动化机器学习工作流，包括在用户指定的时间限制内自动训练和调整许多模型。</p><p id="1acb" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">H2O AutoML 的一些重要特征是:</p><ul class=""><li id="4eeb" class="mz na it kw b kx ky la lb ld nb lh nc ll nd lp ne nf ng nh bi translated">尖端 ML 算法的开源、分布式(多核+多节点)实现。</li><li id="e7fe" class="mz na it kw b kx ni la nj ld nk lh nl ll nm lp ne nf ng nh bi translated">高性能 Java 中核心算法的可用性。包括 R，Python，Scala，web GUI 中的 API。</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/0f82d0a4d7041857cd4fcf930ba2ec86.png" data-original-src="https://miro.medium.com/v2/resize:fit:1256/format:webp/1*YIng6ox_7TjwpSvGk6o01g.png"/></div></figure><ul class=""><li id="1a26" class="mz na it kw b kx ky la lb ld nb lh nc ll nd lp ne nf ng nh bi translated">将模型作为纯 Java 代码轻松部署到生产环境中。</li><li id="88e2" class="mz na it kw b kx ni la nj ld nk lh nl ll nm lp ne nf ng nh bi translated">无缝地在 Hadoop、Spark、AWS、您的笔记本电脑等上工作。</li></ul><h2 id="e9b9" class="nr ly it bd lz ns nt dn md nu nv dp mh ld nw nx mj lh ny nz ml ll oa ob mn oc bi translated">是给谁的？</h2><p id="f3fe" class="pw-post-body-paragraph ku kv it kw b kx mp ju kz la mq jx lc ld mr lf lg lh ms lj lk ll mt ln lo lp im bi translated">H2O 的 AutoML 对新手和高级用户来说都是有用的工具。它提供了一个简单的包装函数，可以执行大量与建模相关的任务，这些任务通常需要许多行代码。这实质上释放了时间来关注数据科学管道的其他方面，如数据预处理、特征工程和模型部署。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi od"><img src="../Images/74bb74c0b6f72e8c5e9f63569039de80.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lvRcM4RPbCwTbc280SC27A.png"/></div></div></figure><h2 id="f0ff" class="nr ly it bd lz ns nt dn md nu nv dp mh ld nw nx mj lh ny nz ml ll oa ob mn oc bi translated">AutoML 接口</h2><p id="155d" class="pw-post-body-paragraph ku kv it kw b kx mp ju kz la mq jx lc ld mr lf lg lh ms lj lk ll mt ln lo lp im bi translated">H2O AutoML 有一个 R 和 Python 接口以及一个叫做 Flow 的 web GUI。H2O AutoML 界面设计为具有尽可能少的参数，因此用户所需要做的就是指向他们的数据集，识别响应列，并可选地指定时间约束或对训练的总模型数的限制。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oe"><img src="../Images/b76639156e2e9c99970c0faa1fa3d7b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TIBTTg5mf-MeQ1xQQkDZ-g.png"/></div></div><figcaption class="mv mw gj gh gi mx my bd b be z dk">H2O AutoML is available in R, Python, and a web GUI.</figcaption></figure></div><div class="ab cl lq lr hx ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="im in io ip iq"><h2 id="6136" class="nr ly it bd lz ns nt dn md nu nv dp mh ld nw nx mj lh ny nz ml ll oa ob mn oc bi translated"><a class="ae no" href="http://docs.h2o.ai/h2o/latest-stable/h2o-docs/downloading.html#install-in-r" rel="noopener ugc nofollow" target="_blank">安装</a></h2><p id="c28f" class="pw-post-body-paragraph ku kv it kw b kx mp ju kz la mq jx lc ld mr lf lg lh ms lj lk ll mt ln lo lp im bi translated">H2O 提供了一个可以从 CRAN 安装的<strong class="kw iu"> R 包</strong>和一个可以从 PyPI 安装的<strong class="kw iu"> Python 包</strong>。在本文中，我们将只使用 Python 实现。此外，您可能想要查看<a class="ae no" href="http://docs.h2o.ai/h2o/latest-stable/h2o-docs/downloading.html" rel="noopener ugc nofollow" target="_blank">文档</a>以了解完整的细节。</p><p id="0658" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><strong class="kw iu">依赖关系:</strong></p><pre class="kj kk kl km gt of og oh oi aw oj bi"><span id="287b" class="nr ly it og b gy ok ol l om on">pip install requests<br/>pip install tabulate<br/>pip install "colorama&gt;=0.3.8"<br/>pip install future</span></pre><ul class=""><li id="d590" class="mz na it kw b kx ky la lb ld nb lh nc ll nd lp ne nf ng nh bi translated">使用 pip 安装</li></ul><pre class="kj kk kl km gt of og oh oi aw oj bi"><span id="0873" class="nr ly it og b gy ok ol l om on">pip install h2o</span></pre><p id="ba3f" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">每个新的 python 会话都从初始化 Python 客户端和 H2O <a class="ae no" href="http://docs.h2o.ai/h2o/latest-stable/h2o-docs/glossary.html" rel="noopener ugc nofollow" target="_blank">集群</a>之间的连接开始。</p></div><div class="ab cl lq lr hx ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="im in io ip iq"><h1 id="65b9" class="lx ly it bd lz ma mb mc md me mf mg mh jz mi ka mj kc mk kd ml kf mm kg mn mo bi translated">H2O 汽车功能</h1><p id="fe92" class="pw-post-body-paragraph ku kv it kw b kx mp ju kz la mq jx lc ld mr lf lg lh ms lj lk ll mt ln lo lp im bi translated">H2O 的 AutoML 配备了以下功能:</p><ul class=""><li id="5f87" class="mz na it kw b kx ky la lb ld nb lh nc ll nd lp ne nf ng nh bi translated">必要的<strong class="kw iu">数据预处理</strong>功能(与所有 H2O 算法一样)。</li><li id="476f" class="mz na it kw b kx ni la nj ld nk lh nl ll nm lp ne nf ng nh bi translated">训练一个<a class="ae no" href="http://docs.h2o.ai/h2o/latest-stable/h2o-docs/grid-search.html" rel="noopener ugc nofollow" target="_blank"> <strong class="kw iu">随机网格</strong> </a> <strong class="kw iu">的算法</strong>如 GBMs、DNNs、GLMs 等。使用精心选择的超参数空间。</li><li id="7118" class="mz na it kw b kx ni la nj ld nk lh nl ll nm lp ne nf ng nh bi translated">单个模型使用<strong class="kw iu">交叉验证</strong>进行调整。</li><li id="68e6" class="mz na it kw b kx ni la nj ld nk lh nl ll nm lp ne nf ng nh bi translated">两个<a class="ae no" href="http://docs.h2o.ai/h2o/latest-stable/h2o-docs/data-science/stacked-ensembles.html" rel="noopener ugc nofollow" target="_blank"> <strong class="kw iu">层叠合奏</strong> </a>受训。一个集成包含所有模型(针对模型性能进行优化)，另一个集成仅提供每个算法类/家族中性能最佳的模型(针对生产使用进行优化)。</li><li id="b250" class="mz na it kw b kx ni la nj ld nk lh nl ll nm lp ne nf ng nh bi translated">返回所有型号的排序后的“<strong class="kw iu">排行榜</strong>”。</li><li id="15a9" class="mz na it kw b kx ni la nj ld nk lh nl ll nm lp ne nf ng nh bi translated">所有型号都可以轻松出口到<strong class="kw iu">生产</strong>。</li></ul></div><div class="ab cl lq lr hx ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="im in io ip iq"><h1 id="69ba" class="lx ly it bd lz ma mb mc md me mf mg mh jz mi ka mj kc mk kd ml kf mm kg mn mo bi translated">个案研究</h1><p id="0005" class="pw-post-body-paragraph ku kv it kw b kx mp ju kz la mq jx lc ld mr lf lg lh ms lj lk ll mt ln lo lp im bi translated"><strong class="kw iu">使用机器学习预测库存管理中的材料延期交货</strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oo"><img src="../Images/83d2a90e01f4797e3011cd44dd4a5931.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wzrKcevPx41X42nALlViJQ.jpeg"/></div></div><figcaption class="mv mw gj gh gi mx my bd b be z dk">Image by <a class="ae no" href="https://pixabay.com/users/marcin049-46288/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=186980" rel="noopener ugc nofollow" target="_blank">marcin049</a> from <a class="ae no" href="https://pixabay.com/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=186980" rel="noopener ugc nofollow" target="_blank">Pixabay</a></figcaption></figure><p id="79a6" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">对于案例研究，我们将使用一个<a class="ae no" href="https://www.researchgate.net/publication/319553365_Predicting_Material_Backorders_in_Inventory_Management_using_Machine_Learning" rel="noopener ugc nofollow" target="_blank"> <strong class="kw iu">产品延期交货</strong> </a>数据集。这里的目标是在给定许多产品指标(如当前库存、运输时间、需求预测和以前的销售)的情况下，预测产品是否会处于延期交货状态。这是一个经典的二元分类问题。可以从这里访问数据集。</p><p id="9a2c" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><strong class="kw iu">参考</strong></p><p id="b27c" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><em class="op"> R. B .森蒂斯峰、E. P .阿吉亚尔和 l .戈利亚特，“使用机器学习预测库存管理中的材料缺货”，第四届 IEEE 拉丁美洲计算智能大会，秘鲁阿雷基帕，2017 年。</em></p><h2 id="1908" class="nr ly it bd lz ns nt dn md nu nv dp mh ld nw nx mj lh ny nz ml ll oa ob mn oc bi translated">方法学</h2><p id="9de6" class="pw-post-body-paragraph ku kv it kw b kx mp ju kz la mq jx lc ld mr lf lg lh ms lj lk ll mt ln lo lp im bi translated">这个机器问题的基本概要如下。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oq"><img src="../Images/a9f771cc4aa7c2b42c6162d252313d3f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yhoxvv6VE8OLrHBOHuGv6Q.png"/></div></div></figure><ul class=""><li id="3cfe" class="mz na it kw b kx ky la lb ld nb lh nc ll nd lp ne nf ng nh bi translated"><strong class="kw iu">开始 H2O </strong></li></ul><p id="1d27" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们从<strong class="kw iu">导入</strong>的<strong class="kw iu"> h2o </strong> Python 模块和<code class="fe or os ot og b">H2OAutoML</code>类开始。然后，初始化本地 H2O 集群。</p><pre class="kj kk kl km gt of og oh oi aw oj bi"><span id="351c" class="nr ly it og b gy ok ol l om on">import h2o<br/>from h2o.automl import H2OAutoML<br/>h2o.init(max_mem_size='16G')</span></pre><p id="a161" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这是一个本地的 H2O 集群。在执行单元时，一些信息将以表格的形式显示在屏幕上，其中包括节点数量、总内存、Python 版本等..此外，<code class="fe or os ot og b">h2o.init()</code>确保没有 H2O 的先前实例正在运行。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ou"><img src="../Images/530756480874aaa8d51cf5fac9c7836c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oqjFEBmapjq0fIcfu8mCCg.png"/></div></div></figure><p id="ab92" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">默认情况下，H2O 实例使用所有的内核和大约 25%的系统内存。但是，如果您希望为它分配固定的内存块，您可以在 init 函数中指定它。</p><ul class=""><li id="7c95" class="mz na it kw b kx ky la lb ld nb lh nc ll nd lp ne nf ng nh bi translated"><strong class="kw iu">将数据加载到 H2O </strong></li></ul><p id="22a2" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">让我们从本地 CSV 文件导入数据。该命令与<code class="fe or os ot og b">pandas.read_csv</code>非常相似，数据以<a class="ae no" href="http://docs.h2o.ai/h2o/latest-stable/h2o-py/docs/frame.html" rel="noopener ugc nofollow" target="_blank">H2 of frame</a>的形式存储在内存中。</p><pre class="kj kk kl km gt of og oh oi aw oj bi"><span id="7f5d" class="nr ly it og b gy ok ol l om on">data_path = "https://github.com/h2oai/h2o-tutorials/raw/master/h2o-world-2017/automl/data/product_backorders.csv"</span><span id="6808" class="nr ly it og b gy ov ol l om on"># Load data into H2O<br/>df = h2o.import_file(data_path)</span></pre><p id="9aad" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">让我们来看一部分数据。</p><pre class="kj kk kl km gt of og oh oi aw oj bi"><span id="85eb" class="nr ly it og b gy ok ol l om on">df.head()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ow"><img src="../Images/7cc558588d84d9bb4f86829b2431ec9c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bcSpnFBRNL006If64sO09w.png"/></div></div><figcaption class="mv mw gj gh gi mx my bd b be z dk">A sample of the dataset</figcaption></figure><pre class="kj kk kl km gt of og oh oi aw oj bi"><span id="47e0" class="nr ly it og b gy ok ol l om on">print(f'Size of training set: <strong class="og iu">{df.shape[0]}</strong> rows and <strong class="og iu">{df.shape[1]}</strong> columns')<br/>-------------------------------------------------------------<br/>Size of training set: 19053 rows and 23 columns</span></pre><ul class=""><li id="4ee3" class="mz na it kw b kx ky la lb ld nb lh nc ll nd lp ne nf ng nh bi translated"><strong class="kw iu">将数据集分为训练数据集和测试数据集</strong></li></ul><pre class="kj kk kl km gt of og oh oi aw oj bi"><span id="d9d5" class="nr ly it og b gy ok ol l om on">splits = df.split_frame(ratios=[0.8],seed=1)<br/>train = splits[0]<br/>test = splits[1]</span></pre><ul class=""><li id="b47c" class="mz na it kw b kx ky la lb ld nb lh nc ll nd lp ne nf ng nh bi translated"><strong class="kw iu">指定响应和预测变量</strong></li></ul><p id="2235" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">接下来，让我们确定<strong class="kw iu">响应列</strong> n，并将列名保存为 y。响应列名为“<strong class="kw iu"> went_on_backorder </strong>，表示产品是否延期交货(二进制响应)。我们还将删除<code class="fe or os ot og b">sku</code>列，因为它是一个唯一的标识符，不应该包含在预测列集中，预测列存储在一个名为 x 的列表中。</p><pre class="kj kk kl km gt of og oh oi aw oj bi"><span id="1d49" class="nr ly it og b gy ok ol l om on">y = "went_on_backorder" <br/>x = df.columns <br/>x.remove(y) <br/>x.remove("sku")</span></pre><ul class=""><li id="d928" class="mz na it kw b kx ky la lb ld nb lh nc ll nd lp ne nf ng nh bi translated"><strong class="kw iu">运行 AutoML </strong></li></ul><p id="c229" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">运行 AutoML，120 秒后停止。<code class="fe or os ot og b">max_runtime_secs</code>参数提供了一种按时间限制 AutoML 运行的方法。</p><pre class="kj kk kl km gt of og oh oi aw oj bi"><span id="9278" class="nr ly it og b gy ok ol l om on">aml = H2OAutoML(max_runtime_secs=120, seed=1)<br/>aml.train(x=x,y=y, training_frame=train)</span></pre><p id="d547" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><strong class="kw iu">所需停止参数</strong></p><p id="8167" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">有两种停止策略(基于时间或模型数量)，必须指定其中一种。如果设置了这两个选项，AutoML 运行将在达到其中一个限制时立即停止。</p><ul class=""><li id="f1e7" class="mz na it kw b kx ky la lb ld nb lh nc ll nd lp ne nf ng nh bi translated"><a class="ae no" href="http://docs.h2o.ai/h2o/latest-stable/h2o-docs/data-science/algo-params/max_runtime_secs.html" rel="noopener ugc nofollow" target="_blank"><strong class="kw iu">max _ runtime _ secs</strong></a>:此参数控制 AutoML 在训练最终堆叠集合模型之前最多运行多长时间。默认为 3600 秒(1 小时)。</li><li id="a0b2" class="mz na it kw b kx ni la nj ld nk lh nl ll nm lp ne nf ng nh bi translated"><a class="ae no" href="http://docs.h2o.ai/h2o/latest-stable/h2o-docs/data-science/algo-params/max_models.html" rel="noopener ugc nofollow" target="_blank"> <strong class="kw iu"> max_models </strong> </a>:指定 AutoML 运行中要构建的模型的最大数量，不包括堆叠整体模型。默认为<code class="fe or os ot og b">NULL/None</code>。</li></ul><p id="0680" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">还有几个可选参数可以设置，例如:</p><p id="0f56" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">nfolds、balance_classes、class_sampling_factors、max_after_balance_size、max_runtime_secs_per_model、stopping_metric 等。你可以在<a class="ae no" href="http://docs.h2o.ai/h2o/latest-stable/h2o-docs/automl.html" rel="noopener ugc nofollow" target="_blank">文档</a>中读到更多关于它们的内容。</p><h2 id="80be" class="nr ly it bd lz ns nt dn md nu nv dp mh ld nw nx mj lh ny nz ml ll oa ob mn oc bi translated">排行榜</h2><p id="463c" class="pw-post-body-paragraph ku kv it kw b kx mp ju kz la mq jx lc ld mr lf lg lh ms lj lk ll mt ln lo lp im bi translated">接下来，我们可以查看 AutoML 排行榜。AutoML 对象包括在该过程中训练的模型的“排行榜”，包括 5 重交叉验证的模型性能(默认)。</p><p id="29d3" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">每个机器学习任务的默认性能指标(二元分类、多类分类、回归)在内部指定，排行榜将按该指标排序。</p><pre class="kj kk kl km gt of og oh oi aw oj bi"><span id="0340" class="nr ly it og b gy ok ol l om on">lb = aml.leaderboard<br/>lb.head()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ox"><img src="../Images/3180ea86072d75e15e47aac69281215d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GZkiiY9yUIvW59vQbJzhcw.png"/></div></div></figure><p id="b018" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">排行榜显示了 AutoML 构建的前 10 个模型及其参数。最佳模型是一个堆叠集合(放置在顶部)，并存储为<code class="fe or os ot og b">aml.leader.</code></p><p id="6112" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><strong class="kw iu">系综探索</strong></p><p id="ff11" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">为了理解集合是如何工作的，让我们看一看堆叠集合“所有模型”模型的内部。“所有模型”集合是 AutoML 运行中所有单个模型的集合。这通常是排行榜上表现最好的型号。</p><pre class="kj kk kl km gt of og oh oi aw oj bi"><span id="4362" class="nr ly it og b gy ok ol l om on"><em class="op"># Get model ids for all models in the AutoML Leaderboard</em><br/>model_ids = list(aml.leaderboard['model_id'].as_data_frame().iloc[:,0])</span><span id="b267" class="nr ly it og b gy ov ol l om on"><em class="op"># Get the "All Models" Stacked Ensemble model</em><br/>se = h2o.get_model([mid for mid <strong class="og iu">in</strong> model_ids if "StackedEnsemble_AllModels" <strong class="og iu">in</strong> mid][0])</span><span id="e232" class="nr ly it og b gy ov ol l om on"><em class="op"># Get the Stacked Ensemble metalearner model</em><br/>metalearner = h2o.get_model(se.metalearner()['name'])</span></pre><p id="194d" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">检查集合中 metalearner(合并器)算法的可变重要性。这向我们展示了每个基础学习者对整体的贡献。</p><pre class="kj kk kl km gt of og oh oi aw oj bi"><span id="311b" class="nr ly it og b gy ok ol l om on">%matplotlib inline<br/>metalearner.std_coef_plot()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oy"><img src="../Images/d6789e5affc2a648534c6091bebbcd23.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wP2ogdug6TCKDE5ZBuOL9A.png"/></div></div><figcaption class="mv mw gj gh gi mx my bd b be z dk">Plotting the base learner contributions to the ensemble.</figcaption></figure><p id="33a8" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><strong class="kw iu">使用 Leader 模型预测</strong></p><pre class="kj kk kl km gt of og oh oi aw oj bi"><span id="c2da" class="nr ly it og b gy ok ol l om on">pred = aml.predict(test)<br/>pred.head()</span></pre><p id="46c3" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><strong class="kw iu">拯救领袖模式</strong></p><p id="676d" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">您还可以保存并下载您的模型，并将其用于部署到生产环境中。</p><pre class="kj kk kl km gt of og oh oi aw oj bi"><span id="184d" class="nr ly it og b gy ok ol l om on">h2o.save_model(aml.leader, path="./product_backorders_model_bin")</span></pre></div><div class="ab cl lq lr hx ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="im in io ip iq"><h1 id="28ce" class="lx ly it bd lz ma mb mc md me mf mg mh jz mi ka mj kc mk kd ml kf mm kg mn mo bi translated">结论</h1><p id="573e" class="pw-post-body-paragraph ku kv it kw b kx mp ju kz la mq jx lc ld mr lf lg lh ms lj lk ll mt ln lo lp im bi translated">从本质上来说，AutoML 的目的是自动化重复的任务，如管道创建和超参数调整，以便数据科学家可以将更多的时间花在手头的业务问题上。AutoML 还旨在让每一个人都能使用这项技术，而不是少数人。AutoML 和数据科学家可以协同工作来加速 ML 过程，以便可以利用机器学习的真正有效性。</p></div><div class="ab cl lq lr hx ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="im in io ip iq"><p id="822e" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><a class="ae no" href="https://www.h2o.ai/blog/a-deep-dive-into-h2os-automl/" rel="noopener ugc nofollow" target="_blank"> <em class="op">原发表于 H2O.ai </em> </a></p></div></div>    
</body>
</html>