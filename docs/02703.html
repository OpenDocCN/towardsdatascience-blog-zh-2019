<html>
<head>
<title>Careful! Looking at you model results too much can cause information leakage</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">小心点。过多地关注你的模型结果会导致信息泄露</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/careful-looking-at-your-model-results-too-much-can-cause-information-leakage-95b4517404bc?source=collection_archive---------18-----------------------#2019-05-02">https://towardsdatascience.com/careful-looking-at-your-model-results-too-much-can-cause-information-leakage-95b4517404bc?source=collection_archive---------18-----------------------#2019-05-02</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="cda8" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在建立机器学习模型时，总是要使用尽可能多的数据。我想我们都知道<a class="ae ko" href="https://en.wikipedia.org/wiki/Overfitting" rel="noopener ugc nofollow" target="_blank">过度拟合</a>的问题，这实质上是你建立的模型复制了训练数据结果，以至于完美地拟合了训练数据，而不是概括地更好地代表数据的总体，当你输入新数据并得到非常奇怪的结果时，会产生灾难性的结果。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi kp"><img src="../Images/ba678d08518fdafc243d922e21521312.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*IdK32w4CCojCEOWv"/></div></div><figcaption class="lb lc gj gh gi ld le bd b be z dk">Photo by <a class="ae ko" href="https://unsplash.com/@dylu?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Jacek Dylag</a> on <a class="ae ko" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="02a6" class="lf lg it bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">你能做些什么来防止这种情况发生？</h1><p id="d83d" class="pw-post-body-paragraph jq jr it js b jt md jv jw jx me jz ka kb mf kd ke kf mg kh ki kj mh kl km kn im bi translated">看看网上，你会发现大量的<a class="ae ko" href="https://elitedatascience.com/overfitting-in-machine-learning" rel="noopener ugc nofollow" target="_blank">文章</a>关于过度适配，什么是过度适配以及如何防止过度适配。这些已经在很大程度上完成了，所以我不会在这里重复它们，但通常这些可以通过在开始之前分离可用的数据来最容易地控制。</p><h1 id="cf56" class="lf lg it bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">有哪些数据隔离？</h1><p id="f59b" class="pw-post-body-paragraph jq jr it js b jt md jv jw jx me jz ka kb mf kd ke kf mg kh ki kj mh kl km kn im bi translated">最基本的方法是将整个可用数据集分成三个不同的样本(没有重复)，并给定以下标签:</p><ul class=""><li id="48d5" class="mi mj it js b jt ju jx jy kb mk kf ml kj mm kn mn mo mp mq bi translated">培养</li><li id="56ce" class="mi mj it js b jt mr jx ms kb mt kf mu kj mv kn mn mo mp mq bi translated">确认</li><li id="932d" class="mi mj it js b jt mr jx ms kb mt kf mu kj mv kn mn mo mp mq bi translated">试验</li></ul><p id="bca2" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">训练、测试和验证数据集每个都执行特定的<a class="ae ko" href="https://en.wikipedia.org/wiki/Training,_validation,_and_test_sets" rel="noopener ugc nofollow" target="_blank">目的</a>，并且通常不会具有相同的大小。事实上，一些最常用的值是 3:1:1 分割(或者 60%训练，20%验证和 20%测试)</p><h2 id="e1ea" class="mw lg it bd lh mx my dn ll mz na dp lp kb nb nc lt kf nd ne lx kj nf ng mb nh bi translated">培训用数据</h2><p id="8107" class="pw-post-body-paragraph jq jr it js b jt md jv jw jx me jz ka kb mf kd ke kf mg kh ki kj mh kl km kn im bi translated">这是数据的核心。这是用来训练和创建您使用的模型的。自然地，你在训练中获得的数据越多，你就能更好地期望模型推广到它。这通常包含所有可用数据的 60%左右。</p><h2 id="ffde" class="mw lg it bd lh mx my dn ll mz na dp lp kb nb nc lt kf nd ne lx kj nf ng mb nh bi translated">验证数据</h2><p id="d569" class="pw-post-body-paragraph jq jr it js b jt md jv jw jx me jz ka kb mf kd ke kf mg kh ki kj mh kl km kn im bi translated">这是用于调整和改进模型的数据集。每当您训练一个模型时，您都使用它来对照验证集，以便生成一些预测并对其性能进行评分。然后，您可以调整该模型，重新训练它，并根据该数据再次运行它，以查看是否有所改进。这可能是一个非常迭代的步骤。您希望这里的数据大小合理，以覆盖模型将暴露的参数空间，但不要太大，因为您的模型没有足够的数据进行训练。这通常占所有可用数据的 20%左右。</p><h2 id="b8d0" class="mw lg it bd lh mx my dn ll mz na dp lp kb nb nc lt kf nd ne lx kj nf ng mb nh bi translated">测试数据</h2><p id="a8f3" class="pw-post-body-paragraph jq jr it js b jt md jv jw jx me jz ka kb mf kd ke kf mg kh ki kj mh kl km kn im bi translated">这些数据在项目开始时就被放在一边，直到您对您的模型满意为止。然后你把它应用到这个数据上，看看它是否真的学会了很好地概括，或者它是否被过度拟合了。与验证数据集相似，您需要足够的数据来涵盖您想要测试的内容，并获得模型正常工作的信心，但您不希望从可以训练的内容中获取太多信息。这通常是现有数据的 20%左右。</p><h1 id="ce71" class="lf lg it bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">你提到覆盖参数空间？</h1><p id="431c" class="pw-post-body-paragraph jq jr it js b jt md jv jw jx me jz ka kb mf kd ke kf mg kh ki kj mh kl km kn im bi translated">我做到了。例如，如果您要针对不同直径管道中的水流量运行模型，您需要确保您拥有验证数据(实际上是所有三组数据),以确保模型能够学习这种能力并进行测试。如果您只对一个管径的数据进行训练，它了解到水流量和管径之间存在关系的可能性非常低，从而导致其他管径的结果很差。</p><p id="bb47" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">因此，为培训保留足够的数据非常重要。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi ni"><img src="../Images/1ca93432f9d748207a81788e1f2cd923.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*_8unmcIeUp9UMQ5O"/></div></div><figcaption class="lb lc gj gh gi ld le bd b be z dk">Photo by <a class="ae ko" href="https://unsplash.com/@onelast?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">T L</a> on <a class="ae ko" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="29ac" class="lf lg it bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">保存数据</h1><p id="d533" class="pw-post-body-paragraph jq jr it js b jt md jv jw jx me jz ka kb mf kd ke kf mg kh ki kj mh kl km kn im bi translated">如果 40%的数据只是用于调整和对您的模型进行最终评分，那么对于一个需要大量变化的特性的复杂模型，您可能需要大量数据。为了增加可用于训练数据的数据量，科学家通常会使用<a class="ae ko" href="https://en.wikipedia.org/wiki/Cross-validation_(statistics)" rel="noopener ugc nofollow" target="_blank">交叉验证</a>。</p><p id="bbc5" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">交叉验证是指将训练集和验证集中的数据集中起来，然后系统地分割成段(或“折叠”)，再分配给每个组，而不是固定的。例如，对于四重交叉验证，为测试和验证放置的数据被分成四个相等的组，并且这些组中的每一个轮流作为验证集，而其他三个被汇集到训练集中。</p><p id="7c7c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">最终，这意味着您已经获得了针对每个数据点的预测，并且还使用它来训练模型(但不是同时),并且正在利用更多的数据。交叉验证也以这种方式用于调整您正在使用的特定模型的超参数，以提高准确性。</p><h1 id="31f9" class="lf lg it bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">那么问题是什么呢？</h1><p id="be90" class="pw-post-body-paragraph jq jr it js b jt md jv jw jx me jz ka kb mf kd ke kf mg kh ki kj mh kl km kn im bi translated">您仍然只使用了 80%的数据，并且总是有一种使用测试集查看当前模型结果的冲动。这通常不是问题，但前提是你能控制如何使用你得到的数据。</p><p id="106f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">一些人将训练和调整模型，将验证集的准确性与测试集进行比较，一旦测试集的准确性不再提高而是变得更差，就停止调整模型。通常在这些情况下，即使测试集变得更差，验证集也会不断改进，这很好地说明了模型变得过度拟合。</p><p id="13b8" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">问题是你使用测试集来检查你的模型太慢了，但是可以肯定的是，你对测试集所做的和上面描述的验证集所发生的一样。对于较差的数据或非常复杂的模型，您可能会对测试集运行多次，而没有意识到您正在过度拟合，因为您正在使用您看到的信息并对模型进行更改。</p><p id="a9d7" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">例如，您得到了最终模型，并对测试集运行它，虽然结果还可以，但您会注意到，如果您更改参数，它可能会得到改进。您更改了它，模型得到了改进，但是您使用了关于测试集的信息来输入到模型中。信息已经在团体之间泄露了。</p><h1 id="6856" class="lf lg it bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">信息泄露</h1><p id="918f" class="pw-post-body-paragraph jq jr it js b jt md jv jw jx me jz ka kb mf kd ke kf mg kh ki kj mh kl km kn im bi translated">信息泄漏是指密封系统中的信息从不应该泄漏的地方泄漏出去。这是密码学中经常使用的一个术语，安全系统向窃听者提供了关于系统内部情况的线索，这可能被用来最终破坏安全性。</p><p id="f175" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">因此，这里的管道是数据科学家，他们无意中使用了自己的知识和技能，并根据他们对测试集的表现来慢慢调整模型。</p><p id="0e86" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我应该补充一点，这通常不是一个大问题，但我见过一两次。我的方法也不是控制它的唯一方法，但是我在下面给出我的观点。</p><h1 id="6c59" class="lf lg it bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">能做些什么？</h1><p id="bc2a" class="pw-post-body-paragraph jq jr it js b jt md jv jw jx me jz ka kb mf kd ke kf mg kh ki kj mh kl km kn im bi translated">一旦你意识到这可能是一个问题，这是很容易控制的。最简单的解决方案是确保您没有多次使用最终测试集，并根据结果限制您的更改。</p><p id="ab66" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">对于模型调整来说，实际上从训练和验证数据池中取出另一小组数据并将其用作测试集的代理可能是有益的。通过这种方式，您仍然可以调整您的模型，并看到模型的改进是如何进行的(当这个额外的测试集变得更差时停止)，并且还具有保留最终测试集以展示最终结果的好处。</p><p id="cbd7" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">虽然这听起来像是更多的数据被保留并从培训中取走，但交叉验证方法可以帮助减轻这种情况。例如，你可以拿走 80%中的 10%到 20%，而你仍然在训练和验证剩下的 60%到 70%(这类似于非交叉验证方法)。</p><h1 id="49d0" class="lf lg it bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">要点</h1><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi nj"><img src="../Images/75427264fe71ee6146237fd6f3101135.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*-VzfhyjbbHhOtx56"/></div></div><figcaption class="lb lc gj gh gi ld le bd b be z dk">Photo by <a class="ae ko" href="https://unsplash.com/@laurenzpicture?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Laurenz Kleinheider</a> on <a class="ae ko" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="d1a7" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">当构建一个需要大量调整的复杂模型时，请注意:</p><ul class=""><li id="f3c6" class="mi mj it js b jt ju jx jy kb mk kf ml kj mm kn mn mo mp mq bi translated">针对最终保留的测试集进行测试会导致过度拟合</li><li id="4ea2" class="mi mj it js b jt mr jx ms kb mt kf mu kj mv kn mn mo mp mq bi translated">根据您的最终测试集结果，限制您对模型的修改程度</li><li id="3fc4" class="mi mj it js b jt mr jx ms kb mt kf mu kj mv kn mn mo mp mq bi translated">你可以成为过度拟合你的模型的管道</li><li id="e88c" class="mi mj it js b jt mr jx ms kb mt kf mu kj mv kn mn mo mp mq bi translated">交叉验证可以帮助你充分利用你所拥有的数据</li><li id="7454" class="mi mj it js b jt mr jx ms kb mt kf mu kj mv kn mn mo mp mq bi translated">如果要拟合很多超参数，额外的测试集会很有用</li></ul></div></div>    
</body>
</html>