<html>
<head>
<title>Using Python Pandas Dataframe vs Min Heap Data Structure</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">ä½¿ç”¨ Python Pandas æ•°æ®å¸§ä¸æœ€å°å †æ•°æ®ç»“æ„</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://towardsdatascience.com/implement-a-min-heap-to-solve-performance-issue-with-data-processing-1f7f891a4ec0?source=collection_archive---------17-----------------------#2019-03-26">https://towardsdatascience.com/implement-a-min-heap-to-solve-performance-issue-with-data-processing-1f7f891a4ec0?source=collection_archive---------17-----------------------#2019-03-26</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/f47b9249eae8376c8f519c7f2d6eaee0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*8HE8_YOtLjGuZYAr"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk">Photo by <a class="ae kf" href="https://unsplash.com/@mkunsplash84?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Marian Kroell</a> on <a class="ae kf" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure></div><div class="ab cl kg kh hx ki" role="separator"><span class="kj bw bk kk kl km"/><span class="kj bw bk kk kl km"/><span class="kj bw bk kk kl"/></div><div class="im in io ip iq"><h1 id="59fa" class="kn ko it bd kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk bi translated">ä»‹ç»</h1><p id="2d37" class="pw-post-body-paragraph ll lm it ln b lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi im bi translated">æœ€è¿‘æˆ‘èŠ±äº†å¾ˆå¤šæ—¶é—´ç ”ç©¶åŸºæœ¬çš„æ•°æ®ç»“æ„ï¼ŒåŒ…æ‹¬æ ˆã€é˜Ÿåˆ—ã€å †å’Œæ ‘ã€‚å®ƒæ•™ä¼šäº†æˆ‘ç”¨ä»¥ä¸‹ä¸åŒçš„æ–¹å¼è§£å†³é—®é¢˜(ä»£ç ):</p><ul class=""><li id="aa10" class="mj mk it ln b lo ml ls mm lw mn ma mo me mp mi mq mr ms mt bi translated">æ€»æ˜¯å¯»æ‰¾æœ€ç®€å•ã€æœ€æœ‰æ•ˆã€æœ€ä¼˜é›…çš„æ–¹å¼(å¯è¯»æ€§æ˜¯é‡‘)</li><li id="aaf0" class="mj mk it ln b lo mu ls mv lw mw ma mx me my mi mq mr ms mt bi translated">å®¡æŸ¥ï¼Œå®¡æŸ¥å’Œå®¡æŸ¥ï¼Œä»¥æé«˜ä»£ç çš„æ•ˆç‡(æ˜¯å¦æœ‰é‡å¤çš„éƒ¨åˆ†ï¼Ÿæˆ‘èƒ½æ¢ä¸€ç§æ–¹å¼åšå—ï¼Ÿæœ‰äº›æ­¥éª¤æ˜¯å¤šä½™çš„å—ï¼Ÿ)</li><li id="791a" class="mj mk it ln b lo mu ls mv lw mw ma mx me my mi mq mr ms mt bi translated">åœ¨é€‰æ‹©ä½ å¯ä»¥ä½¿ç”¨çš„å·¥å…·(æ¡†æ¶ã€æ•°æ®ç»“æ„ã€ç®—æ³•)æ—¶ï¼Œè¦å®é™…è€ƒè™‘</li></ul><p id="6056" class="pw-post-body-paragraph ll lm it ln b lo ml lq lr ls mm lu lv lw mz ly lz ma na mc md me nb mg mh mi im bi translated">é˜…è¯»ç†è®ºåªæ˜¯ä¸€ä¸ªå¼€å§‹ï¼Œåœ¨æˆ‘çœ‹æ¥ï¼Œå·©å›ºæ‰€å­¦çŸ¥è¯†çš„æœ€å¥½æ–¹æ³•æ˜¯å°†å…¶åº”ç”¨åˆ°ç°å®ä¸–ç•Œçš„é—®é¢˜ä¸­ã€‚å¹¸è¿çš„æ˜¯ï¼Œæˆ‘å‚ä¸çš„ä¸€ä¸ªé¡¹ç›®ä¸­æœ‰ä¸€éƒ¨åˆ†å¯ä»¥åˆ©ç”¨<code class="fe nc nd ne nf b">Min Heap</code>çš„å®ç°ï¼Œä¹Ÿå°±æ˜¯é€šå¸¸æ‰€è¯´çš„<code class="fe nc nd ne nf b">Priority Queue</code>ã€‚</p><figure class="nh ni nj nk gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi ng"><img src="../Images/46e548d9789146aa5d27dc8e1cb90aa8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wkGHmuUPGqtTvG8k4OzLxg.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk">An example of a <strong class="bd nl">Binary Min Heap</strong>, visualised in a tree structure.</figcaption></figure><p id="edb6" class="pw-post-body-paragraph ll lm it ln b lo ml lq lr ls mm lu lv lw mz ly lz ma na mc md me nb mg mh mi im bi translated">æˆ‘åœ¨ä¸‹é¢å‡ èŠ‚ä¸­æ¦‚è¿°äº†å®ç°:</p><ul class=""><li id="5581" class="mj mk it ln b lo ml ls mm lw mn ma mo me mp mi mq mr ms mt bi translated">é—®é¢˜æ˜¯</li><li id="5f4f" class="mj mk it ln b lo mu ls mv lw mw ma mx me my mi mq mr ms mt bi translated">åœ¨æœ€å°å †å®ç°ä¹‹å‰</li><li id="7800" class="mj mk it ln b lo mu ls mv lw mw ma mx me my mi mq mr ms mt bi translated">åœ¨æœ€å°å †å®ç°ä¹‹å</li><li id="39f5" class="mj mk it ln b lo mu ls mv lw mw ma mx me my mi mq mr ms mt bi translated">å‚è€ƒ</li></ul></div><div class="ab cl kg kh hx ki" role="separator"><span class="kj bw bk kk kl km"/><span class="kj bw bk kk kl km"/><span class="kj bw bk kk kl"/></div><div class="im in io ip iq"><h1 id="f759" class="kn ko it bd kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk bi translated">é—®é¢˜æ˜¯</h1><p id="2f7e" class="pw-post-body-paragraph ll lm it ln b lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi im bi translated">ä»»åŠ¡å¾ˆç®€å•:ä»æ‰€æœ‰æ»¡è¶³<strong class="ln iu">åŒ…å«ä¾èµ–è§„åˆ™</strong>çš„è¾“å…¥è¡¨ä¸­æ‰¾åˆ°æ‰€æœ‰<strong class="ln iu">åˆ—å¯¹</strong>ã€‚è§„åˆ™æ˜¯ï¼Œå¯¹äºæ¯ä¸ªåˆ—å¯¹ï¼Œä¸€åˆ—çš„æ‰€æœ‰å€¼éƒ½å¿…é¡»å­˜åœ¨äºå®ƒçš„åˆ—å¯¹ä¸­ã€‚ä¸‹é¢æ˜¯ä¸ºäº†æ›´å®¹æ˜“ç†è§£çš„ä¾‹å­ã€‚</p><figure class="nh ni nj nk gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nm"><img src="../Images/0b6d5605a998e2984c985e77a29fd0b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iW5d89a5_eGvNifrcu1rFQ.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk">In<strong class="bd nl"> Example 1</strong>, there were 2 checks performed: 1) column A in column B and 2) column B in column A. The valid column pair in this example is 2) <strong class="bd nl">column B in column A</strong>, because all values in column B exists in column A (inclusion dependency rule satisfied). In <strong class="bd nl">Example 2,</strong> both checks 1) column C in column D and 2) column D in column C are invalid, because the value LL300 only exists in column D.</figcaption></figure><p id="cdad" class="pw-post-body-paragraph ll lm it ln b lo ml lq lr ls mm lu lv lw mz ly lz ma na mc md me nb mg mh mi im bi translated">ç°åœ¨ï¼Œæ‚¨å¯èƒ½ä¼šæƒ³ï¼Œä¸ºä»€ä¹ˆè¦è®©äº‹æƒ…å˜å¾—å¤æ‚å‘¢ï¼Ÿæ‚¨å¯ä»¥é€šè¿‡æ£€æŸ¥æ¯ä¸€å¯¹ï¼Œä¸€åˆ—ä¸­çš„æ‰€æœ‰å€¼æ˜¯å¦éƒ½åŒ…å«åœ¨å¦ä¸€åˆ—ä¸­ï¼Œæ¥åº”ç”¨å¼ºåŠ›æ–¹æ³•ã€‚é—®é¢˜æ˜¯å¤§çº¦æœ‰ 900 ä¸ªè¡¨ï¼Œæ¯ä¸ªè¡¨éƒ½æœ‰ä¸åŒæ•°é‡çš„åˆ—ã€‚ç®€è€Œè¨€ä¹‹ï¼Œå½“ä½¿ç”¨æš´åŠ›æ–¹æ³•æ—¶ï¼Œè¦èŠ±å¾ˆé•¿æ—¶é—´æ¥å®Œæˆæ£€æŸ¥ã€‚</p></div><div class="ab cl kg kh hx ki" role="separator"><span class="kj bw bk kk kl km"/><span class="kj bw bk kk kl km"/><span class="kj bw bk kk kl"/></div><div class="im in io ip iq"><h1 id="7967" class="kn ko it bd kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk bi translated">åœ¨æœ€å°å †å®ç°ä¹‹å‰</h1><p id="a21c" class="pw-post-body-paragraph ll lm it ln b lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi im bi translated">æˆ‘æœ€åˆçš„æ–¹æ³•æ¯”æš´åŠ›æ–¹æ³•ç¨å¾®å¥½ä¸€ç‚¹ï¼Œä½†æ˜¯ï¼Œå®ƒä»ç„¶éœ€è¦å¾ˆé•¿æ—¶é—´æ¥è¿è¡Œã€‚æœ¬è´¨ä¸Šï¼Œåº”ç”¨äº†<code class="fe nc nd ne nf b">Single Pass</code>ç®—æ³•ã€‚è¿™æ„å‘³ç€åœ¨æ‰¾å‡ºåˆ—å¯¹æ—¶ï¼Œæ‰€æœ‰æ•°æ®(æˆ–å€¼)å°†åªè¢«è¯»å–ä¸€æ¬¡ï¼Œè€Œä¸æ˜¯å¤šæ¬¡(æƒ³æƒ³æš´åŠ›æ–¹æ³•ï¼Œæ‚¨å°†å¤šæ¬¡è¯»å–ç›¸åŒçš„åˆ—/å€¼)ã€‚</p><p id="15b7" class="pw-post-body-paragraph ll lm it ln b lo ml lq lr ls mm lu lv lw mz ly lz ma na mc md me nb mg mh mi im bi translated">ä¸ºæ­¤ï¼Œæˆ‘ä½¿ç”¨<code class="fe nc nd ne nf b">pandas</code>åº“æ„å»ºäº†ä¸€ä¸ªå•ç‹¬çš„<code class="fe nc nd ne nf b">data frame</code>ï¼Œå­˜å‚¨æ‰€æœ‰è¡¨ä¸­çš„æ‰€æœ‰åˆ—ï¼ŒåŒ…æ‹¬å®ƒä»¬çš„å€¼ã€‚æœ€åçš„<code class="fe nc nd ne nf b">data frame</code>çœ‹èµ·æ¥æ˜¯è¿™æ ·çš„ã€‚</p><pre class="nh ni nj nk gt nn nf no np aw nq bi"><span id="9f4c" class="nr ko it nf b gy ns nt l nu nv">A       B     C<br/>index<br/>0        nan     0.0   0.0<br/>1        1.0     nan   1.0<br/>2        2.0     nan   2.0<br/>3        nan     3.0   3.0</span></pre><p id="458e" class="pw-post-body-paragraph ll lm it ln b lo ml lq lr ls mm lu lv lw mz ly lz ma na mc md me nb mg mh mi im bi translated">è®©æˆ‘é€šè¿‡è¿™äº›æ­¥éª¤æ¥äº†è§£ä¸Šé¢çš„<code class="fe nc nd ne nf b">data frame</code>:</p><ul class=""><li id="77ef" class="mj mk it ln b lo ml ls mm lw mn ma mo me mp mi mq mr ms mt bi translated">å¯¹äºæ¯ä¸ªè¡¨ä¸­çš„æ¯ä¸€åˆ—ï¼Œå°†å…¶å”¯ä¸€å€¼å­˜å‚¨åœ¨ä¸€ä¸ª<code class="fe nc nd ne nf b">list</code>ä¸­ï¼ŒæŒ‰å‡åºæ’åº</li><li id="133f" class="mj mk it ln b lo mu ls mv lw mw ma mx me my mi mq mr ms mt bi translated">ä»æ‰€æœ‰åˆ—ä¸­è·å–æ‰€æœ‰å”¯ä¸€å€¼ï¼Œå°†å®ƒä»¬å­˜å‚¨åœ¨ä¸€ä¸ª<code class="fe nc nd ne nf b">list</code>ä¸­ï¼ŒæŒ‰å‡åºæ’åºï¼Œä¾‹å¦‚æŒ‰ç…§ä¸Šè¿°<code class="fe nc nd ne nf b">data frame</code>çš„<code class="fe nc nd ne nf b">[0, 1, 2, 3]</code></li><li id="feaf" class="mj mk it ln b lo mu ls mv lw mw ma mx me my mi mq mr ms mt bi translated">æ„é€ ä¸€ä¸ª<code class="fe nc nd ne nf b">data frame</code>å¹¶å°†å…¶<code class="fe nc nd ne nf b">index</code>è®¾ç½®ä¸ºåŒ…å«æ¥è‡ª<strong class="ln iu">æ­¥éª¤ 2 </strong>çš„æ‰€æœ‰å”¯ä¸€å€¼çš„<code class="fe nc nd ne nf b">list</code></li><li id="2e90" class="mj mk it ln b lo mu ls mv lw mw ma mx me my mi mq mr ms mt bi translated">é€šè¿‡<code class="fe nc nd ne nf b">index</code>ä¸Šçš„<code class="fe nc nd ne nf b">left join</code>åˆå¹¶ä»<strong class="ln iu">æ­¥éª¤ 1 </strong>åˆ°<strong class="ln iu">æ­¥éª¤ 3 </strong>çš„æ‰€æœ‰åˆ—è¡¨(å½“ä¸€åˆ—æ²¡æœ‰ç‰¹å®šå€¼æ—¶ï¼Œä¼šåœ¨æœ€åçš„<code class="fe nc nd ne nf b">data frame</code>ä¸­äº§ç”Ÿä¸€ä¸ª<code class="fe nc nd ne nf b">nan</code>æ¡ç›®)ï¼Œä¾‹å¦‚ï¼Œåˆ—<code class="fe nc nd ne nf b">A</code>æ²¡æœ‰<code class="fe nc nd ne nf b">[0, 3]</code>ã€‚</li></ul><blockquote class="nw nx ny"><p id="f3bb" class="ll lm nz ln b lo ml lq lr ls mm lu lv oa mz ly lz ob na mc md oc nb mg mh mi im bi translated">æ³¨æ„ï¼Œç”±äº<code class="fe nc nd ne nf b"><em class="it">nan</em></code>å€¼çš„å½¢æˆï¼Œ<code class="fe nc nd ne nf b"><em class="it">data frame</em></code>ä¸­çš„åˆ—ç±»å‹ä¸æ˜¯<code class="fe nc nd ne nf b"><em class="it">float64</em></code>ã€‚é‚£äº›åˆ—çš„åŸå§‹å€¼å®é™…ä¸Šæ˜¯<code class="fe nc nd ne nf b"><em class="it">int64</em></code>ã€‚</p></blockquote><p id="6b97" class="pw-post-body-paragraph ll lm it ln b lo ml lq lr ls mm lu lv lw mz ly lz ma na mc md me nb mg mh mi im bi translated">åœ¨è¿­ä»£<code class="fe nc nd ne nf b">data frame</code>ä¸­çš„æ¯ä¸€è¡Œä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦åˆå§‹åŒ–ä¸€ä¸ªåŒ…å«åˆå§‹åŒ…å«ä¾èµ–åˆ—åˆ—è¡¨çš„<code class="fe nc nd ne nf b">dictionary</code>ã€‚ç­‰ç­‰ï¼Œä»€ä¹ˆï¼Ÿè®©æˆ‘ç»™ä½ å±•ç¤ºä¸€ä¸‹<code class="fe nc nd ne nf b">dictionary</code>çš„æ ·å­ï¼Œè®©ä½ æ˜ç™½è¿™ä¸€ç‚¹ã€‚</p><pre class="nh ni nj nk gt nn nf no np aw nq bi"><span id="3a30" class="nr ko it nf b gy ns nt l nu nv">inclusion_dict = {'A': ['B', 'C'],<br/>                  'B': ['A', 'C'],<br/>                  'C': ['A', 'B']}</span></pre><p id="8111" class="pw-post-body-paragraph ll lm it ln b lo ml lq lr ls mm lu lv lw mz ly lz ma na mc md me nb mg mh mi im bi translated">ç°åœ¨æ›´æœ‰æ„ä¹‰äº†ï¼Ÿå› æ­¤ï¼ŒåŸºæœ¬ä¸Šï¼Œæˆ‘ä»¬åˆå§‹åŒ–æ‰€æœ‰å¯èƒ½çš„åˆ—å¯¹(ä¾‹å¦‚ï¼Œåˆ— B ä¸­çš„åˆ— Aï¼Œåˆ— C ä¸­çš„åˆ— Aï¼Œè¡¨ç¤ºä¸ºå­—å…¸æ¡ç›®<code class="fe nc nd ne nf b">'A': ['B', 'C']</code>ï¼Œç­‰ç­‰ã€‚)ä½œä¸ºæˆ‘ä»¬è¿­ä»£å‰çš„èµ·ç‚¹ã€‚å½“æˆ‘ä»¬è¿­ä»£<code class="fe nc nd ne nf b">data frame</code>ä¸­çš„æ¯ä¸€è¡Œæ—¶ï¼Œ<code class="fe nc nd ne nf b">inclusion_dict</code>å°†ä¼šç›¸åº”åœ°æ›´æ–°(æ›´å¤šä¿¡æ¯è§ä¸‹æ–‡)ã€‚</p><p id="9f72" class="pw-post-body-paragraph ll lm it ln b lo ml lq lr ls mm lu lv lw mz ly lz ma na mc md me nb mg mh mi im bi translated">å¥½äº†ï¼Œè®©æˆ‘ä»¬æ¥è°ˆè°ˆè¿­ä»£ã€‚ä¸‹é¢æ˜¯æ‰§è¡Œè¿­ä»£çš„ä»£ç ã€‚</p><pre class="nh ni nj nk gt nn nf no np aw nq bi"><span id="c4b0" class="nr ko it nf b gy ns nt l nu nv">def sp_algorithm(dataframe, inclusion_dict):</span><span id="9d1f" class="nr ko it nf b gy od nt l nu nv">    # for each value, get all columns that contains it<br/>    for val in dataframe.index:</span><span id="0cd0" class="nr ko it nf b gy od nt l nu nv">        cols_list = dataframe.columns[dataframe.isin([val]).any()]</span><span id="fc6b" class="nr ko it nf b gy od nt l nu nv">        # for each column in inclusion_dict.keys(), intersect its values with cols_list to get the remaining column pairs candidates<br/>        for key_col in inclusion_dict.keys():</span><span id="3b72" class="nr ko it nf b gy od nt l nu nv">            column_val = dataframe.loc[val, key_col]</span><span id="bd35" class="nr ko it nf b gy od nt l nu nv"># if the current column value is null, then do nothing<br/>            if (column_val == column_val) &amp; (column_val != ''):<br/>                col_dict[key_col] = list(set(col_dict[key_col]).intersection(cols_list))</span></pre><p id="add4" class="pw-post-body-paragraph ll lm it ln b lo ml lq lr ls mm lu lv lw mz ly lz ma na mc md me nb mg mh mi im bi translated">æé†’ä¸€ä¸‹ï¼Œè¿™æ˜¯<code class="fe nc nd ne nf b">data frame</code>ã€‚</p><pre class="nh ni nj nk gt nn nf no np aw nq bi"><span id="c846" class="nr ko it nf b gy ns nt l nu nv">A       B     C<br/>index<br/>0        nan     0.0   0.0<br/>1        1.0     nan   1.0<br/>2        2.0     nan   2.0<br/>3        nan     3.0   3.0</span></pre><p id="51ef" class="pw-post-body-paragraph ll lm it ln b lo ml lq lr ls mm lu lv lw mz ly lz ma na mc md me nb mg mh mi im bi translated">åœ¨<code class="fe nc nd ne nf b">data frame</code>è¡Œçš„æ¯æ¬¡è¿­ä»£ä¸­ï¼Œä¼šå‘ç”Ÿä»¥ä¸‹æƒ…å†µ:</p><ul class=""><li id="d4f4" class="mj mk it ln b lo ml ls mm lw mn ma mo me mp mi mq mr ms mt bi translated"><code class="fe nc nd ne nf b">cols_list</code>:è·å–åŒ…å«å½“å‰ç´¢å¼•å€¼çš„æ‰€æœ‰åˆ—(åªæ˜¯å®ƒä»¬çš„åç§°)<code class="fe nc nd ne nf b">val</code></li><li id="e6a5" class="mj mk it ln b lo mu ls mv lw mw ma mx me my mi mq mr ms mt bi translated">å¯¹äº<code class="fe nc nd ne nf b">inclusion_dict</code>ä¸­çš„æ¯ä¸€åˆ—(å­—å…¸çš„<code class="fe nc nd ne nf b">key</code>),æ ¹æ®ä½ç½®<code class="fe nc nd ne nf b">.loc</code>åœ¨<code class="fe nc nd ne nf b">data frame</code>ä¸­è·å–å…¶å€¼</li><li id="cd87" class="mj mk it ln b lo mu ls mv lw mw ma mx me my mi mq mr ms mt bi translated">æ£€æŸ¥<strong class="ln iu">ç¬¬äºŒæ­¥</strong>çš„å€¼æ˜¯å¦ä¸º<code class="fe nc nd ne nf b">nan</code>å’Œ/æˆ–<code class="fe nc nd ne nf b">''</code>ï¼Œå¦‚æœä¸æ˜¯ï¼Œé€šè¿‡ä¸<code class="fe nc nd ne nf b">cols_list</code>ç›¸äº¤æ›´æ–°<code class="fe nc nd ne nf b">inclusion_dict</code>ã€‚ä¾‹å¦‚ï¼Œåœ¨ä¸Šé¢çš„<code class="fe nc nd ne nf b">data frame</code>çš„ç¬¬ä¸€æ¬¡è¿­ä»£ä¸­ï¼Œ<code class="fe nc nd ne nf b">cols_list</code>å°†æ˜¯<code class="fe nc nd ne nf b">['B', 'C']</code>ï¼Œå› ä¸ºå®ƒä»¬åŒ…å«å€¼<code class="fe nc nd ne nf b">0</code>ã€‚å½“æˆ‘ä»¬æŸ¥æ‰¾<code class="fe nc nd ne nf b">inclusion_dict</code>æ—¶ï¼Œ<code class="fe nc nd ne nf b">key_col = 'A'</code>å°†è¢«è·³è¿‡ï¼Œå› ä¸ºå®ƒåœ¨<code class="fe nc nd ne nf b">if statement</code>ä¸­è¿”å›<code class="fe nc nd ne nf b">False</code>ï¼Œå› ä¸ºå®ƒæ˜¯<code class="fe nc nd ne nf b">nan</code>(å‚è§<code class="fe nc nd ne nf b">data frame</code>ä¸­ç´¢å¼•<code class="fe nc nd ne nf b">0</code>å¤„çš„<code class="fe nc nd ne nf b">A</code>åˆ—)ã€‚å¯¹äº<code class="fe nc nd ne nf b">key_col = 'B'</code>ï¼Œæˆ‘ä»¬å°†æŠŠå®ƒå½“å‰çš„<code class="fe nc nd ne nf b">inclusion_dict</code>å€¼ä¸<code class="fe nc nd ne nf b">cols_list</code>ç›¸äº¤ï¼Œè¿™æ ·æˆ‘ä»¬å°±æœ‰äº†<code class="fe nc nd ne nf b">['C']</code>ã€‚è¿™æ˜¯å› ä¸º<code class="fe nc nd ne nf b">['A', 'C']</code> <strong class="ln iu">ä¸<code class="fe nc nd ne nf b">['B', 'C']</code>ç›¸äº¤çš„</strong>å°±æ˜¯<code class="fe nc nd ne nf b">['C']</code>ã€‚å¯¹äº<code class="fe nc nd ne nf b">key_col = 'C'</code>ï¼Œå…¶<code class="fe nc nd ne nf b">inclusion_dict</code>å‰©ä½™å€¼å°†ä¸º<code class="fe nc nd ne nf b">['B']</code>ã€‚</li></ul><blockquote class="nw nx ny"><p id="c980" class="ll lm nz ln b lo ml lq lr ls mm lu lv oa mz ly lz ob na mc md oc nb mg mh mi im bi translated">å—¯ï¼Œä¸Šé¢çš„ä¸€ç³»åˆ—ä»£ç å®é™…ä¸Šå·¥ä½œå¹¶äº§ç”Ÿäº†æˆ‘æƒ³è¦çš„ç»“æœï¼Œä½†æ˜¯ï¼Œè¿è¡Œæ—¶é—´éå¸¸æ…¢ï¼æ‰€ä»¥ï¼Œæˆ‘å¼€å§‹é—®è‡ªå·±ä¸€ä¸ªé—®é¢˜ï¼Œå¦‚æœæ•°æ®åº“å¤§å¾—å¤šï¼Œå¦‚æœæœ‰æ›´å¤šçš„è¡¨å’Œåˆ—è¦å¤„ç†æ€ä¹ˆåŠï¼Ÿ</p></blockquote><p id="cdca" class="pw-post-body-paragraph ll lm it ln b lo ml lq lr ls mm lu lv lw mz ly lz ma na mc md me nb mg mh mi im bi translated">æ­¤å¤–ï¼Œæ¯æ¬¡åœ¨<code class="fe nc nd ne nf b">sp_algorithm</code>è¿è¡Œæ—¶ä»£ç ä¸­å‡ºç°é”™è¯¯ï¼Œæˆ‘éƒ½å¿…é¡»ä»å¤´é‡æ–°è¿è¡Œæ•´ä¸ªç¨‹åºï¼Œè¿™èŠ±è´¹äº†æˆ‘å¾ˆé•¿æ—¶é—´ã€‚ä»£ç çœ‹èµ·æ¥ä¹Ÿä¸å¯è¯»ï¼Œéš¾ä»¥ç†è§£ï¼Œå¹¶ä¸”å¯èƒ½ä¸å¯æŒç»­ã€‚</p></div><div class="ab cl kg kh hx ki" role="separator"><span class="kj bw bk kk kl km"/><span class="kj bw bk kk kl km"/><span class="kj bw bk kk kl"/></div><div class="im in io ip iq"><h1 id="4eeb" class="kn ko it bd kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk bi translated">åœ¨æœ€å°å †å®ç°ä¹‹å</h1><p id="3b6e" class="pw-post-body-paragraph ll lm it ln b lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi im bi translated">å¤šäºäº†<code class="fe nc nd ne nf b">Min Heap</code>æ•°æ®ç»“æ„ï¼Œæˆ‘èƒ½å¤Ÿå°†è¿è¡Œæ—¶é—´æé«˜ 10 åˆ° 60 å€ï¼Œè¿™å–å†³äºæ•°æ®åº“(å¤§å°ã€è¡¨è®¡æ•°ã€åˆ—è®¡æ•°ã€å”¯ä¸€å€¼è®¡æ•°ç­‰ã€‚)!</p><p id="e34d" class="pw-post-body-paragraph ll lm it ln b lo ml lq lr ls mm lu lv lw mz ly lz ma na mc md me nb mg mh mi im bi translated">æ— è®ºå¦‚ä½•ï¼Œè¿™æ˜¯ä¸€ä¸ªå·¨å¤§çš„è¿›æ­¥ï¼æˆ‘ä¸å¿…æ•´å¤œè¿è¡Œæˆ‘çš„ä»£ç ï¼Œå¸Œæœ›æ²¡æœ‰ä»»ä½•ä¸œè¥¿ä¼šä¸­æ–­ï¼Œå¹¶åœ¨æ—©ä¸Šç¬¬ä¸€ä»¶äº‹å°±æ˜¯æ£€æŸ¥å®ƒã€‚ç°åœ¨ï¼Œæˆ‘å¯ä»¥éšæ—¶è¿è¡Œä»£ç ï¼Œå¹¶åœ¨å‡ åˆ†é’Ÿå†…å¾—åˆ°ç»“æœï¼Œè€Œä¸æ˜¯å‡ ä¸ªå°æ—¶ã€‚</p><p id="fa3f" class="pw-post-body-paragraph ll lm it ln b lo ml lq lr ls mm lu lv lw mz ly lz ma na mc md me nb mg mh mi im bi translated">äº‹ä¸å®œè¿Ÿï¼Œä¸‹é¢æ˜¯å®ç°ä»£ç ã€‚</p><pre class="nh ni nj nk gt nn nf no np aw nq bi"><span id="f8a1" class="nr ko it nf b gy ns nt l nu nv"># inclusion_dict from above<br/>inclusion_dict = {'A': ['B', 'C'],<br/>                  'B': ['A', 'C'],<br/>                  'C': ['A', 'B']}</span><span id="8afb" class="nr ko it nf b gy od nt l nu nv"># instead of a data frame, a dictionary is used to store columns from all tables<br/># column_dict stores sorted (ascending order) unique values from all columns from all tables<br/>column_dict = {'A': [1, 2], <br/>               'B': [0, 3],<br/>               'C': [0, 1, 2, 3]}</span><span id="a6ab" class="nr ko it nf b gy od nt l nu nv">def sp_algorithm(column_dict):<br/>    # initialise min heap<br/>    min_heap = []</span><span id="65ae" class="nr ko it nf b gy od nt l nu nv">    for column in column_dict:<br/>        vals = column_dict[column]</span><span id="22f0" class="nr ko it nf b gy od nt l nu nv">        for val in vals:<br/>            tup = (val, column)<br/>            heapq.heappush(min_heap, tup)</span><span id="fddb" class="nr ko it nf b gy od nt l nu nv">    while min_heap:</span><span id="0dcb" class="nr ko it nf b gy od nt l nu nv">        # get the smallest value in the heap<br/>        att = []</span><span id="eff2" class="nr ko it nf b gy od nt l nu nv">        current_smallest, var = heapq.heappop(min_heap)<br/>        att.append(var)</span><span id="5c80" class="nr ko it nf b gy od nt l nu nv">        # pop all elements where values are equal to current smallest and put them in att list<br/>        while min_heap and min_heap[0][0] == current_smallest:<br/>            next_var = heapq.heappop(min_heap)[-1]<br/>            att.append(next_var)</span><span id="848c" class="nr ko it nf b gy od nt l nu nv">        # update inclusion_dict<br/>        for a in att:<br/>            if a in inclusion_dict:<br/>                inclusion_dict[a] = list(set(inclusion_dict[a]).intersection(att))</span><span id="2a2b" class="nr ko it nf b gy od nt l nu nv"># final inclusion_dict should look like<br/>inclusion_dict = {'A': ['C'],<br/>                  'B': ['C'],<br/>                  'C': []}</span></pre><p id="609d" class="pw-post-body-paragraph ll lm it ln b lo ml lq lr ls mm lu lv lw mz ly lz ma na mc md me nb mg mh mi im bi translated"><code class="fe nc nd ne nf b">inclusion_dict</code>æœ€åçš„ç»“æœåŸºæœ¬ä¸Šè¯´:</p><ul class=""><li id="b799" class="mj mk it ln b lo ml ls mm lw mn ma mo me mp mi mq mr ms mt bi translated">åˆ— A å¯èƒ½ä¾èµ–äºåˆ— Cï¼Œå› ä¸ºå®ƒçš„æ‰€æœ‰å€¼éƒ½åœ¨åˆ— C ä¸­</li><li id="1da0" class="mj mk it ln b lo mu ls mv lw mw ma mx me my mi mq mr ms mt bi translated">åˆ— B å¯èƒ½ä¾èµ–äºåˆ— Cï¼Œå› ä¸ºå®ƒçš„æ‰€æœ‰å€¼éƒ½åœ¨åˆ— C ä¸­</li><li id="2eaf" class="mj mk it ln b lo mu ls mv lw mw ma mx me my mi mq mr ms mt bi translated">åˆ— C åœ¨æ­¤ä¸Šä¸‹æ–‡ä¸­æ²¡æœ‰ä¾èµ–å…³ç³»ï¼Œå› ä¸ºåˆ— A å’Œåˆ— B éƒ½ä¸åŒ…å«åˆ— C ä¸­çš„æ‰€æœ‰å€¼</li></ul><blockquote class="nw nx ny"><p id="8f4c" class="ll lm nz ln b lo ml lq lr ls mm lu lv oa mz ly lz ob na mc md oc nb mg mh mi im bi translated">æˆ‘å¸Œæœ›è¿™èƒ½ç»™ä½ ä¸€ä¸ªåœ¨é¡¹ç›®ä¸­å®ç°<code class="fe nc nd ne nf b"><em class="it">Min Heap</em></code>çš„æ½œåœ¨å¥½å¤„çš„æƒ³æ³•ã€‚æ­£å¦‚æˆ‘å‰é¢æåˆ°çš„ï¼Œæ€è€ƒå¹¶é‡æ–°æ€è€ƒä½ å¯ä»¥ä½¿ç”¨å“ªäº›å·¥å…·ï¼Œå¹¶æ˜æ™ºåœ°é€‰æ‹©ã€‚</p></blockquote><p id="04a1" class="pw-post-body-paragraph ll lm it ln b lo ml lq lr ls mm lu lv lw mz ly lz ma na mc md me nb mg mh mi im bi translated"><code class="fe nc nd ne nf b">Min Heap</code>èƒŒåçš„ç†è®ºä¸åœ¨æœ¬æ–‡è®¨è®ºèŒƒå›´ä¹‹å†…ã€‚æœ¬æ–‡çš„ä¸»è¦ç›®çš„æ˜¯å‘æ‚¨å±•ç¤ºä¸€ä¸ªçœŸå®ä¸–ç•Œä¸­çš„<code class="fe nc nd ne nf b">Min Heap</code>å®ç°ã€‚åˆ«æ‹…å¿ƒï¼Œåªè¦åœ¨è°·æ­Œä¸Šæœç´¢ä¸€ä¸‹ï¼Œä½ å°±ä¼šåœ¨<code class="fe nc nd ne nf b">Min Heap</code>ä¸Šæ‰¾åˆ°å¤§é‡çš„èµ„æºã€‚</p></div><div class="ab cl kg kh hx ki" role="separator"><span class="kj bw bk kk kl km"/><span class="kj bw bk kk kl km"/><span class="kj bw bk kk kl"/></div><div class="im in io ip iq"><h1 id="3a83" class="kn ko it bd kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk bi translated">å‚è€ƒ</h1><p id="7b9c" class="pw-post-body-paragraph ll lm it ln b lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi im bi translated">ä¸Šé¢æè¿°çš„æŠ€æœ¯æ¥è‡ªä¸€ç¯‡è®¨è®º<strong class="ln iu">å•ç¨‹åŒ…å«ä¾èµ–è¯†åˆ«(SPIDER) </strong>ç®—æ³•çš„è®ºæ–‡ã€‚ä½ å¯ä»¥åœ¨è¿™é‡Œäº†è§£æ›´å¤šä¿¡æ¯<a class="ae kf" href="https://hpi.de/fileadmin/user_upload/fachgebiete/naumann/publications/2010/HPI_34_Efficient_and_Exact_Computation_of_Inclusion_Dependencies_for_Data_Integration.pdf" rel="noopener ugc nofollow" target="_blank">ã€‚</a></p><p id="7991" class="pw-post-body-paragraph ll lm it ln b lo ml lq lr ls mm lu lv lw mz ly lz ma na mc md me nb mg mh mi im bi translated">å‰å¾€<strong class="ln iu">ç« èŠ‚ 2.2.2 </strong>å’Œ<strong class="ln iu"> 2.2.3 </strong>äº†è§£<strong class="ln iu">èœ˜è››</strong>ç®—æ³•çš„æ›´å¤šç»†èŠ‚ã€‚</p><p id="d376" class="pw-post-body-paragraph ll lm it ln b lo ml lq lr ls mm lu lv lw mz ly lz ma na mc md me nb mg mh mi im bi translated">å°±<code class="fe nc nd ne nf b">Heap</code>ç†è®ºè€Œè¨€ï¼Œä½ å¯ä»¥åœ¨è°·æ­Œä¸Šæ‰¾åˆ°å¾ˆå¤šå‚è€ƒèµ„æ–™ã€‚è¿™é‡Œæœ‰ä¸€æœ¬<a class="ae kf" href="https://www.pythoncentral.io/priority-queue-beginners-guide/" rel="noopener ugc nofollow" target="_blank">ä½ å¯ä»¥è¯»ã€‚</a></p></div><div class="ab cl kg kh hx ki" role="separator"><span class="kj bw bk kk kl km"/><span class="kj bw bk kk kl km"/><span class="kj bw bk kk kl"/></div><div class="im in io ip iq"><h1 id="6a94" class="kn ko it bd kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk bi translated">æœ€åçš„è¯</h1><p id="eb97" class="pw-post-body-paragraph ll lm it ln b lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi im bi translated">è¿™æ˜¯æˆ‘å†™çš„ç¬¬ä¸€ç¯‡æœ‰ç‚¹å†—é•¿çš„æ–‡ç« ï¼Œæ‰€ä»¥ï¼Œå¦‚æœä½ è§‰å¾—æœ‰ç”¨ï¼Œè¯·ç•™ä¸‹ä½ çš„åé¦ˆã€è¯„è®ºæˆ–ç»™æˆ‘é¼“æŒæˆ–åŠ ä¹¦ç­¾ã€‚</p><p id="05e6" class="pw-post-body-paragraph ll lm it ln b lo ml lq lr ls mm lu lv lw mz ly lz ma na mc md me nb mg mh mi im bi translated">æ¬¢è¿æå‡ºä»»ä½•é—®é¢˜æˆ–åœ¨ä¸‹é¢ç•™ä¸‹å»ºè®®ã€‚</p><p id="401e" class="pw-post-body-paragraph ll lm it ln b lo ml lq lr ls mm lu lv lw mz ly lz ma na mc md me nb mg mh mi im bi translated">å¹²æ¯ï¼ğŸ™‚</p></div></div>    
</body>
</html>