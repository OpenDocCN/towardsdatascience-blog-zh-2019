<html>
<head>
<title>Machine Learning Project 9 — Predict weight based on height and gender</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">机器学习项目 9——根据身高和性别预测体重</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/machine-learning-project-9-predict-weight-based-on-height-and-gender-9ed47285bcbb?source=collection_archive---------11-----------------------#2019-09-09">https://towardsdatascience.com/machine-learning-project-9-predict-weight-based-on-height-and-gender-9ed47285bcbb?source=collection_archive---------11-----------------------#2019-09-09</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/c202774cc80f58c8a93909bc41eeb01a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8wI2MaSK7IC8GB_fGAIWCg.jpeg"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk">source: pexels.com</figcaption></figure><p id="f740" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">今天我将处理这个<a class="ae ld" href="https://www.kaggle.com/mustafaali96/weight-height" rel="noopener ugc nofollow" target="_blank"> Kaggle 数据集</a>。这个数据集有 10，000 行，提供了人的体重、身高和性别。我们必须在这个数据集上建立和训练一个模型，这样它就可以根据一个人的性别和身高来预测他的体重。这是我们从事的第一个拥有大型数据集的项目。所以这将会很有趣。</p><p id="05f4" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated"><strong class="kh iu"># 100 daysofml code # 100 projectsinml</strong></p><p id="f151" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">让我们开始吧。</p></div><div class="ab cl le lf hx lg" role="separator"><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj"/></div><div class="im in io ip iq"><h1 id="7153" class="ll lm it bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">步骤 1:加载数据集</h1><p id="9ec6" class="pw-post-body-paragraph kf kg it kh b ki mj kk kl km mk ko kp kq ml ks kt ku mm kw kx ky mn la lb lc im bi translated">首先，我们将加载数据集。下面是样本数据集——完整的数据文件可以在<a class="ae ld" href="https://github.com/omairaasim/machine_learning/tree/master/project_9_predict_weight_sex" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p><figure class="mo mp mq mr gt ju"><div class="bz fp l di"><div class="ms mt l"/></div></figure><figure class="mo mp mq mr gt ju"><div class="bz fp l di"><div class="ms mt l"/></div></figure></div><div class="ab cl le lf hx lg" role="separator"><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj"/></div><div class="im in io ip iq"><h1 id="0220" class="ll lm it bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">第二步:分析数据</h1><p id="85c4" class="pw-post-body-paragraph kf kg it kh b ki mj kk kl km mk ko kp kq ml ks kt ku mm kw kx ky mn la lb lc im bi translated">数据集包含 3 列，即“性别”、“身高”和“体重”。</p><p id="93aa" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">高度以英寸为单位，重量以磅为单位。</p><p id="73d1" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">我们来分析一下数据。</p><figure class="mo mp mq mr gt ju"><div class="bz fp l di"><div class="ms mt l"/></div></figure><ul class=""><li id="2f7b" class="mu mv it kh b ki kj km kn kq mw ku mx ky my lc mz na nb nc bi translated"><strong class="kh iu"> dataset.info(): </strong></li></ul><p id="1c0f" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">这个方法返回下面的输出。它基本上显示了条目的数量、列名和列类型。下面是该命令的输出。</p><pre class="mo mp mq mr gt nd ne nf ng aw nh bi"><span id="8595" class="ni lm it ne b gy nj nk l nl nm">&lt;class ‘pandas.core.frame.DataFrame’&gt;<br/>RangeIndex: 10000 entries, 0 to 9999<br/>Data columns (total 3 columns):<br/>Gender 10000 non-null object<br/>Height 10000 non-null float64<br/>Weight 10000 non-null float64<br/>dtypes: float64(2), object(1)<br/>memory usage: 234.5+ KB</span></pre><ul class=""><li id="817d" class="mu mv it kh b ki kj km kn kq mw ku mx ky my lc mz na nb nc bi translated"><strong class="kh iu"> dataset.describe(): </strong></li></ul><p id="5d36" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">描述方法显示数据集数值的基本统计信息，如平均值、标准差、百分位数、最小值和最大值。</p><p id="e13e" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">例如:对于高度，我们可以看到平均值为 66.36 英寸，最小高度为 54.26 英寸，最大高度为 78.99 英寸。</p><p id="b41e" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">同样，平均体重为 161.44 磅，最小体重为 64.7 磅，最大体重为 269.98 磅。</p><p id="687b" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">下面是该命令的输出。</p><pre class="mo mp mq mr gt nd ne nf ng aw nh bi"><span id="ab3e" class="ni lm it ne b gy nj nk l nl nm">               Height       Weight<br/>count    10000.000000 10000.000000<br/>mean        66.367560   161.440357<br/>std          3.847528    32.108439<br/>min         54.263133    64.700127<br/>25%         63.505620   135.818051<br/>50%         66.318070   161.212928<br/>75%         69.174262   187.169525<br/>max         78.998742   269.989699</span></pre><ul class=""><li id="e2ab" class="mu mv it kh b ki kj km kn kq mw ku mx ky my lc mz na nb nc bi translated"><strong class="kh iu"> dataset.isnull()。sum() </strong></li></ul><p id="208b" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">这个方法主要用于检查数据集中是否有空值。这将在每一列中列出空值的数量</p><p id="0096" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">下面是该命令的输出。我们可以看到，这 3 列中没有空值。</p><pre class="mo mp mq mr gt nd ne nf ng aw nh bi"><span id="cfdf" class="ni lm it ne b gy nj nk l nl nm">Gender 0<br/>Height 0<br/>Weight 0<br/>dtype: int64</span></pre></div><div class="ab cl le lf hx lg" role="separator"><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj"/></div><div class="im in io ip iq"><h1 id="9c9f" class="ll lm it bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">步骤 3:将性别转换为数字</h1><p id="ee35" class="pw-post-body-paragraph kf kg it kh b ki mj kk kl km mk ko kp kq ml ks kt ku mm kw kx ky mn la lb lc im bi translated">在运行任何机器学习模型之前，我们必须将所有分类值(文本值)转换为数值。在我们的数据集中，我们可以看到我们有一个字段——“性别”，这是分类。所以我们必须把这个场转换成数值。</p><p id="e120" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">将分类值转换为数字的典型方法是使用 LabelEncoder 类将文本转换为数字，然后使用 OneHotEncoder 添加虚拟变量。我们在我们的<a class="ae ld" href="https://medium.com/@omairaasim/machine-learning-project-2-predict-profit-using-multiple-linear-regression-10e736d8bba5" rel="noopener">项目 2 </a>中做到了这一点。</p><p id="3b1d" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">但这仅在分类字段包含 2 个以上的值时有用，例如，假设我们有一个名为“城市”的字段，它包含 2 个以上的值，如“休斯顿”、“纽约”和“旧金山”。</p><p id="1d7f" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">在这种情况下，我们将首先使用 LabelEncoder 将城市转换为数字，如:" Houston" =&gt; 0 和" New York" =&gt; 1 和" San Francisco" =&gt; 2。</p><p id="bf7b" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">然后，我们将使用 OneHotEncoder 添加 3 个虚拟变量，每个城市一个。最后，我们将删除一个哑变量以避免哑变量陷阱。</p><blockquote class="nn no np"><p id="a680" class="kf kg nq kh b ki kj kk kl km kn ko kp nr kr ks kt ns kv kw kx nt kz la lb lc im bi translated">经验法则是——如果一个分类字段有<em class="it"> k </em>个值，那么你将需要<em class="it"> k-1 </em>个虚拟变量。</p></blockquote><p id="9cfe" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">现在在我们的例子中，我们的“性别”字段只包含 2 个值——“男性”和“女性”。当我们使用 LabelEncoder 时，它会转换 say "Male" =&gt;0 和" Female" =&gt; 1。因为它只包含 2 个值，所以我们没有必要使用 OneHotEncoder 和添加虚拟变量。如果我们使用 OneHotEncoder，它将最终添加 2 个伪变量，但我们将最终删除 1 个以避免伪陷阱。所以做了也没什么意义。</p><p id="32bf" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">因此，如果一个分类字段有两个值，我们有两种方法。</p><ul class=""><li id="8859" class="mu mv it kh b ki kj km kn kq mw ku mx ky my lc mz na nb nc bi translated"><strong class="kh iu">使用标签编码器</strong></li></ul><figure class="mo mp mq mr gt ju"><div class="bz fp l di"><div class="ms mt l"/></div></figure><ul class=""><li id="2daf" class="mu mv it kh b ki kj km kn kq mw ku mx ky my lc mz na nb nc bi translated"><strong class="kh iu">直接在数据框中替换</strong></li></ul><p id="f9d8" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">不使用 LabelEncoder，我们可以直接在数据帧中用 0 替换男性，用 1 替换女性，如下所示:</p><figure class="mo mp mq mr gt ju"><div class="bz fp l di"><div class="ms mt l"/></div></figure><p id="bdf7" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">在这两种情况下，性别将被转换为男性 0 和女性 1，如下面 x 的屏幕截图所示。</p><figure class="mo mp mq mr gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nu"><img src="../Images/cbd2d8b3ef1cee96e95eb1f3cd450bd3.png" data-original-src="https://miro.medium.com/v2/resize:fit:846/format:webp/1*VFtc2jSFnj_MMTyjSIBNew.png"/></div></div></figure></div><div class="ab cl le lf hx lg" role="separator"><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj"/></div><div class="im in io ip iq"><h1 id="99cf" class="ll lm it bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">步骤 4:将数据集分成训练集和测试集</h1><p id="13de" class="pw-post-body-paragraph kf kg it kh b ki mj kk kl km mk ko kp kq ml ks kt ku mm kw kx ky mn la lb lc im bi translated">我们将使用 80%的数据进行训练，20%的数据进行测试。</p><figure class="mo mp mq mr gt ju"><div class="bz fp l di"><div class="ms mt l"/></div></figure></div><div class="ab cl le lf hx lg" role="separator"><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj"/></div><div class="im in io ip iq"><h1 id="839f" class="ll lm it bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">步骤 5:拟合回归模型</h1><p id="92aa" class="pw-post-body-paragraph kf kg it kh b ki mj kk kl km mk ko kp kq ml ks kt ku mm kw kx ky mn la lb lc im bi translated">我们将使用线性回归来训练我们的模型。</p><figure class="mo mp mq mr gt ju"><div class="bz fp l di"><div class="ms mt l"/></div></figure></div><div class="ab cl le lf hx lg" role="separator"><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj"/></div><div class="im in io ip iq"><h1 id="64f2" class="ll lm it bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">步骤 6:预测测试集值</h1><figure class="mo mp mq mr gt ju"><div class="bz fp l di"><div class="ms mt l"/></div></figure><p id="7738" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">让我们比较一下预测值(lin_pred)和实际值(y_test)。我们可以看到我们的模型做得相当好。</p><figure class="mo mp mq mr gt ju gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/3a78059990372e14dc57f0da40a104bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:914/format:webp/1*auuKPqufU_bc9zreZaj-5w.png"/></div></figure></div><div class="ab cl le lf hx lg" role="separator"><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj"/></div><div class="im in io ip iq"><h1 id="feff" class="ll lm it bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">第七步:模型准确性</h1><p id="3c38" class="pw-post-body-paragraph kf kg it kh b ki mj kk kl km mk ko kp kq ml ks kt ku mm kw kx ky mn la lb lc im bi translated">我们可以检查几个指标，看看我们的模型表现如何。其中之一是 R 的平方。</p><p id="0b37" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">我们可以看到，我们的 R 平方显示出几乎 90%的精度，这很好。我们将在未来的项目中探索均方误差和平均绝对误差。</p><pre class="mo mp mq mr gt nd ne nf ng aw nh bi"><span id="5b2b" class="ni lm it ne b gy nj nk l nl nm">R square = 0.9052889824534557<br/>Mean squared Error = 97.87152220196164<br/>Mean absolute Error = 7.955916525326746</span><span id="e789" class="ni lm it ne b gy nw nk l nl nm"><br/>R square = 0.9052889824534557<br/>Mean squared Error = 97.87152220196164<br/>Mean absolute Error = 7.955916525326746</span></pre></div><div class="ab cl le lf hx lg" role="separator"><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj"/></div><div class="im in io ip iq"><h1 id="0d41" class="ll lm it bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">第八步:预测我的体重</h1><p id="22ac" class="pw-post-body-paragraph kf kg it kh b ki mj kk kl km mk ko kp kq ml ks kt ku mm kw kx ky mn la lb lc im bi translated">让我们看看这个模型在预测我的体重方面做得有多好。我身高 6 英尺 2 英寸，也就是 74 英寸。</p><figure class="mo mp mq mr gt ju"><div class="bz fp l di"><div class="ms mt l"/></div></figure><pre class="mo mp mq mr gt nd ne nf ng aw nh bi"><span id="f49f" class="ni lm it ne b gy nj nk l nl nm">My predicted weight = [197.2481918]</span></pre><p id="9325" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">我只能说这不准确:)—也许我只是一个离群值—离群值是我们改天再讨论的另一个话题。</p><p id="6252" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">我很享受这个项目的建设。寻找我接下来要解决的下一个具有挑战性的项目。</p><p id="bc83" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">源代码可以在<a class="ae ld" href="https://github.com/omairaasim/machine_learning/tree/master/project_9_predict_weight_sex" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p></div></div>    
</body>
</html>