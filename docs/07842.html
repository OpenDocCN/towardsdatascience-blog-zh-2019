<html>
<head>
<title>Using Python with Selenium to Automate Mouse Clicks and Filling Forms</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用 Python 和 Selenium 实现鼠标点击和表单填写的自动化</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/using-python-and-selenium-to-automate-filling-forms-and-mouse-clicks-f87c74ed5c0f?source=collection_archive---------2-----------------------#2019-10-30">https://towardsdatascience.com/using-python-and-selenium-to-automate-filling-forms-and-mouse-clicks-f87c74ed5c0f?source=collection_archive---------2-----------------------#2019-10-30</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="d622" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">对于这个例子，我们将通过 Instagram 的网站应用程序登录。</p><p id="8ead" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">实际上，我在日常工作流程中使用 Python 和 Selenium。在我工作的公司，我们有自己的网络应用程序，可以在线发送报告。每份报告都有一个账户。</p><p id="a706" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">由于我们每天都有客户加入，我们还需要创建新的帐户。随着我们雇佣更多销售团队成员，客户数量呈指数级增长。创建新账户是一个非常手工的过程，看一份报告，然后输入信息。这是我发现硒的地方。</p><p id="d743" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><a class="ae ko" href="https://www.seleniumhq.org/" rel="noopener ugc nofollow" target="_blank"> <em class="kp">硒</em> </a> <em class="kp"> </em>是一款针对网页浏览器的自动化工具<em class="kp"> </em>。除了 Python 之外，您还可以将它用于许多不同的编程语言。他们也有一个版本，你可以记录你使用浏览器的过程，他们能够模仿他们。</p><p id="5663" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果你有任何容易重复的任务，这是非常有用的。例如，在我的工作中，我从客户成功团队那里获得了一份新客户列表。在该文件中，它有帐户名、帐户 ID 和地址。我必须为每个新账户手工输入。硒可以解决这个问题。</p><p id="5950" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">让我们从简单的东西开始，自动登录 Instagram。登录任何网站基本上都是我们发送的一个小表格。我们将填写凭证的“表格”,然后单击提交按钮。</p><p id="2e3d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">要求:<br/> </strong> <em class="kp"> 1。Python w/ selenium 模块<br/> 2。chrome driver(selenium 使用的特殊谷歌 chrome)</em></p><p id="6be9" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">首先要做的是下载并在必要时安装需求。假设你已经安装了 Python，你可以在模块上做一个<code class="fe kq kr ks kt b">pip install</code>。我们需要的<em class="kp"> chromedriver </em>可以在<a class="ae ko" href="https://chromedriver.chromium.org/downloads" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p><p id="5e86" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们现在可以创建一个新的 Python 文件。让我们从我们的进口开始。</p><pre class="ku kv kw kx gt ky kt kz la aw lb bi"><span id="6821" class="lc ld it kt b gy le lf l lg lh">from selenium import webdriver</span></pre><p id="bb0e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">因为我们使用 chromedriver 作为应用程序。我们需要告诉 Python 它的位置。我刚刚下载了它，并把它放在我的下载文件夹中。我可以用它的路径设定它的位置。</p><pre class="ku kv kw kx gt ky kt kz la aw lb bi"><span id="96f3" class="lc ld it kt b gy le lf l lg lh">chromedriver_location = "/Users/Downloads/chromedriver"</span></pre><p id="b67c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">一旦我们知道了<em class="kp"> chromedriver </em>的位置，我们现在就可以使用 Selenium 的 webdriver 调用它，告诉它去 Instagram 主页。</p><pre class="ku kv kw kx gt ky kt kz la aw lb bi"><span id="ed0d" class="lc ld it kt b gy le lf l lg lh">driver = webdriver.Chrome(chromedriver_location)<br/>driver.get(‘https://www.instagram.com/')</span></pre><p id="996d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们现在可以试着运行这个脚本，看看会得到什么。如果设置正确，将会弹出一个新的 Google Chrome 实例，并把你带到所请求的站点。</p><p id="bf16" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">让我们回到我们的代码，假设我们已经有了 Instagram 凭证。我们想告诉 Selenium 点击蓝色的链接中的<em class="kp">日志:</em></p><figure class="ku kv kw kx gt lj gh gi paragraph-image"><div class="gh gi li"><img src="../Images/b196d8c0a67156b8b817314cc72284aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1396/format:webp/1*EXKfIYNL7YfkvxE9CAXvAQ.png"/></div></figure><p id="ab30" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">Selenium 通过在 web 页面中查找元素来简化自动化。有多种方法可以找到 web 元素，比如 id、类名、文本等等。在这种情况下，我们将使用 Selenium webdriver 的<code class="fe kq kr ks kt b">find_element_by_xpath</code>。</p><p id="48aa" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">回到谷歌浏览器窗口，右键点击蓝色的<em class="kp">登录</em>链接。你想点击<em class="kp"> inspect，</em>应该会弹出一个窗口，显示所有的 web 元素和一个高亮显示的行。您现在想要点击高亮显示的行并<em class="kp">复制 xpath。</em></p><figure class="ku kv kw kx gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="gh gi lm"><img src="../Images/f428dd70e9b2e5b4e7472c3e4e6d0657.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7fu5fnZvzMAZhc7RheidVQ.png"/></div></div></figure><p id="dfeb" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">一旦完成，你应该有这样的东西，当你粘贴下来。</p><p id="125a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><code class="fe kq kr ks kt b">//*[<a class="ae ko" href="http://twitter.com/id" rel="noopener ugc nofollow" target="_blank">@id</a>=”react-root”]/section/main/article/div[2]/div[2]/p/a</code></p><figure class="ku kv kw kx gt lj gh gi paragraph-image"><div class="gh gi lr"><img src="../Images/14c6c7916ec06b1570c385a0b0fdc363.png" data-original-src="https://miro.medium.com/v2/resize:fit:1300/format:webp/1*rf4zVnz7xsSHK2_xer9IDA.png"/></div></figure><p id="221d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">同样，用户名、密码和登录按钮的输入字段也是同样的过程。</p><p id="8e4a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们可以在当前页面上继续操作。我们可以将这些 xpaths 作为字符串存储在代码中，以使其可读。</p><p id="3d7e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们应该有三个来自这个页面的 xpaths 和一个来自初始登录的 xpaths。</p><pre class="ku kv kw kx gt ky kt kz la aw lb bi"><span id="37d6" class="lc ld it kt b gy le lf l lg lh">first_login = '<!-- -->//*[<a class="ae ko" href="http://twitter.com/id" rel="noopener ugc nofollow" target="_blank">@id</a>=”react-root”]/section/main/article/div[2]/div[2]/p/a<!-- -->'</span><span id="7f30" class="lc ld it kt b gy ls lf l lg lh">username_input = '//*[<a class="ae ko" href="http://twitter.com/id" rel="noopener ugc nofollow" target="_blank">@id</a>="react-root"]/section/main/div/article/div/div[1]/div/form/div[2]/div/label/input'</span><span id="69f8" class="lc ld it kt b gy ls lf l lg lh">password_input = '//*[<a class="ae ko" href="http://twitter.com/id" rel="noopener ugc nofollow" target="_blank">@id</a>="react-root"]/section/main/div/article/div/div[1]/div/form/div[3]/div/label/input'</span><span id="d026" class="lc ld it kt b gy ls lf l lg lh">login_submit = '//*[<a class="ae ko" href="http://twitter.com/id" rel="noopener ugc nofollow" target="_blank">@id</a>="react-root"]/section/main/div/article/div/div[1]/div/form/div[4]/button/div'</span></pre><p id="2315" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">既然我们已经定义了 xpaths，现在我们可以告诉 Selenium webdriver 单击并发送一些输入字段的键！</p><p id="cf0a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">让我们再次从第一次登录开始。我们使用<code class="fe kq kr ks kt b">find_element_by_xpath</code>，并给它一个<code class="fe kq kr ks kt b">first_login</code>变量。然后我们可以告诉它点击。</p><pre class="ku kv kw kx gt ky kt kz la aw lb bi"><span id="27fd" class="lc ld it kt b gy le lf l lg lh">driver.find_element_by_xpath(first_login).click()</span></pre><p id="fb81" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">现在，它会将您带到带有输入字段的凭证页面。类似的过程，但现在我们希望 Selenium 用我们的用户名和密码填充这些字段。Selenium 有另一个叫做<code class="fe kq kr ks kt b">send_keys</code>的方法，它让我们可以很容易地自动化打字。我们只要放一个字符串进去，它就会为我们打字。我们现在可以尝试虚拟变量，看看它是否有效。此外，尝试登录，知道我们会被拒绝。</p><pre class="ku kv kw kx gt ky kt kz la aw lb bi"><span id="ffe5" class="lc ld it kt b gy le lf l lg lh">driver.find_element_by_xpath(username_input).send_keys(“username”)<br/>driver.find_element_by_xpath(password_input).send_keys(“password”)<br/>driver.find_element_by_xpath(login_submit).click()</span></pre><p id="c840" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果一切设置正确，我们的最终代码应该如下所示:</p><pre class="ku kv kw kx gt ky kt kz la aw lb bi"><span id="69a6" class="lc ld it kt b gy le lf l lg lh">from selenium import webdriver</span><span id="4310" class="lc ld it kt b gy ls lf l lg lh">chromedriver = "/Users/Downloads/chromedriver"</span><span id="64a0" class="lc ld it kt b gy ls lf l lg lh">driver = webdriver.Chrome(chromedriver)</span><span id="98fc" class="lc ld it kt b gy ls lf l lg lh">driver.get('https://www.instagram.com/')</span><span id="bd02" class="lc ld it kt b gy ls lf l lg lh">first_login = '//*[@id="react-root"]/section/main/article/div[2]/div[2]/p/a'</span><span id="c2d5" class="lc ld it kt b gy ls lf l lg lh">username_input = '//*[@id="react-root"]/section/main/div/article/div/div[1]/div/form/div[2]/div/label/input'</span><span id="5df9" class="lc ld it kt b gy ls lf l lg lh">password_input = '//*[@id="react-root"]/section/main/div/article/div/div[1]/div/form/div[3]/div/label/input'</span><span id="fdf1" class="lc ld it kt b gy ls lf l lg lh">login_submit = '//*[@id="react-root"]/section/main/div/article/div/div[1]/div/form/div[4]/button/div'</span><span id="5251" class="lc ld it kt b gy ls lf l lg lh">driver.find_element_by_xpath(first_login).click()</span><span id="21d4" class="lc ld it kt b gy ls lf l lg lh">driver.find_element_by_xpath(username_input).send_keys("username")</span><span id="c6d6" class="lc ld it kt b gy ls lf l lg lh">driver.find_element_by_xpath(password_input).send_keys("password")</span><span id="0ca7" class="lc ld it kt b gy ls lf l lg lh">driver.find_element_by_xpath(login_submit).click()</span></pre><p id="ec94" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们现在可以运行这个脚本，并在浏览器中看到自动化。这个特定的脚本将工作，但从 Instagram 得到一个错误，因为我们没有适当的凭据。继续使用您自己的信息更改<code class="fe kq kr ks kt b">send_keys</code>周围的用户名和密码字符串，它应该会让您成功登录。</p><p id="ddf4" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">正如你所看到的，这只是一个简单的例子，不同的人有不同的情况。可能性是无限的。</p></div><div class="ab cl lt lu hx lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="im in io ip iq"><p id="b6d5" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我还提供<strong class="js iu"> <em class="kp">家教和</em> </strong>职业指导<a class="ae ko" href="https://square.site/book/8M6SR06V2RQRB/mentor-melv" rel="noopener ugc nofollow" target="_blank">在这里</a>！</p><p id="91ef" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果你喜欢这些内容，请随时在<a class="ae ko" href="https://www.patreon.com/join/melvfnz" rel="noopener ugc nofollow" target="_blank"> Patreon </a>上支持我！</p><p id="1b67" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果你们有任何问题、意见或担忧，请不要忘记通过 LinkedIn 与我联系！</p></div></div>    
</body>
</html>