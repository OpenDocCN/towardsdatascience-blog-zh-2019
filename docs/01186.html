<html>
<head>
<title>Measuring Performance: AUC (AUROC)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">衡量业绩:AUC (AUROC)</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/measuring-performance-auc-auroc-8c8bbfe9be91?source=collection_archive---------16-----------------------#2019-02-23">https://towardsdatascience.com/measuring-performance-auc-auroc-8c8bbfe9be91?source=collection_archive---------16-----------------------#2019-02-23</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="84b0" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">受试者操作特征(AUROC)下的面积是一个性能指标，可用于评估分类模型。AUROC 会告诉您您的模型是否能够正确排列示例:</p><ul class=""><li id="727c" class="ko kp it js b jt ju jx jy kb kq kf kr kj ks kn kt ku kv kw bi translated">对于临床风险预测模型，AUROC 告诉您随机选择的经历了某一事件的患者比随机选择的未经历该事件的患者具有更高的预测风险评分的概率(<a class="ae kx" href="https://www.statisticshowto.datasciencecentral.com/c-statistic/" rel="noopener ugc nofollow" target="_blank"> ref </a>)。</li><li id="bd9d" class="ko kp it js b jt ky jx kz kb la kf lb kj lc kn kt ku kv kw bi translated">对于二进制手写数字分类模型(“1”对“0”)，AUROC 会告诉您随机选择的“1”图像比随机选择的“0”图像具有更高的“1”预测概率</li></ul><p id="400c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">因此,【AUROC 是一个“区分”的性能指标:它告诉你模型区分案例(正面例子)和非案例(负面例子)的能力。)0.8 的 AUROC 意味着该模型具有良好的区分能力:<a class="ae kx" href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3673738/" rel="noopener ugc nofollow" target="_blank"> 80%的时候，该模型将正确地为随机选择的有事件的患者分配比随机选择的无事件患者更高的绝对风险</a>。</p><p id="62be" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">如何解释 AUROC </strong> ( <a class="ae kx" href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3673738/" rel="noopener ugc nofollow" target="_blank"> ref </a>)</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div class="gh gi ld"><img src="../Images/99706bb347b7873f6831d686e463fc44.png" data-original-src="https://miro.medium.com/v2/resize:fit:1152/0*HxOCEULQFRH9Ru4C"/></div></figure><p id="c0b3" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">图:ROC 曲线(根据<a class="ae kx" href="https://commons.wikimedia.org/wiki/File:Roc-draft-xkcd-style.svg" rel="noopener ugc nofollow" target="_blank">这幅漫画</a>修改)</p><p id="108d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">上图显示了一些 ROC 曲线示例。给定曲线的 AUROC 就是其下方的面积。</p><p id="3cee" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">最差的 AUROC 是 0.5，最好的 AUROC 是 1.0。</p><ul class=""><li id="8890" class="ko kp it js b jt ju jx jy kb kq kf kr kj ks kn kt ku kv kw bi translated">0.5 的 AUROC(上图中红色虚线下的区域)对应于抛硬币，即无用的模型。</li><li id="afea" class="ko kp it js b jt ky jx kz kb la kf lb kj lc kn kt ku kv kw bi translated">小于 0.7 的 AUROC 是次优性能</li><li id="2ee9" class="ko kp it js b jt ky jx kz kb la kf lb kj lc kn kt ku kv kw bi translated">0.70–0.80 的 AUROC 是良好的性能</li><li id="5684" class="ko kp it js b jt ky jx kz kb la kf lb kj lc kn kt ku kv kw bi translated">大于 0.8 的 AUROC 是极好的性能</li><li id="b0fa" class="ko kp it js b jt ky jx kz kb la kf lb kj lc kn kt ku kv kw bi translated">AUROC 为 1.0(上图中紫色线下的区域)相当于一个完美的分类器</li></ul><p id="5e99" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">如何计算 AUROC </strong></p><p id="b48a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">AUROC 计算为 ROC 曲线下的面积。ROC 曲线显示了跨不同决策阈值的真阳性率(TPR)和假阳性率(FPR)之间的权衡。有关 TPR、FPR 和决策阈值的回顾，请参见<a class="ae kx" href="https://glassboxmedicine.com/2019/02/17/measuring-performance-the-confusion-matrix/" rel="noopener ugc nofollow" target="_blank">衡量绩效:混淆矩阵</a>。</p><p id="1995" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在绘制的 ROC 曲线中(例如上一节的图)，决策阈值是隐含的。决策阈值是显示为轴的<em class="ll">而不是</em>。AUROC 本身也没有明确显示；这意味着，显示的 ROC 曲线下的面积。</p><p id="528f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">ROC 曲线的 x 轴是假阳性率，ROC 曲线的 y 轴是真阳性率。</p><ul class=""><li id="65ce" class="ko kp it js b jt ju jx jy kb kq kf kr kj ks kn kt ku kv kw bi translated">ROC 曲线总是从左下角开始，即对应于决策阈值 1 的点(FPR = 0，TPR = 0 )(其中每个例子都被分类为阴性，因为所有预测的概率都小于 1)。)</li><li id="0858" class="ko kp it js b jt ky jx kz kb la kf lb kj lc kn kt ku kv kw bi translated">ROC 曲线总是在右上角结束，即对应于决策阈值 0 的点(FPR = 1，TPR = 1 )(其中每个例子都被分类为阳性，因为所有预测的概率都大于 0)。)</li><li id="9a28" class="ko kp it js b jt ky jx kz kb la kf lb kj lc kn kt ku kv kw bi translated">创建曲线的中间点是通过针对 1 和 0 之间的不同决策阈值计算 TPR 和 FPR 来获得的。对于一个粗糙的、有角度的“曲线”，你可以只使用几个判决阈值:例如判决阈值[1，0.75，0.5，0.25，0]。对于更平滑的曲线，您可以使用许多决策阈值，例如[1，0.98，0.96，0.94，…，0.08，0.06，0.04，0.02，0]的决策阈值。</li></ul><p id="0978" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">下图显示了根据真实数据计算的 ROC 曲线，在 ROC 曲线的锯齿状本质中，使用离散决策阈值更容易理解:</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div class="gh gi lm"><img src="../Images/14d815e2a4b65d56bd263a9960b14c10.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/0*4p0_7Zx3HTOQs8M7"/></div></figure><p id="d589" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">(<a class="ae kx" href="https://en.wikipedia.org/wiki/Receiver_operating_characteristic#/media/File:Roccurves.png" rel="noopener ugc nofollow" target="_blank">图来源</a>)</p><p id="81cf" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">为二元分类任务计算测试集 AUROC 的步骤:</p><ol class=""><li id="cf49" class="ko kp it js b jt ju jx jy kb kq kf kr kj ks kn ln ku kv kw bi translated">训练你的机器学习模型</li><li id="eb90" class="ko kp it js b jt ky jx kz kb la kf lb kj lc kn ln ku kv kw bi translated">使用定型模型对测试集进行预测，这样测试集中的每个示例都有介于 0 和 1 之间的分类概率。</li><li id="bf0a" class="ko kp it js b jt ky jx kz kb la kf lb kj lc kn ln ku kv kw bi translated">使用测试集的模型输出预测概率，计算不同决策阈值的 TPR 和 FPR，并绘制 ROC 曲线。</li><li id="ca3c" class="ko kp it js b jt ky jx kz kb la kf lb kj lc kn ln ku kv kw bi translated">计算 ROC 曲线下的面积。</li></ol><p id="032e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">实际上，您不需要编写代码来手动计算 AUROC。许多编程语言中都有计算 AUROC 的函数。例如，在 Python 中，您可以执行以下操作:</p><blockquote class="lo lp lq"><p id="4260" class="jq jr ll js b jt ju jv jw jx jy jz ka lr kc kd ke ls kg kh ki lt kk kl km kn im bi translated"><em class="it">导入 sklearn.metrics </em></p><p id="c0b7" class="jq jr ll js b jt ju jv jw jx jy jz ka lr kc kd ke ls kg kh ki lt kk kl km kn im bi translated"><em class="it"> fpr，tpr，thresholds = sk learn . metrics . roc _ curve(y _ true = true _ labels，y_score = pred_probs，pos _ label = 1)#正类为 1；负类为 0<br/>auroc = sk learn . metrics . AUC(FPR，tpr) </em></p></blockquote><p id="f086" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">首先，向函数 sklearn.metrics.roc_curve()提供基本事实测试集标签(作为向量 y_true)和模型的预测概率(作为向量 y_score ),以获得输出 fpr、tpr 和阈值。fpr 是具有针对不同阈值计算的假阳性率的向量；tpr 是具有不同阈值的计算的真阳性率的向量；thresholds 是一个带有实际阈值的向量，只是在您想要检查它的情况下提供的(在下一个函数中，您不需要显式的 thresholds 向量。)向量 fpr 和 tpr 定义了 ROC 曲线。然后将 fpr 和 tpr 向量传递给 sklearn.metrics.auc()以获得 AUROC 最终值。</p><p id="fa0c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">何时使用 AUROC </strong></p><p id="f338" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">对于不平衡数据，AUROC 比准确性更能提供信息。这是一个非常常见的性能指标，使用各种软件包很容易计算，因此为执行二元分类任务的模型计算 AUROC 通常是一个好主意。</p><p id="4b35" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">了解 AUROC 的局限性也很重要。AUROC 可能对模型的性能“过于乐观”,这些模型是为反面例子比正面例子多得多的数据集构建的。许多真实世界的数据集都符合这一描述:例如，您可能会认为在从普通人群中抽取的数据集中，健康的人(“疾病阴性”)比患病的人(“疾病阳性”)多得多。)在这些真阴性支配真阳性的情况下，可能很难用 AUROC 来区分两种算法的性能。</p><p id="217c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">为什么？在负样本比正样本多得多的情况下，假阳性数量的大幅提高只会导致假阳性率的小幅变化。这是因为假阳性率被计算为假阳性/(假阳性+真阴性)，如果我们在分母中有大量的真阴性，那么仅仅通过改变假阳性就很难改变假阳性率。</p><p id="8548" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">假装算法 1 比算法 2 的假阳性少得多(即算法 1 更好)。如果数据有很多真阴性，算法 1 和算法 2 的假阳性率不会有太大差别，它们的 AUROCs 也不会有太大差别。</p><p id="bad9" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">要点:AUROC 是一个有用的指标，但是你应该知道 AUROC 并没有捕捉到大量负面例子对算法性能的影响。另一个不会被真阴性“淹没”的性能指标是精确召回曲线下面积(AUPRC ),这将在以后的帖子中讨论。</p><p id="93ff" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">本节的参考(也是额外深入讨论的重要资源):<a class="ae kx" href="http://pages.cs.wisc.edu/~jdavis/davisgoadrichcamera2.pdf" rel="noopener ugc nofollow" target="_blank">精确召回和 ROC 曲线之间的关系</a></p><p id="6df2" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果我的模型预测了两个以上的类怎么办？</p><p id="8fe1" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">你可以分别计算每个类的 AUROC，例如，假设你的任务由许多不同的二进制分类任务组成:A 类与非 A 类，B 类与非 B 类，C 类与非 C 类等等。</p><p id="1620" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">命名法</strong></p><p id="eac8" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">受试者操作特征下面积的最常见缩写是“AUC”这是一个糟糕的术语，因为 AUC 只是代表“曲线下面积”(并没有具体说明<em class="ll">什么</em>曲线；ROC 曲线仅仅是隐含的)。因此，在这篇文章中，我更喜欢缩写 AUROC。你也可以看到 AUROC 被称为 c 统计量或“一致性统计量”</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div class="gh gi lu"><img src="../Images/fe027db1221c95e488675bf597374ca7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1232/0*ay_dpcq6kefxjsBD"/></div></figure><p id="b12a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">上图是一个<a class="ae kx" href="https://en.wikipedia.org/wiki/Aurochs" rel="noopener ugc nofollow" target="_blank"> "auroch" </a>，不要和一个" AUROC ":)混淆。奥罗克牛是一种现已灭绝的牛，曾经生活在北非、欧洲和亚洲。(杜克+DS 的另一名成员带给你的自然琐事，他在一次关于“AUROC”缩写的讨论中让我想起了 auroch。)</p><p id="1d95" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">结束了！请继续关注未来关于 AUROC 的表亲 AUPRC 的帖子。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><p id="8a0f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><em class="ll">原载于 2019 年 2 月 23 日</em><a class="ae kx" href="https://glassboxmedicine.com/2019/02/23/measuring-performance-auc-auroc/" rel="noopener ugc nofollow" target="_blank"><em class="ll">http://glassboxmedicine.com</em></a><em class="ll">。</em></p></div></div>    
</body>
</html>