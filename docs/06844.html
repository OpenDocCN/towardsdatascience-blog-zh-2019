<html>
<head>
<title>Brief Introduction of Hamming and Hanning Function as The Preprocessing of Discrete Fourier Transform</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">作为离散傅里叶变换预处理的汉明和汉宁函数简介</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/brief-introduction-of-hamming-and-hanning-function-as-the-preprocessing-of-discrete-fourier-8b87fe538bb7?source=collection_archive---------9-----------------------#2019-09-29">https://towardsdatascience.com/brief-introduction-of-hamming-and-hanning-function-as-the-preprocessing-of-discrete-fourier-8b87fe538bb7?source=collection_archive---------9-----------------------#2019-09-29</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/bbc74ae4c7a2f10c4900997e2b9c792e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*niukYItSoNk0hIeMotjxyw.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">source: <a class="ae kc" href="https://www.tek.com/sites/default/files/u811871/hamming-t.png" rel="noopener ugc nofollow" target="_blank">https://www.tek.com/sites/default/files/u811871/hamming-t.png</a></figcaption></figure><p id="679e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">大多数人的第一个问题是，<strong class="kf ir">为什么我们在离散傅里叶变换(DFT)或者快速傅里叶变换(FFT)中需要预处理？</strong>在回答问题之前，你必须知道 DFT 和 FFT 的区别。我以前在这里讨论过这个话题，如果你想知道更多细节，你可以看看。重点是<strong class="kf ir"> FFT 是做 DFT </strong>的最快方法。</p><p id="d8ec" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">答案是频谱泄漏</strong>。什么是频谱泄漏？频谱泄漏是指将“未完成的”波传递到 FFT。我说的未完成的波是指，当它像这样传递到 FFT 时，具有非整数周期的波。</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div class="gh gi lb"><img src="../Images/60b407d6ce7361c66bddc4d40ff6f76d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*mnsq_Wogr5VhrwUmtOVrkw.png"/></div></figure><p id="a5b3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">当你把这个信号传递给 FFT，结果是这样的</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div class="gh gi lb"><img src="../Images/4f17d4d754fc68c4fe36529210a8f594.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*UgD7o5mLO9X1S5YRFkBvkA.png"/></div></figure><p id="cc2b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Woah，功率很高，尤其是 4 Hz 频段。这很明显，因为我们将一个纯 4 Hz 正弦波传递给 FFT。但是看起来<strong class="kf ir">FFT‘认为’我们的纯信号是 4 Hz 左右</strong>波的叠加。</p><p id="7616" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果将“完成”信号传递给 DFT，结果将会不同。这个“完整的”4 Hz 正弦波</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div class="gh gi lb"><img src="../Images/26486ed32f655ddecb84e44f7e1997f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*EfXa5ueh20BVIABjicHJDA.png"/></div></figure><p id="8533" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">当把它传递给 FFT 时，结果会是这样的</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div class="gh gi lb"><img src="../Images/69d01746e14057535e3913044dbcfc9f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*GnVjr9r8yknYaiIgoFJASQ.png"/></div></figure><p id="c702" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这就是预期的结果！我们的输入信号是 4 Hz 正弦波，因此 DFT 频谱图中的功率频率仅为 4 Hz。而且显示的功率也没有之前那么大。由于 python 代码对空格和制表符非常敏感，我在这里只给你一个代码的<a class="ae kc" href="https://github.com/genomexyz/windowing_DFT/blob/master/exp_leakage.py" rel="noopener ugc nofollow" target="_blank"> GitHub 链接，而不是在这里显示，因为如果我在这里提供它，所有的空格和制表符都会被弄乱。</a></p><p id="b6d5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这种现象被称为光谱泄漏。这是因为<strong class="kf ir"> DFT 假设我们的输入信号是一个‘完整’周期信号</strong>。<strong class="kf ir"> DFT 假设我们的信号完全按照输入</strong>重复。所以当我们通过‘不完整’版本的 4 Hz 正弦波时，DFT 会看到这样的情况。</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div class="gh gi lb"><img src="../Images/6c35f71d362016a084f708e1302bed35.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*gq12NDtqTX8lqjqrJxQrrA.png"/></div></figure><p id="b582" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我们检查该信号的 FFT 输出，这是结果</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div class="gh gi lb"><img src="../Images/49bd8b28e1f097e0dc0a78fd875fc1db.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*zt4kG7FUZXHjjhyQwePgpQ.png"/></div></figure><p id="3109" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">类似于</strong>之前未完成的 4 Hz 正弦波的 FFT 输出不是？是的，除了这个加长版的<strong class="kf ir">外，功率上升更高</strong>(看 y 轴刻度)。绘制如上图的代码是通过<a class="ae kc" href="https://github.com/genomexyz/windowing_DFT/blob/master/plot_wave_extended.py" rel="noopener ugc nofollow" target="_blank">这个链接</a>完成的。</p><p id="98d3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了清除噪声并获得理想的输出(参见“4 Hz 正弦波的 FFT”图)是<strong class="kf ir">，我们必须知道信号的周期并在正确的时间</strong>对其进行切割(正好在信号周期结束时切割)。但是，<strong class="kf ir">在现实世界中，我们不知道信号的周期，而且现实世界中的信号充满了噪声和干扰</strong>，所以在正确的时间切割它是不可能的。<strong class="kf ir">解决方案是开窗函数</strong>。</p><p id="6ecd" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">傅立叶变换中的窗口函数是<strong class="kf ir">，调整 FFT 信号输入的起点和终点的尝试与此类似</strong>。在这个故事中，我们将涵盖 2 窗口函数，汉宁函数，和汉明函数。</p><p id="e8fe" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">汉宁函数是这样写的</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div class="gh gi lg"><img src="../Images/d6b35cf670992c4008a43e8596be5a64.png" data-original-src="https://miro.medium.com/v2/resize:fit:714/format:webp/1*xoSImFy6cO4ji2EAf3cLdg.png"/></div></figure><p id="6513" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">汉明函数是这样的</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div class="gh gi lh"><img src="../Images/fc158a4898934bc6a7b4fda1ba219479.png" data-original-src="https://miro.medium.com/v2/resize:fit:1042/format:webp/1*HHRlks7C9vkZx8TPWknUjQ.png"/></div></figure><p id="aa79" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">其中 M 是 FFT 的数据集输入中的数据量，n 是从 0 到 M-1 的数。</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div class="gh gi li"><img src="../Images/08f296c7c23cd958e0b390d46fcee533.png" data-original-src="https://miro.medium.com/v2/resize:fit:402/format:webp/1*W_qSfRPUOjdF1pE3U93EuQ.png"/></div></figure><p id="589e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">所以 Hanning 和 Hamming 将输出一个数组，这个数组中的数字与数据集中的数据数量成正比。如果我们绘制汉宁和汉明函数的输出，我们将得到如下两个图</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div class="gh gi lb"><img src="../Images/b7a1929a442370076ad46818e83ca928.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*4PrfP11SepFWppjKU7h8lQ.png"/></div></figure><figure class="lc ld le lf gt jr gh gi paragraph-image"><div class="gh gi lb"><img src="../Images/45f37f7c705e08bf8217ceb3434c10ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*fqj691PjFvz6SagfcRa60w.png"/></div></figure><p id="c2db" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这里是<a class="ae kc" href="https://github.com/genomexyz/windowing_DFT/blob/master/plot_hann_hamm.py" rel="noopener ugc nofollow" target="_blank">代码的链接</a>来创建上面的情节。</p><p id="d7b4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了调整信号，<strong class="kf ir">我们将信号乘以汉恩和哈姆</strong>的输出。作为一个例子，我们乘以我们未完成的 4 赫兹正弦波对汉恩和哈姆，然后我们的波形将是这样的。</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div class="gh gi lb"><img src="../Images/7b006a381dd4bbe6eef01f33a35faebf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*ZWNsIVJVry8kIMN0nLc6Ww.png"/></div></figure><figure class="lc ld le lf gt jr gh gi paragraph-image"><div class="gh gi lb"><img src="../Images/e92ff3ce8c7a72ba603ec8054db732c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*PTpyioHjK0sy0FtlFLuEoQ.png"/></div></figure><p id="4d04" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我们进行 FFT 处理，我们会得到这样的图形。</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div class="gh gi lb"><img src="../Images/e85f0065b7d1f3fc9e68ff8f07fa8b3c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*8GRIjOW0OPI367C8ze1hCg.png"/></div></figure><figure class="lc ld le lf gt jr gh gi paragraph-image"><div class="gh gi lb"><img src="../Images/17b8763c1dfe7271a940ed53fa736e4c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*UoWjBC3qfkPZ1fkuf-vUpg.png"/></div></figure><p id="81c1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">看，FFT 中错误频带的功率降低了(包括正确频带，它正在接近“正确”值)。我们可以看到<strong class="kf ir">错误频段的功率并没有完全消除，只是可以降低</strong>。如果我们在这个实验中观察 FFT 的结果，那么在汉明函数和汉宁函数之间没有真正的区别。这里的<a class="ae kc" href="https://github.com/genomexyz/windowing_DFT/blob/master/multiply_hann_hamm.py" rel="noopener ugc nofollow" target="_blank">是代码的链接</a>，用于创建汉宁/汉明函数处理的信号图及其 FFT 结果。</p><p id="d72d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">重要的一点是，无论<strong class="kf ir">是否经过窗函数处理，FFT 图中最主要的频率始终相同</strong>，为 4 Hz。所以，<strong class="kf ir">如果你只是想知道信号中占主导地位的一个频率是什么，我认为你不需要加窗函数</strong>。当您想要在数据集中找到一个以上的主导信号时，我认为这些窗口函数会有很大的帮助，因为当存在泄漏时，主导信号周围的一些频带的功率会盖过您想要找到的第二个、第三个或 etc 信号。当然，如果你想平滑 FFT 的结果，你需要一个窗口函数。</p><p id="e748" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">参考资料:</p><p id="27b0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><a class="ae kc" href="https://www.crystalinstruments.com/dynamic-signal-analysis-basics" rel="noopener ugc nofollow" target="_blank">https://www . crystal instruments . com/dynamic-signal-analysis-basics</a>，2019 年 9 月 29 日访问</p></div></div>    
</body>
</html>