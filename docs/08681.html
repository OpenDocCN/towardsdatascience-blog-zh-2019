<html>
<head>
<title>Byte Pair Encoding — The Dark Horse of Modern NLP</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">字节对编码——现代自然语言处理的黑马</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/byte-pair-encoding-the-dark-horse-of-modern-nlp-eb36c7df4f10?source=collection_archive---------3-----------------------#2019-11-22">https://towardsdatascience.com/byte-pair-encoding-the-dark-horse-of-modern-nlp-eb36c7df4f10?source=collection_archive---------3-----------------------#2019-11-22</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="abd3" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">1994 年首次推出的一种简单的数据压缩算法为当今几乎所有先进的 NLP 模型(包括 BERT)提供了增压。</h2></div><h1 id="71e9" class="kf kg iq bd kh ki kj kk kl km kn ko kp jw kq jx kr jz ks ka kt kc ku kd kv kw bi translated">背景</h1><p id="6899" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">在 NLP 领域，过去几年是一段激动人心的时光。从稀疏的基于频率的词向量到密集的语义词表示预训练模型的演变，如<a class="ae lt" href="https://en.wikipedia.org/wiki/Word2vec" rel="noopener ugc nofollow" target="_blank"> Word2vec </a>和<a class="ae lt" href="https://nlp.stanford.edu/projects/glove/" rel="noopener ugc nofollow" target="_blank"> GloVe </a>为学习词义奠定了基础。多年来，它们作为可靠的嵌入层初始化，在缺乏大量特定任务数据的情况下训练模型。由于在维基百科上预先训练的单词嵌入模型要么受到词汇量的限制，要么受到单词出现频率的限制，像<code class="fe lu lv lw lx b">athazagoraphobia</code>这样的罕见单词将永远不会被捕获，从而导致在文本中出现未知的<code class="fe lu lv lw lx b">&lt;unk&gt;</code>标记。</p></div><div class="ab cl ly lz hu ma" role="separator"><span class="mb bw bk mc md me"/><span class="mb bw bk mc md me"/><span class="mb bw bk mc md"/></div><div class="ij ik il im in"><h1 id="37aa" class="kf kg iq bd kh ki mf kk kl km mg ko kp jw mh jx kr jz mi ka kt kc mj kd kv kw bi translated">处理生僻字</h1><p id="dd8f" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">抛开字符级嵌入不谈，爱丁堡大学的研究人员通过使用字节对编码(BPE)在神经机器翻译中应用<a class="ae lt" href="https://www.aclweb.org/anthology/P16-1162.pdf" rel="noopener ugc nofollow" target="_blank">子词单元</a>，在解决生僻字问题上取得了第一次真正的突破。今天，受 BPE 启发的子词标记化方案已经成为大多数高级模型的规范，包括非常流行的上下文语言模型家族，如<a class="ae lt" href="https://github.com/google-research/bert" rel="noopener ugc nofollow" target="_blank"> BERT </a>、<a class="ae lt" href="https://openai.com/blog/better-language-models/" rel="noopener ugc nofollow" target="_blank"> GPT-2 </a>、<a class="ae lt" href="https://arxiv.org/abs/1907.11692" rel="noopener ugc nofollow" target="_blank">罗伯塔</a>等。有些人把伯特称为新时代的开端，然而，我认为 BPE 是这场竞赛中的一匹黑马，因为它在现代 NLP 模型的成功中没有得到应有的关注。在本文中，我计划更详细地介绍字节对编码是如何实现的，以及它为什么工作！</p></div><div class="ab cl ly lz hu ma" role="separator"><span class="mb bw bk mc md me"/><span class="mb bw bk mc md me"/><span class="mb bw bk mc md"/></div><div class="ij ik il im in"><h1 id="5140" class="kf kg iq bd kh ki mf kk kl km mg ko kp jw mh jx kr jz mi ka kt kc mj kd kv kw bi translated">字节对编码的起源</h1><p id="11ff" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">像许多其他受传统科学启发的深度学习应用一样，字节对编码(BPE)子词标记化也深深植根于一种简单的无损数据压缩算法中。Philip Gage 在 1994 年 2 月版的 C Users Journal 的文章“<a class="ae lt" href="https://www.drdobbs.com/a-new-algorithm-for-data-compression/184402829" rel="noopener ugc nofollow" target="_blank">A New Algorithm for Data Compression</a>”中首次介绍了 BPE，这是一种数据压缩技术，它通过用一个不在数据中出现的字节替换常见的连续字节对来工作。</p><figure class="mk ml mm mn gt mo gh gi paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="gh gi gj"><img src="../Images/6d242feee5f5d39842472fd8d9ada3c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*x1Y_n3sXGygUPSdfXTm9pQ.gif"/></div></div></figure></div><div class="ab cl ly lz hu ma" role="separator"><span class="mb bw bk mc md me"/><span class="mb bw bk mc md me"/><span class="mb bw bk mc md"/></div><div class="ij ik il im in"><h1 id="bd00" class="kf kg iq bd kh ki mf kk kl km mg ko kp jw mh jx kr jz mi ka kt kc mj kd kv kw bi translated">将 BPE 重新用于子词标记化</h1><p id="a38e" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">为了执行子词标记化，BPE 在其实现中被稍微修改，使得频繁出现的子词对被合并在一起，而不是被另一个字节替换以实现压缩。这将基本上导致罕见的单词<code class="fe lu lv lw lx b">athazagoraphobia</code>被分成更频繁的子单词，例如<code class="fe lu lv lw lx b">['▁ath', 'az', 'agor', 'aphobia'].</code></p><p id="847a" class="pw-post-body-paragraph kx ky iq kz b la mv jr lc ld mw ju lf lg mx li lj lk my lm ln lo mz lq lr ls ij bi translated"><strong class="kz ir">第 0 步。</strong>初始化词汇。</p><p id="2420" class="pw-post-body-paragraph kx ky iq kz b la mv jr lc ld mw ju lf lg mx li lj lk my lm ln lo mz lq lr ls ij bi translated"><strong class="kz ir">第一步。</strong>将语料库中的每个单词表示为字符的组合以及特殊的单词结束标记<code class="fe lu lv lw lx b">&lt;/w&gt;</code>。</p><p id="b728" class="pw-post-body-paragraph kx ky iq kz b la mv jr lc ld mw ju lf lg mx li lj lk my lm ln lo mz lq lr ls ij bi translated"><strong class="kz ir">第二步。</strong>迭代统计词汇表所有记号中的字符对。</p><p id="eb99" class="pw-post-body-paragraph kx ky iq kz b la mv jr lc ld mw ju lf lg mx li lj lk my lm ln lo mz lq lr ls ij bi translated"><strong class="kz ir">第三步。</strong>合并最频繁出现的对，将新字符 n-gram 添加到词汇表中。</p><p id="6372" class="pw-post-body-paragraph kx ky iq kz b la mv jr lc ld mw ju lf lg mx li lj lk my lm ln lo mz lq lr ls ij bi translated"><strong class="kz ir">第四步。</strong>重复步骤 3，直到完成期望数量的合并操作或达到期望的词汇大小(这是一个超参数)。</p><figure class="mk ml mm mn gt mo"><div class="bz fp l di"><div class="na nb l"/></div></figure></div><div class="ab cl ly lz hu ma" role="separator"><span class="mb bw bk mc md me"/><span class="mb bw bk mc md me"/><span class="mb bw bk mc md"/></div><div class="ij ik il im in"><h1 id="492e" class="kf kg iq bd kh ki mf kk kl km mg ko kp jw mh jx kr jz mi ka kt kc mj kd kv kw bi translated">是什么让 BPE 成为秘制酱？</h1><p id="4ad2" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">BPE 带来了字符和单词级混合表示之间的完美平衡，这使得它能够管理大型语料库。这种行为还支持使用适当的子词标记对词汇表中的任何罕见单词进行编码，而不会引入任何“未知”标记。这尤其适用于像德语这样的外语，在德语中，许多复合词的存在会使学习丰富的词汇变得困难。有了这种记号化算法，现在每个单词都可以克服他们对被遗忘的恐惧(athazagoraphobia)。</p></div><div class="ab cl ly lz hu ma" role="separator"><span class="mb bw bk mc md me"/><span class="mb bw bk mc md me"/><span class="mb bw bk mc md"/></div><div class="ij ik il im in"><h1 id="693a" class="kf kg iq bd kh ki mf kk kl km mg ko kp jw mh jx kr jz mi ka kt kc mj kd kv kw bi translated">参考</h1><ol class=""><li id="dea9" class="nc nd iq kz b la lb ld le lg ne lk nf lo ng ls nh ni nj nk bi translated">菲利普·盖奇，<em class="nl">一种新的数据压缩算法</em>。<a class="ae lt" href="http://www.drdobbs.com/article/print?articleId=184402829&amp;dept_url=/" rel="noopener ugc nofollow" target="_blank">《多布斯博士杂志》</a></li><li id="4ba2" class="nc nd iq kz b la nm ld nn lg no lk np lo nq ls nh ni nj nk bi translated">森里奇(r .)、哈多(b .)、伯奇(a .)(2015 年)。具有子词单元的生僻字的神经机器翻译。<em class="nl"> arXiv 预印本 arXiv:1508.07909 </em>。</li><li id="4f22" class="nc nd iq kz b la nm ld nn lg no lk np lo nq ls nh ni nj nk bi translated">Devlin，j .，Chang，M. W .，Lee，k .，&amp; Toutanova，K. (2018 年)。Bert:用于语言理解的深度双向转换器的预训练。<em class="nl"> arXiv 预印本 arXiv:1810.04805 </em>。</li><li id="a26b" class="nc nd iq kz b la nm ld nn lg no lk np lo nq ls nh ni nj nk bi translated">刘，y .，奥特，m .，戈亚尔，n .，杜，j .，乔希，m .，陈，d，…和斯托扬诺夫，V. (2019)。Roberta:稳健优化的 bert 预训练方法。<em class="nl"> arXiv 预印本 arXiv:1907.11692 </em>。</li></ol></div></div>    
</body>
</html>