<html>
<head>
<title>Parallelising your Python Code</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">并行化您的 Python 代码</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/parallelising-your-python-code-85b59c558f97?source=collection_archive---------7-----------------------#2019-06-06">https://towardsdatascience.com/parallelising-your-python-code-85b59c558f97?source=collection_archive---------7-----------------------#2019-06-06</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/2e600adb18b495aaf533b90ecce071d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*keMje-0JVLyyHChIM4gZOw.jpeg"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk">Illustration designed by Macrovector / <a class="ae kf" href="http://www.freepik.com" rel="noopener ugc nofollow" target="_blank">Freepik</a></figcaption></figure><p id="4df5" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">卷入一个游戏存在中，你和你的朋友是 T2 矿工。是的，手里拿着黄帽子和铲子。任务-在一定时间内挖一个洞，以便能够提取一些闪闪发光的钻石！所以你的朋友建议你和他们<strong class="ki iu"> <em class="le">轮流</em> </strong>挖…</p><p id="62df" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们说，你需要 100 分钟来完成这个任务时，做了转智。</p><figure class="lg lh li lj gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi lf"><img src="../Images/359007716ccc032fbea5497c03be1b3b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lwrtHrIRazNLHvsq0Qm0cA.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk">Illustration designed by Macrovector / <a class="ae kf" href="http://www.freepik.com" rel="noopener ugc nofollow" target="_blank">Freepik</a></figcaption></figure><p id="9c19" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">但是，如果你们两个可以一起努力，同时完成工作-</p><figure class="lg lh li lj gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi lk"><img src="../Images/fa0bdebb8aa0523cc0b1828ab370f938.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hefA8Pv7JyjddXoij0X3Gw.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk">Illustration designed by Macrovector / <a class="ae kf" href="http://www.freepik.com" rel="noopener ugc nofollow" target="_blank">Freepik</a></figcaption></figure><p id="a9d4" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这会导致-</p><ul class=""><li id="e189" class="ll lm it ki b kj kk kn ko kr ln kv lo kz lp ld lq lr ls lt bi translated">更少的时间</li><li id="2ec5" class="ll lm it ki b kj lu kn lv kr lw kv lx kz ly ld lq lr ls lt bi translated">效率更高</li><li id="c1d5" class="ll lm it ki b kj lu kn lv kr lw kv lx kz ly ld lq lr ls lt bi translated">不浪费可用资源</li><li id="3038" class="ll lm it ki b kj lu kn lv kr lw kv lx kz ly ld lq lr ls lt bi translated">少流汗！</li></ul><p id="cd86" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">同样的情况也发生在你的计算机上，连续给两个进程分配 CPU 时间基本上会让等待的进程<em class="le">饿死</em>直到给定一个 CPU 周期，这是对可能使用的资源的浪费。</p><blockquote class="lz"><p id="16a8" class="ma mb it bd mc md me mf mg mh mi ld dk translated"><strong class="ak">这篇文章是关于如何克服这个问题的。</strong></p></blockquote><p id="7ac1" class="pw-post-body-paragraph kg kh it ki b kj mj kl km kn mk kp kq kr ml kt ku kv mm kx ky kz mn lb lc ld im bi translated">让我们<em class="le">钻研</em>并行编程吧！</p><p id="7111" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">并行计算/编程本质上是组合使用≥ 2 个处理器/内核/计算机来解决单个问题。它是一种计算体系结构，其中几个处理器通过在处理器之间分配工作负载来同时进行计算。</p><h2 id="15aa" class="mo mp it bd mq mr ms dn mt mu mv dp mw kr mx my mz kv na nb nc kz nd ne nf ng bi translated">如何让您的代码为您并行工作！</h2><p id="4098" class="pw-post-body-paragraph kg kh it ki b kj nh kl km kn ni kp kq kr nj kt ku kv nk kx ky kz nl lb lc ld im bi translated">在 python 中，我们有一个由 GIL 领导的怪物——字面上叫做“GIL ”,它代表着“全局”。</p><ul class=""><li id="c9de" class="ll lm it ki b kj kk kn ko kr ln kv lo kz lp ld lq lr ls lt bi translated">它是一个互斥体{ <a class="ae kf" href="https://searchnetworking.techtarget.com/definition/mutex" rel="noopener ugc nofollow" target="_blank">互斥</a> }，保护同一个线程同时访问 Python 对象。</li><li id="bcb5" class="ll lm it ki b kj lu kn lv kr lw kv lx kz ly ld lq lr ls lt bi translated">它还防止多个线程同时执行 Python 字节码。</li></ul><blockquote class="lz"><p id="c577" class="ma mb it bd mc md nm nn no np nq ld dk translated">‘多重处理’→我们的 GIL 救星！</p></blockquote><p id="be02" class="pw-post-body-paragraph kg kh it ki b kj mj kl km kn mk kp kq kr ml kt ku kv mm kx ky kz mn lb lc ld im bi translated">python 中的多处理<a class="ae kf" href="https://www.learnpython.org/en/Modules_and_Packages" rel="noopener ugc nofollow" target="_blank"> <em class="le">包</em> </a>类似于线程<em class="le">模块；“Pool”类是一个很好的例子，它提供了非常方便的方法来并行执行不同输入值的函数。</em></p><p id="9331" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">Pool 类将允许我们创建一个进程/工作者池，它可以同时处理分配给它们的任务。例如，采用一个函数，假设我们将该函数的调用分布在所有/部分可用的内核/处理器上，每个处理器将负责我们处理的问题子集的一部分，我们可以有另一个函数来串行运行所有这些事情，并最终比较多处理如何有助于处理大量 IO 密集型计算。</p><p id="58d6" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">&gt;要检查 CPU 内核的数量，您可以使用以下命令:</p><figure class="lg lh li lj gt ju"><div class="bz fp l di"><div class="nr ns l"/></div></figure></div><div class="ab cl nt nu hx nv" role="separator"><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny"/></div><div class="im in io ip iq"><p id="6940" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu">现在让我们得到<em class="le"> cod-in </em> </strong></p><figure class="lg lh li lj gt ju"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="25ff" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">简单地使用 for 循环遍历用户给定的所有值。</p><figure class="lg lh li lj gt ju"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="fad7" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在下面的要点中，我们看到简单地将相同的函数传递给。“地图”方法使这一切变得轻而易举！</p><p id="42c1" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu">注意</strong> -在‘Pool()’中，一个可选的参数让我们定义我们希望程序使用的处理器数量，缺省值是最大值。</p><p id="8c6d" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu">还有另一个注意事项</strong>——使用<a class="ae kf" href="https://gist.github.com/aananya27/4e871859c7cc90d9cd546c8859c2b245" rel="noopener ugc nofollow" target="_blank"> <em class="le">这个</em> </a>小代码查看可用的 CPU 数量</p><p id="684c" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">还有其他牛逼的映射方法，查看一下 python 中多处理包的官方文档<a class="ae kf" href="https://docs.python.org/3.4/library/multiprocessing.html?highlight=process" rel="noopener ugc nofollow" target="_blank"><em class="le"/></a>。</p><p id="454b" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu">又一个无耻的注释</strong>——你一定注意到了，在尝试上面的代码时，非并行执行对于少量的输入给出了更好的结果，而对于大量的输入，<strong class="ki iu"> <em class="le">并行才是正确的选择</em> </strong>！</p><p id="55b2" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">一定要测试一下这个，然后<a class="ae kf" href="https://twitter.com/aananya_27" rel="noopener ugc nofollow" target="_blank"> <em class="le">评论</em></a>——并行性在多少个值上比并发性表现得更好！</p><p id="38dd" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">希望这是一个有趣的阅读足以让你<em class="le">挖掘</em>到<em class="le">金矿</em>的<strong class="ki iu"> <em class="le">多重处理</em> </strong>！！</p><figure class="lg lh li lj gt ju gh gi paragraph-image"><div class="gh gi oa"><img src="../Images/bb880681a95c0b2b4dab712273fa6910.png" data-original-src="https://miro.medium.com/v2/resize:fit:1136/format:webp/1*t-Pd5VE7Kqw9E87Nf7FbsQ.png"/></div></figure><p id="8c70" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu">就是这样！你很适合并行编程。如果您有任何问题，请随时向我发</strong> <a class="ae kf" href="https://twitter.com/aananya_27" rel="noopener ugc nofollow" target="_blank"> <strong class="ki iu">推文。</strong> </a></p><p id="939a" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><a class="ae kf" href="https://medium.com/@aananya_27" rel="noopener"> <strong class="ki iu">关注我</strong> </a> <strong class="ki iu">随时更新我的帖子。祝您愉快！🎉</strong></p></div></div>    
</body>
</html>