<html>
<head>
<title>RLCard: Building Your Own Poker AI in 3 Steps</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">RLCard:用 3 个步骤构建你自己的扑克人工智能</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/rlcard-building-your-own-poker-ai-in-3-steps-398aa864a0db?source=collection_archive---------10-----------------------#2019-11-12">https://towardsdatascience.com/rlcard-building-your-own-poker-ai-in-3-steps-398aa864a0db?source=collection_archive---------10-----------------------#2019-11-12</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="6bb3" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">介绍纸牌游戏中强化学习的工具包</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/4c71027638cd8c633688f8ce7c2899a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_9abDpNTM9Cbsd2HEXYm9Q.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk"><a class="ae kv" href="https://github.com/datamllab/rlcard" rel="noopener ugc nofollow" target="_blank">https://github.com/datamllab/rlcard</a></figcaption></figure><p id="d9fc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">由于强化学习的进步，人工智能(AI)在游戏中取得了令人鼓舞的进展。举几个例子，AlphaGo 在围棋比赛中击败了人类职业选手。<a class="ae kv" href="https://www.nature.com/articles/nature24270?sf123103138=1" rel="noopener ugc nofollow" target="_blank">alpha zero</a>【2】在国际象棋、shogi、围棋等游戏中从零开始自学，成为艺术大师。近年来，研究人员的努力在扑克游戏中取得了成果，如<a class="ae kv" href="https://science.sciencemag.org/content/359/6374/418" rel="noopener ugc nofollow" target="_blank">Libra tus</a>【3】和<a class="ae kv" href="https://science.sciencemag.org/content/356/6337/508" rel="noopener ugc nofollow" target="_blank">deep stack</a>【4】，在德州扑克中取得了专家级的表现。扑克是人工智能中最具挑战性的游戏之一。作为一名玩家，我们不仅需要考虑自己的手牌，还需要考虑其他玩家隐藏在我们视线之外的手牌。这导致了可能性的爆炸。</p><p id="2df1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在本文中，我将介绍一个用于纸牌游戏中强化学习的开源项目，该项目最近由德克萨斯州 A &amp; M 大学的<a class="ae kv" href="http://faculty.cs.tamu.edu/xiahu/" rel="noopener ugc nofollow" target="_blank">数据实验室</a>开发。本文将首先概述该项目，然后提供一个如何从头开始训练代理人玩 Leduc Hold'em poker(德州扑克的简化版本)的运行示例。该项目的目标是让每个人都能接触到扑克游戏中的人工智能。</p><h1 id="7600" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">概观</h1><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mk"><img src="../Images/55ad3d925a94dcefc94052493d5ae3f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-2I91Sb789qbhA7GOpqDKA.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">[5] <a class="ae kv" href="https://arxiv.org/pdf/1910.04376.pdf" rel="noopener ugc nofollow" target="_blank">An overview of RLCard. Each game is wrapped by an Env (Environment) class with easy-to-use interfaces.</a></figcaption></figure><p id="41f7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">RLCard 提供了各种纸牌环境，包括 21 点、Leduc Hold'em、德克萨斯扑克、UNO、斗(中国扑克游戏)和麻将，以及几个标准的强化学习算法，如<a class="ae kv" href="https://www.nature.com/articles/nature14236?wm=book_wap_0005" rel="noopener ugc nofollow" target="_blank">深度 Q 学习</a>【6】、<a class="ae kv" href="https://arxiv.org/abs/1603.01121" rel="noopener ugc nofollow" target="_blank">神经虚构自玩</a>(NFSP)【7】和<a class="ae kv" href="http://papers.nips.cc/paper/3306-regret-minimization-in-games-with-incomplete-information.pdf" rel="noopener ugc nofollow" target="_blank">反事实后悔最小化</a>【8】。它支持简单的安装和丰富的文档示例。它还支持多个过程的并行训练。采用了以下设计原则:</p><blockquote class="ml mm mn"><p id="6a89" class="kw kx mo ky b kz la jr lb lc ld ju le mp lg lh li mq lk ll lm mr lo lp lq lr ij bi translated"><strong class="ky ir"> <em class="iq">可再现:</em> </strong> <em class="iq">来自环境的结果可以被再现和比较。用相同的随机种子在不同的运行中应该获得相同的结果。<br/> </em> <strong class="ky ir"> <em class="iq">易上手:</em> </strong> <em class="iq">每次游戏结束后都收集整理好经验，界面直白。状态表示、动作编码、奖励设计，甚至游戏规则，都可以方便地配置。<br/> </em> <strong class="ky ir"> <em class="iq">可扩展:</em> </strong> <em class="iq">按照上述设计原则，可以方便地将新的卡片环境添加到工具包中。工具包中的依赖性被最小化，这样代码可以很容易地维护。</em></p></blockquote><h1 id="0b15" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">Leduc 德州扑克</h1><p id="521e" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">Leduc 德州扑克是德州扑克的简化版。该游戏使用 6 张牌(黑桃杰克、王后和国王，以及红桃杰克、王后和国王)。每个玩家会有一张手牌，还有一张社区牌。与德州扑克类似，高等级牌胜过低等级牌，例如黑桃皇后比黑桃杰克大。一对胜过一张牌，例如，一对 j 比皇后和国王大。游戏的目标是从其他玩家那里赢得尽可能多的筹码。Leduc Hold'em 的更多细节可以在<a class="ae kv" href="https://arxiv.org/abs/1207.1411" rel="noopener ugc nofollow" target="_blank"> Bayes 的虚张声势:扑克中的对手建模</a> [9]中找到。</p><h1 id="98e7" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">第一个例子:NFSP 在 Leduc 德州扑克上</h1><p id="f278" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">现在，让我们用 RLCard 对一名 NFSP 特工进行 Leduc 德州扑克培训！完整的示例代码如下所示:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mx my l"/></div></figure><p id="37fc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在本例中，为 Leduc Hold'em 构建 AI 需要 3 个步骤。</p><p id="1350" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">第一步:</strong> <em class="mo">制造环境。</em>首先，告诉“rlcard”我们需要一个 Leduc 德州扑克环境。</p><pre class="kg kh ki kj gt mz na nb nc aw nd bi"><span id="c215" class="ne lt iq na b gy nf ng l nh ni">env = rlcard.make('leduc-holdem')</span></pre><p id="b0bf" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">第二步</strong> : <em class="mo">初始化 NFSP 代理。其次，我们创建两个内置的 NFSP 代理，并告诉代理一些基本信息，例如，动作的数量、状态形状、神经网络结构等。注意，NFSP 还有一些其他的超参数，比如内存大小。这里我们使用默认值。</em></p><pre class="kg kh ki kj gt mz na nb nc aw nd bi"><span id="3e9d" class="ne lt iq na b gy nf ng l nh ni">with tf.Session() as sess:<br/>    agents = []<br/>    for i in range(env.player_num):<br/>        agent = NFSPAgent(sess,<br/>                          scope='nfsp' + str(i),<br/>                          action_num=env.action_num,<br/>                          state_shape=env.state_shape,<br/>                          hidden_layers_sizes=[128,128],<br/>                          q_mlp_layers=[128,128])<br/>        agents.append(agent)</span><span id="9931" class="ne lt iq na b gy nj ng l nh ni">    # Setup agents<br/>    env.set_agents(agents)</span></pre><p id="8985" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">第三步</strong> : <em class="mo">生成游戏数据，训练代理。</em>第三，可以用“run”功能生成游戏数据。然后，我们将这些转换传送到 NFSP 并培训代理。</p><pre class="kg kh ki kj gt mz na nb nc aw nd bi"><span id="36ab" class="ne lt iq na b gy nf ng l nh ni">episode_num = 10000000</span><span id="0227" class="ne lt iq na b gy nj ng l nh ni">for episode in range(episode_num):</span><span id="3455" class="ne lt iq na b gy nj ng l nh ni">    # Generate game data<br/>    trajectories, _ = env.run(is_training=True)</span><span id="fb4b" class="ne lt iq na b gy nj ng l nh ni">    # Train the agents<br/>    for i in range(env.player_num):<br/>        for ts in trajectories[i]:<br/>            agents[i].feed(ts)<br/>            rl_loss = agents[i].train_rl()<br/>            sl_loss = agents[i].train_sl()</span></pre><p id="1d14" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然后，NFSP 代理将通过自我游戏学习玩 Leduc Hold'em。性能可以通过 NFSP 代理和随机代理的比赛来衡量。你也可以在这里找到代码和学习曲线<a class="ae kv" href="https://github.com/datamllab/rlcard/blob/master/examples/leduc_holdem_nfsp.py" rel="noopener ugc nofollow" target="_blank">。示例学习曲线如下所示:</a></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/1199f7de58d2f112d6faf7e980aab46d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1126/format:webp/0*kkPPj_aJ5qiR2yGS.jpeg"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk"><a class="ae kv" href="https://github.com/datamllab/rlcard" rel="noopener ugc nofollow" target="_blank">Learning curves in terms of performance against random strategy. The reward is the winning big blinds.</a></figcaption></figure><p id="b83e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">NFSP 代理在对抗随机代理的性能方面逐渐提高自己。如果您想探索更多的例子，请查看<a class="ae kv" href="https://github.com/datamllab/rlcard/tree/master/examples" rel="noopener ugc nofollow" target="_blank">资源库</a>。玩得开心！</p><h1 id="b811" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">玩预先训练好的模型</h1><p id="5377" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">RLCard 还与 NFSP 一起提供了一个预先训练好的 Leduc Hold'em 模型。我们可以通过运行<a class="ae kv" href="https://github.com/datamllab/rlcard/blob/master/examples/leduc_holdem_human.py" rel="noopener ugc nofollow" target="_blank">这个脚本</a>来对抗预先训练好的代理。</p><pre class="kg kh ki kj gt mz na nb nc aw nd bi"><span id="3da3" class="ne lt iq na b gy nf ng l nh ni">&gt;&gt; Leduc Hold'em pre-trained model</span><span id="661c" class="ne lt iq na b gy nj ng l nh ni">&gt;&gt; Start a new game!<br/>&gt;&gt; Agent 1 chooses raise</span><span id="1096" class="ne lt iq na b gy nj ng l nh ni">=============== Community Card ===============<br/>┌─────────┐<br/>│░░░░░░░░░│<br/>│░░░░░░░░░│<br/>│░░░░░░░░░│<br/>│░░░░░░░░░│<br/>│░░░░░░░░░│<br/>│░░░░░░░░░│<br/>│░░░░░░░░░│<br/>└─────────┘<br/>===============   Your Hand    ===============<br/>┌─────────┐<br/>│J        │<br/>│         │<br/>│         │<br/>│    ♥    │<br/>│         │<br/>│         │<br/>│        J│<br/>└─────────┘<br/>===============     Chips      ===============<br/>Yours:   +<br/>Agent 1: +++<br/>=========== Actions You Can Choose ===========<br/>0: call, 1: raise, 2: fold</span><span id="3420" class="ne lt iq na b gy nj ng l nh ni">&gt;&gt; You choose action (integer):</span></pre><h1 id="d3c7" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">摘要</h1><p id="f50f" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">要了解这个项目的更多信息，请点击这里查看<a class="ae kv" href="https://github.com/datamllab/rlcard" rel="noopener ugc nofollow" target="_blank">。该团队正在积极开发项目的更多功能，包括可视化工具和锦标赛排行榜。这个项目的最终目标是让社区中的每个人都有机会在卡牌游戏中接受训练、比较和分享他们的人工智能。我希望你喜欢阅读。在我的下一篇帖子中，我将介绍 21 点深度 Q 学习的机制，我们将看看该算法是如何实现的及其在纸牌游戏中的应用。</a></p><p id="22d0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">参考资料:<br/>【1】白银<em class="mo">等</em>。用深度神经网络和树搜索掌握围棋游戏(2016)。<br/>【2】白银<em class="mo">等</em>。掌握没有人类知识的围棋游戏(2017)。<br/>【3】布朗和桑德霍尔姆。用于单挑无限注扑克的超人 AI:Libra tus 击败顶级专业人士(2018)。<br/>【4】Moravík<em class="mo">等</em> DeepStack:单挑无限注扑克中的专家级人工智能(2017)。<br/>【5】查<em class="mo">等</em>。RLCard:卡牌游戏强化学习工具包(2019)。<br/>【6】Minh<em class="mo">等</em>通过深度强化学习实现人级控制(2015)。<br/>【7】海因里希和西尔弗。不完全信息博弈中自我博弈的深度强化学习(2016)。<br/>【8】Zinkevich<em class="mo">等</em>不完全信息博弈中的后悔最小化(2008)。<br/>【9】sou they<em class="mo">等</em> Bayes 的虚张声势:扑克中的对手建模(2012)。</p></div></div>    
</body>
</html>