<html>
<head>
<title>How to contain your first Django in docker and access it from AWS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在 docker 中包含你的第一个 Django 并从 AWS 中访问它</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-contain-your-first-django-in-docker-and-access-it-from-aws-fdb0081bdf1d?source=collection_archive---------10-----------------------#2019-07-08">https://towardsdatascience.com/how-to-contain-your-first-django-in-docker-and-access-it-from-aws-fdb0081bdf1d?source=collection_archive---------10-----------------------#2019-07-08</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="6c88" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">今天，许多初级软件工程工作需要一系列技术，包括 Django、python、docker 和 AWS。如果你是一个初学者，并且想了解这些技术，那么你来对地方了。通过这篇文章，我将指导您操作这些工具并创建您的第一个 Python Django 应用程序，该应用程序包含在 docker 中并可从 AWS 访问。</p><p id="c079" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">您只需要:</p><p id="8ac4" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">Docker Hub 免费账户:<a class="ae ko" href="https://hub.docker.com/" rel="noopener ugc nofollow" target="_blank">https://hub.docker.com/</a></p><p id="690a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">AWS 免费账户<a class="ae ko" href="https://aws.amazon.com/account/" rel="noopener ugc nofollow" target="_blank">https://aws.amazon.com/account/</a></p><p id="c94f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">MAC 或 Windows 笔记本电脑。</p><p id="9e89" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">Pycharm 框架<a class="ae ko" href="https://www.jetbrains.com/pycharm/download/" rel="noopener ugc nofollow" target="_blank">https://www.jetbrains.com/pycharm/download/</a></p><p id="6039" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">一个大脑:)</p><p id="1df9" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">从你的宝贵时间最多一个小时。</p><p id="7d31" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">你准备好了吗？</p><p id="aa65" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">所以让我们开始吧…第一步是打开你的<strong class="js iu"> pycharm </strong>并创建一个新项目。</p><p id="d9c2" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">接下来，您必须在<strong class="js iu"> pycharm </strong>中安装 Django 库:</p><pre class="kp kq kr ks gt kt ku kv kw aw kx bi"><span id="bbf7" class="ky kz it ku b gy la lb l lc ld">pip install django</span></pre><p id="e95d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">然后，只需通过下面的命令启动您的项目(我们将项目命名为<strong class="js iu"> DjangoDocker </strong>，但是您可以命名为其他名称)。</p><pre class="kp kq kr ks gt kt ku kv kw aw kx bi"><span id="d2f2" class="ky kz it ku b gy la lb l lc ld">django-admin startproject DjangoDocker</span></pre><figure class="kp kq kr ks gt lf gh gi paragraph-image"><div role="button" tabindex="0" class="lg lh di li bf lj"><div class="gh gi le"><img src="../Images/870f8869a7e5d22a996515ac45b026a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0uIFP1hLFmhcsBvk-cpTNQ.png"/></div></div></figure><p id="f72d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这将创建项目目录和里面的几个文件，我们稍后将详细检查它们。</p><figure class="kp kq kr ks gt lf gh gi paragraph-image"><div class="gh gi lm"><img src="../Images/7c0d7d55516f862e4680f57c2320d98d.png" data-original-src="https://miro.medium.com/v2/resize:fit:454/format:webp/1*_9lDrm2eu68hk4qnlshSBg.png"/></div></figure><p id="a14d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">之后，您需要使用下面的命令在 Django 项目中创建第一个应用程序:</p><pre class="kp kq kr ks gt kt ku kv kw aw kx bi"><span id="574d" class="ky kz it ku b gy la lb l lc ld">python manage.py startapp myApp</span></pre><figure class="kp kq kr ks gt lf gh gi paragraph-image"><div role="button" tabindex="0" class="lg lh di li bf lj"><div class="gh gi ln"><img src="../Images/0961b2ba549cfd5df32554806cbdb481.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2dynY2z7BVSTSrObj8mqmg.png"/></div></div></figure><p id="8cba" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这将在您的主项目目录中创建一个新目录，它将包含以下文件:</p><figure class="kp kq kr ks gt lf gh gi paragraph-image"><div class="gh gi lo"><img src="../Images/df968f6843e28458933f5d2f349362db.png" data-original-src="https://miro.medium.com/v2/resize:fit:354/format:webp/1*DYrSHa8Kl0B1pjR8Hhet_Q.png"/></div></figure><p id="7389" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">您可能会注意到，我们可以在同一个 Django 项目中创建多个应用程序，这在我们想要创建一个后端 API 并在多个项目中使用它的情况下非常有用。</p><p id="0dbb" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">现在让我们试着在我们的第一个应用程序中填充代码，看看我们如何从云中 dockerize 和访问它！！</p><p id="620d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在接下来的步骤中，我们将填充获得“Salam World”Django 应用程序所需的最低编码。</p><p id="f440" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">首先，打开<strong class="js iu"> myApp </strong>目录下的文件“views.py ”,并填入以下代码:</p><pre class="kp kq kr ks gt kt ku kv kw aw kx bi"><span id="04c8" class="ky kz it ku b gy la lb l lc ld">from django.shortcuts import render<br/><br/># Create your views here.<br/>from django.http import HttpResponse<br/>def index(request):<br/>    return HttpResponse(<strong class="ku iu">" Django on Docker on AWS "</strong>)</span></pre><p id="d655" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">然后，您应该向 Django 表明该文件将成为您的索引，为此，只需将以下代码放入 myApp =&gt; <strong class="js iu"> urls.py </strong></p><p id="2716" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">并且只需在<strong class="js iu"> urls.py </strong>(根文件夹)填充根 URL 路径即可。</p><pre class="kp kq kr ks gt kt ku kv kw aw kx bi"><span id="d103" class="ky kz it ku b gy la lb l lc ld">from django.contrib import admin<br/>from django.urls import include, path<br/>path(‘&lt;appname&gt;/’, include(‘&lt;appname&gt;.urls’)),</span></pre><p id="2418" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">之后，您可以启动数据库并检查您的应用程序是否正常工作:</p><pre class="kp kq kr ks gt kt ku kv kw aw kx bi"><span id="1d44" class="ky kz it ku b gy la lb l lc ld">## initiate the database<br/>python manage.py migrate</span><span id="501b" class="ky kz it ku b gy lp lb l lc ld">## check it works<br/>python manage.py runserver</span></pre><p id="7c5d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">只要启动下面的网址，你应该会看到类似的结果:</p><figure class="kp kq kr ks gt lf gh gi paragraph-image"><div class="gh gi lq"><img src="../Images/90298132e89a1c3a02b86fb74d65ae20.png" data-original-src="https://miro.medium.com/v2/resize:fit:714/format:webp/1*4UPbHb3ducyc-lMwEQNkqg.png"/></div></figure><p id="2b29" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">将代码推送到 docker image 之前的一个中间步骤是将它放在 GITHUB 中，以跟踪对每次迭代所做的各种更改。这也将允许您实施您的 DevOps CI/CD 管道，以便直接将更改和“<strong class="js iu">自动</strong>”推送到 AWS，而无需重复所有这些步骤。</p><pre class="kp kq kr ks gt kt ku kv kw aw kx bi"><span id="3986" class="ky kz it ku b gy la lb l lc ld">## initiate GIT<br/># Go to directory and tape:<br/>git init<br/>## Create and fill .gitignore to untrack files<br/>git status #( to check )<br/>git add — all .<br/>git commit -m “My first commit”</span><span id="6e23" class="ky kz it ku b gy lp lb l lc ld">## push to GitHIB<br/>## Connect to Github (login/password)<br/>## create a new repo<br/>git remote add origin <a class="ae ko" href="https://github.com/" rel="noopener ugc nofollow" target="_blank">https://github.com/</a>&lt;login&gt;/&lt;repo&gt;.git<br/>git push -u origin master</span></pre><p id="0fd1" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">现在，我们将看到如何将代码包含在 docker 映像中，并将其推送到 docker hub。</p><p id="381a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">要创建 docker 映像，只需在<strong class="js iu"> Django </strong>根目录中创建以下 3 个文件:</p><p id="f76a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">docker file<br/>docker-compose . yml<br/>requirements . txt</strong></p><pre class="kp kq kr ks gt kt ku kv kw aw kx bi"><span id="d81a" class="ky kz it ku b gy la lb l lc ld">— — — — — Dockerfile<br/># We Use an official Python runtime as a parent image<br/>FROM python:3.6<br/># The enviroment variable ensures that the python output is set straight<br/># to the terminal with out buffering it first<br/>ENV PYTHONUNBUFFERED 1<br/># create root directory for our project in the container<br/>RUN mkdir /&lt;dir-in-container&gt;<br/># Set the working directory to /music_service<br/>WORKDIR /&lt;dir-in-container&gt;<br/># Copy the current directory contents into the container at /music_service<br/>ADD . /&lt;dir-in-container&gt;/<br/># Install any needed packages specified in requirements.txt<br/>RUN pip install -r requirements.txt<br/>EXPOSE 8000<br/>CMD exec gunicorn &lt;Django-project_name&gt;.wsgi:application — bind 0.0.0.0:8000 — workers 3</span><span id="3a0b" class="ky kz it ku b gy lp lb l lc ld">— — — — docker-compose.yml<br/>version: ‘3’<br/>services:<br/> web:<br/> build: .<br/> command: bash -c “python manage.py makemigrations &amp;&amp; python manage.py migrate &amp;&amp; python manage.py runserver 0.0.0.0:8000”<br/> container_name: &lt;dir-in-container&gt;<br/> volumes:<br/> — .:/&lt;dir-in-container&gt;<br/> ports:<br/> — “8000:8000”<br/> <br/> <br/> — — — — requirements.txt<br/>Django==2.1.5<br/>gunicorn==19.9.0</span></pre><p id="0a1a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">之后，通过运行以下命令创建 docker 映像:</p><pre class="kp kq kr ks gt kt ku kv kw aw kx bi"><span id="37a3" class="ky kz it ku b gy la lb l lc ld">docker build -t &lt;DockerLogin&gt;/&lt;Docker-Image_name&gt; .<br/># PS: don’t forget the “.” at the end of the above command</span></pre><p id="0ed6" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">其中<strong class="js iu"> DockerLogin </strong>是您的 docker Hub 登录名，<strong class="js iu"> Docker-Image_name </strong>是您想要的图像名称。</p><p id="442d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">要测试您的映像是否正常工作，只需启动:</p><pre class="kp kq kr ks gt kt ku kv kw aw kx bi"><span id="c62e" class="ky kz it ku b gy la lb l lc ld">docker run -p 8000:8000 -i -t &lt;DockerLogin&gt;/&lt;Docker-Image_name&gt;</span></pre><p id="1f96" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">您应该会在路由端口 8000 上看到您声明的 IP 0.0.0.0 的结果，如下所示:</p><figure class="kp kq kr ks gt lf gh gi paragraph-image"><div class="gh gi lr"><img src="../Images/47e50eb5511ac91517f4c15870c310fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:778/format:webp/1*6BwgfGN83hy_ldwNdtripw.png"/></div></figure><p id="66fe" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">要将图像推入 docker hub，只需启动以下命令:</p><pre class="kp kq kr ks gt kt ku kv kw aw kx bi"><span id="5394" class="ky kz it ku b gy la lb l lc ld">docker push &lt;DockerLogin&gt;/&lt;Docker-Image_name&gt;</span></pre><p id="7acc" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu"> PS </strong>:检查你的本地 docker 是否在运行，如下图所示(针对 Mac 用户)。</p><figure class="kp kq kr ks gt lf gh gi paragraph-image"><div class="gh gi ls"><img src="../Images/ff783e1d5f3f24f4b40ba981a6e668c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:554/format:webp/1*DKQtQfZRqE5snLG_nzEubQ.png"/></div></figure><p id="a4f3" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">现在，您的 Django 应用程序被推送到 Docker Hub 映像，任何人都可以从 Hub 中取出它，并在 Docker 中实例化它，以便在他的本地环境中运行它，而不用担心依赖关系，也不用使用 Django、Python 等。本地安装。</p><p id="54cb" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">现在让我们看看如何托管您的 docker 映像并从<strong class="js iu"> AWS </strong>访问它。</p><p id="2117" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">首先，您需要创建一个<strong class="js iu"> JSON </strong>文件，告诉 AWS 如何找到您的 docker 映像，请参见下面的示例:</p><pre class="kp kq kr ks gt kt ku kv kw aw kx bi"><span id="c2bb" class="ky kz it ku b gy la lb l lc ld">— — — -Dockerrun.aws.json<br/>{<br/> “AWSEBDockerrunVersion”: “1”,<br/> “Image”: {<br/> “Name”: “abdel1979/&lt;image-name&gt;”,<br/> “Update”: “true”<br/> },<br/> “Ports”: [<br/> {<br/> “ContainerPort”: “8000”<br/> }<br/> ],<br/> “Logging”: “/var/log/nginx”<br/>}</span></pre><p id="6ab7" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">之后，只需在您的 AWS 帐户中导航至<strong class="js iu">管理控制台</strong>:</p><figure class="kp kq kr ks gt lf gh gi paragraph-image"><div role="button" tabindex="0" class="lg lh di li bf lj"><div class="gh gi lt"><img src="../Images/16b7dbbcd15fb9c43516abcaf92d2aad.png" data-original-src="https://miro.medium.com/v2/resize:fit:434/format:webp/1*N1QPOYDzNukFQ_j8YInYcA.png"/></div></div></figure><p id="ef0c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">然后交给<strong class="js iu">弹性豆茎。</strong></p><figure class="kp kq kr ks gt lf gh gi paragraph-image"><div class="gh gi lu"><img src="../Images/01acfcfaaa62965d4a38fdba44f0343d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1018/format:webp/1*--Fm_Md0NOOLhxZlcC4knA.png"/></div></figure><p id="377f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">之后，通过命名创建一个新的应用程序，然后选择 web 服务器环境:</p><figure class="kp kq kr ks gt lf gh gi paragraph-image"><div role="button" tabindex="0" class="lg lh di li bf lj"><div class="gh gi lv"><img src="../Images/166e59ca1abf1da7f0a68a3ba77ebbe3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Uxc9xW3OmGd_nGUC5ZtQrQ.png"/></div></div></figure><p id="41ab" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">接下来，填写所需信息，<strong class="js iu">环境名</strong>，<strong class="js iu">域名</strong>并选择 docker 作为平台，最后上传你的<strong class="js iu"> JSON </strong>文件。</p><figure class="kp kq kr ks gt lf gh gi paragraph-image"><div role="button" tabindex="0" class="lg lh di li bf lj"><div class="gh gi lw"><img src="../Images/e04c927ae2a91e0f60ba13df68b356f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-4vXk9sMAie8WppIi4S2LA.png"/></div></div></figure><figure class="kp kq kr ks gt lf gh gi paragraph-image"><div class="gh gi lx"><img src="../Images/4ec25d85eb0f2e41ae15fe6d860531ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1110/format:webp/1*whkLWR1Y_szraBv2vZz2vg.png"/></div></figure><p id="8107" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">最后，等待几分钟来创建您的环境，一旦准备好，打开您选择的域，您将看到您的应用程序显示如下:</p><figure class="kp kq kr ks gt lf gh gi paragraph-image"><div class="gh gi ly"><img src="../Images/2cd6bf6ef791f3ae669cc2bff64a9ec2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1240/format:webp/1*GKxTqNneVlR0Zu2J-GS84Q.png"/></div></figure><p id="f58d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们到了:)<br/>一如既往，我希望你学到了新的东西。</p><p id="95ad" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">萨拉姆，</p></div></div>    
</body>
</html>