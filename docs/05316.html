<html>
<head>
<title>Online Machine Learning with Tensorflow.js</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用 Tensorflow.js 进行在线机器学习</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/online-machine-learning-with-tensorflow-js-2ae232352901?source=collection_archive---------19-----------------------#2019-08-07">https://towardsdatascience.com/online-machine-learning-with-tensorflow-js-2ae232352901?source=collection_archive---------19-----------------------#2019-08-07</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="3737" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">关于如何使用 Tensorflow.js 在浏览器中创建、训练和测试机器学习模型的端到端指南</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/b5fcf45cee8e43cb389d1c0538f43c91.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YvKKzsjspxIfzY4Xj2e9pQ.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">(Source: <a class="ae ky" href="https://miro.medium.com/max/1400/1*F-1fq9TNjDnAYPAXnZP4Ww.png" rel="noopener">https://miro.medium.com/max/1400/1*F-1fq9TNjDnAYPAXnZP4Ww.png</a>)</figcaption></figure><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="kz la l"/></div></figure><h1 id="2bc9" class="lb lc it bd ld le lf lg lh li lj lk ll jz lm ka ln kc lo kd lp kf lq kg lr ls bi translated">介绍</h1><p id="fd79" class="pw-post-body-paragraph lt lu it lv b lw lx ju ly lz ma jx mb mc md me mf mg mh mi mj mk ml mm mn mo im bi translated">由于最近人工智能的进步，现在建立和训练机器学习模型变得相对容易。虽然，这些模型只有通过分享它们，让它们做好在线预测的准备，才能让社会受益。</p><p id="04c7" class="pw-post-body-paragraph lt lu it lv b lw mp ju ly lz mq jx mb mc mr me mf mg ms mi mj mk mt mm mn mo im bi translated">在我之前的一篇文章中，我解释了如何使用<a class="ae ky" rel="noopener" target="_blank" href="/flask-and-heroku-for-online-machine-learning-deployment-425beb54a274"> Heroku 和 Flask </a>创建和部署一个简单的机器学习模型，今天我将为您提供另一个选项:Tensorflow.js。</p><p id="eafa" class="pw-post-body-paragraph lt lu it lv b lw mp ju ly lz mq jx mb mc mr me mf mg ms mi mj mk mt mm mn mo im bi translated">Tensorflow.js 是 Google 创建的 Javascript 库，用于将机器学习能力嵌入到任何形式的 web 应用程序中。</p><p id="4bbc" class="pw-post-body-paragraph lt lu it lv b lw mp ju ly lz mq jx mb mc mr me mf mg ms mi mj mk mt mm mn mo im bi translated">为了添加一些浏览器内可视化，Tensorflow.js 使用了一个名为<em class="mu"> tfjs-vis 的小库。</em>这个库可以用来创建一个侧面板，所有的内容都可以在上面显示。</p><p id="e491" class="pw-post-body-paragraph lt lu it lv b lw mp ju ly lz mq jx mb mc mr me mf mg ms mi mj mk mt mm mn mo im bi translated">除此之外，谷歌还开发了另一个名为<em class="mu"> ml5.js </em>的库，旨在使在线部署预训练模型变得非常容易。这样，非专业人员也可以开始在网络上部署机器学习模型。一个简单的例子，如何使用谷歌 PoseNet 预训练模型是可用的<a class="ae ky" href="https://pierpaolo28.github.io/Projects/ml5.js/ml5intro.html" rel="noopener ugc nofollow" target="_blank">这里</a>。</p><p id="ee43" class="pw-post-body-paragraph lt lu it lv b lw mp ju ly lz mq jx mb mc mr me mf mg ms mi mj mk mt mm mn mo im bi translated">有 3 种主要类型的模型可以在线部署:</p><ol class=""><li id="4117" class="mv mw it lv b lw mp lz mq mc mx mg my mk mz mo na nb nc nd bi translated"><strong class="lv iu">回归模型</strong></li></ol><p id="2b57" class="pw-post-body-paragraph lt lu it lv b lw mp ju ly lz mq jx mb mc mr me mf mg ms mi mj mk mt mm mn mo im bi translated">在这个例子(GIF 1)中，我决定使用<a class="ae ky" href="https://college.cengage.com/mathematics/brase/understandable_statistics/7e/students/datasets/slr/frames/frame.html" rel="noopener ugc nofollow" target="_blank">“瑞典汽车保险风险溢价分析委员会”数据集</a>来训练和可视化一个简单的回归模型。打开网页后，培训过程将实时在线进行。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ne"><img src="../Images/30dc0377493d7ac5dce28b45ded6b74d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*EH68AxMDi6mWVAP_vXC6_A.gif"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">GIF 1: Training and Visualizing online a Regression Model</figcaption></figure><p id="e840" class="pw-post-body-paragraph lt lu it lv b lw mp ju ly lz mq jx mb mc mr me mf mg ms mi mj mk mt mm mn mo im bi translated">2.<strong class="lv iu">分类模型</strong></p><p id="0afb" class="pw-post-body-paragraph lt lu it lv b lw mp ju ly lz mq jx mb mc mr me mf mg ms mi mj mk mt mm mn mo im bi translated">在这个例子(GIF 2)中，我决定使用<a class="ae ky" href="https://www.kaggle.com/sgus1318/winedata" rel="noopener ugc nofollow" target="_blank">“葡萄酒数据集”来训练一个分类模型。</a>在这种情况下，培训过程也是实时在线进行的。此外，还提供了所用神经网络层特征的总结和分类矩阵。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ne"><img src="../Images/a14ac4c2e10d3dd8fac5dd2a39087ccc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*YRUjgDjjiI26Wq1nfNSrvg.gif"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">GIF 2: Training and Visualizing online a Classification Model</figcaption></figure><p id="f873" class="pw-post-body-paragraph lt lu it lv b lw mp ju ly lz mq jx mb mc mr me mf mg ms mi mj mk mt mm mn mo im bi translated">3.<strong class="lv iu">预训练模型</strong></p><p id="ee52" class="pw-post-body-paragraph lt lu it lv b lw mp ju ly lz mq jx mb mc mr me mf mg ms mi mj mk mt mm mn mo im bi translated">最后，在这个例子(GIF 3)中，我决定使用一个预先训练好的模型。我首先使用<a class="ae ky" href="https://www.kaggle.com/uciml/pima-indians-diabetes-database" rel="noopener ugc nofollow" target="_blank">“Pima Indians Diabetes Database”</a>用 Python 训练了这个模型，将其保存为 JSON 文件，最后将其部署到网上，准备进行预测。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ne"><img src="../Images/6a6175a0159d90289c7ecb7c28609efe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*k2u3TaJtx6VRj3ZRU6c5uQ.gif"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">GIF 3: Making Predictions and Visualizing online using a Pre-Trained Model</figcaption></figure><p id="b8bd" class="pw-post-body-paragraph lt lu it lv b lw mp ju ly lz mq jx mb mc mr me mf mg ms mi mj mk mt mm mn mo im bi translated">这三个例子都可以在我的<a class="ae ky" href="https://pierpaolo28.github.io/Projects/tensorflow.js/tensorjs.html" rel="noopener ugc nofollow" target="_blank">个人网站</a>上找到，如果你有兴趣测试一下的话。</p><p id="1238" class="pw-post-body-paragraph lt lu it lv b lw mp ju ly lz mq jx mb mc mr me mf mg ms mi mj mk mt mm mn mo im bi translated">在本文中，我将带您了解如何实现这三个示例中的第一个。</p><p id="05c1" class="pw-post-body-paragraph lt lu it lv b lw mp ju ly lz mq jx mb mc mr me mf mg ms mi mj mk mt mm mn mo im bi translated">所有用于创建这些例子的代码和数据集都可以在我的<a class="ae ky" href="https://github.com/pierpaolo28/Artificial-Intelligence-Projects/tree/master/Google%20AI%20tools/tensorflow.js" rel="noopener ugc nofollow" target="_blank"> GitHub 库</a>中找到。</p><h1 id="6a40" class="lb lc it bd ld le lf lg lh li lj lk ll jz lm ka ln kc lo kd lp kf lq kg lr ls bi translated">示范</h1><p id="db76" class="pw-post-body-paragraph lt lu it lv b lw lx ju ly lz ma jx mb mc md me mf mg mh mi mj mk ml mm mn mo im bi translated">对于这个例子，我将使用这个<a class="ae ky" href="https://raw.githubusercontent.com/pierpaolo28/Artificial-Intelligence-Projects/master/Google%20AI%20tools/tensorflow.js/swedish.json" rel="noopener ugc nofollow" target="_blank">“瑞典汽车保险风险溢价分析委员会”数据集</a>。这个简单的数据集仅由两列组成(X =索赔数量，Y =瑞典地理区域内所有索赔的总支付额，单位为千瑞典克朗)。</p><p id="eecf" class="pw-post-body-paragraph lt lu it lv b lw mp ju ly lz mq jx mb mc mr me mf mg ms mi mj mk mt mm mn mo im bi translated">作为演示的一部分，我们将通过检查索赔分布的总数来预测所有索赔的总支付额。</p><h2 id="fe95" class="nf lc it bd ld ng nh dn lh ni nj dp ll mc nk nl ln mg nm nn lp mk no np lr nq bi translated">设置</h2><p id="3af3" class="pw-post-body-paragraph lt lu it lv b lw lx ju ly lz ma jx mb mc md me mf mg mh mi mj mk ml mm mn mo im bi translated">首先，我们需要创建一个 HTML 页面来显示我们的内容。下面的代码片段提供了一个基本的模板，您可以随意添加任何您想要的功能！</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nr la l"/></div></figure><h2 id="171d" class="nf lc it bd ld ng nh dn lh ni nj dp ll mc nk nl ln mg nm nn lp mk no np lr nq bi translated">预处理</h2><p id="342b" class="pw-post-body-paragraph lt lu it lv b lw lx ju ly lz ma jx mb mc md me mf mg mh mi mj mk ml mm mn mo im bi translated">我们现在可以创建另一个名为<em class="mu"> script.js </em>的文件(在我们的 HTML 文件的同一个目录中)，在这里我们可以开始加载数据集并执行一些基本的预处理任务。</p><p id="0529" class="pw-post-body-paragraph lt lu it lv b lw mp ju ly lz mq jx mb mc mr me mf mg ms mi mj mk mt mm mn mo im bi translated">为了从 JSON 文件加载数据集，我们可以使用下面的函数(<em class="mu"> getData </em>)。在这个函数中，我们首先加载数据集，然后选择我们感兴趣的列，并给它们取一个用户友好的名称。最后，使用一个过滤函数，我们去掉所有出现在所选列中的 nan(不是一个数字)。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nr la l"/></div></figure><p id="a058" class="pw-post-body-paragraph lt lu it lv b lw mp ju ly lz mq jx mb mc mr me mf mg ms mi mj mk mt mm mn mo im bi translated">接下来，我们可以创建一个函数来预处理我们的数据集(<em class="mu"> convertToTensor </em>)。在这种情况下，我们:</p><ol class=""><li id="6945" class="mv mw it lv b lw mp lz mq mc mx mg my mk mz mo na nb nc nd bi translated"><strong class="lv iu">混洗数据</strong> =随机化样本的顺序，这些样本稍后将用于训练我们的回归模型。通过这种方式，与原始数据分布相比，我们可以为我们的模型提供更多种类的数据(这是因为当输入模型时，我们的训练数据将被连续划分为更小的子集，称为批次)。</li><li id="700c" class="mv mw it lv b lw ns lz nt mc nu mg nv mk nw mo na nb nc nd bi translated"><strong class="lv iu">将数据分为特征和标签</strong> =特征将是我们的输入样本，标签将是我们的真实输出值(基本事实)。</li><li id="23ea" class="mv mw it lv b lw ns lz nt mc nu mg nv mk nw mo na nb nc nd bi translated"><strong class="lv iu">以张量形式转换特征和标签</strong> =我们将原始数组转换成二维张量。</li><li id="b4e3" class="mv mw it lv b lw ns lz nt mc nu mg nv mk nw mo na nb nc nd bi translated"><strong class="lv iu">标准化输出张量</strong> =将我们的数据重新调整到 0 到 1 之间的范围。这样做是为了防止训练模型中出现过大或过小的值(上溢/下溢)的问题。一旦训练了我们的模型，我们就可以反规格化我们的输出来获得我们的最终结果。</li></ol><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nr la l"/></div></figure><h2 id="604d" class="nf lc it bd ld ng nh dn lh ni nj dp ll mc nk nl ln mg nm nn lp mk no np lr nq bi translated">定义和训练我们的模型</h2><p id="4d0d" class="pw-post-body-paragraph lt lu it lv b lw lx ju ly lz ma jx mb mc md me mf mg mh mi mj mk ml mm mn mo im bi translated">我们现在可以继续设计一个简单的机器学习模型(<em class="mu"> createModel </em>)，然后创建一个函数来训练它(<em class="mu"> trianModel </em>)。</p><p id="42b8" class="pw-post-body-paragraph lt lu it lv b lw mp ju ly lz mq jx mb mc mr me mf mg ms mi mj mk mt mm mn mo im bi translated">在这种情况下，我利用回调来调用 Tensorflow.js 图形支持库<em class="mu"> tfjs-vis </em>，以便创建一个实时图形，显示我们的模型损失在训练期间是如何变化的(图 1)。如果你有兴趣更详细地了解回调是如何工作的，我在本文<a class="ae ky" rel="noopener" target="_blank" href="/deep-learning-analysis-using-large-model-support-3a67a919255">中提供了更详细的解释。</a></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nr la l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/ebb15c693af3b06d04eaa88a6d07db4d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1002/format:webp/1*LsUCyrbhfuStbZba9V4eww.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Figure 1: Real-Time model Loss</figcaption></figure><h2 id="8f72" class="nf lc it bd ld ng nh dn lh ni nj dp ll mc nk nl ln mg nm nn lp mk no np lr nq bi translated">测试</h2><p id="cdef" class="pw-post-body-paragraph lt lu it lv b lw lx ju ly lz ma jx mb mc md me mf mg mh mi mj mk ml mm mn mo im bi translated">现在我们的模型已经训练好了，我们可以开始做预测了。为此，我设计了下面的函数(<em class="mu"> testModel </em>)。在这个简单的例子中，我决定使用训练数据本身来测试我们的模型性能。</p><p id="df4d" class="pw-post-body-paragraph lt lu it lv b lw mp ju ly lz mq jx mb mc mr me mf mg ms mi mj mk mt mm mn mo im bi translated">此外，我还对我们的模型预测进行了反规范化，然后将它们与真实输出进行了对比，以便检查我们的模型性能(图 2)。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nr la l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/3cc8151d1193aec263ccd4e31952b992.png" data-original-src="https://miro.medium.com/v2/resize:fit:1006/format:webp/1*NxeuNTVHk9hdH3FBlX-e0g.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Figure 2: Model Predictions vs Original Data</figcaption></figure><h2 id="9fc9" class="nf lc it bd ld ng nh dn lh ni nj dp ll mc nk nl ln mg nm nn lp mk no np lr nq bi translated">运行模型</h2><p id="19cd" class="pw-post-body-paragraph lt lu it lv b lw lx ju ly lz ma jx mb mc md me mf mg mh mi mj mk ml mm mn mo im bi translated">最后，我们现在需要创建一个函数来运行所有代码(<em class="mu">运行</em>)。在这个函数中，我们首先执行一些数据可视化，然后调用我们之前定义的所有函数(图 3)。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nr la l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nz"><img src="../Images/ad0495a5e4146c327a4ad06076934afc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1008/format:webp/1*c6YYL-sM42ouZN7Ji5oc0A.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Figure 3: Scatterplot of the original data</figcaption></figure><p id="1ae0" class="pw-post-body-paragraph lt lu it lv b lw mp ju ly lz mq jx mb mc mr me mf mg ms mi mj mk mt mm mn mo im bi translated">现在，您可以通过在自己的网站上运行或使用本地服务器来测试您的模型。如果您从未使用过本地服务器，一个简单的解决方案是使用<a class="ae ky" href="https://visualstudio.microsoft.com/" rel="noopener ugc nofollow" target="_blank"> Visual Studio 代码</a>并安装其<a class="ae ky" href="https://marketplace.visualstudio.com/items?itemName=negokaz.live-server-preview" rel="noopener ugc nofollow" target="_blank"> Live 服务器扩展</a>。</p><h1 id="ec64" class="lb lc it bd ld le lf lg lh li lj lk ll jz lm ka ln kc lo kd lp kf lq kg lr ls bi translated">联系人</h1><p id="60e6" class="pw-post-body-paragraph lt lu it lv b lw lx ju ly lz ma jx mb mc md me mf mg mh mi mj mk ml mm mn mo im bi translated">如果你想了解我最新的文章和项目<a class="ae ky" href="https://medium.com/@pierpaoloippolito28?source=post_page---------------------------" rel="noopener">请关注我的媒体</a>并订阅我的<a class="ae ky" href="http://eepurl.com/gwO-Dr?source=post_page---------------------------" rel="noopener ugc nofollow" target="_blank">邮件列表</a>。以下是我的一些联系人详细信息:</p><ul class=""><li id="031d" class="mv mw it lv b lw mp lz mq mc mx mg my mk mz mo oa nb nc nd bi translated"><a class="ae ky" href="https://uk.linkedin.com/in/pier-paolo-ippolito-202917146?source=post_page---------------------------" rel="noopener ugc nofollow" target="_blank">领英</a></li><li id="c51c" class="mv mw it lv b lw ns lz nt mc nu mg nv mk nw mo oa nb nc nd bi translated"><a class="ae ky" href="https://pierpaolo28.github.io/blog/?source=post_page---------------------------" rel="noopener ugc nofollow" target="_blank">个人博客</a></li><li id="b4d4" class="mv mw it lv b lw ns lz nt mc nu mg nv mk nw mo oa nb nc nd bi translated"><a class="ae ky" href="https://pierpaolo28.github.io/?source=post_page---------------------------" rel="noopener ugc nofollow" target="_blank">个人网站</a></li><li id="6bdc" class="mv mw it lv b lw ns lz nt mc nu mg nv mk nw mo oa nb nc nd bi translated"><a class="ae ky" href="https://towardsdatascience.com/@pierpaoloippolito28?source=post_page---------------------------" rel="noopener" target="_blank">中型简介</a></li><li id="8242" class="mv mw it lv b lw ns lz nt mc nu mg nv mk nw mo oa nb nc nd bi translated"><a class="ae ky" href="https://github.com/pierpaolo28?source=post_page---------------------------" rel="noopener ugc nofollow" target="_blank"> GitHub </a></li><li id="a302" class="mv mw it lv b lw ns lz nt mc nu mg nv mk nw mo oa nb nc nd bi translated"><a class="ae ky" href="https://www.kaggle.com/pierpaolo28?source=post_page---------------------------" rel="noopener ugc nofollow" target="_blank">卡格尔</a></li></ul></div></div>    
</body>
</html>