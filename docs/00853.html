<html>
<head>
<title>Time Series in Python — Exponential Smoothing and ARIMA processes</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python 中的时间序列—指数平滑和 ARIMA 过程</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/time-series-in-python-exponential-smoothing-and-arima-processes-2c67f2a52788?source=collection_archive---------0-----------------------#2019-02-09">https://towardsdatascience.com/time-series-in-python-exponential-smoothing-and-arima-processes-2c67f2a52788?source=collection_archive---------0-----------------------#2019-02-09</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="b9f0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="kl">TL；DR:在这篇文章中，你将学习执行时间序列分析的基本步骤，以及趋势、平稳性、移动平均线等概念。您还将探索指数平滑方法，并学习如何在非平稳数据上拟合 ARIMA 模型。</em></p><h1 id="d43d" class="km kn iq bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bi translated">时间序列随处可见</h1><p id="012a" class="pw-post-body-paragraph jn jo iq jp b jq lk js jt ju ll jw jx jy lm ka kb kc ln ke kf kg lo ki kj kk ij bi translated"><em class="kl">场景 1:你负责一家披萨配送中心，你想知道你的销售是否遵循特定的模式，因为你觉得每周六晚上你的订单数量都会增加……</em></p><p id="64d3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="kl">场景 2:你的公司正在销售一种产品，而你负责预测，或者说预测，在未来某个特定时刻，这种产品所需的供应……</em></p><p id="ff96" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="kl">情况 3:您正在监控一个数据中心，并且想要检测任何异常情况，比如可能导致服务器停机的异常 CPU 使用情况。您跟踪 CPU 使用率的曲线，并想知道何时出现异常… </em></p><p id="a57c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在每一种情况下，你都在处理时间序列。分析序列是一项迷人的工作，因为尽管有所有的数学模型(包括神经网络)，我们人类仍然无法预测未来，并且必须处理不确定性。让我们仔细看看什么是时间序列，可以用哪些方法来分析它们。在本文中，我们将广泛依赖于用 Python 编写的<a class="ae lp" href="https://www.statsmodels.org/stable/index.html" rel="noopener ugc nofollow" target="_blank"><strong class="jp ir"><em class="kl">【stats models】</em></strong></a><strong class="jp ir"><em class="kl"/></strong>库。</p><blockquote class="lq lr ls"><p id="5909" class="jn jo kl jp b jq jr js jt ju jv jw jx lt jz ka kb lu kd ke kf lv kh ki kj kk ij bi translated">时间序列是按时间排序(或索引)的数据序列。它是离散的，每个点之间的间隔是常数。</p></blockquote><h1 id="478e" class="km kn iq bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bi translated">系列的性质和类型</h1><p id="25ff" class="pw-post-body-paragraph jn jo iq jp b jq lk js jt ju ll jw jx jy lm ka kb kc ln ke kf kg lo ki kj kk ij bi translated"><strong class="jp ir"> <em class="kl">趋势</em> </strong>:数据的长期增减。这可以被看作是粗略穿过数据的斜率(不必是线性的)。</p><p id="5a49" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> <em class="kl">季节性</em> </strong>:当一个时间序列受到季节性因素(一天中的某个小时、一周、一月、一年等)的影响时，称之为季节性的。).季节性可以通过固定频率的良好循环模式来观察。</p><p id="04a0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> <em class="kl">周期性</em> </strong>:当数据呈现非固定频率的上升和下降时，出现一个周期。这些波动通常是由经济条件造成的，而且往往与“商业周期”有关。这些波动的持续时间通常至少为两年。</p><p id="2bff" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> <em class="kl">残差</em> </strong>:每个时间序列可以分解成两部分:<br/> -一个预测，由一个或几个<em class="kl">预测值</em><br/>-残差。它们是每个时间步的观测值和预测值之间的差值。记住这一点</p><blockquote class="lq lr ls"><p id="69bf" class="jn jo kl jp b jq jr js jt ju jv jw jx lt jz ka kb lu kd ke kf lv kh ki kj kk ij bi translated"><strong class="jp ir">t 时刻序列值= t 时刻预测值+t 时刻残差</strong></p></blockquote><div class="lw lx ly lz gt ab cb"><figure class="ma mb mc md me mf mg paragraph-image"><div role="button" tabindex="0" class="mh mi di mj bf mk"><img src="../Images/bcee7281e5a2b66772a4386907692c01.png" data-original-src="https://miro.medium.com/v2/resize:fit:1104/format:webp/1*Y9N6_GjWYI9eIfrpqZ24GA.png"/></div></figure><figure class="ma mb mn md me mf mg paragraph-image"><div role="button" tabindex="0" class="mh mi di mj bf mk"><img src="../Images/706ba20b33fa4bddbc8f2a7ac2dca407.png" data-original-src="https://miro.medium.com/v2/resize:fit:898/format:webp/1*LOpA2ty_2Exfkd2W0LYANA.png"/></div><figcaption class="mo mp gj gh gi mq mr bd b be z dk ms di mt mu"><strong class="bd mv">Left</strong>: Series with a <strong class="bd mv">trend</strong>. <strong class="bd mv">Right</strong>: Series exhibiting <strong class="bd mv">seasonal </strong>behavior</figcaption></figure></div><div class="ab cb"><figure class="ma mb mw md me mf mg paragraph-image"><div role="button" tabindex="0" class="mh mi di mj bf mk"><img src="../Images/adb69ce42cb5a5ae78ba7ae75f842a23.png" data-original-src="https://miro.medium.com/v2/resize:fit:994/format:webp/1*O8pxgq3EKWjnarL3g87BjA.png"/></div></figure><figure class="ma mb mx md me mf mg paragraph-image"><div role="button" tabindex="0" class="mh mi di mj bf mk"><img src="../Images/d6c8a7b74f3beed457dc0f5d0c97875d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1008/format:webp/1*fiSwWGHZkpazvilnxGs9UA.png"/></div><figcaption class="mo mp gj gh gi mq mr bd b be z dk my di mz mu"><strong class="bd mv">Left</strong>: <strong class="bd mv">Cyclical </strong>series. <strong class="bd mv">Right</strong>: <strong class="bd mv">Random walk</strong></figcaption></figure></div><h1 id="aada" class="km kn iq bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bi translated">时间序列的分解</h1><p id="fab5" class="pw-post-body-paragraph jn jo iq jp b jq lk js jt ju ll jw jx jy lm ka kb kc ln ke kf kg lo ki kj kk ij bi translated">每个时间序列都可以看作是几个部分的混合:</p><ul class=""><li id="0528" class="na nb iq jp b jq jr ju jv jy nc kc nd kg ne kk nf ng nh ni bi translated">趋势(曲线长期向上或向下移动)</li><li id="5063" class="na nb iq jp b jq nj ju nk jy nl kc nm kg nn kk nf ng nh ni bi translated">季节性成分</li><li id="bd77" class="na nb iq jp b jq nj ju nk jy nl kc nm kg nn kk nf ng nh ni bi translated">残差</li></ul><p id="0489" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">下面是我们的时间序列分解成上述部分后的样子:</p><figure class="lw lx ly lz gt mb gh gi paragraph-image"><div class="gh gi no"><img src="../Images/65fc671d40e8446762c5982a90f643a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:956/format:webp/1*KwTyFVU3G3Y22ptUQRmgzQ.png"/></div></figure><p id="74a8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们的时间序列显示出明显的上升趋势。它不是季节性的，你可以看到季节性的部分看起来很难看。残差的方差似乎随着时间的推移而增加，表明序列在结束时表现出更多的随机行为。</p><h1 id="7fbe" class="km kn iq bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bi translated">黄金法则:平稳</h1><p id="4b37" class="pw-post-body-paragraph jn jo iq jp b jq lk js jt ju ll jw jx jy lm ka kb kc ln ke kf kg lo ki kj kk ij bi translated">在我们进一步分析之前，我们的系列必须使<strong class="jp ir"> <em class="kl">静止。<br/>平稳性</em> </strong>是展现恒定统计性质(均值、方差、自相关等)的性质。).如果时间序列的平均值随着时间的推移而增加，那么它就不是稳定的。</p><h2 id="b7b0" class="np kn iq bd ko nq nr dn ks ns nt dp kw jy nu nv la kc nw nx le kg ny nz li oa bi translated">用于静态化数据的转换:</h2><ul class=""><li id="af00" class="na nb iq jp b jq lk ju ll jy ob kc oc kg od kk nf ng nh ni bi translated"><strong class="jp ir"> <em class="kl">去趋势</em> </strong>:我们去除序列中的<em class="kl">潜在趋势</em>。这可以通过多种方式实现，具体取决于数据的性质:<br/> - <em class="kl">指数化</em>数据:以货币计量的数据与价格指数挂钩或与通货膨胀相关。因此，将序列除以该指数(即<strong class="jp ir">缩减</strong>)是去除数据趋势的解决方案。<br/> - <em class="kl">非指数型</em>数据:是否需要估计趋势是常数、线性还是指数型。前两种情况很容易，对于最后一种情况，有必要估计增长率(通货膨胀或通货紧缩),并应用与指数化数据相同的方法。</li><li id="c34c" class="na nb iq jp b jq nj ju nk jy nl kc nm kg nn kk nf ng nh ni bi translated"><strong class="jp ir"> <em class="kl">差分</em> </strong>:可以通过减去周期值来去除季节性或周期性模式。如果数据是 12 个月的季节性数据，用 12 个滞后的差值序列减去该序列将得到一个“更平”的序列</li><li id="967c" class="na nb iq jp b jq nj ju nk jy nl kc nm kg nn kk nf ng nh ni bi translated"><strong class="jp ir"> <em class="kl">日志</em> </strong>:在趋势中的复合率不是由于某个价格指数(即序列不是以货币计量的)的情况下，日志可以帮助<em class="kl">线性化</em>一个具有指数趋势的序列(回想一下 log(exp(x)) = x)。与通缩不同，它并没有消除任何最终趋势。</li></ul><h1 id="0b44" class="km kn iq bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bi translated">检查平稳性</h1><h2 id="75ce" class="np kn iq bd ko nq nr dn ks ns nt dp kw jy nu nv la kc nw nx le kg ny nz li oa bi translated">绘制滚动统计数据</h2><p id="a7a5" class="pw-post-body-paragraph jn jo iq jp b jq lk js jt ju ll jw jx jy lm ka kb kc ln ke kf kg lo ki kj kk ij bi translated">绘制滚动平均值和方差是直观检查我们系列的第一个好方法。如果滚动统计显示出明显的趋势(向上或向下)并显示出变化的方差(增加或减少幅度)，那么您可能会得出结论，该序列很可能不是平稳的。</p><figure class="lw lx ly lz gt mb"><div class="bz fp l di"><div class="oe of l"/></div></figure><figure class="lw lx ly lz gt mb gh gi paragraph-image"><div role="button" tabindex="0" class="mh mi di mj bf mk"><div class="gh gi og"><img src="../Images/de25d172d4b9dd08fc7e2cdce47d3f64.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sp7_NBZNj_6ZpojQ4I_yCg.png"/></div></div></figure><h2 id="a85a" class="np kn iq bd ko nq nr dn ks ns nt dp kw jy nu nv la kc nw nx le kg ny nz li oa bi translated">扩充迪基-富勒试验</h2><p id="61ae" class="pw-post-body-paragraph jn jo iq jp b jq lk js jt ju ll jw jx jy lm ka kb kc ln ke kf kg lo ki kj kk ij bi translated">该检验用于评估时间序列是否是平稳的。不必深入假设检验的太多细节，你应该知道这个检验将给出一个叫做“检验统计”的结果，根据这个结果，你可以用不同的置信水平(或百分比)来判断时间序列是否平稳。</p><figure class="lw lx ly lz gt mb"><div class="bz fp l di"><div class="oe of l"/></div></figure><figure class="lw lx ly lz gt mb gh gi paragraph-image"><div role="button" tabindex="0" class="mh mi di mj bf mk"><div class="gh gi oh"><img src="../Images/79ca1ce027b928e5c996d6b0d7595429.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aG1P_lYvzV0iiReaR_WzFA.png"/></div></div></figure><h2 id="f7c9" class="np kn iq bd ko nq nr dn ks ns nt dp kw jy nu nv la kc nw nx le kg ny nz li oa bi translated">KPSS</h2><p id="c28e" class="pw-post-body-paragraph jn jo iq jp b jq lk js jt ju ll jw jx jy lm ka kb kc ln ke kf kg lo ki kj kk ij bi translated">KPSS(科维亚特科夫斯基-菲利普斯-施密特-申)检验测试的是序列是趋势平稳的零假设。换句话说，如果检验统计量的 p 值低于 X%置信度阈值，这意味着我们可以拒绝这个假设，并且序列不是具有 X%置信度的趋势平稳序列。高于阈值的 p 值将使我们接受这一假设，并得出序列是趋势平稳的结论。</p><h2 id="39ec" class="np kn iq bd ko nq nr dn ks ns nt dp kw jy nu nv la kc nw nx le kg ny nz li oa bi translated">自相关图(ACF 和 PACF)</h2><p id="67a9" class="pw-post-body-paragraph jn jo iq jp b jq lk js jt ju ll jw jx jy lm ka kb kc ln ke kf kg lo ki kj kk ij bi translated"><em class="kl">自相关</em> (ACF)图表示具有自身滞后的序列的自相关。<br/><em class="kl">偏自相关</em> (PACF)图表示一个序列和其自身滞后之间的相关量，该相关量不能用所有更低阶<em class="kl"> - </em>滞后的相关来解释。理想情况下，我们不希望序列与其自身的滞后之间存在相关性。从图形上来说，我们希望所有的尖峰都落在蓝色区域。</p><figure class="lw lx ly lz gt mb"><div class="bz fp l di"><div class="oe of l"/></div></figure><figure class="lw lx ly lz gt mb gh gi paragraph-image"><div role="button" tabindex="0" class="mh mi di mj bf mk"><div class="gh gi oi"><img src="../Images/9adff6a83878930952bb62c2286f54e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gPA8J1TFgNh9N1ikhdXxuA.png"/></div></div></figure><p id="d748" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">正如我们所见，蓝色区域上方有几个尖峰，这意味着在滞后 1、2、3 和 4 处存在相关性。</p></div><div class="ab cl oj ok hu ol" role="separator"><span class="om bw bk on oo op"/><span class="om bw bk on oo op"/><span class="om bw bk on oo"/></div><div class="ij ik il im in"><h1 id="42fa" class="km kn iq bd ko kp oq kr ks kt or kv kw kx os kz la lb ot ld le lf ou lh li lj bi translated">选择模型</h1><p id="9783" class="pw-post-body-paragraph jn jo iq jp b jq lk js jt ju ll jw jx jy lm ka kb kc ln ke kf kg lo ki kj kk ij bi translated">指数平滑法适用于非平稳数据(即具有趋势的数据和季节性数据)。</p><p id="b199" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ARIMA 模型应该只用于静态数据。因此，应该去除数据的趋势(通过缩减或记录)，然后查看有差异的序列。</p><h1 id="0910" class="km kn iq bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bi translated">平滑方法</h1><p id="6a62" class="pw-post-body-paragraph jn jo iq jp b jq lk js jt ju ll jw jx jy lm ka kb kc ln ke kf kg lo ki kj kk ij bi translated">平滑方法作为加权平均值工作。预测是过去观察的加权平均值。权重可以是统一的(这是一个移动平均值)，或者遵循指数衰减-这意味着给予最近的观察更多的权重，给予旧的观察更少的权重。更高级的方法包括预测中的其他部分，如季节性成分和趋势成分。</p><p id="f498" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们将使用数学方程的分量形式。<em class="kl"> y </em>表示我们的时间序列，<em class="kl"> p </em>表示我们的预测，<em class="kl"> l </em>表示水平，<em class="kl"> s </em>表示季节性成分，<em class="kl"> b </em>表示趋势成分</p><h2 id="2c75" class="np kn iq bd ko nq nr dn ks ns nt dp kw jy nu nv la kc nw nx le kg ny nz li oa bi translated">简单指数平滑</h2><p id="d8d5" class="pw-post-body-paragraph jn jo iq jp b jq lk js jt ju ll jw jx jy lm ka kb kc ln ke kf kg lo ki kj kk ij bi translated"><em class="kl"> &gt;什么时候使用？</em> <br/>数据点少，数据无规律，无季节性或趋势性。</p><p id="f089" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="kl"> &gt;数学背后<br/> </em>只要记住 SES 只有一个组件叫做<em class="kl"> level </em>(下面用“alpha”表示平滑参数)<em class="kl">。</em>是前一级和当前观测值的加权平均值:</p><figure class="lw lx ly lz gt mb gh gi paragraph-image"><div class="gh gi ov"><img src="../Images/b1edfd6a952eea27fd2ac2711cee151e.png" data-original-src="https://miro.medium.com/v2/resize:fit:502/format:webp/1*oVKkecdhS3XGCsCVDhS2RQ.png"/></div></figure><h2 id="2211" class="np kn iq bd ko nq nr dn ks ns nt dp kw jy nu nv la kc nw nx le kg ny nz li oa bi translated"><strong class="ak">霍尔特线性平滑</strong></h2><p id="e9d2" class="pw-post-body-paragraph jn jo iq jp b jq lk js jt ju ll jw jx jy lm ka kb kc ln ke kf kg lo ki kj kk ij bi translated"><em class="kl"> &gt;什么时候使用？<br/> </em>数据中的趋势，无季节性。</p><p id="1740" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="kl">数学背后<br/> </em>预测由一个<em class="kl">水平</em>分量和一个<em class="kl">趋势</em>分量组成。：</p><figure class="lw lx ly lz gt mb gh gi paragraph-image"><div class="gh gi ow"><img src="../Images/e17a44c395693996e76b0e1cedc109f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1222/format:webp/1*QGUWw1aDdchmEfsI4Bveew.png"/></div></figure><figure class="lw lx ly lz gt mb"><div class="bz fp l di"><div class="oe of l"/></div></figure><figure class="lw lx ly lz gt mb gh gi paragraph-image"><div role="button" tabindex="0" class="mh mi di mj bf mk"><div class="gh gi ox"><img src="../Images/b6eed89428b39a899a950db3e514e806.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JNl9a5clla8c-rnnkW-_dw.png"/></div></div></figure><h2 id="ebac" class="np kn iq bd ko nq nr dn ks ns nt dp kw jy nu nv la kc nw nx le kg ny nz li oa bi translated">霍尔特阻尼趋势</h2><p id="4100" class="pw-post-body-paragraph jn jo iq jp b jq lk js jt ju ll jw jx jy lm ka kb kc ln ke kf kg lo ki kj kk ij bi translated">霍尔特的线性趋势法的问题是，趋势在未来是恒定的，无限增加或减少。对于长期预测来说，这可能是个问题。因此，阻尼趋势法是一种添加阻尼参数的方法，以便趋势在未来收敛到恒定值(它使趋势变平)。参数𝑏由𝜙𝑏代替</p><p id="771e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="kl"> &gt;什么时候使用？</em> <br/>数据有趋势。使用乘法版本，除非之前已经记录了数据。在这种情况下，使用附加版本</p><figure class="lw lx ly lz gt mb"><div class="bz fp l di"><div class="oe of l"/></div></figure><figure class="lw lx ly lz gt mb gh gi paragraph-image"><div role="button" tabindex="0" class="mh mi di mj bf mk"><div class="gh gi oy"><img src="../Images/81231b648bb560832cb9b950cb2d20d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9qJcmvji3Y2pCktS39GVwg.png"/></div></div><figcaption class="mo mp gj gh gi mq mr bd b be z dk">Notice how the green curve flattens at the end of the forecast</figcaption></figure><h2 id="1470" class="np kn iq bd ko nq nr dn ks ns nt dp kw jy nu nv la kc nw nx le kg ny nz li oa bi translated">霍尔特-温特季节平滑法</h2><p id="2161" class="pw-post-body-paragraph jn jo iq jp b jq lk js jt ju ll jw jx jy lm ka kb kc ln ke kf kg lo ki kj kk ij bi translated">这将在下一篇文章的<a class="ae lp" href="https://medium.com/@benjamin_47408/time-series-in-python-part-2-dealing-with-seasonal-data-397a65b74051" rel="noopener">中讨论。但你要知道，这种方法就像霍尔特的线性平滑，除了我们增加了一个季节的成分！</a></p></div><div class="ab cl oj ok hu ol" role="separator"><span class="om bw bk on oo op"/><span class="om bw bk on oo op"/><span class="om bw bk on oo"/></div><div class="ij ik il im in"><h1 id="41d0" class="km kn iq bd ko kp oq kr ks kt or kv kw kx os kz la lb ot ld le lf ou lh li lj bi translated">ARIMA</h1><p id="a808" class="pw-post-body-paragraph jn jo iq jp b jq lk js jt ju ll jw jx jy lm ka kb kc ln ke kf kg lo ki kj kk ij bi translated">ARIMA 模型(包括 ARMA、AR 和 MA 模型)是预测<strong class="jp ir">平稳</strong>时间序列的一类通用模型。ARIMA 模型由三部分组成:</p><ul class=""><li id="ad71" class="na nb iq jp b jq jr ju jv jy nc kc nd kg ne kk nf ng nh ni bi translated">序列(<strong class="jp ir"><em class="kl"/></strong>(<strong class="jp ir"><em class="kl">AR</em></strong>)部分)的滞后<strong class="jp ir"> <em class="kl">值</em> </strong>的加权和</li><li id="d9a8" class="na nb iq jp b jq nj ju nk jy nl kc nm kg nn kk nf ng nh ni bi translated">序列(<strong class="jp ir"><em class="kl"/></strong>(<strong class="jp ir"><em class="kl">)MA</em></strong>)的滞后<strong class="jp ir"> <em class="kl">预测误差</em> </strong>的加权和</li><li id="83a6" class="na nb iq jp b jq nj ju nk jy nl kc nm kg nn kk nf ng nh ni bi translated">一个<strong class="jp ir"> <em class="kl">差</em> </strong>的时间序列(<strong class="jp ir"><em class="kl"/></strong>(<strong class="jp ir"><em class="kl">I</em></strong>)部分)</li></ul><p id="08b8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">一个 ARIMA 模型通常被标注为<strong class="jp ir">【p，d，q】</strong>其中<strong class="jp ir"> <em class="kl"> p </em> </strong>表示<strong class="jp ir"> <em class="kl"> AR </em> </strong>部分、<strong class="jp ir"> <em class="kl"> d </em> </strong>差分的顺序(<strong class="jp ir">I</strong>部分)，而 q 表示<strong class="jp ir"> <em class="kl"> MA </em> </strong>项的顺序。</p><h2 id="ebba" class="np kn iq bd ko nq nr dn ks ns nt dp kw jy nu nv la kc nw nx le kg ny nz li oa bi translated">1)选择差分阶数</h2><p id="5222" class="pw-post-body-paragraph jn jo iq jp b jq lk js jt ju ll jw jx jy lm ka kb kc ln ke kf kg lo ki kj kk ij bi translated">拟合 ARIMA 模型的第一步是确定差分阶数以平稳化序列。为此，我们来看看 ACF 和 PACF 图，并记住这两条规则:</p><blockquote class="lq lr ls"><p id="5378" class="jn jo kl jp b jq jr js jt ju jv jw jx lt jz ka kb lu kd ke kf lv kh ki kj kk ij bi translated">”—规则 1:如果序列对大量滞后具有正自相关，那么它可能需要更高阶的差分。<br/> —规则 2:如果 lag-1 自相关为零或负值，或者自相关都很小且无模式，则序列不需要高阶差分。如果滞后-1 自相关为-0.5 或更负，则该系列可能有过度差异。<strong class="jp ir"><br/>(</strong><a class="ae lp" href="http://www.fuqua.duke.edu/faculty_research/faculty_directory/nau/" rel="noopener ugc nofollow" target="_blank">罗伯特·诺</a>，统计预测)</p></blockquote><p id="153f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们从记录数据开始，因为原始数据呈现指数趋势:</p><figure class="lw lx ly lz gt mb"><div class="bz fp l di"><div class="oe of l"/></div></figure><figure class="lw lx ly lz gt mb gh gi paragraph-image"><div role="button" tabindex="0" class="mh mi di mj bf mk"><div class="gh gi oz"><img src="../Images/6731baa7372d46a3d886755bf85c05c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*luC4HUObtXk0dr7A9sKYVg.png"/></div></div></figure><p id="fd39" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">记录的序列似乎更平坦，但它是平稳的吗？让我们计算一个 KPSS 测试来检验这一点:</p><figure class="lw lx ly lz gt mb"><div class="bz fp l di"><div class="oe of l"/></div></figure><figure class="lw lx ly lz gt mb gh gi paragraph-image"><div class="gh gi pa"><img src="../Images/fa4f1ba94afb5f231f643027233d78e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1100/format:webp/1*V-YCwPUpuEUIWKs3PVV7Og.png"/></div></figure><p id="1300" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">检验统计量高于临界值，我们拒绝零假设，我们的序列是<em class="kl">而不是</em>趋势平稳的。然而，为了使这篇文章简短，我们将继续好像它是。</p><p id="9fcb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">(—为了得到一个趋势稳定的序列，我们可以考虑线性回归我们的对数序列，并用回归系数除我们的序列...— )</p><p id="94c8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在让我们来看看记录的一阶差分数据的 ACF 图:</p><figure class="lw lx ly lz gt mb gh gi paragraph-image"><div role="button" tabindex="0" class="mh mi di mj bf mk"><div class="gh gi pb"><img src="../Images/e137736650887fe610a7c56f1696bb5d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MLIjPTMtWjuoI8kFclSs4w.png"/></div></div></figure><p id="46bf" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">“ACF —记录的数据”图表显示了非平稳数据，其特征是峰值缓慢线性衰减(参见上述规则 1)。添加一阶差会在滞后值 1 处产生单个负尖峰。根据规则 2，我们不需要进一步区分这个系列。让我们通过比较(0，0，0)和(0，1，0) ARIMA 模型来检查我们的结果:</p><figure class="lw lx ly lz gt mb"><div class="bz fp l di"><div class="oe of l"/></div></figure><div class="lw lx ly lz gt ab cb"><figure class="ma mb pc md me mf mg paragraph-image"><div role="button" tabindex="0" class="mh mi di mj bf mk"><img src="../Images/ff7714e75c265ed1659a5e29cb8116a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:978/format:webp/1*DiSfU5vrhO7aS3b7QkcJCQ.png"/></div></figure><figure class="ma mb pd md me mf mg paragraph-image"><div role="button" tabindex="0" class="mh mi di mj bf mk"><img src="../Images/e8e48b607497a1fa208ffc102cd6eced.png" data-original-src="https://miro.medium.com/v2/resize:fit:1024/format:webp/1*PdFWtB00k_iUfIHJWmo9Jw.png"/></div></figure></div><p id="17f2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ARIMA(0，1，0)的阿凯克信息标准(AIC)较低，这意味着该模型的表现优于 ARIMA(0，0，0)。让我们看看残差并检查它们的方差:</p><figure class="lw lx ly lz gt mb gh gi paragraph-image"><div role="button" tabindex="0" class="mh mi di mj bf mk"><div class="gh gi pe"><img src="../Images/a206735edc4695a672241c4c7e851126.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OdM1gyoTZKc6koTKsELQQw.png"/></div></div><figcaption class="mo mp gj gh gi mq mr bd b be z dk">Which residuals do you think look better ?</figcaption></figure><h2 id="b150" class="np kn iq bd ko nq nr dn ks ns nt dp kw jy nu nv la kc nw nx le kg ny nz li oa bi translated">2)选择移动授权订单</h2><p id="5f88" class="pw-post-body-paragraph jn jo iq jp b jq lk js jt ju ll jw jx jy lm ka kb kc ln ke kf kg lo ki kj kk ij bi translated">现在我们知道我们必须在模型中包含一阶差分，我们需要选择移动平均阶。这是通过查看差分序列来完成的(因为我们刚刚看到一阶差分序列是平稳的)。同样，我们看看我们的 ACF 和 PACF 图，记住这条规则:</p><blockquote class="lq lr ls"><p id="7b55" class="jn jo kl jp b jq jr js jt ju jv jw jx lt jz ka kb lu kd ke kf lv kh ki kj kk ij bi translated">“如果差分序列<strong class="jp ir"> ACF </strong>的滞后-1 自相关为负，和/或存在锐截止，则选择顺序为 1 的<strong class="jp ir"> MA </strong>”。</p></blockquote><p id="5a91" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">问:为什么选择 1 阶而不是更高阶的移动授权？因为我们会一步一步来。如果我们在更高的滞后下观察自相关，并且通过查看我们的(1，1，0)模型的自相关残差，我们仍然观察到这些尖峰，我们可以增加我们的 MA 阶数，尽管通常不建议超过 2！</p><div class="lw lx ly lz gt ab cb"><figure class="ma mb pf md me mf mg paragraph-image"><div role="button" tabindex="0" class="mh mi di mj bf mk"><img src="../Images/ceb4bad4cb1594c297c9da39a9fa44cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1152/format:webp/1*PdFWtB00k_iUfIHJWmo9Jw.png"/></div></figure><figure class="ma mb pg md me mf mg paragraph-image"><div role="button" tabindex="0" class="mh mi di mj bf mk"><img src="../Images/2a9ab6ca783c8e85266cbf0079201e96.png" data-original-src="https://miro.medium.com/v2/resize:fit:850/format:webp/1*4iv5gtYGalArxDWgHOZvmQ.png"/></div></figure></div><figure class="lw lx ly lz gt mb gh gi paragraph-image"><div role="button" tabindex="0" class="mh mi di mj bf mk"><div class="gh gi ph"><img src="../Images/b05b04ee0d56fa7b409aa133aca4170e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8aCU2mlnP88_bxwCjGas1g.png"/></div></div></figure><p id="87d8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">注意 AIC 是如何再次下降的，残差方差是如何减小的。这表明我们的(1，1，0) ARIMA 比(0，1，0)模型表现得更好！</p><h2 id="be97" class="np kn iq bd ko nq nr dn ks ns nt dp kw jy nu nv la kc nw nx le kg ny nz li oa bi translated">3)选择应收账款订单</h2><p id="b74f" class="pw-post-body-paragraph jn jo iq jp b jq lk js jt ju ll jw jx jy lm ka kb kc ln ke kf kg lo ki kj kk ij bi translated">现在你可能会想:我们有必要添加一个 AR 术语吗？答案是否定的。事实上，在以下情况下，您应该添加一个 AR 术语:</p><blockquote class="lq lr ls"><p id="c02c" class="jn jo kl jp b jq jr js jt ju jv jw jx lt jz ka kb lu kd ke kf lv kh ki kj kk ij bi translated">如果差分序列<strong class="jp ir"> PACF </strong>的滞后-1 自相关为负，和/或有一个锐截止，那么选择一个为 1 的<strong class="jp ir"> AR </strong>阶。</p></blockquote><p id="0d1f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在我们的例子中，我们在 ACF 和 PACF 中都观察到负的滞后-1 自相关。请注意，差分序列的 PACF 在滞后 1 和滞后 2 处显示了两个负峰值，这意味着理论上我们可以将 AR 阶数提高到 2。</p><figure class="lw lx ly lz gt mb gh gi paragraph-image"><div role="button" tabindex="0" class="mh mi di mj bf mk"><div class="gh gi pb"><img src="../Images/e137736650887fe610a7c56f1696bb5d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MLIjPTMtWjuoI8kFclSs4w.png"/></div></div></figure><p id="6570" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这是我们通过拟合(1，1，1) ARIMA 得到的结果:</p><div class="lw lx ly lz gt ab cb"><figure class="ma mb pi md me mf mg paragraph-image"><div role="button" tabindex="0" class="mh mi di mj bf mk"><img src="../Images/f676e0b1272cef1d6576a9c23c3fe14c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1060/format:webp/1*4iv5gtYGalArxDWgHOZvmQ.png"/></div></figure><figure class="ma mb pj md me mf mg paragraph-image"><div role="button" tabindex="0" class="mh mi di mj bf mk"><img src="../Images/2f5ec4143311aa1689d41aa5b91d2165.png" data-original-src="https://miro.medium.com/v2/resize:fit:942/format:webp/1*w2YYQ53koQD0V88SBtgF-g.png"/></div></figure></div><p id="40fe" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">添加 AR 项降低了 AIC，方差从 0.155 降到了 0.145，我们做得很好！我们应该增加一个 AR 项并选择一个(2，1，1) ARIMA 吗？让我们来看看 ARIMA(1，1，1)残差的 ACF &amp; PACF:</p><figure class="lw lx ly lz gt mb gh gi paragraph-image"><div role="button" tabindex="0" class="mh mi di mj bf mk"><div class="gh gi pk"><img src="../Images/67ce9277eb10c48786d34949c1187676.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*okLQmsUscXVNQKk1S1NJMQ.png"/></div></div></figure><p id="85cd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">图中没有显著的自相关滞后值，我们的模型似乎不需要任何额外的 AR 项。你可能会指出第 12 阶段的峰值:这可能是季节性的迹象。我们将在<a class="ae lp" href="https://medium.com/@benjamin_47408/time-series-in-python-part-2-dealing-with-seasonal-data-397a65b74051" rel="noopener">的下一部分</a>中与萨里玛和萨里马克斯一起探讨这个问题。</p><h1 id="f5d7" class="km kn iq bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bi translated">绘制预测</h1><p id="a389" class="pw-post-body-paragraph jn jo iq jp b jq lk js jt ju ll jw jx jy lm ka kb kc ln ke kf kg lo ki kj kk ij bi translated">幸运的是，statsmodels 有一个很好的 API，允许我们从 ARIMA 过程中绘制预测。我强烈建议您将数据放在带有 DateTimeIndex 的 DataFrame 中，因为<em class="kl"> plot_predict() </em>方法确实喜欢日期… <br/>在这种情况下，我们将选择 12 个预测步骤，并将 dynamic 关键字设置为 True:这将强制算法使用其自己的预测值作为未来预测的滞后值:</p><figure class="lw lx ly lz gt mb"><div class="bz fp l di"><div class="oe of l"/></div></figure><figure class="lw lx ly lz gt mb gh gi paragraph-image"><div role="button" tabindex="0" class="mh mi di mj bf mk"><div class="gh gi pl"><img src="../Images/277991e5f9b4b8d2cb08bce08f4bed6a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tHXsJflbXnV26NwiX2G0DA.png"/></div></div></figure><p id="b060" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们看看更大的预测窗口(34 个预测步骤):</p><figure class="lw lx ly lz gt mb gh gi paragraph-image"><div role="button" tabindex="0" class="mh mi di mj bf mk"><div class="gh gi pm"><img src="../Images/58c3dcc7bde104ee20e4867f04805573.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5YxhuY9nGqiXdRIvMfXUEw.png"/></div></div></figure><p id="67e9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">那都是乡亲们！在下一部分的<a class="ae lp" href="https://medium.com/@benjamin_47408/time-series-in-python-part-2-dealing-with-seasonal-data-397a65b74051" rel="noopener">中，我将讨论季节性 Holt-Winter 和季节性 ARIMA。希望你喜欢:)</a></p><p id="d15b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">附加讲座</strong>:</p><p id="4ff1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果你对时间序列预测和分析感兴趣，我强烈推荐下面两个:</p><ul class=""><li id="9d9e" class="na nb iq jp b jq jr ju jv jy nc kc nd kg ne kk nf ng nh ni bi translated"><a class="ae lp" href="https://otexts.com/fpp2/" rel="noopener ugc nofollow" target="_blank"> <em class="kl">预测、原理与实践</em></a><em class="kl">(Hyndman&amp;Athanasopoulos)</em></li><li id="68e2" class="na nb iq jp b jq nj ju nk jy nl kc nm kg nn kk nf ng nh ni bi translated"><a class="ae lp" href="https://people.duke.edu/~rnau/411home.htm" rel="noopener ugc nofollow" target="_blank"><em class="kl"/></a><em class="kl">【罗伯特·诺】</em></li></ul><p id="3457" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> <em class="kl">你也可以查:</em> </strong></p><ul class=""><li id="c0fb" class="na nb iq jp b jq jr ju jv jy nc kc nd kg ne kk nf ng nh ni bi translated"><a class="ae lp" href="https://medium.com/@benjamin_47408/neural-turing-machines-an-artificial-working-memory-cd913420508b" rel="noopener"> <strong class="jp ir"> <em class="kl">本条</em> </strong> </a> <strong class="jp ir"> <em class="kl">关于神经图灵机</em> </strong></li><li id="f480" class="na nb iq jp b jq nj ju nk jy nl kc nm kg nn kk nf ng nh ni bi translated"><a class="ae lp" href="https://medium.com/@benjamin_47408/attention-seq2seq-with-pytorch-learning-to-invert-a-sequence-34faf4133e53" rel="noopener"> <strong class="jp ir"> <em class="kl">本文</em> </strong> </a> <strong class="jp ir"> <em class="kl">关于基于注意力的神经网络</em> </strong></li></ul><p id="6a60" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> <em class="kl">如果你想知道 2019 年哪支球队真的是最好的 NBA 球队，请查看</em> </strong> <a class="ae lp" rel="noopener" target="_blank" href="/bayesian-basketball-were-the-toronto-raptors-really-the-best-team-during-nba-2019-season-e524a26b43a1"> <strong class="jp ir"> <em class="kl">这篇文章</em> </strong> </a> <strong class="jp ir"> <em class="kl">！</em> </strong></p></div></div>    
</body>
</html>