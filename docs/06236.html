<html>
<head>
<title>How To Create a Plotly Visualization And Embed It On Websites</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何创建一个 Plotly 可视化，并将其嵌入网站</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-create-a-plotly-visualization-and-embed-it-on-websites-517c1a78568b?source=collection_archive---------3-----------------------#2019-09-09">https://towardsdatascience.com/how-to-create-a-plotly-visualization-and-embed-it-on-websites-517c1a78568b?source=collection_archive---------3-----------------------#2019-09-09</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/3bc336dac98072971f65bc28a2191bac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*suY3Y7kIAV_7xKox9AL3fw.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk">Examples from Plot.ly</figcaption></figure><p id="6b55" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">Plotly 是一个开源的、易于使用的 python 图表库。Plotly.express 是作为 Plotly.py 的包装器构建的，使创建交互式可视化像编写一行 python ✨一样简单</p><blockquote class="le lf lg"><p id="bcff" class="kf kg lh kh b ki kj kk kl km kn ko kp li kr ks kt lj kv kw kx lk kz la lb lc im bi translated"><code class="fe ll lm ln lo b">plotly.express</code>之于<code class="fe ll lm ln lo b">plotly</code>就像<code class="fe ll lm ln lo b">seaborn</code>之于<code class="fe ll lm ln lo b">matplotlib</code></p></blockquote><p id="3e7f" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">有很多很酷的交互式可视化可以用 Plotly Express 创建——就像这个使用 Airbnb 数据集的可视化:</p><figure class="lq lr ls lt gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi lp"><img src="../Images/25beacea23a9b63c62ace569ccdbfc67.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*6gli08CJ_LwHQJVY0w976A.gif"/></div></div></figure><p id="06ab" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">使用<a class="ae ld" href="https://medium.com/plotly/plotly-py-4-0-is-here-offline-only-express-first-displayable-anywhere-fc444e5659ee" rel="noopener"> Plotly express </a>创建的交互式可视化可以在大多数笔记本和 IDE 上渲染和显示。将它们嵌入其他地方则是另一回事。如果你在嵌入你的交互式可视化图形时遇到了麻烦，那你就来对地方了！</p><p id="e71b" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">在本文中，我将介绍如何使用 plotly express 创建一个基本的交互式可视化，并生成 iframe 嵌入代码以在任何网站上显示它。</p><p id="7442" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">步骤如下:</p><ul class=""><li id="1683" class="lu lv it kh b ki kj km kn kq lw ku lx ky ly lc lz ma mb mc bi translated">创建情节可视化</li><li id="8a9e" class="lu lv it kh b ki md km me kq mf ku mg ky mh lc lz ma mb mc bi translated">主机可视化(在 plotly 或 github 页面上)</li><li id="1998" class="lu lv it kh b ki md km me kq mf ku mg ky mh lc lz ma mb mc bi translated">获取 iframe 嵌入代码</li></ul><h1 id="f5bb" class="mi mj it bd mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf bi translated">创建一个情节可视化</h1><p id="c87d" class="pw-post-body-paragraph kf kg it kh b ki ng kk kl km nh ko kp kq ni ks kt ku nj kw kx ky nk la lb lc im bi translated">如果您还没有，使用<code class="fe ll lm ln lo b">!pip install plotly</code>将 plotly 安装到您的环境中，并使用<code class="fe ll lm ln lo b">import plotly.express as px</code>导入 plotly。</p><p id="a2fd" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">运行以下代码创建一个基本的可视化:</p><pre class="lq lr ls lt gt nl lo nm nn aw no bi"><span id="f027" class="np mj it lo b gy nq nr l ns nt">gapminder = px.data.gapminder()<br/>fig = px.scatter(gapminder.query("year==2007"), x="gdpPercap", y="lifeExp", size="pop", color="continent",<br/>           hover_name="country", log_x=True, size_max=60)</span><span id="3eaf" class="np mj it lo b gy nu nr l ns nt">fig.show()</span></pre><p id="060b" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">下图应该会出现在您的笔记本中:</p><figure class="lq lr ls lt gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nv"><img src="../Images/6323fa8617b308c1120e9ba0c354a293.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*s2wWe1K5uH-UEc1axS502Q.png"/></div></div></figure><p id="349a" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">现在你有了一个交互式可视化工具…让我们把它放在某个地方吧！</p><h1 id="a0eb" class="mi mj it bd mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf bi translated">上传可视化到 Plotly</h1><p id="aa1f" class="pw-post-body-paragraph kf kg it kh b ki ng kk kl km nh ko kp kq ni ks kt ku nj kw kx ky nk la lb lc im bi translated">如果你的数据集足够小，你就可以免费将你的可视化上传到 plotly，如果不够小，当你尝试下面的部分时，它会给你一个错误。我将在下一节解释如果遇到错误如何解决。</p><p id="6796" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">要将可视化上传到您的 plotly 帐户，请使用<code class="fe ll lm ln lo b">!pip install chart_studio</code>安装 chart studio，然后使用<code class="fe ll lm ln lo b">import chart_studio</code>将其导入。</p><p id="b1d4" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">您将需要您的用户名和 api 密钥从您的 plotly 帐户连接到它从您的笔记本电脑。要获取您的 api 密钥，只需点击您的个人资料右上角的用户名，然后点击设置，然后重新生成一个新的 api 密钥。现在，您可以设置您的凭据:</p><pre class="lq lr ls lt gt nl lo nm nn aw no bi"><span id="88a3" class="np mj it lo b gy nq nr l ns nt">username = '' # your username<br/>api_key = '' # your api key - go to profile &gt; settings &gt; regenerate key</span><span id="be61" class="np mj it lo b gy nu nr l ns nt">chart_studio.tools.set_credentials_file(username=username, api_key=api_key)</span></pre><p id="da30" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">使用以下代码行将您的可视化应用到您的帐户中:</p><pre class="lq lr ls lt gt nl lo nm nn aw no bi"><span id="bfa4" class="np mj it lo b gy nq nr l ns nt">import chart_studio.plotly as py<br/>py.plot(fig, filename = 'gdp_per_cap', auto_open=True)</span></pre><p id="6efc" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">如果操作正确，这段代码应该会在你的帐户上打开一个新的可视化窗口，并返回你的笔记本中的链接。您可以使用相同的链接，然后在支持 embed.ly 嵌入的网站上嵌入，如 Medium。注意:当你在 Medium 上写文章的时候，你的可视化效果不会是交互式的，但是一旦你发布了它，它就会起作用。</p><p id="25dc" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">这是我们创建的交互式可视化，我只需粘贴链接就可以嵌入到 Medium 中…很简单。</p><figure class="lq lr ls lt gt ju"><div class="bz fp l di"><div class="nw nx l"/></div></figure><p id="3e05" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">如果把你的可视化上传到 plotly 对你有用，那太好了。您可以跳到下一节，我将向您展示如何生成 iframe 嵌入代码。</p><h1 id="0bb0" class="mi mj it bd mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf bi translated">为绘图可视化生成 HTML</h1><p id="44ac" class="pw-post-body-paragraph kf kg it kh b ki ng kk kl km nh ko kp kq ni ks kt ku nj kw kx ky nk la lb lc im bi translated">当您正在处理的数据集太大时，您将从 plotly 获得一个错误，即您无法上传可视化，除非您升级您的帐户。因此，为了解决这个问题，我们将把我们的可视化图形写成 HTML。</p><p id="ec1e" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">首先，让我们创建一个大型数据集的可视化。我将使用 Airbnb 的数据，这些数据可以在这个<a class="ae ld" href="https://github.com/elizabethts/publish-plotly-website" rel="noopener ugc nofollow" target="_blank"> github repo </a>中找到。如果您想继续学习，可以下载 csv。</p><p id="1272" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">下面是创建我将使用的数据帧的代码:</p><figure class="lq lr ls lt gt ju"><div class="bz fp l di"><div class="ny nx l"/></div></figure><p id="5299" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">下面是创建可视化的代码:</p><pre class="lq lr ls lt gt nl lo nm nn aw no bi"><span id="349d" class="np mj it lo b gy nq nr l ns nt">fig = px.scatter(df, x='Neighborhood', y='Price (US Dollars)'<br/>                 ,size='Accommodates'<br/>                 , hover_data=['Bedrooms', 'Wifi', 'Cable TV', 'Kitchen', 'Washer', 'Number of Reviews']<br/>                 ,color= 'Room Type')</span><span id="7365" class="np mj it lo b gy nu nr l ns nt">fig.update_layout(template='plotly_white')<br/>fig.update_layout(title='How much should you charge in a Berlin neighborhood?')</span><span id="4bec" class="np mj it lo b gy nu nr l ns nt">fig.show()</span></pre><p id="f485" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">输出将如下所示:</p><figure class="lq lr ls lt gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nz"><img src="../Images/ccd07d2084b381fd8e6d2d73b58e2534.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*aNOmtiCKyk9T1SJZFtupfw.gif"/></div></div></figure><p id="57e1" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">现在，如果您尝试使用<code class="fe ll lm ln lo b">py.plot(fig, filename='airbnb', auto_open=True)</code>将它上传到您的 plotly 帐户，您将会看到以下错误:</p><pre class="lq lr ls lt gt nl lo nm nn aw no bi"><span id="cba8" class="np mj it lo b gy nq nr l ns nt">PlotlyRequestError: This file is too big! Your current subscription is limited to 524.288 KB uploads. For more information, please visit: <a class="ae ld" href="https://go.plot.ly/get-pricing." rel="noopener ugc nofollow" target="_blank">https://go.plot.ly/get-pricing.</a></span></pre><p id="f519" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">因此，我们将把我们的可视化结果写成 HTML，并放在 github 页面上。</p><h2 id="0465" class="np mj it bd mk oa ob dn mo oc od dp ms kq oe of mw ku og oh na ky oi oj ne ok bi translated">创建 HTML</h2><p id="6c73" class="pw-post-body-paragraph kf kg it kh b ki ng kk kl km nh ko kp kq ni ks kt ku nj kw kx ky nk la lb lc im bi translated">要为 plotly 可视化生成 HTML 文件，请使用:</p><pre class="lq lr ls lt gt nl lo nm nn aw no bi"><span id="b2ad" class="np mj it lo b gy nq nr l ns nt">import plotly.io as pio<br/>pio.write_html(fig, file=’index.html’, auto_open=True)</span></pre><p id="b324" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">如果操作正确，这段代码将在您的浏览器中打开本地 HTML 文件，您应该会看到可视化效果。</p><h2 id="2260" class="np mj it bd mk oa ob dn mo oc od dp ms kq oe of mw ku og oh na ky oi oj ne ok bi translated">GitHub 页面的宿主</h2><p id="ffc1" class="pw-post-body-paragraph kf kg it kh b ki ng kk kl km nh ko kp kq ni ks kt ku nj kw kx ky nk la lb lc im bi translated">发布到 github 页面非常简单。你可以按照 github <a class="ae ld" href="https://pages.github.com" rel="noopener ugc nofollow" target="_blank">这里</a>的说明或者按照我的简要概述来做。</p><p id="b8c8" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">创建一个新的 github repo 并用 README.md 初始化。上传我们刚刚创建的 index.html 文件，并将其提交到主分支。现在，点击设置，向下滚动到 github 页面部分，在“源”下选择“主分支”。</p><figure class="lq lr ls lt gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi ol"><img src="../Images/fbce3842ac707c4dc308c224dbc9ad34.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FpYl0PjXSjX72OAaJWO6Hw.png"/></div></div></figure><p id="06ce" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">现在你应该可以使用这个链接结构<a class="ae ld" href="http://username.github.io/repository" rel="noopener ugc nofollow" target="_blank"><em class="lh"/></a>来查看你的可视化效果了</p><p id="f1db" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">我刚刚做的那个可以在这里找到<a class="ae ld" href="https://elizabethts.github.io/publish-plotly-website/" rel="noopener ugc nofollow" target="_blank">https://elizabethts.github.io/publish-plotly-website/</a>。</p><h1 id="e2e8" class="mi mj it bd mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf bi translated">用 iframe 嵌入 Plotly 可视化</h1><p id="bf7d" class="pw-post-body-paragraph kf kg it kh b ki ng kk kl km nh ko kp kq ni ks kt ku nj kw kx ky nk la lb lc im bi translated">现在我们有了到我们的 plotly 可视化的链接(托管在 plotly 或 github 页面上),我们可以为可视化生成 iframe 代码。如果您能够将可视化上传到 plotly，则可以使用以下代码行生成 iframe 嵌入代码:</p><pre class="lq lr ls lt gt nl lo nm nn aw no bi"><span id="a6a9" class="np mj it lo b gy nq nr l ns nt">import chart_studio.tools as tls<br/>tls.get_embed('<a class="ae ld" href="https://plot.ly/~elizabethts/9/'" rel="noopener ugc nofollow" target="_blank">https://plot.ly/~elizabethts/9/'</a>) #change to your url</span></pre><p id="8565" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">这将为您提供输出:</p><pre class="lq lr ls lt gt nl lo nm nn aw no bi"><span id="75ec" class="np mj it lo b gy nq nr l ns nt">&lt;iframe id="igraph" scrolling="no" style="border:none;" seamless="seamless" src="https://plot.ly/~elizabethts/9.embed" height="525" width="100%"&gt;&lt;/iframe&gt;</span></pre><p id="e5a0" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">如果您走的是 github pages 路线，您需要自己修改上面的 iframe 代码。把 plotly 网址换成 github 网址就行了！</p><p id="7318" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">最后，您可以将这个 iframe 嵌入代码放到您的站点中，您的可视化效果将会出现！注意:如果使用 github 链接，可能需要修改高度和宽度。</p><p id="3f07" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">讽刺的是，据我所知，如果你的数据集太大，你不能在媒体上嵌入你的交互式可视化，你必须把它放在 github 上。为了解决这个问题，我强烈推荐使用<a class="ae ld" href="https://www.getcloudapp.com" rel="noopener ugc nofollow" target="_blank"> CloudApp </a>来筛选记录 gif，你可以轻松地将其拖放到你的中型文章中，这就是我在这篇文章中所做的。</p><p id="a576" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">现在，您可以创建一个交互式的 plotly 可视化，并生成 iframe 嵌入代码以在任何网站上显示它！</p><p id="02d2" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">在推特上找到我<a class="ae ld" href="https://twitter.com/elizabethets" rel="noopener ugc nofollow" target="_blank">@伊丽莎白</a>！</p><p id="4868" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">来源:</p><div class="om on gp gr oo op"><a href="https://plot.ly/python/" rel="noopener  ugc nofollow" target="_blank"><div class="oq ab fo"><div class="or ab os cl cj ot"><h2 class="bd iu gy z fp ou fr fs ov fu fw is bi translated">plotly</h2><div class="ow l"><h3 class="bd b gy z fp ou fr fs ov fu fw dk translated">Plotly 的 Python 图形库制作出交互式的、出版物质量的图形。如何制作线图的示例…</h3></div><div class="ox l"><p class="bd b dl z fp ou fr fs ov fu fw dk translated">plot.ly</p></div></div><div class="oy l"><div class="oz l pa pb pc oy pd jz op"/></div></div></a></div><div class="om on gp gr oo op"><a href="https://plot.ly/python/getting-started-with-chart-studio/" rel="noopener  ugc nofollow" target="_blank"><div class="oq ab fo"><div class="or ab os cl cj ot"><h2 class="bd iu gy z fp ou fr fs ov fu fw is bi translated">Python 的 Plotly 入门</h2><div class="ow l"><h3 class="bd b gy z fp ou fr fs ov fu fw dk translated">情节可以设置为三种不同类型隐私:公开、私人或秘密。公共:任何人都可以查看此图表。它…</h3></div><div class="ox l"><p class="bd b dl z fp ou fr fs ov fu fw dk translated">plot.ly</p></div></div><div class="oy l"><div class="pe l pa pb pc oy pd jz op"/></div></div></a></div><div class="om on gp gr oo op"><a href="https://medium.com/plotly/introducing-plotly-express-808df010143d" rel="noopener follow" target="_blank"><div class="oq ab fo"><div class="or ab os cl cj ot"><h2 class="bd iu gy z fp ou fr fs ov fu fw is bi translated">✨推出 Plotly 快递✨</h2><div class="ow l"><h3 class="bd b gy z fp ou fr fs ov fu fw dk translated">Plotly Express 是一个新的高级 Python 可视化库:它是 Plotly.py 的包装器，公开了一个简单的…</h3></div><div class="ox l"><p class="bd b dl z fp ou fr fs ov fu fw dk translated">medium.com</p></div></div><div class="oy l"><div class="pf l pa pb pc oy pd jz op"/></div></div></a></div><div class="om on gp gr oo op"><a href="https://plot.ly/python/embedding-plotly-graphs-in-HTML/" rel="noopener  ugc nofollow" target="_blank"><div class="oq ab fo"><div class="or ab os cl cj ot"><h2 class="bd iu gy z fp ou fr fs ov fu fw is bi translated">在 HTML 中嵌入图形</h2><div class="ow l"><h3 class="bd b gy z fp ou fr fs ov fu fw dk translated">Plotly 图形可以嵌入任何 HTML 页面。这包括 IPython 笔记本、Wordpress 网站、仪表盘、博客…</h3></div><div class="ox l"><p class="bd b dl z fp ou fr fs ov fu fw dk translated">plot.ly</p></div></div><div class="oy l"><div class="pg l pa pb pc oy pd jz op"/></div></div></a></div><div class="om on gp gr oo op"><a href="https://pages.github.com" rel="noopener  ugc nofollow" target="_blank"><div class="oq ab fo"><div class="or ab os cl cj ot"><h2 class="bd iu gy z fp ou fr fs ov fu fw is bi translated">GitHub 页面</h2><div class="ow l"><h3 class="bd b gy z fp ou fr fs ov fu fw dk translated">使用你最喜欢的文本编辑器，在你的项目中添加一个 index.html 文件:Hello World I hosted with GitHub Pages…</h3></div><div class="ox l"><p class="bd b dl z fp ou fr fs ov fu fw dk translated">pages.github.com</p></div></div><div class="oy l"><div class="ph l pa pb pc oy pd jz op"/></div></div></a></div></div></div>    
</body>
</html>