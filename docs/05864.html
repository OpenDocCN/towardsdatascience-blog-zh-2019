<html>
<head>
<title>Low-Rank Approximation For Flags</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">标志的低秩近似</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/low-rank-approximation-for-flags-316cb19f7aba?source=collection_archive---------25-----------------------#2019-08-26">https://towardsdatascience.com/low-rank-approximation-for-flags-316cb19f7aba?source=collection_archive---------25-----------------------#2019-08-26</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="6607" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">这个世界充满了低秩矩阵，我们可以对它们进行低秩近似。</h2></div></div><div class="ab cl kj kk hx kl" role="separator"><span class="km bw bk kn ko kp"/><span class="km bw bk kn ko kp"/><span class="km bw bk kn ko"/></div><div class="im in io ip iq"><p id="828b" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">这篇文章的灵感来自亚历克斯·汤森关于快速递减奇异值的精彩演讲，可以在<a class="ae lm" href="https://youtu.be/9BYsNpTCZGg" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="gh gi ln"><img src="../Images/e07cb1ded8b25d359c601825e05656a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*aZ69KRLBcJJzaakE"/></div></div><figcaption class="lz ma gj gh gi mb mc bd b be z dk">Photo by <a class="ae lm" href="https://unsplash.com/@farzadme?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Farzad Mohsenvand</a> on <a class="ae lm" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="21d6" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">在讲座中，汤森教授用不同国家的国旗作为低秩矩阵的例子。然而，没有关于低秩矩阵在多大程度上逼近原始标志的直观图示。</p><p id="d545" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">对于我们的分析，我们将从快速复习低秩近似的含义开始，然后将进行标志的实际分析。</p></div><div class="ab cl kj kk hx kl" role="separator"><span class="km bw bk kn ko kp"/><span class="km bw bk kn ko kp"/><span class="km bw bk kn ko"/></div><div class="im in io ip iq"><p id="b327" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">下面的分析我就用 R。近似的基本思想就是分解。我们把它分成小块，然后重新组装，但不包括小块。</p><p id="bd6b" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">假设我们有一个矩阵<strong class="ks iu"> A </strong>，分解矩阵的一个常用方法是使用所谓的奇异值分解。幸运的是，R 基为我们提供了这个函数。</p><pre class="lo lp lq lr gt md me mf mg aw mh bi"><span id="6cb5" class="mi mj it me b gy mk ml l mm mn">A = matrix(c(4,7,-1,8,-5,-2,4,2,-1,3,-3,6), nrow = 4)</span></pre><p id="639b" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">矩阵看起来会像这样:</p><pre class="lo lp lq lr gt md me mf mg aw mh bi"><span id="7ad1" class="mi mj it me b gy mk ml l mm mn">     [,1] [,2] [,3]<br/>[1,]    4   -5   -1<br/>[2,]    7   -2    3<br/>[3,]   -1    4   -3<br/>[4,]    8    2    6</span></pre><p id="4623" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">以下代码显示了奇异值分解的作用，即任何矩阵都可以写成一个正交矩阵、一个对角矩阵和另一个正交矩阵的乘积。</p><pre class="lo lp lq lr gt md me mf mg aw mh bi"><span id="103d" class="mi mj it me b gy mk ml l mm mn">A.svd &lt;- svd(A) # decompose A and save result to A.svd</span><span id="6e27" class="mi mj it me b gy mo ml l mm mn">A.svd$u %*% diag(A.svd$d) %*% t(A.svd$v) #this line will reproduce A</span></pre><p id="5c47" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">需要注意的一点是，上述关系可以改写为秩 1 矩阵的和。这构成了低秩近似的基础，我们将用 flags 来进一步研究它。下面的代码显示，我们可以用三个秩为 1 的矩阵的和来恢复矩阵。</p><pre class="lo lp lq lr gt md me mf mg aw mh bi"><span id="86ce" class="mi mj it me b gy mk ml l mm mn"># for cleaner code, extract three components<br/>u &lt;- A.svd$u<br/>v &lt;- A.svd$v<br/>d &lt;- A.svd$d</span><span id="b6c2" class="mi mj it me b gy mo ml l mm mn">A.restored &lt;- d[1]*u[, 1] %*% t(v[, 1]) + <br/>              d[2]*u[, 2] %*% t(v[, 2]) + <br/>              d[3]*u[, 3] %*% t(v[, 3])</span><span id="ca1c" class="mi mj it me b gy mo ml l mm mn">all.equal(A.restored, A) # proof that the we restore the matrix<br/>#&gt; TRUE</span></pre></div><div class="ab cl kj kk hx kl" role="separator"><span class="km bw bk kn ko kp"/><span class="km bw bk kn ko kp"/><span class="km bw bk kn ko"/></div><div class="im in io ip iq"><p id="7aab" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">现在，我们准备处理旗帜。我们接下来要做的与上面非常相似，除了我们将只保留几个组件。我们可以这样做的原因是，标志的秩正好高，但数值低，这意味着奇异值急剧下降(还记得上面提到的讲座标题吗？).</p><p id="cce9" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">我将使用下面的包进行分析(如果您想重现结果，只需保存我在这里使用的标志，但我猜任何标志都可以)。</p><pre class="lo lp lq lr gt md me mf mg aw mh bi"><span id="c605" class="mi mj it me b gy mk ml l mm mn">library(imager)<br/>library(purrr)<br/># library(ggplot2) --- for one plot only, omissible</span></pre><p id="aaec" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">有相当多的旗帜，显然是像法国的低排名。所以让我们从更有趣的东西开始:英国国旗。我找到的旗子是这样的:</p><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="gh gi mp"><img src="../Images/6ec6878f21868b93756fb79656f990e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*riQzTZsBs-yziLAyrec7Lg.jpeg"/></div></div></figure><p id="fea6" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">为了简单一点，我将使用这些标志的灰度版本。下面的代码显示了图像的加载和展平。</p><pre class="lo lp lq lr gt md me mf mg aw mh bi"><span id="b771" class="mi mj it me b gy mk ml l mm mn">brsh &lt;- load.image("./british-flag.jpg") #brsh denote British</span><span id="ee5e" class="mi mj it me b gy mo ml l mm mn">gry.brsh &lt;- as.array(brsh)[,,1,] %&gt;% apply(1:2, mean) <br/>gry.brsh %&gt;% as.cimg() %&gt;% plot</span></pre><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div class="gh gi mq"><img src="../Images/5fc7d110afa50953e73f1bcd3ea6d675.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IQa4TIMMGf2GF6x18UkGhA.jpeg"/></div></figure><p id="7e3f" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">接下来，我们将 SVD 应用于标志矩阵。我们也可以画出奇异值，以显示它们下降的速度。</p><pre class="lo lp lq lr gt md me mf mg aw mh bi"><span id="e2e8" class="mi mj it me b gy mk ml l mm mn">brsh.svd &lt;- svd(gry.brsh)</span><span id="b913" class="mi mj it me b gy mo ml l mm mn">ggplot2::quickplot(brsh.svd$d, ylab = "")</span></pre><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div class="gh gi mq"><img src="../Images/fcbbe20fdceacc3c0afc5ee975186d75.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MrIBdULD11ZHushkrs8Sjw.png"/></div></figure><p id="dd90" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">为了便于我们的分析，我们可以定义两个函数:一个用于组件提取，一个用于快速绘制那些恢复的标志(我在这里使用了‘purrr’包，如果需要，可以随意查看这里的<a class="ae lm" href="https://purrr.tidyverse.org/" rel="noopener ugc nofollow" target="_blank">文档</a>进行刷新)。</p><pre class="lo lp lq lr gt md me mf mg aw mh bi"><span id="2d70" class="mi mj it me b gy mk ml l mm mn"># extract first n component<br/>first_n_comp &lt;- function(n, .svd){<br/>  <br/>  u &lt;- .svd$u<br/>  d &lt;- .svd$d<br/>  v &lt;- .svd$v<br/>  <br/>  c(1:n) %&gt;% map( ~ d[.]*u[, .] %*% t(v[, .])) %&gt;% reduce(`+`)<br/>  <br/>}</span><span id="10bc" class="mi mj it me b gy mo ml l mm mn"># draw plot with only 1, 3, 5, 10 components respectively</span><span id="91e5" class="mi mj it me b gy mo ml l mm mn">draw_stepwise &lt;- function(.svd) {<br/>  <br/>  par(mfrow = c(2,2)) # set 2 x 2 layout<br/>  walk(c(1,3,5,10), ~ first_n_comp(., .svd) %&gt;% as.cimg() %&gt;% plot)<br/>}</span></pre><p id="8a1f" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">现在，让我们把这些应用到英国的国旗上。从下面我们可以看到，水平和垂直模式最容易恢复，而对角线模式最难恢复。</p><pre class="lo lp lq lr gt md me mf mg aw mh bi"><span id="78ad" class="mi mj it me b gy mk ml l mm mn">draw_stepwise(brsh.svd)</span></pre><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div class="gh gi mq"><img src="../Images/fb0330a48078d66ecb6f9eca5582f550.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eNJhuBZ9Ec1aeCVWtIjfrA.png"/></div></figure><p id="db12" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">接下来，我们来看看日本的国旗。下面是原文(确实有背景)。</p><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="gh gi mr"><img src="../Images/bb59bf461f851cff022ec1fb07475be4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YL8dig9VhORD1ke_wkGXxA.jpeg"/></div></div></figure><p id="9350" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">这是复原的照片:</p><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div class="gh gi mq"><img src="../Images/67758f065b54ba551c9c4efd5423f7d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3dYttXMuQ8zlQKcfvfjXPg.png"/></div></figure><p id="3735" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">最后但同样重要的是，让我们以美国的旗帜来结束这次分析。这是我发现的一个。</p><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="gh gi ms"><img src="../Images/26388a1d254595d3e641f8b445257de8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Rqd4Xn9emgh7nBtCud07Ug.png"/></div></div></figure><p id="194e" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">这些是我找到的:</p><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div class="gh gi mq"><img src="../Images/c25e7a07c3b135a94e41cccb558b6855.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pAEuIiiOLmpZntt2XmE3eQ.png"/></div></figure><p id="f18a" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">今天就到这里，下次见。</p></div></div>    
</body>
</html>