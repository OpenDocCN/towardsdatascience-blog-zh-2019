# åœ¨ Google Cloud ä¸Šéƒ¨ç½²åƒåœ¾é‚®ä»¶æ£€æµ‹å™¨çš„ç®€å•æŒ‡å—

> åŸæ–‡ï¼š<https://towardsdatascience.com/a-simple-guide-for-deploying-a-spam-detector-onto-google-cloud-ab1cd7163a21?source=collection_archive---------10----------------------->

## è°·æ­Œäº‘å¹³å°ï¼ŒFlaskï¼Œåˆ†ç±»åˆä¸€

![](img/de406c13bf47b6b10feb675f9d764aad.png)

Photo by [Samuel Zeller](https://unsplash.com/photos/G_xJrvHN9nk?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText) on [Unsplash](https://unsplash.com/search/photos/spam?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText)

ä½ å¥½ğŸ‘‹ï¼å—¯ï¼Œæœ‰å¾ˆå¤šå…³äºå»ºç«‹å„ç§ç”¨é€”çš„æœºå™¨å­¦ä¹ æ¨¡å‹çš„æŒ‡å—ï¼Œæˆ‘æœ€è¿‘çœ‹åˆ°äº†ä¸€ä¸ªå…³äºå»ºç«‹åƒåœ¾é‚®ä»¶æ£€æµ‹å™¨ç„¶åä½¿ç”¨ Flask éƒ¨ç½²å®ƒçš„æŒ‡å—ã€‚é€šè¿‡è¿™ä¸€ç‚¹ï¼Œæˆ‘å†³å®šé€šè¿‡éƒ¨ç½²åˆ°è°·æ­Œäº‘å¹³å°ä¸Šæ›´è¿›ä¸€æ­¥ï¼å½“ç„¶ï¼Œä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ Herokuï¼ŒAWS ç­‰ï¼Œä½†è¿™æ˜¯å¦ä¸€å¤©çš„å¦ä¸€ä¸ªä¸»é¢˜ï¼Œæˆ‘ç°åœ¨åªå…³æ³¨ GCPã€‚

## é¡¹ç›®çš„ç®€è¦èƒŒæ™¯

è¿™æ˜¯ä¸€ç§æœºå™¨å­¦ä¹ æ¨¡å‹ï¼Œé€šè¿‡å¯¹ç°æœ‰çš„æ ‡æœ‰â€œåƒåœ¾â€æˆ–â€œç«è…¿â€çš„çŸ­ä¿¡é›†åˆè¿›è¡Œè®­ç»ƒï¼Œå¯¹[åƒåœ¾çŸ­ä¿¡](https://github.com/georgeblu1/Spam-Detector-Web-App)è¿›è¡Œåˆ†ç±»ã€‚åƒåœ¾é‚®ä»¶æ£€æµ‹å™¨é‡‡ç”¨ scikit-learn çš„[å¤šé¡¹å¼æœ´ç´ è´å¶æ–¯](https://scikit-learn.org/stable/modules/naive_bayes.html)åˆ†ç±»å™¨ï¼Œè¯¥åˆ†ç±»å™¨åŸºäºæœ´ç´ è´å¶æ–¯ç®—æ³•ï¼Œç”¨äºå¤šé¡¹å¼åˆ†å¸ƒæ•°æ®:

> æœ´ç´ è´å¶æ–¯æ–¹æ³•æ˜¯ä¸€ç»„åŸºäºåº”ç”¨è´å¶æ–¯å®šç†çš„ç›‘ç£å­¦ä¹ ç®—æ³•ï¼Œå…¶â€œæœ´ç´ â€å‡è®¾æ˜¯åœ¨ç»™å®šç±»å˜é‡çš„å€¼çš„æƒ…å†µä¸‹ï¼Œæ¯å¯¹è¦ç´ ä¹‹é—´çš„æ¡ä»¶ç‹¬ç«‹æ€§ã€‚
> 
> ä¸æ›´å¤æ‚çš„æ–¹æ³•ç›¸æ¯”ï¼Œæœ´ç´ è´å¶æ–¯å­¦ä¹ å™¨å’Œåˆ†ç±»å™¨å¯ä»¥éå¸¸å¿«ã€‚ç±»åˆ«æ¡ä»¶ç‰¹å¾åˆ†å¸ƒçš„åˆ†ç¦»æ„å‘³ç€æ¯ä¸ªåˆ†å¸ƒå¯ä»¥è¢«ç‹¬ç«‹åœ°ä¼°è®¡ä¸ºä¸€ç»´åˆ†å¸ƒã€‚è¿™åè¿‡æ¥åˆæœ‰åŠ©äºç¼“è§£ç»´æ•°ç¾éš¾å¸¦æ¥çš„é—®é¢˜ã€‚

![](img/5c5a544bf30fc7d087d37e6ad0910eac.png)

Flask Logo

åŒæ—¶ï¼ŒFlask ä½œä¸º web æ¡†æ¶ï¼Œé€šè¿‡å‰ç«¯æ¥æ”¶ç”¨æˆ·çš„è¾“å…¥(HTTP è¯·æ±‚)å¹¶å®ç°å…¶é¢„æµ‹åŠŸèƒ½ã€‚è¯ç”Ÿäº 2010 å¹´çš„ Flask ä»¥å¤§å¤šæ•°æ ‡å‡†æ¥çœ‹éƒ½æ˜¯ä¸€ä¸ªå°æ¡†æ¶ï¼Œå°åˆ°å¯ä»¥è¢«ç§°ä¸ºâ€œå¾®æ¡†æ¶â€ã€‚Flask æé«˜äº†å…¶æºä»£ç çš„å¯è¯»æ€§å’Œæ˜“ç†è§£æ€§ã€‚Flask æ˜¯ä¸€ä¸ªç”¨ Python ç¼–å†™çš„è½»é‡çº§ Web æ¡†æ¶ï¼Œå®ƒå·²ç»æˆä¸ºåˆåˆ›ä¼ä¸šæœ€å¹¿æ³›ä½¿ç”¨çš„ Python web æ¡†æ¶ä¹‹ä¸€ï¼Œä¹Ÿæ˜¯å¤§å¤šæ•°ä¼ä¸šå¿«é€Ÿç®€å•è§£å†³æ–¹æ¡ˆçš„å®Œç¾å·¥å…·ã€‚

> Flask çš„ç›®æ ‡æ˜¯ä¿æŒæ¡†æ¶çš„æ ¸å¿ƒå°ä½†é«˜åº¦å¯æ‰©å±•ï¼Œä»è€Œéå¸¸å®¹æ˜“å’Œçµæ´»åœ°ç¼–å†™åº”ç”¨ç¨‹åºæˆ–æ‰©å±•ï¼ŒåŒæ—¶ä½¿å¼€å‘äººå‘˜èƒ½å¤Ÿä¸ºä»–ä»¬çš„åº”ç”¨ç¨‹åºé€‰æ‹©è‡ªå·±çš„é…ç½®

![](img/9d3e63dcdfd5968b5fa3ccd1391d4671.png)

## åœ¨ Google äº‘å¹³å°ä¸Šéƒ¨ç½²

æˆ‘ä»¬å°†åœ¨æ ‡å‡†ç¯å¢ƒä¸­ä½¿ç”¨[è°·æ­Œåº”ç”¨å¼•æ“](https://cloud.google.com/appengine/)ã€‚å®ƒå…è®¸æˆ‘ä»¬â€œåœ¨å®Œå…¨æ‰˜ç®¡çš„æ— æœåŠ¡å™¨å¹³å°ä¸Šæ„å»ºé«˜åº¦å¯æ‰©å±•çš„åº”ç”¨ç¨‹åºâ€ã€‚åœ¨ç»§ç»­ä¹‹å‰ï¼Œæˆ‘å°†æå‡ºä¸€äº›å¿…è¦æ¡ä»¶æˆ–å‡è®¾:

1.  æˆ‘å‡è®¾æ‚¨å·²ç»å®‰è£…äº† Flask å’Œè™šæ‹Ÿç¯å¢ƒä¸­æ¶‰åŠçš„åº“(å¦‚æœæ²¡æœ‰ï¼Œå°†åœ¨åé¢æ˜¾ç¤º)ã€‚
2.  æ‚¨æœ‰ä¸€ä¸ªå¯ä»¥è®¿é—®[è°·æ­Œäº‘å¹³å°æ§åˆ¶å°](https://console.cloud.google.com)çš„è°·æ­Œè´¦æˆ·ï¼Œå¹¶åœ¨ä¸Šé¢åˆ›å»ºäº†ä¸€ä¸ªæ–°é¡¹ç›®ã€‚

> ç¡®ä¿ä¸ºæ‚¨çš„é¡¹ç›®å¯ç”¨**è®¡è´¹**ã€‚ä¸ºäº†å°†åº”ç”¨ç¨‹åºéƒ¨ç½²åˆ° App Engineï¼Œéœ€è¦å°†è®¡è´¹å¸æˆ·é“¾æ¥åˆ°æ‚¨çš„é¡¹ç›®

3.å·²å®‰è£… [Google Cloud SDK](https://cloud.google.com/sdk/) ï¼ŒæŒ‰ç…§å…¶è¯´æ˜è¿›è¡Œå®‰è£…ã€‚

4.æ‚¨å·²ç»æˆåŠŸåœ°åœ¨æœ¬åœ°æµ‹è¯•äº†æ‚¨çš„åº”ç”¨ç¨‹åºã€‚

![](img/d6ce7cbdc8a3d8a0d3b2a30f971b3e9e.png)

Project Folder Structure

å¤§è‡´æ¥è¯´ï¼Œæ‚¨çš„ä¸»æ–‡ä»¶å¤¹å°†å…·æœ‰è¿™ç§ç»“æ„ï¼Œè¯·æ³¨æ„â€œnlpâ€æ˜¯æˆ‘çš„è™šæ‹Ÿç¯å¢ƒï¼Œæˆ‘ä»¬å°†åœ¨ä¸‹é¢åˆ›å»º app.yamlã€appengine_config.py å’Œ requirements.txt:

app.yaml

ç¤ºä¾‹ app.yaml æŒ‡å®šäº†åº”ç”¨ç¨‹åºåº”è¯¥è¿è¡Œçš„è¿è¡Œæ—¶ï¼Œå¯¹äºè¿™ä¸ªé¡¹ç›®ï¼Œå®ƒå°†åœ¨ Python 3.7 ä¸Šè¿è¡Œã€‚å¯¹äº Python 2.7ï¼Œå¯ä»¥å‚è€ƒä¸‹é¢çš„ä»£ç :

Python 2.7 app.yaml

app_engine_config.py

requirements.txt

å¦‚æœæ‚¨æ²¡æœ‰å°†å¿…è¦çš„åº“å®‰è£…åˆ°è™šæ‹Ÿç¯å¢ƒä¸­ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„ä»£ç ã€‚åº”è¯¥é¦–å…ˆæ¿€æ´»ç¯å¢ƒï¼Œå¹¶ä½¿ç”¨ç»ˆç«¯ã€å‘½ä»¤æç¤ºç¬¦ç­‰æ¥è®¿é—®å®ƒï¼Œä»¥ä¾¿æ ¹æ®éœ€æ±‚å®‰è£…æ–°çš„ä¾èµ–é¡¹ã€‚

```
pip install -t lib -r requirements.txt
```

**-t lib:** æ­¤æ ‡å¿—å°†åº“å¤åˆ¶åˆ° lib æ–‡ä»¶å¤¹ä¸­ï¼Œè¯¥æ–‡ä»¶å¤¹åœ¨éƒ¨ç½²æœŸé—´ä¸Šä¼ åˆ° App Engineã€‚

**-r requirements.txt:** pip å®‰è£… requirements.txt ä¸­çš„æ‰€æœ‰å†…å®¹ã€‚

# éƒ¨ç½²

åœ¨æˆ‘ä»¬å¼€å§‹ä¹‹å‰ï¼Œæœ€å¥½(å¯é€‰)æ›´æ–°å·²å®‰è£…çš„äº‘ SDK:

```
gcloud components update
```

ç„¶åï¼Œåœ¨**æ ¹æ–‡ä»¶å¤¹**ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨æ‚¨çš„ cmd/ç»ˆç«¯éƒ¨ç½²å®ƒï¼Œä»£ç å¦‚ä¸‹:

```
gcloud app deploy --project [ID of Project]
```

æˆ–è€…ä½ ä¹Ÿå¯ä»¥åœ¨æ²¡æœ‰é¡¹ç›® ID çš„æƒ…å†µä¸‹å®Œæˆï¼

![](img/5202b0ed6aaeaad898f3f5cf133a8824.png)

æ ¹æ®æ‚¨çš„é¡¹ç›®ï¼Œé€‰æ‹©æœ€åˆé€‚çš„åŒºåŸŸå¹¶ç­‰å¾…å‡ åˆ†é’Ÿï¼Œå®ƒå°†ä¸ºæ‚¨æä¾›ä¸€ä¸ªé“¾æ¥ï¼Œä»»ä½•äººéƒ½å¯ä»¥è®¿é—®è¯¥é“¾æ¥æ¥æŸ¥çœ‹/ä½¿ç”¨æ‚¨çš„ web åº”ç”¨ç¨‹åºï¼

![](img/d1af4364079907aafa59538df4e382f7.png)

æˆ–è€…åªä½¿ç”¨ä¸‹é¢çš„ä»£ç :

```
gcloud app browse --project=
#the link usually is "projectid".appspot.com
```

# ç»“è®º

ç§å•Šã€‚GCP ä½¿éƒ¨ç½² web åº”ç”¨ç¨‹åºçš„è¿‡ç¨‹å˜å¾—æ›´å¿«ã€æ›´å®¹æ˜“ã€‚æˆ‘å¸Œæœ›æˆ‘å¯ä»¥å°è¯•åœ¨ä¸ä¹…çš„å°†æ¥æˆ–å…¶ä»–é¡¹ç›®çš„å…¶ä»–é€‰æ‹©ã€‚å¦‚æœæœ‰ä»»ä½•é—®é¢˜ï¼Œè¯·éšæ—¶è”ç³»æˆ‘ï¼æˆ‘çš„ç½‘ç«™å¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°:[spamdetector.appspot.com](http://spamdetector.appspot.com)

å‚è€ƒ

1.  å­˜å‚¨åº“:[https://github.com/georgeblu1/Spam-Detector-Web-App](https://github.com/georgeblu1/Spam-Detector-Web-App)
2.  ç”¨ Python å¼€å‘ NLP æ¨¡å‹&ç”¨ Flask é€æ­¥éƒ¨ç½²:[https://towardsdatascience . com/develop-a-NLP-Model-in-Python-Deploy-It-with-Flask-Step-Step-744 F3 BDD 7776](/develop-a-nlp-model-in-python-deploy-it-with-flask-step-by-step-744f3bdd7776)
3.  [çƒ§ç“¶æ¡†æ¶é£Ÿè°±](https://www.packtpub.com/web-development/flask-framework-cookbook)
4.  [ç ‚ç®±ç½‘å¼€å‘](https://www.oreilly.com/library/view/flask-web-development/9781491991725/)
5.  [Python æœºå™¨å­¦ä¹ ](https://www.amazon.com/Python-Machine-Learning-Sebastian-Raschka-ebook/dp/B00YSILNL0)