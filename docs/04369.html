<html>
<head>
<title>Visualizing Comic Characters’ Genders and Superpowers</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">可视化漫画人物的性别和超能力</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/visualizing-comic-characters-genders-and-superpowers-ae7c2311cb89?source=collection_archive---------19-----------------------#2019-07-07">https://towardsdatascience.com/visualizing-comic-characters-genders-and-superpowers-ae7c2311cb89?source=collection_archive---------19-----------------------#2019-07-07</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="8c01" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">如何使用 D3 &amp; React 创建带工具提示的堆积条形图？以及关于漫画、性别和超能力的简短讨论</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/079f8e7cda78a33a758010b51221d740.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IxfydsTmbSVvKLqIBIEuaA.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">A small piece of the final chart</figcaption></figure><h1 id="cd58" class="kv kw iq bd kx ky kz la lb lc ld le lf jw lg jx lh jz li ka lj kc lk kd ll lm bi translated">摘要</h1><p id="da3e" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated"><strong class="lp ir"> 1。可视化超能力和性别</strong></p><p id="e74d" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated"><strong class="lp ir"> 2。查询漫画数据</strong></p><p id="fbc4" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated"><strong class="lp ir"> 3。创建 React 组件</strong></p><p id="5354" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated"><strong class="lp ir"> 4。设置工具提示</strong></p><p id="2487" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated"><strong class="lp ir"> 5。参考资料学习 D3 &amp;反应积分</strong></p><p id="aef9" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">React 和 D3 是我在这里使用的工具。我指出这个版本不同于常规 D3 版本的核心部分，常规 D3 版本基于<code class="fe mo mp mq mr b">enter()</code>、<code class="fe mo mp mq mr b">exit()</code>和<code class="fe mo mp mq mr b">update()</code>。</p></div><div class="ab cl ms mt hu mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="ij ik il im in"><p id="0dae" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated"><em class="mz">我写这篇文章是为了了解一点 D3 并且想用 React 方式编码的人。如果你不知道如何使用 React 编码，我强烈推荐 Scrimba 上的这个 100%免费互动</em> <a class="ae na" href="https://scrimba.com/g/glearnreact" rel="noopener ugc nofollow" target="_blank"> <em class="mz">课程</em> </a> <em class="mz">。</em></p><p id="b25b" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">【https://github.com/heberleh/learn-react-d3/】这是 GitHub 条形图库:<a class="ae na" href="https://github.com/heberleh/learn-react-d3/" rel="noopener ugc nofollow" target="_blank"><em class="mz"/></a><em class="mz">。</em></p></div><div class="ab cl ms mt hu mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="ij ik il im in"><p id="96d8" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">这是我漫画人物系列的第二部分:</p><ol class=""><li id="d29a" class="nb nc iq lp b lq mj lt mk lw nd ma ne me nf mi ng nh ni nj bi translated"><a class="ae na" rel="noopener" target="_blank" href="/create-a-marvel-database-with-sql-and-javascript-the-easy-way-573ccdf44673">用 SQL 和 Javascript 创建漫威数据库，最简单的方法</a></li><li id="9962" class="nb nc iq lp b lq nk lt nl lw nm ma nn me no mi ng nh ni nj bi translated"><a class="ae na" href="https://medium.com/@heberleh/visualizing-comic-characters-genders-and-superpowers-ae7c2311cb89" rel="noopener">形象化漫画人物的性别和超能力</a>【这】</li><li id="e441" class="nb nc iq lp b lq nk lt nl lw nm ma nn me no mi ng nh ni nj bi translated"><a class="ae na" href="https://medium.com/@heberleh/comparing-marvel-and-dc-with-data-visualization-33b8f8486082" rel="noopener">用数据可视化比较漫威和 DC</a></li></ol><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi np"><img src="../Images/7ffe454f75f7e8e6ede107e84bbcfc03.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*TK88U5ty5nRYl6dV.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Legend of Marvel &amp; DC visualization: <a class="ae na" href="https://heberleh.github.io/comics-universe/" rel="noopener ugc nofollow" target="_blank">https://heberleh.github.io/comics-universe/</a></figcaption></figure><h1 id="807a" class="kv kw iq bd kx ky kz la lb lc ld le lf jw lg jx lh jz li ka lj kc lk kd ll lm bi translated"><strong class="ak"> 1。可视化超能力和性别</strong></h1><p id="d36e" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">本节首先引导您进入交互式条形图，并描述有关该图的详细信息。然后，它给你一个关于漫画人物的能力和性别的简单讨论。</p><h2 id="f801" class="nq kw iq bd kx nr ns dn lb nt nu dp lf lw nv nw lh ma nx ny lj me nz oa ll ob bi translated"><strong class="ak">交互式堆积条形图</strong></h2><p id="6832" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated"><a class="ae na" href="https://heberleh.github.io/learn-react-d3/" rel="noopener ugc nofollow" target="_blank">https://heberleh.github.io/learn-react-d3/</a></p><p id="825a" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">我的意图是展示男性、女性和其他性别在超级能力中的分布，同时展示超级能力的受欢迎程度。在这种情况下，堆积条形图是一个合理的选择。</p><p id="0327" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">每个条形代表一种能力。它的大小代表字符的数量。<strong class="lp ir"> </strong>全部来自 Wikidata。</p><p id="10b6" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">鼠标悬停会显示该技能的详细信息，如描述和数字。</p><p id="6cfc" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">我在这张图表中使用了许多颜色。如果我想关注一些特定的信息，这可能会被认为是杂乱的。</p><p id="1cb9" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">例如，在<a class="ae na" href="https://heberleh.github.io/comics-universe/" rel="noopener ugc nofollow" target="_blank">漫威&amp; DC 可视化</a>中显示的条形图中，我只选择了 2 种颜色。一个是黑暗，另一个是突出非男性角色多于男性角色的能力。</p><p id="9c10" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">这里我只使用了来自任何虚构世界的喜剧角色的实例；在漫威和 DC 的可视化中，我使用了虚拟角色的实例和子类，从虚拟宇宙等于漫威/DC。</p><h2 id="3179" class="nq kw iq bd kx nr ns dn lb nt nu dp lf lw nv nw lh ma nx ny lj me nz oa ll ob bi translated">解释和讨论</h2><p id="9e5f" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">当解释这个情节时，我们需要考虑到，事实上，在大多数(如果不是全部的话)虚构的宇宙中，男性多于女性和其他性别。我们可以预计每个宇宙中平均有 60%到 70%的角色是男性。因此，在大多数受欢迎的能力中，也期待更多的男性。</p><p id="2581" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">另一方面，我们可以发现女性人数多于男性的不太受欢迎的技能。其中有<em class="mz">力场</em>、<em class="mz">植身术</em>、<em class="mz">冷冻术</em>、<em class="mz">气动术</em>、<em class="mz">弹力术</em>、<em class="mz">概率操纵</em>、<em class="mz">后知后觉</em>和<em class="mz">御血术</em>。有什么历史或社会事实可以解释吗？</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/c9c1595d84d7f3ec829145b1810f0d2c.png" data-original-src="https://miro.medium.com/v2/resize:fit:640/format:webp/0*tNjP88s_Rchel74a.jpg"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk"><a class="ae na" href="https://www.deviantart.com/theopticnerve/art/Marvel-Premier-Dark-Phoenix-Artist-Proof-406825127" rel="noopener ugc nofollow" target="_blank">Marvel Premier — Dark Phoenix Artist Proof</a> by <a class="ae na" href="https://www.deviantart.com/theopticnerve" rel="noopener ugc nofollow" target="_blank">theopticnerve</a>. Under CC BY-NC-ND 3.0</figcaption></figure><p id="7d8a" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">很少有角色的性别不同于男性和女性。</p><p id="89e2" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">在图中发现的一个性别被命名为<strong class="lp ir">agender</strong>——查看绿色条。</p><p id="32e4" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">那就是<strong class="lp ir">凤凰力的情况。</strong></p><p id="8568" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">性别、种族和其他因素比以前被更多地讨论，作者们也更加关注它。</p><p id="54e4" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">举个例子，Jacques Nyemb 讨论了这个话题的一些优点。在第<a class="ae na" href="https://medium.com/@jnyemb/race-gender-and-comics-oh-my-d2328b901ab2" rel="noopener">篇文章</a>中，他写道他的漫画是有关联的:</p><blockquote class="of"><p id="e1ad" class="og oh iq bd oi oj ok ol om on oo mi dk translated">“我得出了一个我不想得出的结论。读者是白人男性，而我的角色是黑人。”</p></blockquote><p id="9d22" class="pw-post-body-paragraph ln lo iq lp b lq op jr ls lt oq ju lv lw or ly lz ma os mc md me ot mg mh mi ij bi translated">雅克还写了他在创造一个虚构的科学家，一个白人男性时的第一个想法:</p><blockquote class="of"><p id="7c84" class="og oh iq bd oi oj ok ol om on oo mi dk translated">“……我很快问自己为什么没有一个女科学家？一个黑人中年人？她的动机在我的新故事中比我坚持原来的想法更有意义。”</p></blockquote><p id="fb28" class="pw-post-body-paragraph ln lo iq lp b lq op jr ls lt oq ju lv lw or ly lz ma os mc md me ot mg mh mi ij bi translated">对我来说，我不是专家，任何想要与我们的现实相联系的宇宙都需要代表不同的人和文化来保持一致。创造一个多样化的虚构世界是为了包容和更接近我们的现实，特别是当它的观众是整个世界的时候。</p><h1 id="dc30" class="kv kw iq bd kx ky kz la lb lc ld le lf jw lg jx lh jz li ka lj kc lk kd ll lm bi translated">2.<strong class="ak">查询漫画数据</strong></h1><p id="7afc" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">为了创建一个图表来显示有多少角色具有每种能力(堆叠的条形大小)以及这些数字如何在性别(颜色、条形)之间分布，我从<a class="ae na" rel="noopener" target="_blank" href="/create-a-marvel-database-with-sql-and-javascript-the-easy-way-573ccdf44673">漫画数据库</a>中查询了一个包含以下信息的表:</p><ul class=""><li id="d499" class="nb nc iq lp b lq mj lt mk lw nd ma ne me nf mi ou nh ni nj bi translated">性格；角色；字母</li><li id="9a5e" class="nb nc iq lp b lq nk lt nl lw nm ma nn me no mi ou nh ni nj bi translated">能力</li><li id="5b36" class="nb nc iq lp b lq nk lt nl lw nm ma nn me no mi ou nh ni nj bi translated">性别</li></ul><p id="1df9" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">要使用这个数据库，你只需要下载一些。js 和。json 文件并导入，然后可以使用 SQL 命令进行查询。如果你想了解如何从维基数据中查询数据并创建一个<em class="mz"> Javascript 数据库</em>，请查看<a class="ae na" rel="noopener" target="_blank" href="/create-a-marvel-database-with-sql-and-javascript-the-easy-way-573ccdf44673">第一篇文章</a>。这是我的<code class="fe mo mp mq mr b">SELEC</code>命令:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ov ow l"/></div></figure><p id="e4bd" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">经过一些数据处理后，我的数据形成为:</p><ul class=""><li id="4704" class="nb nc iq lp b lq mj lt mk lw nd ma ne me nf mi ou nh ni nj bi translated"><code class="fe mo mp mq mr b">labels</code>矢量:性别标签</li><li id="fbff" class="nb nc iq lp b lq nk lt nl lw nm ma nn me no mi ou nh ni nj bi translated"><code class="fe mo mp mq mr b">data</code>:每个能力一个向量，包含每个性别的字符总数向量，根据<code class="fe mo mp mq mr b">labels</code>索引</li></ul><p id="2c29" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">示例:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ov ow l"/></div></figure><p id="414c" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">我定义了堆叠条形图组件接收数据模型作为输入。它包含获取标签和总计的数据和辅助函数:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ov ow l"/></div></figure><p id="596c" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">你可以在这里找到<code class="fe mo mp mq mr b">skillsDistributionByGender()</code>的完整代码<a class="ae na" href="https://github.com/heberleh/learn-react-d3/blob/master/src/ComicsQueries.js" rel="noopener ugc nofollow" target="_blank"/>。</p><h1 id="e370" class="kv kw iq bd kx ky kz la lb lc ld le lf jw lg jx lh jz li ka lj kc lk kd ll lm bi translated">3.创建 React 组件</h1><p id="07b4" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">在定义了我的数据集之后，我开始基于<a class="ae na" href="https://medium.com/@caspg/responsive-chart-with-react-and-d3v4-afd717e57583" rel="noopener">这篇文章和<a class="od oe ep" href="https://medium.com/u/fe4fb1172944?source=post_page-----ae7c2311cb89--------------------------------" rel="noopener" target="_blank"> Kacper Goliński </a>的代码</a>创建一个简单的条形图。</p><p id="d49d" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">如果您没有使用 React 和 D3 创建任何图表，您可能会发现从一个简单的条形图开始更容易，然后回来检查我是如何做堆叠图的以及我是如何添加工具提示的。</p><p id="6ab6" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">Kacper 还实现了<strong class="lp ir"> ResponsiveWrapper </strong>，它根据可见窗口的宽度控制图表的<code class="fe mo mp mq mr b">width</code>。</p><p id="9aaf" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">在这一点上，我认为你知道<code class="fe mo mp mq mr b">create-react-app</code>。如果没有，就去搜索一下，或者查一下我开头提到的课程。</p><p id="f266" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">我们最终的 SVG 将有两个主要的 React 组件，负责显示 y 轴和技能的标签(<code class="fe mo mp mq mr b">&lt;Axes/&gt;</code>)以及堆叠的条形图(<code class="fe mo mp mq mr b">&lt;StackedBars/&gt;</code>)。我设置了一个额外的组件来控制工具提示，显示在每个条的鼠标上(<code class="fe mo mp mq mr b">&lt;ReactTooltip/&gt;</code>):</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ov ow l"/></div></figure><p id="ca53" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated"><strong class="lp ir">集成 D3 和 React 有不同的方法</strong>。</p><p id="f959" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">第一种方法是使用 React 对应用程序进行模块化，并使用 D3 通过<em class="mz"> enter()、update()和 exit() </em>来控制 SVG 元素。</p><p id="616d" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">第二种方法是使用 React 控制所有 SVG 元素，这对 React 应用程序更有意义。因此，我们不会调用<code class="fe mo mp mq mr b">.attr('width', 200)</code>，而是将它直接设置为组件或 SVG 元素，如下例所示:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ov ow l"/></div></figure><p id="d263" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">这段代码返回了<code class="fe mo mp mq mr b">&lt;rect&gt;</code>元素，我们将把这些元素放入一个<code class="fe mo mp mq mr b">&lt;g&gt;</code>中，对每个条形/能力的矩形进行分组。因此，我们可以将它添加到一个函数中，并为每个能力调用它，代码如下:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ov ow l"/></div></figure><p id="e99f" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">这段代码将为每个能力创建一个<code class="fe mo mp mq mr b">&lt;g&gt;</code>和一个最终的<code class="fe mo mp mq mr b">&lt;g&gt;</code>，其中包含了构成图表的所有条形。我们可以在 React 组件中编写所有这些代码，就像我在我的<code class="fe mo mp mq mr b">&lt;StackedBars /&gt;</code> ( <a class="ae na" href="https://github.com/heberleh/learn-react-d3/blob/master/src/components/Bars/StackedBars.js" rel="noopener ugc nofollow" target="_blank">见这里</a>)中所做的那样。</p><p id="4d0a" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">最初，我创建了<code class="fe mo mp mq mr b">x</code>和<code class="fe mo mp mq mr b">y</code>轴，但是我意识到实际的轴在我的图表中是不必要的信息。</p><blockquote class="of"><p id="3651" class="og oh iq bd oi oj ok ol om on oo mi dk translated">去掉对你的观众来说不重要的东西可以减少混乱！</p></blockquote><p id="2a93" class="pw-post-body-paragraph ln lo iq lp b lq op jr ls lt oq ju lv lw or ly lz ma os mc md me ot mg mh mi ij bi translated">因此，我让 y 轴保持原样，只使用 CSS 样式<code class="fe mo mp mq mr b">stroke-opacity: 0</code>省略了<code class="fe mo mp mq mr b">path</code>和<code class="fe mo mp mq mr b">line</code>元素(你可以试试<code class="fe mo mp mq mr b">display:none</code>)。通过移除 React 组件调用，我省略了 x 轴。</p><p id="5fc2" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">这是 React &amp; D3 集成的第二个<strong class="lp ir">重要</strong>案例，因为<code class="fe mo mp mq mr b">d3.axis</code>函数需要 SVG 元素来绘制。这意味着我们不能调用<code class="fe mo mp mq mr b">d3.axis</code>并获得一个将在 React 组件中返回的 SVG 元素，就像我们在上一个例子中所做的那样。</p><p id="5b2e" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">在这种情况下，我们需要给 D3 对 DOM 的临时控制权。为此，我们选择引用当前组件的元素，并告诉 D3 处理它。这里有一个例子:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ov ow l"/></div></figure><p id="ac4d" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">我们用<code class="fe mo mp mq mr b">ref={(el) =&gt; { this.axisElement = el; }}</code>设置轴节点(见上图)，然后用 D3 选择它，并调用 D3 轴函数，就像这里的<code class="fe mo mp mq mr b">d3.select(this.axisElement).call(axis)</code>一样，这将追加轴元素。</p><p id="ce18" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">上面的例子将在<code class="fe mo mp mq mr b">&lt;g&gt;</code>元素中绘制轴，并且我们在渲染后将其全部返回给父组件。</p><blockquote class="of"><p id="fff7" class="og oh iq bd oi oj ok ol om on oo mi dk translated">"<code class="fe mo mp mq mr b">ref</code>更新发生在<code class="fe mo mp mq mr b">componentDidMount</code>或组件更新生命周期方法之前"-<a class="ae na" href="https://reactjs.org/docs/refs-and-the-dom.html" rel="noopener ugc nofollow" target="_blank">文档</a></p></blockquote><p id="250e" class="pw-post-body-paragraph ln lo iq lp b lq op jr ls lt oq ju lv lw or ly lz ma os mc md me ot mg mh mi ij bi translated">因此，我们的代码首先执行<code class="fe mo mp mq mr b">this.axisElement = el</code>，然后执行<code class="fe mo mp mq mr b">renderAxis()</code>。</p></div><div class="ab cl ms mt hu mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="ij ik il im in"><p id="3d92" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated"><strong class="lp ir">在结论</strong>中，我们定义了使用 React 和 D3 创建 SVG 可视化的两种主要方法:</p><ol class=""><li id="39d8" class="nb nc iq lp b lq mj lt mk lw nd ma ne me nf mi ng nh ni nj bi translated"><strong class="lp ir">声明性地</strong>:你控制 SVG 元素；</li><li id="d97b" class="nb nc iq lp b lq nk lt nl lw nm ma nn me no mi ng nh ni nj bi translated"><strong class="lp ir"> refs </strong>:赋予 D3 对特定被引用节点的控制权。</li></ol><p id="c393" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">根据 React <a class="ae na" href="https://reactjs.org/docs/refs-and-the-dom.html" rel="noopener ugc nofollow" target="_blank">文档</a>，首选第一种，尽可能避免第二种。如果 D3 中的函数返回 SVG 元素，你可以声明性地使用结果(不使用 ref)，否则，<code class="fe mo mp mq mr b">ref</code>似乎是避免<em class="mz">进入</em>、<em class="mz">退出</em>和<em class="mz">更新</em>函数的唯一方法。</p><h1 id="451c" class="kv kw iq bd kx ky kz la lb lc ld le lf jw lg jx lh jz li ka lj kc lk kd ll lm bi translated">4.设置工具提示</h1><p id="c455" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">创建工具提示的一种方法是为每个条或堆叠的条构建一个单独的组件；另一种方法是构建一个控制所有工具提示的组件。</p><p id="2f38" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">这就是<a class="ae na" href="https://www.npmjs.com/package/react-tooltip" rel="noopener ugc nofollow" target="_blank">反应工具提示</a>的作用。你只需要在工具提示出现的地方设置一些属性，以及 SVG 之外的一个组件<code class="fe mo mp mq mr b">&lt;ReactTooltip/&gt;</code>的属性。在工具提示将出现的元素中，您设置了两个属性:<em class="mz">数据-提示</em>和<em class="mz">数据-用于</em>。第一个是文本，第二个是 ReactTooltip 组件 id，如下所示:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ov ow l"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">ReactTooltip website: <a class="ae na" href="https://www.npmjs.com/package/react-tooltip" rel="noopener ugc nofollow" target="_blank">https://www.npmjs.com/package/react-tooltip</a></figcaption></figure><h1 id="c55a" class="kv kw iq bd kx ky kz la lb lc ld le lf jw lg jx lh jz li ka lj kc lk kd ll lm bi translated">5.学习 D3 和 React 集成的参考资料</h1><p id="01d9" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">到目前为止，我已经<em class="mz">接触了三个主要活跃作者的内容</em>，他们使用 D3 和 React，创建教程并分享他们的代码:</p><ul class=""><li id="6aea" class="nb nc iq lp b lq mj lt mk lw nd ma ne me nf mi ou nh ni nj bi translated"><a class="od oe ep" href="https://medium.com/u/4607b4069d83?source=post_page-----ae7c2311cb89--------------------------------" rel="noopener" target="_blank">吴雪莉</a>:<a class="ae na" href="https://twitter.com/sxywu" rel="noopener ugc nofollow" target="_blank">https://twitter.com/sxywu</a></li><li id="ae1b" class="nb nc iq lp b lq nk lt nl lw nm ma nn me no mi ou nh ni nj bi translated">纳迪耶·布雷默:<a class="ae na" href="https://twitter.com/NadiehBremer" rel="noopener ugc nofollow" target="_blank">https://twitter.com/NadiehBremer</a></li><li id="bc12" class="nb nc iq lp b lq nk lt nl lw nm ma nn me no mi ou nh ni nj bi translated"><a class="od oe ep" href="https://medium.com/u/8e43dcd3c21f?source=post_page-----ae7c2311cb89--------------------------------" rel="noopener" target="_blank">瑞士银行柜员</a>:<strong class="lp ir"/>【https://twitter.com/Swizec】T4</li></ul><h1 id="a922" class="kv kw iq bd kx ky kz la lb lc ld le lf jw lg jx lh jz li ka lj kc lk kd ll lm bi translated">6.在幕后</h1><p id="b33b" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">这些是我在编码图表时拍摄的一些屏幕截图。如你所见，我开始展示这些轴，最后却把它们拿走了。</p><div class="kg kh ki kj gt ab cb"><figure class="oy kk oz pa pb pc pd paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/177d32cbc1dcc605f36f5c1e916f5476.png" data-original-src="https://miro.medium.com/v2/resize:fit:920/format:webp/1*099WkgVKqcvjUHXx1JmsDQ.png"/></div></figure><figure class="oy kk pe pa pb pc pd paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/d4163f1f9198c86e27c4fb03a99d2607.png" data-original-src="https://miro.medium.com/v2/resize:fit:520/format:webp/1*h-nFTGcJC_v7SqcHptAzgQ.png"/></div></figure><figure class="oy kk pf pa pb pc pd paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/68f67b0fbdf7be08b68712627d7b11d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:562/format:webp/1*5qKgn2VlAZydDWZ1qK4JmA.png"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk pg di ph pi">See all these lines and axes? I don’t need them here.</figcaption></figure></div><div class="ab cb"><figure class="oy kk pj pa pb pc pd paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/810260f32a397bd886e0223d443fdab2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1118/format:webp/1*sMvmwJ3aXo9lobRX7o2YZg.png"/></div></figure><figure class="oy kk pk pa pb pc pd paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/689c18906785b95f4dc2bbc552ac31d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:884/format:webp/1*NpHlukaNrqyxi1gIRps2EQ.png"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk pl di pm pi">Adjusting the bar sizes and placement.</figcaption></figure></div><p id="97e1" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">请留下您对任何主题的评论或私人笔记。</p><p id="f8f7" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">谢谢你看我的文章！</p></div></div>    
</body>
</html>