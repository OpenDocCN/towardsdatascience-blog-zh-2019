<html>
<head>
<title>Understanding Learning Rate</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">了解学习速度</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/https-medium-com-dashingaditya-rakhecha-understanding-learning-rate-dd5da26bb6de?source=collection_archive---------5-----------------------#2019-06-28">https://towardsdatascience.com/https-medium-com-dashingaditya-rakhecha-understanding-learning-rate-dd5da26bb6de?source=collection_archive---------5-----------------------#2019-06-28</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="636b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">最初发表于<a class="ae kl" href="https://iq.opengenus.org/learning-rate/" rel="noopener ugc nofollow" target="_blank"> OpenGenus IQ </a>。</p><p id="5df7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi km translated"><span class="l kn ko kp bm kq kr ks kt ku di"> W </span>在构建深度学习项目时，我们面临的最常见的问题是选择正确的超参数(通常称为优化器)。这是至关重要的，因为超参数决定了机器学习模型的专业知识。</p><p id="7f4f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在机器学习(以下简称 ML)中，<strong class="jp ir">超参数是模型外部的配置变量</strong>，其值不是根据给定的数据估计的。超参数是估计模型参数过程的重要部分，通常由专业人员定义。</p><blockquote class="kv"><p id="1d6c" class="kw kx iq bd ky kz la lb lc ld le kk dk translated"><strong class="ak">当 ML 算法用于特定问题时，例如当我们使用网格搜索或随机搜索算法时，我们实际上是在调整模型的超参数，以发现有助于我们实现最准确预测的值。</strong></p></blockquote><h1 id="c897" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">什么是学习率？</h1><p id="c58c" class="pw-post-body-paragraph jn jo iq jp b jq md js jt ju me jw jx jy mf ka kb kc mg ke kf kg mh ki kj kk ij bi translated">学习率(λ)就是这样一个<strong class="jp ir">超参数</strong>，它定义了相对于损耗梯度下降的网络权重的<strong class="jp ir">调整。它决定了我们达到最佳体重的快慢</strong></p><p id="cbeb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">梯度下降算法通过在每一步最小化成本函数，在多次迭代中估计模型的权重。</p><p id="5c99" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">算法是这样的:</p><pre class="mi mj mk ml gt mm mn mo mp aw mq bi"><span id="ca89" class="mr lg iq mn b gy ms mt l mu mv">Repeat until convergence {<br/> <br/>     Wj = Wj - λ θF(Wj)/θWj<br/> <br/>}</span></pre><p id="5c5b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">其中:</p><ul class=""><li id="34d1" class="mw mx iq jp b jq jr ju jv jy my kc mz kg na kk nb nc nd ne bi translated"><strong class="jp ir"> Wj </strong>是重量</li><li id="6b4a" class="mw mx iq jp b jq nf ju ng jy nh kc ni kg nj kk nb nc nd ne bi translated"><strong class="jp ir"> θ </strong>是θ</li><li id="47bd" class="mw mx iq jp b jq nf ju ng jy nh kc ni kg nj kk nb nc nd ne bi translated"><strong class="jp ir"> F(Wj) </strong>分别是成本函数。</li></ul><p id="6584" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">为了让梯度下降起作用，我们必须将学习率设置为一个合适的值。该参数<strong class="jp ir">决定了我们向最佳重量</strong>移动的快慢。如果学习率非常大，我们将跳过最优解。如果它太小，我们将需要太多的迭代来收敛到最佳值。所以使用一个好的学习率是至关重要的。</p><p id="95f1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">用简单的语言来说，我们可以把学习速度定义为我们的网络为了新的概念而抛弃到目前为止已经学习过的概念的速度。</p><h1 id="6ddf" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq nk ls lt lu nl lw lx ly nm ma mb mc bi translated">通过孩子的互动解释学习率</h1><p id="00ce" class="pw-post-body-paragraph jn jo iq jp b jq md js jt ju me jw jx jy mf ka kb kc mg ke kf kg mh ki kj kk ij bi translated">为了更好地理解这一点，让我们考虑一个例子。</p><p id="7268" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果一个孩子看到十只狗并且它们都是黑色的，他可能会认为所有的狗都是黑色的，并且在试图识别一只狗时会考虑这一特征。</p><p id="a8e1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">想象一下，他看到一只白色的狗，他的父母告诉他这是一只狗。有了令人满意的学习速度，他会很快明白黑色不是狗的重要特征，并会寻找另一个特征。</p><p id="291b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">但是由于学习率低，他会认为白狗是异类，并且会继续相信所有的狗都是黑的。</p><p id="4bab" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果<strong class="jp ir">学习率太高</strong>，他会立刻开始相信所有的狗都是白色的，尽管他见过的黑狗比白狗多。</p><p id="eba8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">关键是<strong class="jp ir">达到理想的学习率</strong>真的很重要，因为:</p><ul class=""><li id="dfc4" class="mw mx iq jp b jq jr ju jv jy my kc mz kg na kk nb nc nd ne bi translated">学习率低和高都会导致时间和资源的浪费</li><li id="9a58" class="mw mx iq jp b jq nf ju ng jy nh kc ni kg nj kk nb nc nd ne bi translated">较低的学习率意味着更多的训练时间</li><li id="3e03" class="mw mx iq jp b jq nf ju ng jy nh kc ni kg nj kk nb nc nd ne bi translated">更多时间导致云 GPU 成本增加</li><li id="771a" class="mw mx iq jp b jq nf ju ng jy nh kc ni kg nj kk nb nc nd ne bi translated">更高的比率可能会导致模型无法准确预测任何事情</li></ul><p id="b019" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">理想的学习率是这样的，它足够低，使网络收敛到有用的东西，但又足够高，使它可以在合理的时间内被训练。</p><h1 id="9a47" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq nk ls lt lu nl lw lx ly nm ma mb mc bi translated">调整学习率</h1><p id="5ec5" class="pw-post-body-paragraph jn jo iq jp b jq md js jt ju me jw jx jy mf ka kb kc mg ke kf kg mh ki kj kk ij bi translated">学习率是调节神经网络的最重要的超参数。一个好的学习率可能是一个没有学到任何东西的模型和一个呈现最先进结果的模型之间的差别。</p><p id="bd12" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">下图展示了配置学习率时可能遇到的不同情况。</p><figure class="mi mj mk ml gt no gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/3aec1b98a0ac128660de616170a3c2fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:918/format:webp/0*C5kIkoBwht0fXRgs.jpeg"/></div><figcaption class="nr ns gj gh gi nt nu bd b be z dk">Effect of various learning rates on convergence (Img Credit: <a class="ae kl" href="http://cs231n.github.io/neural-networks-3/" rel="noopener ugc nofollow" target="_blank">cs231n</a>)</figcaption></figure><p id="b5cb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">找到理想或最佳学习率的明显方法是通过反复试验。为了有效地做到这一点，有一些方法我们应该坚持。</p><h1 id="c895" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq nk ls lt lu nl lw lx ly nm ma mb mc bi translated">从粗到细搜索学习率</h1><p id="cdf9" class="pw-post-body-paragraph jn jo iq jp b jq md js jt ju me jw jx jy mf ka kb kc mg ke kf kg mh ki kj kk ij bi translated">0.01 和 0.011 的学习率不可能产生很大不同的结果。即使他们这样做了，以如此小的增量进行搜索是非常昂贵和低效的:如果两种学习速率都导致模型发散怎么办？花在训练上的时间将是一种浪费。</p><p id="5288" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">一个更有效的方法是尝试各种不同的学习速度，以确定你应该探索的学习速度范围，并在此范围内集中精力。</p><p id="09e5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">例如，每当我试图调整学习率时，我通常从搜索学习率 1e-7、1e-6、1e-5、… 0.01、0.1、1 开始。换句话说，我搜索了 10 个不同的顺序，以找到学习速度的最佳范围。然后，我以较小的增量搜索。例如，如果我发现最佳范围在 0.01 到 0.1 之间，我就会开始在这个范围内搜索学习率，比如 0.03。这与二分搜索法背后的想法非常相似，是一种广泛适用的技术。</p><h1 id="39e8" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq nk ls lt lu nl lw lx ly nm ma mb mc bi translated">不要一开始就对整个数据集进行训练</h1><p id="3fde" class="pw-post-body-paragraph jn jo iq jp b jq md js jt ju me jw jx jy mf ka kb kc mg ke kf kg mh ki kj kk ij bi translated">从整个数据集开始很可能是浪费时间。有可能，一些学习率会导致你的损失发散或波动，一些学习率可能会训练得非常慢，所以在几次迭代后，这些学习率的顺序可以从你的搜索中删除。</p><p id="770b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">尽管试错法是一种相对可靠的调整学习率的方法，但是一种更有效的方法是<strong class="jp ir">“学习率测试”</strong>，这种方法通过最小的训练来找到最佳的学习率。<br/>基本的想法是，你要有效地找到你可以使用的最大学习率，这将改善损失。为了找到这个值，你用多种学习率进行轻微训练，看看损失是如何变化的。<br/>实际程序是:</p><p id="1e95" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">选择一个最小和最大学习率进行搜索(例如 1e-7 和 0.1) <br/>使用 SGD 为几个时期训练模型，同时从最小学习率到最大学习率线性增加学习率。</p><p id="0d4a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在每次迭代中，记录准确性(或损失)。</p><p id="7067" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">绘制测试精度图，查看损失/精度从哪里开始改善，何时开始变得更差/平稳/变得不稳定。后面的学习率是收敛的最大学习率，是你初始学习率的一个很好的值。前一个学习率，即最大学习率的 1/3–1/4，是一个很好的最小学习率，如果使用学习率衰减，可以降低这个学习率。</p><figure class="mi mj mk ml gt no gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/b00dd960ea7110b31c2c204c1d9e0739.png" data-original-src="https://miro.medium.com/v2/resize:fit:678/format:webp/0*ca_8LHjqesoR9X6Y.png"/></div></figure><p id="b6e6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果测试精度曲线看起来像上面的图表，一个好的学习率从 0.006 开始，在这里损失开始变得参差不齐。</p><h1 id="bc54" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq nk ls lt lu nl lw lx ly nm ma mb mc bi translated">学习速度应该是适应性的</h1><p id="fb39" class="pw-post-body-paragraph jn jo iq jp b jq md js jt ju me jw jx jy mf ka kb kc mg ke kf kg mh ki kj kk ij bi translated">这种提高超参数收敛速度的方法减少了手动调整初始学习速度的需要。这种方法通过在优化期间使用相对于更新规则本身的学习速率的梯度来动态更新学习速率。计算这个“超梯度”几乎不需要额外的计算，只需要将原始梯度的一个额外副本存储在存储器中，并且只依赖于反向模式自动微分所提供的。</p><h1 id="f12c" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq nk ls lt lu nl lw lx ly nm ma mb mc bi translated">结论和进一步阅读</h1><p id="34dd" class="pw-post-body-paragraph jn jo iq jp b jq md js jt ju me jw jx jy mf ka kb kc mg ke kf kg mh ki kj kk ij bi translated"><strong class="jp ir">很明显，配置模型的学习率是一项至关重要的任务，无论您选择哪种方法，都将非常耗时且富有挑战性</strong>。</p><p id="557b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Leslie N. Smith 在论文“<a class="ae kl" href="https://arxiv.org/abs/1506.01186" rel="noopener ugc nofollow" target="_blank">用于训练神经网络的循环学习率</a>”中讨论了一种涉及选择神经网络学习率范围的强大技术。</p></div></div>    
</body>
</html>