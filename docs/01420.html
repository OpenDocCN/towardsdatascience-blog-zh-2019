<html>
<head>
<title>KGCNs: Machine Learning over Knowledge Graphs with TensorFlow</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">KGCNs:基于 TensorFlow 的知识图机器学习</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/kgcns-machine-learning-over-knowledge-graphs-with-tensorflow-a1d3328b8f02?source=collection_archive---------9-----------------------#2019-03-06">https://towardsdatascience.com/kgcns-machine-learning-over-knowledge-graphs-with-tensorflow-a1d3328b8f02?source=collection_archive---------9-----------------------#2019-03-06</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/5c02ab5c12351833d560a94e8739dbde.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Zpa1k6_flTVxxMuGtLYayg.png"/></div></div></figure><p id="e8da" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这个项目引入了一个新颖的模型:<em class="kw">知识图卷积网络</em> <strong class="ka ir"> </strong> (KGCN)，可以在 Apache 许可下从<a class="ae kx" href="https://github.com/graknlabs/kglib/tree/master/kglib/kgcn" rel="noopener ugc nofollow" target="_blank">的 GitHub repo </a>免费使用。它是用 Python 编写的，可以通过 PyPi 的 pip <a class="ae kx" href="https://pypi.org/project/grakn-kglib/" rel="noopener ugc nofollow" target="_blank">安装。</a></p><p id="1618" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这项工作<a class="ae kx" href="https://blog.grakn.ai/knowledge-graph-convolutional-networks-machine-learning-over-reasoned-knowledge-9eb5ce5e0f68" rel="noopener ugc nofollow" target="_blank">的主要思想是使用</a><a class="ae kx" href="https://github.com/vaticle/typedb" rel="noopener ugc nofollow" target="_blank"> TypeDB </a>作为知识图，在知识图、自动逻辑推理和机器学习之间建立一座桥梁。</p><h2 id="556b" class="ky kz iq bd la lb lc dn ld le lf dp lg kj lh li lj kn lk ll lm kr ln lo lp lq bi translated">摘要</h2><p id="62c7" class="pw-post-body-paragraph jy jz iq ka b kb lr kd ke kf ls kh ki kj lt kl km kn lu kp kq kr lv kt ku kv ij bi translated">通过监督学习，KGCN 可用于创建任何标记的 TypeDB <a class="ae kx" href="https://dev.grakn.ai/docs/concept-api/overview" rel="noopener ugc nofollow" target="_blank">事物</a>集合的矢量表示<em class="kw">嵌入</em>。</p><ol class=""><li id="bf8f" class="lw lx iq ka b kb kc kf kg kj ly kn lz kr ma kv mb mc md me bi translated">KGCN 可以被直接训练用于存储在 TypeDB 中的事物的分类或回归。</li><li id="9b50" class="lw lx iq ka b kb mf kf mg kj mh kn mi kr mj kv mb mc md me bi translated">未来的工作将包括通过无监督学习构建嵌入。</li></ol><h1 id="4eb5" class="mk kz iq bd la ml mm mn ld mo mp mq lg mr ms mt lj mu mv mw lm mx my mz lp na bi translated">它是用来做什么的？</h1><p id="ce0a" class="pw-post-body-paragraph jy jz iq ka b kb lr kd ke kf ls kh ki kj lt kl km kn lu kp kq kr lv kt ku kv ij bi translated">通常，数据不太适合表格格式。在知识图中存储复杂和相互关联的数据有很多好处，尤其是每个数据点的上下文可以完整地存储。</p><p id="1e30" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">然而，许多现有的机器学习技术依赖于每个示例的<em class="kw">输入向量的存在。创建这样一个向量来表示知识图中的一个节点是很重要的。</em></p><p id="d022" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">为了利用机器学习中现有的想法、工具和管道的财富，我们需要一种构建这些向量的方法。通过这种方式，我们可以利用知识图中的上下文信息进行机器学习。</p><p id="ade2" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这是 KGCN 能做到的。给定知识图中的一个示例节点，它可以检查该示例、其<em class="kw">上下文</em>附近的节点。基于这个上下文，它可以确定一个向量表示，例如一个嵌入了的<em class="kw">。</em></p><p id="2bdf" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">KGCN 适合完成两种广泛的学习任务</p><ol class=""><li id="d105" class="lw lx iq ka b kb kc kf kg kj ly kn lz kr ma kv mb mc md me bi translated"><strong class="ka ir">从知识图进行监督学习以进行预测，例如多类分类(已实施)、回归、链接预测</strong></li><li id="214a" class="lw lx iq ka b kb mf kf mg kj mh kn mi kr mj kv mb mc md me bi translated"><strong class="ka ir">知识图嵌入的无监督创建，例如用于聚类和节点比较任务</strong></li></ol><figure class="nc nd ne nf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nb"><img src="../Images/2fa34db9f72ad1d58430471ffe05af24.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*u2o9o2HBoDcgz0n16Ctdtg.png"/></div></div></figure><p id="059d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">为了构建一个<em class="kw">有用的</em>表示，KGCN 需要进行一些学习。为此，它需要一个函数来优化。回顾我们可以执行的广泛任务，我们有不同的案例来配置学习:</p><ol class=""><li id="cab1" class="lw lx iq ka b kb kc kf kg kj ly kn lz kr ma kv mb mc md me bi translated">在受监督的情况下，我们可以针对我们想要执行的确切任务进行优化。在这种情况下，嵌入是学习管道中的过渡张量</li><li id="4720" class="lw lx iq ka b kb mf kf mg kj mh kn mi kr mj kv mb mc md me bi translated">为了构建无监督嵌入作为输出，我们优化以最小化图中的一些相似性度量</li></ol><h1 id="4d66" class="mk kz iq bd la ml mm mn ld mo mp mq lg mr ms mt lj mu mv mw lm mx my mz lp na bi translated">方法学</h1><p id="271c" class="pw-post-body-paragraph jy jz iq ka b kb lr kd ke kf ls kh ki kj lt kl km kn lu kp kq kr lv kt ku kv ij bi translated">这个项目背后的意识形态在<a class="ae kx" href="https://blog.grakn.ai/knowledge-graph-convolutional-networks-machine-learning-over-reasoned-knowledge-9eb5ce5e0f68" rel="noopener ugc nofollow" target="_blank">这里</a>描述，还有一个<a class="ae kx" href="https://youtu.be/Jx_Twc75ka0?t=368" rel="noopener ugc nofollow" target="_blank">的演示视频</a>。实现的原理基于来自斯坦福 SNAP 小组的 GraphSAGE，经过大量修改后可用于知识图。KGCN 从存储在<em class="kw">类型超图</em>、<strong class="ka ir">类型数据库</strong>中的上下文数据中学习，而不是处理典型的属性图。此外，它还从 TypeDB 的<em class="kw">自动逻辑推理器</em>推导出的事实中学习。从这一点开始，假设对<a class="ae kx" href="https://docs.vaticle.com/" rel="noopener ugc nofollow" target="_blank"> TypeDB 的文档</a>有所了解。</p><p id="e2f6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在，我们介绍关键组件及其交互方式。</p><h1 id="8ca5" class="mk kz iq bd la ml mm mn ld mo mp mq lg mr ms mt lj mu mv mw lm mx my mz lp na bi translated">KGCN</h1><p id="50a9" class="pw-post-body-paragraph jy jz iq ka b kb lr kd ke kf ls kh ki kj lt kl km kn lu kp kq kr lv kt ku kv ij bi translated">KGCN 负责导出一组事物的嵌入(从而直接学习对它们进行分类)。我们从查询 TypeDB 开始，以找到一组带标签的示例。接下来，我们收集关于每个例子的上下文的数据。我们通过递归地考虑它们的邻居，以及它们邻居的邻居，直到<em class="kw"> K </em>跳远，来做到这一点。</p><figure class="nc nd ne nf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ng"><img src="../Images/fc097962250d3f74e5c93e08a9a834b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WFmh0gBkMwXpBqdEKpoYjA.png"/></div></div></figure><p id="72b2" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们从 TypeDB(上图)中检索关于这个邻域的数据。该信息包括所遇到的每个相邻事物的<em class="kw">类型层次</em>、<em class="kw">角色</em>和<em class="kw">属性值</em>，以及任何推断的邻居(上面用虚线表示)。这些数据被编译成数组，由神经网络接收。</p><p id="2cb0" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">通过操作聚合和组合，为一个事物建立一个单一的矢量表示。这个过程可以递归链接到相邻事物的 K 跳。这为感兴趣的事物构建了一个表示，其中包含从广泛的上下文中提取的信息。</p><figure class="nc nd ne nf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nh"><img src="../Images/38963d454b169dd58d2f0e2ff1693001.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*stxU5wkQgw6lveW8wIZR8Q.png"/></div></div></figure><p id="224c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在监督学习中，这些嵌入被直接优化以执行手边的任务。对于多类分类，这是通过将嵌入传递到单个后续密集层并通过 softmax 交叉熵确定损失(针对示例事物的标签)来实现的；然后，优化以尽量减少损失。</p><p id="4654" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">一个 KGCN 对象集合了许多子组件，一个上下文构建器、邻居发现器、编码器和嵌入器。</p><p id="3b6b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">输入管道组件不太有趣，所以我们将跳到有趣的部分。你可以在<a class="ae kx" href="https://github.com/vaticle/kglib/tree/master/kglib/kgcn" rel="noopener ugc nofollow" target="_blank"> KGCN 的自述</a>中读到其余的内容。</p><h2 id="ca6f" class="ky kz iq bd la lb lc dn ld le lf dp lg kj lh li lj kn lk ll lm kr ln lo lp lq bi translated">嵌入器</h2><p id="1af6" class="pw-post-body-paragraph jy jz iq ka b kb lr kd ke kf ls kh ki kj lt kl km kn lu kp kq kr lv kt ku kv ij bi translated">为了创建嵌入，我们在 TensorFlow 中构建了一个网络，该网络连续聚合和组合来自 K 跳的特征，直到保留一个“摘要”表示，即嵌入(如下图所示)。</p><p id="985e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">为了创建流水线，嵌入器链聚合并组合所考虑的邻居的 K 跳操作。例如，对于 2 跳的情况，这意味着聚合-组合-聚合-组合。</p><figure class="nc nd ne nf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ni"><img src="../Images/cf1931f46345ac8f663b2e525e673aac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bxMdYdMMqjkwRoiJVZG-2Q.png"/></div></div></figure><p id="998e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">上图显示了在监督分类的情况下这种链接是如何工作的。</p><p id="5786" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">嵌入器负责链接子组件聚合器和组合器，如下所述。</p><h2 id="f95a" class="ky kz iq bd la lb lc dn ld le lf dp lg kj lh li lj kn lk ll lm kr ln lo lp lq bi translated">集合商</h2><p id="3d95" class="pw-post-body-paragraph jy jz iq ka b kb lr kd ke kf ls kh ki kj lt kl km kn lu kp kq kr lv kt ku kv ij bi translated">一个<em class="kw">聚合器</em>(如下图)接受一个事物邻居的子样本的向量表示。它产生一个代表所有这些输入的向量。它必须以一种顺序不可知的方式做到这一点，因为邻居是无序的。为了实现这一点，我们使用一个密集连接的层，以及<em class="kw"> maxpool </em>输出(maxpool 是顺序不可知的)。</p><figure class="nc nd ne nf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nj"><img src="../Images/004cd71f4bd17554e1bf53894c8e8a62.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*U7xFieVJPdel5xUc6a7Ckg.png"/></div></div></figure><h2 id="267a" class="ky kz iq bd la lb lc dn ld le lf dp lg kj lh li lj kn lk ll lm kr ln lo lp lq bi translated">组合器</h2><p id="20fc" class="pw-post-body-paragraph jy jz iq ka b kb lr kd ke kf ls kh ki kj lt kl km kn lu kp kq kr lv kt ku kv ij bi translated">一旦我们将一个事物的邻居聚合成一个单一的向量表示，我们需要将它与该事物本身的向量表示结合起来。一个<em class="kw">组合器</em>通过连接两个向量来实现这一点，并使用单个密集连接的层来降低维度。</p><figure class="nc nd ne nf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nk"><img src="../Images/7afa368494411888ec4068768a96df4b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gdGgUU7g6Fu-St9dWy7pzg.png"/></div></div></figure><h1 id="f915" class="mk kz iq bd la ml mm mn ld mo mp mq lg mr ms mt lj mu mv mw lm mx my mz lp na bi translated">监督 KGCN 分类器</h1><p id="a535" class="pw-post-body-paragraph jy jz iq ka b kb lr kd ke kf ls kh ki kj lt kl km kn lu kp kq kr lv kt ku kv ij bi translated">受监督的 KGCN 分类器负责编排实际的学习。它包含一个 KGCN 实例，对于任何使用 KGCN 的学习者，它提供:</p><ul class=""><li id="c5a8" class="lw lx iq ka b kb kc kf kg kj ly kn lz kr ma kv nl mc md me bi translated"><strong class="ka ir">训练/评估/预测的方法</strong></li><li id="3779" class="lw lx iq ka b kb mf kf mg kj mh kn mi kr mj kv nl mc md me bi translated">从嵌入张量到预测的管道</li><li id="837d" class="lw lx iq ka b kb mf kf mg kj mh kn mi kr mj kv nl mc md me bi translated"><strong class="ka ir">接受预测和标签的损失函数</strong></li><li id="ea8b" class="lw lx iq ka b kb mf kf mg kj mh kn mi kr mj kv nl mc md me bi translated">乐观主义者</li><li id="6bb2" class="lw lx iq ka b kb mf kf mg kj mh kn mi kr mj kv nl mc md me bi translated">反向传播训练循环</li></ul><p id="a4fc" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">必须是提供这些行为的类，因为 KGCN 不与任何特定的学习任务相关联。因此，这门课提供了监督学习框架所需的所有专业知识。</p><p id="d667" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">下面是一个稍微简化的程序流程的 UML 活动图。</p><figure class="nc nd ne nf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/5c02ab5c12351833d560a94e8739dbde.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Zpa1k6_flTVxxMuGtLYayg.png"/></div></div></figure><h1 id="d514" class="mk kz iq bd la ml mm mn ld mo mp mq lg mr ms mt lj mu mv mw lm mx my mz lp na bi translated">使用 KGCNs 构建</h1><p id="2ea7" class="pw-post-body-paragraph jy jz iq ka b kb lr kd ke kf ls kh ki kj lt kl km kn lu kp kq kr lv kt ku kv ij bi translated">要开始使用 KGCNs 进行构建，请查看自述文件的<a class="ae kx" href="https://github.com/graknlabs/kglib/tree/master/kglib/kgcn#quickstart" rel="noopener ugc nofollow" target="_blank">快速入门</a>，确保您具备所有要求，并遵循示例<a class="ae kx" href="https://github.com/graknlabs/kglib/tree/master/kglib/kgcn#usage" rel="noopener ugc nofollow" target="_blank">用法</a>说明，重申如下:</p><figure class="nc nd ne nf gt jr"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="1f7a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这将帮助您为自己的知识图构建一个多类分类器！存储库中还有一个例子，其中有真实的数据，可以填补模板使用中遗漏的任何空白。</p><p id="48f9" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果您喜欢我们正在做的事情，并且您使用 KGCNs 或对其感兴趣，您可以做几件事情:</p><ul class=""><li id="4b29" class="lw lx iq ka b kb kc kf kg kj ly kn lz kr ma kv nl mc md me bi translated">提交<a class="ae kx" href="https://github.com/graknlabs/kglib/issues" rel="noopener ugc nofollow" target="_blank">问题</a>以解决您在安装或使用 KGCNs 时遇到的任何问题</li><li id="f4ea" class="lw lx iq ka b kb mf kf mg kj mh kn mi kr mj kv nl mc md me bi translated">如果你愿意帮助我们提升这部作品的知名度，就开始回购吧:)</li><li id="c855" class="lw lx iq ka b kb mf kf mg kj mh kn mi kr mj kv nl mc md me bi translated">在<a class="ae kx" href="https://discord.com/invite/vaticle" rel="noopener ugc nofollow" target="_blank"> Vaticle Discord channel </a>上提出问题、提出想法或与我们对话</li></ul><p id="8a8c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这篇文章是为<a class="ae kx" href="https://github.com/graknlabs/kglib/releases/tag/v0.1a3" rel="noopener ugc nofollow" target="_blank">第三个 kglib 预发布</a>而写的，使用了 TypeDB commit <code class="fe no np nq nr b">20750ca0a46b4bc252ad81edccdfd8d8b7c46caa</code>，随后可能会与回购不一致。查看那里的最新消息！</p></div></div>    
</body>
</html>