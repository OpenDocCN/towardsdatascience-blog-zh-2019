<html>
<head>
<title>Using the Spotify API with your Android application: the essentials</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在 Android 应用程序中使用 Spotify API:要点</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/using-the-spotify-api-with-your-android-application-the-essentials-1a3c1bc36b9e?source=collection_archive---------4-----------------------#2019-08-27">https://towardsdatascience.com/using-the-spotify-api-with-your-android-application-the-essentials-1a3c1bc36b9e?source=collection_archive---------4-----------------------#2019-08-27</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/816b8f347d473c96f72a7d0a7c43961d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*c9RJj4MmFu079suZV9wbBg.jpeg"/></div></div></figure><h1 id="164b" class="jy jz iq bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">概观</h1><p id="787c" class="pw-post-body-paragraph kw kx iq ky b kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">在本教程中，我将向您展示如何与 Spotify API 进行交互。如何认证、调用和解析结果。我们将发现 Spotify API 的能力，可以获得什么样的信息，以及我们可以对它进行什么样的操作。</p><p id="2c16" class="pw-post-body-paragraph kw kx iq ky b kz lu lb lc ld lv lf lg lh lw lj lk ll lx ln lo lp ly lr ls lt ij bi translated">虽然它是一个 REST API，因此对每个客户端都是一样的，但 iOS、Android 和 Web 的身份验证有很大不同。所以，在这篇文章中，我们将<strong class="ky ir">聚焦于 Android 认证</strong>。我们将要对 API 进行的调用也可以在 iOS 或 web 应用程序中以同样的方式使用。为了在 Android 上创建调用，我们将使用广为人知的凌空框架(【https://github.com/google/volley】<a class="ae lz" href="https://github.com/google/volley" rel="noopener ugc nofollow" target="_blank"/>)。</p><p id="addf" class="pw-post-body-paragraph kw kx iq ky b kz lu lb lc ld lv lf lg lh lw lj lk ll lx ln lo lp ly lr ls lt ij bi translated">所以，我们走吧！</p><p id="ab24" class="pw-post-body-paragraph kw kx iq ky b kz lu lb lc ld lv lf lg lh lw lj lk ll lx ln lo lp ly lr ls lt ij bi translated"><em class="ma">免责声明:Spotify API 可能会发生变化，因此在该功能中，这些调用可能不再有效，或者必须进行更改。如果出现问题，请查阅官方文档。</em></p><div class="mb mc gp gr md me"><a href="https://developer.spotify.com/documentation/web-api/" rel="noopener  ugc nofollow" target="_blank"><div class="mf ab fo"><div class="mg ab mh cl cj mi"><h2 class="bd ir gy z fp mj fr fs mk fu fw ip bi translated">Web API |面向开发者的 Spotify</h2><div class="ml l"><h3 class="bd b gy z fp mj fr fs mk fu fw dk translated">注意:使用 Spotify 开发者工具，即表示您接受 Spotify 开发者服务条款。基于简单的休息…</h3></div><div class="mm l"><p class="bd b dl z fp mj fr fs mk fu fw dk translated">developer.spotify.com</p></div></div><div class="mn l"><div class="mo l mp mq mr mn ms jw me"/></div></div></a></div><h1 id="4647" class="jy jz iq bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">创建 Spotify API 项目</h1><p id="d87a" class="pw-post-body-paragraph kw kx iq ky b kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated"><strong class="ky ir">首先，我们需要创建一个 Spotify API 项目</strong>，以允许我们使用它进行认证。为此，我们前往<a class="ae lz" href="https://developer.spotify.com/dashboard" rel="noopener ugc nofollow" target="_blank">https://developer.spotify.com/dashboard</a>，用我们的 Spotify 账户登录。</p><p id="0208" class="pw-post-body-paragraph kw kx iq ky b kz lu lb lc ld lv lf lg lh lw lj lk ll lx ln lo lp ly lr ls lt ij bi translated"><strong class="ky ir">现在我们必须执行以下步骤:</strong></p><ol class=""><li id="a4d8" class="mt mu iq ky b kz lu ld lv lh mv ll mw lp mx lt my mz na nb bi translated"><strong class="ky ir">点击右上角的“创建客户 ID”</strong></li><li id="aa00" class="mt mu iq ky b kz nc ld nd lh ne ll nf lp ng lt my mz na nb bi translated"><strong class="ky ir">填写表单、名称、描述和我们正在构建的内容(手机应用程序)</strong></li><li id="e6b9" class="mt mu iq ky b kz nc ld nd lh ne ll nf lp ng lt my mz na nb bi translated"><strong class="ky ir">回答我们是否正在开发商业集成。答案:否</strong></li><li id="deb4" class="mt mu iq ky b kz nc ld nd lh ne ll nf lp ng lt my mz na nb bi translated">接受服务条款。</li></ol><p id="267c" class="pw-post-body-paragraph kw kx iq ky b kz lu lb lc ld lv lf lg lh lw lj lk ll lx ln lo lp ly lr ls lt ij bi translated">现在，我们必须将重定向 URI 添加到我们的白名单中。为此，让我们进入“编辑设置”，在“重定向 URIs”下，我们添加要重定向的包名。例如，在我的例子中，这将是<em class="ma">" com . spotifyapiexample://callback "</em>。请注意，在 URI 中不允许有下划线。也可以在知道包名之后再做，但是必须在我们第一次运行应用程序之前完成。</p><p id="12d3" class="pw-post-body-paragraph kw kx iq ky b kz lu lb lc ld lv lf lg lh lw lj lk ll lx ln lo lp ly lr ls lt ij bi translated">很好，现在我们已经完成了，我们可以继续我们的 Android 项目了。</p><h1 id="5a0f" class="jy jz iq bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">创建 Android 项目</h1><p id="078d" class="pw-post-body-paragraph kw kx iq ky b kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">让我们用一个<strong class="ky ir">空活动</strong>创建一个基本的 android 项目。我将调用我的<em class="ma"> Spotify_api_example </em>。请随意选择你的名字。如果您还没有将您的应用程序列入白名单，现在是时候使用“&lt;your _ package name&gt;://callback”来这样做了</p><p id="6554" class="pw-post-body-paragraph kw kx iq ky b kz lu lb lc ld lv lf lg lh lw lj lk ll lx ln lo lp ly lr ls lt ij bi translated">首先，我们需要将 Spotify Android auth 库添加到我们的项目中。从 https://github.com/spotify/android-auth/releases.<a class="ae lz" href="https://github.com/spotify/android-auth/releases." rel="noopener ugc nofollow" target="_blank">下载项目</a> <strong class="ky ir">解压文件夹，并将文件夹复制到项目根目录下的/app/libs 目录下。</strong></p><p id="a564" class="pw-post-body-paragraph kw kx iq ky b kz lu lb lc ld lv lf lg lh lw lj lk ll lx ln lo lp ly lr ls lt ij bi translated"><strong class="ky ir">然后打开你的 build.gradle (Module: app)文件，添加对库的依赖:</strong></p><figure class="nh ni nj nk gt jr"><div class="bz fp l di"><div class="nl nm l"/></div></figure><h1 id="7fd8" class="jy jz iq bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">认证和获取用户信息</h1><p id="8b37" class="pw-post-body-paragraph kw kx iq ky b kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">现在，让我们<strong class="ky ir">创建一个新的活动(空活动)</strong>，我把它叫做 SplashActivity。在这个活动中，我们要做三件事:验证 Spotify API，获取当前用户的一些信息，并在获取令牌和信息后重定向到主活动。</p><p id="9357" class="pw-post-body-paragraph kw kx iq ky b kz lu lb lc ld lv lf lg lh lw lj lk ll lx ln lo lp ly lr ls lt ij bi translated">首先，打开您的<strong class="ky ir"> AndroidManifest.xml </strong>并将启动活动更改为我们新创建的 SplashActivity。此外，将<strong class="ky ir">互联网权限</strong>添加到清单中，这样我们就可以与外界通信了。</p><figure class="nh ni nj nk gt jr"><div class="bz fp l di"><div class="nl nm l"/></div></figure><p id="28fa" class="pw-post-body-paragraph kw kx iq ky b kz lu lb lc ld lv lf lg lh lw lj lk ll lx ln lo lp ly lr ls lt ij bi translated">现在打开你的<strong class="ky ir">水花活动</strong>。让我们创建一个名为<strong class="ky ir"> authenticateSpotify() </strong>的新方法。</p><figure class="nh ni nj nk gt jr"><div class="bz fp l di"><div class="nl nm l"/></div></figure><ul class=""><li id="f211" class="mt mu iq ky b kz lu ld lv lh mv ll mw lp mx lt nn mz na nb bi translated">首先，我们打开一个 AuthenticationRequest，其中包含我们的 ClientID、我们想要的响应类型(在本例中是一个身份验证令牌)和 RedirectURI ( <strong class="ky ir">这个 URI 必须被列入我们在 https://developer.spotify.com/dashboard<a class="ae lz" href="https://developer.spotify.com/dashboard" rel="noopener ugc nofollow" target="_blank"><strong class="ky ir">和</strong> </a>的项目中的白名单)</strong></li><li id="b6dc" class="mt mu iq ky b kz nc ld nd lh ne ll nf lp ng lt nn mz na nb bi translated">然后，我们设置我们请求的范围(例如，用户最近阅读播放)。这些是我们需要向用户请求的不同权限，例如，读取他的个人信息的权限。请求的作用域将显示给用户，他必须将它们授予您的应用程序。</li><li id="c197" class="mt mu iq ky b kz nc ld nd lh ne ll nf lp ng lt nn mz na nb bi translated">最后，我们发送请求。这将打开 Spotify(如果安装了的话)或者返回到用户必须登录的 WebView。REQUEST_CODE 只是一个静态数字(例如 1337)来标识我们刚刚启动的应用程序。</li></ul><p id="e303" class="pw-post-body-paragraph kw kx iq ky b kz lu lb lc ld lv lf lg lh lw lj lk ll lx ln lo lp ly lr ls lt ij bi translated">现在，让我们定义一些我们需要的常量。用您的 ClientID 和 RedirectURI 替换它们。您可以在 Spotify 仪表盘中找到 ClientID。</p><figure class="nh ni nj nk gt jr"><div class="bz fp l di"><div class="nl nm l"/></div></figure><p id="d79a" class="pw-post-body-paragraph kw kx iq ky b kz lu lb lc ld lv lf lg lh lw lj lk ll lx ln lo lp ly lr ls lt ij bi translated">当用户登录时。他将被重定向到您的应用程序。如果请求成功，我们将在那里接收令牌。<strong class="ky ir">将以下内容添加到 SplashActivity 类:</strong></p><figure class="nh ni nj nk gt jr"><div class="bz fp l di"><div class="nl nm l"/></div></figure><p id="d38c" class="pw-post-body-paragraph kw kx iq ky b kz lu lb lc ld lv lf lg lh lw lj lk ll lx ln lo lp ly lr ls lt ij bi translated">用户从 Spotify API 被重定向回来。然后你的应用识别 RequestCode，所以很明显它是从 Spotify 重定向过来的。然后，应用程序检查它是否收到了令牌，并相应地继续进行。我们使用 shared preferences(<a class="ae lz" href="https://developer.android.com/reference/android/content/SharedPreferences" rel="noopener ugc nofollow" target="_blank">https://developer . Android . com/reference/Android/content/shared preferences</a>)将令牌保存在我们的持久存储中。请务必查看评论，进一步了解正在发生的事情。</p><p id="306b" class="pw-post-body-paragraph kw kx iq ky b kz lu lb lc ld lv lf lg lh lw lj lk ll lx ln lo lp ly lr ls lt ij bi translated"><strong class="ky ir">最后，我们必须初始化我们的共享首选项，并调用 authenticateSpotify()方法。</strong>将以下代码添加到您的 SplashActivity 中:</p><figure class="nh ni nj nk gt jr"><div class="bz fp l di"><div class="nl nm l"/></div></figure><p id="60fe" class="pw-post-body-paragraph kw kx iq ky b kz lu lb lc ld lv lf lg lh lw lj lk ll lx ln lo lp ly lr ls lt ij bi translated">恭喜你。我们现在收到了有效的 API 令牌，可以开始使用 Spotify API 了。如果您想尝试一下，请取消对 waitForUserInfo()的注释；调用 onActivityResult。您应该可以使用您的 Spotify 帐户登录。但遗憾的是，其他事情都不会发生。</p><p id="affb" class="pw-post-body-paragraph kw kx iq ky b kz lu lb lc ld lv lf lg lh lw lj lk ll lx ln lo lp ly lr ls lt ij bi translated">我们要打的第一个电话是获取一些关于我们用户的信息。例如，如果您想跟踪谁在使用您的应用程序。您可以通过用户唯一的 Spotify ID 来识别他们。</p><p id="875c" class="pw-post-body-paragraph kw kx iq ky b kz lu lb lc ld lv lf lg lh lw lj lk ll lx ln lo lp ly lr ls lt ij bi translated">让我们首先用我们将从 Spotify API 收到的信息为我们的用户创建一个模型。<strong class="ky ir">创建一个名为“用户”的新类，并添加以下代码:</strong></p><figure class="nh ni nj nk gt jr"><div class="bz fp l di"><div class="nl nm l"/></div></figure><p id="252d" class="pw-post-body-paragraph kw kx iq ky b kz lu lb lc ld lv lf lg lh lw lj lk ll lx ln lo lp ly lr ls lt ij bi translated">现在，为了保持结构化，让我们为将要使用的每个 API 端点创建一个服务类。<strong class="ky ir">创建一个名为“Connectors”的新包，创建一个名为“UserService”的新类，并添加以下代码:</strong></p><figure class="nh ni nj nk gt jr"><div class="bz fp l di"><div class="nl nm l"/></div></figure><p id="4480" class="pw-post-body-paragraph kw kx iq ky b kz lu lb lc ld lv lf lg lh lw lj lk ll lx ln lo lp ly lr ls lt ij bi translated">如果我们查看 Spotify API 文档，我们会发现这个请求非常简单。这是一个对端点的标准 GET 请求，我们只需要我们的承载令牌(在上一步中收到的那个)作为报头。不需要其他参数。</p><figure class="nh ni nj nk gt jr gh gi paragraph-image"><div class="gh gi no"><img src="../Images/cb6c9ffa6365ea56a037cfe17d7fc718.png" data-original-src="https://miro.medium.com/v2/resize:fit:1362/format:webp/1*CCjvPB9gBea30zvozZgzCQ.png"/></div><figcaption class="np nq gj gh gi nr ns bd b be z dk"><a class="ae lz" href="https://developer.spotify.com/documentation/web-api/reference/users-profile/get-current-users-profile/" rel="noopener ugc nofollow" target="_blank">https://developer.spotify.com/documentation/web-api/reference/users-profile/get-current-users-profile/</a></figcaption></figure><p id="4b38" class="pw-post-body-paragraph kw kx iq ky b kz lu lb lc ld lv lf lg lh lw lj lk ll lx ln lo lp ly lr ls lt ij bi translated">这里，我们用 JsonObjectRequest 生成一个基本的 GET 请求。我们简单地用 Gson 和我们创建的用户类解析结果。所以我们创建了一个新的用户对象，一旦我们从 API 得到响应，我们就用结果填充对象的值。VolleyCallBack 接口有助于我们知道何时收到了有效的响应，然后我们可以相应地继续进行。</p><p id="e18a" class="pw-post-body-paragraph kw kx iq ky b kz lu lb lc ld lv lf lg lh lw lj lk ll lx ln lo lp ly lr ls lt ij bi translated"><strong class="ky ir">为了让我们的回调工作，我们创建了一个名为“VolleyCallBack”的新接口</strong></p><figure class="nh ni nj nk gt jr"><div class="bz fp l di"><div class="nl nm l"/></div></figure><p id="e9bb" class="pw-post-body-paragraph kw kx iq ky b kz lu lb lc ld lv lf lg lh lw lj lk ll lx ln lo lp ly lr ls lt ij bi translated">我们只需要一个方法，当请求成功并且我们收到响应时通知我们。</p><p id="3626" class="pw-post-body-paragraph kw kx iq ky b kz lu lb lc ld lv lf lg lh lw lj lk ll lx ln lo lp ly lr ls lt ij bi translated"><strong class="ky ir">现在我们需要在 SplashActivity 类中实现 waitForUserInfo()方法。</strong></p><figure class="nh ni nj nk gt jr"><div class="bz fp l di"><div class="nl nm l"/></div></figure><p id="5199" class="pw-post-body-paragraph kw kx iq ky b kz lu lb lc ld lv lf lg lh lw lj lk ll lx ln lo lp ly lr ls lt ij bi translated">现在，如果您启动您的应用程序，您应该获得您的令牌，获得用户信息，并应被重定向到 MainActivity，它将只显示“Hello World！”。在后台，您的应用程序获取了一个有效的认证令牌，并请求有关登录用户的附加信息。Spotify ID 保存在永久存储器中，因此我们可以在以后再次访问它。我们只需要显示信息。</p><p id="8c1b" class="pw-post-body-paragraph kw kx iq ky b kz lu lb lc ld lv lf lg lh lw lj lk ll lx ln lo lp ly lr ls lt ij bi translated">我们不打算构建一个大的用户界面，本教程的主要目标是向您展示如何获取数据，如何使用数据由您决定。</p><h1 id="85ba" class="jy jz iq bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">获取最近播放的歌曲</h1><p id="72e7" class="pw-post-body-paragraph kw kx iq ky b kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">现在我们已经收到了令牌和用户信息，是时候使用另一个 API 端点了。我们将获取用户最近播放的歌曲。<strong class="ky ir">为你的歌曲</strong>建立一个新的模型，类似于我们已经创建的用户模型。</p><figure class="nh ni nj nk gt jr"><div class="bz fp l di"><div class="nl nm l"/></div></figure><p id="0106" class="pw-post-body-paragraph kw kx iq ky b kz lu lb lc ld lv lf lg lh lw lj lk ll lx ln lo lp ly lr ls lt ij bi translated">接下来，<strong class="ky ir">让我们创建一个非常简单的 UI 来显示 Spotify ID、一首歌曲的标题和一个按钮。</strong></p><figure class="nh ni nj nk gt jr"><div class="bz fp l di"><div class="nl nm l"/></div></figure><p id="4d5a" class="pw-post-body-paragraph kw kx iq ky b kz lu lb lc ld lv lf lg lh lw lj lk ll lx ln lo lp ly lr ls lt ij bi translated">现在让我们编写两个新方法并初始化我们的 UI 元素。</p><figure class="nh ni nj nk gt jr"><div class="bz fp l di"><div class="nl nm l"/></div></figure><p id="63fc" class="pw-post-body-paragraph kw kx iq ky b kz lu lb lc ld lv lf lg lh lw lj lk ll lx ln lo lp ly lr ls lt ij bi translated">在我们的 getTracks()方法中，我们调用了 SongService 方法，该方法将从 API 中获取歌曲。收到数据后，我们将使用 updateSong()方法更新歌曲的名称。</p><p id="9f4b" class="pw-post-body-paragraph kw kx iq ky b kz lu lb lc ld lv lf lg lh lw lj lk ll lx ln lo lp ly lr ls lt ij bi translated">我们需要一个名为 SongService 的新类，我们将从 Spotify API 中获取歌曲。这个类类似于我们实现的 UserService，处理我们发送给 API 的请求。</p><p id="83e1" class="pw-post-body-paragraph kw kx iq ky b kz lu lb lc ld lv lf lg lh lw lj lk ll lx ln lo lp ly lr ls lt ij bi translated">同样，如果我们查看 Spotify API 文档，我们会看到这是一个简单的 GET 请求，除了头中的 Bearer token 之外，没有任何必需的参数。</p><figure class="nh ni nj nk gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nt"><img src="../Images/101b8d2351237bba3d9f65764489d8a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*efiTU6I5Zi9DLtIktdWVAg.png"/></div></div><figcaption class="np nq gj gh gi nr ns bd b be z dk"><a class="ae lz" href="https://developer.spotify.com/console/get-recently-played/" rel="noopener ugc nofollow" target="_blank">https://developer.spotify.com/console/get-recently-played/</a></figcaption></figure><p id="18a6" class="pw-post-body-paragraph kw kx iq ky b kz lu lb lc ld lv lf lg lh lw lj lk ll lx ln lo lp ly lr ls lt ij bi translated">典型的响应如下所示:</p><figure class="nh ni nj nk gt jr"><div class="bz fp l di"><div class="nl nm l"/></div></figure><p id="9217" class="pw-post-body-paragraph kw kx iq ky b kz lu lb lc ld lv lf lg lh lw lj lk ll lx ln lo lp ly lr ls lt ij bi translated"><strong class="ky ir">让我们在 SongService 中实现它</strong></p><figure class="nh ni nj nk gt jr"><div class="bz fp l di"><div class="nl nm l"/></div></figure><figure class="nh ni nj nk gt jr gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/a6f5de2e106ba50f8d809aa04598aa39.png" data-original-src="https://miro.medium.com/v2/resize:fit:640/format:webp/1*azCszKjSFJrhjYDGGdhMbw.png"/></div><figcaption class="np nq gj gh gi nr ns bd b be z dk">The UI should look like this, but feel free to change things around</figcaption></figure><p id="ec46" class="pw-post-body-paragraph kw kx iq ky b kz lu lb lc ld lv lf lg lh lw lj lk ll lx ln lo lp ly lr ls lt ij bi translated">这一次，解析结果比上一次稍微困难一些。因为我们收到了一个<em class="ma"> JSON 数组</em>，所以我们必须遍历那个<em class="ma">数组</em>中的每一项，并将该项分配给我们的<em class="ma"> song 对象</em>。我们像上次对 Gson 那样做。最后，我们返回一个类型为<em class="ma"> &lt; Song &gt; </em>的<em class="ma">数组列表</em>，其中包含了我们从 API 中获取的歌曲。</p><p id="fdfd" class="pw-post-body-paragraph kw kx iq ky b kz lu lb lc ld lv lf lg lh lw lj lk ll lx ln lo lp ly lr ls lt ij bi translated">现在，如果你启动这个应用程序，你应该会看到你最近听过的一首歌的名字。我们只展示一个。这个按钮还不能做任何事情，所以我们来改变它。</p><h1 id="0a19" class="jy jz iq bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">将歌曲添加到您喜欢的歌曲</h1><p id="6bb7" class="pw-post-body-paragraph kw kx iq ky b kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">为我们的按钮创建一个 OnClicklistener，并将其分配给我们的按钮。</p><figure class="nh ni nj nk gt jr"><div class="bz fp l di"><div class="nl nm l"/></div></figure><p id="ce67" class="pw-post-body-paragraph kw kx iq ky b kz lu lb lc ld lv lf lg lh lw lj lk ll lx ln lo lp ly lr ls lt ij bi translated">我们需要生成一个 PUT 请求。这一次我们必须提供一个主体，它必须包含一组 Spotify ID 字符串。我们将在这个数组中只包含一个 ID，因为我们将为每首歌曲生成一个请求。</p><div class="nh ni nj nk gt ab cb"><figure class="nv jr nw nx ny nz oa paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><img src="../Images/6f2d7a570ca6d0d3d2b4eb7a37a8d577.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*4UaCi5O--APkiJBSjnEW1w.png"/></div></figure><figure class="nv jr nw nx ny nz oa paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><img src="../Images/3b38b56a19f5c103a95f3095e1fefde2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*tJ0HUXN2H3yNKcjs0HjnJg.png"/></div><figcaption class="np nq gj gh gi nr ns bd b be z dk ob di oc od"><a class="ae lz" href="https://developer.spotify.com/console/put-current-user-saved-tracks/" rel="noopener ugc nofollow" target="_blank">https://developer.spotify.com/console/put-current-user-saved-tracks/</a></figcaption></figure></div><p id="35ac" class="pw-post-body-paragraph kw kx iq ky b kz lu lb lc ld lv lf lg lh lw lj lk ll lx ln lo lp ly lr ls lt ij bi translated">编辑 SongService 类并添加以下行:</p><figure class="nh ni nj nk gt jr"><div class="bz fp l di"><div class="nl nm l"/></div></figure><p id="767e" class="pw-post-body-paragraph kw kx iq ky b kz lu lb lc ld lv lf lg lh lw lj lk ll lx ln lo lp ly lr ls lt ij bi translated">首先，我们准备主体，这里称为有效载荷。我们生成一个新的 JSONArray，并添加一个带有歌曲 ID 的条目。我们将整个东西包装在一个 JSONObject 中，有效载荷就准备好了。</p><p id="83aa" class="pw-post-body-paragraph kw kx iq ky b kz lu lb lc ld lv lf lg lh lw lj lk ll lx ln lo lp ly lr ls lt ij bi translated">现在我们准备将要发送的请求。这次是一个 PUT 请求，所以方法发生了变化。另外，它类似于我们已经发送的其他请求。最后，我们将请求添加到我们的队列中，因此它将被异步执行。</p><p id="0fd8" class="pw-post-body-paragraph kw kx iq ky b kz lu lb lc ld lv lf lg lh lw lj lk ll lx ln lo lp ly lr ls lt ij bi translated">如果您启动该应用程序，您应该能够看到这首歌，如果您按下添加按钮，它会将这首歌添加到 Spotify 帐户中您喜欢的歌曲中，并且会列出一首新歌，您可以再次将其添加到您的资料库中。继续检查它是否工作。</p><h1 id="ddfc" class="jy jz iq bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">结论</h1><p id="f9e0" class="pw-post-body-paragraph kw kx iq ky b kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">关于 Spotify API 的教程到此结束。这是 Spotify API 可以实现的一个小例子。可能性几乎是无穷无尽的，也许你知道你想用它做什么。不管怎样，祝你编码愉快！</p><p id="9b08" class="pw-post-body-paragraph kw kx iq ky b kz lu lb lc ld lv lf lg lh lw lj lk ll lx ln lo lp ly lr ls lt ij bi translated">看看我的另一个 Android 项目，我用 Spotify API 提供了更多的功能和调用，比如添加和删除播放列表、播放歌曲等等。</p><div class="mb mc gp gr md me"><a href="https://github.com/Hyferion/SpotifyRecLabelingAndroid" rel="noopener  ugc nofollow" target="_blank"><div class="mf ab fo"><div class="mg ab mh cl cj mi"><h2 class="bd ir gy z fp mj fr fs mk fu fw ip bi translated">hyferion/SpotifyRecLabelingAndroid</h2><div class="ml l"><h3 class="bd b gy z fp mj fr fs mk fu fw dk translated">这个应用程序是基于机器学习的应用程序的一部分，用于歌曲的分类和制作…</h3></div><div class="mm l"><p class="bd b dl z fp mj fr fs mk fu fw dk translated">github.com</p></div></div><div class="mn l"><div class="oe l mp mq mr mn ms jw me"/></div></div></a></div><p id="a7b2" class="pw-post-body-paragraph kw kx iq ky b kz lu lb lc ld lv lf lg lh lw lj lk ll lx ln lo lp ly lr ls lt ij bi translated"><strong class="ky ir">另外，你可以在 Github 上找到本教程的代码:</strong></p><div class="mb mc gp gr md me"><a href="https://github.com/Hyferion/spotify_api_example" rel="noopener  ugc nofollow" target="_blank"><div class="mf ab fo"><div class="mg ab mh cl cj mi"><h2 class="bd ir gy z fp mj fr fs mk fu fw ip bi translated">Hyferion/spotify_api_example</h2><div class="ml l"><h3 class="bd b gy z fp mj fr fs mk fu fw dk translated">此时您不能执行该操作。您已使用另一个标签页或窗口登录。您已在另一个选项卡中注销，或者…</h3></div><div class="mm l"><p class="bd b dl z fp mj fr fs mk fu fw dk translated">github.com</p></div></div></div></a></div><p id="a2d0" class="pw-post-body-paragraph kw kx iq ky b kz lu lb lc ld lv lf lg lh lw lj lk ll lx ln lo lp ly lr ls lt ij bi translated">在我的下一篇文章中，我将谈论我在 Spotify API 上开发的另一个应用程序。</p></div></div>    
</body>
</html>