<html>
<head>
<title>Lyrics Generation Model to the Web</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">面向网络的歌词生成模型</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/lyrics-generation-model-to-the-web-f5e03dc5d8b5?source=collection_archive---------40-----------------------#2019-10-15">https://towardsdatascience.com/lyrics-generation-model-to-the-web-f5e03dc5d8b5?source=collection_archive---------40-----------------------#2019-10-15</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/4c5b4eba5d6b88f1bd2f6d35027d8cce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*dMS0VeY7W6baVrzX"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk">Photo by <a class="ae jg" href="https://unsplash.com/@willianjusten?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Willian Justen de Vasconcellos</a> on <a class="ae jg" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h2 id="c05f" class="jh ji jj bd b dl jk jl jm jn jo jp dk jq translated" aria-label="kicker paragraph">迷你项目</h2><div class=""/><div class=""><h2 id="1ea4" class="pw-subtitle-paragraph kp js jj bd b kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg dk translated">一种创建和托管文本生成模型的极简方式</h2></div><p id="bf4b" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">Python 有一个很棒的库，叫做<a class="ae jg" href="https://github.com/minimaxir/textgenrnn" rel="noopener ugc nofollow" target="_blank"> textgenrnn </a>，可以很容易地在你的文本上训练神经网络。我一直使用的<a class="ae jg" href="https://raw.githubusercontent.com/deinal/predict-spotify-top-global/master/data/processedlyrics.txt" rel="noopener ugc nofollow" target="_blank">文本数据</a>由 2017-2019 年期间 Spotify 全球 200 强曲目组成。这是使用 textgenrnn 训练模型所需的全部代码:</p><figure class="md me mf mg gt iv"><div class="bz fp l di"><div class="mh mi l"/></div></figure><p id="60f7" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">它相当快，开箱后就有几个重量文件可供您自己尝试。无论如何，当你有一个训练好的模型时，生成新的文本也同样简单:</p><figure class="md me mf mg gt iv"><div class="bz fp l di"><div class="mh mi l"/></div></figure><p id="4a05" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">大多数时候，输出是可笑的无意义的。这里有一个例子:</p><pre class="md me mf mg gt mj mk ml mm aw mn bi"><span id="e971" class="mo mp jj mk b gy mq mr l ms mt">Hold on, now she got the heart (Oh, it's so safe)<br/>I want you to be my man comes on a time<br/>When I was the light<br/>[Verse 1]<br/>I can't have to change you the beat us (Yeah, yeah)<br/>(Hey, hey, hey, hey, hey)<br/>And I can't pop a bag (I made it)<br/>Hold on, but you don't like what, what you want, where were?<br/>I'm drowning on the morning, she wanna keep going for the morning<br/>I can't have a little bitch (Skrrt)<br/>I can't be a bad llon low<br/>She wanted me a little bit of the booty</span></pre><p id="fedf" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">我把这个上传到网上，让其他人在 lyrics-gen.herokuapp.com 的 T4 试一试。主机是 Heroku 的免费层，因此网站在 30 分钟不活动后会休眠，这意味着如果它碰巧休眠了，可能需要几秒钟才能访问。创作一首歌曲大约需要 15 秒钟。</p><p id="b685" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">我用 Python 的 Flask 库创建了这个站点。<a class="ae jg" href="https://github.com/hd4niel/Lyrics-generation-webpage" rel="noopener ugc nofollow" target="_blank">这个</a>库包含了整个网页。我创建了一个尽可能简单的 main.py 文件，放在我之前训练过的权重所在的文件夹中:</p><figure class="md me mf mg gt iv"><div class="bz fp l di"><div class="mh mi l"/></div></figure><p id="9039" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">函数 generate 使用如上所述的 textgenrnn 来生成歌词。这些可以通过异步 AJAX 请求在 HTML 文件中调用。AJAX 可以更新网页的一部分，而不需要重新加载整个页面。</p><figure class="md me mf mg gt iv"><div class="bz fp l di"><div class="mh mi l"/></div></figure><p id="a684" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">单击 generate 按钮会触发一个 AJAX 函数，该函数从主文件中的 generate 函数接收一个由换行符分隔的字符串作为响应。ajax 方法内部的循环从响应中创建了一个无序列表，最终的列表被传递给 id 为“textlist”的 div 元素。默认情况下，HTML 将项目符号添加到无序列表中，但是在这里通过将 list-style 设置为 none 来删除它们。</p><p id="8808" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">我添加了少量的 CSS 样式和 tadaa，这样我们就完成了:)</p><figure class="md me mf mg gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi mu"><img src="../Images/2c42290f674094fb536ed8746b85d278.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VrZi8xV0atND05M2Q5x7Zg.png"/></div></div></figure><p id="a067" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">TL；DR I 热情推荐<a class="ae jg" href="https://github.com/minimaxir/textgenrnn" rel="noopener ugc nofollow" target="_blank"> textgenrnn </a>用于生成文本，并利用该包创建了一个<a class="ae jg" href="https://lyrics-gen.herokuapp.com" rel="noopener ugc nofollow" target="_blank">网站</a>。</p><p id="a3d2" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">祝你愉快！</p></div></div>    
</body>
</html>