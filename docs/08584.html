<html>
<head>
<title>Fun with StyleGAN: Let’s predict the Tesla CyberTruck design!</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">StyleGAN 的乐趣:让我们预测特斯拉 CyberTruck 的设计！</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/fun-with-stylegan-lets-predict-the-tesla-cybertruck-design-3f2123ab4d0d?source=collection_archive---------35-----------------------#2019-11-19">https://towardsdatascience.com/fun-with-stylegan-lets-predict-the-tesla-cybertruck-design-3f2123ab4d0d?source=collection_archive---------35-----------------------#2019-11-19</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="3d6c" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">当你从一辆旧的<em class="ki">皮卡</em>和一辆<em class="ki">特斯拉 Model X </em>的潜在组合中生成一辆带有<strong class="ak"> StyleGAN </strong>的汽车时，会发生什么？</h2></div><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ko kp l"/></div></figure><p id="0534" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">11 月 21 日，埃隆·马斯克将推出一款新的特斯拉皮卡，他说</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lm kp l"/></div></figure><p id="08f5" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">所以自然地，作为一名数据科学家和特斯拉粉丝，我必须探索人工智能是否可以预测这辆卡车的设计！</p><p id="649e" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">经过数周的尝试和失败，我终于找到了一个名为<a class="ae ln" href="https://github.com/NVlabs/stylegan" rel="noopener ugc nofollow" target="_blank"> <strong class="ks iu"> StyleGAN </strong> </a>的生成式人工智能模型，它可以产生<a class="ae ln" href="https://www.youtube.com/watch?v=OLZ3-ZJwSu4" rel="noopener ugc nofollow" target="_blank">想象中的汽车设计</a>，我用这个模型结合了一辆<em class="lo">皮卡</em>和一辆<em class="lo">特斯拉 Model X </em>的设计，给了我们一个特斯拉卡车的估算设计。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi lp"><img src="../Images/2bcf0b97cd251c9e624003b6b659211f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*nXoTOaKr3WFyHqBWuOW5Zw.gif"/></div><figcaption class="ls lt gj gh gi lu lv bd b be z dk">StyleGAN output for <strong class="bd lw">Old Pickup Truck + Tesla Model X</strong></figcaption></figure><p id="b668" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">在进一步将假想的特斯拉卡车的设计与一辆<a class="ae ln" href="https://i.pinimg.com/originals/4d/5e/1a/4d5e1aae30ceac3f6669ad9126d02dde.jpg" rel="noopener ugc nofollow" target="_blank">装甲运兵车</a>的设计相结合后，我们根据埃隆的描述得到了赛博卡车设计的最佳估计。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi lx"><img src="../Images/3f34ca9191a364332ef11fd5913c925b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1012/format:webp/1*5XzGzwlNN-kM8P93AiRdVw.png"/></div><figcaption class="ls lt gj gh gi lu lv bd b be z dk">Is this what the Tesla CyberTruck will look like? StyleGAN seems to think so.</figcaption></figure><h1 id="2fba" class="ly lz it bd ma mb mc md me mf mg mh mi jz mj ka mk kc ml kd mm kf mn kg mo mp bi translated">理解风格 g</h1><p id="b035" class="pw-post-body-paragraph kq kr it ks b kt mq ju kv kw mr jx ky kz ms lb lc ld mt lf lg lh mu lj lk ll im bi translated">今年早些时候，NVIDIA 的研究人员推出了 StyleGAN   <strong class="ks iu"> </strong>。它最出名的是能够生成看起来非常真实的随机人脸。他们还提供生成汽车的预训练模型，这是我在这个项目中使用的。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi mv"><img src="../Images/38563860020f788207c0de50d84d62e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CP3JlBkxe9U3KAKdLHuanQ.png"/></div></div><figcaption class="ls lt gj gh gi lu lv bd b be z dk">These people are not real. These are random faces generated by StyleGAN. [<a class="ae ln" href="https://github.com/NVlabs/stylegan" rel="noopener ugc nofollow" target="_blank">source</a>]</figcaption></figure><p id="ad7f" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">任何 GAN 方法的典型发生器网络使用从高斯分布提取的随机噪声像素的图像作为起点。然后，它学习将这个有噪声的图像转换为目标分布，在我们的例子中是一辆汽车的图像。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi na"><img src="../Images/d02305c5c870dfa34a69cea6f5327e95.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pxZ6-NH24JV1fMynnGWy4w.png"/></div></div></figure><p id="2bda" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">生成器使用几个卷积层来学习这个目标分布，使用数千个图像样本用于其训练过程。然而，StyleGAN 的工作方式略有不同。它在输入噪声层和卷积层之间引入了一个额外的映射网络。映射网络仅由完全连接的层组成，这些层接收噪声图像并将其转换为一些有意义的潜在空间表示。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi na"><img src="../Images/8ca2a33432f7c28b1652261ea2762377.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Gk334tTpg8Xgi4W84Zo5ZA.png"/></div></div><figcaption class="ls lt gj gh gi lu lv bd b be z dk">Mapping Network in StyleGAN</figcaption></figure><p id="eb3b" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">这个中间的潜在空间包含多个层，其中每一层都表示一个特定的造型元素，生成器在试图生成汽车图像时需要使用该元素。因此，一层可能包含关于汽车颜色的信息，另一层可能包含关于位置和角度的信息，如前视图或后视图。一层可以包含前灯设计的信息等等。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi na"><img src="../Images/9455cfbde9cee3d48d1869122c562dbd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kfd0xwZ67RbZeBSOVu_1pw.png"/></div></div><figcaption class="ls lt gj gh gi lu lv bd b be z dk">The Generator/Synthesis Network of StyleGAN.</figcaption></figure><p id="6bf4" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">现在是斯蒂根模型的生成器。该模型使用小尺度的恒定图像作为在训练过程中学习的起点。几个上采样和卷积层处理这个输入。来自映射网络的中间潜在表示在这里被用于不同的级别，以控制输出汽车图像的设计。这就是 StyleGAN 能够生成随机汽车图像的方式。</p><h1 id="e7d0" class="ly lz it bd ma mb mc md me mf mg mh mi jz mj ka mk kc ml kd mm kf mn kg mo mp bi translated">然而，这里有一个问题。</h1><p id="b714" class="pw-post-body-paragraph kq kr it ks b kt mq ju kv kw mr jx ky kz ms lb lc ld mt lf lg lh mu lj lk ll im bi translated">虽然我们可以使用 StyleGAN 来转换随机噪声输入，使其看起来像汽车，但我们无法控制汽车的设计元素。换句话说，对于任何给定的输入，我们无法控制映射网络的输出。因此，如果我们想为特斯拉 CyberTruck 生成具有特定风格特征的汽车，我们将需要以某种方式修改这种潜在的风格，以符合 CyberTruck 的描述。只有这样，我们才能使用合成网络来可视化汽车的最终输出图像。</p><h1 id="32c2" class="ly lz it bd ma mb mc md me mf mg mh mi jz mj ka mk kc ml kd mm kf mn kg mo mp bi translated">编码器拯救世界。</h1><p id="f90d" class="pw-post-body-paragraph kq kr it ks b kt mq ju kv kw mr jx ky kz ms lb lc ld mt lf lg lh mu lj lk ll im bi translated">谢天谢地，有人为这个问题找到了一个巧妙的解决办法。名为<a class="ae ln" href="https://github.com/Puzer/stylegan-encoder" rel="noopener ugc nofollow" target="_blank"> <strong class="ks iu"> StyleGAN-Encoder </strong> </a>的 github repo 将在这里帮助我们。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi nb"><img src="../Images/c96148662a1610b46196c8abca0da759.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DaGX5psxMlaatAw2XbHOEA.png"/></div></div></figure><p id="f5de" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">使用这个编码器，我们可以训练另一个神经网络，它充当一个<strong class="ks iu">“反向生成器”</strong>。它可以将任何汽车的图像(如特斯拉 Model X)作为其输入，并产生相应的潜在空间作为其输出。一旦潜在空间可用，我们可以对其进行修改，并根据我们的意愿改变输入车的设计。很聪明，对吧？</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi nc"><img src="../Images/1789f26557d6f94c09147fb998b6258e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QaSiiXM69p_z1jYiGSPX1Q.png"/></div></div></figure><p id="1195" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">所以，这里是这个<strong class="ks iu">反向发电机</strong>的工作原理。首先，我们使用一个预训练的 ResNet 模型来转换我们想要改变其设计的汽车的图像，并将其转换为潜在的风格作为其输出。为此生成训练数据非常容易，我们可以简单地使用 StyleGAN 生成器来生成几乎无限的输入-输出样本对。使用这个，我们可以得到一个由 StyleGAN 的映射网络产生的潜在空间的相当不错的估计。</p><p id="efc7" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">但是，仍然有一些更多的优化需要做。一旦我们从 ResNet 获得了对潜在风格的粗略估计，我们就可以用它来生成汽车的相应图像。损失函数现在可以由<a class="ae ln" rel="noopener" target="_blank" href="/perceptual-losses-for-real-time-style-transfer-and-super-resolution-637b5d93fa6d"> <strong class="ks iu"> VGG 感知损失</strong> </a>度量来定义，该度量测量两个输出图像在视觉上看起来有多不同。对于比较图像之间的视觉相似性来说，这是一个比诸如均方误差之类的更健壮的度量。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi nc"><img src="../Images/30d4a7efbd8e843384614225b0ade932.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RAoUXYRehKH9DaMxjKWEPg.png"/></div></div></figure><p id="a915" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">现在，为了优化潜在的风格，我们需要做的就是通过这个组合网络反向传播，同时保持所有网络权重固定。这里唯一允许训练的参数是<strong class="ks iu">输入风格潜伏</strong>。因此，经过几次反复训练后，你可以很快收敛到潜在风格的最佳估计值。</p><h1 id="55cb" class="ly lz it bd ma mb mc md me mf mg mh mi jz mj ka mk kc ml kd mm kf mn kg mo mp bi translated">玩潜伏空间！</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi nc"><img src="../Images/09eb122264ce74a576538c21bb98b5ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PykxR7FaTh7dYwV81NXTAw.png"/></div></div></figure><p id="a029" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">我们现在准备通过组合不同汽车的潜在风格，挑选我们想从哪辆汽车中选择的设计元素，来玩转这种潜在风格。然后，我们可以简单地使用 StyleGAN 生成器来产生混合多种汽车设计的结果。</p><blockquote class="nd ne nf"><p id="60e2" class="kq kr lo ks b kt ku ju kv kw kx jx ky ng la lb lc nh le lf lg ni li lj lk ll im bi translated">我必须承认，和甘斯一起工作时，玩这个潜在空间是你能得到的最大乐趣！</p></blockquote><h1 id="e96a" class="ly lz it bd ma mb mc md me mf mg mh mi jz mj ka mk kc ml kd mm kf mn kg mo mp bi translated">结果:赛博卡车预测！</h1><p id="2e7c" class="pw-post-body-paragraph kq kr it ks b kt mq ju kv kw mr jx ky kz ms lb lc ld mt lf lg lh mu lj lk ll im bi translated">我摆弄了一下这个人工智能，得到了一些关于即将推出的特斯拉 CyberTruck 设计的有趣预测。我将不同的设计风格混合到一辆旧学校皮卡的潜在空间中，得到了 StyleGAN 输出，如下图。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi nc"><img src="../Images/1e6ff25af69b73954ec99906cd2368d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BEW0TRLU6FM65HnUBeG-4g.png"/></div></div></figure><ol class=""><li id="cfbd" class="nj nk it ks b kt ku kw kx kz nl ld nm lh nn ll no np nq nr bi translated">第一个简单地将卡车转换成 Model X 克隆，如果不是因为埃隆·马斯克对网络卡车的疯狂设计想法，这将是一个安全的选择。</li><li id="4cc7" class="nj nk it ks b kt ns kw nt kz nu ld nv lh nw ll no np nq nr bi translated">这就是为什么我认为第二种选择看起来最接近网络卡车的实际样子。它结合了</li><li id="115a" class="nj nk it ks b kt ns kw nt kz nu ld nv lh nw ll no np nq nr bi translated">第三种选择也可能是真的，如果埃隆决定让它看起来像一辆复古的银翼杀手汽车，但不幸的是，它看起来不再像特斯拉汽车。</li></ol><p id="ce6e" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">我投票给最接近真实情况的选项 2。但是，你们觉得呢？你认为赛博卡车看起来会像这些预言中的任何一个吗？或者你认为它会看起来完全不同，一些我们从未见过的东西？请在下面的评论中告诉我！</p><h1 id="722d" class="ly lz it bd ma mb mc md me mf mg mh mi jz mj ka mk kc ml kd mm kf mn kg mo mp bi translated">参考</h1><ol class=""><li id="b2aa" class="nj nk it ks b kt mq kw mr kz nx ld ny lh nz ll no np nq nr bi translated"><a class="ae ln" href="https://www.youtube.com/watch?v=dCKbRCUyop8" rel="noopener ugc nofollow" target="_blank">学习如何用一个生成性对抗网络来变形人脸！</a>由<a class="ae ln" href="https://www.youtube.com/channel/UCNIkB2IeJ-6AmZv7bQ1oBYg" rel="noopener ugc nofollow" target="_blank"> Arxiv 洞察</a></li><li id="1905" class="nj nk it ks b kt ns kw nt kz nu ld nv lh nw ll no np nq nr bi translated"><a class="ae ln" href="https://www.youtube.com/watch?v=Wwwyr7cOBlUFF" rel="noopener ugc nofollow" target="_blank">用 nVidia StyleGAN 和 Python (7.3)生成人脸</a>作者<a class="ae ln" href="https://www.youtube.com/user/HeatonResearch" rel="noopener ugc nofollow" target="_blank">杰夫·希顿</a></li><li id="651e" class="nj nk it ks b kt ns kw nt kz nu ld nv lh nw ll no np nq nr bi translated"><a class="ae ln" href="https://www.youtube.com/watch?v=AQBti_wN414" rel="noopener ugc nofollow" target="_blank"> StyleGAN </a>作者<a class="ae ln" href="https://www.youtube.com/channel/UCHB9VepY6kYvZjj0Bgxnpbw" rel="noopener ugc nofollow" target="_blank">亨利·艾实验室</a></li></ol></div><div class="ab cl oa ob hx oc" role="separator"><span class="od bw bk oe of og"/><span class="od bw bk oe of og"/><span class="od bw bk oe of"/></div><div class="im in io ip iq"><p id="552a" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">感谢您的阅读。如果你喜欢这篇文章，你可以在<a class="ae ln" href="https://medium.com/@chintan.t93" rel="noopener">媒体</a>、<a class="ae ln" href="https://github.com/ChintanTrivedi" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上关注我的更多作品，或者订阅我的<a class="ae ln" href="http://youtube.com/c/DeepGamingAI" rel="noopener ugc nofollow" target="_blank"> YouTube 频道</a>。</p></div></div>    
</body>
</html>