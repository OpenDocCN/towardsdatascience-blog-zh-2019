<html>
<head>
<title>SQL or NoSQL?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">SQL 还是 NoSQL？</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/sql-or-nosql-d3f3e3970635?source=collection_archive---------4-----------------------#2019-12-25">https://towardsdatascience.com/sql-or-nosql-d3f3e3970635?source=collection_archive---------4-----------------------#2019-12-25</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/5d4c28e710339a066c9f57906bb32c50.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FnXnWwqFjWwngipBQ-7C3w.png"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk">Image by <a class="ae jg" href="https://pixabay.com/users/pexels-2286921/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=1834859" rel="noopener ugc nofollow" target="_blank">Pexels</a> from <a class="ae jg" href="https://pixabay.com/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=1834859" rel="noopener ugc nofollow" target="_blank">Pixabay</a></figcaption></figure><div class=""/><div class=""><h2 id="f3bb" class="pw-subtitle-paragraph kg ji jj bd b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dk translated">NoSQL 数据库能做什么而关系数据库不能</h2></div><p id="c60d" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">NoSQL 数据库在现代数据体系结构中越来越受欢迎。它已经成为一种以特定格式存储数据的强大方法，这种格式可以快速处理大量数据。市场上已经有许多 NoSQL 数据库，而新的数据库仍在不断涌现。最流行的分类包括 4 种类型:宽列、文档、键值对和图形。在众多 NoSQL 数据库中，下面列出了几个受欢迎的数据库:</p><ul class=""><li id="5cf7" class="lu lv jj la b lb lc le lf lh lw ll lx lp ly lt lz ma mb mc bi translated">宽柱状:Cassandra、HBase、AWS DynamoDB</li><li id="c299" class="lu lv jj la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">文档:Couchbase，MongoDB，Azure Cosmos DB，AWS DynamoDB</li><li id="3926" class="lu lv jj la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">图形:Neo4J，Azure Cosmos DB，TigerGraph，AWS Neptune</li><li id="4270" class="lu lv jj la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">键值对:AWS 迪纳摩，Redis，甲骨文 NoSQL</li></ul><p id="1923" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">很明显，一个 NoSQL 数据库可以属于一个以上的类别。面对如此多的选择，这也给数据架构师和分析从业者带来了挑战，他们甚至在进行概念验证(POC)或最小可行产品(MVP)之前，就应该选择哪一个以及做出正确决策需要考虑哪些因素。我将这篇文章致力于深入 NoSQL 数据库的一般描述，解释 NoSQL 数据库如何实现关系数据库无法实现的性能。我希望这篇文章能够帮助读者做出正确的决定，首先决定您是否应该使用 NoSQL，如果是，哪些应该是考虑和 POC/MVP 测试的首选。</p><h1 id="560f" class="mi mj jj bd mk ml mm mn mo mp mq mr ms kp mt kq mu ks mv kt mw kv mx kw my mz bi translated"><strong class="ak">关系数据库和规范化</strong></h1><p id="1fc0" class="pw-post-body-paragraph ky kz jj la b lb na kk ld le nb kn lg lh nc lj lk ll nd ln lo lp ne lr ls lt im bi translated">在评论 NoSQL 之前，我们应该对 SQL 和关系数据库有一个很好的理解。关系数据库是英国计算机科学家 Edgar F. Codd 在 1970 年发明的。他的发明导致了 RDBMS(关系数据库管理系统)数据库在随后三十年的成功，包括 IBM DB2、Oracle、Sybase、SQL Server、MySQL 和 PostReg SQL。大约在同一时间，SQL(结构化查询语言)开始活跃起来，成为查询和维护关系数据库的通用语言。</p><p id="928a" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">关系理论引入了规范化的概念，旨在最小化数据冗余和解决数据插入/更新/删除异常，如 Codd 在他的原始论文“数据库关系模型的进一步规范化”中所示:</p><ul class=""><li id="e93d" class="lu lv jj la b lb lc le lf lh lw ll lx lp ly lt lz ma mb mc bi translated">将关系集合从不期望的插入、更新和删除依赖关系中释放出来。</li><li id="35b1" class="lu lv jj la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">随着新的数据类型的引入，减少对关系集合进行重组的需要，从而增加应用程序的寿命。</li><li id="d499" class="lu lv jj la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">使关系模型向用户提供更多信息。</li><li id="67cf" class="lu lv jj la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">使关系的收集与查询统计无关，其中这些统计易于随着时间的推移而改变。</li></ul><p id="3563" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">换句话说，目标是使用相关的“数据集合”通过准确的插入、更新和删除来有效地存储信息。为了实现这些目标，Codd 定义了三种规范化，这是每个关系数据库都应该满足的原则(尽管后来发布了更多的规范化形式，但它们在现实世界中并不常见)。简而言之，在设计关系数据库时，这三种范式会导致以下关键方面:</p><p id="f341" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la jk">第一范式:</strong>数据库应该由表组成；每个表格都有行和列；每行应该有相同数量的列。</p><ul class=""><li id="0215" class="lu lv jj la b lb lc le lf lh lw ll lx lp ly lt lz ma mb mc bi translated">每一列都应该是相同的类型，并且不能有两列同名。</li><li id="986f" class="lu lv jj la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">表中的每一行都应该是唯一的，由一列或多列强制执行，称为“主键”。给定主键，行的顺序无关紧要。</li><li id="4c32" class="lu lv jj la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">列和行相交处的每个单元格应该由一个值组成。</li></ul><p id="9406" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la jk">第二和第三范式:</strong>表中的所有非键列都应该依赖且仅依赖于主键:</p><ul class=""><li id="48ef" class="lu lv jj la b lb lc le lf lh lw ll lx lp ly lt lz ma mb mc bi translated">如果有多个构成主键的列，则非键列应该依赖于所有这些列，而不仅仅是主键的一部分(第二范式)</li><li id="a21c" class="lu lv jj la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">非键列不应依赖于不在主键中的任何列(第三范式)</li></ul><p id="88bc" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">为了实现上述规则，数据被存储在独立逻辑实体的多个表中，其关系由引用另一个表中的主键的“外键”来实施。关系模型导致以最少的数据冗余存储数据的最有效的方式，并使其在表级别非常可扩展，只要明确定义关系并严格遵循三种范式。这些关系还使得一条信息的插入/更新/删除仅发生在一个地方，这消除了潜在的数据不一致问题，同时利用这些关系来维护数据的完整性和准确性，而没有任何信息丢失。最后，SQL 语言成为一种强大的数据库语言，可以从关系数据库中检索任何信息。</p><h1 id="924a" class="mi mj jj bd mk ml mm mn mo mp mq mr ms kp mt kq mu ks mv kt mw kv mx kw my mz bi translated"><strong class="ak"> NoSQL 数据库:与 3 种范式相对</strong></h1><p id="964f" class="pw-post-body-paragraph ky kz jj la b lb na kk ld le nb kn lg lh nc lj lk ll nd ln lo lp ne lr ls lt im bi translated">当 Elgar 发明关系模型时，他可能没有想到一个关系数据库可以分成多少个表，以及当人们试图连接大量的表时会面临什么样的性能问题。一般来说，关系数据库有两个最大的缺点，今天的 NoSQL 数据库试图克服:</p><p id="b8cf" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la jk">刚性</strong>增加列和属性时，典型表现在两个方面:</p><ul class=""><li id="c785" class="lu lv jj la b lb lc le lf lh lw ll lx lp ly lt lz ma mb mc bi translated">对于非结构化或半结构化数据，通常需要动态添加属性，虽然只适用于特定的行，但不是每一行。此外，值可以是不同的类型，很难作为原子值来维护。</li><li id="528d" class="lu lv jj la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">将表和列分解成关系的需要引入了很长的开发周期，包括数据库逻辑和物理设计、复杂查询的开发、测试和生产部署。</li></ul><p id="05ae" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la jk">性能缓慢</strong>当需要连接多个表时，尤其是当一个或多个表存储大量数据时。例如:</p><ul class=""><li id="9f8a" class="lu lv jj la b lb lc le lf lh lw ll lx lp ly lt lz ma mb mc bi translated">当需要连接大型表时，缓慢的性能通常出现在读取中。</li><li id="fce0" class="lu lv jj la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">当需要一次更新多个相关表时，大容量数据加载会带来性能瓶颈。</li></ul><p id="7f83" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">因此，NoSQL 数据库被设计成在数据量大时提供添加信息的灵活性和快速性能，同时牺牲三种范式并容忍数据冗余和插入/更新/删除异常的风险。出于同样的原因，NoSQL 数据库最适合不适合关系数据库设计的半结构化或非结构化数据，以及需要很少约束来增强其准确性的数据场景。此外，大多数 NoSQL 数据库都是为快速读取性能而设计的，代价是降低了频繁更新、插入和删除的速度。</p><p id="40b1" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在市场上，有许多 NoSQL 数据库和不同的分类方式，如键值对、列类型、文档和图表。如果深入研究，大多数 NoSQL 数据库使用两种技术来绕过关系数据库:基于键值对的数据存储和通过水平伸缩实现的反规范化。</p><h2 id="41b4" class="nf mj jj bd mk ng nh dn mo ni nj dp ms lh nk nl mu ll nm nn mw lp no np my nq bi translated"><strong class="ak"> 1。基于键值对的数据存储</strong></h2><p id="37b3" class="pw-post-body-paragraph ky kz jj la b lb na kk ld le nb kn lg lh nc lj lk ll nd ln lo lp ne lr ls lt im bi translated">克服关系表僵化的最常见技术是创建键值对，其中的值可以是任何数据类型，比如数组或文档。显然，这种结构完全抛弃了关系范式。JSON 格式本质上是一组以分层方式组织的键值对，这非常适合面向对象编程(OOP ),并且被大多数 API 使用。大多数 NoSQL 数据库使用键值对或 JSON 格式:</p><ul class=""><li id="e66f" class="lu lv jj la b lb lc le lf lh lw ll lx lp ly lt lz ma mb mc bi translated">键值对:Cassandra、HBase、Redis、Amazon DynamoDB</li><li id="5a48" class="lu lv jj la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">JSON:文档 NoSQL 数据库，如 Mango 和 CouchBase 图形 NoSQL 数据库，如 Neo4j 和 Azure Cosmo。</li></ul><p id="8334" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">键值对为动态添加任何信息提供了极大的灵活性，无需考虑不同行或表之间的关系完整性。此外，键名和值存储在一起，这使得数据检索更有效。索引键后，可以快速检索值。当可能有许多列或字段时，使用键-值对，每个列或字段都被频繁添加，但只用于一小部分数据。该场景通常适用于从不同应用程序和系统收集的文档、调查数据、产品属性或日志数据。</p><p id="36a0" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这种结构的缺点很明显:</p><ul class=""><li id="dd2b" class="lu lv jj la b lb lc le lf lh lw ll lx lp ly lt lz ma mb mc bi translated">难以加强不同属性之间的关系</li><li id="6605" class="lu lv jj la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">难以识别数据冗余</li><li id="ed8c" class="lu lv jj la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">需要更多的存储空间，因为需要存储每个值的键名。</li><li id="21d1" class="lu lv jj la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">特定更新和删除的成本很高。</li><li id="8bf9" class="lu lv jj la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">不适合大量扫描许多数据元素</li></ul><h2 id="c5d2" class="nf mj jj bd mk ng nh dn mo ni nj dp ms lh nk nl mu ll nm nn mw lp no np my nq bi translated"><strong class="ak"> 2。通过水平缩放启用反规格化</strong></h2><p id="cdc9" class="pw-post-body-paragraph ky kz jj la b lb na kk ld le nb kn lg lh nc lj lk ll nd ln lo lp ne lr ls lt im bi translated">提高 NoSQL 数据库性能的一种常见方法是“非规范化”表，即在一个表中存储所有可能的列或字段，这样在检索信息时就不需要连接多个表。在底层，现代 NoSQL 数据库以分布式方式将数据存储在不同服务器上的数据块或分区中，以实现水平扩展。与 Todd 的关系数据库目标完全相反，反规范化提高了数据库读取性能，同时带来了数据冗余和更新/插入/删除异常。在将数据加载到 NoSQL 数据库之前，应将其“连接”或反规范化。因此，它通常需要 ETL 过程来准备数据。对非规范化表的插入、更新和删除可能开销很大，并且还会导致数据不一致，因为无论列位于何处，都需要在多个位置更新该列。</p><p id="e852" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">此外，为了能够从“非规范化”的结构中快速检索，索引键列并以特定的顺序和本地化方式存储数据是所使用的基本技术，但是，这会使写入和加载花费更长的时间。数据结构的“非规范化”本质使得它通常只适合于一种具有一致检索模式的用例。对于不同的用例，应该构建不同的非规范化结构，这会导致数据重复，需要更多的数据存储。换句话说，这种类型的结构适合具有下面列出的三个特征的用例。</p><ol class=""><li id="e7a9" class="lu lv jj la b lb lc le lf lh lw ll lx lp ly lt nr ma mb mc bi translated">存储同质数据，通常用于一个应用程序</li><li id="59ad" class="lu lv jj la b lb md le me lh mf ll mg lp mh lt nr ma mb mc bi translated">处理无限的大容量</li><li id="4072" class="lu lv jj la b lb md le me lh mf ll mg lp mh lt nr ma mb mc bi translated">一致的数据检索模式</li></ol><p id="70fb" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">对每个 NoSQL 数据库的合适用例的详细描述超出了本文的范围。然而，随着对 SQL 和 NoSQL 之间的基本差异的深入理解，我们应该能够在明确特定用例及其需求之后提出正确的问题并选择正确的问题。</p><h1 id="bdc8" class="mi mj jj bd mk ml mm mn mo mp mq mr ms kp mt kq mu ks mv kt mw kv mx kw my mz bi translated"><strong class="ak">结论</strong></h1><p id="7c1b" class="pw-post-body-paragraph ky kz jj la b lb na kk ld le nb kn lg lh nc lj lk ll nd ln lo lp ne lr ls lt im bi translated">对于一个组织来说，关系数据库和 NoSQL 数据库都是需要的，这取决于不同的用例及需求。基于上述基本原理，您甚至可以在开始进行任何 POC、MVP 或实验之前就决定使用哪个数据库。一般来说，当数据量很大并且可以容忍数据冗余时，NoSQL 数据库适合某些类型的应用程序和选择性用例。另一方面，关系数据库。更加通用—它可以处理任何结构化数据，并保证插入/更新/删除的性能和数据质量。一些关系数据库可以有效地处理大数据，如亚马逊红移和雪花，通过利用大规模并行处理(MPP)，同时仍然支持 SQL。最终设计一个性能卓越的大数据系统是一项具有挑战性的任务。它需要完整的数据流，从数据源到数据的最终应用，并考虑大数据架构中的数据库和数据处理，以实现最佳性能(参见我的另外两篇文章:<a class="ae jg" rel="noopener" target="_blank" href="/big-data-architecture-in-data-processing-and-data-access-d03cff195e21">数据处理和数据访问中的大数据架构</a>和<a class="ae jg" rel="noopener" target="_blank" href="/design-principles-for-big-data-performance-cd2c0e9e92bd">大数据性能的设计原则</a>)。</p></div></div>    
</body>
</html>