<html>
<head>
<title>Anomaly detection and forecasting of permeate breakthrough</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">渗透率突破的异常检测和预测</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/anomaly-detection-and-forecasting-of-permeate-breakthrough-e79a1cfaf0a9?source=collection_archive---------24-----------------------#2019-10-17">https://towardsdatascience.com/anomaly-detection-and-forecasting-of-permeate-breakthrough-e79a1cfaf0a9?source=collection_archive---------24-----------------------#2019-10-17</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="8bc9" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在这项工作中，我们评估了各种方法，以预测何时有渗透突破的生化生产过程。自动编码器模型似乎很有前途，但应该与传统的统计过程控制指标相结合，以增加其鲁棒性。</p><p id="bf4d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">同样，指数移动平均线(EMA)和长短期记忆(LSTM)提供了不同的结果。均线平滑时间序列数据，给出一段时间的趋势。这与 LSTM 相结合，使我们能够对未来的渗透值进行预测。</p><p id="27a5" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这个项目的完整代码可以在我的<a class="ae ko" href="https://github.com/PriceTT/DSND-Capstone" rel="noopener ugc nofollow" target="_blank"> <strong class="js iu"> github repo </strong> </a>中找到。</p><h1 id="8019" class="kp kq it bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">超滤过程</h1><p id="e70a" class="pw-post-body-paragraph jq jr it js b jt ln jv jw jx lo jz ka kb lp kd ke kf lq kh ki kj lr kl km kn im bi translated">在食品和生化工业中，使用超滤(UF)是纯化目标产品的关键单元操作。进料进入 UF，根据膜的孔径，大于孔径的物质保留在<strong class="js iu">浓缩液(产品)</strong>中，小于孔径的物质进入<strong class="js iu">透过液(废物)</strong>。</p><figure class="lt lu lv lw gt lx gh gi paragraph-image"><div role="button" tabindex="0" class="ly lz di ma bf mb"><div class="gh gi ls"><img src="../Images/a42934f79d2ec91d3fad7f41c6adbf4c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Rs2k3L4ueVXYBWl8148-YQ.png"/></div></div><figcaption class="me mf gj gh gi mg mh bd b be z dk">Image courtesy <a class="ae ko" href="http://www.crs-reprocessing.com*" rel="noopener ugc nofollow" target="_blank">www.crs-reprocessing.com</a></figcaption></figure><p id="106f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">取决于应用，超滤膜的孔径大约为 10-100 千道尔顿。正因为如此，才有可能分离蛋白质，并通过除去水和盐来增加浓缩物流中蛋白质的浓度，留下感兴趣的产物。</p><figure class="lt lu lv lw gt lx gh gi paragraph-image"><div class="gh gi mi"><img src="../Images/0b35e7ef1b330c2791d50593b4aa5a21.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/1*grRofK6FVN3Q36699eXVmQ.gif"/></div><figcaption class="me mf gj gh gi mg mh bd b be z dk">Image courtesy <a class="ae ko" href="http://www.synderfiltration.com*" rel="noopener ugc nofollow" target="_blank">www.synderfiltration.com</a></figcaption></figure><p id="1988" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">然而，随着时间的推移，膜降解，蛋白质进入渗透。由于渗透物是一种废物流，我们实际上是在扔掉我们想要出售的产品！！！</p><h1 id="6723" class="kp kq it bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">问题陈述</h1><p id="e9cf" class="pw-post-body-paragraph jq jr it js b jt ln jv jw jx lo jz ka kb lp kd ke kf lq kh ki kj lr kl km kn im bi translated">在本项目中，通过分析历史渗透值，目的是检测<strong class="js iu">渗透物突破(渗透物中产品含量高)</strong>并在应该更换超滤膜时向工程师提供反馈，从而使<strong class="js iu">生产过程更加可靠并减少产品损失。</strong></p><p id="f696" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">换句话说，我们希望开发一种稳健的方法来预测何时出现渗透突破，并预测未来的价值。</p><h1 id="22e3" class="kp kq it bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">方法学</h1><p id="ddcd" class="pw-post-body-paragraph jq jr it js b jt ln jv jw jx lo jz ka kb lp kd ke kf lq kh ki kj lr kl km kn im bi translated">比例渗透数据由位于卡伦堡德纳姆克的<em class="mj">诺维信</em>生产工厂提供。</p><figure class="lt lu lv lw gt lx gh gi paragraph-image"><div role="button" tabindex="0" class="ly lz di ma bf mb"><div class="gh gi mk"><img src="../Images/8f95be13418e47eb5d8b646bf7b525af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3g5GmnmaSQdbtvAk9EsMLQ.png"/></div></div></figure><p id="84d0" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">然而，历史突破的时间记录是不一致的。因此，突破的特征将被创造。这四个特征是:</p><ul class=""><li id="8a56" class="ml mm it js b jt ju jx jy kb mn kf mo kj mp kn mq mr ms mt bi translated"><strong class="js iu"> mean_value_scaled </strong>:从 0-1 缩放的原始渗透值。</li><li id="4acb" class="ml mm it js b jt mu jx mv kb mw kf mx kj my kn mq mr ms mt bi translated"><strong class="js iu"> ema_avg: </strong>均线的平均值 _ 缩放值。</li><li id="39a8" class="ml mm it js b jt mu jx mv kb mw kf mx kj my kn mq mr ms mt bi translated"><strong class="js iu">标准:</strong>平均值的标准偏差 _ 缩放</li><li id="fad8" class="ml mm it js b jt mu jx mv kb mw kf mx kj my kn mq mr ms mt bi translated"><strong class="js iu">目标</strong>:1.5σ以上的数值，分为正常(0)和突破(1)</li></ul><p id="ceb1" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">为了检测渗透数据中的异常值(渗透突破)，我们评估了:</p><ul class=""><li id="9e48" class="ml mm it js b jt ju jx jy kb mn kf mo kj mp kn mq mr ms mt bi translated"><a class="ae ko" rel="noopener" target="_blank" href="/machine-learning-for-anomaly-detection-and-condition-monitoring-d4614e7de770">主成分分析</a></li><li id="3855" class="ml mm it js b jt mu jx mv kb mw kf mx kj my kn mq mr ms mt bi translated">一个<a class="ae ko" href="https://www.jeremyjordan.me/autoencoders/" rel="noopener ugc nofollow" target="_blank">自动编码器型号</a></li></ul><p id="75b8" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">为了预测未来渗透值，我们评估了:</p><ul class=""><li id="aa5b" class="ml mm it js b jt ju jx jy kb mn kf mo kj mp kn mq mr ms mt bi translated">EMA 的使用</li><li id="f101" class="ml mm it js b jt mu jx mv kb mw kf mx kj my kn mq mr ms mt bi translated">更加精密的<a class="ae ko" rel="noopener" target="_blank" href="/predicting-stock-price-with-lstm-13af86a74944">T5【LSTM】型号 T7】</a></li></ul><p id="10a4" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">以下指标用于确定模型的表现如何:</p><ul class=""><li id="34cc" class="ml mm it js b jt ju jx jy kb mn kf mo kj mp kn mq mr ms mt bi translated">对于异常/异常值检测，我们将使用准确度和 F 值。</li><li id="8a24" class="ml mm it js b jt mu jx mv kb mw kf mx kj my kn mq mr ms mt bi translated">对于预测，我们将使用测试集的均方误差(MSE)。</li></ul><h1 id="5f80" class="kp kq it bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">结果</h1><p id="a137" class="pw-post-body-paragraph jq jr it js b jt ln jv jw jx lo jz ka kb lp kd ke kf lq kh ki kj lr kl km kn im bi translated"><strong class="js iu">异常值检测</strong></p><p id="0e9a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu"> PCA 分析</strong>显示正常渗透值(蓝色)和异常值(红色)之间存在差异。</p><figure class="lt lu lv lw gt lx gh gi paragraph-image"><div role="button" tabindex="0" class="ly lz di ma bf mb"><div class="gh gi mz"><img src="../Images/27d86019753d86b49ffb3a04582d54e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DHGI_57CFKE6laV23OLdYg.png"/></div></div></figure><p id="3600" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">可以看出，97.5 %的方差可以由前两个主成分(PC)来解释。此外，上面的双图显示了前两个主成分的负荷和得分。对于第一台 PC，所有的特性都是正面的。这是合理的，因为如果<strong class="js iu"> mean_value_scaled </strong>增加，则<strong class="js iu"> std </strong>也会随着<strong class="js iu"> ema_avg </strong>增加(过程中有更多变化)。当包含两个 PC 时，<strong class="js iu"> ema_avg </strong>和<strong class="js iu"> std </strong>的相关性更强，但与<strong class="js iu"> mean_value_scaled </strong>的相关性较弱。</p><blockquote class="na nb nc"><p id="81fb" class="jq jr mj js b jt ju jv jw jx jy jz ka nd kc kd ke ne kg kh ki nf kk kl km kn im bi translated">每个主成分是一个指向最高方差方向的单位向量(在考虑了早期主成分捕获的方差之后)。权重离零越远，主分量在相应特征的方向上就越多。如果两个特征具有相同符号的较大权重(都是正的或都是负的)，那么一个特征的增加会与另一个特征的增加相关联。相比之下，具有不同符号的特征可能会表现出负相关性:一个变量的增加会导致另一个变量的减少。</p></blockquote></div><div class="ab cl ng nh hx ni" role="separator"><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl"/></div><div class="im in io ip iq"><p id="f33e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">同样，更先进的<strong class="js iu">自动编码器型号</strong>能够在测试集上以 0.9715 的准确度分数、0.8438 的精确度分数和 0.7714 的 F 分数捕获何时出现突破。</p><figure class="lt lu lv lw gt lx gh gi paragraph-image"><div role="button" tabindex="0" class="ly lz di ma bf mb"><div class="gh gi mk"><img src="../Images/36dd526517326ae0b1d2c5ced3ee8f67.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Kv3vgGoy__IyUgsKi-iG8A.png"/></div></div></figure><p id="1921" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">黑线是我们认为有突破的目标和标志。蓝色和绿色的线是训练和测试数据集残差。阈值是自动内折器模型识别为异常值的值，在大多数情况下，该值与目标值一致。</p><p id="b5ad" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">以下是自动编码器模型的指标。当您处理一个类不平衡的数据集时，仅准确性并不能说明全部情况，就像这个数据集一样，其中正标签和负标签的数量存在显著差异。因此，我们也将使用 f1 分数，它是<a class="ae ko" href="https://developers.google.com/machine-learning/crash-course/classification/true-false-positive-negative" rel="noopener ugc nofollow" target="_blank">精度和召回</a>的平衡。</p><figure class="lt lu lv lw gt lx gh gi paragraph-image"><div role="button" tabindex="0" class="ly lz di ma bf mb"><div class="gh gi nn"><img src="../Images/57941cfcede828bc219ed3c295cb8bf7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yjTPY-VumQ5Sp1QfbNMlkw.png"/></div></div></figure><p id="06c4" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">上面的 autoencoder 给出了比朴素情况好得多的性能(朴素预测器:[准确度分数:0.0543，F 分数:0.0669])。详见我的<a class="ae ko" href="https://github.com/PriceTT/DSND-Capstone" rel="noopener ugc nofollow" target="_blank">代号</a>。</p></div><div class="ab cl ng nh hx ni" role="separator"><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl"/></div><div class="im in io ip iq"><p id="45b5" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">预测渗透值</strong></p><p id="0904" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">简单的 EMA 在跟踪趋势方面做得很好，但是通常滞后于新数据的移动，如下所示。这一具体分析表明，在使用 EMA 的一个主峰之后，大约需要一年时间才会出现另一个主峰(假设在导致渗透值降低的主峰之后更换膜)。<br/>这实际上比制造商所说的更短，应该接近 2 年。这可能意味着我们需要评估膜的操作和清洁条件，看看这对膜的寿命是否有影响。</p><figure class="lt lu lv lw gt lx gh gi paragraph-image"><div role="button" tabindex="0" class="ly lz di ma bf mb"><div class="gh gi mk"><img src="../Images/b7e9a53d7a29d97a958ec46c396cba33.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0cCApbOfDM1DfLgUHAIFsQ.png"/></div></div></figure></div><div class="ab cl ng nh hx ni" role="separator"><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl"/></div><div class="im in io ip iq"><p id="ce4e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">LSTM</strong>在预测实际渗透值方面表现不佳，但在预测 EMA(如下所示)和标准偏差方面表现出色。与仅使用 EMA 模型相比，这可以用于实现更长期的预测。</p><figure class="lt lu lv lw gt lx gh gi paragraph-image"><div role="button" tabindex="0" class="ly lz di ma bf mb"><div class="gh gi mk"><img src="../Images/b7cfdf5b1da8002ae4e28b6fe912c911.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sxr-9IjZ5EZ9ZYzISSD1Rg.png"/></div></div></figure><h1 id="6f22" class="kp kq it bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm bi translated"><strong class="ak">未来工作</strong></h1><p id="0b50" class="pw-post-body-paragraph jq jr it js b jt ln jv jw jx lo jz ka kb lp kd ke kf lq kh ki kj lr kl km kn im bi translated">在这一分析的基础上，还可以做更多的事情。我想到的几个例子是:</p><ul class=""><li id="0f74" class="ml mm it js b jt ju jx jy kb mn kf mo kj mp kn mq mr ms mt bi translated">不更换膜的机会成本分析。</li><li id="3dba" class="ml mm it js b jt mu jx mv kb mw kf mx kj my kn mq mr ms mt bi translated">LSTM 在预测未来值的均值和标准差方面做得很好。评估我们是否能重建未来价值的概率可能会很有趣。</li><li id="4d14" class="ml mm it js b jt mu jx mv kb mw kf mx kj my kn mq mr ms mt bi translated">应调查梯度的使用或数值之间的%变化。虽然移动平均是一个成功的特征，但考虑到渗透物样品不是以规则的间隔采集的，梯度可以提供更多有用的信息。</li><li id="3020" class="ml mm it js b jt mu jx mv kb mw kf mx kj my kn mq mr ms mt bi translated">评估不同的模型参数:<br/> —损失函数和优化器<br/> —激活函数:relu</li></ul><p id="2125" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">感谢您的阅读，希望这能激发您对该领域的兴趣。欢迎建设性的反馈，如果您发现代码有问题，您可以在<a class="ae ko" href="https://github.com/PriceTT/DSND-Capstone" rel="noopener ugc nofollow" target="_blank"> Github repo </a>中提出问题。</p></div></div>    
</body>
</html>