<html>
<head>
<title>IT Support Ticket Classification and Deployment using Machine Learning and AWS Lambda</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">它使用机器学习和 AWS Lambda 支持票据分类和部署</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/it-support-ticket-classification-and-deployment-using-machine-learning-and-aws-lambda-8ef8b82643b6?source=collection_archive---------2-----------------------#2019-03-15">https://towardsdatascience.com/it-support-ticket-classification-and-deployment-using-machine-learning-and-aws-lambda-8ef8b82643b6?source=collection_archive---------2-----------------------#2019-03-15</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="2bcf" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated"><strong class="ak">支持话单分类和部署</strong></h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/a047ae4e35b7438162b14892908663d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Smt1TdF4vm9Pzaym"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">IT Ticket Classification</figcaption></figure><p id="4fdd" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx ir">项目描述和初始假设:</strong></p><p id="608d" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">作为我们认知计算最终项目的一部分，我们决定解决一个现实生活中的业务挑战，为此我们选择了 IT 服务管理。在所有的商业案例中，我们感兴趣的是可能适合我们项目的四个用户案例。</p><p id="f32a" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">1.在帮助台，几乎 30–40%的事件票证没有发送给正确的团队，票证一直在转来转去，当它到达正确的团队时，问题可能已经广泛传播并到达最高管理层，带来许多麻烦。</p><p id="3479" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">2.假设用户在使用打印机时遇到了一些问题。用户致电帮助台，他在 IT 支持人员的帮助下创建了一个票证，他们意识到需要更新用户系统中的配置，然后他们解决了该票证。如果 10 个其他用户报告了同样的问题，该怎么办？我们可以使用这些数据，并通过使用非结构化数据来分析潜在的问题。此外，我们可以分析趋势并最大限度地减少那些事故单。</p><p id="dd57" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">3.可以响应和处理用户票证的虚拟机器人。</p><p id="079d" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在这三个用例中，由于时间和资源的限制，我们决定先用第一个用例。</p><p id="168d" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx ir">使用的工具和技术:</strong></p><p id="64f8" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">● ServiceNow 实例(IT 服务管理</p><p id="cae6" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">平台)</p><p id="2001" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">● AWS Lambda 功能</p><p id="6723" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">● EC2 实例</p><p id="b1fd" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">● Python</p><p id="bb96" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">●神经网络模型</p><p id="42b1" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">●来自公开来源的 50000 多张样票</p><h2 id="63ac" class="lr ls iq bd lt lu lv dn lw lx ly dp lz le ma mb mc li md me mf lm mg mh mi mj bi translated">流程概述:</h2><p id="b365" class="pw-post-body-paragraph kv kw iq kx b ky mk jr la lb ml ju ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">该过程的整个工作流程可以分成不同的子部分。下图显示了一个非常高层次的概述。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="ab gu cl mp"><img src="../Images/24eace31bfb9bb80ed4c7bcd2babe518.png" data-original-src="https://miro.medium.com/v2/format:webp/1*CFhq_zzLxzyWAwal1pwlrA.png"/></div></figure><p id="81a1" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx ir">数据集:</strong></p><p id="2dfa" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们直接从 servicenow 中提取数据集，并尝试使用 ML 技术对它们进行分类，以制作一个带标签的数据集。我们只是保留了票证中的描述和类别，并继续对其进行分析，以得出事件的前 5 个类别。</p><p id="8208" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">一旦我们使用主题建模对前 5 个事件类别进行了分类，就会添加标签</p><p id="2459" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx ir">用例概述:</strong></p><p id="dac8" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在典型的 IT 环境中，大多数关键问题都以票据的形式得到处理和跟踪。IT 基础设施是网络中连接在一起一组组件。因此，当一个组件发生故障时，它会带走许多其他组件。甚至可能需要几天时间来找出问题所在并找到根本原因。因此，有必要通知部件所有者</p><p id="005f" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">以便采取适当的措施防止这种情况发生。</p><p id="0cb2" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这些问题通常由用户向帮助热线或服务台报告，他们是第一线支持人员。不幸的是，任何人都很难知道所有的组件，因此门票被发送到错误的团队。它到达最初的团队可能需要几天或几周的时间。因此，我们认为可以使用 NLP 来解决这个问题。</p><p id="fae1" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">IT 服务管理平均生成 40 GB 以上的数据。这给了我们足够的数据来训练和实现我们的模型。</p><p id="8dfb" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们的模型如果实施得当，可以为业务部门节省数十亿美元，因为他们会因此失去许多服务级别协议。</p><p id="b7c6" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx ir">基于云计算的 ITSM: </strong></p><p id="0ab3" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在云计算到来之前，这个商业案例几乎是不可能处理的。云计算首先使机器学习算法和 IT 服务管理之间的集成成为可能。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mq"><img src="../Images/d9dc6a789cc9946bb6c574461c19ae19.png" data-original-src="https://miro.medium.com/v2/resize:fit:1166/0*0dFcuAIkTNuIEhcU"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mr"><img src="../Images/8c869d8d4c01a30553ddbf646710567a.png" data-original-src="https://miro.medium.com/v2/resize:fit:596/0*lyLVe-S77_ZDfmb5"/></div></figure><p id="0cc9" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">对于我们的业务案例，我们使用了一个名为 Servicenow 的基于云的 IT 服务管理应用程序，并使用 API gateway 访问了包装在 AWS lambda 函数中的机器学习模型。</p><p id="f6e0" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">【ServiceNow 与 AWS 的集成:</p><p id="54f0" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">Web 服务使应用程序能够通过网络连接到其他软件应用程序，从而允许提供者(服务器)和客户(消费者)之间交换信息。</p><p id="2e13" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">web 服务消费者(客户机)向 web 服务提供者(服务器)请求信息。web 服务提供者处理请求，并返回状态代码和响应正文。当返回响应体时，web 服务消费者从响应体中提取信息，并对提取的数据进行操作。</p><p id="7b85" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">ServiceNow 可以使用来自第三方提供商或其他 ServiceNow 实例的 web 服务。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ms"><img src="../Images/14583995d6590251f4b56d0f34b97980.png" data-original-src="https://miro.medium.com/v2/resize:fit:964/0*5pLWm7FrZAgxp6wN"/></div></figure><p id="1b86" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在我们的例子中，我们使用由 API 网关通过 Rest web 服务触发的端点 url，并使用在创建票证时运行的 javascript 来访问它。</p><p id="0782" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在创建票证时，javascript 被触发，它将事件描述发送到我们放置在 AWS 中的模型，该模型执行机器学习操作并返回预测的类别和概率。</p><h1 id="f3ce" class="mt ls iq bd lt mu mv mw lw mx my mz lz jw na jx mc jz nb ka mf kc nc kd mi nd bi translated"><strong class="ak">用于分类的主题建模</strong></h1><p id="107a" class="pw-post-body-paragraph kv kw iq kx b ky mk jr la lb ml ju ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">即使我们不确定主题是什么，我们也会提前选择主题的数量。</p><p id="2dd7" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">每个文档都表示为主题的分布。</p><p id="fc04" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">每个主题都表示为单词的分布。</p><p id="e92e" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们使用 NLTK 的 Wordnet 来查找单词、同义词、反义词等的含义。另外，我们使用<a class="ae ne" href="http://www.nltk.org/_modules/nltk/stem/wordnet.html" rel="noopener ugc nofollow" target="_blank"> WordNetLemmatizer </a>来获取词根。</p><p id="5c3d" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">然后，我们逐行读取数据集，为 LDA 准备每一行，并存储在一个列表中。</p><h1 id="ce9c" class="mt ls iq bd lt mu mv mw lw mx my mz lz jw na jx mc jz nb ka mf kc nc kd mi nd bi translated"><strong class="ak">带 Gensim 的 LDA</strong></h1><p id="50e9" class="pw-post-body-paragraph kv kw iq kx b ky mk jr la lb ml ju ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">首先，我们从数据中创建一个字典，然后转换成<a class="ae ne" href="https://en.wikipedia.org/wiki/Bag-of-words_model" rel="noopener ugc nofollow" target="_blank">单词袋</a>语料库，并保存字典和语料库以备将来使用。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nf"><img src="../Images/49af1a723cc5c06c573b20293f6a52f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*zNN25XQH0UWcqF5_"/></div></div></figure><p id="985d" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx ir">然后，我们尝试使用 LDA 找出 5 个主题:- </strong></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nf"><img src="../Images/683c5b6d1455ba0c0ac161884622bfac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*4hzPSSMsoC7_s7BO"/></div></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nf"><img src="../Images/f96197daaccd83389633fb35e3b27f3c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*C2LQVVyATj1iWgG-"/></div></div></figure><h1 id="192a" class="mt ls iq bd lt mu mv mw lw mx my mz lz jw na jx mc jz nb ka mf kc nc kd mi nd bi translated">皮尔戴维斯</h1><p id="479a" class="pw-post-body-paragraph kv kw iq kx b ky mk jr la lb ml ju ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">pyLDAvis 旨在帮助用户解释符合文本数据语料库的主题模型中的主题。该软件包从拟合的 LDA 主题模型中提取信息，以通知基于 web 的交互式可视化。</p><h1 id="e7c7" class="mt ls iq bd lt mu mv mw lw mx my mz lz jw na jx mc jz nb ka mf kc nc kd mi nd bi translated"><strong class="ak">可视化 5 个主题:</strong></h1><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nf"><img src="../Images/b982333478447584570ccd69d2e49057.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*uo0mrjpVhoKfVwwF"/></div></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nf"><img src="../Images/66c863004c1329f57406cdee8b88a2e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*qGMX0w2gN9F77a0m"/></div></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nf"><img src="../Images/710321c56d3b05e01f678eef561e0e1f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*WtruZcvr2OeNGAXy"/></div></div></figure><p id="3416" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">通过主题建模，我们得出结论，整个数据集可以分为 5 类</p><p id="5b95" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx ir">网络</strong></p><p id="b320" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx ir">用户维护</strong></p><p id="08cc" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx ir">数据库</strong></p><p id="c4a2" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx ir">应用工作台</strong></p><p id="1ce1" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx ir">安全</strong></p><p id="543c" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">然后，我们相应地标记我们的数据集，并准备一个数据集来对其执行监督学习。</p><h1 id="8e63" class="mt ls iq bd lt mu mv mw lw mx my mz lz jw na jx mc jz nb ka mf kc nc kd mi nd bi translated"><strong class="ak"> RNN 进行分类:- </strong></h1><p id="fad2" class="pw-post-body-paragraph kv kw iq kx b ky mk jr la lb ml ju ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated"><strong class="kx ir">端到端的文本分类管道由以下组件组成:</strong></p><p id="9609" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">1.训练文本:它是输入文本，通过它我们的监督学习模型能够学习和预测所需的类。</p><p id="8d33" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">2.特征向量:特征向量是包含描述输入数据特征的信息的向量。</p><p id="25b8" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">3.标签:这些是我们的模型将预测的预定义类别/类</p><p id="a233" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">4.ML Algo:它是我们的模型能够处理文本分类的算法(在我们的例子中:CNN，，韩)</p><p id="3c0d" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">5.预测模型:在历史数据集上训练的模型，可以执行标签预测。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nf"><img src="../Images/c19324f7be37dc9105166cbb9ebe63bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*CC8WCEdH7OWv3A-o"/></div></div></figure><h1 id="3bf5" class="mt ls iq bd lt mu mv mw lw mx my mz lz jw na jx mc jz nb ka mf kc nc kd mi nd bi translated">使用递归神经网络(RNN)的事件分类:</h1><p id="5235" class="pw-post-body-paragraph kv kw iq kx b ky mk jr la lb ml ju ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated"><a class="ae ne" href="https://en.wikipedia.org/wiki/Recurrent_neural_network" rel="noopener ugc nofollow" target="_blank">递归神经网络(RNN) </a>是一类人工神经网络，其中节点之间的连接沿着序列形成有向图。这允许它展示时间序列的动态时间行为。</p><p id="83af" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">使用来自外部嵌入的知识可以提高 RNN 的精确度，因为它集成了关于单词的新信息(词汇和语义)，这些信息是在非常大的数据语料库上训练和提炼的。我们使用的预训练嵌入是<a class="ae ne" href="https://nlp.stanford.edu/projects/glove/" rel="noopener ugc nofollow" target="_blank">手套</a>。</p><p id="523b" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">RNN 是一系列神经网络模块，它们像链条一样相互连接。每一个都在向下一个传递信息。</p><p id="051c" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">一大块神经网络 AA 查看某个输入 xtxt 并输出一个值 htht。环路允许信息从网络的一个步骤传递到下一个步骤。</p><p id="c0fc" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这些循环使得循环神经网络看起来有点神秘。然而，如果你想得更多一点，就会发现它们与普通的神经网络并没有什么不同。递归神经网络可以被认为是同一网络的多个副本，每个副本都向后继者传递消息。考虑一下如果我们展开循环会发生什么:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nf"><img src="../Images/4f883d13a9093e052de3315a4b3470fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*gh2H1GQgX0cP8UjO"/></div></div></figure><h1 id="e0ec" class="mt ls iq bd lt mu mv mw lw mx my mz lz jw na jx mc jz nb ka mf kc nc kd mi nd bi translated">LSTM 网络公司</h1><p id="e99a" class="pw-post-body-paragraph kv kw iq kx b ky mk jr la lb ml ju ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">长短期记忆网络——通常简称为“lstm”——是一种特殊的 RNN，能够学习长期依赖性。由<a class="ae ne" href="http://www.bioinf.jku.at/publications/older/2604.pdf" rel="noopener ugc nofollow" target="_blank">hoch Reiter&amp;schmid Huber(1997)</a>提出，并在随后的工作中被许多人提炼和推广。它们在各种各样的问题上表现得非常好，现在被广泛使用。</p><p id="b182" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">LSTMs 的明确设计是为了避免长期依赖问题。长时间记住信息实际上是他们的默认行为，而不是他们努力学习的东西！</p><p id="942b" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">所有递归神经网络都具有神经网络重复模块链的形式。在标准 RNNs 中，这种重复模块将具有非常简单的结构，例如单个 tanh 层。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nf"><img src="../Images/fb739e22771fb21ef6ec20422cb93fef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*sXr36I_urscVXpeF"/></div></div></figure><p id="3596" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">标准 RNN 中的重复模块包含一个层。</p><p id="3241" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">LSTMs 也具有这种链状结构，但是重复模块具有不同的结构。不是只有一个神经网络层，而是有四个，以一种非常特殊的方式相互作用。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nf"><img src="../Images/44662bb6f7be31033a8c18bed92a7910.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*WTdjVfDawwN8klE2"/></div></div></figure><p id="554e" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">LSTM 中的重复模块包含四个相互作用的层。</p><p id="051b" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">不要担心正在发生的事情的细节。稍后我们将一步一步地浏览 LSTM 图。现在，让我们试着适应我们将要使用的符号。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nf"><img src="../Images/799a73eaa6ce73e28ad5b73b3a40e397.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*2rVdioi0Dqx6k0Ng"/></div></div></figure><p id="3c31" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在上图中，每条线都承载一个完整的向量，从一个节点的输出到其他节点的输入。粉色圆圈代表逐点操作，如向量加法，而黄色方框是学习过的神经网络层。行合并表示连接，而行分叉表示其内容被复制，并且副本被移动到不同的位置。</p><h1 id="4583" class="mt ls iq bd lt mu mv mw lw mx my mz lz jw na jx mc jz nb ka mf kc nc kd mi nd bi translated">LSTMs 背后的核心理念</h1><p id="e8d0" class="pw-post-body-paragraph kv kw iq kx b ky mk jr la lb ml ju ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">LSTMs 的关键是单元状态，即贯穿图表顶部的水平线。</p><p id="7e23" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">细胞状态有点像传送带。它沿着整个链条直线向下，只有一些微小的线性相互作用。信息很容易不加改变地沿着它流动。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nf"><img src="../Images/26ae392b7f32f61103f4df143694d8d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*5vRetcxB-hO-o0QV"/></div></div></figure><p id="8698" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">LSTM 确实有能力删除或添加细胞状态的信息，由称为门的结构仔细调节。</p><p id="eaee" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">门是选择性地让信息通过的一种方式。它们由一个 sigmoid 神经网络层和一个逐点乘法运算组成。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/343b750abfceff0e4376488cac922164.png" data-original-src="https://miro.medium.com/v2/resize:fit:824/0*xPY_MUDD8q4qBwR0"/></div></figure><p id="5813" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">sigmoid 层输出 0 到 1 之间的数字，描述每种成分应该通过多少。值为 0 表示“不允许任何东西通过”，而值为 1 表示“允许任何东西通过！”</p><p id="05ed" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">一个 LSTM 有三个这样的门，用来保护和控制细胞状态。</p><h1 id="50af" class="mt ls iq bd lt mu mv mw lw mx my mz lz jw na jx mc jz nb ka mf kc nc kd mi nd bi translated">LSTM 按部就班地走过</h1><p id="a762" class="pw-post-body-paragraph kv kw iq kx b ky mk jr la lb ml ju ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">LSTM 的第一步是决定我们要从细胞状态中丢弃什么信息。这个决定是由一个称为“忘记栅极层”的 sigmoid 层做出的。它查看 ht 1 ht 1 和 xtxt，并为单元状态 Ct 1 Ct 1 中的每个数字输出一个介于 00 和 11 之间的数字。11 代表“完全保留这个”，00 代表“完全摆脱这个”</p><p id="0a35" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">让我们回到我们的例子，一个语言模型试图根据所有前面的单词预测下一个单词。在这样的问题中，单元状态可能包括当前主题的性别，以便可以使用正确的代词。当我们看到一个新的主题时，我们想忘记旧主题的性别。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nf"><img src="../Images/c8bb7b662167cc6e990a731b549f5cbb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*gVC8LLRxK5Rqicix"/></div></div></figure><p id="8177" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">下一步是决定我们要在单元格状态中存储什么新信息。这有两个部分。首先，一个称为“输入门层”的 sigmoid 层决定我们要更新哪些值。接下来，tanh 层创建一个新的候选值向量，C̃ tC~t，可以添加到状态中。在下一步中，我们将结合这两者来创建状态更新。</p><p id="5ba8" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在我们的语言模型的例子中，我们希望将新主体的性别添加到细胞状态中，以替换我们遗忘的旧主体。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nf"><img src="../Images/5522d41cf0043e52d25477330dd4eddb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*u08BvGqvkrVVLDna"/></div></div></figure><p id="2f56" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">现在应该将旧的单元状态 ct1ct 1 更新为新的单元状态 CtCt。前面的步骤已经决定了要做什么，我们只需要实际去做。</p><p id="ddaf" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们用 ftft 乘以旧状态，忘记了我们早先决定忘记的事情。然后，我们添加 it∗c̃tit∫c ~ t。这是新的候选值，由我们决定更新每个状态值的多少来缩放。</p><p id="400f" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在语言模型的情况下，这是我们实际删除旧主题的性别信息并添加新信息的地方，正如我们在前面的步骤中决定的那样。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nf"><img src="../Images/0193aca49f058eef7b976dfa9385707d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*r6SjPZZDo6w_oz2M"/></div></div></figure><p id="0b0e" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">最后，我们需要决定我们要输出什么。该输出将基于我们的单元状态，但将是过滤后的版本。首先，我们运行一个 sigmoid 层，它决定我们要输出细胞状态的哪些部分。然后，我们通过 tanhtanh 设置单元状态(将值推至 11 和 11 之间)，并乘以 sigmoid 门的输出，这样我们只输出我们决定的部分。</p><p id="94c5" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">对于语言模型示例，由于它刚刚看到了一个主题，它可能希望输出与一个动词相关的信息，以防接下来会出现这个信息。例如，它可能输出主语是单数还是复数，这样我们就知道一个动词应该变成什么形式，如果接下来是什么的话。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nf"><img src="../Images/f2978ec930b7344bd5e2fd38420ea439.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*u9GKdha2O9hQ6utA"/></div></div></figure><h1 id="4699" class="mt ls iq bd lt mu mv mw lw mx my mz lz jw na jx mc jz nb ka mf kc nc kd mi nd bi translated">长短期记忆的变异</h1><p id="be81" class="pw-post-body-paragraph kv kw iq kx b ky mk jr la lb ml ju ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">到目前为止，我所描述的是一个非常正常的 LSTM。但并不是所有的 LSTMs 都和上面的一样。事实上，似乎几乎所有涉及 LSTMs 的论文都使用了稍微不同的版本。这些差异很小，但其中一些值得一提。</p><p id="965b" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">由 Gers &amp; Schmidhuber (2000)提出的一个流行的 LSTM 变体，是增加“窥视孔连接”这意味着我们让栅极层查看单元状态。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nf"><img src="../Images/9a82938627ec6b520a2bdc8935d7659a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*-GArC5chQx87R9-y"/></div></div></figure><p id="1bd6" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">上图给所有的门都加了窥视孔，但是很多论文会给一些窥视孔而不给另一些。</p><p id="dd72" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">另一种变化是使用耦合的遗忘和输入门。我们一起做决定，而不是分别决定忘记什么和应该添加什么新信息。我们只会忘记何时在它的位置输入东西。只有当我们忘记旧的东西时，我们才会向状态输入新的值。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nf"><img src="../Images/0a648cc981b1d6d97fcd68926d582baf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*QXN83SnXhE1AGfPQ"/></div></div></figure><p id="771f" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">LSTM 的一个稍微戏剧性的变化是门控循环单元，或 GRU，由<a class="ae ne" href="http://arxiv.org/pdf/1406.1078v3.pdf" rel="noopener ugc nofollow" target="_blank"> Cho 等人(2014) </a>引入。它将遗忘门和输入门合并成一个“更新门”它还合并了单元格状态和隐藏状态，并进行一些其他更改。由此产生的模型比标准的 LSTM 模型更简单，而且越来越受欢迎。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nf"><img src="../Images/f8bdb665dc17e8bcaa24633ec65d4401.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*cnS8G3-fREL7gw0t"/></div></div></figure><h1 id="81ae" class="mt ls iq bd lt mu mv mw lw mx my mz lz jw na jx mc jz nb ka mf kc nc kd mi nd bi translated"><strong class="ak">我们的建筑</strong></h1><h2 id="7ad9" class="lr ls iq bd lt lu lv dn lw lx ly dp lz le ma mb mc li md me mf lm mg mh mi mj bi translated"><strong class="ak">通用型号</strong></h2><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nf"><img src="../Images/41f183c25cbbbd74db4cf67115a8245f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*5ljBH8AhAIlJLlFd"/></div></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nf"><img src="../Images/b2296ed0f52182f11b9d5a15308fc5b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*8QpudeVTcg4Vkasp"/></div></div></figure><h2 id="eec1" class="lr ls iq bd lt lu lv dn lw lx ly dp lz le ma mb mc li md me mf lm mg mh mi mj bi translated"><strong class="ak"> LSTM 车型</strong></h2><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nf"><img src="../Images/f82d6df19751fb6395e07f39a40309d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*7gZtKOedpyVhZGyf"/></div></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nf"><img src="../Images/aec3ad48d959f38385be956698d67f78.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*qmboeM5FFhDtoz2_"/></div></div></figure><p id="d7c5" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">要在文本数据上使用 Keras，我们首先必须对其进行预处理。为此，我们可以使用 Keras 的 Tokenizer 类。该对象将 num_words 作为参数，它是基于词频进行标记化后保留的最大单词数。</p><p id="e0f4" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">一旦在数据上安装了标记器，我们就可以用它将文本字符串转换成数字序列。这些数字代表每个单词在字典中的位置(可以把它想象成映射)。</p><p id="42fc" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在这个项目中，我们试图通过使用递归神经网络和基于注意力的 LSTM 编码器来解决这个问题。</p><p id="1982" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">通过使用 LSTM 编码器，我们打算在运行前馈网络进行分类之前，在递归神经网络的最后输出中编码文本的所有信息。</p><p id="94e6" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这非常类似于神经翻译机器和序列到序列学习。</p><p id="70fc" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们在 Keras 中使用 LSTM 层来解决长期依赖的问题。</p><h1 id="6288" class="mt ls iq bd lt mu mv mw lw mx my mz lz jw na jx mc jz nb ka mf kc nc kd mi nd bi translated"><strong class="ak">模型评分和选择</strong></h1><p id="747c" class="pw-post-body-paragraph kv kw iq kx b ky mk jr la lb ml ju ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">我们的模型评分和选择基于标准评估指标准确度、精确度和 F1 分数，定义如下:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nh"><img src="../Images/8f3bee74e65afa672c2843a53e9f6fd4.png" data-original-src="https://miro.medium.com/v2/resize:fit:836/0*cLWRMvOT4DlweDu4"/></div></div></figure><p id="30ab" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">其中:</p><p id="df91" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">TP 代表真正分类的数目。也就是说，具有实际标签 A 的记录已被正确分类或“预测”为标签 A。</p><p id="34ec" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">TN 是真否定分类的数量。也就是说，实际标签不等于 A 的记录已被正确分类为不属于标签 A。</p><p id="8e0b" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">FP 是假阳性分类的数量，即实际标签不是 A 的记录被错误地分类为属于类别 A。</p><p id="de7d" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">FN 是假阴性的数量，即标签等于 A 的记录被错误地分类为不属于类别 A。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ni"><img src="../Images/05e45e2947badaceffc2e093b4b31d41.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*gzcNheDrLxH6Q54t"/></div></div></figure><p id="073c" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx ir">图 3。预测分类与实际分类的“混淆矩阵”</strong></p><p id="b722" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">预测和实际分类的组合被称为“混淆矩阵”，如图 3 所示。在这些定义的背景下，各种评估指标提供了以下见解:</p><p id="ef62" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">准确性:正确的模型预测总数的比例。</p><p id="6ba1" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">精确度(也称为正面预测值):正确预测相对于该特定类别所有预测的比例。</p><p id="e88e" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">召回率(也称为真阳性率、TPR、命中率或敏感度):真阳性相对于所有实际阳性的比例。</p><p id="b19f" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">假阳性率(也称为假警报率):假阳性相对于所有实际阴性的比例(FPR)。</p><p id="c230" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">F1:(更稳健的)精确度和召回率的调和平均值。</p><h1 id="3259" class="mt ls iq bd lt mu mv mw lw mx my mz lz jw na jx mc jz nb ka mf kc nc kd mi nd bi translated"><strong class="ak">输出:- </strong></h1><h2 id="5757" class="lr ls iq bd lt lu lv dn lw lx ly dp lz le ma mb mc li md me mf lm mg mh mi mj bi translated"><strong class="ak">通用 RNN 型号:- </strong></h2><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nj"><img src="../Images/d50297852d3f4b563471998a0675e13b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*3o6vMabqbx8MImvZ"/></div></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nf"><img src="../Images/8a27972da7881d98db2f115fddf805f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*yRZkt8Sohlphaapp"/></div></div></figure><h2 id="12b7" class="lr ls iq bd lt lu lv dn lw lx ly dp lz le ma mb mc li md me mf lm mg mh mi mj bi translated"><strong class="ak"> RNN 与 LSTM 层</strong></h2><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nj"><img src="../Images/7c18bda1d889dbc912d840aaacfc3215.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*xbGo8pK3xgzeIrs-"/></div></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nf"><img src="../Images/2759dc941b95720091a7e2a9186675e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*vyAmYBr3L4ax3q3V"/></div></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nf"><img src="../Images/34902410ffc23d065a380a2aff69a82e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*4wFn2cVTTG02jJ0G"/></div></div></figure><h1 id="d39f" class="mt ls iq bd lt mu mv mw lw mx my mz lz jw na jx mc jz nb ka mf kc nc kd mi nd bi translated"><strong class="ak">观察:- </strong></h1><p id="6340" class="pw-post-body-paragraph kv kw iq kx b ky mk jr la lb ml ju ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">没有 LSTM 的一般 RNN 模型为我们提供了 66%的准确性，而我们能够使用 RNN 的 LSTM 网络层将其提高到 69%</p><p id="9c1d" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">低数据量导致准确性在 70%后几乎停滞不前，我们是否增加图中明显的时期并不重要。</p><p id="c39f" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">然而，69%是足够公平的分类，因为我们打算在线训练它，并随着数据量增长到更高的程度而不断提高准确性。</p><h1 id="3c48" class="mt ls iq bd lt mu mv mw lw mx my mz lz jw na jx mc jz nb ka mf kc nc kd mi nd bi translated"><strong class="ak">模型部署</strong></h1><p id="4aa2" class="pw-post-body-paragraph kv kw iq kx b ky mk jr la lb ml ju ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">对于这个项目的范围，我们计划在亚马逊 AWS 上部署模型，并将其与服务集成，以便模型进行在线或实时预测。为此，我们将首先通过将模型转储到 pickle 文件中来导出模型。此外，我们将编写一个连接到 S3 桶的函数，从那里读取 pickle 文件并重新创建模型。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/7ed6968599244d34da7dfeb86ce3c8d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1058/0*Q1tpcIeQWH36j3SQ"/></div></figure><p id="6cae" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">所以工作流程看起来是这样的:</p><ol class=""><li id="e715" class="nl nm iq kx b ky kz lb lc le nn li no lm np lq nq nr ns nt bi translated">立即创建服务中的事件</li><li id="e3f3" class="nl nm iq kx b ky nu lb nv le nw li nx lm ny lq nq nr ns nt bi translated">事件在 AWS 中接收，并且我们的 AWS EC2 实例或服务正在运行</li><li id="fa14" class="nl nm iq kx b ky nu lb nv le nw li nx lm ny lq nq nr ns nt bi translated">从 S3 桶中获取 function.py 文件，该文件将从 Pickle 文件中读取模型并重新创建模型</li><li id="deb0" class="nl nm iq kx b ky nu lb nv le nw li nx lm ny lq nq nr ns nt bi translated">它将从服务请求中提取特征，即事件描述</li><li id="f3e3" class="nl nm iq kx b ky nu lb nv le nw li nx lm ny lq nq nr ns nt bi translated">现在，代码将在 AWS Lambda 中执行，它将为我们提供事件所属的类别</li><li id="9dac" class="nl nm iq kx b ky nu lb nv le nw li nx lm ny lq nq nr ns nt bi translated">在 AWS 上创建 EC2 实例:-</li><li id="bce6" class="nl nm iq kx b ky nu lb nv le nw li nx lm ny lq nq nr ns nt bi translated">首先，创建一个 AWS 帐户，它将让你免费使用一年的一些有限的服务，但对这个项目来说已经足够了</li><li id="89a3" class="nl nm iq kx b ky nu lb nv le nw li nx lm ny lq nq nr ns nt bi translated">创建一个 EC2 实例并选择自由层机器，或者如果您的帐户中有信用并且需要一个更强大的机器，您可以从其他选项中选择</li><li id="6f20" class="nl nm iq kx b ky nu lb nv le nw li nx lm ny lq nq nr ns nt bi translated">在 AWS 上为 Python 配置一个虚拟运行时环境，完成后，将所有配置文件压缩到一个文件中，并在压缩文件中包含 function.py 文件，因为我们将在 AWS S3 存储桶中上传该文件</li><li id="64d9" class="nl nm iq kx b ky nu lb nv le nw li nx lm ny lq nq nr ns nt bi translated">创建一个 S3 桶并上传包含模型详细信息(如模型名称、超参数和模型权重)的 pickle 文件，还上传包含 function.py 文件以及 python 虚拟环境配置设置的 zip 文件</li></ol><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nz"><img src="../Images/06b955cf504950194da50e3b0461b0ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Mh0Y2xTFL80Q5Ca3"/></div></div></figure><ol class=""><li id="5efa" class="nl nm iq kx b ky kz lb lc le nn li no lm np lq nq nr ns nt bi translated">现在，最后设置 AWS Lambda，这是我们将运行 python 脚本并进行预测的地方</li></ol><p id="302e" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">AWS Lambda 是一种计算服务，让您无需配置或管理服务器就可以运行代码。它会自己处理那部分。AWS Lambda 最棒的一点是，你只需为你消耗的计算时间付费——当你的代码不运行时，是不收费的。有了 AWS Lambda，您几乎可以为任何类型的应用程序或后端服务运行代码——所有这些都无需管理。AWS Lambda 在高可用性计算基础设施上运行您的代码，并执行计算资源的所有管理，包括服务器和操作系统维护、容量供应和自动扩展、代码监控和日志记录。你所需要做的就是用 AWS Lambda 支持的语言之一来提供你的代码。</p><p id="1662" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">虽然我们无法配置 AWS lambda，因为我们都不熟悉它，必须浏览文档，时间不够。我们计划将该项目扩展到我们的其他课程并完成它。一旦我们达到目标，我们将更新博客。</p><h1 id="0c51" class="mt ls iq bd lt mu mv mw lw mx my mz lz jw na jx mc jz nb ka mf kc nc kd mi nd bi translated">ServiceNow 和 AWS 之间的集成:</h1><p id="82f0" class="pw-post-body-paragraph kv kw iq kx b ky mk jr la lb ml ju ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">Web 服务使应用程序能够通过网络连接到其他软件应用程序，从而允许提供者(服务器)和客户(消费者)之间交换信息。</p><p id="3ce2" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">web 服务消费者(客户机)向 web 服务提供者(服务器)请求信息。web 服务提供者处理请求，并返回状态代码和响应正文。当返回响应体时，web 服务消费者从响应体中提取信息，并对提取的数据进行操作。</p><p id="f2ff" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">ServiceNow 可以使用来自第三方提供商或其他 ServiceNow 实例的 web 服务。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ms"><img src="../Images/2f41131a5073734294427c5809642ca5.png" data-original-src="https://miro.medium.com/v2/resize:fit:964/0*kuC6v7R5xJjRVf7V"/></div></figure><p id="92e1" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在我们的例子中，我们使用 API 网关通过 Rest web 服务触发的端点 url，并使用创建票证时运行的 javascript 访问它。</p><p id="6229" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在创建票证时，javascript 被触发，它将事件描述发送到我们放置在 AWS 中的模型，该模型执行机器学习操作并返回预测的类别和概率。</p><h1 id="e9c0" class="mt ls iq bd lt mu mv mw lw mx my mz lz jw na jx mc jz nb ka mf kc nc kd mi nd bi translated">未来范围:</h1><p id="f5cd" class="pw-post-body-paragraph kv kw iq kx b ky mk jr la lb ml ju ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">这个项目还没有完成，因为我们时间不够。我们正在进行这个项目，我们计划推进这个项目，以便我们可以在 AWS 上部署我们的代码，并将其与服务集成。一有进展，我们就会更新博客。:)</p><p id="3753" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx ir"> Github 链接:- </strong></p><p id="7f02" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">https://github.com/pankajkishore/Cognitive-Project<a class="ae ne" href="https://github.com/pankajkishore/Cognitive-Project" rel="noopener ugc nofollow" target="_blank"/></p><p id="330e" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx ir">资源:- </strong></p><p id="fc39" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><a class="ae ne" href="https://medium.com/jatana/report-on-text-classification-using-cnn-rnn-han-f0e887214d5f" rel="noopener">https://medium . com/jatana/report-on-text-class ification-using-CNN-rnn-Han-f0e 887214 d5f</a></p><p id="adec" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><a class="ae ne" href="https://medium.com/datadriveninvestor/automation-all-the-way-machine-learning-for-it-service-management-9de99882a33" rel="noopener">https://medium . com/datadriveninvestor/automation-all-the-way-machine-learning-for-it-service-management-9de 99882 a 33</a></p><div class="oa ob gp gr oc od"><a href="https://github.com/karolzak/support-tickets-classification" rel="noopener  ugc nofollow" target="_blank"><div class="oe ab fo"><div class="of ab og cl cj oh"><h2 class="bd ir gy z fp oi fr fs oj fu fw ip bi translated">karolzak/support-门票-分类</h2><div class="ok l"><h3 class="bd b gy z fp oi fr fs oj fu fw dk translated">这个案例研究展示了如何为文本分析和分类创建一个模型，并将其作为 web 服务部署在…</h3></div><div class="ol l"><p class="bd b dl z fp oi fr fs oj fu fw dk translated">github.com</p></div></div><div class="om l"><div class="on l oo op oq om or kp od"/></div></div></a></div><p id="1d1a" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">作者:<a class="ae ne" href="https://www.linkedin.com/in/pankajkishore89/" rel="noopener ugc nofollow" target="_blank"> Pankaj Kishore </a>，<a class="ae ne" href="https://www.linkedin.com/in/anujasrivastava/" rel="noopener ugc nofollow" target="_blank"> Anuja Srivastava </a>，<a class="ae ne" href="https://www.linkedin.com/in/jitender-phogat/" rel="noopener ugc nofollow" target="_blank"> Jitender Phogat </a>和<a class="ae ne" href="https://www.linkedin.com/in/karthik-kumar-longhorn/" rel="noopener ugc nofollow" target="_blank"> Karthik Kandakumar </a></p></div></div>    
</body>
</html>