<html>
<head>
<title>Modeling Telecom Customer Churn with Variational Autoencoder</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">基于变分自动编码器的电信客户流失建模</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/modeling-telecom-customer-churn-with-variational-autoencoder-4e5cf6194871?source=collection_archive---------10-----------------------#2019-02-19">https://towardsdatascience.com/modeling-telecom-customer-churn-with-variational-autoencoder-4e5cf6194871?source=collection_archive---------10-----------------------#2019-02-19</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="ip iq gp gr ir is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/08ec4bccf5c1298a86e64a7cc87c4ddf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vUh05q4iQjhXgtiT6ktu2Q.jpeg"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Photo credit: Pixabay</figcaption></figure><div class=""/><div class=""><h2 id="722f" class="pw-subtitle-paragraph kc je jf bd b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt dk translated">如何应用<strong class="ak">深度卷积神经网络和自动编码器</strong>建立<strong class="ak">流失</strong>预测模型。</h2></div><p id="49a0" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">An <a class="ae lq" href="https://en.wikipedia.org/wiki/Autoencoder" rel="noopener ugc nofollow" target="_blank"> <strong class="kw jg"> autoencoder </strong> </a>是深度学习对降维的回答。这个想法非常简单:通过一系列隐藏层来转换输入，但要确保最终的输出层与输入层具有相同的维度。然而，插入的隐藏层具有逐渐减少的节点数量(因此，减少了输入矩阵的维数)。如果输出与输入紧密匹配或编码，则最小隐藏层的节点可以作为有效的降维数据集。</p><p id="44f6" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated"><a class="ae lq" href="http://kvfrans.com/variational-autoencoders-explained/" rel="noopener ugc nofollow" target="_blank"> <strong class="kw jg">变分自动编码器</strong> </a> (VAE)类似于经典自动编码器，是由编码器、解码器和损失函数组成的神经网络。它们让我们设计复杂的数据生成模型，并使它们适合大型数据集。</p><p id="db34" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">在阅读了一篇关于使用卷积网络和自动编码器洞察用户流失的文章后。我决定对电信客户流失数据集实现 VAE，该数据集可以从 IBM 样本数据集下载。将 VAE 应用于这样一个相对较小的数据集有点矫枉过正，但为了学习 VAE，我还是要这么做。</p><h1 id="85cf" class="lr ls jf bd lt lu lv lw lx ly lz ma mb kl mc km md ko me kp mf kr mg ks mh mi bi translated">数据</h1><p id="80bf" class="pw-post-body-paragraph ku kv jf kw b kx mj kg kz la mk kj lc ld ml lf lg lh mm lj lk ll mn ln lo lp ij bi translated">每行代表一个客户，每列包含列元数据上描述的客户属性。</p><p id="41df" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">数据集包括以下信息:</p><ul class=""><li id="d009" class="mo mp jf kw b kx ky la lb ld mq lh mr ll ms lp mt mu mv mw bi translated">上个月内离开的客户—这一列称为流失</li><li id="1806" class="mo mp jf kw b kx mx la my ld mz lh na ll nb lp mt mu mv mw bi translated">每位客户已注册的服务—电话、多条线路、互联网、在线安全、在线备份、设备保护、技术支持以及流媒体电视和电影</li><li id="2279" class="mo mp jf kw b kx mx la my ld mz lh na ll nb lp mt mu mv mw bi translated">客户账户信息——他们成为客户的时间、合同、支付方式、无纸化账单、每月费用和总费用</li><li id="d312" class="mo mp jf kw b kx mx la my ld mz lh na ll nb lp mt mu mv mw bi translated">客户的人口统计信息—性别、年龄范围，以及他们是否有伴侣和家属。</li></ul><pre class="nc nd ne nf gt ng nh ni nj aw nk bi"><span id="1c50" class="nl ls jf nh b gy nm nn l no np">import pandas as pd<br/>import numpy as np<br/>from sklearn.preprocessing import StandardScaler,MinMaxScaler<br/>import collections<br/>%matplotlib inline<br/>import matplotlib.pyplot as plt<br/>import seaborn as sns<br/>from sklearn import preprocessing<br/>from sklearn.metrics import (confusion_matrix, precision_recall_curve, auc,<br/>                             roc_curve, recall_score, classification_report, f1_score,<br/>                             precision_recall_fscore_support)<br/>from sklearn.model_selection import train_test_split<br/>from sklearn.preprocessing import StandardScaler,MinMaxScaler<br/>from keras.layers import Input, Dense, Lambda<br/>from keras.models import Model<br/>from keras.objectives import binary_crossentropy<br/>from keras.callbacks import LearningRateScheduler<br/>from keras.utils.vis_utils import model_to_dot<br/>from keras.callbacks import EarlyStopping, ModelCheckpoint<br/>import keras.backend as K<br/>from keras.callbacks import Callback<br/>import matplotlib<br/>matplotlib.rcParams['figure.figsize'] = (10.0, 6.0)</span><span id="4a8b" class="nl ls jf nh b gy nq nn l no np">df = pd.read_csv('WA_Fn-UseC_-Telco-Customer-Churn.csv')<br/>df.info()</span></pre><figure class="nc nd ne nf gt is gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/735bf6150317a3305263739a6aa50b2b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1106/format:webp/1*loVJj7-gfytaIp7gZ0Z3TQ.png"/></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Figure 1</figcaption></figure><p id="d6fb" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">总费用应转换成数字。</p><pre class="nc nd ne nf gt ng nh ni nj aw nk bi"><span id="3a56" class="nl ls jf nh b gy nm nn l no np">df['TotalCharges'] = pd.to_numeric(df['TotalCharges'], errors='coerce')</span></pre><p id="18bf" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">数据集中的大多数特征都是分类的。我们将首先可视化它们，然后创建虚拟变量。</p><h1 id="6c30" class="lr ls jf bd lt lu lv lw lx ly lz ma mb kl mc km md ko me kp mf kr mg ks mh mi bi translated"><strong class="ak">可视化并分析分类特征</strong></h1><h2 id="c37d" class="nl ls jf bd lt ns nt dn lx nu nv dp mb ld nw nx md lh ny nz mf ll oa ob mh oc bi translated">性别</h2><pre class="nc nd ne nf gt ng nh ni nj aw nk bi"><span id="be59" class="nl ls jf nh b gy nm nn l no np">gender_plot = df.groupby(['gender', 'Churn']).size().reset_index().pivot(columns='Churn', index='gender', values=0)<br/>gender_plot.plot(x=gender_plot.index, kind='bar', stacked=True);<br/>print('Gender', collections.Counter(df['gender']))</span></pre><figure class="nc nd ne nf gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi od"><img src="../Images/4de9ef3180287eb5c2e428ddb7c5bb17.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NMoqultwBViLENz9ij8_Yg.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Figure 2</figcaption></figure><p id="7502" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">性别似乎对客户流失没有影响。</p><h2 id="b0d8" class="nl ls jf bd lt ns nt dn lx nu nv dp mb ld nw nx md lh ny nz mf ll oa ob mh oc bi translated"><strong class="ak">合作伙伴</strong></h2><pre class="nc nd ne nf gt ng nh ni nj aw nk bi"><span id="b9f2" class="nl ls jf nh b gy nm nn l no np">partner_plot = df.groupby(['Partner', 'Churn']).size().reset_index().pivot(columns='Churn', index='Partner', values=0)<br/>partner_plot.plot(x=partner_plot.index, kind='bar', stacked=True);<br/>print('Partner', collections.Counter(df['Partner']))</span></pre><figure class="nc nd ne nf gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi oe"><img src="../Images/2b794d3f34aaaa4ad5a5b7770c5007f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WAsgSVdv3zN54EGKN09FnA.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Figure 3</figcaption></figure><p id="a651" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">客户是否有合作伙伴似乎对客户流失有一些影响。</p><h2 id="6c9a" class="nl ls jf bd lt ns nt dn lx nu nv dp mb ld nw nx md lh ny nz mf ll oa ob mh oc bi translated">受赡养者</h2><pre class="nc nd ne nf gt ng nh ni nj aw nk bi"><span id="f171" class="nl ls jf nh b gy nm nn l no np">dependents_plot = df.groupby(['Dependents', 'Churn']).size().reset_index().pivot(columns='Churn', index='Dependents', values=0)<br/>dependents_plot.plot(x=dependents_plot.index, kind='bar', stacked=True);<br/>print('Dependents', collections.Counter(df['Dependents']))</span></pre><figure class="nc nd ne nf gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi of"><img src="../Images/c3c1d0b0a991d71cd6c3cdc6c319532a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1XeJ17Ur-mnomokQFRlZWg.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Figure 4</figcaption></figure><p id="0958" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">没有家属的客户比有家属的客户更容易流失。</p><h2 id="f499" class="nl ls jf bd lt ns nt dn lx nu nv dp mb ld nw nx md lh ny nz mf ll oa ob mh oc bi translated"><strong class="ak">电话服务</strong></h2><pre class="nc nd ne nf gt ng nh ni nj aw nk bi"><span id="a7b6" class="nl ls jf nh b gy nm nn l no np">phoneservice_plot = df.groupby(['PhoneService', 'Churn']).size().reset_index().pivot(columns='Churn', index='PhoneService', values=0)<br/>phoneservice_plot.plot(x=phoneservice_plot.index, kind='bar', stacked=True);<br/>print('PhoneService', collections.Counter(df['PhoneService']))</span></pre><figure class="nc nd ne nf gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi og"><img src="../Images/5681b718ff843b7736aca01861d24f69.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Q6Q-PzEQfc7XpVNeJIE8IA.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Figure 5</figcaption></figure><p id="bd3f" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">没有多少客户没有注册电话服务，客户是否有电话服务似乎对客户流失没有影响。</p><h2 id="99dc" class="nl ls jf bd lt ns nt dn lx nu nv dp mb ld nw nx md lh ny nz mf ll oa ob mh oc bi translated"><strong class="ak">多线</strong></h2><pre class="nc nd ne nf gt ng nh ni nj aw nk bi"><span id="42e8" class="nl ls jf nh b gy nm nn l no np">multiplelines_plot = df.groupby(['MultipleLines', 'Churn']).size().reset_index().pivot(columns='Churn', index='MultipleLines', values=0)<br/>multiplelines_plot.plot(x=multiplelines_plot.index, kind='bar', stacked=True);<br/>print('MultipleLines', collections.Counter(df['MultipleLines']))</span></pre><figure class="nc nd ne nf gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi oh"><img src="../Images/2a9bfa82cae99d5796139d354c204588.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*93NRLcUucnpU5WejlQXUPw.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Figure 6</figcaption></figure><p id="c219" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">客户是否签署了多线似乎对客户流失没有影响。</p><h2 id="3983" class="nl ls jf bd lt ns nt dn lx nu nv dp mb ld nw nx md lh ny nz mf ll oa ob mh oc bi translated"><strong class="ak">互联网服务</strong></h2><pre class="nc nd ne nf gt ng nh ni nj aw nk bi"><span id="ca7c" class="nl ls jf nh b gy nm nn l no np">internetservice_plot = df.groupby(['InternetService', 'Churn']).size().reset_index().pivot(columns='Churn', index='InternetService', values=0)<br/>internetservice_plot.plot(x=internetservice_plot.index, kind='bar', stacked=True);<br/>print('InternetService', collections.Counter(df['InternetService']))</span></pre><figure class="nc nd ne nf gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi oi"><img src="../Images/dd356d50b598da9eab4e33c01f7f27fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5c5WBTf5JCzppWdNa7SdHw.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Figure 7</figcaption></figure><p id="94b5" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">似乎注册光纤的客户最有可能流失，几乎 50%的客户流失了。</p><h2 id="1342" class="nl ls jf bd lt ns nt dn lx nu nv dp mb ld nw nx md lh ny nz mf ll oa ob mh oc bi translated"><strong class="ak">在线安全</strong></h2><pre class="nc nd ne nf gt ng nh ni nj aw nk bi"><span id="f8ec" class="nl ls jf nh b gy nm nn l no np">onlinesecurity_plot = df.groupby(['OnlineSecurity', 'Churn']).size().reset_index().pivot(columns='Churn', index='OnlineSecurity', values=0)<br/>onlinesecurity_plot.plot(x=onlinesecurity_plot.index, kind='bar', stacked=True);<br/>print('OnlineSecurity', collections.Counter(df['OnlineSecurity']))</span></pre><figure class="nc nd ne nf gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi oj"><img src="../Images/d36394eaf331708b9fc1dd1c1b2b8908.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*r2XPX1XkRfHOno36Y3C04g.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Figure 8</figcaption></figure><p id="ec53" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">没有注册 OnlineSecurity 的客户最有可能流失。</p><h2 id="8d9f" class="nl ls jf bd lt ns nt dn lx nu nv dp mb ld nw nx md lh ny nz mf ll oa ob mh oc bi translated"><strong class="ak">在线备份</strong></h2><pre class="nc nd ne nf gt ng nh ni nj aw nk bi"><span id="89c6" class="nl ls jf nh b gy nm nn l no np">onlinebackup_plot = df.groupby(['OnlineBackup', 'Churn']).size().reset_index().pivot(columns='Churn', index='OnlineBackup', values=0)<br/>onlinebackup_plot.plot(x=onlinebackup_plot.index, kind='bar', stacked=True);<br/>print('OnlineBackup', collections.Counter(df['OnlineBackup']))</span></pre><figure class="nc nd ne nf gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ok"><img src="../Images/b9c42bc3c3ebb91302b401507e74dcd6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*upjWOZTYInNZwniJFHz3aA.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Figure 9</figcaption></figure><p id="0b43" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">没有注册 OnlineBackUp 的客户最有可能流失。</p><h2 id="31a8" class="nl ls jf bd lt ns nt dn lx nu nv dp mb ld nw nx md lh ny nz mf ll oa ob mh oc bi translated"><strong class="ak">设备保护</strong></h2><pre class="nc nd ne nf gt ng nh ni nj aw nk bi"><span id="6b59" class="nl ls jf nh b gy nm nn l no np">deviceprotection_plot = df.groupby(['DeviceProtection', 'Churn']).size().reset_index().pivot(columns='Churn', index='DeviceProtection', values=0)<br/>deviceprotection_plot.plot(x=deviceprotection_plot.index, kind='bar', stacked=True);<br/>print('DeviceProtection', collections.Counter(df['DeviceProtection']))</span></pre><figure class="nc nd ne nf gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ol"><img src="../Images/ea57d8d48cd77d96c772708da9df38d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*omU1XmisbifylVZ5ulD5XQ.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Figure 10</figcaption></figure><p id="121d" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">没有注册 DeviceProtection 的客户最有可能流失。</p><h2 id="23d0" class="nl ls jf bd lt ns nt dn lx nu nv dp mb ld nw nx md lh ny nz mf ll oa ob mh oc bi translated"><strong class="ak">技术支持</strong></h2><pre class="nc nd ne nf gt ng nh ni nj aw nk bi"><span id="6e5f" class="nl ls jf nh b gy nm nn l no np">techsupport_plot = df.groupby(['TechSupport', 'Churn']).size().reset_index().pivot(columns='Churn', index='TechSupport', values=0)<br/>techsupport_plot.plot(x=techsupport_plot.index, kind='bar', stacked=True);<br/>print('TechSupport', collections.Counter(df['TechSupport']))</span></pre><figure class="nc nd ne nf gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi om"><img src="../Images/ae179f50124d4fb893ef63c235a300d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8wDZ-kYEBPN0mkhbT4b5gA.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Figure 11</figcaption></figure><p id="7412" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">没有注册技术支持的客户最有可能流失。</p><h2 id="2bca" class="nl ls jf bd lt ns nt dn lx nu nv dp mb ld nw nx md lh ny nz mf ll oa ob mh oc bi translated"><strong class="ak">流媒体电视</strong></h2><pre class="nc nd ne nf gt ng nh ni nj aw nk bi"><span id="9bfd" class="nl ls jf nh b gy nm nn l no np">streamingtv_plot = df.groupby(['StreamingTV', 'Churn']).size().reset_index().pivot(columns='Churn', index='StreamingTV', values=0)<br/>streamingtv_plot.plot(x=streamingtv_plot.index, kind='bar', stacked=True);<br/>print('StreamingTV', collections.Counter(df['StreamingTV']))</span></pre><figure class="nc nd ne nf gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi on"><img src="../Images/9f8703835761c0ae2381b8720d5824b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VzHOUdX9HZxb8eLJDNF9mw.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Figure 12</figcaption></figure><h2 id="3375" class="nl ls jf bd lt ns nt dn lx nu nv dp mb ld nw nx md lh ny nz mf ll oa ob mh oc bi translated"><strong class="ak">流媒体电影</strong></h2><pre class="nc nd ne nf gt ng nh ni nj aw nk bi"><span id="678d" class="nl ls jf nh b gy nm nn l no np">streamingmovies_plot = df.groupby(['StreamingMovies', 'Churn']).size().reset_index().pivot(columns='Churn', index='StreamingMovies', values=0)<br/>streamingmovies_plot.plot(x=streamingmovies_plot.index, kind='bar', stacked=True);<br/>print('StreamingMovies', collections.Counter(df['StreamingMovies']))</span></pre><figure class="nc nd ne nf gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi oo"><img src="../Images/77757bda537d4f1180642b48309835a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TuMYrVWzNRTIhDyt188O5A.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Figure 13</figcaption></figure><p id="fe52" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">从以上七个图中，我们可以看到，没有互联网服务的客户流失率非常低。</p><h2 id="e86e" class="nl ls jf bd lt ns nt dn lx nu nv dp mb ld nw nx md lh ny nz mf ll oa ob mh oc bi translated"><strong class="ak">合同</strong></h2><pre class="nc nd ne nf gt ng nh ni nj aw nk bi"><span id="a254" class="nl ls jf nh b gy nm nn l no np">contract_plot = df.groupby(['Contract', 'Churn']).size().reset_index().pivot(columns='Churn', index='Contract', values=0)<br/>contract_plot.plot(x=contract_plot.index, kind='bar', stacked=True);<br/>print('Contract', collections.Counter(df['Contract']))</span></pre><figure class="nc nd ne nf gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi op"><img src="../Images/cc4496358401150dd3c34277b24cc42b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*stI-Qg4QN-LuEiwv2RvmLg.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Figure 14</figcaption></figure><p id="102d" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">很明显，合同条款确实对客户流失有影响。当客户有一份两年的合同时，很少有不愉快的事情发生。大多数客户都有逐月合约。</p><h2 id="cf09" class="nl ls jf bd lt ns nt dn lx nu nv dp mb ld nw nx md lh ny nz mf ll oa ob mh oc bi translated"><strong class="ak">无纸账单</strong></h2><pre class="nc nd ne nf gt ng nh ni nj aw nk bi"><span id="e902" class="nl ls jf nh b gy nm nn l no np">paperlessbilling_plot = df.groupby(['PaperlessBilling', 'Churn']).size().reset_index().pivot(columns='Churn', index='PaperlessBilling', values=0)<br/>paperlessbilling_plot.plot(x=paperlessbilling_plot.index, kind='bar', stacked=True);<br/>print('PaperlessBilling', collections.Counter(df['PaperlessBilling']))</span></pre><figure class="nc nd ne nf gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi oq"><img src="../Images/874ef557c578bd89987bdb384a36921e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yHasUeyGuc3XS7tgI55APQ.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Figure 15</figcaption></figure><h2 id="e8dd" class="nl ls jf bd lt ns nt dn lx nu nv dp mb ld nw nx md lh ny nz mf ll oa ob mh oc bi translated"><strong class="ak">支付方式</strong></h2><pre class="nc nd ne nf gt ng nh ni nj aw nk bi"><span id="af5a" class="nl ls jf nh b gy nm nn l no np">paymentmethod_plot = df.groupby(['PaymentMethod', 'Churn']).size().reset_index().pivot(columns='Churn', index='PaymentMethod', values=0)<br/>paymentmethod_plot.plot(x=paymentmethod_plot.index, kind='bar', stacked=True);<br/>print('PaymentMethod', collections.Counter(df['PaymentMethod']))</span></pre><figure class="nc nd ne nf gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi or"><img src="../Images/8d83e1b3641f820edd6f2e02f2096010.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8yp4CeOHyQh8JUqQ8JMu7A.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Figure 16</figcaption></figure><p id="92f6" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">支付方式似乎对流失率有影响，尤其是电子支票支付的流失率最高。</p><h2 id="4217" class="nl ls jf bd lt ns nt dn lx nu nv dp mb ld nw nx md lh ny nz mf ll oa ob mh oc bi translated">老年人</h2><pre class="nc nd ne nf gt ng nh ni nj aw nk bi"><span id="3d3e" class="nl ls jf nh b gy nm nn l no np">seniorcitizen_plot = df.groupby(['SeniorCitizen', 'Churn']).size().reset_index().pivot(columns='Churn', index='SeniorCitizen', values=0)<br/>seniorcitizen_plot.plot(x=seniorcitizen_plot.index, kind='bar', stacked=True);<br/>print('SeniorCitizen', collections.Counter(df['SeniorCitizen']))</span></pre><figure class="nc nd ne nf gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi of"><img src="../Images/fb98246dc6f847750a35c07419ad83cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nr6zttfYIYB0PTpDqvFR_g.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Figure 17</figcaption></figure><p id="1619" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">我们的数据中没有很多老年人。看起来顾客是否是老年人对客户流失率没有影响。</p><h1 id="738f" class="lr ls jf bd lt lu lv lw lx ly lz ma mb kl mc km md ko me kp mf kr mg ks mh mi bi translated"><strong class="ak">探索数字特征</strong></h1><h2 id="ab25" class="nl ls jf bd lt ns nt dn lx nu nv dp mb ld nw nx md lh ny nz mf ll oa ob mh oc bi translated"><strong class="ak">任期</strong></h2><pre class="nc nd ne nf gt ng nh ni nj aw nk bi"><span id="6058" class="nl ls jf nh b gy nm nn l no np">sns.kdeplot(df['tenure'].loc[df['Churn'] == 'No'], label='not churn', shade=True);<br/>sns.kdeplot(df['tenure'].loc[df['Churn'] == 'Yes'], label='churn', shade=True);</span></pre><figure class="nc nd ne nf gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi os"><img src="../Images/ba21af5b68c525b1cf0bf74437751437.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BnR9aCCKxaXl-sW-9d5f8A.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Figure 18</figcaption></figure><pre class="nc nd ne nf gt ng nh ni nj aw nk bi"><span id="6365" class="nl ls jf nh b gy nm nn l no np">df['tenure'].loc[df['Churn'] == 'No'].describe()</span></pre><figure class="nc nd ne nf gt is gh gi paragraph-image"><div class="gh gi ot"><img src="../Images/d7a4b226b11986632a88b1157d1792d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:832/format:webp/1*nm1U8h6-dd9ogVuxEopzrQ.png"/></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Figure 19</figcaption></figure><pre class="nc nd ne nf gt ng nh ni nj aw nk bi"><span id="84f7" class="nl ls jf nh b gy nm nn l no np">df['tenure'].loc[df['Churn'] == 'Yes'].describe()</span></pre><figure class="nc nd ne nf gt is gh gi paragraph-image"><div class="gh gi ou"><img src="../Images/62d96cdc73be4799bfe46530267058e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:760/format:webp/1*WCymrbZ3AMt2m4b6OxNm8A.png"/></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Figure 20</figcaption></figure><p id="012e" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">没有流失的客户比流失的客户拥有更长的平均任期(20 个月)。</p><h2 id="d060" class="nl ls jf bd lt ns nt dn lx nu nv dp mb ld nw nx md lh ny nz mf ll oa ob mh oc bi translated"><strong class="ak">月费</strong></h2><pre class="nc nd ne nf gt ng nh ni nj aw nk bi"><span id="57e2" class="nl ls jf nh b gy nm nn l no np">sns.kdeplot(df['MonthlyCharges'].loc[df['Churn'] == 'No'], label='not churn', shade=True);<br/>sns.kdeplot(df['MonthlyCharges'].loc[df['Churn'] == 'Yes'], label='churn', shade=True);</span></pre><figure class="nc nd ne nf gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ov"><img src="../Images/22cb0c993692124704bec48896b7fbfe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*i9sN11VH_wGXE2jd9Y1sWA.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Figure 21</figcaption></figure><pre class="nc nd ne nf gt ng nh ni nj aw nk bi"><span id="4282" class="nl ls jf nh b gy nm nn l no np">df['MonthlyCharges'].loc[df['Churn'] == 'No'].describe()</span></pre><figure class="nc nd ne nf gt is gh gi paragraph-image"><div class="gh gi ow"><img src="../Images/1eddaa5b43362a488006692528294169.png" data-original-src="https://miro.medium.com/v2/resize:fit:978/format:webp/1*VQ6PeWcAWGxduRdUo5h9Eg.png"/></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Figure 22</figcaption></figure><pre class="nc nd ne nf gt ng nh ni nj aw nk bi"><span id="7eb0" class="nl ls jf nh b gy nm nn l no np">df['MonthlyCharges'].loc[df['Churn'] == 'Yes'].describe()</span></pre><figure class="nc nd ne nf gt is gh gi paragraph-image"><div class="gh gi ox"><img src="../Images/6b81863f2ef21b62b145c84887187625.png" data-original-src="https://miro.medium.com/v2/resize:fit:1088/format:webp/1*6sb-Lrsu0-lyWTVMdoFd6g.png"/></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Figure 23</figcaption></figure><p id="7976" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">流失客户支付的月平均费用比非流失客户高 20%以上。</p><h2 id="0e18" class="nl ls jf bd lt ns nt dn lx nu nv dp mb ld nw nx md lh ny nz mf ll oa ob mh oc bi translated"><strong class="ak">总费用</strong></h2><pre class="nc nd ne nf gt ng nh ni nj aw nk bi"><span id="7b89" class="nl ls jf nh b gy nm nn l no np">sns.kdeplot(df['TotalCharges'].loc[df['Churn'] == 'No'], label='not churn', shade=True);<br/>sns.kdeplot(df['TotalCharges'].loc[df['Churn'] == 'Yes'], label='churn', shade=True);</span></pre><figure class="nc nd ne nf gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi oy"><img src="../Images/ba62d3d22dcd81bce2089d230b340776.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_R-JGoOX1-mDpArlJqbMMg.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Figure 24</figcaption></figure><h1 id="ad44" class="lr ls jf bd lt lu lv lw lx ly lz ma mb kl mc km md ko me kp mf kr mg ks mh mi bi translated">数据预处理</h1><p id="d558" class="pw-post-body-paragraph ku kv jf kw b kx mj kg kz la mk kj lc ld ml lf lg lh mm lj lk ll mn ln lo lp ij bi translated">用 0 到 1 之间的值对标签进行编码。</p><pre class="nc nd ne nf gt ng nh ni nj aw nk bi"><span id="5a6e" class="nl ls jf nh b gy nm nn l no np">le = preprocessing.LabelEncoder()<br/>df['Churn'] = le.fit_transform(df.Churn.values)</span></pre><p id="e6f3" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">用该列的平均值填写 nan。</p><pre class="nc nd ne nf gt ng nh ni nj aw nk bi"><span id="5f80" class="nl ls jf nh b gy nm nn l no np">df = df.fillna(df.mean())</span></pre><p id="c27a" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">编码分类特征。</p><pre class="nc nd ne nf gt ng nh ni nj aw nk bi"><span id="5c5b" class="nl ls jf nh b gy nm nn l no np">categorical =  ['gender', 'Partner', 'Dependents', 'PhoneService', 'MultipleLines', 'InternetService', 'OnlineSecurity', 'OnlineBackup', 'DeviceProtection', 'TechSupport', 'StreamingTV', 'StreamingMovies', 'Contract', 'PaperlessBilling', 'PaymentMethod']<br/>for f in categorical:<br/>    dummies = pd.get_dummies(df[f], prefix = f, prefix_sep = '_')<br/>    df = pd.concat([df, dummies], axis = 1)<br/># drop original categorical features<br/>df.drop(categorical, axis = 1, inplace = True)</span></pre><p id="088d" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">将数据分为训练集、验证集和测试集，并创建批处理通过我们的网络发送。</p><figure class="nc nd ne nf gt is"><div class="bz fp l di"><div class="oz pa l"/></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">autoencoder_preprocessing.py</figcaption></figure><h1 id="9e83" class="lr ls jf bd lt lu lv lw lx ly lz ma mb kl mc km md ko me kp mf kr mg ks mh mi bi translated">VAE 在喀拉斯的实施</h1><p id="5d12" class="pw-post-body-paragraph ku kv jf kw b kx mj kg kz la mk kj lc ld ml lf lg lh mm lj lk ll mn ln lo lp ij bi translated">以下代码脚本主要来自<a class="ae lq" href="https://wiseodd.github.io/techblog/2016/12/10/variational-autoencoder/" rel="noopener ugc nofollow" target="_blank"> Agustinus Kristiadi 的博客文章:变化的自动编码器:直觉和实现</a>。</p><ul class=""><li id="52b4" class="mo mp jf kw b kx ky la lb ld mq lh mr ll ms lp mt mu mv mw bi translated">定义输入层。</li><li id="7e20" class="mo mp jf kw b kx mx la my ld mz lh na ll nb lp mt mu mv mw bi translated">定义编码器层。</li><li id="fbdf" class="mo mp jf kw b kx mx la my ld mz lh na ll nb lp mt mu mv mw bi translated">编码器模型，将输入编码为潜在变量。</li><li id="7566" class="mo mp jf kw b kx mx la my ld mz lh na ll nb lp mt mu mv mw bi translated">我们使用平均值作为输出，因为它是中心点，代表高斯分布。</li><li id="0b61" class="mo mp jf kw b kx mx la my ld mz lh na ll nb lp mt mu mv mw bi translated">我们从 2 个密集层的输出中取样。</li><li id="d965" class="mo mp jf kw b kx mx la my ld mz lh na ll nb lp mt mu mv mw bi translated">定义 VAE 模型中的解码层。</li><li id="7232" class="mo mp jf kw b kx mx la my ld mz lh na ll nb lp mt mu mv mw bi translated">定义总体 VAE 模型，用于重建和培训。</li><li id="ced7" class="mo mp jf kw b kx mx la my ld mz lh na ll nb lp mt mu mv mw bi translated">定义生成器模型，生成给定潜在变量 z 的新数据。</li><li id="0ba4" class="mo mp jf kw b kx mx la my ld mz lh na ll nb lp mt mu mv mw bi translated">将我们的损失转化为 Keras 代码。</li><li id="df14" class="mo mp jf kw b kx mx la my ld mz lh na ll nb lp mt mu mv mw bi translated">开始训练。</li></ul><figure class="nc nd ne nf gt is"><div class="bz fp l di"><div class="oz pa l"/></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">VAE.py</figcaption></figure><p id="0a56" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">该模型在批量为 100 个样本的 55 个时期后停止训练。</p><h1 id="07ad" class="lr ls jf bd lt lu lv lw lx ly lz ma mb kl mc km md ko me kp mf kr mg ks mh mi bi translated">估价</h1><pre class="nc nd ne nf gt ng nh ni nj aw nk bi"><span id="fa1f" class="nl ls jf nh b gy nm nn l no np">plt.plot(vae_history.history['loss'])<br/>plt.plot(vae_history.history['val_loss'])<br/>plt.title('model loss')<br/>plt.ylabel('loss')<br/>plt.xlabel('epoch')<br/>plt.legend(['train', 'test'], loc='upper left')<br/>plt.show();</span></pre><figure class="nc nd ne nf gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi pb"><img src="../Images/37a74f3a6cd654c2568be65766f47bcd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vtErzXZJi38xbmH69teTxg.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Figure 25</figcaption></figure><p id="d179" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">从上面的损失图中，我们可以看到，该模型在训练和验证数据集上都具有可比的性能，并且在最后似乎收敛得很好。</p><p id="086c" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">我们使用重构误差来衡量解码器的性能。训练自动编码器以减少重建误差，如下所示:</p><pre class="nc nd ne nf gt ng nh ni nj aw nk bi"><span id="a98c" class="nl ls jf nh b gy nm nn l no np">x_train_encoded = encoder.predict(X_train)</span><span id="9294" class="nl ls jf nh b gy nq nn l no np">pred_train = decoder.predict(x_train_encoded)<br/>mse = np.mean(np.power(X_train - pred_train, 2), axis=1)<br/>error_df = pd.DataFrame({'recon_error': mse,<br/>                        'churn': y_train})</span><span id="d083" class="nl ls jf nh b gy nq nn l no np">plt.figure(figsize=(10,6))<br/>sns.kdeplot(error_df.recon_error[error_df.churn==0], label='not churn', shade=True, clip=(0,10))<br/>sns.kdeplot(error_df.recon_error[error_df.churn==1], label='churn', shade=True, clip=(0,10))<br/>plt.xlabel('reconstruction error');<br/>plt.title('Reconstruction error - Train set');</span></pre><figure class="nc nd ne nf gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi pc"><img src="../Images/21bac7aa38add0d86365fe8531980704.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*O-1UjcxIKKqPPXJGrqZXsA.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Figure 26</figcaption></figure><pre class="nc nd ne nf gt ng nh ni nj aw nk bi"><span id="ff67" class="nl ls jf nh b gy nm nn l no np">x_val_encoded = encoder.predict(X_val)</span><span id="7b93" class="nl ls jf nh b gy nq nn l no np">pred = decoder.predict(x_val_encoded)<br/>mseV = np.mean(np.power(X_val - pred, 2), axis=1)<br/>error_df = pd.DataFrame({'recon_error': mseV,<br/>                        'churn': y_val})</span><span id="2c43" class="nl ls jf nh b gy nq nn l no np">plt.figure(figsize=(10,6))<br/>sns.kdeplot(error_df.recon_error[error_df.churn==0], label='not churn', shade=True, clip=(0,10))<br/>sns.kdeplot(error_df.recon_error[error_df.churn==1], label='churn', shade=True, clip=(0,10))<br/>plt.xlabel('reconstruction error');<br/>plt.title('Reconstruction error - Validation set');</span></pre><figure class="nc nd ne nf gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi pd"><img src="../Images/61f6d6a0069ece62599258ec953861b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*v1kvWwKwPn_EwPRgrG0ngA.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Figure 27</figcaption></figure><h2 id="f414" class="nl ls jf bd lt ns nt dn lx nu nv dp mb ld nw nx md lh ny nz mf ll oa ob mh oc bi translated">潜在空间可视化</h2><p id="84c8" class="pw-post-body-paragraph ku kv jf kw b kx mj kg kz la mk kj lc ld ml lf lg lh mm lj lk ll mn ln lo lp ij bi translated">我们可以在 2D 潜在空间中聚类客户，并可视化搅动和未搅动的客户，它们可以在潜在空间中分离，并揭示不同聚类的形成。</p><pre class="nc nd ne nf gt ng nh ni nj aw nk bi"><span id="389c" class="nl ls jf nh b gy nm nn l no np">x_train_encoded = encoder.predict(X_train)</span><span id="70e1" class="nl ls jf nh b gy nq nn l no np">plt.scatter(x_train_encoded[:, 0], x_train_encoded[:, 1], <br/>            c=y_train, alpha=0.6)<br/>plt.title('Train set in latent space')<br/>plt.show();</span></pre><figure class="nc nd ne nf gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi pe"><img src="../Images/fd3bcc9803ceaef942e6c8cc67b18314.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SMDL_SZgMUHHXk-GlqkdSA.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Figure 28</figcaption></figure><pre class="nc nd ne nf gt ng nh ni nj aw nk bi"><span id="6b6c" class="nl ls jf nh b gy nm nn l no np">x_val_encoded = encoder.predict(X_val)</span><span id="cd68" class="nl ls jf nh b gy nq nn l no np">plt.scatter(x_val_encoded[:, 0], x_val_encoded[:, 1], <br/>            c=y_val, alpha=0.6)</span><span id="7504" class="nl ls jf nh b gy nq nn l no np">plt.title('Validation set in latent space')<br/>plt.show();</span></pre><figure class="nc nd ne nf gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi oe"><img src="../Images/74ca5ff48b7af4a5fb2887428fe2a842.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sE49Aa795Y3Av2u78S_fiA.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Figure 29</figcaption></figure><h2 id="2625" class="nl ls jf bd lt ns nt dn lx nu nv dp mb ld nw nx md lh ny nz mf ll oa ob mh oc bi translated">对验证集的预测</h2><pre class="nc nd ne nf gt ng nh ni nj aw nk bi"><span id="de23" class="nl ls jf nh b gy nm nn l no np">x_val_encoded = encoder.predict(X_val)<br/>fpr, tpr, thresholds = roc_curve(y_val, clf.predict(x_val_encoded))<br/>roc_auc = auc(fpr, tpr)</span><span id="adcd" class="nl ls jf nh b gy nq nn l no np">plt.title('Receiver Operating Characteristic')<br/>plt.plot(fpr, tpr, label='AUC = %0.4f'% roc_auc)<br/>plt.legend(loc='lower right')<br/>plt.plot([0,1],[0,1],'r--')<br/>plt.xlim([-0.001, 1])<br/>plt.ylim([0, 1.001])<br/>plt.ylabel('True Positive Rate')<br/>plt.xlabel('False Positive Rate')<br/>plt.show();</span></pre><figure class="nc nd ne nf gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi pf"><img src="../Images/82ba6c48bc356ddb521eeb843e236489.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sh7ROJgdoBr02T-bfj6Iyg.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Figure 29</figcaption></figure><pre class="nc nd ne nf gt ng nh ni nj aw nk bi"><span id="ed8b" class="nl ls jf nh b gy nm nn l no np">print('Accuracy:')<br/>print(accuracy_score(y_val, clf.predict(x_val_encoded)))<br/>print("Confusion Matrix:")<br/>print(confusion_matrix(y_val,clf.predict(x_val_encoded)))<br/>print("Classification Report:")<br/>print(classification_report(y_val,clf.predict(x_val_encoded)))</span></pre><figure class="nc nd ne nf gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi pg"><img src="../Images/f1adb1470d3e4f96ba4fce011d96c222.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8ZV61xIng0anrfeZJaCq2w.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Figure 30</figcaption></figure><h2 id="375a" class="nl ls jf bd lt ns nt dn lx nu nv dp mb ld nw nx md lh ny nz mf ll oa ob mh oc bi translated">对测试集的预测</h2><pre class="nc nd ne nf gt ng nh ni nj aw nk bi"><span id="4391" class="nl ls jf nh b gy nm nn l no np">x_test_encoded = encoder.predict(X_test)<br/>fpr, tpr, thresholds = roc_curve(y_test, clf.predict(x_test_encoded))<br/>roc_auc = auc(fpr, tpr)<br/>plt.title('Receiver Operating Characteristic')<br/>plt.plot(fpr, tpr, label='AUC = %0.4f'% roc_auc)<br/>plt.legend(loc='lower right')<br/>plt.plot([0,1],[0,1],'r--')<br/>plt.xlim([-0.001, 1])<br/>plt.ylim([0, 1.001])<br/>plt.ylabel('True Positive Rate')<br/>plt.xlabel('False Positive Rate')<br/>plt.show();</span></pre><figure class="nc nd ne nf gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ph"><img src="../Images/99a7ff5eece7edc8cf46f1790ce66ead.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8d5FlYOUsbYpDmB3ikCjVA.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Figure 31</figcaption></figure><pre class="nc nd ne nf gt ng nh ni nj aw nk bi"><span id="11e4" class="nl ls jf nh b gy nm nn l no np">print('Accuracy:')<br/>print(accuracy_score(y_test, clf.predict(x_test_encoded)))<br/>print("Confusion Matrix:")<br/>print(confusion_matrix(y_test,clf.predict(x_test_encoded)))<br/>print("Classification Report:")<br/>print(classification_report(y_test,clf.predict(x_test_encoded)))</span></pre><figure class="nc nd ne nf gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi pi"><img src="../Images/e36a9fae1f3a86dd2a43e92a29588bf7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sovSX3M9zyHIqIqMi3zohw.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Figure 32</figcaption></figure><p id="d25e" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">就是这样！Jupyter 笔记本可以在<a class="ae lq" href="https://github.com/susanli2016/Machine-Learning-with-Python/blob/master/Autoencoder%20for%20Customer%20Churn.ipynb" rel="noopener ugc nofollow" target="_blank"> Github </a>上找到。周一快乐！</p><p id="1e44" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">参考资料:</p><div class="ip iq gp gr ir pj"><a href="https://www.jeremyjordan.me/variational-autoencoders/" rel="noopener  ugc nofollow" target="_blank"><div class="pk ab fo"><div class="pl ab pm cl cj pn"><h2 class="bd jg gy z fp po fr fs pp fu fw je bi translated">可变自动编码器。</h2><div class="pq l"><h3 class="bd b gy z fp po fr fs pp fu fw dk translated">在我关于自动编码器的介绍性文章中，我讨论了各种模型(欠完整、稀疏、去噪、收缩)…</h3></div><div class="pr l"><p class="bd b dl z fp po fr fs pp fu fw dk translated">www.jeremyjordan.me</p></div></div></div></a></div><div class="ip iq gp gr ir pj"><a href="https://jaan.io/what-is-variational-autoencoder-vae-tutorial/" rel="noopener  ugc nofollow" target="_blank"><div class="pk ab fo"><div class="pl ab pm cl cj pn"><h2 class="bd jg gy z fp po fr fs pp fu fw je bi translated">教程-什么是变分自动编码器？-贾恩·阿尔托萨尔</h2><div class="pq l"><h3 class="bd b gy z fp po fr fs pp fu fw dk translated">从两个角度理解变分自动编码器:深度学习和图形模型。</h3></div><div class="pr l"><p class="bd b dl z fp po fr fs pp fu fw dk translated">jaan.io</p></div></div></div></a></div><div class="ip iq gp gr ir pj"><a href="http://kvfrans.com/variational-autoencoders-explained/" rel="noopener  ugc nofollow" target="_blank"><div class="pk ab fo"><div class="pl ab pm cl cj pn"><h2 class="bd jg gy z fp po fr fs pp fu fw je bi translated">解释了各种自动编码器</h2><div class="pq l"><h3 class="bd b gy z fp po fr fs pp fu fw dk translated">在我上一篇关于生成对立网络的文章中，我介绍了一个简单的方法来训练一个可以…</h3></div><div class="pr l"><p class="bd b dl z fp po fr fs pp fu fw dk translated">kvfrans.com</p></div></div><div class="ps l"><div class="pt l pu pv pw ps px ix pj"/></div></div></a></div><div class="ip iq gp gr ir pj"><a href="https://medium.com/@curiousily/credit-card-fraud-detection-using-autoencoders-in-keras-tensorflow-for-hackers-part-vii-20e0c85301bd" rel="noopener follow" target="_blank"><div class="pk ab fo"><div class="pl ab pm cl cj pn"><h2 class="bd jg gy z fp po fr fs pp fu fw je bi translated">使用 Keras 中的自动编码器检测信用卡欺诈——面向黑客的 TensorFlow(第七部分)</h2><div class="pq l"><h3 class="bd b gy z fp po fr fs pp fu fw dk translated">信用卡交易中的异常检测是如何工作的？</h3></div><div class="pr l"><p class="bd b dl z fp po fr fs pp fu fw dk translated">medium.com</p></div></div><div class="ps l"><div class="py l pu pv pw ps px ix pj"/></div></div></a></div><div class="ip iq gp gr ir pj"><a href="https://deeplearning4j.org/tutorials/05-basic-autoencoder-anomaly-detection-using-reconstruction-error" rel="noopener  ugc nofollow" target="_blank"><div class="pk ab fo"><div class="pl ab pm cl cj pn"><h2 class="bd jg gy z fp po fr fs pp fu fw je bi translated">基本自动编码器-使用重构误差进行异常检测| Deeplearning4j</h2><div class="pq l"><h3 class="bd b gy z fp po fr fs pp fu fw dk translated">下载此笔记本请查看自述文件，了解安装、设置依赖关系和导入…</h3></div><div class="pr l"><p class="bd b dl z fp po fr fs pp fu fw dk translated">deeplearning4j.org</p></div></div><div class="ps l"><div class="pz l pu pv pw ps px ix pj"/></div></div></a></div><div class="ip iq gp gr ir pj"><a href="https://github.com/naomifridman/Deep-VAE-prediction-of-churn-customer" rel="noopener  ugc nofollow" target="_blank"><div class="pk ab fo"><div class="pl ab pm cl cj pn"><h2 class="bd jg gy z fp po fr fs pp fu fw je bi translated">Naomi fridman/深度 VAE 客户流失预测</h2><div class="pq l"><h3 class="bd b gy z fp po fr fs pp fu fw dk translated">预测客户流失的可变深度自动编码器-Naomi fridman/深度 VAE-客户流失预测</h3></div><div class="pr l"><p class="bd b dl z fp po fr fs pp fu fw dk translated">github.co</p></div></div><div class="ps l"><div class="qa l pu pv pw ps px ix pj"/></div></div></a></div></div></div>    
</body>
</html>