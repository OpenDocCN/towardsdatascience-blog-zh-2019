<html>
<head>
<title>Cheat sheet for Python dataframe ↔ R dataframe syntax conversions</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python 数据帧↔ R 数据帧语法转换的备忘单</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/cheat-sheet-for-python-dataframe-r-dataframe-syntax-conversions-450f656b44ca?source=collection_archive---------3-----------------------#2019-10-10">https://towardsdatascience.com/cheat-sheet-for-python-dataframe-r-dataframe-syntax-conversions-450f656b44ca?source=collection_archive---------3-----------------------#2019-10-10</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="0fa0" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">对于那些熟悉使用 Python 或 R 进行数据分析，并希望快速学习另一种语言的基础知识的人来说，这是一个迷你指南</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/87cdfa57d5b471d292500549ccc87a26.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*l4_VV3ZQqdQmZLGR9ucPOw.jpeg"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Photo by <a class="ae kv" href="https://unsplash.com/@madfishdigital?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Mad Fish Digital</a> on <a class="ae kv" href="https://unsplash.com/s/photos/data-tables?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="dbb9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在本指南中，对于 Python，以下所有命令都基于“pandas”包。对于 R，某些命令需要“dplyr”和“tidyr”包。</p><p id="af47" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">欢迎评论/建议。</p><h2 id="3825" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">Python ↔R 基础知识</h2><pre class="kg kh ki kj gt ml mm mn mo aw mp bi"><span id="4a5f" class="ls lt iq mm b gy mq mr l ms mt"><strong class="mm ir"># Python </strong>⇔<strong class="mm ir"> R: object types</strong><br/>type(a)  ⇔ class(a)   # "class" is better than "typeof"</span><span id="c191" class="ls lt iq mm b gy mu mr l ms mt"><strong class="mm ir"># Python </strong>⇔<strong class="mm ir"> R: variable assignment</strong><br/>a=5      ⇔ a&lt;-5       # a=5 also works for R<br/></span><span id="7544" class="ls lt iq mm b gy mu mr l ms mt"><strong class="mm ir"># Python list </strong>⇔<strong class="mm ir"> R vector:</strong><br/>a = [1,3,5,7]                ⇔  a &lt;- c(1,3,5,7)<br/>a = [i for i in range(3,9)]  ⇔  a &lt;- c(3:9)</span><span id="bfbe" class="ls lt iq mm b gy mu mr l ms mt"><strong class="mm ir"># Python 'for loop':<br/></strong>for val in [1,3,5]:<br/>    print(val)</span><span id="9cf8" class="ls lt iq mm b gy mu mr l ms mt"><strong class="mm ir"># R 'for loop':<br/></strong>for (val in c(1,3,5)){<br/>    print(val)<br/>}</span><span id="3979" class="ls lt iq mm b gy mu mr l ms mt"><strong class="mm ir"># Python function:<br/></strong>def new_function(a, b=5):<br/>    return a+b</span><span id="a9a1" class="ls lt iq mm b gy mu mr l ms mt"><strong class="mm ir"># R function:<br/></strong>new_function &lt;- function(a, b=5) {<br/>    return (a+b)<br/>}</span></pre><h2 id="2790" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">检查数据帧</h2><pre class="kg kh ki kj gt ml mm mn mo aw mp bi"><span id="81aa" class="ls lt iq mm b gy mq mr l ms mt"><strong class="mm ir"># Python </strong>⇔<strong class="mm ir"> R</strong><br/>df.head()       ⇔  head(df)<br/>df.head(3)      ⇔  head(df,3)<br/>df.tail(3)      ⇔  tail(df,3)<br/>df.shape[0]     ⇔  nrow(df)<br/>df.shape[1]     ⇔  ncol(df)<br/>df.shape        ⇔  dim(df)<br/>df.info()       ⇔  <strong class="mm ir">NO EQUIVALENT</strong><br/>df.describe()   ⇔  summary(df)     # similar, not exactly the same<br/><strong class="mm ir">NO EQUIVALENT</strong>   ⇔  str(df)</span></pre><h2 id="4456" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">文件输入输出</h2><pre class="kg kh ki kj gt ml mm mn mo aw mp bi"><span id="0ef9" class="ls lt iq mm b gy mq mr l ms mt"><strong class="mm ir"># Python  </strong><br/>import pandas as pd<br/>df = pd.read_csv("input.csv",<br/>                 sep    = ",",<br/>                 header = 0)<br/>df.to_csv("output.csv", index = False)</span><span id="f2cb" class="ls lt iq mm b gy mu mr l ms mt"><strong class="mm ir"># R </strong><br/>df &lt;- read.csv("input.csv", <br/>               header = TRUE,<br/>               na.strings=c("","NA"),    <br/>               sep = ",")<br/>write.csv(df, "output.csv", row.names = FALSE)</span><span id="5e14" class="ls lt iq mm b gy mu mr l ms mt"># na.strings: make sure NAs are not read as empty strings</span></pre><h2 id="3db7" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">创建新的数据框架</h2><pre class="kg kh ki kj gt ml mm mn mo aw mp bi"><span id="0d0e" class="ls lt iq mm b gy mq mr l ms mt"><strong class="mm ir"># Python<br/></strong>import pandas as pd<br/>df = pd.DataFrame(dict(col_a=['a','b','c'], col_b=[1,2,3]))</span><span id="1f08" class="ls lt iq mm b gy mu mr l ms mt"><strong class="mm ir"># R</strong><br/>col_a &lt;- c('a','b','c')<br/>col_b &lt;- c(1,2,3)<br/>df &lt;- data.frame(col_a, col_b)</span></pre><h2 id="49ed" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">列/行过滤</h2><pre class="kg kh ki kj gt ml mm mn mo aw mp bi"><span id="d123" class="ls lt iq mm b gy mq mr l ms mt"><strong class="mm ir"># Python: row filtering  </strong><br/>df[(df['column_1'] &gt; 3) &amp;    <br/>   (df['column_2'].isnull())]</span><span id="ca44" class="ls lt iq mm b gy mu mr l ms mt"><strong class="mm ir"># R: row filtering  </strong><br/>df[(df$column_1 &gt; 3) &amp;    <br/>   (is.na(df$column_2)), ] <br/><strong class="mm ir">OR<br/></strong>library(dplyr)<br/>df %&gt;% filter((column_1 &gt; 3) &amp; (is.na(column_2)))</span><span id="fe6b" class="ls lt iq mm b gy mu mr l ms mt"><strong class="mm ir"># Python </strong>⇔<strong class="mm ir"> R: column filtering (keep columns) </strong><br/>df[['c1', 'c2']] ⇔  df[c('c1', 'c2')]   # OR: df[,c('c1', 'c2')]</span><span id="e524" class="ls lt iq mm b gy mu mr l ms mt"><strong class="mm ir"># Python </strong>⇔<strong class="mm ir"> R(with dplyr): column filtering (drop columns)<br/></strong>df.drop(['c1', 'c2'], axis=1)  ⇔  df %&gt;% select(-c('c1', 'c2'))</span><span id="77fe" class="ls lt iq mm b gy mu mr l ms mt"><strong class="mm ir"># Python </strong>⇔<strong class="mm ir"> R: select columns by position<br/></strong>df.iloc[:,2:5]  ⇔  df[c(3:5)]           # Note the indexing</span><span id="d343" class="ls lt iq mm b gy mu mr l ms mt"><strong class="mm ir"># Python: check if a column contains specific values<br/></strong>df[df['c1'].isin(['a','b'])]<br/><strong class="mm ir">OR</strong><br/>df.query('c1 in ("a", "b")')</span><span id="35aa" class="ls lt iq mm b gy mu mr l ms mt"><strong class="mm ir"># R: check if a column contains specific values<br/></strong>df[df$c1 %in% c('a', 'b'), ]<br/><strong class="mm ir">OR</strong><br/>library(dplyr)<br/>df %&gt;% filter(c1 %in% c('a', 'b'))</span></pre><h2 id="98d6" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">缺失值处理/计数</h2><pre class="kg kh ki kj gt ml mm mn mo aw mp bi"><span id="a151" class="ls lt iq mm b gy mq mr l ms mt"><strong class="mm ir"># Python: missing value imputation <br/></strong>df['c1'] = df['c1'].fillna(0)  <br/><strong class="mm ir">OR</strong><br/>df.fillna(value={'c1': 0})</span><span id="dc4e" class="ls lt iq mm b gy mu mr l ms mt"><strong class="mm ir"># R: missing value imputation<br/></strong>df$c1[is.na(df$c1)] &lt;- 0<br/><strong class="mm ir">OR <br/></strong>df$c1 = ifelse(is.na(df$c1) == TRUE, 0, df$c1)<br/><strong class="mm ir">OR</strong><br/>library(dplyr)<br/>library(tidyr)<strong class="mm ir"><br/></strong>df %&gt;% mutate(c1 = replace_na(c1, 0))</span><span id="17db" class="ls lt iq mm b gy mu mr l ms mt"><strong class="mm ir"># Python </strong>⇔<strong class="mm ir"> R: number of missing values in a column<br/></strong>df['c1'].isnull().sum()  ⇔  sum(is.na(df$c1))</span></pre><h2 id="6516" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">单列的统计信息</h2><pre class="kg kh ki kj gt ml mm mn mo aw mp bi"><span id="ba98" class="ls lt iq mm b gy mq mr l ms mt"><strong class="mm ir"># Python </strong>⇔<strong class="mm ir"> R: count value frequency (Similar)</strong><br/>df['c1'].value_counts()              ⇔ table(df$c1)<br/>df['c1'].value_counts(dropna=False)  ⇔ table(df$c1, useNA='always')<br/>df['c1'].value_counts(ascending=False) <br/>⇔ sort(table(df$c1), decreasing = TRUE)</span><span id="8703" class="ls lt iq mm b gy mu mr l ms mt"><strong class="mm ir"># Python </strong>⇔<strong class="mm ir"> R: unique columns (including missing values) </strong><br/>df['c1'].unique()      ⇔  unique(df$c1)<br/>len(df['c1'].unique()) ⇔  length(unique(df$c1))</span><span id="d9bc" class="ls lt iq mm b gy mu mr l ms mt"><strong class="mm ir"># Python </strong>⇔<strong class="mm ir"> R: column max / min / mean<br/></strong>df['c1'].max()         ⇔  max(df$c1,  na.rm = TRUE)<br/>df['c1'].min()         ⇔  min(df$c1,  na.rm = TRUE)<br/>df['c1'].mean()        ⇔  mean(df$c1, na.rm = TRUE)</span></pre><h2 id="73f7" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">分组和聚合</h2><pre class="kg kh ki kj gt ml mm mn mo aw mp bi"><span id="32c1" class="ls lt iq mm b gy mq mr l ms mt"><strong class="mm ir"># Python: max / min / sum / mean / count<br/></strong>tbl = df.groupby('c1').agg({'c2':['max', 'min', 'sum'],<br/>                            'c3':['mean'],<br/>                            'c1':['count']}).reset_index()<br/>tbl.columns = ['c1', 'c2_max', 'c2_min', 'c2_sum', <br/>               'c3_mean', 'count']<br/><strong class="mm ir">OR (for chained operations)</strong><br/>tbl = df.groupby('c1').agg(c2_max=  ('c2', max),<br/>                           c2_min=  ('c2', min),<br/>                           c2_sum=  ('c2', sum),<br/>                           c3_mean= ('c2', 'mean'),<br/>                           count=   ('c1', 'count')).reset_index()</span><span id="8040" class="ls lt iq mm b gy mu mr l ms mt"><strong class="mm ir"># R: max / min / sum / mean / count<br/></strong>library(dplyr)<strong class="mm ir"><br/></strong>df %&gt;% group_by(c1) %&gt;% <br/>       summarise(c2_max  = max(c2, na.rm = T),<br/>                 c2_min  = min(c2, na.rm = T),<br/>                 c2_sum  = sum(c2, na.rm = T),<br/>                 c3_mean = mean(c3, na.rm = T),<br/>                 count   = n())       </span><span id="05fc" class="ls lt iq mm b gy mu mr l ms mt"><strong class="mm ir"># Python: count distinct<br/></strong>df.groupby('c1')['c2'].nunique()\<br/>                      .reset_index()\<br/>                      .rename(columns={'c2':'c2_cnt_distinct'})</span><span id="d14c" class="ls lt iq mm b gy mu mr l ms mt"><strong class="mm ir"># R: count distinct</strong><br/>library(dplyr)<br/>tbl &lt;- df %&gt;% group_by(c1) <br/>          %&gt;% summarise(c2_cnt_distinct = n_distinct(c2))</span></pre><h2 id="5f8f" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">创建新列/改变现有列</h2><pre class="kg kh ki kj gt ml mm mn mo aw mp bi"><span id="04f4" class="ls lt iq mm b gy mq mr l ms mt"><strong class="mm ir"># Python: rename columns<br/></strong>df.rename(columns={'old_col': 'new_col'})         </span><span id="7e74" class="ls lt iq mm b gy mu mr l ms mt"><strong class="mm ir"># R: rename columns<br/></strong>library(dplyr)<br/>df %&gt;% rename(new_col = old_col)</span><span id="6cc8" class="ls lt iq mm b gy mu mr l ms mt"><strong class="mm ir"># Python: value mapping<br/></strong>df['Sex'] = df['Sex'].map({'male':0, 'female':1})</span><span id="62c3" class="ls lt iq mm b gy mu mr l ms mt"><strong class="mm ir"># R: value mapping<br/></strong>library(dplyr)<br/>df$Sex &lt;- mapvalues(df$Sex, <br/>          from=c('male', 'female'), <br/>          to=c(0,1))</span><span id="07c5" class="ls lt iq mm b gy mu mr l ms mt"><strong class="mm ir"># Python </strong>⇔<strong class="mm ir"> R: change data type<br/></strong>df['c1'] = df['c1'].astype(str)    ⇔  df$c1 &lt;- as.character(df$c1)<br/>df['c1'] = df['c1'].astype(int)    ⇔  df$c1 &lt;- as.integer(df$c1)<br/>df['c1'] = df['c1'].astype(float)  ⇔  df$c1 &lt;- as.numeric(df$c1)</span></pre><h2 id="0f8c" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">按行筛选器更新列值</h2><pre class="kg kh ki kj gt ml mm mn mo aw mp bi"><span id="6ad5" class="ls lt iq mm b gy mq mr l ms mt"><strong class="mm ir"># Python </strong>⇔<strong class="mm ir"> R: <br/></strong>df.loc[df['c1']=='A', 'c2'] = 99  ⇔  df[df$c1=='A', 'c2'] &lt;- 99</span></pre><h2 id="ea84" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">连接/分类</h2><pre class="kg kh ki kj gt ml mm mn mo aw mp bi"><span id="550d" class="ls lt iq mm b gy mq mr l ms mt"><strong class="mm ir"># Python: inner join / left join<br/></strong>import pandas as pd<br/>merged_df1 = pd.merge(df1, df2, on='c1', how='inner')<br/>merged_df2 = pd.merge(df1, df2, on='c1', how='left')<br/><strong class="mm ir">OR (for chained operations)</strong><br/>merged_df1 = df1.merge(df2, on='c1', how='inner')<br/>merged_df2 = df1.merge(df2, on='c1', how='left')</span><span id="3560" class="ls lt iq mm b gy mu mr l ms mt"><strong class="mm ir"># R: inner join / left join<br/></strong>merged_df1 &lt;- merge(x=df1,y=df2,by='c1')<br/>merged_df2 &lt;- merge(x=df1,y=df2,by='c1',all.x=TRUE)<br/><strong class="mm ir">OR </strong><br/>library(dplyr)<br/>merged_df1 &lt;- inner_join(x=df1,y=df2,by='c1')<br/>merged_df2 &lt;- left_join(x=df1,y=df2,by='c1')</span><span id="3713" class="ls lt iq mm b gy mu mr l ms mt"><strong class="mm ir"># Python: sorting<br/></strong>df.sort_values(by=['c1','c2'], ascending = [True, False])</span><span id="429b" class="ls lt iq mm b gy mu mr l ms mt"><strong class="mm ir"># R: sorting <br/></strong>library(dplyr)<br/>df %&gt;% arrange(c1, desc(c2))</span></pre><h2 id="b244" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">串联/采样</h2><pre class="kg kh ki kj gt ml mm mn mo aw mp bi"><span id="6a20" class="ls lt iq mm b gy mq mr l ms mt"><strong class="mm ir"># Python (import pandas as pd) </strong>⇔<strong class="mm ir"> R: concatenation<br/></strong>pd.concat([df1, df2, df3])     ⇔ rbind(df1, df2, df3)<br/>pd.concat([df1, df2], axis=1)  ⇔ cbind(df1, df2)</span><span id="d8d0" class="ls lt iq mm b gy mu mr l ms mt"><strong class="mm ir"># Python random sample<br/></strong>df.sample(n=3, random_state=42)</span><span id="6a69" class="ls lt iq mm b gy mu mr l ms mt"><strong class="mm ir"># R random sample<br/></strong>set.seed(42)<br/>sample_n(df, 3)</span></pre><h2 id="4afb" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">链式操作的一个例子</h2><pre class="kg kh ki kj gt ml mm mn mo aw mp bi"><span id="5d4f" class="ls lt iq mm b gy mq mr l ms mt"><strong class="mm ir"># Python: chained operations with '.'<br/></strong>df.drop('c1', axis=1)\<br/>  .sort_values(by='c2', ascending=False)\<br/>  .assign(c3 = lambda x: x['c1']*3 + 2)\<br/>  .fillna(value={'c2': 0, 'c4':-99})\<br/>  .rename(columns={'total': 'TOT'})\<br/>  .query('c3 &gt; 10')</span><span id="db4a" class="ls lt iq mm b gy mu mr l ms mt"><strong class="mm ir"># R: chained operations with '%&gt;%'<br/></strong>library(dplyr)<br/>library(tidyr)<br/>df %&gt;% select(-c('c1')) %&gt;%<br/>       arrange(desc(c2)) %&gt;%<br/>       mutate(c3 = c1*3 + 2) %&gt;%<br/>       mutate(c2 = replace_na(c2, 0),<br/>              c4 = replace_na(c4, -99)) %&gt;%<br/>       rename(TOT = total) %&gt;%            <br/>       filter(c3 &gt; 10)</span></pre></div></div>    
</body>
</html>