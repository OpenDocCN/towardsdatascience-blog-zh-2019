<html>
<head>
<title>Attention — Seq2Seq Models</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">注意— Seq2Seq 型号</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/day-1-2-attention-seq2seq-models-65df3f49e263?source=collection_archive---------2-----------------------#2019-07-13">https://towardsdatascience.com/day-1-2-attention-seq2seq-models-65df3f49e263?source=collection_archive---------2-----------------------#2019-07-13</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="887a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><em class="ko">序列间</em> (abrv。Seq2Seq)模型是深度学习模型，在机器翻译、文本摘要和图像字幕等任务中取得了很多成功。谷歌翻译在 2016 年末开始在<a class="ae kp" href="https://blog.google/products/translate/found-translation-more-accurate-fluent-sentences-google-translate/" rel="noopener ugc nofollow" target="_blank">生产中使用</a>这样的模型。这两个开创性的论文中解释了这些模型(<a class="ae kp" href="https://papers.nips.cc/paper/5346-sequence-to-sequence-learning-with-neural-networks.pdf" rel="noopener ugc nofollow" target="_blank"> Sutskever 等人，2014 </a>，<a class="ae kp" href="http://emnlp2014.org/papers/pdf/EMNLP2014179.pdf" rel="noopener ugc nofollow" target="_blank"> Cho 等人，2014 </a>)。</p><h1 id="a068" class="kq kr it bd ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln bi translated">Seq2Seq 模型是什么？</h1><p id="6d13" class="pw-post-body-paragraph jq jr it js b jt lo jv jw jx lp jz ka kb lq kd ke kf lr kh ki kj ls kl km kn im bi translated">Seq2Seq 模型是一种模型，它接受一系列项目(单词、字母、时间序列等)并输出另一系列项目。</p><figure class="lu lv lw lx gt ly gh gi paragraph-image"><div role="button" tabindex="0" class="lz ma di mb bf mc"><div class="gh gi lt"><img src="../Images/3b93c6bc03bb8ae7d76b5a8887b6d868.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1nERP8YPd-0DkpVC4Fi2pg.png"/></div></div><figcaption class="mf mg gj gh gi mh mi bd b be z dk">Seq2Seq Model</figcaption></figure><p id="39b4" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在神经机器翻译的情况下，输入是一系列单词，输出是翻译的一系列单词。</p><p id="4a4d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">现在让我们努力减少我们的黑匣子的黑色。该模型由一个<em class="ko">编码器</em>和一个<em class="ko">解码器</em>组成。编码器以<em class="ko">隐藏状态向量</em>的形式捕获输入序列的<em class="ko">上下文</em>，并将其发送至解码器，解码器随后产生输出序列。由于任务是基于序列的，编码器和解码器都倾向于使用某种形式的 RNNs、LSTMs、GRUs 等。隐藏状态向量可以是任何大小，尽管在大多数情况下，它被视为 2 的次方和一个大数字(256，512，1024 ),这在某种程度上可以表示完整序列和域的复杂性。</p><figure class="lu lv lw lx gt ly gh gi paragraph-image"><div role="button" tabindex="0" class="lz ma di mb bf mc"><div class="gh gi ca"><img src="../Images/eee5a2b2c578b10dc9d14ed5bf387e76.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qwJ1bOJEXjVUMsqEh0kuHA.png"/></div></div></figure><h1 id="a900" class="kq kr it bd ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln bi translated">我们再深入一点！RNNs！</h1><figure class="lu lv lw lx gt ly gh gi paragraph-image"><div role="button" tabindex="0" class="lz ma di mb bf mc"><div class="gh gi mj"><img src="../Images/f0a8acaa2cef20dcbced8bd944d4f1ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Rkf5UgcyJ5h1X06Y7S3kHg.png"/></div></div><figcaption class="mf mg gj gh gi mh mi bd b be z dk">RNN Cell</figcaption></figure><p id="a624" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">根据设计，RNNs 有两个输入，一个是它们看到的当前示例，另一个是以前输入的表示。因此，时间步长<em class="ko"> t </em>处的输出取决于当前输入以及时间<em class="ko"> t-1 </em>处的输入。这就是为什么他们在面对与序列相关的任务时表现得更好。顺序信息保存在网络的隐藏状态中，并在下一个实例中使用。</p><p id="933e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">由 RNNs 组成的编码器将序列作为输入，并在序列的末尾生成最终嵌入。然后将它发送到解码器，解码器使用它来预测序列，在每次连续预测之后，它使用前一个隐藏状态来预测序列的下一个实例。</p><figure class="lu lv lw lx gt ly gh gi paragraph-image"><div role="button" tabindex="0" class="lz ma di mb bf mc"><div class="gh gi mk"><img src="../Images/573c3889f1f5ee562484ca8a2d3f660a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*K9PhG8uxOLisgqyiMYji0g.png"/></div></div><figcaption class="mf mg gj gh gi mh mi bd b be z dk">Encoder-Decoder Model for Seq2Seq Modelling</figcaption></figure><p id="9a2c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu"> <em class="ko">缺点:</em> </strong>输出序列严重依赖编码器最终输出中隐藏状态定义的上下文，使得模型处理长句具有挑战性。在长序列的情况下，初始上下文很可能在序列结束时丢失。</p><p id="7151" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu"> <em class="ko">解决方案:</em> </strong> <a class="ae kp" href="https://arxiv.org/abs/1409.0473" rel="noopener ugc nofollow" target="_blank"> Bahdanau 等人，2014 </a>和<a class="ae kp" href="https://arxiv.org/abs/1508.04025" rel="noopener ugc nofollow" target="_blank"> Luong 等人，2015 </a>论文介绍了一种称为“注意力”的技术，它允许模型在输出序列的每个阶段关注输入序列的不同部分，从而允许上下文从头到尾得到保留。</p><h1 id="3e7a" class="kq kr it bd ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln bi translated">现在我引起你的注意了！；P</h1><p id="d2b0" class="pw-post-body-paragraph jq jr it js b jt lo jv jw jx lp jz ka kb lq kd ke kf lr kh ki kj ls kl km kn im bi translated">简而言之，由于问题是编码器末端的单个隐藏状态向量是不够的，我们发送与输入序列中实例数量一样多的隐藏状态向量。这是新的表现形式:</p><figure class="lu lv lw lx gt ly gh gi paragraph-image"><div role="button" tabindex="0" class="lz ma di mb bf mc"><div class="gh gi ml"><img src="../Images/dc5bd3a9663e5b22d1b51c393d337e2f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8f9k9MRmdpCUVvophQKyXw.png"/></div></div><figcaption class="mf mg gj gh gi mh mi bd b be z dk">Seq2Seq with Attention — incomplete</figcaption></figure><p id="a5a8" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">听起来很简单，不是吗？让我们引入更多的复杂性。解码器到底是如何使用隐藏状态向量集的？到目前为止，这两个模型之间的唯一区别是在解码阶段引入了所有输入实例的隐藏状态。</p><p id="3044" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">创建基于注意力的模型的另一个有价值的补充是<em class="ko">上下文向量</em>。这是为输出序列中的每个时间实例生成的。在每一步，上下文向量是输入隐藏状态的加权和，如下所示:</p><figure class="lu lv lw lx gt ly gh gi paragraph-image"><div class="gh gi mm"><img src="../Images/585e0dca154dd17891dcd9908cd163e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:304/format:webp/1*JUhEbMltn1e6eXhylzaAgQ.png"/></div><figcaption class="mf mg gj gh gi mh mi bd b be z dk">Context Vector</figcaption></figure><p id="486c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">但是如何在预测中使用上下文向量呢？而权重<em class="ko"> a1，a2，a3 </em>又是如何决定的呢？让我们一次解决一个问题，先解决一个简单的问题——上下文向量。</p><p id="c198" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">所生成的上下文向量通过级联与隐藏状态向量相结合，并且这个新的<em class="ko">注意力隐藏向量</em>用于预测该时刻的输出。注意，这个注意力向量是为输出序列中的每个时间实例生成的，并且现在取代了隐藏状态向量。</p><figure class="lu lv lw lx gt ly gh gi paragraph-image"><div class="gh gi mm"><img src="../Images/5fc374e7784752f784dbff9bb7ba0bb7.png" data-original-src="https://miro.medium.com/v2/resize:fit:304/format:webp/1*bEQWItT1fMSImjKSDLooTg.png"/></div><figcaption class="mf mg gj gh gi mh mi bd b be z dk">Attention hidden state</figcaption></figure><p id="72b2" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">现在我们到了谜题的最后一块，注意力得分。</p><p id="5eae" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">同样，简单地说，这些是另一个神经网络模型<em class="ko">比对模型</em>的输出，该模型最初与 seq2seq 模型联合训练。对齐模型对输入(由其隐藏状态表示)与先前输出(由注意力隐藏状态表示)的匹配程度进行评分，并对每个输入与先前输出进行匹配。然后对所有这些分数取一个最大值，得到的数字就是每个输入的注意力分数。</p><figure class="lu lv lw lx gt ly gh gi paragraph-image"><div role="button" tabindex="0" class="lz ma di mb bf mc"><div class="gh gi mn"><img src="../Images/bd6952ecf20770535c0f93737d18dde4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hLzauU2gyNfsOkjPLYhHXQ.png"/></div></div><figcaption class="mf mg gj gh gi mh mi bd b be z dk">Attention scoring</figcaption></figure><p id="10ea" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">因此，我们现在知道输入的哪一部分对于输出序列中每个实例的预测是最重要的。在训练阶段，模型已经学会了如何将各种实例从输出序列对齐到输入序列。下面是一个机器翻译模型的示例，以矩阵形式显示。注意，矩阵中的每个条目都是与输入和输出序列相关联的注意力分数。</p><figure class="lu lv lw lx gt ly gh gi paragraph-image"><div role="button" tabindex="0" class="lz ma di mb bf mc"><div class="gh gi mo"><img src="../Images/24df6dc21182572b74be41c7f303a222.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jLQ3jZwYLRKJsUk1SRKFQw.png"/></div></div><figcaption class="mf mg gj gh gi mh mi bd b be z dk">French to English conversion. Notice how the model weighted the input sequence while outputing European Economic Area”</figcaption></figure><p id="6dde" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">所以现在我们有了最终完整的模型</p><figure class="lu lv lw lx gt ly gh gi paragraph-image"><div role="button" tabindex="0" class="lz ma di mb bf mc"><div class="gh gi mp"><img src="../Images/1b2ed2cd7cd90554e805598c3da4ee26.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*A4H-IhqwjNZ_eL57Cqch0A.png"/></div></div><figcaption class="mf mg gj gh gi mh mi bd b be z dk">Seq2Seq Attention Based Model</figcaption></figure><p id="3355" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如我们所见，我们开始使用的黑盒现在变成了白色。以下是图片摘要:</p><figure class="lu lv lw lx gt ly gh gi paragraph-image"><div role="button" tabindex="0" class="lz ma di mb bf mc"><div class="gh gi mq"><img src="../Images/ab2c6ad8b5db0bb0a6649b592f722b14.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*48kpsosXjQruH_BGERRHig.png"/></div></div></figure><figure class="lu lv lw lx gt ly gh gi paragraph-image"><div role="button" tabindex="0" class="lz ma di mb bf mc"><div class="gh gi mr"><img src="../Images/1973d96514c8f8abe5df54314ab55715.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*evpDWm7Gm0q0_QLwB0QHPw.png"/></div></div></figure><p id="ac1c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我希望你觉得这很有用并且容易理解。如果有任何更正或任何形式的反馈，我希望收到您的来信。请在这里评论，让我知道。</p></div><div class="ab cl ms mt hx mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="im in io ip iq"><h1 id="e4ff" class="kq kr it bd ks kt mz kv kw kx na kz la lb nb ld le lf nc lh li lj nd ll lm ln bi translated">参考资料:</h1><div class="ne nf gp gr ng nh"><a href="https://jalammar.github.io/visualizing-neural-machine-translation-mechanics-of-seq2seq-models-with-attention/" rel="noopener  ugc nofollow" target="_blank"><div class="ni ab fo"><div class="nj ab nk cl cj nl"><h2 class="bd iu gy z fp nm fr fs nn fu fw is bi translated">可视化神经机器翻译模型(Seq2seq 模型的机制，注意)</h2><div class="no l"><h3 class="bd b gy z fp nm fr fs nn fu fw dk translated">翻译:中文(简体)，韩文观察:麻省理工学院的深度学习艺术讲座引用此贴…</h3></div><div class="np l"><p class="bd b dl z fp nm fr fs nn fu fw dk translated">jalammar.github.io</p></div></div><div class="nq l"><div class="nr l ns nt nu nq nv md nh"/></div></div></a></div><div class="ne nf gp gr ng nh"><a href="https://skymind.ai/wiki/lstm" rel="noopener  ugc nofollow" target="_blank"><div class="ni ab fo"><div class="nj ab nk cl cj nl"><h2 class="bd iu gy z fp nm fr fs nn fu fw is bi translated">LSTMs 和递归神经网络初学者指南</h2><div class="no l"><h3 class="bd b gy z fp nm fr fs nn fu fw dk translated">数据只能反向理解；但它必须向前看。-索伦·克尔凯郭尔，日记内容实际上…</h3></div><div class="np l"><p class="bd b dl z fp nm fr fs nn fu fw dk translated">skymind.ai</p></div></div><div class="nq l"><div class="nw l ns nt nu nq nv md nh"/></div></div></a></div><div class="ne nf gp gr ng nh"><a href="https://arxiv.org/abs/1409.0473" rel="noopener  ugc nofollow" target="_blank"><div class="ni ab fo"><div class="nj ab nk cl cj nl"><h2 class="bd iu gy z fp nm fr fs nn fu fw is bi translated">通过联合学习对齐和翻译的神经机器翻译</h2><div class="no l"><h3 class="bd b gy z fp nm fr fs nn fu fw dk translated">神经机器翻译是最近提出的机器翻译方法。不同于传统的统计…</h3></div><div class="np l"><p class="bd b dl z fp nm fr fs nn fu fw dk translated">arxiv.org</p></div></div></div></a></div><div class="ne nf gp gr ng nh"><a href="https://github.com/tensorflow/nmt" rel="noopener  ugc nofollow" target="_blank"><div class="ni ab fo"><div class="nj ab nk cl cj nl"><h2 class="bd iu gy z fp nm fr fs nn fu fw is bi translated">张量流/nmt</h2><div class="no l"><h3 class="bd b gy z fp nm fr fs nn fu fw dk translated">TensorFlow 神经机器翻译教程。通过在…上创建帐户，为 tensorflow/nmt 的发展做出贡献</h3></div><div class="np l"><p class="bd b dl z fp nm fr fs nn fu fw dk translated">github.com</p></div></div><div class="nq l"><div class="nx l ns nt nu nq nv md nh"/></div></div></a></div><div class="ne nf gp gr ng nh"><a href="https://blog.google/products/translate/found-translation-more-accurate-fluent-sentences-google-translate/" rel="noopener  ugc nofollow" target="_blank"><div class="ni ab fo"><div class="nj ab nk cl cj nl"><h2 class="bd iu gy z fp nm fr fs nn fu fw is bi translated">在翻译中发现:谷歌翻译中更准确、流畅的句子</h2><div class="no l"><h3 class="bd b gy z fp nm fr fs nn fu fw dk translated">在 10 年里，谷歌翻译已经从仅仅支持几种语言发展到 103 种，连接陌生人，达到…</h3></div><div class="np l"><p class="bd b dl z fp nm fr fs nn fu fw dk translated">博客.谷歌</p></div></div><div class="nq l"><div class="ny l ns nt nu nq nv md nh"/></div></div></a></div><div class="ne nf gp gr ng nh"><a href="https://medium.com/@bgg/seq2seq-pay-attention-to-self-attention-part-1-d332e85e9aad" rel="noopener follow" target="_blank"><div class="ni ab fo"><div class="nj ab nk cl cj nl"><h2 class="bd iu gy z fp nm fr fs nn fu fw is bi translated">Seq2seq 关注自我关注:第 1 部分</h2><div class="no l"><h3 class="bd b gy z fp nm fr fs nn fu fw dk translated">Seq2seq 与注意模型</h3></div><div class="np l"><p class="bd b dl z fp nm fr fs nn fu fw dk translated">medium.com</p></div></div><div class="nq l"><div class="nz l ns nt nu nq nv md nh"/></div></div></a></div><div class="ne nf gp gr ng nh"><a href="https://arxiv.org/abs/1508.04025" rel="noopener  ugc nofollow" target="_blank"><div class="ni ab fo"><div class="nj ab nk cl cj nl"><h2 class="bd iu gy z fp nm fr fs nn fu fw is bi translated">基于注意力的神经机器翻译的有效方法</h2><div class="no l"><h3 class="bd b gy z fp nm fr fs nn fu fw dk translated">一种注意力机制最近被用于通过选择性地聚焦于……来改善神经机器翻译(NMT)</h3></div><div class="np l"><p class="bd b dl z fp nm fr fs nn fu fw dk translated">arxiv.org</p></div></div></div></a></div><div class="ne nf gp gr ng nh"><a href="https://datascience.stackexchange.com/questions/16416/why-the-number-of-neurons-or-convolutions-chosen-equal-powers-of-two" rel="noopener  ugc nofollow" target="_blank"><div class="ni ab fo"><div class="nj ab nk cl cj nl"><h2 class="bd iu gy z fp nm fr fs nn fu fw is bi translated">为什么神经元或卷积的数量选择 2 的等幂？</h2><div class="no l"><h3 class="bd b gy z fp nm fr fs nn fu fw dk translated">感谢您为 Data Science Stack Exchange 贡献答案！请务必回答问题。提供…</h3></div><div class="np l"><p class="bd b dl z fp nm fr fs nn fu fw dk translated">datascience.stackexchange.com</p></div></div><div class="nq l"><div class="oa l ns nt nu nq nv md nh"/></div></div></a></div><p id="ab45" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">Sutskever，Ilya，Oriol Vinyals 和 Quoc V. Le。"用神经网络进行序列对序列学习."<em class="ko">神经信息处理系统的进展</em>。2014.</p><p id="6e50" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">使用统计机器翻译的 RNN 编码解码器学习短语表达<em class="ko"> arXiv 预印本 arXiv:1406.1078 </em> (2014)。</p><p id="4f6d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">https://www . guide light . com . au/the-guide light-psychology-blog/？类别=生活+教练</p></div></div>    
</body>
</html>