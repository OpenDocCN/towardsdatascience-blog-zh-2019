<html>
<head>
<title>Create a Multipage Dash Application</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">创建多页 Dash 应用程序</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/create-a-multipage-dash-application-eceac464de91?source=collection_archive---------3-----------------------#2019-10-19">https://towardsdatascience.com/create-a-multipage-dash-application-eceac464de91?source=collection_archive---------3-----------------------#2019-10-19</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div class="gh gi jq"><img src="../Images/441fce4808627c318d1af11712ca1281.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*HgyPzToO2mLGQ8V5OyGirQ.gif"/></div></figure><p id="2098" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated"><strong class="jz iu">制作仪表板</strong>是向编码人员和非编码人员传达数据科学项目价值的好方法！</p><p id="faf3" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">对于我们这些从事数据科学工作的人来说，我们的数据技能往往伴随着前端开发技能的缺乏。由 Plotly 构建的 Dash 库提供了简单的 boiler plate 代码，用于开发 Python 中的交互式 web 应用程序。</p><p id="290e" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated"><em class="kv">寻找灵感，查看</em> <a class="ae kw" href="https://dash-gallery.plotly.host/Portal/" rel="noopener ugc nofollow" target="_blank"> <em class="kv">仪表盘图库</em> </a> <em class="kv">！</em></p><p id="5a84" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">在本文中，我将介绍构建一个基本的多页面 dash 应用程序的步骤。该项目的代码和数据可以在<a class="ae kw" href="https://github.com/joelsewhere/dash_app" rel="noopener ugc nofollow" target="_blank"> this Github repo </a>中找到。</p><h1 id="c359" class="kx ky it bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">为什么是多页应用？</h1><p id="efd6" class="pw-post-body-paragraph jx jy it jz b ka lv kc kd ke lw kg kh ki lx kk kl km ly ko kp kq lz ks kt ku im bi translated">学习构建一个多页面应用程序是非常有用的，原因有很多。以下是一些例子:</p><ol class=""><li id="72b2" class="ma mb it jz b ka kb ke kf ki mc km md kq me ku mf mg mh mi bi translated">允许为方法或背景信息添加单独的页面。</li><li id="ea86" class="ma mb it jz b ka mj ke mk ki ml km mm kq mn ku mf mg mh mi bi translated">将一个复杂的数据项目分解到多个页面中可以带来流畅的用户体验。</li><li id="c086" class="ma mb it jz b ka mj ke mk ki ml km mm kq mn ku mf mg mh mi bi translated">可以用来建立一个在线投资组合！</li><li id="e5c8" class="ma mb it jz b ka mj ke mk ki ml km mm kq mn ku mf mg mh mi bi translated">理解工作流可以作为进入 web 开发世界的一小步。</li></ol><h1 id="539d" class="kx ky it bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">应用程序结构:</h1><h2 id="961b" class="mo ky it bd kz mp mq dn ld mr ms dp lh ki mt mu ll km mv mw lp kq mx my lt mz bi translated">项目目录:</h2><figure class="nb nc nd ne gt ju gh gi paragraph-image"><div class="gh gi na"><img src="../Images/f22ae199531e075b6b41228576e5f536.png" data-original-src="https://miro.medium.com/v2/resize:fit:576/format:webp/1*60RVFESGd7q1KBJnzEHpIQ.png"/></div></figure><p id="c23a" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">index.py 最终是运行整个应用程序的文件。可以把它看作是项目的目录。每个页面将在单独的文件中构建，然后导入到 index.py 中。此工作流用于保持文件的简洁和可读性，并保持项目结构的组织性和灵活性。</p><h2 id="58df" class="mo ky it bd kz mp mq dn ld mr ms dp lh ki mt mu ll km mv mw lp kq mx my lt mz bi translated">D.R.Y 代码</h2><p id="5a98" class="pw-post-body-paragraph jx jy it jz b ka lv kc kd ke lw kg kh ki lx kk kl km ly ko kp kq lz ks kt ku im bi translated">该工作流有助于避免重复代码。例如，这个应用程序的每个页面都需要一个导航栏。组件只是被导入，而不是在每个文件中编写相同的代码。</p><h1 id="6564" class="kx ky it bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">创建目录和环境</h1><p id="f45d" class="pw-post-body-paragraph jx jy it jz b ka lv kc kd ke lw kg kh ki lx kk kl km ly ko kp kq lz ks kt ku im bi translated">首先，我们创建一个文件夹来保存我们所有的项目文件:</p><p id="3912" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">注意:我个人更喜欢使用 Visual Studio 代码或 Pycharm，但是为了使本演练易于理解，我们将坚持在终端中构建该应用程序。</p><p id="a2b9" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">在终端中:</p><pre class="nb nc nd ne gt nf ng nh ni aw nj bi"><span id="eb98" class="mo ky it ng b gy nk nl l nm nn">mkdir dash_app<br/>cd dash_app</span></pre><p id="314d" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">接下来我们要做的是创建一个虚拟环境来构建应用程序。不，这在技术上不是一个要求，但是它消除了产生依赖错误的风险，并且通常是构建 web 应用程序时的最佳实践。</p><pre class="nb nc nd ne gt nf ng nh ni aw nj bi"><span id="652c" class="mo ky it ng b gy nk nl l nm nn">pip install virtualenv<br/>virtualenv venv<br/>source venv/bin/activate</span></pre><p id="5600" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">(venv)现在应该出现在终端中的$符号之前。这意味着您现在正在使用您的虚拟环境。</p><p id="16d7" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">随着虚拟环境的激活，我们需要安装我们将用于这个项目的库。</p><pre class="nb nc nd ne gt nf ng nh ni aw nj bi"><span id="bbf9" class="mo ky it ng b gy nk nl l nm nn">pip install pandas<br/>pip install dash<br/>pip install dash-bootstrap-components</span><span id="a69a" class="mo ky it ng b gy no nl l nm nn">### These are dependences and are likely already installed</span><span id="4b78" class="mo ky it ng b gy no nl l nm nn">pip install dash-core-components<br/>pip install dash-html-components<br/>pip install plotly</span></pre><h1 id="1c03" class="kx ky it bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">构建导航栏:</h1><p id="044d" class="pw-post-body-paragraph jx jy it jz b ka lv kc kd ke lw kg kh ki lx kk kl km ly ko kp kq lz ks kt ku im bi translated">注意:导航栏和主页其余部分的代码直接从<a class="ae kw" href="https://dash-bootstrap-components.opensource.faculty.ai/" rel="noopener ugc nofollow" target="_blank"> dash bootstrap components 网站</a>复制而来。</p><p id="bf93" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated"><strong class="jz iu"> Dash bootstrap 组件</strong>将网页划分成网格，是组织 web 应用布局的有用工具。有关定位应用程序组件(网页上出现的任何内容)的更多信息，请点击<a class="ae kw" href="https://dash-bootstrap-components.opensource.faculty.ai/l/components/layout" rel="noopener ugc nofollow" target="_blank">此链接</a>并查看 dbc 的使用。Row 和 dbc.Column</p><p id="c93a" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">在终端中打开 vim 文本编辑器。</p><pre class="nb nc nd ne gt nf ng nh ni aw nj bi"><span id="0f04" class="mo ky it ng b gy nk nl l nm nn">vim navbar.py<br/>s</span></pre><p id="c3d3" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">s 启用了编辑模式，这样我们就可以开始编写代码了！</p><p id="35e8" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">在 navbar.py 中:</p><pre class="nb nc nd ne gt nf ng nh ni aw nj bi"><span id="f578" class="mo ky it ng b gy nk nl l nm nn">import dash_bootstrap_components as dbc</span><span id="bb3d" class="mo ky it ng b gy no nl l nm nn">def Navbar():<br/>     navbar = dbc.NavbarSimple(<br/>           children=[<br/>              dbc.NavItem(dbc.NavLink("Time-Series", href="/time-series")),<br/>              dbc.DropdownMenu(<br/>                 nav=True,<br/>                 in_navbar=True,<br/>                 label="Menu",<br/>                 children=[<br/>                    dbc.DropdownMenuItem("Entry 1"),<br/>                    dbc.DropdownMenuItem("Entry 2"),<br/>                    dbc.DropdownMenuItem(divider=True),<br/>                    dbc.DropdownMenuItem("Entry 3"),<br/>                          ],<br/>                      ),<br/>                    ],<br/>          brand="Home",<br/>          brand_href="/home",<br/>          sticky="top",<br/>        )</span><span id="e2a1" class="mo ky it ng b gy no nl l nm nn">return navbar</span></pre><p id="d458" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">在上面的第六行中，href 参数告诉应用程序将哪个页面返回给用户(如果在开头放置 https://就可以导航到外部网站！)</p><p id="abdb" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">在这行代码中，我们将 href 设置为“/time-series”。这将是我们的时间序列图的链接名称。</p><p id="f435" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">保存并退出文件。</p><pre class="nb nc nd ne gt nf ng nh ni aw nj bi"><span id="89da" class="mo ky it ng b gy nk nl l nm nn">Esc<br/>:wq [ENTER]</span></pre><h1 id="3dca" class="kx ky it bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">主页:</h1><pre class="nb nc nd ne gt nf ng nh ni aw nj bi"><span id="f89e" class="mo ky it ng b gy nk nl l nm nn">vim homepage.py<br/>## s to enable edit mode</span></pre><p id="7fd8" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">在 homepage.py 中，我们首先需要导入所需的库。</p><pre class="nb nc nd ne gt nf ng nh ni aw nj bi"><span id="48f0" class="mo ky it ng b gy nk nl l nm nn">import dash<br/>import dash_bootstrap_components as dbc<br/>import dash_core_components as dcc<br/>import dash_html_components as html</span></pre><p id="8399" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">我们还想从 navbar.py 导入 navbar 函数，并创建一个 Navbar 对象。</p><pre class="nb nc nd ne gt nf ng nh ni aw nj bi"><span id="269e" class="mo ky it ng b gy nk nl l nm nn">from navbar import Navbar</span><span id="3dcb" class="mo ky it ng b gy no nl l nm nn">nav = Navbar()</span></pre><h2 id="b6fc" class="mo ky it bd kz mp mq dn ld mr ms dp lh ki mt mu ll km mv mw lp kq mx my lt mz bi translated">构建主页主体:</h2><p id="2612" class="pw-post-body-paragraph jx jy it jz b ka lv kc kd ke lw kg kh ki lx kk kl km ly ko kp kq lz ks kt ku im bi translated">该页面的布局将是 2 个网格空间的网格。1 行，2 列。</p><p id="7dba" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">第一栏:</p><ul class=""><li id="67d4" class="ma mb it jz b ka kb ke kf ki mc km md kq me ku np mg mh mi bi translated">页眉</li><li id="903e" class="ma mb it jz b ka mj ke mk ki ml km mm kq mn ku np mg mh mi bi translated">段落</li><li id="6b29" class="ma mb it jz b ka mj ke mk ki ml km mm kq mn ku np mg mh mi bi translated">纽扣</li></ul><p id="cd04" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">第二栏:</p><ul class=""><li id="4fad" class="ma mb it jz b ka kb ke kf ki mc km md kq me ku np mg mh mi bi translated">页眉</li><li id="69d9" class="ma mb it jz b ka mj ke mk ki ml km mm kq mn ku np mg mh mi bi translated">图表</li></ul><p id="2899" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">额外加分:<a class="ae kw" href="https://dash.plot.ly/dash-deployment-server/static-assets" rel="noopener ugc nofollow" target="_blank">把图形改成图像。</a></p><pre class="nb nc nd ne gt nf ng nh ni aw nj bi"><span id="9899" class="mo ky it ng b gy nk nl l nm nn">body = dbc.Container(<br/>    [<br/>       dbc.Row(<br/>           [<br/>               dbc.Col(<br/>                  [<br/>                     html.H2("Heading"),<br/>                     html.P(<br/>                         """\<br/>Donec id elit non mi porta gravida at eget metus.Fusce dapibus, tellus ac cursus commodo, tortor mauris condimentumnibh, ut fermentum massa justo sit amet risus. Etiam porta semmalesuada magna mollis euismod. Donec sed odio dui. Donec id elit nonmi porta gravida at eget metus. Fusce dapibus, tellus ac cursuscommodo, tortor mauris condimentum nibh, ut fermentum massa justo sitamet risus. Etiam porta sem malesuada magna mollis euismod. Donec sedodio dui."""<br/>                           ),<br/>                           dbc.Button("View details", color="secondary"),<br/>                   ],<br/>                  md=4,<br/>               ),<br/>              dbc.Col(<br/>                 [<br/>                     html.H2("Graph"),<br/>                     dcc.Graph(<br/>                         figure={"data": [{"x": [1, 2, 3], "y": [1, 4, 9]}]}<br/>                            ),<br/>                        ]<br/>                     ),<br/>                ]<br/>            )<br/>       ],<br/>className="mt-4",<br/>)</span></pre><p id="9df9" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">下一位代码<em class="kv">重要</em>。</p><p id="f116" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">因为我们正在构建一个多页面应用程序，我们需要能够将布局导入到其他文件中。为此，我们将构建一个主页函数，返回页面的整个布局。</p><p id="8e73" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated"><em class="kv">注意:布局必须始终是一个破折号 html 组件。标准是将布局包装在一个 div 中。</em></p><pre class="nb nc nd ne gt nf ng nh ni aw nj bi"><span id="e6ce" class="mo ky it ng b gy nk nl l nm nn">def Homepage():<br/>    layout = html.Div([<br/>    nav,<br/>    body<br/>    ])</span><span id="967b" class="mo ky it ng b gy no nl l nm nn">return layout</span></pre><p id="33fc" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">在继续之前，让我们确保应用程序正常工作。为此，请将以下代码添加到页面底部。</p><pre class="nb nc nd ne gt nf ng nh ni aw nj bi"><span id="7552" class="mo ky it ng b gy nk nl l nm nn">app = dash.Dash(__name__, external_stylesheets = [dbc.themes.UNITED])</span><span id="9a37" class="mo ky it ng b gy no nl l nm nn">app.layout = Homepage()</span><span id="778a" class="mo ky it ng b gy no nl l nm nn">if __name__ == "__main__":<br/>    app.run_server()</span></pre><p id="ec99" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">保存并退出 vim。</p><pre class="nb nc nd ne gt nf ng nh ni aw nj bi"><span id="0008" class="mo ky it ng b gy nk nl l nm nn">Esc<br/>:wq [ENTER]</span></pre><p id="c8db" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">太好了！现在让我们运行应用程序，以确保代码正常工作！</p><pre class="nb nc nd ne gt nf ng nh ni aw nj bi"><span id="a3e5" class="mo ky it ng b gy nk nl l nm nn">python homepage.py</span></pre><p id="46c5" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">如果应用程序失败，将打印出一条错误消息。习惯这个，很大程度上是应用构建的工作流程。对我来说，90%的时间是一个简单的语法错误。阅读错误信息并调试问题。(如果我的代码有问题，请在评论中告诉我！)</p><p id="28a3" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">如果应用程序运行，将打印出几行。重要的一行应该是这样的:</p><pre class="nb nc nd ne gt nf ng nh ni aw nj bi"><span id="8de3" class="mo ky it ng b gy nk nl l nm nn">Running on <a class="ae kw" href="http://127.0.0.1:8050/" rel="noopener ugc nofollow" target="_blank">http://127.0.0.1:8050/</a></span></pre><p id="bbbe" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">复制 http url 并将其粘贴到互联网浏览器中。</p><blockquote class="nq"><p id="257e" class="nr ns it bd nt nu nv nw nx ny nz ku dk translated">转眼间。一个应用诞生了！</p></blockquote><p id="78df" class="pw-post-body-paragraph jx jy it jz b ka oa kc kd ke ob kg kh ki oc kk kl km od ko kp kq oe ks kt ku im bi translated">在你欣赏你的作品一段时间后，关闭网络应用。</p><pre class="nb nc nd ne gt nf ng nh ni aw nj bi"><span id="bf5b" class="mo ky it ng b gy nk nl l nm nn">[CTR] C<br/>##### It will look like this in terminal: ^C</span></pre><h1 id="0c49" class="kx ky it bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">应用</h1><p id="d3c4" class="pw-post-body-paragraph jx jy it jz b ka lv kc kd ke lw kg kh ki lx kk kl km ly ko kp kq lz ks kt ku im bi translated">现在让我们建立我们的交互式图形页面！</p><p id="e7ce" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">首先，我们创建一个 app.py 文件。</p><pre class="nb nc nd ne gt nf ng nh ni aw nj bi"><span id="8f14" class="mo ky it ng b gy nk nl l nm nn">vim app.py<br/>## s to enable edit mode</span></pre><p id="216c" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">接下来，导入应用程序的库、我们的 Navbar 函数以及伊利诺伊州的人口数据。</p><pre class="nb nc nd ne gt nf ng nh ni aw nj bi"><span id="2b08" class="mo ky it ng b gy nk nl l nm nn">### Data<br/>import pandas as pd<br/>import pickle</span><span id="ff3e" class="mo ky it ng b gy no nl l nm nn">### Graphing<br/>import plotly.graph_objects as go</span><span id="4f6b" class="mo ky it ng b gy no nl l nm nn">### Dash<br/>import dash<br/>import dash_core_components as dcc<br/>import dash_html_components as html<br/>import dash_bootstrap_components as dbc<br/>from dash.dependencies import Output, Input<br/></span><span id="daaf" class="mo ky it ng b gy no nl l nm nn">## Navbar<br/>from navbar import Navbar</span><span id="143c" class="mo ky it ng b gy no nl l nm nn">df = pd.read_csv('<a class="ae kw" href="https://gist.githubusercontent.com/joelsewhere/f75da35d9e0c7ed71e5a93c10c52358d/raw/d8534e2f25495cc1de3cd604f952e8cbc0cc3d96/population_il_cities.csv" rel="noopener ugc nofollow" target="_blank">https://gist.githubusercontent.com/joelsewhere/f75da35d9e0c7ed71e5a93c10c52358d/raw/d8534e2f25495cc1de3cd604f952e8cbc0cc3d96/population_il_cities.csv</a>')</span><span id="8186" class="mo ky it ng b gy no nl l nm nn">df.set_index(df.iloc[:,0], drop = True, inplace = True)</span><span id="6106" class="mo ky it ng b gy no nl l nm nn">df = df.iloc[:,1:]</span></pre><p id="a4b6" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">最后两行代码只是将日期列设置为索引，然后从数据集中删除该列的副本。</p><p id="89b5" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">好，现在让我们建立一些组件！</p><h2 id="d689" class="mo ky it bd kz mp mq dn ld mr ms dp lh ki mt mu ll km mv mw lp kq mx my lt mz bi translated">导航条:</h2><pre class="nb nc nd ne gt nf ng nh ni aw nj bi"><span id="4ce3" class="mo ky it ng b gy nk nl l nm nn">nav = Navbar()</span></pre><h2 id="ec31" class="mo ky it bd kz mp mq dn ld mr ms dp lh ki mt mu ll km mv mw lp kq mx my lt mz bi translated">标题:</h2><p id="3072" class="pw-post-body-paragraph jx jy it jz b ka lv kc kd ke lw kg kh ki lx kk kl km ly ko kp kq lz ks kt ku im bi translated">我们将使用标题向用户提供一些说明。</p><pre class="nb nc nd ne gt nf ng nh ni aw nj bi"><span id="0ea0" class="mo ky it ng b gy nk nl l nm nn">header = html.H3(<br/>    'Select the name of an Illinois city to see its population!'<br/>)</span></pre><h2 id="730a" class="mo ky it bd kz mp mq dn ld mr ms dp lh ki mt mu ll km mv mw lp kq mx my lt mz bi translated">下拉列表:</h2><p id="5f7c" class="pw-post-body-paragraph jx jy it jz b ka lv kc kd ke lw kg kh ki lx kk kl km ly ko kp kq lz ks kt ku im bi translated">对于这个应用程序，我们将建立一个下拉菜单。在后台，下拉菜单被格式化为字典列表。这本词典有两个关键词。“标签”和“价值”。label =用户将在下拉菜单中看到的内容，value =返回给应用程序以查询数据的内容。</p><p id="3b5f" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">因为每一列都是伊利诺伊州的一个城市，所以我们将使用这个数据集的列名进行查询。</p><p id="b844" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">每一列都被格式化为“伊利诺伊州的城市”。让每个标签都包含“伊利诺伊州”有点大材小用，因为我们只寻找伊利诺伊州的城市。在下面的代码中，我们将删除每个词典标签的这部分额外文本:</p><pre class="nb nc nd ne gt nf ng nh ni aw nj bi"><span id="5d6a" class="mo ky it ng b gy nk nl l nm nn">options = [{'label':x.replace(', Illinois', ''), 'value': x} for x in df.columns]</span></pre><p id="389e" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">现在，我们将字典列表直接插入到一个下拉对象中</p><p id="a936" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated"><strong class="jz iu"> <em class="kv">重要:</em> </strong>任何交互的组件都必须有一个 id 名。你很快就会明白为什么了。此外，组件不能共享 id 名称。如果一个 id 被多次使用，将会抛出一个错误，应用程序将会中断。</p><p id="67f3" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">dcc 中的参数。下拉功能有。</p><ul class=""><li id="1416" class="ma mb it jz b ka kb ke kf ki mc km md kq me ku np mg mh mi bi translated"><strong class="jz iu"> id: </strong>组件的唯一标识符。格式化为字符串。</li><li id="34c3" class="ma mb it jz b ka mj ke mk ki ml km mm kq mn ku np mg mh mi bi translated"><strong class="jz iu">选项:</strong>带有“标签”和“值”键的字典列表</li><li id="9be0" class="ma mb it jz b ka mj ke mk ki ml km mm kq mn ku np mg mh mi bi translated"><strong class="jz iu"> value: </strong>应用程序加载时下拉菜单设置的默认值。(我从数据集中随机选择了一个城市作为默认城市。)</li></ul><pre class="nb nc nd ne gt nf ng nh ni aw nj bi"><span id="0a82" class="mo ky it ng b gy nk nl l nm nn">dropdown = html.Div(dcc.Dropdown(<br/>    id = 'pop_dropdown',<br/>    options = options,<br/>    value = 'Abingdon city, Illinois'<br/>))</span></pre><p id="71d3" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">下拉完成！</p><h2 id="2026" class="mo ky it bd kz mp mq dn ld mr ms dp lh ki mt mu ll km mv mw lp kq mx my lt mz bi translated">输出空间:</h2><p id="3d83" class="pw-post-body-paragraph jx jy it jz b ka lv kc kd ke lw kg kh ki lx kk kl km ly ko kp kq lz ks kt ku im bi translated">这是我们输出图表的地方。</p><pre class="nb nc nd ne gt nf ng nh ni aw nj bi"><span id="b36d" class="mo ky it ng b gy nk nl l nm nn">output = html.Div(id = 'output',<br/>                children = [],<br/>                )</span></pre><p id="cd1b" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">这是所有的组件！</p><p id="37e9" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">现在，就像我们制作主页一样，我们将制作一个名为“App”的布局功能。</p><pre class="nb nc nd ne gt nf ng nh ni aw nj bi"><span id="1b11" class="mo ky it ng b gy nk nl l nm nn">def App():<br/>    layout = html.Div([<br/>        nav,<br/>        header,<br/>        dropdown,<br/>        output<br/>    ])</span><span id="f5d2" class="mo ky it ng b gy no nl l nm nn">return layout</span></pre><p id="2bfe" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">好的，现在让我们制作图表。我们将创建一个 build_graph 函数，该函数将从下拉菜单中接受一个城市，并返回一个显示该城市人口趋势的图表。</p><pre class="nb nc nd ne gt nf ng nh ni aw nj bi"><span id="e39f" class="mo ky it ng b gy nk nl l nm nn">def build_graph(city):</span><span id="fbfa" class="mo ky it ng b gy no nl l nm nn">data = [go.Scatter(x = df.index,<br/>                        y = df[city],<br/>                        marker = {'color': 'orange'})]</span><span id="e0fe" class="mo ky it ng b gy no nl l nm nn">graph = dcc.Graph(<br/>           figure = {<br/>               'data': data,</span><span id="ea03" class="mo ky it ng b gy no nl l nm nn">'layout': go.Layout(<br/>                    title = '{} Population Change'.format(city),<br/>                    yaxis = {'title': 'Population'},<br/>                    hovermode = 'closest'<br/>                                  )<br/>                       }<br/>             )</span><span id="b300" class="mo ky it ng b gy no nl l nm nn">return graph</span></pre><p id="f0a8" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">好吧！这个文件到此为止。确保保存并退出。</p><pre class="nb nc nd ne gt nf ng nh ni aw nj bi"><span id="d076" class="mo ky it ng b gy nk nl l nm nn">Esc<br/>:wq [ENTER]</span></pre><h1 id="512a" class="kx ky it bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">索引</h1><p id="eada" class="pw-post-body-paragraph jx jy it jz b ka lv kc kd ke lw kg kh ki lx kk kl km ly ko kp kq lz ks kt ku im bi translated">现在，让我们用一个 index.py 文件将它们集合起来！</p><pre class="nb nc nd ne gt nf ng nh ni aw nj bi"><span id="b239" class="mo ky it ng b gy nk nl l nm nn">vim index.py<br/>## s to enable edit mode</span></pre><p id="d6ad" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">导入所有的库和函数。</p><pre class="nb nc nd ne gt nf ng nh ni aw nj bi"><span id="c732" class="mo ky it ng b gy nk nl l nm nn">import dash<br/>import dash_core_components as dcc<br/>import dash_html_components as html<br/>from dash.dependencies import Input, Output<br/>import dash_bootstrap_components as dbc</span><span id="4c82" class="mo ky it ng b gy no nl l nm nn">from app import App, build_graph</span><span id="7593" class="mo ky it ng b gy no nl l nm nn">from homepage import Homepage</span></pre><p id="d3e9" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">接下来，我们声明一个 dash app 对象。为了美观，我们将通过传入 dbc.themes 外部样式表来使用主题。主题的名字总是大写的，并且包含在一个列表中。随意阅读可用的主题<a class="ae kw" href="https://bootswatch.com/" rel="noopener ugc nofollow" target="_blank">这里</a>。</p><pre class="nb nc nd ne gt nf ng nh ni aw nj bi"><span id="2ec4" class="mo ky it ng b gy nk nl l nm nn">app = dash.Dash(__name__, external_stylesheets=[dbc.themes.UNITED])</span></pre><p id="71f8" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated"><strong class="jz iu"> <em class="kv">重要:</em> </strong>为了让我们的时间序列图具有交互性，我们要为下拉菜单和输出空间创建一个回调函数。但是，dash 不允许回调布局中不存在的组件。因为主页布局中没有下拉菜单或输出空间，所以我们必须更改应用程序的配置。</p><pre class="nb nc nd ne gt nf ng nh ni aw nj bi"><span id="6113" class="mo ky it ng b gy nk nl l nm nn">app.config.suppress_callback_exceptions = True</span></pre><p id="86d7" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">接下来，我们创建一个 dcc。Location 对象，在应用程序中不可见，但监视 url。这将告诉我们的应用程序根据用户点击的链接返回一个页面。</p><p id="f274" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">现在，创建一个内容空间，我们可以在这里返回主页或时间序列页面。</p><pre class="nb nc nd ne gt nf ng nh ni aw nj bi"><span id="3679" class="mo ky it ng b gy nk nl l nm nn">app.layout = html.Div([<br/>    dcc.Location(id = 'url', refresh = False),<br/>    html.Div(id = 'page-content')<br/>])</span></pre><h1 id="88de" class="kx ky it bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">复试</h1><p id="ad57" class="pw-post-body-paragraph jx jy it jz b ka lv kc kd ke lw kg kh ki lx kk kl km ly ko kp kq lz ks kt ku im bi translated">好吧！现在让我们使我们的应用程序具有交互性，这样当用户点击某些东西时，事情就会发生。</p><p id="4284" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">我们需要两次复试。一个用于返回应用程序的不同页面，另一个用于更新图表。</p><p id="777c" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">为此，我们声明@app.callback</p><p id="3298" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">在 app.callback 中，我们传递在文件顶部导入的输出函数。输出的参数是:</p><ol class=""><li id="d0f2" class="ma mb it jz b ka kb ke kf ki mc km md kq me ku mf mg mh mi bi translated">正在更新的组件的 id。</li><li id="8524" class="ma mb it jz b ka mj ke mk ki ml km mm kq mn ku mf mg mh mi bi translated">正在更新的组件的参数。(90%的情况下，您将更新一个 div，并且该参数将被设置为“children”)</li></ol><p id="e56b" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">注意:一个回调可以更新多个输出空间。只需将所有输出函数包装在一个列表中。</p><p id="e69a" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">接下来，我们将输入函数传递给 app.callback。</p><ul class=""><li id="d8fc" class="ma mb it jz b ka kb ke kf ki mc km md kq me ku np mg mh mi bi translated">* *输入总是包含在列表中。即使只有一个输入**</li><li id="0c29" class="ma mb it jz b ka mj ke mk ki ml km mm kq mn ku np mg mh mi bi translated">输入参数与输出参数相同</li></ul><p id="ac53" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">在这种情况下，我们输出到我们的“页面内容”div，并从我们的“url”位置输入。</p><pre class="nb nc nd ne gt nf ng nh ni aw nj bi"><span id="e193" class="mo ky it ng b gy nk nl l nm nn"><a class="ae kw" href="http://twitter.com/app" rel="noopener ugc nofollow" target="_blank">@app</a>.callback(Output('page-content', 'children'),<br/>            [Input('url', 'pathname')])<br/>def display_page(pathname):<br/>    if pathname == '/time-series':<br/>        return App()</span><span id="f4db" class="mo ky it ng b gy no nl l nm nn">else:<br/>        return Homepage()</span></pre><p id="0d4b" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">现在我们为我们的时序图创建回调。</p><p id="c1c5" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">因为我们做了一个 build_graph 函数，所以这个回调超级简单。</p><pre class="nb nc nd ne gt nf ng nh ni aw nj bi"><span id="19a6" class="mo ky it ng b gy nk nl l nm nn"><a class="ae kw" href="http://twitter.com/app" rel="noopener ugc nofollow" target="_blank">@app</a>.callback(<br/>    Output('output', 'children'),<br/>    [Input('pop_dropdown', 'value')]<br/>)<br/>def update_graph(city):</span><span id="0c1d" class="mo ky it ng b gy no nl l nm nn">graph = build_graph(city)</span><span id="c484" class="mo ky it ng b gy no nl l nm nn">return graph</span></pre><p id="4109" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">最后，让应用程序运行。</p><pre class="nb nc nd ne gt nf ng nh ni aw nj bi"><span id="8c59" class="mo ky it ng b gy nk nl l nm nn">if __name__ == '__main__':<br/>    app.run_server(debug=True)</span></pre><p id="02dd" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">注意，我已经设置了 debug=True。在部署应用程序时，您应该将其设置为 false，但我们正处于开发阶段，将 debug 设置为 True 会使应用程序的调试变得更加容易。</p><p id="59fa" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">保存并退出:</p><pre class="nb nc nd ne gt nf ng nh ni aw nj bi"><span id="be05" class="mo ky it ng b gy nk nl l nm nn">Esc<br/>:wq [ENTER]</span></pre><p id="51e8" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">并运行应用程序！</p><pre class="nb nc nd ne gt nf ng nh ni aw nj bi"><span id="e05b" class="mo ky it ng b gy nk nl l nm nn">python index.py</span></pre><h1 id="fdda" class="kx ky it bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">结论</h1><p id="61d8" class="pw-post-body-paragraph jx jy it jz b ka lv kc kd ke lw kg kh ki lx kk kl km ly ko kp kq lz ks kt ku im bi translated">这是一个简单的例子，但是这些基础可以用来构建更加复杂和强大的应用程序！</p><p id="07f3" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">发表评论，如果你有任何问题，请告诉我。</p><p id="4bcc" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">附:退出您的虚拟环境。</p><pre class="nb nc nd ne gt nf ng nh ni aw nj bi"><span id="1e3d" class="mo ky it ng b gy nk nl l nm nn">deactivate</span></pre></div></div>    
</body>
</html>