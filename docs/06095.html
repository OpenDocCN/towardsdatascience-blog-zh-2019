<html>
<head>
<title>Hyper Parameter Tuning with Randomised Grid Search</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">利用随机网格搜索的超参数调谐</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/hyper-parameter-tuning-with-randomised-grid-search-54f865d27926?source=collection_archive---------18-----------------------#2019-09-04">https://towardsdatascience.com/hyper-parameter-tuning-with-randomised-grid-search-54f865d27926?source=collection_archive---------18-----------------------#2019-09-04</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="f82c" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">为什么随机网格搜索更好，如何使用它？</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/a9f7c0ce339da084be6acfdd815f2a53.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oy_ASKYYe6H3ziWCeWCv7A.jpeg"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Jewel Changi Singapore — beautiful isn’t it?</figcaption></figure></div><div class="ab cl ky kz hx la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="im in io ip iq"><blockquote class="lf lg lh"><p id="950d" class="li lj lk ll b lm ln ju lo lp lq jx lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">随机网格搜索在为任何机器学习模型寻找接近最优的超参数时非常有用。</p><p id="381c" class="li lj lk ll b lm ln ju lo lp lq jx lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">经验法则:无论网格大小如何，60 次迭代，95%的时间，可以找到最好的 5%的参数集。</p></blockquote></div><div class="ab cl ky kz hx la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="im in io ip iq"><h2 id="2e00" class="mf mg it bd mh mi mj dn mk ml mm dp mn mo mp mq mr ms mt mu mv mw mx my mz na bi translated"><strong class="ak">什么是网格搜索？</strong></h2><blockquote class="lf lg lh"><p id="eb8f" class="li lj lk ll b lm ln ju lo lp lq jx lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">网格搜索是一种寻找最优参数集的残酷搜索算法。</p></blockquote><p id="6cbc" class="pw-post-body-paragraph li lj it ll b lm ln ju lo lp lq jx lr mo lt lu lv ms lx ly lz mw mb mc md me im bi translated">让我们假设我们正在构建一个二元随机森林分类模型，并将使用 AUC 来评估它。在所有的数据处理和特征工程之后，我们需要调整参数以达到最大的精度。</p><p id="9477" class="pw-post-body-paragraph li lj it ll b lm ln ju lo lp lq jx lr mo lt lu lv ms lx ly lz mw mb mc md me im bi translated">经过一些初步分析后，我们决定从数值范围中选择参数，例如:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nb nc l"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Example: parameter grid</figcaption></figure><p id="ba9e" class="pw-post-body-paragraph li lj it ll b lm ln ju lo lp lq jx lr mo lt lu lv ms lx ly lz mw mb mc md me im bi translated">这是一个<strong class="ll iu">参数网格</strong>，由<strong class="ll iu">所有可能的参数组合组成。36 (2*3*3*2)组潜在的参数可以从这个网格中提取。</strong></p><p id="d8f3" class="pw-post-body-paragraph li lj it ll b lm ln ju lo lp lq jx lr mo lt lu lv ms lx ly lz mw mb mc md me im bi translated"><strong class="ll iu">网格搜索将计算每组参数的准确度分数，并选择产生最佳结果的一个。</strong>在下面的例子中，网格搜索将输出集合 4，因为它产生最高的 AUC。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nb nc l"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Example: AUC score for each parameter set in the grid</figcaption></figure></div><div class="ab cl ky kz hx la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="im in io ip iq"><h2 id="c4c2" class="mf mg it bd mh mi mj dn mk ml mm dp mn mo mp mq mr ms mt mu mv mw mx my mz na bi translated"><strong class="ak">为什么网格搜索会失败？</strong></h2><p id="1396" class="pw-post-body-paragraph li lj it ll b lm nd ju lo lp ne jx lr mo nf lu lv ms ng ly lz mw nh mc md me im bi translated">网格搜索保证在网格中找到最佳参数集。然而，<strong class="ll iu">随着更多的参数或更多的参数选择添加到网格中，网格的大小呈指数级增长。</strong></p><p id="9ba4" class="pw-post-body-paragraph li lj it ll b lm ln ju lo lp lq jx lr mo lt lu lv ms lx ly lz mw mb mc md me im bi translated">使用上面的例子，让我们用 5 个候选参数再调整一个参数“最小杂质减少”,并为所有现有参数添加一个选项。通过稍微扩大搜索区域，网格扩展到 720 (3*4*4*3*5)个集合，比原始网格大 20 倍！如果原来的网格搜索需要 20 分钟，这个网格就需要将近 7 个小时才能完成。</p><p id="4f55" class="pw-post-body-paragraph li lj it ll b lm ln ju lo lp lq jx lr mo lt lu lv ms lx ly lz mw mb mc md me im bi translated"><strong class="ll iu">因此，当我们调整具有许多参数的复杂模型时，网格搜索在许多情况下不太可行。</strong></p></div><div class="ab cl ky kz hx la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="im in io ip iq"><h2 id="e431" class="mf mg it bd mh mi mj dn mk ml mm dp mn mo mp mq mr ms mt mu mv mw mx my mz na bi translated">随机网格搜索是网格搜索的一个很好的替代品</h2><p id="6da5" class="pw-post-body-paragraph li lj it ll b lm nd ju lo lp ne jx lr mo nf lu lv ms ng ly lz mw nh mc md me im bi translated"><strong class="ll iu">随机网格搜索不是穷举搜索，而是从网格中随机抽取一组参数来计算每次迭代的精确度分数。</strong>可以调整迭代次数，所有迭代中的最佳集合将作为输出。</p><p id="14b5" class="pw-post-body-paragraph li lj it ll b lm ln ju lo lp lq jx lr mo lt lu lv ms lx ly lz mw mb mc md me im bi translated">显然，由于控制了迭代次数，随机网格搜索消耗了更少的计算能力。但是，需要多少次迭代才能找到足够好的参数集呢？</p><blockquote class="lf lg lh"><p id="a9c0" class="li lj lk ll b lm ln ju lo lp lq jx lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated"><strong class="ll iu">经验法则:</strong>无论网格大小如何，60 次迭代，95%的时间，可以找到最好的 5%的参数集。</p></blockquote><p id="6b31" class="pw-post-body-paragraph li lj it ll b lm ln ju lo lp lq jx lr mo lt lu lv ms lx ly lz mw mb mc md me im bi translated"><strong class="ll iu">简单数学证明:</strong></p><ol class=""><li id="7844" class="ni nj it ll b lm ln lp lq mo nk ms nl mw nm me nn no np nq bi translated">让我们将<em class="lk"> n </em>表示为迭代次数。</li><li id="3ac3" class="ni nj it ll b lm nr lp ns mo nt ms nu mw nv me nn no np nq bi translated">经过<em class="lk"> n </em>次迭代后，从网格中抽取的最佳<em class="lk"> p </em>组参数中没有一组的概率是(1- <em class="lk"> p)ⁿ </em></li><li id="6740" class="ni nj it ll b lm nr lp ns mo nt ms nu mw nv me nn no np nq bi translated">因此，在<em class="lk"> n </em>次迭代之后，从网格中抽取至少一组最佳<em class="lk"> p </em> %参数的概率是 1-(1- <em class="lk"> p)ⁿ </em></li><li id="64ac" class="ni nj it ll b lm nr lp ns mo nt ms nu mw nv me nn no np nq bi translated">如果我们想要有 95%置信度的最好的 5%参数集，解上面的方程，1-(1–5%<em class="lk">)ⁿ=</em>95%，n ≈ <strong class="ll iu"> 59 </strong></li></ol><p id="d941" class="pw-post-body-paragraph li lj it ll b lm ln ju lo lp lq jx lr mo lt lu lv ms lx ly lz mw mb mc md me im bi translated">从这个证明中，我们还可以得出结论，推荐的迭代次数与网格大小无关。</p></div><div class="ab cl ky kz hx la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="im in io ip iq"><h2 id="573b" class="mf mg it bd mh mi mj dn mk ml mm dp mn mo mp mq mr ms mt mu mv mw mx my mz na bi translated">随机网格搜索的迭代次数清单</h2><p id="17a5" class="pw-post-body-paragraph li lj it ll b lm nd ju lo lp ne jx lr mo nf lu lv ms ng ly lz mw nh mc md me im bi translated">为了方便读者，请参考下表，了解不同置信度和性能阈值的推荐迭代次数</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/0d43075faab0101c09368a0377db5ea3.png" data-original-src="https://miro.medium.com/v2/resize:fit:472/format:webp/1*OHXh9WBdw91-SE9jN2xtVw.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Recommended number of iterations</figcaption></figure><p id="bf55" class="pw-post-body-paragraph li lj it ll b lm ln ju lo lp lq jx lr mo lt lu lv ms lx ly lz mw mb mc md me im bi translated">感谢阅读！</p></div></div>    
</body>
</html>