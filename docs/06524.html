<html>
<head>
<title>Scraping Continued: Download Images with Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">抓取继续:用 Python 下载图像</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/scraping-continued-download-images-with-python-6122623f3d82?source=collection_archive---------12-----------------------#2019-09-18">https://towardsdatascience.com/scraping-continued-download-images-with-python-6122623f3d82?source=collection_archive---------12-----------------------#2019-09-18</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="e0c1" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">大约一周前，我写了一篇关于网络抓取的文章。本文介绍了使用 Python 的<a class="ae ko" href="https://www.crummy.com/software/BeautifulSoup/bs4/doc/" rel="noopener ugc nofollow" target="_blank"> BeautifulSoup </a>库获取数据的一些基本概念，并进一步利用<a class="ae ko" href="https://pandas.pydata.org/" rel="noopener ugc nofollow" target="_blank"> Pandas </a>的能力将获取的数据存储到 DataFrame 对象中。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi kp"><img src="../Images/9a2d86b5f9fe6f84553526e317d7a16a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*D9GsqPNri9OuKUuP"/></div></div><figcaption class="lb lc gj gh gi ld le bd b be z dk">Photo by <a class="ae ko" href="https://unsplash.com/@max_duz?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Max Duzij</a> on <a class="ae ko" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="e11c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">浏览那篇文章是这篇文章的先决条件，<em class="lf">因为你还能如何获得数据？如果你已经熟悉网页抓取的概念，你就不必通读了，只需在底部抓取代码即可。总之，这里有一个链接:</em></p><div class="lg lh gp gr li lj"><a rel="noopener follow" target="_blank" href="/no-dataset-no-problem-scrape-one-yourself-57806dea3cac"><div class="lk ab fo"><div class="ll ab lm cl cj ln"><h2 class="bd iu gy z fp lo fr fs lp fu fw is bi translated">没有数据集？没问题。自己刮一个。</h2><div class="lq l"><h3 class="bd b gy z fp lo fr fs lp fu fw dk translated">使用 Python 和 BeautifulSoup 的强大功能来收集对您重要的数据。</h3></div><div class="lr l"><p class="bd b dl z fp lo fr fs lp fu fw dk translated">towardsdatascience.com</p></div></div><div class="ls l"><div class="lt l lu lv lw ls lx kz lj"/></div></div></a></div><p id="14d2" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果你是阅读这篇文章的人之一，你可能会想知道整个故事就是这样(<strong class="js iu"> <em class="lf">剧透警告:</em> </strong> <em class="lf">它不是</em>)。<br/>快速浏览一下获取的数据，你会看到雄伟的<strong class="js iu"> <em class="lf">缩略图</em> </strong>栏，如果你把它和这篇文章的标题联系起来，就不难得出这个故事还没有结束的结论。</p><p id="1dd2" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">今天的文章将处理从缩略图 URL 下载图像的过程。</p><p id="4262" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu"> <em class="lf">但是我为什么要下载图片呢？</em> </strong></p><p id="6814" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我很高兴你问了。也许你的数据科学项目需要通过<a class="ae ko" href="https://en.wikipedia.org/wiki/Convolutional_neural_network" rel="noopener ugc nofollow" target="_blank">卷积神经网络</a>进行图像分类。让我们想象下面的场景——你想开发一个算法，它能够根据一些缩略图的特征来预测图书的主题(流派)(<em class="lf">嗯，实际上是一个很好的项目想法！</em>)。</p><p id="0e8f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我绝不是 CNN 的专家，但我将向您展示如何根据流派将图像下载到各自的子目录中。事不宜迟，我们开始吧！</p></div><div class="ab cl ly lz hx ma" role="separator"><span class="mb bw bk mc md me"/><span class="mb bw bk mc md me"/><span class="mb bw bk mc md"/></div><div class="im in io ip iq"><h1 id="6d62" class="mf mg it bd mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc bi translated">一点点准备工作</h1><p id="3c35" class="pw-post-body-paragraph jq jr it js b jt nd jv jw jx ne jz ka kb nf kd ke kf ng kh ki kj nh kl km kn im bi translated">你真的认为没有这个你就能逃脱吗？</p><figure class="kq kr ks kt gt ku"><div class="bz fp l di"><div class="ni nj l"/></div></figure><p id="31bf" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">虽然，我会尽量把这部分说得简短一些。归结起来就是做一些库导入和导入以前抓取的数据。代码如下:</p><figure class="kq kr ks kt gt ku"><div class="bz fp l di"><div class="nk nj l"/></div><figcaption class="lb lc gj gh gi ld le bd b be z dk">Imports — <a class="ae ko" href="https://gist.github.com/dradecic/04cbe16e067ea66bf750eb8fdd1c4845" rel="noopener ugc nofollow" target="_blank">https://gist.github.com/dradecic/04cbe16e067ea66bf750eb8fdd1c4845</a></figcaption></figure><p id="1f53" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">简单回顾一下——下面是<strong class="js iu"> <em class="lf"> df </em> </strong>的样子:</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi nl"><img src="../Images/e8b9b7f626f518e9d20de1af037587d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*v2dL0ilILawJtcb57ED1bA.png"/></div></div><figcaption class="lb lc gj gh gi ld le bd b be z dk">Head of df</figcaption></figure><p id="f956" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">所有的准备工作现在都完成了——没那么糟糕，对吧？</p></div><div class="ab cl ly lz hx ma" role="separator"><span class="mb bw bk mc md me"/><span class="mb bw bk mc md me"/><span class="mb bw bk mc md"/></div><div class="im in io ip iq"><h1 id="b620" class="mf mg it bd mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc bi translated">下载图像</h1><p id="2b38" class="pw-post-body-paragraph jq jr it js b jt nd jv jw jx ne jz ka kb nf kd ke kf ng kh ki kj nh kl km kn im bi translated">你期待已久的部分来了。但是在给你代码之前，这里是应该发生的事情的概要:</p><ol class=""><li id="67e9" class="nm nn it js b jt ju jx jy kb no kf np kj nq kn nr ns nt nu bi translated">一个变量<strong class="js iu"> <em class="lf"> BASE_DIR </em> </strong>被声明，为图像存储根目录的名称</li><li id="e8e1" class="nm nn it js b jt nv jx nw kb nx kf ny kj nz kn nr ns nt nu bi translated">声明了一个变量<strong class="js iu"> <em class="lf"> SUB_DIRS </em> </strong>，它是一个数组，保存了数据集中所有不同的主题</li><li id="7780" class="nm nn it js b jt nv jx nw kb nx kf ny kj nz kn nr ns nt nu bi translated">将创建根目录以及所有子目录(如果它们不存在的话)</li><li id="ff84" class="nm nn it js b jt nv jx nw kb nx kf ny kj nz kn nr ns nt nu bi translated">基于不同的主题值过滤数据集</li><li id="5c17" class="nm nn it js b jt nv jx nw kb nx kf ny kj nz kn nr ns nt nu bi translated">使用<strong class="js iu"> <em class="lf"> urllib </em> </strong>下载缩略图</li><li id="af32" class="nm nn it js b jt nv jx nw kb nx kf ny kj nz kn nr ns nt nu bi translated">执行一些替换以使文件名格式正确</li></ol><p id="e877" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><em class="lf">呀呀</em>。听起来工作量很大。但它实际上不是——拜托，我们谈论的是 Python！</p><p id="6a9e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">下面是代码片段。我强烈建议您阅读每一行，甚至可以一行一行地执行，以便更好地理解为什么所有东西都是这样工作的。</p><figure class="kq kr ks kt gt ku"><div class="bz fp l di"><div class="nk nj l"/></div><figcaption class="lb lc gj gh gi ld le bd b be z dk">Image Downloader — <a class="ae ko" href="https://gist.github.com/dradecic/d26d44d7e145577a1ded06f28559499b" rel="noopener ugc nofollow" target="_blank">https://gist.github.com/dradecic/d26d44d7e145577a1ded06f28559499b</a></figcaption></figure><p id="9e60" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">运行此代码单元将创建以下目录结构:</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div class="gh gi oa"><img src="../Images/4869a213f23fb5664da45de86526520b.png" data-original-src="https://miro.medium.com/v2/resize:fit:484/format:webp/1*koxqxw_8V5rRec-yVx3n0g.png"/></div><figcaption class="lb lc gj gh gi ld le bd b be z dk">Directory Structure</figcaption></figure><p id="9ebe" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">此外，在每个子目录中，您会看到一堆图像:</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi ob"><img src="../Images/3464e187298de782d540c75bd87c4edc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*z81O2bmozmK8h5t7PaRuJQ.png"/></div></div><figcaption class="lb lc gj gh gi ld le bd b be z dk">Music Subdirectory</figcaption></figure></div><div class="ab cl ly lz hx ma" role="separator"><span class="mb bw bk mc md me"/><span class="mb bw bk mc md me"/><span class="mb bw bk mc md"/></div><div class="im in io ip iq"><h1 id="1778" class="mf mg it bd mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc bi translated">结论</h1><p id="b248" class="pw-post-body-paragraph jq jr it js b jt nd jv jw jx ne jz ka kb nf kd ke kf ng kh ki kj nh kl km kn im bi translated">这是一篇相当短的文章——但我更喜欢那些较长的文章。使您不想立即关闭浏览器窗口。</p><p id="3f50" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">像往常一样，在您选择的数据集上使用这项新获得的技能。看看有没有可能不下载图片而下载别的东西(<em class="lf">有可能</em>)。如果你对 CNN 和深度学习感兴趣，但在网上找不到相关的数据集，那就自己做一个。没有限制。</p><p id="1956" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">感谢阅读…</p></div><div class="ab cl ly lz hx ma" role="separator"><span class="mb bw bk mc md me"/><span class="mb bw bk mc md me"/><span class="mb bw bk mc md"/></div><div class="im in io ip iq"><p id="e569" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><em class="lf">喜欢这篇文章吗？成为</em> <a class="ae ko" href="https://medium.com/@radecicdario/membership" rel="noopener"> <em class="lf">中等会员</em> </a> <em class="lf">继续无限制学习。如果你使用下面的链接，我会收到你的一部分会员费，不需要你额外付费。</em></p><div class="lg lh gp gr li lj"><a href="https://medium.com/@radecicdario/membership" rel="noopener follow" target="_blank"><div class="lk ab fo"><div class="ll ab lm cl cj ln"><h2 class="bd iu gy z fp lo fr fs lp fu fw is bi translated">通过我的推荐链接加入 Medium-Dario rade ci</h2><div class="lq l"><h3 class="bd b gy z fp lo fr fs lp fu fw dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="lr l"><p class="bd b dl z fp lo fr fs lp fu fw dk translated">medium.com</p></div></div><div class="ls l"><div class="oc l lu lv lw ls lx kz lj"/></div></div></a></div></div></div>    
</body>
</html>