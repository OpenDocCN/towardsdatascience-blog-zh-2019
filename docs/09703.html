<html>
<head>
<title>What Form of Cross-Validation Should You Use?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">你应该使用什么形式的交叉验证？</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/what-form-of-cross-validation-should-you-use-76aaecc45c75?source=collection_archive---------9-----------------------#2019-12-20">https://towardsdatascience.com/what-form-of-cross-validation-should-you-use-76aaecc45c75?source=collection_archive---------9-----------------------#2019-12-20</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="7d45" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsdatascience.com/tagged/optimization-and-ml" rel="noopener" target="_blank">优化和机器学习</a></h2><div class=""/><div class=""><h2 id="4c20" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">优化样本外预测误差的正确代理</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/b8b4901eec0c43fe94f96900482e454c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QKAnanYIE8v7G_qP0TL49A.jpeg"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk">Photo by <a class="ae lh" href="https://unsplash.com/@joshcala?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Josh Calabrese</a> on <a class="ae lh" href="https://unsplash.com/s/photos/spin?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="1360" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi me translated"><span class="l mf mg mh bm mi mj mk ml mm di"> C </span>通过对整个数据集的样本外预测误差进行平均，我们希望交叉验证误差可以作为模型在未知测试数据上表现的代理。如果它作为一个准确的代理，那么我们可以使用交叉验证作为指导来调整模型，以便在一般情况下实现更好的性能。</p><p id="3e43" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><a class="ae lh" href="https://en.wikipedia.org/wiki/Cross-validation_(statistics)#k-fold_cross-validation" rel="noopener ugc nofollow" target="_blank"> K 重交叉验证</a>将数据集随机划分为 K 个不重叠的子集。模型被训练 k 次，每个子集依次被排除并用作样本外测试数据。对于较小的 k 值，k 倍的计算成本可能较低，但它具有不吸引人的特性，即它将随机性引入交叉验证结果。</p><p id="cd87" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><a class="ae lh" href="https://en.wikipedia.org/wiki/Cross-validation_(statistics)#Leave-one-out_cross-validation" rel="noopener ugc nofollow" target="_blank">留一交叉验证</a> (LOOCV)是一种 k 折形式，其中 k 等于数据集的大小。与常规 k-fold 相比，LOOCV 结果没有随机性，因为每个数据点总是被划分到自己的子集。虽然在一般情况下这可能很昂贵，需要模型适合数据集中的每个点，但对于某些模型，如<a class="ae lh" href="https://en.wikipedia.org/wiki/Tikhonov_regularization" rel="noopener ugc nofollow" target="_blank">岭回归</a>，LOOCV 可以有效地计算和优化，以找到最佳的模型参数。</p><p id="82df" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">如果可行，LOOCV 应优先于其他形式的 k 倍；但是它仍然有一些不理想的特性。让<strong class="lk jd"> X </strong>和<strong class="lk jd"> y </strong>代表数据集的 n×p 特征矩阵和目标值。如果<strong class="lk jd"> Q </strong>是一个 n×n<a class="ae lh" href="https://en.wikipedia.org/wiki/Orthogonal_matrix" rel="noopener ugc nofollow" target="_blank">正交矩阵</a>，则放</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi mn"><img src="../Images/e38ead0af9859eee3aa1c622778c4ec1.png" data-original-src="https://miro.medium.com/v2/resize:fit:428/format:webp/1*FpfELyBIBW07CsAIi3QeaQ@2x.png"/></div></figure><p id="2823" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">假设我们用岭回归模型来拟合数据集。如果<strong class="lk jd"> b </strong>代表模型的回归变量，那么<strong class="lk jd"> b </strong>在旋转回归问题上的误差与在原始问题上的误差相同</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi mo"><img src="../Images/b63907faec3ea5a72329063ef6f98318.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HINUdVKde95AcpoBpuvc0w@2x.png"/></div></div></figure><p id="5b38" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">因此，回归问题<strong class="lk jd">X’，y’</strong>和<strong class="lk jd"> X，y </strong>之间是等价的，然而 LOOCV 对于旋转不是不变的。</p><p id="368f" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">此外，当一个特征的方差只集中在几个数据点时，LOOCV 的表现尤其差。在最极端的情况下，假设</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi mp"><img src="../Images/7059b3a706d1f6bc4c821422a4386b5d.png" data-original-src="https://miro.medium.com/v2/resize:fit:912/format:webp/1*5iE_pBMBtf4vdMhoEeyObw@2x.png"/></div></figure><p id="6e7e" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">当排除第 I 个数据向量(i ≤ p)时，剩余数据集中没有方差来拟合第 I 个回归系数，因此 LOOCV 为</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi mq"><img src="../Images/ffbfd65b693d4124aba40cf514c18599.png" data-original-src="https://miro.medium.com/v2/resize:fit:408/format:webp/1*WyAYXbgYEUdrDb-fRzkVLQ@2x.png"/></div></div></figure><p id="f50f" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">并且独立于正则化矩阵。</p><h2 id="4e6c" class="mr ms it bd mt mu mv dn mw mx my dp mz lr na nb nc lv nd ne nf lz ng nh ni iz bi translated">广义交叉验证</h2><p id="6725" class="pw-post-body-paragraph li lj it lk b ll nj kd ln lo nk kg lq lr nl lt lu lv nm lx ly lz nn mb mc md im bi translated">广义交叉验证(GCV)背后的思想是修改 100c v，以便它是在原始回归问题的旋转上计算的，其中旋转矩阵是以非常特殊的方式选择的，以便 1) GCV 对于原始回归问题的旋转是不变的，以及 2)特征向量的方差在变换矩阵<strong class="lk jd">x’</strong>⁴.上均匀地“展开”</p><p id="ac2b" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">设<strong class="lk jd"> U </strong>、<strong class="lk jd"> S </strong>、<strong class="lk jd"> V </strong>代表<strong class="lk jd"> X </strong>的<a class="ae lh" href="https://en.wikipedia.org/wiki/Singular_value_decomposition" rel="noopener ugc nofollow" target="_blank">奇异值分解</a></p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi no"><img src="../Images/36ad93df4b71e23b348ed1ce4347b0d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:528/format:webp/1*LR-RVsCtFR9_XDOrhUwLiQ@2x.png"/></div></figure><p id="f62b" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">其中<strong class="lk jd"> S </strong>为矩形对角矩阵<strong class="lk jd"> U </strong>和<strong class="lk jd"> V </strong>为正交矩阵。让<strong class="lk jd"> W </strong>代表一个<a class="ae lh" href="https://en.wikipedia.org/wiki/Unitary_matrix" rel="noopener ugc nofollow" target="_blank">酉矩阵</a> (GCV 使用复数旋转)。放</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi np"><img src="../Images/0bc69b453fc8e62d7b12b86ee3a28a36.png" data-original-src="https://miro.medium.com/v2/resize:fit:468/format:webp/1*izrc1kx93kiJeC7AmKVHWw@2x.png"/></div></figure><p id="cc15" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">设<strong class="lk jd">X′</strong>，<strong class="lk jd">y′</strong>表示这个矩阵的旋转回归问题。然后</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nq"><img src="../Images/c04b49d014a1ff17723acfcf5a43c5bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*76mQ3YpWSLAMbywsL5FQGg@2x.png"/></div></div></figure><p id="b2ba" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">现在，准备</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/9216df029e47a0a452e1687368cd28c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:752/format:webp/1*SrG5i1adLD_1LNsQwVg_PQ@2x.png"/></div></figure><p id="f60c" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><strong class="lk jd"> W </strong>的列是 n×n<a class="ae lh" href="https://en.wikipedia.org/wiki/Circulant_matrix" rel="noopener ugc nofollow" target="_blank">个循环矩阵</a>的公共特征向量，因此对于任意对角矩阵<strong class="lk jd"> D </strong></p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/387a54560b3cce1fc6d9c4d5e886f10a.png" data-original-src="https://miro.medium.com/v2/resize:fit:396/format:webp/1*-SWPZPjK4dSNSqm2VJwgEA@2x.png"/></div></figure><p id="9162" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">是一个循环矩阵，其形式为</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/99d60bd9b8196d7a3a79c71ea141c5db.png" data-original-src="https://miro.medium.com/v2/resize:fit:1164/format:webp/1*MMYtP4r7YHU6KOSAkZSDLw@2x.png"/></div></figure><p id="1025" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">因此，</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/dfaf693e70afa356fcaa1c66063a0428.png" data-original-src="https://miro.medium.com/v2/resize:fit:308/format:webp/1*8WCrulTK2CMfxllcs6eomA@2x.png"/></div></figure><p id="b91b" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">是对角线上有常数的循环矩阵。另外，对于<strong class="lk jd">x′</strong>的任意一行，它与<strong class="lk jd">x′</strong>的其他行的协方差由相同的移位 vector⁵.表示</p><h2 id="7010" class="mr ms it bd mt mu mv dn mw mx my dp mz lr na nb nc lv nd ne nf lz ng nh ni iz bi translated">计算 GCV</h2><p id="e330" class="pw-post-body-paragraph li lj it lk b ll nj kd ln lo nk kg lq lr nl lt lu lv nm lx ly lz nn mb mc md im bi translated">设<strong class="lk jd">γ</strong>表示岭回归的正则化矩阵。那么回归问题<strong class="lk jd"> X </strong>，<strong class="lk jd"> y </strong>的 LOOCV 可以用 equation⁶有效地计算</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/93eb69c281db31c9f51edbdb1d234abc.png" data-original-src="https://miro.medium.com/v2/resize:fit:636/format:webp/1*LNIa5iDytpyAl9ncwb-YTQ@2x.png"/></div></figure><p id="e622" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在哪里</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/8b4a27fd338ca39345596a297dcf008a.png" data-original-src="https://miro.medium.com/v2/resize:fit:772/format:webp/1*J4lhls9U2QLPTJz7tjAlUw@2x.png"/></div></figure><p id="2076" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">相同的等式可以用于旋转回归问题<strong class="lk jd">X’，y’</strong>来计算 GCV，只是我们需要考虑到<strong class="lk jd">X’，y’</strong>是复数值的事实。那么，GCV 方程就变成了</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nx"><img src="../Images/09025a659aefebe8d07825e06376d034.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RjeMy_edsBp0rbefyKoXpA@2x.png"/></div></div></figure><p id="03c6" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在哪里</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ny"><img src="../Images/9f89f1430f805ff7631791d23a3ad35f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9rXQwoDzsc_RrOyiJqc40Q@2x.png"/></div></div></figure><p id="8ad4" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">(注意:<strong class="lk jd"> A </strong>和<strong class="lk jd"> b̂ </strong>对于旋转是不变的，因此它们保持不变)</p><p id="d8cf" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我们还可以对 LOOCV 的导数方程进行同样的修改，以计算 GCV 导数，这使得应用优化器来最小化关于<strong class="lk jd">γ</strong>的 GCV 成为可能。</p><h2 id="e48f" class="mr ms it bd mt mu mv dn mw mx my dp mz lr na nb nc lv nd ne nf lz ng nh ni iz bi translated">一个特例</h2><p id="151f" class="pw-post-body-paragraph li lj it lk b ll nj kd ln lo nk kg lq lr nl lt lu lv nm lx ly lz nn mb mc md im bi translated">假设我们用单个变量来参数化我们的正则化矩阵<strong class="lk jd">γ</strong></p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/2e7a1d80b9a762873112f0cd48b08e63.png" data-original-src="https://miro.medium.com/v2/resize:fit:308/format:webp/1*U4S_S0EupjJj3RpBWVV47Q@2x.png"/></div></figure><p id="c414" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">那么<strong class="lk jd">h′</strong>就是的对角线</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi nz"><img src="../Images/5bb3b4167b7e53c57c723cbdf9aa3dbb.png" data-original-src="https://miro.medium.com/v2/resize:fit:496/format:webp/1*gYu7WGuuR-xw3_kpLnPMdQ@2x.png"/></div></figure><p id="cccf" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">和</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi oa"><img src="../Images/0ed04f6686657563a47ea3ff403c8353.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*x-osnR4VnVdMSwZ1Ier2OQ@2x.png"/></div></div></figure><p id="6ee9" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">现在，因为</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/bafaf3a85805d9d4bef1d5499073944f.png" data-original-src="https://miro.medium.com/v2/resize:fit:924/format:webp/1*5yhiGw6KCCfcl-od50sEGQ@2x.png"/></div></figure><p id="e858" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">是一个对角矩阵，由此可见</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi nz"><img src="../Images/5bb3b4167b7e53c57c723cbdf9aa3dbb.png" data-original-src="https://miro.medium.com/v2/resize:fit:496/format:webp/1*gYu7WGuuR-xw3_kpLnPMdQ@2x.png"/></div></figure><p id="4e92" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">是循环矩阵。因此，<strong class="lk jd">h′</strong>是一个常数值向量，等于</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/fee3ccbbe4450a07613cc578a370572d.png" data-original-src="https://miro.medium.com/v2/resize:fit:760/format:webp/1*Kzz39jq15o2Ct0mErmfe4w@2x.png"/></div></figure><p id="a5b8" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">或者，由于轨迹对于旋转是不变的，</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi od"><img src="../Images/1d3b4e5a943bae7b7daab09d066dac55.png" data-original-src="https://miro.medium.com/v2/resize:fit:696/format:webp/1*x7wIja_fc1iOkSQd2bB1Pw@2x.png"/></div></figure><p id="09be" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">将其代入 LOOCV 方程，并利用旋转回归问题具有相同误差平方和的特性，单变量正则化的 GCV 为</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi oe"><img src="../Images/bebb717b7347fb12fb08593a741cbc4f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1052/format:webp/1*oMzDY4axohqdZ6v7qlyGJA@2x.png"/></div></figure><p id="ba93" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">这是 GCV 最常见的表现形式。但是注意:对于由多个变量参数化的<strong class="lk jd">γ</strong>的一般情况，这个简化的方程不会计算出正确的 value⁷.</p><h2 id="188d" class="mr ms it bd mt mu mv dn mw mx my dp mz lr na nb nc lv nd ne nf lz ng nh ni iz bi translated">现实世界的问题</h2><p id="23ac" class="pw-post-body-paragraph li lj it lk b ll nj kd ln lo nk kg lq lr nl lt lu lv nm lx ly lz nn mb mc md im bi translated">我们将在一个示例问题上比较设置正则化参数的不同方法的性能。数据取自 1974 年美国杂志《汽车趋势》,任务是从其他给定的属性预测车辆的燃油效率。我们将在数据的留一交叉验证中比较以下模型:</p><ul class=""><li id="e1c6" class="of og it lk b ll lm lo lp lr oh lv oi lz oj md ok ol om on bi translated"><strong class="lk jd">最小二乘回归</strong></li><li id="dfa7" class="of og it lk b ll oo lo op lr oq lv or lz os md ok ol om on bi translated"><strong class="lk jd"> RR-LOOCV-1: </strong>通过二阶优化器设置单个正则化参数的岭回归，以最小化训练数据上的 LOOCV 误差。</li><li id="207f" class="of og it lk b ll oo lo op lr oq lv or lz os md ok ol om on bi translated"><strong class="lk jd"> RR-LOOCV-p: </strong>与 RR-LOOCV-1 相同，但对于每个<a class="ae lh" href="https://en.wikipedia.org/wiki/Principal_component_analysis" rel="noopener ugc nofollow" target="_blank">主分量</a>具有单独的正则化参数。</li><li id="5d0f" class="of og it lk b ll oo lo op lr oq lv or lz os md ok ol om on bi translated"><strong class="lk jd"> RR-GCV-1: </strong>通过二阶优化器设置单个正则化参数的岭回归，以最小化训练数据上的 GCV 误差。</li><li id="6bda" class="of og it lk b ll oo lo op lr oq lv or lz os md ok ol om on bi translated"><strong class="lk jd"> RR-GCV-p: </strong>与 RR-GCV-1 相同，但对每个主成分使用单独的正则化参数。</li></ul><p id="d5a5" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">注意:在这个实验中有两个水平的交叉验证。在最高层，我们为每个数据点形成一对训练数据和测试数据来训练模型；在较低层次，岭回归模型对训练数据执行另一个交叉验证，以设置它们的正则化参数。</p><p id="3b10" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">下表显示了从 best 到 worse⁸.订购的每个型号的 LOOCV 的均方根误差(RMSE)</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/308ad61311ef9a2be86a4ba8a09cc3f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1164/format:webp/1*_EeCaeAyQFFdB7AE9RfrVA@2x.png"/></div></figure><h2 id="2849" class="mr ms it bd mt mu mv dn mw mx my dp mz lr na nb nc lv nd ne nf lz ng nh ni iz bi translated">结论</h2><p id="230e" class="pw-post-body-paragraph li lj it lk b ll nj kd ln lo nk kg lq lr nl lt lu lv nm lx ly lz nn mb mc md im bi translated">岭回归是机器学习中最常用的模型之一。通过正确的正则化矩阵，它经常优于最小二乘法。使用优化器，我们可以设置正则化参数来最大化某些形式的交叉验证的性能；但是为了获得良好的样本外性能，我们需要使用交叉验证作为样本外预测误差的准确代理。我们看到了 LOOCV 在某些情况下会有问题，并且有一个不受欢迎的特性，就是它对旋转很敏感。我们引入 GCV 作为旋转不变的替代方案，并通过展开特征矩阵的方差来处理 LOOCV 的问题情况。我们比较了不同岭回归模型在一个示例问题上的表现，发现 GCV 给出了最好的结果。</p><p id="daa6" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><em class="ot">要找到优化留一交叉验证或广义交叉验证的正则化参数，请查看</em><a class="ae lh" href="https://buildingblock.ai" rel="noopener ugc nofollow" target="_blank"><em class="ot">building block . ai</em></a><em class="ot">。</em></p></div><div class="ab cl ou ov hx ow" role="separator"><span class="ox bw bk oy oz pa"/><span class="ox bw bk oy oz pa"/><span class="ox bw bk oy oz"/></div><div class="im in io ip iq"><p id="e959" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">脚注</p><p id="5bcc" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">[1]:参见<a class="ae lh" rel="noopener" target="_blank" href="/how-to-do-ridge-regression-better-34ecb6ee3b12">如何更好地进行岭回归</a>，了解如何将优化器与 LOOCV 一起使用以找到正则化参数的详细信息。</p><p id="ebc6" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">[2]:请参见<a class="ae lh" href="https://github.com/rnburn/ridge-regression-doc/blob/master/notebooks/loocv-rotations.ipynb" rel="noopener ugc nofollow" target="_blank">https://github . com/rn burn/ridge-regression-doc/blob/master/notebooks/loo cv-rotations . ipynb</a>了解 loocv 如何对旋转敏感的示例。</p><p id="e171" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">[3]:GCV 作为 LOOCV 在旋转回归问题上的问题案例和表述摘自</p><blockquote class="pb pc pd"><p id="5ff0" class="li lj ot lk b ll lm kd ln lo lp kg lq pe ls lt lu pf lw lx ly pg ma mb mc md im bi translated">Golub G .、Heath M .和 Wahba G .，<a class="ae lh" href="http://pages.stat.wisc.edu/~wahba/stat860public/pdf1/golub.heath.wahba.pdf" rel="noopener ugc nofollow" target="_blank">广义交叉验证作为选择良好岭参数的方法</a> (1979 年)，《技术计量学》，第 21 卷，第 2 期</p></blockquote><p id="c4fb" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">[4]:为了使“分散方差”的概念更精确，让<strong class="lk jd"> K </strong>表示数据向量的协方差矩阵</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi ph"><img src="../Images/c8b4a5525554dcf808325b9509a21f01.png" data-original-src="https://miro.medium.com/v2/resize:fit:548/format:webp/1*gFxPNlc4MCaziWTdd-tifw@2x.png"/></div></figure><p id="5d72" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">其中我们假设<strong class="lk jd"> X </strong>的列居中，p 是特征向量的长度。注意到<strong class="lk jd"> K </strong>的<a class="ae lh" href="https://en.wikipedia.org/wiki/Matrix_norm#Frobenius_norm" rel="noopener ugc nofollow" target="_blank"> Frobenius 范数</a>对于<strong class="lk jd"> X </strong>的旋转是不变的；<strong class="lk jd"> </strong>并且在 GCV 旋转之后，协方差矩阵<strong class="lk jd">K′</strong>是循环的，因此每一列对 Frobenius 范数的贡献相等。</p><p id="9638" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">[5]:<a class="ae lh" href="https://github.com/rnburn/ridge-regression-doc/blob/master/notebooks/gcv-rotation.ipynb" rel="noopener ugc nofollow" target="_blank">https://github . com/rn burn/ridge-regression-doc/blob/master/notebooks/gcv-rotation . ipynb</a>验证 GCV 旋转矩阵是否循环</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/dfaf693e70afa356fcaa1c66063a0428.png" data-original-src="https://miro.medium.com/v2/resize:fit:308/format:webp/1*8WCrulTK2CMfxllcs6eomA@2x.png"/></div></figure><p id="4119" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">[6]:参见<a class="ae lh" rel="noopener" target="_blank" href="/how-to-do-ridge-regression-better-34ecb6ee3b12">如何更好地做岭回归</a>高效 LOOCV 方程的推导</p><p id="74ba" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">[7]:参见<a class="ae lh" href="https://github.com/rnburn/ridge-regression-doc/blob/master/notebooks/gcv-formulas.ipynb" rel="noopener ugc nofollow" target="_blank">https://github . com/rn burn/ridge-regression-doc/blob/master/notebooks/gcv-formulas . ipynb</a>单变量 GCV 方程的验证</p><p id="d1f8" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">[8]:完整实验可在<a class="ae lh" href="https://github.com/rnburn/ridge-regression-doc/blob/master/notebooks/motor-trends-regression.ipynb" rel="noopener ugc nofollow" target="_blank">https://github . com/rn burn/ridge-regression-doc/blob/master/notebooks/motor-trends-regression . ipynb</a>获得</p></div></div>    
</body>
</html>