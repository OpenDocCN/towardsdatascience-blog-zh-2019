<html>
<head>
<title>Data manipulation in R</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">R 中的数据操作</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/data-manipulation-in-r-5540ed13ac5f?source=collection_archive---------21-----------------------#2019-12-24">https://towardsdatascience.com/data-manipulation-in-r-5540ed13ac5f?source=collection_archive---------21-----------------------#2019-12-24</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="5a5c" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">查看 R 中操作数据的主要函数，例如如何对数据框进行子集化、创建新变量、记录分类变量和重命名变量</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/b59132beb3081da2100943b3cbbdad2b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*voEJp2o-Z2k4-uUd"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Photo by <a class="ae ky" href="https://unsplash.com/@campaign_creators?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Campaign Creators</a></figcaption></figure><h1 id="b16c" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">介绍</h1><p id="eb7f" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">并非所有数据框都像您预期的那样整洁。因此，在<a class="ae ky" href="https://statsandr.com/blog/how-to-import-an-excel-file-in-rstudio/" rel="noopener ugc nofollow" target="_blank">将数据集导入 RStudio </a>后，大多数情况下，您需要在执行任何统计分析之前准备好数据集。当数据质量很差时，数据处理有时甚至会比实际分析花费更长的时间。</p><p id="3bb7" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">数据操作包括广泛的工具和技术。我们在这里详细介绍了您在 r 中的项目最有可能需要的操作。如果您发现其他数据操作很重要，以便我可以添加它们，请不要犹豫让我知道(例如作为本文结尾的评论)。</p><p id="ba5c" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在本文中，我们展示了在 r 中操作数据的主要函数。我们首先在向量、<a class="ae ky" href="https://statsandr.com/blog/data-types-in-r/#factor" rel="noopener ugc nofollow" target="_blank">因子</a>和列表上说明这些函数。然后我们举例说明在 r 中操作数据帧和日期/时间的主要函数。</p><h1 id="9774" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">向量</h1><h1 id="a6c3" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">串联</h1><p id="d56e" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">我们可以用<code class="fe ms mt mu mv b">c()</code>连接(即组合)数字或字符串:</p><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="556b" class="na la it mv b gy nb nc l nd ne">c(2, 4, -1)</span><span id="3bf8" class="na la it mv b gy nf nc l nd ne">## [1]  2  4 -1</span><span id="9e48" class="na la it mv b gy nf nc l nd ne">c(1, 5 / 6, 2^3, -0.05)</span><span id="3cd4" class="na la it mv b gy nf nc l nd ne">## [1]  1.0000000  0.8333333  8.0000000 -0.0500000</span></pre><p id="e50f" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">请注意，默认情况下，R 显示 7 位小数。可以用<code class="fe ms mt mu mv b">options(digits = 2)</code>(两位小数)修改。</p><p id="568f" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">也可以创建一系列连续的<a class="ae ky" href="https://statsandr.com/blog/data-types-in-r/#integer" rel="noopener ugc nofollow" target="_blank">整数</a>:</p><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="23ed" class="na la it mv b gy nb nc l nd ne">1:10</span><span id="0927" class="na la it mv b gy nf nc l nd ne">##  [1]  1  2  3  4  5  6  7  8  9 10</span><span id="613c" class="na la it mv b gy nf nc l nd ne"># is the same than<br/>c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10)</span><span id="8cfe" class="na la it mv b gy nf nc l nd ne">##  [1]  1  2  3  4  5  6  7  8  9 10</span><span id="72e6" class="na la it mv b gy nf nc l nd ne"># or<br/>c(1:10)</span><span id="946f" class="na la it mv b gy nf nc l nd ne">##  [1]  1  2  3  4  5  6  7  8  9 10</span></pre><h1 id="20dc" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated"><code class="fe ms mt mu mv b">seq()</code>和<code class="fe ms mt mu mv b">rep()</code></h1><p id="a196" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated"><code class="fe ms mt mu mv b">seq()</code>允许制作一个由序列定义的向量。您可以选择增量:</p><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="60e2" class="na la it mv b gy nb nc l nd ne">seq(from = 2, to = 5, by = 0.5)</span><span id="f4fc" class="na la it mv b gy nf nc l nd ne">## [1] 2.0 2.5 3.0 3.5 4.0 4.5 5.0</span></pre><p id="a4a2" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">或者它的长度:</p><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="ec67" class="na la it mv b gy nb nc l nd ne">seq(from = 2, to = 5, length.out = 7)</span><span id="ab75" class="na la it mv b gy nf nc l nd ne">## [1] 2.0 2.5 3.0 3.5 4.0 4.5 5.0</span></pre><p id="4f4a" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">另一方面，<code class="fe ms mt mu mv b">rep()</code>创建一个向量，它是数字或字符串的重复:</p><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="a832" class="na la it mv b gy nb nc l nd ne">rep(1, times = 3)</span><span id="b8cb" class="na la it mv b gy nf nc l nd ne">## [1] 1 1 1</span><span id="58e7" class="na la it mv b gy nf nc l nd ne">rep(c("A", "B", "C"), times = c(3, 1, 2))</span><span id="c0d8" class="na la it mv b gy nf nc l nd ne">## [1] "A" "A" "A" "B" "C" "C"</span></pre><p id="c6e6" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">您也可以创建一个数字和字符串重复的向量:</p><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="c4a1" class="na la it mv b gy nb nc l nd ne">rep(c("A", 2, "C"), times = c(3, 1, 2))</span><span id="5105" class="na la it mv b gy nf nc l nd ne">## [1] "A" "A" "A" "2" "C" "C"</span></pre><p id="6358" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">但是在这种情况下，数字 2 也将被视为一个字符串(而不是一个<a class="ae ky" href="https://statsandr.com/blog/data-types-in-r/#numeric" rel="noopener ugc nofollow" target="_blank">数字</a>),因为向量中至少有一个字符串。</p><h1 id="9039" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">分配</h1><p id="bb5c" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">在 R 中有三种分配对象的方法:</p><ol class=""><li id="90f3" class="ng nh it lt b lu mn lx mo ma ni me nj mi nk mm nl nm nn no bi translated"><code class="fe ms mt mu mv b">&lt;-</code></li><li id="3515" class="ng nh it lt b lu np lx nq ma nr me ns mi nt mm nl nm nn no bi translated"><code class="fe ms mt mu mv b">=</code></li><li id="ee9b" class="ng nh it lt b lu np lx nq ma nr me ns mi nt mm nl nm nn no bi translated"><code class="fe ms mt mu mv b">assign()</code></li></ol><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="ca64" class="na la it mv b gy nb nc l nd ne"># 1st method<br/>x &lt;- c(2.1, 5, -4, 1, 5)<br/>x</span><span id="22f4" class="na la it mv b gy nf nc l nd ne">## [1]  2.1  5.0 -4.0  1.0  5.0</span><span id="a185" class="na la it mv b gy nf nc l nd ne"># 2nd method<br/>x2 &lt;- c(2.1, 5, -4, 1, 5)<br/>x2</span><span id="9c13" class="na la it mv b gy nf nc l nd ne">## [1]  2.1  5.0 -4.0  1.0  5.0</span><span id="da6f" class="na la it mv b gy nf nc l nd ne"># 3rd method (less common)<br/>assign("x3", c(2.1, 5, -4, 1, 5))<br/>x3</span><span id="f8d9" class="na la it mv b gy nf nc l nd ne">## [1]  2.1  5.0 -4.0  1.0  5.0</span></pre><p id="e537" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">也可以将一个向量指定给另一个向量，例如:</p><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="229d" class="na la it mv b gy nb nc l nd ne">y &lt;- c(x, 10, 1 / 4)<br/>y</span><span id="3e79" class="na la it mv b gy nf nc l nd ne">## [1]  2.10  5.00 -4.00  1.00  5.00 10.00  0.25</span></pre><h1 id="ef14" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">向量的元素</h1><p id="cbbe" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">我们可以通过在方括号中指定向量的位置来选择向量的一个或多个元素:</p><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="86c4" class="na la it mv b gy nb nc l nd ne"># select one element<br/>x[3]</span><span id="3aa4" class="na la it mv b gy nf nc l nd ne">## [1] -4</span><span id="ecab" class="na la it mv b gy nf nc l nd ne"># select more than one element with c()<br/>x[c(1, 3, 4)]</span><span id="d3b1" class="na la it mv b gy nf nc l nd ne">## [1]  2.1 -4.0  1.0</span></pre><p id="4de4" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">注意，在 R 中，索引的编号从 1 开始(不像其他编程语言那样从 0 开始)，所以<code class="fe ms mt mu mv b">x[1]</code>给出了向量<code class="fe ms mt mu mv b">x</code>的第一个元素。</p><p id="9138" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我们也可以使用<a class="ae ky" href="https://statsandr.com/blog/data-types-in-r/#logical" rel="noopener ugc nofollow" target="_blank">布尔值</a>(即<code class="fe ms mt mu mv b">TRUE</code>或<code class="fe ms mt mu mv b">FALSE</code>)来选择向量的一些元素。该方法仅选择与<code class="fe ms mt mu mv b">TRUE</code>相对应的元素:</p><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="5aca" class="na la it mv b gy nb nc l nd ne">x[c(TRUE, FALSE, TRUE, TRUE, FALSE)]</span><span id="3e49" class="na la it mv b gy nf nc l nd ne">## [1]  2.1 -4.0  1.0</span></pre><p id="2752" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">或者我们可以把元素撤回来:</p><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="93ba" class="na la it mv b gy nb nc l nd ne">x[-c(2, 4)]</span><span id="5285" class="na la it mv b gy nf nc l nd ne">## [1]  2.1 -4.0  5.0</span></pre><h1 id="91b4" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">类型和长度</h1><p id="b496" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">向量的主要类型有<a class="ae ky" href="https://statsandr.com/blog/data-types-in-r/#numeric" rel="noopener ugc nofollow" target="_blank">数字</a>、<a class="ae ky" href="https://statsandr.com/blog/data-types-in-r/#logical" rel="noopener ugc nofollow" target="_blank">逻辑</a>和<a class="ae ky" href="https://statsandr.com/blog/data-types-in-r/#character" rel="noopener ugc nofollow" target="_blank">字符</a>。关于每种类型的更多细节，参见 R 中不同的<a class="ae ky" href="https://statsandr.com/blog/data-types-in-r/" rel="noopener ugc nofollow" target="_blank">数据类型。</a></p><p id="c461" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><code class="fe ms mt mu mv b">class()</code>给出矢量类型:</p><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="2553" class="na la it mv b gy nb nc l nd ne">x &lt;- c(2.1, 5, -4, 1, 5, 0)<br/>class(x)</span><span id="24ad" class="na la it mv b gy nf nc l nd ne">## [1] "numeric"</span><span id="1508" class="na la it mv b gy nf nc l nd ne">y &lt;- c(x, "Hello")<br/>class(y)</span><span id="9afe" class="na la it mv b gy nf nc l nd ne">## [1] "character"</span></pre><p id="28e1" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">正如您在上面看到的，只有当 vector 的所有元素都是数字时，它的类才会是数字。只要一个元素是一个字符，向量的类就是一个字符。</p><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="2da2" class="na la it mv b gy nb nc l nd ne">z &lt;- c(TRUE, FALSE, FALSE)<br/>class(z)</span><span id="79df" class="na la it mv b gy nf nc l nd ne">## [1] "logical"</span></pre><p id="e904" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><code class="fe ms mt mu mv b">length()</code>给出一个向量的长度:</p><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="1b87" class="na la it mv b gy nb nc l nd ne">length(x)</span><span id="13b3" class="na la it mv b gy nf nc l nd ne">## [1] 6</span></pre><p id="d4b5" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">所以要选择一个向量的最后一个元素(以动态的方式)，我们可以使用<code class="fe ms mt mu mv b">length()</code>和<code class="fe ms mt mu mv b">[]</code>的组合:</p><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="90a4" class="na la it mv b gy nb nc l nd ne">x[length(x)]</span><span id="9d91" class="na la it mv b gy nf nc l nd ne">## [1] 0</span></pre><h1 id="bcdd" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">寻找向量类型</h1><p id="0665" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">我们可以用<code class="fe ms mt mu mv b">is.type</code>函数族找到向量的类型:</p><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="a742" class="na la it mv b gy nb nc l nd ne">is.numeric(x)</span><span id="55ef" class="na la it mv b gy nf nc l nd ne">## [1] TRUE</span><span id="1707" class="na la it mv b gy nf nc l nd ne">is.logical(x)</span><span id="33a1" class="na la it mv b gy nf nc l nd ne">## [1] FALSE</span><span id="71ac" class="na la it mv b gy nf nc l nd ne">is.character(x)</span><span id="a668" class="na la it mv b gy nf nc l nd ne">## [1] FALSE</span></pre><p id="46fa" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">或者用更通用的方式使用<code class="fe ms mt mu mv b">is()</code>功能:</p><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="970e" class="na la it mv b gy nb nc l nd ne">is(x)</span><span id="bad6" class="na la it mv b gy nf nc l nd ne">## [1] "numeric" "vector"</span></pre><h1 id="a78c" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">类型和长度的修改</h1><p id="fefa" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">我们可以用<code class="fe ms mt mu mv b">as.numeric()</code>、<code class="fe ms mt mu mv b">as.logical()</code>和<code class="fe ms mt mu mv b">as.character()</code>功能改变矢量的类型:</p><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="c70b" class="na la it mv b gy nb nc l nd ne">x_character &lt;- as.character(x)<br/>x_character</span><span id="3f84" class="na la it mv b gy nf nc l nd ne">## [1] "2.1" "5"   "-4"  "1"   "5"   "0"</span><span id="1c80" class="na la it mv b gy nf nc l nd ne">is.character(x_character)</span><span id="bdc6" class="na la it mv b gy nf nc l nd ne">## [1] TRUE</span><span id="b97b" class="na la it mv b gy nf nc l nd ne">x_logical &lt;- as.logical(x)<br/>x_logical</span><span id="92ca" class="na la it mv b gy nf nc l nd ne">## [1]  TRUE  TRUE  TRUE  TRUE  TRUE FALSE</span><span id="1e6b" class="na la it mv b gy nf nc l nd ne">is.logical(x_logical)</span><span id="669c" class="na la it mv b gy nf nc l nd ne">## [1] TRUE</span></pre><p id="ae73" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">也可以改变它的长度:</p><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="c805" class="na la it mv b gy nb nc l nd ne">length(x) &lt;- 4<br/>x</span><span id="d877" class="na la it mv b gy nf nc l nd ne">## [1]  2.1  5.0 -4.0  1.0</span></pre><p id="fdcf" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">如你所见，向量的第一个元素是守恒的，而所有其他元素都被移除了。在本例中，第一个 4 是因为我们指定了长度 4。</p><h1 id="91df" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">数值运算符</h1><p id="0183" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">基本数值运算符如<code class="fe ms mt mu mv b">+</code>、<code class="fe ms mt mu mv b">-</code>、<code class="fe ms mt mu mv b">*</code>、<code class="fe ms mt mu mv b">/</code>和<code class="fe ms mt mu mv b">^</code>可以应用于向量:</p><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="e4c2" class="na la it mv b gy nb nc l nd ne">x &lt;- c(2.1, 5, -4, 1)<br/>y &lt;- c(0, -7, 1, 1 / 4)</span><span id="8404" class="na la it mv b gy nf nc l nd ne">x + y</span><span id="d380" class="na la it mv b gy nf nc l nd ne">## [1]  2.10 -2.00 -3.00  1.25</span><span id="676a" class="na la it mv b gy nf nc l nd ne">x * y</span><span id="ac62" class="na la it mv b gy nf nc l nd ne">## [1]   0.00 -35.00  -4.00   0.25</span><span id="c863" class="na la it mv b gy nf nc l nd ne">x^y</span><span id="bbc3" class="na la it mv b gy nf nc l nd ne">## [1]  1.00e+00  1.28e-05 -4.00e+00  1.00e+00</span></pre><p id="032d" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">也可以计算矢量的最小<a class="ae ky" href="https://statsandr.com/blog/descriptive-statistics-in-r/#minimum-and-maximum" rel="noopener ugc nofollow" target="_blank">、最大</a>、和、积、累积和以及累积积:</p><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="efd4" class="na la it mv b gy nb nc l nd ne">min(x)</span><span id="c631" class="na la it mv b gy nf nc l nd ne">## [1] -4</span><span id="46df" class="na la it mv b gy nf nc l nd ne">max(x)</span><span id="92c9" class="na la it mv b gy nf nc l nd ne">## [1] 5</span><span id="2ed2" class="na la it mv b gy nf nc l nd ne">sum(x)</span><span id="eacc" class="na la it mv b gy nf nc l nd ne">## [1] 4.1</span><span id="de65" class="na la it mv b gy nf nc l nd ne">prod(x)</span><span id="dab0" class="na la it mv b gy nf nc l nd ne">## [1] -42</span><span id="3479" class="na la it mv b gy nf nc l nd ne">cumsum(x)</span><span id="c018" class="na la it mv b gy nf nc l nd ne">## [1] 2.1 7.1 3.1 4.1</span><span id="7968" class="na la it mv b gy nf nc l nd ne">cumprod(x)</span><span id="6387" class="na la it mv b gy nf nc l nd ne">## [1]   2.1  10.5 -42.0 -42.0</span></pre><p id="be43" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">也可以应用以下数学运算:</p><ul class=""><li id="fe4c" class="ng nh it lt b lu mn lx mo ma ni me nj mi nk mm nu nm nn no bi translated"><code class="fe ms mt mu mv b">sqrt()</code>(平方根)</li><li id="8df2" class="ng nh it lt b lu np lx nq ma nr me ns mi nt mm nu nm nn no bi translated"><code class="fe ms mt mu mv b">cos()</code>(余弦)</li><li id="e721" class="ng nh it lt b lu np lx nq ma nr me ns mi nt mm nu nm nn no bi translated"><code class="fe ms mt mu mv b">sin()</code>(正弦)</li><li id="e973" class="ng nh it lt b lu np lx nq ma nr me ns mi nt mm nu nm nn no bi translated"><code class="fe ms mt mu mv b">tan()</code>(相切)</li><li id="3cb1" class="ng nh it lt b lu np lx nq ma nr me ns mi nt mm nu nm nn no bi translated"><code class="fe ms mt mu mv b">log()</code>(对数)</li><li id="2270" class="ng nh it lt b lu np lx nq ma nr me ns mi nt mm nu nm nn no bi translated"><code class="fe ms mt mu mv b">log10()</code>(以 10 为底的对数)</li><li id="7714" class="ng nh it lt b lu np lx nq ma nr me ns mi nt mm nu nm nn no bi translated"><code class="fe ms mt mu mv b">exp()</code>(指数型)</li><li id="5123" class="ng nh it lt b lu np lx nq ma nr me ns mi nt mm nu nm nn no bi translated"><code class="fe ms mt mu mv b">abs()</code>(绝对值)</li></ul><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="f6c8" class="na la it mv b gy nb nc l nd ne">cos(x)</span><span id="0767" class="na la it mv b gy nf nc l nd ne">## [1] -0.5048461  0.2836622 -0.6536436  0.5403023</span><span id="0c30" class="na la it mv b gy nf nc l nd ne">exp(x)</span><span id="016f" class="na la it mv b gy nf nc l nd ne">## [1]   8.16616991 148.41315910   0.01831564   2.71828183</span></pre><p id="4081" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">如果需要四舍五入，可以使用<code class="fe ms mt mu mv b">round()</code>、<code class="fe ms mt mu mv b">floor()</code>和<code class="fe ms mt mu mv b">ceiling()</code>功能:</p><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="1e12" class="na la it mv b gy nb nc l nd ne">round(cos(x), digits = 3) # 3 decimals</span><span id="a89a" class="na la it mv b gy nf nc l nd ne">## [1] -0.505  0.284 -0.654  0.540</span><span id="c633" class="na la it mv b gy nf nc l nd ne">floor(cos(x)) # largest integer not greater than x</span><span id="76ef" class="na la it mv b gy nf nc l nd ne">## [1] -1  0 -1  0</span><span id="5e3b" class="na la it mv b gy nf nc l nd ne">ceiling(cos(x)) # smallest integer not less than x</span><span id="2e35" class="na la it mv b gy nf nc l nd ne">## [1] 0 1 0 1</span></pre><h1 id="674e" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">逻辑运算符</h1><p id="6d5e" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">R 中最常见的逻辑运算符是:</p><ul class=""><li id="10fc" class="ng nh it lt b lu mn lx mo ma ni me nj mi nk mm nu nm nn no bi translated">否定:<code class="fe ms mt mu mv b">!</code></li><li id="ddd0" class="ng nh it lt b lu np lx nq ma nr me ns mi nt mm nu nm nn no bi translated">比较:<code class="fe ms mt mu mv b">&lt;</code>、<code class="fe ms mt mu mv b">&lt;=</code>、<code class="fe ms mt mu mv b">&gt;=</code>、<code class="fe ms mt mu mv b">&gt;</code>、<code class="fe ms mt mu mv b">==</code>(相等)、<code class="fe ms mt mu mv b">!=</code>(不同)</li><li id="d764" class="ng nh it lt b lu np lx nq ma nr me ns mi nt mm nu nm nn no bi translated">还有:<code class="fe ms mt mu mv b">&amp;</code></li><li id="9cb0" class="ng nh it lt b lu np lx nq ma nr me ns mi nt mm nu nm nn no bi translated">或者:<code class="fe ms mt mu mv b">|</code></li></ul><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="db10" class="na la it mv b gy nb nc l nd ne">x</span><span id="1035" class="na la it mv b gy nf nc l nd ne">## [1]  2.1  5.0 -4.0  1.0</span><span id="7d5e" class="na la it mv b gy nf nc l nd ne">x &lt;= c(1, 6, 3, 4)</span><span id="c762" class="na la it mv b gy nf nc l nd ne">## [1] FALSE  TRUE  TRUE  TRUE</span><span id="5f9a" class="na la it mv b gy nf nc l nd ne">x &lt;= 1</span><span id="221f" class="na la it mv b gy nf nc l nd ne">## [1] FALSE FALSE  TRUE  TRUE</span><span id="ab07" class="na la it mv b gy nf nc l nd ne">(x == 1 | x &gt; 4)</span><span id="2b8f" class="na la it mv b gy nf nc l nd ne">## [1] FALSE  TRUE FALSE  TRUE</span><span id="483d" class="na la it mv b gy nf nc l nd ne">!(x == 1 | x &gt; 4)</span><span id="d66a" class="na la it mv b gy nf nc l nd ne">## [1]  TRUE FALSE  TRUE FALSE</span></pre><h1 id="abf8" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated"><code class="fe ms mt mu mv b">all()</code>和<code class="fe ms mt mu mv b">any()</code></h1><p id="8c93" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">顾名思义，如果所有元素都满足条件，<code class="fe ms mt mu mv b">all()</code>将返回<code class="fe ms mt mu mv b">TRUE</code>，而如果 vector 的任何元素都满足条件，<code class="fe ms mt mu mv b">any()</code>将返回<code class="fe ms mt mu mv b">TRUE</code>:</p><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="e535" class="na la it mv b gy nb nc l nd ne">x</span><span id="3f0e" class="na la it mv b gy nf nc l nd ne">## [1]  2.1  5.0 -4.0  1.0</span><span id="e170" class="na la it mv b gy nf nc l nd ne">x &lt;= 1</span><span id="626a" class="na la it mv b gy nf nc l nd ne">## [1] FALSE FALSE  TRUE  TRUE</span><span id="42ba" class="na la it mv b gy nf nc l nd ne">all(x &lt;= 1)</span><span id="8933" class="na la it mv b gy nf nc l nd ne">## [1] FALSE</span><span id="1cff" class="na la it mv b gy nf nc l nd ne">any(x &lt;= 1)</span><span id="2b5a" class="na la it mv b gy nf nc l nd ne">## [1] TRUE</span></pre><h1 id="ddc0" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">字符串向量上的操作</h1><p id="cabb" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">您可以将至少两个向量粘贴在一起:</p><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="c2d9" class="na la it mv b gy nb nc l nd ne">code &lt;- paste(c("BE", "BE", "FR", "EN", "BE"), 1:5, sep = "/")<br/>code</span><span id="2234" class="na la it mv b gy nf nc l nd ne">## [1] "BE/1" "BE/2" "FR/3" "EN/4" "BE/5"</span></pre><p id="862f" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">参数<code class="fe ms mt mu mv b">sep</code>代表<code class="fe ms mt mu mv b">separator</code>，允许指定用于分隔每个字符串的字符或符号。</p><p id="362b" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">如果不想指定分隔符，可以使用<code class="fe ms mt mu mv b">sep = ""</code>或<code class="fe ms mt mu mv b">paste0()</code>功能:</p><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="fd51" class="na la it mv b gy nb nc l nd ne">paste(c("BE", "BE", "FR", "EN", "BE"), 1:5, sep = "")</span><span id="f480" class="na la it mv b gy nf nc l nd ne">## [1] "BE1" "BE2" "FR3" "EN4" "BE5"</span><span id="52e4" class="na la it mv b gy nf nc l nd ne">paste0(c("BE", "BE", "FR", "EN", "BE"), 1:5)</span><span id="2381" class="na la it mv b gy nf nc l nd ne">## [1] "BE1" "BE2" "FR3" "EN4" "BE5"</span></pre><p id="bbf2" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">要找到包含给定字符串的元素的位置，使用<code class="fe ms mt mu mv b">grep()</code>函数:</p><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="a467" class="na la it mv b gy nb nc l nd ne">grep("BE", code)</span><span id="6905" class="na la it mv b gy nf nc l nd ne">## [1] 1 2 5</span></pre><p id="8a32" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">为了根据开始和结束位置提取字符串，我们可以使用<code class="fe ms mt mu mv b">substr()</code>函数:</p><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="3b5e" class="na la it mv b gy nb nc l nd ne">substr(code,<br/>  start = 1,<br/>  stop = 3<br/>) # extract characters 1 to 3</span><span id="1491" class="na la it mv b gy nf nc l nd ne">## [1] "BE/" "BE/" "FR/" "EN/" "BE/"</span></pre><p id="750c" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">使用<code class="fe ms mt mu mv b">sub()</code>功能，用另一个字符串替换向量中存在的字符串:</p><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="cc4a" class="na la it mv b gy nb nc l nd ne">sub(<br/>  pattern = "BE", # find BE<br/>  replacement = "BEL", # replace it with BEL<br/>  code<br/>)</span><span id="de17" class="na la it mv b gy nf nc l nd ne">## [1] "BEL/1" "BEL/2" "FR/3"  "EN/4"  "BEL/5"</span></pre><p id="b734" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">使用<code class="fe ms mt mu mv b">strsplit()</code>功能根据特定符号分割字符串:</p><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="aacd" class="na la it mv b gy nb nc l nd ne">strsplit(c("Rafael Nadal", "Roger Federer", "Novak Djokovic"),<br/>  split = " "<br/>)</span><span id="16d4" class="na la it mv b gy nf nc l nd ne">## [[1]]<br/>## [1] "Rafael" "Nadal" <br/>## <br/>## [[2]]<br/>## [1] "Roger"   "Federer"<br/>## <br/>## [[3]]<br/>## [1] "Novak"    "Djokovic"</span><span id="b46c" class="na la it mv b gy nf nc l nd ne">strsplit(code,<br/>  split = "/"<br/>)</span><span id="6b45" class="na la it mv b gy nf nc l nd ne">## [[1]]<br/>## [1] "BE" "1" <br/>## <br/>## [[2]]<br/>## [1] "BE" "2" <br/>## <br/>## [[3]]<br/>## [1] "FR" "3" <br/>## <br/>## [[4]]<br/>## [1] "EN" "4" <br/>## <br/>## [[5]]<br/>## [1] "BE" "5"</span></pre><p id="b730" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">要将字符向量转换为大写和小写:</p><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="6283" class="na la it mv b gy nb nc l nd ne">toupper(c("Rafael Nadal", "Roger Federer", "Novak Djokovic"))</span><span id="616c" class="na la it mv b gy nf nc l nd ne">## [1] "RAFAEL NADAL"   "ROGER FEDERER"  "NOVAK DJOKOVIC"</span><span id="76f0" class="na la it mv b gy nf nc l nd ne">tolower(c("Rafael Nadal", "Roger Federer", "Novak Djokovic"))</span><span id="1b03" class="na la it mv b gy nf nc l nd ne">## [1] "rafael nadal"   "roger federer"  "novak djokovic"</span></pre><h1 id="21cd" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">顺序和向量</h1><p id="a650" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">我们可以从最小到最大或者从最大到最小对向量的元素进行排序:</p><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="cb3b" class="na la it mv b gy nb nc l nd ne">x &lt;- c(2.1, 5, -4, 1, 1)<br/>sort(x) # smallest to largest</span><span id="7ef9" class="na la it mv b gy nf nc l nd ne">## [1] -4.0  1.0  1.0  2.1  5.0</span><span id="70de" class="na la it mv b gy nf nc l nd ne">sort(x, decreasing = TRUE) # largest to smallest</span><span id="46b9" class="na la it mv b gy nf nc l nd ne">## [1]  5.0  2.1  1.0  1.0 -4.0</span></pre><p id="2cab" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><code class="fe ms mt mu mv b">order()</code>给出应用于向量的排列，以便对其元素进行排序:</p><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="f444" class="na la it mv b gy nb nc l nd ne">order(x)</span><span id="0d34" class="na la it mv b gy nf nc l nd ne">## [1] 3 4 5 1 2</span></pre><p id="156e" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">可以看到，向量的第三个元素最小，第二个元素最大。这由输出开始时的 3 和输出结束时的 2 表示。</p><p id="89bf" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">像<code class="fe ms mt mu mv b">sort()</code>一样，也可以添加<code class="fe ms mt mu mv b">decreasing = TRUE</code>参数:</p><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="c58d" class="na la it mv b gy nb nc l nd ne">order(x, decreasing = TRUE)</span><span id="73ee" class="na la it mv b gy nf nc l nd ne">## [1] 2 1 4 5 3</span></pre><p id="1c3b" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在这种情况下，输出中的 2 表示向量的第二个元素最大，而 3 表示第三个元素最小。</p><p id="35c3" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><code class="fe ms mt mu mv b">rank()</code>给出了元素的等级:</p><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="a31b" class="na la it mv b gy nb nc l nd ne">rank(x)</span><span id="c83a" class="na la it mv b gy nf nc l nd ne">## [1] 4.0 5.0 1.0 2.5 2.5</span></pre><p id="9cbd" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">向量的最后两个元素的秩为 2.5，因为它们是相等的，并且它们在第一个秩之后但在第四个秩之前。</p><p id="9f25" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我们也可以颠倒元素(从最后一个到第一个):</p><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="f06e" class="na la it mv b gy nb nc l nd ne">x</span><span id="264b" class="na la it mv b gy nf nc l nd ne">## [1]  2.1  5.0 -4.0  1.0  1.0</span><span id="8919" class="na la it mv b gy nf nc l nd ne">rev(x)</span><span id="c8a7" class="na la it mv b gy nf nc l nd ne">## [1]  1.0  1.0 -4.0  5.0  2.1</span></pre><h1 id="8a49" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">因素</h1><p id="e9ba" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated"><a class="ae ky" href="https://statsandr.com/blog/data-types-in-r/#factor" rel="noopener ugc nofollow" target="_blank">R</a>中的因子是具有一系列级别的向量，也称为类别。因素对于<a class="ae ky" href="https://statsandr.com/blog/variable-types-and-examples/#qualitative" rel="noopener ugc nofollow" target="_blank">定性</a>数据很有用，如性别、公民身份、眼睛颜色等。</p><h1 id="7f49" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">创造因素</h1><p id="d488" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">我们用<code class="fe ms mt mu mv b">factor()</code>函数创建因子(不要忘记<code class="fe ms mt mu mv b">c()</code>):</p><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="6801" class="na la it mv b gy nb nc l nd ne">f1 &lt;- factor(c("T1", "T3", "T1", "T2"))<br/>f1</span><span id="7d73" class="na la it mv b gy nf nc l nd ne">## [1] T1 T3 T1 T2<br/>## Levels: T1 T2 T3</span></pre><p id="4ab7" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我们当然可以从现有的向量中创建一个因子:</p><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="c544" class="na la it mv b gy nb nc l nd ne">v &lt;- c(1, 1, 0, 1, 0)<br/>v2 &lt;- factor(v,<br/>  levels = c(0, 1),<br/>  labels = c("bad", "good")<br/>)<br/>v2</span><span id="7b64" class="na la it mv b gy nf nc l nd ne">## [1] good good bad  good bad <br/>## Levels: bad good</span></pre><p id="77f6" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我们还可以通过添加<code class="fe ms mt mu mv b">ordered = TRUE</code>参数来指定级别的顺序:</p><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="5a04" class="na la it mv b gy nb nc l nd ne">v2 &lt;- factor(v,<br/>  levels = c(0, 1),<br/>  labels = c("bad", "good"),<br/>  ordered = TRUE<br/>)<br/>v2</span><span id="60fe" class="na la it mv b gy nf nc l nd ne">## [1] good good bad  good bad <br/>## Levels: bad &lt; good</span></pre><p id="1b07" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">请注意，级别的顺序将遵循在<code class="fe ms mt mu mv b">labels</code>参数中指定的顺序。</p><h1 id="27eb" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">性能</h1><p id="2371" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">要了解级别的名称:</p><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="3599" class="na la it mv b gy nb nc l nd ne">levels(f1)</span><span id="f7e6" class="na la it mv b gy nf nc l nd ne">## [1] "T1" "T2" "T3"</span></pre><p id="9037" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">对于级别数:</p><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="4553" class="na la it mv b gy nb nc l nd ne">nlevels(f1)</span><span id="64d0" class="na la it mv b gy nf nc l nd ne">## [1] 3</span></pre><p id="445a" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在 R 中，第一级始终是参考级。该参考水平可通过<code class="fe ms mt mu mv b">relevel()</code>进行修改:</p><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="78ea" class="na la it mv b gy nb nc l nd ne">relevel(f1, ref = "T3")</span><span id="c106" class="na la it mv b gy nf nc l nd ne">## [1] T1 T3 T1 T2<br/>## Levels: T3 T1 T2</span></pre><p id="55fb" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">您会看到“T3”现在是第一个，因此也是参考电平。更改参考级别会影响它们在统计分析中的显示或处理顺序。例如，将<a class="ae ky" href="https://statsandr.com/blog/descriptive-statistics-in-r/#boxplot" rel="noopener ugc nofollow" target="_blank">箱线图</a>与不同的参考电平进行比较。</p><h1 id="6e9e" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">处理</h1><p id="5893" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">要了解每个级别的频率:</p><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="4364" class="na la it mv b gy nb nc l nd ne">table(f1)</span><span id="dd3c" class="na la it mv b gy nf nc l nd ne">## f1<br/>## T1 T2 T3 <br/>##  2  1  1</span><span id="dab2" class="na la it mv b gy nf nc l nd ne"># or<br/>summary(f1)</span><span id="92f0" class="na la it mv b gy nf nc l nd ne">## T1 T2 T3 <br/>##  2  1  1</span></pre><p id="de22" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">请注意，相对频率(即比例)可通过组合<code class="fe ms mt mu mv b">prop.table()</code>和<code class="fe ms mt mu mv b">table()</code>或<code class="fe ms mt mu mv b">summary()</code>找到:</p><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="0263" class="na la it mv b gy nb nc l nd ne">prop.table(table(f1))</span><span id="6d47" class="na la it mv b gy nf nc l nd ne">## f1<br/>##   T1   T2   T3 <br/>## 0.50 0.25 0.25</span><span id="3a70" class="na la it mv b gy nf nc l nd ne"># or<br/>prop.table(summary(f1))</span><span id="e63f" class="na la it mv b gy nf nc l nd ne">##   T1   T2   T3 <br/>## 0.50 0.25 0.25</span></pre><p id="eec1" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">记住，一个因子在 R 中被编码为一个数字向量，即使它看起来像一个字符向量。我们可以用<code class="fe ms mt mu mv b">as.numeric()</code>函数将一个因子转换成它的等值数字:</p><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="a3b4" class="na la it mv b gy nb nc l nd ne">f1</span><span id="2980" class="na la it mv b gy nf nc l nd ne">## [1] T1 T3 T1 T2<br/>## Levels: T1 T2 T3</span><span id="6c22" class="na la it mv b gy nf nc l nd ne">as.numeric(f1)</span><span id="8cf1" class="na la it mv b gy nf nc l nd ne">## [1] 1 3 1 2</span></pre><p id="0de7" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">用<code class="fe ms mt mu mv b">as.factor()</code>或<code class="fe ms mt mu mv b">factor()</code>函数可以将数值向量转换成因子:</p><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="a08d" class="na la it mv b gy nb nc l nd ne">num &lt;- 1:4<br/>fac &lt;- as.factor(num)<br/>fac</span><span id="b9ef" class="na la it mv b gy nf nc l nd ne">## [1] 1 2 3 4<br/>## Levels: 1 2 3 4</span><span id="b4fb" class="na la it mv b gy nf nc l nd ne">fac2 &lt;- factor(num)<br/>fac2</span><span id="a181" class="na la it mv b gy nf nc l nd ne">## [1] 1 2 3 4<br/>## Levels: 1 2 3 4</span></pre><p id="301d" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><code class="fe ms mt mu mv b">factor()</code>的优点是可以为每个级别指定一个名称:</p><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="6e86" class="na la it mv b gy nb nc l nd ne">fac2 &lt;- factor(num,<br/>  labels = c("bad", "neutral", "good", "very good")<br/>)<br/>fac2</span><span id="80a0" class="na la it mv b gy nf nc l nd ne">## [1] bad       neutral   good      very good<br/>## Levels: bad neutral good very good</span></pre><h1 id="893e" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">列表</h1><p id="f207" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">列表是一个向量，它的元素可以有不同的性质:向量、列表、因子、数字或字符等。</p><h1 id="31de" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">创建列表</h1><p id="71fd" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">功能<code class="fe ms mt mu mv b">list()</code>允许创建列表:</p><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="68ac" class="na la it mv b gy nb nc l nd ne">tahiti &lt;- list(<br/>  plane = c("Airbus", "Boeing"),<br/>  departure = c("Brussels", "Milan", "Paris"),<br/>  duration = c(15, 11, 14)<br/>)<br/>tahiti</span><span id="9509" class="na la it mv b gy nf nc l nd ne">## $plane<br/>## [1] "Airbus" "Boeing"<br/>## <br/>## $departure<br/>## [1] "Brussels" "Milan"    "Paris"   <br/>## <br/>## $duration<br/>## [1] 15 11 14</span></pre><h1 id="bb02" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">处理</h1><p id="3148" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">有几种方法可以从列表中提取元素:</p><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="dd2b" class="na la it mv b gy nb nc l nd ne">tahiti$departure</span><span id="bcc6" class="na la it mv b gy nf nc l nd ne">## [1] "Brussels" "Milan"    "Paris"</span><span id="602f" class="na la it mv b gy nf nc l nd ne"># or<br/>tahiti$de</span><span id="8265" class="na la it mv b gy nf nc l nd ne">## [1] "Brussels" "Milan"    "Paris"</span><span id="7b12" class="na la it mv b gy nf nc l nd ne"># or<br/>tahiti[[2]]</span><span id="fc24" class="na la it mv b gy nf nc l nd ne">## [1] "Brussels" "Milan"    "Paris"</span><span id="695d" class="na la it mv b gy nf nc l nd ne"># or<br/>tahiti[["departure"]]</span><span id="4a0d" class="na la it mv b gy nf nc l nd ne">## [1] "Brussels" "Milan"    "Paris"</span><span id="6cc0" class="na la it mv b gy nf nc l nd ne">tahiti[[2]][c(1, 2)]</span><span id="f873" class="na la it mv b gy nf nc l nd ne">## [1] "Brussels" "Milan"</span></pre><p id="6ea8" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">要将列表转换为向量:</p><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="d6c1" class="na la it mv b gy nb nc l nd ne">v &lt;- unlist(tahiti)<br/>v</span><span id="12f8" class="na la it mv b gy nf nc l nd ne">##     plane1     plane2 departure1 departure2 departure3  duration1  duration2 <br/>##   "Airbus"   "Boeing" "Brussels"    "Milan"    "Paris"       "15"       "11" <br/>##  duration3 <br/>##       "14"</span><span id="8145" class="na la it mv b gy nf nc l nd ne">is.vector(v)</span><span id="319f" class="na la it mv b gy nf nc l nd ne">## [1] TRUE</span></pre><h1 id="9594" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">获取对象的详细信息</h1><p id="daa1" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated"><code class="fe ms mt mu mv b">attributes()</code>给出元素的名称(它可以用在每个 R 对象上):</p><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="3601" class="na la it mv b gy nb nc l nd ne">attributes(tahiti)</span><span id="4167" class="na la it mv b gy nf nc l nd ne">## $names<br/>## [1] "plane"     "departure" "duration"</span></pre><p id="f9b1" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><code class="fe ms mt mu mv b">str()</code>给出关于元素的简短描述(也可用于每个 R 对象):</p><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="4143" class="na la it mv b gy nb nc l nd ne">str(tahiti)</span><span id="1feb" class="na la it mv b gy nf nc l nd ne">## List of 3<br/>##  $ plane    : chr [1:2] "Airbus" "Boeing"<br/>##  $ departure: chr [1:3] "Brussels" "Milan" "Paris"<br/>##  $ duration : num [1:3] 15 11 14</span></pre><h1 id="cbe3" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">数据帧</h1><p id="2dbb" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">R 中每个导入的文件都是一个数据帧(至少如果你不使用包<a class="ae ky" href="https://statsandr.com/blog/how-to-import-an-excel-file-in-rstudio/" rel="noopener ugc nofollow" target="_blank">将你的数据导入 R </a>)。数据框是列表和矩阵的混合:它具有矩阵的形状，但是列可以有不同的类。</p><p id="820d" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">记住，<strong class="lt iu">数据帧</strong>的黄金标准是:</p><ul class=""><li id="bd04" class="ng nh it lt b lu mn lx mo ma ni me nj mi nk mm nu nm nn no bi translated"><strong class="lt iu">列</strong>代表<strong class="lt iu">变量</strong></li><li id="c60b" class="ng nh it lt b lu np lx nq ma nr me ns mi nt mm nu nm nn no bi translated"><strong class="lt iu">线</strong>对应于<strong class="lt iu">观察值</strong>和</li><li id="1977" class="ng nh it lt b lu np lx nq ma nr me ns mi nt mm nu nm nn no bi translated">每个<strong class="lt iu">值</strong>必须有自己的<strong class="lt iu">单元格</strong></li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nv"><img src="../Images/6a0a48a8803993897a9c620247a56231.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*lQ6LUznhgeXzms88.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Structure of a data frame. Source: R for Data Science by Hadley Wickham &amp; Garrett Grolemund</figcaption></figure><p id="efa8" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在本文中，我们使用数据框架<code class="fe ms mt mu mv b">cars</code>来说明主要的数据操作技术。请注意，数据框是默认安装在 RStudio 中的(因此您不需要导入它)，我在整篇文章中使用通用名称<code class="fe ms mt mu mv b">dat</code>作为数据框的名称(参见此处的<a class="ae ky" href="https://statsandr.com/blog/how-to-import-an-excel-file-in-rstudio/#user-friendly-way" rel="noopener ugc nofollow" target="_blank"/>为什么我总是使用通用名称而不是更具体的名称)。</p><p id="9eed" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">以下是整个数据框:</p><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="7774" class="na la it mv b gy nb nc l nd ne">dat &lt;- cars # rename the cars data frame with a generic name<br/>dat # display the entire data frame</span><span id="d967" class="na la it mv b gy nf nc l nd ne">##    speed dist<br/>## 1      4    2<br/>## 2      4   10<br/>## 3      7    4<br/>## 4      7   22<br/>## 5      8   16<br/>## 6      9   10<br/>## 7     10   18<br/>## 8     10   26<br/>## 9     10   34<br/>## 10    11   17<br/>## 11    11   28<br/>## 12    12   14<br/>## 13    12   20<br/>## 14    12   24<br/>## 15    12   28<br/>## 16    13   26<br/>## 17    13   34<br/>## 18    13   34<br/>## 19    13   46<br/>## 20    14   26<br/>## 21    14   36<br/>## 22    14   60<br/>## 23    14   80<br/>## 24    15   20<br/>## 25    15   26<br/>## 26    15   54<br/>## 27    16   32<br/>## 28    16   40<br/>## 29    17   32<br/>## 30    17   40<br/>## 31    17   50<br/>## 32    18   42<br/>## 33    18   56<br/>## 34    18   76<br/>## 35    18   84<br/>## 36    19   36<br/>## 37    19   46<br/>## 38    19   68<br/>## 39    20   32<br/>## 40    20   48<br/>## 41    20   52<br/>## 42    20   56<br/>## 43    20   64<br/>## 44    22   66<br/>## 45    23   54<br/>## 46    24   70<br/>## 47    24   92<br/>## 48    24   93<br/>## 49    24  120<br/>## 50    25   85</span></pre><p id="18f8" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">该数据帧有 50 个带有 2 个变量的观察值(<code class="fe ms mt mu mv b">speed</code>和<code class="fe ms mt mu mv b">distance</code>)。</p><p id="f152" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">您可以分别使用<code class="fe ms mt mu mv b">nrow()</code>和<code class="fe ms mt mu mv b">ncol()</code>检查观察值和变量的数量，或者使用<code class="fe ms mt mu mv b">dim()</code>同时检查两者:</p><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="792e" class="na la it mv b gy nb nc l nd ne">nrow(dat) # number of rows/observations</span><span id="22b8" class="na la it mv b gy nf nc l nd ne">## [1] 50</span><span id="cffa" class="na la it mv b gy nf nc l nd ne">ncol(dat) # number of columns/variables</span><span id="aea0" class="na la it mv b gy nf nc l nd ne">## [1] 2</span><span id="caea" class="na la it mv b gy nf nc l nd ne">dim(dat) # dimension: number of rows and number of columns</span><span id="e0fa" class="na la it mv b gy nf nc l nd ne">## [1] 50  2</span></pre><h1 id="9452" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">行名和列名</h1><p id="111d" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">在操作数据框之前，了解行和列的名称很有意思:</p><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="fe7c" class="na la it mv b gy nb nc l nd ne">dimnames(dat)</span><span id="28a0" class="na la it mv b gy nf nc l nd ne">## [[1]]<br/>##  [1] "1"  "2"  "3"  "4"  "5"  "6"  "7"  "8"  "9"  "10" "11" "12" "13" "14" "15"<br/>## [16] "16" "17" "18" "19" "20" "21" "22" "23" "24" "25" "26" "27" "28" "29" "30"<br/>## [31] "31" "32" "33" "34" "35" "36" "37" "38" "39" "40" "41" "42" "43" "44" "45"<br/>## [46] "46" "47" "48" "49" "50"<br/>## <br/>## [[2]]<br/>## [1] "speed" "dist"</span></pre><p id="cfd4" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">要只知道列名:</p><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="dd49" class="na la it mv b gy nb nc l nd ne">names(dat)</span><span id="8185" class="na la it mv b gy nf nc l nd ne">## [1] "speed" "dist"</span><span id="c47f" class="na la it mv b gy nf nc l nd ne"># or<br/>colnames(dat)</span><span id="a5a9" class="na la it mv b gy nf nc l nd ne">## [1] "speed" "dist"</span></pre><p id="7e11" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">并且只知道行名:</p><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="7dd3" class="na la it mv b gy nb nc l nd ne">rownames(dat)</span><span id="77c2" class="na la it mv b gy nf nc l nd ne">##  [1] "1"  "2"  "3"  "4"  "5"  "6"  "7"  "8"  "9"  "10" "11" "12" "13" "14" "15"<br/>## [16] "16" "17" "18" "19" "20" "21" "22" "23" "24" "25" "26" "27" "28" "29" "30"<br/>## [31] "31" "32" "33" "34" "35" "36" "37" "38" "39" "40" "41" "42" "43" "44" "45"<br/>## [46] "46" "47" "48" "49" "50"</span></pre><h1 id="086e" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">子集 a 数据帧</h1><h1 id="8030" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">首次或最后一次观察</h1><ul class=""><li id="47cf" class="ng nh it lt b lu lv lx ly ma nw me nx mi ny mm nu nm nn no bi translated">要仅保留前 10 个观察值:</li></ul><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="1025" class="na la it mv b gy nb nc l nd ne">head(dat, n = 10)</span><span id="acd1" class="na la it mv b gy nf nc l nd ne">##    speed dist<br/>## 1      4    2<br/>## 2      4   10<br/>## 3      7    4<br/>## 4      7   22<br/>## 5      8   16<br/>## 6      9   10<br/>## 7     10   18<br/>## 8     10   26<br/>## 9     10   34<br/>## 10    11   17</span></pre><ul class=""><li id="2d2c" class="ng nh it lt b lu mn lx mo ma ni me nj mi nk mm nu nm nn no bi translated">要仅保留最后 5 次观察:</li></ul><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="f74b" class="na la it mv b gy nb nc l nd ne">tail(dat, n = 5)</span><span id="795f" class="na la it mv b gy nf nc l nd ne">##    speed dist<br/>## 46    24   70<br/>## 47    24   92<br/>## 48    24   93<br/>## 49    24  120<br/>## 50    25   85</span></pre><h1 id="8312" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">随机观察样本</h1><ul class=""><li id="0e0e" class="ng nh it lt b lu lv lx ly ma nw me nx mi ny mm nu nm nn no bi translated">要抽取 4 个观察值的样本而不替换:</li></ul><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="ab34" class="na la it mv b gy nb nc l nd ne">library(dplyr)<br/>sample_n(dat, 4, replace = FALSE)</span><span id="013f" class="na la it mv b gy nf nc l nd ne">##   speed dist<br/>## 1     7   22<br/>## 2     8   16<br/>## 3    20   48<br/>## 4    10   18</span></pre><h1 id="34d0" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">基于行号或列号</h1><p id="bc04" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">如果您知道要保留哪些观察结果或列，则可以使用行号或列号对数据框进行分组。我们用几个例子来说明这一点:</p><ul class=""><li id="4ca2" class="ng nh it lt b lu mn lx mo ma ni me nj mi nk mm nu nm nn no bi translated">保留第三次观察的所有变量:</li></ul><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="9880" class="na la it mv b gy nb nc l nd ne">dat[3, ]</span></pre><ul class=""><li id="3b9c" class="ng nh it lt b lu mn lx mo ma ni me nj mi nk mm nu nm nn no bi translated">为所有观察值保留第二个变量:</li></ul><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="260b" class="na la it mv b gy nb nc l nd ne">dat[, 2]</span></pre><ul class=""><li id="73fd" class="ng nh it lt b lu mn lx mo ma ni me nj mi nk mm nu nm nn no bi translated">您可以混合使用上述两种方法，只保留第 3 次观察的第 2 个变量:</li></ul><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="29eb" class="na la it mv b gy nb nc l nd ne">dat[3, 2]</span><span id="5a25" class="na la it mv b gy nf nc l nd ne">## [1] 4</span></pre><ul class=""><li id="9db5" class="ng nh it lt b lu mn lx mo ma ni me nj mi nk mm nu nm nn no bi translated">保持几次观察；例如观察结果 1 至 5、所有变量的第 10 和第 15 个观察结果:</li></ul><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="ccdb" class="na la it mv b gy nb nc l nd ne">dat[c(1:5, 10, 15), ] # do not forget c()</span><span id="967a" class="na la it mv b gy nf nc l nd ne">##    speed dist<br/>## 1      4    2<br/>## 2      4   10<br/>## 3      7    4<br/>## 4      7   22<br/>## 5      8   16<br/>## 10    11   17<br/>## 15    12   28</span></pre><ul class=""><li id="6c7c" class="ng nh it lt b lu mn lx mo ma ni me nj mi nk mm nu nm nn no bi translated">删除观察结果 5 至 45:</li></ul><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="14a4" class="na la it mv b gy nb nc l nd ne">dat[-c(5:45), ]</span><span id="0f62" class="na la it mv b gy nf nc l nd ne">##    speed dist<br/>## 1      4    2<br/>## 2      4   10<br/>## 3      7    4<br/>## 4      7   22<br/>## 46    24   70<br/>## 47    24   92<br/>## 48    24   93<br/>## 49    24  120<br/>## 50    25   85</span></pre><ul class=""><li id="46a1" class="ng nh it lt b lu mn lx mo ma ni me nj mi nk mm nu nm nn no bi translated">提示:如果只保留最后一次观察，请用<code class="fe ms mt mu mv b">nrow()</code>代替行号:</li></ul><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="af76" class="na la it mv b gy nb nc l nd ne">dat[nrow(dat), ] # nrow() gives the number of rows</span><span id="30a7" class="na la it mv b gy nf nc l nd ne">##    speed dist<br/>## 50    25   85</span></pre><p id="8d05" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">这样，无论观察多少次，你都会选择最后一次。使用一段代码而不是特定值的技术是为了避免“硬编码”。通常不建议硬编码(除非您想要指定一个您确信永远不会改变的参数)，因为如果您的数据框改变了，您将需要手动编辑您的代码。</p><p id="33b0" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">正如您现在可能已经知道的，您可以通过运行<code class="fe ms mt mu mv b">dataset_name[row_number, column_number]</code>来选择数据集的观测值和/或变量。当行(列)号为空时，选择整个行(列)。</p><p id="49bd" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">请注意，上述所有示例也适用于矩阵:</p><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="dc8e" class="na la it mv b gy nb nc l nd ne">mat &lt;- matrix(c(-1, 2, 0, 3), ncol = 2, nrow = 2)<br/>mat</span><span id="b633" class="na la it mv b gy nf nc l nd ne">##      [,1] [,2]<br/>## [1,]   -1    0<br/>## [2,]    2    3</span><span id="c426" class="na la it mv b gy nf nc l nd ne">mat[1, 2]</span><span id="a34e" class="na la it mv b gy nf nc l nd ne">## [1] 0</span></pre><h1 id="8511" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">基于变量名</h1><p id="0954" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">要根据名称而不是列号选择数据集中的一个变量，请使用<code class="fe ms mt mu mv b">dataset_name$variable_name</code>:</p><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="a592" class="na la it mv b gy nb nc l nd ne">dat$speed</span><span id="a137" class="na la it mv b gy nf nc l nd ne">##  [1]  4  4  7  7  8  9 10 10 10 11 11 12 12 12 12 13 13 13 13 14 14 14 14 15 15<br/>## [26] 15 16 16 17 17 17 18 18 18 18 19 19 19 20 20 20 20 20 22 23 24 24 24 24 25</span></pre><p id="3d99" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">如果您打算修改数据库的结构，强烈建议使用第二种方法访问数据框中的变量，而不是第一种方法。事实上，如果在数据框中添加或删除一列，编号将会改变。因此，变量通常是通过其名称而不是位置(列号)来引用的。此外，更容易理解和解释写有变量名的代码(用一个简洁但清晰的名字调用变量的另一个原因)。我仍然使用列号的原因只有一个；如果变量名称预期会改变，而数据帧的结构不会改变。</p><p id="f325" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">为了选择变量，也可以使用强大的<code class="fe ms mt mu mv b">dplyr</code>包中的<code class="fe ms mt mu mv b">select()</code>命令(由于<code class="fe ms mt mu mv b">head()</code>命令，为了简洁起见，仅显示前 6 个观察结果):</p><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="6795" class="na la it mv b gy nb nc l nd ne">head(select(dat, speed))</span><span id="0021" class="na la it mv b gy nf nc l nd ne">##   speed<br/>## 1     4<br/>## 2     4<br/>## 3     7<br/>## 4     7<br/>## 5     8<br/>## 6     9</span></pre><p id="d64b" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">这等同于删除距离变量:</p><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="d923" class="na la it mv b gy nb nc l nd ne">head(select(dat, -dist))</span><span id="4384" class="na la it mv b gy nf nc l nd ne">##   speed<br/>## 1     4<br/>## 2     4<br/>## 3     7<br/>## 4     7<br/>## 5     8<br/>## 6     9</span></pre><h1 id="efcc" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">基于一个或多个标准</h1><p id="2f00" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">您也可以根据一个或多个标准对数据框进行子集化，而不是根据行/列号或变量名对数据框进行子集化:</p><ul class=""><li id="13b8" class="ng nh it lt b lu mn lx mo ma ni me nj mi nk mm nu nm nn no bi translated">只保留速度大于 20 的观察值。第一个参数引用数据框的名称，而第二个参数引用子集标准:</li></ul><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="3e09" class="na la it mv b gy nb nc l nd ne">subset(dat, dat$speed &gt; 20)</span><span id="2293" class="na la it mv b gy nf nc l nd ne">##    speed dist<br/>## 44    22   66<br/>## 45    23   54<br/>## 46    24   70<br/>## 47    24   92<br/>## 48    24   93<br/>## 49    24  120<br/>## 50    25   85</span></pre><ul class=""><li id="e534" class="ng nh it lt b lu mn lx mo ma ni me nj mi nk mm nu nm nn no bi translated">仅保留距离小于或等于 50 <strong class="lt iu">且</strong>速度等于 10 的观测值。注意平等标准的<code class="fe ms mt mu mv b">==</code>(而非<code class="fe ms mt mu mv b">=</code>):</li></ul><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="6ad0" class="na la it mv b gy nb nc l nd ne">subset(dat, dat$dist &lt;= 50 &amp; dat$speed == 10)</span><span id="06bd" class="na la it mv b gy nf nc l nd ne">##   speed dist<br/>## 7    10   18<br/>## 8    10   26<br/>## 9    10   34</span></pre><ul class=""><li id="49e0" class="ng nh it lt b lu mn lx mo ma ni me nj mi nk mm nu nm nn no bi translated">使用<code class="fe ms mt mu mv b">|</code>只保留距离小于 20 <strong class="lt iu">或</strong>速度等于 10 的观测值；</li></ul><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="bff3" class="na la it mv b gy nb nc l nd ne">subset(dat, dat$dist &lt; 20 | dat$speed == 10)</span><span id="f928" class="na la it mv b gy nf nc l nd ne">##    speed dist<br/>## 1      4    2<br/>## 2      4   10<br/>## 3      7    4<br/>## 5      8   16<br/>## 6      9   10<br/>## 7     10   18<br/>## 8     10   26<br/>## 9     10   34<br/>## 10    11   17<br/>## 12    12   14</span></pre><ul class=""><li id="18a9" class="ng nh it lt b lu mn lx mo ma ni me nj mi nk mm nu nm nn no bi translated">要过滤掉一些观察结果，使用<code class="fe ms mt mu mv b">!=</code>。例如，保持速度不等于 24 和距离不等于 120 的观察值(由于<code class="fe ms mt mu mv b">tail()</code>命令，为了简洁起见，只显示最后 6 个观察值):</li></ul><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="ee47" class="na la it mv b gy nb nc l nd ne">tail(subset(dat, dat$speed != 24 &amp; dat$dist != 120))</span><span id="979c" class="na la it mv b gy nf nc l nd ne">##    speed dist<br/>## 41    20   52<br/>## 42    20   56<br/>## 43    20   64<br/>## 44    22   66<br/>## 45    23   54<br/>## 50    25   85</span></pre><p id="b560" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">注意，也可以用<code class="fe ms mt mu mv b">split()</code>对数据帧进行子集化:</p><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="2aa2" class="na la it mv b gy nb nc l nd ne">split(dat, dat$factor_variable)</span></pre><p id="371f" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">上述代码会将您的数据框分割成几个数据框，每个数据框对应因子变量的一个级别。</p><h1 id="3012" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">创建一个新变量</h1><p id="eb8b" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">通常，可以通过基于初始数据框中的其他变量创建新变量来增强数据框，或者通过手动添加新变量来增强数据框。</p><p id="1ea4" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在这个例子中，我们创建了两个新变量；一个是速度乘以距离(我们称之为<code class="fe ms mt mu mv b">speed_dist</code>)，另一个是速度的分类(我们称之为<code class="fe ms mt mu mv b">speed_cat</code>)。然后，我们用 4 个变量显示这个新数据框的前 6 个观察值:</p><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="db34" class="na la it mv b gy nb nc l nd ne"># create new variable speed_dist<br/>dat$speed_dist &lt;- dat$speed * dat$dist</span><span id="957c" class="na la it mv b gy nf nc l nd ne"># create new variable speed_cat<br/># with ifelse(): if dat$speed &gt; 7, then speed_cat is "high speed", otherwise it is "low_speed"<br/>dat$speed_cat &lt;- factor(ifelse(dat$speed &gt; 7,<br/>  "high speed", "low speed"<br/>))</span><span id="a0b8" class="na la it mv b gy nf nc l nd ne"># display first 6 observations<br/>head(dat) # 6 is the default in head()</span><span id="427b" class="na la it mv b gy nf nc l nd ne">##   speed dist speed_dist  speed_cat<br/>## 1     4    2          8  low speed<br/>## 2     4   10         40  low speed<br/>## 3     7    4         28  low speed<br/>## 4     7   22        154  low speed<br/>## 5     8   16        128 high speed<br/>## 6     9   10         90 high speed</span></pre><p id="8f1b" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">注意，在编程中，字符串通常用引号括起来(如<code class="fe ms mt mu mv b">"character string"</code>)，R 也不例外。</p><h1 id="8ae8" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">将连续变量转换为分类变量</h1><p id="95a0" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">将<a class="ae ky" href="https://statsandr.com/blog/variable-types-and-examples/#continuous" rel="noopener ugc nofollow" target="_blank">连续变量</a>转换为分类变量(也称为<a class="ae ky" href="https://statsandr.com/blog/variable-types-and-examples/#qualitative" rel="noopener ugc nofollow" target="_blank">定性变量</a>):</p><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="8054" class="na la it mv b gy nb nc l nd ne">dat$speed_quali &lt;- cut(dat$speed,<br/>  breaks = c(0, 12, 15, 19, 26), # cut points<br/>  right = FALSE # closed on the left, open on the right<br/>)</span><span id="5f42" class="na la it mv b gy nf nc l nd ne">dat[c(1:2, 23:24, 49:50), ] # display some observations</span><span id="a42d" class="na la it mv b gy nf nc l nd ne">##    speed dist speed_dist  speed_cat speed_quali<br/>## 1      4    2          8  low speed      [0,12)<br/>## 2      4   10         40  low speed      [0,12)<br/>## 23    14   80       1120 high speed     [12,15)<br/>## 24    15   20        300 high speed     [15,19)<br/>## 49    24  120       2880 high speed     [19,26)<br/>## 50    25   85       2125 high speed     [19,26)</span></pre><p id="7f9b" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">例如，当年龄(连续变量)被转换为代表不同年龄组的定性变量时，这种转换通常在年龄上进行。</p><h1 id="2d7d" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">行中的总和与平均值</h1><p id="9f32" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">在使用李克特量表(除其他外，用于心理学)的调查中，通常情况下，我们需要根据多个问题计算每个受访者的分数。分数通常是所有感兴趣问题的平均值或总和。</p><p id="c63d" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">这可以通过<code class="fe ms mt mu mv b">rowMeans()</code>和<code class="fe ms mt mu mv b">rowSums()</code>来完成。例如，让我们计算变量<code class="fe ms mt mu mv b">speed</code>、<code class="fe ms mt mu mv b">dist</code>和<code class="fe ms mt mu mv b">speed_dist</code>的平均值和总和(当然，变量必须是数字，因为总和和平均值不能在定性变量上计算！)并将它们存储在变量<code class="fe ms mt mu mv b">mean_score</code>和<code class="fe ms mt mu mv b">total_score</code>下:</p><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="e86a" class="na la it mv b gy nb nc l nd ne">dat$mean_score &lt;- rowMeans(dat[, 1:3]) # variables speed, dist and speed_dist correspond to variables 1 to 3<br/>dat$total_score &lt;- rowSums(dat[, 1:3])</span><span id="cb65" class="na la it mv b gy nf nc l nd ne">head(dat)</span><span id="83dc" class="na la it mv b gy nf nc l nd ne">##   speed dist speed_dist  speed_cat speed_quali mean_score total_score<br/>## 1     4    2          8  low speed      [0,12)   4.666667          14<br/>## 2     4   10         40  low speed      [0,12)  18.000000          54<br/>## 3     7    4         28  low speed      [0,12)  13.000000          39<br/>## 4     7   22        154  low speed      [0,12)  61.000000         183<br/>## 5     8   16        128 high speed      [0,12)  50.666667         152<br/>## 6     9   10         90 high speed      [0,12)  36.333333         109</span></pre><h1 id="e220" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">列中的总和与平均值</h1><p id="a156" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">也可以用<code class="fe ms mt mu mv b">colMeans()</code>和<code class="fe ms mt mu mv b">colSums()</code>按列计算平均值和总和:</p><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="7e54" class="na la it mv b gy nb nc l nd ne">colMeans(dat[, 1:3])</span><span id="a4cd" class="na la it mv b gy nf nc l nd ne">##      speed       dist speed_dist <br/>##      15.40      42.98     769.64</span><span id="d8ce" class="na la it mv b gy nf nc l nd ne">colSums(dat[, 1:3])</span><span id="6001" class="na la it mv b gy nf nc l nd ne">##      speed       dist speed_dist <br/>##        770       2149      38482</span></pre><p id="7057" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">这相当于:</p><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="2a71" class="na la it mv b gy nb nc l nd ne">mean(dat$speed)</span><span id="bc66" class="na la it mv b gy nf nc l nd ne">## [1] 15.4</span><span id="5450" class="na la it mv b gy nf nc l nd ne">sum(dat$speed)</span><span id="06ca" class="na la it mv b gy nf nc l nd ne">## [1] 770</span></pre><p id="59d2" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">但是它允许一次对几个变量进行处理。</p><h1 id="7209" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">分类变量和标签管理</h1><p id="eb61" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">对于分类变量，使用因子格式并命名变量的不同级别是一个很好的实践。</p><ul class=""><li id="444e" class="ng nh it lt b lu mn lx mo ma ni me nj mi nk mm nu nm nn no bi translated">对于本例，让我们根据距离创建另一个名为<code class="fe ms mt mu mv b">dist_cat</code>的新变量，然后将其格式从数字改为因子(同时还指定级别的标签):</li></ul><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="c353" class="na la it mv b gy nb nc l nd ne"># create new variable dist_cat<br/>dat$dist_cat &lt;- ifelse(dat$dist &lt; 15,<br/>  1, 2<br/>)</span><span id="15a3" class="na la it mv b gy nf nc l nd ne"># change from numeric to factor and specify the labels<br/>dat$dist_cat &lt;- factor(dat$dist_cat,<br/>  levels = c(1, 2),<br/>  labels = c("small distance", "big distance") # follow the order of the levels<br/>)</span><span id="579d" class="na la it mv b gy nf nc l nd ne">head(dat)</span><span id="ef0e" class="na la it mv b gy nf nc l nd ne">##   speed dist speed_dist  speed_cat speed_quali mean_score total_score<br/>## 1     4    2          8  low speed      [0,12)   4.666667          14<br/>## 2     4   10         40  low speed      [0,12)  18.000000          54<br/>## 3     7    4         28  low speed      [0,12)  13.000000          39<br/>## 4     7   22        154  low speed      [0,12)  61.000000         183<br/>## 5     8   16        128 high speed      [0,12)  50.666667         152<br/>## 6     9   10         90 high speed      [0,12)  36.333333         109<br/>##         dist_cat<br/>## 1 small distance<br/>## 2 small distance<br/>## 3 small distance<br/>## 4   big distance<br/>## 5   big distance<br/>## 6 small distance</span></pre><ul class=""><li id="9dec" class="ng nh it lt b lu mn lx mo ma ni me nj mi nk mm nu nm nn no bi translated">要检查变量的格式:</li></ul><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="a953" class="na la it mv b gy nb nc l nd ne">class(dat$dist_cat)</span><span id="7fb2" class="na la it mv b gy nf nc l nd ne">## [1] "factor"</span><span id="e30f" class="na la it mv b gy nf nc l nd ne"># or<br/>str(dat$dist_cat)</span><span id="eec8" class="na la it mv b gy nf nc l nd ne">##  Factor w/ 2 levels "small distance",..: 1 1 1 2 2 1 2 2 2 2 ...</span></pre><p id="03fa" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">如果您只需要格式化有限数量的变量，这就足够了。但是，如果您需要对大量的分类变量执行此操作，那么多次编写相同的代码很快就会变得非常耗时。正如您所想象的，使用<code class="fe ms mt mu mv b">within()</code>命令格式化许多变量而不必逐个为每个变量编写完整的代码是可能的:</p><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="30ea" class="na la it mv b gy nb nc l nd ne">dat &lt;- within(dat, {<br/>  speed_cat &lt;- factor(speed_cat, labels = c(<br/>    "high speed",<br/>    "low speed"<br/>  ))<br/>  dist_cat &lt;- factor(dist_cat, labels = c(<br/>    "small distance",<br/>    "big distance"<br/>  ))<br/>})</span><span id="af0a" class="na la it mv b gy nf nc l nd ne">head(dat)</span><span id="b5c4" class="na la it mv b gy nf nc l nd ne">##   speed dist speed_dist  speed_cat speed_quali mean_score total_score<br/>## 1     4    2          8  low speed      [0,12)   4.666667          14<br/>## 2     4   10         40  low speed      [0,12)  18.000000          54<br/>## 3     7    4         28  low speed      [0,12)  13.000000          39<br/>## 4     7   22        154  low speed      [0,12)  61.000000         183<br/>## 5     8   16        128 high speed      [0,12)  50.666667         152<br/>## 6     9   10         90 high speed      [0,12)  36.333333         109<br/>##         dist_cat<br/>## 1 small distance<br/>## 2 small distance<br/>## 3 small distance<br/>## 4   big distance<br/>## 5   big distance<br/>## 6 small distance</span><span id="40e3" class="na la it mv b gy nf nc l nd ne">str(dat)</span><span id="c268" class="na la it mv b gy nf nc l nd ne">## 'data.frame':    50 obs. of  8 variables:<br/>##  $ speed      : num  4 4 7 7 8 9 10 10 10 11 ...<br/>##  $ dist       : num  2 10 4 22 16 10 18 26 34 17 ...<br/>##  $ speed_dist : num  8 40 28 154 128 90 180 260 340 187 ...<br/>##  $ speed_cat  : Factor w/ 2 levels "high speed","low speed": 2 2 2 2 1 1 1 1 1 1 ...<br/>##  $ speed_quali: Factor w/ 4 levels "[0,12)","[12,15)",..: 1 1 1 1 1 1 1 1 1 1 ...<br/>##  $ mean_score : num  4.67 18 13 61 50.67 ...<br/>##  $ total_score: num  14 54 39 183 152 109 208 296 384 215 ...<br/>##  $ dist_cat   : Factor w/ 2 levels "small distance",..: 1 1 1 2 2 1 2 2 2 2 ...</span></pre><p id="09de" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">或者，如果您想在不改变标签的情况下将几个数值变量转换成分类变量，最好使用<code class="fe ms mt mu mv b">transform()</code>函数。我们用来自<code class="fe ms mt mu mv b"><a class="ae ky" href="https://statsandr.com/blog/graphics-in-r-with-ggplot2/" rel="noopener ugc nofollow" target="_blank">{ggplot2}</a></code>包的<code class="fe ms mt mu mv b">mpg</code>数据帧来说明该功能:</p><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="9704" class="na la it mv b gy nb nc l nd ne">library(ggplot2)<br/>mpg &lt;- transform(mpg,<br/>  cyl = factor(cyl),<br/>  drv = factor(drv),<br/>  fl = factor(fl),<br/>  class = factor(class)<br/>)</span></pre><h1 id="6060" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">记录分类变量</h1><p id="8846" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">如果您对当前标签不满意，可以对分类变量的标签进行重新编码。在本例中，我们将标签更改如下:</p><ul class=""><li id="63a9" class="ng nh it lt b lu mn lx mo ma ni me nj mi nk mm nu nm nn no bi translated">“小距离”变成“短距离”</li><li id="8b82" class="ng nh it lt b lu np lx nq ma nr me ns mi nt mm nu nm nn no bi translated">“大距离”变成了“大距离”</li></ul><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="2572" class="na la it mv b gy nb nc l nd ne">dat$dist_cat &lt;- recode(dat$dist_cat,<br/>  "small distance" = "short distance",<br/>  "big distance" = "large distance"<br/>)</span><span id="d52f" class="na la it mv b gy nf nc l nd ne">head(dat)</span><span id="7134" class="na la it mv b gy nf nc l nd ne">##   speed dist speed_dist  speed_cat speed_quali mean_score total_score<br/>## 1     4    2          8  low speed      [0,12)   4.666667          14<br/>## 2     4   10         40  low speed      [0,12)  18.000000          54<br/>## 3     7    4         28  low speed      [0,12)  13.000000          39<br/>## 4     7   22        154  low speed      [0,12)  61.000000         183<br/>## 5     8   16        128 high speed      [0,12)  50.666667         152<br/>## 6     9   10         90 high speed      [0,12)  36.333333         109<br/>##         dist_cat<br/>## 1 short distance<br/>## 2 short distance<br/>## 3 short distance<br/>## 4 large distance<br/>## 5 large distance<br/>## 6 short distance</span></pre><h1 id="301f" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">更改参考水平</h1><p id="c153" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">对于某些分析，您可能想要更改级别的顺序。例如，如果您正在分析关于对照组和治疗组的数据，您可能希望将对照组设置为参考组。默认情况下，级别按字母顺序排序，如果从数值更改为因子，则按其数值排序。</p><ul class=""><li id="10f6" class="ng nh it lt b lu mn lx mo ma ni me nj mi nk mm nu nm nn no bi translated">要检查级别的当前顺序(第一个级别为参考级别):</li></ul><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="3f8b" class="na la it mv b gy nb nc l nd ne">levels(dat$dist_cat)</span><span id="a730" class="na la it mv b gy nf nc l nd ne">## [1] "short distance" "large distance"</span></pre><p id="2f4f" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在这种情况下，“短距离”是第一个级别，它是参考级别。这是第一个级别，因为在创建变量时，它最初被设置为等于 1 的值。</p><ul class=""><li id="abfd" class="ng nh it lt b lu mn lx mo ma ni me nj mi nk mm nu nm nn no bi translated">要更改参考电平:</li></ul><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="0b2a" class="na la it mv b gy nb nc l nd ne">dat$dist_cat &lt;- relevel(dat$dist_cat, ref = "large distance")</span><span id="17b8" class="na la it mv b gy nf nc l nd ne">levels(dat$dist_cat)</span><span id="95f5" class="na la it mv b gy nf nc l nd ne">## [1] "large distance" "short distance"</span></pre><p id="865a" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">大距离现在是第一级，因此也是参考级。</p><h1 id="3002" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">重命名变量名</h1><p id="1d91" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">要重命名变量名，如下所示:</p><ul class=""><li id="bf21" class="ng nh it lt b lu mn lx mo ma ni me nj mi nk mm nu nm nn no bi translated">距离→距离</li><li id="e9ac" class="ng nh it lt b lu np lx nq ma nr me ns mi nt mm nu nm nn no bi translated">速度 _ 距离→速度 _ 距离</li><li id="d3e8" class="ng nh it lt b lu np lx nq ma nr me ns mi nt mm nu nm nn no bi translated">距离 _ 猫→距离 _ 猫</li></ul><p id="ebe3" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">使用<code class="fe ms mt mu mv b">dplyr</code>包中的<code class="fe ms mt mu mv b">rename()</code>命令:</p><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="3dde" class="na la it mv b gy nb nc l nd ne">dat &lt;- rename(dat,<br/>  distance = dist,<br/>  speed_distance = speed_dist,<br/>  distance_cat = dist_cat<br/>)</span><span id="fc25" class="na la it mv b gy nf nc l nd ne">names(dat) # display variable names</span><span id="835d" class="na la it mv b gy nf nc l nd ne">## [1] "speed"          "distance"       "speed_distance" "speed_cat"     <br/>## [5] "speed_quali"    "mean_score"     "total_score"    "distance_cat"</span></pre><h1 id="83cd" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">手动创建数据框</h1><p id="5325" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">尽管大多数分析是在导入的数据框上执行的，但也可以直接在 R:</p><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="9717" class="na la it mv b gy nb nc l nd ne"># Create the data frame named dat with 2 variables<br/>dat &lt;- data.frame(<br/>  "variable1" = c(6, 12, NA, 3), # presence of 1 missing value (NA)<br/>  "variable2" = c(3, 7, 9, 1)<br/>)</span><span id="0ed2" class="na la it mv b gy nf nc l nd ne"># Print the data frame<br/>dat</span><span id="1717" class="na la it mv b gy nf nc l nd ne">##   variable1 variable2<br/>## 1         6         3<br/>## 2        12         7<br/>## 3        NA         9<br/>## 4         3         1</span></pre><h1 id="7eda" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">合并两个数据帧</h1><p id="dbdc" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">默认情况下，合并是在公共变量(同名的变量)上完成的。但是，如果它们没有相同的名称，仍然可以通过指定名称来合并这两个数据框:</p><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="7f00" class="na la it mv b gy nb nc l nd ne">dat1 &lt;- data.frame(<br/>  person = c(1:4),<br/>  treatment = c("T1", "T2")<br/>)</span><span id="cddb" class="na la it mv b gy nf nc l nd ne">dat1</span><span id="a12c" class="na la it mv b gy nf nc l nd ne">##   person treatment<br/>## 1      1        T1<br/>## 2      2        T2<br/>## 3      3        T1<br/>## 4      4        T2</span><span id="f1a7" class="na la it mv b gy nf nc l nd ne">dat2 &lt;- data.frame(<br/>  patient = c(1:4),<br/>  age = c(56, 23, 32, 19),<br/>  gender = c("M", "F", "F", "M")<br/>)</span><span id="9c39" class="na la it mv b gy nf nc l nd ne">dat2</span><span id="a63e" class="na la it mv b gy nf nc l nd ne">##   patient age gender<br/>## 1       1  56      M<br/>## 2       2  23      F<br/>## 3       3  32      F<br/>## 4       4  19      M</span></pre><p id="1768" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我们想通过主题编号来合并两个数据帧，但是这个编号在第一个数据帧中被称为<code class="fe ms mt mu mv b">person</code>，在第二个数据帧中被称为<code class="fe ms mt mu mv b">patient</code>，所以我们需要指出它:</p><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="022f" class="na la it mv b gy nb nc l nd ne">merge(<br/>  x = dat1, y = dat2,<br/>  by.x = "person", by.y = "patient",<br/>  all = TRUE<br/>)</span><span id="e7a4" class="na la it mv b gy nf nc l nd ne">##   person treatment age gender<br/>## 1      1        T1  56      M<br/>## 2      2        T2  23      F<br/>## 3      3        T1  32      F<br/>## 4      4        T2  19      M</span></pre><h1 id="276a" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">从另一个数据框添加新观测值</h1><p id="c22e" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">为了从另一个数据框中添加新的观测值，这两个数据框需要具有相同的列名(但它们的顺序可以不同):</p><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="09c9" class="na la it mv b gy nb nc l nd ne">dat1</span><span id="567c" class="na la it mv b gy nf nc l nd ne">##   person treatment<br/>## 1      1        T1<br/>## 2      2        T2<br/>## 3      3        T1<br/>## 4      4        T2</span><span id="648d" class="na la it mv b gy nf nc l nd ne">dat3 &lt;- data.frame(<br/>  person = 5:8,<br/>  treatment = c("T3")<br/>)</span><span id="ef43" class="na la it mv b gy nf nc l nd ne">dat3</span><span id="222f" class="na la it mv b gy nf nc l nd ne">##   person treatment<br/>## 1      5        T3<br/>## 2      6        T3<br/>## 3      7        T3<br/>## 4      8        T3</span><span id="cade" class="na la it mv b gy nf nc l nd ne">rbind(dat1, dat3) # r stands for row, so we bind data frames by row</span><span id="f99f" class="na la it mv b gy nf nc l nd ne">##   person treatment<br/>## 1      1        T1<br/>## 2      2        T2<br/>## 3      3        T1<br/>## 4      4        T2<br/>## 5      5        T3<br/>## 6      6        T3<br/>## 7      7        T3<br/>## 8      8        T3</span></pre><p id="992e" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">如您所见，数据帧<code class="fe ms mt mu mv b">dat1</code>的末尾添加了 5 至 8 人的数据(因为<code class="fe ms mt mu mv b">rbind()</code>函数中<code class="fe ms mt mu mv b">dat1</code>在<code class="fe ms mt mu mv b">dat3</code>之前)。</p><h1 id="a768" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">从另一个数据框添加新变量</h1><p id="bd3b" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">也可以使用<code class="fe ms mt mu mv b">cbind()</code>功能向数据帧添加新变量。与<code class="fe ms mt mu mv b">rbind()</code>不同，列名不必相同，因为它们是相邻添加的:</p><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="4369" class="na la it mv b gy nb nc l nd ne">dat2</span><span id="82d7" class="na la it mv b gy nf nc l nd ne">##   patient age gender<br/>## 1       1  56      M<br/>## 2       2  23      F<br/>## 3       3  32      F<br/>## 4       4  19      M</span><span id="9b23" class="na la it mv b gy nf nc l nd ne">dat3</span><span id="dc2b" class="na la it mv b gy nf nc l nd ne">##   person treatment<br/>## 1      5        T3<br/>## 2      6        T3<br/>## 3      7        T3<br/>## 4      8        T3</span><span id="12e6" class="na la it mv b gy nf nc l nd ne">cbind(dat2, dat3) # c stands for column, so we bind data frames by column</span><span id="de67" class="na la it mv b gy nf nc l nd ne">##   patient age gender person treatment<br/>## 1       1  56      M      5        T3<br/>## 2       2  23      F      6        T3<br/>## 3       3  32      F      7        T3<br/>## 4       4  19      M      8        T3</span></pre><p id="a855" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">如果只想添加另一个数据框中的特定变量:</p><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="a26d" class="na la it mv b gy nb nc l nd ne">dat_cbind &lt;- cbind(dat2, dat3$treatment)</span><span id="ea2d" class="na la it mv b gy nf nc l nd ne">dat_cbind</span><span id="06fe" class="na la it mv b gy nf nc l nd ne">##   patient age gender dat3$treatment<br/>## 1       1  56      M             T3<br/>## 2       2  23      F             T3<br/>## 3       3  32      F             T3<br/>## 4       4  19      M             T3</span><span id="a3a9" class="na la it mv b gy nf nc l nd ne">names(dat_cbind)[4] &lt;- "treatment"</span><span id="90db" class="na la it mv b gy nf nc l nd ne">dat_cbind</span><span id="a2e6" class="na la it mv b gy nf nc l nd ne">##   patient age gender treatment<br/>## 1       1  56      M        T3<br/>## 2       2  23      F        T3<br/>## 3       3  32      F        T3<br/>## 4       4  19      M        T3</span></pre><p id="d7ac" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">或者更简单地用<code class="fe ms mt mu mv b">data.frame()</code>功能:</p><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="7d14" class="na la it mv b gy nb nc l nd ne">data.frame(dat2,<br/>  treatment = dat3$treatment<br/>)</span><span id="90ce" class="na la it mv b gy nf nc l nd ne">##   patient age gender treatment<br/>## 1       1  56      M        T3<br/>## 2       2  23      F        T3<br/>## 3       3  32      F        T3<br/>## 4       4  19      M        T3</span></pre><h1 id="1e42" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">缺少值</h1><p id="7b4b" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">缺失值(在 RStudio 中用 NA 表示，表示“不适用”)对于许多分析来说通常是有问题的，因为包括缺失值的许多计算结果都有缺失值。</p><p id="3425" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">例如，具有至少一个 NA 的系列或变量的平均值将给出 NA 结果。上一节创建的数据帧<code class="fe ms mt mu mv b">dat</code>用于本例:</p><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="f1b6" class="na la it mv b gy nb nc l nd ne">dat</span><span id="a331" class="na la it mv b gy nf nc l nd ne">##   variable1 variable2<br/>## 1         6         3<br/>## 2        12         7<br/>## 3        NA         9<br/>## 4         3         1</span><span id="af5a" class="na la it mv b gy nf nc l nd ne">mean(dat$variable1)</span><span id="ddb9" class="na la it mv b gy nf nc l nd ne">## [1] NA</span></pre><p id="c4e3" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><code class="fe ms mt mu mv b">na.omit()</code>函数避免 NA 结果，就像没有丢失值一样:</p><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="658b" class="na la it mv b gy nb nc l nd ne">mean(na.omit(dat$variable1))</span><span id="acf5" class="na la it mv b gy nf nc l nd ne">## [1] 7</span></pre><p id="45b0" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">此外，大多数基本函数都包含一个处理缺失值的参数:</p><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="71e1" class="na la it mv b gy nb nc l nd ne">mean(dat$variable1, na.rm = TRUE)</span><span id="b393" class="na la it mv b gy nf nc l nd ne">## [1] 7</span></pre><p id="42b1" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><code class="fe ms mt mu mv b">is.na()</code>表示某个元素是否为缺失值:</p><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="adb2" class="na la it mv b gy nb nc l nd ne">is.na(dat)</span><span id="5af6" class="na la it mv b gy nf nc l nd ne">##      variable1 variable2<br/>## [1,]     FALSE     FALSE<br/>## [2,]     FALSE     FALSE<br/>## [3,]      TRUE     FALSE<br/>## [4,]     FALSE     FALSE</span></pre><p id="6e6e" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">请注意，字符串形式的“NA”不会被视为缺失值:</p><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="ac6c" class="na la it mv b gy nb nc l nd ne">y &lt;- c("NA", "2")</span><span id="f8ae" class="na la it mv b gy nf nc l nd ne">is.na(y)</span><span id="d464" class="na la it mv b gy nf nc l nd ne">## [1] FALSE FALSE</span></pre><p id="2f5d" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">要检查矢量或数据帧中是否至少有一个值缺失:</p><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="be80" class="na la it mv b gy nb nc l nd ne">anyNA(dat$variable2) # check for NA in variable2</span><span id="3bbd" class="na la it mv b gy nf nc l nd ne">## [1] FALSE</span><span id="6f80" class="na la it mv b gy nf nc l nd ne">anyNA(dat) # check for NA in the whole data frame</span><span id="a222" class="na la it mv b gy nf nc l nd ne">## [1] TRUE</span><span id="2cc3" class="na la it mv b gy nf nc l nd ne"># or<br/>any(is.na(dat)) # check for NA in the whole data frame</span><span id="1cbd" class="na la it mv b gy nf nc l nd ne">## [1] TRUE</span></pre><p id="a66b" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">尽管如此，对于某些类型的分析来说，使用 NAs 的数据帧仍然存在问题。有几种方法可以去除或估算缺失值。</p><h1 id="d96c" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">删除 NAs</h1><p id="ee30" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">一个简单的解决方案是删除至少包含一个缺失值的所有观察值(即行)。这是通过仅保留完整案例的观察结果来实现的:</p><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="6177" class="na la it mv b gy nb nc l nd ne">dat_complete &lt;- dat[complete.cases(dat), ]<br/>dat_complete</span><span id="03f1" class="na la it mv b gy nf nc l nd ne">##   variable1 variable2<br/>## 1         6         3<br/>## 2        12         7<br/>## 4         3         1</span></pre><p id="64b9" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">删除有缺失值的观测值时要小心，尤其是缺失值不是“随机缺失”的情况。这并不是因为删除它们是可能的(也是容易的),而是因为您应该在所有情况下都这样做。然而，这超出了本文的范围。</p><h1 id="86bd" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">估算 NAs</h1><p id="8564" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">除了删除至少有一个 NA 的观测值之外，还可以对它们进行估算，也就是说，用变量的中值或众数等值来替换它们。这可以通过包<code class="fe ms mt mu mv b">imputeMissings</code>中的命令<code class="fe ms mt mu mv b">impute()</code>轻松完成:</p><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="8a11" class="na la it mv b gy nb nc l nd ne">library(imputeMissings)</span><span id="2f3f" class="na la it mv b gy nf nc l nd ne">dat_imputed &lt;- impute(dat) # default method is median/mode<br/>dat_imputed</span><span id="fe9e" class="na la it mv b gy nf nc l nd ne">##   variable1 variable2<br/>## 1         6         3<br/>## 2        12         7<br/>## 3         6         9<br/>## 4         3         1</span></pre><p id="7c04" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">当使用中值/众数方法(默认)时，字符向量和因子用众数估算。数字和整数向量用中位数估算。再次，小心使用插补。其他软件包提供更先进的插补技术。然而，我们保持这篇文章简单明了，因为高级插补超出了 r。</p><h1 id="1783" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">规模</h1><p id="a7bf" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated"><a class="ae ky" href="https://statsandr.com/blog/do-my-data-follow-a-normal-distribution-a-note-on-the-most-widely-used-distribution-and-how-to-test-for-normality-in-r/#probabilities-and-standard-normal-distribution" rel="noopener ugc nofollow" target="_blank">缩放</a>(也称为标准化)当一个数据帧的变量具有不同的单位时，变量通常用在主成分分析(PCA) <a class="ae ky" href="https://statsandr.com/blog/data-manipulation-in-r/#fn1" rel="noopener ugc nofollow" target="_blank"> 1 </a>之前。请记住，缩放变量意味着它将计算该变量的平均值和标准差。然后，通过减去该变量的平均值并除以该变量的标准偏差来“缩放”该变量的每个值(即每行)。形式上:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nz"><img src="../Images/c317626e1dcaeb1cce59b8e564f9d8e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:240/format:webp/1*iWjcY8lFP_mrfYeCk2KUbA.png"/></div></figure><p id="53f6" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">其中 xbar 和 s 分别是变量的平均值和标准差。</p><p id="6ea1" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">使用<code class="fe ms mt mu mv b">scale()</code>缩放 R 中的一个或多个变量:</p><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="b75f" class="na la it mv b gy nb nc l nd ne">dat_scaled &lt;- scale(dat_imputed)</span><span id="807c" class="na la it mv b gy nf nc l nd ne">head(dat_scaled)</span><span id="3c6a" class="na la it mv b gy nf nc l nd ne">##       variable1  variable2<br/>## [1,] -0.1986799 -0.5477226<br/>## [2,]  1.3907590  0.5477226<br/>## [3,] -0.1986799  1.0954451<br/>## [4,] -0.9933993 -1.0954451</span></pre><h1 id="5845" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">日期和时间</h1><h1 id="630f" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">日期</h1><p id="4aa6" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">在 R 中，默认的日期格式遵循 ISO 8601 国际标准的规则，该标准将一天表示为“2001–02–13”(yyyy-mm-DD)。<a class="ae ky" href="https://statsandr.com/blog/data-manipulation-in-r/#fn2" rel="noopener ugc nofollow" target="_blank"> 2 </a></p><p id="0a9b" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">日期可以由字符串或数字定义。比如 2016 年 10 月 1 日:</p><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="6bd0" class="na la it mv b gy nb nc l nd ne">as.Date("01/10/16", format = "%d/%m/%y")</span><span id="e171" class="na la it mv b gy nf nc l nd ne">## [1] "2016-10-01"</span><span id="f0cd" class="na la it mv b gy nf nc l nd ne">as.Date(274, origin = "2016-01-01") # there are 274 days between the origin and October 1st, 2016</span><span id="6e72" class="na la it mv b gy nf nc l nd ne">## [1] "2016-10-01"</span></pre><h1 id="3342" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">英国泰晤士报(1785 年创刊)</h1><p id="edc7" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">日期和时间向量的示例:</p><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="1fa2" class="na la it mv b gy nb nc l nd ne">dates &lt;- c("02/27/92", "02/27/99", "01/14/92")<br/>times &lt;- c("23:03:20", "22:29:56", "01:03:30")</span><span id="0952" class="na la it mv b gy nf nc l nd ne">x &lt;- paste(dates, times)<br/>x</span><span id="ed12" class="na la it mv b gy nf nc l nd ne">## [1] "02/27/92 23:03:20" "02/27/99 22:29:56" "01/14/92 01:03:30"</span><span id="bc40" class="na la it mv b gy nf nc l nd ne">strptime(x,<br/>  format = "%m/%d/%y %H:%M:%S"<br/>)</span><span id="1a0e" class="na la it mv b gy nf nc l nd ne">## [1] "1992-02-27 23:03:20 CET" "1999-02-27 22:29:56 CET"<br/>## [3] "1992-01-14 01:03:30 CET"</span></pre><p id="a59e" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">找到更多关于如何用<code class="fe ms mt mu mv b">help(strptime)</code>表达日期和时间格式的信息。</p><h1 id="8b5f" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">从枣中提取</h1><p id="50ae" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">我们可以提取:</p><ul class=""><li id="7d80" class="ng nh it lt b lu mn lx mo ma ni me nj mi nk mm nu nm nn no bi translated">平日</li><li id="ff22" class="ng nh it lt b lu np lx nq ma nr me ns mi nt mm nu nm nn no bi translated">月份</li><li id="86d7" class="ng nh it lt b lu np lx nq ma nr me ns mi nt mm nu nm nn no bi translated">四分之一</li><li id="8963" class="ng nh it lt b lu np lx nq ma nr me ns mi nt mm nu nm nn no bi translated">年</li></ul><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="4918" class="na la it mv b gy nb nc l nd ne">y &lt;- strptime(x,<br/>  format = "%m/%d/%y %H:%M:%S"<br/>)</span><span id="5fab" class="na la it mv b gy nf nc l nd ne">y</span><span id="91e0" class="na la it mv b gy nf nc l nd ne">## [1] "1992-02-27 23:03:20 CET" "1999-02-27 22:29:56 CET"<br/>## [3] "1992-01-14 01:03:30 CET"</span><span id="564c" class="na la it mv b gy nf nc l nd ne">weekdays(y, abbreviate = FALSE)</span><span id="2e87" class="na la it mv b gy nf nc l nd ne">## [1] "Thursday" "Saturday" "Tuesday"</span><span id="9533" class="na la it mv b gy nf nc l nd ne">months(y, abbreviate = FALSE)</span><span id="cc4d" class="na la it mv b gy nf nc l nd ne">## [1] "February" "February" "January"</span><span id="7e51" class="na la it mv b gy nf nc l nd ne">quarters(y, abbreviate = FALSE)</span><span id="91b8" class="na la it mv b gy nf nc l nd ne">## [1] "Q1" "Q1" "Q1"</span><span id="3078" class="na la it mv b gy nf nc l nd ne">format(y, "%Y") # 4-digit year</span><span id="8d87" class="na la it mv b gy nf nc l nd ne">## [1] "1992" "1999" "1992"</span><span id="bfc8" class="na la it mv b gy nf nc l nd ne">format(y, "%y") # 2-digit year</span><span id="ff81" class="na la it mv b gy nf nc l nd ne">## [1] "92" "99" "92"</span></pre><h1 id="1105" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">导出和保存</h1><p id="d14e" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">如果复制粘贴还不够，您可以用<code class="fe ms mt mu mv b">save()</code>保存一个 R 格式的对象:</p><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="f806" class="na la it mv b gy nb nc l nd ne">save(dat, file = "dat.Rdata")</span></pre><p id="bba0" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">或者使用<code class="fe ms mt mu mv b">write.table()</code>或<code class="fe ms mt mu mv b">write.csv()</code>:</p><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="6a55" class="na la it mv b gy nb nc l nd ne">write.table(dat, "filename", row = FALSE, sep = "\t", quote = FALSE)</span></pre><p id="757b" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">如果您需要将每个结果发送到一个文件而不是控制台:</p><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="87d7" class="na la it mv b gy nb nc l nd ne">sink("filename")</span></pre><p id="5e16" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">(别忘了用<code class="fe ms mt mu mv b">sink()</code>阻止它。)</p><h1 id="38f3" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">寻求帮助</h1><p id="e621" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">您总能找到一些关于以下方面的帮助:</p><ul class=""><li id="6f2e" class="ng nh it lt b lu mn lx mo ma ni me nj mi nk mm nu nm nn no bi translated">一个功能:<code class="fe ms mt mu mv b">?function</code>或<code class="fe ms mt mu mv b">help(function)</code></li><li id="f003" class="ng nh it lt b lu np lx nq ma nr me ns mi nt mm nu nm nn no bi translated">一包:<code class="fe ms mt mu mv b">help(package = packagename)</code></li><li id="cc2d" class="ng nh it lt b lu np lx nq ma nr me ns mi nt mm nu nm nn no bi translated">一个概念:<code class="fe ms mt mu mv b">help.search("concept")</code>还是<code class="fe ms mt mu mv b">apropos("concept")</code></li></ul><p id="c03f" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">否则，谷歌就是你最好的朋友！</p><p id="d8d7" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">感谢阅读。我希望这篇文章能帮助你在 RStudio 中操作数据。现在您已经知道了如何将数据帧导入 R 以及如何操作它，下一步可能是学习如何在 R 中执行<a class="ae ky" href="https://statsandr.com/blog/descriptive-statistics-in-r/" rel="noopener ugc nofollow" target="_blank">描述性统计。如果您正在使用 R 寻找更高级的统计分析，请参阅所有关于 R </a>的文章。</p><p id="79cd" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">和往常一样，如果您有与本文主题相关的问题或建议，请将其添加为评论，以便其他读者可以从讨论中受益。</p></div><div class="ab cl oa ob hx oc" role="separator"><span class="od bw bk oe of og"/><span class="od bw bk oe of og"/><span class="od bw bk oe of"/></div><div class="im in io ip iq"><ol class=""><li id="e75e" class="ng nh it lt b lu mn lx mo ma ni me nj mi nk mm nl nm nn no bi translated">主成分分析(PCA)是一种用于探索性数据分析的有用技术，允许更好地可视化具有大量变量的数据框架中存在的变化。当有许多变量时，数据不容易用原始格式表示出来。为了应对这种情况，PCA 采用具有许多变量的数据帧，并通过将原始变量转换成较少数量的“主成分”来简化它。第一个维度包含数据框中的最大方差，依此类推，维度之间不相关。请注意，PCA 是对数量变量进行的。<a class="ae ky" href="https://statsandr.com/blog/data-manipulation-in-r/#fnref1" rel="noopener ugc nofollow" target="_blank"> ↩︎ </a></li><li id="2388" class="ng nh it lt b lu np lx nq ma nr me ns mi nt mm nl nm nn no bi translated">请注意，每个软件的日期格式不尽相同！例如，Excel 使用不同的格式。<a class="ae ky" href="https://statsandr.com/blog/data-manipulation-in-r/#fnref2" rel="noopener ugc nofollow" target="_blank"> ↩︎ </a></li></ol><h1 id="232d" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">相关文章</h1><ul class=""><li id="b990" class="ng nh it lt b lu lv lx ly ma nw me nx mi ny mm nu nm nn no bi translated"><a class="ae ky" href="https://statsandr.com/blog/data-types-in-r/" rel="noopener ugc nofollow" target="_blank">R 中的数据类型</a></li><li id="e9f1" class="ng nh it lt b lu np lx nq ma nr me ns mi nt mm nu nm nn no bi translated"><a class="ae ky" href="https://statsandr.com/blog/how-to-import-an-excel-file-in-rstudio/" rel="noopener ugc nofollow" target="_blank">如何在 RStudio 中导入 Excel 文件？</a></li><li id="cdc6" class="ng nh it lt b lu np lx nq ma nr me ns mi nt mm nu nm nn no bi translated"><a class="ae ky" href="https://statsandr.com/blog/how-to-install-r-and-rstudio/" rel="noopener ugc nofollow" target="_blank">如何安装 R 和 RStudio？</a></li><li id="dfda" class="ng nh it lt b lu np lx nq ma nr me ns mi nt mm nu nm nn no bi translated"><a class="ae ky" href="https://statsandr.com/blog/hypothesis-test-by-hand/" rel="noopener ugc nofollow" target="_blank">手工假设检验</a></li><li id="bde0" class="ng nh it lt b lu np lx nq ma nr me ns mi nt mm nu nm nn no bi translated"><a class="ae ky" href="https://statsandr.com/blog/anova-in-r/" rel="noopener ugc nofollow" target="_blank">R 中的方差分析</a></li></ul></div><div class="ab cl oa ob hx oc" role="separator"><span class="od bw bk oe of og"/><span class="od bw bk oe of og"/><span class="od bw bk oe of"/></div><div class="im in io ip iq"><p id="279a" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><em class="oh">原载于 2019 年 12 月 24 日</em><a class="ae ky" href="https://statsandr.com/blog/data-manipulation-in-r/" rel="noopener ugc nofollow" target="_blank"><em class="oh">https://statsandr.com</em></a><em class="oh">。</em></p></div></div>    
</body>
</html>