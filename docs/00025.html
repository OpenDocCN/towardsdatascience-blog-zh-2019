<html>
<head>
<title>Chaos Game Representation of a genetic sequence</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">遗传序列的混沌博弈表示</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/chaos-game-representation-of-a-genetic-sequence-4681f1a67e14?source=collection_archive---------14-----------------------#2019-01-02">https://towardsdatascience.com/chaos-game-representation-of-a-genetic-sequence-4681f1a67e14?source=collection_archive---------14-----------------------#2019-01-02</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div class="gh gi jn"><img src="../Images/e2efa63998ff2533c9fbea2608263525.png" data-original-src="https://miro.medium.com/v2/resize:fit:1188/format:webp/1*ZkKPoiD1STqbmWGH0jrcIA.png"/></div></figure><blockquote class="ju jv jw"><p id="918c" class="jx jy jz ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这是我关于生物信息学领域的第二篇文章，我们将一个基因序列呈现为一个混沌游戏表示图。通过这一系列的文章，我希望我能让更多的人对生物信息学感兴趣。</p></blockquote><p id="ffaf" class="pw-post-body-paragraph jx jy iq ka b kb kc kd ke kf kg kh ki kw kk kl km kx ko kp kq ky ks kt ku kv ij bi translated">混沌游戏表示是一个序列的图形表示。这是一种将长的一维序列(在我们的例子中是基因序列)转换成图形形式的方法。这是一种新的整体方法，提供了一个 DNA 序列的视觉图像，与传统的核苷酸线性排列完全不同。CGR 可以识别核苷酸序列中的模式，这些模式是使用分形结构技术，通过将 DNA 序列视为由 A、T、C 和 g 四个单元组成的字符串，从一类基因的数据库中获得的</p><p id="afc3" class="pw-post-body-paragraph jx jy iq ka b kb kc kd ke kf kg kh ki kw kk kl km kx ko kp kq ky ks kt ku kv ij bi translated">这种模式识别依赖于视觉识别。它是非随机输入在迭代函数系统中的应用。该方法最初是针对 DNA 序列提出的，现在正被用于任何任意符号。CGR 展示了基因组的显著模式特征。由于模式对基因组来说是独特的，这可以用来识别基因组片段或检测水平基因转移。此外，CGR 模式的定量分析可用于序列比较，用 CGR 进行无比对和基于比对的序列比较都是可能的。</p><p id="8bea" class="pw-post-body-paragraph jx jy iq ka b kb kc kd ke kf kg kh ki kw kk kl km kx ko kp kq ky ks kt ku kv ij bi translated">这就是科学介绍，现在让我们从基础开始。核苷酸是一种分子，当它们结合在一起时，构成了核酸 RNA 和 DNA 的单个结构单元。我们有四种不同的核苷酸。腺嘌呤(A)、胸腺嘧啶(T)、胞嘧啶(C)、鸟嘌呤(G)。为了配合化学反应，这里有一些化学公式:</p><figure class="la lb lc ld gt jr gh gi paragraph-image"><div class="gh gi kz"><img src="../Images/acfdc35a9c91e94db77cdae712e9b759.png" data-original-src="https://miro.medium.com/v2/resize:fit:706/format:webp/1*ACFkws6MXLa-jcaeZvwlzw.jpeg"/></div><figcaption class="le lf gj gh gi lg lh bd b be z dk">Our respective actors in this article, adenine, thymine, guanine and cytosine.</figcaption></figure><p id="17e5" class="pw-post-body-paragraph jx jy iq ka b kb kc kd ke kf kg kh ki kw kk kl km kx ko kp kq ky ks kt ku kv ij bi translated">在我们的例子中，我们将分析生物序列，更具体地说，DNA 序列。生物序列被定义为:</p><figure class="la lb lc ld gt jr gh gi paragraph-image"><div class="gh gi li"><img src="../Images/1d0d978b330735354306c057fe3a6b85.png" data-original-src="https://miro.medium.com/v2/resize:fit:870/0*n2ff_a2tavVTQjWK"/></div></figure><p id="2ba8" class="pw-post-body-paragraph jx jy iq ka b kb kc kd ke kf kg kh ki kw kk kl km kx ko kp kq ky ks kt ku kv ij bi translated">由于我们将分析 DNA，我们的序列将被定义为:</p><figure class="la lb lc ld gt jr gh gi paragraph-image"><div class="gh gi lj"><img src="../Images/96d3ad656cac0033050c7f6e73b3aa3f.png" data-original-src="https://miro.medium.com/v2/resize:fit:238/0*UZeB1DoKd8Oe6pJw"/></div></figure><p id="f530" class="pw-post-body-paragraph jx jy iq ka b kb kc kd ke kf kg kh ki kw kk kl km kx ko kp kq ky ks kt ku kv ij bi translated">为了开始绘制我们的混沌游戏表示，我们必须先计算我们的 k-mers。什么是 k-mers？术语 k-mer(或 x-mer，其中 x 实际上可以是任何选择的辅音)通常指核酸或氨基酸序列的特定 n-元组或 n-gram，其可用于识别生物分子如 DNA(用于基因预测)或蛋白质中的某些区域。这样的 k-mer 串可以用于寻找感兴趣的区域，或者使用给出许多可能的 k-mer 组合(或者具有重复的排列)的离散概率分布的 k-mer 统计。特定的短 k-聚体被称为寡聚物或简称“寡聚物”。为了简单地解释这一点，让我们看一个简短的序列</p><figure class="la lb lc ld gt jr gh gi paragraph-image"><div class="gh gi lk"><img src="../Images/f08cc3dc4ef9c405da77b5ffaf37e726.png" data-original-src="https://miro.medium.com/v2/resize:fit:210/0*JUXc-lLGYd7MtE5O"/></div></figure><p id="bf30" class="pw-post-body-paragraph jx jy iq ka b kb kc kd ke kf kg kh ki kw kk kl km kx ko kp kq ky ks kt ku kv ij bi translated">所以如果我们计算 1 聚体的数量，那只是核苷酸出现的数量。因此，在我们的示例中，出现的情况是:</p><figure class="la lb lc ld gt jr gh gi paragraph-image"><div class="gh gi ll"><img src="../Images/af804de64b9c12dce1d44f88606bd058.png" data-original-src="https://miro.medium.com/v2/resize:fit:104/0*7K30JylTWWzI_1g8"/></div></figure><p id="b03d" class="pw-post-body-paragraph jx jy iq ka b kb kc kd ke kf kg kh ki kw kk kl km kx ko kp kq ky ks kt ku kv ij bi translated">在我们写算法之前，让我们看一下 Genbank 和 FASTA 文件格式。Genbank 是所有公开可用的 DNA 序列的注释集合，这些文件以 FASTA 格式编写。FASTA 格式包含一个标题和 DNA 序列。因此，我们将分析<em class="jz"> NC_012920 </em>文件，这是智人线粒体，你可以通过搜索 Genbank 数据库或从<a class="ae lm" href="http://ge.tt/3q9IIOQ/v/0?c" rel="noopener ugc nofollow" target="_blank">这里</a>获得该文件。在我们开始分析序列之前，让我们写一些代码来读取文件。</p><figure class="la lb lc ld gt jr"><div class="bz fp l di"><div class="ln lo l"/></div><figcaption class="le lf gj gh gi lg lh bd b be z dk">Reading the FASTA file.</figcaption></figure><p id="be78" class="pw-post-body-paragraph jx jy iq ka b kb kc kd ke kf kg kh ki kw kk kl km kx ko kp kq ky ks kt ku kv ij bi translated">这是最基本的东西，我们读取文件，把新的线连接起来，这样我们就形成了一个大的基因串。现在我们需要计算 k-mers 在序列中的出现次数。我们来写一个方法<em class="jz"> count_kmers </em>:</p><figure class="la lb lc ld gt jr"><div class="bz fp l di"><div class="ln lo l"/></div><figcaption class="le lf gj gh gi lg lh bd b be z dk">Counting k-mers.</figcaption></figure><p id="619c" class="pw-post-body-paragraph jx jy iq ka b kb kc kd ke kf kg kh ki kw kk kl km kx ko kp kq ky ks kt ku kv ij bi translated">在我们的例子中，序列参数是数据，k 是一个整数。你可能已经注意到我们从字典中删除了一个 N。我们正在分析的序列也包含一个 N，这个 N 可以是 A、C、G 或 T 中的任何一个，这取决于概率。因为序列中只有一个 N，所以我们忽略它。</p><p id="4d85" class="pw-post-body-paragraph jx jy iq ka b kb kc kd ke kf kg kh ki kw kk kl km kx ko kp kq ky ks kt ku kv ij bi translated">现在我们已经得到了 k-mer，我们需要计算 k-mer 出现的概率。如果你记得你的概率和统计课，这应该是一个简单的问题。如果我们定义</p><figure class="la lb lc ld gt jr gh gi paragraph-image"><div class="gh gi lp"><img src="../Images/4f6475159e6ab23df07c52fd470bdbb8.png" data-original-src="https://miro.medium.com/v2/resize:fit:20/0*k88b9HJcWNMFTg85"/></div></figure><p id="ea25" class="pw-post-body-paragraph jx jy iq ka b kb kc kd ke kf kg kh ki kw kk kl km kx ko kp kq ky ks kt ku kv ij bi translated">作为基因结构中的一个子序列，出现的概率</p><figure class="la lb lc ld gt jr gh gi paragraph-image"><div class="gh gi lp"><img src="../Images/2fcea6c35659e75496752c15c60c4571.png" data-original-src="https://miro.medium.com/v2/resize:fit:20/0*37Y3wLYWNar42V89"/></div></figure><p id="93e5" class="pw-post-body-paragraph jx jy iq ka b kb kc kd ke kf kg kh ki kw kk kl km kx ko kp kq ky ks kt ku kv ij bi translated">是</p><figure class="la lb lc ld gt jr gh gi paragraph-image"><div class="gh gi lq"><img src="../Images/a37a1820496808dfdc49736471d21371.png" data-original-src="https://miro.medium.com/v2/resize:fit:202/0*4FKKJr3lIvnblVCO"/></div></figure><p id="c96a" class="pw-post-body-paragraph jx jy iq ka b kb kc kd ke kf kg kh ki kw kk kl km kx ko kp kq ky ks kt ku kv ij bi translated">在哪里</p><figure class="la lb lc ld gt jr gh gi paragraph-image"><div class="gh gi lr"><img src="../Images/7129a269b873d046c8e53d7b652df92e.png" data-original-src="https://miro.medium.com/v2/resize:fit:30/0*p5eMzL6yepfkpG9x"/></div></figure><p id="5cf7" class="pw-post-body-paragraph jx jy iq ka b kb kc kd ke kf kg kh ki kw kk kl km kx ko kp kq ky ks kt ku kv ij bi translated">是序列的长度</p><figure class="la lb lc ld gt jr gh gi paragraph-image"><div class="gh gi ls"><img src="../Images/352bebccaa194ce20b102e863d995108.png" data-original-src="https://miro.medium.com/v2/resize:fit:18/0*xwUlaJm9vo7SQ3_S"/></div></figure><p id="692e" class="pw-post-body-paragraph jx jy iq ka b kb kc kd ke kf kg kh ki kw kk kl km kx ko kp kq ky ks kt ku kv ij bi translated">是 k-mer 的长度</p><figure class="la lb lc ld gt jr gh gi paragraph-image"><div class="gh gi lt"><img src="../Images/75aeaf4f17b74aa8b2776b91e35f2fcb.png" data-original-src="https://miro.medium.com/v2/resize:fit:40/0*Owy-MhS8Wl4zNaWI"/></div></figure><p id="b0d2" class="pw-post-body-paragraph jx jy iq ka b kb kc kd ke kf kg kh ki kw kk kl km kx ko kp kq ky ks kt ku kv ij bi translated">是 k-mer 出现的次数。</p><p id="b4c4" class="pw-post-body-paragraph jx jy iq ka b kb kc kd ke kf kg kh ki kw kk kl km kx ko kp kq ky ks kt ku kv ij bi translated">现在让我们写一些 Python 代码来计算这个。</p><figure class="la lb lc ld gt jr"><div class="bz fp l di"><div class="ln lo l"/></div><figcaption class="le lf gj gh gi lg lh bd b be z dk">Calculating the probabilities.</figcaption></figure><p id="f727" class="pw-post-body-paragraph jx jy iq ka b kb kc kd ke kf kg kh ki kw kk kl km kx ko kp kq ky ks kt ku kv ij bi translated">现在混沌游戏的基本表现已经完成。现在让我们解释什么是 CGR。CGR 是序列的广义尺度无关马尔可夫概率表，寡聚体表可以从 CGR 图像推导出来。CGR 通过以下程序生成:</p><figure class="la lb lc ld gt jr"><div class="bz fp l di"><div class="ln lo l"/></div><figcaption class="le lf gj gh gi lg lh bd b be z dk">CGR pseudo code.</figcaption></figure><figure class="la lb lc ld gt jr gh gi paragraph-image"><div class="gh gi lu"><img src="../Images/61d3366f64ba48f920a27c8ba6c587d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1050/format:webp/1*u9MM2b4S-VRCngsZRIbWEQ.png"/></div></figure><p id="fa5a" class="pw-post-body-paragraph jx jy iq ka b kb kc kd ke kf kg kh ki kw kk kl km kx ko kp kq ky ks kt ku kv ij bi translated">我们试图编写的程序将创建一个图像，显示给定序列中所有 k-mers(长度为 k 的寡核苷酸)的丰度。例如，对于四聚体(k=4)，得到的图像将由以下组成</p><figure class="la lb lc ld gt jr gh gi paragraph-image"><div class="gh gi lv"><img src="../Images/9de4dbab11025dedc6fa4ec33d3fbd2e.png" data-original-src="https://miro.medium.com/v2/resize:fit:122/0*ecrBQhmFM0ypgkfm"/></div></figure><p id="73c6" class="pw-post-body-paragraph jx jy iq ka b kb kc kd ke kf kg kh ki kw kk kl km kx ko kp kq ky ks kt ku kv ij bi translated">方框，每个代表一个低聚物。寡聚物名称和丰度写在这些方框内，丰度也用方框颜色显示，从白色(无)到黑色(高频率)。这个 k-mer 表也称为 FCGR(从混沌游戏表示中提取的频率矩阵)。</p><figure class="la lb lc ld gt jr gh gi paragraph-image"><div class="gh gi lw"><img src="../Images/fe986daf89a20f3bea8135b806bd9bb7.png" data-original-src="https://miro.medium.com/v2/resize:fit:512/format:webp/1*ed3xQcTZCbqu--adYYhbBA.png"/></div><figcaption class="le lf gj gh gi lg lh bd b be z dk">A k-mer table example for CGR.</figcaption></figure><p id="f457" class="pw-post-body-paragraph jx jy iq ka b kb kc kd ke kf kg kh ki kw kk kl km kx ko kp kq ky ks kt ku kv ij bi translated">如果你问自己为什么 4 的 4 次方，这是概率和统计的基础。如果我们有一个长度为 4 的 k-mer，每个点有四个可能的值(A，C，G，T)，那么我们有</p><figure class="la lb lc ld gt jr gh gi paragraph-image"><div class="gh gi lx"><img src="../Images/4330bc0a41bb5ff3e8d0897fdc961de1.png" data-original-src="https://miro.medium.com/v2/resize:fit:28/0*hZLrvDNYbhaThWd5"/></div></figure><p id="747b" class="pw-post-body-paragraph jx jy iq ka b kb kc kd ke kf kg kh ki kw kk kl km kx ko kp kq ky ks kt ku kv ij bi translated">可能的组合。基本上，我们在做一个二维数组。我们可以用下面的公式来计算它的大小</p><figure class="la lb lc ld gt jr gh gi paragraph-image"><div class="gh gi ly"><img src="../Images/bc7ecbd472a33024e9b6f7df7842a3bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:228/0*kHMRSk2kF99mXl0F"/></div></figure><p id="5f2d" class="pw-post-body-paragraph jx jy iq ka b kb kc kd ke kf kg kh ki kw kk kl km kx ko kp kq ky ks kt ku kv ij bi translated">在哪里</p><figure class="la lb lc ld gt jr gh gi paragraph-image"><div class="gh gi ls"><img src="../Images/13704c85296d70f879fac19586ecc151.png" data-original-src="https://miro.medium.com/v2/resize:fit:18/0*K1WEAszID6qoP1Nr"/></div></figure><p id="444a" class="pw-post-body-paragraph jx jy iq ka b kb kc kd ke kf kg kh ki kw kk kl km kx ko kp kq ky ks kt ku kv ij bi translated">是 k-mer 的长度。现在我们需要计算低聚物的位置。寡聚体的位置可以递归定位如下:</p><p id="1f09" class="pw-post-body-paragraph jx jy iq ka b kb kc kd ke kf kg kh ki kw kk kl km kx ko kp kq ky ks kt ku kv ij bi translated">对于低聚物中的每个字母，一个盒子被细分为四个象限，其中 A 是左上，T 是右下，G 是右上，C 是左下。因此，低聚物 ACGT 是在</p><ul class=""><li id="044f" class="lz ma iq ka b kb kc kf kg kw mb kx mc ky md kv me mf mg mh bi translated">A =左上象限</li><li id="256c" class="lz ma iq ka b kb mi kf mj kw mk kx ml ky mm kv me mf mg mh bi translated">C =上象限内的左下方</li><li id="5dfc" class="lz ma iq ka b kb mi kf mj kw mk kx ml ky mm kv me mf mg mh bi translated">G =上方象限内的右上</li><li id="8e6d" class="lz ma iq ka b kb mi kf mj kw mk kx ml ky mm kv me mf mg mh bi translated">T =上述象限内的右下方</li></ul><figure class="la lb lc ld gt jr gh gi paragraph-image"><div class="gh gi mn"><img src="../Images/f01638a628869e19ae2bc6667b597ca5.png" data-original-src="https://miro.medium.com/v2/resize:fit:840/format:webp/1*fARCOJtMUhfWGalZnqzUVw.png"/></div><figcaption class="le lf gj gh gi lg lh bd b be z dk">How the quadrants work when representing a gene structure.</figcaption></figure><p id="8ea6" class="pw-post-body-paragraph jx jy iq ka b kb kc kd ke kf kg kh ki kw kk kl km kx ko kp kq ky ks kt ku kv ij bi translated">现在让我们写一些代码。现在我们可以使用递归，但我们不会这样做，因为我们可以用数学方法计算元素的位置。</p><figure class="la lb lc ld gt jr"><div class="bz fp l di"><div class="ln lo l"/></div><figcaption class="le lf gj gh gi lg lh bd b be z dk">Calculating CGR array.</figcaption></figure><p id="2835" class="pw-post-body-paragraph jx jy iq ka b kb kc kd ke kf kg kh ki kw kk kl km kx ko kp kq ky ks kt ku kv ij bi translated">该方法采用两个参数，第一个是 k-mer 概率的字典，第二个是 k-mer 长度。首先，我们使用上面的公式计算数组大小，然后初始化 maxx、maxy、posx 和 posy 变量。然后我们遍历所有的键，对于每个键，我们计算 k-mer 在表中的位置。</p><p id="751b" class="pw-post-body-paragraph jx jy iq ka b kb kc kd ke kf kg kh ki kw kk kl km kx ko kp kq ky ks kt ku kv ij bi translated">现在让我们把所有东西放在一起，运行程序。</p><figure class="la lb lc ld gt jr"><div class="bz fp l di"><div class="ln lo l"/></div></figure><p id="7d26" class="pw-post-body-paragraph jx jy iq ka b kb kc kd ke kf kg kh ki kw kk kl km kx ko kp kq ky ks kt ku kv ij bi translated">我们最终的结果是两张图片:</p><figure class="la lb lc ld gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="gh gi mo"><img src="../Images/e6efd5bcd3d0c9f2ef0af7da790e541c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-2JptTEdPpqxWMh5KH8QPw.png"/></div></div><figcaption class="le lf gj gh gi lg lh bd b be z dk">CGR representation of 3-mers of the NC_012920 sequence.</figcaption></figure><figure class="la lb lc ld gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="gh gi mo"><img src="../Images/4cd21a478c809bfca72796b98fad67fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9SWdudMt4guOkFMray800Q.png"/></div></div><figcaption class="le lf gj gh gi lg lh bd b be z dk">CGR representation of 4-mers of the NC_012920 sequence.</figcaption></figure></div><div class="ab cl mt mu hu mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="ij ik il im in"><h2 id="4510" class="na nb iq bd nc nd ne dn nf ng nh dp ni kw nj nk nl kx nm nn no ky np nq nr ns bi translated">参考</h2><ol class=""><li id="342c" class="lz ma iq ka b kb nt kf nu kw nv kx nw ky nx kv ny mf mg mh bi translated">H.乔尔·杰弗里，“基因结构的混沌游戏表示”，收录于<em class="jz">核酸研究，第 18 卷，第 8 号</em>，1990 年，第 2163–2170 页。</li><li id="a8bd" class="lz ma iq ka b kb mi kf mj kw mk kx ml ky mm kv ny mf mg mh bi translated">混沌游戏表现。在线:<a class="ae lm" href="http://www.lifenscience.com/bioinformatics/chaos-game-representation" rel="noopener ugc nofollow" target="_blank">http://www . lifen science . com/bio informatics/chaos-game-representation</a></li><li id="b080" class="lz ma iq ka b kb mi kf mj kw mk kx ml ky mm kv ny mf mg mh bi translated">K-mer。在线:【http://en.wikipedia.org/wiki/K-mer T4】</li><li id="7308" class="lz ma iq ka b kb mi kf mj kw mk kx ml ky mm kv ny mf mg mh bi translated">CGR G 语言项目。在线:<a class="ae lm" href="http://www.g-language.org/wiki/cgr" rel="noopener ugc nofollow" target="_blank">http://www.g-language.org/wiki/cgr</a></li><li id="abc4" class="lz ma iq ka b kb mi kf mj kw mk kx ml ky mm kv ny mf mg mh bi translated">Wolfram Mathematica 中的 CGR 表示。在线:<a class="ae lm" href="https://community.wolfram.com/groups/-/m/t/920422" rel="noopener ugc nofollow" target="_blank">https://community.wolfram.com/groups/-/m/t/920422</a></li></ol></div></div>    
</body>
</html>