<html>
<head>
<title>1 quick tip for pulling data from a Pandas dataframe using SQL queries</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用 SQL 查询从 Pandas 数据框架中提取数据的 1 个快速技巧</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/a-quick-tip-for-pulling-data-from-a-pandas-dataframe-using-sql-queries-bbe3b39d17d?source=collection_archive---------2-----------------------#2019-06-13">https://towardsdatascience.com/a-quick-tip-for-pulling-data-from-a-pandas-dataframe-using-sql-queries-bbe3b39d17d?source=collection_archive---------2-----------------------#2019-06-13</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/6ecfaa1aac9a5168d91c7e537d75bae6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*slTKfK-1pAFxiEcKcKSfsg.jpeg"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk">Photo by <a class="ae kf" href="https://unsplash.com/@hongqi?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Bruce Hong</a> on <a class="ae kf" href="https://unsplash.com/search/photos/funny-panda?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><blockquote class="kg kh ki"><p id="ed09" class="kj kk kl km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh im bi translated">想获得灵感？快来加入我的<a class="ae kf" href="https://www.superquotes.co/?utm_source=mediumtech&amp;utm_medium=web&amp;utm_campaign=sharing" rel="noopener ugc nofollow" target="_blank"> <strong class="km iu">超级行情快讯</strong> </a>。😎</p></blockquote><p id="b219" class="pw-post-body-paragraph kj kk it km b kn ko kp kq kr ks kt ku li kw kx ky lj la lb lc lk le lf lg lh im bi translated">熊猫图书馆对于任何使用 Python 分析数据的人来说都是非常棒的。</p><p id="1b67" class="pw-post-body-paragraph kj kk it km b kn ko kp kq kr ks kt ku li kw kx ky lj la lb lc lk le lf lg lh im bi translated">它非常容易使用，正确应用时速度很快，并且功能灵活。有了 Pandas，许多通常需要更多工作的功能，例如检索一些关于数据的基本统计数据，只需调用一个函数就可以完成！</p><p id="14d8" class="pw-post-body-paragraph kj kk it km b kn ko kp kq kr ks kt ku li kw kx ky lj la lb lc lk le lf lg lh im bi translated">尽管如此，有时我们更喜欢使用一种工具而不是另一种。如果你习惯于在 Excel、Tableau 或 SQL 上浏览数据，那么切换到 Pandas 仍然是一个跳跃。</p><p id="7bd0" class="pw-post-body-paragraph kj kk it km b kn ko kp kq kr ks kt ku li kw kx ky lj la lb lc lk le lf lg lh im bi translated">如果你有 SQL 的背景，有一个很棒的 Python 库可以帮助你平稳过渡:<a class="ae kf" href="https://github.com/yhat/pandasql" rel="noopener ugc nofollow" target="_blank"> <strong class="km iu"> Pandasql </strong> </a>。</p><p id="0385" class="pw-post-body-paragraph kj kk it km b kn ko kp kq kr ks kt ku li kw kx ky lj la lb lc lk le lf lg lh im bi translated">Pandasql 允许您编写 sql 查询来查询 pandas 数据框架中的数据。这允许您避开在熊猫中必须学习大量 Python 的正常要求。相反，您可以简单地在函数调用中编写常规的 SQL 查询，并在 Pandas dataframe 上运行它来检索您的数据！</p><h1 id="b382" class="ll lm it bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">用 Pandasql 查询熊猫数据帧</h1><h2 id="b2fe" class="mj lm it bd ln mk ml dn lr mm mn dp lv li mo mp lz lj mq mr md lk ms mt mh mu bi translated">安装</h2><p id="eb83" class="pw-post-body-paragraph kj kk it km b kn mv kp kq kr mw kt ku li mx kx ky lj my lb lc lk mz lf lg lh im bi translated">我们可以通过一个快速的 pip 来安装 Pandasql:</p><pre class="na nb nc nd gt ne nf ng nh aw ni bi"><span id="fbe8" class="mj lm it nf b gy nj nk l nl nm">pip install pandasql</span></pre><h2 id="9bd6" class="mj lm it bd ln mk ml dn lr mm mn dp lv li mo mp lz lj mq mr md lk ms mt mh mu bi translated">加载数据</h2><p id="e333" class="pw-post-body-paragraph kj kk it km b kn mv kp kq kr mw kt ku li mx kx ky lj my lb lc lk mz lf lg lh im bi translated">让我们从实际的数据集开始。我们将使用<code class="fe nn no np nf b">seaborn</code>库加载 iris flowers 数据集:</p><pre class="na nb nc nd gt ne nf ng nh aw ni bi"><span id="d71f" class="mj lm it nf b gy nj nk l nl nm"><em class="kl">import </em>pandasql<br/><em class="kl">import </em>seaborn <em class="kl">as </em>sns<br/><br/>data = sns.load_dataset('iris')</span></pre><h2 id="2c1d" class="mj lm it bd ln mk ml dn lr mm mn dp lv li mo mp lz lj mq mr md lk ms mt mh mu bi translated">选择</h2><p id="c696" class="pw-post-body-paragraph kj kk it km b kn mv kp kq kr mw kt ku li mx kx ky lj my lb lc lk mz lf lg lh im bi translated">通常，如果我们想检索数据帧中的前 20 项，我们会对熊猫做这样的事情:</p><pre class="na nb nc nd gt ne nf ng nh aw ni bi"><span id="75f1" class="mj lm it nf b gy nj nk l nl nm">data.head(20)</span></pre><p id="75e1" class="pw-post-body-paragraph kj kk it km b kn ko kp kq kr ks kt ku li kw kx ky lj la lb lc lk le lf lg lh im bi translated">有了 pandasql，我们可以像在 sql 数据库上运行标准 SQL 查询一样写出它。只需将 pandas 数据帧的名称作为您正在解析的表的名称，数据将被检索:</p><pre class="na nb nc nd gt ne nf ng nh aw ni bi"><span id="7737" class="mj lm it nf b gy nj nk l nl nm">sub_data = pandasql.sqldf("SELECT * FROM data LIMIT 20;", globals())<br/>print(sub_data)</span></pre><p id="f8fb" class="pw-post-body-paragraph kj kk it km b kn ko kp kq kr ks kt ku li kw kx ky lj la lb lc lk le lf lg lh im bi translated">我们可以用 SQL 中的 WHERE 进行的常规过滤操作也是适用的。让我们首先使用 pandas 提取所有大于 5 的数据:</p><pre class="na nb nc nd gt ne nf ng nh aw ni bi"><span id="d941" class="mj lm it nf b gy nj nk l nl nm">sub_data = data[data["petal_length"] &gt; 5.0]</span></pre><p id="982f" class="pw-post-body-paragraph kj kk it km b kn ko kp kq kr ks kt ku li kw kx ky lj la lb lc lk le lf lg lh im bi translated">为了在 SQL 中实现这一点，某些行只需添加 WHERE 调用来实现相同的过滤:</p><pre class="na nb nc nd gt ne nf ng nh aw ni bi"><span id="3f3c" class="mj lm it nf b gy nj nk l nl nm">sub_data = pandasql.sqldf("SELECT * FROM data WHERE petal_length &gt; 5.0;", globals())</span></pre><p id="cede" class="pw-post-body-paragraph kj kk it km b kn ko kp kq kr ks kt ku li kw kx ky lj la lb lc lk le lf lg lh im bi translated">当然，我们也可以总是只选择我们想要的列:</p><pre class="na nb nc nd gt ne nf ng nh aw ni bi"><span id="51a3" class="mj lm it nf b gy nj nk l nl nm">sub_data = pandasql.sqldf("SELECT petal_width, petal_length FROM data WHERE petal_length &gt; 5.0;", globals())</span></pre><p id="944f" class="pw-post-body-paragraph kj kk it km b kn ko kp kq kr ks kt ku li kw kx ky lj la lb lc lk le lf lg lh im bi translated">这就是如何使用 SQL 查询从 pandas 数据帧中检索数据。</p></div><div class="ab cl nq nr hx ns" role="separator"><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv"/></div><div class="im in io ip iq"><h1 id="89f1" class="ll lm it bd ln lo nx lq lr ls ny lu lv lw nz ly lz ma oa mc md me ob mg mh mi bi translated">喜欢学习？</h1><p id="3163" class="pw-post-body-paragraph kj kk it km b kn mv kp kq kr mw kt ku li mx kx ky lj my lb lc lk mz lf lg lh im bi translated">在 twitter 上关注我，我会在这里发布所有最新最棒的人工智能、技术和科学！也在 LinkedIn<a class="ae kf" href="https://www.linkedin.com/in/georgeseif/" rel="noopener ugc nofollow" target="_blank">上与我联系</a>！</p></div></div>    
</body>
</html>