<html>
<head>
<title>Quickly Transfer a Kaggle dataset into a Google bucket</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">快速将 Kaggle 数据集转移到 Google bucket 中</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/quickly-transfer-a-kaggle-dataset-into-a-google-bucket-ac21aefceb15?source=collection_archive---------11-----------------------#2019-09-29">https://towardsdatascience.com/quickly-transfer-a-kaggle-dataset-into-a-google-bucket-ac21aefceb15?source=collection_archive---------11-----------------------#2019-09-29</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="ac0a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">15 天。我震惊地发现，将一个相对较小(20GB)的图像数据集从我的本地机器上传到谷歌云平台(GCP)的存储桶需要多长时间。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/0e9b8993a0776e4252dcd0bd48caeaca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tzFfCwyHPJv4SWkE5X8Bwg.jpeg"/></div></div></figure><p id="563a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在本文中，我将介绍另一种方法，它使用 GCP 虚拟机(VM)将这个过程缩短到 2 小时。关键是在与您的 bucket 相同的区域中创建一个 VM，将文件下载到那里，然后将它转移到 bucket。</p><p id="6d5e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果你没有水桶，先把它放好，并记住你决定使用哪个区域。您可以毫无问题地使用所有标准设置。</p><p id="be9a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">下一步是创建一个虚拟机。我选择了 4 核，这样我们就可以在图像传输过程中利用多处理选项。除此之外，这是一个非常标准的设置，保留了所有的默认值。例外情况是将启动盘扩展到 100 GB 以容纳解压缩后的数据，并使用 Ubuntu 18 LTS，这只是个人偏好。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi kx"><img src="../Images/a62b78d792108c2145b3e43329fe5d32.png" data-original-src="https://miro.medium.com/v2/resize:fit:954/format:webp/1*EPtfEkVmVyoZn3yhVZX3Ig.png"/></div><figcaption class="ky kz gj gh gi la lb bd b be z dk">GCP VM setup</figcaption></figure><p id="afa3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">一旦虚拟机启动，我就连接到由<a class="ae lc" href="https://cloud.google.com/pubsub/docs/quickstart-cli" rel="noopener ugc nofollow" target="_blank"> Google CLI </a>提供的 ssh 工具(可能需要安装在本地机器上)</p><pre class="km kn ko kp gt ld le lf lg aw lh bi"><span id="ad91" class="li lj iq le b gy lk ll l lm ln">gcloud compute ssh --project [NAME OF YOUR PROJECT] --zone [ZONE NAME] [NAME OF VM]</span></pre><p id="783e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在虚拟机上，我安装了 pip 和 kaggle API。</p><pre class="km kn ko kp gt ld le lf lg aw lh bi"><span id="4930" class="li lj iq le b gy lk ll l lm ln">## Install pip<br/>&gt; curl <a class="ae lc" href="https://bootstrap.pypa.io/get-pip.py" rel="noopener ugc nofollow" target="_blank">https://bootstrap.pypa.io/get-pip.py</a> -o get-pip.py<br/>&gt; sudo apt-get install python3-distutils<br/>&gt; sudo python3 get-pip.py<br/>## Install kaggle API<br/>&gt; pip install kaggle</span></pre><p id="9fa1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">为了从 Kaggle 下载文件，您需要在 VM 上保存一个 API 令牌。你可以进入你的 Kaggle 账户，下载一个新的令牌，然后把它放到虚拟机上。在虚拟机上，创建一个名为“的隐藏文件夹。kaggle”并把钥匙移到那里</p><p id="ccc9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">在你的本地机器上:</strong></p><pre class="km kn ko kp gt ld le lf lg aw lh bi"><span id="7aac" class="li lj iq le b gy lk ll l lm ln">&gt; gcloud compute scp Downloads/kaggle.json kaggle-download:~</span></pre><p id="fdbc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">在虚拟机上:</strong></p><pre class="km kn ko kp gt ld le lf lg aw lh bi"><span id="a06f" class="li lj iq le b gy lk ll l lm ln">&gt; mkdir .kaggle<br/>&gt; mv kaggle.json .kaggle</span></pre><p id="f4b2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">至此，Kaggle API 应该可以使用了！导航到您感兴趣的竞争对手或数据集，将 API 命令复制到虚拟机中，下载就应该开始了。许多数据集是压缩的，所以您需要安装解压缩工具并提取数据。</p><pre class="km kn ko kp gt ld le lf lg aw lh bi"><span id="1b7f" class="li lj iq le b gy lk ll l lm ln">&gt; sudo apt-get install unzip<br/>&gt; unzip [DATASET].zip</span></pre><p id="cad9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">接下来要做的就是在虚拟机上验证你的谷歌账户，然后传输数据！m 标志允许我们使用多线程处理，r 递归地传输数据文件夹中的所有内容。对我来说，对于大约 20GB 的数据，运行整个过程需要大约 2 小时。</p><pre class="km kn ko kp gt ld le lf lg aw lh bi"><span id="eb0e" class="li lj iq le b gy lk ll l lm ln">&gt; gcloud auth login<br/>&gt; gsutil -m cp -r [DATA FOLDER] gs://[BUCKET NAME]</span></pre><p id="ff10" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">完成后，记得关闭虚拟机。每当我需要下载新的东西时，我就把它删除，然后转一个新的。快乐的旅行！</p></div></div>    
</body>
</html>