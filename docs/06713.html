<html>
<head>
<title>Connecting Python to Oracle, SQL Server, MySQL, and PostgreSQL</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">将 Python 连接到 Oracle、SQL Server、MySQL 和 PostgreSQL</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/connecting-python-to-oracle-sql-server-mysql-and-postgresql-ea1e4523b1e9?source=collection_archive---------4-----------------------#2019-09-25">https://towardsdatascience.com/connecting-python-to-oracle-sql-server-mysql-and-postgresql-ea1e4523b1e9?source=collection_archive---------4-----------------------#2019-09-25</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="af01" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">数据库。在一定程度上经常被数据科学家忽略，至少被新的数据科学家忽略。我明白了，你有你的波士顿住房数据集存储在 CSV 文件中，为什么还要麻烦数据库呢？</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/d395dea82d213b0ca2be726be0c4d70c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Sd50m5VidzQA8wzhJiFHhQ.jpeg"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Photo by <a class="ae ky" href="https://www.pexels.com/@cookiecutter?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank">panumas nikhomkhai </a>from <a class="ae ky" href="https://www.pexels.com/photo/bandwidth-close-up-computer-connection-1148820/?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank">Pexels</a></figcaption></figure><p id="94c7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在我职业生涯的大部分时间里，我也忽略了它们，但后来我需要为我的日常工作学习 SQL 和 PL/SQL。这是一项很好的技能——甚至可以说是你简历中的必备技能——但是客户想要用 PL/SQL 交付数据科学项目是完全的白痴行为。</p><p id="fdfc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是 SQL 不等于数据库。我喜欢数据库的数据存储能力，主要是因为数据比 CSV 更安全——没有人可以双击并打开/更改 Excel 中的表格。</p><p id="4101" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">出于这个原因，我决定写这篇文章，因为出于某种原因，在网上找到 2010 年后发布的关于这个主题的东西并不像你想象的那样简单(从那以后发生了很多变化)。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="91d3" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">Oracle 连接</h1><p id="995f" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">为了连接到 Oracle 数据库,您当然需要在您的机器上安装该数据库。我的机器有<strong class="lb iu"> 12c </strong>版本，所以不能保证所有东西都能在旧版本或新版本上运行。为了测试一切，我解锁了著名的<strong class="lb iu"> HR </strong>模式，并将密码设置为<em class="mz"> hr </em>。</p><p id="eba2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一旦你也这样做了，点击<em class="mz">连接</em>将显示你需要连接 Python 到你的 Oracle 数据库实例的每个细节:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi na"><img src="../Images/5400aa47ba3d26376a78e7bb862ebaad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8HmPRtCvzoK0cRyFw3O-QA.png"/></div></div></figure><p id="d60c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在跳转到代码之前，你需要通过<em class="mz"> pip </em>安装<strong class="lb iu">CX _ OracleT13】库，就像这样:</strong></p><pre class="kj kk kl km gt nb nc nd ne aw nf bi"><span id="ee50" class="ng md it nc b gy nh ni l nj nk">pip install cx_oracle</span></pre><p id="3b28" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">连接过程是我今天要讨论的四个过程中最长的，但是如果你逐行阅读的话，它真的很简单。我选择从著名的<strong class="lb iu">雇员</strong>表中获取前 10 行(注意 Oracle 如何使用<strong class="lb iu"> <em class="mz"> ROWNUM </em> </strong>，而不是<strong class="lb iu"> <em class="mz"> TOP </em> </strong>，或<strong class="lb iu"> <em class="mz"> LIMIT </em> </strong>):</p><pre class="kj kk kl km gt nb nc nd ne aw nf bi"><span id="43d6" class="ng md it nc b gy nh ni l nj nk">import cx_Oracle</span><span id="1c99" class="ng md it nc b gy nl ni l nj nk">dsn = cx_Oracle.makedsn(<br/>    'localhost', <br/>    '1521', <br/>    service_name='orcl'<br/>)<br/>conn = cx_Oracle.connect(<br/>    user='hr', <br/>    password='hr', <br/>    dsn=dsn<br/>)</span><span id="f806" class="ng md it nc b gy nl ni l nj nk">c = conn.cursor()<br/>c.execute('SELECT * FROM employees WHERE ROWNUM &lt;= 10')</span><span id="b6c9" class="ng md it nc b gy nl ni l nj nk">for row in c: print(row)<br/>conn.close()</span></pre><p id="6eb1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">执行此代码块将向您的笔记本输出以下内容:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nm"><img src="../Images/a65541377a8b3dc9e39b42f7e75c9b78.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fJdsCuxRTjbUb8WrS0dLDQ.png"/></div></div></figure><p id="4160" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这并不难，是吗？下面的会更容易，或者至少写的更短，我保证！</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="21d6" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">SQL Server</h1><p id="54ae" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">除了 Oracle 数据库之外，微软的 SQL Server 也是典型工作环境中常见的数据库系统。要连接到它，您首先需要获取<strong class="lb iu">服务器名称</strong>(所选字符串):</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/d25feb9d20224f92540085accb27afe0.png" data-original-src="https://miro.medium.com/v2/resize:fit:946/format:webp/1*ghltCjJICdi8QOlLGThYpA.png"/></div></figure><p id="c6b6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后，当您连接到数据库引擎时，您将需要找到数据库名称和表名称，这样您就知道应该在连接字符串中放入什么:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi no"><img src="../Images/2069f7aafa76d8feaf70639723014332.png" data-original-src="https://miro.medium.com/v2/resize:fit:492/format:webp/1*M6-K9DxB3NNGdWuZQxna9Q.png"/></div></figure><p id="b9fb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">哦，差点忘了。还需要通过<em class="mz"> pip </em>安装<strong class="lb iu"><em class="mz">py odbc</em>T3】库:</strong></p><pre class="kj kk kl km gt nb nc nd ne aw nf bi"><span id="2dba" class="ng md it nc b gy nh ni l nj nk">pip install pyodbc</span></pre><p id="56f9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">正如所承诺的，这段代码比连接到 Oracle 的代码要短一些:</p><pre class="kj kk kl km gt nb nc nd ne aw nf bi"><span id="9f10" class="ng md it nc b gy nh ni l nj nk">import pyodbc</span><span id="2702" class="ng md it nc b gy nl ni l nj nk">conn = pyodbc.connect(<br/>    'Driver={SQL Server};'<br/>    'Server=DESKTOP-TLF7IMQ\SQLEXPRESS;'<br/>    'Database=retail;'<br/>    'Trusted_Connection=yes;'<br/>)</span><span id="2afe" class="ng md it nc b gy nl ni l nj nk">cursor = conn.cursor()<br/>cursor.execute('SELECT TOP 5 * FROM dbo.table_transactions')</span><span id="74ad" class="ng md it nc b gy nl ni l nj nk">for row in cursor: print(row)<br/>conn.close()</span></pre><p id="98d8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">执行此代码单元将输出以下内容:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi np"><img src="../Images/72acf5e2e6ecfd02ea2f7543c3ed9fdd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1138/format:webp/1*3ikiCgVC512NVMV0nDwhmw.png"/></div></figure><p id="cff8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来，MySQL。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="1b55" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">关系型数据库</h1><p id="85a7" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">虽然在工作环境中可能不像前两个那么常用，<a class="ae ky" href="https://dev.mysql.com/downloads/" rel="noopener ugc nofollow" target="_blank"> MySQL </a>仍然非常受欢迎，如果你以前学过 web 开发，你可能会用到它。</p><p id="15f3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">默认情况下，MySQL 实例附带了这个<strong class="lb iu"> <em class="mz"> sakila </em> </strong>数据库，它看起来对<a class="ae ky" href="http://www.postgresqltutorial.com/postgresql-sample-database/" rel="noopener ugc nofollow" target="_blank"> dvdrental </a>数据库非常熟悉。我要建立的连接是到<strong class="lb iu"> <em class="mz"> sakila </em> </strong>数据库，以及<strong class="lb iu"> <em class="mz">演员</em> </strong>表。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/e206b87b288eabe3c0d3172b3ce1a1e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:400/format:webp/1*pSLussyNnjbJThScpKJGbw.png"/></div></figure><p id="b210" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我通过<a class="ae ky" href="https://www.anaconda.com/" rel="noopener ugc nofollow" target="_blank"> Anaconda </a>安装的 Python 已经内置了必要的库，所以不需要额外安装。要从 Python 连接，我将使用<strong class="lb iu"> <em class="mz"> mysql </em> </strong>库:</p><pre class="kj kk kl km gt nb nc nd ne aw nf bi"><span id="5f0e" class="ng md it nc b gy nh ni l nj nk">import mysql.connector</span><span id="f079" class="ng md it nc b gy nl ni l nj nk">conn = mysql.connector.connect(<br/>    host='localhost',<br/>    user='root',<br/>    passwd='1234'<br/>)</span><span id="9236" class="ng md it nc b gy nl ni l nj nk">cursor = conn.cursor()<br/>cursor.execute('SELECT * FROM sakila.actor LIMIT 5')</span><span id="12a8" class="ng md it nc b gy nl ni l nj nk">for row in cursor: print(row)<br/>conn.close()</span></pre><p id="dd9c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一旦执行了这段代码，您将得到如下输出:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/750cb8db3ceb930a080bcc8cda179149.png" data-original-src="https://miro.medium.com/v2/resize:fit:1046/format:webp/1*LLt1sGSd8TxtukgLRl4ijA.png"/></div></figure><p id="d848" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">搞定三个，还剩一个！</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="ee76" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">一种数据库系统</h1><p id="8d1e" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">最后但同样重要的是 Postgres 数据库。要连接到它，您需要安装<strong class="lb iu"> <em class="mz"> psycopg2 </em> </strong>库:</p><pre class="kj kk kl km gt nb nc nd ne aw nf bi"><span id="1534" class="ng md it nc b gy nh ni l nj nk">pip install psycopg2</span></pre><p id="bb39" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">奇怪的名字，我知道。很容易在导入时出现打印错误。</p><p id="3757" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然而，连接过程相当简单。我的数据库实例包含前面提到的<strong class="lb iu"> <em class="mz"> dvdrental </em> </strong>数据库，所以我将连接到它，再一次连接到 actor 表:</p><pre class="kj kk kl km gt nb nc nd ne aw nf bi"><span id="11a1" class="ng md it nc b gy nh ni l nj nk">import psycopg2</span><span id="bd84" class="ng md it nc b gy nl ni l nj nk">conn = psycopg2.connect(<br/>    user='postgres',<br/>    password='1234',<br/>    host='127.0.0.1',<br/>    port='5432',<br/>    database='dvdrental'<br/>)</span><span id="6a50" class="ng md it nc b gy nl ni l nj nk">cursor = conn.cursor()<br/>cursor.execute('SELECT * FROM actor LIMIT 10')</span><span id="570f" class="ng md it nc b gy nl ni l nj nk">for row in cursor: print(row)<br/>conn.close()</span></pre><p id="30b5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">执行该代码块将输出以下内容:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/79db81509691bcd2b9343424f132e343.png" data-original-src="https://miro.medium.com/v2/resize:fit:1162/format:webp/1*Yi88QMCTS-knzs4GhaeOPw.png"/></div></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="93ef" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">结论</h1><p id="308d" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">这篇文章差不多到此结束。我看过 15 分钟以上的文章，只连接到一个数据库，涵盖了所有的基本细节。就我个人而言，我不认为这有什么意义，因为拜托，这只是一个数据库连接！有很多更重要的事情需要关注。</p><p id="2cbf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你是一名数据科学家，你将主要使用数据库来获取数据，所以这篇文章对你来说已经足够了。如果需要更高级的东西，去问你最好的朋友，谷歌。</p><p id="85fd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">感谢阅读…</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><p id="d244" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="mz">喜欢这篇文章吗？成为</em> <a class="ae ky" href="https://medium.com/@radecicdario/membership" rel="noopener"> <em class="mz">中等会员</em> </a> <em class="mz">继续无限制的学习。如果你使用下面的链接，我会收到你的一部分会员费，不需要你额外付费。</em></p><div class="nt nu gp gr nv nw"><a href="https://medium.com/@radecicdario/membership" rel="noopener follow" target="_blank"><div class="nx ab fo"><div class="ny ab nz cl cj oa"><h2 class="bd iu gy z fp ob fr fs oc fu fw is bi translated">通过我的推荐链接加入 Medium-Dario rade ci</h2><div class="od l"><h3 class="bd b gy z fp ob fr fs oc fu fw dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="oe l"><p class="bd b dl z fp ob fr fs oc fu fw dk translated">medium.com</p></div></div><div class="of l"><div class="og l oh oi oj of ok ks nw"/></div></div></a></div></div></div>    
</body>
</html>