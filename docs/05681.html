<html>
<head>
<title>Multi Class Object Classification for Retail Products</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">零售产品的多类对象分类</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/multi-class-object-classification-for-retail-products-aa4ecaaaa096?source=collection_archive---------10-----------------------#2019-08-20">https://towardsdatascience.com/multi-class-object-classification-for-retail-products-aa4ecaaaa096?source=collection_archive---------10-----------------------#2019-08-20</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="5d94" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">无摩擦商店体验的计算机视觉。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/d8d6c695a670e1e472278cb47958f238.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*empB65v51mQ65lXohvlmRw.jpeg"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Photo by <a class="ae kv" href="https://unsplash.com/@fikrirasyid?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Fikri Rasyid</a> on <a class="ae kv" href="https://unsplash.com/search/photos/grocery-store?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="5030" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">被困在付费墙后面？点击<a class="ae kv" rel="noopener" target="_blank" href="/multi-class-object-classification-for-retail-products-aa4ecaaaa096?source=friends_link&amp;sk=a09cd7d1715635d2519b1f10a3bf06f6">这里</a>阅读完整故事与我的朋友链接！</p><p id="9d67" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">零售从来都不是一个停滞不前的行业。如果零售商想要成功，他们就不能停滞不前。他们必须适应和创新，否则就有被抛在后面的风险。</p><p id="3699" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">计算机视觉在零售业中的应用将从根本上改变客户和零售商的购物体验。在这篇博客中，我将为零售产品制作一个基于计算机视觉的多类对象分类模型。这个项目的灵感来自著名的<a class="ae kv" href="https://www.amazon.com/b?ie=UTF8&amp;node=16008589011" rel="noopener ugc nofollow" target="_blank">亚马逊 Go </a>商店。我希望你喜欢这篇文章，并发现它很有见地。</p><p id="cc18" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">亚马逊将 Amazon Go 描述为一种不需要结账的新型商店。这意味着当你在 Amazon Go 购物时，你永远不必排队。该商店使用 Amazon Go 应用程序——你进入 Amazon Go，拿走你想要的产品，感谢该应用程序，只需再次离开。它通过使用自动驾驶汽车中发现的相同类型的技术来工作，如计算机视觉、传感器融合和深度学习。这项技术可以检测产品何时被拿走或放回货架，并在您的虚拟购物车中跟踪它们。当你带着商品离开商店时，你的亚马逊账户会被扣款，你会收到一张收据。</p><p id="2735" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果你想看的话，这是视频。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ls lt l"/></div></figure><h1 id="1df4" class="lu lv iq bd lw lx ly lz ma mb mc md me jw mf jx mg jz mh ka mi kc mj kd mk ml bi translated">计算机视觉在零售业中的应用</h1><ol class=""><li id="02d4" class="mm mn iq ky b kz mo lc mp lf mq lj mr ln ms lr mt mu mv mw bi translated">使用面部识别定制体验。</li><li id="ea29" class="mm mn iq ky b kz mx lc my lf mz lj na ln nb lr mt mu mv mw bi translated">让购物更人性化，减少交易。</li><li id="b210" class="mm mn iq ky b kz mx lc my lf mz lj na ln nb lr mt mu mv mw bi translated">基于计算机视觉的库存管理。</li><li id="4695" class="mm mn iq ky b kz mx lc my lf mz lj na ln nb lr mt mu mv mw bi translated">模糊了店内和网上的界限。</li><li id="409c" class="mm mn iq ky b kz mx lc my lf mz lj na ln nb lr mt mu mv mw bi translated">无摩擦商店体验。</li></ol><h1 id="028e" class="lu lv iq bd lw lx ly lz ma mb mc md me jw mf jx mg jz mh ka mi kc mj kd mk ml bi translated">数据</h1><p id="1a0f" class="pw-post-body-paragraph kw kx iq ky b kz mo jr lb lc mp ju le lf nc lh li lj nd ll lm ln ne lp lq lr ij bi translated">我在这个项目中使用了弗赖堡杂货数据集。它由 25 种食物的 5000 张 256x256 RGB 图像组成。论文可以在<a class="ae kv" href="https://arxiv.org/pdf/1611.05799.pdf" rel="noopener ugc nofollow" target="_blank">这里</a>找到，数据集<a class="ae kv" href="http://aisdatasets.informatik.uni-freiburg.de/freiburg_groceries_dataset" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p><h1 id="7998" class="lu lv iq bd lw lx ly lz ma mb mc md me jw mf jx mg jz mh ka mi kc mj kd mk ml bi translated">环境和工具</h1><ol class=""><li id="8046" class="mm mn iq ky b kz mo lc mp lf mq lj mr ln ms lr mt mu mv mw bi translated">Numpy</li><li id="8fb1" class="mm mn iq ky b kz mx lc my lf mz lj na ln nb lr mt mu mv mw bi translated">熊猫</li><li id="eb8a" class="mm mn iq ky b kz mx lc my lf mz lj na ln nb lr mt mu mv mw bi translated">sci kit-图像</li><li id="9449" class="mm mn iq ky b kz mx lc my lf mz lj na ln nb lr mt mu mv mw bi translated">Matplotlib</li><li id="3bbd" class="mm mn iq ky b kz mx lc my lf mz lj na ln nb lr mt mu mv mw bi translated">sci kit-学习</li><li id="6176" class="mm mn iq ky b kz mx lc my lf mz lj na ln nb lr mt mu mv mw bi translated">克拉斯</li></ol><h1 id="774a" class="lu lv iq bd lw lx ly lz ma mb mc md me jw mf jx mg jz mh ka mi kc mj kd mk ml bi translated">图像分类</h1><p id="09f7" class="pw-post-body-paragraph kw kx iq ky b kz mo jr lb lc mp ju le lf nc lh li lj nd ll lm ln ne lp lq lr ij bi translated">完整的图像分类管道可以形式化如下:</p><ul class=""><li id="2af9" class="mm mn iq ky b kz la lc ld lf nf lj ng ln nh lr ni mu mv mw bi translated">我们的输入是一个由<em class="nj"> N </em>幅图像组成的训练数据集，每幅图像都标有 25 个不同类别中的一个。</li><li id="6d1f" class="mm mn iq ky b kz mx lc my lf mz lj na ln nb lr ni mu mv mw bi translated">然后，我们使用这个训练集来训练一个分类器，以学习每个类的样子。</li><li id="bb95" class="mm mn iq ky b kz mx lc my lf mz lj na ln nb lr ni mu mv mw bi translated">最后，我们通过要求分类器预测一组它以前从未见过的新图像的标签来评估分类器的质量。然后，我们将这些图像的真实标签与分类器预测的标签进行比较。</li></ul><h1 id="92ee" class="lu lv iq bd lw lx ly lz ma mb mc md me jw mf jx mg jz mh ka mi kc mj kd mk ml bi translated">代码在哪里？</h1><p id="0924" class="pw-post-body-paragraph kw kx iq ky b kz mo jr lb lc mp ju le lf nc lh li lj nd ll lm ln ne lp lq lr ij bi translated">事不宜迟，让我们从代码开始吧。github 上的完整项目可以在这里找到<a class="ae kv" href="https://github.com/abhinavsagar/Grocery-Image-Classification" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="8d4e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我从加载所有的库和依赖项开始。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nk lt l"/></div></figure><p id="7de8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">接下来，我制作了一个函数来绘制损失和准确性，这将在训练模型后得到。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nk lt l"/></div></figure><p id="7d9e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我还创建了几个函数来返回特定图像的标签并加载数据集。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nk lt l"/></div></figure><p id="3e8c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我继续为每个产品创建单独的类，并调用函数来加载每个类的所有图像。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nk lt l"/></div></figure><p id="f532" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">接下来，我将图像转换成分类格式，然后再对图像进行归一化。我还将数据集分成两部分——80%的数据用于训练集，20%的数据用于测试集。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nk lt l"/></div></figure><p id="34d4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">由于数据集很小，我使用了旋转、缩放和翻转等数据扩充策略。这几乎使数据集的大小增加了一倍。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nk lt l"/></div></figure><p id="b0d5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们展示每个类别中的一些示例。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nk lt l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nl"><img src="../Images/1b3068dde983f56fcd6956e12d0fd4a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jyUcigWKuLYO3-9gtEiZ2w.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Sample Products</figcaption></figure><p id="407a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">到目前为止一切顺利。现在到了项目有趣的部分。我们来做深度学习模型。</p><p id="f64e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我已经使用预训练的 VGG 重量转移学习。在此基础上，我使用了一个平均池层来减少前几层的学习权重的差异。此外，我用 30%的辍学，以减少过度拟合。最后，我使用了一个有 25 个神经元的密集层来表示我们数据集中的 25 类食品。我使用 softmax 作为激活函数，因为它是一个多类分类问题。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nk lt l"/></div></figure><p id="70d3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们将模型可视化。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nk lt l"/></div></figure><p id="b935" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我继续使用 keras 定义一些回调。如果验证准确性增加，我使用模型检查点来节省权重。如果验证损失开始趋于平稳，我还使用了提前停止标准。另外两个回调用于在 tensorboard 中可视化结果，以及在 csv 文件中保存日志。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nk lt l"/></div></figure><p id="3316" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">接下来，我定义了 2 个优化器。第一个是随机梯度下降，学习率为 0.0001，动量值为 0.99。第二个是亚当，学习率略高，为 0.001。</p><p id="d667" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">对比两者，我发现亚当给出了更好的结果。我还使用分类交叉熵作为我们模型的损失函数。我对模型进行了 50 次迭代，批量大小为 128，我认为这是解决这个问题的最佳方法。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nk lt l"/></div></figure><p id="5eb2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">最后我画出了结果。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nk lt l"/></div></figure><h1 id="1b14" class="lu lv iq bd lw lx ly lz ma mb mc md me jw mf jx mg jz mh ka mi kc mj kd mk ml bi translated">结果</h1><h2 id="fa62" class="nm lv iq bd lw nn no dn ma np nq dp me lf nr ns mg lj nt nu mi ln nv nw mk nx bi translated">损失/精度与历元</h2><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ny"><img src="../Images/7fe250ea33cfbc44c445029e36d0636a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KWiBxXa7W8fojmEUN4kuyg.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Loss/Accuracy vs Epoch</figcaption></figure><p id="9306" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">该模型能够达到 60%的验证准确性，考虑到每个类别中有 100-200 张图像的类别数量(25)，这已经是相当不错的了。您可以随意使用不同的架构或使用超参数来获得更好的结果。</p><h2 id="3623" class="nm lv iq bd lw nn no dn ma np nq dp me lf nr ns mg lj nt nu mi ln nv nw mk nx bi translated">正确与不正确的样本</h2><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nz"><img src="../Images/007410edf80c0a1de940b66429db0d56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Bu_fubsY4dNTXoiTt-EZjQ.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Correct vs Incorrect Samples</figcaption></figure><p id="5901" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">可以注意到，我们的模型预测了相当多的错误分类样本。但我仍然觉得这应该是这个领域进一步工作的良好开端。</p><h1 id="dffe" class="lu lv iq bd lw lx ly lz ma mb mc md me jw mf jx mg jz mh ka mi kc mj kd mk ml bi translated">结论</h1><p id="699c" class="pw-post-body-paragraph kw kx iq ky b kz mo jr lb lc mp ju le lf nc lh li lj nd ll lm ln ne lp lq lr ij bi translated">虽然这个项目还远未完成，但在如此多样的现实世界问题中看到深度学习的成功是令人瞩目的。自动对象分类对于食品和杂货零售商非常有帮助，可以减少仓库和零售店的库存管理过程中的人力。无摩擦的商店体验也被认为是购物的未来。</p><h1 id="8091" class="lu lv iq bd lw lx ly lz ma mb mc md me jw mf jx mg jz mh ka mi kc mj kd mk ml bi translated">参考资料/进一步阅读</h1><div class="oa ob gp gr oc od"><a href="https://www.amazon.com/b?ie=UTF8&amp;node=16008589011" rel="noopener  ugc nofollow" target="_blank"><div class="oe ab fo"><div class="of ab og cl cj oh"><h2 class="bd ir gy z fp oi fr fs oj fu fw ip bi translated">Amazon.com::亚马逊 Go</h2><div class="ok l"><h3 class="bd b gy z fp oi fr fs oj fu fw dk translated">Amazon Go 是一种新型商店，拥有世界上最先进的购物技术。没有排队，没有结账-只是…</h3></div><div class="ol l"><p class="bd b dl z fp oi fr fs oj fu fw dk translated">www.amazon.com</p></div></div><div class="om l"><div class="on l oo op oq om or kp od"/></div></div></a></div><div class="oa ob gp gr oc od"><a href="https://searchenterpriseai.techtarget.com/feature/252463246/Top-computer-vision-retail-uses-and-how-they-enhance-shopping" rel="noopener  ugc nofollow" target="_blank"><div class="oe ab fo"><div class="of ab og cl cj oh"><h2 class="bd ir gy z fp oi fr fs oj fu fw ip bi translated">计算机视觉的主要零售用途及其如何增强购物</h2><div class="ok l"><h3 class="bd b gy z fp oi fr fs oj fu fw dk translated">网络和网上购物的出现给零售业带来了巨大的冲击。然而，它从来没有…</h3></div><div class="ol l"><p class="bd b dl z fp oi fr fs oj fu fw dk translated">searchenterpriseai.techtarget.com</p></div></div><div class="om l"><div class="os l oo op oq om or kp od"/></div></div></a></div><div class="oa ob gp gr oc od"><a href="https://hackernoon.com/a-beginners-guide-to-computer-vision-in-retail-b5a31cfd5283" rel="noopener  ugc nofollow" target="_blank"><div class="oe ab fo"><div class="of ab og cl cj oh"><h2 class="bd ir gy z fp oi fr fs oj fu fw ip bi translated">零售业计算机视觉初学者指南</h2><div class="ok l"><h3 class="bd b gy z fp oi fr fs oj fu fw dk translated">任何一个手指未干的人现在都应该听说过席卷发达国家的“零售业末日”…</h3></div><div class="ol l"><p class="bd b dl z fp oi fr fs oj fu fw dk translated">hackernoon.com</p></div></div><div class="om l"><div class="ot l oo op oq om or kp od"/></div></div></a></div><h1 id="2957" class="lu lv iq bd lw lx ly lz ma mb mc md me jw mf jx mg jz mh ka mi kc mj kd mk ml bi translated">在你走之前</h1><p id="1a85" class="pw-post-body-paragraph kw kx iq ky b kz mo jr lb lc mp ju le lf nc lh li lj nd ll lm ln ne lp lq lr ij bi translated">相应的源代码可以在这里找到。</p><div class="oa ob gp gr oc od"><a href="https://github.com/abhinavsagar/Grocery-Image-Classification" rel="noopener  ugc nofollow" target="_blank"><div class="oe ab fo"><div class="of ab og cl cj oh"><h2 class="bd ir gy z fp oi fr fs oj fu fw ip bi translated">abhinavsagar/杂货-图像-分类</h2><div class="ok l"><h3 class="bd b gy z fp oi fr fs oj fu fw dk translated">弗莱堡食品数据集由 25 种食品的 5000 张 256x256 RGB 图像组成。我用过迁移学习…</h3></div><div class="ol l"><p class="bd b dl z fp oi fr fs oj fu fw dk translated">github.com</p></div></div></div></a></div><h1 id="83f7" class="lu lv iq bd lw lx ly lz ma mb mc md me jw mf jx mg jz mh ka mi kc mj kd mk ml bi translated">联系人</h1><p id="924e" class="pw-post-body-paragraph kw kx iq ky b kz mo jr lb lc mp ju le lf nc lh li lj nd ll lm ln ne lp lq lr ij bi translated">如果你想了解我最新的文章和项目<a class="ae kv" href="https://medium.com/@abhinav.sagar" rel="noopener">，请关注我的媒体</a>。以下是我的一些联系人详细信息:</p><ul class=""><li id="6b94" class="mm mn iq ky b kz la lc ld lf nf lj ng ln nh lr ni mu mv mw bi translated"><a class="ae kv" href="https://abhinavsagar.github.io" rel="noopener ugc nofollow" target="_blank">个人网站</a></li><li id="575a" class="mm mn iq ky b kz mx lc my lf mz lj na ln nb lr ni mu mv mw bi translated"><a class="ae kv" href="https://in.linkedin.com/in/abhinavsagar4" rel="noopener ugc nofollow" target="_blank">领英</a></li><li id="6139" class="mm mn iq ky b kz mx lc my lf mz lj na ln nb lr ni mu mv mw bi translated"><a class="ae kv" href="https://medium.com/@abhinav.sagar" rel="noopener">中等轮廓</a></li><li id="2e6d" class="mm mn iq ky b kz mx lc my lf mz lj na ln nb lr ni mu mv mw bi translated"><a class="ae kv" href="https://github.com/abhinavsagar" rel="noopener ugc nofollow" target="_blank"> GitHub </a></li><li id="de97" class="mm mn iq ky b kz mx lc my lf mz lj na ln nb lr ni mu mv mw bi translated"><a class="ae kv" href="https://www.kaggle.com/abhinavsagar" rel="noopener ugc nofollow" target="_blank">卡格尔</a></li></ul><p id="7505" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">快乐阅读，快乐学习，快乐编码！</p></div></div>    
</body>
</html>