<html>
<head>
<title>BERT vs ULMFiT Faceoff</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">伯特 vs 乌尔菲特对决</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/battle-of-the-heavyweights-bert-vs-ulmfit-faceoff-91a582a7c42b?source=collection_archive---------17-----------------------#2019-08-05">https://towardsdatascience.com/battle-of-the-heavyweights-bert-vs-ulmfit-faceoff-91a582a7c42b?source=collection_archive---------17-----------------------#2019-08-05</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="13f2" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph">重量级人物之战</h2><div class=""/><div class=""><h2 id="0ac9" class="pw-subtitle-paragraph jw iz iq bd b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dk translated">一个简单的 web 应用程序，用于实时比较两种架构。包括在谷歌应用引擎上部署的完整代码和说明</h2></div><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi kp"><img src="../Images/a7067cf0ab6985f7b7fcfb49674433a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*o1NB0RDcr7OlHIV4"/></div></div><figcaption class="lb lc gj gh gi ld le bd b be z dk">Photo by <a class="ae ko" href="https://unsplash.com/@1walter2?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Johann Walter Bantz</a> on <a class="ae ko" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="5e39" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">这篇文章是<a class="ae ko" href="https://medium.com/dsnet/running-pytorch-transformers-on-custom-datasets-717fd9e10fe2" rel="noopener">早先</a>文章的延续，在那篇文章中我谈到了在自定义数据集上运行拥抱脸的 pytorch-transformers 库。</p><p id="673c" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">在本主题中，我们将讨论:</p><ol class=""><li id="9617" class="mb mc iq lh b li lj ll lm lo md ls me lw mf ma mg mh mi mj bi translated">使用 py torch-transformers &amp; ul fit 进行推理</li><li id="4cd2" class="mb mc iq lh b li mk ll ml lo mm ls mn lw mo ma mg mh mi mj bi translated">使用 HTML 前端和 flask 后端将其转换为 web 应用程序</li><li id="4cda" class="mb mc iq lh b li mk ll ml lo mm ls mn lw mo ma mg mh mi mj bi translated">使用 SQLAlchemy &amp; Cloud SQL 存储数据</li><li id="aeda" class="mb mc iq lh b li mk ll ml lo mm ls mn lw mo ma mg mh mi mj bi translated"><a class="ae ko" href="https://deployment-247905.appspot.com/" rel="noopener ugc nofollow" target="_blank">谷歌应用引擎上的生产部署</a></li><li id="62f0" class="mb mc iq lh b li mk ll ml lo mm ls mn lw mo ma mg mh mi mj bi translated">几个有趣的观察结果</li></ol><h1 id="dc10" class="mp mq iq bd mr ms mt mu mv mw mx my mz kf na kg nb ki nc kj nd kl ne km nf ng bi translated">背景</h1><p id="2c42" class="pw-post-body-paragraph lf lg iq lh b li nh ka lk ll ni kd ln lo nj lq lr ls nk lu lv lw nl ly lz ma ij bi translated">当<a class="ae ko" href="https://github.com/huggingface/pytorch-transformers" rel="noopener ugc nofollow" target="_blank">py torch-transformers</a>发布时，我想试用一下，看看它的性能有多好，使用起来有多方便。因此，我开始着手建立一个 BERT(基础)模型，并在 IMDB 电影评论数据集上进行了微调。我把它包在一个网络应用程序上，任何人都可以玩。然后，我觉得与其他模型进行比较会很有趣，所以我在我的应用程序中加入了 ULMFiT。之所以选择 ULMFiT，是因为我作为 FastAI 的学生已经很长时间了，并且随身带着一个微调过的模型。最后，我决定通过对每个单词进行预测来实现实时性，这提供了一种很酷的方式来查看模型的内部工作方式。</p><p id="981a" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">app 部署在这里:<a class="ae ko" href="https://deployment-247905.appspot.com/" rel="noopener ugc nofollow" target="_blank">https://deployment-247905.appspot.com/</a></p><p id="d2c1" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">这是当前版本的外观:</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi nm"><img src="../Images/77e5fcc77acd13d2e8ed146edd1a20c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ngTpqnn4aCYn82xR2oVQkw.png"/></div></div></figure><h1 id="17ab" class="mp mq iq bd mr ms mt mu mv mw mx my mz kf na kg nb ki nc kj nd kl ne km nf ng bi translated">密码</h1><p id="ad7b" class="pw-post-body-paragraph lf lg iq lh b li nh ka lk ll ni kd ln lo nj lq lr ls nk lu lv lw nl ly lz ma ij bi translated">所有的代码都存在于这里的<a class="ae ko" href="https://github.com/nikhilno1/nlp_projects/tree/master/deployment/imdb-google-app-engine" rel="noopener ugc nofollow" target="_blank">回购</a>中。[注意:自述文件将会随着代码的清理/小的重构而更新更多的细节]</p><p id="a9c3" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">下面快速浏览一下目录结构。</p><p id="b4ad" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">├──docker file<br/>├──readme . MD<br/>├──app . YAML<br/>├──main . py<br/>├──model<br/>├──model-fastai<br/>├──requirements . txt<br/>├──static<br/>┤──templates<br/>└──utils _ inference . py</p><ol class=""><li id="ba53" class="mb mc iq lh b li lj ll lm lo md ls me lw mf ma mg mh mi mj bi translated">Dockerfile:将应用程序作为 docker 容器运行。此外，我们在谷歌应用引擎(GAE)部署中使用了“灵活”的环境，这需要一个 dockerfile 文件。</li><li id="7f31" class="mb mc iq lh b li mk ll ml lo mm ls mn lw mo ma mg mh mi mj bi translated">app . YAML:GAE 所需的应用程序设置文件</li><li id="ebe5" class="mb mc iq lh b li mk ll ml lo mm ls mn lw mo ma mg mh mi mj bi translated">main.py:主 flask 后端代码。文件名应该是 main.py，以便与 GAE 一起使用</li><li id="4bfb" class="mb mc iq lh b li mk ll ml lo mm ls mn lw mo ma mg mh mi mj bi translated">模型:包含微调的 BERT(基本)模型文件。想要下载文件，但是库需要增强来处理。我会看看我能不能做到。</li><li id="aa6a" class="mb mc iq lh b li mk ll ml lo mm ls mn lw mo ma mg mh mi mj bi translated">model-fastai:只包含 ULMFiT 的 imdb.vocab 文件。其他文件从一个公共的谷歌云存储桶中下载。</li><li id="918a" class="mb mc iq lh b li mk ll ml lo mm ls mn lw mo ma mg mh mi mj bi translated">requirements . txt:docker file 需要安装的所有包</li><li id="cf88" class="mb mc iq lh b li mk ll ml lo mm ls mn lw mo ma mg mh mi mj bi translated">静态:Web 用户界面所需的 CSS 和 javascript 文件</li><li id="2719" class="mb mc iq lh b li mk ll ml lo mm ls mn lw mo ma mg mh mi mj bi translated">模板:包含拥有我们的 Web 用户界面的 index.html 文件。</li><li id="5f95" class="mb mc iq lh b li mk ll ml lo mm ls mn lw mo ma mg mh mi mj bi translated">utils_inference.py:为 BERT 模型进行推理所需的实用函数。这些是从 pytorch-transformers 的 utils_ <dataset>中复制的。py 文件，并定制为 IMDB 电影评论数据集运行。</dataset></li></ol><h1 id="e767" class="mp mq iq bd mr ms mt mu mv mw mx my mz kf na kg nb ki nc kj nd kl ne km nf ng bi translated">推理</h1><p id="49d8" class="pw-post-body-paragraph lf lg iq lh b li nh ka lk ll ni kd ln lo nj lq lr ls nk lu lv lw nl ly lz ma ij bi translated">虽然 pytorch-transformers 使运行预训练模型甚至微调它们变得容易，但我发现在它上面运行推理很困难。因此，我复制了相关的功能，并修改它们以适应我的需要。</p><p id="b881" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">在 IMDB 电影评论数据集上微调 BERT 的所有细节可以在我早先的<a class="ae ko" href="https://medium.com/dsnet/running-pytorch-transformers-on-custom-datasets-717fd9e10fe2" rel="noopener">帖子</a>中找到。</p><p id="65f8" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">另一方面，从代码中可以看出，在 ULMFiT 上运行推理非常简单。</p><p id="635b" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">推理是通过后端的“/analyze”API 端点公开的，然后调用相关的函数来获得预测并在响应中返回它。</p><h1 id="2d85" class="mp mq iq bd mr ms mt mu mv mw mx my mz kf na kg nb ki nc kj nd kl ne km nf ng bi translated">前端</h1><p id="bf2b" class="pw-post-body-paragraph lf lg iq lh b li nh ka lk ll ni kd ln lo nj lq lr ls nk lu lv lw nl ly lz ma ij bi translated">前端使用 HTML、CSS 和 Javascript 开发。它使用额外的 jQuery 包来整合标尺、加载按钮和向上/向下滚动功能。为了提供实时交互，使用 AJAX 调用在每个单词后自动触发预测(稍有延迟，以防止在键入句子时触发不必要的事件),从而只更新标尺，而无需重新加载整个页面。</p><p id="836c" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">UI 还有一个选项，可以对任何评论的模型性能进行投票。这些信息被保存在一个 SQL 数据库中，这样我们以后就可以分析哪个模型对哪个评论更有效。</p><p id="2e51" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">我的 UI 技能相当有限，所以代码肯定不是最优雅的，但它完成了工作。</p><h1 id="5045" class="mp mq iq bd mr ms mt mu mv mw mx my mz kf na kg nb ki nc kj nd kl ne km nf ng bi translated">后端</h1><p id="5914" class="pw-post-body-paragraph lf lg iq lh b li nh ka lk ll ni kd ln lo nj lq lr ls nk lu lv lw nl ly lz ma ij bi translated">后端使用<a class="ae ko" href="https://flask.palletsprojects.com/en/1.1.x/" rel="noopener ugc nofollow" target="_blank"> FLASK </a> WSGI web 应用框架。它公开了 3 个 API 端点:</p><p id="4df6" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">/':对于主用户界面</p><p id="c5f2" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">“/analyze”:用于运行预测</p><p id="7816" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">/model-feedback ':用于提交对模型性能的反馈。</p><p id="d2d1" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">可以调用后端在调试或生产模式下运行。这是由一个。主应用程序文件夹中的“调试”文件。(即在调试模式下运行创建一个<em class="nn">。调试 apps 文件夹中的</em>文件)。</p><p id="28f6" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated"><a class="ae ko" href="https://docs.pylonsproject.org/projects/waitress/en/stable/" rel="noopener ugc nofollow" target="_blank"> <em class="nn">女服务员</em> </a>用于服务制作版。请注意，按照 Google App Engine 的指示，生产版本需要在端口 8080 上运行。</p><p id="6eee" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">后端使用<em class="nn">aiohttp</em>&amp;<em class="nn">asyncio</em>模块异步下载模型文件。</p><p id="8b38" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">我们还保存了客户端 IP 地址，以区分有多少不同的 IP 地址访问了该应用程序。因为在 GAE，应用程序位于 nginx 代理之后，所以我们必须使用<em class="nn"> request.access_route[0] </em>来检索它。</p><h1 id="a4fb" class="mp mq iq bd mr ms mt mu mv mw mx my mz kf na kg nb ki nc kj nd kl ne km nf ng bi translated">数据存储</h1><p id="5ab8" class="pw-post-body-paragraph lf lg iq lh b li nh ka lk ll ni kd ln lo nj lq lr ls nk lu lv lw nl ly lz ma ij bi translated">后端使用<a class="ae ko" href="https://www.sqlalchemy.org/" rel="noopener ugc nofollow" target="_blank"> SQLAlchemy </a>与谷歌的<a class="ae ko" href="https://cloud.google.com/sql/docs/mysql/" rel="noopener ugc nofollow" target="_blank">云 SQL </a>实例交互，将模型性能数据保存在 MySQL 数据库中。必须单独提供云 SQL 实例。Google App Engine 实例可以直接访问云 SQL 实例(通过云 SQL 连接名称字段)。请参考<a class="ae ko" href="https://cloud.google.com/sql/docs/mysql/" rel="noopener ugc nofollow" target="_blank">官方</a>文档，了解实例的配置。</p><h1 id="b344" class="mp mq iq bd mr ms mt mu mv mw mx my mz kf na kg nb ki nc kj nd kl ne km nf ng bi translated">部署到生产</h1><p id="64ba" class="pw-post-body-paragraph lf lg iq lh b li nh ka lk ll ni kd ln lo nj lq lr ls nk lu lv lw nl ly lz ma ij bi translated">因为我从谷歌获得了免费积分，所以我决定把这个应用程序放在它的基础设施上。起初我想部署一个虚拟机实例，但后来我遇到了 GAE，听起来非常完美。</p><p id="df62" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">让我们来看一下<em class="nn"> app.yaml </em>文件，该文件控制应用程序如何在 GAE 上托管</p><blockquote class="no np nq"><p id="372e" class="lf lg nn lh b li lj ka lk ll lm kd ln nr lp lq lr ns lt lu lv nt lx ly lz ma ij bi translated">运行时:自定义<br/> env: flex <br/>资源:<br/>CPU:2<br/>memory _ GB:4.0<br/>disk _ size _ GB:20<br/>readiness _ check:<br/>app _ start _ time out _ sec:900<br/>env _ variables:<br/>CLOUD _ SQL _ CONNECTION _ NAME:deployment-XXXXXX:xxxxxxxx:xxxxxxxx xx<br/>DB _ USER:xxxxxxxx<br/>DB _ PASS:XXXXXX<br/></p><p id="241b" class="lf lg nn lh b li lj ka lk ll lm kd ln nr lp lq lr ns lt lu lv nt lx ly lz ma ij bi translated">运行时:自定义<br/>环境:flex</p></blockquote><p id="2cf8" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">如果您正在部署 docker 容器，那么您需要使用灵活的环境(与标准环境相对)。自从我开始使用 docker 以来，我已经部署了相同的环境，但是我想转移到标准的环境，因为如果没有使用，这些实例可以缩减到 0。</p><blockquote class="no np nq"><p id="70d3" class="lf lg nn lh b li lj ka lk ll lm kd ln nr lp lq lr ns lt lu lv nt lx ly lz ma ij bi translated">资源:<br/> cpu: 2 <br/>内存 _gb: 4.0 <br/>磁盘 _ 大小 _gb: 20</p></blockquote><p id="86cf" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">我增加了默认实例的配置，选择了一个双 CPU 实例，内存为 4 GB，磁盘大小为 20 GB。在'<em class="nn"> google cloud deploy </em>'命令失败并且日志抛出“<em class="nn">设备上没有剩余空间</em>”错误后，我不得不增加磁盘大小。</p><blockquote class="no np nq"><p id="d0a5" class="lf lg nn lh b li lj ka lk ll lm kd ln nr lp lq lr ns lt lu lv nt lx ly lz ma ij bi translated">准备就绪 _ 检查:<br/> app_start_timeout_sec: 900</p></blockquote><p id="b068" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">在我收到“<em class="nn"> google cloud deploy </em>”命令失败后，我将应用程序启动超时从默认的 300 秒增加到 900 秒。</p><blockquote class="no np nq"><p id="b786" class="lf lg nn lh b li lj ka lk ll lm kd ln nr lp lq lr ns lt lu lv nt lx ly lz ma ij bi translated">env _ variables:<br/>CLOUD _ SQL _ CONNECTION _ NAME:deployment-XXXXXX:xxxxxxx:xxxxxxxx<br/>DB _ USER:xxxxxxx<br/>DB _ PASS:XXXXXX<br/>DB _ NAME:xxxxxxx</p></blockquote><p id="a5f9" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">将数据库凭证传递给后端 python 脚本需要这些设置。理想情况下，我们应该使用“云密钥管理”解决方案(或等效方案)</p><blockquote class="no np nq"><p id="f349" class="lf lg nn lh b li lj ka lk ll lm kd ln nr lp lq lr ns lt lu lv nt lx ly lz ma ij bi translated">beta _ settings:<br/>cloud _ SQL _ instances:deployment-XXXXXX:xxxxxxx:xxxxxxxx</p></blockquote><p id="c195" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">需要此设置来提供 GAE 和云 SQL 实例之间的连接。</p><h1 id="b89a" class="mp mq iq bd mr ms mt mu mv mw mx my mz kf na kg nb ki nc kj nd kl ne km nf ng bi translated">有趣的观察</h1><p id="63ce" class="pw-post-body-paragraph lf lg iq lh b li nh ka lk ll ni kd ln lo nj lq lr ls nk lu lv lw nl ly lz ma ij bi translated">在这一部分，我们将看看我发现的一些有趣的观察结果:</p><p id="3f8b" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">总的来说，ULMFiT 似乎很难处理短句(3-4 个单词)。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi nu"><img src="../Images/281995b91ba1eaf858919cdaba0aee93.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GEJ2DpmvouPDAsIP1zrNBw.png"/></div></div></figure><p id="a662" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">添加“.”最后改变置信度%。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi nv"><img src="../Images/4e942fa320ed7dd3007b62a6c8f20f77.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7LFxGQLR45pz-efVDfJ6mQ.png"/></div></div></figure><p id="31a6" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">仅仅增加一个额外的单词“It”就改变了对 ULMFiT 的预测。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi nw"><img src="../Images/c3a63ff4f269696df0487823c37f74b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tzR6CeFxjhmHQM4P2F3UcQ.png"/></div></div></figure><p id="163e" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">我想这两种情况都有可能。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi nx"><img src="../Images/b22c6d939adcd01f2a21ee89c74d47cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*38VrBNI-A7lyjsadh2WAEg.png"/></div></div></figure><p id="05ed" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">这个也一样。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi ny"><img src="../Images/4793b2e534710b6b2aa0d962f299c3ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gFWQscPWpHFhT7POwVwT9Q.png"/></div></div></figure><p id="425e" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">伯特在这里做得更好，因为我认为“高于平均水平”是积极的。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi nz"><img src="../Images/b252779890545e01d88a44f7b3993ac6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Nu0oLeoI3Dp3QAIFU9EM6Q.png"/></div></div></figure><p id="14d6" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">在这种情况下，两者都是正确的，但我们知道 ULMFiT 对于较短的句子偏向于否定。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi oa"><img src="../Images/90f9695c1fa891bd6e90544763ce50ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FS-D5voo1dd-W2b8ytVhCg.png"/></div></div></figure><p id="0a1c" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">很高兴看到这里的信心越来越强。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi ob"><img src="../Images/6e4136c584c2f49fe4cbd8c3f8d7204a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zBYVKK_FR7QxZELQy2Tvpg.png"/></div></div></figure><p id="d19b" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">很高兴看到伯特能把这件事做好。但是我们知道“高于平均水平”是负面的。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi oc"><img src="../Images/93abb4a537c4fbc31a5da0174400e693.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DTXKr6w48-NDDFWMCi39Vw.png"/></div></div></figure><p id="ce4c" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">但它得到的却是负面的。也许是因为刑期较短。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi od"><img src="../Images/4bd7278a89f4b0ce7ec9c4ab7b6d127e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BYljulyz8qvXbNjuDOYrJw.png"/></div></div></figure><p id="b416" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">这里都很好。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi oe"><img src="../Images/6f6c37e34a1272b5481a2a7049c224a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7MLXnGWyVO6PlIVwGS_iYw.png"/></div></div></figure><p id="f874" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">但这是什么？伯特仅仅通过去掉单词“was”就改变了它的预测。发生什么事了？</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi of"><img src="../Images/9a7a5f2f1d5dff787beb50bca25497ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QzvU3_Bfi73c3O3578X7wg.png"/></div></div></figure><p id="f89a" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">现在这个你会认为是负的，伯特错了，乌尔姆菲特对了。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi og"><img src="../Images/086d8de1eeb389d30d9a0f7bd06e2b6b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QyA32Gnnsv6JgewhUEe9Yw.png"/></div></div></figure><p id="8c8f" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">但是如果你去掉“黑暗”这个词，伯特就会改变它的预测。同样，不知道这是如何工作的。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi oh"><img src="../Images/5f1b291b6b876ebff06006db62a8e554.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ah3kSYu8TgwCLzct4bb_8Q.png"/></div></div></figure><p id="e26e" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">最后，我在 IMDB 上测试了 50 多条真实评论，我可以说这两个模型彼此非常一致，除了这一次 ULMFiT 似乎做出了更好的判断。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi oi"><img src="../Images/cad3611fa20332e6f34217619336b8c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ujx0Bcdy92wUDcjB-7O25A.png"/></div></div></figure><h1 id="18b9" class="mp mq iq bd mr ms mt mu mv mw mx my mz kf na kg nb ki nc kj nd kl ne km nf ng bi translated">结论</h1><p id="6073" class="pw-post-body-paragraph lf lg iq lh b li nh ka lk ll ni kd ln lo nj lq lr ls nk lu lv lw nl ly lz ma ij bi translated">虽然上面的例子确实表明 BERT 更擅长理解语言的语义，但是在现实世界中，当有多个句子时，两者之间没有太多选择。</p><p id="8819" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">如果更多的用户可以尝试这个应用程序，并提供他们对一种模式比另一种模式更好的情况的反馈，也许我们就可以选出一个赢家。</p><p id="3ee8" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated"><em class="nn">快速链接:</em><a class="ae ko" href="https://deployment-247905.appspot.com/" rel="noopener ugc nofollow" target="_blank"><em class="nn">【https://deployment-247905.appspot.com/】</em>T5】</a></p></div></div>    
</body>
</html>