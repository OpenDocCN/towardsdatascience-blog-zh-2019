<html>
<head>
<title>Create predictive models in R with Caret</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用插入符号在 R 中创建预测模型</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/create-predictive-models-in-r-with-caret-12baf9941236?source=collection_archive---------3-----------------------#2019-07-19">https://towardsdatascience.com/create-predictive-models-in-r-with-caret-12baf9941236?source=collection_archive---------3-----------------------#2019-07-19</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="c52c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">Caret 是<strong class="js iu"> <em class="ko"> C </em> </strong>分类<strong class="js iu"><em class="ko">A</em></strong>nd<strong class="js iu"><em class="ko">RE</em></strong>gression<strong class="js iu"><em class="ko">T</em></strong>raining。它是一个完整的包，涵盖了创建机器学习预测模型的所有阶段。在本教程中，我将解释以下主题:</p><ol class=""><li id="c61d" class="kp kq it js b jt ju jx jy kb kr kf ks kj kt kn ku kv kw kx bi translated">如何安装 caret</li><li id="86bf" class="kp kq it js b jt ky jx kz kb la kf lb kj lc kn ku kv kw kx bi translated">如何创建简单的模型</li><li id="0367" class="kp kq it js b jt ky jx kz kb la kf lb kj lc kn ku kv kw kx bi translated">如何使用交叉验证来避免过度拟合</li><li id="2428" class="kp kq it js b jt ky jx kz kb la kf lb kj lc kn ku kv kw kx bi translated">如何向数据添加简单的预处理</li><li id="a10f" class="kp kq it js b jt ky jx kz kb la kf lb kj lc kn ku kv kw kx bi translated">如何为您选择的模型找到最佳参数</li><li id="bfca" class="kp kq it js b jt ky jx kz kb la kf lb kj lc kn ku kv kw kx bi translated">如何查看模型中最重要的特征/变量</li><li id="a332" class="kp kq it js b jt ky jx kz kb la kf lb kj lc kn ku kv kw kx bi translated">如何使用你的模型来预测</li></ol><h1 id="8935" class="ld le it bd lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma bi translated">安装</h1><p id="9017" class="pw-post-body-paragraph jq jr it js b jt mb jv jw jx mc jz ka kb md kd ke kf me kh ki kj mf kl km kn im bi translated">安装 caret 就像在 r 中安装任何其他包一样简单。如果你使用的是 RStudio(推荐)，你也可以点击工具栏中的“工具”&gt;“安装包…”来安装它。</p><pre class="mg mh mi mj gt mk ml mm mn aw mo bi"><span id="26d9" class="mp le it ml b gy mq mr l ms mt">install.packages("caret")</span></pre><h1 id="be08" class="ld le it bd lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma bi translated">创建简单的模型</h1><p id="90fd" class="pw-post-body-paragraph jq jr it js b jt mb jv jw jx mc jz ka kb md kd ke kf me kh ki kj mf kl km kn im bi translated">我们将通过使用<strong class="js iu"> train() </strong>函数来实现这一点。函数<strong class="js iu"> train() </strong>是 caret 的核心函数。顾名思义，它用于训练模型，即将算法应用于一组数据，并创建代表该数据集的模型。</p><p id="4f77" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">train()函数有三个基本参数:</p><ol class=""><li id="e7c6" class="kp kq it js b jt ju jx jy kb kr kf ks kj kt kn ku kv kw kx bi translated">公式</li><li id="0ace" class="kp kq it js b jt ky jx kz kb la kf lb kj lc kn ku kv kw kx bi translated">资料组</li><li id="f928" class="kp kq it js b jt ky jx kz kb la kf lb kj lc kn ku kv kw kx bi translated">方法(或算法)</li></ol><p id="9805" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">公式</strong>参数是你指定什么是因变量(你要预测的)和自变量(特性)的地方。下面我会详细解释如何写你的公式。</p><p id="e6a6" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">数据集</strong>参数是您的数据。</p><p id="2dc3" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">方法</strong>参数是指定使用哪个分类或回归模型的字符串。</p><p id="93ed" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在本教程中，我将使用 mtcars 数据集。它是内置的 R 数据集之一。下面是关于这个数据集的解释:</p><h2 id="ccdb" class="mp le it bd lf mu mv dn lj mw mx dp ln kb my mz lr kf na nb lv kj nc nd lz ne bi translated">汽车趋势道路测试(mtcars)</h2><h2 id="087b" class="mp le it bd lf mu mv dn lj mw mx dp ln kb my mz lr kf na nb lv kj nc nd lz ne bi translated">描述</h2><p id="10ec" class="pw-post-body-paragraph jq jr it js b jt mb jv jw jx mc jz ka kb md kd ke kf me kh ki kj mf kl km kn im bi translated">该数据摘自 1974 年的《美国汽车趋势》杂志，包括 32 款汽车(1973-74 款)的油耗以及汽车设计和性能的 10 个方面。</p><p id="0bdd" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">用 11 个变量的 32 个观察值格式化一个数据框。</p><ol class=""><li id="701c" class="kp kq it js b jt ju jx jy kb kr kf ks kj kt kn ku kv kw kx bi translated">mpg:英里/(美国)加仑</li><li id="3ebd" class="kp kq it js b jt ky jx kz kb la kf lb kj lc kn ku kv kw kx bi translated">cyl:气缸数量</li><li id="cab5" class="kp kq it js b jt ky jx kz kb la kf lb kj lc kn ku kv kw kx bi translated">disp:排量(立方英寸)</li><li id="a4f7" class="kp kq it js b jt ky jx kz kb la kf lb kj lc kn ku kv kw kx bi translated">马力:总马力</li><li id="eaa7" class="kp kq it js b jt ky jx kz kb la kf lb kj lc kn ku kv kw kx bi translated">drat:后桥传动比</li><li id="22cd" class="kp kq it js b jt ky jx kz kb la kf lb kj lc kn ku kv kw kx bi translated">重量:重量(1000 磅)</li><li id="bb50" class="kp kq it js b jt ky jx kz kb la kf lb kj lc kn ku kv kw kx bi translated">qsec: 1/4 英里时间</li><li id="24e2" class="kp kq it js b jt ky jx kz kb la kf lb kj lc kn ku kv kw kx bi translated">vs: V/S</li><li id="8be9" class="kp kq it js b jt ky jx kz kb la kf lb kj lc kn ku kv kw kx bi translated">am:变速器(0 =自动，1 =手动)</li><li id="b518" class="kp kq it js b jt ky jx kz kb la kf lb kj lc kn ku kv kw kx bi translated">档位:前进档的数量</li><li id="a8c4" class="kp kq it js b jt ky jx kz kb la kf lb kj lc kn ku kv kw kx bi translated">碳水化合物:化油器数量</li></ol><p id="362c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">让我们来看看数据框。</p><pre class="mg mh mi mj gt mk ml mm mn aw mo bi"><span id="2d8d" class="mp le it ml b gy mq mr l ms mt">data(mtcars)    <em class="ko"># Load the dataset</em><br/>head(mtcars)</span></pre><figure class="mg mh mi mj gt ng gh gi paragraph-image"><div role="button" tabindex="0" class="nh ni di nj bf nk"><div class="gh gi nf"><img src="../Images/fe68ad6d52f98101437e9d97be8370f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JIG_JCbWFTYMy7ByljMNEQ.png"/></div></div></figure><pre class="mg mh mi mj gt mk ml mm mn aw mo bi"><span id="1e92" class="mp le it ml b gy mq mr l ms mt">?mtcars         <em class="ko"># Get more information about this dataset</em></span></pre><p id="c330" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">现在，让我们创建回归模型，根据其他属性预测汽车模型可以行驶多少英里每加仑(mpg)。</p><p id="a992" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">公式</strong>可以写成“<strong class="js iu"> x ~ y，z，w”</strong>其中 x 是因变量，我们这里是 mpg，y，z，w 是自变量。如果你想传递所有的属性，你可以把它写成“<strong class="js iu"> x ~。</strong><strong class="js iu">。</strong></p><pre class="mg mh mi mj gt mk ml mm mn aw mo bi"><span id="af15" class="mp le it ml b gy mq mr l ms mt"><strong class="ml iu">library</strong>(caret)</span><span id="2bd5" class="mp le it ml b gy nn mr l ms mt"><em class="ko"># Simple linear regression model (lm means linear model)</em><br/>model &lt;- train(mpg ~ wt,<br/>               data = mtcars,<br/>               method = "lm")<br/><br/><em class="ko"># Multiple linear regression model</em><br/>model &lt;- train(mpg ~ .,<br/>               data = mtcars,<br/>               method = "lm")<br/><br/><em class="ko"># Ridge regression model</em><br/>model &lt;- train(mpg ~ .,<br/>               data = mtcars,<br/>               method = "ridge") <em class="ko"># Try using "lasso"</em></span></pre><p id="e529" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这就是如何使用函数<strong class="js iu"> train() </strong>创建不同的基本模型。很简单，不是吗？</p><h1 id="ff7e" class="ld le it bd lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma bi translated">k 倍交叉验证</h1><p id="2f2b" class="pw-post-body-paragraph jq jr it js b jt mb jv jw jx mc jz ka kb md kd ke kf me kh ki kj mf kl km kn im bi translated">函数<strong class="js iu"> train() </strong>有其他可选参数。让我们学习如何通过向我们的<strong class="js iu"> train() </strong>函数添加参数<strong class="js iu">tr control</strong>(train control)来向我们的模型添加重采样。</p><p id="13f8" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">重采样过程可以通过使用 K 重交叉验证、留一交叉验证或引导来完成。在这个例子中，我们将使用 10 重交叉验证。为此，我们需要使用另一个插入符号函数，<strong class="js iu"> trainControl() </strong>。检查下面的代码。</p><pre class="mg mh mi mj gt mk ml mm mn aw mo bi"><span id="56d8" class="mp le it ml b gy mq mr l ms mt"><em class="ko">## 10-fold CV</em></span><span id="6cb5" class="mp le it ml b gy nn mr l ms mt"><em class="ko"># possible values: boot", "boot632", "cv", "repeatedcv", "LOOCV", "LGOCV"<br/></em>fitControl &lt;- trainControl(method = "repeatedcv",   <br/>                           number = 10,     <em class="ko"># number of folds</em><br/>                           repeats = 10)    <em class="ko"># repeated ten times</em><br/><br/>model.cv &lt;- train(mpg ~ .,<br/>               data = mtcars,<br/>               method = "lasso",  <em class="ko"># now we're using the lasso method</em><br/>               trControl = fitControl)  <br/><br/>model.cv   </span><span id="2189" class="mp le it ml b gy nn mr l ms mt">## The lasso <br/>## <br/>## 32 samples<br/>## 10 predictors<br/>## <br/>## No pre-processing<br/>## Resampling: Cross-Validated (10 fold, repeated 10 times) <br/>## Summary of sample sizes: 28, 30, 28, 28, 29, 29, ... <br/>## Resampling results across tuning parameters:<br/>## <br/>##   fraction  RMSE      Rsquared   MAE     <br/>##   0.1       4.660950  0.8873870  3.841383<br/>##   0.5       2.824138  0.8735388  2.468004<br/>##   0.9       3.243825  0.8400985  2.797594<br/>## <br/>## RMSE was used to select the optimal model using the smallest value.<br/>## The final value used for the model was fraction = 0.5.</span></pre><h1 id="e26b" class="ld le it bd lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma bi translated">添加预处理</h1><p id="d897" class="pw-post-body-paragraph jq jr it js b jt mb jv jw jx mc jz ka kb md kd ke kf me kh ki kj mf kl km kn im bi translated"><strong class="js iu"> train() </strong>函数还有另一个可选参数叫做<strong class="js iu">预处理</strong>。它用于为您的数据添加一些预处理。</p><p id="0c6a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在本例中，我们将使用以下预处理:</p><ol class=""><li id="63e0" class="kp kq it js b jt ju jx jy kb kr kf ks kj kt kn ku kv kw kx bi translated">中心数据(即计算每列的平均值，并从每个相应的值中减去它)；</li><li id="95c8" class="kp kq it js b jt ky jx kz kb la kf lb kj lc kn ku kv kw kx bi translated">缩放数据(即将所有数据放在同一个刻度上，例如从 0 到 1 的刻度)</li></ol><p id="732a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">但是，还有更多的预处理可能性，如“BoxCox”、“YeoJohnson”、“expoTrans”、“range”、“knnImpute”、“bagImpute”、“medianImpute”、“pca”、“ica”和“spatialSign”。</p><pre class="mg mh mi mj gt mk ml mm mn aw mo bi"><span id="3329" class="mp le it ml b gy mq mr l ms mt">model.cv &lt;- train(mpg ~ .,<br/>               data = mtcars,<br/>               method = "lasso",<br/>               trControl = fitControl,<br/>               preProcess = c('scale', 'center')) <em class="ko"># default: no pre-processing</em><br/><br/>?train    # if you need more information about the train function<br/></span><span id="d5d8" class="mp le it ml b gy nn mr l ms mt">model.cv</span><span id="a675" class="mp le it ml b gy nn mr l ms mt">## The lasso <br/>## <br/>## 32 samples<br/>## 10 predictors<br/>## <br/>## Pre-processing: scaled (10), centered (10) <br/>## Resampling: Cross-Validated (10 fold, repeated 10 times) <br/>## Summary of sample sizes: 29, 30, 29, 28, 29, 29, ... <br/>## Resampling results across tuning parameters:<br/>## <br/>##   fraction  RMSE      Rsquared   MAE     <br/>##   0.1       4.597673  0.9072492  3.821535<br/>##   0.5       2.755728  0.8968303  2.411330<br/>##   0.9       3.183950  0.8820037  2.778551<br/>## <br/>## RMSE was used to select the optimal model using the smallest value.<br/>## The final value used for the model was fraction = 0.5.</span></pre><h1 id="a784" class="ld le it bd lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma bi translated">寻找模型超参数</h1><p id="0917" class="pw-post-body-paragraph jq jr it js b jt mb jv jw jx mc jz ka kb md kd ke kf me kh ki kj mf kl km kn im bi translated">通过使用<strong class="js iu"> tuneGrid </strong>参数，我们可以找到模型的最佳超参数。该参数接收具有可能调谐值的数据帧。dataframe 列的名称与优化参数的名称相同。</p><p id="8b1c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">为了生成可能的值，我将使用基本库中的<strong class="js iu"> expand.grid </strong>函数。为了解释 tuneGrid 的用法，我将使用岭回归法。</p><h2 id="5166" class="mp le it bd lf mu mv dn lj mw mx dp ln kb my mz lr kf na nb lv kj nc nd lz ne bi translated">简短解释</h2><p id="659f" class="pw-post-body-paragraph jq jr it js b jt mb jv jw jx mc jz ka kb md kd ke kf me kh ki kj mf kl km kn im bi translated">随着λ的增长，岭方法将预测变量的系数向 0 收缩。收缩效应降低了模型的灵活性，也降低了其方差，但增加了偏差。岭回归的思想是找到λ的值，该值是偏差和方差之间令人满意的折衷。</p><p id="42d2" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">使用下面的代码，我们可以找到 10^-2 到 10^10.之间岭回归的最佳 lambda 参数</p><pre class="mg mh mi mj gt mk ml mm mn aw mo bi"><span id="587d" class="mp le it ml b gy mq mr l ms mt"><em class="ko"># Here I generate a dataframe with a column named lambda with 100 values that goes from 10^10 to 10^-2</em><br/>lambdaGrid &lt;- expand.grid(lambda = 10^seq(10, -2, length=100))<br/><br/>model.cv &lt;- train(mpg ~ .,<br/>               data = mtcars,<br/>               method = "ridge",<br/>               trControl = fitControl,<br/>               preProcess = c('scale', 'center'),<br/>               tuneGrid = lambdaGrid,   <em class="ko"># Test all the lambda values in the lambdaGrid dataframe</em><br/>               na.action = na.omit)   <em class="ko"># Ignore NA values</em><br/><br/>model.cv</span><span id="c451" class="mp le it ml b gy nn mr l ms mt"><br/>## Ridge Regression <br/>## <br/>## 32 samples<br/>## 10 predictors<br/>## <br/>## Pre-processing: scaled (10), centered (10) <br/>## Resampling: Cross-Validated (10 fold, repeated 10 times) <br/>## Summary of sample sizes: 28, 29, 28, 29, 30, 28, ... <br/>## Resampling results across tuning parameters:<br/>## <br/>##   lambda        RMSE       Rsquared   MAE      <br/>##   1.000000e-02   3.133764  0.8542752   2.700711<br/>##   1.321941e-02   3.097225  0.8559508   2.670390<br/>##   1.747528e-02   3.057315  0.8583961   2.637061<br/>##   2.310130e-02   3.015005  0.8621809   2.600386<br/>##   3.053856e-02   2.971543  0.8672769   2.562851</span><span id="f565" class="mp le it ml b gy nn mr l ms mt">... # too much output so i cut it out</span><span id="fda9" class="mp le it ml b gy nn mr l ms mt">##   1.000000e+10  25.370412  0.8901093  23.047829<br/>## <br/>## RMSE was used to select the optimal model using the smallest value.<br/>## The final value used for the model was lambda = 0.1629751.</span></pre><p id="3a3d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">当您调用<strong class="js iu"> model.cv </strong>时，您可以看到您测试的每个 lambda 值的度量 RMSE、Rsquared 和 MAE，并且模型还输出测试值中 lambda 的最佳选择。在这种情况下，λ= 0.1629751。</p><p id="192a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">还有另一种搜索超参数的方法，不需要将值列表传递给<strong class="js iu"> train() </strong>函数。我们可以在<strong class="js iu"> trainControl() </strong>中使用<strong class="js iu"> search = "random" </strong>，该函数将自动测试一系列值。</p><pre class="mg mh mi mj gt mk ml mm mn aw mo bi"><span id="6f32" class="mp le it ml b gy mq mr l ms mt">fitControl &lt;- trainControl(<em class="ko">## 10-fold CV</em><br/>                           method = "repeatedcv",<br/>                           number = 10,<br/>                           repeats = 10,<br/>                           search = "random")  <em class="ko"># hyper-parameters random search </em><br/><br/>model.cv &lt;- train(mpg ~ .,<br/>               data = mtcars,<br/>               method = "ridge",<br/>               trControl = fitControl,<br/>               preProcess = c('scale', 'center'),<br/>               na.action = na.omit)<br/><br/>model.cv</span><span id="e410" class="mp le it ml b gy nn mr l ms mt">## Ridge Regression <br/>## <br/>## 32 samples<br/>## 10 predictors<br/>## <br/>## Pre-processing: scaled (10), centered (10) <br/>## Resampling: Cross-Validated (10 fold, repeated 10 times) <br/>## Summary of sample sizes: 28, 29, 29, 29, 28, 28, ... <br/>## Resampling results across tuning parameters:<br/>## <br/>##   lambda        RMSE       Rsquared   MAE      <br/>##   7.830203e-05   3.428075  0.8533706   2.950310<br/>##   9.214823e-05   3.427668  0.8533953   2.949997<br/>##   8.645309e+00  15.314730  0.9024834  13.994384<br/>## <br/>## RMSE was used to select the optimal model using the smallest value.<br/>## The final value used for the model was lambda = 9.214823e-05.</span></pre><h1 id="9064" class="ld le it bd lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma bi translated">可变重要性</h1><p id="7568" class="pw-post-body-paragraph jq jr it js b jt mb jv jw jx mc jz ka kb md kd ke kf me kh ki kj mf kl km kn im bi translated">现在，让我们学习如何查看哪些是我们模型中最重要的变量。我们可以使用插入符号函数<strong class="js iu"> varImp </strong>。<strong class="js iu"> varImp </strong>的返回可以传递给函数<strong class="js iu"> ggplot </strong>以生成可视化。</p><pre class="mg mh mi mj gt mk ml mm mn aw mo bi"><span id="5120" class="mp le it ml b gy mq mr l ms mt">ggplot(varImp(model.cv))</span></pre><figure class="mg mh mi mj gt ng gh gi paragraph-image"><div class="gh gi no"><img src="../Images/889b47310a3d6197207e4f582c5b3bc7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1354/format:webp/1*UkRGGRqKuc_KSn22NoGZew.png"/></div></figure><p id="e2c5" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">正如我们在图中看到的，位移变量对我们的预测模型最重要。</p><h1 id="5fc2" class="ld le it bd lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma bi translated">预言</h1><p id="269c" class="pw-post-body-paragraph jq jr it js b jt mb jv jw jx mc jz ka kb md kd ke kf me kh ki kj mf kl km kn im bi translated">最后，我们可以使用函数<strong class="js iu"> predict </strong>来预测汽车的性能，即每加仑汽油可以行驶多少英里。我将传递与生成模型相同的数据帧作为参数，只是为了展示函数是如何工作的。</p><p id="15bf" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在一个真实的项目中，你会使用一个更大的数据帧，并把它分成一个训练集和一个测试集，但这不是这里的目的。</p><pre class="mg mh mi mj gt mk ml mm mn aw mo bi"><span id="d841" class="mp le it ml b gy mq mr l ms mt">predictions &lt;- predict(model.cv, mtcars)<br/><br/>predictions</span><span id="08de" class="mp le it ml b gy nn mr l ms mt">##           Mazda RX4       Mazda RX4 Wag          Datsun 710 <br/>##            22.59767            22.11103            26.25381 <br/>##      Hornet 4 Drive   Hornet Sportabout             Valiant <br/>##            21.23520            17.69025            20.38318 <br/>##          Duster 360           Merc 240D            Merc 230 <br/>##            14.38382            22.49686            24.41665 <br/>##            Merc 280           Merc 280C          Merc 450SE <br/>##            18.70104            19.19260            14.17669 <br/>##          Merc 450SL         Merc 450SLC  Cadillac Fleetwood <br/>##            15.60112            15.74344            12.03039 <br/>## Lincoln Continental   Chrysler Imperial            Fiat 128 <br/>##            10.93585            10.49555            27.77480 <br/>##         Honda Civic      Toyota Corolla       Toyota Corona <br/>##            29.89355            29.51135            23.64401 <br/>##    Dodge Challenger         AMC Javelin          Camaro Z28 <br/>##            16.94227            17.73144            13.30775 <br/>##    Pontiac Firebird           Fiat X1-9       Porsche 914-2 <br/>##            16.68855            28.29431            26.15559 <br/>##        Lotus Europa      Ford Pantera L        Ferrari Dino <br/>##            27.63590            18.87023            19.69368 <br/>##       Maserati Bora          Volvo 142E <br/>##            13.93917            24.37227</span></pre><p id="a41a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">您可以将预测值与真实值进行比较。有一些指标可以用来判断你的模型是否是一个好的预测器，但是我们不打算在这里深入讨论。</p><p id="461e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">感谢您的阅读。我希望这是一次有益而愉快的阅读。</p></div></div>    
</body>
</html>