<html>
<head>
<title>The art of the upvote: using NLP to predict upvotes based on headline</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">上行投票的艺术:使用 NLP 根据标题预测上行投票</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/the-art-of-the-upvote-using-nlp-to-predict-upvotes-based-on-headline-458408be3c73?source=collection_archive---------34-----------------------#2019-10-24">https://towardsdatascience.com/the-art-of-the-upvote-using-nlp-to-predict-upvotes-based-on-headline-458408be3c73?source=collection_archive---------34-----------------------#2019-10-24</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/c68e2e06f9f0a56d9e7a2fc709276ab5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GM48vFtL7NpZTFF-IH7_sA.png"/></div></div></figure><div class=""/><p id="83b5" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我最喜欢的项目是那些试图理解人类行为和行动的项目。无论是试图预测自行车租赁最受欢迎的工作日，还是教育水平与个人是否喜欢原版《星球大战》三部曲有任何关系。</p><p id="8862" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在线互动，尤其是在论坛中，非常有趣，因为它们是如此的被动和无形。一个简单的“喜欢”或“赞成”可以是有意的，也可以是无意义的。与脸书和 Instagram 不同，论坛大多是匿名的。这个事实使得像 Reddit 和 Hacker News 这样的地方特别有趣。</p></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><h2 id="7689" class="lg lh je bd li lj lk dn ll lm ln dp lo km lp lq lr kq ls lt lu ku lv lw lx ly bi translated">目标</h2><p id="040e" class="pw-post-body-paragraph kb kc je kd b ke lz kg kh ki ma kk kl km mb ko kp kq mc ks kt ku md kw kx ky im bi translated">我在这个项目中的目标是根据标题预测黑客新闻文章获得的投票数。由于 upvotes 是受欢迎程度的一个指标，我想发现哪种类型的文章最受用户欢迎。</p><h2 id="564f" class="lg lh je bd li lj lk dn ll lm ln dp lo km lp lq lr kq ls lt lu ku lv lw lx ly bi translated">数据</h2><p id="375d" class="pw-post-body-paragraph kb kc je kd b ke lz kg kh ki ma kk kl km mb ko kp kq mc ks kt ku md kw kx ky im bi translated">该项目使用的数据是 2006 年至 2015 年用户向《黑客新闻》提交的资料。这个数据是开发者 Arnaud Drizard 利用黑客新闻 API 刮出来的，可以在这里找到<a class="ae me" href="https://github.com/arnauddri/hn" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="5953" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我从数据中随机抽取了 300 行，并删除了除提交时间、upvotes、url 和 headline 之外的无关列。</p><figure class="mg mh mi mj gt iv gh gi paragraph-image"><div class="gh gi mf"><img src="../Images/de64ae27b51e850dd4cfde19c8e832ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1194/format:webp/1*AKlSV0xDFvix_-SYvDC0aA.png"/></div></figure><h1 id="6ff5" class="mk lh je bd li ml mm mn ll mo mp mq lo mr ms mt lr mu mv mw lu mx my mz lx na bi translated">现在是有趣的部分，NLP！😎</h1><p id="e470" class="pw-post-body-paragraph kb kc je kd b ke lz kg kh ki ma kk kl km mb ko kp kq mc ks kt ku md kw kx ky im bi translated">我选择使用单词包模型，它描述了单词在文档中的出现，或者在我们的例子中是标题。这包括以下步骤:</p><ol class=""><li id="20ba" class="nb nc je kd b ke kf ki kj km nd kq ne ku nf ky ng nh ni nj bi translated">标记每个标题</li><li id="7663" class="nb nc je kd b ke nk ki nl km nm kq nn ku no ky ng nh ni nj bi translated">创建独特单词的集合或“词汇表”</li><li id="dffd" class="nb nc je kd b ke nk ki nl km nm kq nn ku no ky ng nh ni nj bi translated">创建单词袋矩阵</li><li id="abc9" class="nb nc je kd b ke nk ki nl km nm kq nn ku no ky ng nh ni nj bi translated">给标题中的每个单词打分</li><li id="e026" class="nb nc je kd b ke nk ki nl km nm kq nn ku no ky ng nh ni nj bi translated">管理词汇</li></ol><h2 id="577b" class="lg lh je bd li lj lk dn ll lm ln dp lo km lp lq lr kq ls lt lu ku lv lw lx ly bi translated">标记化</h2><p id="3dad" class="pw-post-body-paragraph kb kc je kd b ke lz kg kh ki ma kk kl km mb ko kp kq mc ks kt ku md kw kx ky im bi translated">第一步是标记每个标题。每个标题都表示为一个字符串。标记化包括将这些单个字符串拆分成标题中的几个单个单词(标记)的字符串。这对于稍后创建词汇和单词包矩阵是必要的。</p><figure class="mg mh mi mj gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi np"><img src="../Images/212a8a529036157eaea236703b90f791.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kDmTzHIY5h1onggnqQx-sg.jpeg"/></div></div><figcaption class="nq nr gj gh gi ns nt bd b be z dk">Example of tokenization</figcaption></figure><h2 id="f3b8" class="lg lh je bd li lj lk dn ll lm ln dp lo km lp lq lr kq ls lt lu ku lv lw lx ly bi translated">创建词汇和词汇包向量</h2><p id="302f" class="pw-post-body-paragraph kb kc je kd b ke lz kg kh ki ma kk kl km mb ko kp kq mc ks kt ku md kw kx ky im bi translated">每个独特的单词都成为词汇的一部分。我选择将词汇表转换成熊猫数据框，如下所示。这允许我在下一步填充数据框，并将其用作单词袋矩阵。</p><figure class="mg mh mi mj gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nu"><img src="../Images/60b901da5fb1bc67f8447dcf1dc52d13.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gQeyQNFhlGebJRFgEGKv0A.jpeg"/></div></div><figcaption class="nq nr gj gh gi ns nt bd b be z dk">data frame of BoW vocabulary</figcaption></figure><p id="a384" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">数据框中的每一行代表数据集中每个索引处的标题。此时，矩阵中充满了 0，因为我还没有对标题中的单词进行评分。</p><h2 id="0a21" class="lg lh je bd li lj lk dn ll lm ln dp lo km lp lq lr kq ls lt lu ku lv lw lx ly bi translated">得分单词</h2><p id="13ee" class="pw-post-body-paragraph kb kc je kd b ke lz kg kh ki ma kk kl km mb ko kp kq mc ks kt ku md kw kx ky im bi translated">最简单的计分方法是计算每个单词的出现次数。我用这种方法来填充矩阵。</p><figure class="mg mh mi mj gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nv"><img src="../Images/f6397d5132a0f3a0fc9e61037d68460a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*60_zDGoKibFG2cJXJA4Eyw.jpeg"/></div></div><figcaption class="nq nr gj gh gi ns nt bd b be z dk">bag of words matrix</figcaption></figure><h2 id="738d" class="lg lh je bd li lj lk dn ll lm ln dp lo km lp lq lr kq ls lt lu ku lv lw lx ly bi translated">管理词汇</h2><p id="ec39" class="pw-post-body-paragraph kb kc je kd b ke lz kg kh ki ma kk kl km mb ko kp kq mc ks kt ku md kw kx ky im bi translated">此时，我有一个相对较大的数据框架。减少它的一个简单的方法是删除停用词。停用词是这样的词:a，and，the，it，is 等。那不代表任何真正的意义。这样做应该会减少下一节中计算的误差量。</p></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><h1 id="8dfc" class="mk lh je bd li ml nw mn ll mo nx mq lo mr ny mt lr mu nz mw lu mx oa mz lx na bi translated">训练模型和进行预测</h1><p id="7919" class="pw-post-body-paragraph kb kc je kd b ke lz kg kh ki ma kk kl km mb ko kp kq mc ks kt ku md kw kx ky im bi translated">回到我的目标，我想训练一个模型来预测一个标题将获得的支持票数。在转移到更复杂的模型之前，最好先看看一个简单的模型是否能完成工作。</p><h2 id="1584" class="lg lh je bd li lj lk dn ll lm ln dp lo km lp lq lr kq ls lt lu ku lv lw lx ly bi translated">线性回归</h2><p id="b7d2" class="pw-post-body-paragraph kb kc je kd b ke lz kg kh ki ma kk kl km mb ko kp kq mc ks kt ku md kw kx ky im bi translated">我将使用 sci kit-learn<strong class="kd jf"><em class="ob">train _ test _ split</em></strong>函数将我的数据分成训练集和测试集。我将 80%用于训练，20%用于测试，并使用均方差作为我的误差度量。</p><figure class="mg mh mi mj gt iv"><div class="bz fp l di"><div class="oc od l"/></div><figcaption class="nq nr gj gh gi ns nt bd b be z dk">X: bag of words matrix; y: upvotes</figcaption></figure><p id="5f2e" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我最终得到的 MSE 是 2361.02，这导致了 48.59 的 RMSE。这意味着平均误差与真实值相差 48.59 票。考虑到我的数据的平均投票数是 10，这是一个很大的错误。我将使用随机森林模型再次尝试，看看更复杂的模型是否能帮助我减少错误。</p><h2 id="5c74" class="lg lh je bd li lj lk dn ll lm ln dp lo km lp lq lr kq ls lt lu ku lv lw lx ly bi translated">随机森林</h2><figure class="mg mh mi mj gt iv"><div class="bz fp l di"><div class="oc od l"/></div></figure><p id="a9f7" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">使用随机森林只是稍微增加了我的模型的准确性，从误差 48.59 到 45.41。这仍然是一个很大的误差。标题可能不是预测上行投票的最佳特征，因为它不一定指示帖子活动。评论数量和提交时间可能是更好的功能。</p><p id="f69d" class="pw-post-body-paragraph kb kc je kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><em class="ob">也许在第二部里？</em></p></div></div>    
</body>
</html>