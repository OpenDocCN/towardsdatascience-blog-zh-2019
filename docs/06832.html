<html>
<head>
<title>Hey, Can (A)I Get Your Number?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">嘿，能给我你的号码吗？</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/hey-can-a-i-get-your-number-805eda62419f?source=collection_archive---------24-----------------------#2019-09-28">https://towardsdatascience.com/hey-can-a-i-get-your-number-805eda62419f?source=collection_archive---------24-----------------------#2019-09-28</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/849efca217df7c12326482d05c0d7d5c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XcOCNnxuA0Tx3vjRIfp8GQ.jpeg"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk">Source: BGR</figcaption></figure><h2 id="1dd7" class="jg jh ji bd b dl jj jk jl jm jn jo dk jp translated" aria-label="kicker paragraph">现代科学的逐步指南</h2><div class=""/><div class=""><h2 id="9210" class="pw-subtitle-paragraph ko jr ji bd b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf dk translated">用 CNN 帮助爱情在 21 世纪蓬勃发展</h2></div><p id="a2b7" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">好吧，听着。他们刚认识你——这太疯狂了。</p><p id="5bab" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">但是你不知何故得到了他们的电话号码，所以现在你要打电话给他们…也许。</p><p id="86ae" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">(除非你出生在 2000 年之后，在这种情况下，你会不惜一切代价避免给别人打电话——发短信就行了，怪人。)</p><p id="0fdf" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">只有一个问题。你刚做了 Lasik 眼科手术:</p><figure class="md me mf mg gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi mc"><img src="../Images/00af561a993224abf8a427d058f6007c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*I9jf9OW3E1hdXQ7x1zuLAA.jpeg"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk">You clearly CANNOT see what that says (roll with me on this)</figcaption></figure><p id="7ddd" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">现在你看起来像斯蒂维·旺德，你看不到 SH*T，更不用说这张纸上的数字了。在你绝望的时候，你左顾右盼，寻找一个能让你在意识到自己什么也看不见之前跳下去的高处。</p><figure class="md me mf mg gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi mh"><img src="../Images/ce791bdfb6e0e526e97371b46f8f3739.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GWNhXAvIHs1VTNO8GEjVEA.jpeg"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk">This is you for the next 6 hours. Maybe you’ll get singing superpowers too. (Britannica)</figcaption></figure><p id="054d" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">但是等等。这不是结束。你已经有了一个变通办法:一个如此疯狂的计划，它可能会奏效</p><blockquote class="mj"><p id="3ea4" class="mk ml ji bd mm mn mo mp mq mr ms mb dk translated">你要用人工智能。</p></blockquote><p id="ab53" class="pw-post-body-paragraph lg lh ji li b lj mt ks ll lm mu kv lo lp mv lr ls lt mw lv lw lx mx lz ma mb im bi translated">等等，什么？艾！？瓦力现在能帮你什么？</p><figure class="md me mf mg gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi my"><img src="../Images/050ef69ecb84c835eef515d345ed4961.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TJPRwFmuB9oWyh7uKh-mUA.png"/></div></div></figure><p id="f7be" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">看，这有点误解——人工智能不一定意味着机器人。</p><blockquote class="mj"><p id="124f" class="mk ml ji bd mm mn mo mp mq mr ms mb dk translated">人工智能描述了计算机执行人类可以完成的任务。</p></blockquote><p id="74fe" class="pw-post-body-paragraph lg lh ji li b lj mt ks ll lm mu kv lo lp mv lr ls lt mw lv lw lx mx lz ma mb im bi translated">诸如“看到”手写数字的图片并识别它们是什么数字之类的任务。当谈到图像分类时，我们通常使用一种称为卷积神经网络或 CNN 的结构。查看<a class="ae mz" href="https://medium.com/@igrandic03/what-defines-a-rubber-duck-cb5545650662" rel="noopener">这篇文章</a>，深入分析它们是如何工作的——但这里有一个简短的总结:</p><ul class=""><li id="b117" class="na nb ji li b lj lk lm ln lp nc lt nd lx ne mb nf ng nh ni bi translated">神经网络有<strong class="li js">层</strong>。CNN 的每一层都在寻找某些<strong class="li js">特征</strong>。</li><li id="00b9" class="na nb ji li b lj nj lm nk lp nl lt nm lx nn mb nf ng nh ni bi translated">图像被分成几部分来看，搜索和映射特征。<strong class="li js">特征映射</strong>通过像素数给出特定特征出现的概率位置。</li><li id="f4f4" class="na nb ji li b lj nj lm nk lp nl lt nm lx nn mb nf ng nh ni bi translated">我们可以通过从更小的增量中取最大值来简化复杂的地图，我们将图像分解成更小的新图像。这叫做<strong class="li js">池</strong>。</li><li id="59e6" class="na nb ji li b lj nj lm nk lp nl lt nm lx nn mb nf ng nh ni bi translated">然后，我们通过一个<strong class="li js"> ReLU </strong>(整流线性单位)函数运行所有这些值，该函数将所有负值变为 0。</li><li id="8435" class="na nb ji li b lj nj lm nk lp nl lt nm lx nn mb nf ng nh ni bi translated">我们可以多次映射、合并和重新逻辑，以变得更加精确。这些可以被编译成对应于每个标签或结果的<strong class="li js">连接层</strong>。</li><li id="b423" class="na nb ji li b lj nj lm nk lp nl lt nm lx nn mb nf ng nh ni bi translated">CNN 通过使用<strong class="li js">加权像素</strong>来确定每种结果的概率，并给出它对图像内容的最佳猜测。</li></ul><p id="05d8" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">很刺激，对吧？</p></div><div class="ab cl no np hx nq" role="separator"><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt"/></div><div class="im in io ip iq"><blockquote class="mj"><p id="6b76" class="mk ml ji bd mm mn mo mp mq mr ms mb dk translated">那么，你到底如何利用这项惊人的技术呢？</p></blockquote><p id="949a" class="pw-post-body-paragraph lg lh ji li b lj mt ks ll lm mu kv lo lp mv lr ls lt mw lv lw lx mx lz ma mb im bi translated">幸运的是，你是一个键盘高手，甚至不需要<em class="mi">看到屏幕就能做到这一点——下面是它的分解:</em></p><ol class=""><li id="e9c8" class="na nb ji li b lj lk lm ln lp nc lt nd lx ne mb nv ng nh ni bi translated">你在做数据科学——你需要数据！</li><li id="4365" class="na nb ji li b lj nj lm nk lp nl lt nm lx nn mb nv ng nh ni bi translated">然后你要看看数据是否平衡和可用。</li><li id="3677" class="na nb ji li b lj nj lm nk lp nl lt nm lx nn mb nv ng nh ni bi translated">准备好你的资料。</li><li id="ebad" class="na nb ji li b lj nj lm nk lp nl lt nm lx nn mb nv ng nh ni bi translated">用模型上的数据训练和测试 CNN。</li><li id="c416" class="na nb ji li b lj nj lm nk lp nl lt nm lx nn mb nv ng nh ni bi translated">用你刚拿到的电话号码查一下。</li></ol><h1 id="a8e7" class="nw nx ji bd ny nz oa ob oc od oe of og kx oh ky oi la oj lb ok ld ol le om on bi translated">1.让我们得到这些数据</h1><figure class="md me mf mg gt iv gh gi paragraph-image"><div class="gh gi oo"><img src="../Images/7bd85100bc6426ff3f76bc2e3a79b9bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1390/1*HCHq9hlpx0RCqDhpYELNfg.gif"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk">(Giphy)</figcaption></figure><p id="99a6" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">Kaggle 是一个数据科学竞赛平台，在这里你可以找到免费的数据集。通常情况下，你必须得到手写数字的照片，把它们转换成。包含其特征的 csv 文件，然后通过模型运行该文件来训练它。</p><p id="f92d" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">幸运的是，我们现在还不需要这么做——你可以在这里从 MNIST<a class="ae mz" href="https://www.kaggle.com/c/digit-recognizer" rel="noopener ugc nofollow" target="_blank">数据集</a>中获得这些数据。我们还必须添加一些依赖项，为我们提供实现这一目标的工具:</p><pre class="md me mf mg gt op oq or os aw ot bi"><span id="06e1" class="ou nx ji oq b gy ov ow l ox oy">import pandas as pd<br/>import numpy as np<br/>import matplotlib.pyplot as plt<br/>import matplotlib.image as mpimg<br/>import seaborn as sns<br/>%matplotlib inline</span><span id="1d70" class="ou nx ji oq b gy oz ow l ox oy">np.random.seed(2)</span><span id="0f94" class="ou nx ji oq b gy oz ow l ox oy">from sklearn.model_selection import train_test_split<br/>from sklearn.metrics import confusion_matrix<br/>import itertools</span><span id="6081" class="ou nx ji oq b gy oz ow l ox oy">from keras.utils.np_utils import to_categorical # convert to one-hot-encoding<br/>from keras.models import Sequential<br/>from keras.layers import Dense, Dropout, Flatten, Conv2D, MaxPool2D<br/>from keras.optimizers import RMSprop<br/>from keras.preprocessing.image import ImageDataGenerator<br/>from keras.callbacks import ReduceLROnPlateau</span><span id="9e26" class="ou nx ji oq b gy oz ow l ox oy">sns.set(style=’white’, context=’notebook’, palette=’deep’)</span></pre><h1 id="d7a4" class="nw nx ji bd ny nz oa ob oc od oe of og kx oh ky oi la oj lb ok ld ol le om on bi translated">2.平衡程度如何？</h1><figure class="md me mf mg gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi pa"><img src="../Images/acc6cfba556d4778fbe00e241d1c3ee3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*k_stdx2-QKEVfDEJHjUoRw.jpeg"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk">Wikimedia Commons</figcaption></figure><p id="c352" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">在你的一生中，如果你只看到 1 只兔子和 39999 只鸭子，你可能会猜那是一只鸭子。相反，如果你看到 1 只鸭子和 39，999 只兔子，你会猜兔子。</p><p id="2397" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">机器的学习方式与你的学习方式类似——如果数据偏向/不平衡于某个标签，可能会导致不准确的预测。我们需要确保数据是均匀分布的<strong class="li js"/>，这样机器就可以学习所有相同的 10 个数字。</p><p id="9edd" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">您可以使用一些简单的 python 命令来实现这一点:</p><pre class="md me mf mg gt op oq or os aw ot bi"><span id="7bdb" class="ou nx ji oq b gy ov ow l ox oy">train = pd.read_csv (r".../train.csv")<br/>test = pd.read_csv (r".../test.csv")</span><span id="43a5" class="ou nx ji oq b gy oz ow l ox oy">Y_train = train[“label”]</span><span id="dfe4" class="ou nx ji oq b gy oz ow l ox oy">X_train = train.drop(labels = [“label”],axis = 1)</span><span id="2cf6" class="ou nx ji oq b gy oz ow l ox oy">del train</span><span id="ad3b" class="ou nx ji oq b gy oz ow l ox oy">g = sns.countplot(Y_train)</span><span id="1223" class="ou nx ji oq b gy oz ow l ox oy">Y_train.value_counts()</span></pre><figure class="md me mf mg gt iv gh gi paragraph-image"><div class="gh gi pb"><img src="../Images/599ce282c5c1b3134e126a23d0aca435.png" data-original-src="https://miro.medium.com/v2/resize:fit:1020/format:webp/1*1KGcEonzRphWvIQiv76dMw.png"/></div></figure><p id="18bd" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">看起来您的数据已经相当均匀地分布了，所以您可以开始了！</p><h1 id="b620" class="nw nx ji bd ny nz oa ob oc od oe of og kx oh ky oi la oj lb ok ld ol le om on bi translated">3.数据准备</h1><p id="2f4d" class="pw-post-body-paragraph lg lh ji li b lj pc ks ll lm pd kv lo lp pe lr ls lt pf lv lw lx pg lz ma mb im bi translated">我们必须使我们的数据集可行，所以我们对它进行规范化和整形，以便它能与我们稍后要使用的模型一起工作。然后，我们将标签(10 位数字)编码成向量:</p><pre class="md me mf mg gt op oq or os aw ot bi"><span id="e793" class="ou nx ji oq b gy ov ow l ox oy">X_train = X_train / 255.0<br/>test = test / 255.0</span><span id="3127" class="ou nx ji oq b gy oz ow l ox oy">X_train = X_train.values.reshape(-1,28,28,1)<br/>test = test.values.reshape(-1,28,28,1)</span><span id="c7df" class="ou nx ji oq b gy oz ow l ox oy">Y_train = to_categorical(Y_train, num_classes = 10)</span></pre><p id="e015" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">现在，让我们将数据进一步分为训练集和验证集:</p><pre class="md me mf mg gt op oq or os aw ot bi"><span id="a1a2" class="ou nx ji oq b gy ov ow l ox oy">random_seed = 2</span><span id="5e8a" class="ou nx ji oq b gy oz ow l ox oy">X_train, X_val, Y_train, Y_val = train_test_split(X_train, Y_train, test_size = 0.1, random_state=random_seed)</span></pre><h1 id="9d04" class="nw nx ji bd ny nz oa ob oc od oe of og kx oh ky oi la oj lb ok ld ol le om on bi translated">4.培训+测试模型</h1><figure class="md me mf mg gt iv gh gi paragraph-image"><div class="gh gi ph"><img src="../Images/9df034e67f6e41cbd29195ec279de2bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:996/1*nsbETczc7lvDzQX96QANTg.gif"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk">This is your model. (Giphy)</figcaption></figure><p id="a973" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">我们将使用 Keras Sequential API 来解决这个问题，它的组合有点像这样:</p><pre class="md me mf mg gt op oq or os aw ot bi"><span id="57b1" class="ou nx ji oq b gy ov ow l ox oy">model = Sequential()<br/><br/>model.add(Conv2D(filters = 32, kernel_size = (5,5),padding = 'Same', <br/>                 activation ='relu', input_shape = (28,28,1)))<br/>model.add(Conv2D(filters = 32, kernel_size = (5,5),padding = 'Same', <br/>                 activation ='relu'))<br/>model.add(MaxPool2D(pool_size=(2,2)))<br/>model.add(Dropout(0.25))<br/><br/><br/>model.add(Conv2D(filters = 64, kernel_size = (3,3),padding = 'Same', <br/>                 activation ='relu'))<br/>model.add(Conv2D(filters = 64, kernel_size = (3,3),padding = 'Same', <br/>                 activation ='relu'))<br/>model.add(MaxPool2D(pool_size=(2,2), strides=(2,2)))<br/>model.add(Dropout(0.25))<br/><br/><br/>model.add(Flatten())<br/>model.add(Dense(256, activation = "relu"))<br/>model.add(Dropout(0.5))<br/>model.add(Dense(10, activation = "softmax"))</span></pre><p id="1cbd" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">我们在这里做的是添加我们的数据将要经过的层。现在我们设置一个优化器和退火器来避免过度拟合。我们还可以增强和扩展我们的数据集，以进一步避免这种情况:</p><pre class="md me mf mg gt op oq or os aw ot bi"><span id="66bb" class="ou nx ji oq b gy ov ow l ox oy">optimizer = RMSprop(lr=0.001, rho=0.9, epsilon=1e-08, decay=0.0)</span><span id="52f9" class="ou nx ji oq b gy oz ow l ox oy">model.compile(optimizer = optimizer , loss = “categorical_crossentropy”, metrics=[“accuracy”])</span><span id="a450" class="ou nx ji oq b gy oz ow l ox oy">learning_rate_reduction = ReduceLROnPlateau(monitor='val_acc', <br/>                                            patience=3, <br/>                                            verbose=1, <br/>                                            factor=0.5, <br/>                                            min_lr=0.00001)</span><span id="709a" class="ou nx ji oq b gy oz ow l ox oy">datagen = ImageDataGenerator(<br/> featurewise_center=False, <br/> samplewise_center=False,<br/> featurewise_std_normalization=False, <br/> samplewise_std_normalization=False, <br/> zca_whitening=False, <br/> rotation_range=10, <br/> zoom_range = 0.1, <br/> width_shift_range=0.1, <br/> height_shift_range=0.1, <br/> horizontal_flip=False, <br/> vertical_flip=False)</span><span id="d7db" class="ou nx ji oq b gy oz ow l ox oy">datagen.fit(X_train)</span></pre><p id="37fc" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">现在让我们把它们放在一起！</p><pre class="md me mf mg gt op oq or os aw ot bi"><span id="95b1" class="ou nx ji oq b gy ov ow l ox oy">epochs = 2 #depending on how good your computer is, you can do more<br/>batch_size = 86</span><span id="df8a" class="ou nx ji oq b gy oz ow l ox oy">history = model.fit_generator(datagen.flow(X_train,Y_train, batch_size=batch_size),<br/> epochs = epochs, validation_data = (X_val,Y_val),<br/> verbose = 2, steps_per_epoch=X_train.shape[0] // batch_size<br/> , callbacks=[learning_rate_reduction])</span></pre><figure class="md me mf mg gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi pi"><img src="../Images/33b793f19e0b8a8c0010f71444503a4d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*noqHKfTzweqNSQOrQSQH6Q.png"/></div></div></figure><p id="98ec" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">耶！通过手术后正在恢复的眼睛，你可以看到这个模型大约有 96%的准确性。</p><h1 id="4a8c" class="nw nx ji bd ny nz oa ob oc od oe of og kx oh ky oi la oj lb ok ld ol le om on bi translated">5.号码是多少？？</h1><p id="d0fc" class="pw-post-body-paragraph lg lh ji li b lj pc ks ll lm pd kv lo lp pe lr ls lt pf lv lw lx pg lz ma mb im bi translated">你就快到了。你和你的浪漫的命运之间唯一的事情是能够实际上<em class="mi">使用</em>这个模型来计算出那个电话号码是什么。</p><figure class="md me mf mg gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi my"><img src="../Images/87e52c8d8b0254678c5e3a62cdf943b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_B2aKXD3EdoOZ3KvN-WpYA.png"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk">A diagrammatical representation of your predicament.</figcaption></figure><p id="7517" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">不知何故，你设法拍下了组成那个电话号码的各个数字的照片，并把它们上传到了你的电脑上，你这个聪明的坏蛋:</p><figure class="md me mf mg gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi pj"><img src="../Images/cf9f1ca2c7c9d98ffe010a2dbe3c9c57.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*c7KPJYog1P4dHB3FbL83sg.png"/></div></div></figure><p id="13a3" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">您的第一项工作是将它们的像素值转换成您的模型可以读取的格式。这意味着你需要一个脚本来放入这些照片。csv 格式，与您的训练数据集格式相同。</p><pre class="md me mf mg gt op oq or os aw ot bi"><span id="dd7f" class="ou nx ji oq b gy ov ow l ox oy">import os,array<br/>import pandas as pd<br/>os.chdir(r”.../phone_digits”)<br/>import time</span><span id="06df" class="ou nx ji oq b gy oz ow l ox oy">from PIL import Image<br/>columnNames = list()</span><span id="a86a" class="ou nx ji oq b gy oz ow l ox oy">for i in range(784):<br/> pixel = ‘pixel’<br/> pixel += str(i)<br/> columnNames.append(pixel)</span><span id="2258" class="ou nx ji oq b gy oz ow l ox oy">new_data = pd.DataFrame(columns = columnNames)<br/>start_time = time.time()<br/>for i in range(1,11):<br/> t = i<br/> img_name = str(t)+ (“.jpg”)<br/> img = Image.open(img_name)<br/> rawData = img.load()<br/> <br/> data = []<br/> for y in range(28):<br/> for x in range(28):<br/> data.append(rawData[x,y][0])<br/> print (i)<br/> k = 0<br/><br/> new_data.loc[i] = [data[k] for k in range(784)]<br/></span><span id="c9d8" class="ou nx ji oq b gy oz ow l ox oy">print (“Done”)</span><span id="52a4" class="ou nx ji oq b gy oz ow l ox oy">new_data.to_csv(“new_data_converted.csv”,index = False)</span></pre><p id="f305" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">这应该会在同一个文件夹中创建一个. csv 文件，您可以将它输入到您的模型中。让我们现在就开始吧:</p><pre class="md me mf mg gt op oq or os aw ot bi"><span id="5132" class="ou nx ji oq b gy ov ow l ox oy">phone_number = pd.read_csv (r”C:\Users\hilal\Pictures\phone_digits/new_data_converted.csv”)<br/>phone_number = phone_number / 255.0<br/>phone_number = phone_number.values.reshape(-1,28,28,1)</span><span id="d774" class="ou nx ji oq b gy oz ow l ox oy">results = model.predict(phone_number)<br/>results = np.argmax(results,axis = 1)</span><span id="7d9a" class="ou nx ji oq b gy oz ow l ox oy">results = pd.Series(results,name=”Label”)</span><span id="a03f" class="ou nx ji oq b gy oz ow l ox oy">final_order = pd.concat([pd.Series(range(1,11),name = "ImageId"),results],axis = 1)<br/>print (final_order)</span></pre><p id="79f7" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">而现在…</p><figure class="md me mf mg gt iv gh gi paragraph-image"><div class="gh gi pk"><img src="../Images/feb1ae16c13391f817916678eee88993.png" data-original-src="https://miro.medium.com/v2/resize:fit:898/1*yb9XXnLb7CJ33AaQAjdmJQ.gif"/></div><figcaption class="jc jd gj gh gi je jf bd b be z dk">DRUMROLL PLEASE! (Giphy)</figcaption></figure><p id="eff9" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">您的结果如下:</p><figure class="md me mf mg gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi pl"><img src="../Images/dff8821f3ed64b3377829f76406e4d75.png" data-original-src="https://miro.medium.com/v2/resize:fit:314/format:webp/1*VpLdq3PbFFuO_nhiA9loJg.png"/></div></div></figure><p id="32f3" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">哇哦。你做到了。天啊。你真是个天才。弥赛亚。男人中的英雄。你从笔记本电脑上站起来，绕场一周，和你的狗击掌。右边的数字告诉你电话号码是多少，你终于可以看到了，因为你的视力恢复了。</p><p id="18f1" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">当然，这可能意味着这整个练习是不必要的，但是请跟我一起做。)</p><p id="68aa" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">你拿起电话，开始拨打那些甜蜜的数字，这时你意识到…</p><figure class="md me mf mg gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi my"><img src="../Images/51c540bfed354609fc9f12710ee79e57.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UtgzJTUayaXUg6LdEHHtpQ.png"/></div></div></figure><p id="2b17" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">“等一下——</p><blockquote class="mj"><p id="6088" class="mk ml ji bd mm mn mo mp mq mr ms mb dk translated">这不可能是一个实数。"</p></blockquote><p id="a34c" class="pw-post-body-paragraph lg lh ji li b lj mt ks ll lm mu kv lo lp mv lr ls lt mw lv lw lx mx lz ma mb im bi translated">哦，好吧…也许其他人会对你的数据科学技能印象深刻？</p><figure class="md me mf mg gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi my"><img src="../Images/7db51b28e2483b1cb17003bac78849bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*w-UmeW1Ct-dmwXefUQa89g.png"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk">*cries in Python*</figcaption></figure></div><div class="ab cl no np hx nq" role="separator"><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt"/></div><div class="im in io ip iq"><p id="dbca" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">大家好，我是 Murto，是一名 17 岁的企业家，也是加拿大多伦多的一名学生。如果你对这篇文章有任何反馈，或者你只是想聊天，请通过 <a class="ae mz" href="https://www.linkedin.com/in/murto-hilali-7a6068136/" rel="noopener ugc nofollow" target="_blank"> <em class="mi"> LinkedIn </em> </a> <em class="mi">联系我！下一步:</em></p><ul class=""><li id="ba7e" class="na nb ji li b lj lk lm ln lp nc lt nd lx ne mb nf ng nh ni bi translated">告诉某人你爱他们</li><li id="d430" class="na nb ji li b lj nj lm nk lp nl lt nm lx nn mb nf ng nh ni bi translated"><em class="mi">战胜你的敌人</em></li><li id="2243" class="na nb ji li b lj nj lm nk lp nl lt nm lx nn mb nf ng nh ni bi translated"><em class="mi">查查我写过的其他一些关于艾的文章</em> <a class="ae mz" rel="noopener" target="_blank" href="/how-to-train-your-artificial-intelligence-the-hidden-code-20cb3a35e1d6?source=your_stories_page---------------------------"> <em class="mi">这里</em> </a> <em class="mi">和</em> <a class="ae mz" rel="noopener" target="_blank" href="/nobody-understands-me-but-soon-artificial-intelligence-just-might-440f771c2024?source=your_stories_page---------------------------"> <em class="mi">这里</em> </a></li><li id="da5e" class="na nb ji li b lj nj lm nk lp nl lt nm lx nn mb nf ng nh ni bi translated"><em class="mi">祝你今天愉快</em></li></ul><p id="77bf" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">谢谢！</p></div></div>    
</body>
</html>