<html>
<head>
<title>Predicting Micronutrients using Neural Networks and Random Forest (Part 1)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用神经网络和随机森林预测微量营养素(上)</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/predicting-micronutrients-using-neural-networks-and-random-forest-part-1-83a1469766d7?source=collection_archive---------6-----------------------#2019-01-01">https://towardsdatascience.com/predicting-micronutrients-using-neural-networks-and-random-forest-part-1-83a1469766d7?source=collection_archive---------6-----------------------#2019-01-01</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="f425" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">联合国儿童基金会希望你利用机器学习的力量，帮助他们预测食物中的重要营养成分。</h2></div><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi kg"><img src="../Images/2fab7e89192a381bda0b9a3ada4f9c67.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*2c55qtDQAd8RrD09"/></div></div><figcaption class="ks kt gj gh gi ku kv bd b be z dk">Photo by <a class="ae kw" href="https://unsplash.com/@dosejuice?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Dose Juice</a> on <a class="ae kw" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="5cc2" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">欢迎大家！今天，我们将实施机器学习算法来解决世界上最困难的问题之一——世界饥饿。</p><p id="a8d0" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">我决定将本教程分成多个部分，以确保我们不会错过任何重要的细节。</p><p id="1154" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">在这个系列中，我们将解决一个回归问题，并根据其他微量营养素和常量营养素预测重要的微量营养素，微量营养素是健康大脑、骨骼和身体的基石。</p><p id="a9ea" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">我们将使用编程语言 Python 和机器学习中两个常用的依赖项来构建我们的模型，Keras 和 Scikit-Learn。</p><p id="63cf" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">在第一部分中，我们将更多地讨论数据集和数据清理，而不是构建模型本身。</p><p id="67c9" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">数据清理是该过程的一个关键部分，因为提供给我们的数据并不总是准备好输入到模型中。</p><p id="d1db" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">事不宜迟，我们开始吧。</p><h1 id="4ed7" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated"><strong class="ak">概述</strong></h1><p id="bc53" class="pw-post-body-paragraph kx ky iq kz b la ml jr lc ld mm ju lf lg mn li lj lk mo lm ln lo mp lq lr ls ij bi translated">这篇博文包括以下内容:</p><ul class=""><li id="7e62" class="mq mr iq kz b la lb ld le lg ms lk mt lo mu ls mv mw mx my bi translated">动机</li><li id="d0e4" class="mq mr iq kz b la mz ld na lg nb lk nc lo nd ls mv mw mx my bi translated">先决条件</li><li id="d539" class="mq mr iq kz b la mz ld na lg nb lk nc lo nd ls mv mw mx my bi translated">介绍</li><li id="e685" class="mq mr iq kz b la mz ld na lg nb lk nc lo nd ls mv mw mx my bi translated">资料组</li><li id="b76f" class="mq mr iq kz b la mz ld na lg nb lk nc lo nd ls mv mw mx my bi translated">数据清理</li></ul><h1 id="8e91" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">动机</h1><p id="debf" class="pw-post-body-paragraph kx ky iq kz b la ml jr lc ld mm ju lf lg mn li lj lk mo lm ln lo mp lq lr ls ij bi translated">在这篇博文中，我决定报道一些与任务稍有不同的内容。大多数时候，机器学习教程都涉及单变量回归，在预测过程中只有一个结果变量。</p><p id="b030" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">然而，这一次，我们将使用一些流行的机器学习算法来解决一个多元回归问题，其中结果变量不止一个。</p><p id="71c8" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">我认为这很重要，因为许多现实世界的问题需要考虑多个输出变量之间的关系。</p><p id="1c4c" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">注意——深度学习的话题将在我们使用神经网络进行回归时出现。大多数博客帖子都会比较深度神经网络如何显示出比其他算法更好的准确性。</p><p id="b32a" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">然而，在这个系列中，我将涵盖一个场景，其中深度神经网络实际上<em class="ne">比其他机器学习架构</em>表现更差。</p><p id="132f" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">此外，我将介绍一些有用的工具，您可以利用它们来构建机器学习算法。</p><h1 id="dac0" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">先决条件</h1><p id="9c38" class="pw-post-body-paragraph kx ky iq kz b la ml jr lc ld mm ju lf lg mn li lj lk mo lm ln lo mp lq lr ls ij bi translated">这篇博客文章假设读者对流行的机器学习算法(如线性回归和决策树)和技术术语(如过拟合、隐藏层等)有所熟悉。,).</p><p id="24ce" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">如果你以前没有任何知识，或者需要一些知识来更新我上面提到的一些东西，这里有一些我推荐的资源:</p><ul class=""><li id="a5e5" class="mq mr iq kz b la lb ld le lg ms lk mt lo mu ls mv mw mx my bi translated">《统计学习导论》，作者:Gareth James，Daniela Witten，Trevor Hastie，Robert Tibshirani</li><li id="5c08" class="mq mr iq kz b la mz ld na lg nb lk nc lo nd ls mv mw mx my bi translated">机器学习、线性回归、随机森林<br/>《统计学习的要素》，作者 Trevor Hastie、Robert Tibshirani、Jerome Friedman</li><li id="c65b" class="mq mr iq kz b la mz ld na lg nb lk nc lo nd ls mv mw mx my bi translated"><a class="ae kw" href="https://bit.ly/2RorsKx" rel="noopener ugc nofollow" target="_blank">机器学习入门</a></li><li id="06f8" class="mq mr iq kz b la mz ld na lg nb lk nc lo nd ls mv mw mx my bi translated"><a class="ae kw" href="https://bit.ly/2QYbebw" rel="noopener ugc nofollow" target="_blank">多元/多变量回归</a></li><li id="5911" class="mq mr iq kz b la mz ld na lg nb lk nc lo nd ls mv mw mx my bi translated"><a class="ae kw" href="https://bit.ly/2iv6dmW" rel="noopener ugc nofollow" target="_blank">深度学习和神经网络</a></li></ul><h1 id="bec6" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">介绍</h1><p id="6573" class="pw-post-body-paragraph kx ky iq kz b la ml jr lc ld mm ju lf lg mn li lj lk mo lm ln lo mp lq lr ls ij bi translated">联合国儿童基金会(UNICEF)有一个请求，希望您加入他们的数据科学团队，解决一个在对抗世界饥饿的斗争中起着至关重要作用的重要问题——微量营养素(也称为维生素和矿物质)。</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi nf"><img src="../Images/392c754a3599df415a387e0af16134ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ADqPsipCqfD68s0R"/></div></div><figcaption class="ks kt gj gh gi ku kv bd b be z dk">Photo by <a class="ae kw" href="https://unsplash.com/@perrygrone?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Perry Grone</a> on <a class="ae kw" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="85a2" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">你的工作是创建一个机器学习模型，可以根据其他营养物质(蛋白质、碳水化合物等)对这些缺乏进行预测。,).</p><p id="bc74" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">然而，关于这项工作，他们忘了说一件事，他们没有数据(这对于像联合国儿童基金会这样大的组织来说是极不可能的；但为了这篇博文，姑且说他们没有)。</p><p id="c823" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">因此，您需要找到获取数据的方法来构建模型。</p><p id="fcf9" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">但是怎么做呢？从哪里来的？</p><h1 id="33f9" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">资料组</h1><p id="c615" class="pw-post-body-paragraph kx ky iq kz b la ml jr lc ld mm ju lf lg mn li lj lk mo lm ln lo mp lq lr ls ij bi translated">幸运的是，历史上最伟大的创造之一，互联网，充满了许多开放的数据集，我们可以下载并用来训练我们的模型。</p><p id="cf48" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">在这种情况下，我们将使用来自美国农业部农业研究服务局的<a class="ae kw" href="https://www.unicef.org/nutrition/index_iodine.html" rel="noopener ugc nofollow" target="_blank">美国农业部国家营养数据库作为标准参考(SR) </a>。</p><p id="7628" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">在本教程中，我们将使用缩写的 excel 文件，您可以在<a class="ae kw" href="https://www.ars.usda.gov/ARSUserFiles/80400525/Data/SR/SR28/dnload/sr28abxl.zip" rel="noopener ugc nofollow" target="_blank">这里</a>下载。</p><p id="205e" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">该数据集包含美国食物成分数据的主要来源，有超过 8000 个数据点，每种食物中有超过 50 种微量营养素(如碳水化合物、蛋白质等)。,).</p><p id="1344" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">现在我们得到了数据，首先要做的是数据清洗。</p><h1 id="42e6" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">数据清理</h1><p id="020e" class="pw-post-body-paragraph kx ky iq kz b la ml jr lc ld mm ju lf lg mn li lj lk mo lm ln lo mp lq lr ls ij bi translated">自然，数据并不总是以干净的 CSV 或文本文件的形式出现，可以随时输入到机器学习模型中。</p><p id="4884" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">我们从大自然中获取的大部分食物在我们从超市购买之前都要先进行清洗和加工。数据也是如此。</p><p id="56c9" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">但首先，让我们看看我们的数据。由于数据是 Excel 文件的形式，我们将使用 Pandas <code class="fe ng nh ni nj b">read_excel</code>函数打开文件。</p><pre class="kh ki kj kk gt nk nj nl nm aw nn bi"><span id="d46b" class="no lu iq nj b gy np nq l nr ns">import pandas as pd</span><span id="1cee" class="no lu iq nj b gy nt nq l nr ns">path_to_data = "datasets/ABBREV.xlsx" # Path to the Excel file<br/>dataset = pd.read_excel(path_to_data)<br/>dataset.head()</span></pre><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi nu"><img src="../Images/43d3239f69ecec94fcaf4404a74c10ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eQcPYQR4VgbFaZ-gGZXAqQ.png"/></div></div><figcaption class="ks kt gj gh gi ku kv bd b be z dk">If you run on the code on Jupyter Notebook, then the table should look like this (might look different if you run a python script on terminal)</figcaption></figure><p id="b942" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><code class="fe ng nh ni nj b">dataset.head()</code>显示数据集的前 5 行。通过这样做，我们可以对我们的数据有所了解。</p><p id="7afa" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">正如我们所见，该表包含了每种食物的营养成分数据(如黄油、奶酪等。,).</p><p id="e07f" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">各栏包含食物中每种微量营养素和常量营养素(蛋白质、碳水化合物等)的名称。,).</p><p id="f8ad" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">要查看所有变量的数据，可以运行下面的代码。</p><pre class="kh ki kj kk gt nk nj nl nm aw nn bi"><span id="a99d" class="no lu iq nj b gy np nq l nr ns">dataset.columns</span><span id="d9af" class="no lu iq nj b gy nt nq l nr ns"># Output<br/>Index(['NDB_No', 'Shrt_Desc', 'Water_(g)', 'Energ_Kcal', 'Protein_(g)',<br/>       'Lipid_Tot_(g)', 'Ash_(g)', 'Carbohydrt_(g)', 'Fiber_TD_(g)',<br/>       'Sugar_Tot_(g)', 'Calcium_(mg)', 'Iron_(mg)', 'Magnesium_(mg)',<br/>       'Phosphorus_(mg)', 'Potassium_(mg)', 'Sodium_(mg)', 'Zinc_(mg)',<br/>       'Copper_mg)', 'Manganese_(mg)', 'Selenium_(µg)', 'Vit_C_(mg)',<br/>       'Thiamin_(mg)', 'Riboflavin_(mg)', 'Niacin_(mg)', 'Panto_Acid_mg)',<br/>       'Vit_B6_(mg)', 'Folate_Tot_(µg)', 'Folic_Acid_(µg)', 'Food_Folate_(µg)',<br/>       'Folate_DFE_(µg)', 'Choline_Tot_ (mg)', 'Vit_B12_(µg)', 'Vit_A_IU',<br/>       'Vit_A_RAE', 'Retinol_(µg)', 'Alpha_Carot_(µg)', 'Beta_Carot_(µg)',<br/>       'Beta_Crypt_(µg)', 'Lycopene_(µg)', 'Lut+Zea_ (µg)', 'Vit_E_(mg)',<br/>       'Vit_D_µg', 'Vit_D_IU', 'Vit_K_(µg)', 'FA_Sat_(g)', 'FA_Mono_(g)',<br/>       'FA_Poly_(g)', 'Cholestrl_(mg)', 'GmWt_1', 'GmWt_Desc1', 'GmWt_2',<br/>       'GmWt_Desc2', 'Refuse_Pct'],<br/>      dtype='object')</span></pre><p id="dd60" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">在我们继续之前，我总是喜欢检查每一列的数据类型。这一点很重要，因为在训练中只使用 float 类型。</p><p id="00b7" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">我不会详细说明所有这些变量的含义。但是如果您有兴趣了解，可以在下载数据集时查看 zip 文件中包含的文档。</p><p id="0689" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">幸运的是，Pandas 的<code class="fe ng nh ni nj b">DataFrame</code>类有一个属性<code class="fe ng nh ni nj b">dtypes</code>，它返回一个包含每一列数据类型的<code class="fe ng nh ni nj b">Series</code>。</p><pre class="kh ki kj kk gt nk nj nl nm aw nn bi"><span id="ec43" class="no lu iq nj b gy np nq l nr ns">dataset.dtypes</span><span id="5e93" class="no lu iq nj b gy nt nq l nr ns">#Output</span><span id="7ddf" class="no lu iq nj b gy nt nq l nr ns">NDB_No                 int64<br/>Shrt_Desc             object<br/>Water_(g)            float64<br/>Energ_Kcal             int64<br/>Protein_(g)          float64<br/>Lipid_Tot_(g)        float64<br/>Ash_(g)              float64<br/>Carbohydrt_(g)       float64<br/>Fiber_TD_(g)         float64<br/>Sugar_Tot_(g)        float64<br/>Calcium_(mg)         float64<br/>Iron_(mg)            float64<br/>Magnesium_(mg)       float64<br/>Phosphorus_(mg)      float64<br/>Potassium_(mg)       float64<br/>Sodium_(mg)          float64<br/>Zinc_(mg)            float64<br/>Copper_mg)           float64<br/>Manganese_(mg)       float64<br/>Selenium_(µg)        float64<br/>Vit_C_(mg)           float64<br/>Thiamin_(mg)         float64<br/>Riboflavin_(mg)      float64<br/>Niacin_(mg)          float64<br/>Panto_Acid_mg)       float64<br/>Vit_B6_(mg)          float64<br/>Folate_Tot_(µg)      float64<br/>Folic_Acid_(µg)      float64<br/>Food_Folate_(µg)     float64<br/>Folate_DFE_(µg)      float64<br/>Choline_Tot_ (mg)    float64<br/>Vit_B12_(µg)         float64<br/>Vit_A_IU             float64<br/>Vit_A_RAE            float64<br/>Retinol_(µg)         float64<br/>Alpha_Carot_(µg)     float64<br/>Beta_Carot_(µg)      float64<br/>Beta_Crypt_(µg)      float64<br/>Lycopene_(µg)        float64<br/>Lut+Zea_ (µg)        float64<br/>Vit_E_(mg)           float64<br/>Vit_D_µg             float64<br/>Vit_D_IU             float64<br/>Vit_K_(µg)           float64<br/>FA_Sat_(g)           float64<br/>FA_Mono_(g)          float64<br/>FA_Poly_(g)          float64<br/>Cholestrl_(mg)       float64<br/>GmWt_1               float64<br/>GmWt_Desc1            object<br/>GmWt_2               float64<br/>GmWt_Desc2            object<br/>Refuse_Pct           float64<br/>dtype: object</span></pre><p id="8d48" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">啊哈，看那个。似乎除了<code class="fe ng nh ni nj b">NDB_No</code>、<code class="fe ng nh ni nj b">Shrt_Desc</code>、<code class="fe ng nh ni nj b">Energy_Kcal</code>、<code class="fe ng nh ni nj b">GmWt_Desc1</code>和<code class="fe ng nh ni nj b">GmWt_Desc2</code>之外，所有的列都是浮动的。</p><p id="54ee" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">此外，您可以看到其中一些列的数据类型为<code class="fe ng nh ni nj b">object</code>。这是因为它们包含每个行条目的文本。</p><p id="96a8" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">出于这个原因，熊猫会认为它们是分类数据。我想使用术语<em class="ne">假分类变量</em>，因为它们实际上不是分类数据，只是包含文本。</p><p id="7b9b" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">为了使数据清理过程更加简单，让我们将这些<em class="ne">错误分类变量</em>与另一个数值变量分开。</p><p id="9a42" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">由于熊猫不提供这样的功能，我们必须手动完成。</p><pre class="kh ki kj kk gt nk nj nl nm aw nn bi"><span id="5ab2" class="no lu iq nj b gy np nq l nr ns">tot_cols = dataset.columns<br/>num_cols = dataset._get_numeric_data().columns<br/>cat_cols = list(set(tot_cols)-set(num_cols))</span><span id="2506" class="no lu iq nj b gy nt nq l nr ns"># Output of cat_cols</span><span id="dae7" class="no lu iq nj b gy nt nq l nr ns">['GmWt_Desc1', 'GmWt_Desc2', 'Shrt_Desc']</span></pre><p id="8257" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">太好了！现在我们可以开始第一步了。</p><p id="40d5" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">首先注意，<code class="fe ng nh ni nj b">NBD_No</code>包含每种食物的索引，<code class="fe ng nh ni nj b">Shrt_Desc</code>包含食物本身的名称。在这种情况下，我们可以删除这些变量，因为它们不会用于构建模型。</p><pre class="kh ki kj kk gt nk nj nl nm aw nn bi"><span id="8a3e" class="no lu iq nj b gy np nq l nr ns">drop_cols = ['NDB_No', 'Shrt_Desc']<br/>dataset = dataset.drop(drop_cols, axis=1)</span></pre><p id="3c39" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">接下来，我们需要为我们的培训设置<strong class="kz ir">标签</strong>。因为我们正在处理一个多元回归问题，这意味着输出变量将不止一个。</p><p id="1a7c" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">换句话说，这意味着我们有多个标签。</p><p id="d210" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">正如我之前提到的，联合国儿童基金会希望你对某些食物中的重要微量营养素做出预测。但是正如我们在专栏中看到的，他们有很多。</p><p id="2fa4" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">我们怎么知道哪一个会成为我们的标签呢？</p><p id="95f3" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">这个问题没有明确的答案，这取决于你要解决的问题。由于我们不太了解营养(我想)，我们可以查看联合国儿童基金会的官方网站。</p><p id="26a2" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">根据联合国儿童基金会的官方网站，微量营养素主要有七种缺乏:碘、维生素 A、铁、锌、钙、维生素 D 和叶酸。</p><p id="787f" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">除了碘，所有这些都在我们的数据集中提供。但是在与我们团队中的主管讨论之后，他说可以进行构建模型的第一次迭代。</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi nv"><img src="../Images/11347442417048dcc81e46cef5cf9607.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zJnwFircxqSDL2-jnEhGbg.png"/></div></div><figcaption class="ks kt gj gh gi ku kv bd b be z dk">Just to give a visualization of what we are trying to do.</figcaption></figure><p id="d28c" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">现在，我们只是将结果变量的名称放在一个列表中。在 Python 中，我们可以通过执行以下操作来做到这一点。</p><pre class="kh ki kj kk gt nk nj nl nm aw nn bi"><span id="81e7" class="no lu iq nj b gy np nq l nr ns">labels = ['Calcium_(mg)', 'Iron_(mg)','Zinc_(mg)', 'Vit_A_IU', 'Vit_D_IU', 'Folate_Tot_(µg)']</span></pre><p id="d1d1" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">好了，现在我们需要回到那些<em class="ne">错误的分类变量。</em>因为我们已经去掉了<code class="fe ng nh ni nj b">NDB_No</code>、<code class="fe ng nh ni nj b">Shrt_Desc</code>，我们需要做的就是如何处理<code class="fe ng nh ni nj b">GmWt_Desc1</code>和<code class="fe ng nh ni nj b">GmWt_Desc2</code>。</p><p id="29f9" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">现在你可以做两件事。</p><p id="37ef" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">首先，你可以放弃它们，因为它们只是对<code class="fe ng nh ni nj b">GmWt_1</code>和<code class="fe ng nh ni nj b">GmWt_2</code>变量的描述。第二种方法是清理文本，只包含每一行条目的编号。</p><p id="c568" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">我会推荐第一种选择，因为这些变量很可能不会对模型的性能产生任何重大影响。然而，为了这篇博文，我将把他们包括在内。</p><p id="c369" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">为什么？我会解释的。</p><p id="185d" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">互联网上的数据并不总是干净的。他们可以有多余的或喋喋不休的话。因此，以某种方式清除这些文本并用数字表示它们是一个好习惯。</p><p id="4a18" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">计算机只能计算数字，不能计算文本类型的数据。</p><p id="e4a2" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">因此，我们需要删除<code class="fe ng nh ni nj b">GmWt_Desc1</code>和<code class="fe ng nh ni nj b">GmWt_Desc2</code>中的文本。在这种情况下，它包括括号内的任何内容。</p><p id="6f32" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">幸运的是，我已经写了一个函数来做这件事。</p><pre class="kh ki kj kk gt nk nj nl nm aw nn bi"><span id="28f1" class="no lu iq nj b gy np nq l nr ns">def clean_text(data):<br/>    <br/>    # If value is NaN we return the same value for cleansing later on<br/>    if isinstance(data, str):<br/>        <br/>        # Remove any punctuations including words within parentheses<br/>        clean = re.sub(r'\([^)]*\)', '', data)<br/>        <br/>        # Get numbers only<br/>        clean = re.sub("\D","",clean)<br/>        <br/>        return clean<br/>    <br/>    else:<br/>        return data</span></pre><p id="282e" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">我们可以使用这个函数来删除括号中的标点符号和单词。此外，我们希望得到句子中的数字。</p><p id="e335" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">例如，如果行中的条目是“1 pat，(1" sq，1/3" high)”，那么我们只留下数字 1。</p><p id="4b76" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">熊猫让我们简单地用属性<code class="fe ng nh ni nj b">apply</code>来说明。这就是<em class="ne">假分类变量</em>列表派上用场的地方。</p><pre class="kh ki kj kk gt nk nj nl nm aw nn bi"><span id="f0f8" class="no lu iq nj b gy np nq l nr ns"># Remove text in <!-- -->GmWt_Desc1<br/>dataset[cat_cols[0]] = dataset[cat_cols[0]].apply(clean_text)</span><span id="07ec" class="no lu iq nj b gy nt nq l nr ns"># Remove text in <!-- -->GmWt_Desc2<br/>dataset[cat_cols[1]] = dataset[cat_cols[1]].apply(clean_text)</span></pre><p id="c416" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">太棒了。看来我们完了，对吧？不完全是。在准备好输入数据之前，我们需要做几件事情。</p><p id="1402" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">如果你回到<code class="fe ng nh ni nj b">clean_text</code>函数，有一个注释说“如果值是 NaN，我们返回相同的值用于以后的清理。”</p><p id="61e7" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">清理数据集的另一个常见步骤是处理<strong class="kz ir">缺失数据</strong>。这很常见，因为许多可以在互联网上找到的数据集并没有完全填满。</p><p id="649c" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">那些丢失的数据被替换为 NaN 值。与文本一样，计算机不能计算 NaN 值。</p><p id="44b4" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">让我们看看数据集的每一列是否有任何缺失值。</p><pre class="kh ki kj kk gt nk nj nl nm aw nn bi"><span id="40f4" class="no lu iq nj b gy np nq l nr ns">dataset.isnull().sum()</span><span id="a17e" class="no lu iq nj b gy nt nq l nr ns"># Output</span><span id="3f00" class="no lu iq nj b gy nt nq l nr ns">Water_(g)               1<br/>Energ_Kcal              0<br/>Protein_(g)             0<br/>Lipid_Tot_(g)           0<br/>Ash_(g)               325<br/>Carbohydrt_(g)          0<br/>Fiber_TD_(g)          594<br/>Sugar_Tot_(g)        1832<br/>Calcium_(mg)          348<br/>Iron_(mg)             144<br/>Magnesium_(mg)        739<br/>Phosphorus_(mg)       579<br/>Potassium_(mg)        426<br/>Sodium_(mg)            83<br/>Zinc_(mg)             706<br/>Copper_mg)           1257<br/>Manganese_(mg)       2160<br/>Selenium_(µg)        1700<br/>Vit_C_(mg)            818<br/>Thiamin_(mg)          634<br/>Riboflavin_(mg)       616<br/>Niacin_(mg)           637<br/>Panto_Acid_mg)       2242<br/>Vit_B6_(mg)           905<br/>Folate_Tot_(µg)      1261<br/>Folic_Acid_(µg)      2039<br/>Food_Folate_(µg)     1768<br/>Folate_DFE_(µg)      2057<br/>Choline_Tot_ (mg)    4016<br/>Vit_B12_(µg)         1193<br/>Vit_A_IU              711<br/>Vit_A_RAE            1535<br/>Retinol_(µg)         1806<br/>Alpha_Carot_(µg)     3258<br/>Beta_Carot_(µg)      3162<br/>Beta_Crypt_(µg)      3270<br/>Lycopene_(µg)        3292<br/>Lut+Zea_ (µg)        3315<br/>Vit_E_(mg)           2889<br/>Vit_D_µg             3262<br/>Vit_D_IU             3211<br/>Vit_K_(µg)           3563<br/>FA_Sat_(g)            349<br/>FA_Mono_(g)           666<br/>FA_Poly_(g)           665<br/>Cholestrl_(mg)        410<br/>GmWt_1                300<br/>GmWt_Desc1            299<br/>GmWt_2               3965<br/>GmWt_Desc2           3965<br/>Refuse_Pct             50<br/>dtype: int64</span></pre><p id="17cd" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">哇，看来我们的数据集中有很多缺失的数据。</p><p id="e6b7" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">同样，这里我们可以做两件事。第一种方法是删除任何列中包含缺失数据的行。这意味着如果一个列有一个 NaN 值，我们会立即删除它们。</p><p id="ebe6" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">第二个选择是做输入，这意味着替换丢失的值。这个选项更可取，因为我们不会丢弃在模型训练期间可能很重要的其他数据。</p><p id="0743" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">问题是，我们用什么来代替它呢？</p><p id="6d2b" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">没有人能回答这个问题。这取决于你面临的问题和你使用的模型。一些模型对于缺失数据是稳健的，而另一些则不能处理它们。</p><p id="c644" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">例如，稍后，我们将使用一种流行的机器学习算法，称为随机森林。这个模型有自己处理缺失数据的方式。</p><p id="934d" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">但是，我们不会在本系列中讨论这个问题。但是如果你有兴趣了解的话，<a class="ae kw" href="https://www.youtube.com/watch?v=nyxTdL_4Q-Q" rel="noopener ugc nofollow" target="_blank">这个视频</a>会很有帮助。</p><p id="e67a" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">为了简单起见，我们将使用一种最流行的技术来替换丢失的数据。那就是通过使用中间值。</p><p id="e990" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">为什么？这是对另一篇博文的解释。与此同时，让我们继续前进。</p><p id="a8cc" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">为了获得每一列的中间值，我们可以使用由<code class="fe ng nh ni nj b">DataFrame</code>类提供的属性<code class="fe ng nh ni nj b">median()</code>。然后，我们可以使用<code class="fe ng nh ni nj b">fillna</code>属性替换丢失的值。</p><pre class="kh ki kj kk gt nk nj nl nm aw nn bi"><span id="4ddd" class="no lu iq nj b gy np nq l nr ns">get_median = dataset.median()<br/>dataset = dataset.fillna(get_median)</span></pre><p id="1f6c" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">另一种方法是使用 Scikit-learn 的<code class="fe ng nh ni nj b"><a class="ae kw" href="https://scikit-learn.org/stable/modules/generated/sklearn.impute.SimpleImputer.html" rel="noopener ugc nofollow" target="_blank">SimpleImputer</a></code> <a class="ae kw" href="https://scikit-learn.org/stable/modules/generated/sklearn.impute.SimpleImputer.html" rel="noopener ugc nofollow" target="_blank">类</a>。</p><p id="c654" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">现在我们需要检查数据集中是否没有丢失的数据值。</p><pre class="kh ki kj kk gt nk nj nl nm aw nn bi"><span id="cc5f" class="no lu iq nj b gy np nq l nr ns">dataset.isna().values.any()</span><span id="917c" class="no lu iq nj b gy nt nq l nr ns"># Output<br/>False</span></pre><p id="bed0" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">看起来所有丢失的值都不见了。</p><p id="7246" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">现在，到了最后一步。由于我们正在处理一个监督学习任务，我们需要将数据集分成输入数据和标签。</p><p id="84f9" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">但在此之前，我想快速提一下。</p><p id="39fc" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">如果你注意我们的变量列表，对于维生素 A 和维生素 D，我们有两个变量分别代表它们。</p><p id="77c0" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">维生素 A 有<code class="fe ng nh ni nj b">Vit_A_IU</code>和<code class="fe ng nh ni nj b">Vit_A_RAE</code>，维生素 D 有<code class="fe ng nh ni nj b">Vit_D_IU</code>和<code class="fe ng nh ni nj b">Vit_D_µg</code>。</p><p id="856b" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">IU 代表国际标准。我不打算解释什么是 IU，但是如果你想知道更多，你可以在这里查看。</p><p id="5033" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">我决定选择<code class="fe ng nh ni nj b">Vit_A_IU</code>和<code class="fe ng nh ni nj b">Vit_D_IU</code>，因为我试图避免每个变量的单位差异有太大的变化。</p><p id="b032" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">现在我们已经解决了这个问题，让我们继续分离输入数据和标签。</p><p id="feea" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">还记得之前最初准备的标签名称列表吗？这就是它派上用场的地方。</p><pre class="kh ki kj kk gt nk nj nl nm aw nn bi"><span id="3ff9" class="no lu iq nj b gy np nq l nr ns"># List of names of the columns that we will drop for the input data<br/>drop_cols = ['Vit_D_µg', 'Vit_A_RAE'] + labels</span><span id="b216" class="no lu iq nj b gy nt nq l nr ns"># Get the data for labels<br/>y = dataset[labels].values</span><span id="a312" class="no lu iq nj b gy nt nq l nr ns"># Get the data for inputs<br/>X = dataset.drop(drop_cols, axis=1).values</span></pre><p id="b344" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">属性将数据从一个对象转换成 Numpy 数组。</p><p id="53b3" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">厉害！我们已经清理完数据了</p><p id="788e" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">作为数据科学团队的一员，我们正在取得进步。既然数据已经去掉了文本和缺失值，我们就可以开始构建模型了。</p><p id="6d7c" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">请加入本系列的第 2 部分，我们将通过使用 Scikit-learn 创建一个机器学习模型，最终在战胜世界饥饿的斗争中迈出又一步。</p><p id="8398" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">我希望这篇博文对你有所帮助，并且迫不及待地想在第 2 部分见到你。在那之前，干杯！</p><p id="e4a5" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">关于我:</p><p id="f6ea" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><em class="ne">一名印尼留学生，目前在韩国留学，对人工智能世界有着浓厚的兴趣。一家名为 88spares 的初创公司的后端开发人员。相信不断的学习。我想回馈在我追求知识的过程中贡献良多的人工智能。当我不写代码时，我喜欢阅读航天工业的最新趋势，并为我大学的美式足球队效力。</em></p></div></div>    
</body>
</html>