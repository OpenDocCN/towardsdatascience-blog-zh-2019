# ä½¿ç”¨ PyTorch çš„æ¢µæ–‡å­—ç¬¦ç¥ç»ç½‘ç»œæ•™ç¨‹

> åŸæ–‡ï¼š<https://towardsdatascience.com/neural-network-tutorial-with-devanagari-characters-using-pytorch-6abceb78a020?source=collection_archive---------25----------------------->

## *ç”¨ PyTorch è®­ç»ƒä¸€ä¸ªäººå·¥ç¥ç»ç½‘ç»œç”¨äºè¯†åˆ«æ‰‹å†™çš„æ¢µæ–‡å­—ç¬¦ã€‚*

![](img/8dcc088c03aa872e1e5449ea2d93807f.png)

Source: images.google.com

é¡¾åæ€ä¹‰ï¼Œç¥ç»ç½‘ç»œæ˜¯ç”±äººè„‘ç¥ç»å…ƒæ¾æ•£åœ°æ¿€å‘å‡ºæ¥çš„ã€‚ä½†æ˜¯æˆ‘ä»¬ä¸ä¼šåœ¨è¿™é‡Œè®¨è®ºå¤§è„‘ç±»æ¯”çš„ä»»ä½•ç»†èŠ‚ã€‚ç›¸åï¼Œæˆ‘ä»¬å°†é€šè¿‡ä¸€äº›æ•°å­¦å’Œç¼–ç æ¥ç†è§£å®ƒã€‚

# æ„ŸçŸ¥å™¨

å¼—å…°å…‹Â·ç½—æ£®å¸ƒæ‹‰ç‰¹(Frank Rosenblatt)åœ¨ 20 ä¸–çºª 50 å¹´ä»£æå‡ºäº†æ„ŸçŸ¥æœº(perceptron)ï¼Œè¡¨æ˜ä¸€ç§ç®—æ³•å¯ä»¥æ¨¡ä»¿äººç±»å¤§è„‘çš„å†³ç­–èƒ½åŠ›(æˆ‘ä»¬ä»åœ¨å°è¯•)ã€‚ä»–åœ¨è®ºæ–‡ä¸­å†™é“ï¼Œæˆ‘ä»¬å¯ä»¥å°†è¾“å…¥è§†ä¸ºç”±äºŒè¿›åˆ¶æ•°ç»„æˆçš„ç¥ç»å…ƒã€‚å¦‚æœè¿™äº›äºŒè¿›åˆ¶æ•°å¯ä»¥ç”Ÿæˆä¸€ä¸ªäºŒè¿›åˆ¶æ•°ä½œä¸ºè¾“å‡º**ï¼Œå¦‚æœ**è¾“å‡ºæ»¡è¶³æŸä¸ªé˜ˆå€¼ï¼Œåˆ™åªç”Ÿæˆ**ã€‚**

![](img/f03f1f5c5772d8e3998412044a1a48f1.png)

Perceptron model

ä½ å¯èƒ½ä¼šé—®:

ä½†æ˜¯ Gopalï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥å†™ä¸€ä¸ªç¨‹åºæ¥åšè¿™ä¸ªä»»åŠ¡ï¼›ä¸ºä»€ä¹ˆè¦å†™ç¥ç»ç½‘ç»œå‘¢ï¼Ÿæˆ‘å¾ˆé«˜å…´ä½ é—®äº†ã€‚

é€‰æ‹©ç¥ç»ç½‘ç»œè€Œä¸æ˜¯ä»»ä½•ç¨‹åºçš„ç¬¬ä¸€ä¸ªåŸå› æ˜¯ï¼Œå®ƒä»¬æ˜¯**é€šç”¨å‡½æ•°é€¼è¿‘å™¨**ï¼Œå¯ä»¥æ¨æ–­å‡ºæˆ‘ä»¬è¯•å›¾å»ºç«‹çš„æ¨¡å‹ï¼Œæˆ–è€…å¦‚æœå®ƒå¤ªå¤æ‚ï¼Œç¥ç»ç½‘ç»œæ€»æ˜¯ä»£è¡¨é‚£ä¸ªå‡½æ•°ã€‚

æˆ‘ä»¬å¯ä»¥å‡è®¾å°†ä»»ä½•å‡½æ•°è½¬åŒ–ä¸ºæ•°å­¦æœ¯è¯­ï¼Œç„¶åæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ç¥ç»ç½‘ç»œæ¥è¡¨ç¤ºè¯¥å‡½æ•°ã€‚

ç¬¬äºŒä¸ªåŸå› æ˜¯å¯ä¼¸ç¼©æ€§å’Œçµæ´»æ€§ã€‚æˆ‘ä»¬å¯ä»¥å¾ˆå®¹æ˜“åœ°åœ¨ç¥ç»ç½‘ç»œä¸­å †å å±‚ï¼Œè¿™å°†å¢åŠ ç¥ç»ç½‘ç»œçš„å¤æ‚æ€§ã€‚

# ç¥ç»ç½‘ç»œçš„åŸºæœ¬æ¶æ„

**ç¥ç»ç½‘ç»œç”±ä»¥ä¸‹ç»„ä»¶ç»„æˆ:**

*   è¾“å…¥å±‚ x
*   ä»»æ„æ•°é‡çš„éšè—å±‚
*   è¾“å‡ºå›¾å±‚ï¼Œğ‘¦
*   ä¸€å¥— parameters(ğ‘Š)å’Œ biases(ğ‘)å„ layer,ğ‘Šå’Œğ‘ä¹‹é—´
*   æ¯ä¸ªéšè—å±‚çš„æ¿€æ´»å‡½æ•°çš„é€‰æ‹©ï¼Œğœ

![](img/11ada75e3696caea3f0917480ee9519d.png)

Resource from [https://tex.stackexchange.com/questions/132444/diagram-of-an-artificial-neural-network](https://tex.stackexchange.com/questions/132444/diagram-of-an-artificial-neural-network)

æˆ‘ä»¬è®­ç»ƒç¥ç»ç½‘ç»œè¿›è¡Œ *n* æ¬¡è¿­ä»£ï¼›æ¯æ¬¡è¿­ä»£åŒ…æ‹¬ä¸¤ä¸ªæ­¥éª¤:

1.  å‰é¦ˆ
2.  åå‘ä¼ æ’­

# å‰é¦ˆ:

ç®€å•æ¥è¯´ï¼Œå½“ç¬¬ä¸€å±‚çš„è¾“å‡ºæˆä¸ºä¸‹ä¸€å±‚çš„è¾“å…¥ã€‚è¿™ç§ç½‘ç»œç§°ä¸º**å‰é¦ˆç½‘ç»œã€‚**

æˆ‘ä»¬çš„ç½‘ç»œä¸­æ²¡æœ‰åé¦ˆä¿¡æ¯çš„å›è·¯ï¼›å®ƒå°†æ€»æ˜¯è¢«å‰é¦ˆã€‚

# åå‘ä¼ æ’­:

è¿™æ˜¯æˆ‘ä»¬çš„ç¥ç»ç½‘ç»œ*å®é™…ä¸Š*ä»è®­ç»ƒ**æ•°æ®**ä¸­å­¦ä¹ çš„è¿‡ç¨‹ã€‚

ä½†é—®é¢˜ä»ç„¶æ²¡æœ‰ç­”æ¡ˆï¼Œæˆ‘ä»¬çš„ç½‘ç»œå¦‚ä½•å­¦ä¹ åˆ†ç±»æˆ–é¢„æµ‹ï¼Ÿå¦‚æœæˆ‘ä»¬çš„æ¨¡å‹å·²ç»é¢„æµ‹åˆ°äº†ä»€ä¹ˆï¼Œé‚£ä¹ˆæˆ‘ä»¬çš„æ¨¡å‹å¦‚ä½•ç¡®å®šå®ƒæ˜¯æ­£ç¡®çš„é¢„æµ‹è¿˜æ˜¯é”™è¯¯çš„å‘¢ï¼Ÿ

ç­”æ¡ˆæ˜¯**æŸå¤±å‡½æ•°ï¼›å®ƒ**æœ‰åŠ©äºæˆ‘ä»¬çš„ç½‘ç»œé¢„æµ‹ä¸åŸå§‹å€¼ç›¸å·®å¤šå°‘ã€‚

æˆ‘ä»¬çš„æ¨¡å‹å·²ç»é¢„æµ‹äº†ä¸€æ‰€æˆ¿å­çš„ä»·æ ¼ä¸º 100K ç¾å…ƒï¼Œè€ŒåŸå§‹ä»·æ ¼ä¸º 101K ç¾å…ƒï¼Œé‚£ä¹ˆåŸå§‹ä»·æ ¼å’Œé¢„æµ‹ä»·æ ¼ä¹‹é—´çš„å·®å¼‚å°†ä¸º 1K ç¾å…ƒï¼›è¿™å°±æ˜¯æŸå¤±å‡½æ•°å¸®åŠ©æˆ‘ä»¬çš„ç½‘ç»œå†³å®šçš„ã€‚

å›åˆ°åå‘ä¼ æ’­ï¼Œåœ¨æˆ‘ä»¬å€ŸåŠ©æŸå¤±å‡½æ•°è®¡ç®—æ¨¡å‹é¢„æµ‹å’ŒåŸå§‹å€¼çš„è¯¯å·®ä¹‹åï¼Œ**æˆ‘ä»¬å‘å›è¿™ä¸ªè¯¯å·®ä»¥æ›´æ–°æˆ‘ä»¬çš„è¾“å…¥ç¥ç»å…ƒæˆ–** **æƒé‡å’Œåå·®ã€‚è¿™è¢«ç§°ä¸ºåå‘ä¼ æ’­ã€‚**

ä½†æ˜¯æˆ‘ä»¬éœ€è¦å¤šå°‘æ¥æ›´æ–°æˆ‘ä»¬çš„**æƒé‡å’Œåå·®**ï¼Ÿ

**ä¸ºäº†çŸ¥é“è°ƒæ•´æƒé‡å’Œåå·®çš„é€‚å½“é‡ï¼Œæˆ‘ä»¬å¿…é¡»æ¨å¯¼å‡º*æˆ‘ä»¬çš„* *æƒé‡å’Œåå·®çš„æŸå¤±å‡½æ•°*ã€‚**

æˆ‘è®¤ä¸ºç°åœ¨æˆ‘ä»¬æœ‰è¶³å¤Ÿçš„ç›´è§‰æ¥å¼€å§‹æˆ‘ä»¬çš„ç¼–ç éƒ¨åˆ†ã€‚

# å®ç°äººå·¥ç¥ç»ç½‘ç»œå¯¹æ‰‹ç»˜å¤©ä½“æ–‡å­—çš„åˆ†ç±»

æˆ‘ä»¬å°†ä½¿ç”¨ PyTorch åº“æ¥æ„å»ºæˆ‘ä»¬çš„ç¥ç»ç½‘ç»œã€‚

æˆ‘å†™äº†ä¸€ä¸ªå°ç¨‹åº *plot_images* ç”¨äºæ˜¾ç¤ºå­—ç¬¦åŠå…¶æ ‡ç­¾ã€‚

è®©æˆ‘ä»¬çœ‹çœ‹æˆ‘ä»¬çš„ CSV æ–‡ä»¶ä¸­æœ‰ä»€ä¹ˆã€‚

*df.head()* å°†ç»™å‡ºæ•°æ®å¸§çš„å‰ 5 åˆ—ã€‚åœ¨æˆ‘ä»¬çš„æ•°æ®é›†ä¸­ï¼Œæˆ‘ä»¬æœ‰ä» 0 åˆ° 1023 çš„åƒç´ å€¼ã€‚ç”¨äºæ˜¾ç¤ºç‰¹å®šå­—ç¬¦çš„*å­—ç¬¦*åˆ—ç”±ç‰¹å®šåƒç´ å€¼ç»„æˆã€‚

è®©æˆ‘ä»¬è¿è¡Œæˆ‘ä»¬çš„ *plot_images* å‡½æ•°ï¼Œçœ‹çœ‹è¿™äº›å›¾åƒã€‚

```
>>plot_images(df, 4, "character")
```

![](img/03c93e311d7001ceb5d219f37474c073.png)

æˆ‘ä»¬çš„æ•°æ®é›†ä¸­æœ‰ 46 ä¸ªç‹¬ç‰¹çš„æ‰‹ç»˜å­—ç¬¦ï¼›å› æ­¤ï¼Œæ•°å­— 46 å°†æ˜¯æˆ‘ä»¬ç¥ç»ç½‘ç»œçš„è¾“å‡ºç»´åº¦ã€‚

ä½†æ˜¯åœ¨åˆ›å»ºç¥ç»ç½‘ç»œä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å‡†å¤‡æ•°æ®åŠ è½½å™¨ï¼Œä»¥ä¾¿å°†å®ƒæä¾›ç»™æˆ‘ä»¬çš„æ¨¡å‹è¿›è¡Œè®­ç»ƒå’Œæµ‹è¯•ï¼Œå› ä¸º NumPy æ•°æ®ä¸èƒ½ä¸ PyTorch çš„åº“ä¸€èµ·å·¥ä½œã€‚

å› æ­¤ï¼Œåœ¨ä¸Šé¢çš„ä»£ç ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬è¯»å–æ•°æ®å¹¶ä»ä¸­åˆ†ç¦»å‡ºè¦ç´ å’Œæ ‡ç­¾ã€‚**å¦‚æœä½ æ³¨æ„åˆ°äº†ï¼Œæˆ‘ä¹Ÿåœ¨ç”¨ 255.0 é™¤*features _ numpy*ï¼›æˆ‘è¿™æ ·åšæ˜¯ä¸ºäº†è§„èŒƒæˆ‘ä»¬çš„åƒç´ å€¼ã€‚**

ç„¶åï¼Œæˆ‘å°†æˆ‘ä»¬çš„åˆ†ç±»æ ‡ç­¾è½¬æ¢æˆä»£ç ï¼Œå› ä¸ºæˆ‘ä»¬åªèƒ½ç”¨æ•°å­—æ•°æ®æ¥åˆ›å»ºå¼ é‡å€¼ã€‚

åœ¨æˆ‘ä»¬çš„ *data_loader* å‡½æ•°ä¸­ï¼Œæˆ‘ä»¬è·å–ç‰¹æ€§å’Œç›®æ ‡ï¼›å¦‚æœå®ƒä»¬åœ¨ NumPy æ•°æ®ä¸­ï¼Œæˆ‘ä»¬å°±æŠŠå®ƒä»¬è½¬æ¢æˆå¼ é‡ï¼›ä¹‹åï¼Œæˆ‘ä»¬ç”¨***torch . utils . Data . tensordatasetã€*** å’Œ**åˆ›å»ºå¼ é‡æ•°æ®ï¼Œæœ€åå°†æ•°æ®è½¬æ¢æˆæ•°æ®åŠ è½½å™¨ã€‚**

å°±æ˜¯è¿™æ ·ï¼›æˆ‘ä»¬çš„æ•°æ®ç°åœ¨å¯ä»¥è¾“å…¥åˆ°æ¨¡å‹ä¸­äº†ã€‚è®©æˆ‘ä»¬ç°åœ¨å»ºç«‹ç¥ç»ç½‘ç»œã€‚

åœ¨æˆ‘ä»¬çš„ **ANNModel ä¸­ï¼Œå– 32*32ï¼Œæœ€åä¸€å±‚è¾“å…¥çš„è¾“å‡ºç»´åº¦ä¸º 46ã€‚ä½†æ˜¯æˆ‘ä»¬è¿™é‡Œæœ‰ä¸¤ä¸ªæˆ‘è¿˜æ²¡æœ‰è°ˆåˆ°çš„æ–°æœ¯è¯­ã€‚**

**Dropout:åˆ é™¤å¸¦æœ‰æ¦‚ç‡å€¼çš„éšæœºæ¿€æ´»æƒé‡ã€‚å‡è®¾æˆ‘ä»¬å·²ç»å°†æ¦‚ç‡å€¼è®¾ç½®ä¸º 0.2ã€‚é‚£ä¹ˆå¯¹äºæ¯ä¸€ä¸ªå‰é¦ˆæˆ–è€…åå‘ä¼ æ’­è¿‡ç¨‹ï¼Œå®ƒéƒ½ä¼šå¿½ç•¥æ‰é‚£ 20%çš„ç¥ç»å…ƒã€‚å®ƒæœ‰åŠ©äºé˜²æ­¢è¿‡åº¦åˆèº«ã€‚**

**Softmax:åœ¨æ•°å­¦ä¸­ï¼ŒSoftmax å‡½æ•°ï¼Œä¹Ÿç§°ä¸º softargmax æˆ–å½’ä¸€åŒ–æŒ‡æ•°å‡½æ•°ï¼Œæ˜¯ä¸€ä¸ªå°† K ä¸ªå®æ•°çš„å‘é‡ä½œä¸ºè¾“å…¥ï¼Œå¹¶å°†å…¶å½’ä¸€åŒ–ä¸ºç”± K ä¸ªä¸è¾“å…¥æ•°çš„æŒ‡æ•°æˆæ¯”ä¾‹çš„æ¦‚ç‡ç»„æˆçš„æ¦‚ç‡åˆ†å¸ƒçš„å‡½æ•°ã€‚**

é€šè¿‡ç†è§£è¿™ä¸¤ä¸ªæœ¯è¯­ï¼Œæˆ‘ä»¬ç°åœ¨å¯ä»¥ç»§ç»­åŸ¹è®­è¿‡ç¨‹ã€‚

è®­ç»ƒè¿‡ç¨‹ç®€å•ï¼›æˆ‘ä»¬æ­£åœ¨è¿­ä»£æˆ‘ä»¬çš„è®­ç»ƒæ•°æ®åŠ è½½å™¨çš„å›¾åƒå’Œæ ‡ç­¾ã€‚ç„¶åæ¸…é™¤åˆå§‹æ¢¯åº¦å€¼å¹¶éšåè¿›è¡Œé¢„æµ‹ã€‚è¿è¡Œè¿™ä¸ªç¨‹åºåï¼Œæ‚¨åº”è¯¥å¯ä»¥è·å¾—è¶…è¿‡ 94%çš„æµ‹è¯•æ•°æ®çš„å‡†ç¡®ç‡ã€‚

ä¸å¯èƒ½è§£é‡Šæ¯ä¸€æ­¥ï¼›è¯·åœ¨è¯„è®ºåŒºé—®æˆ‘ã€‚

åŸ¹è®­ç»“æŸåï¼Œè®©æˆ‘ä»¬çœ‹çœ‹æˆ‘ä»¬çš„åŸ¹è®­å’ŒéªŒè¯æ›²çº¿ã€‚

![](img/6f2845f2f9119641b68b2d0d7a581663.png)

Training vs. Validation loss

çœ‹èµ·æ¥ä¸é”™ã€‚:)

## æ¨è®º:

è®©æˆ‘ä»¬æ£€æŸ¥ä¸€ä¸‹æˆ‘ä»¬çš„æ¨¡å‹åœ¨æµ‹è¯•æ•°æ®ä¸Šçš„è¡¨ç°ã€‚

```
>> make_predictions(test_loader, 44)
```

![](img/bb5db742937febd116a8a31e7b8688b0.png)

Inference

å®ƒåšå¾—éå¸¸å¥½ã€‚:)

å‚è€ƒ

[](https://en.wikipedia.org/wiki/Softmax_function) [## Softmax å‡½æ•°

### åœ¨æ•°å­¦ä¸­ï¼Œsoftmax å‡½æ•°ï¼Œä¹Ÿç§°ä¸º softargmax æˆ–å½’ä¸€åŒ–æŒ‡æ•°å‡½æ•°ï¼Œ[2] :198 æ˜¯ä¸€ä¸ªâ€¦

en.wikipedia.org](https://en.wikipedia.org/wiki/Softmax_function) 

æ•°æ®é›†:

 [## æ¢µæ–‡å­—ç¬¦é›†

### ä¸‹è½½æ•°åƒä¸ªé¡¹ç›®çš„å¼€æ”¾æ•°æ®é›†+åœ¨ä¸€ä¸ªå¹³å°ä¸Šå…±äº«é¡¹ç›®ã€‚æ¢ç´¢çƒ­é—¨è¯é¢˜ï¼Œå¦‚æ”¿åºœâ€¦

www.kaggle.com](https://www.kaggle.com/rishianand/devanagari-character-set)