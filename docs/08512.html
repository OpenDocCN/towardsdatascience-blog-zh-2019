<html>
<head>
<title>Streamlit 101: An in-depth introduction</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Streamlit 101:深入介绍</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/streamlit-101-an-in-depth-introduction-fc8aad9492f2?source=collection_archive---------3-----------------------#2019-11-18">https://towardsdatascience.com/streamlit-101-an-in-depth-introduction-fc8aad9492f2?source=collection_archive---------3-----------------------#2019-11-18</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="ip iq gp gr ir is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/d8d8a8d77fe4a7e2102e139e65af15c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aG4aAXDyepK4ra2jcHyd6g.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Streamlit app with code</figcaption></figure><div class=""/><div class=""><h2 id="ca1a" class="pw-subtitle-paragraph kc je jf bd b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt dk translated">使用 Airbnb 纽约数据深入了解 Streamlit</h2></div><p id="0b2f" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated"><a class="ae lq" href="https://streamlit.io/" rel="noopener ugc nofollow" target="_blank"> Streamlit 是一个令人敬畏的新工具</a>，它允许工程师围绕他们的数据、机器学习模型和几乎任何东西快速构建高度交互式的网络应用。</p><p id="e3cb" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">Streamlit 最大的优点是它不需要任何 web 开发知识。如果你懂 Python，你就可以开始了！</p><p id="db38" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated"><a class="ae lq" href="https://github.com/shaildeliwala/experiments/blob/master/streamlit.py" rel="noopener ugc nofollow" target="_blank">这是本教程的完整代码</a>，如果你想继续学习本教程的话。</p><h1 id="23e3" class="lr ls jf bd lt lu lv lw lx ly lz ma mb kl mc km md ko me kp mf kr mg ks mh mi bi translated">为什么细流是超级酷的</h1><p id="c0ee" class="pw-post-body-paragraph ku kv jf kw b kx mj kg kz la mk kj lc ld ml lf lg lh mm lj lk ll mn ln lo lp ij bi translated">一句话:它给了你一个<em class="mo">惊人的</em>快速、迭代和交互式的开发循环。</p><p id="7e03" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">分割你的屏幕，使你的代码编辑工具在一半，你的浏览器在另一半，编辑你的代码，并看到你的应用程序即时更新！关于 Streamlit，我最喜欢的部分是它如何在几个小时内让您从 Jupyter 笔记本变成一个值得向客户展示的时尚 web 应用程序。</p><h1 id="564d" class="lr ls jf bd lt lu lv lw lx ly lz ma mb kl mc km md ko me kp mf kr mg ks mh mi bi translated">设置它</h1><p id="f354" class="pw-post-body-paragraph ku kv jf kw b kx mj kg kz la mk kj lc ld ml lf lg lh mm lj lk ll mn ln lo lp ij bi translated">安装步骤:</p><pre class="mp mq mr ms gt mt mu mv mw aw mx bi"><span id="75a5" class="my ls jf mu b gy mz na l nb nc">$ pip install streamlit<br/>$ streamlit hello</span></pre><p id="391e" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">进口:</p><pre class="mp mq mr ms gt mt mu mv mw aw mx bi"><span id="f1d3" class="my ls jf mu b gy mz na l nb nc">import pandas as pd<br/>import streamlit as st<br/>import plotly.express as px</span></pre><p id="5e2e" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">要运行您的 Streamlit 应用程序:</p><pre class="mp mq mr ms gt mt mu mv mw aw mx bi"><span id="659d" class="my ls jf mu b gy mz na l nb nc">$ streamlit run app.py</span></pre><h1 id="51f5" class="lr ls jf bd lt lu lv lw lx ly lz ma mb kl mc km md ko me kp mf kr mg ks mh mi bi translated">获取 Airbnb 纽约房源数据</h1><p id="2beb" class="pw-post-body-paragraph ku kv jf kw b kx mj kg kz la mk kj lc ld ml lf lg lh mm lj lk ll mn ln lo lp ij bi translated">Airbnb 没有正式发布任何数据。Airbnb 内部的另一个名为<a class="ae lq" href="http://insideairbnb.com/" rel="noopener ugc nofollow" target="_blank">的小组</a>定期发布 Airbnb 房源并审核数据。</p><pre class="mp mq mr ms gt mt mu mv mw aw mx bi"><span id="6b33" class="my ls jf mu b gy mz na l nb nc"><strong class="mu jg">@st.cache</strong><br/>def<strong class="mu jg"> </strong>get_data():<br/>    url = "http://data.insideairbnb.com/united-states/ny/new-york-city/2019-09-12/visualisations/listings.csv"<br/>    return pd.read_csv(url)</span><span id="bdaf" class="my ls jf mu b gy nd na l nb nc">df = get_data()</span></pre><h2 id="eedf" class="my ls jf bd lt ne nf dn lx ng nh dp mb ld ni nj md lh nk nl mf ll nm nn mh no bi translated">数据缓存</h2><p id="6e4c" class="pw-post-body-paragraph ku kv jf kw b kx mj kg kz la mk kj lc ld ml lf lg lh mm lj lk ll mn ln lo lp ij bi translated"><code class="fe np nq nr mu b">st.cache</code> decorator 表示 Streamlit 将执行内部魔术，这样数据将只下载一次并缓存以备将来使用。</p><p id="760c" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">在幕后，Streamlit 跟踪函数名、函数体中的代码以及我们在函数调用中传递的输入参数。在第一次调用时，它将函数的返回值存储在本地缓存中。在随后使用完全相同的参数调用该函数时，Streamlit 从本地缓存返回结果。</p><p id="7a90" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">Streamlit 数据缓存的主要限制是它不能跟踪函数体外部发生的数据更改。</p><h1 id="c508" class="lr ls jf bd lt lu lv lw lx ly lz ma mb kl mc km md ko me kp mf kr mg ks mh mi bi translated">以标题(和引用)开始</h1><pre class="mp mq mr ms gt mt mu mv mw aw mx bi"><span id="e881" class="my ls jf mu b gy mz na l nb nc"><strong class="mu jg">st.title</strong>("Streamlit 101: An in-depth introduction")<br/><strong class="mu jg">st.markdown</strong>("Welcome to this in-depth introduction to [...].")</span><span id="ede7" class="my ls jf mu b gy nd na l nb nc"><strong class="mu jg">st.header</strong>("Customary quote")<br/><strong class="mu jg">st.markdown</strong>("&gt; I just love to go home, no matter where I am [...]")</span></pre><p id="38b0" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">上面的代码呈现了以下内容。</p><figure class="mp mq mr ms gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ns"><img src="../Images/8b52890a08d4fbee1ba0dafce8e78e52.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kQ-NwZp19dHWCpxKS2QhbA.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Title, section header, and Markdown content rendered by Streamlit</figcaption></figure><p id="73c3" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated"><a class="ae lq" href="https://streamlit.io/docs/api.html#streamlit.title" rel="noopener ugc nofollow" target="_blank"> st.title </a>适合主标题。对于章节标题，使用<a class="ae lq" href="https://streamlit.io/docs/api.html#streamlit.header" rel="noopener ugc nofollow" target="_blank">第一标题</a>或<a class="ae lq" href="https://streamlit.io/docs/api.html#streamlit.subheader" rel="noopener ugc nofollow" target="_blank">第二标题</a>。</p><p id="e233" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated"><a class="ae lq" href="https://streamlit.io/docs/api.html#streamlit.markdown" rel="noopener ugc nofollow" target="_blank"> st.markdown </a>呈现使用<a class="ae lq" href="https://github.github.com/gfm" rel="noopener ugc nofollow" target="_blank"> Github 风格的 Markdown </a>编写的任何字符串。它也支持 HTML，但 Streamlit 建议不要允许，因为存在潜在的用户安全问题。</p><h1 id="ff6a" class="lr ls jf bd lt lu lv lw lx ly lz ma mb kl mc km md ko me kp mf kr mg ks mh mi bi translated">数据一览</h1><p id="0f28" class="pw-post-body-paragraph ku kv jf kw b kx mj kg kz la mk kj lc ld ml lf lg lh mm lj lk ll mn ln lo lp ij bi translated">这是我们开始探索性分析时通常做的第一件事。<a class="ae lq" href="https://streamlit.io/docs/api.html#streamlit.dataframe" rel="noopener ugc nofollow" target="_blank"> st.dataframe </a>渲染熊猫数据帧。</p><pre class="mp mq mr ms gt mt mu mv mw aw mx bi"><span id="cb89" class="my ls jf mu b gy mz na l nb nc"><strong class="mu jg">st.dataframe</strong>(df.head())</span></pre><figure class="mp mq mr ms gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nt"><img src="../Images/7006b08f630b092a11a9206a5d620dbc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kPQJiy49a6ffeEJ_CD7Ezw.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Pandas dataframe rendered using <a class="ae lq" href="https://streamlit.io/docs/api.html#streamlit.dataframe" rel="noopener ugc nofollow" target="_blank">streamlit.dataframe</a></figcaption></figure><p id="4bb1" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">我喜欢它允许在点击任何列标题时对数据帧进行排序(注意<em class="mo"> host_name </em>标题中的小 v 形符号)。</p><p id="e33d" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">右上角有一个方便的小按钮，可以切换到全屏视图。非常适合查看较大的数据框，无需过多滚动。</p><p id="73ba" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">它还支持<a class="ae lq" href="https://pandas.pydata.org/pandas-docs/stable/user_guide/style.html" rel="noopener ugc nofollow" target="_blank">样式的</a>数据帧。</p><h1 id="11df" class="lr ls jf bd lt lu lv lw lx ly lz ma mb kl mc km md ko me kp mf kr mg ks mh mi bi translated">代码块</h1><p id="9888" class="pw-post-body-paragraph ku kv jf kw b kx mj kg kz la mk kj lc ld ml lf lg lh mm lj lk ll mn ln lo lp ij bi translated"><a class="ae lq" href="https://streamlit.io/docs/api.html#streamlit.code" rel="noopener ugc nofollow" target="_blank"> st.code </a>渲染单行和多行代码块。还有一个指定编程语言的选项。</p><pre class="mp mq mr ms gt mt mu mv mw aw mx bi"><span id="611c" class="my ls jf mu b gy mz na l nb nc">st.code("""<br/>@st.cache<br/>def get_data():<br/>    url = "http://data.insideairbnb.com/[...]"<br/>    return pd.read_csv(url)<br/>""", language="python")</span></pre><figure class="mp mq mr ms gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nu"><img src="../Images/3e4c75addd69cd8918577a2989c1889f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0uhqyvIlGKbON9RHu0hhlA.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Code rendered using <a class="ae lq" href="https://streamlit.io/docs/api.html#streamlit.code" rel="noopener ugc nofollow" target="_blank"><em class="nv">streamlit.code</em></a></figcaption></figure><p id="aae8" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">或者，使用一个<code class="fe np nq nr mu b">with <a class="ae lq" href="https://streamlit.io/docs/api.html#streamlit.echo" rel="noopener ugc nofollow" target="_blank">st.echo</a></code>块执行其中的代码，并将其作为应用程序中的一个代码段。</p><figure class="mp mq mr ms gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nw"><img src="../Images/637e9e1d25a02d9634103d01d88d08fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LZ6vbJtOwL2Zn9bFNwZhFg.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Code rendered using <a class="ae lq" href="https://streamlit.io/docs/api.html#streamlit.echo" rel="noopener ugc nofollow" target="_blank">streamlit.echo</a></figcaption></figure><h1 id="facb" class="lr ls jf bd lt lu lv lw lx ly lz ma mb kl mc km md ko me kp mf kr mg ks mh mi bi translated">纽约最贵的 Airbnb 房源</h1><p id="dabf" class="pw-post-body-paragraph ku kv jf kw b kx mj kg kz la mk kj lc ld ml lf lg lh mm lj lk ll mn ln lo lp ij bi translated">Airbnb 最贵的房产都在哪里？</p><h2 id="7839" class="my ls jf bd lt ne nf dn lx ng nh dp mb ld ni nj md lh nk nl mf ll nm nn mh no bi translated">在地图上</h2><p id="5158" class="pw-post-body-paragraph ku kv jf kw b kx mj kg kz la mk kj lc ld ml lf lg lh mm lj lk ll mn ln lo lp ij bi translated"><a class="ae lq" href="https://streamlit.io/docs/api.html#streamlit.map" rel="noopener ugc nofollow" target="_blank"> st.map </a>在地图上显示位置，无需编写一行样板代码来准备地图对象。唯一的要求是 dataframe 必须包含名为<em class="mo"> lat </em> / <em class="mo"> latitude </em>或<em class="mo">lon</em>/<em class="mo">longitude</em>的列。</p><figure class="mp mq mr ms gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi gj"><img src="../Images/3506e7e49aaa739b1c750645b009a430.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Oq4g17updYslv2igZhgWog.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk"><a class="ae lq" href="https://streamlit.io/docs/api.html#streamlit.map" rel="noopener ugc nofollow" target="_blank">Streamlit map</a> with markers based on latitude and longitude</figcaption></figure><p id="fd4f" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">不出所料，曼哈顿岛是昂贵的航空公司最集中的地方。一些分散在布鲁克林。最贵的标价是 10000 美元。</p><p id="5e81" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated"><a class="ae lq" href="https://streamlit.io/docs/api.html#streamlit.deck_gl_chart" rel="noopener ugc nofollow" target="_blank"> st.deck_gl_chart </a>允许更多参数创建更有趣的定制地图。</p><h1 id="370a" class="lr ls jf bd lt lu lv lw lx ly lz ma mb kl mc km md ko me kp mf kr mg ks mh mi bi translated">选择列的子集</h1><p id="70cc" class="pw-post-body-paragraph ku kv jf kw b kx mj kg kz la mk kj lc ld ml lf lg lh mm lj lk ll mn ln lo lp ij bi translated">Streamlit 有一个<a class="ae lq" href="https://streamlit.io/docs/api.html#streamlit.multiselect" rel="noopener ugc nofollow" target="_blank"> multiselect </a>小部件，允许从项目列表中选择或删除项目。这让我们可以为 dataframe 构建一个列选择器小部件。</p><pre class="mp mq mr ms gt mt mu mv mw aw mx bi"><span id="1f78" class="my ls jf mu b gy mz na l nb nc">cols = ["name", "host_name", "neighbourhood", "room_type", "price"]<br/>st_ms = st.multiselect("Columns", df.columns.tolist(), default=cols)</span></pre><figure class="mp mq mr ms gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nx"><img src="../Images/d8822cce282d9814f3fa4548eb8e5de4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7fcacSDkbMF5d3tmaNmNeQ.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk"><a class="ae lq" href="https://streamlit.io/docs/api.html#streamlit.multiselect" rel="noopener ugc nofollow" target="_blank">Streamlit multi-select</a> widget with auto-completion</figcaption></figure><p id="9585" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">multiselect 小部件是 Streamlit 中最强大、最方便的工具之一。除了列选择之外，还有一个用途是基于列的一个或多个值来过滤数据帧。另一种方法是根据不同模型的预测，为并排比较 ROC 曲线选择支线图。</p><h1 id="fc08" class="lr ls jf bd lt lu lv lw lx ly lz ma mb kl mc km md ko me kp mf kr mg ks mh mi bi translated">按房间类型划分的平均价格</h1><p id="de1a" class="pw-post-body-paragraph ku kv jf kw b kx mj kg kz la mk kj lc ld ml lf lg lh mm lj lk ll mn ln lo lp ij bi translated">哪种房型平均最贵？</p><h2 id="3891" class="my ls jf bd lt ne nf dn lx ng nh dp mb ld ni nj md lh nk nl mf ll nm nn mh no bi translated">在静态表中</h2><p id="9a00" class="pw-post-body-paragraph ku kv jf kw b kx mj kg kz la mk kj lc ld ml lf lg lh mm lj lk ll mn ln lo lp ij bi translated"><a class="ae lq" href="https://streamlit.io/docs/api.html#streamlit.table" rel="noopener ugc nofollow" target="_blank"> st.table </a>显示一个静态表。但是，您不能通过单击列标题对其进行排序。</p><pre class="mp mq mr ms gt mt mu mv mw aw mx bi"><span id="b5cf" class="my ls jf mu b gy mz na l nb nc"><strong class="mu jg">st.table</strong>(df.groupby("room_type").price.mean().reset_index()\<br/>.round(2).sort_values("price", ascending=False)\<br/>.assign(avg_price=lambda x: x.pop("price").apply(lambda y: "%.2f" % y)))</span></pre><figure class="mp mq mr ms gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ny"><img src="../Images/5f96667735a482ee78751562086f332a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gIWHjn-_jwJZQ_GQmWXGBg.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk"><a class="ae lq" href="https://streamlit.io/docs/api.html#streamlit.table" rel="noopener ugc nofollow" target="_blank">Static table</a> rendered by Streamlit</figcaption></figure><h1 id="d91b" class="lr ls jf bd lt lu lv lw lx ly lz ma mb kl mc km md ko me kp mf kr mg ks mh mi bi translated">哪些主机列出的属性最多？</h1><p id="64d9" class="pw-post-body-paragraph ku kv jf kw b kx mj kg kz la mk kj lc ld ml lf lg lh mm lj lk ll mn ln lo lp ij bi translated">Sonder (NYC) 以 387 个房产列表位居榜首。Blueground 排名第二，有 240 个条目。下面是从使用<code class="fe np nq nr mu b"><a class="ae lq" href="https://streamlit.io/docs/api.html#streamlit.json" rel="noopener ugc nofollow" target="_blank">st.json</a></code>呈现为 JSON 的两个清单中随机选择的清单。</p><p id="0959" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">Streamlit 呈现完全交互式的 JSON 部分，支持折叠/展开对象和数组，以及复制到剪贴板功能。</p><figure class="mp mq mr ms gt is gh gi paragraph-image"><div class="gh gi nz"><img src="../Images/8fff29882f046871312b5032652042b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1288/format:webp/1*dMiVpXOJCzWPGAaGg7NhKg.png"/></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk"><a class="ae lq" href="https://streamlit.io/docs/api.html#streamlit.json" rel="noopener ugc nofollow" target="_blank">JSON section</a> rendered by Streamlit</figcaption></figure><h1 id="1f65" class="lr ls jf bd lt lu lv lw lx ly lz ma mb kl mc km md ko me kp mf kr mg ks mh mi bi translated">房产价格分布是怎样的？</h1><p id="3ce3" class="pw-post-body-paragraph ku kv jf kw b kx mj kg kz la mk kj lc ld ml lf lg lh mm lj lk ll mn ln lo lp ij bi translated">我们使用<a class="ae lq" href="https://streamlit.io/docs/api.html#streamlit.plotly_chart" rel="noopener ugc nofollow" target="_blank"> st.plotly_chart </a>将房地产价格直方图显示为 Plotly 图表。</p><h2 id="7834" class="my ls jf bd lt ne nf dn lx ng nh dp mb ld ni nj md lh nk nl mf ll nm nn mh no bi translated">边栏和价格范围滑块</h2><p id="a9ec" class="pw-post-body-paragraph ku kv jf kw b kx mj kg kz la mk kj lc ld ml lf lg lh mm lj lk ll mn ln lo lp ij bi translated">我们使用<a class="ae lq" href="https://streamlit.io/docs/api.html#streamlit.slider" rel="noopener ugc nofollow" target="_blank"> st.slider </a>来提供一个滑块，允许选择直方图的自定义范围。我们把它藏在一个侧边栏里。</p><pre class="mp mq mr ms gt mt mu mv mw aw mx bi"><span id="e19a" class="my ls jf mu b gy mz na l nb nc">values = <strong class="mu jg">st.sidebar.slider</strong>(“Price range”, float(df.price.min()), 1000., (50., 300.))<br/>f = px.histogram(df.query(f”price.between{values}”), x=”price”, nbins=15, title=”Price distribution”)<br/>f.update_xaxes(title=”Price”)<br/>f.update_yaxes(title=”No. of listings”)<br/><strong class="mu jg">st.plotly_chart</strong>(f)</span></pre><figure class="mp mq mr ms gt is gh gi paragraph-image"><div class="gh gi oa"><img src="../Images/3266aca9138ffc1e41a41f6815fafc07.png" data-original-src="https://miro.medium.com/v2/resize:fit:634/format:webp/1*v2yoVBGtX3zacvHm43DerA.png"/></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">In the sidebar</figcaption></figure><figure class="mp mq mr ms gt is gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/414beeb6ca86fe4823c21523e4aa9a1a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1396/format:webp/1*navLPtJxtJ8uNP0xlZ9CEw.png"/></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">On the main page</figcaption></figure><p id="0acc" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">最高的条形对应于 60-79 美元的价格范围，有 7229 个列表。</p><p id="13fe" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated"><em class="mo">注意:在本教程中，我将滑块的最大值限制为 1000，这样范围选择就会清晰可见。</em></p><h1 id="497b" class="lr ls jf bd lt lu lv lw lx ly lz ma mb kl mc km md ko me kp mf kr mg ks mh mi bi translated">不同社区的可用性分布</h1><p id="4669" class="pw-post-body-paragraph ku kv jf kw b kx mj kg kz la mk kj lc ld ml lf lg lh mm lj lk ll mn ln lo lp ij bi translated"><code class="fe np nq nr mu b">availability_365</code>表示酒店全年可用的天数。我们按邻居组检查<code class="fe np nq nr mu b">availability_365</code>的汇总统计数据。</p><p id="2c54" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">使用<a class="ae lq" href="https://streamlit.io/docs/api.html#streamlit.radio" rel="noopener ugc nofollow" target="_blank"> st.radio </a>，我们显示一个可供选择的邻居组列表。默认情况下，我们排除价格≥200 美元的物品，并使用<a class="ae lq" href="https://streamlit.io/docs/api.html#streamlit.checkbox" rel="noopener ugc nofollow" target="_blank"> st.checkbox </a>提供一个<em class="mo">包含昂贵物品</em>复选框。</p><p id="4316" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">st.write 是一种伞状函数，接受字符串、数据帧、字典、绘图、地图等等(文档中的完整列表)。它允许传入多个参数，其行为取决于它们的类型。</p><pre class="mp mq mr ms gt mt mu mv mw aw mx bi"><span id="c151" class="my ls jf mu b gy mz na l nb nc"><strong class="mu jg">st.write</strong>("Using a radio button restricts selection to only one option at a time.")<br/>neighborhood = <strong class="mu jg">st.radio</strong>("Neighborhood", df.neighbourhood_group.unique())<br/>show_exp = <strong class="mu jg">st.checkbox</strong>("Include expensive listings")</span></pre><figure class="mp mq mr ms gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi oc"><img src="../Images/b9d2d412e348fb998a5c56e5e89f720c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mnt_vDEnXQIGDPuXdDg66A.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk"><a class="ae lq" href="https://streamlit.io/docs/api.html#streamlit.radio" rel="noopener ugc nofollow" target="_blank">Radio group</a> and <a class="ae lq" href="https://streamlit.io/docs/api.html#streamlit.checkbox" rel="noopener ugc nofollow" target="_blank">checkbox</a> rendered by Streamlit</figcaption></figure><p id="00fa" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">169 天，布鲁克林的平均可用性最低。斯塔滕岛的平均可用性最高，为 226。如果我们包括昂贵的清单(价格&gt; = 200 美元)，这个数字分别是 171 和 230。</p><p id="05f4" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated"><strong class="kw jg"> <em class="mo">注意:</em> </strong> <em class="mo">有 18431 条记录带有</em> <code class="fe np nq nr mu b"><em class="mo">availability_365</em></code> <em class="mo"> 0(零)，我已经忽略了。</em></p><h2 id="a459" class="my ls jf bd lt ne nf dn lx ng nh dp mb ld ni nj md lh nk nl mf ll nm nn mh no bi translated">按邻居组列出的平均可用性</h2><p id="23c9" class="pw-post-body-paragraph ku kv jf kw b kx mj kg kz la mk kj lc ld ml lf lg lh mm lj lk ll mn ln lo lp ij bi translated"><a class="ae lq" href="https://streamlit.io/docs/api.html#streamlit.checkbox" rel="noopener ugc nofollow" target="_blank"> st.pyplot </a>渲染使用 matplotlib 构建的地块，如下图所示。</p><pre class="mp mq mr ms gt mt mu mv mw aw mx bi"><span id="5252" class="my ls jf mu b gy mz na l nb nc">df.query("availability_365&gt;0")\<br/>.groupby("neighbourhood_group")\<br/>.availability_365.mean()\<br/>.plot.bar(rot=0)\<br/>.set(title="Average availability by neighborhood group",<br/>xlabel="Neighborhood group", ylabel="Avg. availability (in no. of days)")<br/><strong class="mu jg">st.pyplot</strong>()</span></pre><figure class="mp mq mr ms gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi od"><img src="../Images/c3cb90ff55302b1b1bb030b78cca5df4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*g4CmpDo4_QJPpjC1nbu8Rg.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Created with pandas (matplotlib)</figcaption></figure><h1 id="a43e" class="lr ls jf bd lt lu lv lw lx ly lz ma mb kl mc km md ko me kp mf kr mg ks mh mi bi translated">评论数量</h1><p id="762b" class="pw-post-body-paragraph ku kv jf kw b kx mj kg kz la mk kj lc ld ml lf lg lh mm lj lk ll mn ln lo lp ij bi translated">我们希望查看评论数量在我们可以自定义的范围内的属性。</p><p id="c420" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">在侧栏中，我们使用<a class="ae lq" href="https://streamlit.io/docs/api.html#streamlit.number_input" rel="noopener ugc nofollow" target="_blank"> st.number_input </a>提供了一个数字范围选择器。如果<code class="fe np nq nr mu b">minimum</code> &gt; <code class="fe np nq nr mu b">maximum</code>，我们使用<a class="ae lq" href="https://streamlit.io/docs/api.html#streamlit.number_input" rel="noopener ugc nofollow" target="_blank"> st.error </a>显示错误信息。</p><pre class="mp mq mr ms gt mt mu mv mw aw mx bi"><span id="5137" class="my ls jf mu b gy mz na l nb nc">minimum = <strong class="mu jg">st.sidebar.number_input</strong>("Minimum", min_value=0)<br/>maximum = <strong class="mu jg">st.sidebar.number_input</strong>("Maximum", min_value=0, value=5)<br/>if minimum &gt; maximum:<br/>    <strong class="mu jg">st.error</strong>("Please enter a valid range")<br/>else:<br/>    df.query("@minimum&lt;=number_of_reviews&lt;=@maximum")</span></pre><figure class="mp mq mr ms gt is gh gi paragraph-image"><div class="gh gi oe"><img src="../Images/e322304028b871a14490dd9c7df6a78f.png" data-original-src="https://miro.medium.com/v2/resize:fit:624/format:webp/1*HcYArIfq4552i142kedAhA.png"/></div></figure><p id="1e45" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">486 是最高评论数。两个列表有这么多评论。两家都在东埃尔姆赫斯特街区，都是价格分别为 65 美元和 45 美元的私人房间。一般来说，超过 400 条评论的列表价格低于 100 美元。有几款在 100 美元到 200 美元之间，只有一款定价在 200 美元以上。</p><h1 id="2bc1" class="lr ls jf bd lt lu lv lw lx ly lz ma mb kl mc km md ko me kp mf kr mg ks mh mi bi translated">图像和下拉菜单</h1><p id="f118" class="pw-post-body-paragraph ku kv jf kw b kx mj kg kz la mk kj lc ld ml lf lg lh mm lj lk ll mn ln lo lp ij bi translated">使用<a class="ae lq" href="https://streamlit.io/docs/api.html#streamlit.image" rel="noopener ugc nofollow" target="_blank"> st.image </a>显示猫、小狗、特征重要性图、标记视频帧等的图像。</p><p id="acc2" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">现在来点好玩的。</p><pre class="mp mq mr ms gt mt mu mv mw aw mx bi"><span id="c3dc" class="my ls jf mu b gy mz na l nb nc">pics = {<br/>    "Cat": "https://cdn.pixabay.com/photo/2016/09/24/22/20/cat-1692702_960_720.jpg",<br/>    "Puppy": "https://cdn.pixabay.com/photo/2019/03/15/19/19/puppy-4057786_960_720.jpg",<br/>    "Sci-fi city": "https://storage.needpix.com/rsynced_images/science-fiction-2971848_1280.jpg"<br/>}<br/>pic = <strong class="mu jg">st.selectbox</strong>("Picture choices", list(pics.keys()), 0)<br/><strong class="mu jg">st.image</strong>(pics[pic], use_column_width=True, caption=pics[pic])</span></pre><figure class="mp mq mr ms gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi of"><img src="../Images/7450f43d1fb2a130d07f3a9de05f69b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DN1TZrJkd4fZTmwGjKg_Gw.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Cat image source: <a class="ae lq" href="https://cdn.pixabay.com/photo/2016/09/24/22/20/cat-1692702_960_720.jpg" rel="noopener ugc nofollow" target="_blank">https://cdn.pixabay.com/photo/2016/09/24/22/20/cat-1692702_960_720.jpg</a></figcaption></figure><h1 id="0a91" class="lr ls jf bd lt lu lv lw lx ly lz ma mb kl mc km md ko me kp mf kr mg ks mh mi bi translated">魔法</h1><p id="ea86" class="pw-post-body-paragraph ku kv jf kw b kx mj kg kz la mk kj lc ld ml lf lg lh mm lj lk ll mn ln lo lp ij bi translated">请注意，在上面的评论数量部分，我们将<code class="fe np nq nr mu b">df.query("@minimum&lt;=number_of_reviews&lt;=@maximum")</code>写在了它自己的一行上，而没有将其包装在对<code class="fe np nq nr mu b">st.dataframe</code>的调用中。这仍然呈现了一个数据帧，因为<a class="ae lq" href="https://streamlit.io/docs/api.html#magic-commands" rel="noopener ugc nofollow" target="_blank"> Streamlit 在其自己的行上检测到</a>一个变量或文字，并使用<code class="fe np nq nr mu b">st.write</code>来呈现它。</p><h1 id="f631" class="lr ls jf bd lt lu lv lw lx ly lz ma mb kl mc km md ko me kp mf kr mg ks mh mi bi translated">结论</h1><p id="40ba" class="pw-post-body-paragraph ku kv jf kw b kx mj kg kz la mk kj lc ld ml lf lg lh mm lj lk ll mn ln lo lp ij bi translated">我们已经讨论了交互式小部件、数据框、表格、图像、降价、绘图渲染、地图和文本内容。Streamlit 允许对现有元素和显示进度的<a class="ae lq" href="https://streamlit.io/docs/getting_started.html#show-progress" rel="noopener ugc nofollow" target="_blank">进行</a><a class="ae lq" href="https://streamlit.io/docs/api.html#mutate-data" rel="noopener ugc nofollow" target="_blank">修改，这在本教程中没有涉及。例如，您可以向现有表格中添加行，或者向图表中添加新数据。您还可以显示长时间运行的进程的进度条。</a></p><p id="d689" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">恭喜，您已经准备好开始构建自己的 Streamlit 应用程序。</p><h1 id="5b66" class="lr ls jf bd lt lu lv lw lx ly lz ma mb kl mc km md ko me kp mf kr mg ks mh mi bi translated">派对时间！</h1><p id="8231" class="pw-post-body-paragraph ku kv jf kw b kx mj kg kz la mk kj lc ld ml lf lg lh mm lj lk ll mn ln lo lp ij bi translated">当你运行为这个教程创建的<a class="ae lq" href="https://github.com/shaildeliwala/experiments/blob/master/streamlit.py" rel="noopener ugc nofollow" target="_blank">应用时，点击<strong class="kw jg"> <em class="mo">庆祝！</em> </strong>按钮由下面的代码呈现。</a></p><pre class="mp mq mr ms gt mt mu mv mw aw mx bi"><span id="5b1d" class="my ls jf mu b gy mz na l nb nc"><strong class="mu jg">st.markdown</strong>("## Party time!")<br/><strong class="mu jg">st.write</strong>("Yay! You're done with this tutorial of Streamlit. Click below to celebrate.")<br/>btn = <strong class="mu jg">st.button</strong>("Celebrate!")<br/>if btn:<br/>    <strong class="mu jg">st.balloons</strong>()</span></pre><h1 id="9025" class="lr ls jf bd lt lu lv lw lx ly lz ma mb kl mc km md ko me kp mf kr mg ks mh mi bi translated">下一步是什么？</h1><p id="1b33" class="pw-post-body-paragraph ku kv jf kw b kx mj kg kz la mk kj lc ld ml lf lg lh mm lj lk ll mn ln lo lp ij bi translated">我的下一篇文章将是关于我在 Kaggle 上的沃尔玛购物旅行类型分类竞赛中获得银牌(排名 35 /前 4%)的解决方案。</p><h1 id="6a0d" class="lr ls jf bd lt lu lv lw lx ly lz ma mb kl mc km md ko me kp mf kr mg ks mh mi bi translated">参考和链接</h1><ul class=""><li id="165c" class="og oh jf kw b kx mj la mk ld oi lh oj ll ok lp ol om on oo bi translated">为本教程创建的 Streamlit 应用的完整代码:<a class="ae lq" href="https://github.com/shaildeliwala/experiments/blob/master/streamlit.py" rel="noopener ugc nofollow" target="_blank">https://github . com/shaildeliwala/experiments/blob/master/Streamlit . py</a></li><li id="a595" class="og oh jf kw b kx op la oq ld or lh os ll ot lp ol om on oo bi translated">出自<a class="ou ov ep" href="https://medium.com/u/39dfc90d7a34?source=post_page-----fc8aad9492f2--------------------------------" rel="noopener" target="_blank">Streamlit 联合创始人 Adrien Treuille</a>:<a class="ae lq" rel="noopener" target="_blank" href="/coding-ml-tools-like-you-code-ml-models-ddba3357eace">https://towardsdatascience . com/coding-ml-tools-like-you-code-ml-models-ddba 3357 eace</a></li><li id="50c1" class="og oh jf kw b kx op la oq ld or lh os ll ot lp ol om on oo bi translated">Streamlit API 文档:<a class="ae lq" href="https://streamlit.io/docs/api.html#streamlit.slider" rel="noopener ugc nofollow" target="_blank">https://streamlit.io/docs/api.html</a></li><li id="30c9" class="og oh jf kw b kx op la oq ld or lh os ll ot lp ol om on oo bi translated">Streamlit 教程:<a class="ae lq" href="https://streamlit.io/docs/tutorial2/" rel="noopener ugc nofollow" target="_blank">https://streamlit.io/docs/tutorial2/</a></li><li id="71ad" class="og oh jf kw b kx op la oq ld or lh os ll ot lp ol om on oo bi translated">Streamlit 演示视频:<a class="ae lq" href="https://youtu.be/B2iAodr0fOo" rel="noopener ugc nofollow" target="_blank">https://youtu.be/B2iAodr0fOo</a></li><li id="a564" class="og oh jf kw b kx op la oq ld or lh os ll ot lp ol om on oo bi translated">Airbnb 纽约房源数据(非官方):<a class="ae lq" href="http://data.insideairbnb.com/united-states/ny/new-york-city/2019-09-12/visualisations/listings.csv" rel="noopener ugc nofollow" target="_blank">http://data . inside Airbnb . com/United-States/ny/new-York-city/2019-09-12/visualizations/listings . CSV</a></li><li id="a82f" class="og oh jf kw b kx op la oq ld or lh os ll ot lp ol om on oo bi translated">Plotly 直方图文档:<a class="ae lq" href="https://plot.ly/python/histograms/" rel="noopener ugc nofollow" target="_blank">https://plot.ly/python/histograms/</a></li></ul></div></div>    
</body>
</html>