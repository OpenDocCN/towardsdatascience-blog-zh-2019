<html>
<head>
<title>Pollution forecasting using Time series and LSTM with MXnet</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">基于时间序列和 LSTM 的 MXnet 污染预测</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/pollution-forecasting-using-time-series-and-lstm-with-mxnet-16fe9180ee1?source=collection_archive---------23-----------------------#2019-10-21">https://towardsdatascience.com/pollution-forecasting-using-time-series-and-lstm-with-mxnet-16fe9180ee1?source=collection_archive---------23-----------------------#2019-10-21</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/ac5793dc8e19b747e12c327c25b1560a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Hs-6iS52-OvMAo6J"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk">Photo by <a class="ae kf" href="https://unsplash.com/@jakehills?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Jake Hills</a> on <a class="ae kf" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="1390" class="kg kh it bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">时间序列</h1><p id="d9d3" class="pw-post-body-paragraph le lf it lg b lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">时间序列分析是一种处理时间序列数据或趋势分析的统计技术。时间序列数据是指数据在一系列特定的时间段或间隔内。</p><p id="564e" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">TSA(时间序列分析)应用:</p><ul class=""><li id="9b7b" class="mh mi it lg b lh mc ll md lp mj lt mk lx ml mb mm mn mo mp bi translated">模式识别</li><li id="fabb" class="mh mi it lg b lh mq ll mr lp ms lt mt lx mu mb mm mn mo mp bi translated">地震预报</li><li id="8437" class="mh mi it lg b lh mq ll mr lp ms lt mt lx mu mb mm mn mo mp bi translated">天气预报</li><li id="ddab" class="mh mi it lg b lh mq ll mr lp ms lt mt lx mu mb mm mn mo mp bi translated">金融统计</li></ul><p id="f7e3" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">还有更多…</p><h1 id="4562" class="kg kh it bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">MXnet</h1><figure class="mw mx my mz gt ju gh gi paragraph-image"><div class="gh gi mv"><img src="../Images/c7cdc89de13c8ac03ac1dec9967c8751.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/0*UbArg2AhR-re2IH0.png"/></div></figure><p id="b2a7" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">Apache MXNet(孵化)是一个深度学习框架，旨在提高效率和灵活性。它允许你混合符号和命令式编程来最大化效率和生产力。MXNet 的核心包含一个动态依赖调度器，它可以动态地自动并行化符号操作和命令操作。在此之上的图形优化层使得符号执行速度更快，内存效率更高。MXNet 是可移植的、轻量级的，可以有效地扩展到多个 GPU 和多台机器。</p><h1 id="fb2d" class="kg kh it bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">问题</h1><figure class="mw mx my mz gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi na"><img src="../Images/7585f10da5d303acadefe1cfba905660.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*SaR55GtUak_mknJ-"/></div></div></figure><blockquote class="nb nc nd"><p id="4af9" class="le lf ne lg b lh mc lj lk ll md ln lo nf me lr ls ng mf lv lw nh mg lz ma mb im bi translated"><em class="it">在中国这个世界上人口最多的国家，随着新兴精英阶层的崛起和超过 10%的经济增长率，环境问题已经退居其次。日益严重的污染导致了无法使用的水道，出生缺陷的增加，以及一些地球上最脏的空气。它是如此的令人讨厌，以至于现在有一个词来形容它:“smogpocalypse”。</em></p></blockquote><p id="26e8" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated"><a class="ae kf" href="https://allthatsinteresting.com/pollution-in-china-photographs" rel="noopener ugc nofollow" target="_blank">来源</a></p><h1 id="4147" class="kg kh it bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">我们开始吧！</h1><h2 id="8b2a" class="ni kh it bd ki nj nk dn km nl nm dp kq lp nn no ku lt np nq ky lx nr ns lc nt bi translated">密码</h2><p id="2ecb" class="pw-post-body-paragraph le lf it lg b lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">这里用到的所有代码都可以作为<a class="ae kf" href="https://colab.research.google.com/drive/1ktpx04H1uZtezRd934De3-IIqD43mhn2" rel="noopener ugc nofollow" target="_blank">笔记本</a>使用。可以直接在<a class="ae kf" href="https://colab.research.google.com" rel="noopener ugc nofollow" target="_blank"> google colab </a>上运行。</p></div><div class="ab cl nu nv hx nw" role="separator"><span class="nx bw bk ny nz oa"/><span class="nx bw bk ny nz oa"/><span class="nx bw bk ny nz"/></div><div class="im in io ip iq"><p id="3e94" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">我们从安装基本组件和依赖项开始我们的笔记本。</p><figure class="mw mx my mz gt ju"><div class="bz fp l di"><div class="ob oc l"/></div></figure><p id="be26" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">在本教程中，我们将使用<a class="ae kf" href="https://archive.ics.uci.edu/ml/datasets/Beijing+PM2.5+Data" rel="noopener ugc nofollow" target="_blank">北京 PM2.5 数据集</a>来训练和预测污染水平(<a class="ae kf" href="https://blissair.com/what-is-pm-2-5.htm" rel="noopener ugc nofollow" target="_blank"> PM2.5 </a>)</p><p id="ad70" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">使用 wget 直接下载数据集:</p><figure class="mw mx my mz gt ju"><div class="bz fp l di"><div class="ob oc l"/></div></figure><p id="e864" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">导入所需模块:</p><figure class="mw mx my mz gt ju"><div class="bz fp l di"><div class="ob oc l"/></div></figure><p id="b517" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">用熊猫读数据:</p><figure class="mw mx my mz gt ju"><div class="bz fp l di"><div class="ob oc l"/></div></figure><p id="7886" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated"><em class="ne">小数据处理</em> —</p><p id="3c13" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">大量的可视化和特征工程超出了本教程的范围，但是我们仍然需要做一些事情来继续。</p><ul class=""><li id="4a89" class="mh mi it lg b lh mc ll md lp mj lt mk lx ml mb mm mn mo mp bi translated">下降<em class="ne"> Nan </em>值。</li><li id="1ae7" class="mh mi it lg b lh mq ll mr lp ms lt mt lx mu mb mm mn mo mp bi translated">标签编码风向(<em class="ne"> cbwd </em>)</li></ul><figure class="mw mx my mz gt ju"><div class="bz fp l di"><div class="ob oc l"/></div></figure><figure class="mw mx my mz gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi od"><img src="../Images/0178304981ab9dbae06b8820b5a5414f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1304/format:webp/0*o69mIOnH8iSs-dF-.png"/></div></div></figure><p id="5711" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">我们数据集的快速可视化:</p><figure class="mw mx my mz gt ju"><div class="bz fp l di"><div class="ob oc l"/></div></figure><figure class="mw mx my mz gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi oe"><img src="../Images/b2bc1590899e679c507a6b16e476f7c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*BWxbmtEo5uVKCQdx.png"/></div></div></figure><p id="5906" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">我们定义了一个将数据转换为数据序列的函数:</p><figure class="mw mx my mz gt ju"><div class="bz fp l di"><div class="ob oc l"/></div></figure><p id="8610" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated"><em class="ne">多一点数据预处理</em></p><ul class=""><li id="b9bf" class="mh mi it lg b lh mc ll md lp mj lt mk lx ml mb mm mn mo mp bi translated">将数据集值中的值缩放至[0，1]</li><li id="1e4e" class="mh mi it lg b lh mq ll mr lp ms lt mt lx mu mb mm mn mo mp bi translated">通过将我们的数据传递给上面定义的<code class="fe of og oh oi b">make_dataset_many_to_one</code>来创建新的数据集。在这里，我们选择每 24 小时做一次记录。</li></ul><p id="7db1" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">按如下方式重塑数据:</p><ul class=""><li id="bb5c" class="mh mi it lg b lh mc ll md lp mj lt mk lx ml mb mm mn mo mp bi translated"><strong class="lg iu">样品</strong>。一个序列就是一个样本。一个批次由一个或多个样本组成。</li><li id="cb84" class="mh mi it lg b lh mq ll mr lp ms lt mt lx mu mb mm mn mo mp bi translated"><strong class="lg iu">时间步长</strong>。一个时间步长是样本中的一个观察点。</li><li id="bc4a" class="mh mi it lg b lh mq ll mr lp ms lt mt lx mu mb mm mn mo mp bi translated"><strong class="lg iu">特点</strong>。一个特征是一个时间步长的一个观察值。</li></ul><figure class="mw mx my mz gt ju"><div class="bz fp l di"><div class="ob oc l"/></div></figure><p id="4052" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">将 numpy 数组转换成<code class="fe of og oh oi b">mxnet.nd.array</code>:</p><figure class="mw mx my mz gt ju"><div class="bz fp l di"><div class="ob oc l"/></div></figure><p id="1842" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">定义<a class="ae kf" href="https://mxnet.incubator.apache.org/api/python/docs/api/gluon/rnn/index.html#mxnet.gluon.rnn.LSTM" rel="noopener ugc nofollow" target="_blank"> LSTM </a>神经网络:</p><figure class="mw mx my mz gt ju"><div class="bz fp l di"><div class="ob oc l"/></div></figure><p id="ec57" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">接下来，我们需要将模型初始化为一个设备。(CPU 或 GPU)</p><figure class="mw mx my mz gt ju"><div class="bz fp l di"><div class="ob oc l"/></div></figure><p id="ce27" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">现在，我们需要定义训练参数。<a class="ae kf" href="https://mxnet.apache.org/api/python/docs/api/gluon/trainer.html" rel="noopener ugc nofollow" target="_blank">更多</a></p><figure class="mw mx my mz gt ju"><div class="bz fp l di"><div class="ob oc l"/></div></figure><p id="cef4" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">这里，<code class="fe of og oh oi b">loss_function</code>用于训练期间，<code class="fe of og oh oi b">mse</code>用于计算每个历元后的损失。</p><figure class="mw mx my mz gt ju"><div class="bz fp l di"><div class="ob oc l"/></div></figure><p id="2bb9" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">主训练循环:</p><figure class="mw mx my mz gt ju"><div class="bz fp l di"><div class="ob oc l"/></div></figure><p id="e434" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">损失应该随着每个时期变得更低，我们为 15 个时期训练我们的模型。</p><figure class="mw mx my mz gt ju"><div class="bz fp l di"><div class="ob oc l"/></div></figure><p id="6253" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">对整个数据集进行预测:</p><figure class="mw mx my mz gt ju"><div class="bz fp l di"><div class="ob oc l"/></div></figure><p id="a425" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">将缩放后的预测值转换为实际大小，并将其存储在数据框中:</p><figure class="mw mx my mz gt ju"><div class="bz fp l di"><div class="ob oc l"/></div></figure><p id="1519" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">将预测可视化:</p><figure class="mw mx my mz gt ju"><div class="bz fp l di"><div class="ob oc l"/></div></figure><figure class="mw mx my mz gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi oj"><img src="../Images/a5d6522a7468598f91efbe078ea965ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*S_FaLRA0PuMI9Jhg.png"/></div></div></figure><p id="7199" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">正如你所看到的，我们的模型在预测明天的污染水平方面做得很好。</p></div><div class="ab cl nu nv hx nw" role="separator"><span class="nx bw bk ny nz oa"/><span class="nx bw bk ny nz oa"/><span class="nx bw bk ny nz"/></div><div class="im in io ip iq"><p id="e2f7" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">希望这篇文章对你的探索有所帮助。</p><p id="1dd3" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated"><a class="ae kf" href="https://colab.research.google.com/drive/1ktpx04H1uZtezRd934De3-IIqD43mhn2" rel="noopener ugc nofollow" target="_blank">在 Google Colab 中运行此笔记本</a></p></div></div>    
</body>
</html>