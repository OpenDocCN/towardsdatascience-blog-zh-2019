<html>
<head>
<title>DNA Search- Command Line Interfaces with argparse</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">DNA 搜索-与 argparse 的命令行接口</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/dna-search-command-line-interfaces-with-argparse-8b11c0862495?source=collection_archive---------21-----------------------#2019-07-13">https://towardsdatascience.com/dna-search-command-line-interfaces-with-argparse-8b11c0862495?source=collection_archive---------21-----------------------#2019-07-13</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="b1b6" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated"><strong class="ak">寻找小 DNA 片段</strong></h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/06206201ee30e8c95285a2134e527570.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7WIIqgYrULPmCHY1ChdgaA.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk"><a class="ae ky" href="https://unsplash.com/@nci" rel="noopener ugc nofollow" target="_blank">National Cancer Institute</a> via Unsplash</figcaption></figure><h1 id="55e6" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated"><strong class="ak">命令行与 argparse 接口</strong></h1><p id="d197" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">在生物信息学中，经常需要在命令行上运行我们的程序。幸运的是，Python 的 argparse 模块——标准库的一部分——使这变得很容易。</p><p id="a9ab" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">Python 有一系列有用的库，使得构建用户界面变得容易。通常，当我们想到用户界面时，脑海中浮现的是图形点击界面。然而，用户界面是允许用户与程序交互的任何东西，包括命令行界面——这是本文的重点。</p><p id="ef81" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">为了介绍 argparse，我将构建一个小程序来搜索用户输入的特定小段 DNA。程序将搜索的这些小段 DNA 被称为限制酶位点，即长度在 4-6 个字符之间的小 Python 字符串。这个程序将搜索细菌的基因组，看看它们出现的频率！</p><h1 id="5812" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated"><strong class="ak">入门</strong></h1><p id="55fb" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">该计划有两个明确的目的:</p><ol class=""><li id="4e78" class="ms mt it lt b lu mn lx mo ma mu me mv mi mw mm mx my mz na bi translated">向用户提供信息，例如当程序崩溃时提供有用的信息。</li><li id="b84f" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm mx my mz na bi translated">要灵活。该程序应该能够通过改变命令行参数来搜索用户选择的任何 DNA。</li></ol><p id="aa17" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">首先，导入 argparse 模块并创建 ArgumentParser 对象:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ng nh l"/></div></figure><p id="b743" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">这不是必须的，但是我发现使用<strong class="lt iu">描述关键字参数</strong>提供一个描述性的字符串很有帮助。当程序稍后在命令行中调用帮助时，将提供 python 程序的描述性概述。如果有多个用户，并且程序运行之间有时间间隔，这可能是有用的。</p><p id="8561" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">接下来，我们通过调用<strong class="lt iu"> add_argument()方法</strong>来告诉参数解析器对象预期的参数。一旦添加了所有的参数，我们可以告诉它通过调用<strong class="lt iu"> parse_args()方法</strong>来解析命令行参数。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ng nh l"/></div></figure><p id="adf2" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu"> add_argument()方法</strong>添加了三个参数。此外，还增加了其他各种可选参数，如<strong class="lt iu"> help=，type=，choice=，default= ect </strong>。</p><p id="aa4d" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">这就是 argparse 模块真正发挥作用的地方。</p><p id="9889" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">短参数和长参数分别用单连字符(-)或双连字符(—)指定。这意味着，在终端的命令行上，当程序运行时，参数可以用简写方式表示，输入文件名用-i 表示，或者用简写方式表示，输入文件名用 input _ filename 表示。长短参数的另一个好处是它们可以在命令行中以任何顺序表达！</p><p id="e12f" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">混合匹配排列中的短参数和长参数如下所示。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ni"><img src="../Images/ce58b7c83717a6b7fdfef7ec186b8dcd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tPzFKuEOSlPhrGAvFj6hxw.png"/></div></div></figure><p id="63be" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我们可以通过使用 help 关键字参数调用 add_argument()来使帮助文本变得更好。当程序在没有命令行参数的情况下运行时，会出现三个参数的有用帮助文本(以黄色突出显示):</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nj"><img src="../Images/a96842b1d1809fa273be41015051d473.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IwMMmhOuJ2LQzWZjdm7GUA.png"/></div></div></figure><p id="c1bf" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu">自定义验证</strong></p><p id="bce7" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">parser.add_argument 方法中的 type=参数接受 Python 函数的名称</p><p id="0c51" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">类型参数引用一个函数，例如—输入文件名由名为 file_check 的函数检查。下面显示的这个函数检查文件是否确实存在。</p><p id="6ca5" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">最后，choice 和 nargs 参数意味着用户可以选择选择列表中的任何元素。因为用户可以选择多个参数，所以 nargs 参数是必需的，并且指定了一个星号。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ng nh l"/></div></figure><p id="51d9" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">最后，现在已经添加了所有参数和用于输入验证的函数，可以编写一个小脚本了。我先写一个小字典，里面的限制酶名称是键，限制酶识别的对应序列是它们的值。</p><p id="285b" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">为了完整起见，我在 restriciton _ enzyme _ dict 字典中包含了这个程序所需的模块。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ng nh l"/></div></figure><p id="e0bf" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">用户指定的参数以 args 为前缀，后跟其输入名称。</p><p id="fc53" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">首先打开 DNA 文件，并使用。read()方法。接下来，迭代用户指定的模式。模式代表一个限制酶，是上面字典中显示的关键字，例如 EcoRI 是字典中的关键字；restriction_enzyme_dict，它的值是‘GAATTC’，即它在任何 DNA 样本中识别的序列。</p><p id="6068" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">对于每种限制性内切酶，我用。get()方法。它的价值在于它在基因组中识别的序列。正则表达式 re.findall 查找 DNA 中所有出现的序列，并将这些序列附加到结果列表中。</p><p id="1f21" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">使用集合将结果列表转换为特殊的字典。Counter 方法()，用于计算找到一个唯一序列的次数。</p><p id="8fa4" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">最后，这本由 collections 创建的新词典。可以迭代名为 restriction_sites_dict 的计数器，如果序列超过用户指定的计数，则打印一条消息，告诉用户它被找到了多少次及其序列。</p><p id="2d14" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">要查看程序的运行情况，让我们运行几个测试示例！</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ng nh l"/></div></figure><p id="a78b" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">输出示例如下所示:</p><p id="a6e6" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在这里，我使用 p 标志(p 标志对应于用户指定的模式)搜索了三种限制性内切酶，-p HindIII、EcoRI 和 KpnI。在第一次运行时，我没有指定计数。之前，在 count_no 的 add_argument 中，我将一个有用的默认值设置为 0。</p><p id="9e40" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">当我再次运行程序时，计数阈值为 500，程序通知我 HindIII 站点低于我指定的 500 阈值。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nk"><img src="../Images/a04b826a93f0fe3eecf51a0ef2412b47.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*w5I5yh4mZUasLbnIx0KZnA.png"/></div></div></figure><p id="59e5" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">这个程序运行良好。结果很快返回，并且已经搜索了大肠杆菌的整个基因组内的限制酶位点！非常酷(这个 Fasta 文件是从 NCBI 获得的)，但是在我们的命令行中，我们可以通过指定它们各自的文件名，轻松地选择搜索其他细菌基因组。</p><p id="d3d0" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">最后，阐述一下先前的意图将是有益的。具体来说，该计划被设计得非常灵活。如果用户添加了不正确的限制性内切酶，比如 FakeEnzyme，会发生什么？</p><p id="9fca" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><em class="nl">让我们运行程序来找出答案。</em></p><p id="ce5c" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我突出显示了有用的错误消息，如果用户输入了错误的选项，它会提示用户从提供的选择列表中进行选择。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nm"><img src="../Images/15db7106fa183ce97a703ced702cdd52.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GY0rFWwiFlBqu4w_o5hZOQ.png"/></div></div></figure><h1 id="c988" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">摘要</h1><p id="f316" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">这个简短的教程展示了如何将命令行界面添加到程序中。幸运的是，Python 提供了构建接口的有用库，argparse 就是其中之一。</p></div></div>    
</body>
</html>